# Issue 10057: Upgrade sagenb

archive/issues_010056.json:
```json
{
    "body": "Upgrade to the latest version of sagenb.  Tarball for `upstream/` at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.2.tar\n\nOne useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\nWe deprecate for real all these fixed `sagenb` imports in #17460.\n\nThis will also fix #11275, #8738, #8427, #17490.\n\nSee also #17482 and #17515 for Sage issues related to this update.\n\n**Assignee:** @jasongrout, @williamstein\n\n**CC:**  @johanrosenkilde\n\n**Keywords:** sd35.5\n\n**Branch/Commit:** [14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8](https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8)\n\n**Upstream:** Fixed upstream, in a later stable release.\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** Karl-Dieter Crisman\n\nIssue created by migration from https://trac.sagemath.org/ticket/10057\n\n",
    "closed_at": "2015-01-02T15:46:34Z",
    "created_at": "2010-10-02T19:44:08Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "Upgrade sagenb",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10057",
    "user": "https://github.com/jasongrout"
}
```
Upgrade to the latest version of sagenb.  Tarball for `upstream/` at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.2.tar

One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
We deprecate for real all these fixed `sagenb` imports in #17460.

This will also fix #11275, #8738, #8427, #17490.

See also #17482 and #17515 for Sage issues related to this update.

**Assignee:** @jasongrout, @williamstein

**CC:**  @johanrosenkilde

**Keywords:** sd35.5

**Branch/Commit:** [14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8](https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8)

**Upstream:** Fixed upstream, in a later stable release.

**Reviewer:** Jeroen Demeyer

**Author:** Karl-Dieter Crisman

Issue created by migration from https://trac.sagemath.org/ticket/10057





---

archive/attachments_013116.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10057.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10057/trac_10057.patch",
    "created_at": "2010-10-09T20:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_118248.json:
```json
{
    "body": "<a id='comment:2'></a>\n",
    "created_at": "2010-10-09T20:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118248",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:2'></a>




---

archive/issue_comments_118249.json:
```json
{
    "body": "**Author:** Mike Hansen",
    "created_at": "2010-10-09T20:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118249",
    "user": "https://github.com/mwhansen"
}
```

**Author:** Mike Hansen



---

archive/issue_comments_118250.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-10-09T20:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118250",
    "user": "https://github.com/mwhansen"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_118251.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2012-01-10T10:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118251",
    "user": "https://github.com/zimmermann6"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_118252.json:
```json
{
    "body": "<a id='comment:3'></a>\nMike,\n\nI started to review that ticket, but I'm puzzled since\n\n```\nsage: from sage.misc.misc import decorator_defaults\n```\nstill works. Shouldn't it fail?\n\nAlso, shouldn't the patch include a doctest?\n\nPaul",
    "created_at": "2012-01-10T10:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118252",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:3'></a>
Mike,

I started to review that ticket, but I'm puzzled since

```
sage: from sage.misc.misc import decorator_defaults
```
still works. Shouldn't it fail?

Also, shouldn't the patch include a doctest?

Paul



---

archive/issue_comments_118253.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd35.5\".",
    "created_at": "2012-01-10T10:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118253",
    "user": "https://github.com/zimmermann6"
}
```

**Changing keywords** from "" to "sd35.5".



---

archive/issue_comments_118254.json:
```json
{
    "body": "**Reviewer:** Paul Zimmermann",
    "created_at": "2012-01-10T10:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118254",
    "user": "https://github.com/zimmermann6"
}
```

**Reviewer:** Paul Zimmermann



---

archive/issue_comments_118255.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [zimmerma](#comment%3A3):\n> Mike,\n> \n> I started to review that ticket, but I'm puzzled since\n> \n> ```\n> sage: from sage.misc.misc import decorator_defaults\n> ```\n> still works. Shouldn't it fail?\n> \n\n\nThe reason it doesn't fail is because sage.misc.misc contains an import statement, importing decorator_defaults among other (line 2735). This was introduced in #9907 for backwards compatibility, in case users assumed that these decorators would still be in sage.misc.misc. I assumed this would be a temporary thing, just as for keyword and attribute changes. #9907 was merged 14 months ago, so this is longer than the deprecation lifetime, but on the other hand, no deprecation warning has been issued to users doing the wrong thing for these past 14 months. I'm not sure what is usually done under such circumstances. Also, removing the import statement from sage.misc.misc will result in the pickle jar breaking, and I'm not sure how to remedy that and what consequences it might have. Need expert opinion here.\n\n> Also, shouldn't the patch include a doctest?\n\n\nMaybe that's just me, but isn't it a bit too much including a doctest just for a relocation of a function? It's still the same function.",
    "created_at": "2012-01-10T12:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118255",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:4'></a>
Replying to [zimmerma](#comment%3A3):
> Mike,
> 
> I started to review that ticket, but I'm puzzled since
> 
> ```
> sage: from sage.misc.misc import decorator_defaults
> ```
> still works. Shouldn't it fail?
> 


The reason it doesn't fail is because sage.misc.misc contains an import statement, importing decorator_defaults among other (line 2735). This was introduced in #9907 for backwards compatibility, in case users assumed that these decorators would still be in sage.misc.misc. I assumed this would be a temporary thing, just as for keyword and attribute changes. #9907 was merged 14 months ago, so this is longer than the deprecation lifetime, but on the other hand, no deprecation warning has been issued to users doing the wrong thing for these past 14 months. I'm not sure what is usually done under such circumstances. Also, removing the import statement from sage.misc.misc will result in the pickle jar breaking, and I'm not sure how to remedy that and what consequences it might have. Need expert opinion here.

> Also, shouldn't the patch include a doctest?


Maybe that's just me, but isn't it a bit too much including a doctest just for a relocation of a function? It's still the same function.



---

archive/issue_comments_118256.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2012-01-10T13:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118256",
    "user": "https://github.com/zimmermann6"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_118257.json:
```json
{
    "body": "<a id='comment:5'></a>\nok I understand. But then I don't know what a reviewer is supposed to do for such a patch.\nAnyway I put it back to needs review.\n\nPaul",
    "created_at": "2012-01-10T13:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118257",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:5'></a>
ok I understand. But then I don't know what a reviewer is supposed to do for such a patch.
Anyway I put it back to needs review.

Paul



---

archive/issue_comments_118258.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2013-06-18T20:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118258",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_118259.json:
```json
{
    "body": "**Changing reviewer** from \"Paul Zimmermann\" to \"Mike Hansen, Paul Zimmermann\".",
    "created_at": "2014-12-06T20:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118259",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Paul Zimmermann" to "Mike Hansen, Paul Zimmermann".



---

archive/issue_events_030384.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-06T20:38:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30384"
}
```



---

archive/issue_events_030385.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30385"
}
```



---

archive/issue_events_030386.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-06T20:38:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30386"
}
```



---

archive/issue_comments_118260.json:
```json
{
    "body": "**Changing author** from \"Mike Hansen\" to \"\".",
    "created_at": "2014-12-06T20:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118260",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Mike Hansen" to "".



---

archive/issue_comments_118261.json:
```json
{
    "body": "<a id='comment:7'></a>\nI'm working on a sagenb pull request.",
    "created_at": "2014-12-06T20:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118261",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I'm working on a sagenb pull request.



---

archive/issue_events_030387.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30387"
}
```



---

archive/issue_comments_118262.json:
```json
{
    "body": "**Changing status** from closed to new.",
    "created_at": "2014-12-06T20:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118262",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from closed to new.



---

archive/issue_comments_118263.json:
```json
{
    "body": "**Changing upstream** from \"N/A\" to \"Not yet reported upstream; Will do shortly.\".",
    "created_at": "2014-12-06T20:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118263",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "N/A" to "Not yet reported upstream; Will do shortly.".



---

archive/issue_comments_118264.json:
```json
{
    "body": "<a id='comment:8'></a>\nHey, only the release manager gets to close a ticket!  ;-)\n\nMore seriously, should we remove the 'deprecated' import or is the pickle jar issue mentioned [above](#comment%3A4) serious enough to not do that?  Anyway, better to keep this as an \"upstream tracking\" ticket, as sagenb will still need to be upgraded for this (and whatever else - https://github.com/sagemath/sagenb/pull/267 could use review, for instance).",
    "created_at": "2014-12-06T20:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118264",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
Hey, only the release manager gets to close a ticket!  ;-)

More seriously, should we remove the 'deprecated' import or is the pickle jar issue mentioned [above](#comment%3A4) serious enough to not do that?  Anyway, better to keep this as an "upstream tracking" ticket, as sagenb will still need to be upgraded for this (and whatever else - https://github.com/sagemath/sagenb/pull/267 could use review, for instance).



---

archive/issue_events_030388.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-06T20:52:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30388"
}
```



---

archive/issue_events_030389.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-06T20:52:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30389"
}
```



---

archive/issue_comments_118265.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,3 @@\n-This line is in the interact.py file in sagenb:\n+Upgrade to the latest version of sagenb.\n \n-```\n-from sage.misc.misc import decorator_defaults\n-```\n-\n-#9907 moved this to sage.misc.decorators, so the import location should be changed after it is merged.\n+One useful fix is the fixing of various import locations.\n``````\n",
    "created_at": "2014-12-06T20:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118265",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,3 @@
-This line is in the interact.py file in sagenb:
+Upgrade to the latest version of sagenb.
 
-```
-from sage.misc.misc import decorator_defaults
-```
-
-#9907 moved this to sage.misc.decorators, so the import location should be changed after it is merged.
+One useful fix is the fixing of various import locations.
``````




---

archive/issue_comments_118266.json:
```json
{
    "body": "<a id='comment:9'></a>\nOK, I'll rework the ticket.",
    "created_at": "2014-12-06T20:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118266",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
OK, I'll rework the ticket.



---

archive/issue_events_030390.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "rename": {
        "from": "Change import location for decorator_defaults in sagenb interact.py",
        "to": "Upgrade sagenb"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30390"
}
```



---

archive/issue_comments_118267.json:
```json
{
    "body": "**Changing upstream** from \"Not yet reported upstream; Will do shortly.\" to \"Reported upstream. No feedback yet.\".",
    "created_at": "2014-12-06T21:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118267",
    "user": "https://github.com/jdemeyer"
}
```

**Changing upstream** from "Not yet reported upstream; Will do shortly." to "Reported upstream. No feedback yet.".



---

archive/issue_comments_118268.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Upgrade to the latest version of sagenb.\n \n-One useful fix is the fixing of various import locations.\n+One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\n``````\n",
    "created_at": "2014-12-06T21:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118268",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Upgrade to the latest version of sagenb.
 
-One useful fix is the fixing of various import locations.
+One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
``````




---

archive/issue_comments_118269.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Upgrade to the latest version of sagenb.\n \n One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\n+\n+We deprecate for real all these fixed `sagenb` imports.\n``````\n",
    "created_at": "2014-12-06T21:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118269",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Upgrade to the latest version of sagenb.
 
 One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
+
+We deprecate for real all these fixed `sagenb` imports.
``````




---

archive/issue_comments_118270.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\n \n-We deprecate for real all these fixed `sagenb` imports.\n+We deprecate for real all these fixed `sagenb` imports: #17460.\n``````\n",
    "created_at": "2014-12-07T23:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118270",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
 
-We deprecate for real all these fixed `sagenb` imports.
+We deprecate for real all these fixed `sagenb` imports: #17460.
``````




---

archive/issue_comments_118271.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\".",
    "created_at": "2014-12-07T23:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118271",
    "user": "https://github.com/jdemeyer"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug.".



---

archive/issue_comments_118272.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2014-12-08T16:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118272",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_118273.json:
```json
{
    "body": "<a id='comment:13'></a>\nOkay.  Now if you can at least look at https://github.com/sagemath/sagenb/pull/282 for me (since you already have a working sagenb development environment) I would be grateful.  Given its importance, I'd also appreciate a look at https://github.com/sagemath/sagenb/pull/267 but I know that one requires just slightly more testing, though in reality both patches are fairly trivial.",
    "created_at": "2014-12-08T16:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118273",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>
Okay.  Now if you can at least look at https://github.com/sagemath/sagenb/pull/282 for me (since you already have a working sagenb development environment) I would be grateful.  Given its importance, I'd also appreciate a look at https://github.com/sagemath/sagenb/pull/267 but I know that one requires just slightly more testing, though in reality both patches are fairly trivial.



---

archive/issue_comments_118274.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/10057)",
    "created_at": "2014-12-08T18:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118274",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/10057)



---

archive/issue_comments_118275.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/10057)\" to \"\".",
    "created_at": "2014-12-08T18:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118275",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/jdemeyer/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/10057)" to "".



---

archive/issue_comments_118276.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\n \n-We deprecate for real all these fixed `sagenb` imports: #17460.\n+This will also fix #11275, #8738, #8427, ...\n+\n+See also #17482 and #17515 for Sage issues related to this update.  We deprecate for real all these fixed `sagenb` imports in #17460.\n``````\n",
    "created_at": "2014-12-18T02:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118276",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
 
-We deprecate for real all these fixed `sagenb` imports: #17460.
+This will also fix #11275, #8738, #8427, ...
+
+See also #17482 and #17515 for Sage issues related to this update.  We deprecate for real all these fixed `sagenb` imports in #17460.
``````




---

archive/issue_comments_118277.json:
```json
{
    "body": "**Changing reviewer** from \"Mike Hansen, Paul Zimmermann\" to \"\".",
    "created_at": "2014-12-18T02:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118277",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Mike Hansen, Paul Zimmermann" to "".



---

archive/issue_comments_118278.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,4 +4,6 @@\n \n This will also fix #11275, #8738, #8427, ...\n \n+Ideally this would also have a fix for #17490 in it.\n+\n See also #17482 and #17515 for Sage issues related to this update.  We deprecate for real all these fixed `sagenb` imports in #17460.\n``````\n",
    "created_at": "2014-12-18T03:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118278",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,4 +4,6 @@
 
 This will also fix #11275, #8738, #8427, ...
 
+Ideally this would also have a fix for #17490 in it.
+
 See also #17482 and #17515 for Sage issues related to this update.  We deprecate for real all these fixed `sagenb` imports in #17460.
``````




---

archive/issue_comments_118279.json:
```json
{
    "body": "**Author:** Karl-Dieter Crisman",
    "created_at": "2014-12-22T15:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118279",
    "user": "https://github.com/kcrisman"
}
```

**Author:** Karl-Dieter Crisman



---

archive/issue_comments_118280.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2014-12-22T15:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118280",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_118281.json:
```json
{
    "body": "**Commit:** [f5c559df46d9a8700a9479bc1244b1d943e02b4b](https://github.com/sagemath/sagetrac-mirror/commit/f5c559df46d9a8700a9479bc1244b1d943e02b4b)",
    "created_at": "2014-12-22T15:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118281",
    "user": "https://github.com/kcrisman"
}
```

**Commit:** [f5c559df46d9a8700a9479bc1244b1d943e02b4b](https://github.com/sagemath/sagetrac-mirror/commit/f5c559df46d9a8700a9479bc1244b1d943e02b4b)



---

archive/issue_comments_118282.json:
```json
{
    "body": "**Branch:** [u/kcrisman/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/kcrisman/ticket/10057)",
    "created_at": "2014-12-22T15:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118282",
    "user": "https://github.com/kcrisman"
}
```

**Branch:** [u/kcrisman/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/kcrisman/ticket/10057)



---

archive/issue_comments_118283.json:
```json
{
    "body": "<a id='comment:18'></a>\nFor reference to #17490, I used `gnutar` and not the standard Mac `tar`, so hopefully that is resolved temporarily with this sagenb.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5c559df46d9a8700a9479bc1244b1d943e02b4b\">f5c559d</a></td><td><code>Upgrade sagenb to version 0.11.2</code></td></tr></table>\n",
    "created_at": "2014-12-22T15:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118283",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>
For reference to #17490, I used `gnutar` and not the standard Mac `tar`, so hopefully that is resolved temporarily with this sagenb.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5c559df46d9a8700a9479bc1244b1d943e02b4b">f5c559d</a></td><td><code>Upgrade sagenb to version 0.11.2</code></td></tr></table>




---

archive/issue_comments_118284.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Upgrade to the latest version of sagenb.\n+Upgrade to the latest version of sagenb.  Tarball for `upstream/` at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.2.tar\n \n One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\n \n``````\n",
    "created_at": "2014-12-22T15:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118284",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Upgrade to the latest version of sagenb.
+Upgrade to the latest version of sagenb.  Tarball for `upstream/` at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.2.tar
 
 One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
 
``````




---

archive/issue_comments_118285.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, but not in a stable release.\" to \"Fixed upstream, in a later stable release.\".",
    "created_at": "2014-12-22T15:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118285",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Fixed upstream, but not in a stable release." to "Fixed upstream, in a later stable release.".



---

archive/issue_comments_118286.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,9 +1,8 @@\n Upgrade to the latest version of sagenb.  Tarball for `upstream/` at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.2.tar\n \n One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)\n+We deprecate for real all these fixed `sagenb` imports in #17460.\n \n-This will also fix #11275, #8738, #8427, ...\n+This will also fix #11275, #8738, #8427, #17490.\n \n-Ideally this would also have a fix for #17490 in it.\n-\n-See also #17482 and #17515 for Sage issues related to this update.  We deprecate for real all these fixed `sagenb` imports in #17460.\n+See also #17482 and #17515 for Sage issues related to this update.\n``````\n",
    "created_at": "2014-12-22T16:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118286",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,9 +1,8 @@
 Upgrade to the latest version of sagenb.  Tarball for `upstream/` at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.2.tar
 
 One useful fix is the fixing of various import locations: [https://github.com/sagemath/sagenb/pull/280](https://github.com/sagemath/sagenb/pull/280)
+We deprecate for real all these fixed `sagenb` imports in #17460.
 
-This will also fix #11275, #8738, #8427, ...
+This will also fix #11275, #8738, #8427, #17490.
 
-Ideally this would also have a fix for #17490 in it.
-
-See also #17482 and #17515 for Sage issues related to this update.  We deprecate for real all these fixed `sagenb` imports in #17460.
+See also #17482 and #17515 for Sage issues related to this update.
``````




---

archive/issue_comments_118287.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [kcrisman](#comment%3A18):\n> For reference to #17490, I used `gnutar` and not the standard Mac `tar`, so hopefully that is resolved temporarily with this sagenb.\n\n\nAt least I see\n\n```\njdemeyer@tamiyo:/usr/local/src/sage-git/upstream$ file sagenb-*\nsagenb-0.10.8.2.tar: POSIX tar archive (GNU)\nsagenb-0.11.0.tar:   POSIX tar archive\nsagenb-0.11.1.tar:   POSIX tar archive\nsagenb-0.11.2.tar:   POSIX tar archive (GNU)\n```",
    "created_at": "2014-12-22T16:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118287",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [kcrisman](#comment%3A18):
> For reference to #17490, I used `gnutar` and not the standard Mac `tar`, so hopefully that is resolved temporarily with this sagenb.


At least I see

```
jdemeyer@tamiyo:/usr/local/src/sage-git/upstream$ file sagenb-*
sagenb-0.10.8.2.tar: POSIX tar archive (GNU)
sagenb-0.11.0.tar:   POSIX tar archive
sagenb-0.11.1.tar:   POSIX tar archive
sagenb-0.11.2.tar:   POSIX tar archive (GNU)
```



---

archive/issue_comments_118288.json:
```json
{
    "body": "<a id='comment:23'></a>\nI don't know that this will *fix* #17490, though I can fix the upstream release instructions.  But that is a good sign.\n\nAnyway, ready for review.  Most stuff is either obvious fixes or stuff that doesn't affect day-to-day notebook operations (the translation stuff).",
    "created_at": "2014-12-22T16:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118288",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:23'></a>
I don't know that this will *fix* #17490, though I can fix the upstream release instructions.  But that is a good sign.

Anyway, ready for review.  Most stuff is either obvious fixes or stuff that doesn't affect day-to-day notebook operations (the translation stuff).



---

archive/issue_comments_118289.json:
```json
{
    "body": "<a id='comment:24'></a>\nI guess a review will be mostly \"does it build and pass doctests?\", assuming that everything was actually reviewed upstream.",
    "created_at": "2014-12-22T16:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118289",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
I guess a review will be mostly "does it build and pass doctests?", assuming that everything was actually reviewed upstream.



---

archive/issue_comments_118290.json:
```json
{
    "body": "<a id='comment:25'></a>\nI think it is worth checking whether there is any serious regression of behavior - make sure worksheets still work, test random functionality, etc. as a whole.  Especially worth making sure the *Sage* tickets mentioned above are actually fixed by the upgrade.  The only possible issue I can foresee is if one of the packages upstream of upstream changed a doctest - I had some bizarre Sage failure related to Babel but I don't see how it could have come from a 'standard' sagenb installation. \n\nWhich reminds me that #17482 is just waiting for your say-so, I made the change you requested.",
    "created_at": "2014-12-22T17:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118290",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:25'></a>
I think it is worth checking whether there is any serious regression of behavior - make sure worksheets still work, test random functionality, etc. as a whole.  Especially worth making sure the *Sage* tickets mentioned above are actually fixed by the upgrade.  The only possible issue I can foresee is if one of the packages upstream of upstream changed a doctest - I had some bizarre Sage failure related to Babel but I don't see how it could have come from a 'standard' sagenb installation. 

Which reminds me that #17482 is just waiting for your say-so, I made the change you requested.



---

archive/issue_comments_118291.json:
```json
{
    "body": "<a id='comment:26'></a>\nCan someone check whether this could cause\n\n```\nsage -t --long src/sage/symbolic/expression.pyx\nFailed example:\n    import sagenb.misc.support as s\nExpected nothing\nGot:\n    doctest:14: ImportWarning: Not importing directory '/Users/...sage/local/lib/python2.7/site-packages/Babel-1.3-py2.7.egg/babel/localedata': missing __init__.py\n```\nor whether that is just because of my sagenb setup, not a problem per se?  There is a similar failure in \n\n```\nsage -t --long src/sage/combinat/cluster_algebra_quiver/quiver.py\nsage -t --long src/sage/misc/dev_tools.py\n```\nAlso the usual\n\n```\n\nFile \"src/sage/repl/notebook_ipython.py\", line 60, in sage.repl.notebook_ipython.have_prerequisites\nFailed example:\n    from sage.repl.notebook_ipython import have_prerequisites\nExpected nothing\nGot:\n    doctest:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.\n\n```\nalso in\n\n```\nsage -t --long src/sage/repl/zmq_kernel.py\n```\nthough I don't (yet) have beta4.",
    "created_at": "2014-12-22T19:31:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118291",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:26'></a>
Can someone check whether this could cause

```
sage -t --long src/sage/symbolic/expression.pyx
Failed example:
    import sagenb.misc.support as s
Expected nothing
Got:
    doctest:14: ImportWarning: Not importing directory '/Users/...sage/local/lib/python2.7/site-packages/Babel-1.3-py2.7.egg/babel/localedata': missing __init__.py
```
or whether that is just because of my sagenb setup, not a problem per se?  There is a similar failure in 

```
sage -t --long src/sage/combinat/cluster_algebra_quiver/quiver.py
sage -t --long src/sage/misc/dev_tools.py
```
Also the usual

```

File "src/sage/repl/notebook_ipython.py", line 60, in sage.repl.notebook_ipython.have_prerequisites
Failed example:
    from sage.repl.notebook_ipython import have_prerequisites
Expected nothing
Got:
    doctest:57: PowmInsecureWarning: Not using mpz_powm_sec.  You should rebuild using libgmp >= 5 to avoid timing attack vulnerability.

```
also in

```
sage -t --long src/sage/repl/zmq_kernel.py
```
though I don't (yet) have beta4.



---

archive/issue_comments_118292.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2014-12-22T19:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118292",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_118293.json:
```json
{
    "body": "<a id='comment:27'></a>\nIndeed, this is a regression:\n\n```\nsage -t --long src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 10721, in sage.symbolic.expression.get_dynamic_class_for_function\nFailed example:\n    import sagenb.misc.support as s\nExpected nothing\nGot:\n    doctest:14: ImportWarning: Not importing directory '/usr/local/src/sage-git/local/lib/python2.7/site-packages/Babel-1.3-py2.7.egg/babel/localedata': missing __init__.py\n**********************************************************************\n```",
    "created_at": "2014-12-22T19:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118293",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Indeed, this is a regression:

```
sage -t --long src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 10721, in sage.symbolic.expression.get_dynamic_class_for_function
Failed example:
    import sagenb.misc.support as s
Expected nothing
Got:
    doctest:14: ImportWarning: Not importing directory '/usr/local/src/sage-git/local/lib/python2.7/site-packages/Babel-1.3-py2.7.egg/babel/localedata': missing __init__.py
**********************************************************************
```



---

archive/issue_comments_118294.json:
```json
{
    "body": "<a id='comment:28'></a>\nSee https://github.com/voleg/babel/commit/14796d7f5d3d175b3feac73c2fe8bb87037514d5",
    "created_at": "2014-12-22T19:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118294",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
See https://github.com/voleg/babel/commit/14796d7f5d3d175b3feac73c2fe8bb87037514d5



---

archive/issue_comments_118295.json:
```json
{
    "body": "<a id='comment:29'></a>\nI have to admit I cannot figure out what change would have done this; we already have Babel 1.3 in previous Sage.  Maybe an unintended side effect of the changes in imports w.r.t. `sagenb.misc.support`?  Also notice this *only* happens in doctests, not at the command line.",
    "created_at": "2014-12-22T20:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118295",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:29'></a>
I have to admit I cannot figure out what change would have done this; we already have Babel 1.3 in previous Sage.  Maybe an unintended side effect of the changes in imports w.r.t. `sagenb.misc.support`?  Also notice this *only* happens in doctests, not at the command line.



---

archive/issue_comments_118296.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [kcrisman](#comment%3A29):\n> we already have Babel 1.3 in previous Sage\n\nYes, but the previous Notebook version didn't actually *use* babel.\n\n> Also notice this *only* happens in doctests, not at the command line.\n\nWarnings in Python can be enabled/disabled. Apparently, this warning is enabled in doctests (which is probably a good thing) but not in the command line.",
    "created_at": "2014-12-22T20:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118296",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Replying to [kcrisman](#comment%3A29):
> we already have Babel 1.3 in previous Sage

Yes, but the previous Notebook version didn't actually *use* babel.

> Also notice this *only* happens in doctests, not at the command line.

Warnings in Python can be enabled/disabled. Apparently, this warning is enabled in doctests (which is probably a good thing) but not in the command line.



---

archive/issue_comments_118297.json:
```json
{
    "body": "<a id='comment:31'></a>\nOkay, I think it is stuff like https://github.com/sagemath/sagenb/commit/5ffa976e0d76b674e09cd6bddd2d1bd6105f166c - it actually happens in other places we import babel (or `flask.ext.babel`) but those were not doctested in Sage.\n\nUnfortunately, the `util/fetch_deps.py` in sagenb doesn't exactly make it easy to just apply patches.",
    "created_at": "2014-12-22T20:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118297",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:31'></a>
Okay, I think it is stuff like https://github.com/sagemath/sagenb/commit/5ffa976e0d76b674e09cd6bddd2d1bd6105f166c - it actually happens in other places we import babel (or `flask.ext.babel`) but those were not doctested in Sage.

Unfortunately, the `util/fetch_deps.py` in sagenb doesn't exactly make it easy to just apply patches.



---

archive/issue_comments_118298.json:
```json
{
    "body": "<a id='comment:32'></a>\n> Yes, but the previous Notebook version didn't actually use babel.\n\n\nSure it did - e.g. https://github.com/sagemath/sagenb/commit/5511a2a01322b66fefdc942e41c4d3d95b1f1677",
    "created_at": "2014-12-22T20:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118298",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:32'></a>
> Yes, but the previous Notebook version didn't actually use babel.


Sure it did - e.g. https://github.com/sagemath/sagenb/commit/5511a2a01322b66fefdc942e41c4d3d95b1f1677



---

archive/issue_comments_118299.json:
```json
{
    "body": "<a id='comment:33'></a>\n> Unfortunately, the `util/fetch_deps.py` in sagenb doesn't exactly make it easy to just apply patches.\n\nWorst case we could put this file in the egg at the very end, but that is pretty hackish.",
    "created_at": "2014-12-22T20:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118299",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:33'></a>
> Unfortunately, the `util/fetch_deps.py` in sagenb doesn't exactly make it easy to just apply patches.

Worst case we could put this file in the egg at the very end, but that is pretty hackish.



---

archive/issue_comments_118300.json:
```json
{
    "body": "<a id='comment:34'></a>\nBy the way, if you or others could test the *rest* of the upgrade, or at any rate normal functioning of nb, then we could have just this issue to deal with.",
    "created_at": "2014-12-22T20:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118300",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:34'></a>
By the way, if you or others could test the *rest* of the upgrade, or at any rate normal functioning of nb, then we could have just this issue to deal with.



---

archive/issue_comments_118301.json:
```json
{
    "body": "<a id='comment:35'></a>\nYes, I was sloppy. To be more precise: running the doctests with sagenb-0.11.1 didn't import the `babel` package.\n\nTo patch `babel`: it's probably best to remove `babel` from `sagenb` and install it like a normal package (this should really be done for all packages inside `sagenb`).",
    "created_at": "2014-12-22T20:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118301",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>
Yes, I was sloppy. To be more precise: running the doctests with sagenb-0.11.1 didn't import the `babel` package.

To patch `babel`: it's probably best to remove `babel` from `sagenb` and install it like a normal package (this should really be done for all packages inside `sagenb`).



---

archive/issue_comments_118302.json:
```json
{
    "body": "<a id='comment:36'></a>\nAt least, the `babel` failure is the only doctest failure.",
    "created_at": "2014-12-22T20:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118302",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>
At least, the `babel` failure is the only doctest failure.



---

archive/issue_comments_118303.json:
```json
{
    "body": "<a id='comment:37'></a>\n> To patch babel: it's probably best to remove babel from sagenb and install it like a normal package (this should really be done for all packages inside sagenb).\n\n\nYes, but easier said than done.  I won't have time for this today, and I'm a little hazy on exactly how all the dependencies for sagenb might get properly imported from Sage itself.\n\nIt would also be nice if upstream were responsive at all to their many pull requests (this seems to be the case for several projects pocoo has \"taken over\").",
    "created_at": "2014-12-22T20:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118303",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:37'></a>
> To patch babel: it's probably best to remove babel from sagenb and install it like a normal package (this should really be done for all packages inside sagenb).


Yes, but easier said than done.  I won't have time for this today, and I'm a little hazy on exactly how all the dependencies for sagenb might get properly imported from Sage itself.

It would also be nice if upstream were responsive at all to their many pull requests (this seems to be the case for several projects pocoo has "taken over").



---

archive/issue_comments_118304.json:
```json
{
    "body": "<a id='comment:38'></a>\nAlternatively, if you just want to fix the doctest failure, you could import the `babel` stuff inside the method where you need it.",
    "created_at": "2014-12-22T20:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118304",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>
Alternatively, if you just want to fix the doctest failure, you could import the `babel` stuff inside the method where you need it.



---

archive/issue_comments_118305.json:
```json
{
    "body": "<a id='comment:39'></a>\nHmm, that might be easier.",
    "created_at": "2014-12-22T20:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118305",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:39'></a>
Hmm, that might be easier.



---

archive/issue_comments_118306.json:
```json
{
    "body": "<a id='comment:40'></a>\n> Hmm, that might be easier.\n\n\nNot that I wouldn't be averse to shipping the dependencies separately again!  I just feel like any time I have for sagenb is better used for actual bugs, of which there are already plenty.",
    "created_at": "2014-12-22T20:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118306",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:40'></a>
> Hmm, that might be easier.


Not that I wouldn't be averse to shipping the dependencies separately again!  I just feel like any time I have for sagenb is better used for actual bugs, of which there are already plenty.



---

archive/issue_comments_118307.json:
```json
{
    "body": "<a id='comment:41'></a>\n> Hmm, that might be easier.\n\nYes, that fixes it - and since there is only that one function, it's not a problem to import it in that one place.\n\nI'll have a fix and new package in a little bit.  I hope.",
    "created_at": "2014-12-22T21:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118307",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:41'></a>
> Hmm, that might be easier.

Yes, that fixes it - and since there is only that one function, it's not a problem to import it in that one place.

I'll have a fix and new package in a little bit.  I hope.



---

archive/issue_comments_118308.json:
```json
{
    "body": "<a id='comment:42'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8\">14d3291</a></td><td><code>Upgrade sagenb to version 0.11.2</code></td></tr></table>\n",
    "created_at": "2014-12-22T21:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118308",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8">14d3291</a></td><td><code>Upgrade sagenb to version 0.11.2</code></td></tr></table>




---

archive/issue_comments_118309.json:
```json
{
    "body": "**Changing commit** from \"[f5c559df46d9a8700a9479bc1244b1d943e02b4b](https://github.com/sagemath/sagetrac-mirror/commit/f5c559df46d9a8700a9479bc1244b1d943e02b4b)\" to \"[14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8](https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8)\".",
    "created_at": "2014-12-22T21:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118309",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f5c559df46d9a8700a9479bc1244b1d943e02b4b](https://github.com/sagemath/sagetrac-mirror/commit/f5c559df46d9a8700a9479bc1244b1d943e02b4b)" to "[14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8](https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8)".



---

archive/issue_comments_118310.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2014-12-22T21:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118310",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_118311.json:
```json
{
    "body": "<a id='comment:43'></a>\nOkay, it was a forced push but should be okay now.  Same address for the updated spkg.  Here is the diff - once this has positive review I'll push it all back upstream.\n\n```diff\ndiff --git a/sagenb/misc/misc.py b/sagenb/misc/misc.py\nindex 88b3eef..5a647f7 100644\n--- a/sagenb/misc/misc.py\n+++ b/sagenb/misc/misc.py\n@@ -20,8 +20,6 @@ Check that github issue #195 is fixed::\n #############################################################################\n \n from pkg_resources import resource_filename\n-from babel import Locale\n-from babel.core import UnknownLocaleError\n \n def stub(f):\n     def g(*args, **kwds):\n@@ -517,6 +515,8 @@ def translations_path():\n     return os.path.join(SAGENB_ROOT, 'translations')\n \n def get_languages():\n+    from babel import Locale\n+    from babel.core import UnknownLocaleError\n     langs = []\n     dir_names = [lang for lang in os.listdir(translations_path())\n                        if lang != 'en_US']\n```",
    "created_at": "2014-12-22T21:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118311",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:43'></a>
Okay, it was a forced push but should be okay now.  Same address for the updated spkg.  Here is the diff - once this has positive review I'll push it all back upstream.

```diff
diff --git a/sagenb/misc/misc.py b/sagenb/misc/misc.py
index 88b3eef..5a647f7 100644
--- a/sagenb/misc/misc.py
+++ b/sagenb/misc/misc.py
@@ -20,8 +20,6 @@ Check that github issue #195 is fixed::
 #############################################################################
 
 from pkg_resources import resource_filename
-from babel import Locale
-from babel.core import UnknownLocaleError
 
 def stub(f):
     def g(*args, **kwds):
@@ -517,6 +515,8 @@ def translations_path():
     return os.path.join(SAGENB_ROOT, 'translations')
 
 def get_languages():
+    from babel import Locale
+    from babel.core import UnknownLocaleError
     langs = []
     dir_names = [lang for lang in os.listdir(translations_path())
                        if lang != 'en_US']
```



---

archive/issue_comments_118312.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2014-12-22T21:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118312",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_118313.json:
```json
{
    "body": "<a id='comment:44'></a>\nAll long doctests pass this time.",
    "created_at": "2014-12-23T21:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118313",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
All long doctests pass this time.



---

archive/issue_comments_118314.json:
```json
{
    "body": "<a id='comment:45'></a>\nAnd I assume that it is still a gnu tar archive?  \n\nOkay, I think anyone can put this to positive review if they don't see any regressions in actual behavior.",
    "created_at": "2014-12-24T02:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118314",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:45'></a>
And I assume that it is still a gnu tar archive?  

Okay, I think anyone can put this to positive review if they don't see any regressions in actual behavior.



---

archive/issue_comments_118315.json:
```json
{
    "body": "<a id='comment:46'></a>\nI'm tagging this upstream, so any additional problems will have to be 1) after Christmas and 2) version 0.11.3.",
    "created_at": "2014-12-24T02:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118315",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:46'></a>
I'm tagging this upstream, so any additional problems will have to be 1) after Christmas and 2) version 0.11.3.



---

archive/issue_comments_118316.json:
```json
{
    "body": "<a id='comment:47'></a>\nThe tarball is made correctly, I don't get any warnings when extracting it.\n\nI also checked that the tarball contents matches the git repo. I noticed a few missing files: [https://github.com/sagemath/sagenb/issues/327](https://github.com/sagemath/sagenb/issues/327) I consider this a serious issue (especially with the `COPYING` file missing), but not serious enough to block this ticket.",
    "created_at": "2014-12-24T09:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118316",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>
The tarball is made correctly, I don't get any warnings when extracting it.

I also checked that the tarball contents matches the git repo. I noticed a few missing files: [https://github.com/sagemath/sagenb/issues/327](https://github.com/sagemath/sagenb/issues/327) I consider this a serious issue (especially with the `COPYING` file missing), but not serious enough to block this ticket.



---

archive/issue_comments_118317.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2014-12-24T09:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118317",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_118318.json:
```json
{
    "body": "<a id='comment:48'></a>\n* #11275: fixed\n* #8738: fixed\n* #8427: fixed\n* #17490: fixed",
    "created_at": "2014-12-24T09:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118318",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>
* #11275: fixed
* #8738: fixed
* #8427: fixed
* #17490: fixed



---

archive/issue_events_030391.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-02T15:46:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10057#event-30391"
}
```



---

archive/issue_comments_118319.json:
```json
{
    "body": "**Changing branch** from \"[u/kcrisman/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/kcrisman/ticket/10057)\" to \"[14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8](https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8)\".",
    "created_at": "2015-01-02T15:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10057#issuecomment-118319",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/kcrisman/ticket/10057](https://github.com/sagemath/sagetrac-mirror/tree/u/kcrisman/ticket/10057)" to "[14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8](https://github.com/sagemath/sagetrac-mirror/commit/14d329164ce9731014d3d6e5a2ae1bbcc9a9b3f8)".
