# Issue 10156: Rename top-level makefile to Makefile

archive/issues_010155.json:
```json
{
    "body": "This ticket has a few patches which should be applied when renaming `makefile` to `Makefile`.  See also #9799.\n\nApply:\n1. [attachment:10156_doc.patch](https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch)\n2. [attachment:10156_scripts.patch](https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch)\n3. [attachment:install.patch](https://github.com/sagemath/sage/files/ticket10156/install.patch)\n\n**CC:**  @jhpalmieri @nexttime\n\n**Keywords:** scripts makefile\n\n**Author:** Jeroen Demeyer, John Palmieri\n\n**Reviewer:** Volker Braun\n\n**Merged:** sage-4.6.1.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/10156\n\n",
    "closed_at": "2010-11-16T08:21:29Z",
    "created_at": "2010-10-23T07:42:31Z",
    "labels": [
        "component: distribution",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.1",
    "title": "Rename top-level makefile to Makefile",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/10156",
    "user": "https://github.com/jdemeyer"
}
```
This ticket has a few patches which should be applied when renaming `makefile` to `Makefile`.  See also #9799.

Apply:
1. [attachment:10156_doc.patch](https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch)
2. [attachment:10156_scripts.patch](https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch)
3. [attachment:install.patch](https://github.com/sagemath/sage/files/ticket10156/install.patch)

**CC:**  @jhpalmieri @nexttime

**Keywords:** scripts makefile

**Author:** Jeroen Demeyer, John Palmieri

**Reviewer:** Volker Braun

**Merged:** sage-4.6.1.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/10156





---

archive/attachments_013747.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "10156_doc.patch",
    "asset_url": "tarball://root/attachments/ticket10156/10156_doc.patch",
    "created_at": "2010-10-23T07:50:56Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_095654.json:
```json
{
    "body": "**Attachment:** [10156_doc.patch](https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch)\n\nsagelib patch",
    "created_at": "2010-10-23T07:50:56Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95654",
    "user": "https://github.com/jdemeyer"
}
```

**Attachment:** [10156_doc.patch](https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch)

sagelib patch



---

archive/attachments_013748.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "10156_scripts.patch",
    "asset_url": "tarball://root/attachments/ticket10156/10156_scripts.patch",
    "created_at": "2010-10-23T07:51:06Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_095655.json:
```json
{
    "body": "**Attachment:** [10156_scripts.patch](https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch)\n\nsage_scripts patch",
    "created_at": "2010-10-23T07:51:06Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95655",
    "user": "https://github.com/jdemeyer"
}
```

**Attachment:** [10156_scripts.patch](https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch)

sage_scripts patch



---

archive/issue_comments_095656.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2010-10-23T11:49:24Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95656",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_comments_095657.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe renaming is also done by #9433 IIRC.",
    "created_at": "2010-10-23T11:56:02Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95657",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>
The renaming is also done by #9433 IIRC.



---

archive/issue_comments_095658.json:
```json
{
    "body": "<a id='comment:3'></a>\nI wonder if it's safer to use `[Mm]akefile` in the shell scripts. (The scripts calling Python functions rather than `os.system()` etc. would get more complicated of course.)\n\nAt least there seems to be a lack of error / consistency checking, as always...",
    "created_at": "2010-10-23T13:29:57Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95658",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'></a>
I wonder if it's safer to use `[Mm]akefile` in the shell scripts. (The scripts calling Python functions rather than `os.system()` etc. would get more complicated of course.)

At least there seems to be a lack of error / consistency checking, as always...



---

archive/issue_events_077043.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-10-23T13:29:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77043"
}
```



---

archive/issue_comments_095659.json:
```json
{
    "body": "<a id='comment:4'></a>\nPatches look reasonable; I just don't know yet if they catch all instances.",
    "created_at": "2010-10-23T13:31:42Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95659",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
Patches look reasonable; I just don't know yet if they catch all instances.



---

archive/issue_comments_095660.json:
```json
{
    "body": "<a id='comment:5'></a>\nIf you thrust the author of the patch to do the test, I am doing the following:\n* building Sage from source with #9799, #10156, #10157 applied and makefile renamed to Makefile\n* making an sdist and a bdist from this built Sage\n* extract the sdist, make, make ptestlong\n* extract the bdist, make ptestlong\n\nIf all this works, I think that #10156 and #10157 are proven to work.",
    "created_at": "2010-10-23T15:56:50Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95660",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
If you thrust the author of the patch to do the test, I am doing the following:
* building Sage from source with #9799, #10156, #10157 applied and makefile renamed to Makefile
* making an sdist and a bdist from this built Sage
* extract the sdist, make, make ptestlong
* extract the bdist, make ptestlong

If all this works, I think that #10156 and #10157 are proven to work.



---

archive/issue_comments_095661.json:
```json
{
    "body": "<a id='comment:6'></a>\nAll builds and tests mentioned above worked with #9799, #10156, #10157 applied.",
    "created_at": "2010-10-23T22:12:52Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95661",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
All builds and tests mentioned above worked with #9799, #10156, #10157 applied.



---

archive/issue_comments_095662.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-See also #9799\n+This ticket has a few patches which should be applied when renaming `makefile` to `Makefile`.  See also #9799.\n``````\n",
    "created_at": "2010-10-23T22:12:52Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95662",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-See also #9799
+This ticket has a few patches which should be applied when renaming `makefile` to `Makefile`.  See also #9799.
``````




---

archive/issue_comments_095663.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [leif](#comment%3A3):\n> I wonder if it's safer to use `[Mm]akefile` in the shell scripts.\n\n\nI don't see why.  If we really rename `makefile` to `Makefile`, there is no reason to use `[Mm]akefile`.",
    "created_at": "2010-10-25T10:29:01Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95663",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [leif](#comment%3A3):
> I wonder if it's safer to use `[Mm]akefile` in the shell scripts.


I don't see why.  If we really rename `makefile` to `Makefile`, there is no reason to use `[Mm]akefile`.



---

archive/issue_comments_095664.json:
```json
{
    "body": "**Merged:** sage-4.6.1.alpha0",
    "created_at": "2010-11-01T10:17:07Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95664",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.1.alpha0



---

archive/issue_comments_095665.json:
```json
{
    "body": "<a id='comment:9'></a>\nJohn or Leif: could you review this and #10157 please?  I think these patches have received sufficient testing to prove that they work.",
    "created_at": "2010-11-05T08:47:31Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95665",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
John or Leif: could you review this and #10157 please?  I think these patches have received sufficient testing to prove that they work.



---

archive/issue_comments_095666.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe Sage library patch looks fine. \n\nFor the scripts patch, I haven't tested it at all, but what happens if you upgrade from a version of Sage with a file called \"makefile\"?  Will things break?  I don't think it's ever a good idea to run \"sage-sdist\" or \"sage-bdist\" from an upgraded version of Sage, but if someone does, what will happen?  Would it be a good idea to either use something like [Mm]akefile, as leif suggested, or do something like the following:\n\n```sh\nif [ -e makefile ]; then\n   cp -$OPT makefile \"$TMP\"/Makefile\nfi\n```\n(This is for sage-bdist, and you would use something similar in sage-sdist.)",
    "created_at": "2010-11-05T17:59:27Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95666",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>
The Sage library patch looks fine. 

For the scripts patch, I haven't tested it at all, but what happens if you upgrade from a version of Sage with a file called "makefile"?  Will things break?  I don't think it's ever a good idea to run "sage-sdist" or "sage-bdist" from an upgraded version of Sage, but if someone does, what will happen?  Would it be a good idea to either use something like [Mm]akefile, as leif suggested, or do something like the following:

```sh
if [ -e makefile ]; then
   cp -$OPT makefile "$TMP"/Makefile
fi
```
(This is for sage-bdist, and you would use something similar in sage-sdist.)



---

archive/issue_comments_095667.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jhpalmieri](#comment%3A10):\n> The Sage library patch looks fine. \n> \n> For the scripts patch, I haven't tested it at all, but what happens if you upgrade from a version of Sage with a file called \"makefile\"?  Will things break?\n\n\nW.r.t. making new dists from an upgraded version, hopefully #9433 solves this... ;-)\n\n(I don't know if you meant upgrading in general; this works for me. You just still have the old `makefile`.)\n\n\n> I don't think it's ever a good idea to run \"sage-sdist\" or \"sage-bdist\" from an upgraded version of Sage [...]\n\n\nNobody should do this, currently.\n\nWe should perhaps just give an error message in that case (until #9433 is merged).",
    "created_at": "2010-11-05T18:38:58Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95667",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
Replying to [jhpalmieri](#comment%3A10):
> The Sage library patch looks fine. 
> 
> For the scripts patch, I haven't tested it at all, but what happens if you upgrade from a version of Sage with a file called "makefile"?  Will things break?


W.r.t. making new dists from an upgraded version, hopefully #9433 solves this... ;-)

(I don't know if you meant upgrading in general; this works for me. You just still have the old `makefile`.)


> I don't think it's ever a good idea to run "sage-sdist" or "sage-bdist" from an upgraded version of Sage [...]


Nobody should do this, currently.

We should perhaps just give an error message in that case (until #9433 is merged).



---

archive/issue_comments_095668.json:
```json
{
    "body": "<a id='comment:12'></a>\nI don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?",
    "created_at": "2010-11-05T20:17:32Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95668",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?



---

archive/issue_comments_095669.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jdemeyer](#comment%3A12):\n> I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?\n\n\nOf course. But I would *rename* it because (POSIX) `make` gives `makefile` precedence over `Makefile` and we don't want to cause confusion.",
    "created_at": "2010-11-06T00:24:57Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95669",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
Replying to [jdemeyer](#comment%3A12):
> I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?


Of course. But I would *rename* it because (POSIX) `make` gives `makefile` precedence over `Makefile` and we don't want to cause confusion.



---

archive/issue_comments_095670.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [leif](#comment%3A13):\n> Replying to [jdemeyer](#comment%3A12):\n> > I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?\n\n> \n> Of course. But I would *rename* it because (POSIX) `make` gives `makefile` precedence over `Makefile` and we don't want to cause confusion.\n\n\nOn the other hand, if `makefile` and `Makefile` are identical files, it shouldn't matter.  It seems just dangerous to delete `makefile` during a Sage build/upgrade.\n\nCan any of you implement this?",
    "created_at": "2010-11-07T10:56:15Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95670",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [leif](#comment%3A13):
> Replying to [jdemeyer](#comment%3A12):
> > I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?

> 
> Of course. But I would *rename* it because (POSIX) `make` gives `makefile` precedence over `Makefile` and we don't want to cause confusion.


On the other hand, if `makefile` and `Makefile` are identical files, it shouldn't matter.  It seems just dangerous to delete `makefile` during a Sage build/upgrade.

Can any of you implement this?



---

archive/issue_comments_095671.json:
```json
{
    "body": "**Work Issues:** copy makefile to Makefile during upgrade",
    "created_at": "2010-11-07T10:56:15Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95671",
    "user": "https://github.com/jdemeyer"
}
```

**Work Issues:** copy makefile to Makefile during upgrade



---

archive/issue_events_077044.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-07T10:56:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77044"
}
```



---

archive/issue_events_077045.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-07T10:56:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77045"
}
```



---

archive/issue_comments_095672.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [jdemeyer](#comment%3A14):\n> Replying to [leif](#comment%3A13):\n> > Replying to [jdemeyer](#comment%3A12):\n> > > I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?\n\n> > \n> > Of course. But I would *rename* it because (POSIX) `make` gives `makefile` precedence over `Makefile` and we don't want to cause confusion.\n\n> \n> On the other hand, if `makefile` and `Makefile` are identical files, it shouldn't matter.  It seems just dangerous to delete `makefile` during a Sage build/upgrade.\n\n\nNote that on OS X, you can't have files called both \"makefile\" and \"Makefile\" in the same directory.  Also, \"makefile\" is not used at all during an upgrade, so it should be safe to rename it.\n\n> Can any of you implement this?\n\n\nIt's taken care of by #9433.  If we want to implement it here, I think it should be done in the sage-upgrade script, after running \"./install\" and checking its exit status:\n\n```diff\ndiff -r 4047e578febc sage-upgrade\n--- a/sage-upgrade      Sat Oct 30 16:05:33 2010 -0700\n+++ b/sage-upgrade      Tue Nov 09 10:57:40 2010 -0800\n@@ -36,3 +36,13 @@\n     exit 1\n fi\n \n+cd \"$SAGE_ROOT\"\n+\n+if [ -f makefile ]; then\n+    mv makefile Makefile\n+fi\n+\n+if [ $? -ne 0 ]; then\n+    echo \"Error renaming 'makefile' to 'Makefile'.\n+    exit 1\n+fi\n```\nAnother option would also check for the existence of 'Makefile' before doing the move:\n\n```diff\ndiff -r 4047e578febc sage-upgrade\n--- a/sage-upgrade      Sat Oct 30 16:05:33 2010 -0700\n+++ b/sage-upgrade      Tue Nov 09 10:58:47 2010 -0800\n@@ -36,3 +36,16 @@\n     exit 1\n fi\n \n+cd \"$SAGE_ROOT\"\n+\n+if [ -f makefile ]; then\n+    if [ -f Makefile ]; then\n+       mv Makefile Makefile.old\n+    fi\n+    mv makefile Makefile\n+fi\n+\n+if [ $? -ne 0 ]; then\n+    echo \"Error renaming 'makefile' to 'Makefile'.\n+    exit 1\n+fi\n```\nOpinions either way?",
    "created_at": "2010-11-09T19:00:13Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95672",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Replying to [jdemeyer](#comment%3A14):
> Replying to [leif](#comment%3A13):
> > Replying to [jdemeyer](#comment%3A12):
> > > I don't understand the fine details of upgrading, but would it be possible to copy `makefile` to `Makefile` during the *upgrade*?

> > 
> > Of course. But I would *rename* it because (POSIX) `make` gives `makefile` precedence over `Makefile` and we don't want to cause confusion.

> 
> On the other hand, if `makefile` and `Makefile` are identical files, it shouldn't matter.  It seems just dangerous to delete `makefile` during a Sage build/upgrade.


Note that on OS X, you can't have files called both "makefile" and "Makefile" in the same directory.  Also, "makefile" is not used at all during an upgrade, so it should be safe to rename it.

> Can any of you implement this?


It's taken care of by #9433.  If we want to implement it here, I think it should be done in the sage-upgrade script, after running "./install" and checking its exit status:

```diff
diff -r 4047e578febc sage-upgrade
--- a/sage-upgrade      Sat Oct 30 16:05:33 2010 -0700
+++ b/sage-upgrade      Tue Nov 09 10:57:40 2010 -0800
@@ -36,3 +36,13 @@
     exit 1
 fi
 
+cd "$SAGE_ROOT"
+
+if [ -f makefile ]; then
+    mv makefile Makefile
+fi
+
+if [ $? -ne 0 ]; then
+    echo "Error renaming 'makefile' to 'Makefile'.
+    exit 1
+fi
```
Another option would also check for the existence of 'Makefile' before doing the move:

```diff
diff -r 4047e578febc sage-upgrade
--- a/sage-upgrade      Sat Oct 30 16:05:33 2010 -0700
+++ b/sage-upgrade      Tue Nov 09 10:58:47 2010 -0800
@@ -36,3 +36,16 @@
     exit 1
 fi
 
+cd "$SAGE_ROOT"
+
+if [ -f makefile ]; then
+    if [ -f Makefile ]; then
+       mv Makefile Makefile.old
+    fi
+    mv makefile Makefile
+fi
+
+if [ $? -ne 0 ]; then
+    echo "Error renaming 'makefile' to 'Makefile'.
+    exit 1
+fi
```
Opinions either way?



---

archive/attachments_013749.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "10156_upgrade.patch",
    "asset_url": "tarball://root/attachments/ticket10156/10156_upgrade.patch",
    "created_at": "2010-11-10T08:39:16Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10156/10156_upgrade.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_095673.json:
```json
{
    "body": "**Attachment:** [10156_upgrade.patch](https://github.com/sagemath/sage/files/ticket10156/10156_upgrade.patch)\n\nAdditional scripts patch: rename makefile to Makefile during upgrade",
    "created_at": "2010-11-10T08:39:16Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95673",
    "user": "https://github.com/jdemeyer"
}
```

**Attachment:** [10156_upgrade.patch](https://github.com/sagemath/sage/files/ticket10156/10156_upgrade.patch)

Additional scripts patch: rename makefile to Makefile during upgrade



---

archive/issue_events_077046.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-10T18:58:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77046"
}
```



---

archive/issue_events_077047.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-10T18:58:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77047"
}
```



---

archive/issue_comments_095674.json:
```json
{
    "body": "**Changing merged** from \"sage-4.6.1.alpha0\" to \"\".",
    "created_at": "2010-11-10T18:58:24Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95674",
    "user": "https://github.com/jdemeyer"
}
```

**Changing merged** from "sage-4.6.1.alpha0" to "".



---

archive/issue_comments_095675.json:
```json
{
    "body": "**Merged:** sage-4.6.1.alpha1",
    "created_at": "2010-11-10T22:27:28Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95675",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.1.alpha1



---

archive/issue_comments_095676.json:
```json
{
    "body": "<a id='comment:18'></a>\nThe first two patches (10156_docs.patch and 10156_scripts.patch) get a positive review from me.\n\nThis doesn't work, probably my fault.  The issue is that the script \"sage-upgrade\" doesn't get upgraded in the process.  So I think moving makefile should happen at the end of the \"install\" script instead, since this gets downloaded before it gets run.  (In particular, upgrading didn't rename \"makefile\" when I tested it.)  Try this patch to \"install\" instead.",
    "created_at": "2010-11-11T01:15:14Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95676",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
The first two patches (10156_docs.patch and 10156_scripts.patch) get a positive review from me.

This doesn't work, probably my fault.  The issue is that the script "sage-upgrade" doesn't get upgraded in the process.  So I think moving makefile should happen at the end of the "install" script instead, since this gets downloaded before it gets run.  (In particular, upgrading didn't rename "makefile" when I tested it.)  Try this patch to "install" instead.



---

archive/issue_comments_095677.json:
```json
{
    "body": "**Changing author** from \"Jeroen Demeyer\" to \"Jeroen Demeyer, John Palmieri\".",
    "created_at": "2010-11-11T01:15:14Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95677",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing author** from "Jeroen Demeyer" to "Jeroen Demeyer, John Palmieri".



---

archive/attachments_013750.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "install",
    "asset_url": "tarball://root/attachments/ticket10156/install",
    "created_at": "2010-11-11T01:15:36Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10156/install",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_095678.json:
```json
{
    "body": "**Attachment:** [install](https://github.com/sagemath/sage/files/ticket10156/install)\n\nthe file spkg/install",
    "created_at": "2010-11-11T01:15:36Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95678",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [install](https://github.com/sagemath/sage/files/ticket10156/install)

the file spkg/install



---

archive/attachments_013751.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "install.patch",
    "asset_url": "tarball://root/attachments/ticket10156/install.patch",
    "created_at": "2010-11-11T01:15:54Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10156/install.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_095679.json:
```json
{
    "body": "**Attachment:** [install.patch](https://github.com/sagemath/sage/files/ticket10156/install.patch)\n\npatch for 'install'",
    "created_at": "2010-11-11T01:15:54Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95679",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [install.patch](https://github.com/sagemath/sage/files/ticket10156/install.patch)

patch for 'install'



---

archive/issue_comments_095680.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [jhpalmieri](#comment%3A18):\n> This doesn't work, probably my fault. \n\n\nBy \"this\", I meant the third patch, 10156_upgrade.patch.",
    "created_at": "2010-11-11T02:18:30Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95680",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
Replying to [jhpalmieri](#comment%3A18):
> This doesn't work, probably my fault. 


By "this", I meant the third patch, 10156_upgrade.patch.



---

archive/issue_comments_095681.json:
```json
{
    "body": "<a id='comment:20'></a>\nFor what it's worth, my change to \"install\" works for me when upgrading on both Mac OS X (with its odd case-sensitivity) and Solaris.  I tested upgrading from 4.5.3 (which had \"makefile\") and 4.6.1.alpha0 (which had \"Makefile\").",
    "created_at": "2010-11-11T04:40:23Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95681",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>
For what it's worth, my change to "install" works for me when upgrading on both Mac OS X (with its odd case-sensitivity) and Solaris.  I tested upgrading from 4.5.3 (which had "makefile") and 4.6.1.alpha0 (which had "Makefile").



---

archive/issue_comments_095682.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,6 @@\n This ticket has a few patches which should be applied when renaming `makefile` to `Makefile`.  See also #9799.\n+\n+Apply:\n+1. [attachment:10156_doc.patch](https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch)\n+2. [attachment:10156_scripts.patch](https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch)\n+3. [attachment:install.patch](https://github.com/sagemath/sage/files/ticket10156/install.patch)\n``````\n",
    "created_at": "2010-11-11T19:42:37Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95682",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,6 @@
 This ticket has a few patches which should be applied when renaming `makefile` to `Makefile`.  See also #9799.
+
+Apply:
+1. [attachment:10156_doc.patch](https://github.com/sagemath/sage/files/ticket10156/10156_doc.patch)
+2. [attachment:10156_scripts.patch](https://github.com/sagemath/sage/files/ticket10156/10156_scripts.patch)
+3. [attachment:install.patch](https://github.com/sagemath/sage/files/ticket10156/install.patch)
``````




---

archive/issue_comments_095683.json:
```json
{
    "body": "**Changing work issues** from \"copy makefile to Makefile during upgrade\" to \"\".",
    "created_at": "2010-11-15T12:43:57Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95683",
    "user": "https://github.com/jdemeyer"
}
```

**Changing work issues** from "copy makefile to Makefile during upgrade" to "".



---

archive/issue_events_077048.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-15T12:43:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "rename": {
        "from": "Rename makefile to Makefile",
        "to": "Rename top-level makefile to Makefile"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77048"
}
```



---

archive/issue_comments_095684.json:
```json
{
    "body": "**Reviewer:** Volker Braun",
    "created_at": "2010-11-16T02:05:31Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95684",
    "user": "https://github.com/vbraun"
}
```

**Reviewer:** Volker Braun



---

archive/issue_comments_095685.json:
```json
{
    "body": "<a id='comment:23'></a>\nI successfully updated from sage-4.5.2 on Fedora 13 and the patch did go the extra mile to make sure that it doesn't break upgrades. I'll set it to positive review.",
    "created_at": "2010-11-16T02:05:31Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95685",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
I successfully updated from sage-4.5.2 on Fedora 13 and the patch did go the extra mile to make sure that it doesn't break upgrades. I'll set it to positive review.



---

archive/issue_events_077049.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-11-16T02:05:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77049"
}
```



---

archive/issue_events_077050.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-11-16T02:05:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77050"
}
```



---

archive/issue_events_077051.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-16T08:21:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77051"
}
```



---

archive/issue_events_077052.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-16T08:21:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10156#event-77052"
}
```



---

archive/issue_comments_095686.json:
```json
{
    "body": "<a id='comment:25'></a>\nIt looks to me there are still a few files that refer to `makefile`. Shall I create a ticket for these:\n\n```\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:Another way is to edit the file \\code{makefile} in the top level Sage\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:After saving all changes to \\code{makefile}, we can parallel test with the\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:these command, see the files \\code{SAGE\\_ROOT/makefile} and\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:argument \\code{-long}. See the file \\code{SAGE\\_ROOT/makefile} for further\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:\\code{SAGE\\_ROOT/makefile} for further details.\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:the file \\code{SAGE\\_ROOT/makefile} takes care of the unpacking,\ndevel/sage-main/doc/output/latex/en/developer/developer.tex:\\code{\\$SAGE\\_ROOT/makefile} before using \\code{ptestlong}). See\n```",
    "created_at": "2010-11-16T17:57:51Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95686",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:25'></a>
It looks to me there are still a few files that refer to `makefile`. Shall I create a ticket for these:

```
devel/sage-main/doc/output/latex/en/developer/developer.tex:Another way is to edit the file \code{makefile} in the top level Sage
devel/sage-main/doc/output/latex/en/developer/developer.tex:After saving all changes to \code{makefile}, we can parallel test with the
devel/sage-main/doc/output/latex/en/developer/developer.tex:these command, see the files \code{SAGE\_ROOT/makefile} and
devel/sage-main/doc/output/latex/en/developer/developer.tex:argument \code{-long}. See the file \code{SAGE\_ROOT/makefile} for further
devel/sage-main/doc/output/latex/en/developer/developer.tex:\code{SAGE\_ROOT/makefile} for further details.
devel/sage-main/doc/output/latex/en/developer/developer.tex:the file \code{SAGE\_ROOT/makefile} takes care of the unpacking,
devel/sage-main/doc/output/latex/en/developer/developer.tex:\code{\$SAGE\_ROOT/makefile} before using \code{ptestlong}). See
```



---

archive/issue_comments_095687.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [drkirkby](#comment%3A25):\n> It looks to me there are still a few files that refer to `makefile`. Shall I create a ticket for these:\n> \n> ```\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:Another way is to edit the file \\code{makefile} in the top level Sage\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:After saving all changes to \\code{makefile}, we can parallel test with the\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:these command, see the files \\code{SAGE\\_ROOT/makefile} and\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:argument \\code{-long}. See the file \\code{SAGE\\_ROOT/makefile} for further\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:\\code{SAGE\\_ROOT/makefile} for further details.\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:the file \\code{SAGE\\_ROOT/makefile} takes care of the unpacking,\n> devel/sage-main/doc/output/latex/en/developer/developer.tex:\\code{\\$SAGE\\_ROOT/makefile} before using \\code{ptestlong}). See\n> ```\n\n\nThese are all in the *output* directory.  Could it be that you did not rebuild the pdf documentation after applying these tickets and are finding the old tex files?",
    "created_at": "2010-11-16T18:04:17Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95687",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Replying to [drkirkby](#comment%3A25):
> It looks to me there are still a few files that refer to `makefile`. Shall I create a ticket for these:
> 
> ```
> devel/sage-main/doc/output/latex/en/developer/developer.tex:Another way is to edit the file \code{makefile} in the top level Sage
> devel/sage-main/doc/output/latex/en/developer/developer.tex:After saving all changes to \code{makefile}, we can parallel test with the
> devel/sage-main/doc/output/latex/en/developer/developer.tex:these command, see the files \code{SAGE\_ROOT/makefile} and
> devel/sage-main/doc/output/latex/en/developer/developer.tex:argument \code{-long}. See the file \code{SAGE\_ROOT/makefile} for further
> devel/sage-main/doc/output/latex/en/developer/developer.tex:\code{SAGE\_ROOT/makefile} for further details.
> devel/sage-main/doc/output/latex/en/developer/developer.tex:the file \code{SAGE\_ROOT/makefile} takes care of the unpacking,
> devel/sage-main/doc/output/latex/en/developer/developer.tex:\code{\$SAGE\_ROOT/makefile} before using \code{ptestlong}). See
> ```


These are all in the *output* directory.  Could it be that you did not rebuild the pdf documentation after applying these tickets and are finding the old tex files?



---

archive/issue_comments_095688.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jdemeyer](#comment%3A26):\n\n> These are all in the *output* directory.  Could it be that you did not rebuild the pdf documentation after applying these tickets and are finding the old tex files?\n\n\nYes, it is very possible. I'm just going to build Sage again from scratch, as I've messed around with various files. But I very much doubt I built the pdfs, so that explains it. \n\nDave",
    "created_at": "2010-11-16T19:41:41Z",
    "issue": "https://github.com/sagemath/sage/issues/10156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10156#issuecomment-95688",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:27'></a>
Replying to [jdemeyer](#comment%3A26):

> These are all in the *output* directory.  Could it be that you did not rebuild the pdf documentation after applying these tickets and are finding the old tex files?


Yes, it is very possible. I'm just going to build Sage again from scratch, as I've messed around with various files. But I very much doubt I built the pdfs, so that explains it. 

Dave
