# Issue 10118: upgrade sphinx to version 1.0.4

archive/issues_010117.json:
```json
{
    "body": "As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n\n**Apply:** (starting from sage-4.6.1.alpha1)\n\n1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)\n2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)\n3. Apply [attachment:10118_sphinx_sagelib.2.patch] to the Sage library.\n4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n\nSee also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.\n\nFollow-up (p4 spkg): #10350\n\nAssignee: tbd\n\nCC:  @hivert @jhpalmieri sage-combinat @novoselt\n\nKeywords: sphinx spkg\n\nResolution: fixed\n\nAuthor: Minh Van Nguyen, Jeroen Demeyer\n\nReviewer: Jeroen Demeyer, Minh Van Nguyen\n\nMerged: sage-4.6.1.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/10118\n\n",
    "closed_at": "2010-11-28T21:58:10Z",
    "created_at": "2010-10-11T06:39:17Z",
    "labels": [
        "component: packages: standard",
        "blocker"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.1",
    "title": "upgrade sphinx to version 1.0.4",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10118",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```
As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).

**Apply:** (starting from sage-4.6.1.alpha1)

1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)
2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)
3. Apply [attachment:10118_sphinx_sagelib.2.patch] to the Sage library.
4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.

See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.

Follow-up (p4 spkg): #10350

Assignee: tbd

CC:  @hivert @jhpalmieri sage-combinat @novoselt

Keywords: sphinx spkg

Resolution: fixed

Author: Minh Van Nguyen, Jeroen Demeyer

Reviewer: Jeroen Demeyer, Minh Van Nguyen

Merged: sage-4.6.1.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/10118





---

archive/issue_comments_106777.json:
```json
{
    "body": "<a id='comment:1'></a>I think Florent Hivert mentioned possibly working on the Sphinx and Pygments packages.  Florent, did you happen to start upgrading them?",
    "created_at": "2010-10-15T21:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106777",
    "user": "https://github.com/qed777"
}
```

<a id='comment:1'></a>I think Florent Hivert mentioned possibly working on the Sphinx and Pygments packages.  Florent, did you happen to start upgrading them?



---

archive/issue_comments_106778.json:
```json
{
    "body": "<a id='comment:3'></a>Sphinx-1.0.4 works well in sage-4.5.3 and 4.6alpha3 the only problem is it break\nthe following test:\n\n```\nsage -t -force_lib \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\"\nFile \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\", line 69:\n    sage: sphinxify('A test')\nExpected:\n    '<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\nGot:\n    '\\n<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\", line 71:\n    sage: sphinxify('**Testing**\\n`monospace`')\nExpected:\n    '<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div>'\nGot:\n    '\\n<div class=\"docstring\">\\n    \\n  <p><strong>Testing</strong>\\n<span class=\"math\">monospace</span></p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\", line 73:\n    sage: sphinxify('`x=y`')\nExpected:\n    '<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\nGot:\n    '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'File \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\", line 69:\n    sage: sphinxify('A test')\nExpected:\n    '<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\nGot:\n    '\\n<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\", line 71:\n    sage: sphinxify('**Testing**\\n`monospace`')\nExpected:\n    '<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div>'\nGot:\n    '\\n<div class=\"docstring\">\\n    \\n  <p><strong>Testing</strong>\\n<span class=\"math\">monospace</span></p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py\", line 73:\n    sage: sphinxify('`x=y`')\nExpected:\n    '<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\nGot:\n    '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n```",
    "created_at": "2010-10-16T07:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106778",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>Sphinx-1.0.4 works well in sage-4.5.3 and 4.6alpha3 the only problem is it break
the following test:

```
sage -t -force_lib "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py"
File "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py", line 69:
    sage: sphinxify('A test')
Expected:
    '<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
Got:
    '\n<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
**********************************************************************
File "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py", line 71:
    sage: sphinxify('**Testing**\n`monospace`')
Expected:
    '<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div>'
Got:
    '\n<div class="docstring">\n    \n  <p><strong>Testing</strong>\n<span class="math">monospace</span></p>\n\n\n</div>'
**********************************************************************
File "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py", line 73:
    sage: sphinxify('`x=y`')
Expected:
    '<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
Got:
    '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'File "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py", line 69:
    sage: sphinxify('A test')
Expected:
    '<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
Got:
    '\n<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
**********************************************************************
File "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py", line 71:
    sage: sphinxify('**Testing**\n`monospace`')
Expected:
    '<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div>'
Got:
    '\n<div class="docstring">\n    \n  <p><strong>Testing</strong>\n<span class="math">monospace</span></p>\n\n\n</div>'
**********************************************************************
File "/usr/lib/python2.6/site-packages/sagenb/misc/sphinxify.py", line 73:
    sage: sphinxify('`x=y`')
Expected:
    '<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
Got:
    '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
```



---

archive/issue_comments_106779.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:1 mpatel]:\n> I think Florent Hivert mentioned possibly working on the Sphinx and Pygments packages.  Florent, did you happen to start upgrading them?\n\n\nHi Mitesh,\n\nI didn't had the time to work on it (and even more generally on sage) recently. My previous attempt goes back to July with version 1.0.1 and showed some difficult hard stuff but Sphinx itself seemed to bu the cause. This is very cool if they are solved with 1.0.4. There is a chance that I can find some time in the next two weeks. However, if Francois beat me, I won't complain :-)\nThe broken tests seem so be very easy to solve. My plan is then to solve #9128 (Sphinx should be aware of all.py to find its links).",
    "created_at": "2010-10-16T08:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106779",
    "user": "https://github.com/hivert"
}
```

<a id='comment:4'></a>Replying to [comment:1 mpatel]:
> I think Florent Hivert mentioned possibly working on the Sphinx and Pygments packages.  Florent, did you happen to start upgrading them?


Hi Mitesh,

I didn't had the time to work on it (and even more generally on sage) recently. My previous attempt goes back to July with version 1.0.1 and showed some difficult hard stuff but Sphinx itself seemed to bu the cause. This is very cool if they are solved with 1.0.4. There is a chance that I can find some time in the next two weeks. However, if Francois beat me, I won't complain :-)
The broken tests seem so be very easy to solve. My plan is then to solve #9128 (Sphinx should be aware of all.py to find its links).



---

archive/issue_comments_106780.json:
```json
{
    "body": "<a id='comment:5'></a>Well the situation for me is that on sage-on-gentoo we use system packages. And sphinx 1.0.4 has been marked stable so all sage-on-gentoo users were automatically updated to it. We test a number of things that way, if there is a real problem we pin sage to use a particular version.\n\nI won't beat you to it, it's kind of crunch time here (the semester and the year is ending in New Zealand with all that implies in terms of marking).",
    "created_at": "2010-10-16T09:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106780",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>Well the situation for me is that on sage-on-gentoo we use system packages. And sphinx 1.0.4 has been marked stable so all sage-on-gentoo users were automatically updated to it. We test a number of things that way, if there is a real problem we pin sage to use a particular version.

I won't beat you to it, it's kind of crunch time here (the semester and the year is ending in New Zealand with all that implies in terms of marking).



---

archive/issue_comments_106781.json:
```json
{
    "body": "<a id='comment:6'></a>Can someone post a spkg for this? I can try to review, but I need something to review...",
    "created_at": "2010-11-05T10:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106781",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:6'></a>Can someone post a spkg for this? I can try to review, but I need something to review...



---

archive/issue_comments_106782.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 ddrake]:\n> Can someone post a spkg for this? I can try to review, but I need something to review...\n\n\nI'm currently (just taking a break to answer your comment) working on an upgraded Sphinx package.",
    "created_at": "2010-11-05T10:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106782",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:7'></a>Replying to [comment:6 ddrake]:
> Can someone post a spkg for this? I can try to review, but I need something to review...


I'm currently (just taking a break to answer your comment) working on an upgraded Sphinx package.



---

archive/issue_comments_106783.json:
```json
{
    "body": "Attachment [trac-10118_sphinx-spkg.patch](tarball://root/attachments/some-uuid/ticket10118/trac-10118_sphinx-spkg.patch) by mvngu created at 2010-11-08 16:43:49",
    "created_at": "2010-11-08T16:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106783",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Attachment [trac-10118_sphinx-spkg.patch](tarball://root/attachments/some-uuid/ticket10118/trac-10118_sphinx-spkg.patch) by mvngu created at 2010-11-08 16:43:49



---

archive/issue_comments_106784.json:
```json
{
    "body": "Attachment [trac-10118_sagenb.patch](tarball://root/attachments/some-uuid/ticket10118/trac-10118_sagenb.patch) by mvngu created at 2010-11-08 16:59:44",
    "created_at": "2010-11-08T16:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106784",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Attachment [trac-10118_sagenb.patch](tarball://root/attachments/some-uuid/ticket10118/trac-10118_sagenb.patch) by mvngu created at 2010-11-08 16:59:44



---

archive/issue_comments_106785.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-11-08T17:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106785",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_106786.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,11 @@\n As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n+\n+**Apply:**\n+\n+1. Prerequisite: #9850.\n+2. The upgraded Sphinx package at http://sage.math.washington.edu/home/mvngu/spkg/standard/sphinx/sphinx-1.0.4.p0.spkg. For reference, my patch for that spkg is [attachment:trac-10118_sphinx-spkg.patch], but do not apply that patch; it's already applied to the upgraded spkg.\n+3. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.\n+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n \n Comment: 1\n \n``````\n",
    "created_at": "2010-11-08T17:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106786",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,11 @@
 As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).
+
+**Apply:**
+
+1. Prerequisite: #9850.
+2. The upgraded Sphinx package at http://sage.math.washington.edu/home/mvngu/spkg/standard/sphinx/sphinx-1.0.4.p0.spkg. For reference, my patch for that spkg is [attachment:trac-10118_sphinx-spkg.patch], but do not apply that patch; it's already applied to the upgraded spkg.
+3. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.
+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.
 
 Comment: 1
 
``````




---

archive/issue_comments_106787.json:
```json
{
    "body": "<a id='comment:8'></a>See the ticket description for instructions on which patch/spkg to apply. Here are the results of my testing.\n\n* bsd.math -- Both the HTML and PDF versions of the documentation built OK.\n\n* cicero.skynet -- The HTML version of the documentation built OK, with numerous warnings regarding a missing LaTeX installation. This also meant that I can't build the PDF version of the documentation.\n\n* cleo.skynet -- Sage 4.6.1.alpha0 fails to build on this machine, hence can't test building the documentation.\n\n* eno.skynet -- The HTML version of the documentation built OK, with numerous warnings regarding a missing LaTeX installation. This also meant that I can't build the PDF version of the documentation.\n\n* flavius.skynet -- The PDF version of the documentation built fine. The HTML version built with numerous warnings due to missing the dvipng command.\n\n* gcc11 -- The HTML documentation built OK, with some warnings due to an incomplete LaTeX installation. Can't build the PDF version of the documentation due to this reason.\n\n* gcc16 -- The HTML documentation built OK, with some warnings due to an incomplete LaTeX installation. Can't build the PDF version of the documentation due to this reason.\n\n* hawk (David Kirkby's OpenSolaris box) -- Both the PDF and HTML versions of the documentation built fine.\n\n* iras.skynet -- Sage 4.6.1.alpha0 fails to build on this machine, hence can't test building the documentation.\n\n* lena.skynet -- The HTML version of the documentation built OK, with numerous warnings about a missing LaTeX installation, hence cannot parse math expressions typeset using LaTeX. The missing LaTeX installation also prevents us from building the PDF version of the documentation.\n\n* rh.math -- Has a LaTeX installation, but missing utf8x.def, hence unable to successfully build the PDF version of the documentation. The HTML version of the documentation built with numerous warnings due to missing utf8x.def.\n\n* rosemary.math -- Sage 4.6.1.alpha0 fails to build on this machine, hence can't test building the standard documentation.\n\n* sage.math -- Both the HTML and PDF versions of the documentation built fine.\n\n* sextus.skynet -- The HTML version of the documentation built OK, with numerous warnings about a missing LaTeX installation, hence cannot parse math expressions typeset using LaTeX. The missing LaTeX installation also prevents us from building the PDF version of the documentation.\n\n* taurus.skynet -- The HTML documentation built fine. This machine doesn't have a LaTeX installation, so I can't build the PDF version of the documentation.\n\nWhat the above tests mean is that the HTML documentation can be built without a LaTeX installation, but the resulting documentation would not render LaTeX typeset math expressions. For best result, you should install a LaTeX distribution on your system before building the Sage documentation. Of course, when you compile Sage, the configure script that is first run does warn about having a LaTeX installation if your system doesn't already have a LaTeX installation.\n\n\n\nI'm CC'ing the sage-combinat team because [attachment:trac-10118_sage-lib.patch] touches files in the combinatorics module.",
    "created_at": "2010-11-08T17:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106787",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:8'></a>See the ticket description for instructions on which patch/spkg to apply. Here are the results of my testing.

* bsd.math -- Both the HTML and PDF versions of the documentation built OK.

* cicero.skynet -- The HTML version of the documentation built OK, with numerous warnings regarding a missing LaTeX installation. This also meant that I can't build the PDF version of the documentation.

* cleo.skynet -- Sage 4.6.1.alpha0 fails to build on this machine, hence can't test building the documentation.

* eno.skynet -- The HTML version of the documentation built OK, with numerous warnings regarding a missing LaTeX installation. This also meant that I can't build the PDF version of the documentation.

* flavius.skynet -- The PDF version of the documentation built fine. The HTML version built with numerous warnings due to missing the dvipng command.

* gcc11 -- The HTML documentation built OK, with some warnings due to an incomplete LaTeX installation. Can't build the PDF version of the documentation due to this reason.

* gcc16 -- The HTML documentation built OK, with some warnings due to an incomplete LaTeX installation. Can't build the PDF version of the documentation due to this reason.

* hawk (David Kirkby's OpenSolaris box) -- Both the PDF and HTML versions of the documentation built fine.

* iras.skynet -- Sage 4.6.1.alpha0 fails to build on this machine, hence can't test building the documentation.

* lena.skynet -- The HTML version of the documentation built OK, with numerous warnings about a missing LaTeX installation, hence cannot parse math expressions typeset using LaTeX. The missing LaTeX installation also prevents us from building the PDF version of the documentation.

* rh.math -- Has a LaTeX installation, but missing utf8x.def, hence unable to successfully build the PDF version of the documentation. The HTML version of the documentation built with numerous warnings due to missing utf8x.def.

* rosemary.math -- Sage 4.6.1.alpha0 fails to build on this machine, hence can't test building the standard documentation.

* sage.math -- Both the HTML and PDF versions of the documentation built fine.

* sextus.skynet -- The HTML version of the documentation built OK, with numerous warnings about a missing LaTeX installation, hence cannot parse math expressions typeset using LaTeX. The missing LaTeX installation also prevents us from building the PDF version of the documentation.

* taurus.skynet -- The HTML documentation built fine. This machine doesn't have a LaTeX installation, so I can't build the PDF version of the documentation.

What the above tests mean is that the HTML documentation can be built without a LaTeX installation, but the resulting documentation would not render LaTeX typeset math expressions. For best result, you should install a LaTeX distribution on your system before building the Sage documentation. Of course, when you compile Sage, the configure script that is first run does warn about having a LaTeX installation if your system doesn't already have a LaTeX installation.



I'm CC'ing the sage-combinat team because [attachment:trac-10118_sage-lib.patch] touches files in the combinatorics module.



---

archive/issue_comments_106788.json:
```json
{
    "body": "<a id='comment:10'></a>You should be able to build 4.6.1.alpha0 on cleo with `export SAGE_DEBUG=yes` (#9897, #10120).  This should also help on iras, but you'll likely also have problems with cddlib (#10204).\n\nBy the way, do you think we could add rosemary.math as a Sage Buildbot buildslave?",
    "created_at": "2010-11-08T23:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106788",
    "user": "https://github.com/qed777"
}
```

<a id='comment:10'></a>You should be able to build 4.6.1.alpha0 on cleo with `export SAGE_DEBUG=yes` (#9897, #10120).  This should also help on iras, but you'll likely also have problems with cddlib (#10204).

By the way, do you think we could add rosemary.math as a Sage Buildbot buildslave?



---

archive/issue_comments_106789.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 mpatel]:\n> By the way, do you think we could add rosemary.math as a Sage Buildbot buildslave?\n\n\nSee the following sage-devel thread for a follow-up to your question:\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/7cf390f110f6cea6",
    "created_at": "2010-11-09T07:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106789",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:11'></a>Replying to [comment:10 mpatel]:
> By the way, do you think we could add rosemary.math as a Sage Buildbot buildslave?


See the following sage-devel thread for a follow-up to your question:

http://groups.google.com/group/sage-devel/browse_thread/thread/7cf390f110f6cea6



---

archive/issue_comments_106790.json:
```json
{
    "body": "Changing keywords from \"\" to \"sphinx spkg\".",
    "created_at": "2010-11-09T08:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106790",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "sphinx spkg".



---

archive/issue_comments_106791.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:8 mvngu]:\n>  * eno.skynet -- The HTML version of the documentation built OK, with numerous warnings regarding a missing LaTeX installation. This also meant that I can't build the PDF version of the documentation.\n\n\nIf possible, I would like to see\n* See the resulting HTML of a Sphinx run without LaTeX.\n* The log file of running Sphinx without LaTeX.\n\nWould it make sense for `make doc-html` to first test whether `latex` is installed?  If there is no `latex`, give an error and don't build the documentation.",
    "created_at": "2010-11-09T08:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106791",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:8 mvngu]:
>  * eno.skynet -- The HTML version of the documentation built OK, with numerous warnings regarding a missing LaTeX installation. This also meant that I can't build the PDF version of the documentation.


If possible, I would like to see
* See the resulting HTML of a Sphinx run without LaTeX.
* The log file of running Sphinx without LaTeX.

Would it make sense for `make doc-html` to first test whether `latex` is installed?  If there is no `latex`, give an error and don't build the documentation.



---

archive/issue_comments_106792.json:
```json
{
    "body": "Attachment [dochtml.log](tarball://root/attachments/some-uuid/ticket10118/dochtml.log) by mvngu created at 2010-11-09 12:08:32",
    "created_at": "2010-11-09T12:08:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106792",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Attachment [dochtml.log](tarball://root/attachments/some-uuid/ticket10118/dochtml.log) by mvngu created at 2010-11-09 12:08:32



---

archive/issue_comments_106793.json:
```json
{
    "body": "<a id='comment:13'></a>Attachment [docpdf.log](tarball://root/attachments/some-uuid/ticket10118/docpdf.log) by mvngu created at 2010-11-09 12:21:22\n\nReplying to [comment:12 jdemeyer]:\n> If possible, I would like to see\n> * See the resulting HTML of a Sphinx run without LaTeX.\n\n\nSee the URL\n\nhttp://mvngu.googlecode.com/hg/10118-sphinx/en/index.html\n\n\n\n\n>  * The log file of running Sphinx without LaTeX.\n\n\nSee the log files:\n\n1. [attachment:dochtml.log]\n2. [attachment:docpdf.log]\n\n\n\n> Would it make sense for `make doc-html` to first test whether `latex` is installed?  If there is no `latex`, give an error and don't build the documentation.\n\n\nThat would result in a user, whose system doesn't have LaTeX but can compile Sage OK, without at least a way to build the vast majority of the Sage standard documentation. Currently, on a system without LaTeX you could still build the HTML version of the Sage documentation, but any expressions typeset in LaTeX could not be rendered using LaTeX. This means that the documentation does build, but you won't be able to see LaTeX math expressions typeset beautifully; you can still read the corresponding LaTeX typesetting, though. However, if you build the HTML version with jsMath rendering of mathematical expressions, then you don't need LaTeX at all. The only case where you really need LaTeX is when you build the PDF version of the documentation. \n\nSo LaTeX is not necessary for building the Sage documentation. But if you don't have LaTeX, there's very little reason why the documentation builder should abort and refuse to build the HTML version of the documentation. The resulting \"broken\" HTML built documentation is still very readable; you just don't get beautifully typeset math expressions. And if you have jsMath installed, build the documentation with jsMath.",
    "created_at": "2010-11-09T12:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106793",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:13'></a>Attachment [docpdf.log](tarball://root/attachments/some-uuid/ticket10118/docpdf.log) by mvngu created at 2010-11-09 12:21:22

Replying to [comment:12 jdemeyer]:
> If possible, I would like to see
> * See the resulting HTML of a Sphinx run without LaTeX.


See the URL

http://mvngu.googlecode.com/hg/10118-sphinx/en/index.html




>  * The log file of running Sphinx without LaTeX.


See the log files:

1. [attachment:dochtml.log]
2. [attachment:docpdf.log]



> Would it make sense for `make doc-html` to first test whether `latex` is installed?  If there is no `latex`, give an error and don't build the documentation.


That would result in a user, whose system doesn't have LaTeX but can compile Sage OK, without at least a way to build the vast majority of the Sage standard documentation. Currently, on a system without LaTeX you could still build the HTML version of the Sage documentation, but any expressions typeset in LaTeX could not be rendered using LaTeX. This means that the documentation does build, but you won't be able to see LaTeX math expressions typeset beautifully; you can still read the corresponding LaTeX typesetting, though. However, if you build the HTML version with jsMath rendering of mathematical expressions, then you don't need LaTeX at all. The only case where you really need LaTeX is when you build the PDF version of the documentation. 

So LaTeX is not necessary for building the Sage documentation. But if you don't have LaTeX, there's very little reason why the documentation builder should abort and refuse to build the HTML version of the documentation. The resulting "broken" HTML built documentation is still very readable; you just don't get beautifully typeset math expressions. And if you have jsMath installed, build the documentation with jsMath.



---

archive/issue_comments_106794.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 mvngu]:\n> Replying to [comment:12 jdemeyer]:\n> > If possible, I would like to see\n> > * See the resulting HTML of a Sphinx run without LaTeX.\n\n> \n> http://mvngu.googlecode.com/hg/10118-sphinx/en/index.html\n\n\nThanks!  The output does indeed look quite readable without LaTeX installed.",
    "created_at": "2010-11-10T10:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106794",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:13 mvngu]:
> Replying to [comment:12 jdemeyer]:
> > If possible, I would like to see
> > * See the resulting HTML of a Sphinx run without LaTeX.

> 
> http://mvngu.googlecode.com/hg/10118-sphinx/en/index.html


Thanks!  The output does indeed look quite readable without LaTeX installed.



---

archive/issue_comments_106795.json:
```json
{
    "body": "<a id='comment:15'></a>I'm all in favour of making the pdf documentation actually work!\nI am preparing a .p1 package with some minor changes, hang on...",
    "created_at": "2010-11-11T21:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106795",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>I'm all in favour of making the pdf documentation actually work!
I am preparing a .p1 package with some minor changes, hang on...



---

archive/issue_comments_106796.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2010-11-11T21:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106796",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_106797.json:
```json
{
    "body": "Attachment [sphinx-1.0.4.p1.patch](tarball://root/attachments/some-uuid/ticket10118/sphinx-1.0.4.p1.patch) by @jdemeyer created at 2010-11-12 19:47:12\n\nReviewer patch, p0 to p1",
    "created_at": "2010-11-12T19:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106797",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [sphinx-1.0.4.p1.patch](tarball://root/attachments/some-uuid/ticket10118/sphinx-1.0.4.p1.patch) by @jdemeyer created at 2010-11-12 19:47:12

Reviewer patch, p0 to p1



---

archive/issue_comments_106798.json:
```json
{
    "body": "<a id='comment:16'></a>Minh, your patches look fine, I made some minor changes to `Makefile` and `spkg-install`.\n\nNew spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg)\n\nspkg patch: [attachment:sphinx-1.0.4.p1.patch]\n\nWorks on sage.math.washington.edu, it would probably be good to test on other machines too.",
    "created_at": "2010-11-12T19:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106798",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>Minh, your patches look fine, I made some minor changes to `Makefile` and `spkg-install`.

New spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg)

spkg patch: [attachment:sphinx-1.0.4.p1.patch]

Works on sage.math.washington.edu, it would probably be good to test on other machines too.



---

archive/issue_comments_106799.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,11 @@\n+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n \n+**Apply:**\n+\n+1. Prerequisite: #9850.\n+2. The upgraded Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg).\n+3. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.\n+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n \n Comment: 1\n \n``````\n",
    "created_at": "2010-11-12T19:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106799",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,11 @@
+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).
 
+**Apply:**
+
+1. Prerequisite: #9850.
+2. The upgraded Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg).
+3. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.
+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.
 
 Comment: 1
 
``````




---

archive/issue_comments_106800.json:
```json
{
    "body": "<a id='comment:17'></a>The patches look okay to me, but I've only glanced at them.  However, I don't see why the various .py files in the patches directory are in .hgignore.  I don't think this is the usual practice for spkgs.",
    "created_at": "2010-11-12T20:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106800",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>The patches look okay to me, but I've only glanced at them.  However, I don't see why the various .py files in the patches directory are in .hgignore.  I don't think this is the usual practice for spkgs.



---

archive/issue_comments_106801.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 jhpalmieri]:\n> I don't think this is the usual practice for spkgs.\n\n\nI agree that this is not the usual practice, but maybe we should make it usual practice?  (I've done it for `pari` and `ecm`)  The point is that I see absolutely no reason to put **patched** files under revision control.  Putting the **patches** (i.e. the diffs) under revision control makes sense (and that's also what I did).  One advantage is that you get smaller diffs between spkg versions.  Also the spkgs themselves should be smaller.  Putting patched files under revision control is almost the same as putting `src/` under revision control and we don't do that either...",
    "created_at": "2010-11-12T20:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106801",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>Replying to [comment:17 jhpalmieri]:
> I don't think this is the usual practice for spkgs.


I agree that this is not the usual practice, but maybe we should make it usual practice?  (I've done it for `pari` and `ecm`)  The point is that I see absolutely no reason to put **patched** files under revision control.  Putting the **patches** (i.e. the diffs) under revision control makes sense (and that's also what I did).  One advantage is that you get smaller diffs between spkg versions.  Also the spkgs themselves should be smaller.  Putting patched files under revision control is almost the same as putting `src/` under revision control and we don't do that either...



---

archive/issue_comments_106802.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 jdemeyer]:\n> Replying to [comment:17 jhpalmieri]:\n> > I don't think this is the usual practice for spkgs.\n\n> \n> I agree that this is not the usual practice, but maybe we should make it usual practice?\n\n\nI'm not sure.  I hope other people express opinions.  Is it worth discussing on sage-devel? Anyway, since it's not the usual practice, I think you should definitely document what you're doing in SPKG.txt.  When I'm working on an spkg, in general I find it very helpful to have long descriptions in SPKG.txt, not just very short summaries of what happened.\n\n(I'm also not sure why \"patches/Makefile\" has an entry in the patch file, since this file is now supposed to be untracked.)",
    "created_at": "2010-11-12T22:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106802",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>Replying to [comment:18 jdemeyer]:
> Replying to [comment:17 jhpalmieri]:
> > I don't think this is the usual practice for spkgs.

> 
> I agree that this is not the usual practice, but maybe we should make it usual practice?


I'm not sure.  I hope other people express opinions.  Is it worth discussing on sage-devel? Anyway, since it's not the usual practice, I think you should definitely document what you're doing in SPKG.txt.  When I'm working on an spkg, in general I find it very helpful to have long descriptions in SPKG.txt, not just very short summaries of what happened.

(I'm also not sure why "patches/Makefile" has an entry in the patch file, since this file is now supposed to be untracked.)



---

archive/issue_comments_106803.json:
```json
{
    "body": "<a id='comment:20'></a>By the way, the hg repo is not clean:\n\n```\n$ hg status\n? .SPKG.txt.swp\n```",
    "created_at": "2010-11-12T23:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106803",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>By the way, the hg repo is not clean:

```
$ hg status
? .SPKG.txt.swp
```



---

archive/issue_comments_106804.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:19 jhpalmieri]:\n> (I'm also not sure why \"patches/Makefile\" has an entry in the patch file, since this file is now supposed to be untracked.)\n\nDoing a `hg forget` did the trick.",
    "created_at": "2010-11-13T13:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106804",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Replying to [comment:19 jhpalmieri]:
> (I'm also not sure why "patches/Makefile" has an entry in the patch file, since this file is now supposed to be untracked.)

Doing a `hg forget` did the trick.



---

archive/issue_comments_106805.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:20 jhpalmieri]:\n> By the way, the hg repo is not clean:\n> \n> ```\n> $ hg status\n> ? .SPKG.txt.swp\n> ```\n\n\nFixed, spkg in same place.",
    "created_at": "2010-11-13T13:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106805",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>Replying to [comment:20 jhpalmieri]:
> By the way, the hg repo is not clean:
> 
> ```
> $ hg status
> ? .SPKG.txt.swp
> ```


Fixed, spkg in same place.



---

archive/issue_comments_106806.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n \n+**Apply:** (starting from sage-4.6.1.alpha1)\n+\n+1. The upgraded Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg) (or [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p2.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p2.spkg) which uses *patch* and depends on #9418).\n+2. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.\n+3. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n \n Comment: 1\n \n``````\n",
    "created_at": "2010-11-15T11:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106806",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).
 
+**Apply:** (starting from sage-4.6.1.alpha1)
+
+1. The upgraded Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p1.spkg) (or [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p2.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p2.spkg) which uses *patch* and depends on #9418).
+2. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.
+3. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.
 
 Comment: 1
 
``````




---

archive/issue_comments_106807.json:
```json
{
    "body": "<a id='comment:24'></a>For what it's worth: build html and pdf documentation of sage-4.6.1.alpha1 with only the following Sphinx WARNINGS:\n\n```\nwriting... /mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/en/tutorial/introduction.rst:: WARNING: unusable reference target found: ../installation/index.html\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/en/tutorial/sagetex.rst:: WARNING: unusable reference target found: ../installation/index.html\nwriting... /mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/en/faq/faq-usage.rst:: WARNING: unusable reference target found: about:plugins\nwriting... /mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/fr/tutorial/introduction.rst:: WARNING: unusable reference target found: ../../en/installation/index.html\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/fr/tutorial/sagetex.rst:: WARNING: unusable reference target found: ../../en/installation/index.html\n```",
    "created_at": "2010-11-15T23:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106807",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>For what it's worth: build html and pdf documentation of sage-4.6.1.alpha1 with only the following Sphinx WARNINGS:

```
writing... /mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/en/tutorial/introduction.rst:: WARNING: unusable reference target found: ../installation/index.html
/mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/en/tutorial/sagetex.rst:: WARNING: unusable reference target found: ../installation/index.html
writing... /mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/en/faq/faq-usage.rst:: WARNING: unusable reference target found: about:plugins
writing... /mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/fr/tutorial/introduction.rst:: WARNING: unusable reference target found: ../../en/installation/index.html
/mnt/usb1/scratch/jdemeyer/merger/sage-4.6.1.alpha2/devel/sage/doc/fr/tutorial/sagetex.rst:: WARNING: unusable reference target found: ../../en/installation/index.html
```



---

archive/issue_comments_106808.json:
```json
{
    "body": "<a id='comment:25'></a>On one particular Linux system, I get the following error during `make doc-html`:\n\n```\nlooking for now-outdated files... none found\npickling environment... done\nchecking consistency... done\npreparing documents... done\nwriting output... [  0%] algebras\nwriting output... [  0%] arithgroup\nWARNING: display latex u'{\\\\rm SL}_2(\\\\ZZ)': latex exited with error:\n[stderr]\n\n[stdout]\nThis is pdfTeXk, Version 3.1415926-1.40.9 (Web2C 7.5.7)\n %&-line parsing enabled.\nentering extended mode\n(./math.tex\nLaTeX2e <2005/12/01>\nBabel <v3.8l> and hyphenation patterns for english, usenglishmax, dumylang, noh\nyphenation, loaded.\n(/usr/share/texmf-dist/tex/latex/base/article.cls\nDocument Class: article 2005/09/16 v1.4f Standard LaTeX document class\n(/usr/share/texmf-dist/tex/latex/base/size12.clo))\n(/usr/share/texmf-dist/tex/latex/base/inputenc.sty\n\n! LaTeX Error: File `utf8x.def' not found.\n\nType X to quit or <RETURN> to proceed,\nor enter new name. (Default extension: def)\n\nEnter file name:\n! Emergency stop.\n<read *>\n\nl.128 \\endinput\n               ^^M\nNo pages of output.\nTranscript written on math.log.\n```\n\nSo it seems that the new Sphinx needs a more recent LaTeX installation with `utf8x.def`.",
    "created_at": "2010-11-17T08:29:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106808",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>On one particular Linux system, I get the following error during `make doc-html`:

```
looking for now-outdated files... none found
pickling environment... done
checking consistency... done
preparing documents... done
writing output... [  0%] algebras
writing output... [  0%] arithgroup
WARNING: display latex u'{\\rm SL}_2(\\ZZ)': latex exited with error:
[stderr]

[stdout]
This is pdfTeXk, Version 3.1415926-1.40.9 (Web2C 7.5.7)
 %&-line parsing enabled.
entering extended mode
(./math.tex
LaTeX2e <2005/12/01>
Babel <v3.8l> and hyphenation patterns for english, usenglishmax, dumylang, noh
yphenation, loaded.
(/usr/share/texmf-dist/tex/latex/base/article.cls
Document Class: article 2005/09/16 v1.4f Standard LaTeX document class
(/usr/share/texmf-dist/tex/latex/base/size12.clo))
(/usr/share/texmf-dist/tex/latex/base/inputenc.sty

! LaTeX Error: File `utf8x.def' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: def)

Enter file name:
! Emergency stop.
<read *>

l.128 \endinput
               ^^M
No pages of output.
Transcript written on math.log.
```

So it seems that the new Sphinx needs a more recent LaTeX installation with `utf8x.def`.



---

archive/issue_comments_106809.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:25 jdemeyer]:\n> So it seems that the new Sphinx needs a more recent LaTeX installation with `utf8x.def`.\n\n\nhum... unicode support. Is this linux system still using tetex?",
    "created_at": "2010-11-17T08:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106809",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'></a>Replying to [comment:25 jdemeyer]:
> So it seems that the new Sphinx needs a more recent LaTeX installation with `utf8x.def`.


hum... unicode support. Is this linux system still using tetex?



---

archive/issue_comments_106810.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 fbissey]:\n> hum... unicode support. Is this linux system still using tetex?\n\n\nYes (I know it's outdated but probably still widely spread).",
    "created_at": "2010-11-17T09:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106810",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Replying to [comment:26 fbissey]:
> hum... unicode support. Is this linux system still using tetex?


Yes (I know it's outdated but probably still widely spread).



---

archive/issue_comments_106811.json:
```json
{
    "body": "<a id='comment:28'></a>Hmm, sphinx-0.6.3 uses\n\n```\n\\usepackage[utf8]{inputenc}\n```\nwhich works with that particular tetex installation.\n\nsphinx-1.0.4 uses\n\n```\n\\usepackage[utf8x]{inputenc}\n```\n\nAnybody knows the difference (and would it make sense to patch sphinx to use utf8 instead of utf8x)?",
    "created_at": "2010-11-17T10:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106811",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>Hmm, sphinx-0.6.3 uses

```
\usepackage[utf8]{inputenc}
```
which works with that particular tetex installation.

sphinx-1.0.4 uses

```
\usepackage[utf8x]{inputenc}
```

Anybody knows the difference (and would it make sense to patch sphinx to use utf8 instead of utf8x)?



---

archive/issue_comments_106812.json:
```json
{
    "body": "<a id='comment:29'></a>According to [stackoverflow](http://stackoverflow.com/questions/1797841/icelandic-utf8-and-utf8x-in-latex), \n\n```\nutf8 is \"supported\" by the LaTeX team and covers a fairly specific/limited range \nof unicode input characters. It only defines those symbols that are known to be \navailable with the current font encoding.\n\nutf8x, AFAIK, is no longer supported, but covers a much broader range of input \nsymbols. I would recommend only trying it if utf8 doesn't do what you need.\n```\nWe also discussed this for Sage at #8036.  In fact, is the difference really in Sphinx 1.0.4?  In SAGE_ROOT/devel/sage/doc/common/conf.py, we have the line\n\n```\nlatex_elements['inputenc'] = '\\\\usepackage[utf8x]{inputenc}'\n```\nadded by #8036.  I wonder why this doesn't cause you problems on that particular linux system.",
    "created_at": "2010-11-17T15:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106812",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:29'></a>According to [stackoverflow](http://stackoverflow.com/questions/1797841/icelandic-utf8-and-utf8x-in-latex), 

```
utf8 is "supported" by the LaTeX team and covers a fairly specific/limited range 
of unicode input characters. It only defines those symbols that are known to be 
available with the current font encoding.

utf8x, AFAIK, is no longer supported, but covers a much broader range of input 
symbols. I would recommend only trying it if utf8 doesn't do what you need.
```
We also discussed this for Sage at #8036.  In fact, is the difference really in Sphinx 1.0.4?  In SAGE_ROOT/devel/sage/doc/common/conf.py, we have the line

```
latex_elements['inputenc'] = '\\usepackage[utf8x]{inputenc}'
```
added by #8036.  I wonder why this doesn't cause you problems on that particular linux system.



---

archive/issue_comments_106813.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:29 jhpalmieri]:\n> We also discussed this for Sage at #8036.  In fact, is the difference really in Sphinx 1.0.4?  In SAGE_ROOT/devel/sage/doc/common/conf.py, we have the line\n> \n> ```\n> latex_elements['inputenc'] = '\\\\usepackage[utf8x]{inputenc}'\n> ```\n> added by #8036.  I wonder why this doesn't cause you problems on that particular linux system.\n\n\nAre we sure that line is actually used?  Probably not I guess.  Because `locate utf8x` returns nothing on this system, so `utf8x` cannot possibly work (but building the HTML documentation works).",
    "created_at": "2010-11-17T18:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106813",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>Replying to [comment:29 jhpalmieri]:
> We also discussed this for Sage at #8036.  In fact, is the difference really in Sphinx 1.0.4?  In SAGE_ROOT/devel/sage/doc/common/conf.py, we have the line
> 
> ```
> latex_elements['inputenc'] = '\\usepackage[utf8x]{inputenc}'
> ```
> added by #8036.  I wonder why this doesn't cause you problems on that particular linux system.


Are we sure that line is actually used?  Probably not I guess.  Because `locate utf8x` returns nothing on this system, so `utf8x` cannot possibly work (but building the HTML documentation works).



---

archive/issue_comments_106814.json:
```json
{
    "body": "<a id='comment:31'></a>By the way, that system actually uses texlive, not tetex (Gentoo `dev-texlive/texlive-latex-2008-r2` to be precise).",
    "created_at": "2010-11-17T18:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106814",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>By the way, that system actually uses texlive, not tetex (Gentoo `dev-texlive/texlive-latex-2008-r2` to be precise).



---

archive/issue_comments_106815.json:
```json
{
    "body": "<a id='comment:32'></a>Oh, sorry, my mistake.  The line I mentioned does get used when producing the latex/PDF docs, but not the html.  For the html docs, the file pngmath.py (in sphinx/ext) has been changed from the old version of Sphinx to use utf8x instead of utf8.  We could try a patch like this:\n\n```diff\n--- ../src/sphinx/ext/pngmath.py\t2010-07-24 03:07:36.000000000 -0700\n+++ pngmath.py\t2010-11-17 10:20:51.000000000 -0800\n@@ -34,7 +34,7 @@\n \n DOC_HEAD = r'''\n \\documentclass[12pt]{article}\n-\\usepackage[utf8x]{inputenc}\n+\\usepackage[utf8]{inputenc}\n \\usepackage{amsmath}\n \\usepackage{amsthm}\n \\usepackage{amssymb}\n```\nIt also might be worth investigating why the Sphinx people changed this in the first place.",
    "created_at": "2010-11-17T18:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106815",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>Oh, sorry, my mistake.  The line I mentioned does get used when producing the latex/PDF docs, but not the html.  For the html docs, the file pngmath.py (in sphinx/ext) has been changed from the old version of Sphinx to use utf8x instead of utf8.  We could try a patch like this:

```diff
--- ../src/sphinx/ext/pngmath.py	2010-07-24 03:07:36.000000000 -0700
+++ pngmath.py	2010-11-17 10:20:51.000000000 -0800
@@ -34,7 +34,7 @@
 
 DOC_HEAD = r'''
 \documentclass[12pt]{article}
-\usepackage[utf8x]{inputenc}
+\usepackage[utf8]{inputenc}
 \usepackage{amsmath}
 \usepackage{amsthm}
 \usepackage{amssymb}
```
It also might be worth investigating why the Sphinx people changed this in the first place.



---

archive/issue_comments_106816.json:
```json
{
    "body": "<a id='comment:33'></a>The change in Sphinx is documented [here](http://bitbucket.org/birkenfeld/sphinx/changeset/82508227409c).  It was patched to allow people to use unicode characters (like a unicode \"not equals\" sign, rather than using \\neq) in math and have them typeset correctly.",
    "created_at": "2010-11-17T18:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106816",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:33'></a>The change in Sphinx is documented [here](http://bitbucket.org/birkenfeld/sphinx/changeset/82508227409c).  It was patched to allow people to use unicode characters (like a unicode "not equals" sign, rather than using \neq) in math and have them typeset correctly.



---

archive/issue_comments_106817.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:32 jhpalmieri]:\n> Oh, sorry, my mistake.  The line I mentioned does get used when producing the latex/PDF docs, but not the html.  For the html docs, the file pngmath.py (in sphinx/ext) has been changed from the old version of Sphinx to use utf8x instead of utf8.  We could try a patch like this:\n> \n> ```\n> #!diff\n> --- ../src/sphinx/ext/pngmath.py\t2010-07-24 03:07:36.000000000 -0700\n> +++ pngmath.py\t2010-11-17 10:20:51.000000000 -0800\n> @@ -34,7 +34,7 @@\n>  \n>  DOC_HEAD = r'''\n>  \\documentclass[12pt]{article}\n> -\\usepackage[utf8x]{inputenc}\n> +\\usepackage[utf8]{inputenc}\n>  \\usepackage{amsmath}\n>  \\usepackage{amsthm}\n>  \\usepackage{amssymb}\n> ```\n> It also might be worth investigating why the Sphinx people changed this in the first place.\n\n\nSounds like a good idea.  I will try it when I have time.",
    "created_at": "2010-11-17T18:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106817",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>Replying to [comment:32 jhpalmieri]:
> Oh, sorry, my mistake.  The line I mentioned does get used when producing the latex/PDF docs, but not the html.  For the html docs, the file pngmath.py (in sphinx/ext) has been changed from the old version of Sphinx to use utf8x instead of utf8.  We could try a patch like this:
> 
> ```
> #!diff
> --- ../src/sphinx/ext/pngmath.py	2010-07-24 03:07:36.000000000 -0700
> +++ pngmath.py	2010-11-17 10:20:51.000000000 -0800
> @@ -34,7 +34,7 @@
>  
>  DOC_HEAD = r'''
>  \documentclass[12pt]{article}
> -\usepackage[utf8x]{inputenc}
> +\usepackage[utf8]{inputenc}
>  \usepackage{amsmath}
>  \usepackage{amsthm}
>  \usepackage{amssymb}
> ```
> It also might be worth investigating why the Sphinx people changed this in the first place.


Sounds like a good idea.  I will try it when I have time.



---

archive/issue_comments_106818.json:
```json
{
    "body": "Attachment [10118_sphinx_sagelib.patch](tarball://root/attachments/some-uuid/ticket10118/10118_sphinx_sagelib.patch) by @jdemeyer created at 2010-11-18 09:20:02",
    "created_at": "2010-11-18T09:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106818",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [10118_sphinx_sagelib.patch](tarball://root/attachments/some-uuid/ticket10118/10118_sphinx_sagelib.patch) by @jdemeyer created at 2010-11-18 09:20:02



---

archive/issue_comments_106819.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-11-18T13:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106819",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_106820.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n \n+**Apply:** (starting from sage-4.6.1.alpha1)\n+\n+1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)\n+2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)\n+3. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.\n+4. Apply [attachment:10118_sphinx_sagelib.patch] to the Sage library.\n+5. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n+\n+See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.\n \n Comment: 1\n \n``````\n",
    "created_at": "2010-11-18T22:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106820",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).
 
+**Apply:** (starting from sage-4.6.1.alpha1)
+
+1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)
+2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)
+3. Apply [attachment:trac-10118_sage-lib.patch] to the Sage library.
+4. Apply [attachment:10118_sphinx_sagelib.patch] to the Sage library.
+5. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.
+
+See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.
 
 Comment: 1
 
``````




---

archive/issue_comments_106821.json:
```json
{
    "body": "Attachment [10118_sphinx_sagelib.2.patch](tarball://root/attachments/some-uuid/ticket10118/10118_sphinx_sagelib.2.patch) by @jdemeyer created at 2010-11-18 22:18:02\n\nSage library patch, replaces trac-10118_sage-lib.patch",
    "created_at": "2010-11-18T22:18:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106821",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [10118_sphinx_sagelib.2.patch](tarball://root/attachments/some-uuid/ticket10118/10118_sphinx_sagelib.2.patch) by @jdemeyer created at 2010-11-18 22:18:02

Sage library patch, replaces trac-10118_sage-lib.patch



---

archive/issue_comments_106822.json:
```json
{
    "body": "<a id='comment:37'></a>Minh, I removed your hunk removing `(`this link <../../installation/index.html>`_ should take you to a local copy of the installation guide).` because\n1. I like the local link, I think we should try to keep it.\n2. There are other places in the documentation with the same problem, so we might as well fix them all at once in one ticket.",
    "created_at": "2010-11-18T22:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106822",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>Minh, I removed your hunk removing `(`this link <../../installation/index.html>`_ should take you to a local copy of the installation guide).` because
1. I like the local link, I think we should try to keep it.
2. There are other places in the documentation with the same problem, so we might as well fix them all at once in one ticket.



---

archive/issue_comments_106823.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n \n+**Apply:** (starting from sage-4.6.1.alpha1)\n+\n+1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)\n+2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)\n+3. Apply [attachment:10118_sphinx_sagelib.2.patch] to the Sage library.\n+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n+\n+See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.\n \n Comment: 1\n \n``````\n",
    "created_at": "2010-11-18T22:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106823",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,13 @@
+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).
 
+**Apply:** (starting from sage-4.6.1.alpha1)
+
+1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)
+2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)
+3. Apply [attachment:10118_sphinx_sagelib.2.patch] to the Sage library.
+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.
+
+See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.
 
 Comment: 1
 
``````




---

archive/issue_comments_106824.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-11-19T07:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106824",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_106825.json:
```json
{
    "body": "Attachment [sphinx-1.0.4.p3.patch](tarball://root/attachments/some-uuid/ticket10118/sphinx-1.0.4.p3.patch) by @jdemeyer created at 2010-11-19 07:50:53\n\nPatch from p0 to p3, for review",
    "created_at": "2010-11-19T07:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106825",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [sphinx-1.0.4.p3.patch](tarball://root/attachments/some-uuid/ticket10118/sphinx-1.0.4.p3.patch) by @jdemeyer created at 2010-11-19 07:50:53

Patch from p0 to p3, for review



---

archive/issue_comments_106826.json:
```json
{
    "body": "<a id='comment:39'></a>Attachment [trac-10118_use-utf8.patch](tarball://root/attachments/some-uuid/ticket10118/trac-10118_use-utf8.patch) by mvngu created at 2010-11-27 23:51:26\n\nHere are some trivial problems in the file `SPKG.txt` of version \".p3\" of the Sphinx package:\n\n* In the section\n\n```\n## Dependencies\n\nThis depends on Jinja >= 2, Pygments >= 0.8, and docutils >= 0.4.\n```\n we should have \"Pygments >= 1.3.1\" due to ticket #10290. But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.\n\n* In the section\n\n```\n* patches/pngmath.patch: This replaces \\usepackage[utf8x]{inputenc}\n  by \\usepackage[utf8]{inputenc} in the LaTeX preamble for building\n  images in the HTML documentation.  This change is done because some\n  LaTeX installations have only utf8, not utf8x (utf8x adds support for\n  much more Unicode characters, but these are needed used to typeset the\n  mathematics in the Sage documentation).\n```\n the fragment\n {{{\nbut these are needed used to typeset the\n }}}\n should be changed to\n {{{\nbut these are used to typeset the\n }}}\n\nTested on the following platforms:\n\n* {sage.math, bsd.math, hawk}: Both HTML and PDF versions of documentation built OK. For the PDF version, building the reference manual produced some warnings about \"unusable reference target\", which are to do with relative links to other documents in the Sage standard documentation.\n\n* {cleo, iras}.skynet: Sage 4.6.1.alpha2 fails to build on this machine, hence the documentation doesn't get built at all.\n \n* {cicero, eno, lena, sextus, taurus, t2}: The HTML version of the documentation mostly built OK, but with warnings about a missing LaTeX installation. Consequently, the PDF version of the documentation can't be built.\n\n* flavius.skynet -- The PDF version of the documentation built fine, but with some warnings about unusable relative links. The HTML version built with numerous warnings due to missing the dvipng command.\n\n* {gcc11, gcc16}.fsffrance.org: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command \"dvipng\". This machine has a LaTeX installation, but it is missing the file titlesec.sty, hence building the PDF version of any document in the standard documentation would hang at the error message:\n {{{\nStyle option: `fancybox' v1.3 <2000/09/19> (tvz)\n)\n\n! LaTeX Error: File `titlesec.sty' not found.\n\nType X to quit or <RETURN> to proceed,\nor enter new name. (Default extension: sty)\n }}}\n\n* rh.math: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command \"dvipng\". This means that LaTeX typesetting does not render at all in the HTML version. This machine has a LaTeX installation, but it is missing the file utf8x.def, hence building any document in the standard documentation would hang at the error message that prompts for utf8x.def. Note that we have the patch\n {{{#!diff\ndiff -r -u src.old/sphinx/ext/pngmath.py src/sphinx/ext/pngmath.py              \n--- src/sphinx/ext/pngmath.py   2010-07-24 12:07:36.000000000 +0200             \n+++ src/sphinx/ext/pngmath.py   2010-11-18 09:38:05.428635584 +0100             \n`@``@` -34,7 +34,7 `@``@`\n                                                                                \n DOC_HEAD = r'''                                                                \n \\documentclass[12pt]{article}                                                  \n-\\usepackage[utf8x]{inputenc}                                                   \n+\\usepackage[utf8]{inputenc}                                                    \n \\usepackage{amsmath}                                                           \n \\usepackage{amsthm}                                                            \n \\usepackage{amssymb}\n }}}\n to use only utf8 instead of utf8x. The same change needs to be made to the file `doc/common/conf.py`. See my reviewer patch [attachment:trac-10118_use-utf8.patch]. With this patch, we get pass the issue of the missing utf8x.def, but we now run into the following error:\n {{{\nStyle option: `fancybox' v1.3 <2000/09/19> (tvz)\n)\n\n! LaTeX Error: File `titlesec.sty' not found.\n\nType X to quit or <RETURN> to proceed,\nor enter new name. (Default extension: sty)\n }}}\n \nSo here are two choices:\n\n1. Accept `sphinx-1.0.4.p3.spkg` as is. I'm OK with that package. The issues I pointed out above can be addressed in a follow-up ticket.\n2. Fix the above issues in the current ticket.",
    "created_at": "2010-11-27T23:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106826",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:39'></a>Attachment [trac-10118_use-utf8.patch](tarball://root/attachments/some-uuid/ticket10118/trac-10118_use-utf8.patch) by mvngu created at 2010-11-27 23:51:26

Here are some trivial problems in the file `SPKG.txt` of version ".p3" of the Sphinx package:

* In the section

```
## Dependencies

This depends on Jinja >= 2, Pygments >= 0.8, and docutils >= 0.4.
```
 we should have "Pygments >= 1.3.1" due to ticket #10290. But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.

* In the section

```
* patches/pngmath.patch: This replaces \usepackage[utf8x]{inputenc}
  by \usepackage[utf8]{inputenc} in the LaTeX preamble for building
  images in the HTML documentation.  This change is done because some
  LaTeX installations have only utf8, not utf8x (utf8x adds support for
  much more Unicode characters, but these are needed used to typeset the
  mathematics in the Sage documentation).
```
 the fragment
 {{{
but these are needed used to typeset the
 }}}
 should be changed to
 {{{
but these are used to typeset the
 }}}

Tested on the following platforms:

* {sage.math, bsd.math, hawk}: Both HTML and PDF versions of documentation built OK. For the PDF version, building the reference manual produced some warnings about "unusable reference target", which are to do with relative links to other documents in the Sage standard documentation.

* {cleo, iras}.skynet: Sage 4.6.1.alpha2 fails to build on this machine, hence the documentation doesn't get built at all.
 
* {cicero, eno, lena, sextus, taurus, t2}: The HTML version of the documentation mostly built OK, but with warnings about a missing LaTeX installation. Consequently, the PDF version of the documentation can't be built.

* flavius.skynet -- The PDF version of the documentation built fine, but with some warnings about unusable relative links. The HTML version built with numerous warnings due to missing the dvipng command.

* {gcc11, gcc16}.fsffrance.org: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command "dvipng". This machine has a LaTeX installation, but it is missing the file titlesec.sty, hence building the PDF version of any document in the standard documentation would hang at the error message:
 {{{
Style option: `fancybox' v1.3 <2000/09/19> (tvz)
)

! LaTeX Error: File `titlesec.sty' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: sty)
 }}}

* rh.math: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command "dvipng". This means that LaTeX typesetting does not render at all in the HTML version. This machine has a LaTeX installation, but it is missing the file utf8x.def, hence building any document in the standard documentation would hang at the error message that prompts for utf8x.def. Note that we have the patch
 {{{#!diff
diff -r -u src.old/sphinx/ext/pngmath.py src/sphinx/ext/pngmath.py              
--- src/sphinx/ext/pngmath.py   2010-07-24 12:07:36.000000000 +0200             
+++ src/sphinx/ext/pngmath.py   2010-11-18 09:38:05.428635584 +0100             
`@``@` -34,7 +34,7 `@``@`
                                                                                
 DOC_HEAD = r'''                                                                
 \documentclass[12pt]{article}                                                  
-\usepackage[utf8x]{inputenc}                                                   
+\usepackage[utf8]{inputenc}                                                    
 \usepackage{amsmath}                                                           
 \usepackage{amsthm}                                                            
 \usepackage{amssymb}
 }}}
 to use only utf8 instead of utf8x. The same change needs to be made to the file `doc/common/conf.py`. See my reviewer patch [attachment:trac-10118_use-utf8.patch]. With this patch, we get pass the issue of the missing utf8x.def, but we now run into the following error:
 {{{
Style option: `fancybox' v1.3 <2000/09/19> (tvz)
)

! LaTeX Error: File `titlesec.sty' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: sty)
 }}}
 
So here are two choices:

1. Accept `sphinx-1.0.4.p3.spkg` as is. I'm OK with that package. The issues I pointed out above can be addressed in a follow-up ticket.
2. Fix the above issues in the current ticket.



---

archive/issue_comments_106827.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).\n \n+**Apply:** (starting from sage-4.6.1.alpha1)\n+\n+1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)\n+2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)\n+3. Apply [attachment:10118_sphinx_sagelib.2.patch] to the Sage library.\n+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.\n+\n+See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.\n+\n+Follow-up (p4 spkg): #10350\n \n Comment: 1\n \n``````\n",
    "created_at": "2010-11-28T10:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106827",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+As the subject says. See this [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8bad71b8a6a8382e) thread for some background on why we need to upgrade [Sphinx](http://sphinx.pocoo.org/).
 
+**Apply:** (starting from sage-4.6.1.alpha1)
+
+1. The patch package [http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/patch-2.5.9.spkg) (see #9418)
+2. The Sphinx package at [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p3.spkg)
+3. Apply [attachment:10118_sphinx_sagelib.2.patch] to the Sage library.
+4. Apply [attachment:trac-10118_sagenb.patch] to the Sage notebook library.
+
+See also #10290 (Upgrade Pygments to version 1.3.1) for syntax highlighting to work properly.
+
+Follow-up (p4 spkg): #10350
 
 Comment: 1
 
``````




---

archive/issue_comments_106828.json:
```json
{
    "body": "<a id='comment:40'></a>Since this ticket is already merged, see #10350.",
    "created_at": "2010-11-28T10:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106828",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>Since this ticket is already merged, see #10350.



---

archive/issue_comments_106829.json:
```json
{
    "body": "<a id='comment:41'></a>Since Minh agreed on this spkg, I'm setting this to positive_review.  Further changes are at #10350.",
    "created_at": "2010-11-28T13:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106829",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>Since Minh agreed on this spkg, I'm setting this to positive_review.  Further changes are at #10350.



---

archive/issue_comments_106830.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-11-28T13:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106830",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106831.json:
```json
{
    "body": "<a id='comment:42'></a>Regarding the last patch (trac-10118_use-utf8.patch):\n\n- this is a bit of a regression: see #8036.  Right now, the problematic string from that ticket is not in the reference manual, but if the file schemes/elliptic_curves/BSD.py is added to the reference manual, then the pdf documentation won't build.\n\n- with this patch, I think that fr/tutorial doesn't build in pdf format.  Could someone else please check this?\n\n- by default, Sphinx uses utf8, so if this patch worked, I think you could actually just comment out the line (in conf.py)\n\n```\nlatex_elements['inputenc'] = '\\\\usepackage[utf8x]{inputenc}'\n```\n rather than replace `utf8x` with `utf8`.",
    "created_at": "2010-11-28T18:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106831",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:42'></a>Regarding the last patch (trac-10118_use-utf8.patch):

- this is a bit of a regression: see #8036.  Right now, the problematic string from that ticket is not in the reference manual, but if the file schemes/elliptic_curves/BSD.py is added to the reference manual, then the pdf documentation won't build.

- with this patch, I think that fr/tutorial doesn't build in pdf format.  Could someone else please check this?

- by default, Sphinx uses utf8, so if this patch worked, I think you could actually just comment out the line (in conf.py)

```
latex_elements['inputenc'] = '\\usepackage[utf8x]{inputenc}'
```
 rather than replace `utf8x` with `utf8`.



---

archive/issue_comments_106832.json:
```json
{
    "body": "<a id='comment:43'></a>I agree with John.  Let's **not** apply the reviewer patch (it is only needed to build the pdf documentation, so I don't think there is a big issue).",
    "created_at": "2010-11-28T18:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106832",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'></a>I agree with John.  Let's **not** apply the reviewer patch (it is only needed to build the pdf documentation, so I don't think there is a big issue).



---

archive/issue_events_025818.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-28T21:58:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10118#event-25818"
}
```



---

archive/issue_comments_106833.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-11-28T21:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106833",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_106834.json:
```json
{
    "body": "<a id='comment:45'></a>In principle **needs work**:\n\nSphinx attempts to download Jinja2 during build, see the follow-up ticket #10350.",
    "created_at": "2010-12-03T15:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106834",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:45'></a>In principle **needs work**:

Sphinx attempts to download Jinja2 during build, see the follow-up ticket #10350.



---

archive/issue_comments_106835.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:45 leif]:\n> In principle **needs work**:\n> \n> Sphinx attempts to download Jinja2 during build, see the follow-up ticket #10350.\n\n\nAn upgraded Jinja2 spkg (2.2.5.p0), avoiding the download of a version >=2.2, can be found at #10423; needs review.",
    "created_at": "2010-12-03T18:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10118#issuecomment-106835",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:46'></a>Replying to [comment:45 leif]:
> In principle **needs work**:
> 
> Sphinx attempts to download Jinja2 during build, see the follow-up ticket #10350.


An upgraded Jinja2 spkg (2.2.5.p0), avoiding the download of a version >=2.2, can be found at #10423; needs review.
