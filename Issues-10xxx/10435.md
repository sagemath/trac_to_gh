# Issue 10435: Invalid write in bitsets

archive/issues_010382.json:
```json
{
    "assignees": [],
    "body": "\n\n**Assignee:** @jasongrout\n\n**CC:**  mvngu\n\n**Author:** Robert Miller\n\n**Reviewer:** Nathann Cohen\n\n**Merged:** sage-4.6.2.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/10435\n\n",
    "closed_at": "2011-01-26T22:27:44Z",
    "created_at": "2010-12-06T14:17:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20misc",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Invalid write in bitsets",
    "type": "issue",
    "updated_at": "2011-01-26T22:27:44Z",
    "url": "https://github.com/sagemath/sage/issues/10435",
    "user": "https://github.com/rlmill"
}
```


**Assignee:** @jasongrout

**CC:**  mvngu

**Author:** Robert Miller

**Reviewer:** Nathann Cohen

**Merged:** sage-4.6.2.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/10435





---

archive/issue_events_114923.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-12-06T14:17:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114923"
}
```



---

archive/issue_events_114924.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-12-06T14:17:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20misc",
    "label_color": "08517b",
    "label_name": "component: misc",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114924"
}
```



---

archive/issue_events_114925.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-12-06T14:17:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114925"
}
```



---

archive/issue_events_114926.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-12-06T14:36:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114926"
}
```



---

archive/issue_comments_099775.json:
```json
{
    "body": "<a id='comment:2'></a>\nAlso CCing Minh, who has done some bitset work.",
    "created_at": "2010-12-06T16:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99775",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:2'></a>
Also CCing Minh, who has done some bitset work.



---

archive/issue_events_114927.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2010-12-06T16:50:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114927"
}
```



---

archive/issue_events_114928.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2010-12-06T16:50:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114928"
}
```



---

archive/issue_comments_099776.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe -testall fails on the file to which the doctest is added... Here is what I got :\n\n```python\nExpected:\n    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    list a []\n    a.size 128\n    len(a) 0\n    a.limbs 4\n    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.in(n)   False\n    a.not_in(n)   True\n    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a.first_in_complement()    -1\n    a.isempty()  True\n    a.eq(b)      False\n    a.cmp(b)     -1\n    a.issubset(b) True\n    a.issuperset(b) False\n    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.first()           -1\n    a.next(n)           -1\n    a.first_diff(b)     1\n    a.next_diff(b, n)   -1\n    a.hamming_weight()  0\n    a.hamming_weight_sparse()  0\n    rshifts add  True\n    lshifts add  True\n    intersection commutes True\n    union commutes  True\n    not not = id True\n    flipped bit  -1\n    add bit      -1\n    discard bit    -1\n    lshift add unset ok True\n    rshift set unset ok True\n    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\nGot:\n    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    list a []\n    a.size 128\n    len(a) 0\n    a.limbs 2\n    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.in(n)   False\n    a.not_in(n)   True\n    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a.first_in_complement()    -1\n    a.isempty()  True\n    a.eq(b)      False\n    a.cmp(b)     -1\n    a.issubset(b) True\n    a.issuperset(b) False\n    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.first()           -1\n    a.next(n)           -1\n    a.first_diff(b)     1\n    a.next_diff(b, n)   -1\n    a.hamming_weight()  0\n    a.hamming_weight_sparse()  0\n    rshifts add  True\n    lshifts add  True\n    intersection commutes True\n    union commutes  True\n    not not = id True\n    flipped bit  -1\n    add bit      -1\n    discard bit    -1\n    lshift add unset ok True\n    rshift set unset ok True\n    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n```\n\nThe only difference I was able to notice is at the 5th line\n\nNathann",
    "created_at": "2010-12-06T16:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99776",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>
The -testall fails on the file to which the doctest is added... Here is what I got :

```python
Expected:
    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    list a []
    a.size 128
    len(a) 0
    a.limbs 4
    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.in(n)   False
    a.not_in(n)   True
    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a.first_in_complement()    -1
    a.isempty()  True
    a.eq(b)      False
    a.cmp(b)     -1
    a.issubset(b) True
    a.issuperset(b) False
    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.first()           -1
    a.next(n)           -1
    a.first_diff(b)     1
    a.next_diff(b, n)   -1
    a.hamming_weight()  0
    a.hamming_weight_sparse()  0
    rshifts add  True
    lshifts add  True
    intersection commutes True
    union commutes  True
    not not = id True
    flipped bit  -1
    add bit      -1
    discard bit    -1
    lshift add unset ok True
    rshift set unset ok True
    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
Got:
    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    list a []
    a.size 128
    len(a) 0
    a.limbs 2
    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.in(n)   False
    a.not_in(n)   True
    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a.first_in_complement()    -1
    a.isempty()  True
    a.eq(b)      False
    a.cmp(b)     -1
    a.issubset(b) True
    a.issuperset(b) False
    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.first()           -1
    a.next(n)           -1
    a.first_diff(b)     1
    a.next_diff(b, n)   -1
    a.hamming_weight()  0
    a.hamming_weight_sparse()  0
    rshifts add  True
    lshifts add  True
    intersection commutes True
    union commutes  True
    not not = id True
    flipped bit  -1
    add bit      -1
    discard bit    -1
    lshift add unset ok True
    rshift set unset ok True
    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

The only difference I was able to notice is at the 5th line

Nathann



---

archive/issue_comments_099777.json:
```json
{
    "body": "<a id='comment:4'></a>\nOops.",
    "created_at": "2010-12-06T16:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99777",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:4'></a>
Oops.



---

archive/issue_events_114929.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-12-06T16:55:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114929"
}
```



---

archive/issue_events_114930.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-12-06T16:55:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114930"
}
```



---

archive/issue_comments_099778.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt now passes all tests.. But what about this \"limbs\" parameter ? Is it platform-dependent ?\n\nNathann",
    "created_at": "2010-12-06T16:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99778",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>
It now passes all tests.. But what about this "limbs" parameter ? Is it platform-dependent ?

Nathann



---

archive/issue_comments_099779.json:
```json
{
    "body": "<a id='comment:6'></a>\n\n```python\n    bits.limbs = (size - 1)/(8*sizeof(unsigned long)) + 1\n```\n\nLooks like it is.... Thank you very much for your help ! `:-)`\n\nNathann",
    "created_at": "2010-12-06T16:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99779",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>

```python
    bits.limbs = (size - 1)/(8*sizeof(unsigned long)) + 1
```

Looks like it is.... Thank you very much for your help ! `:-)`

Nathann



---

archive/issue_events_114931.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2010-12-06T16:59:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114931"
}
```



---

archive/issue_events_114932.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2010-12-06T16:59:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114932"
}
```



---

archive/issue_comments_099780.json:
```json
{
    "body": "**Reviewer:** Nathann Cohen",
    "created_at": "2010-12-06T17:00:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99780",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Nathann Cohen



---

archive/issue_comments_099781.json:
```json
{
    "body": "<a id='comment:9'></a>\nThis seems to cause problems on some Skynet machines, for example on `hawk` (OpenSolaris 06.2009-32):\n\n```\nsage -t -long  -force_lib devel/sage/sage/misc/misc_c.pyx\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.6.2.alpha0/devel/sage-main/sage/misc/misc_c.pyx\", line 598:\n    sage: test_bitset('00'*64, '01'*64, 128)\nExpected:\n    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    list a []\n    a.size 128\n    len(a) 0\n    a.limbs ...\n    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.in(n)   False\n    a.not_in(n)   True\n    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a.first_in_complement()    -1\n    a.isempty()  True\n    a.eq(b)      False\n    a.cmp(b)     -1\n    a.issubset(b) True\n    a.issuperset(b) False\n    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.first()           -1\n    a.next(n)           -1\n    a.first_diff(b)     1\n    a.next_diff(b, n)   -1\n    a.hamming_weight()  0\n    a.hamming_weight_sparse()  0\n    rshifts add  True\n    lshifts add  True\n    intersection commutes True\n    union commutes  True\n    not not = id True\n    flipped bit  -1\n    add bit      -1\n    discard bit    -1\n    lshift add unset ok True\n    rshift set unset ok True\n    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\nGot:\n    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    list a []\n    a.size 128\n    len(a) 0\n    a.limbs 4\n    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.in(n)   True\n    a.not_in(n)   False\n    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a.first_in_complement()    -1\n    a.isempty()  True\n    a.eq(b)      False\n    a.cmp(b)     -1\n    a.issubset(b) True\n    a.issuperset(b) False\n    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    a.first()           -1\n    a.next(n)           -1\n    a.first_diff(b)     1\n    a.next_diff(b, n)   -1\n    a.hamming_weight()  0\n    a.hamming_weight_sparse()  0\n    rshifts add  True\n    lshifts add  True\n    intersection commutes True\n    union commutes  True\n    not not = id True\n    flipped bit  -1\n    add bit      -1\n    discard bit    -1\n    lshift add unset ok True\n    rshift set unset ok True\n    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n**********************************************************************\n```",
    "created_at": "2010-12-25T08:54:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99781",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
This seems to cause problems on some Skynet machines, for example on `hawk` (OpenSolaris 06.2009-32):

```
sage -t -long  -force_lib devel/sage/sage/misc/misc_c.pyx
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.6.2.alpha0/devel/sage-main/sage/misc/misc_c.pyx", line 598:
    sage: test_bitset('00'*64, '01'*64, 128)
Expected:
    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    list a []
    a.size 128
    len(a) 0
    a.limbs ...
    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.in(n)   False
    a.not_in(n)   True
    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a.first_in_complement()    -1
    a.isempty()  True
    a.eq(b)      False
    a.cmp(b)     -1
    a.issubset(b) True
    a.issuperset(b) False
    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.first()           -1
    a.next(n)           -1
    a.first_diff(b)     1
    a.next_diff(b, n)   -1
    a.hamming_weight()  0
    a.hamming_weight_sparse()  0
    rshifts add  True
    lshifts add  True
    intersection commutes True
    union commutes  True
    not not = id True
    flipped bit  -1
    add bit      -1
    discard bit    -1
    lshift add unset ok True
    rshift set unset ok True
    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
Got:
    a 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    list a []
    a.size 128
    len(a) 0
    a.limbs 4
    b 01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.in(n)   True
    a.not_in(n)   False
    a.add(n)     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.discard(n)   00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_to(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.flip(n)    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.set_first_n(n)    11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a.first_in_complement()    -1
    a.isempty()  True
    a.eq(b)      False
    a.cmp(b)     -1
    a.issubset(b) True
    a.issuperset(b) False
    a.copy()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    r.clear()     00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    complement a        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
    a intersect b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a union b       01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a minus b      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a symmetric_difference b      01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
    a.rshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.lshift(n)  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    a.first()           -1
    a.next(n)           -1
    a.first_diff(b)     1
    a.next_diff(b, n)   -1
    a.hamming_weight()  0
    a.hamming_weight_sparse()  0
    rshifts add  True
    lshifts add  True
    intersection commutes True
    union commutes  True
    not not = id True
    flipped bit  -1
    add bit      -1
    discard bit    -1
    lshift add unset ok True
    rshift set unset ok True
    reallocating a      00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 128          00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to size 256          0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    to original size    00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
**********************************************************************
```



---

archive/issue_events_114933.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-25T08:54:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114933"
}
```



---

archive/issue_events_114934.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-25T08:54:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114934"
}
```



---

archive/issue_comments_099782.json:
```json
{
    "body": "<a id='comment:10'></a>\nOn `bsd.math` (OS X 10.6 32-bit), doctesting `misc_c.pyx` gives a segmentation fault.",
    "created_at": "2010-12-31T14:59:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99782",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
On `bsd.math` (OS X 10.6 32-bit), doctesting `misc_c.pyx` gives a segmentation fault.



---

archive/issue_comments_099783.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [@jdemeyer](#comment%3A9):\n> This seems to cause problems on some Skynet machines, for example on `hawk` (OpenSolaris 06.2009-32):\n\nThe diff of these two is:\n\n```\n5c5\n<     a.limbs ...\n---\n>     a.limbs 4\n7,8c7,8\n<     a.in(n)   False\n<     a.not_in(n)   True\n---\n>     a.in(n)   True\n>     a.not_in(n)   False\n```",
    "created_at": "2011-01-12T01:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99783",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:11'></a>
Replying to [@jdemeyer](#comment%3A9):
> This seems to cause problems on some Skynet machines, for example on `hawk` (OpenSolaris 06.2009-32):

The diff of these two is:

```
5c5
<     a.limbs ...
---
>     a.limbs 4
7,8c7,8
<     a.in(n)   False
<     a.not_in(n)   True
---
>     a.in(n)   True
>     a.not_in(n)   False
```



---

archive/issue_comments_099784.json:
```json
{
    "body": "**Attachment:** [trac_10435.patch.gz](https://github.com/sagemath/sage/files/ticket10435/trac_10435.patch.gz)",
    "created_at": "2011-01-12T02:24:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99784",
    "user": "https://github.com/rlmill"
}
```

**Attachment:** [trac_10435.patch.gz](https://github.com/sagemath/sage/files/ticket10435/trac_10435.patch.gz)



---

archive/issue_events_114935.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-12T02:50:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114935"
}
```



---

archive/issue_events_114936.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-12T02:50:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114936"
}
```



---

archive/issue_comments_099785.json:
```json
{
    "body": "<a id='comment:13'></a>\nCan you justify why you removed the test from the patch?",
    "created_at": "2011-01-12T02:58:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99785",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Can you justify why you removed the test from the patch?



---

archive/issue_comments_099786.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [@jdemeyer](#comment%3A13):\n> Can you justify why you removed the test from the patch?\n\nYes. It was an invalid test. The number provided was equal to the size of the bitset, which is valid when setting the first n bits to 1, but not valid when adding that bit to the set, i.e. 0..127 would be valid but 128 is not. That is why I added the new testing function.",
    "created_at": "2011-01-12T03:03:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99786",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:14'></a>
Replying to [@jdemeyer](#comment%3A13):
> Can you justify why you removed the test from the patch?

Yes. It was an invalid test. The number provided was equal to the size of the bitset, which is valid when setting the first n bits to 1, but not valid when adding that bit to the set, i.e. 0..127 would be valid but 128 is not. That is why I added the new testing function.



---

archive/issue_comments_099787.json:
```json
{
    "body": "<a id='comment:15'></a>\nI realize that the reviewer of this ticket might not have access to a Solaris machine to test this new patch on.  That's fine, I would be happy with a positive_review based on simply reading the patch and not testing it.  If this gets a positive_review, I will test it properly.",
    "created_at": "2011-01-19T17:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99787",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
I realize that the reviewer of this ticket might not have access to a Solaris machine to test this new patch on.  That's fine, I would be happy with a positive_review based on simply reading the patch and not testing it.  If this gets a positive_review, I will test it properly.



---

archive/issue_events_114937.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-01-19T20:39:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114937"
}
```



---

archive/issue_events_114938.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-01-19T20:39:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114938"
}
```



---

archive/issue_comments_099788.json:
```json
{
    "body": "<a id='comment:16'></a>\nThen I give it a positive review ! It fixes a real problem, and passes all tests on the last alpha0 release. Thank you for testing it on OpenSolaris ! `:-)`\n\nNathann",
    "created_at": "2011-01-19T20:39:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99788",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>
Then I give it a positive review ! It fixes a real problem, and passes all tests on the last alpha0 release. Thank you for testing it on OpenSolaris ! `:-)`

Nathann



---

archive/issue_comments_099789.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha3",
    "created_at": "2011-01-26T22:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10435#issuecomment-99789",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha3



---

archive/issue_events_114939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T22:27:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114939"
}
```



---

archive/issue_events_114940.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T22:27:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10435",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10435#event-114940"
}
```
