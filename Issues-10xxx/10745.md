# Issue 10745: bug in elliptic curve gens()

archive/issues_010682.json:
```json
{
    "body": "Assignee: @JohnCremona\n\nCC:  @adeines @JohnCremona gagansekhon weigandt @williamstein @categorie @robertwb\n\n[See #15608 for a list of open simon_two_descent tickets]\n\n```\nsage: a = [1, 0, 1, -1751, -31352]\nsage: F = EllipticCurve(a)\nsage: K.<d> = QuadraticField(5)\nsage: FK = EllipticCurve(K, a)\nsage: F.gens()\n[(52 : 111 : 1)]\nsage: FK.gens()\n[]\n```\nThis isn't very good, because the default in Sage is proof=True, so one would expect this to be a provable result (until reading the docs of course).\n\nOver Q, if the result is not provable an error is raised or a warning is printed, depending on the `proof` flag. This should be the same here.\n\nIssue created by migration from https://trac.sagemath.org/ticket/10745\n\n",
    "closed_at": "2014-04-01T00:11:43Z",
    "created_at": "2011-02-05T00:40:23Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "title": "bug in elliptic curve gens()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10745",
    "user": "https://github.com/rlmill"
}
```
Assignee: @JohnCremona

CC:  @adeines @JohnCremona gagansekhon weigandt @williamstein @categorie @robertwb

[See #15608 for a list of open simon_two_descent tickets]

```
sage: a = [1, 0, 1, -1751, -31352]
sage: F = EllipticCurve(a)
sage: K.<d> = QuadraticField(5)
sage: FK = EllipticCurve(K, a)
sage: F.gens()
[(52 : 111 : 1)]
sage: FK.gens()
[]
```
This isn't very good, because the default in Sage is proof=True, so one would expect this to be a provable result (until reading the docs of course).

Over Q, if the result is not provable an error is raised or a warning is printed, depending on the `proof` flag. This should be the same here.

Issue created by migration from https://trac.sagemath.org/ticket/10745





---

archive/issue_comments_112087.json:
```json
{
    "body": "I'm not sure that, when the gens() function was added over number fields at SD22, we thought it through very well.  In particular, I don't think that Simon's code necessarily passes the \"proof=True\" criteria (but cannot be more specific).  Except that the points it returns are points on the curve...",
    "created_at": "2011-02-05T02:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112087",
    "user": "https://github.com/JohnCremona"
}
```

I'm not sure that, when the gens() function was added over number fields at SD22, we thought it through very well.  In particular, I don't think that Simon's code necessarily passes the "proof=True" criteria (but cannot be more specific).  Except that the points it returns are points on the curve...



---

archive/issue_comments_112088.json:
```json
{
    "body": "The output of simon_two_descent() for EK is\n\n```\nsage: FK.simon_two_descent()\n(1, 1, [])\n```\nwhich can be interpreted as follows:  he computes the 2-Selmer rank is 1, which gives a valid upper bound for the rank (=1).  He fails to find points on 2-coverings, so there are no points returned.  *But* he uses the parity conjecture to increase the lower bound from 0 to 1.\n\nSo when we decide (in the simon_two_descent()) method) that the output is certain, we need to take this into account.\n\nSecondly, the gens() function for curves over number fields is completely reckless:\n\n```\n        lower,upper,gens = self.simon_two_descent(verbose=verbose,lim1=lim1,lim3=\\\nlim3,limtriv=limtriv,maxprob=maxprob,limbigprime=limbigprime)\n        return gens\n```\nThere is no caching, no checking of Proof, and worst of all, the gens which are returned have not been looked at at all.  Just about all you can say about them is that they are points on the curve.\n\nWho let that in?  This function needs changing urgently.",
    "created_at": "2011-02-22T22:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112088",
    "user": "https://github.com/JohnCremona"
}
```

The output of simon_two_descent() for EK is

```
sage: FK.simon_two_descent()
(1, 1, [])
```
which can be interpreted as follows:  he computes the 2-Selmer rank is 1, which gives a valid upper bound for the rank (=1).  He fails to find points on 2-coverings, so there are no points returned.  *But* he uses the parity conjecture to increase the lower bound from 0 to 1.

So when we decide (in the simon_two_descent()) method) that the output is certain, we need to take this into account.

Secondly, the gens() function for curves over number fields is completely reckless:

```
        lower,upper,gens = self.simon_two_descent(verbose=verbose,lim1=lim1,lim3=\
lim3,limtriv=limtriv,maxprob=maxprob,limbigprime=limbigprime)
        return gens
```
There is no caching, no checking of Proof, and worst of all, the gens which are returned have not been looked at at all.  Just about all you can say about them is that they are points on the curve.

Who let that in?  This function needs changing urgently.



---

archive/issue_comments_112089.json:
```json
{
    "body": "If we want to keep a gens() function for elliptic curves over number fields. We're going to need some functionality to check saturation of points over number fields. I'm ccing Robert Bradshaw because he's thought about this.",
    "created_at": "2011-03-22T19:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112089",
    "user": "https://trac.sagemath.org/admin/accounts/users/weigandt"
}
```

If we want to keep a gens() function for elliptic curves over number fields. We're going to need some functionality to check saturation of points over number fields. I'm ccing Robert Bradshaw because he's thought about this.



---

archive/issue_comments_112090.json:
```json
{
    "body": "It seems that the second problem has disappeared in 6.0. I get now \n\n```\nsage: FK.gens(lim1=6)\n[]\n```\nThat still leaves 1).\n\nSomehow, one should think that it would be best, if the curve remembered that it was defined over a smaller field and that it had found some points of infinite order already. In general, I think it is best if the algorithm would run through all subfield and search for points in there. ... But now I am dreaming.",
    "created_at": "2013-12-22T22:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112090",
    "user": "https://github.com/categorie"
}
```

It seems that the second problem has disappeared in 6.0. I get now 

```
sage: FK.gens(lim1=6)
[]
```
That still leaves 1).

Somehow, one should think that it would be best, if the curve remembered that it was defined over a smaller field and that it had found some points of infinite order already. In general, I think it is best if the algorithm would run through all subfield and search for points in there. ... But now I am dreaming.



---

archive/issue_comments_112091.json:
```json
{
    "body": "I modified the docstring of gens in #13593 . It now says there that the function returns some points of infinite order. In fact Simon's script just gives back what it came across during the various ways to search for points. They are not lin. indep. for instance. And of course there is no guarantee it finds any.\n\nMaybe this ticket should now be rewritten as:\n\nImplement `gens` correctly for elliptic curves over number fields. Extract from the points given by 2-descent (in case it determines the rank) a set of linearly indep. point and then saturate the Mordell-Weil group.",
    "created_at": "2013-12-28T01:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112091",
    "user": "https://github.com/categorie"
}
```

I modified the docstring of gens in #13593 . It now says there that the function returns some points of infinite order. In fact Simon's script just gives back what it came across during the various ways to search for points. They are not lin. indep. for instance. And of course there is no guarantee it finds any.

Maybe this ticket should now be rewritten as:

Implement `gens` correctly for elliptic curves over number fields. Extract from the points given by 2-descent (in case it determines the rank) a set of linearly indep. point and then saturate the Mordell-Weil group.



---

archive/issue_comments_112092.json:
```json
{
    "body": "I propose to close this after #13593 and #5153 as these two overlap a lot with the ticket here. Once they are closed. Then we open a new ticket enhancement for the saturation over number field (unless that exists already).",
    "created_at": "2013-12-30T16:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112092",
    "user": "https://github.com/categorie"
}
```

I propose to close this after #13593 and #5153 as these two overlap a lot with the ticket here. Once they are closed. Then we open a new ticket enhancement for the saturation over number field (unless that exists already).



---

archive/issue_comments_112093.json:
```json
{
    "body": "Given that the documentation no longer says that the points returned by `gens()` are linearly independent or span a subgroup of full rank, this is technically not a bug anymore, but there is still the inconsistency with the similar function over **Q**.  There seem to be three options:\n1. close this ticket as invalid or wontfix;\n2. use this ticket to print a warning or raise an error if `gens()` returns something other than a basis for a subgroup of full rank in the Mordell-Weil group;\n3. rewrite this ticket with a more ambitious goal as in comment:6.\nAny ideas?",
    "created_at": "2014-02-12T15:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112093",
    "user": "https://github.com/pjbruin"
}
```

Given that the documentation no longer says that the points returned by `gens()` are linearly independent or span a subgroup of full rank, this is technically not a bug anymore, but there is still the inconsistency with the similar function over **Q**.  There seem to be three options:
1. close this ticket as invalid or wontfix;
2. use this ticket to print a warning or raise an error if `gens()` returns something other than a basis for a subgroup of full rank in the Mordell-Weil group;
3. rewrite this ticket with a more ambitious goal as in comment:6.
Any ideas?



---

archive/issue_comments_112094.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2014-02-12T15:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112094",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_112095.json:
```json
{
    "body": "I think 3) is covered in ticket #8829. So it does not really make sense to do duplicate it here. \nI don't think we should raise an error or a warning for a documented behaviour as in 2). So I would say:\n\neither this ticket can be closed as in 1) in case the documentation is clear enough about the current behaviour or otherwise it should improve it.\n\nor it is a suggestion to improve the gens function. It should run gens first in subfields (where it is much easier to run) and then put the resulting sets cleverly together.",
    "created_at": "2014-02-28T13:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112095",
    "user": "https://github.com/categorie"
}
```

I think 3) is covered in ticket #8829. So it does not really make sense to do duplicate it here. 
I don't think we should raise an error or a warning for a documented behaviour as in 2). So I would say:

either this ticket can be closed as in 1) in case the documentation is clear enough about the current behaviour or otherwise it should improve it.

or it is a suggestion to improve the gens function. It should run gens first in subfields (where it is much easier to run) and then put the resulting sets cleverly together.



---

archive/issue_comments_112096.json:
```json
{
    "body": "Replying to [comment:11 wuthrich]:\n> I think 3) is covered in ticket #8829. So it does not really make sense to do duplicate it here.\n\nOK, I agree (I hadn't seen #8829).\n> I don't think we should raise an error or a warning for a documented behaviour as in 2).\n\nIn that case I think it would be good to explicitly say that this is different from the function `gens()` for elliptic curves over **Q**.  The documentation currently also says \"Check `rank()` or `rank_bounds()` to verify the number of generators\", which is somewhat misleading because even if `E.rank() == len(E.gens())` nothing is guaranteed except that the points have infinite order, so you don't really verify anything by just comparing the two numbers.\n> So I would say:\n> \n> either this ticket can be closed as in 1) in case the documentation is clear enough about the current behaviour or otherwise it should improve it.\n\nThe documentation can be improved in any case; even if we can do better in `gens()` for some curves, we are certainly far away from always returning a basis for the Mordell-Weil group modulo torsion, so documentation improvements will not be made redundant by the other option:\n> or it is a suggestion to improve the gens function. It should run gens first in subfields (where it is much easier to run) and then put the resulting sets cleverly together. \n\nThere are quite a few things one could try, e.g.\n- to find a suitable base field, start with the field generated by the coefficients of the Weierstrass model, and then possibly try to descend to a smaller field\n- try to reduce the base field even more by finding an *isogeny* to an elliptic curve defined over a smaller field\n- for a quadratic extension *L*/*K* and a curve *E*/*L* already defined over *K*, compute M-W generators of *E*/*K* and of its twist by the extension *L*/*K*\nHow about just clarifying the documentation in this ticket and opening a new ticket for these actual improvements to `gens()`?",
    "created_at": "2014-02-28T14:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112096",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:11 wuthrich]:
> I think 3) is covered in ticket #8829. So it does not really make sense to do duplicate it here.

OK, I agree (I hadn't seen #8829).
> I don't think we should raise an error or a warning for a documented behaviour as in 2).

In that case I think it would be good to explicitly say that this is different from the function `gens()` for elliptic curves over **Q**.  The documentation currently also says "Check `rank()` or `rank_bounds()` to verify the number of generators", which is somewhat misleading because even if `E.rank() == len(E.gens())` nothing is guaranteed except that the points have infinite order, so you don't really verify anything by just comparing the two numbers.
> So I would say:
> 
> either this ticket can be closed as in 1) in case the documentation is clear enough about the current behaviour or otherwise it should improve it.

The documentation can be improved in any case; even if we can do better in `gens()` for some curves, we are certainly far away from always returning a basis for the Mordell-Weil group modulo torsion, so documentation improvements will not be made redundant by the other option:
> or it is a suggestion to improve the gens function. It should run gens first in subfields (where it is much easier to run) and then put the resulting sets cleverly together. 

There are quite a few things one could try, e.g.
- to find a suitable base field, start with the field generated by the coefficients of the Weierstrass model, and then possibly try to descend to a smaller field
- try to reduce the base field even more by finding an *isogeny* to an elliptic curve defined over a smaller field
- for a quadratic extension *L*/*K* and a curve *E*/*L* already defined over *K*, compute M-W generators of *E*/*K* and of its twist by the extension *L*/*K*
How about just clarifying the documentation in this ticket and opening a new ticket for these actual improvements to `gens()`?



---

archive/issue_comments_112097.json:
```json
{
    "body": "> How about just clarifying the documentation in this ticket and opening a new ticket for these actual improvements to `gens()`?\n\n\nYes, I agree that is the best to do. We can also make `simon_two_descent` return only points of infinite order in the number field case, too. As it was noted in #10735.",
    "created_at": "2014-03-28T17:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112097",
    "user": "https://github.com/categorie"
}
```

> How about just clarifying the documentation in this ticket and opening a new ticket for these actual improvements to `gens()`?


Yes, I agree that is the best to do. We can also make `simon_two_descent` return only points of infinite order in the number field case, too. As it was noted in #10735.



---

archive/issue_comments_112098.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-03-28T20:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112098",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_112099.json:
```json
{
    "body": "OK, I made a branch doing what you suggested.  The documentation is now hopefully clearer.  Filtering out points of finite order is now always done directly after calling Simon's GP program.  While I was at it, I removed the change to an integral model since this is not necessary (anymore?).",
    "created_at": "2014-03-28T20:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112099",
    "user": "https://github.com/pjbruin"
}
```

OK, I made a branch doing what you suggested.  The documentation is now hopefully clearer.  Filtering out points of finite order is now always done directly after calling Simon's GP program.  While I was at it, I removed the change to an integral model since this is not necessary (anymore?).



---

archive/issue_comments_112100.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-03-28T21:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_112101.json:
```json
{
    "body": "Also implement caching of the result of `simon_two_descent` over QQ by sharing more code between the various functions.\n\n---\nNew commits:",
    "created_at": "2014-03-28T22:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112101",
    "user": "https://github.com/pjbruin"
}
```

Also implement caching of the result of `simon_two_descent` over QQ by sharing more code between the various functions.

---
New commits:



---

archive/issue_comments_112102.json:
```json
{
    "body": "My first comment when looking at the modifications above is that I see that you changed ell.gp. Is this good ? It is very very likely that the next update of simon's scripts will forget to make this patch-fix of a upstream file. Would it not be better to tell the author to change this in his version and we update our file ? This is a genuine question as I am not sure what is better. One thing to bear in mind is that it seems that Denis has not been very active on the bugs in his script recently.",
    "created_at": "2014-03-30T15:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112102",
    "user": "https://github.com/categorie"
}
```

My first comment when looking at the modifications above is that I see that you changed ell.gp. Is this good ? It is very very likely that the next update of simon's scripts will forget to make this patch-fix of a upstream file. Would it not be better to tell the author to change this in his version and we update our file ? This is a genuine question as I am not sure what is better. One thing to bear in mind is that it seems that Denis has not been very active on the bugs in his script recently.



---

archive/issue_comments_112103.json:
```json
{
    "body": "If I understand correctly the old ell.gp returns 0 for the rank of the example in ell_number_field.py at line 2086, while the point in there is of infinite order. We should certainly report this upstream as a bug.",
    "created_at": "2014-03-30T15:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112103",
    "user": "https://github.com/categorie"
}
```

If I understand correctly the old ell.gp returns 0 for the rank of the example in ell_number_field.py at line 2086, while the point in there is of infinite order. We should certainly report this upstream as a bug.



---

archive/issue_comments_112104.json:
```json
{
    "body": "Replying to [comment:18 wuthrich]:\n> If I understand correctly the old ell.gp returns 0 for the rank of the example in ell_number_field.py at line 2086, while the point in there is of infinite order. We should certainly report this upstream as a bug.\n\nThis is #16022, on which this ticket indirectly depends (explaining the edit of `ell.gp` showing up in the branch).",
    "created_at": "2014-03-30T16:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112104",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:18 wuthrich]:
> If I understand correctly the old ell.gp returns 0 for the rank of the example in ell_number_field.py at line 2086, while the point in there is of infinite order. We should certainly report this upstream as a bug.

This is #16022, on which this ticket indirectly depends (explaining the edit of `ell.gp` showing up in the branch).



---

archive/issue_comments_112105.json:
```json
{
    "body": "That is not mentioned as dependency on the ticket though. How do I get to know quickly what the modifications to approve in this ticket are ? I always though that commit messages starting with the trac number were useful for that.",
    "created_at": "2014-03-30T16:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112105",
    "user": "https://github.com/categorie"
}
```

That is not mentioned as dependency on the ticket though. How do I get to know quickly what the modifications to approve in this ticket are ? I always though that commit messages starting with the trac number were useful for that.



---

archive/issue_comments_112106.json:
```json
{
    "body": "Replying to [comment:20 wuthrich]:\n> That is not mentioned as dependency on the ticket though.\n\nIt is quite a long chain of dependencies: #10745 <- #10735 <- #9322 <- #16009 <- #16022 (plus #9322 <- #16011).  I'm not sure if explicitly listing all of these makes it clearer.\n> How do I get to know quickly what the modifications to approve in this ticket are ?\n\nAll dependencies get in via #10735, so one way to do it is to create a local branch for #10735 and type `git diff --color ticket/10735 ticket/10745` (replace `ticket/10735` and `ticket/10745` with the branch names you use).\n> I always though that commit messages starting with the trac number were useful for that.\n\nGood point; usually I number the branch name, but it could indeed be useful to put the ticket number in the commit message as well.",
    "created_at": "2014-03-30T21:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112106",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:20 wuthrich]:
> That is not mentioned as dependency on the ticket though.

It is quite a long chain of dependencies: #10745 <- #10735 <- #9322 <- #16009 <- #16022 (plus #9322 <- #16011).  I'm not sure if explicitly listing all of these makes it clearer.
> How do I get to know quickly what the modifications to approve in this ticket are ?

All dependencies get in via #10735, so one way to do it is to create a local branch for #10735 and type `git diff --color ticket/10735 ticket/10745` (replace `ticket/10735` and `ticket/10745` with the branch names you use).
> I always though that commit messages starting with the trac number were useful for that.

Good point; usually I number the branch name, but it could indeed be useful to put the ticket number in the commit message as well.



---

archive/issue_comments_112107.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-31T12:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112107",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_112108.json:
```json
{
    "body": "OK, that was helpful. \n\nAll tests pass and I am happy with all modifications. Except there is one I am not certain about. You changed in gp_simon that the model is not necessarily changed to an integral model. I tried a few example and it seems to work even with non-integral models. Why are you certain this will never cause a problem ?\n\nCan I leave you to open a ticket for the other issue on gens ? I believe there is one for saturation, but I think we should open another one for the original problem posted in the question here.",
    "created_at": "2014-03-31T12:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112108",
    "user": "https://github.com/categorie"
}
```

OK, that was helpful. 

All tests pass and I am happy with all modifications. Except there is one I am not certain about. You changed in gp_simon that the model is not necessarily changed to an integral model. I tried a few example and it seems to work even with non-integral models. Why are you certain this will never cause a problem ?

Can I leave you to open a ticket for the other issue on gens ? I believe there is one for saturation, but I think we should open another one for the original problem posted in the question here.



---

archive/issue_comments_112109.json:
```json
{
    "body": "Replying to [comment:22 wuthrich]: \n> All tests pass and I am happy with all modifications.\n\nThanks for the review!\n>Except there is one I am not certain about. You changed in gp_simon that the model is not necessarily changed to an integral model. I tried a few example and it seems to work even with non-integral models. Why are you certain this will never cause a problem ?\n\nDenis Simon writes this in the documentation of `ell.gp`:\n\n```\n  La fonction bnfellrank() accepte toutes les courbes sous la forme\n  [a1,a2,a3,a4,a6]\n  Les coefficients peuvent etre entiers ou non.\n```\nOne of the first things that the GP function `bnfellrank()` does is indeed clearing denominators.  (The specialised functions for the three possible 2-torsion structures do require an integral model, but we don't call those directly.)\n> Can I leave you to open a ticket for the other issue on gens ? I believe there is one for saturation, but I think we should open another one for the original problem posted in the question here.\n\nYou mean for extracting a set of linearly independent points, or for the trick of looking over smaller fields first?  I can open a ticket for each of those.  The one for saturation is #8829.",
    "created_at": "2014-03-31T13:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112109",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:22 wuthrich]: 
> All tests pass and I am happy with all modifications.

Thanks for the review!
>Except there is one I am not certain about. You changed in gp_simon that the model is not necessarily changed to an integral model. I tried a few example and it seems to work even with non-integral models. Why are you certain this will never cause a problem ?

Denis Simon writes this in the documentation of `ell.gp`:

```
  La fonction bnfellrank() accepte toutes les courbes sous la forme
  [a1,a2,a3,a4,a6]
  Les coefficients peuvent etre entiers ou non.
```
One of the first things that the GP function `bnfellrank()` does is indeed clearing denominators.  (The specialised functions for the three possible 2-torsion structures do require an integral model, but we don't call those directly.)
> Can I leave you to open a ticket for the other issue on gens ? I believe there is one for saturation, but I think we should open another one for the original problem posted in the question here.

You mean for extracting a set of linearly independent points, or for the trick of looking over smaller fields first?  I can open a ticket for each of those.  The one for saturation is #8829.



---

archive/issue_comments_112110.json:
```json
{
    "body": "Well, I guess saturation (using the height pairing anyway) should filter out the linearly dependent points too. I was rather thinking of the other issue. Maybe a simple thing would be to pass on the gens when using `base_extend`. The more advanced \"looking over smaller fields\" seems too utopian.",
    "created_at": "2014-03-31T14:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112110",
    "user": "https://github.com/categorie"
}
```

Well, I guess saturation (using the height pairing anyway) should filter out the linearly dependent points too. I was rather thinking of the other issue. Maybe a simple thing would be to pass on the gens when using `base_extend`. The more advanced "looking over smaller fields" seems too utopian.



---

archive/issue_comments_112111.json:
```json
{
    "body": "Replying to [comment:24 wuthrich]:\n> Well, I guess saturation (using the height pairing anyway) should filter out the linearly dependent points too.\n\nActually the current patch at #8829 requires the initial points to be linearly independent; it even has a doctest showing that it fails for linearly dependent points...  It is probably better to fix this *after* #8829, though.\n> I was rather thinking of the other issue. Maybe a simple thing would be to pass on the gens when using `base_extend`. The more advanced \"looking over smaller fields\" seems too utopian.\n\nOK, then I will open a ticket to fix at least the following (inspired by the original problem):\n\n```\nsage: E = EllipticCurve([1,0,1,-1751,-31352])\nsage: K.<d>=QuadraticField(5)\nsage: E.gens()\n[(52 : 111 : 1)]\nsage: E.base_extend(K).gens()\n[]\n```",
    "created_at": "2014-03-31T14:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112111",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:24 wuthrich]:
> Well, I guess saturation (using the height pairing anyway) should filter out the linearly dependent points too.

Actually the current patch at #8829 requires the initial points to be linearly independent; it even has a doctest showing that it fails for linearly dependent points...  It is probably better to fix this *after* #8829, though.
> I was rather thinking of the other issue. Maybe a simple thing would be to pass on the gens when using `base_extend`. The more advanced "looking over smaller fields" seems too utopian.

OK, then I will open a ticket to fix at least the following (inspired by the original problem):

```
sage: E = EllipticCurve([1,0,1,-1751,-31352])
sage: K.<d>=QuadraticField(5)
sage: E.gens()
[(52 : 111 : 1)]
sage: E.base_extend(K).gens()
[]
```



---

archive/issue_comments_112112.json:
```json
{
    "body": "Well, whatever the documentation says about gens over number fields, users will assume that we are miracle-workers and hence that the gens are complete over the extension.  The only situation where this is probably do-able is for quadratic extensions, assuming that we can find gens for the twist.  Somewhere there is code which, on given an elliptic curve over a quadratic fields when evaluating its gens function, tries to see if the curve is a base-change and if so uses this trick.  I cannot remember of anyone implemented this well enough to have been let in...",
    "created_at": "2014-03-31T14:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112112",
    "user": "https://github.com/JohnCremona"
}
```

Well, whatever the documentation says about gens over number fields, users will assume that we are miracle-workers and hence that the gens are complete over the extension.  The only situation where this is probably do-able is for quadratic extensions, assuming that we can find gens for the twist.  Somewhere there is code which, on given an elliptic curve over a quadratic fields when evaluating its gens function, tries to see if the curve is a base-change and if so uses this trick.  I cannot remember of anyone implemented this well enough to have been let in...



---

archive/issue_comments_112113.json:
```json
{
    "body": "Replying to [comment:25 pbruin]:\n> Replying to [comment:24 wuthrich]:\n> > I was rather thinking of the other issue. Maybe a simple thing would be to pass on the gens when using `base_extend`. The more advanced \"looking over smaller fields\" seems too utopian.\n\n> OK, then I will open a ticket\nThis is now #16034.",
    "created_at": "2014-03-31T14:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112113",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:25 pbruin]:
> Replying to [comment:24 wuthrich]:
> > I was rather thinking of the other issue. Maybe a simple thing would be to pass on the gens when using `base_extend`. The more advanced "looking over smaller fields" seems too utopian.

> OK, then I will open a ticket
This is now #16034.



---

archive/issue_comments_112114.json:
```json
{
    "body": "Replying to [comment:26 cremona]:\n> Somewhere there is code which, on given an elliptic curve over a quadratic fields when evaluating its gens function, tries to see if the curve is a base-change and if so uses this trick.  I cannot remember of anyone implemented this well enough to have been let in...\n\nI think this is part of the patch at #8829.",
    "created_at": "2014-03-31T14:30:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112114",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:26 cremona]:
> Somewhere there is code which, on given an elliptic curve over a quadratic fields when evaluating its gens function, tries to see if the curve is a base-change and if so uses this trick.  I cannot remember of anyone implemented this well enough to have been let in...

I think this is part of the patch at #8829.



---

archive/issue_comments_112115.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-01T00:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10745#issuecomment-112115",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_027688.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-01T00:11:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10745",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10745#event-27688"
}
```
