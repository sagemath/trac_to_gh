# Issue 10052: Improve the implementation of the Steenrod algebra

archive/issues_010051.json:
```json
{
    "assignees": [],
    "body": "The attached patch does several things:\n\n- it moves the Steenrod algebra code to a subdirectory of algebras.  For one thing, there are already 4 files, and for another, I hope that more will be added: several people are working on related projects.\n\n- it reimplements the Steenrod algebra using `CombinatorialFreeModule`, which provides a number of conveniences: scalar multiplication is already defined, as are tensor products, etc.  Then for example the antipode or the coproduct can be defined just on basis elements, and the linear extension to all elements is handled automatically.\n\n- it implements another way of computing products, using admissible sequences and the Adem relations.  This provides a good way of checking for bugs: with two completely different algorithms for computing products, one can compute the same product two ways and compare answers.\n\n- it implements sub-Hopf algebras of the Steenrod algebra.  These were classified 35 years ago, and for some applications people want to use sub-Hopf algebras rather than the whole thing.\n\n- the `TestSuite` has been improved: all components now pass, whereas before, we had some failures.  From the *old* steenrod_algebra.py:\n\n```\n            sage: TestSuite(A).run() # todo: fix category inheritance for elements of A\n              Failure in _test_category:\n              ...\n              ------------------------------------------------------------\n              The following tests failed: _test_category\n            Failure in _test_elements\n            The following tests failed: _test_elements\n```\n From the new one:\n\n```\n            sage: TestSuite(SteenrodAlgebra()).run()\n            sage: TestSuite(SteenrodAlgebra(profile=[4,3,2,2,1])).run()\n            sage: TestSuite(SteenrodAlgebra(basis='adem')).run()\n            sage: TestSuite(SteenrodAlgebra(basis='wall')).run()\n            sage: TestSuite(SteenrodAlgebra(basis='arnonc')).run() # long time\n            sage: TestSuite(SteenrodAlgebra(basis='woody')).run() # long time\n            sage: A3 = SteenrodAlgebra(3)\n            sage: A3.category()\n            Category of graded hopf algebras with basis over Finite Field of size 3\n            sage: TestSuite(A3).run()\n            sage: TestSuite(SteenrodAlgebra(basis='adem', p=3)).run()\n            sage: TestSuite(SteenrodAlgebra(basis='pst_llex', p=7)).run() # long time\n            sage: TestSuite(SteenrodAlgebra(basis='comm_deg', p=5)).run() # long time\n```\n Not only are there no failures, but there are many more executions of the suite.  This yields some repetition, but the method `an_element` varies depending on the values of `basis` and `p`, so there are also new tests run with each execution.\n\nUnfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.\n\n\n## Apply\n\n1. [attachment:trac_10052-steenrod.rebased.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.rebased.patch)\n2. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)\n\n**Assignee:** @aghitza\n\n**CC:**  @jvkersch @nilesjohnson\n\n**Keywords:** steenrod, notebook\n\n**Author:** John Palmieri\n\n**Reviewer:** Niles Johnson\n\n**Merged:** sage-4.7.1.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/10052\n\n",
    "closed_at": "2011-06-09T11:56:08Z",
    "created_at": "2010-10-01T22:35:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve the implementation of the Steenrod algebra",
    "type": "issue",
    "updated_at": "2011-06-09T11:56:08Z",
    "url": "https://github.com/sagemath/sage/issues/10052",
    "user": "https://github.com/jhpalmieri"
}
```
The attached patch does several things:

- it moves the Steenrod algebra code to a subdirectory of algebras.  For one thing, there are already 4 files, and for another, I hope that more will be added: several people are working on related projects.

- it reimplements the Steenrod algebra using `CombinatorialFreeModule`, which provides a number of conveniences: scalar multiplication is already defined, as are tensor products, etc.  Then for example the antipode or the coproduct can be defined just on basis elements, and the linear extension to all elements is handled automatically.

- it implements another way of computing products, using admissible sequences and the Adem relations.  This provides a good way of checking for bugs: with two completely different algorithms for computing products, one can compute the same product two ways and compare answers.

- it implements sub-Hopf algebras of the Steenrod algebra.  These were classified 35 years ago, and for some applications people want to use sub-Hopf algebras rather than the whole thing.

- the `TestSuite` has been improved: all components now pass, whereas before, we had some failures.  From the *old* steenrod_algebra.py:

```
            sage: TestSuite(A).run() # todo: fix category inheritance for elements of A
              Failure in _test_category:
              ...
              ------------------------------------------------------------
              The following tests failed: _test_category
            Failure in _test_elements
            The following tests failed: _test_elements
```
 From the new one:

```
            sage: TestSuite(SteenrodAlgebra()).run()
            sage: TestSuite(SteenrodAlgebra(profile=[4,3,2,2,1])).run()
            sage: TestSuite(SteenrodAlgebra(basis='adem')).run()
            sage: TestSuite(SteenrodAlgebra(basis='wall')).run()
            sage: TestSuite(SteenrodAlgebra(basis='arnonc')).run() # long time
            sage: TestSuite(SteenrodAlgebra(basis='woody')).run() # long time
            sage: A3 = SteenrodAlgebra(3)
            sage: A3.category()
            Category of graded hopf algebras with basis over Finite Field of size 3
            sage: TestSuite(A3).run()
            sage: TestSuite(SteenrodAlgebra(basis='adem', p=3)).run()
            sage: TestSuite(SteenrodAlgebra(basis='pst_llex', p=7)).run() # long time
            sage: TestSuite(SteenrodAlgebra(basis='comm_deg', p=5)).run() # long time
```
 Not only are there no failures, but there are many more executions of the suite.  This yields some repetition, but the method `an_element` varies depending on the values of `basis` and `p`, so there are also new tests run with each execution.

Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.


## Apply

1. [attachment:trac_10052-steenrod.rebased.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.rebased.patch)
2. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)

**Assignee:** @aghitza

**CC:**  @jvkersch @nilesjohnson

**Keywords:** steenrod, notebook

**Author:** John Palmieri

**Reviewer:** Niles Johnson

**Merged:** sage-4.7.1.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/10052





---

archive/issue_events_110173.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-10-01T22:35:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110173"
}
```



---

archive/issue_events_110174.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-10-01T22:35:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "08517b",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110174"
}
```



---

archive/issue_events_110175.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-10-01T22:35:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110175"
}
```



---

archive/issue_comments_094071.json:
```json
{
    "body": "**Attachment:** [trac_10052-sagenb.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch.gz)\n\npatch for sagenb repo",
    "created_at": "2010-10-01T22:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94071",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_10052-sagenb.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch.gz)

patch for sagenb repo



---

archive/issue_comments_094072.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -37,3 +37,5 @@\n             sage: TestSuite(SteenrodAlgebra(basis='comm_deg', p=5)).run() # long time\n ```\n  Not only are there no failures, but there are many more executions of the suite.  This yields some repetition, but the method `an_element` varies depending on the values of `basis` and `p`, so there are also new tests run with each execution.\n+\n+Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.\n``````\n",
    "created_at": "2010-10-01T22:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94072",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -37,3 +37,5 @@
             sage: TestSuite(SteenrodAlgebra(basis='comm_deg', p=5)).run() # long time
 ```
  Not only are there no failures, but there are many more executions of the suite.  This yields some repetition, but the method `an_element` varies depending on the values of `basis` and `p`, so there are also new tests run with each execution.
+
+Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.
``````




---

archive/issue_comments_094073.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"steenrod, notebook\".",
    "created_at": "2010-10-01T22:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94073",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing keywords** from "" to "steenrod, notebook".



---

archive/issue_events_110176.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-10-01T22:44:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110176"
}
```



---

archive/issue_comments_094074.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nI seem to be missing something; here's what I get after applying [attachment:trac_10052-steenrod.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.patch) to sage 4.6.alpha2:\n\n```\nsage: SteenrodAlgebra(5)\nTraceback (most recent call last)\n...\nTypeError: __init__() got an unexpected keyword argument 'scalar_mult'\n```\n\nAre there other patches I should have applied?\n\nMoreover, the notebook patch doesn't apply at all -- I don't know where the directory ``sagenb`` is, let alone the file ``sageinspect.py``.  Any ideas what I could be missing?",
    "created_at": "2010-10-10T19:47:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94074",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:3'>**Comment 3:**</a>
I seem to be missing something; here's what I get after applying [attachment:trac_10052-steenrod.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.patch) to sage 4.6.alpha2:

```
sage: SteenrodAlgebra(5)
Traceback (most recent call last)
...
TypeError: __init__() got an unexpected keyword argument 'scalar_mult'
```

Are there other patches I should have applied?

Moreover, the notebook patch doesn't apply at all -- I don't know where the directory ``sagenb`` is, let alone the file ``sageinspect.py``.  Any ideas what I could be missing?



---

archive/issue_events_110177.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2010-10-10T19:47:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110177"
}
```



---

archive/issue_events_110178.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2010-10-10T19:47:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110178"
}
```



---

archive/issue_comments_094075.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nReplying to [@nilesjohnson](#comment%3A3):\n> I seem to be missing something; here's what I get after applying [attachment:trac_10052-steenrod.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.patch) to sage 4.6.alpha2:\n\nOops, sorry, my fault.  This patch depends on the one at #9370, so please apply that first.\n\n> Moreover, the notebook patch doesn't apply at all -- I don't know where the directory ``sagenb`` is, let alone the file ``sageinspect.py``.  Any ideas what I could be missing?\n\nAs of Sage 4.6.alpha2, this is a little complicated, but with 4.6.alpha3, you can do `hg_sagenb.import_patch(\"...path_to_patch_file...\")` from within Sage to apply it.  (The sagenb patch on this ticket is pretty minor, just to make some doctests pass: there are some doctests in the patched file which return the path to one of the files which implements the Steenrod algebra, and since the files got moved around, the doctests fail without the sagenb patch.)",
    "created_at": "2010-10-11T15:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94075",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'>**Comment 4:**</a>
Replying to [@nilesjohnson](#comment%3A3):
> I seem to be missing something; here's what I get after applying [attachment:trac_10052-steenrod.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.patch) to sage 4.6.alpha2:

Oops, sorry, my fault.  This patch depends on the one at #9370, so please apply that first.

> Moreover, the notebook patch doesn't apply at all -- I don't know where the directory ``sagenb`` is, let alone the file ``sageinspect.py``.  Any ideas what I could be missing?

As of Sage 4.6.alpha2, this is a little complicated, but with 4.6.alpha3, you can do `hg_sagenb.import_patch("...path_to_patch_file...")` from within Sage to apply it.  (The sagenb patch on this ticket is pretty minor, just to make some doctests pass: there are some doctests in the patched file which return the path to one of the files which implements the Steenrod algebra, and since the files got moved around, the doctests fail without the sagenb patch.)



---

archive/issue_events_110179.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-10-11T15:57:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110179"
}
```



---

archive/issue_events_110180.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-10-11T15:57:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110180"
}
```



---

archive/issue_comments_094076.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -39,3 +39,5 @@\n  Not only are there no failures, but there are many more executions of the suite.  This yields some repetition, but the method `an_element` varies depending on the values of `basis` and `p`, so there are also new tests run with each execution.\n \n Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.\n+\n+This patch depends on #9370.\n``````\n",
    "created_at": "2010-10-11T15:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94076",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -39,3 +39,5 @@
  Not only are there no failures, but there are many more executions of the suite.  This yields some repetition, but the method `an_element` varies depending on the values of `basis` and `p`, so there are also new tests run with each execution.
 
 Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.
+
+This patch depends on #9370.
``````




---

archive/issue_comments_094077.json:
```json
{
    "body": "**Attachment:** [trac_10052-steenrod.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.patch.gz)\n\ndepends on #9370",
    "created_at": "2010-10-11T15:57:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94077",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_10052-steenrod.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.patch.gz)

depends on #9370



---

archive/issue_comments_094078.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n(I attached the same patch so I could add the note about it depending on #9370.)",
    "created_at": "2010-10-11T15:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94078",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'>**Comment 5:**</a>
(I attached the same patch so I could add the note about it depending on #9370.)



---

archive/issue_comments_094079.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nAlso re the sagenb patch: the patched file \"sagenb/misc/sageinspect.py\" is a modified version of \"sage/misc/sageinspect.py\", present so that sagenb can function as a standalone project, independent of the rest of Sage.  So any changes to the sage file necessitate corresponding changes to the sagenb file.  So without actually applying the sagenb patch, you should be able to verify that the patch looks okay.  (Eventually, of course, you should apply it and run \"make ptestlong\" to run the sagenb tests as well as the sage ones...)",
    "created_at": "2010-10-11T19:56:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94079",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'>**Comment 6:**</a>
Also re the sagenb patch: the patched file "sagenb/misc/sageinspect.py" is a modified version of "sage/misc/sageinspect.py", present so that sagenb can function as a standalone project, independent of the rest of Sage.  So any changes to the sage file necessitate corresponding changes to the sagenb file.  So without actually applying the sagenb patch, you should be able to verify that the patch looks okay.  (Eventually, of course, you should apply it and run "make ptestlong" to run the sagenb tests as well as the sage ones...)



---

archive/issue_comments_094080.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nI just attached a new version of the patch.  This should be essentially equivalent, except that the new version records the fact that various files have been renamed, and so in theory the change history for the files (like the old algebras/steenrod_algebra.py, now renamed to algebras/steenrod/steenrod_algebra.py) should remain intact.  Two files (steenrod_milnor_multiplication.py and steenrod_milnor_multiplication_odd.py) were combined, and this was recorded as the first being renamed and the second removed.",
    "created_at": "2010-11-03T23:56:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94080",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'>**Comment 7:**</a>
I just attached a new version of the patch.  This should be essentially equivalent, except that the new version records the fact that various files have been renamed, and so in theory the change history for the files (like the old algebras/steenrod_algebra.py, now renamed to algebras/steenrod/steenrod_algebra.py) should remain intact.  Two files (steenrod_milnor_multiplication.py and steenrod_milnor_multiplication_odd.py) were combined, and this was recorded as the first being renamed and the second removed.



---

archive/issue_comments_094081.json:
```json
{
    "body": "version 2. depends on #9370",
    "created_at": "2010-11-19T23:50:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94081",
    "user": "https://github.com/jhpalmieri"
}
```

version 2. depends on #9370



---

archive/issue_comments_094082.json:
```json
{
    "body": "**Work Issues:** minor docstring issues, problems with sub-Hopf algebras",
    "created_at": "2010-12-01T14:03:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94082",
    "user": "https://github.com/nilesjohnson"
}
```

**Work Issues:** minor docstring issues, problems with sub-Hopf algebras



---

archive/issue_events_110181.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2010-12-01T14:03:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110181"
}
```



---

archive/issue_events_110182.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2010-12-01T14:03:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110182"
}
```



---

archive/issue_comments_094083.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\n**Attachment:** [trac_10052-steenrod.v2.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v2.patch.gz)\n\nHi John,\n\nI've finally had a chance to look over this patch.  The functionality is really great, and I think the documentation is fantastic!  I noticed a couple of minor issues, and then some larger problems related to sub-Hopf algebras; here goes:\n\n* I really like the [sage.misc.misc.verbose](http://www.sagemath.org/doc/reference/sage/misc/misc.html#sage.misc.misc.verbose) module; I just wanted to remind you about it for  `steenrod_algebra_bases.steenrod_basis_error_check`.  For a lengthy demonstration, try\n\n```\nsage: set_verbose(1)\nsage: EllipticCurve('11a1').sha().an_padic(5)\n```\n\n* Two minor doctest failures; the first occurs because -1 = 10 in GF(11), and Sage prints 10; the second occurs because the way dicts are printed may vary -- to fix that one I suggest testing that the output of the function is equal to the given dict.\n\n```\nsage -t  sage/algebras/steenrod/steenrod_algebra.py\n**********************************************************************\nFile \"/Applications/sage/devel/sage-main/sage/algebras/steenrod/steenrod_algebra.py\", line 1340:\n    sage: SteenrodAlgebra(p=11).Q(0,2).coproduct()\nExpected:\n    1 # Q_0 Q_2 + Q_0 # Q_2 + Q_0 Q_2 # 1 - Q_2 # Q_0\nGot:\n    1 # Q_0 Q_2 + Q_0 # Q_2 + Q_0 Q_2 # 1 + 10*Q_2 # Q_0\n**********************************************************************\nFile \"/Applications/sage/devel/sage-main/sage/algebras/steenrod/steenrod_algebra.py\", line 3080:\n    sage: d._basis_dictionary('arnonc')\nExpected:\n    {(7,): 1, (2, 5): 1, (4, 2, 1): 1, (4, 3): 1}\nGot:\n    {(7,): 1, (2, 5): 1, (4, 3): 1, (4, 2, 1): 1}\n**********************************************************************\n```\n\n* The docstring for `.gens()`, last sentence before EXAMPLES::, should mention the `Q_n`'s too, since both `.gen()` and `.ngens()` mention them.\n\n* `.gen()` fails for pst basis: The following returns an error:\n\n```\nsage: SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]], basis='pst').gen(2)\n```\n\n* In the docstring for `.milnor_multiplication_odd()`, could you give a reference for Monks Maple package?\n\n* I think the description of `.homogeneous_component()` is a little misleading: I expected it to return the vector space of elements of homogeneous degree `n`, and thus was surprised to get different answers depending on which basis I used.  Of course this was clarified by the description of the algorithm, but maybe the description could be clarified.\n\n```\nsage: G = SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]], basis='pst')\nsage: H = SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]])\nsage: [H[n].dimension() - G[n].dimension() for n in range(100)]\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 1, 4, 2, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 2, 6, 4, 0]\n```\n\n* `.an_element()` sometimes returns an element which may not be in sub algebra:\n\n```\nsage: H = SteenrodAlgebra(profile=[1,2,1,1])\nsage: H.an_element()\nSq(2,1)\nsage: H.an_element() in H\nFalse\n```\n\n* For sub algebras, `.Q()` should throw an error for elements not in the sub algebra (as with `.P()`):\n\n```\nsage: H = SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]])\nsage: H.Q(4) in H\nFalse\nsage: H.Q(4)\nQ_4\nsage: H.Q(4).parent() is H\nTrue\n```\n\n* There is a problem with `.antipode()` for sub algebras:\n\n```\nsage: A = SteenrodAlgebra(2)\nsage: A.Sq(2,1).antipode()\nSq(2,1)\nsage: H = SteenrodAlgebra(profile=[2,2,1])\nsage: H.Sq(2,1).antipode()\nTraceback (most recent call last):\n...\nValueError: Element does not lie in this Steenrod algebra\n```\n\n* problems with coercion:\n\n```\nsage: H.Sq(2,1) == A.Sq(2,1)\nTrue\nsage: H.Sq(2,1).coproduct() == A.Sq(2,1).coproduct()\nFalse\n\nsage: A.Sq(2,1).coproduct().parent() is A.tensor_square()\nsage: A.tensor_square()(H.Sq(2,1).coproduct())\nTraceback (most recent call last):\n...\nNotImplementedError: \n```\n\n* printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:\n\n```\nsage: A = SteenrodAlgebra(13)\nsage: A.an_element()\n12 Q_1 Q_3 P(2,1)\n\nsage: PolynomialRing(GF(13),'x',5).random_element()\n5*x1^2 + x0*x2 + x2*x4 - x4^2 - 5*x2\n```\n\n* it's too bad that elements do not print in a way that can be typed directly into Sage (I think I read somewhere that this should be done whenever possible).  This could be fixed by allowing the user to declare Sq, P, Q as global functions (e.g. P = A.P) -- perhaps by using the .inject_variables() function -- and changing the Q_i to print as Q(i).  Of course this would work for only one Steenrod algebra (or sub algebra) at a time, but would still be useful for basic testing/playing.",
    "created_at": "2010-12-01T14:03:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94083",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:8'>**Comment 8:**</a>
**Attachment:** [trac_10052-steenrod.v2.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v2.patch.gz)

Hi John,

I've finally had a chance to look over this patch.  The functionality is really great, and I think the documentation is fantastic!  I noticed a couple of minor issues, and then some larger problems related to sub-Hopf algebras; here goes:

* I really like the [sage.misc.misc.verbose](http://www.sagemath.org/doc/reference/sage/misc/misc.html#sage.misc.misc.verbose) module; I just wanted to remind you about it for  `steenrod_algebra_bases.steenrod_basis_error_check`.  For a lengthy demonstration, try

```
sage: set_verbose(1)
sage: EllipticCurve('11a1').sha().an_padic(5)
```

* Two minor doctest failures; the first occurs because -1 = 10 in GF(11), and Sage prints 10; the second occurs because the way dicts are printed may vary -- to fix that one I suggest testing that the output of the function is equal to the given dict.

```
sage -t  sage/algebras/steenrod/steenrod_algebra.py
**********************************************************************
File "/Applications/sage/devel/sage-main/sage/algebras/steenrod/steenrod_algebra.py", line 1340:
    sage: SteenrodAlgebra(p=11).Q(0,2).coproduct()
Expected:
    1 # Q_0 Q_2 + Q_0 # Q_2 + Q_0 Q_2 # 1 - Q_2 # Q_0
Got:
    1 # Q_0 Q_2 + Q_0 # Q_2 + Q_0 Q_2 # 1 + 10*Q_2 # Q_0
**********************************************************************
File "/Applications/sage/devel/sage-main/sage/algebras/steenrod/steenrod_algebra.py", line 3080:
    sage: d._basis_dictionary('arnonc')
Expected:
    {(7,): 1, (2, 5): 1, (4, 2, 1): 1, (4, 3): 1}
Got:
    {(7,): 1, (2, 5): 1, (4, 3): 1, (4, 2, 1): 1}
**********************************************************************
```

* The docstring for `.gens()`, last sentence before EXAMPLES::, should mention the `Q_n`'s too, since both `.gen()` and `.ngens()` mention them.

* `.gen()` fails for pst basis: The following returns an error:

```
sage: SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]], basis='pst').gen(2)
```

* In the docstring for `.milnor_multiplication_odd()`, could you give a reference for Monks Maple package?

* I think the description of `.homogeneous_component()` is a little misleading: I expected it to return the vector space of elements of homogeneous degree `n`, and thus was surprised to get different answers depending on which basis I used.  Of course this was clarified by the description of the algorithm, but maybe the description could be clarified.

```
sage: G = SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]], basis='pst')
sage: H = SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]])
sage: [H[n].dimension() - G[n].dimension() for n in range(100)]
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 1, 4, 2, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 1, 4, 3, 0, 0, 0, 0, 0, 2, 6, 4, 0]
```

* `.an_element()` sometimes returns an element which may not be in sub algebra:

```
sage: H = SteenrodAlgebra(profile=[1,2,1,1])
sage: H.an_element()
Sq(2,1)
sage: H.an_element() in H
False
```

* For sub algebras, `.Q()` should throw an error for elements not in the sub algebra (as with `.P()`):

```
sage: H = SteenrodAlgebra(p=5, profile=[[2,1], [2,2,2]])
sage: H.Q(4) in H
False
sage: H.Q(4)
Q_4
sage: H.Q(4).parent() is H
True
```

* There is a problem with `.antipode()` for sub algebras:

```
sage: A = SteenrodAlgebra(2)
sage: A.Sq(2,1).antipode()
Sq(2,1)
sage: H = SteenrodAlgebra(profile=[2,2,1])
sage: H.Sq(2,1).antipode()
Traceback (most recent call last):
...
ValueError: Element does not lie in this Steenrod algebra
```

* problems with coercion:

```
sage: H.Sq(2,1) == A.Sq(2,1)
True
sage: H.Sq(2,1).coproduct() == A.Sq(2,1).coproduct()
False

sage: A.Sq(2,1).coproduct().parent() is A.tensor_square()
sage: A.tensor_square()(H.Sq(2,1).coproduct())
Traceback (most recent call last):
...
NotImplementedError: 
```

* printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:

```
sage: A = SteenrodAlgebra(13)
sage: A.an_element()
12 Q_1 Q_3 P(2,1)

sage: PolynomialRing(GF(13),'x',5).random_element()
5*x1^2 + x0*x2 + x2*x4 - x4^2 - 5*x2
```

* it's too bad that elements do not print in a way that can be typed directly into Sage (I think I read somewhere that this should be done whenever possible).  This could be fixed by allowing the user to declare Sq, P, Q as global functions (e.g. P = A.P) -- perhaps by using the .inject_variables() function -- and changing the Q_i to print as Q(i).  Of course this would work for only one Steenrod algebra (or sub algebra) at a time, but would still be useful for basic testing/playing.



---

archive/issue_comments_094084.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nReplying to [@nilesjohnson](#comment%3A8):\n\nThanks a lot for all the work and careful comments.  Among other things, you've found some bugs in the code, which I think I've fixed.  I'm attaching a new patch, but I'm leaving it as \"needs work\" while I keep looking at it to see if I can see other issues which need fixing.\n\n> * I really like the [sage.misc.misc.verbose](http://www.sagemath.org/doc/reference/sage/misc/misc.html#sage.misc.misc.verbose) module; I just wanted to remind you about it for  `steenrod_algebra_bases.steenrod_basis_error_check`.\n\nThat's a good idea; I've implemented it.\n\n> * Two minor doctest failures; the first occurs because -1 = 10 in GF(11), and Sage prints 10; the second occurs because the way dicts are printed may vary\n\nI don't see these, on either sage.math or on OS X.  What platform are you using?\n\n> * The docstring for `.gens()`, last sentence before EXAMPLES::, should mention the `Q_n`'s too, since both `.gen()` and `.ngens()` mention them.\n\nFixed.\n\n> * `.gen()` fails for pst basis: \n\nFixed, plus a new doctest for it.\n\n> * In the docstring for `.milnor_multiplication_odd()`, could you give a reference for Monks Maple package?\n\nDone, and also in milnor_multiplication().\n\n> * I think the description of `.homogeneous_component()` is a little misleading: I expected it to return the vector space of elements of homogeneous degree `n`, and thus was surprised to get different answers depending on which basis I used.  \n\nMe, too.  It should give vector spaces of the same dimension regardless of the basis.  This turned out to be a bug in the basis algorithm (with profile functions, I was accidentally setting a variable n inside a loop \"for n in range(...)\", so n was being reset in the middle of the loop, causing it to end too early).  This is fixed, and I've added some tests for it, both in homogeneous_component and in steenrod_basis_error_check.\n\n> * `.an_element()` sometimes returns an element which may not be in sub algebra:\n\nFixed.  If the algebra has a profile function, return `1` if the algebra is just the base field, and otherwise return its first generator.  The old behavior, returning some arbitrarily chosen element, is still there for the full Steenrod algebra.\n\n>    * For sub algebras, `.Q()` should throw an error for elements not in the sub algebra (as with `.P()`):\n\nFixed, along with a new doctest.\n\n> * There is a problem with `.antipode()` for sub algebras:\n\nI don't see this one, although it may have been fixed by one of the other fixes.  I've added a doctest for it anyway.\n\n> * problems with coercion:\n\n\n```\nsage: H.Sq(2,1) == A.Sq(2,1)\nTrue\nsage: H.Sq(2,1).coproduct() == A.Sq(2,1).coproduct()\nFalse\n \nsage: A.Sq(2,1).coproduct().parent() is A.tensor_square()\nsage: A.tensor_square()(H.Sq(2,1).coproduct())\nTraceback (most recent call last):\n...\nNotImplementedError: \n```\n\nI don't know how to fix this: it has to do with the implementation (or lack thereof) of tensor products.  I don't think it's particular to the Steenrod algebra, so I'd like to have it dealt with on another ticket.\n\n> * printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:\n\nI understand what you're saying, but I think that printing this way is ugly.  (This was one of the reasons for #9370.)  If you really want, I can change it, but I'd rather not.\n\n> * it's too bad that elements do not print in a way that can be typed directly into Sage (I think I read somewhere that this should be done whenever possible).  This could be fixed by allowing the user to declare Sq, P, Q as global functions (e.g. P = A.P) -- perhaps by using the .inject_variables() function -- and changing the Q_i to print as Q(i).  Of course this would work for only one Steenrod algebra (or sub algebra) at a time, but would still be useful for basic testing/playing.\n\nThis is a very interesting idea, but I don't know how to do it right now.  Can `inject_variables` be used to define functions, not just variables?  I'll think about it, but I may want to defer it to a later ticket.",
    "created_at": "2010-12-02T06:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94084",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'>**Comment 9:**</a>
Replying to [@nilesjohnson](#comment%3A8):

Thanks a lot for all the work and careful comments.  Among other things, you've found some bugs in the code, which I think I've fixed.  I'm attaching a new patch, but I'm leaving it as "needs work" while I keep looking at it to see if I can see other issues which need fixing.

> * I really like the [sage.misc.misc.verbose](http://www.sagemath.org/doc/reference/sage/misc/misc.html#sage.misc.misc.verbose) module; I just wanted to remind you about it for  `steenrod_algebra_bases.steenrod_basis_error_check`.

That's a good idea; I've implemented it.

> * Two minor doctest failures; the first occurs because -1 = 10 in GF(11), and Sage prints 10; the second occurs because the way dicts are printed may vary

I don't see these, on either sage.math or on OS X.  What platform are you using?

> * The docstring for `.gens()`, last sentence before EXAMPLES::, should mention the `Q_n`'s too, since both `.gen()` and `.ngens()` mention them.

Fixed.

> * `.gen()` fails for pst basis: 

Fixed, plus a new doctest for it.

> * In the docstring for `.milnor_multiplication_odd()`, could you give a reference for Monks Maple package?

Done, and also in milnor_multiplication().

> * I think the description of `.homogeneous_component()` is a little misleading: I expected it to return the vector space of elements of homogeneous degree `n`, and thus was surprised to get different answers depending on which basis I used.  

Me, too.  It should give vector spaces of the same dimension regardless of the basis.  This turned out to be a bug in the basis algorithm (with profile functions, I was accidentally setting a variable n inside a loop "for n in range(...)", so n was being reset in the middle of the loop, causing it to end too early).  This is fixed, and I've added some tests for it, both in homogeneous_component and in steenrod_basis_error_check.

> * `.an_element()` sometimes returns an element which may not be in sub algebra:

Fixed.  If the algebra has a profile function, return `1` if the algebra is just the base field, and otherwise return its first generator.  The old behavior, returning some arbitrarily chosen element, is still there for the full Steenrod algebra.

>    * For sub algebras, `.Q()` should throw an error for elements not in the sub algebra (as with `.P()`):

Fixed, along with a new doctest.

> * There is a problem with `.antipode()` for sub algebras:

I don't see this one, although it may have been fixed by one of the other fixes.  I've added a doctest for it anyway.

> * problems with coercion:


```
sage: H.Sq(2,1) == A.Sq(2,1)
True
sage: H.Sq(2,1).coproduct() == A.Sq(2,1).coproduct()
False
 
sage: A.Sq(2,1).coproduct().parent() is A.tensor_square()
sage: A.tensor_square()(H.Sq(2,1).coproduct())
Traceback (most recent call last):
...
NotImplementedError: 
```

I don't know how to fix this: it has to do with the implementation (or lack thereof) of tensor products.  I don't think it's particular to the Steenrod algebra, so I'd like to have it dealt with on another ticket.

> * printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:

I understand what you're saying, but I think that printing this way is ugly.  (This was one of the reasons for #9370.)  If you really want, I can change it, but I'd rather not.

> * it's too bad that elements do not print in a way that can be typed directly into Sage (I think I read somewhere that this should be done whenever possible).  This could be fixed by allowing the user to declare Sq, P, Q as global functions (e.g. P = A.P) -- perhaps by using the .inject_variables() function -- and changing the Q_i to print as Q(i).  Of course this would work for only one Steenrod algebra (or sub algebra) at a time, but would still be useful for basic testing/playing.

This is a very interesting idea, but I don't know how to do it right now.  Can `inject_variables` be used to define functions, not just variables?  I'll think about it, but I may want to defer it to a later ticket.



---

archive/issue_comments_094085.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nReplying to [@jhpalmieri](#comment%3A9):\n> Replying to [@nilesjohnson](#comment%3A8):\n> \n> Thanks a lot for all the work and careful comments.  Among other things, you've found some bugs in the code, which I think I've fixed.  I'm attaching a new patch, but I'm leaving it as \"needs work\" while I keep looking at it to see if I can see other issues which need fixing.\n\nGlad to help; I'll keep looking too.  For now, some continued discussion of printing and `.inject_variables()` . . .\n\n> > * Two minor doctest failures\n\n> I don't see these, on either sage.math or on OS X.  What platform are you using?\n\nI'm using OS X, but Sage 4.5.2 for the first round of reviewing -- maybe recent changes have fixed these problems.\n\n\n> > * problems with coercion:\n\n> \n> I don't know how to fix this: it has to do with the implementation (or lack thereof) of tensor products.  I don't think it's particular to the Steenrod algebra, so I'd like to have it dealt with on another ticket.\n> \n\nThat sounds reasonable -- I'll try to work out the issue and put up a ticket (unless you already know what the problem is).\n\n> > * printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:\n\n> \n> I understand what you're saying, but I think that printing this way is ugly.  (This was one of the reasons for #9370.)  If you really want, I can change it, but I'd rather not.\n\nWell, I'm not sure if this is a decision that should depend solely on my opinion or yours; my thinking is that we should opt for consistency over aesthetics unless there is a really good reason not to.  Every other ring in Sage prints multiplication as `*` -- do you have a good reason to reverse that convention for the Steenrod algebra? (As you point out, this is related to the question of whether or not #9370 is a good idea -- something I'm not sure of yet.) In particular, printing `*` is consistent with the way Sage requires input to be typed (although note my further comments on that topic below).\n\n\n> \n> > * it's too bad that elements do not print in a way that can be typed directly into Sage (I think I read somewhere that this should be done whenever possible).  \n\nAfter some looking, I think what I was remembering is this section of the [interactive shell tutorial](http://www.sagemath.org/doc/tutorial/interactive_shell.html#saving-and-loading-individual-objects), which mentions this idea as a possible way for printing objects, but one which Sage does not enforce -- rather it suggests using un/pickling to store and retrieve objects.  Nevertheless, I think printing as closely as possible to valid input is useful, especially for new users.\n\n> Can `inject_variables` be used to define functions, not just variables?  I'll think about it, but I may want to defer it to a later ticket.\n\nFair enough; something like this does work for [infinite polynomial rings](http://www.sagemath.org/doc/reference/sage/rings/polynomial/infinite_polynomial_element.html):\n\n```\nsage: R = InfinitePolynomialRing(ZZ,'t')\nsage: R\nInfinite polynomial ring in t over Integer Ring\nsage: R.inject_variables()\nDefining t\nsage: R.gens()\n(t_*,)\nsage: t[2]\nt_2\nsage: t[3]\nt_3\nsage: t[2]*t[3] - 4*t[11] + 8\n-4*t_11 + t_3*t_2 + 8\nsage: t[2]*t[3] - 4*t[11] + 8 in R\nTrue\n```\n\nI think the way this is implemented is by defining a `__getitem__` method for the generator, but the same should work by defining a `__call__` method.  (And I did notice, by the way, that the objects don't print in the same way that they have to be input.)  For infinite polynomial rings, `.inject_variables()` is inherited from `sage.structure.category_object.CategoryObject`:\n\n```\n    def inject_variables(self, scope=None, verbose=True):\n        \"\"\"\n        Inject the generators of self with their names into the\n        namespace of the Python code from which this function is\n        called.  Thus, e.g., if the generators of self are labeled\n        'a', 'b', and 'c', then after calling this method the\n        variables a, b, and c in the current scope will be set\n        equal to the generators of self.\n\n        NOTE: If Foo is a constructor for a Sage object with generators, and\n        Foo is defined in Cython, then it would typically call\n        ``inject_variables()`` on the object it creates.  E.g.,\n        ``PolynomialRing(QQ, 'y')`` does this so that the variable y is the\n        generator of the polynomial ring.\n        \"\"\"\n        vs = self.variable_names()\n        gs = self.gens()\n        if scope is None:\n           scope = globals()\n        if verbose:\n           print \"Defining %s\"%(', '.join(vs))\n        for v, g in zip(vs, gs):\n           scope[v] = g\n```\n\nSo if you want to use it, you would have to re-think what is returned by `.gens()`, especially in the case of finitely-generated sub algebras.  Of course you could make a new definition of `.inject_variables()`, but it's not clear this is a good idea either . . . I think this is worth a little more thought, but shouldn't derail the rest of this ticket.",
    "created_at": "2010-12-02T16:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94085",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:10'>**Comment 10:**</a>
Replying to [@jhpalmieri](#comment%3A9):
> Replying to [@nilesjohnson](#comment%3A8):
> 
> Thanks a lot for all the work and careful comments.  Among other things, you've found some bugs in the code, which I think I've fixed.  I'm attaching a new patch, but I'm leaving it as "needs work" while I keep looking at it to see if I can see other issues which need fixing.

Glad to help; I'll keep looking too.  For now, some continued discussion of printing and `.inject_variables()` . . .

> > * Two minor doctest failures

> I don't see these, on either sage.math or on OS X.  What platform are you using?

I'm using OS X, but Sage 4.5.2 for the first round of reviewing -- maybe recent changes have fixed these problems.


> > * problems with coercion:

> 
> I don't know how to fix this: it has to do with the implementation (or lack thereof) of tensor products.  I don't think it's particular to the Steenrod algebra, so I'd like to have it dealt with on another ticket.
> 

That sounds reasonable -- I'll try to work out the issue and put up a ticket (unless you already know what the problem is).

> > * printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:

> 
> I understand what you're saying, but I think that printing this way is ugly.  (This was one of the reasons for #9370.)  If you really want, I can change it, but I'd rather not.

Well, I'm not sure if this is a decision that should depend solely on my opinion or yours; my thinking is that we should opt for consistency over aesthetics unless there is a really good reason not to.  Every other ring in Sage prints multiplication as `*` -- do you have a good reason to reverse that convention for the Steenrod algebra? (As you point out, this is related to the question of whether or not #9370 is a good idea -- something I'm not sure of yet.) In particular, printing `*` is consistent with the way Sage requires input to be typed (although note my further comments on that topic below).


> 
> > * it's too bad that elements do not print in a way that can be typed directly into Sage (I think I read somewhere that this should be done whenever possible).  

After some looking, I think what I was remembering is this section of the [interactive shell tutorial](http://www.sagemath.org/doc/tutorial/interactive_shell.html#saving-and-loading-individual-objects), which mentions this idea as a possible way for printing objects, but one which Sage does not enforce -- rather it suggests using un/pickling to store and retrieve objects.  Nevertheless, I think printing as closely as possible to valid input is useful, especially for new users.

> Can `inject_variables` be used to define functions, not just variables?  I'll think about it, but I may want to defer it to a later ticket.

Fair enough; something like this does work for [infinite polynomial rings](http://www.sagemath.org/doc/reference/sage/rings/polynomial/infinite_polynomial_element.html):

```
sage: R = InfinitePolynomialRing(ZZ,'t')
sage: R
Infinite polynomial ring in t over Integer Ring
sage: R.inject_variables()
Defining t
sage: R.gens()
(t_*,)
sage: t[2]
t_2
sage: t[3]
t_3
sage: t[2]*t[3] - 4*t[11] + 8
-4*t_11 + t_3*t_2 + 8
sage: t[2]*t[3] - 4*t[11] + 8 in R
True
```

I think the way this is implemented is by defining a `__getitem__` method for the generator, but the same should work by defining a `__call__` method.  (And I did notice, by the way, that the objects don't print in the same way that they have to be input.)  For infinite polynomial rings, `.inject_variables()` is inherited from `sage.structure.category_object.CategoryObject`:

```
    def inject_variables(self, scope=None, verbose=True):
        """
        Inject the generators of self with their names into the
        namespace of the Python code from which this function is
        called.  Thus, e.g., if the generators of self are labeled
        'a', 'b', and 'c', then after calling this method the
        variables a, b, and c in the current scope will be set
        equal to the generators of self.

        NOTE: If Foo is a constructor for a Sage object with generators, and
        Foo is defined in Cython, then it would typically call
        ``inject_variables()`` on the object it creates.  E.g.,
        ``PolynomialRing(QQ, 'y')`` does this so that the variable y is the
        generator of the polynomial ring.
        """
        vs = self.variable_names()
        gs = self.gens()
        if scope is None:
           scope = globals()
        if verbose:
           print "Defining %s"%(', '.join(vs))
        for v, g in zip(vs, gs):
           scope[v] = g
```

So if you want to use it, you would have to re-think what is returned by `.gens()`, especially in the case of finitely-generated sub algebras.  Of course you could make a new definition of `.inject_variables()`, but it's not clear this is a good idea either . . . I think this is worth a little more thought, but shouldn't derail the rest of this ticket.



---

archive/issue_comments_094086.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -40,4 +40,8 @@\n \n Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.\n \n-This patch depends on #9370.\n+\n+## Apply\n+\n+1. Patch from #9370.\n+2. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch).\n``````\n",
    "created_at": "2010-12-02T16:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94086",
    "user": "https://github.com/nilesjohnson"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -40,4 +40,8 @@
 
 Unfortunately, since the patch moves files around, it is large.  It also trivially affects a few doctests in sageinspect, which means that it requires a patch to sagenb.
 
-This patch depends on #9370.
+
+## Apply
+
+1. Patch from #9370.
+2. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch).
``````




---

archive/issue_comments_094087.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nReplying to [@nilesjohnson](#comment%3A10):\n> > > * problems with coercion:\n\n> > \n> > I don't know how to fix this: it has to do with the implementation (or lack thereof) of tensor products.  I don't think it's particular to the Steenrod algebra, so I'd like to have it dealt with on another ticket.\n> > \n\n> \n> That sounds reasonable -- I'll try to work out the issue and put up a ticket (unless you already know what the problem is).\n\nI don't know what the ticket is, although some of the sage-combinat people probably do.\n\n> > > * printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:\n\n> > \n> > I understand what you're saying, but I think that printing this way is ugly.  (This was one of the reasons for #9370.)  If you really want, I can change it, but I'd rather not.\n\n> \n> Well, I'm not sure if this is a decision that should depend solely on my opinion or yours; my thinking is that we should opt for consistency over aesthetics unless there is a really good reason not to.  Every other ring in Sage prints multiplication as `*` -- do you have a good reason to reverse that convention for the Steenrod algebra?\n\nI would interpret this another way: you include a `*` when you need to in order to prevent ambiguity.  In a situation where you can have polynomial generators called 'xy' and 'yx' (which would be terrible choices, but anyway), you have to include `*` so that you you can read `xy * yx` properly.  So you need `*` in a polynomial algebra, or in any algebra in which the generators have user-specified names.  But for the Steenrod algebra, there are no such possibilities of ambiguity, so you don't need the `*`.\n\nThat's my justification, anyway.\n\nA different way to interpret it: symbols like \"Q_{0} Q_{1} P(1,3,2)\" could be viewed as atomic: they are basis elements for the Steenrod algebra.  So it's reasonable to print them without asterisks.  Then the question is whether to insist on a `*` between a scalar and a basis element, which I just think looks bad, although it is mostly the convention in Sage.\n\nA third view: the existing implementation of the Steenrod algebra doesn't use `*`.  I haven't heard any comment about this before, so I don't think it's confused anyone so far.  So for consistency :), we should keep it as is.\n\n---\n\nI'll keep thinking about the `inject_variables` issue, also.  Meanwhile, I'm attaching a revised version of the v3 patch; compared to the last one, this just fixes some typos and cleans up the documentation a little.  It also changes the file sage/categories/coalgebras_with_basis.py, to get rid of a warning when building the docs.  This passes all tests on sage.math, and it passes selected tests on OS X and Solaris.  (I haven't had time to run a full test suite on these other platforms, but tests pass on all files which I think should be affected.)",
    "created_at": "2010-12-03T23:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94087",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'>**Comment 11:**</a>
Replying to [@nilesjohnson](#comment%3A10):
> > > * problems with coercion:

> > 
> > I don't know how to fix this: it has to do with the implementation (or lack thereof) of tensor products.  I don't think it's particular to the Steenrod algebra, so I'd like to have it dealt with on another ticket.
> > 

> 
> That sounds reasonable -- I'll try to work out the issue and put up a ticket (unless you already know what the problem is).

I don't know what the ticket is, although some of the sage-combinat people probably do.

> > > * printing of elements:  to be consistent with the rest of sage, perhaps multiplication should print as `*`:

> > 
> > I understand what you're saying, but I think that printing this way is ugly.  (This was one of the reasons for #9370.)  If you really want, I can change it, but I'd rather not.

> 
> Well, I'm not sure if this is a decision that should depend solely on my opinion or yours; my thinking is that we should opt for consistency over aesthetics unless there is a really good reason not to.  Every other ring in Sage prints multiplication as `*` -- do you have a good reason to reverse that convention for the Steenrod algebra?

I would interpret this another way: you include a `*` when you need to in order to prevent ambiguity.  In a situation where you can have polynomial generators called 'xy' and 'yx' (which would be terrible choices, but anyway), you have to include `*` so that you you can read `xy * yx` properly.  So you need `*` in a polynomial algebra, or in any algebra in which the generators have user-specified names.  But for the Steenrod algebra, there are no such possibilities of ambiguity, so you don't need the `*`.

That's my justification, anyway.

A different way to interpret it: symbols like "Q_{0} Q_{1} P(1,3,2)" could be viewed as atomic: they are basis elements for the Steenrod algebra.  So it's reasonable to print them without asterisks.  Then the question is whether to insist on a `*` between a scalar and a basis element, which I just think looks bad, although it is mostly the convention in Sage.

A third view: the existing implementation of the Steenrod algebra doesn't use `*`.  I haven't heard any comment about this before, so I don't think it's confused anyone so far.  So for consistency :), we should keep it as is.

---

I'll keep thinking about the `inject_variables` issue, also.  Meanwhile, I'm attaching a revised version of the v3 patch; compared to the last one, this just fixes some typos and cleans up the documentation a little.  It also changes the file sage/categories/coalgebras_with_basis.py, to get rid of a warning when building the docs.  This passes all tests on sage.math, and it passes selected tests on OS X and Solaris.  (I haven't had time to run a full test suite on these other platforms, but tests pass on all files which I think should be affected.)



---

archive/issue_events_110183.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-12-03T23:48:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110183"
}
```



---

archive/issue_events_110184.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-12-03T23:48:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110184"
}
```



---

archive/issue_comments_094088.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nReplying to [@jhpalmieri](#comment%3A11):\n> I don't know what the ticket is, although some of the sage-combinat people probably do.\n\nSorry, I meant to say \"I don't know what the issue is...\"",
    "created_at": "2010-12-03T23:48:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94088",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'>**Comment 12:**</a>
Replying to [@jhpalmieri](#comment%3A11):
> I don't know what the ticket is, although some of the sage-combinat people probably do.

Sorry, I meant to say "I don't know what the issue is..."



---

archive/issue_comments_094089.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nFor the buildbot:\n\napply trac_10052-steenrod.v3.patch, trac_10052-sagenb.patch",
    "created_at": "2010-12-04T16:43:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94089",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'>**Comment 13:**</a>
For the buildbot:

apply trac_10052-steenrod.v3.patch, trac_10052-sagenb.patch



---

archive/issue_comments_094090.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nFor the buildbot:\n\nDepends on #9370",
    "created_at": "2010-12-04T19:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94090",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:14'>**Comment 14:**</a>
For the buildbot:

Depends on #9370



---

archive/issue_comments_094091.json:
```json
{
    "body": "**Changing work issues** from \"minor docstring issues, problems with sub-Hopf algebras\" to \"\".",
    "created_at": "2010-12-11T17:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94091",
    "user": "https://github.com/nilesjohnson"
}
```

**Changing work issues** from "minor docstring issues, problems with sub-Hopf algebras" to "".



---

archive/issue_comments_094092.json:
```json
{
    "body": "**Reviewer:** Niles Johnson",
    "created_at": "2010-12-11T17:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94092",
    "user": "https://github.com/nilesjohnson"
}
```

**Reviewer:** Niles Johnson



---

archive/issue_comments_094093.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@jhpalmieri](#comment%3A11):\n> I would interpret this another way: you include a `*` when you need to in order to prevent ambiguity.  In a situation where you can have polynomial generators called 'xy' and 'yx' (which would be terrible choices, but anyway), you have to include `*` so that you you can read `xy * yx` properly.  So you need `*` in a polynomial algebra, or in any algebra in which the generators have user-specified names.  But for the Steenrod algebra, there are no such possibilities of ambiguity, so you don't need the `*`.\n\nok, fair enough\n\n\nI've started looking at this again, and I get two errors trying to apply the v3 patch (sage 4.6); here are the contents of the .rej file:\n\n```\n--- coalgebras_with_basis.py\n+++ coalgebras_with_basis.py\n@@ -91,7 +91,7 @@\n         @lazy_attribute\n         def coproduct(self):\n             \"\"\"\n-            If :meth:`.coproduct_on_basis` is available, construct the\n+            If :meth:`coproduct_on_basis` is available, construct the\n             coproduct morphism from ``self`` to ``self`` `\\otimes`\n             ``self`` by extending it by linearity\n \n@@ -115,7 +115,7 @@\n         @lazy_attribute\n         def counit(self):\n             \"\"\"\n-            If :meth:`.counit_on_basis` is available, construct the\n+            If :meth:`counit_on_basis` is available, construct the\n             counit morphism from ``self`` to ``self`` `\\otimes`\n             ``self`` by extending it by linearity\n```\n\nI'll keep looking at the patch, since these won't affect the functionality.",
    "created_at": "2010-12-11T17:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94093",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@jhpalmieri](#comment%3A11):
> I would interpret this another way: you include a `*` when you need to in order to prevent ambiguity.  In a situation where you can have polynomial generators called 'xy' and 'yx' (which would be terrible choices, but anyway), you have to include `*` so that you you can read `xy * yx` properly.  So you need `*` in a polynomial algebra, or in any algebra in which the generators have user-specified names.  But for the Steenrod algebra, there are no such possibilities of ambiguity, so you don't need the `*`.

ok, fair enough


I've started looking at this again, and I get two errors trying to apply the v3 patch (sage 4.6); here are the contents of the .rej file:

```
--- coalgebras_with_basis.py
+++ coalgebras_with_basis.py
@@ -91,7 +91,7 @@
         @lazy_attribute
         def coproduct(self):
             """
-            If :meth:`.coproduct_on_basis` is available, construct the
+            If :meth:`coproduct_on_basis` is available, construct the
             coproduct morphism from ``self`` to ``self`` `\otimes`
             ``self`` by extending it by linearity
 
@@ -115,7 +115,7 @@
         @lazy_attribute
         def counit(self):
             """
-            If :meth:`.counit_on_basis` is available, construct the
+            If :meth:`counit_on_basis` is available, construct the
             counit morphism from ``self`` to ``self`` `\otimes`
             ``self`` by extending it by linearity
```

I'll keep looking at the patch, since these won't affect the functionality.



---

archive/issue_comments_094094.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nThe patch bot can't seem to apply that patch either.  I think I based this on 4.6.1.alpha2, so there must be some additional dependency.  I'll try to track it down today.",
    "created_at": "2010-12-11T19:20:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94094",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'>**Comment 16:**</a>
The patch bot can't seem to apply that patch either.  I think I based this on 4.6.1.alpha2, so there must be some additional dependency.  I'll try to track it down today.



---

archive/issue_comments_094095.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nDepends on #9370 and #8589.\n\n(The second of these was merged into 4.6.1.alpha0.)",
    "created_at": "2010-12-11T20:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94095",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'>**Comment 17:**</a>
Depends on #9370 and #8589.

(The second of these was merged into 4.6.1.alpha0.)



---

archive/issue_comments_094096.json:
```json
{
    "body": "Diff between v2 and v3 (for reference only)",
    "created_at": "2010-12-15T18:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94096",
    "user": "https://github.com/jhpalmieri"
}
```

Diff between v2 and v3 (for reference only)



---

archive/issue_comments_094097.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\n**Attachment:** [trac_10052-steenrod.delta2to3.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.delta2to3.patch.gz)\n\nHere is a slightly modified v3 patch, fixing a little documentation and (more importantly) a bug in the validity checking for profile functions, pointed out by Bob Bruner.",
    "created_at": "2010-12-15T18:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94097",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'>**Comment 18:**</a>
**Attachment:** [trac_10052-steenrod.delta2to3.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.delta2to3.patch.gz)

Here is a slightly modified v3 patch, fixing a little documentation and (more importantly) a bug in the validity checking for profile functions, pointed out by Bob Bruner.



---

archive/issue_comments_094098.json:
```json
{
    "body": "**Attachment:** [trac_10052-steenrod.v3.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch.gz)\n\nversion 3. depends on #9370",
    "created_at": "2010-12-16T21:46:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94098",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_10052-steenrod.v3.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch.gz)

version 3. depends on #9370



---

archive/issue_comments_094099.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nThe \"delta2to3\" patch is now slightly out of date.  If I have time, I'll fix this, but for now, the last line in \n\n```\n        if truncation_type > 0:\n            k = k + [2]\n        else:\n            k = k + [1]\n```\n(from `is_valid_profile` in steenrod_algebra_misc.py) has been changed:\n\n```\n        if truncation_type > 0:\n            k = k + [2]\n        else:\n            k = k + [1]*len(profile[0])\n```",
    "created_at": "2010-12-16T21:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94099",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'>**Comment 19:**</a>
The "delta2to3" patch is now slightly out of date.  If I have time, I'll fix this, but for now, the last line in 

```
        if truncation_type > 0:
            k = k + [2]
        else:
            k = k + [1]
```
(from `is_valid_profile` in steenrod_algebra_misc.py) has been changed:

```
        if truncation_type > 0:
            k = k + [2]
        else:
            k = k + [1]*len(profile[0])
```



---

archive/issue_comments_094100.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nFor the buildbot:\n\nDepends on #9370, #8589.\n\nApply  [[attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/0b5814cc45492e2610d7ea8c7d4568af.patch](https://github.com/sagemath/sage/files/ticket10052/460f0039477c5ef095bb9fc12c08d0a4.patch),)\n\n(p.s. I haven't forgotten about this :)",
    "created_at": "2010-12-20T18:36:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94100",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:20'>**Comment 20:**</a>
For the buildbot:

Depends on #9370, #8589.

Apply  [[attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/0b5814cc45492e2610d7ea8c7d4568af.patch](https://github.com/sagemath/sage/files/ticket10052/460f0039477c5ef095bb9fc12c08d0a4.patch),)

(p.s. I haven't forgotten about this :)



---

archive/issue_comments_094101.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -44,4 +44,6 @@\n ## Apply\n \n 1. Patch from #9370.\n-2. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch).\n+2. Patch from #8589 (merged into 4.6.1.alpha0)\n+3. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch)\n+4. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)\n``````\n",
    "created_at": "2010-12-20T18:36:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94101",
    "user": "https://github.com/nilesjohnson"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -44,4 +44,6 @@
 ## Apply
 
 1. Patch from #9370.
-2. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch).
+2. Patch from #8589 (merged into 4.6.1.alpha0)
+3. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch)
+4. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)
``````




---

archive/issue_comments_094102.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nApply  trac_10052-steenrod.v3.patch, trac_10052-sagenb.patch",
    "created_at": "2010-12-20T18:38:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94102",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:21'>**Comment 21:**</a>
Apply  trac_10052-steenrod.v3.patch, trac_10052-sagenb.patch



---

archive/issue_comments_094103.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nI'm ready to give this a positive review, but now (Sage 4.6.2) I'm getting a failing doctest with `latex` on a coproduct (note the missing `1` at the end of the latex string):\n\n```\nsage: A7 = SteenrodAlgebra(7)\nsage: c = Sq(2).change_basis('adem').coproduct()\nsage: c\n1 # Sq^2 + Sq^1 # Sq^1 + Sq^2 # 1\nsage: latex(c)\n1 \\otimes \\text{Sq}^{2} + \\text{Sq}^{1} \\otimes \\text{Sq}^{1} + \\text{Sq}^{2} \\otimes \n```\n\nThis is probably related to bugs in the code for tensor products of algebras, but I haven't been able to track down the precise problem.",
    "created_at": "2011-03-10T18:54:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94103",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:22'>**Comment 22:**</a>
I'm ready to give this a positive review, but now (Sage 4.6.2) I'm getting a failing doctest with `latex` on a coproduct (note the missing `1` at the end of the latex string):

```
sage: A7 = SteenrodAlgebra(7)
sage: c = Sq(2).change_basis('adem').coproduct()
sage: c
1 # Sq^2 + Sq^1 # Sq^1 + Sq^2 # 1
sage: latex(c)
1 \otimes \text{Sq}^{2} + \text{Sq}^{1} \otimes \text{Sq}^{1} + \text{Sq}^{2} \otimes 
```

This is probably related to bugs in the code for tensor products of algebras, but I haven't been able to track down the precise problem.



---

archive/issue_events_110185.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2011-03-10T18:54:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110185"
}
```



---

archive/issue_events_110186.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2011-03-10T18:54:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110186"
}
```



---

archive/issue_comments_094104.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nThanks for keeping an eye on this.  The latex/coproduct bug is because of #9370, not because of anything here.  I think I know how to fix it.\n\nMeanwhile, there may be a bug in profile functions for the odd primary Steenrod algebra, so give me a few days to check it out and fix it.  (I'm leaving this as \"needs work\" until I get it straightened out.)",
    "created_at": "2011-03-11T22:28:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94104",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'>**Comment 23:**</a>
Thanks for keeping an eye on this.  The latex/coproduct bug is because of #9370, not because of anything here.  I think I know how to fix it.

Meanwhile, there may be a bug in profile functions for the odd primary Steenrod algebra, so give me a few days to check it out and fix it.  (I'm leaving this as "needs work" until I get it straightened out.)



---

archive/issue_events_110187.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-03-16T20:30:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110187"
}
```



---

archive/issue_events_110188.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-03-16T20:30:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110188"
}
```



---

archive/issue_comments_094105.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\n#9370 has a positive review, and the most recent patch there fixes the coproduct bug.  Meanwhile, there was a bug with profile functions.  The new \"v4\" patch fixes it.  I've also included a delta patch to help with reviewing.  (The delta patch may not be completely accurate; I may have tinkered with some doctests for `normalize_profile` and those changes may not be recorded in the delta patch because I got lazy.)\n\nApply only trac_10052-steenrod.v4.patch.\n\nDepends on #9370.",
    "created_at": "2011-03-16T20:30:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94105",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'>**Comment 24:**</a>
#9370 has a positive review, and the most recent patch there fixes the coproduct bug.  Meanwhile, there was a bug with profile functions.  The new "v4" patch fixes it.  I've also included a delta patch to help with reviewing.  (The delta patch may not be completely accurate; I may have tinkered with some doctests for `normalize_profile` and those changes may not be recorded in the delta patch because I got lazy.)

Apply only trac_10052-steenrod.v4.patch.

Depends on #9370.



---

archive/issue_comments_094106.json:
```json
{
    "body": "Diff between v3 and v4 (for reference only)",
    "created_at": "2011-03-16T20:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94106",
    "user": "https://github.com/jhpalmieri"
}
```

Diff between v3 and v4 (for reference only)



---

archive/issue_comments_094107.json:
```json
{
    "body": "**Attachment:** [trac_10052-steenrod.delta3to4.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.delta3to4.patch.gz)\n\nversion 4. depends on #9370",
    "created_at": "2011-03-16T20:31:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94107",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_10052-steenrod.delta3to4.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.delta3to4.patch.gz)

version 4. depends on #9370



---

archive/issue_comments_094108.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\n**Attachment:** [trac_10052-steenrod.v4.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v4.patch.gz)\n\nPatchbot: apply trac_10052-steenrod.v4.patch",
    "created_at": "2011-04-28T13:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94108",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:25'>**Comment 25:**</a>
**Attachment:** [trac_10052-steenrod.v4.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v4.patch.gz)

Patchbot: apply trac_10052-steenrod.v4.patch



---

archive/issue_events_110189.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2011-05-31T07:29:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110189"
}
```



---

archive/issue_events_110190.json:
```json
{
    "actor": "https://github.com/nilesjohnson",
    "created_at": "2011-05-31T07:29:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110190"
}
```



---

archive/issue_comments_094109.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nOk, I've finally gotten back to looking at this.  With the following, I'm giving this a positive review\n\n* The patchs apply cleanly to Sage 4.7, and pass all (long) tests for me.  \n\n* The documentation builds without warning, looks good\n\n* Complete doctest coverage\n\n* The previous issues I noticed (comment:8) have all been addressed, as well as some others, and now I see no problems with the functionality\n\n* The code is free from obvious inefficiencies (e.g. in memory management, error handling)\n\n* In general, this is well-written, well-documented, and a substantial improvement!",
    "created_at": "2011-05-31T07:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94109",
    "user": "https://github.com/nilesjohnson"
}
```

<a id='comment:26'>**Comment 26:**</a>
Ok, I've finally gotten back to looking at this.  With the following, I'm giving this a positive review

* The patchs apply cleanly to Sage 4.7, and pass all (long) tests for me.  

* The documentation builds without warning, looks good

* Complete doctest coverage

* The previous issues I noticed (comment:8) have all been addressed, as well as some others, and now I see no problems with the functionality

* The code is free from obvious inefficiencies (e.g. in memory management, error handling)

* In general, this is well-written, well-documented, and a substantial improvement!



---

archive/issue_comments_094110.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nThis needs to be rebased to sage-4.7.1.alpha2.",
    "created_at": "2011-06-08T20:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94110",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'>**Comment 27:**</a>
This needs to be rebased to sage-4.7.1.alpha2.



---

archive/issue_events_110191.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-08T20:58:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110191"
}
```



---

archive/issue_events_110192.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-08T20:58:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110192"
}
```



---

archive/issue_comments_094111.json:
```json
{
    "body": "**Attachment:** [trac_10052-steenrod.rebased.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.rebased.patch.gz)\n\nrebased to 4.7.1.alpha2",
    "created_at": "2011-06-08T23:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94111",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_10052-steenrod.rebased.patch.gz](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.rebased.patch.gz)

rebased to 4.7.1.alpha2



---

archive/issue_events_110193.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-06-08T23:01:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110193"
}
```



---

archive/issue_events_110194.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-06-08T23:01:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110194"
}
```



---

archive/issue_comments_094112.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -43,7 +43,5 @@\n \n ## Apply\n \n-1. Patch from #9370.\n-2. Patch from #8589 (merged into 4.6.1.alpha0)\n-3. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch)\n-4. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)\n+1. [attachment:trac_10052-steenrod.rebased.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.rebased.patch)\n+2. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)\n``````\n",
    "created_at": "2011-06-08T23:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94112",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -43,7 +43,5 @@
 
 ## Apply
 
-1. Patch from #9370.
-2. Patch from #8589 (merged into 4.6.1.alpha0)
-3. [attachment:trac_10052-steenrod.v3.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.v3.patch)
-4. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)
+1. [attachment:trac_10052-steenrod.rebased.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-steenrod.rebased.patch)
+2. [attachment:trac_10052-sagenb.patch](https://github.com/sagemath/sage/files/ticket10052/trac_10052-sagenb.patch)
``````




---

archive/issue_events_110195.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-09T11:56:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110195"
}
```



---

archive/issue_events_110196.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-09T11:56:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10052#event-110196"
}
```



---

archive/issue_comments_094113.json:
```json
{
    "body": "**Merged:** sage-4.7.1.alpha3",
    "created_at": "2011-06-09T11:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10052#issuecomment-94113",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.1.alpha3
