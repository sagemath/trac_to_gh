# Issue 10064: -1 in expression "is_positive".

archive/issues_010063.json:
```json
{
    "body": "I test :\n\n```\ny = I*I*x / x # so y is the expression -1\ny._is_positive()  # the answer is True (and I dislike)\nz = -x / x \nz._is_positive()   # the answer is False \nbool (z == y) # the answer is True\n```\n\nApply [attachment:trac_10064.sage-5.10.beta5.patch].\n\nAssignee: @burcin\n\nCC:  @robertwb @kcrisman\n\nKeywords: sd35\n\nReviewer: Burcin Erocal\n\nAuthor: Mike Hansen\n\nMerged: sage-5.11.beta1\n\nDependencies: #7160\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10064\n\n",
    "closed_at": "2013-06-10T08:41:51Z",
    "created_at": "2010-10-03T18:04:13Z",
    "labels": [
        "component: calculus",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.11",
    "title": "-1 in expression \"is_positive\".",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10064",
    "user": "https://trac.sagemath.org/admin/accounts/users/fmaltey"
}
```
I test :

```
y = I*I*x / x # so y is the expression -1
y._is_positive()  # the answer is True (and I dislike)
z = -x / x 
z._is_positive()   # the answer is False 
bool (z == y) # the answer is True
```

Apply [attachment:trac_10064.sage-5.10.beta5.patch].

Assignee: @burcin

CC:  @robertwb @kcrisman

Keywords: sd35

Reviewer: Burcin Erocal

Author: Mike Hansen

Merged: sage-5.11.beta1

Dependencies: #7160

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10064





---

archive/issue_events_025592.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-10-16T20:45:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25592"
}
```



---

archive/issue_comments_121788.json:
```json
{
    "body": "<a id='comment:1'></a>Simpler example:\n\n```\nsage: (I*I)._is_positive()\nTrue\nsage: I*I\n-1\n```\n\nThe `is_positive()` test in pynac is at line 923 in numeric.cpp:\n\n```\n    case PYOBJECT:\n      n = is_real() && (PyObject_Compare(v._pyobject, ZERO) > 0);\n      if (PyErr_Occurred()) \n\tpy_error(\"is_positive\");\n      return n;\n```\n\nWe use the python comparison. Unfortunately, this doesn't work as expected for number field elements:\n\n```\nsage: m = (I*I).pyobject()\nsage: m.parent()\nNumber Field in I with defining polynomial x^2 + 1\nsage: m > 0\nTrue\nsage: m\n-1\n```",
    "created_at": "2010-10-16T20:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121788",
    "user": "https://github.com/burcin"
}
```

<a id='comment:1'></a>Simpler example:

```
sage: (I*I)._is_positive()
True
sage: I*I
-1
```

The `is_positive()` test in pynac is at line 923 in numeric.cpp:

```
    case PYOBJECT:
      n = is_real() && (PyObject_Compare(v._pyobject, ZERO) > 0);
      if (PyErr_Occurred()) 
	py_error("is_positive");
      return n;
```

We use the python comparison. Unfortunately, this doesn't work as expected for number field elements:

```
sage: m = (I*I).pyobject()
sage: m.parent()
Number Field in I with defining polynomial x^2 + 1
sage: m > 0
True
sage: m
-1
```



---

archive/issue_comments_121789.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-10-16T20:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121789",
    "user": "https://github.com/burcin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_121790.json:
```json
{
    "body": "<a id='comment:2'></a>attachment:trac_10064-compare_I.patch changes the quadratic number field element comparison code to return a more sensible result. Now we have:\n\n```\nsage: m = (I*I).pyobject()\nsage: m > 0\nFalse\nsage: m < 0\nTrue\n```\n\nThis also fixes #10062.",
    "created_at": "2010-10-16T20:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121790",
    "user": "https://github.com/burcin"
}
```

<a id='comment:2'></a>attachment:trac_10064-compare_I.patch changes the quadratic number field element comparison code to return a more sensible result. Now we have:

```
sage: m = (I*I).pyobject()
sage: m > 0
False
sage: m < 0
True
```

This also fixes #10062.



---

archive/issue_comments_121791.json:
```json
{
    "body": "Changing author from \"\" to \"Burcin Erocal\"",
    "created_at": "2010-10-16T20:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121791",
    "user": "https://github.com/burcin"
}
```

Changing author from "" to "Burcin Erocal"



---

archive/issue_comments_121792.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2010-10-16T20:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121792",
    "user": "https://github.com/burcin"
}
```

Changing priority from major to critical.



---

archive/issue_comments_121793.json:
```json
{
    "body": "<a id='comment:3'></a>Here is a small bit of code that breaks (in 4.5.3) with trac_10064-compare_I.patch applied:\n\n```\nK.<a> = QuadraticField(5)\nE = EllipticCurve(K,[-1, -1, 1/2*a + 1/2, -1/2*a - 1/2, 1/2*a + 1/2])\nE.torsion_subgroup()\n```",
    "created_at": "2010-11-02T06:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121793",
    "user": "https://trac.sagemath.org/admin/accounts/users/jgaski"
}
```

<a id='comment:3'></a>Here is a small bit of code that breaks (in 4.5.3) with trac_10064-compare_I.patch applied:

```
K.<a> = QuadraticField(5)
E = EllipticCurve(K,[-1, -1, 1/2*a + 1/2, -1/2*a - 1/2, 1/2*a + 1/2])
E.torsion_subgroup()
```



---

archive/issue_comments_121794.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-11-02T06:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121794",
    "user": "https://trac.sagemath.org/admin/accounts/users/jgaski"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_121795.json:
```json
{
    "body": "<a id='comment:4'></a>Please see http://tinypaste.com/3f27d for the error from the above code snippet.",
    "created_at": "2010-11-03T20:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121795",
    "user": "https://trac.sagemath.org/admin/accounts/users/jgaski"
}
```

<a id='comment:4'></a>Please see http://tinypaste.com/3f27d for the error from the above code snippet.



---

archive/issue_comments_121796.json:
```json
{
    "body": "<a id='comment:6'></a>Apparently related to #7160 and #6132, see [this sage-devel discussion](http://groups.google.com/group/sage-support/browse_thread/thread/28bbd04a78dadb57/01168722573ff736).",
    "created_at": "2011-02-07T15:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121796",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>Apparently related to #7160 and #6132, see [this sage-devel discussion](http://groups.google.com/group/sage-support/browse_thread/thread/28bbd04a78dadb57/01168722573ff736).



---

archive/issue_comments_121797.json:
```json
{
    "body": "Attachment [trac_10064.patch](tarball://root/attachments/some-uuid/ticket10064/trac_10064.patch) by @mwhansen created at 2011-12-19 10:37:44",
    "created_at": "2011-12-19T10:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121797",
    "user": "https://github.com/mwhansen"
}
```

Attachment [trac_10064.patch](tarball://root/attachments/some-uuid/ticket10064/trac_10064.patch) by @mwhansen created at 2011-12-19 10:37:44



---

archive/issue_comments_121798.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-19T10:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121798",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_121799.json:
```json
{
    "body": "Changing dependencies from \"\" to \"7160\"",
    "created_at": "2011-12-19T10:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121799",
    "user": "https://github.com/mwhansen"
}
```

Changing dependencies from "" to "7160"



---

archive/issue_comments_121800.json:
```json
{
    "body": "<a id='comment:7'></a>I've added a patch which verifies that is fixed by #7160.\n\nApply trac_10064.patch",
    "created_at": "2011-12-19T10:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121800",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:7'></a>I've added a patch which verifies that is fixed by #7160.

Apply trac_10064.patch



---

archive/issue_comments_121801.json:
```json
{
    "body": "Changing author from \"Burcin Erocal\" to \"Mike Hansen\"",
    "created_at": "2011-12-19T10:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121801",
    "user": "https://github.com/mwhansen"
}
```

Changing author from "Burcin Erocal" to "Mike Hansen"



---

archive/issue_comments_121802.json:
```json
{
    "body": "Changing dependencies from \"7160\" to \"#7160\"",
    "created_at": "2011-12-19T15:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121802",
    "user": "https://github.com/kcrisman"
}
```

Changing dependencies from "7160" to "#7160"



---

archive/issue_comments_121803.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd35\".",
    "created_at": "2011-12-20T12:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121803",
    "user": "https://github.com/mwhansen"
}
```

Changing keywords from "" to "sd35".



---

archive/issue_comments_121804.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Burcin Erocal\"",
    "created_at": "2012-01-10T05:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121804",
    "user": "https://github.com/burcin"
}
```

Changing reviewer from "" to "Burcin Erocal"



---

archive/issue_comments_121805.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,8 @@\n bool (z == y) # the answer is True\n ```\n \n+Apply attachment:trac_10064.patch.\n+\n Comment: 1\n \n Priority: major\n``````\n",
    "created_at": "2012-01-10T05:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121805",
    "user": "https://github.com/burcin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,8 @@
 bool (z == y) # the answer is True
 ```
 
+Apply attachment:trac_10064.patch.
+
 Comment: 1
 
 Priority: major
``````




---

archive/issue_comments_121806.json:
```json
{
    "body": "<a id='comment:10'></a>Looks good to me.",
    "created_at": "2012-01-10T05:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121806",
    "user": "https://github.com/burcin"
}
```

<a id='comment:10'></a>Looks good to me.



---

archive/issue_events_025593.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-01-10T05:59:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25593"
}
```



---

archive/issue_events_025594.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-01-10T05:59:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25594"
}
```



---

archive/issue_comments_121807.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-01-10T05:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121807",
    "user": "https://github.com/burcin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_025595.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-10T08:47:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25595"
}
```



---

archive/issue_events_025596.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-10T08:47:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25596"
}
```



---

archive/issue_comments_121808.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+I test :\n \n+```\n+y = I*I*x / x # so y is the expression -1\n+y._is_positive()  # the answer is True (and I dislike)\n+z = -x / x \n+z._is_positive()   # the answer is False \n+bool (z == y) # the answer is True\n+```\n+\n+Apply [attachment:trac_10064.sage-5.10.beta5.patch].\n \n Comment: 1\n \n``````\n",
    "created_at": "2013-06-03T14:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121808",
    "user": "https://github.com/burcin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+I test :
 
+```
+y = I*I*x / x # so y is the expression -1
+y._is_positive()  # the answer is True (and I dislike)
+z = -x / x 
+z._is_positive()   # the answer is False 
+bool (z == y) # the answer is True
+```
+
+Apply [attachment:trac_10064.sage-5.10.beta5.patch].
 
 Comment: 1
 
``````




---

archive/issue_events_025597.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2013-06-03T14:08:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25597"
}
```



---

archive/issue_events_025598.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2013-06-03T14:08:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25598"
}
```



---

archive/issue_comments_121809.json:
```json
{
    "body": "<a id='comment:12'></a>Attachment [trac_10064.sage-5.10.beta5.patch](tarball://root/attachments/some-uuid/ticket10064/trac_10064.sage-5.10.beta5.patch) by @burcin created at 2013-06-03 14:08:21\n\nNow that #7160 is fixed (by way of #13213), this can be merged.",
    "created_at": "2013-06-03T14:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121809",
    "user": "https://github.com/burcin"
}
```

<a id='comment:12'></a>Attachment [trac_10064.sage-5.10.beta5.patch](tarball://root/attachments/some-uuid/ticket10064/trac_10064.sage-5.10.beta5.patch) by @burcin created at 2013-06-03 14:08:21

Now that #7160 is fixed (by way of #13213), this can be merged.



---

archive/issue_comments_121810.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.11.beta1\"",
    "created_at": "2013-06-10T08:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121810",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.11.beta1"



---

archive/issue_events_025599.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-10T08:41:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10064#event-25599"
}
```



---

archive/issue_comments_121811.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-06-10T08:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10064#issuecomment-121811",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
