# Issue 10135: eulerian_circuit() of Graph can't handle multiple edges

archive/issues_010134.json:
```json
{
    "body": "This is reported in [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/cb8454790b70a20c).\n\n**Assignee:** @jasongrout, @nathanncohen, @rlmill\n\n**CC:**  brunellus @jasongrout\n\n**Author:** Luk\u00e1\u0161 L\u00e1nsk\u00fd\n\n**Reviewer:** Nathann Cohen\n\n**Merged:** sage-5.0.beta2\n\nIssue created by migration from https://trac.sagemath.org/ticket/10135\n\n",
    "closed_at": "2012-02-02T12:52:17Z",
    "created_at": "2010-10-16T13:39:05Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "eulerian_circuit() of Graph can't handle multiple edges",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10135",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```
This is reported in [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/cb8454790b70a20c).

**Assignee:** @jasongrout, @nathanncohen, @rlmill

**CC:**  brunellus @jasongrout

**Author:** Lukáš Lánský

**Reviewer:** Nathann Cohen

**Merged:** sage-5.0.beta2

Issue created by migration from https://trac.sagemath.org/ticket/10135





---

archive/issue_comments_095308.json:
```json
{
    "body": "<a id='comment:1'></a>\nI see that the function is based on Fleury's algorithm. Would it be plausible if I rewrite it using asymptotically faster Hierholzer's algorithm?",
    "created_at": "2011-12-02T21:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95308",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

<a id='comment:1'></a>
I see that the function is based on Fleury's algorithm. Would it be plausible if I rewrite it using asymptotically faster Hierholzer's algorithm?



---

archive/issue_comments_095309.json:
```json
{
    "body": "<a id='comment:2'></a>\nplausible -> meaningful :-)",
    "created_at": "2011-12-02T21:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95309",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

<a id='comment:2'></a>
plausible -> meaningful :-)



---

archive/issue_comments_095310.json:
```json
{
    "body": "<a id='comment:3'></a>\nIf you've got a better way to do it, go for it!",
    "created_at": "2011-12-03T21:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95310",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
If you've got a better way to do it, go for it!



---

archive/attachments_013232.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10135_eulerian_circuit_rewrite.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10135/trac_10135_eulerian_circuit_rewrite.patch",
    "created_at": "2011-12-06T23:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```



---

archive/issue_comments_095311.json:
```json
{
    "body": "",
    "created_at": "2011-12-06T23:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95311",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```





---

archive/issue_comments_095312.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe patch I just sent strives for three advancements in eulerian_circuit():\n\n* It should close this ticket. :-)\n\n* It should run in O(|E|) time.\n\n* It should find eulerian circualiton in disconnected cases like\n\n```\nGraph({0: [], 1: [2], 2: [3], 3: [1], 4: []})\n```\n\nwhere previous one failed. This is similar to the trac #12108. Notice, that you need to apply the patch I sent to that ticket before testing this code -- if you don't, one of the tests fails because is_eulerian() doesn't work correctly.\n\nDuring testing I was surprised by way Sage handles multiple loops:\n\n```\nsage: g=Graph({0: [0, 0]})\nsage: g.degree(0)\n4\nsage: g.delete_edge(g.edge_iterator(0).next())\nsage: g.degree(0)\n0\n```\n\nI think that Sage should either reject multiple loops at the beginning (merge them to one, for example), or handle them as separate. This is surprising behavior. What do you think?",
    "created_at": "2011-12-06T23:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95312",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

<a id='comment:4'></a>
The patch I just sent strives for three advancements in eulerian_circuit():

* It should close this ticket. :-)

* It should run in O(|E|) time.

* It should find eulerian circualiton in disconnected cases like

```
Graph({0: [], 1: [2], 2: [3], 3: [1], 4: []})
```

where previous one failed. This is similar to the trac #12108. Notice, that you need to apply the patch I sent to that ticket before testing this code -- if you don't, one of the tests fails because is_eulerian() doesn't work correctly.

During testing I was surprised by way Sage handles multiple loops:

```
sage: g=Graph({0: [0, 0]})
sage: g.degree(0)
4
sage: g.delete_edge(g.edge_iterator(0).next())
sage: g.degree(0)
0
```

I think that Sage should either reject multiple loops at the beginning (merge them to one, for example), or handle them as separate. This is surprising behavior. What do you think?



---

archive/issue_events_076820.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/brunellus",
    "created_at": "2011-12-06T23:50:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10135#event-76820"
}
```



---

archive/issue_comments_095313.json:
```json
{
    "body": "<a id='comment:5'></a>\nI started #12135 for the mentioned multiple loops problem.",
    "created_at": "2011-12-11T15:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95313",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

<a id='comment:5'></a>
I started #12135 for the mentioned multiple loops problem.



---

archive/issue_comments_095314.json:
```json
{
    "body": "<a id='comment:6'></a>\nSome additional changes to this code were introduced in #12325. I guess it would be efficient to review both tickets together.",
    "created_at": "2012-01-19T05:20:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95314",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

<a id='comment:6'></a>
Some additional changes to this code were introduced in #12325. I guess it would be efficient to review both tickets together.



---

archive/issue_comments_095315.json:
```json
{
    "body": "**Reviewer:** Nathann Cohen",
    "created_at": "2012-01-26T13:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95315",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Nathann Cohen



---

archive/issue_comments_095316.json:
```json
{
    "body": "<a id='comment:7'></a>\nHelloooooo !!\n\nThis one's good to go, too ! The reverse() function is actually slower than the copy(), but it makes much more sense to solve this problem directly by modifying the backends than by changing this method. Thank you for this patch ! `:-)`\n\nNathann",
    "created_at": "2012-01-26T13:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95316",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>
Helloooooo !!

This one's good to go, too ! The reverse() function is actually slower than the copy(), but it makes much more sense to solve this problem directly by modifying the backends than by changing this method. Thank you for this patch ! `:-)`

Nathann



---

archive/issue_events_076821.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-01-26T13:30:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10135#event-76821"
}
```



---

archive/issue_events_076822.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-01-26T13:30:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10135#event-76822"
}
```



---

archive/issue_comments_095317.json:
```json
{
    "body": "**Author:** Luk\u00e1\u0161 L\u00e1nsk\u00fd",
    "created_at": "2012-01-26T18:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95317",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

**Author:** Lukáš Lánský



---

archive/issue_comments_095318.json:
```json
{
    "body": "**Merged:** sage-5.0.beta2",
    "created_at": "2012-02-02T12:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10135#issuecomment-95318",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.beta2



---

archive/issue_events_076823.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-02T12:52:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10135#event-76823"
}
```



---

archive/issue_events_076824.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-02T12:52:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10135",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10135#event-76824"
}
```
