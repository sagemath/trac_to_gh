# Issue 10548: The coercion model is keeping references to tracebacks which causes memory leaks.

archive/issues_010495.json:
```json
{
    "body": "When I was doing some computations on modular forms, I noticed that the ModularSymbols_clear_cache() was not doing what it claims to do.\n\n```\nsage: import gc  \nsage: m=ModularSymbols(Gamma1(29),sign=1)\nsage: m=[]\nsage: ModularSymbols_clear_cache()\nsage: gc.collect()\n57\nsage: [x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]\n[Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field]\nsage: \n```\nSo even after garbage collection the modular symbols element is still in memory.\n\nWhen testing please also make sure that the last stackframe from #10570 is also gone.\n\nApply [attachment:10548-coerce-traceback.2.patch] and [attachment:trac_10548-coerce-traceback-doctest.v2.patch]\n\n**Assignee:** @robertwb\n\n**CC:**  @loefflerd\n\n**Resolution:** fixed\n\n**Author:** Robert Bradshaw\n\n**Reviewer:** Maarten Derickx\n\n**Merged:** sage-4.7.alpha4\n\nIssue created by migration from https://trac.sagemath.org/ticket/10548\n\n",
    "closed_at": "2011-04-07T19:56:57Z",
    "created_at": "2011-01-03T14:43:49Z",
    "labels": [
        "component: coercion",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "The coercion model is keeping references to tracebacks which causes memory leaks.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10548",
    "user": "https://github.com/koffie"
}
```
When I was doing some computations on modular forms, I noticed that the ModularSymbols_clear_cache() was not doing what it claims to do.

```
sage: import gc  
sage: m=ModularSymbols(Gamma1(29),sign=1)
sage: m=[]
sage: ModularSymbols_clear_cache()
sage: gc.collect()
57
sage: [x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]
[Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field]
sage: 
```
So even after garbage collection the modular symbols element is still in memory.

When testing please also make sure that the last stackframe from #10570 is also gone.

Apply [attachment:10548-coerce-traceback.2.patch] and [attachment:trac_10548-coerce-traceback-doctest.v2.patch]

**Assignee:** @robertwb

**CC:**  @loefflerd

**Resolution:** fixed

**Author:** Robert Bradshaw

**Reviewer:** Maarten Derickx

**Merged:** sage-4.7.alpha4

Issue created by migration from https://trac.sagemath.org/ticket/10548





---

archive/issue_comments_138015.json:
```json
{
    "body": "<a id='comment:1'></a>\nPs. you might want to use smaller numbers then 97 to test because ModularSymbols(Gamma1(97),sign=1) takes a while. It behaves the same, but with smaller memory usage for smaller numbers.",
    "created_at": "2011-01-03T14:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138015",
    "user": "https://github.com/koffie"
}
```

<a id='comment:1'></a>
Ps. you might want to use smaller numbers then 97 to test because ModularSymbols(Gamma1(97),sign=1) takes a while. It behaves the same, but with smaller memory usage for smaller numbers.



---

archive/issue_comments_138016.json:
```json
{
    "body": "<a id='comment:2'></a>\nAccording to heapy the aditional memory comes from;\n\ndict of sage.modular.modsym.manin_symbols.ManinSymbol\n\n\n```\nmderickx@mod:~$ sage\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: import gc\nsage: from guppy import hpy; hp=hpy()\nsage: M=ModularSymbols(Gamma1(97),sign=1)\nsage: get_memory_usage()\n848.1953125\nsage: M=[]\nsage: get_memory_usage()\n848.1953125\nsage: ModularSymbols_clear_cache()\nsage: get_memory_usage()\n848.1953125\nsage: hp.heap()\nPartition of a set of 445281 objects. Total size = 68518056 bytes.\n Index  Count   %     Size   % Cumulative  % Kind (class / dict of class)\n     0 169534  38 28541776  42  28541776  42 str\n     1 125494  28 10674696  16  39216472  57 tuple\n     2   1624   0  3964480   6  43180952  63 dict of module\n     3  25817   6  3098040   5  46278992  68 types.CodeType\n     4  24634   6  2956080   4  49235072  72 function\n     5   2798   1  2949584   4  52184656  76 dict (no owner)\n     6   2660   1  2727392   4  54912048  80 dict of type\n     7   9408   2  2634240   4  57546288  84 dict of sage.modular.modsym.manin_symbols.ManinSymbol\n     8   2660   1  2388040   3  59934328  87 type\n     9   4293   1  1010536   1  60944864  89 list\n<895 more rows. Type e.g. '_.more' to view.>\nsage: \n```\n| Sage Version 4.6, Release Date: 2010-10-30                         |\n| Type notebook() for the GUI, and license() for information.        |",
    "created_at": "2011-01-03T15:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138016",
    "user": "https://github.com/koffie"
}
```

<a id='comment:2'></a>
According to heapy the aditional memory comes from;

dict of sage.modular.modsym.manin_symbols.ManinSymbol


```
mderickx@mod:~$ sage
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: import gc
sage: from guppy import hpy; hp=hpy()
sage: M=ModularSymbols(Gamma1(97),sign=1)
sage: get_memory_usage()
848.1953125
sage: M=[]
sage: get_memory_usage()
848.1953125
sage: ModularSymbols_clear_cache()
sage: get_memory_usage()
848.1953125
sage: hp.heap()
Partition of a set of 445281 objects. Total size = 68518056 bytes.
 Index  Count   %     Size   % Cumulative  % Kind (class / dict of class)
     0 169534  38 28541776  42  28541776  42 str
     1 125494  28 10674696  16  39216472  57 tuple
     2   1624   0  3964480   6  43180952  63 dict of module
     3  25817   6  3098040   5  46278992  68 types.CodeType
     4  24634   6  2956080   4  49235072  72 function
     5   2798   1  2949584   4  52184656  76 dict (no owner)
     6   2660   1  2727392   4  54912048  80 dict of type
     7   9408   2  2634240   4  57546288  84 dict of sage.modular.modsym.manin_symbols.ManinSymbol
     8   2660   1  2388040   3  59934328  87 type
     9   4293   1  1010536   1  60944864  89 list
<895 more rows. Type e.g. '_.more' to view.>
sage: 
```
| Sage Version 4.6, Release Date: 2010-10-30                         |
| Type notebook() for the GUI, and license() for information.        |



---

archive/issue_comments_138017.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,47 +1,14 @@\n-When I was doing some computations on modular forms, I noticed the following strange memory usage behaviour which. After the first two iterations it seems like there is a memory leak. But strangely enough it stops leaking at the third iteration.\n+When I was doing some computations on modular forms, I noticed that the ModularSymbols_clear_cache() was not doing what it claims to do.\n \n ```\n-sage: import gc\n+sage: import gc  \n+sage: ModularSymbols(Gamma1(29),sign=1)\n+Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field\n+sage: ModularSymbols_clear_cache()\n sage: gc.collect()\n-54\n-sage: get_memory_usage()\n-819.7578125\n-sage: for i in xrange(10):\n-....:     ModularSymbols(Gamma1(97),sign=1)\n-....:     ModularSymbols_clear_cache()\n-....:     gc.collect()\n-....:     get_memory_usage()\n-....:     \n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-0\n-842.58984375\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-0\n-860.08203125\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-876.63671875\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-878.2421875\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-878.76953125\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-880.2421875\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-880.2421875\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-880.2421875\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-880.2421875\n-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field\n-37640\n-880.2421875\n+57\n+sage: [x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]\n+[Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field]\n+sage: \n ```\n-\n-It would be nice to be able to create modular symbols without needing to restart sage to get all your memory back.\n+So even after garbage collection the modular symbols element is still in memory.\n``````\n",
    "created_at": "2011-01-07T22:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138017",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,47 +1,14 @@
-When I was doing some computations on modular forms, I noticed the following strange memory usage behaviour which. After the first two iterations it seems like there is a memory leak. But strangely enough it stops leaking at the third iteration.
+When I was doing some computations on modular forms, I noticed that the ModularSymbols_clear_cache() was not doing what it claims to do.
 
 ```
-sage: import gc
+sage: import gc  
+sage: ModularSymbols(Gamma1(29),sign=1)
+Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field
+sage: ModularSymbols_clear_cache()
 sage: gc.collect()
-54
-sage: get_memory_usage()
-819.7578125
-sage: for i in xrange(10):
-....:     ModularSymbols(Gamma1(97),sign=1)
-....:     ModularSymbols_clear_cache()
-....:     gc.collect()
-....:     get_memory_usage()
-....:     
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-0
-842.58984375
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-0
-860.08203125
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-876.63671875
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-878.2421875
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-878.76953125
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-880.2421875
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-880.2421875
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-880.2421875
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-880.2421875
-Modular Symbols space of dimension 440 for Gamma_1(97) of weight 2 with sign 1 and over Rational Field
-37640
-880.2421875
+57
+sage: [x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]
+[Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field]
+sage: 
 ```
-
-It would be nice to be able to create modular symbols without needing to restart sage to get all your memory back.
+So even after garbage collection the modular symbols element is still in memory.
``````




---

archive/issue_comments_138018.json:
```json
{
    "body": "<a id='comment:4'></a>\nIt's not an error of the ModularSymbols_clear_cache() function\n\n```\nsage: ModularSymbols(Gamma1(29),sign=1,use_cache=False)\nModular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field\nsage: None\nsage: gc.collect()\n54\nsage: [x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]\n[Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field]\n```",
    "created_at": "2011-01-07T22:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138018",
    "user": "https://github.com/koffie"
}
```

<a id='comment:4'></a>
It's not an error of the ModularSymbols_clear_cache() function

```
sage: ModularSymbols(Gamma1(29),sign=1,use_cache=False)
Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field
sage: None
sage: gc.collect()
54
sage: [x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]
[Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field]
```



---

archive/issue_comments_138019.json:
```json
{
    "body": "<a id='comment:5'></a>\nSee the attached chain.png picture created with objgraph. There is a reference chain to the homset module. And the homeset module will not get destroyed so we have to find out where this chain comes from.",
    "created_at": "2011-01-08T00:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138019",
    "user": "https://github.com/koffie"
}
```

<a id='comment:5'></a>
See the attached chain.png picture created with objgraph. There is a reference chain to the homset module. And the homeset module will not get destroyed so we have to find out where this chain comes from.



---

archive/issue_comments_138020.json:
```json
{
    "body": "<a id='comment:6'></a>\nMight this be an instance of #715? Modular symbols spaces are Parents, so various maps in and out of them are probably getting cached by the coercion model machinery.",
    "created_at": "2011-01-20T13:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138020",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:6'></a>
Might this be an instance of #715? Modular symbols spaces are Parents, so various maps in and out of them are probably getting cached by the coercion model machinery.



---

archive/issue_comments_138021.json:
```json
{
    "body": "Attachment [chain.png](tarball://root/attachments/some-uuid/ticket10548/chain.png) by @koffie created at 2011-01-20 13:08:28",
    "created_at": "2011-01-20T13:08:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138021",
    "user": "https://github.com/koffie"
}
```

Attachment [chain.png](tarball://root/attachments/some-uuid/ticket10548/chain.png) by @koffie created at 2011-01-20 13:08:28



---

archive/issue_comments_138022.json:
```json
{
    "body": "<a id='comment:7'></a>\nSorry I failed in adding the mentioned chain.png before. It shows a reference chain explaining why ManinSymbol(37,35) is still in the memory. It seems that it has at least to do something with code in the homset module. I don't know enough details about the coercion and category framework and their interaction to say that it has something to do with 715. But the description of 715 really looks like it could be the cause.\n\nIf it is coercion, it might also be related to: #10570",
    "created_at": "2011-01-20T13:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138022",
    "user": "https://github.com/koffie"
}
```

<a id='comment:7'></a>
Sorry I failed in adding the mentioned chain.png before. It shows a reference chain explaining why ManinSymbol(37,35) is still in the memory. It seems that it has at least to do something with code in the homset module. I don't know enough details about the coercion and category framework and their interaction to say that it has something to do with 715. But the description of 715 really looks like it could be the cause.

If it is coercion, it might also be related to: #10570



---

archive/issue_comments_138023.json:
```json
{
    "body": "<a id='comment:8'></a>\nHaving looked at #10570, I don't think that's the reason. #715 seems a much more likely culprit.",
    "created_at": "2011-01-20T15:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138023",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:8'></a>
Having looked at #10570, I don't think that's the reason. #715 seems a much more likely culprit.



---

archive/issue_comments_138024.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,8 +2,8 @@\n \n ```\n sage: import gc  \n-sage: ModularSymbols(Gamma1(29),sign=1)\n-Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field\n+sage: m=ModularSymbols(Gamma1(29),sign=1)\n+sage: m=[]\n sage: ModularSymbols_clear_cache()\n sage: gc.collect()\n 57\n``````\n",
    "created_at": "2011-03-21T20:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138024",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,8 +2,8 @@
 
 ```
 sage: import gc  
-sage: ModularSymbols(Gamma1(29),sign=1)
-Modular Symbols space of dimension 49 for Gamma_1(29) of weight 2 with sign 1 and over Rational Field
+sage: m=ModularSymbols(Gamma1(29),sign=1)
+sage: m=[]
 sage: ModularSymbols_clear_cache()
 sage: gc.collect()
 57
``````




---

archive/issue_comments_138025.json:
```json
{
    "body": "<a id='comment:10'></a>\nHere is some code run on sage 4.6.1 showing that it is really the coercion framework.\n\n```\nsage: import gc  \nsage: import objgraph\nsage: import inspect\nsage: m=ModularSymbols(Gamma1(29),use_cache=False)\nsage: m=[]\nsage: ModularSymbols_clear_cache()\nsage: gc.collect()\n54\nsage: a=[x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]\nsage: l=objgraph.find_backref_chain(a[0],inspect.ismodule,max_depth=15,extra_ignore=[id(a)])\nsage: map(type,l)\n[<type 'module'>, <type 'dict'>, <type 'sage.structure.coerce.CoercionModel_cache_maps'>, <type 'list'>, <type 'tuple'>, <type 'traceback'>, <type 'frame'>, <type 'frame'>, <type 'frame'>, <type 'frame'>, <class 'sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1_with_category'>]\n```",
    "created_at": "2011-03-21T21:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138025",
    "user": "https://github.com/koffie"
}
```

<a id='comment:10'></a>
Here is some code run on sage 4.6.1 showing that it is really the coercion framework.

```
sage: import gc  
sage: import objgraph
sage: import inspect
sage: m=ModularSymbols(Gamma1(29),use_cache=False)
sage: m=[]
sage: ModularSymbols_clear_cache()
sage: gc.collect()
54
sage: a=[x for x in gc.get_objects() if isinstance(x,sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1)]
sage: l=objgraph.find_backref_chain(a[0],inspect.ismodule,max_depth=15,extra_ignore=[id(a)])
sage: map(type,l)
[<type 'module'>, <type 'dict'>, <type 'sage.structure.coerce.CoercionModel_cache_maps'>, <type 'list'>, <type 'tuple'>, <type 'traceback'>, <type 'frame'>, <type 'frame'>, <type 'frame'>, <type 'frame'>, <class 'sage.modular.modsym.ambient.ModularSymbolsAmbient_wtk_g1_with_category'>]
```



---

archive/issue_comments_138026.json:
```json
{
    "body": "<a id='comment:11'></a>\nbtw it goes wrong in the same way on 4.7.alpha1",
    "created_at": "2011-03-21T21:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138026",
    "user": "https://github.com/koffie"
}
```

<a id='comment:11'></a>
btw it goes wrong in the same way on 4.7.alpha1



---

archive/issue_comments_138027.json:
```json
{
    "body": "**Changing assignee** from @craigcitro to @robertwb.",
    "created_at": "2011-03-21T22:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138027",
    "user": "https://github.com/koffie"
}
```

**Changing assignee** from @craigcitro to @robertwb.



---

archive/issue_events_032480.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "rename": {
        "from": "ModularSymbols_clear_cache() not clearing everything?",
        "to": "The coercion model is keeping references to tracebacks which causes memory leaks."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10548#event-32480"
}
```



---

archive/issue_comments_138028.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,3 +12,5 @@\n sage: \n ```\n So even after garbage collection the modular symbols element is still in memory.\n+\n+When testing please also make sure that the last stackframe from #10570 is also gone.\n``````\n",
    "created_at": "2011-03-21T22:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138028",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,3 +12,5 @@
 sage: 
 ```
 So even after garbage collection the modular symbols element is still in memory.
+
+When testing please also make sure that the last stackframe from #10570 is also gone.
``````




---

archive/issue_comments_138029.json:
```json
{
    "body": "Attachment [10548-coerce-traceback.patch](tarball://root/attachments/some-uuid/ticket10548/10548-coerce-traceback.patch) by @robertwb created at 2011-03-22 06:04:08",
    "created_at": "2011-03-22T06:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138029",
    "user": "https://github.com/robertwb"
}
```

Attachment [10548-coerce-traceback.patch](tarball://root/attachments/some-uuid/ticket10548/10548-coerce-traceback.patch) by @robertwb created at 2011-03-22 06:04:08



---

archive/issue_comments_138030.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-03-22T06:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138030",
    "user": "https://github.com/robertwb"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_138031.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe attached patch fixes the issue described in the title, but does not fix #715.",
    "created_at": "2011-03-22T06:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138031",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:14'></a>
The attached patch fixes the issue described in the title, but does not fix #715.



---

archive/issue_comments_138032.json:
```json
{
    "body": "Attachment [10548-coerce-traceback.2.patch](tarball://root/attachments/some-uuid/ticket10548/10548-coerce-traceback.2.patch) by @koffie created at 2011-03-23 18:55:42\n\nrebased against 4.7.alpha1",
    "created_at": "2011-03-23T18:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138032",
    "user": "https://github.com/koffie"
}
```

Attachment [10548-coerce-traceback.2.patch](tarball://root/attachments/some-uuid/ticket10548/10548-coerce-traceback.2.patch) by @koffie created at 2011-03-23 18:55:42

rebased against 4.7.alpha1



---

archive/issue_comments_138033.json:
```json
{
    "body": "<a id='comment:15'></a>\nLooks good to me.",
    "created_at": "2011-03-23T20:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138033",
    "user": "https://github.com/koffie"
}
```

<a id='comment:15'></a>
Looks good to me.



---

archive/issue_comments_138034.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-03-23T20:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138034",
    "user": "https://github.com/koffie"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_138035.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2011-03-23T20:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138035",
    "user": "https://github.com/koffie"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_138036.json:
```json
{
    "body": "<a id='comment:16'></a>\nAttachment [10548-coerce-traceback-doctest.patch](tarball://root/attachments/some-uuid/ticket10548/10548-coerce-traceback-doctest.patch) by @koffie created at 2011-03-23 20:30:02",
    "created_at": "2011-03-23T20:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138036",
    "user": "https://github.com/koffie"
}
```

<a id='comment:16'></a>
Attachment [10548-coerce-traceback-doctest.patch](tarball://root/attachments/some-uuid/ticket10548/10548-coerce-traceback-doctest.patch) by @koffie created at 2011-03-23 20:30:02



---

archive/issue_comments_138037.json:
```json
{
    "body": "<a id='comment:17'></a>\nRobert, (or someone else), can you review the doctest I added?",
    "created_at": "2011-03-23T20:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138037",
    "user": "https://github.com/koffie"
}
```

<a id='comment:17'></a>
Robert, (or someone else), can you review the doctest I added?



---

archive/issue_comments_138038.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-03-23T20:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138038",
    "user": "https://github.com/koffie"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_138039.json:
```json
{
    "body": "**Reviewer:** Maarten Derickx",
    "created_at": "2011-03-23T20:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138039",
    "user": "https://github.com/koffie"
}
```

**Reviewer:** Maarten Derickx



---

archive/issue_comments_138040.json:
```json
{
    "body": "**Author:** Robert Bradshaw",
    "created_at": "2011-03-23T20:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138040",
    "user": "https://github.com/koffie"
}
```

**Author:** Robert Bradshaw



---

archive/issue_comments_138041.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,3 +14,5 @@\n So even after garbage collection the modular symbols element is still in memory.\n \n When testing please also make sure that the last stackframe from #10570 is also gone.\n+\n+apply 10548-coerce-traceback.2.patch  and 10548-coerce-traceback-doctest.patch\n``````\n",
    "created_at": "2011-03-23T20:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138041",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,3 +14,5 @@
 So even after garbage collection the modular symbols element is still in memory.
 
 When testing please also make sure that the last stackframe from #10570 is also gone.
+
+apply 10548-coerce-traceback.2.patch  and 10548-coerce-traceback-doctest.patch
``````




---

archive/issue_comments_138042.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-03-23T21:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138042",
    "user": "https://github.com/robertwb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_138043.json:
```json
{
    "body": "<a id='comment:19'></a>\nThe doctest looks good to me.",
    "created_at": "2011-03-23T21:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138043",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:19'></a>
The doctest looks good to me.



---

archive/issue_comments_138044.json:
```json
{
    "body": "Attachment [trac_10548-coerce-traceback-doctest.v2.patch](tarball://root/attachments/some-uuid/ticket10548/trac_10548-coerce-traceback-doctest.v2.patch) by @kini created at 2011-03-24 22:51:20\n\nnew doctest",
    "created_at": "2011-03-24T22:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138044",
    "user": "https://github.com/kini"
}
```

Attachment [trac_10548-coerce-traceback-doctest.v2.patch](tarball://root/attachments/some-uuid/ticket10548/trac_10548-coerce-traceback-doctest.v2.patch) by @kini created at 2011-03-24 22:51:20

new doctest



---

archive/issue_comments_138045.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,4 +15,4 @@\n \n When testing please also make sure that the last stackframe from #10570 is also gone.\n \n-apply 10548-coerce-traceback.2.patch  and 10548-coerce-traceback-doctest.patch\n+Apply 10548-coerce-traceback.2.patch, trac_10548-coerce-traceback-doctest.v2.patch\n``````\n",
    "created_at": "2011-03-24T22:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138045",
    "user": "https://github.com/kini"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,4 +15,4 @@
 
 When testing please also make sure that the last stackframe from #10570 is also gone.
 
-apply 10548-coerce-traceback.2.patch  and 10548-coerce-traceback-doctest.patch
+Apply 10548-coerce-traceback.2.patch, trac_10548-coerce-traceback-doctest.v2.patch
``````




---

archive/issue_comments_138046.json:
```json
{
    "body": "<a id='comment:20'></a>\nI folded in the doctest from the current patch at #10570, also by Maarten.",
    "created_at": "2011-03-24T22:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138046",
    "user": "https://github.com/kini"
}
```

<a id='comment:20'></a>
I folded in the doctest from the current patch at #10570, also by Maarten.



---

archive/issue_comments_138047.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,4 +15,4 @@\n \n When testing please also make sure that the last stackframe from #10570 is also gone.\n \n-Apply 10548-coerce-traceback.2.patch, trac_10548-coerce-traceback-doctest.v2.patch\n+Apply [attachment:10548-coerce-traceback.2.patch] and [attachment:trac_10548-coerce-traceback-doctest.v2.patch]\n``````\n",
    "created_at": "2011-04-05T12:09:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138047",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,4 +15,4 @@
 
 When testing please also make sure that the last stackframe from #10570 is also gone.
 
-Apply 10548-coerce-traceback.2.patch, trac_10548-coerce-traceback-doctest.v2.patch
+Apply [attachment:10548-coerce-traceback.2.patch] and [attachment:trac_10548-coerce-traceback-doctest.v2.patch]
``````




---

archive/issue_comments_138048.json:
```json
{
    "body": "**Merged:** sage-4.7.alpha4",
    "created_at": "2011-04-07T19:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138048",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.alpha4



---

archive/issue_events_032481.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-07T19:56:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10548#event-32481"
}
```



---

archive/issue_comments_138049.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2011-04-07T19:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10548#issuecomment-138049",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed
