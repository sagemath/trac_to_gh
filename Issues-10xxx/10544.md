# Issue 10544: LLL reduced kernel bases are not always correct

archive/issues_010491.json:
```json
{
    "assignees": [],
    "body": "On 4.6.1.alpha 3:\n\n```\nsage: sage: E=matrix(ZZ, 5, 8,\n....: [5, -23, 21, 77, -50, 8, -76, 16, 2,\n....: -9, 8, 30, -19, 3, -29, 6, 4, -16, 13,\n....: 53, -30, 4, -47, 9, 0, 5, -14, -24,\n....: 33, -5, 47, -14, -2, 11, -9, -35, 23,\n....: -5, 34, -7])\nsage: sage: KK=E.right_kernel(LLL=True)\nsage: sage: BB=KK.basis_matrix().change_ring(ZZ)\nsage: sage: BB.is_LLL_reduced()\nFalse\nsage: sage: LL=BB.LLL()\nsage: sage: LL-BB\n[0 0 0 0 0 0 0 0]\n[0 0 0 0 0 0 0 0]\n[0 0 0 0 0 0 0 0]\n[1 0 1 0 1 1 0 1]\n[0 0 0 0 0 0 0 0]\n```\n\nI can't say for certain that this is a bug, but it does not look correct to me.  This may happen about one time in twenty for random matrices of this size.  Any smaller and it seemed to be quite rare.  Larger and it was more frequent.  Wish I had a better test case to offer.\n\n\n\n\n**Assignee:** @jasongrout, @williamstein\n\n**CC:**  @wjp\n\n**Keywords:** days84\n\n**Reviewer:** Thierry Monteil\n\nIssue created by migration from https://trac.sagemath.org/ticket/10544\n\n",
    "closed_at": "2017-07-13T07:54:31Z",
    "created_at": "2011-01-02T04:51:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "LLL reduced kernel bases are not always correct",
    "type": "issue",
    "updated_at": "2017-07-13T07:54:31Z",
    "url": "https://github.com/sagemath/sage/issues/10544",
    "user": "https://github.com/rbeezer"
}
```
On 4.6.1.alpha 3:

```
sage: sage: E=matrix(ZZ, 5, 8,
....: [5, -23, 21, 77, -50, 8, -76, 16, 2,
....: -9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
....: 53, -30, 4, -47, 9, 0, 5, -14, -24,
....: 33, -5, 47, -14, -2, 11, -9, -35, 23,
....: -5, 34, -7])
sage: sage: KK=E.right_kernel(LLL=True)
sage: sage: BB=KK.basis_matrix().change_ring(ZZ)
sage: sage: BB.is_LLL_reduced()
False
sage: sage: LL=BB.LLL()
sage: sage: LL-BB
[0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0]
[1 0 1 0 1 1 0 1]
[0 0 0 0 0 0 0 0]
```

I can't say for certain that this is a bug, but it does not look correct to me.  This may happen about one time in twenty for random matrices of this size.  Any smaller and it seemed to be quite rare.  Larger and it was more frequent.  Wish I had a better test case to offer.




**Assignee:** @jasongrout, @williamstein

**CC:**  @wjp

**Keywords:** days84

**Reviewer:** Thierry Monteil

Issue created by migration from https://trac.sagemath.org/ticket/10544





---

archive/issue_events_116586.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-01-02T04:51:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "08517b",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116586"
}
```



---

archive/issue_events_116587.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-01-02T04:51:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116587"
}
```



---

archive/issue_events_116588.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-01-02T04:51:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "008080",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116588"
}
```



---

archive/issue_comments_102416.json:
```json
{
    "body": "<a id='comment:2'></a>\nAfter discussion at days27, it seems this is an LLL parameter mismatch:\n\n\n```\nin gp:\n\n? ??qflll\nqflll(x,{flag = 0}):\n\n   LLL algorithm applied to the columns of the matrix x.   The columns of x may\nbe linearly dependent.  The result is a unimodular transformation matrix T such\nthat  x  .T  is  an  LLL-reduced  basis  of the lattice generated by the column\nvectors of x.  Note that if x is not of maximal rank T will not be square.  The\nLLL parameters are (0.51,0.99),  meaning that the Gram-Schmidt coefficients for\nthe  final  basis satisfy mu_{i,j} <= |0.51|,  and the Lov\\'{a}sz's constant is\n0.99.\n```\n\n\n```\nsage: BB.is_LLL_reduced(eta=.51)\nTrue\n```",
    "created_at": "2011-01-12T01:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10544#issuecomment-102416",
    "user": "https://github.com/wjp"
}
```

<a id='comment:2'></a>
After discussion at days27, it seems this is an LLL parameter mismatch:


```
in gp:

? ??qflll
qflll(x,{flag = 0}):

   LLL algorithm applied to the columns of the matrix x.   The columns of x may
be linearly dependent.  The result is a unimodular transformation matrix T such
that  x  .T  is  an  LLL-reduced  basis  of the lattice generated by the column
vectors of x.  Note that if x is not of maximal rank T will not be square.  The
LLL parameters are (0.51,0.99),  meaning that the Gram-Schmidt coefficients for
the  final  basis satisfy mu_{i,j} <= |0.51|,  and the Lov\'{a}sz's constant is
0.99.
```


```
sage: BB.is_LLL_reduced(eta=.51)
True
```



---

archive/issue_events_116589.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116589"
}
```



---

archive/issue_events_116590.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116590"
}
```



---

archive/issue_events_116591.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116591"
}
```



---

archive/issue_events_116592.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116592"
}
```



---

archive/issue_events_116593.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116593"
}
```



---

archive/issue_events_116594.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116594"
}
```



---

archive/issue_events_116595.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116595"
}
```



---

archive/issue_events_116596.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116596"
}
```



---

archive/issue_comments_102417.json:
```json
{
    "body": "**Reviewer:** Thierry Monteil",
    "created_at": "2017-03-02T16:12:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10544#issuecomment-102417",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Reviewer:** Thierry Monteil



---

archive/issue_events_116597.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2017-03-02T16:12:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116597"
}
```



---

archive/issue_comments_102418.json:
```json
{
    "body": "<a id='comment:7'></a>\nI had a look to this as sage days 84, actually, the LLL option is not passed correctly, according to the doc, this should be passed as a string to the `basis` option, compare (on 7.6.beta5):\n\n\n```\nE=matrix(ZZ, 5, 8,\n[5, -23, 21, 77, -50, 8, -76, 16, 2,\n-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,\n53, -30, 4, -47, 9, 0, 5, -14, -24,\n33, -5, 47, -14, -2, 11, -9, -35, 23,\n-5, 34, -7])\nKK=E.right_kernel(LLL=True)\nBB=KK.basis_matrix().change_ring(ZZ)\nBB.is_LLL_reduced()\nFalse\n```\n\nwith \n\n```\nE=matrix(ZZ, 5, 8,\n[5, -23, 21, 77, -50, 8, -76, 16, 2,\n-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,\n53, -30, 4, -47, 9, 0, 5, -14, -24,\n33, -5, 47, -14, -2, 11, -9, -35, 23,\n-5, 34, -7])\nKK=E.right_kernel(basis='LLL')\nBB=KK.basis_matrix().change_ring(ZZ)\nBB.is_LLL_reduced()\nTrue\n```\n\nHence, i suggest to close this ticket as wontfix.",
    "created_at": "2017-03-02T16:12:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10544#issuecomment-102418",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:7'></a>
I had a look to this as sage days 84, actually, the LLL option is not passed correctly, according to the doc, this should be passed as a string to the `basis` option, compare (on 7.6.beta5):


```
E=matrix(ZZ, 5, 8,
[5, -23, 21, 77, -50, 8, -76, 16, 2,
-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
53, -30, 4, -47, 9, 0, 5, -14, -24,
33, -5, 47, -14, -2, 11, -9, -35, 23,
-5, 34, -7])
KK=E.right_kernel(LLL=True)
BB=KK.basis_matrix().change_ring(ZZ)
BB.is_LLL_reduced()
False
```

with 

```
E=matrix(ZZ, 5, 8,
[5, -23, 21, 77, -50, 8, -76, 16, 2,
-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
53, -30, 4, -47, 9, 0, 5, -14, -24,
33, -5, 47, -14, -2, 11, -9, -35, 23,
-5, 34, -7])
KK=E.right_kernel(basis='LLL')
BB=KK.basis_matrix().change_ring(ZZ)
BB.is_LLL_reduced()
True
```

Hence, i suggest to close this ticket as wontfix.



---

archive/issue_comments_102419.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"days84\".",
    "created_at": "2017-03-02T16:12:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10544#issuecomment-102419",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Changing keywords** from "" to "days84".



---

archive/issue_events_116598.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2017-03-02T16:12:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116598"
}
```



---

archive/issue_events_116599.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2017-03-02T16:12:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116599"
}
```



---

archive/issue_events_116600.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2017-03-02T16:12:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116600"
}
```



---

archive/issue_events_116601.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-13T07:54:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116601"
}
```



---

archive/issue_events_116602.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-13T07:54:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116602"
}
```



---

archive/issue_events_116603.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-13T07:54:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "008080",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10544#event-116603"
}
```



---

archive/issue_comments_102420.json:
```json
{
    "body": "<a id='comment:9'></a>\nClosing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).",
    "created_at": "2017-07-13T07:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10544#issuecomment-102420",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).
