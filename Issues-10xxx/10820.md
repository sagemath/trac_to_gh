# Issue 10820: tachyon-0.98beta.p11 doesn't build on ARM

archive/issues_010754.json:
```json
{
    "body": "I discussed ideas for a correct fix with upstream, but in the mean time, it's pretty easy to get around the problem with the attached patch.\n\nAll patches applied to this ticket are for review purposes only, and do not need to be merged to Sage - all changes are in the package. \n\nThe updated package can be found at:\n\nhttp://boxen.math.washington.edu/home/kirkby/patches/tachyon-0.98.9.p3.spkg\n\n\n\nAssignee: drkirkby\n\nUpstream: Reported upstream. Developers acknowledge bug.\n\nReviewer: David Kirkby\n\nAuthor: Julien Puydt\n\nMerged: sage-4.7.alpha2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10820\n\n",
    "closed_at": "2011-03-18T13:41:22Z",
    "created_at": "2011-02-22T05:37:04Z",
    "labels": [
        "component: porting",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "tachyon-0.98beta.p11 doesn't build on ARM",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10820",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```
I discussed ideas for a correct fix with upstream, but in the mean time, it's pretty easy to get around the problem with the attached patch.

All patches applied to this ticket are for review purposes only, and do not need to be merged to Sage - all changes are in the package. 

The updated package can be found at:

http://boxen.math.washington.edu/home/kirkby/patches/tachyon-0.98.9.p3.spkg



Assignee: drkirkby

Upstream: Reported upstream. Developers acknowledge bug.

Reviewer: David Kirkby

Author: Julien Puydt

Merged: sage-4.7.alpha2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10820





---

archive/issue_comments_143439.json:
```json
{
    "body": "Attachment [spkg-install.patch](tarball://root/attachments/some-uuid/ticket10820/spkg-install.patch) by Snark created at 2011-02-22 05:37:41\n\nPatch to make tachyon work on ARM (to apply to spkg-install)",
    "created_at": "2011-02-22T05:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143439",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Attachment [spkg-install.patch](tarball://root/attachments/some-uuid/ticket10820/spkg-install.patch) by Snark created at 2011-02-22 05:37:41

Patch to make tachyon work on ARM (to apply to spkg-install)



---

archive/issue_comments_143440.json:
```json
{
    "body": "<a id='comment:1'></a>\nI can't test this, as I don't have an ARM processor, but the necessary changes should be fairly safe, as it does very little and only on one processor. \n\nBut you need to do more to get this into Sage. \n\n* Remove the '-e' option to 'sed', as you don't need it if the code is on the command line. \n* Drop the use of the '-i' option to 'sed' as this is a non-standard option. See http://pubs.opengroup.org/onlinepubs/9699919799/utilities/sed.html Just use something like \n\n```\nsed 's/-m32//g' Make-arch > Make-arch.tmp\nmv Make-arch.tmp Make-arch\n```\n* Edit SPKG.txt, to document the change you have made. Document them under tachyon-0.98beta.p12\n* Create one Mercurial patch of all your changes. \n* Create a new package, tachyon-0.98beta.p12.spkg and post a link to the URL of that new package. \n* Change the ticket from \"new\" to \"needs_review\"\n\nOne you do all these, I will be happy to give it a positive review, even though I'm unable to actually check on an ARM processor. \n\nDave",
    "created_at": "2011-02-28T09:30:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143440",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:1'></a>
I can't test this, as I don't have an ARM processor, but the necessary changes should be fairly safe, as it does very little and only on one processor. 

But you need to do more to get this into Sage. 

* Remove the '-e' option to 'sed', as you don't need it if the code is on the command line. 
* Drop the use of the '-i' option to 'sed' as this is a non-standard option. See http://pubs.opengroup.org/onlinepubs/9699919799/utilities/sed.html Just use something like 

```
sed 's/-m32//g' Make-arch > Make-arch.tmp
mv Make-arch.tmp Make-arch
```
* Edit SPKG.txt, to document the change you have made. Document them under tachyon-0.98beta.p12
* Create one Mercurial patch of all your changes. 
* Create a new package, tachyon-0.98beta.p12.spkg and post a link to the URL of that new package. 
* Change the ticket from "new" to "needs_review"

One you do all these, I will be happy to give it a positive review, even though I'm unable to actually check on an ARM processor. 

Dave



---

archive/issue_comments_143441.json:
```json
{
    "body": "<a id='comment:2'></a>\nOk, here is a new patch, which modifies pkg-install as you wanted and describes succinctly the changes in SPKG.txt.\n\nIs making a new package available really needed?",
    "created_at": "2011-03-12T19:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143441",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:2'></a>
Ok, here is a new patch, which modifies pkg-install as you wanted and describes succinctly the changes in SPKG.txt.

Is making a new package available really needed?



---

archive/issue_comments_143442.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-03-12T19:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143442",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_143443.json:
```json
{
    "body": "Reviewer: David Kirkby",
    "created_at": "2011-03-12T21:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143443",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Reviewer: David Kirkby



---

archive/issue_comments_143444.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2011-03-12T21:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143444",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing upstream from "N/A" to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_143445.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-03-12T21:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143445",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_143446.json:
```json
{
    "body": "<a id='comment:4'></a>\nI can't tell exactly what you have done, as I have no .spkg to look at, but it looks to me as though you have copied `Make-arch` unmodified to the patches directory, then used 'sed' on that to change it. If I'm correct, then its a waste of disk space. The two sensible options are either to:\n\n* Create a patch, which can be installed with GNU patch. \n* Use 'sed' to edit the `Make-arch`, overwriting the source code when spkg-install is run. \n\nThe patches attached to the ticket must be in Mercurial format, and there must be a new .spkg file with all the changes committed. That way there's an exact log of all the changes in the package. If you don't know how to do that, I don't mind doing it for you this time, but in the long term you will need to find out how to do it. \n\nAlso, can you fill in the author form with your real name.",
    "created_at": "2011-03-12T21:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143446",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:4'></a>
I can't tell exactly what you have done, as I have no .spkg to look at, but it looks to me as though you have copied `Make-arch` unmodified to the patches directory, then used 'sed' on that to change it. If I'm correct, then its a waste of disk space. The two sensible options are either to:

* Create a patch, which can be installed with GNU patch. 
* Use 'sed' to edit the `Make-arch`, overwriting the source code when spkg-install is run. 

The patches attached to the ticket must be in Mercurial format, and there must be a new .spkg file with all the changes committed. That way there's an exact log of all the changes in the package. If you don't know how to do that, I don't mind doing it for you this time, but in the long term you will need to find out how to do it. 

Also, can you fill in the author form with your real name.



---

archive/issue_comments_143447.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-13T07:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143447",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_143448.json:
```json
{
    "body": "<a id='comment:5'></a>\nWhat I gave is the patch that modifies the spkg's content, and it can be applied with GNU patch ; I have no clue what a \"mercurial patch\" is... as far as I know, all source control system use the same two patch formats, and I used the most human-readable, dubbed \"unified\" -- I obtained it by running \"diff -urN tachyon-0.98.9.p2/ tachyon-0.98.9.p3/\" (my diff being GNU's, version 3.0).\n\nIt tells ***exactly*** what **I** have done :\n* I added a comment in SPKG.txt (three lines) ;\n* I modified spkg-install so that for ARM it removes \"-m32\" from Make-arch (three lines).\n\nThe current spkg-install already does things to Make-arch -- and one of the first things it does it to just cp it : \"cp ../../patches/Make-arch .\", line 16. What I do is that later on, I make it realize that it should have modified it ; so I just take it again, but copy it using sed to remove the offending switch : no waste of space with respect to what the current spkg does.\n\nIf I give you the resulting spkg, you'll just have everything : the full sources, the previous changes and -- buried in the middle of that -- my own changes. Six lines lost in the of 2.4M of files, where you'll not review what I have done, but what the previous packager did!\n\nI only want you to review the six lines I'm really responsible of : the rest is not my work. And you'll notice that out of six lines, three are for documenting my changes...\n\nTo tell more, here is how to apply my patch -- which is quite long because I have no clue how to really use an spkg :\n\n```\n$ cp /path/to/tachyon-0.98.9.p2.spkg ./tachyon-0.98.9.p2.tar.bz2\n$ tar xaf tachyon-0.98.9.p2.tar.bz2\n$ mv tachyon-0.98.9.p2 tachyon-0.98.9.p3\n$ cd tachyon-0.98.9.p3\n$ patch -p1 < /path/to/tachyon-0.98.9_for_ARM\n$ cd ..\n$ tar cjf tachyon-0.98.9.p3.tar.bz2 tachyon-0.98.9.p3\n$ mv tachyon-0.98.9.p3.tar.bz2 tachyon-0.98.9.p3.spkg\n```\n\nThe way you should read the patch is :\n\n```\ndiff -ur tachyon-0.98.9.p2/spkg-install tachyon-0.98.9.p3/spkg-install\n```\nthis tells I turned tachyon-0.98.9.p2/spkg-install into tachyon-0.98.9.p3/spkg-install\n\n```\n--- tachyon-0.98.9.p2/spkg-install      2011-01-13 01:43:50.000000000 +0100\n+++ tachyon-0.98.9.p3/spkg-install      2011-03-12 19:08:11.124659955 +0100\n```\nthis says that what is prefixed \"-\" will be what is removed from tachyon-0.98.9.p2/spkg-install, and what is prefixed \"+\" will be what is added to tachyon-0.98.9.p3/spkg-install\n\n```\n@@ -63,6 +63,9 @@\n```\nthis says that the following chunk applies at line 63, and that something 6 lines long will become 9 lines long.\n\n```\n\t             $MAKE linux-64-thr;;\n\t        ppc)\n\t             $MAKE linux-ppc;;\n\t+        armv7l)\n\t+            sed \"s/-m32//g\" ../../patches/Make-arch > Make-arch\n\t+            $MAKE linux-thr;;\n\t        *) # e.g. ppc64\n\t             echo \"Sorry, your platform isn't supported by Tachyon and/or Sage. Exiting...\"\n\t             exit 1\n```\nThis is the code from the current file, with the \"+\" being the lines to add : there I'm just adding to the arch test which was falling through to an error a new case, just for \"armv7l\", which just modifies the Make-arch files by removing -m32... a Make-arch file which I do not really create myself, as you can see : I just make do with what is already available. This is all I modify in pkg-install.\n\nNow there is another file I modify :\n\n```\ndiff -ur tachyon-0.98.9.p2/SPKG.txt tachyon-0.98.9.p3/SPKG.txt\n\t--- tachyon-0.98.9.p2/SPKG.txt  2011-01-24 16:16:05.000000000 +0100\n\t+++ tachyon-0.98.9.p3/SPKG.txt  2011-03-12 19:49:13.844659953 +0100\n\t@@ -62,6 +62,9 @@\n\t \n\t == Changelog ==\n\t \n\t+=== tachyon-0.98.9.p3 (Julien Puydt, March 12, 2011)\n\t+ * #10820: Made package compile on ARM\n\t+\n\t === tachyon-0.98.9.p2 (Volker Braun, January 24, 2011)\n\t  * #10681: Remove \"CC=cc\" for the maxosx (32-bit) make target\n```\nAnd here again, we see that I just made the 6 lines following line 62, 9 lines, by adding the three lines prefixed by '+'.\n\nThat's all I did. And that's all I want reviewed.",
    "created_at": "2011-03-13T07:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143448",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:5'></a>
What I gave is the patch that modifies the spkg's content, and it can be applied with GNU patch ; I have no clue what a "mercurial patch" is... as far as I know, all source control system use the same two patch formats, and I used the most human-readable, dubbed "unified" -- I obtained it by running "diff -urN tachyon-0.98.9.p2/ tachyon-0.98.9.p3/" (my diff being GNU's, version 3.0).

It tells ***exactly*** what **I** have done :
* I added a comment in SPKG.txt (three lines) ;
* I modified spkg-install so that for ARM it removes "-m32" from Make-arch (three lines).

The current spkg-install already does things to Make-arch -- and one of the first things it does it to just cp it : "cp ../../patches/Make-arch .", line 16. What I do is that later on, I make it realize that it should have modified it ; so I just take it again, but copy it using sed to remove the offending switch : no waste of space with respect to what the current spkg does.

If I give you the resulting spkg, you'll just have everything : the full sources, the previous changes and -- buried in the middle of that -- my own changes. Six lines lost in the of 2.4M of files, where you'll not review what I have done, but what the previous packager did!

I only want you to review the six lines I'm really responsible of : the rest is not my work. And you'll notice that out of six lines, three are for documenting my changes...

To tell more, here is how to apply my patch -- which is quite long because I have no clue how to really use an spkg :

```
$ cp /path/to/tachyon-0.98.9.p2.spkg ./tachyon-0.98.9.p2.tar.bz2
$ tar xaf tachyon-0.98.9.p2.tar.bz2
$ mv tachyon-0.98.9.p2 tachyon-0.98.9.p3
$ cd tachyon-0.98.9.p3
$ patch -p1 < /path/to/tachyon-0.98.9_for_ARM
$ cd ..
$ tar cjf tachyon-0.98.9.p3.tar.bz2 tachyon-0.98.9.p3
$ mv tachyon-0.98.9.p3.tar.bz2 tachyon-0.98.9.p3.spkg
```

The way you should read the patch is :

```
diff -ur tachyon-0.98.9.p2/spkg-install tachyon-0.98.9.p3/spkg-install
```
this tells I turned tachyon-0.98.9.p2/spkg-install into tachyon-0.98.9.p3/spkg-install

```
--- tachyon-0.98.9.p2/spkg-install      2011-01-13 01:43:50.000000000 +0100
+++ tachyon-0.98.9.p3/spkg-install      2011-03-12 19:08:11.124659955 +0100
```
this says that what is prefixed "-" will be what is removed from tachyon-0.98.9.p2/spkg-install, and what is prefixed "+" will be what is added to tachyon-0.98.9.p3/spkg-install

```
@@ -63,6 +63,9 @@
```
this says that the following chunk applies at line 63, and that something 6 lines long will become 9 lines long.

```
	             $MAKE linux-64-thr;;
	        ppc)
	             $MAKE linux-ppc;;
	+        armv7l)
	+            sed "s/-m32//g" ../../patches/Make-arch > Make-arch
	+            $MAKE linux-thr;;
	        *) # e.g. ppc64
	             echo "Sorry, your platform isn't supported by Tachyon and/or Sage. Exiting..."
	             exit 1
```
This is the code from the current file, with the "+" being the lines to add : there I'm just adding to the arch test which was falling through to an error a new case, just for "armv7l", which just modifies the Make-arch files by removing -m32... a Make-arch file which I do not really create myself, as you can see : I just make do with what is already available. This is all I modify in pkg-install.

Now there is another file I modify :

```
diff -ur tachyon-0.98.9.p2/SPKG.txt tachyon-0.98.9.p3/SPKG.txt
	--- tachyon-0.98.9.p2/SPKG.txt  2011-01-24 16:16:05.000000000 +0100
	+++ tachyon-0.98.9.p3/SPKG.txt  2011-03-12 19:49:13.844659953 +0100
	@@ -62,6 +62,9 @@
	 
	 == Changelog ==
	 
	+=== tachyon-0.98.9.p3 (Julien Puydt, March 12, 2011)
	+ * #10820: Made package compile on ARM
	+
	 === tachyon-0.98.9.p2 (Volker Braun, January 24, 2011)
	  * #10681: Remove "CC=cc" for the maxosx (32-bit) make target
```
And here again, we see that I just made the 6 lines following line 62, 9 lines, by adding the three lines prefixed by '+'.

That's all I did. And that's all I want reviewed.



---

archive/issue_comments_143449.json:
```json
{
    "body": "Author: Julien Puydt",
    "created_at": "2011-03-13T07:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143449",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Author: Julien Puydt



---

archive/issue_comments_143450.json:
```json
{
    "body": "<a id='comment:6'></a>\nOne thing a reviewer should do is to check that all the changes are committed to the Mercuiral repository - clearly I can't do that unless you commit the changes to the repository and make an .spkg available so I can verify it. \n\nThe release manager will want to copy your new .spkg into the next Sage release. For that he needs to be able to download it from somewhere. \n\nSo despite the fact your changes are small, you must still make the 2.4 MB file available for both the reviewer and the release manager. \n\nIf you look in any .spkg, you will find a directory `.hg` which is the Mercurial repository. Google that. \n\nSince you don't know how to make the changes, I'll explain it. You can probably find similar in the Sage developers guide.\n\nFirst create a file `$HOME/.hgrc`. Here's mine. Make the obvious changes. \n\n```\ndrkirkby@hawk:~$ cat .hgrc\n[ui]\nusername = David Kirkby <david.kirkby@onetel.net>\n\n[extensions]\n# Enable the Mercurial queue extension.\nhgext.mq =\n```\n\nI suggest at this point you make a backup of whatever you have done, in case you mess up. \n\nNext you need to commit your changes to the Mercurial repository in the .spkg. Do this from the root directory of Sage:\n\n```\n$ EDITOR=vi # (or use emacs, vim, gedit or what other text editor you want.) \n$ export EDITOR \n$ ./sage -sh\n```\n\nYou will get something like this, which is a subshell of Sage. \n\n```\nStarting subshell with Sage environment variables set.\nBe sure to exit when you are done and do not do anything\nwith other copies of Sage!\n\nBypassing shell configuration files ...\n\nSAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1\n(sage subshell) hawk:sage-4.7.alpha1 drkirkby$ cd spkg/standard/tachyon-0.98.9.p3\nSAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1\n(sage subshell) hawk:tachyon-0.98.9.p3 drkirkby$ hg commit\n```\n\nAt this point your editor will open. Put on one line \n\n*#10820 Add support of the ARM processor to the Tachyon package*\n\nSave the file. That will commit the changes to the Mercurial repository in the package. Next you need to create a **Mercurial** patch that can be attached to this ticket. \n\n```\nSAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1\n(sage subshell) hawk:tachyon-0.98.9.p3 drkirkby$ hg export tip > $HOME/10820-ARM-support-for-Tachyon.patch\nSAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1\n(sage subshell) hawk:tachyon-0.98.9.p3 drkirkby$ exit\nexit\nExited Sage subshell.\ndrkirkby@hawk:~/sage-4.7.alpha1$ \n```\n\nThat will create a file $HOME/10820-ARM-support-for-Tachyon.patch which should be attached to this ticket. That's the only file that needs to be attached to the ticket - it will contain all the information needed. \n\nNext tar up the package\n\n```\n$ cd spkg/standard\n$ tar cfj tachyon-0.98.9.p3.spkg tachyon-0.98.9.p3\n```\n\nand post a link to where I can download the complete package. Put that link in the ticket description too, and make a note that all patches attached to the ticket are for review purposes only, and that all changes are committed to the Mercurial repository. That helps the release manager. \n\nI'll then review it. Whist I don't have access to an ARM processor, assuming things all look OK, I will give it a positive review. \n\nDave",
    "created_at": "2011-03-13T10:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143450",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:6'></a>
One thing a reviewer should do is to check that all the changes are committed to the Mercuiral repository - clearly I can't do that unless you commit the changes to the repository and make an .spkg available so I can verify it. 

The release manager will want to copy your new .spkg into the next Sage release. For that he needs to be able to download it from somewhere. 

So despite the fact your changes are small, you must still make the 2.4 MB file available for both the reviewer and the release manager. 

If you look in any .spkg, you will find a directory `.hg` which is the Mercurial repository. Google that. 

Since you don't know how to make the changes, I'll explain it. You can probably find similar in the Sage developers guide.

First create a file `$HOME/.hgrc`. Here's mine. Make the obvious changes. 

```
drkirkby@hawk:~$ cat .hgrc
[ui]
username = David Kirkby <david.kirkby@onetel.net>

[extensions]
# Enable the Mercurial queue extension.
hgext.mq =
```

I suggest at this point you make a backup of whatever you have done, in case you mess up. 

Next you need to commit your changes to the Mercurial repository in the .spkg. Do this from the root directory of Sage:

```
$ EDITOR=vi # (or use emacs, vim, gedit or what other text editor you want.) 
$ export EDITOR 
$ ./sage -sh
```

You will get something like this, which is a subshell of Sage. 

```
Starting subshell with Sage environment variables set.
Be sure to exit when you are done and do not do anything
with other copies of Sage!

Bypassing shell configuration files ...

SAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1
(sage subshell) hawk:sage-4.7.alpha1 drkirkby$ cd spkg/standard/tachyon-0.98.9.p3
SAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1
(sage subshell) hawk:tachyon-0.98.9.p3 drkirkby$ hg commit
```

At this point your editor will open. Put on one line 

*#10820 Add support of the ARM processor to the Tachyon package*

Save the file. That will commit the changes to the Mercurial repository in the package. Next you need to create a **Mercurial** patch that can be attached to this ticket. 

```
SAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1
(sage subshell) hawk:tachyon-0.98.9.p3 drkirkby$ hg export tip > $HOME/10820-ARM-support-for-Tachyon.patch
SAGE_ROOT=/export/home/drkirkby/sage-4.7.alpha1
(sage subshell) hawk:tachyon-0.98.9.p3 drkirkby$ exit
exit
Exited Sage subshell.
drkirkby@hawk:~/sage-4.7.alpha1$ 
```

That will create a file $HOME/10820-ARM-support-for-Tachyon.patch which should be attached to this ticket. That's the only file that needs to be attached to the ticket - it will contain all the information needed. 

Next tar up the package

```
$ cd spkg/standard
$ tar cfj tachyon-0.98.9.p3.spkg tachyon-0.98.9.p3
```

and post a link to where I can download the complete package. Put that link in the ticket description too, and make a note that all patches attached to the ticket are for review purposes only, and that all changes are committed to the Mercurial repository. That helps the release manager. 

I'll then review it. Whist I don't have access to an ARM processor, assuming things all look OK, I will give it a positive review. 

Dave



---

archive/issue_comments_143451.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-03-13T10:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143451",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_143452.json:
```json
{
    "body": "Attachment [tachyon-0.98.9_for_ARM](tarball://root/attachments/some-uuid/ticket10820/tachyon-0.98.9_for_ARM) by Snark created at 2011-03-13 11:05:51\n\nMercurial patch",
    "created_at": "2011-03-13T11:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143452",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Attachment [tachyon-0.98.9_for_ARM](tarball://root/attachments/some-uuid/ticket10820/tachyon-0.98.9_for_ARM) by Snark created at 2011-03-13 11:05:51

Mercurial patch



---

archive/issue_comments_143453.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe patch is now from mercurial, and I attached the full patched spkg.",
    "created_at": "2011-03-13T11:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143453",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:7'></a>
The patch is now from mercurial, and I attached the full patched spkg.



---

archive/issue_comments_143454.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-13T11:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143454",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_143455.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-03-13T21:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143455",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_143456.json:
```json
{
    "body": "<a id='comment:8'></a>\nThat's OK now. I can't check it on ARM, but I trust you when you say it solves the problem, so positive review. \n\nThe only issue was that you are not supposed to attached .spkg's to trac, as trac is not well suited for handling large files. Instead a link should be provided to where the package can be downloaded. For this reason, I have deleted the package from the trac server, and placed it at \n\nhttp://boxen.math.washington.edu/home/kirkby/patches/tachyon-0.98.9.p3.spkg\n\nSo positive review. I've set the milestone to be 4.7. Hopefully it will get in there. It is a very low risk patch, since it only effects systems with the ARM processor, so I see no reason this should not be merged soon. \n\nDave",
    "created_at": "2011-03-13T21:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143456",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:8'></a>
That's OK now. I can't check it on ARM, but I trust you when you say it solves the problem, so positive review. 

The only issue was that you are not supposed to attached .spkg's to trac, as trac is not well suited for handling large files. Instead a link should be provided to where the package can be downloaded. For this reason, I have deleted the package from the trac server, and placed it at 

http://boxen.math.washington.edu/home/kirkby/patches/tachyon-0.98.9.p3.spkg

So positive review. I've set the milestone to be 4.7. Hopefully it will get in there. It is a very low risk patch, since it only effects systems with the ARM processor, so I see no reason this should not be merged soon. 

Dave



---

archive/issue_events_033396.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2011-03-13T21:08:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "milestone": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10820#event-33396"
}
```



---

archive/issue_comments_143457.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,9 @@\n I discussed ideas for a correct fix with upstream, but in the mean time, it's pretty easy to get around the problem with the attached patch.\n+\n+All patches applied to this ticket are for review purposes only, and do not need to be merged to Sage - all changes are in the package. \n+\n+The updated package can be found at:\n+\n+http://boxen.math.washington.edu/home/kirkby/patches/tachyon-0.98.9.p3.spkg\n+\n+\n``````\n",
    "created_at": "2011-03-13T21:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143457",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,9 @@
 I discussed ideas for a correct fix with upstream, but in the mean time, it's pretty easy to get around the problem with the attached patch.
+
+All patches applied to this ticket are for review purposes only, and do not need to be merged to Sage - all changes are in the package. 
+
+The updated package can be found at:
+
+http://boxen.math.washington.edu/home/kirkby/patches/tachyon-0.98.9.p3.spkg
+
+
``````




---

archive/issue_comments_143458.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-03-18T13:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143458",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_033397.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-03-18T13:41:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10820#event-33397"
}
```



---

archive/issue_comments_143459.json:
```json
{
    "body": "Merged: sage-4.7.alpha2",
    "created_at": "2011-03-18T13:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143459",
    "user": "https://github.com/jdemeyer"
}
```

Merged: sage-4.7.alpha2



---

archive/issue_comments_143460.json:
```json
{
    "body": "<a id='comment:10'></a>\nFWIW, Tachyon is not (out of the box) building on the Raspberry Pi; it's uname is armv6l.  Adding the architecture in the spkg.install alongside the armv7l line seems to work just fine; would it be possible to include the armv6l in the patch?  (Or really, at this point, make a new patch to include it?)",
    "created_at": "2013-01-16T20:45:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143460",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:10'></a>
FWIW, Tachyon is not (out of the box) building on the Raspberry Pi; it's uname is armv6l.  Adding the architecture in the spkg.install alongside the armv7l line seems to work just fine; would it be possible to include the armv6l in the patch?  (Or really, at this point, make a new patch to include it?)



---

archive/issue_comments_143461.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [sdenton](#comment%3A10):\n> FWIW, Tachyon is not (out of the box) building on the Raspberry Pi; it's uname is armv6l.  Adding the architecture in the spkg.install alongside the armv7l line seems to work just fine; would it be possible to include the armv6l in the patch?  (Or really, at this point, make a new patch to include it?)\n\n\nsure, just open a new ticket and post your patch there.",
    "created_at": "2013-01-18T02:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10820#issuecomment-143461",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
Replying to [sdenton](#comment%3A10):
> FWIW, Tachyon is not (out of the box) building on the Raspberry Pi; it's uname is armv6l.  Adding the architecture in the spkg.install alongside the armv7l line seems to work just fine; would it be possible to include the armv6l in the patch?  (Or really, at this point, make a new patch to include it?)


sure, just open a new ticket and post your patch there.
