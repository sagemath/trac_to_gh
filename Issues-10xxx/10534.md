# Issue 10534: Cleanup in choose_nk, split_nk, subword, subset

archive/issues_010481.json:
```json
{
    "body": "- deprecate `ChooseNK` (in `sage.combinat.choose_nk`) and `SplitNK` (in `sage.combinat.split_nk`).\n- clean `sage.combinat.subword` and `sage.combinat.subset`\n  - inheritance from `Parent`\n  - much better iteration/random generation\n  - ...\n\nAnd become more pep8 compliant ;=)\n\nsee also: #16472\n\nAssignee: @videlec\n\nCC:  sage-combinat\n\nKeywords: generation, combinatorics, set, subset, partition\n\nBranch/Commit: 714f266d81f57dd6d98daa5598a3b54478c213c8\n\nReviewer: Florent Hivert, Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw\n\nAuthor: Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10534\n\n",
    "closed_at": "2014-06-18T12:00:18Z",
    "created_at": "2010-12-30T16:27:16Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Cleanup in choose_nk, split_nk, subword, subset",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10534",
    "user": "https://github.com/videlec"
}
```
- deprecate `ChooseNK` (in `sage.combinat.choose_nk`) and `SplitNK` (in `sage.combinat.split_nk`).
- clean `sage.combinat.subword` and `sage.combinat.subset`
  - inheritance from `Parent`
  - much better iteration/random generation
  - ...

And become more pep8 compliant ;=)

see also: #16472

Assignee: @videlec

CC:  sage-combinat

Keywords: generation, combinatorics, set, subset, partition

Branch/Commit: 714f266d81f57dd6d98daa5598a3b54478c213c8

Reviewer: Florent Hivert, Frédéric Chapoton, Travis Scrimshaw

Author: Vincent Delecroix, Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10534





---

archive/issue_comments_114293.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,36 +1,39 @@\n-This ticket stands for a faster implementation of subset and partition generation of (finite or infinite) enumerated sets.\n+This ticket stands for a faster method of exhaustive generation of\n \n-The timing for anything related to Sage sage.combinat.Subwords, sage.combinat.Subsets, sage.combinat.SetPartitions, ... are very slow. The roadmap is as follows\n+* subwords\n+* subsets\n+* set partitions\n \n-1) **Low level generation:** Implement a small python extension which must be as performant as itertools is\n+Moreover we correct bugs and typos (see details in the patch) and create some random generation capabilities.\n+\n+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n \n \\`\\`\\`\n-sage: import itertools\n-sage: list(itertools.combinations(['a','b','c'],2))\n-[('a', 'b'), ('a', 'c'), ('b', 'c')]\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n \\`\\`\\`\n+New version\n \n-The following will be available:\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n \n-* subset of given size\n-* all subsets\n-* set partitions with given integer combination\n-* all set partitions\n-\n-And for each of them different order of generation (lex, revlex, Gray codes, ...) and output as list or tuple.\n-\n-Any Suggested names for iterators?\n-\n-combinations_lex_as_list, combinations_lex_as_tuple combinations_revlex_as_\n-\n-2) **Include and interface it with Sage:** this won't be hard.\n-\n-REFERENCES:\n-\n-* Knuth TAOCP fascicule 3a\n-* Python C API http://docs.python.org/c-api/\n-\n-Assignee: @videlec\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.47 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 94.1 ms per loop\n+\\`\\`\\`\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2011-03-28T11:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114293",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,36 +1,39 @@
-This ticket stands for a faster implementation of subset and partition generation of (finite or infinite) enumerated sets.
+This ticket stands for a faster method of exhaustive generation of
 
-The timing for anything related to Sage sage.combinat.Subwords, sage.combinat.Subsets, sage.combinat.SetPartitions, ... are very slow. The roadmap is as follows
+* subwords
+* subsets
+* set partitions
 
-1) **Low level generation:** Implement a small python extension which must be as performant as itertools is
+Moreover we correct bugs and typos (see details in the patch) and create some random generation capabilities.
+
+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
 
 \`\`\`
-sage: import itertools
-sage: list(itertools.combinations(['a','b','c'],2))
-[('a', 'b'), ('a', 'c'), ('b', 'c')]
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
 \`\`\`
+New version
 
-The following will be available:
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
 
-* subset of given size
-* all subsets
-* set partitions with given integer combination
-* all set partitions
-
-And for each of them different order of generation (lex, revlex, Gray codes, ...) and output as list or tuple.
-
-Any Suggested names for iterators?
-
-combinations_lex_as_list, combinations_lex_as_tuple combinations_revlex_as_
-
-2) **Include and interface it with Sage:** this won't be hard.
-
-REFERENCES:
-
-* Knuth TAOCP fascicule 3a
-* Python C API http://docs.python.org/c-api/
-
-Assignee: @videlec
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.47 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 94.1 ms per loop
+\`\`\`
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114294.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,39 @@\n+This ticket stands for a faster method of exhaustive generation of\n \n+* subwords\n+* subsets\n+* set partitions\n+\n+Moreover we correct bugs and typos (see details in the patch, doctest coverage is now 100%) and create some random generation capabilities.\n+\n+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\\`\\`\\`\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2011-04-05T13:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114294",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,39 @@
+This ticket stands for a faster method of exhaustive generation of
 
+* subwords
+* subsets
+* set partitions
+
+Moreover we correct bugs and typos (see details in the patch, doctest coverage is now 100%) and create some random generation capabilities.
+
+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+\`\`\`
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114295.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-05T13:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114295",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_114296.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,39 @@\n+This ticket stands for a faster method of exhaustive generation of\n \n+* subwords\n+* subsets\n+* set partitions (ordered and non orderered)\n+\n+Moreover we correct bugs and typos (see details in the patch, doctest coverage is now 100%) and create some random generation capabilities.\n+\n+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\\`\\`\\`\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2011-04-05T13:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114296",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,39 @@
+This ticket stands for a faster method of exhaustive generation of
 
+* subwords
+* subsets
+* set partitions (ordered and non orderered)
+
+Moreover we correct bugs and typos (see details in the patch, doctest coverage is now 100%) and create some random generation capabilities.
+
+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+\`\`\`
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114297.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-29T20:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114297",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_114298.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,42 @@\n+This ticket stands for a faster method of exhaustive generation of\n+\n+* subwords\n+* subsets\n+* set partitions (ordered and non orderered)\n+\n+Moreover we correct bugs and typos (see details in the patch, doctest coverage is now 100%) and create some random generation capabilities.\n+\n+To fit with FiniteEnumeratedSet, cardinality returns now a Sage Integer (and no more a Python int).\n+\n+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\\`\\`\\`\n+\n \n \n Author: vdelecroix\n```\n",
    "created_at": "2011-04-29T20:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114298",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,42 @@
+This ticket stands for a faster method of exhaustive generation of
+
+* subwords
+* subsets
+* set partitions (ordered and non orderered)
+
+Moreover we correct bugs and typos (see details in the patch, doctest coverage is now 100%) and create some random generation capabilities.
+
+To fit with FiniteEnumeratedSet, cardinality returns now a Sage Integer (and no more a Python int).
+
+Timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+\`\`\`
+
 
 
 Author: vdelecroix
```




---

archive/issue_comments_114299.json:
```json
{
    "body": "Remove assignee @videlec.",
    "created_at": "2011-05-27T17:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114299",
    "user": "https://github.com/videlec"
}
```

Remove assignee @videlec.



---

archive/issue_comments_114300.json:
```json
{
    "body": "Set assignee to @videlec.",
    "created_at": "2011-05-27T17:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114300",
    "user": "https://github.com/videlec"
}
```

Set assignee to @videlec.



---

archive/issue_comments_114301.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,43 @@\n+This ticket stands for a faster method of exhaustive generation of\n+\n+* subwords\n+* subsets\n+* set partitions (ordered and non orderered)\n+\n+Moreover, the patch provides\n+* bugs and typos corrections (doctest coverage is now 100%)\n+* random generation capabilities\n+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)\n+\n+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\\`\\`\\`\n+\n \n \n Author: vdelecroix\n```\n",
    "created_at": "2011-05-27T17:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114301",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,43 @@
+This ticket stands for a faster method of exhaustive generation of
+
+* subwords
+* subsets
+* set partitions (ordered and non orderered)
+
+Moreover, the patch provides
+* bugs and typos corrections (doctest coverage is now 100%)
+* random generation capabilities
+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)
+
+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+\`\`\`
+
 
 
 Author: vdelecroix
```




---

archive/issue_comments_114302.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,50 @@\n+This ticket stands for a faster method of exhaustive generation of\n+\n+* subwords\n+* subsets\n+* set partitions (ordered and non orderered)\n+\n+Moreover, the patch provides\n+* bugs and typos corrections (doctest coverage is now 100%)\n+* random generation capabilities\n+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)\n+\n+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)\n+sage: timeit('S.cardinality()')\n+5 loops, best of 3: 712 ms per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)\n+sage: timeit('S.cardinality()')\n+625 loops, best of 3: 33.9 \u00b5s per loop\n+\\`\\`\\`\n \n \n Author: vdelecroix\n```\n",
    "created_at": "2011-05-27T17:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114302",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,50 @@
+This ticket stands for a faster method of exhaustive generation of
+
+* subwords
+* subsets
+* set partitions (ordered and non orderered)
+
+Moreover, the patch provides
+* bugs and typos corrections (doctest coverage is now 100%)
+* random generation capabilities
+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)
+
+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)
+sage: timeit('S.cardinality()')
+5 loops, best of 3: 712 ms per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)
+sage: timeit('S.cardinality()')
+625 loops, best of 3: 33.9 µs per loop
+\`\`\`
 
 
 Author: vdelecroix
```




---

archive/issue_comments_114303.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-06-02T10:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114303",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_114304.json:
```json
{
    "body": "<a id='comment:9'></a>Hi Vincent,\n\nYour patch looks good except a few remarks:\n\n- the field Author below is for credits. You should put your real name and\n  not your login.\n\n- the documentation now says:\n   {{{\n   [...]\n   The elements of the output are tuples of Python int (and not Sage Integer).\n   [...]\n   It's element are returned as plain list of python int.\n   }}}\n   At least one of those two sentences is wrong. Also they seems a little\n   redundent. This should be fixed.\n\nI'm sorry for not having the time to put a review patch, nor finish the review\nnow.",
    "created_at": "2011-06-02T16:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114304",
    "user": "https://github.com/hivert"
}
```

<a id='comment:9'></a>Hi Vincent,

Your patch looks good except a few remarks:

- the field Author below is for credits. You should put your real name and
  not your login.

- the documentation now says:
   {{{
   [...]
   The elements of the output are tuples of Python int (and not Sage Integer).
   [...]
   It's element are returned as plain list of python int.
   }}}
   At least one of those two sentences is wrong. Also they seems a little
   redundent. This should be fixed.

I'm sorry for not having the time to put a review patch, nor finish the review
now.



---

archive/issue_comments_114305.json:
```json
{
    "body": "<a id='comment:10'></a>>  - the field Author below is for credits. You should put your real name and\n>    not your login.\n\n\nThank you for modifying this.\n\n>  - the documentation now says:\n>     {{{\n>     [...]\n>     The elements of the output are tuples of Python int (and not Sage Integer).\n>     [...]\n>     It's element are returned as plain list of python int.\n>     }}}\n\n\nThat's right. Output value are now tuples and it is fully specified.",
    "created_at": "2011-06-03T13:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114305",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>>  - the field Author below is for credits. You should put your real name and
>    not your login.


Thank you for modifying this.

>  - the documentation now says:
>     {{{
>     [...]
>     The elements of the output are tuples of Python int (and not Sage Integer).
>     [...]
>     It's element are returned as plain list of python int.
>     }}}


That's right. Output value are now tuples and it is fully specified.



---

archive/issue_comments_114306.json:
```json
{
    "body": "<a id='comment:11'></a>Attachment [trac_10534-generation_of_subsets_and_set_partitions.patch](tarball://root/attachments/some-uuid/ticket10534/trac_10534-generation_of_subsets_and_set_partitions.patch) by @hivert created at 2011-06-14 21:28:14\n\nHi Vincent,\n\nI need more time to review your long patch. I just notice the following:\n\n```\nfile: sage/combinat/choose_nk.py\n85\t            sage: [0,2] in c52   # trac XXXX \n```\nYou probably want to replace XXXX by an actual number. I'll continue my review tomorrow (hopefully)\n\nFlorent",
    "created_at": "2011-06-14T21:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114306",
    "user": "https://github.com/hivert"
}
```

<a id='comment:11'></a>Attachment [trac_10534-generation_of_subsets_and_set_partitions.patch](tarball://root/attachments/some-uuid/ticket10534/trac_10534-generation_of_subsets_and_set_partitions.patch) by @hivert created at 2011-06-14 21:28:14

Hi Vincent,

I need more time to review your long patch. I just notice the following:

```
file: sage/combinat/choose_nk.py
85	            sage: [0,2] in c52   # trac XXXX 
```
You probably want to replace XXXX by an actual number. I'll continue my review tomorrow (hopefully)

Florent



---

archive/issue_comments_114307.json:
```json
{
    "body": "<a id='comment:12'></a>Hi Florent\n\n> I need more time to review your long patch. \n\n\nCertainly. Thanks for the review.\n\nI have three important design questions relative to that patch and the Combinatorial classes which it modify\n* should the attributes of a CombinatorialClass be visible like S.w or do we prefer S._w (some code in graphs uses a direct call to S.w) ?\n* what should be the inheritance/relations between say Subsets (subset of a given set) and Subsets_k (subset of size k of a given set) ?\n* what should be the output of Subwords ? tuple, list, strings, any user defined type ? Actually, if you initialize it with list (resp. tuple, string) it output lists (resp. tuple, string). \n\n> I just notice the following:\n> \n> ```\n> file: sage/combinat/choose_nk.py\n> 85\t            sage: [0,2] in c52   # trac XXXX \n> ```\n> You probably want to replace XXXX by an actual number.\n\n\nDone",
    "created_at": "2011-06-16T12:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114307",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>Hi Florent

> I need more time to review your long patch. 


Certainly. Thanks for the review.

I have three important design questions relative to that patch and the Combinatorial classes which it modify
* should the attributes of a CombinatorialClass be visible like S.w or do we prefer S._w (some code in graphs uses a direct call to S.w) ?
* what should be the inheritance/relations between say Subsets (subset of a given set) and Subsets_k (subset of size k of a given set) ?
* what should be the output of Subwords ? tuple, list, strings, any user defined type ? Actually, if you initialize it with list (resp. tuple, string) it output lists (resp. tuple, string). 

> I just notice the following:
> 
> ```
> file: sage/combinat/choose_nk.py
> 85	            sage: [0,2] in c52   # trac XXXX 
> ```
> You probably want to replace XXXX by an actual number.


Done



---

archive/issue_comments_114308.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2012-01-29T15:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114308",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_114309.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,52 @@\n+This ticket stands for a faster method of exhaustive generation of combinatorial object that may be found in sage.combinat.* and more precisely\n \n+* subwords (sage.combinat.subword)\n+* subsets (sage.combinat.subset)\n+* set partitions (sage.combinat.set_partitions and sage.combinat.set_partition_ordered)\n+\n+Most of the time, the improvment just consists in calling the python library itertools. For other, it consists in creating a lower level Python iterator which does not use the heavy mechanism of Parent/Element (which is not intended for the frontend user).\n+\n+Moreover, the patch provides\n+* bugs and typos corrections (doctest coverage is now 100%)\n+* random generation capabilities\n+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)\n+\n+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)\n+sage: timeit('S.cardinality()')\n+5 loops, best of 3: 712 ms per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)\n+sage: timeit('S.cardinality()')\n+625 loops, best of 3: 33.9 \u00b5s per loop\n+\\`\\`\\`\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2012-04-29T19:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114309",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,52 @@
+This ticket stands for a faster method of exhaustive generation of combinatorial object that may be found in sage.combinat.* and more precisely
 
+* subwords (sage.combinat.subword)
+* subsets (sage.combinat.subset)
+* set partitions (sage.combinat.set_partitions and sage.combinat.set_partition_ordered)
+
+Most of the time, the improvment just consists in calling the python library itertools. For other, it consists in creating a lower level Python iterator which does not use the heavy mechanism of Parent/Element (which is not intended for the frontend user).
+
+Moreover, the patch provides
+* bugs and typos corrections (doctest coverage is now 100%)
+* random generation capabilities
+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)
+
+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)
+sage: timeit('S.cardinality()')
+5 loops, best of 3: 712 ms per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)
+sage: timeit('S.cardinality()')
+625 loops, best of 3: 33.9 µs per loop
+\`\`\`
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114310.json:
```json
{
    "body": "<a id='comment:14'></a>Nathan, you should be more explicit when asking for more info...",
    "created_at": "2012-04-29T19:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114310",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>Nathan, you should be more explicit when asking for more info...



---

archive/issue_comments_114311.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-04-29T19:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114311",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_114312.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,56 @@\n+This ticket stands for a faster method of exhaustive generation of combinatorial object that may be found in sage.combinat.* and more precisely\n \n+* subwords (sage.combinat.subword)\n+* subsets (sage.combinat.subset)\n+* set partitions (sage.combinat.set_partitions and sage.combinat.set_partition_ordered)\n+\n+Most of the time, the improvment just consists in calling the python library itertools. For other, it consists in creating a lower level Python iterator which does not use the heavy mechanism of Parent/Element (which is not intended for the frontend user).\n+\n+Moreover, the patch provides\n+* bugs and typos corrections (doctest coverage is now 100%)\n+* random generation capabilities\n+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)\n+\n+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)\n+sage: timeit('S.cardinality()')\n+5 loops, best of 3: 712 ms per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)\n+sage: timeit('S.cardinality()')\n+625 loops, best of 3: 33.9 \u00b5s per loop\n+\\`\\`\\`\n+\n+Apply only:\n+\n+* trac_10534-generation_of_subsets_and_set_partitions.2.patch\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2012-04-29T19:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114312",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,56 @@
+This ticket stands for a faster method of exhaustive generation of combinatorial object that may be found in sage.combinat.* and more precisely
 
+* subwords (sage.combinat.subword)
+* subsets (sage.combinat.subset)
+* set partitions (sage.combinat.set_partitions and sage.combinat.set_partition_ordered)
+
+Most of the time, the improvment just consists in calling the python library itertools. For other, it consists in creating a lower level Python iterator which does not use the heavy mechanism of Parent/Element (which is not intended for the frontend user).
+
+Moreover, the patch provides
+* bugs and typos corrections (doctest coverage is now 100%)
+* random generation capabilities
+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)
+
+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)
+sage: timeit('S.cardinality()')
+5 loops, best of 3: 712 ms per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)
+sage: timeit('S.cardinality()')
+625 loops, best of 3: 33.9 µs per loop
+\`\`\`
+
+Apply only:
+
+* trac_10534-generation_of_subsets_and_set_partitions.2.patch
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114313.json:
```json
{
    "body": "<a id='comment:17'></a>I update the file to make it works on sage-5.0. I will update the corresponding patch in the combinat queue.",
    "created_at": "2012-05-25T12:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114313",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>I update the file to make it works on sage-5.0. I will update the corresponding patch in the combinat queue.



---

archive/issue_comments_114314.json:
```json
{
    "body": "<a id='comment:18'></a>This code breaks a test in polytopes.parallelotope, because this last procedure calls Combinations and expect to receive a list and not a tuple. This has to be cured, maybe by inserting a list() at the appropriate place in this procedure. Please test that the correction works before uploading a new patch.\n\nPlease also remove all trailing whitespaces, see the bot report.",
    "created_at": "2012-07-11T10:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114314",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>This code breaks a test in polytopes.parallelotope, because this last procedure calls Combinations and expect to receive a list and not a tuple. This has to be cured, maybe by inserting a list() at the appropriate place in this procedure. Please test that the correction works before uploading a new patch.

Please also remove all trailing whitespaces, see the bot report.



---

archive/issue_comments_114315.json:
```json
{
    "body": "<a id='comment:19'></a>Here is a minimal example of what goes wrong in polytopes.parallelotope :\n\n```\nsage: g=[ vector([1,0]), vector([0,1])]\nsage: Combinations(g)\n```\n\nThis is a mutability/hash problem, when trying to convert a multiset in a set, apparently..",
    "created_at": "2012-07-16T14:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114315",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>Here is a minimal example of what goes wrong in polytopes.parallelotope :

```
sage: g=[ vector([1,0]), vector([0,1])]
sage: Combinations(g)
```

This is a mutability/hash problem, when trying to convert a multiset in a set, apparently..



---

archive/issue_comments_114316.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 chapoton]:\n> Here is a minimal example of what goes wrong in polytopes.parallelotope :\n> \n> \n> ```\n> sage: g=[ vector([1,0]), vector([0,1])]\n> sage: Combinations(g)\n> ```\n> \n> This is a mutability/hash problem, when trying to convert a multiset in a set, apparently..\n\n\nIn the above example, the command fails because the *vector* is not hashable.",
    "created_at": "2012-07-20T11:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114316",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Replying to [comment:19 chapoton]:
> Here is a minimal example of what goes wrong in polytopes.parallelotope :
> 
> 
> ```
> sage: g=[ vector([1,0]), vector([0,1])]
> sage: Combinations(g)
> ```
> 
> This is a mutability/hash problem, when trying to convert a multiset in a set, apparently..


In the above example, the command fails because the *vector* is not hashable.



---

archive/issue_comments_114317.json:
```json
{
    "body": "Attachment [trac_10534-generation_of_subsets_and_set_partitions.2.patch](tarball://root/attachments/some-uuid/ticket10534/trac_10534-generation_of_subsets_and_set_partitions.2.patch) by @videlec created at 2012-07-20 11:37:21",
    "created_at": "2012-07-20T11:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114317",
    "user": "https://github.com/videlec"
}
```

Attachment [trac_10534-generation_of_subsets_and_set_partitions.2.patch](tarball://root/attachments/some-uuid/ticket10534/trac_10534-generation_of_subsets_and_set_partitions.2.patch) by @videlec created at 2012-07-20 11:37:21



---

archive/issue_comments_114318.json:
```json
{
    "body": "<a id='comment:21'></a>I correct the error and add the ticket number on the first line of the patch (as asked by the patchbot).",
    "created_at": "2012-07-20T11:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114318",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>I correct the error and add the ticket number on the first line of the patch (as asked by the patchbot).



---

archive/issue_comments_114319.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,56 @@\n+This ticket stands for a faster method of exhaustive generation of combinatorial object that may be found in sage.combinat.* and more precisely\n \n+* subwords (sage.combinat.subword)\n+* subsets (sage.combinat.subset)\n+* set partitions (sage.combinat.set_partitions and sage.combinat.set_partition_ordered)\n+\n+Most of the time, the improvment just consists in calling the python library itertools. For other, it consists in creating a lower level Python iterator which does not use the heavy mechanism of Parent/Element (which is not intended for the frontend user).\n+\n+Moreover, the patch provides\n+* bugs and typos corrections (doctest coverage is now 100%)\n+* random generation capabilities\n+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)\n+\n+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \\`@\\` 2.10GHz)\n+\n+Old version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 401 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 4 s per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)\n+sage: timeit('S.cardinality()')\n+5 loops, best of 3: 712 ms per loop\n+\\`\\`\\`\n+New version\n+\n+\\`\\`\\`\n+sage: S = SetPartitions(8,[3,3,2])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 130 ms per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+25 loops, best of 3: 10.4 ms per loop\n+\n+sage: S = SetPartitions(9,[3,3,2,1])\n+sage: timeit('for p in S: pass')\n+5 loops, best of 3: 1.43 s per loop\n+sage: timeit('for p in S._fast_iterator(): pass')\n+5 loops, best of 3: 91.3 ms per loop\n+\n+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)\n+sage: timeit('S.cardinality()')\n+625 loops, best of 3: 33.9 \u00b5s per loop\n+\\`\\`\\`\n+\n+Apply only:\n+\n+* trac_10534-generation_of_subsets_and_set_partitions.3.patch\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2012-08-27T18:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114319",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,56 @@
+This ticket stands for a faster method of exhaustive generation of combinatorial object that may be found in sage.combinat.* and more precisely
 
+* subwords (sage.combinat.subword)
+* subsets (sage.combinat.subset)
+* set partitions (sage.combinat.set_partitions and sage.combinat.set_partition_ordered)
+
+Most of the time, the improvment just consists in calling the python library itertools. For other, it consists in creating a lower level Python iterator which does not use the heavy mechanism of Parent/Element (which is not intended for the frontend user).
+
+Moreover, the patch provides
+* bugs and typos corrections (doctest coverage is now 100%)
+* random generation capabilities
+* modified cardinality method which always return a Sage Integer (and no more Python int or Sage Rational)
+
+Some timings (on Intel(R) Core(TM)2 Duo CPU T8100  \`@\` 2.10GHz)
+
+Old version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 401 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 4 s per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5, submultiset=True)
+sage: timeit('S.cardinality()')
+5 loops, best of 3: 712 ms per loop
+\`\`\`
+New version
+
+\`\`\`
+sage: S = SetPartitions(8,[3,3,2])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 130 ms per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+25 loops, best of 3: 10.4 ms per loop
+
+sage: S = SetPartitions(9,[3,3,2,1])
+sage: timeit('for p in S: pass')
+5 loops, best of 3: 1.43 s per loop
+sage: timeit('for p in S._fast_iterator(): pass')
+5 loops, best of 3: 91.3 ms per loop
+
+sage: S = Subsets([1]*1+[2]*2+[3]*3+[4]*4+[5]*5,submultiset=True)
+sage: timeit('S.cardinality()')
+625 loops, best of 3: 33.9 µs per loop
+\`\`\`
+
+Apply only:
+
+* trac_10534-generation_of_subsets_and_set_partitions.3.patch
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114320.json:
```json
{
    "body": "<a id='comment:22'></a>Apply only:\n\n* trac_10534-generation_of_subsets_and_set_partitions.3.patch",
    "created_at": "2012-08-27T18:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114320",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'></a>Apply only:

* trac_10534-generation_of_subsets_and_set_partitions.3.patch



---

archive/issue_comments_114321.json:
```json
{
    "body": "Attachment [trac_10534-generation_of_subsets_and_set_partitions.3.patch](tarball://root/attachments/some-uuid/ticket10534/trac_10534-generation_of_subsets_and_set_partitions.3.patch) by @fchapoton created at 2012-08-31 19:29:07",
    "created_at": "2012-08-31T19:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114321",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_10534-generation_of_subsets_and_set_partitions.3.patch](tarball://root/attachments/some-uuid/ticket10534/trac_10534-generation_of_subsets_and_set_partitions.3.patch) by @fchapoton created at 2012-08-31 19:29:07



---

archive/issue_comments_114322.json:
```json
{
    "body": "<a id='comment:23'></a>new patch, to ensure 100% doctest",
    "created_at": "2012-08-31T19:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114322",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>new patch, to ensure 100% doctest



---

archive/issue_comments_114323.json:
```json
{
    "body": "<a id='comment:24'></a>I got 100% doctest coverage for all the edited files but there was one warning. If someone doesn't mind explaining what is the significance of this, that would be helpful.\n\n---\nSCORE /Applications/sage/devel/sage-main/sage/combinat/subset.py: 100% (33 of 33)\n\nPossibly wrong (function name doesn't occur in doctests):\n* _element_constructor_(self, x):\n* _element_constructor_(self, x):\n\n---\n\nAlso, \"devel/sage/sage/tests/interrupt.pyx\" timed out when I ran the long doctests.",
    "created_at": "2012-11-03T22:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114323",
    "user": "https://trac.sagemath.org/admin/accounts/users/emchennyc"
}
```

<a id='comment:24'></a>I got 100% doctest coverage for all the edited files but there was one warning. If someone doesn't mind explaining what is the significance of this, that would be helpful.

---
SCORE /Applications/sage/devel/sage-main/sage/combinat/subset.py: 100% (33 of 33)

Possibly wrong (function name doesn't occur in doctests):
* _element_constructor_(self, x):
* _element_constructor_(self, x):

---

Also, "devel/sage/sage/tests/interrupt.pyx" timed out when I ran the long doctests.



---

archive/issue_comments_114324.json:
```json
{
    "body": "<a id='comment:25'></a>> ---\n> SCORE /Applications/sage/devel/sage-main/sage/combinat/subset.py: 100% (33 of 33)\n> \n> Possibly wrong (function name doesn't occur in doctests):\n> * _element_constructor_(self, x):\n> * _element_constructor_(self, x):\n\n\nThis is because the methods _element_constructor_(self, x) are not directly tested. There should be a comment \"# indirect doctest\" after the corresponding test. Basically, this function is used to build an element of a parent, but it is called through the method __call__ of the parent (which is implemented in Parent).\n\n> Also, \"devel/sage/sage/tests/interrupt.pyx\" timed out when I ran the long doctests.\n\n\nThis is much more ennoying and I do not know why.",
    "created_at": "2012-11-04T18:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114324",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>> ---
> SCORE /Applications/sage/devel/sage-main/sage/combinat/subset.py: 100% (33 of 33)
> 
> Possibly wrong (function name doesn't occur in doctests):
> * _element_constructor_(self, x):
> * _element_constructor_(self, x):


This is because the methods _element_constructor_(self, x) are not directly tested. There should be a comment "# indirect doctest" after the corresponding test. Basically, this function is used to build an element of a parent, but it is called through the method __call__ of the parent (which is implemented in Parent).

> Also, "devel/sage/sage/tests/interrupt.pyx" timed out when I ran the long doctests.


This is much more ennoying and I do not know why.



---

archive/issue_comments_114325.json:
```json
{
    "body": "<a id='comment:26'></a>Helloooooooooooooooo !!!\n\nWhile I read your patch, two things :\n* an \"It's\" should become an \"its\"\n* why do you change the ouput type from lists to tuples ?\n\nBtw, sorry I did not answer your comment many months ago, I may have missed the warning from trac : I had set the ticket to `needs_info` because you seemed to be asking rather fundamental questions which would have had an impact on the patch, so that it would have been a pity to review the patch if you intended to change it so much later.\n\nHave you had an answer from Florent since ?\n\nNathann",
    "created_at": "2013-03-24T19:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114325",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>Helloooooooooooooooo !!!

While I read your patch, two things :
* an "It's" should become an "its"
* why do you change the ouput type from lists to tuples ?

Btw, sorry I did not answer your comment many months ago, I may have missed the warning from trac : I had set the ticket to `needs_info` because you seemed to be asking rather fundamental questions which would have had an impact on the patch, so that it would have been a pity to review the patch if you intended to change it so much later.

Have you had an answer from Florent since ?

Nathann



---

archive/issue_comments_114326.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-03T18:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114326",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_027045.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10534#event-27045"
}
```



---

archive/issue_events_027046.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10534#event-27046"
}
```



---

archive/issue_events_027047.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10534#event-27047"
}
```



---

archive/issue_events_027048.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10534#event-27048"
}
```



---

archive/issue_events_027049.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10534#event-27049"
}
```



---

archive/issue_comments_114327.json:
```json
{
    "body": "<a id='comment:31'></a>Hello,\n\nI have made a branch from the latest patch, but only partially. I have not touched the files `set_partition` and `set_partition_ordered`. \n\nMaybe one could just try to get this smaller changes in ?\n\n---\nNew commits:",
    "created_at": "2014-06-06T12:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114327",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'></a>Hello,

I have made a branch from the latest patch, but only partially. I have not touched the files `set_partition` and `set_partition_ordered`. 

Maybe one could just try to get this smaller changes in ?

---
New commits:



---

archive/issue_comments_114328.json:
```json
{
    "body": "<a id='comment:32'></a>Hi,\n\nYou deserve a necromancy badge ;-) I gave up on that ticket since Travis was refactoring a lot in `sage.combinat.*`. It definitely makes sense to have at least a portion of it. I will have a look.\n\nVincent",
    "created_at": "2014-06-06T14:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114328",
    "user": "https://github.com/videlec"
}
```

<a id='comment:32'></a>Hi,

You deserve a necromancy badge ;-) I gave up on that ticket since Travis was refactoring a lot in `sage.combinat.*`. It definitely makes sense to have at least a portion of it. I will have a look.

Vincent



---

archive/issue_comments_114329.json:
```json
{
    "body": "<a id='comment:33'></a>Ok. From the commit you proposed, I think we could\n- deprecate `ChooseNK` and `SplitNK` as it is used nowhere and subsumed by subsets and set partitions.\n- do some more cleaning in `combination.py`, `subset.py` and `subwords.py`:\n    - remove the inheritance from `CombinatorialClass` and make them inherit from `Parent`. We would set the category to `EnumeratedSets().Finite()`\n    - better iteration\n    - make `Subwords` work with words as input\n      {{{\n      sage: Subwords(Word([1,2,3,4,5]))\n      Traceback (most recent call last):\n      ...\n      ValueError: datatype should be str, list or tuple\n      }}}\n    - etc\nIf you agree with this, I can modify the ticket description and propose a commit.\n\nVincent",
    "created_at": "2014-06-06T19:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114329",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'></a>Ok. From the commit you proposed, I think we could
- deprecate `ChooseNK` and `SplitNK` as it is used nowhere and subsumed by subsets and set partitions.
- do some more cleaning in `combination.py`, `subset.py` and `subwords.py`:
    - remove the inheritance from `CombinatorialClass` and make them inherit from `Parent`. We would set the category to `EnumeratedSets().Finite()`
    - better iteration
    - make `Subwords` work with words as input
      {{{
      sage: Subwords(Word([1,2,3,4,5]))
      Traceback (most recent call last):
      ...
      ValueError: datatype should be str, list or tuple
      }}}
    - etc
If you agree with this, I can modify the ticket description and propose a commit.

Vincent



---

archive/issue_comments_114330.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:32 vdelecroix]:\n> You deserve a necromancy badge ;-) I gave up on that ticket since Travis was refactoring a lot in `sage.combinat.*`. It definitely makes sense to have at least a portion of it. I will have a look.\n\n\nI don't really have time right now to keep going through that, as much as I'd like to. +1 on getting this in. I don't remember if I had any (partial) removal of `CombinatorialClass` in `combination.py`, `subset.py`, or `subwords.py` to give as a starting point, but I don't think I did. However if you have any problems with doing this, I might have some answers so feel free to ask.\n\nBest,\n\nTravis",
    "created_at": "2014-06-06T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114330",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>Replying to [comment:32 vdelecroix]:
> You deserve a necromancy badge ;-) I gave up on that ticket since Travis was refactoring a lot in `sage.combinat.*`. It definitely makes sense to have at least a portion of it. I will have a look.


I don't really have time right now to keep going through that, as much as I'd like to. +1 on getting this in. I don't remember if I had any (partial) removal of `CombinatorialClass` in `combination.py`, `subset.py`, or `subwords.py` to give as a starting point, but I don't think I did. However if you have any problems with doing this, I might have some answers so feel free to ask.

Best,

Travis



---

archive/issue_comments_114331.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-06T19:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114332.json:
```json
{
    "body": "<a id='comment:36'></a>I have made a clean-up commit, changin only small details such as raise syntax and so on. I will now stop working on that.\n\nI agree with the changes that you propose. I hope there will be no merge problem with my stupid clean-up commit..",
    "created_at": "2014-06-06T19:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114332",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'></a>I have made a clean-up commit, changin only small details such as raise syntax and so on. I will now stop working on that.

I agree with the changes that you propose. I hope there will be no merge problem with my stupid clean-up commit..



---

archive/issue_comments_114333.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+- deprecate \\`ChooseNK\\` (in \\`sage.combinat.choose_nk\\`) and \\`SplitNK\\` (in \\`sage.combinat.split_nk\\`).\n+- clean \\`sage.combinat.subword\\` and \\`sage.combinat.subset\\`\n+  - inheritance from \\`Parent\\`\n+  - much better iteration/random generation\n+  - ...\n \n+And become more pep8 compliant ;=)\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2014-06-06T20:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114333",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,10 @@
+- deprecate \`ChooseNK\` (in \`sage.combinat.choose_nk\`) and \`SplitNK\` (in \`sage.combinat.split_nk\`).
+- clean \`sage.combinat.subword\` and \`sage.combinat.subset\`
+  - inheritance from \`Parent\`
+  - much better iteration/random generation
+  - ...
 
+And become more pep8 compliant ;=)
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114334.json:
```json
{
    "body": "<a id='comment:38'></a>I have some more to push on subsets and subwords... but for tomorrow ;-)\n\n---\nNew commits:",
    "created_at": "2014-06-06T21:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114334",
    "user": "https://github.com/videlec"
}
```

<a id='comment:38'></a>I have some more to push on subsets and subwords... but for tomorrow ;-)

---
New commits:



---

archive/issue_comments_114335.json:
```json
{
    "body": "<a id='comment:39'></a>There are some doctest continuation `...` that should be replaced by `....:`",
    "created_at": "2014-06-07T06:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114335",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'></a>There are some doctest continuation `...` that should be replaced by `....:`



---

archive/issue_comments_114336.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-07T12:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114336",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114337.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-07T15:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114337",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114338.json:
```json
{
    "body": "<a id='comment:42'></a>Very cool... now we can do\n\n```\nsage: S = Subsets(Subsets(Subsets(3)))\nsage: S.cardinality()\n115792089237316195423570985008687907853269984665640564039457584007913129639936\nsage: S.unrank(14321093401985)\n`1, 3}, {3}}, {{2}, {3}, {1, 2}, {2, 3}, {1, 3}, {1, 2, 3}}, {{1, 3}, {2}, {2, 3}, {}, {3}}, {{2}}, {}, {{1, 3}, {1, 2}, {2}, {3}}, {{2}, {1}}, {{1, 2}, {2}, {1`\nsage: S.random_element()\n...\n```\n(so I updated the tutorial which had before a `#long time` for that kind of examples). And moreover no `CombinatorialClass` anymore.\n\nNeeds review!\n\nVincent",
    "created_at": "2014-06-07T15:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114338",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>Very cool... now we can do

```
sage: S = Subsets(Subsets(Subsets(3)))
sage: S.cardinality()
115792089237316195423570985008687907853269984665640564039457584007913129639936
sage: S.unrank(14321093401985)
`1, 3}, {3}}, {{2}, {3}, {1, 2}, {2, 3}, {1, 3}, {1, 2, 3}}, {{1, 3}, {2}, {2, 3}, {}, {3}}, {{2}}, {}, {{1, 3}, {1, 2}, {2}, {3}}, {{2}, {1}}, {{1, 2}, {2}, {1`
sage: S.random_element()
...
```
(so I updated the tutorial which had before a `#long time` for that kind of examples). And moreover no `CombinatorialClass` anymore.

Needs review!

Vincent



---

archive/issue_comments_114339.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-07T15:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114339",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_114340.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-07T18:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114340",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114341.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+- deprecate \\`ChooseNK\\` (in \\`sage.combinat.choose_nk\\`) and \\`SplitNK\\` (in \\`sage.combinat.split_nk\\`).\n+- clean \\`sage.combinat.subword\\` and \\`sage.combinat.subset\\`\n+  - inheritance from \\`Parent\\`\n+  - much better iteration/random generation\n+  - ...\n \n+And become more pep8 compliant ;=)\n+\n+see also: #16472\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2014-06-11T18:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114341",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,12 @@
+- deprecate \`ChooseNK\` (in \`sage.combinat.choose_nk\`) and \`SplitNK\` (in \`sage.combinat.split_nk\`).
+- clean \`sage.combinat.subword\` and \`sage.combinat.subset\`
+  - inheritance from \`Parent\`
+  - much better iteration/random generation
+  - ...
 
+And become more pep8 compliant ;=)
+
+see also: #16472
 
 Author: vdelecroix
 
```




---

archive/issue_comments_114342.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-12T16:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114343.json:
```json
{
    "body": "<a id='comment:46'></a>Hey Vincent, I've gone through and it looks good (I tried to change the `element_class` workaround, but `Set_object_enumerated` is actually a subclass of `Parent` causing layout conflicts...uggg). I've made some minor tweaks and changed the strings to the python 3 `format`. If you're happy with my changes, then positive review. Other things (like removing `CombinatorialClass` from `Combinations` and the `element_class` thing) can be on followups.",
    "created_at": "2014-06-12T16:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114343",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:46'></a>Hey Vincent, I've gone through and it looks good (I tried to change the `element_class` workaround, but `Set_object_enumerated` is actually a subclass of `Parent` causing layout conflicts...uggg). I've made some minor tweaks and changed the strings to the python 3 `format`. If you're happy with my changes, then positive review. Other things (like removing `CombinatorialClass` from `Combinations` and the `element_class` thing) can be on followups.



---

archive/issue_comments_114344.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-12T16:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114344",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_114345.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:46 tscrim]:\n> Hey Vincent, I've gone through and it looks good (I tried to change the `element_class` workaround, but `Set_object_enumerated` is actually a subclass of `Parent` causing layout conflicts...uggg). I've made some minor tweaks and changed the strings to the python 3 `format`. If you're happy with my changes, then positive review. Other things (like removing `CombinatorialClass` from `Combinations` and the `element_class` thing) can be on followups.\n\n\nThanks for your contribution on this!\n\nVincent",
    "created_at": "2014-06-12T16:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114345",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'></a>Replying to [comment:46 tscrim]:
> Hey Vincent, I've gone through and it looks good (I tried to change the `element_class` workaround, but `Set_object_enumerated` is actually a subclass of `Parent` causing layout conflicts...uggg). I've made some minor tweaks and changed the strings to the python 3 `format`. If you're happy with my changes, then positive review. Other things (like removing `CombinatorialClass` from `Combinations` and the `element_class` thing) can be on followups.


Thanks for your contribution on this!

Vincent



---

archive/issue_comments_114346.json:
```json
{
    "body": "<a id='comment:48'></a>Merge failure due to #16067",
    "created_at": "2014-06-14T20:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114346",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:48'></a>Merge failure due to #16067



---

archive/issue_comments_114347.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-06-14T20:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114347",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_114348.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-14T20:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114348",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114349.json:
```json
{
    "body": "<a id='comment:51'></a>All right. The rebase was rather trivial.",
    "created_at": "2014-06-14T20:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114349",
    "user": "https://github.com/videlec"
}
```

<a id='comment:51'></a>All right. The rebase was rather trivial.



---

archive/issue_comments_114350.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-06-14T20:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114350",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_114351.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-06-15T12:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114351",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_114352.json:
```json
{
    "body": "<a id='comment:52'></a>\n```\nsage -t --long src/sage/misc/sageinspect.py  # 1 doctest failed\n```",
    "created_at": "2014-06-15T12:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114352",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:52'></a>
```
sage -t --long src/sage/misc/sageinspect.py  # 1 doctest failed
```



---

archive/issue_comments_114353.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-15T14:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114354.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-06-15T14:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114354",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_114355.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-06-15T16:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114355",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_114356.json:
```json
{
    "body": "<a id='comment:55'></a>Try running the testsuite...",
    "created_at": "2014-06-15T16:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114356",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:55'></a>Try running the testsuite...



---

archive/issue_comments_114357.json:
```json
{
    "body": "<a id='comment:56'></a>I did (again):\n\n```\ntravis@travis-sage:~/sage/src/sage/misc$ sage -tp sageinspect.py \nRunning doctests with ID 2014-06-15-09-38-19-7033a8ad.\nDoctesting 1 file using 4 threads.\nsage -t sageinspect.py\n    [251 tests, 24.24 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 24.6 seconds\n    cpu time: 4.7 seconds\n    cumulative wall time: 24.2 seconds\ntravis@travis-sage:~/sage/src/sage/misc$ sage -tp --long sageinspect.py \nRunning doctests with ID 2014-06-15-09-40-50-0dd08e9e.\nDoctesting 1 file using 4 threads.\nsage -t --long sageinspect.py\n    [251 tests, 24.16 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 24.5 seconds\n    cpu time: 4.7 seconds\n    cumulative wall time: 24.2 seconds\n```\nIs there a failure elsewhere (I also checked the failures that the patchbot reported and those passed)?",
    "created_at": "2014-06-15T16:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114357",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:56'></a>I did (again):

```
travis@travis-sage:~/sage/src/sage/misc$ sage -tp sageinspect.py 
Running doctests with ID 2014-06-15-09-38-19-7033a8ad.
Doctesting 1 file using 4 threads.
sage -t sageinspect.py
    [251 tests, 24.24 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 24.6 seconds
    cpu time: 4.7 seconds
    cumulative wall time: 24.2 seconds
travis@travis-sage:~/sage/src/sage/misc$ sage -tp --long sageinspect.py 
Running doctests with ID 2014-06-15-09-40-50-0dd08e9e.
Doctesting 1 file using 4 threads.
sage -t --long sageinspect.py
    [251 tests, 24.16 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 24.5 seconds
    cpu time: 4.7 seconds
    cumulative wall time: 24.2 seconds
```
Is there a failure elsewhere (I also checked the failures that the patchbot reported and those passed)?



---

archive/issue_comments_114358.json:
```json
{
    "body": "<a id='comment:57'></a>Same problem as in #16472\n\n```\nsage -t --long structure/sage_object.pyx\n**********************************************************************\nFile \"structure/sage_object.pyx\", line 1346, in sage.structure.sage_object.unpickle_all\nFailed example:\n    sage.structure.sage_object.unpickle_all()  # (4s on sage.math, 2011)\nExpected\n...\nGot:\n...\n    Failed:\n    _class__sage_combinat_choose_nk_ChooseNK__.sobj\n    _class__sage_combinat_split_nk_SplitNK_nk__.sobj\n```\n\nIf the approach with `__setstate__` is more standard then we should go for it here as well.",
    "created_at": "2014-06-15T17:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114358",
    "user": "https://github.com/videlec"
}
```

<a id='comment:57'></a>Same problem as in #16472

```
sage -t --long structure/sage_object.pyx
**********************************************************************
File "structure/sage_object.pyx", line 1346, in sage.structure.sage_object.unpickle_all
Failed example:
    sage.structure.sage_object.unpickle_all()  # (4s on sage.math, 2011)
Expected
...
Got:
...
    Failed:
    _class__sage_combinat_choose_nk_ChooseNK__.sobj
    _class__sage_combinat_split_nk_SplitNK_nk__.sobj
```

If the approach with `__setstate__` is more standard then we should go for it here as well.



---

archive/issue_comments_114359.json:
```json
{
    "body": "<a id='comment:58'></a>Will you be taking care of it Vincent or do you want me to?",
    "created_at": "2014-06-15T17:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114359",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:58'></a>Will you be taking care of it Vincent or do you want me to?



---

archive/issue_comments_114360.json:
```json
{
    "body": "<a id='comment:59'></a>Replying to [comment:58 tscrim]:\n> Will you be taking care of it Vincent or do you want me to?\n\n\nNo, no. I will do it along your lines. Thanks for proposing.",
    "created_at": "2014-06-15T17:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114360",
    "user": "https://github.com/videlec"
}
```

<a id='comment:59'></a>Replying to [comment:58 tscrim]:
> Will you be taking care of it Vincent or do you want me to?


No, no. I will do it along your lines. Thanks for proposing.



---

archive/issue_comments_114361.json:
```json
{
    "body": "<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-15T19:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_114362.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-15T19:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114362",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_114363.json:
```json
{
    "body": "<a id='comment:61'></a>Hey Travis,\n\nPlease double check that everything is fine.\n\nVincent",
    "created_at": "2014-06-15T19:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114363",
    "user": "https://github.com/videlec"
}
```

<a id='comment:61'></a>Hey Travis,

Please double check that everything is fine.

Vincent



---

archive/issue_comments_114364.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-16T05:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114364",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_114365.json:
```json
{
    "body": "<a id='comment:62'></a>LGTM. Thanks Vincent.",
    "created_at": "2014-06-16T05:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114365",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:62'></a>LGTM. Thanks Vincent.



---

archive/issue_events_027050.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-18T12:00:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10534#event-27050"
}
```



---

archive/issue_comments_114366.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-18T12:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10534#issuecomment-114366",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
