# Issue 10620: Upgrade Sphinx to version 1.1.2

archive/issues_010567.json:
```json
{
    "body": "Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. \n\n---\n\nNew spkg:\n\n- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)\n\nApply\n\n- [attachment:trac_10620-scripts-hgignore.patch] to the scripts repo\n- [attachment:trac_10620-sageinspect.patch] to the main Sage library\n- [attachment:trac_10620-sagenb-sageinspect.patch] to the sagenb repo\n\n\nAssignee: mvngu\n\nCC:  @jasongrout @hivert\n\nKeywords: sphinx upgrade spkg autodoc\n\nResolution: fixed\n\nAuthor: John Palmieri\n\nReviewer: Jeroen Demeyer\n\nMerged: sage-4.8.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/10620\n\n",
    "closed_at": "2011-11-14T17:31:48Z",
    "created_at": "2011-01-13T07:44:53Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Upgrade Sphinx to version 1.1.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10620",
    "user": "https://trac.sagemath.org/admin/accounts/users/davidm"
}
```
Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. 

---

New spkg:

- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)

Apply

- [attachment:trac_10620-scripts-hgignore.patch] to the scripts repo
- [attachment:trac_10620-sageinspect.patch] to the main Sage library
- [attachment:trac_10620-sagenb-sageinspect.patch] to the sagenb repo


Assignee: mvngu

CC:  @jasongrout @hivert

Keywords: sphinx upgrade spkg autodoc

Resolution: fixed

Author: John Palmieri

Reviewer: Jeroen Demeyer

Merged: sage-4.8.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/10620





---

archive/issue_comments_115702.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [sage_autodoc.patch](tarball://root/attachments/some-uuid/ticket10620/sage_autodoc.patch) by @mwhansen created at 2011-01-13 09:07:09\n\nIn 4.6.1, Sphinx was upgraded to 1.0.4.  Any new spkg should be based on the one found in #10350.",
    "created_at": "2011-01-13T09:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115702",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:1'></a>Attachment [sage_autodoc.patch](tarball://root/attachments/some-uuid/ticket10620/sage_autodoc.patch) by @mwhansen created at 2011-01-13 09:07:09

In 4.6.1, Sphinx was upgraded to 1.0.4.  Any new spkg should be based on the one found in #10350.



---

archive/issue_events_027337.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2011-01-13T11:10:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10620#event-27337"
}
```



---

archive/issue_comments_115703.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-27T15:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115703",
    "user": "https://github.com/jasongrout"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_115704.json:
```json
{
    "body": "<a id='comment:4'></a>Should this ticket be set to \"needs review\"?\n\nI guess by now sphinx 1.0.7 is released.",
    "created_at": "2011-04-27T15:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115704",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:4'></a>Should this ticket be set to "needs review"?

I guess by now sphinx 1.0.7 is released.



---

archive/issue_comments_115705.json:
```json
{
    "body": "<a id='comment:5'></a>We might want to wait for 1.1, depending on how long it will take, since 1.1 includes MathJax (hurrah!).",
    "created_at": "2011-04-28T05:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115705",
    "user": "https://github.com/kini"
}
```

<a id='comment:5'></a>We might want to wait for 1.1, depending on how long it will take, since 1.1 includes MathJax (hurrah!).



---

archive/issue_comments_115706.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-23T21:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115706",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_115707.json:
```json
{
    "body": "<a id='comment:6'></a>The patch for sage_autodoc needs a lot more work: the file sage_autodoc should be kept in line with the file autodoc.py in sphinx/ext.  Should we somehow autogenerate this file (using patch) from autodoc.py?",
    "created_at": "2011-07-23T21:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115707",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>The patch for sage_autodoc needs a lot more work: the file sage_autodoc should be kept in line with the file autodoc.py in sphinx/ext.  Should we somehow autogenerate this file (using patch) from autodoc.py?



---

archive/issue_comments_115708.json:
```json
{
    "body": "<a id='comment:7'></a>In fact, maybe we should include sage_autodoc.py in the Sphinx spkg: make a copy of autodoc.py, patch it, and write it in the sphinx/ext directory.  That would make it much easier to keep sage_autodoc.py in sync with autodoc.py. Then we just have to make this change in SAGE_ROOT/devel/sage/doc/common/conf.py:\n\n```diff\ndiff --git a/doc/common/conf.py b/doc/common/conf.py\n--- a/doc/common/conf.py\n+++ b/doc/common/conf.py\n@@ -13,7 +13,7 @@ sys.path.append(os.path.abspath(os.path.\n \n # Add any Sphinx extension module names here, as strings. They can be extensions\n # coming with Sphinx (named 'sphinx.ext.*') or your custom ones.\n-extensions = ['sage_autodoc',  'sphinx.ext.graphviz',\n+extensions = ['sphinx.ext.sage_autodoc',  'sphinx.ext.graphviz',\n               'sphinx.ext.inheritance_diagram', 'sphinx.ext.todo',\n               'sphinx.ext.intersphinx']\n # also of interest:\n```",
    "created_at": "2011-07-24T17:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115708",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>In fact, maybe we should include sage_autodoc.py in the Sphinx spkg: make a copy of autodoc.py, patch it, and write it in the sphinx/ext directory.  That would make it much easier to keep sage_autodoc.py in sync with autodoc.py. Then we just have to make this change in SAGE_ROOT/devel/sage/doc/common/conf.py:

```diff
diff --git a/doc/common/conf.py b/doc/common/conf.py
--- a/doc/common/conf.py
+++ b/doc/common/conf.py
@@ -13,7 +13,7 @@ sys.path.append(os.path.abspath(os.path.
 
 # Add any Sphinx extension module names here, as strings. They can be extensions
 # coming with Sphinx (named 'sphinx.ext.*') or your custom ones.
-extensions = ['sage_autodoc',  'sphinx.ext.graphviz',
+extensions = ['sphinx.ext.sage_autodoc',  'sphinx.ext.graphviz',
               'sphinx.ext.inheritance_diagram', 'sphinx.ext.todo',
               'sphinx.ext.intersphinx']
 # also of interest:
```



---

archive/issue_comments_115709.json:
```json
{
    "body": "<a id='comment:8'></a>#10715 is also an \"upgrade sphinx\" ticket that might be considered a dup of this ticket.",
    "created_at": "2011-08-09T21:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115709",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>#10715 is also an "upgrade sphinx" ticket that might be considered a dup of this ticket.



---

archive/issue_comments_115710.json:
```json
{
    "body": "<a id='comment:9'></a>And the spkg has to be rebased on that of #11659 (1.0.4.p7).",
    "created_at": "2011-08-09T22:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115710",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>And the spkg has to be rebased on that of #11659 (1.0.4.p7).



---

archive/issue_comments_115711.json:
```json
{
    "body": "Changing keywords from \"sphinx uprgrade\" to \"sphinx upgrade spkg autodoc\".",
    "created_at": "2011-08-09T22:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115711",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "sphinx uprgrade" to "sphinx upgrade spkg autodoc".



---

archive/issue_comments_115712.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 leif]:\n> And the spkg has to be rebased on that of #11659 (1.0.4.p7).\n\n\nOh, just remembered I had prepared a follow-up Sphinx 1.0.4.p8 spkg at #11665 myself (currently needing review).",
    "created_at": "2011-08-10T19:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115712",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>Replying to [comment:9 leif]:
> And the spkg has to be rebased on that of #11659 (1.0.4.p7).


Oh, just remembered I had prepared a follow-up Sphinx 1.0.4.p8 spkg at #11665 myself (currently needing review).



---

archive/issue_comments_115713.json:
```json
{
    "body": "<a id='comment:11'></a>Version 1.0.8 of Sphinx has just been released.",
    "created_at": "2011-09-23T23:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115713",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>Version 1.0.8 of Sphinx has just been released.



---

archive/issue_comments_115714.json:
```json
{
    "body": "Changing component from documentation to packages.",
    "created_at": "2011-09-23T23:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115714",
    "user": "https://github.com/jhpalmieri"
}
```

Changing component from documentation to packages.



---

archive/issue_comments_115715.json:
```json
{
    "body": "<a id='comment:12'></a>Okay, I have a new spkg, actually, two.  The first (\"p0\") is just a straightforward upgrade of the previous version.  However, we should probably update sage_autodoc.py in light of changes to the Sphinx extension autodoc.py, on which it is based.  I can provide a patch to the Sage library modifying sage_autodoc.py if necessary.\n\nA different approach: the second spkg (\"p1\") autogenerates sage_autodoc.py from autodoc.py, and saves sage_autodoc.py in sphinx/ext instead of in sage/doc/common.  So using this one requires a change to sage/doc/common/conf.py, which I've provided.  This approach seems as though it will be easier to maintain, or at least it will be easier to keep sage_autodoc.py in line with autodoc.py.\n\nWith both of these approaches, I get some warnings about cross-references, which are why the other entries are in the patch for the Sage library.  I'm seeing lots of broken cross-references, though: take a look at the reference manual for categories/examples/finite_weyl_groups.py: \n\n```\n    Only the following basic operations are implemented:\n     - :meth:`one`\n     - :meth:`product`\n     - :meth:`simple_reflection`\n     - :meth:`Element.has_right_descent`.\n{{{\nNone of these produces a link.  I don't know what's going on.",
    "created_at": "2011-09-24T04:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115715",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>Okay, I have a new spkg, actually, two.  The first ("p0") is just a straightforward upgrade of the previous version.  However, we should probably update sage_autodoc.py in light of changes to the Sphinx extension autodoc.py, on which it is based.  I can provide a patch to the Sage library modifying sage_autodoc.py if necessary.

A different approach: the second spkg ("p1") autogenerates sage_autodoc.py from autodoc.py, and saves sage_autodoc.py in sphinx/ext instead of in sage/doc/common.  So using this one requires a change to sage/doc/common/conf.py, which I've provided.  This approach seems as though it will be easier to maintain, or at least it will be easier to keep sage_autodoc.py in line with autodoc.py.

With both of these approaches, I get some warnings about cross-references, which are why the other entries are in the patch for the Sage library.  I'm seeing lots of broken cross-references, though: take a look at the reference manual for categories/examples/finite_weyl_groups.py: 

```
    Only the following basic operations are implemented:
     - :meth:`one`
     - :meth:`product`
     - :meth:`simple_reflection`
     - :meth:`Element.has_right_descent`.
{{{
None of these produces a link.  I don't know what's going on.



---

archive/issue_comments_115716.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,16 @@\n-Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached.\n+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. \n \n-Keywords: sphinx uprgrade\n+---\n+\n+Straightforward upgrade:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p0.spkg)\n+\n+Alternative approach, autogenerating sage-autodoc.py from autodoc.py:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg)\n+- apply [attachment:trac_10620-sage.patch] to the Sage library\n+\n \n Author: David Monarres\n \n```\n",
    "created_at": "2011-09-24T04:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115716",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,16 @@
-Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached.
+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. 
 
-Keywords: sphinx uprgrade
+---
+
+Straightforward upgrade:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p0.spkg)
+
+Alternative approach, autogenerating sage-autodoc.py from autodoc.py:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg)
+- apply [attachment:trac_10620-sage.patch] to the Sage library
+
 
 Author: David Monarres
 
```




---

archive/issue_comments_115717.json:
```json
{
    "body": "Attachment [trac_10620-sphinx-p0.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sphinx-p0.patch) by @jhpalmieri created at 2011-09-24 04:55:28\n\npatch for sphinx pkg, for review only",
    "created_at": "2011-09-24T04:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115717",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_10620-sphinx-p0.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sphinx-p0.patch) by @jhpalmieri created at 2011-09-24 04:55:28

patch for sphinx pkg, for review only



---

archive/issue_comments_115718.json:
```json
{
    "body": "patch for sphinx pkg, for review only",
    "created_at": "2011-09-24T04:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115718",
    "user": "https://github.com/jhpalmieri"
}
```

patch for sphinx pkg, for review only



---

archive/issue_comments_115719.json:
```json
{
    "body": "Attachment [trac_10620-sage.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sage.patch) by @jhpalmieri created at 2011-09-24 04:56:16",
    "created_at": "2011-09-24T04:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115719",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_10620-sage.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sage.patch) by @jhpalmieri created at 2011-09-24 04:56:16



---

archive/issue_comments_115720.json:
```json
{
    "body": "<a id='comment:13'></a>By the way, we could use the new spkg (either version) and keep the Sage library intact; this would use the old, and now somewhat out-dated, sage_autodoc.py, but it does not have the cross-reference problems.",
    "created_at": "2011-09-24T05:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115720",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>By the way, we could use the new spkg (either version) and keep the Sage library intact; this would use the old, and now somewhat out-dated, sage_autodoc.py, but it does not have the cross-reference problems.



---

archive/issue_comments_115721.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 jhpalmieri]:\n\nThanks for building the new spkg ! \n\n> By the way, we could use the new spkg (either version) and keep the Sage library intact; this would use the old, and now somewhat out-dated, sage_autodoc.py, but it does not have the cross-reference problems.\n\n\nConcerning cross references, I've been doing some work in #9128. So my suggestion is to upgrade the spkg (I can probably find the time to review it this week) and the keep the cross reference problem for another ticket. What to you think ?",
    "created_at": "2011-09-24T08:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115721",
    "user": "https://github.com/hivert"
}
```

<a id='comment:14'></a>Replying to [comment:13 jhpalmieri]:

Thanks for building the new spkg ! 

> By the way, we could use the new spkg (either version) and keep the Sage library intact; this would use the old, and now somewhat out-dated, sage_autodoc.py, but it does not have the cross-reference problems.


Concerning cross references, I've been doing some work in #9128. So my suggestion is to upgrade the spkg (I can probably find the time to review it this week) and the keep the cross reference problem for another ticket. What to you think ?



---

archive/issue_comments_115722.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-24T18:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115722",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_115723.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 hivert]:\n> Replying to [comment:13 jhpalmieri]:\n> \n> Thanks for building the new spkg ! \n> \n> > By the way, we could use the new spkg (either version) and keep the Sage library intact; this would use the old, and now somewhat out-dated, sage_autodoc.py, but it does not have the cross-reference problems.\n\n> \n> Concerning cross references, I've been doing some work in #9128. So my suggestion is to upgrade the spkg (I can probably find the time to review it this week) and the keep the cross reference problem for another ticket. What to you think ? \n\n\nIt makes me uncomfortable to have sage_autodoc.py so out-of-synch with autodoc.py, and as far as I can tell, changes to autodoc.py, and hence to the updated sage_autodoc.py, are what is causing the problem with the cross-references.  So I think just merging the spkg would only be acceptable if the work on #9128 (or elsewhere?) includes updating sage_autodoc.py.  What do you think of the idea of putting that file in the Sphinx directory (as in the \"p1\" version of the spkg) instead of keeping it in the Sage library?",
    "created_at": "2011-09-24T18:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115723",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>Replying to [comment:14 hivert]:
> Replying to [comment:13 jhpalmieri]:
> 
> Thanks for building the new spkg ! 
> 
> > By the way, we could use the new spkg (either version) and keep the Sage library intact; this would use the old, and now somewhat out-dated, sage_autodoc.py, but it does not have the cross-reference problems.

> 
> Concerning cross references, I've been doing some work in #9128. So my suggestion is to upgrade the spkg (I can probably find the time to review it this week) and the keep the cross reference problem for another ticket. What to you think ? 


It makes me uncomfortable to have sage_autodoc.py so out-of-synch with autodoc.py, and as far as I can tell, changes to autodoc.py, and hence to the updated sage_autodoc.py, are what is causing the problem with the cross-references.  So I think just merging the spkg would only be acceptable if the work on #9128 (or elsewhere?) includes updating sage_autodoc.py.  What do you think of the idea of putting that file in the Sphinx directory (as in the "p1" version of the spkg) instead of keeping it in the Sage library?



---

archive/issue_comments_115724.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-11-05T18:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115724",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_115725.json:
```json
{
    "body": "<a id='comment:17'></a>There is now a version 1.1.2 of Sphinx.  Probably we should update this spkg.",
    "created_at": "2011-11-05T18:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115725",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>There is now a version 1.1.2 of Sphinx.  Probably we should update this spkg.



---

archive/issue_comments_115726.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,15 @@\n+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. \n+\n+---\n+\n+Straightforward upgrade:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)\n+\n+Alternative approach, autogenerating sage-autodoc.py from autodoc.py:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg)\n+- apply [attachment:trac_10620-sage.patch] to the Sage library\n \n \n Author: David Monarres\n```\n",
    "created_at": "2011-11-05T19:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115726",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,15 @@
+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. 
+
+---
+
+Straightforward upgrade:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)
+
+Alternative approach, autogenerating sage-autodoc.py from autodoc.py:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg)
+- apply [attachment:trac_10620-sage.patch] to the Sage library
 
 
 Author: David Monarres
```




---

archive/issue_comments_115727.json:
```json
{
    "body": "<a id='comment:18'></a>I updated the \"straightforward\" spkg, I have no clue what `autodoc` is, so I left that alone.",
    "created_at": "2011-11-05T19:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115727",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>I updated the "straightforward" spkg, I have no clue what `autodoc` is, so I left that alone.



---

archive/issue_comments_115728.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-05T19:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115728",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_115729.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,15 @@\n+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. \n+\n+---\n+\n+Straightforward upgrade:\n+\n+- [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.1.2.p0.spkg)\n+\n+Alternative approach, autogenerating sage-autodoc.py from autodoc.py:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg)\n+- apply [attachment:trac_10620-sage.patch] to the Sage library\n \n \n Author: David Monarres\n```\n",
    "created_at": "2011-11-05T19:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115729",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,15 @@
+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. 
+
+---
+
+Straightforward upgrade:
+
+- [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.1.2.p0.spkg)
+
+Alternative approach, autogenerating sage-autodoc.py from autodoc.py:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.0.8.p1.spkg)
+- apply [attachment:trac_10620-sage.patch] to the Sage library
 
 
 Author: David Monarres
```




---

archive/issue_comments_115730.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. \n+\n+---\n+\n+New spkg:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)\n \n \n Author: David Monarres\n```\n",
    "created_at": "2011-11-05T20:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115730",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,10 @@
+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. 
+
+---
+
+New spkg:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)
 
 
 Author: David Monarres
```




---

archive/issue_comments_115731.json:
```json
{
    "body": "<a id='comment:20'></a>`sage_autodoc` is the Sage version of the Sphinx extension `autodoc` (found in `sphinx/ext/`); it is used to extract the reference manual from the source code.  We've modified the original to handle various things (perhaps cython code, lazy methods, cached methods?).  So `sage_autodoc.py`, which lives in `devel/sage/doc/common`, used to be a simple modification of the Sphinx file `autodoc.py`, but now the two files differ more dramatically as `autodoc.py` has been patched in ways that `sage_autodoc.py` hasn't, and vice versa.\n\nIt might be good, to take full advantage of upgrades to Sphinx, to try to remedy this by creating `sage_autodoc.py` by patching `autodoc.py` in the Sphinx spkg.  Unfortunately, when I tried this approach, the new `sage_autodoc` module didn't work perfectly, probably because of recent changes in `autodoc`.  This could be dealt with on another ticket.  Following Leif's general suggestion about this kind of thing, perhaps we should add a \"To do\" item to the \"Special Build Instructions\" section of SPKG.txt.  I've prepared a new spkg (based on yours) with this change.  The spkg also removes the patch to 'autodoc.py', since I don't think we use that anymore: we use 'sage_autodoc.py' instead.",
    "created_at": "2011-11-05T20:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115731",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>`sage_autodoc` is the Sage version of the Sphinx extension `autodoc` (found in `sphinx/ext/`); it is used to extract the reference manual from the source code.  We've modified the original to handle various things (perhaps cython code, lazy methods, cached methods?).  So `sage_autodoc.py`, which lives in `devel/sage/doc/common`, used to be a simple modification of the Sphinx file `autodoc.py`, but now the two files differ more dramatically as `autodoc.py` has been patched in ways that `sage_autodoc.py` hasn't, and vice versa.

It might be good, to take full advantage of upgrades to Sphinx, to try to remedy this by creating `sage_autodoc.py` by patching `autodoc.py` in the Sphinx spkg.  Unfortunately, when I tried this approach, the new `sage_autodoc` module didn't work perfectly, probably because of recent changes in `autodoc`.  This could be dealt with on another ticket.  Following Leif's general suggestion about this kind of thing, perhaps we should add a "To do" item to the "Special Build Instructions" section of SPKG.txt.  I've prepared a new spkg (based on yours) with this change.  The spkg also removes the patch to 'autodoc.py', since I don't think we use that anymore: we use 'sage_autodoc.py' instead.



---

archive/issue_comments_115732.json:
```json
{
    "body": "<a id='comment:21'></a>The following should be added to the scripts ``.hgignore``:\n\n```\nsphinx-apidoc\n```",
    "created_at": "2011-11-05T23:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115732",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>The following should be added to the scripts ``.hgignore``:

```
sphinx-apidoc
```



---

archive/issue_comments_115733.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-11-05T23:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115733",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_115734.json:
```json
{
    "body": "<a id='comment:22'></a>I think this is okay now.  It's a little more complicated than I thought.  First, Sage does use autodoc, in the 'sphinxify' routine when doing introspection.  So I restored the autodoc patch.  Second, with the new spkg, I was getting doctest failures: one piece of output in sageinspect.py was wrong.  I think that the new output is actually better: it's processing a docstring using sphinxify and coming up with nicer output.  So I think it's okay to change the output for the doctest.\n\nSo there are three or four patches, one for the scripts repo (hgignore), one for the Sage library (doctest), and one for the Sphinx spkg.  The patch for the Sage library should come with a corresponding patch for sagenb, but I don't know what to do about that.  Submit a ticket for the flask notebook?  I'll include one for the current sagenb repo, in case that's the right thing to do.",
    "created_at": "2011-11-06T02:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115734",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>I think this is okay now.  It's a little more complicated than I thought.  First, Sage does use autodoc, in the 'sphinxify' routine when doing introspection.  So I restored the autodoc patch.  Second, with the new spkg, I was getting doctest failures: one piece of output in sageinspect.py was wrong.  I think that the new output is actually better: it's processing a docstring using sphinxify and coming up with nicer output.  So I think it's okay to change the output for the doctest.

So there are three or four patches, one for the scripts repo (hgignore), one for the Sage library (doctest), and one for the Sphinx spkg.  The patch for the Sage library should come with a corresponding patch for sagenb, but I don't know what to do about that.  Submit a ticket for the flask notebook?  I'll include one for the current sagenb repo, in case that's the right thing to do.



---

archive/issue_comments_115735.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,16 @@\n+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. \n+\n+---\n+\n+New spkg:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)\n+\n+Apply\n+\n+- [attachment:trac_10620-scripts-hgignore.patch] to the scripts repo\n+- [attachment:trac_10620-sageinspect.patch] to the main Sage library\n+- [attachment:trac_10620-sagenb-sageinspect.patch] to the sagenb repo\n \n \n Author: David Monarres\n```\n",
    "created_at": "2011-11-06T02:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115735",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,16 @@
+Just made a spkg and a change to sage_autodoc in order to upgrade sphinx to the latest version. Spkg and patch attached. 
+
+---
+
+New spkg:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/sphinx-1.1.2.p0.spkg)
+
+Apply
+
+- [attachment:trac_10620-scripts-hgignore.patch] to the scripts repo
+- [attachment:trac_10620-sageinspect.patch] to the main Sage library
+- [attachment:trac_10620-sagenb-sageinspect.patch] to the sagenb repo
 
 
 Author: David Monarres
```




---

archive/issue_comments_115736.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-06T02:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115736",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_115737.json:
```json
{
    "body": "Attachment [trac_10620-sphinx-1.1.2.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sphinx-1.1.2.patch) by @jhpalmieri created at 2011-11-06 02:15:06\n\npatch for sphinx 1.1.2 spkg; for review only",
    "created_at": "2011-11-06T02:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115737",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_10620-sphinx-1.1.2.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sphinx-1.1.2.patch) by @jhpalmieri created at 2011-11-06 02:15:06

patch for sphinx 1.1.2 spkg; for review only



---

archive/issue_comments_115738.json:
```json
{
    "body": "Attachment [trac_10620-scripts-hgignore.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-scripts-hgignore.patch) by @jhpalmieri created at 2011-11-06 02:15:17\n\nscripts repo",
    "created_at": "2011-11-06T02:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115738",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_10620-scripts-hgignore.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-scripts-hgignore.patch) by @jhpalmieri created at 2011-11-06 02:15:17

scripts repo



---

archive/issue_comments_115739.json:
```json
{
    "body": "sage library repo",
    "created_at": "2011-11-06T02:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115739",
    "user": "https://github.com/jhpalmieri"
}
```

sage library repo



---

archive/issue_comments_115740.json:
```json
{
    "body": "Attachment [trac_10620-sagenb-sageinspect.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sagenb-sageinspect.patch) by @jhpalmieri created at 2011-11-06 02:49:28\n\nsagenb repo",
    "created_at": "2011-11-06T02:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115740",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_10620-sagenb-sageinspect.patch](tarball://root/attachments/some-uuid/ticket10620/trac_10620-sagenb-sageinspect.patch) by @jhpalmieri created at 2011-11-06 02:49:28

sagenb repo



---

archive/issue_comments_115741.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 jhpalmieri]:\n> I'll include one for the current sagenb repo, in case that's the right thing to do.\n\nYes, this is the right thing to do (I have discussed with the sagenb developers some time ago).",
    "created_at": "2011-11-06T09:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115741",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Replying to [comment:22 jhpalmieri]:
> I'll include one for the current sagenb repo, in case that's the right thing to do.

Yes, this is the right thing to do (I have discussed with the sagenb developers some time ago).



---

archive/issue_comments_115742.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-11T22:17:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115742",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_115743.json:
```json
{
    "body": "<a id='comment:24'></a>Looks good to me, but see the encoding issue at #10112.",
    "created_at": "2011-11-11T22:17:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115743",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>Looks good to me, but see the encoding issue at #10112.



---

archive/issue_events_027338.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T17:31:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10620#event-27338"
}
```



---

archive/issue_comments_115744.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-14T17:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10620",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10620#issuecomment-115744",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
