# Issue 10525: move algebraic subschemes of toric varieties to their rightful places

archive/issues_010472.json:
```json
{
    "body": "We should follow affine and projective space and put the implementation of algebraic subschemes into `algebraic_scheme.py`, the morphisms into `morphism.py`, and homsets into `homset.py`. The attached patch does this and adds documentation to the algebraic schemes module.\n\n**Assignee:** @aghitza\n\n**CC:**  @novoselt\n\n**Author:** Volker Braun\n\n**Reviewer:** Andrey Novoseltsev\n\n**Merged:** sage-4.6.2.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/10525\n\n",
    "closed_at": "2011-01-25T08:16:32Z",
    "created_at": "2010-12-24T22:36:00Z",
    "labels": [
        "component: algebraic geometry",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "move algebraic subschemes of toric varieties to their rightful places",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10525",
    "user": "https://github.com/vbraun"
}
```
We should follow affine and projective space and put the implementation of algebraic subschemes into `algebraic_scheme.py`, the morphisms into `morphism.py`, and homsets into `homset.py`. The attached patch does this and adds documentation to the algebraic schemes module.

**Assignee:** @aghitza

**CC:**  @novoselt

**Author:** Volker Braun

**Reviewer:** Andrey Novoseltsev

**Merged:** sage-4.6.2.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/10525





---

archive/issue_comments_127389.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-We should follow affine and projective space and put the implementation of algebraic subschemes into `algebraic_scheme.py`, the morphisms into `morphism.py`, and homsets into `homset.py`. The attached patch does this.\n+We should follow affine and projective space and put the implementation of algebraic subschemes into `algebraic_scheme.py`, the morphisms into `morphism.py`, and homsets into `homset.py`. The attached patch does this and adds documentation to the algebraic schemes module.\n``````\n",
    "created_at": "2010-12-24T22:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127389",
    "user": "https://github.com/vbraun"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-We should follow affine and projective space and put the implementation of algebraic subschemes into `algebraic_scheme.py`, the morphisms into `morphism.py`, and homsets into `homset.py`. The attached patch does this.
+We should follow affine and projective space and put the implementation of algebraic subschemes into `algebraic_scheme.py`, the morphisms into `morphism.py`, and homsets into `homset.py`. The attached patch does this and adds documentation to the algebraic schemes module.
``````




---

archive/issue_comments_127390.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-12-24T22:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127390",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_127391.json:
```json
{
    "body": "<a id='comment:2'></a>\nI knew how affine/projective classes were packed into modules but deliberately violated the convention for toric varieties. Reasons:\n\n1. Old modules are not documented/doctested, so it was easier to make sure that new stuff does follow requirements when it is in completely new files.\n2. Old classes should be switched from old parents and methods to the new coercion framework and there may be some redesign in the process, so it is also good to keep them more separated.\n3. Perhaps the most important: toric varieties/subvarieties/morphisms are more related to each other then to affine or projective analogs, in particular it makes more sense to group documentation on toric classes together rather than documentation on all kinds of ambients spaces, then all kinds of morphisms and so on. Note also that having classes in the same module simplifies Sphynx references to them - it is much more likely that documentation of a toric morphism will refer to toric varieties rather than affine morphisms. Also, I find it much more convenient to work with the source code files of toric framework as opposed to previous schemes. When there are 5 similar named classes with almost the same methods in a generically named file, I got confused which method I am editing.\n\nSo I am against this patch and would prefer instead to regroup older classes similar to toric varieties or perhaps split them into separate modules like `affine_morphism`, `projective_morphism`, etc. Of course, it is mostly just personal preference and taste, so if my reasoning is unconvincing I will consent...",
    "created_at": "2011-01-10T20:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127391",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:2'></a>
I knew how affine/projective classes were packed into modules but deliberately violated the convention for toric varieties. Reasons:

1. Old modules are not documented/doctested, so it was easier to make sure that new stuff does follow requirements when it is in completely new files.
2. Old classes should be switched from old parents and methods to the new coercion framework and there may be some redesign in the process, so it is also good to keep them more separated.
3. Perhaps the most important: toric varieties/subvarieties/morphisms are more related to each other then to affine or projective analogs, in particular it makes more sense to group documentation on toric classes together rather than documentation on all kinds of ambients spaces, then all kinds of morphisms and so on. Note also that having classes in the same module simplifies Sphynx references to them - it is much more likely that documentation of a toric morphism will refer to toric varieties rather than affine morphisms. Also, I find it much more convenient to work with the source code files of toric framework as opposed to previous schemes. When there are 5 similar named classes with almost the same methods in a generically named file, I got confused which method I am editing.

So I am against this patch and would prefer instead to regroup older classes similar to toric varieties or perhaps split them into separate modules like `affine_morphism`, `projective_morphism`, etc. Of course, it is mostly just personal preference and taste, so if my reasoning is unconvincing I will consent...



---

archive/issue_comments_127392.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2011-01-10T20:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127392",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_127393.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2011-01-11T22:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127393",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_127394.json:
```json
{
    "body": "**Reviewer:** Andrey Novoseltsev",
    "created_at": "2011-01-11T22:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127394",
    "user": "https://github.com/vbraun"
}
```

**Reviewer:** Andrey Novoseltsev



---

archive/issue_comments_127395.json:
```json
{
    "body": "<a id='comment:3'></a>\nHi Andrey, \n\nI do understand your points and I do agree that there is a case to be made to separate them. But at least for now I would prefer to have everything in one place:\n\n* Its easier to refactor things if you don't have to hunt for code in different files. If you get confused with similar-looking methods then that really shows that common code ought to be moved to the base class.\n\n* From the end user point of view, there shouldn't be much of a difference between the affine schemes. Its an ambient space with equations. The end user is probably interested in presentation-independent properties like irreducible components, dimensions, singularities. Not so much about the details of the embedding. The module documentation should emphasize that that the different classes behave in the same way and not so much focus on the implementation details.\n\n* Also, for \"patches\" of toric varieties we definitely need both the affine toric patches as well as the embedding in affine space (with the toric ideal). So again the different algebraic schemes end up being coupled more tightly than you think.\n\n* Im unifying the somewhat duplicated methods `projective_embedding` vs. `embedding_morphism` in `trac_10540_Spec_of_affine_toric_variety.patch`.\n\nIn any case, I think we should first merge this sequence of patches and then figure out the coercion / category framework. If we can then split the code into different files without introducing cyclic dependencies then I'd be happy to do so.",
    "created_at": "2011-01-11T22:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127395",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>
Hi Andrey, 

I do understand your points and I do agree that there is a case to be made to separate them. But at least for now I would prefer to have everything in one place:

* Its easier to refactor things if you don't have to hunt for code in different files. If you get confused with similar-looking methods then that really shows that common code ought to be moved to the base class.

* From the end user point of view, there shouldn't be much of a difference between the affine schemes. Its an ambient space with equations. The end user is probably interested in presentation-independent properties like irreducible components, dimensions, singularities. Not so much about the details of the embedding. The module documentation should emphasize that that the different classes behave in the same way and not so much focus on the implementation details.

* Also, for "patches" of toric varieties we definitely need both the affine toric patches as well as the embedding in affine space (with the toric ideal). So again the different algebraic schemes end up being coupled more tightly than you think.

* Im unifying the somewhat duplicated methods `projective_embedding` vs. `embedding_morphism` in `trac_10540_Spec_of_affine_toric_variety.patch`.

In any case, I think we should first merge this sequence of patches and then figure out the coercion / category framework. If we can then split the code into different files without introducing cyclic dependencies then I'd be happy to do so.



---

archive/issue_comments_127396.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2011-01-12T00:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127396",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_127397.json:
```json
{
    "body": "<a id='comment:4'></a>\nOK, let's proceed with it.\n\nTo make my life easier - did you make any changes to the code from/in `toric_variety` module except for hyperlinks adjustments?",
    "created_at": "2011-01-12T00:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127397",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:4'></a>
OK, let's proceed with it.

To make my life easier - did you make any changes to the code from/in `toric_variety` module except for hyperlinks adjustments?



---

archive/issue_comments_127398.json:
```json
{
    "body": "<a id='comment:5'></a>\nI didn't make any major changes to `toric_variety.py`, in this patch I just moved stuff to the algebraic schemes.",
    "created_at": "2011-01-12T01:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127398",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
I didn't make any major changes to `toric_variety.py`, in this patch I just moved stuff to the algebraic schemes.



---

archive/issue_comments_127399.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2011-01-14T00:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127399",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_info to needs_review.



---

archive/attachments_013747.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10525_reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10525/trac_10525_reviewer.patch",
    "created_at": "2011-01-14T00:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_127400.json:
```json
{
    "body": "<a id='comment:6'></a>\nI made some little changes to the documentation while I was reading it. If you agree with them, feel free to set this to positive review!",
    "created_at": "2011-01-14T00:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127400",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:6'></a>
I made some little changes to the documentation while I was reading it. If you agree with them, feel free to set this to positive review!



---

archive/issue_comments_127401.json:
```json
{
    "body": "<a id='comment:7'></a>\nLooks great, thanks!",
    "created_at": "2011-01-14T00:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127401",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
Looks great, thanks!



---

archive/issue_comments_127402.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-01-14T00:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127402",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_127403.json:
```json
{
    "body": "<a id='comment:8'></a>\nI am rebuilding to final 4.6.1 now, so I didn't check, but I am pretty sure that this patch will conflict with #9055 which got merged in 4.6.2.alpha0, so this one has to be rebased.",
    "created_at": "2011-01-14T01:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127403",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>
I am rebuilding to final 4.6.1 now, so I didn't check, but I am pretty sure that this patch will conflict with #9055 which got merged in 4.6.2.alpha0, so this one has to be rebased.



---

archive/issue_comments_127404.json:
```json
{
    "body": "Rebased agains sage-4.6.2.alpha0",
    "created_at": "2011-01-19T18:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127404",
    "user": "https://github.com/novoselt"
}
```

Rebased agains sage-4.6.2.alpha0



---

archive/attachments_013748.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10525_move_AlgebraicScheme_subscheme_toric.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10525/trac_10525_move_AlgebraicScheme_subscheme_toric.2.patch",
    "created_at": "2011-01-19T18:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_127405.json:
```json
{
    "body": "<a id='comment:9'></a>\nIndeed there was some fuzz, I have updated the original patch to apply smoothly.\n\nApply trac_10525_move_AlgebraicScheme_subscheme_toric.2.patch and trac_10525_reviewer.patch",
    "created_at": "2011-01-19T18:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127405",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:9'></a>
Indeed there was some fuzz, I have updated the original patch to apply smoothly.

Apply trac_10525_move_AlgebraicScheme_subscheme_toric.2.patch and trac_10525_reviewer.patch



---

archive/issue_comments_127406.json:
```json
{
    "body": "<a id='comment:10'></a>\nI still get fuzz, there is some issue with patch ordering I think. I've reordered my patch queue to reflect #9433 as closely as possible. See also https://bitbucket.org/vbraun/mq-for-sage-toric-varieties\n\nRediffed patch follows. \n\nApply trac_10525_move_AlgebraicScheme_subscheme_toric.patch and trac_10525_reviewer.patch",
    "created_at": "2011-01-19T19:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127406",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>
I still get fuzz, there is some issue with patch ordering I think. I've reordered my patch queue to reflect #9433 as closely as possible. See also https://bitbucket.org/vbraun/mq-for-sage-toric-varieties

Rediffed patch follows. 

Apply trac_10525_move_AlgebraicScheme_subscheme_toric.patch and trac_10525_reviewer.patch



---

archive/attachments_013749.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10525_move_AlgebraicScheme_subscheme_toric.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10525/trac_10525_move_AlgebraicScheme_subscheme_toric.patch",
    "created_at": "2011-01-19T19:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_127407.json:
```json
{
    "body": "Updated patch",
    "created_at": "2011-01-19T19:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127407",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_127408.json:
```json
{
    "body": "<a id='comment:11'></a>\nFor the patch bot:\nDepends on #9055",
    "created_at": "2011-01-19T22:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127408",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>
For the patch bot:
Depends on #9055



---

archive/issue_comments_127409.json:
```json
{
    "body": "<a id='comment:12'></a>\nGot it: fuzz in `fano_toric_varieties` was due to me having #10522 before this - somehow it got lost and I didn't take it into account when I rearranged my queue. Now Volker's latest version applies smoothly for me.",
    "created_at": "2011-01-20T00:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127409",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:12'></a>
Got it: fuzz in `fano_toric_varieties` was due to me having #10522 before this - somehow it got lost and I didn't take it into account when I rearranged my queue. Now Volker's latest version applies smoothly for me.



---

archive/issue_events_031956.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-25T08:16:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10525#event-31956"
}
```



---

archive/issue_comments_127410.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha2",
    "created_at": "2011-01-25T08:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10525",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10525#issuecomment-127410",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha2
