# Issue 10720: nth_root for (Laurent) power series

archive/issues_010657.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-pernici"
    ],
    "body": "There is a nth_root method defined on univariate polynomial (via Newton method)\n\n```\nsage: R.<x> = QQ[]\nsage: ((1 + x - x^2)**5).nth_root(5)\n-x^2 + x + 1\n```\nWe provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n\nThis branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n\nOn multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n\nCC:  @robertwb @bgrenet\n\nKeywords: **power series**\n\nBranch/Commit: **[`eddd45d`](https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d)**\n\nReviewer: **S\u00e9bastien Labb\u00e9**\n\nAuthor: **Mario Pernici, Vincent Delecroix**\n\nComponent: **commutative algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10720_\n\n",
    "closed_at": "2017-12-31T09:27:55Z",
    "created_at": "2011-01-31T18:18:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20commutative%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "nth_root for (Laurent) power series",
    "type": "issue",
    "updated_at": "2017-12-31T09:27:55Z",
    "url": "https://github.com/sagemath/sage/issues/10720",
    "user": "https://github.com/sagetrac-pernici"
}
```
There is a nth_root method defined on univariate polynomial (via Newton method)

```
sage: R.<x> = QQ[]
sage: ((1 + x - x^2)**5).nth_root(5)
-x^2 + x + 1
```
We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.

This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).

On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.

CC:  @robertwb @bgrenet

Keywords: **power series**

Branch/Commit: **[`eddd45d`](https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d)**

Reviewer: **Sébastien Labbé**

Author: **Mario Pernici, Vincent Delecroix**

Component: **commutative algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/10720_





---

archive/issue_events_140072.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2011-01-31T18:18:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140072"
}
```



---

archive/issue_comments_102914.json:
```json
{
    "body": "Attachment: **[trac_10720_power_series_nth_root.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root.patch.gz)**",
    "created_at": "2011-01-31T18:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102914",
    "user": "https://github.com/sagetrac-pernici"
}
```

Attachment: **[trac_10720_power_series_nth_root.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root.patch.gz)**



---

archive/issue_comments_102915.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -40,4 +40,3 @@\n In particular it can be used in the multivariate series considered\n in ticket #1956 .\n \n-\n``````\n",
    "created_at": "2011-01-31T18:33:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102915",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -40,4 +40,3 @@
 In particular it can be used in the multivariate series considered
 in ticket #1956 .
 
-
``````




---

archive/issue_events_140073.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2011-01-31T18:33:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20commutative%20algebra",
    "label_color": "0000ff",
    "label_name": "c: commutative algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140073"
}
```



---

archive/issue_events_140074.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2011-01-31T18:33:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140074"
}
```



---

archive/issue_events_140075.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2011-01-31T18:33:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140075"
}
```



---

archive/issue_comments_102916.json:
```json
{
    "body": "Changed keywords from none to **power series**",
    "created_at": "2011-01-31T18:33:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102916",
    "user": "https://github.com/sagetrac-pernici"
}
```

Changed keywords from none to **power series**



---

archive/issue_comments_102917.json:
```json
{
    "body": "Author: **mario pernici**",
    "created_at": "2011-01-31T18:33:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102917",
    "user": "https://github.com/sagetrac-pernici"
}
```

Author: **mario pernici**



---

archive/issue_events_140076.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2011-01-31T18:33:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140076"
}
```



---

archive/issue_events_140077.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2011-01-31T18:33:48Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "subject": "https://github.com/sagetrac-pernici",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140077"
}
```



---

archive/issue_comments_102918.json:
```json
{
    "body": "Attachment: **[trac_10720_power_series_nth_root_2.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_2.patch.gz)**",
    "created_at": "2011-02-01T17:13:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102918",
    "user": "https://github.com/sagetrac-pernici"
}
```

Attachment: **[trac_10720_power_series_nth_root_2.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_2.patch.gz)**



---

archive/issue_comments_102919.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,42 +1,4 @@\n-In this patch the nth-root of power series `y = x^n` is introduced using\n-the Newton method for `y = x^-n`\n+computation of an nth root of a power series using the Newton method\n \n-```\n-x' = (1+1/n)*x - y*x^(n+1)/n               (1)\n-```\n+Apply trac_10720_power_series_nth_root_2.patch\n \n-```\n-sage: R.<t> = QQ[]\n-sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^3\n-sage: p.nth_root(3)\n-1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)\n-sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^-3\n-sage: p.nth_root(-3)\n-1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)\n-```\n-\n-The iterations are division-free;\n-in the case `n=2` one can compare this division-free iteration\n-with the iteration used in the Newton method for `sqrt`\n-\n-```\n-x' = (x +y/x)/2                            (2)\n-```\n-\n-\n-`nth_root` can be used to compute the square root of series which\n-currently `sqrt` does not support\n-\n-```\n-sage: R.<x,y> = QQ[]\n-sage: S.<t> = R[[]]\n-sage: p = 1 + x*t + (x^2+y^2)*t^2 + O(t^3)\n-sage: p1 = p.nth_root(2); p1\n-1 + 1/2*x*t + (3/8*x^2 + 1/2*y^2)*t^2 + O(t^3)\n-sage: p1^2\n-1 + x*t + (x^2 + y^2)*t^2 + O(t^3)\n-```\n-\n-In particular it can be used in the multivariate series considered\n-in ticket #1956 .\n-\n``````\n",
    "created_at": "2011-02-01T17:23:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102919",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,42 +1,4 @@
-In this patch the nth-root of power series `y = x^n` is introduced using
-the Newton method for `y = x^-n`
+computation of an nth root of a power series using the Newton method
 
-```
-x' = (1+1/n)*x - y*x^(n+1)/n               (1)
-```
+Apply trac_10720_power_series_nth_root_2.patch
 
-```
-sage: R.<t> = QQ[]
-sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^3
-sage: p.nth_root(3)
-1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)
-sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^-3
-sage: p.nth_root(-3)
-1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)
-```
-
-The iterations are division-free;
-in the case `n=2` one can compare this division-free iteration
-with the iteration used in the Newton method for `sqrt`
-
-```
-x' = (x +y/x)/2                            (2)
-```
-
-
-`nth_root` can be used to compute the square root of series which
-currently `sqrt` does not support
-
-```
-sage: R.<x,y> = QQ[]
-sage: S.<t> = R[[]]
-sage: p = 1 + x*t + (x^2+y^2)*t^2 + O(t^3)
-sage: p1 = p.nth_root(2); p1
-1 + 1/2*x*t + (3/8*x^2 + 1/2*y^2)*t^2 + O(t^3)
-sage: p1^2
-1 + x*t + (x^2 + y^2)*t^2 + O(t^3)
-```
-
-In particular it can be used in the multivariate series considered
-in ticket #1956 .
-
``````




---

archive/issue_comments_102920.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe nth-root of power series `y = x^n` is computed using\nthe Newton method for `y = x^-n`\n\n```\nx' = (1+1/n)*x - y*x^(n+1)/n\n```\n\n```\nsage: R.<t> = QQ[]\nsage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^3\nsage: p.nth_root(3)\n1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)\nsage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^-3\nsage: p.nth_root(-3)\n1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)\n```\n\n\nWith this patch `nth_root` works also for series on `ZZ`\n\n```\nsage: R.<t> = ZZ[[]]\nsage: p = 1 + 4*t^2 + 3*t^3 + O(t^4)\nsage: p.nth_root(2)\n1 + 2*t^2 + 3/2*t^3 + O(t^4)\nsage: p.sqrt(2)\n1 + 2*t^2 + 3/2*t^3 + O(t^4)\nsage: p.nth_root(3)\n1 + 4/3*t^2 + t^3 + O(t^4)\nsage: p = 4*t^2 + 3*t^3 + O(t^4)\nsage: p.nth_root(2)\n2*t + 3/4*t^2 + O(t^3)\nsage: p.sqrt(2)\nTraceback (most recent call last):\n...\nTypeError: no conversion of this rational to integer\n```\n\nthere is a bug in `sqrt` in this case.\n\n`nth_root` can be used to compute the square root of series which\ncurrently `sqrt` does not support\n\n```\nsage: R.<x,y> = QQ[]\nsage: S.<t> = R[[]]\nsage: p = 4 + t*x + t^2*y + O(t^3)\nsage: p.nth_root(2)\n2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)\nsage: p = 32*t^5 + x*t^6 + y*t^7 + O(t^8)\nsage: p.nth_root(5)\n2*t + 1/80*x*t^2 + (-1/6400*x^2 + 1/80*y)*t^3 + O(t^4)\nsage: p.sqrt()\nTraceback (most recent call last):\n...\nAttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'\n```\n\n`nth-root` iteration formula is division-free, which is convenient in this\ncase; in this case `sqrt`  could call `nth_root`.\n\n\n`nth_root` can be used in the multivariate series considered\nin ticket #1956 .",
    "created_at": "2011-02-01T17:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102920",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:3" align="right">comment:3</div>

The nth-root of power series `y = x^n` is computed using
the Newton method for `y = x^-n`

```
x' = (1+1/n)*x - y*x^(n+1)/n
```

```
sage: R.<t> = QQ[]
sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^3
sage: p.nth_root(3)
1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)
sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^-3
sage: p.nth_root(-3)
1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)
```


With this patch `nth_root` works also for series on `ZZ`

```
sage: R.<t> = ZZ[[]]
sage: p = 1 + 4*t^2 + 3*t^3 + O(t^4)
sage: p.nth_root(2)
1 + 2*t^2 + 3/2*t^3 + O(t^4)
sage: p.sqrt(2)
1 + 2*t^2 + 3/2*t^3 + O(t^4)
sage: p.nth_root(3)
1 + 4/3*t^2 + t^3 + O(t^4)
sage: p = 4*t^2 + 3*t^3 + O(t^4)
sage: p.nth_root(2)
2*t + 3/4*t^2 + O(t^3)
sage: p.sqrt(2)
Traceback (most recent call last):
...
TypeError: no conversion of this rational to integer
```

there is a bug in `sqrt` in this case.

`nth_root` can be used to compute the square root of series which
currently `sqrt` does not support

```
sage: R.<x,y> = QQ[]
sage: S.<t> = R[[]]
sage: p = 4 + t*x + t^2*y + O(t^3)
sage: p.nth_root(2)
2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)
sage: p = 32*t^5 + x*t^6 + y*t^7 + O(t^8)
sage: p.nth_root(5)
2*t + 1/80*x*t^2 + (-1/6400*x^2 + 1/80*y)*t^3 + O(t^4)
sage: p.sqrt()
Traceback (most recent call last):
...
AttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'
```

`nth-root` iteration formula is division-free, which is convenient in this
case; in this case `sqrt`  could call `nth_root`.


`nth_root` can be used in the multivariate series considered
in ticket #1956 .



---

archive/issue_comments_102921.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nin the above message there is a wrong example on where sqrt fails;\nhere is the corrected example\n\n```\nsage: R.<x,y> = QQ[]\nsage: S.<t> = R[[]]\nsage: p = 4 + t*x + t^2*y + O(t^3)\nsage: p.nth_root(2)\n2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)\nsage: p.sqrt()\nTraceback (most recent call last):\n...\nAttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'\n}",
    "created_at": "2011-02-01T18:19:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102921",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:4" align="right">comment:4</div>

in the above message there is a wrong example on where sqrt fails;
here is the corrected example

```
sage: R.<x,y> = QQ[]
sage: S.<t> = R[[]]
sage: p = 4 + t*x + t^2*y + O(t^3)
sage: p.nth_root(2)
2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)
sage: p.sqrt()
Traceback (most recent call last):
...
AttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'
}



---

archive/issue_events_140078.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2011-02-02T08:55:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140078"
}
```



---

archive/issue_events_140079.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2011-02-02T08:55:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140079"
}
```



---

archive/issue_comments_102922.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nApply only trac_10720_power_series_nth_root_2.patch",
    "created_at": "2011-02-02T08:57:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102922",
    "user": "https://github.com/robertwb"
}
```

<div id="comment:6" align="right">comment:6</div>

Apply only trac_10720_power_series_nth_root_2.patch



---

archive/issue_comments_102923.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n computation of an nth root of a power series using the Newton method\n \n-Apply trac_10720_power_series_nth_root_2.patch\n+Apply:\n \n+1. trac_10720_power_series_nth_root_2.patch\n+\n+2. trac_10720_power_series_nth_root_3.patch\n``````\n",
    "created_at": "2011-02-03T15:23:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102923",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,7 @@
 computation of an nth root of a power series using the Newton method
 
-Apply trac_10720_power_series_nth_root_2.patch
+Apply:
 
+1. trac_10720_power_series_nth_root_2.patch
+
+2. trac_10720_power_series_nth_root_3.patch
``````




---

archive/issue_comments_102924.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_10720_power_series_nth_root_3.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz)**\n\nWith trac_10720_power_series_nth_root_3.patch nth_root is much faster for `n` large\n\n```\nsage: S.<t> = QQ[[]]\nsage: p = t.exp(30)\nsage: %time p1 = p.nth_root(1000)\nWall time: 0.01 s\n```\nwith the previous version it takes 84s",
    "created_at": "2011-02-03T15:23:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102924",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_10720_power_series_nth_root_3.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz)**

With trac_10720_power_series_nth_root_3.patch nth_root is much faster for `n` large

```
sage: S.<t> = QQ[[]]
sage: p = t.exp(30)
sage: %time p1 = p.nth_root(1000)
Wall time: 0.01 s
```
with the previous version it takes 84s



---

archive/issue_comments_102925.json:
```json
{
    "body": "Attachment: **[trac_10720_power_series_nth_root_4.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_4.patch.gz)**",
    "created_at": "2011-02-05T16:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102925",
    "user": "https://github.com/sagetrac-pernici"
}
```

Attachment: **[trac_10720_power_series_nth_root_4.patch.gz](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_4.patch.gz)**



---

archive/issue_comments_102926.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWith trac_10720_power_series_nth_root_4.patch \nnth_root and inversion become faster for series on\npolynomial rings, when used together with\ntrac_10480_fast_PowerSeries_poly_multiplication-alternative.patch\nfrom ticket #10480 (otherwise these functions perform as without the patch).\n\nIn the following benchmarks apply\ntrac_karatsuba_improvements.patch and\ntrac_10480_fast_PowerSeries_poly_multiplication-alternative.patch,\ntrac_10720_power_series_nth_root_2.patch and\ntrac_10720_power_series_nth_root_3.patch;\nin (2) apply also the new patch\n\n```\nsage: N = 2\nsage: R= PolynomialRing(QQ,N,'x')\nsage: x = R.gens()\nsage: S.<t> = R[[]]\nsage: sx = sum(x)\nsage: prec = 15\nsage: p = (t.exp(prec)).subs({t:t*sx})\nsage: %time p1 = p^-1\nsage: %time p1 = p.nth_root(2)\n```\n\nInversion benchmark:\n\n```\nN  prec  (1)    (2)\n2  15    0.06   0.01\n3  15    2.1    0.07\n4  15    58     0.5\n5  15    1440   3.4\n```\n\nSquare root benchmark:\n\n```\nN  prec  (1)    (2)\n2  15    0.15   0.03\n3  15    5.2    0.31\n4  15    161    3.3\n```\n\nThe speedup is large because the terms with high degree in `t`\nare large polynomials, due to the combinatorial\npossibilities with several variables; using `_mul_` instead of _mul_trunc\nseveral products involving these large polynomials are computed and\nlater truncated away.",
    "created_at": "2011-02-05T16:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102926",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:8" align="right">comment:8</div>

With trac_10720_power_series_nth_root_4.patch 
nth_root and inversion become faster for series on
polynomial rings, when used together with
trac_10480_fast_PowerSeries_poly_multiplication-alternative.patch
from ticket #10480 (otherwise these functions perform as without the patch).

In the following benchmarks apply
trac_karatsuba_improvements.patch and
trac_10480_fast_PowerSeries_poly_multiplication-alternative.patch,
trac_10720_power_series_nth_root_2.patch and
trac_10720_power_series_nth_root_3.patch;
in (2) apply also the new patch

```
sage: N = 2
sage: R= PolynomialRing(QQ,N,'x')
sage: x = R.gens()
sage: S.<t> = R[[]]
sage: sx = sum(x)
sage: prec = 15
sage: p = (t.exp(prec)).subs({t:t*sx})
sage: %time p1 = p^-1
sage: %time p1 = p.nth_root(2)
```

Inversion benchmark:

```
N  prec  (1)    (2)
2  15    0.06   0.01
3  15    2.1    0.07
4  15    58     0.5
5  15    1440   3.4
```

Square root benchmark:

```
N  prec  (1)    (2)
2  15    0.15   0.03
3  15    5.2    0.31
4  15    161    3.3
```

The speedup is large because the terms with high degree in `t`
are large polynomials, due to the combinatorial
possibilities with several variables; using `_mul_` instead of _mul_trunc
several products involving these large polynomials are computed and
later truncated away.



---

archive/issue_comments_102927.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,3 @@\n computation of an nth root of a power series using the Newton method\n \n-Apply:\n \n-1. trac_10720_power_series_nth_root_2.patch\n-\n-2. trac_10720_power_series_nth_root_3.patch\n``````\n",
    "created_at": "2011-02-05T16:57:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102927",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,3 @@
 computation of an nth root of a power series using the Newton method
 
-Apply:
 
-1. trac_10720_power_series_nth_root_2.patch
-
-2. trac_10720_power_series_nth_root_3.patch
``````




---

archive/issue_comments_102928.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThis is an enhancement rather than a defect.",
    "created_at": "2011-11-13T12:27:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102928",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:10" align="right">comment:10</div>

This is an enhancement rather than a defect.



---

archive/issue_events_140080.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-11-13T12:27:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140080"
}
```



---

archive/issue_events_140081.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-11-13T12:27:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140081"
}
```



---

archive/issue_comments_102929.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nWhich patches need to be applied? Please put some information in the ticket description.\n\nIf  `trac_10720_power_series_nth_root_3.patch` is meant to be applied, please add a doctest to `__pow_trunc`.",
    "created_at": "2011-12-31T12:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102929",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

Which patches need to be applied? Please put some information in the ticket description.

If  `trac_10720_power_series_nth_root_3.patch` is meant to be applied, please add a doctest to `__pow_trunc`.



---

archive/issue_comments_102930.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAs Volker mentioned, `__pow_trunc` lacks a docstring. (Just to remove this from the list of tickets needing review until that is fixed.)",
    "created_at": "2013-03-04T18:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102930",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:13" align="right">comment:13</div>

As Volker mentioned, `__pow_trunc` lacks a docstring. (Just to remove this from the list of tickets needing review until that is fixed.)



---

archive/issue_events_140082.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2013-03-04T18:48:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140082"
}
```



---

archive/issue_events_140083.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2013-03-04T18:48:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140083"
}
```



---

archive/issue_comments_102931.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n computation of an nth root of a power series using the Newton method\n \n+---\n \n+Apply\n+\n+1. [attachment: trac_10720_power_series_nth_root_2.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_2.patch.gz)\n+2. [attachment: trac_10720_power_series_nth_root_3.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz)\n+3. [attachment: trac_10720_power_series_nth_root_4.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_4.patch.gz)\n``````\n",
    "created_at": "2013-03-04T18:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102931",
    "user": "https://github.com/saraedum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
 computation of an nth root of a power series using the Newton method
 
+---
 
+Apply
+
+1. [attachment: trac_10720_power_series_nth_root_2.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_2.patch.gz)
+2. [attachment: trac_10720_power_series_nth_root_3.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz)
+3. [attachment: trac_10720_power_series_nth_root_4.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_4.patch.gz)
``````




---

archive/issue_comments_102932.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOne related remark:\n\nThanks to ticket #14115, it is now easy to implement a general rational power by\n\n```\ndef rational_power(f,alpha):\n    return (f.log()*alpha).exp()\n```\n\nI do not know how it compares in terms of speed with the method of this ticket.",
    "created_at": "2013-03-15T10:00:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102932",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:14" align="right">comment:14</div>

One related remark:

Thanks to ticket #14115, it is now easy to implement a general rational power by

```
def rational_power(f,alpha):
    return (f.log()*alpha).exp()
```

I do not know how it compares in terms of speed with the method of this ticket.



---

archive/issue_events_140084.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140084"
}
```



---

archive/issue_events_140085.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140085"
}
```



---

archive/issue_events_140086.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140086"
}
```



---

archive/issue_events_140087.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140087"
}
```



---

archive/issue_comments_102933.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@fchapoton](#comment%3A14):\n> Thanks to ticket #14115, it is now easy to implement a general rational power by\n> \n> ```\n> def rational_power(f,alpha):\n>     return (f.log()*alpha).exp()\n> ```\n> \n> I do not know how it compares in terms of speed with the method of this ticket.\n\nAdditionally #15601 implements Pari series. If a speed comparison is made please include that implementation as third case to compare.",
    "created_at": "2014-04-22T13:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102933",
    "user": "https://github.com/rwst"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@fchapoton](#comment%3A14):
> Thanks to ticket #14115, it is now easy to implement a general rational power by
> 
> ```
> def rational_power(f,alpha):
>     return (f.log()*alpha).exp()
> ```
> 
> I do not know how it compares in terms of speed with the method of this ticket.

Additionally #15601 implements Pari series. If a speed comparison is made please include that implementation as third case to compare.



---

archive/issue_events_140088.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140088"
}
```



---

archive/issue_events_140089.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140089"
}
```



---

archive/issue_events_140090.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140090"
}
```



---

archive/issue_events_140091.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140091"
}
```



---

archive/issue_events_140092.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-06-24T07:58:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140092"
}
```



---

archive/issue_events_140093.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-06-24T07:58:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140093"
}
```



---

archive/issue_comments_102934.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nWe should use (and possibly improve) #20571. Would be a good idea to use this ticket to implement a `_pow_trunc_` following the `__pow_trunc` from [attachment: trac_10720_power_series_nth_root_3.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz).",
    "created_at": "2016-06-24T07:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102934",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

We should use (and possibly improve) #20571. Would be a good idea to use this ticket to implement a `_pow_trunc_` following the `__pow_trunc` from [attachment: trac_10720_power_series_nth_root_3.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz).



---

archive/issue_comments_102935.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nMoreover, polynomials should provide a `nth_root_series_trunc` (the same way there exists a `inverse_series_trunc`).",
    "created_at": "2016-06-24T08:00:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102935",
    "user": "https://github.com/videlec"
}
```

<div id="comment:21" align="right">comment:21</div>

Moreover, polynomials should provide a `nth_root_series_trunc` (the same way there exists a `inverse_series_trunc`).



---

archive/issue_comments_102936.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nrecycling...",
    "created_at": "2017-12-18T11:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102936",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

recycling...



---

archive/issue_comments_102937.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,12 @@\n-computation of an nth root of a power series using the Newton method\n+There is a nth_root method defined on univariate and multivariate polynomials.\n \n----\n+```\n+sage: R.<x,y,z> = QQ[]\n+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We should make it available on\n \n-Apply\n-\n-1. [attachment: trac_10720_power_series_nth_root_2.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_2.patch.gz)\n-2. [attachment: trac_10720_power_series_nth_root_3.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz)\n-3. [attachment: trac_10720_power_series_nth_root_4.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_4.patch.gz)\n+- univariate and multivariate Laurent polynomials\n+- univariate and multivariate power series\n+- univariate and multivariate Laurent power series\n``````\n",
    "created_at": "2017-12-18T11:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102937",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,12 @@
-computation of an nth root of a power series using the Newton method
+There is a nth_root method defined on univariate and multivariate polynomials.
 
----
+```
+sage: R.<x,y,z> = QQ[]
+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We should make it available on
 
-Apply
-
-1. [attachment: trac_10720_power_series_nth_root_2.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_2.patch.gz)
-2. [attachment: trac_10720_power_series_nth_root_3.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_3.patch.gz)
-3. [attachment: trac_10720_power_series_nth_root_4.patch](https://github.com/sagemath/sage/files/ticket10720/trac_10720_power_series_nth_root_4.patch.gz)
+- univariate and multivariate Laurent polynomials
+- univariate and multivariate power series
+- univariate and multivariate Laurent power series
``````




---

archive/issue_events_140094.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-18T11:04:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140094"
}
```



---

archive/issue_events_140095.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-18T11:04:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140095"
}
```



---

archive/issue_events_140096.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-18T11:04:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "title_is": "nth_root for (Laurent) polynomials and power series",
    "title_was": "nth_root in power series",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140096"
}
```



---

archive/issue_comments_102938.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n ```\n-We should make it available on\n+We modify provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n \n - univariate and multivariate Laurent polynomials\n - univariate and multivariate power series\n``````\n",
    "created_at": "2017-12-18T11:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102938",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
 ```
-We should make it available on
+We modify provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
 
 - univariate and multivariate Laurent polynomials
 - univariate and multivariate power series
``````




---

archive/issue_comments_102939.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n ```\n-We modify provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n \n - univariate and multivariate Laurent polynomials\n - univariate and multivariate power series\n``````\n",
    "created_at": "2017-12-18T11:07:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102939",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
 ```
-We modify provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
 
 - univariate and multivariate Laurent polynomials
 - univariate and multivariate power series
``````




---

archive/issue_comments_102940.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,11 +1,13 @@\n-There is a nth_root method defined on univariate and multivariate polynomials.\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n ```\n-sage: R.<x,y,z> = QQ[]\n-sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n ```\n-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+On multi-variate polynomials there is another `nth_root` method implemented via factorization (sic)!!\n+\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for both univariate and multivariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n \n - univariate and multivariate Laurent polynomials\n - univariate and multivariate power series\n``````\n",
    "created_at": "2017-12-18T11:23:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102940",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,11 +1,13 @@
-There is a nth_root method defined on univariate and multivariate polynomials.
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
 ```
-sage: R.<x,y,z> = QQ[]
-sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
 ```
-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+On multi-variate polynomials there is another `nth_root` method implemented via factorization (sic)!!
+
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for both univariate and multivariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
 
 - univariate and multivariate Laurent polynomials
 - univariate and multivariate power series
``````




---

archive/issue_comments_102941.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,10 +5,10 @@\n sage: ((1 + x - x^2)**5).nth_root(5)\n 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n ```\n-On multi-variate polynomials there is another `nth_root` method implemented via factorization (sic)!!\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n \n-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for both univariate and multivariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+- univariate Laurent polynomials\n+- univariate power series\n+- univariate Laurent power series\n \n-- univariate and multivariate Laurent polynomials\n-- univariate and multivariate power series\n-- univariate and multivariate Laurent power series\n+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n``````\n",
    "created_at": "2017-12-19T10:56:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102941",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,10 +5,10 @@
 sage: ((1 + x - x^2)**5).nth_root(5)
 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
 ```
-On multi-variate polynomials there is another `nth_root` method implemented via factorization (sic)!!
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
 
-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for both univariate and multivariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+- univariate Laurent polynomials
+- univariate power series
+- univariate Laurent power series
 
-- univariate and multivariate Laurent polynomials
-- univariate and multivariate power series
-- univariate and multivariate Laurent power series
+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
``````




---

archive/issue_comments_102942.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,4 +11,6 @@\n - univariate power series\n - univariate Laurent power series\n \n+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n+\n On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n``````\n",
    "created_at": "2017-12-21T11:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102942",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,4 +11,6 @@
 - univariate power series
 - univariate Laurent power series
 
+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
+
 On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
``````




---

archive/issue_comments_102943.json:
```json
{
    "body": "Branch: **[u/vdelecroix/10720](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10720)**",
    "created_at": "2017-12-21T13:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102943",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/10720](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10720)**



---

archive/issue_comments_102944.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,11 +5,7 @@\n sage: ((1 + x - x^2)**5).nth_root(5)\n 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n ```\n-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n-\n-- univariate Laurent polynomials\n-- univariate power series\n-- univariate Laurent power series\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n \n This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n \n``````\n",
    "created_at": "2017-12-21T13:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102944",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,11 +5,7 @@
 sage: ((1 + x - x^2)**5).nth_root(5)
 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
 ```
-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
-
-- univariate Laurent polynomials
-- univariate power series
-- univariate Laurent power series
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
 
 This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
 
``````




---

archive/issue_comments_102945.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bb007494254a3471f633628052accfc44c17a70\"><code>5bb0074</code></a></td><td><code>10720: _nth_root_series for univariate polynomials</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c3d0388dd2b193a07bcf6a13d6cd7b8fd445160\"><code>1c3d038</code></a></td><td><code>10720: nth_root for (Laurent) power series</code></td></tr></table>\n",
    "created_at": "2017-12-21T13:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102945",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bb007494254a3471f633628052accfc44c17a70"><code>5bb0074</code></a></td><td><code>10720: _nth_root_series for univariate polynomials</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c3d0388dd2b193a07bcf6a13d6cd7b8fd445160"><code>1c3d038</code></a></td><td><code>10720: nth_root for (Laurent) power series</code></td></tr></table>




---

archive/issue_comments_102946.json:
```json
{
    "body": "Changed author from **mario pernici** to **Vincent Delecroix**",
    "created_at": "2017-12-21T13:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102946",
    "user": "https://github.com/videlec"
}
```

Changed author from **mario pernici** to **Vincent Delecroix**



---

archive/issue_events_140097.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T13:08:07Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "title_is": "nth_root for (Laurent) power series",
    "title_was": "nth_root for (Laurent) polynomials and power series",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140097"
}
```



---

archive/issue_comments_102947.json:
```json
{
    "body": "Commit: **[`1c3d038`](https://github.com/sagemath/sagetrac-mirror/commit/1c3d0388dd2b193a07bcf6a13d6cd7b8fd445160)**",
    "created_at": "2017-12-21T13:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102947",
    "user": "https://github.com/videlec"
}
```

Commit: **[`1c3d038`](https://github.com/sagemath/sagetrac-mirror/commit/1c3d0388dd2b193a07bcf6a13d6cd7b8fd445160)**



---

archive/issue_events_140098.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T13:08:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140098"
}
```



---

archive/issue_events_140099.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T13:08:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140099"
}
```



---

archive/issue_comments_102948.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n sage: ((1 + x - x^2)**5).nth_root(5)\n 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n ```\n-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n+We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n \n This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n \n``````\n",
    "created_at": "2017-12-21T13:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102948",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 sage: ((1 + x - x^2)**5).nth_root(5)
 2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
 ```
-We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
+We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
 
 This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
 
``````




---

archive/issue_comments_102949.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReproducing the example of [[comment:7](#comment%3A7)]\n\n```\nsage: S.<t> = QQ[[]]\nsage: p = t.exp(30)\nsage: %time p1 = p.nth_root(1000)\nCPU times: user 11.7 ms, sys: 3.27 ms, total: 15 ms\nWall time: 13.8 ms\n```",
    "created_at": "2017-12-21T13:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102949",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">comment:30</div>

Reproducing the example of [[comment:7](#comment%3A7)]

```
sage: S.<t> = QQ[[]]
sage: p = t.exp(30)
sage: %time p1 = p.nth_root(1000)
CPU times: user 11.7 ms, sys: 3.27 ms, total: 15 ms
Wall time: 13.8 ms
```



---

archive/issue_events_140100.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T13:14:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140100"
}
```



---

archive/issue_events_140101.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T13:14:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140101"
}
```



---

archive/issue_comments_102950.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe initial proposal of using Newton method for `y^-n` is more clever since we don't need to use power series inversion...",
    "created_at": "2017-12-21T13:14:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102950",
    "user": "https://github.com/videlec"
}
```

<div id="comment:31" align="right">comment:31</div>

The initial proposal of using Newton method for `y^-n` is more clever since we don't need to use power series inversion...



---

archive/issue_comments_102951.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n ```\n sage: R.<x> = QQ[]\n sage: ((1 + x - x^2)**5).nth_root(5)\n-2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+-x^2 + x + 1\n ```\n We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n \n``````\n",
    "created_at": "2017-12-21T13:55:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102951",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 ```
 sage: R.<x> = QQ[]
 sage: ((1 + x - x^2)**5).nth_root(5)
-2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+-x^2 + x + 1
 ```
 We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
 
``````




---

archive/issue_comments_102952.json:
```json
{
    "body": "Changed commit from **[`1c3d038`](https://github.com/sagemath/sagetrac-mirror/commit/1c3d0388dd2b193a07bcf6a13d6cd7b8fd445160)** to **[`2e432e1`](https://github.com/sagemath/sagetrac-mirror/commit/2e432e1ffb6134b2262b8a85268b3656de1cbb8d)**",
    "created_at": "2017-12-21T14:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102952",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1c3d038`](https://github.com/sagemath/sagetrac-mirror/commit/1c3d0388dd2b193a07bcf6a13d6cd7b8fd445160)** to **[`2e432e1`](https://github.com/sagemath/sagetrac-mirror/commit/2e432e1ffb6134b2262b8a85268b3656de1cbb8d)**



---

archive/issue_comments_102953.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e432e1ffb6134b2262b8a85268b3656de1cbb8d\"><code>2e432e1</code></a></td><td><code>10720: use Newton method for x^-n instead</code></td></tr></table>\n",
    "created_at": "2017-12-21T14:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102953",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e432e1ffb6134b2262b8a85268b3656de1cbb8d"><code>2e432e1</code></a></td><td><code>10720: use Newton method for x^-n instead</code></td></tr></table>




---

archive/issue_events_140102.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T14:58:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140102"
}
```



---

archive/issue_events_140103.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-21T14:58:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140103"
}
```



---

archive/issue_comments_102954.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nIt is indeed better\n\n```\nsage: S.<t> = QQ[[]]\nsage: p = t.exp(30)\nsage: %time p1 = p.nth_root(1000)\nCPU times: user 3.8 ms, sys: 30 \u00b5s, total: 3.83 ms\nWall time: 3.69 ms\n```",
    "created_at": "2017-12-21T14:59:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102954",
    "user": "https://github.com/videlec"
}
```

<div id="comment:35" align="right">comment:35</div>

It is indeed better

```
sage: S.<t> = QQ[[]]
sage: p = t.exp(30)
sage: %time p1 = p.nth_root(1000)
CPU times: user 3.8 ms, sys: 30 µs, total: 3.83 ms
Wall time: 3.69 ms
```



---

archive/issue_comments_102955.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@fchapoton](#comment%3A14):\n> One related remark:\n> \n> Thanks to ticket #14115, it is now easy to implement a general rational power by\n> \n> ```\n> def rational_power(f,alpha):\n>     return (f.log()*alpha).exp()\n> ```\n> \n> I do not know how it compares in terms of speed with the method of this ticket.\n\n```\nsage: R.<x> = PowerSeriesRing(QQ, default_prec=100)\nsage: p = (1 + 2*x - x^4)**200\nsage: %timeit p1 = p.nth_root(1000)\n100 loops, best of 3: 4.18 ms per loop\nsage: %timeit p2 = (p.log()/1000).exp()\n100 loops, best of 3: 5.84 ms per loop\n```\nBut the main advantage of the method proposed here is that it works in positive characteristic.",
    "created_at": "2017-12-21T15:43:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102955",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@fchapoton](#comment%3A14):
> One related remark:
> 
> Thanks to ticket #14115, it is now easy to implement a general rational power by
> 
> ```
> def rational_power(f,alpha):
>     return (f.log()*alpha).exp()
> ```
> 
> I do not know how it compares in terms of speed with the method of this ticket.

```
sage: R.<x> = PowerSeriesRing(QQ, default_prec=100)
sage: p = (1 + 2*x - x^4)**200
sage: %timeit p1 = p.nth_root(1000)
100 loops, best of 3: 4.18 ms per loop
sage: %timeit p2 = (p.log()/1000).exp()
100 loops, best of 3: 5.84 ms per loop
```
But the main advantage of the method proposed here is that it works in positive characteristic.



---

archive/issue_comments_102956.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bcade8aa53391ef8930e474281dfc9b51599bd1b\"><code>bcade8a</code></a></td><td><code>10720: more examples</code></td></tr></table>\n",
    "created_at": "2017-12-21T15:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102956",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bcade8aa53391ef8930e474281dfc9b51599bd1b"><code>bcade8a</code></a></td><td><code>10720: more examples</code></td></tr></table>




---

archive/issue_comments_102957.json:
```json
{
    "body": "Changed commit from **[`2e432e1`](https://github.com/sagemath/sagetrac-mirror/commit/2e432e1ffb6134b2262b8a85268b3656de1cbb8d)** to **[`bcade8a`](https://github.com/sagemath/sagetrac-mirror/commit/bcade8aa53391ef8930e474281dfc9b51599bd1b)**",
    "created_at": "2017-12-21T15:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102957",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2e432e1`](https://github.com/sagemath/sagetrac-mirror/commit/2e432e1ffb6134b2262b8a85268b3656de1cbb8d)** to **[`bcade8a`](https://github.com/sagemath/sagetrac-mirror/commit/bcade8aa53391ef8930e474281dfc9b51599bd1b)**



---

archive/issue_comments_102958.json:
```json
{
    "body": "Changed author from **Vincent Delecroix** to **Mario Pernici, Vincent Delecroix**",
    "created_at": "2017-12-21T16:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102958",
    "user": "https://github.com/videlec"
}
```

Changed author from **Vincent Delecroix** to **Mario Pernici, Vincent Delecroix**



---

archive/issue_comments_102959.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\n1. `def _nth_root_series(self, long n, long prec, start=None):` is missing a INPUT block, in which, in particular, the goal of input `start` should be explained.\n\n2. At two places the input block says <code>- \\`\\`prec\\`\\` -- integer (optional) - precision of the result</code>, but the code does `prec = min(self.prec(), prec)`. I suggest to add a sentence advertising it saying something like `If prec is larger than self.prec(), then self.prec() is used.`",
    "created_at": "2017-12-22T09:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102959",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:39" align="right">comment:39</div>

1. `def _nth_root_series(self, long n, long prec, start=None):` is missing a INPUT block, in which, in particular, the goal of input `start` should be explained.

2. At two places the input block says <code>- \`\`prec\`\` -- integer (optional) - precision of the result</code>, but the code does `prec = min(self.prec(), prec)`. I suggest to add a sentence advertising it saying something like `If prec is larger than self.prec(), then self.prec() is used.`



---

archive/issue_events_140104.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2017-12-22T09:09:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140104"
}
```



---

archive/issue_events_140105.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2017-12-22T09:09:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140105"
}
```



---

archive/issue_comments_102960.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\n3. `Check that the result are consistent` -> `results`",
    "created_at": "2017-12-22T12:17:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102960",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:40" align="right">comment:40</div>

3. `Check that the result are consistent` -> `results`



---

archive/issue_comments_102961.json:
```json
{
    "body": "Reviewer: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2017-12-22T12:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102961",
    "user": "https://github.com/seblabbe"
}
```

Reviewer: **Sébastien Labbé**



---

archive/issue_comments_102962.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nOnce, those three changes on the documentation aspect are done, feel free to change the status to positive review on my behalf.",
    "created_at": "2017-12-22T12:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102962",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:41" align="right">comment:41</div>

Once, those three changes on the documentation aspect are done, feel free to change the status to positive review on my behalf.



---

archive/issue_comments_102963.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d7545da76d830c7bb6cf187e8f8683e4a2e56ff\"><code>0d7545d</code></a></td><td><code>10720: _nth_root_series for univariate polynomials</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc2bb6094f2692b56d72fcd3732b3d8520ed8cbc\"><code>fc2bb60</code></a></td><td><code>10720: nth_root for (Laurent) power series</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c83d4c79479d70c5ce5b306335225497d1b0d951\"><code>c83d4c7</code></a></td><td><code>10720: use Newton method for x^-n instead</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a5d992b421f448b829a1857bddfe0bf58a06343\"><code>3a5d992</code></a></td><td><code>10720: more examples</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d\"><code>eddd45d</code></a></td><td><code>10720: doc fixes</code></td></tr></table>\n",
    "created_at": "2017-12-26T16:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102963",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d7545da76d830c7bb6cf187e8f8683e4a2e56ff"><code>0d7545d</code></a></td><td><code>10720: _nth_root_series for univariate polynomials</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc2bb6094f2692b56d72fcd3732b3d8520ed8cbc"><code>fc2bb60</code></a></td><td><code>10720: nth_root for (Laurent) power series</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c83d4c79479d70c5ce5b306335225497d1b0d951"><code>c83d4c7</code></a></td><td><code>10720: use Newton method for x^-n instead</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a5d992b421f448b829a1857bddfe0bf58a06343"><code>3a5d992</code></a></td><td><code>10720: more examples</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d"><code>eddd45d</code></a></td><td><code>10720: doc fixes</code></td></tr></table>




---

archive/issue_comments_102964.json:
```json
{
    "body": "Changed commit from **[`bcade8a`](https://github.com/sagemath/sagetrac-mirror/commit/bcade8aa53391ef8930e474281dfc9b51599bd1b)** to **[`eddd45d`](https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d)**",
    "created_at": "2017-12-26T16:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102964",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bcade8a`](https://github.com/sagemath/sagetrac-mirror/commit/bcade8aa53391ef8930e474281dfc9b51599bd1b)** to **[`eddd45d`](https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d)**



---

archive/issue_events_140106.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-26T16:27:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140106"
}
```



---

archive/issue_events_140107.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-26T16:27:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140107"
}
```



---

archive/issue_comments_102965.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nrebased and fixed. I am only setting to needs review to have some patchbot reviews.",
    "created_at": "2017-12-26T16:27:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102965",
    "user": "https://github.com/videlec"
}
```

<div id="comment:43" align="right">comment:43</div>

rebased and fixed. I am only setting to needs review to have some patchbot reviews.



---

archive/issue_comments_102966.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nMerci S\u00e9bastien!",
    "created_at": "2017-12-28T12:26:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102966",
    "user": "https://github.com/videlec"
}
```

<div id="comment:44" align="right">comment:44</div>

Merci Sébastien!



---

archive/issue_events_140108.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-28T12:26:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140108"
}
```



---

archive/issue_events_140109.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-28T12:26:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140109"
}
```



---

archive/issue_comments_102967.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/10720](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10720)** to **[`eddd45d`](https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d)**",
    "created_at": "2017-12-31T09:27:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10720#issuecomment-102967",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/10720](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10720)** to **[`eddd45d`](https://github.com/sagemath/sagetrac-mirror/commit/eddd45db6e20c602db8c539fe6752ba259b2af9d)**



---

archive/issue_events_140110.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-31T09:27:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140110"
}
```



---

archive/issue_events_140111.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "94238811424e0646a0af0f424574f2add3ff3191",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-12-31T09:27:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10720",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10720#event-140111"
}
```
