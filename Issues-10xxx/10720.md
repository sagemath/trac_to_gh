# Issue 10720: nth_root for (Laurent) power series

archive/issues_010657.json:
```json
{
    "body": "There is a nth_root method defined on univariate polynomial (via Newton method)\n\n```\nsage: R.<x> = QQ[]\nsage: ((1 + x - x^2)**5).nth_root(5)\n-x^2 + x + 1\n```\nWe provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n\nThis branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n\nOn multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n\nAssignee: pernici\n\nCC:  @robertwb @bgrenet\n\nKeywords: power series\n\nBranch/Commit: eddd45db6e20c602db8c539fe6752ba259b2af9d\n\nReviewer: S\u00e9bastien Labb\u00e9\n\nAuthor: Mario Pernici, Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10720\n\n",
    "closed_at": "2017-12-31T09:27:55Z",
    "created_at": "2011-01-31T18:18:06Z",
    "labels": [
        "component: commutative algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "nth_root for (Laurent) power series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10720",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```
There is a nth_root method defined on univariate polynomial (via Newton method)

```
sage: R.<x> = QQ[]
sage: ((1 + x - x^2)**5).nth_root(5)
-x^2 + x + 1
```
We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.

This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).

On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.

Assignee: pernici

CC:  @robertwb @bgrenet

Keywords: power series

Branch/Commit: eddd45db6e20c602db8c539fe6752ba259b2af9d

Reviewer: Sébastien Labbé

Author: Mario Pernici, Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10720





---

archive/issue_comments_117317.json:
```json
{
    "body": "Attachment [trac_10720_power_series_nth_root.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root.patch) by pernici created at 2011-01-31 18:33:07",
    "created_at": "2011-01-31T18:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117317",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Attachment [trac_10720_power_series_nth_root.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root.patch) by pernici created at 2011-01-31 18:33:07



---

archive/issue_comments_117318.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -40,7 +40,6 @@\n In particular it can be used in the multivariate series considered\n in ticket #1956 .\n \n-Assignee: tbd\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2011-01-31T18:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117318",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -40,7 +40,6 @@
 In particular it can be used in the multivariate series considered
 in ticket #1956 .
 
-Assignee: tbd
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117319.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to commutative algebra.",
    "created_at": "2011-01-31T18:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117319",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Changing component from PLEASE CHANGE to commutative algebra.



---

archive/issue_comments_117320.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2011-01-31T18:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117320",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Changing priority from major to minor.



---

archive/issue_comments_117321.json:
```json
{
    "body": "Changing keywords from \"\" to \"power series\".",
    "created_at": "2011-01-31T18:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117321",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Changing keywords from "" to "power series".



---

archive/issue_events_027601.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pernici",
    "created_at": "2011-01-31T18:33:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27601"
}
```



---

archive/issue_comments_117322.json:
```json
{
    "body": "Changing assignee from tbd to pernici.",
    "created_at": "2011-01-31T18:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117322",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Changing assignee from tbd to pernici.



---

archive/issue_comments_117323.json:
```json
{
    "body": "Attachment [trac_10720_power_series_nth_root_2.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root_2.patch) by pernici created at 2011-02-01 17:13:17",
    "created_at": "2011-02-01T17:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117323",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Attachment [trac_10720_power_series_nth_root_2.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root_2.patch) by pernici created at 2011-02-01 17:13:17



---

archive/issue_comments_117324.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n+computation of an nth root of a power series using the Newton method\n+\n+Apply trac_10720_power_series_nth_root_2.patch\n \n \n Component: PLEASE CHANGE\n``````\n",
    "created_at": "2011-02-01T17:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117324",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
+computation of an nth root of a power series using the Newton method
+
+Apply trac_10720_power_series_nth_root_2.patch
 
 
 Component: PLEASE CHANGE
``````




---

archive/issue_comments_117325.json:
```json
{
    "body": "<a id='comment:3'></a>The nth-root of power series `y = x^n` is computed using\nthe Newton method for `y = x^-n`\n\n```\nx' = (1+1/n)*x - y*x^(n+1)/n\n```\n\n```\nsage: R.<t> = QQ[]\nsage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^3\nsage: p.nth_root(3)\n1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)\nsage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^-3\nsage: p.nth_root(-3)\n1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)\n```\n\n\nWith this patch `nth_root` works also for series on `ZZ`\n\n```\nsage: R.<t> = ZZ[[]]\nsage: p = 1 + 4*t^2 + 3*t^3 + O(t^4)\nsage: p.nth_root(2)\n1 + 2*t^2 + 3/2*t^3 + O(t^4)\nsage: p.sqrt(2)\n1 + 2*t^2 + 3/2*t^3 + O(t^4)\nsage: p.nth_root(3)\n1 + 4/3*t^2 + t^3 + O(t^4)\nsage: p = 4*t^2 + 3*t^3 + O(t^4)\nsage: p.nth_root(2)\n2*t + 3/4*t^2 + O(t^3)\nsage: p.sqrt(2)\nTraceback (most recent call last):\n...\nTypeError: no conversion of this rational to integer\n```\n\nthere is a bug in `sqrt` in this case.\n\n`nth_root` can be used to compute the square root of series which\ncurrently `sqrt` does not support\n\n```\nsage: R.<x,y> = QQ[]\nsage: S.<t> = R[[]]\nsage: p = 4 + t*x + t^2*y + O(t^3)\nsage: p.nth_root(2)\n2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)\nsage: p = 32*t^5 + x*t^6 + y*t^7 + O(t^8)\nsage: p.nth_root(5)\n2*t + 1/80*x*t^2 + (-1/6400*x^2 + 1/80*y)*t^3 + O(t^4)\nsage: p.sqrt()\nTraceback (most recent call last):\n...\nAttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'\n```\n\n`nth-root` iteration formula is division-free, which is convenient in this\ncase; in this case `sqrt`  could call `nth_root`.\n\n\n`nth_root` can be used in the multivariate series considered\nin ticket #1956 .",
    "created_at": "2011-02-01T17:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117325",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:3'></a>The nth-root of power series `y = x^n` is computed using
the Newton method for `y = x^-n`

```
x' = (1+1/n)*x - y*x^(n+1)/n
```

```
sage: R.<t> = QQ[]
sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^3
sage: p.nth_root(3)
1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)
sage: p = (1 + 2*t + 5*t^2 + 7*t^3 + O(t^4))^-3
sage: p.nth_root(-3)
1 + 2*t + 5*t^2 + 7*t^3 + O(t^4)
```


With this patch `nth_root` works also for series on `ZZ`

```
sage: R.<t> = ZZ[[]]
sage: p = 1 + 4*t^2 + 3*t^3 + O(t^4)
sage: p.nth_root(2)
1 + 2*t^2 + 3/2*t^3 + O(t^4)
sage: p.sqrt(2)
1 + 2*t^2 + 3/2*t^3 + O(t^4)
sage: p.nth_root(3)
1 + 4/3*t^2 + t^3 + O(t^4)
sage: p = 4*t^2 + 3*t^3 + O(t^4)
sage: p.nth_root(2)
2*t + 3/4*t^2 + O(t^3)
sage: p.sqrt(2)
Traceback (most recent call last):
...
TypeError: no conversion of this rational to integer
```

there is a bug in `sqrt` in this case.

`nth_root` can be used to compute the square root of series which
currently `sqrt` does not support

```
sage: R.<x,y> = QQ[]
sage: S.<t> = R[[]]
sage: p = 4 + t*x + t^2*y + O(t^3)
sage: p.nth_root(2)
2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)
sage: p = 32*t^5 + x*t^6 + y*t^7 + O(t^8)
sage: p.nth_root(5)
2*t + 1/80*x*t^2 + (-1/6400*x^2 + 1/80*y)*t^3 + O(t^4)
sage: p.sqrt()
Traceback (most recent call last):
...
AttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'
```

`nth-root` iteration formula is division-free, which is convenient in this
case; in this case `sqrt`  could call `nth_root`.


`nth_root` can be used in the multivariate series considered
in ticket #1956 .



---

archive/issue_comments_117326.json:
```json
{
    "body": "<a id='comment:4'></a>in the above message there is a wrong example on where sqrt fails;\nhere is the corrected example\n\n```\nsage: R.<x,y> = QQ[]\nsage: S.<t> = R[[]]\nsage: p = 4 + t*x + t^2*y + O(t^3)\nsage: p.nth_root(2)\n2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)\nsage: p.sqrt()\nTraceback (most recent call last):\n...\nAttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'\n}",
    "created_at": "2011-02-01T18:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117326",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:4'></a>in the above message there is a wrong example on where sqrt fails;
here is the corrected example

```
sage: R.<x,y> = QQ[]
sage: S.<t> = R[[]]
sage: p = 4 + t*x + t^2*y + O(t^3)
sage: p.nth_root(2)
2 + 1/4*x*t + (-1/64*x^2 + 1/4*y)*t^2 + O(t^3)
sage: p.sqrt()
Traceback (most recent call last):
...
AttributeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object has no attribute 'sqrt'
}



---

archive/issue_comments_117327.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2011-02-02T08:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117327",
    "user": "https://github.com/robertwb"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_117328.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-02-02T08:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117328",
    "user": "https://github.com/robertwb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_117329.json:
```json
{
    "body": "<a id='comment:6'></a>Apply only trac_10720_power_series_nth_root_2.patch",
    "created_at": "2011-02-02T08:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117329",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:6'></a>Apply only trac_10720_power_series_nth_root_2.patch



---

archive/issue_comments_117330.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+computation of an nth root of a power series using the Newton method\n \n+Apply:\n+\n+1. trac_10720_power_series_nth_root_2.patch\n+\n+2. trac_10720_power_series_nth_root_3.patch\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2011-02-03T15:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117330",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+computation of an nth root of a power series using the Newton method
 
+Apply:
+
+1. trac_10720_power_series_nth_root_2.patch
+
+2. trac_10720_power_series_nth_root_3.patch
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117331.json:
```json
{
    "body": "<a id='comment:7'></a>Attachment [trac_10720_power_series_nth_root_3.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root_3.patch) by pernici created at 2011-02-03 15:23:24\n\nWith trac_10720_power_series_nth_root_3.patch nth_root is much faster for `n` large\n\n```\nsage: S.<t> = QQ[[]]\nsage: p = t.exp(30)\nsage: %time p1 = p.nth_root(1000)\nWall time: 0.01 s\n```\nwith the previous version it takes 84s",
    "created_at": "2011-02-03T15:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117331",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:7'></a>Attachment [trac_10720_power_series_nth_root_3.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root_3.patch) by pernici created at 2011-02-03 15:23:24

With trac_10720_power_series_nth_root_3.patch nth_root is much faster for `n` large

```
sage: S.<t> = QQ[[]]
sage: p = t.exp(30)
sage: %time p1 = p.nth_root(1000)
Wall time: 0.01 s
```
with the previous version it takes 84s



---

archive/issue_comments_117332.json:
```json
{
    "body": "Attachment [trac_10720_power_series_nth_root_4.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root_4.patch) by pernici created at 2011-02-05 16:41:57",
    "created_at": "2011-02-05T16:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117332",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Attachment [trac_10720_power_series_nth_root_4.patch](tarball://root/attachments/some-uuid/ticket10720/trac_10720_power_series_nth_root_4.patch) by pernici created at 2011-02-05 16:41:57



---

archive/issue_comments_117333.json:
```json
{
    "body": "<a id='comment:8'></a>With trac_10720_power_series_nth_root_4.patch \nnth_root and inversion become faster for series on\npolynomial rings, when used together with\ntrac_10480_fast_PowerSeries_poly_multiplication-alternative.patch\nfrom ticket #10480 (otherwise these functions perform as without the patch).\n\nIn the following benchmarks apply\ntrac_karatsuba_improvements.patch and\ntrac_10480_fast_PowerSeries_poly_multiplication-alternative.patch,\ntrac_10720_power_series_nth_root_2.patch and\ntrac_10720_power_series_nth_root_3.patch;\nin (2) apply also the new patch\n\n```\nsage: N = 2\nsage: R= PolynomialRing(QQ,N,'x')\nsage: x = R.gens()\nsage: S.<t> = R[[]]\nsage: sx = sum(x)\nsage: prec = 15\nsage: p = (t.exp(prec)).subs({t:t*sx})\nsage: %time p1 = p^-1\nsage: %time p1 = p.nth_root(2)\n```\n\nInversion benchmark:\n\n```\nN  prec  (1)    (2)\n2  15    0.06   0.01\n3  15    2.1    0.07\n4  15    58     0.5\n5  15    1440   3.4\n```\n\nSquare root benchmark:\n\n```\nN  prec  (1)    (2)\n2  15    0.15   0.03\n3  15    5.2    0.31\n4  15    161    3.3\n```\n\nThe speedup is large because the terms with high degree in `t`\nare large polynomials, due to the combinatorial\npossibilities with several variables; using _mul_ instead of _mul_trunc\nseveral products involving these large polynomials are computed and\nlater truncated away.",
    "created_at": "2011-02-05T16:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117333",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:8'></a>With trac_10720_power_series_nth_root_4.patch 
nth_root and inversion become faster for series on
polynomial rings, when used together with
trac_10480_fast_PowerSeries_poly_multiplication-alternative.patch
from ticket #10480 (otherwise these functions perform as without the patch).

In the following benchmarks apply
trac_karatsuba_improvements.patch and
trac_10480_fast_PowerSeries_poly_multiplication-alternative.patch,
trac_10720_power_series_nth_root_2.patch and
trac_10720_power_series_nth_root_3.patch;
in (2) apply also the new patch

```
sage: N = 2
sage: R= PolynomialRing(QQ,N,'x')
sage: x = R.gens()
sage: S.<t> = R[[]]
sage: sx = sum(x)
sage: prec = 15
sage: p = (t.exp(prec)).subs({t:t*sx})
sage: %time p1 = p^-1
sage: %time p1 = p.nth_root(2)
```

Inversion benchmark:

```
N  prec  (1)    (2)
2  15    0.06   0.01
3  15    2.1    0.07
4  15    58     0.5
5  15    1440   3.4
```

Square root benchmark:

```
N  prec  (1)    (2)
2  15    0.15   0.03
3  15    5.2    0.31
4  15    161    3.3
```

The speedup is large because the terms with high degree in `t`
are large polynomials, due to the combinatorial
possibilities with several variables; using _mul_ instead of _mul_trunc
several products involving these large polynomials are computed and
later truncated away.



---

archive/issue_comments_117334.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+computation of an nth root of a power series using the Newton method\n+\n \n \n Component: PLEASE CHANGE\n``````\n",
    "created_at": "2011-02-05T16:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117334",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+computation of an nth root of a power series using the Newton method
+
 
 
 Component: PLEASE CHANGE
``````




---

archive/issue_comments_117335.json:
```json
{
    "body": "<a id='comment:10'></a>This is an enhancement rather than a defect.",
    "created_at": "2011-11-13T12:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117335",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:10'></a>This is an enhancement rather than a defect.



---

archive/issue_comments_117336.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2011-11-13T12:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117336",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_117337.json:
```json
{
    "body": "<a id='comment:11'></a>Which patches need to be applied? Please put some information in the ticket description.\n\nIf  `trac_10720_power_series_nth_root_3.patch` is meant to be applied, please add a doctest to `__pow_trunc`.",
    "created_at": "2011-12-31T12:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117337",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>Which patches need to be applied? Please put some information in the ticket description.

If  `trac_10720_power_series_nth_root_3.patch` is meant to be applied, please add a doctest to `__pow_trunc`.



---

archive/issue_comments_117338.json:
```json
{
    "body": "<a id='comment:13'></a>As Volker mentioned, `__pow_trunc` lacks a docstring. (Just to remove this from the list of tickets needing review until that is fixed.)",
    "created_at": "2013-03-04T18:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117338",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:13'></a>As Volker mentioned, `__pow_trunc` lacks a docstring. (Just to remove this from the list of tickets needing review until that is fixed.)



---

archive/issue_comments_117339.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-04T18:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117339",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117340.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+computation of an nth root of a power series using the Newton method\n \n+---\n+\n+Apply\n+\n+1. [attachment:trac_10720_power_series_nth_root_2.patch]\n+2. [attachment:trac_10720_power_series_nth_root_3.patch]\n+3. [attachment:trac_10720_power_series_nth_root_4.patch]\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2013-03-04T18:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117340",
    "user": "https://github.com/saraedum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+computation of an nth root of a power series using the Newton method
 
+---
+
+Apply
+
+1. [attachment:trac_10720_power_series_nth_root_2.patch]
+2. [attachment:trac_10720_power_series_nth_root_3.patch]
+3. [attachment:trac_10720_power_series_nth_root_4.patch]
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117341.json:
```json
{
    "body": "<a id='comment:14'></a>One related remark:\n\nThanks to ticket #14115, it is now easy to implement a general rational power by\n\n```\ndef rational_power(f,alpha):\n    return (f.log()*alpha).exp()\n```\n\nI do not know how it compares in terms of speed with the method of this ticket.",
    "created_at": "2013-03-15T10:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117341",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>One related remark:

Thanks to ticket #14115, it is now easy to implement a general rational power by

```
def rational_power(f,alpha):
    return (f.log()*alpha).exp()
```

I do not know how it compares in terms of speed with the method of this ticket.



---

archive/issue_events_027602.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27602"
}
```



---

archive/issue_events_027603.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27603"
}
```



---

archive/issue_events_027604.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27604"
}
```



---

archive/issue_events_027605.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27605"
}
```



---

archive/issue_comments_117342.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:14 chapoton]:\n> Thanks to ticket #14115, it is now easy to implement a general rational power by\n> \n> ```\n> def rational_power(f,alpha):\n>     return (f.log()*alpha).exp()\n> ```\n> \n> I do not know how it compares in terms of speed with the method of this ticket.\n\nAdditionally #15601 implements Pari series. If a speed comparison is made please include that implementation as third case to compare.",
    "created_at": "2014-04-22T13:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117342",
    "user": "https://github.com/rwst"
}
```

<a id='comment:17'></a>Replying to [comment:14 chapoton]:
> Thanks to ticket #14115, it is now easy to implement a general rational power by
> 
> ```
> def rational_power(f,alpha):
>     return (f.log()*alpha).exp()
> ```
> 
> I do not know how it compares in terms of speed with the method of this ticket.

Additionally #15601 implements Pari series. If a speed comparison is made please include that implementation as third case to compare.



---

archive/issue_events_027606.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27606"
}
```



---

archive/issue_events_027607.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27607"
}
```



---

archive/issue_events_027608.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27608"
}
```



---

archive/issue_events_027609.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27609"
}
```



---

archive/issue_events_027610.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-06-24T07:58:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27610"
}
```



---

archive/issue_events_027611.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-06-24T07:58:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27611"
}
```



---

archive/issue_comments_117343.json:
```json
{
    "body": "<a id='comment:20'></a>We should use (and possibly improve) #20571. Would be a good idea to use this ticket to implement a `_pow_trunc_` following the `__pow_trunc` from [attachment:trac_10720_power_series_nth_root_3.patch].",
    "created_at": "2016-06-24T07:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117343",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>We should use (and possibly improve) #20571. Would be a good idea to use this ticket to implement a `_pow_trunc_` following the `__pow_trunc` from [attachment:trac_10720_power_series_nth_root_3.patch].



---

archive/issue_comments_117344.json:
```json
{
    "body": "<a id='comment:21'></a>Moreover, polynomials should provide a `nth_root_series_trunc` (the same way there exists a `inverse_series_trunc`).",
    "created_at": "2016-06-24T08:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117344",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>Moreover, polynomials should provide a `nth_root_series_trunc` (the same way there exists a `inverse_series_trunc`).



---

archive/issue_comments_117345.json:
```json
{
    "body": "<a id='comment:22'></a>recycling...",
    "created_at": "2017-12-18T11:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117345",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>recycling...



---

archive/issue_comments_117346.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There is a nth_root method defined on univariate and multivariate polynomials.\n \n+```\n+sage: R.<x,y,z> = QQ[]\n+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We should make it available on\n+\n+- univariate and multivariate Laurent polynomials\n+- univariate and multivariate power series\n+- univariate and multivariate Laurent power series\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-18T11:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117346",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There is a nth_root method defined on univariate and multivariate polynomials.
 
+```
+sage: R.<x,y,z> = QQ[]
+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We should make it available on
+
+- univariate and multivariate Laurent polynomials
+- univariate and multivariate power series
+- univariate and multivariate Laurent power series
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_events_027612.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-18T11:04:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27612"
}
```



---

archive/issue_events_027613.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-18T11:04:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27613"
}
```



---

archive/issue_comments_117347.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There is a nth_root method defined on univariate and multivariate polynomials.\n \n+```\n+sage: R.<x,y,z> = QQ[]\n+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We modify provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+\n+- univariate and multivariate Laurent polynomials\n+- univariate and multivariate power series\n+- univariate and multivariate Laurent power series\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-18T11:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117347",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There is a nth_root method defined on univariate and multivariate polynomials.
 
+```
+sage: R.<x,y,z> = QQ[]
+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We modify provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+
+- univariate and multivariate Laurent polynomials
+- univariate and multivariate power series
+- univariate and multivariate Laurent power series
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117348.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There is a nth_root method defined on univariate and multivariate polynomials.\n \n+```\n+sage: R.<x,y,z> = QQ[]\n+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+\n+- univariate and multivariate Laurent polynomials\n+- univariate and multivariate power series\n+- univariate and multivariate Laurent power series\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-18T11:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117348",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There is a nth_root method defined on univariate and multivariate polynomials.
 
+```
+sage: R.<x,y,z> = QQ[]
+sage: (32 * (x*y + 1)^5 * (x+y+z)^5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+
+- univariate and multivariate Laurent polynomials
+- univariate and multivariate power series
+- univariate and multivariate Laurent power series
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117349.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,17 @@\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n+```\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+On multi-variate polynomials there is another `nth_root` method implemented via factorization (sic)!!\n+\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for both univariate and multivariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+\n+- univariate and multivariate Laurent polynomials\n+- univariate and multivariate power series\n+- univariate and multivariate Laurent power series\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-18T11:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117349",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,17 @@
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
+```
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+On multi-variate polynomials there is another `nth_root` method implemented via factorization (sic)!!
+
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for both univariate and multivariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+
+- univariate and multivariate Laurent polynomials
+- univariate and multivariate power series
+- univariate and multivariate Laurent power series
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117350.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,17 @@\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n+```\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+\n+- univariate Laurent polynomials\n+- univariate power series\n+- univariate Laurent power series\n+\n+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-19T10:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117350",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,17 @@
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
+```
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+
+- univariate Laurent polynomials
+- univariate power series
+- univariate Laurent power series
+
+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117351.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,19 @@\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n+```\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for\n+\n+- univariate Laurent polynomials\n+- univariate power series\n+- univariate Laurent power series\n+\n+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n+\n+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-21T11:26:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117351",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,19 @@
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
+```
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for
+
+- univariate Laurent polynomials
+- univariate power series
+- univariate Laurent power series
+
+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
+
+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117352.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n+```\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n+\n+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n+\n+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-21T13:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117352",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
+```
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We provide a more general implementation in a new method `nth_root_series_trunc` that compute the series expansion of the n-th root for univariate polynomials (there might not be a n-th root that is a polynomial). Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
+
+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
+
+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117353.json:
```json
{
    "body": "<a id='comment:28'></a>New commits:",
    "created_at": "2017-12-21T13:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117353",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>New commits:



---

archive/issue_comments_117354.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-12-21T13:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117354",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117355.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n+```\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z\n+```\n+We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n+\n+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n+\n+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-21T13:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117355",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
+```
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
+2*x^2*y + 2*x*y^2 + 2*x*y*z + 2*x + 2*y + 2*z
+```
+We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
+
+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
+
+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117356.json:
```json
{
    "body": "<a id='comment:30'></a>Reproducing the example of [This is the Trac macro *comment:7 comment:7* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:7 comment:7-macro)\n\n```\nsage: S.<t> = QQ[[]]\nsage: p = t.exp(30)\nsage: %time p1 = p.nth_root(1000)\nCPU times: user 11.7 ms, sys: 3.27 ms, total: 15 ms\nWall time: 13.8 ms\n```",
    "created_at": "2017-12-21T13:10:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117356",
    "user": "https://github.com/videlec"
}
```

<a id='comment:30'></a>Reproducing the example of [This is the Trac macro *comment:7 comment:7* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:7 comment:7-macro)

```
sage: S.<t> = QQ[[]]
sage: p = t.exp(30)
sage: %time p1 = p.nth_root(1000)
CPU times: user 11.7 ms, sys: 3.27 ms, total: 15 ms
Wall time: 13.8 ms
```



---

archive/issue_comments_117357.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-12-21T13:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117357",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117358.json:
```json
{
    "body": "<a id='comment:31'></a>The initial proposal of using Newton method for `y^-n` is more clever since we don't need to use power series inversion...",
    "created_at": "2017-12-21T13:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117358",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>The initial proposal of using Newton method for `y^-n` is more clever since we don't need to use power series inversion...



---

archive/issue_comments_117359.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There is a nth_root method defined on univariate polynomial (via Newton method)\n \n+```\n+sage: R.<x> = QQ[]\n+sage: ((1 + x - x^2)**5).nth_root(5)\n+-x^2 + x + 1\n+```\n+We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.\n+\n+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).\n+\n+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2017-12-21T13:55:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117359",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There is a nth_root method defined on univariate polynomial (via Newton method)
 
+```
+sage: R.<x> = QQ[]
+sage: ((1 + x - x^2)**5).nth_root(5)
+-x^2 + x + 1
+```
+We provide a more general implementation in a new method `_nth_root_series` that compute the series expansion of the n-th root for univariate polynomials. Using it we implement straightforward `nth_root` for univariate (Laurent) power series.
+
+This branch will not consider support for `extend=True` (see this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/ijYyZ4IduF0)). When `extend=True` the method will simply raise a `NotImplementedError` while waiting for Puiseux series in Sage (see #4618).
+
+On multi-variate polynomials there is also a `nth_root` method but which is implemented via factorization (sic)! The multivariate case should just call the univariate case with appropriate variable ordering. This will be dealt with in another ticket.
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_117360.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-21T14:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117361.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-12-21T14:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117361",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117362.json:
```json
{
    "body": "<a id='comment:35'></a>It is indeed better\n\n```\nsage: S.<t> = QQ[[]]\nsage: p = t.exp(30)\nsage: %time p1 = p.nth_root(1000)\nCPU times: user 3.8 ms, sys: 30 \u00b5s, total: 3.83 ms\nWall time: 3.69 ms\n```",
    "created_at": "2017-12-21T14:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117362",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>It is indeed better

```
sage: S.<t> = QQ[[]]
sage: p = t.exp(30)
sage: %time p1 = p.nth_root(1000)
CPU times: user 3.8 ms, sys: 30 µs, total: 3.83 ms
Wall time: 3.69 ms
```



---

archive/issue_comments_117363.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:14 chapoton]:\n> One related remark:\n> \n> Thanks to ticket #14115, it is now easy to implement a general rational power by\n> \n> ```\n> def rational_power(f,alpha):\n>     return (f.log()*alpha).exp()\n> ```\n> \n> I do not know how it compares in terms of speed with the method of this ticket.\n\n\n```\nsage: R.<x> = PowerSeriesRing(QQ, default_prec=100)\nsage: p = (1 + 2*x - x^4)**200\nsage: %timeit p1 = p.nth_root(1000)\n100 loops, best of 3: 4.18 ms per loop\nsage: %timeit p2 = (p.log()/1000).exp()\n100 loops, best of 3: 5.84 ms per loop\n```\nBut the main advantage of the method proposed here is that it works in positive characteristic.",
    "created_at": "2017-12-21T15:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117363",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>Replying to [comment:14 chapoton]:
> One related remark:
> 
> Thanks to ticket #14115, it is now easy to implement a general rational power by
> 
> ```
> def rational_power(f,alpha):
>     return (f.log()*alpha).exp()
> ```
> 
> I do not know how it compares in terms of speed with the method of this ticket.


```
sage: R.<x> = PowerSeriesRing(QQ, default_prec=100)
sage: p = (1 + 2*x - x^4)**200
sage: %timeit p1 = p.nth_root(1000)
100 loops, best of 3: 4.18 ms per loop
sage: %timeit p2 = (p.log()/1000).exp()
100 loops, best of 3: 5.84 ms per loop
```
But the main advantage of the method proposed here is that it works in positive characteristic.



---

archive/issue_comments_117364.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-21T15:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117365.json:
```json
{
    "body": "<a id='comment:39'></a>1. `def _nth_root_series(self, long n, long prec, start=None):` is missing a INPUT block, in which, in particular, the goal of input `start` should be explained.\n\n2. At two places the input block says `- ``prec`` -- integer (optional) - precision of the result`, but the code does `prec = min(self.prec(), prec)`. I suggest to add a sentence advertising it saying something like `If prec is larger than self.prec(), then self.prec() is used.`",
    "created_at": "2017-12-22T09:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117365",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:39'></a>1. `def _nth_root_series(self, long n, long prec, start=None):` is missing a INPUT block, in which, in particular, the goal of input `start` should be explained.

2. At two places the input block says `- ``prec`` -- integer (optional) - precision of the result`, but the code does `prec = min(self.prec(), prec)`. I suggest to add a sentence advertising it saying something like `If prec is larger than self.prec(), then self.prec() is used.`



---

archive/issue_comments_117366.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-12-22T09:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117366",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117367.json:
```json
{
    "body": "<a id='comment:40'></a>3. `Check that the result are consistent` -> `results`",
    "created_at": "2017-12-22T12:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117367",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:40'></a>3. `Check that the result are consistent` -> `results`



---

archive/issue_comments_117368.json:
```json
{
    "body": "<a id='comment:41'></a>Once, those three changes on the documentation aspect are done, feel free to change the status to positive review on my behalf.",
    "created_at": "2017-12-22T12:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117368",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:41'></a>Once, those three changes on the documentation aspect are done, feel free to change the status to positive review on my behalf.



---

archive/issue_comments_117369.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-12-26T16:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117369",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_117370.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-12-26T16:27:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117370",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117371.json:
```json
{
    "body": "<a id='comment:43'></a>rebased and fixed. I am only setting to needs review to have some patchbot reviews.",
    "created_at": "2017-12-26T16:27:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117371",
    "user": "https://github.com/videlec"
}
```

<a id='comment:43'></a>rebased and fixed. I am only setting to needs review to have some patchbot reviews.



---

archive/issue_comments_117372.json:
```json
{
    "body": "<a id='comment:44'></a>Merci S\u00e9bastien!",
    "created_at": "2017-12-28T12:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117372",
    "user": "https://github.com/videlec"
}
```

<a id='comment:44'></a>Merci Sébastien!



---

archive/issue_comments_117373.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-12-28T12:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117373",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_027614.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-31T09:27:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10720#event-27614"
}
```



---

archive/issue_comments_117374.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-12-31T09:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10720#issuecomment-117374",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
