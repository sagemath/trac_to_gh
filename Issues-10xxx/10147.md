# Issue 10147: conversions of constant polynomials

archive/issues_010146.json:
```json
{
    "assignees": [],
    "body": "Many conversions of constant polynomials fail\n\n```\nsage: CC(QQ['x']['y'](2/3))\nTraceback (most recent call last):\n...\nTypeError: unable to coerce to a ComplexNumber:\n<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>\n```\nAs a consequence, some root computations are not available\n\n```\nsage: R.<x> = QQ['y'][]\nsage: (-x+1).roots(ring=CC)\n[(1.00000000000000, 1)]\nsage: (-1/2*x+1).roots(ring=CC)\nTraceback (most recent call last):\n...\nTypeError: unable to coerce to a ComplexNumber:\n<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>\n```\n(this used to crash on older version of SageMath, see below).\n\n---\nOriginal report on previous version of sage\n\n`p.roots(ring=CC)` where `p` is an element `QQ['y']['x']` whose coefficient do not depend on `y` leads to several different errors depending on the value of p.  I guess there are in fact several distinct issues.  The final crash might be related to #9826.\n\n```\n~$ sage\n----------------------------------------------------------------------\n| Sage Version 4.5.3, Release Date: 2010-09-04                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: R.<x> = QQ['y'][]\nsage: (-x+1).roots(ring=CC)\n[(1.00000000000000, 1)]\nsage: (-1/2*x+1).roots(ring=CC)\nERROR: An unexpected error occurred while tokenizing input\nThe following traceback may be corrupted or invalid\nThe error message is: ('EOF in multi-line statement', (19469, 0))\n\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/home/marc/<ipython console> in <module>()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31226)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.change_ring (sage/rings/polynomial/polynomial_element.c:16456)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6407)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3108)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3010)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_ring.pyc in _element_constructor_(self, x, check, is_gen, construct, **kwds)\n    311                 x = x.Polrev()\n    312 \n--> 313         return C(self, x, check, is_gen, construct=construct, **kwds)\n    314 \n    315     def is_integral_domain(self, proof = True):\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_real_mpfr_dense.so in sage.rings.polynomial.polynomial_real_mpfr_dense.PolynomialRealDense.__init__ (sage/rings/polynomial/polynomial_real_mpfr_dense.c:3609)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6407)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3108)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3010)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/real_mpfr.so in sage.rings.real_mpfr.RealField_class._element_constructor_ (sage/rings/real_mpfr.c:5058)()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/real_mpfr.so in sage.rings.real_mpfr.RealNumber._set (sage/rings/real_mpfr.c:8767)()\n\nTypeError: Unable to convert x (='-1/2') to real number.\nsage: (-1/2*x+1/2).roots()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n\n/home/marc/<ipython console> in <module>()\n\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31591)()\n\nNotImplementedError: root finding for this polynomial not implemented\nsage: (-1/2*x+1/2).roots(ring=CC)\n*** glibc detected *** python: munmap_chunk(): invalid pointer: 0x0000000001208958 ***\n======= Backtrace: =========\n/lib/libc.so.6[0x3c38271ad6]\n/home/marc/opt/sage-4.5.3/local/lib/libmpfr.so.1(mpfr_clear+0x45)[0x7fc911f80a45]\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_real_mpfr_dense.so(+0x7867)[0x7fc90a74d867]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0xa241c)[0x7fc91e85841c]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x3af3)[0x7fc91e89f973]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0x730df)[0x7fc91e8290df]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0x5819f)[0x7fc91e80e19f]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so(+0x12724)[0x7fc910609724]\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/parent.so(+0x25ec2)[0x7fc9174a2ec2]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0xaba8c)[0x7fc91e861a8c]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so(+0xd3c2)[0x7fc90bc873c2]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]\n/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so(+0xd191c)[0x7fc90bd4b91c]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5a8e)[0x7fc91e8a190e]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7fc91e8a2df2]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x6244)[0x7fc91e8a20c4]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5ab2)[0x7fc91e8a1932]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7fc91e8a2df2]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyRun_FileExFlags+0xb0)[0x7fc91e8c2c90]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyRun_SimpleFileExFlags+0xdc)[0x7fc91e8c2e5c]\n/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(Py_Main+0xb36)[0x7fc91e8d0186]\n/lib/libc.so.6(__libc_start_main+0xfd)[0x3c3821ec4d]\npython[0x400699]\n======= Memory map: ========\n00400000-00401000 r-xp 00000000 08:0a 1787644                            /home/marc/opt/sage-4.5.3/local/bin/python\n00600000-00601000 rw-p 00000000 08:0a 1787644                            /home/marc/opt/sage-4.5.3/local/bin/python\n00cb1000-05306000 rw-p 00000000 00:00 0                                  [heap]\n32b2c00000-32b2c16000 r-xp 00000000 08:06 40741                          /lib/libgcc_s.so.1\n32b2c16000-32b2e15000 ---p 00016000 08:06 40741                          /lib/libgcc_s.so.1\n32b2e15000-32b2e16000 rw-p 00015000 08:06 40741                          /lib/libgcc_s.so.1\n3c37e00000-3c37e1e000 r-xp 00000000 08:06 40724                          /lib/ld-2.11.2.so\n3c3801d000-3c3801e000 r--p 0001d000 08:06 40724                          /lib/ld-2.11.2.so\n3c3801e000-3c3801f000 rw-p 0001e000 08:06 40724                          /lib/ld-2.11.2.so\n3c3801f000-3c38020000 rw-p 00000000 00:00 0 \n3c38200000-3c38358000 r-xp 00000000 08:06 40737                          /lib/libc-2.11.2.so\n3c38358000-3c38557000 ---p 00158000 08:06 40737                          /lib/libc-2.11.2.so\n3c38557000-3c3855b000 r--p 00157000 08:06 40737                          /lib/libc-2.11.2.so\n3c3855b000-3c3855c000 rw-p 0015b000 08:06 40737                          /lib/libc-2.11.2.so\n3c3855c000-3c38561000 rw-p 00000000 00:00 0 \n3c38600000-3c38680000 r-xp 00000000 08:06 40787                          /lib/libm-2.11.2.so\n3c38680000-3c38880000 ---p 00080000 08:06 40787                          /lib/libm-2.11.2.so\n3c38880000-3c38881000 r--p 00080000 08:06 40787                          /lib/libm-2.11.2.so\n3c38881000-3c38882000 rw-p 00081000 08:06 40787                          /lib/libm-2.11.2.so\n3c38a00000-3c38a02000 r-xp 00000000 08:06 40738                          /lib/libdl-2.11.2.so\n3c38a02000-3c38c02000 ---p 00002000 08:06 40738                          /lib/libdl-2.11.2.so\n3c38c02000-3c38c03000 r--p 00002000 08:06 40738                          /lib/libdl-2.11.2.so\n3c38c03000-3c38c04000 rw-p 00003000 08:06 40738                          /lib/libdl-2.11.2.so\n3c38e00000-3c38e17000 r-xp 00000000 08:06 40766                          /lib/libpthread-2.11.2.so\n3c38e17000-3c39016000 ---p 00017000 08:06 40766                          /lib/libpthread-2.11.2.so\n3c39016000-3c39017000 r--p 00016000 08:06 40766                          /lib/libpthread-2.11.2.so\n3c39017000-3c39018000 rw-p 00017000 08:06 40766                          /lib/libpthread-2.11.2.so\n3c39018000-3c3901c000 rw-p 00000000 00:00 0 \n3c4ba00000-3c4ba08000 r-xp 00000000 08:06 40917                          /lib/libcrypt-2.11.2.so\n3c4ba08000-3c4bc07000 ---p 00008000 08:06 40917                          /lib/libcrypt-2.11.2.so\n3c4bc07000-3c4bc08000 r--p 00007000 08:06 40917                          /lib/libcrypt-2.11.2.so\n3c4bc08000-3c4bc09000 rw-p 00008000 08:06 40917                          /lib/libcrypt-2.11.2.so\n```\n\n\n\n**Assignee:** @aghitza\n\n**CC:**  @jasongrout\n\n**Branch/Commit:** [6822948572e9dcb87e86fa30f3387e640c88c55b](https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b)\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Vincent Delecroix\n\nIssue created by migration from https://trac.sagemath.org/ticket/10147\n\n",
    "closed_at": "2021-03-20T15:27:43Z",
    "created_at": "2010-10-20T18:55:44Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "conversions of constant polynomials",
    "type": "issue",
    "updated_at": "2021-03-20T18:22:45Z",
    "url": "https://github.com/sagemath/sage/issues/10147",
    "user": "https://github.com/mezzarobba"
}
```
Many conversions of constant polynomials fail

```
sage: CC(QQ['x']['y'](2/3))
Traceback (most recent call last):
...
TypeError: unable to coerce to a ComplexNumber:
<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>
```
As a consequence, some root computations are not available

```
sage: R.<x> = QQ['y'][]
sage: (-x+1).roots(ring=CC)
[(1.00000000000000, 1)]
sage: (-1/2*x+1).roots(ring=CC)
Traceback (most recent call last):
...
TypeError: unable to coerce to a ComplexNumber:
<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>
```
(this used to crash on older version of SageMath, see below).

---
Original report on previous version of sage

`p.roots(ring=CC)` where `p` is an element `QQ['y']['x']` whose coefficient do not depend on `y` leads to several different errors depending on the value of p.  I guess there are in fact several distinct issues.  The final crash might be related to #9826.

```
~$ sage
----------------------------------------------------------------------
| Sage Version 4.5.3, Release Date: 2010-09-04                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: R.<x> = QQ['y'][]
sage: (-x+1).roots(ring=CC)
[(1.00000000000000, 1)]
sage: (-1/2*x+1).roots(ring=CC)
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (19469, 0))

---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/marc/<ipython console> in <module>()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31226)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.change_ring (sage/rings/polynomial/polynomial_element.c:16456)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6407)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3108)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3010)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_ring.pyc in _element_constructor_(self, x, check, is_gen, construct, **kwds)
    311                 x = x.Polrev()
    312 
--> 313         return C(self, x, check, is_gen, construct=construct, **kwds)
    314 
    315     def is_integral_domain(self, proof = True):

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_real_mpfr_dense.so in sage.rings.polynomial.polynomial_real_mpfr_dense.PolynomialRealDense.__init__ (sage/rings/polynomial/polynomial_real_mpfr_dense.c:3609)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6407)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3108)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3010)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/real_mpfr.so in sage.rings.real_mpfr.RealField_class._element_constructor_ (sage/rings/real_mpfr.c:5058)()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/real_mpfr.so in sage.rings.real_mpfr.RealNumber._set (sage/rings/real_mpfr.c:8767)()

TypeError: Unable to convert x (='-1/2') to real number.
sage: (-1/2*x+1/2).roots()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/marc/<ipython console> in <module>()

/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31591)()

NotImplementedError: root finding for this polynomial not implemented
sage: (-1/2*x+1/2).roots(ring=CC)
*** glibc detected *** python: munmap_chunk(): invalid pointer: 0x0000000001208958 ***
======= Backtrace: =========
/lib/libc.so.6[0x3c38271ad6]
/home/marc/opt/sage-4.5.3/local/lib/libmpfr.so.1(mpfr_clear+0x45)[0x7fc911f80a45]
/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_real_mpfr_dense.so(+0x7867)[0x7fc90a74d867]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0xa241c)[0x7fc91e85841c]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x3af3)[0x7fc91e89f973]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0x730df)[0x7fc91e8290df]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0x5819f)[0x7fc91e80e19f]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]
/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so(+0x12724)[0x7fc910609724]
/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/structure/parent.so(+0x25ec2)[0x7fc9174a2ec2]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(+0xaba8c)[0x7fc91e861a8c]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]
/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so(+0xd3c2)[0x7fc90bc873c2]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyObject_Call+0x53)[0x7fc91e7fce13]
/home/marc/opt/sage-4.5.3/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so(+0xd191c)[0x7fc90bd4b91c]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5a8e)[0x7fc91e8a190e]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7fc91e8a2df2]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x6244)[0x7fc91e8a20c4]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5ab2)[0x7fc91e8a1932]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x5235)[0x7fc91e8a10b5]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x8cd)[0x7fc91e8a2d1d]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7fc91e8a2df2]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyRun_FileExFlags+0xb0)[0x7fc91e8c2c90]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(PyRun_SimpleFileExFlags+0xdc)[0x7fc91e8c2e5c]
/home/marc/opt/sage-4.5.3/local/lib/libpython2.6.so.1.0(Py_Main+0xb36)[0x7fc91e8d0186]
/lib/libc.so.6(__libc_start_main+0xfd)[0x3c3821ec4d]
python[0x400699]
======= Memory map: ========
00400000-00401000 r-xp 00000000 08:0a 1787644                            /home/marc/opt/sage-4.5.3/local/bin/python
00600000-00601000 rw-p 00000000 08:0a 1787644                            /home/marc/opt/sage-4.5.3/local/bin/python
00cb1000-05306000 rw-p 00000000 00:00 0                                  [heap]
32b2c00000-32b2c16000 r-xp 00000000 08:06 40741                          /lib/libgcc_s.so.1
32b2c16000-32b2e15000 ---p 00016000 08:06 40741                          /lib/libgcc_s.so.1
32b2e15000-32b2e16000 rw-p 00015000 08:06 40741                          /lib/libgcc_s.so.1
3c37e00000-3c37e1e000 r-xp 00000000 08:06 40724                          /lib/ld-2.11.2.so
3c3801d000-3c3801e000 r--p 0001d000 08:06 40724                          /lib/ld-2.11.2.so
3c3801e000-3c3801f000 rw-p 0001e000 08:06 40724                          /lib/ld-2.11.2.so
3c3801f000-3c38020000 rw-p 00000000 00:00 0 
3c38200000-3c38358000 r-xp 00000000 08:06 40737                          /lib/libc-2.11.2.so
3c38358000-3c38557000 ---p 00158000 08:06 40737                          /lib/libc-2.11.2.so
3c38557000-3c3855b000 r--p 00157000 08:06 40737                          /lib/libc-2.11.2.so
3c3855b000-3c3855c000 rw-p 0015b000 08:06 40737                          /lib/libc-2.11.2.so
3c3855c000-3c38561000 rw-p 00000000 00:00 0 
3c38600000-3c38680000 r-xp 00000000 08:06 40787                          /lib/libm-2.11.2.so
3c38680000-3c38880000 ---p 00080000 08:06 40787                          /lib/libm-2.11.2.so
3c38880000-3c38881000 r--p 00080000 08:06 40787                          /lib/libm-2.11.2.so
3c38881000-3c38882000 rw-p 00081000 08:06 40787                          /lib/libm-2.11.2.so
3c38a00000-3c38a02000 r-xp 00000000 08:06 40738                          /lib/libdl-2.11.2.so
3c38a02000-3c38c02000 ---p 00002000 08:06 40738                          /lib/libdl-2.11.2.so
3c38c02000-3c38c03000 r--p 00002000 08:06 40738                          /lib/libdl-2.11.2.so
3c38c03000-3c38c04000 rw-p 00003000 08:06 40738                          /lib/libdl-2.11.2.so
3c38e00000-3c38e17000 r-xp 00000000 08:06 40766                          /lib/libpthread-2.11.2.so
3c38e17000-3c39016000 ---p 00017000 08:06 40766                          /lib/libpthread-2.11.2.so
3c39016000-3c39017000 r--p 00016000 08:06 40766                          /lib/libpthread-2.11.2.so
3c39017000-3c39018000 rw-p 00017000 08:06 40766                          /lib/libpthread-2.11.2.so
3c39018000-3c3901c000 rw-p 00000000 00:00 0 
3c4ba00000-3c4ba08000 r-xp 00000000 08:06 40917                          /lib/libcrypt-2.11.2.so
3c4ba08000-3c4bc07000 ---p 00008000 08:06 40917                          /lib/libcrypt-2.11.2.so
3c4bc07000-3c4bc08000 r--p 00007000 08:06 40917                          /lib/libcrypt-2.11.2.so
3c4bc08000-3c4bc09000 rw-p 00008000 08:06 40917                          /lib/libcrypt-2.11.2.so
```



**Assignee:** @aghitza

**CC:**  @jasongrout

**Branch/Commit:** [6822948572e9dcb87e86fa30f3387e640c88c55b](https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b)

**Reviewer:** Matthias Koeppe

**Author:** Vincent Delecroix

Issue created by migration from https://trac.sagemath.org/ticket/10147





---

archive/issue_events_111508.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-10-20T18:55:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111508"
}
```



---

archive/issue_events_111509.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-10-20T18:55:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "08517b",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111509"
}
```



---

archive/issue_events_111510.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-10-20T18:55:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111510"
}
```



---

archive/issue_events_111511.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111511"
}
```



---

archive/issue_events_111512.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111512"
}
```



---

archive/issue_events_111513.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111513"
}
```



---

archive/issue_events_111514.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111514"
}
```



---

archive/issue_events_111515.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111515"
}
```



---

archive/issue_events_111516.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111516"
}
```



---

archive/issue_events_111517.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111517"
}
```



---

archive/issue_events_111518.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111518"
}
```



---

archive/issue_comments_095535.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nNo longer crashes; the errors in the cases that are not implemented make sense; I doubt this is worth adding tests.",
    "created_at": "2021-03-09T17:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95535",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:6'>**Comment 6:**</a>
No longer crashes; the errors in the cases that are not implemented make sense; I doubt this is worth adding tests.



---

archive/issue_events_111519.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2021-03-09T17:42:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111519"
}
```



---

archive/issue_events_111520.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2021-03-09T17:42:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111520"
}
```



---

archive/issue_events_111521.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2021-03-09T17:42:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "008080",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111521"
}
```



---

archive/issue_comments_095536.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nIn sage-9.3.beta7 the example fails because of\n\n```\nsage: RR(QQ['y'](-1/2)) \nTraceback (most recent call last):\n...\nTypeError: unable to convert '-1/2' to a real number\n```\nwhich is worth fixing.",
    "created_at": "2021-03-14T18:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95536",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'>**Comment 7:**</a>
In sage-9.3.beta7 the example fails because of

```
sage: RR(QQ['y'](-1/2)) 
Traceback (most recent call last):
...
TypeError: unable to convert '-1/2' to a real number
```
which is worth fixing.



---

archive/issue_comments_095537.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nAs a matter of comparison, it works in QQ\n\n```\nsage: R.<x> = QQ['y'][]\nsage: (-1/2*x+1).roots(ring=QQ)\n[(2, 1)]\n```\nThis is because the conversion works\n\n```\nsage: QQ(QQ['y'](1/2))\n1/2\n```\nThis is explained by the fact that the conversion method `_rational_` is implemented on polynomial\n\n```\nsage: QQ['x'](1/2)._rational_()\n1/2\n```\nIt is worth adding the corresponding conversion methods for floating point numbers\n- `_mpfr_` for `RealField`\n- `_real_mpfi_` for `RealIntervalField`\nThough, complex numbers do not have a conversion method (set in the constructor via `self._populate_coercion_lists_(convert_method_name='XXX')`).",
    "created_at": "2021-03-14T18:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95537",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'>**Comment 8:**</a>
As a matter of comparison, it works in QQ

```
sage: R.<x> = QQ['y'][]
sage: (-1/2*x+1).roots(ring=QQ)
[(2, 1)]
```
This is because the conversion works

```
sage: QQ(QQ['y'](1/2))
1/2
```
This is explained by the fact that the conversion method `_rational_` is implemented on polynomial

```
sage: QQ['x'](1/2)._rational_()
1/2
```
It is worth adding the corresponding conversion methods for floating point numbers
- `_mpfr_` for `RealField`
- `_real_mpfi_` for `RealIntervalField`
Though, complex numbers do not have a conversion method (set in the constructor via `self._populate_coercion_lists_(convert_method_name='XXX')`).



---

archive/issue_events_111522.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-14T18:43:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111522"
}
```



---

archive/issue_events_111523.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-14T18:43:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111523"
}
```



---

archive/issue_events_111524.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-14T18:43:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111524"
}
```



---

archive/issue_comments_095538.json:
```json
{
    "body": "**Author:** Vincent Delecroix",
    "created_at": "2021-03-14T20:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95538",
    "user": "https://github.com/videlec"
}
```

**Author:** Vincent Delecroix



---

archive/issue_comments_095539.json:
```json
{
    "body": "**Branch:** [u/vdelecroix/10147](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10147)",
    "created_at": "2021-03-14T20:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95539",
    "user": "https://github.com/videlec"
}
```

**Branch:** [u/vdelecroix/10147](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10147)



---

archive/issue_comments_095540.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee49837a854eca344b0791dade89249618dd724c\">ee49837</a></td><td><code>add convert method for ComplexField</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e\">4c7a3c3</a></td><td><code>more scalar conversions for polynomials</code></td></tr></table>\n",
    "created_at": "2021-03-14T20:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95540",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'>**Comment 10:**</a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee49837a854eca344b0791dade89249618dd724c">ee49837</a></td><td><code>add convert method for ComplexField</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e">4c7a3c3</a></td><td><code>more scalar conversions for polynomials</code></td></tr></table>




---

archive/issue_events_111525.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-14T20:50:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111525"
}
```



---

archive/issue_events_111526.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-14T20:50:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111526"
}
```



---

archive/issue_comments_095541.json:
```json
{
    "body": "**Commit:** [4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e](https://github.com/sagemath/sagetrac-mirror/commit/4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e)",
    "created_at": "2021-03-14T20:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95541",
    "user": "https://github.com/videlec"
}
```

**Commit:** [4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e](https://github.com/sagemath/sagetrac-mirror/commit/4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e)



---

archive/issue_comments_095542.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+Many conversions of constant polynomials fail\n+\n+```\n+sage: CC(QQ['x']['y'](2/3))\n+Traceback (most recent call last):\n+...\n+TypeError: unable to coerce to a ComplexNumber:\n+<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>\n+```\n+As a consequence, some root computations are not available\n+\n+```\n+sage: R.<x> = QQ['y'][]\n+sage: (-x+1).roots(ring=CC)\n+[(1.00000000000000, 1)]\n+sage: (-1/2*x+1).roots(ring=CC)\n+Traceback (most recent call last):\n+...\n+TypeError: unable to coerce to a ComplexNumber:\n+<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>\n+```\n+(this used to crash on older version of SageMath, see below).\n+\n+---\n+Original report on previous version of sage\n+\n `p.roots(ring=CC)` where `p` is an element `QQ['y']['x']` whose coefficient do not depend on `y` leads to several different errors depending on the value of p.  I guess there are in fact several distinct issues.  The final crash might be related to #9826.\n \n ```\n@@ -6,10 +32,6 @@\n | Sage Version 4.5.3, Release Date: 2010-09-04                       |\n | Type notebook() for the GUI, and license() for information.        |\n ----------------------------------------------------------------------\n-sage: R.<x> = QQ['y'][]\n-sage: (-x+1).roots(ring=CC)\n-[(1.00000000000000, 1)]\n-sage: (-1/2*x+1).roots(ring=CC)\n ERROR: An unexpected error occurred while tokenizing input\n The following traceback may be corrupted or invalid\n The error message is: ('EOF in multi-line statement', (19469, 0))\n``````\n",
    "created_at": "2021-03-14T20:56:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95542",
    "user": "https://github.com/videlec"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,29 @@
+Many conversions of constant polynomials fail
+
+```
+sage: CC(QQ['x']['y'](2/3))
+Traceback (most recent call last):
+...
+TypeError: unable to coerce to a ComplexNumber:
+<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>
+```
+As a consequence, some root computations are not available
+
+```
+sage: R.<x> = QQ['y'][]
+sage: (-x+1).roots(ring=CC)
+[(1.00000000000000, 1)]
+sage: (-1/2*x+1).roots(ring=CC)
+Traceback (most recent call last):
+...
+TypeError: unable to coerce to a ComplexNumber:
+<class 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense'>
+```
+(this used to crash on older version of SageMath, see below).
+
+---
+Original report on previous version of sage
+
 `p.roots(ring=CC)` where `p` is an element `QQ['y']['x']` whose coefficient do not depend on `y` leads to several different errors depending on the value of p.  I guess there are in fact several distinct issues.  The final crash might be related to #9826.
 
 ```
@@ -6,10 +32,6 @@
 | Sage Version 4.5.3, Release Date: 2010-09-04                       |
 | Type notebook() for the GUI, and license() for information.        |
 ----------------------------------------------------------------------
-sage: R.<x> = QQ['y'][]
-sage: (-x+1).roots(ring=CC)
-[(1.00000000000000, 1)]
-sage: (-1/2*x+1).roots(ring=CC)
 ERROR: An unexpected error occurred while tokenizing input
 The following traceback may be corrupted or invalid
 The error message is: ('EOF in multi-line statement', (19469, 0))
``````




---

archive/issue_events_111527.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-14T20:56:47Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "rename": {
        "from": "Inconsistent behaviour of p.roots(ring=CC) for p(x) in QQ['y']['x'] (incl. crashing)",
        "to": "conversions of constant polynomials"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111527"
}
```



---

archive/issue_comments_095543.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -32,6 +32,10 @@\n | Sage Version 4.5.3, Release Date: 2010-09-04                       |\n | Type notebook() for the GUI, and license() for information.        |\n ----------------------------------------------------------------------\n+sage: R.<x> = QQ['y'][]\n+sage: (-x+1).roots(ring=CC)\n+[(1.00000000000000, 1)]\n+sage: (-1/2*x+1).roots(ring=CC)\n ERROR: An unexpected error occurred while tokenizing input\n The following traceback may be corrupted or invalid\n The error message is: ('EOF in multi-line statement', (19469, 0))\n``````\n",
    "created_at": "2021-03-14T20:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95543",
    "user": "https://github.com/videlec"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -32,6 +32,10 @@
 | Sage Version 4.5.3, Release Date: 2010-09-04                       |
 | Type notebook() for the GUI, and license() for information.        |
 ----------------------------------------------------------------------
+sage: R.<x> = QQ['y'][]
+sage: (-x+1).roots(ring=CC)
+[(1.00000000000000, 1)]
+sage: (-1/2*x+1).roots(ring=CC)
 ERROR: An unexpected error occurred while tokenizing input
 The following traceback may be corrupted or invalid
 The error message is: ('EOF in multi-line statement', (19469, 0))
``````




---

archive/issue_events_111528.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-14T23:13:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111528"
}
```



---

archive/issue_events_111529.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-14T23:13:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111529"
}
```



---

archive/issue_comments_095544.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nPatchbot shows doctest errors",
    "created_at": "2021-03-14T23:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95544",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'>**Comment 13:**</a>
Patchbot shows doctest errors



---

archive/issue_comments_095545.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nReplying to [@mkoeppe](#comment%3A13):\n> Patchbot shows doctest errors \n\nwhich one?",
    "created_at": "2021-03-17T19:32:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95545",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'>**Comment 14:**</a>
Replying to [@mkoeppe](#comment%3A13):
> Patchbot shows doctest errors 

which one?



---

archive/issue_events_111530.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-17T19:32:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111530"
}
```



---

archive/issue_events_111531.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-17T19:32:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111531"
}
```



---

archive/issue_comments_095546.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nThis one https://patchbot.sagemath.org/log/10147/Linux/1_SMP_Debian_4.19.171-2_(2021-01-30)/x86_64/4.19.0-14-amd64/tmonteil-lxc3/2021-03-17%2017:45:45",
    "created_at": "2021-03-17T19:39:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95546",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'>**Comment 15:**</a>
This one https://patchbot.sagemath.org/log/10147/Linux/1_SMP_Debian_4.19.171-2_(2021-01-30)/x86_64/4.19.0-14-amd64/tmonteil-lxc3/2021-03-17%2017:45:45



---

archive/issue_comments_095547.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nthx",
    "created_at": "2021-03-17T19:41:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95547",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'>**Comment 16:**</a>
thx



---

archive/issue_events_111532.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-17T19:41:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111532"
}
```



---

archive/issue_events_111533.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-17T19:41:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111533"
}
```



---

archive/issue_comments_095548.json:
```json
{
    "body": "**Changing commit** from \"[4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e](https://github.com/sagemath/sagetrac-mirror/commit/4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e)\" to \"[6822948572e9dcb87e86fa30f3387e640c88c55b](https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b)\".",
    "created_at": "2021-03-17T19:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95548",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e](https://github.com/sagemath/sagetrac-mirror/commit/4c7a3c3066ed34c65a22d722aa9c47e717bf6c6e)" to "[6822948572e9dcb87e86fa30f3387e640c88c55b](https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b)".



---

archive/issue_comments_095549.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b\">6822948</a></td><td><code>fix doctests</code></td></tr></table>\n",
    "created_at": "2021-03-17T19:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95549",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>**Comment 17:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b">6822948</a></td><td><code>fix doctests</code></td></tr></table>




---

archive/issue_events_111534.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-17T19:59:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111534"
}
```



---

archive/issue_events_111535.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-03-17T19:59:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111535"
}
```



---

archive/issue_comments_095550.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2021-03-18T03:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95550",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_comments_095551.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nLGTM",
    "created_at": "2021-03-18T03:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95551",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'>**Comment 19:**</a>
LGTM



---

archive/issue_events_111536.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T03:03:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111536"
}
```



---

archive/issue_events_111537.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T03:03:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111537"
}
```



---

archive/issue_comments_095552.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/10147](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10147)\" to \"[6822948572e9dcb87e86fa30f3387e640c88c55b](https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b)\".",
    "created_at": "2021-03-20T15:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10147#issuecomment-95552",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/vdelecroix/10147](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/10147)" to "[6822948572e9dcb87e86fa30f3387e640c88c55b](https://github.com/sagemath/sagetrac-mirror/commit/6822948572e9dcb87e86fa30f3387e640c88c55b)".



---

archive/issue_events_111538.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-20T15:27:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111538"
}
```



---

archive/issue_events_111539.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "96b4d505ad9cb96cd778b46ec6b3dbf3a44f6fd6",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-03-20T15:27:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111539"
}
```



---

archive/issue_events_111540.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-20T18:22:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111540"
}
```



---

archive/issue_events_111541.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-20T18:22:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10147",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10147#event-111541"
}
```
