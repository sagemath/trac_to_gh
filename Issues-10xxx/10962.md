# Issue 10962: Set_PythonType objects are not picklable

archive/issues_010883.json:
```json
{
    "body": "\n```\n    sage: S = sage.structure.parent.Set_PythonType(tuple)\n    sage: dumps(S)\n    ------------------------------------------------------------\n    Traceback (most recent call last):\n      File \"<ipython console>\", line 1, in <module>\n      File \"sage_object.pyx\", line 842, in sage.structure.sage_object.dumps (sage/structure/sage_object.c:8274)\n      File \"sage_object.pyx\", line 217, in sage.structure.sage_object.SageObject.dumps (sage/structure/sage_object.c:2183)\n    PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\n```\n \n\n\nAssignee: @williamstein\n\nCC:  sage-combinat\n\nBranch/Commit: f28f02aeb6008daa88a267dc31d31963664c17dc\n\nReviewer: Jeroen Demeyer, Vincent Delecroix\n\nAuthor: Vincent Delecroix, Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10962\n\n",
    "closed_at": "2015-01-02T15:46:39Z",
    "created_at": "2011-03-18T16:19:07Z",
    "labels": [
        "component: pickling",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "Set_PythonType objects are not picklable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10962",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

```
    sage: S = sage.structure.parent.Set_PythonType(tuple)
    sage: dumps(S)
    ------------------------------------------------------------
    Traceback (most recent call last):
      File "<ipython console>", line 1, in <module>
      File "sage_object.pyx", line 842, in sage.structure.sage_object.dumps (sage/structure/sage_object.c:8274)
      File "sage_object.pyx", line 217, in sage.structure.sage_object.SageObject.dumps (sage/structure/sage_object.c:2183)
    PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed
```
 


Assignee: @williamstein

CC:  sage-combinat

Branch/Commit: f28f02aeb6008daa88a267dc31d31963664c17dc

Reviewer: Jeroen Demeyer, Vincent Delecroix

Author: Vincent Delecroix, Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10962





---

archive/issue_comments_137973.json:
```json
{
    "body": "Changing assignee from sage-combinat to @williamstein.",
    "created_at": "2011-03-18T16:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137973",
    "user": "https://github.com/nthiery"
}
```

Changing assignee from sage-combinat to @williamstein.



---

archive/issue_comments_137974.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,21 +1,13 @@\n-This works:\n \n ```\n-sage: Q =  CombinatorialFreeModule( QQ, [1,2,3] )\n-sage: a = Q.an_element()\n-sage: dumps(a)\n-...\n-```\n-\n-And this doesn't:\n-\n-```\n-sage: Q =  CombinatorialFreeModule( QQ, sage.structure.parent.Set_PythonType(tuple) )\n-sage: a = Q.an_element()\n-sage: dumps(a)\n----------------------------------------------------------------------------\n-PicklingError                             Traceback (most recent call last)\n-...\n-PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\n+    sage: S = sage.structure.parent.Set_PythonType(tuple)\n+    sage: dumps(S)\n+    ------------------------------------------------------------\n+    Traceback (most recent call last):\n+      File \"<ipython console>\", line 1, in <module>\n+      File \"sage_object.pyx\", line 842, in sage.structure.sage_object.dumps (sage/structure/sage_object.c:8274)\n+      File \"sage_object.pyx\", line 217, in sage.structure.sage_object.SageObject.dumps (sage/structure/sage_object.c:2183)\n+    PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\n ```\n  \n+\n``````\n",
    "created_at": "2011-03-18T16:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137974",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,21 +1,13 @@
-This works:
 
 ```
-sage: Q =  CombinatorialFreeModule( QQ, [1,2,3] )
-sage: a = Q.an_element()
-sage: dumps(a)
-...
-```
-
-And this doesn't:
-
-```
-sage: Q =  CombinatorialFreeModule( QQ, sage.structure.parent.Set_PythonType(tuple) )
-sage: a = Q.an_element()
-sage: dumps(a)
----------------------------------------------------------------------------
-PicklingError                             Traceback (most recent call last)
-...
-PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed
+    sage: S = sage.structure.parent.Set_PythonType(tuple)
+    sage: dumps(S)
+    ------------------------------------------------------------
+    Traceback (most recent call last):
+      File "<ipython console>", line 1, in <module>
+      File "sage_object.pyx", line 842, in sage.structure.sage_object.dumps (sage/structure/sage_object.c:8274)
+      File "sage_object.pyx", line 217, in sage.structure.sage_object.SageObject.dumps (sage/structure/sage_object.c:2183)
+    PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed
 ```
  
+
``````




---

archive/issue_events_041530.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "rename": {
        "from": "Problem with pickle in CombinatorialFreeModule",
        "to": "Set_PythonType objects are not picklable"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10962#event-41530"
}
```



---

archive/issue_comments_137975.json:
```json
{
    "body": "<a id='comment:2'></a>\nI implement a `__reduce__` method for Set_PythonType and now it works...\n\nBest,\nVincent",
    "created_at": "2012-12-13T13:14:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137975",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
I implement a `__reduce__` method for Set_PythonType and now it works...

Best,
Vincent



---

archive/issue_comments_137976.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-01-15T12:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137976",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_137977.json:
```json
{
    "body": "Attachment [trac_10962-pickle_set_pythontype.2.patch](tarball://root/attachments/some-uuid/ticket10962/trac_10962-pickle_set_pythontype.2.patch) by @videlec created at 2013-01-17 11:22:24",
    "created_at": "2013-01-17T11:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137977",
    "user": "https://github.com/videlec"
}
```

Attachment [trac_10962-pickle_set_pythontype.2.patch](tarball://root/attachments/some-uuid/ticket10962/trac_10962-pickle_set_pythontype.2.patch) by @videlec created at 2013-01-17 11:22:24



---

archive/issue_comments_137978.json:
```json
{
    "body": "<a id='comment:4'></a>\nI undo a change which produces error (because of some metaclass buisness). I also add a method is_finite in relation with the cardinality one.\n\napply only: trac_10962-pickle_set_pythontype.2.patch",
    "created_at": "2013-01-17T11:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137978",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
I undo a change which produces error (because of some metaclass buisness). I also add a method is_finite in relation with the cardinality one.

apply only: trac_10962-pickle_set_pythontype.2.patch



---

archive/issue_comments_137979.json:
```json
{
    "body": "<a id='comment:5'></a>\nHi,\n\nI added a relatively fast check at the very begining of the __init__ method that verifies that the argument is a type or not (using the function `PyType_Check` from the C-API. It is the cause of many errors (see the log of the patchbot) and I do not know whether it is a good thing to check...\n\nSee the following [sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/8f28e2637e92e1c1).",
    "created_at": "2013-01-18T09:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137979",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
Hi,

I added a relatively fast check at the very begining of the __init__ method that verifies that the argument is a type or not (using the function `PyType_Check` from the C-API. It is the cause of many errors (see the log of the patchbot) and I do not know whether it is a good thing to check...

See the following [sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/8f28e2637e92e1c1).



---

archive/issue_comments_137980.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/10962\"",
    "created_at": "2014-12-19T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137980",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/10962"



---

archive/issue_comments_137981.json:
```json
{
    "body": "<a id='comment:6'></a>\nNew commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[18b968d](https://github.com/sagemath/sagetrac-mirror/commit/18b968d45aa8649698eae4e5e70a88f9964e0e0d)|`trac #10962: make Set_PythonType pickable`|",
    "created_at": "2014-12-19T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137981",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[18b968d](https://github.com/sagemath/sagetrac-mirror/commit/18b968d45aa8649698eae4e5e70a88f9964e0e0d)|`trac #10962: make Set_PythonType pickable`|



---

archive/issue_comments_137982.json:
```json
{
    "body": "Changing author from \"\" to \"Vincent Delecroix\"",
    "created_at": "2014-12-19T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137982",
    "user": "https://github.com/videlec"
}
```

Changing author from "" to "Vincent Delecroix"



---

archive/issue_comments_137983.json:
```json
{
    "body": "Changing commit from \"\" to \"18b968d45aa8649698eae4e5e70a88f9964e0e0d\"",
    "created_at": "2014-12-19T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137983",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "18b968d45aa8649698eae4e5e70a88f9964e0e0d"



---

archive/issue_comments_137984.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-19T17:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137984",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_137985.json:
```json
{
    "body": "<a id='comment:7'></a>\nThis is wrong, it should be `EXAMPLES:`:\n\n```\nEXAMPLES::\n\nLet us create a parent in the category of rings::\n```",
    "created_at": "2014-12-19T17:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137985",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
This is wrong, it should be `EXAMPLES:`:

```
EXAMPLES::

Let us create a parent in the category of rings::
```



---

archive/issue_comments_137986.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[97f3984](https://github.com/sagemath/sagetrac-mirror/commit/97f39849ff27767c6a99608d3a29db9b5738ae01)|`trac #10962: fix documentation`|",
    "created_at": "2014-12-19T17:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137986",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[97f3984](https://github.com/sagemath/sagetrac-mirror/commit/97f39849ff27767c6a99608d3a29db9b5738ae01)|`trac #10962: fix documentation`|



---

archive/issue_comments_137987.json:
```json
{
    "body": "Changing commit from \"18b968d45aa8649698eae4e5e70a88f9964e0e0d\" to \"97f39849ff27767c6a99608d3a29db9b5738ae01\"",
    "created_at": "2014-12-19T17:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "18b968d45aa8649698eae4e5e70a88f9964e0e0d" to "97f39849ff27767c6a99608d3a29db9b5738ae01"



---

archive/issue_comments_137988.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-12-19T17:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137988",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_137989.json:
```json
{
    "body": "<a id='comment:10'></a>\nI got a strange error from the pickle jar. Could anyone perform the test?\n\n```\nsage -t --long structure/sage_object.pyx\n**********************************************************************\nFile \"structure/sage_object.pyx\", line 1431, in sage.structure.sage_object.unpickle_all\nFailed example:\n    sage.structure.sage_object.unpickle_all()  # (4s on sage.math, 2011)\nExpected:\n    doctest:... DeprecationWarning: ...\n    See http://trac.sagemath.org/... for details.\n    Successfully unpickled ... objects.\n    Failed to unpickle 0 objects.\nGot:\n    doctest:1: DeprecationWarning: OrderedAlphabet is deprecated; use Alphabet instead.\n    See http://trac.sagemath.org/8920 for details.\n    doctest:850: DeprecationWarning: This class is replaced by Matrix_modn_dense_float/Matrix_modn_dense_double.\n    See http://trac.sagemath.org/4260 for details.\n     * unpickle failure: load('/home/vincent/.sage/temp/mangouste/23352/dir_D94KcT//pickle_jar/_class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj')\n    doctest:1: DeprecationWarning: gen_py.pari is deprecated, use sage.libs.pari.all.pari instead\n    See http://trac.sagemath.org/17451 for details.\n    doctest:632: DeprecationWarning: The \"pari_mod\" finite field implementation is deprecated\n    See http://trac.sagemath.org/17297 for details.\n    Failed:\n    _class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj\n    ----------------------------------------------------------------------\n    ** This error is probably due to an old pickle failing to unpickle.\n    ** See sage.structure.sage_object.register_unpickle_override for\n    ** how to override the default unpickling methods for (old) pickles.\n    ** NOTE: pickles should never be removed from the pickle_jar! \n    ----------------------------------------------------------------------\n    Successfully unpickled 585 objects.\n    Failed to unpickle 1 objects.\n**********************************************************************\nFile \"structure/sage_object.pyx\", line 1439, in sage.structure.sage_object.unpickle_all\nFailed example:\n    sage.structure.sage_object.unpickle_all()\nExpected:\n    Successfully unpickled ... objects.\n    Failed to unpickle 0 objects.\nGot:\n     * unpickle failure: load('/home/vincent/.sage/temp/mangouste/23352/dir_VbqHGc//pickle_jar/_class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj')\n    Failed:\n    _class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj\n    ----------------------------------------------------------------------\n    ** This error is probably due to an old pickle failing to unpickle.\n    ** See sage.structure.sage_object.register_unpickle_override for\n    ** how to override the default unpickling methods for (old) pickles.\n    ** NOTE: pickles should never be removed from the pickle_jar! \n    ----------------------------------------------------------------------\n    Successfully unpickled 585 objects.\n    Failed to unpickle 1 objects.\n**********************************************************************\n```",
    "created_at": "2014-12-19T17:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137989",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>
I got a strange error from the pickle jar. Could anyone perform the test?

```
sage -t --long structure/sage_object.pyx
**********************************************************************
File "structure/sage_object.pyx", line 1431, in sage.structure.sage_object.unpickle_all
Failed example:
    sage.structure.sage_object.unpickle_all()  # (4s on sage.math, 2011)
Expected:
    doctest:... DeprecationWarning: ...
    See http://trac.sagemath.org/... for details.
    Successfully unpickled ... objects.
    Failed to unpickle 0 objects.
Got:
    doctest:1: DeprecationWarning: OrderedAlphabet is deprecated; use Alphabet instead.
    See http://trac.sagemath.org/8920 for details.
    doctest:850: DeprecationWarning: This class is replaced by Matrix_modn_dense_float/Matrix_modn_dense_double.
    See http://trac.sagemath.org/4260 for details.
     * unpickle failure: load('/home/vincent/.sage/temp/mangouste/23352/dir_D94KcT//pickle_jar/_class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj')
    doctest:1: DeprecationWarning: gen_py.pari is deprecated, use sage.libs.pari.all.pari instead
    See http://trac.sagemath.org/17451 for details.
    doctest:632: DeprecationWarning: The "pari_mod" finite field implementation is deprecated
    See http://trac.sagemath.org/17297 for details.
    Failed:
    _class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj
    ----------------------------------------------------------------------
    ** This error is probably due to an old pickle failing to unpickle.
    ** See sage.structure.sage_object.register_unpickle_override for
    ** how to override the default unpickling methods for (old) pickles.
    ** NOTE: pickles should never be removed from the pickle_jar! 
    ----------------------------------------------------------------------
    Successfully unpickled 585 objects.
    Failed to unpickle 1 objects.
**********************************************************************
File "structure/sage_object.pyx", line 1439, in sage.structure.sage_object.unpickle_all
Failed example:
    sage.structure.sage_object.unpickle_all()
Expected:
    Successfully unpickled ... objects.
    Failed to unpickle 0 objects.
Got:
     * unpickle failure: load('/home/vincent/.sage/temp/mangouste/23352/dir_VbqHGc//pickle_jar/_class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj')
    Failed:
    _class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj
    ----------------------------------------------------------------------
    ** This error is probably due to an old pickle failing to unpickle.
    ** See sage.structure.sage_object.register_unpickle_override for
    ** how to override the default unpickling methods for (old) pickles.
    ** NOTE: pickles should never be removed from the pickle_jar! 
    ----------------------------------------------------------------------
    Successfully unpickled 585 objects.
    Failed to unpickle 1 objects.
**********************************************************************
```



---

archive/issue_comments_137990.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/10962\" to \"u/jdemeyer/ticket/10962\"",
    "created_at": "2014-12-19T18:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137990",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/vdelecroix/10962" to "u/jdemeyer/ticket/10962"



---

archive/issue_comments_137991.json:
```json
{
    "body": "<a id='comment:12'></a>\nI confirm the unpickling error, it is due to\n\n```\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-d62ad2672fb4> in <module>()\n----> 1 load('/home/jdemeyer/.sage/temp/tamiyo/6215/dir_LJVs2X//pickle_jar/_class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj')\n\n/usr/local/src/sage-config/src/sage/structure/sage_object.pyx in sage.structure.sage_object.load (build/cythonized/sage/structure/sage_object.c:11233)()\n    945 \n    946     ## Load file by absolute filename\n--> 947     X = loads(open(filename).read(), compress=compress)\n    948     try:\n    949         X._default_filename = os.path.abspath(filename)\n\n/usr/local/src/sage-config/src/sage/structure/sage_object.pyx in sage.structure.sage_object.loads (build/cythonized/sage/structure/sage_object.c:13238)()\n   1319     unpickler.find_global = unpickle_global\n   1320 \n-> 1321     return unpickler.load()\n   1322 \n   1323 \n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/groups/matrix_gps/pickling_overrides.pyc in __setstate__(self, state)\n     36         degree = state['_MatrixGroup_gap__n']\n     37         from sage.libs.all import libgap\n---> 38         libgap_group = libgap.Group(libgap(matrix_gens))\n     39         self.__init__(degree, ring, libgap_group)\n     40 \n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9585)()\n   1102             mor = <map.Map> self._convert_from_hash.get(R)\n   1103         except KeyError:\n-> 1104             mor = <map.Map> self._internal_convert_map_from(R)\n   1105 \n   1106         if mor is not None:\n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent._internal_convert_map_from (build/cythonized/sage/structure/parent.c:19460)()\n   2581             return self._convert_from_hash.get(S)\n   2582         except KeyError:\n-> 2583             mor = self.discover_convert_map_from(S)\n   2584             # Before trac #14711, the morphism has been\n   2585             # put both into _convert_from_list and into\n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.discover_convert_map_from (build/cythonized/sage/structure/parent.c:20064)()\n   2624             from sage.structure.coerce_maps import ListMorphism\n   2625             if isinstance(S, Sequences):\n-> 2626                 return ListMorphism(S, self.convert_map_from(list))\n   2627 \n   2628         mor = self._generic_convert_map(S)\n\n/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.ListMorphism.__init__ (build/cythonized/sage/structure/coerce_maps.c:8911)()\n    529     def __init__(self, domain, Map real_morphism):\n    530         if not PY_TYPE_CHECK(domain, Parent):\n--> 531             domain = Set_PythonType(domain)\n    532         Map.__init__(self, domain, real_morphism.codomain())\n    533         self._coerce_cost = real_morphism._coerce_cost + 3\n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24290)()\n   2990 cdef _type_set_cache = {}\n   2991 \n-> 2992 cpdef Parent Set_PythonType(theType):\n   2993     \"\"\"\n   2994     Return the (unique) Parent that represents the set of Python objects\n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24199)()\n   3021         return _type_set_cache[theType]\n   3022     except KeyError:\n-> 3023         _type_set_cache[theType] = theSet = Set_PythonType_class(theType)\n   3024         return theSet\n   3025 \n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Set_PythonType_class.__init__ (build/cythonized/sage/structure/parent.c:24417)()\n   3055         \"\"\"\n   3056         if not isinstance(theType, type):\n-> 3057             raise TypeError(\"must be intialized with a type, not %r\" % theType)\n   3058         Set_generic.__init__(self, element_constructor=theType, category=Sets())\n   3059         self._type = theType\n\nTypeError: must be intialized with a type, not Category of sequences in Full MatrixSpace of 2 by 2 dense matrices over Finite Field of size 3\n```\n\n---\nNew commits:\n|                                                                                                                                          |                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|\n|[2908e57](https://github.com/sagemath/sagetrac-mirror/commit/2908e5797bb558895695abd5443ad718cc14d5fb)|`Remove useless C/API calls`|",
    "created_at": "2014-12-19T18:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137991",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
I confirm the unpickling error, it is due to

```
TypeError                                 Traceback (most recent call last)
<ipython-input-3-d62ad2672fb4> in <module>()
----> 1 load('/home/jdemeyer/.sage/temp/tamiyo/6215/dir_LJVs2X//pickle_jar/_class__sage_groups_matrix_gps_matrix_group_element_MatrixGroupElement__.sobj')

/usr/local/src/sage-config/src/sage/structure/sage_object.pyx in sage.structure.sage_object.load (build/cythonized/sage/structure/sage_object.c:11233)()
    945 
    946     ## Load file by absolute filename
--> 947     X = loads(open(filename).read(), compress=compress)
    948     try:
    949         X._default_filename = os.path.abspath(filename)

/usr/local/src/sage-config/src/sage/structure/sage_object.pyx in sage.structure.sage_object.loads (build/cythonized/sage/structure/sage_object.c:13238)()
   1319     unpickler.find_global = unpickle_global
   1320 
-> 1321     return unpickler.load()
   1322 
   1323 

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/groups/matrix_gps/pickling_overrides.pyc in __setstate__(self, state)
     36         degree = state['_MatrixGroup_gap__n']
     37         from sage.libs.all import libgap
---> 38         libgap_group = libgap.Group(libgap(matrix_gens))
     39         self.__init__(degree, ring, libgap_group)
     40 

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9585)()
   1102             mor = <map.Map> self._convert_from_hash.get(R)
   1103         except KeyError:
-> 1104             mor = <map.Map> self._internal_convert_map_from(R)
   1105 
   1106         if mor is not None:

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent._internal_convert_map_from (build/cythonized/sage/structure/parent.c:19460)()
   2581             return self._convert_from_hash.get(S)
   2582         except KeyError:
-> 2583             mor = self.discover_convert_map_from(S)
   2584             # Before trac #14711, the morphism has been
   2585             # put both into _convert_from_list and into

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.discover_convert_map_from (build/cythonized/sage/structure/parent.c:20064)()
   2624             from sage.structure.coerce_maps import ListMorphism
   2625             if isinstance(S, Sequences):
-> 2626                 return ListMorphism(S, self.convert_map_from(list))
   2627 
   2628         mor = self._generic_convert_map(S)

/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.ListMorphism.__init__ (build/cythonized/sage/structure/coerce_maps.c:8911)()
    529     def __init__(self, domain, Map real_morphism):
    530         if not PY_TYPE_CHECK(domain, Parent):
--> 531             domain = Set_PythonType(domain)
    532         Map.__init__(self, domain, real_morphism.codomain())
    533         self._coerce_cost = real_morphism._coerce_cost + 3

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24290)()
   2990 cdef _type_set_cache = {}
   2991 
-> 2992 cpdef Parent Set_PythonType(theType):
   2993     """
   2994     Return the (unique) Parent that represents the set of Python objects

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24199)()
   3021         return _type_set_cache[theType]
   3022     except KeyError:
-> 3023         _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
   3024         return theSet
   3025 

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Set_PythonType_class.__init__ (build/cythonized/sage/structure/parent.c:24417)()
   3055         """
   3056         if not isinstance(theType, type):
-> 3057             raise TypeError("must be intialized with a type, not %r" % theType)
   3058         Set_generic.__init__(self, element_constructor=theType, category=Sets())
   3059         self._type = theType

TypeError: must be intialized with a type, not Category of sequences in Full MatrixSpace of 2 by 2 dense matrices over Finite Field of size 3
```

---
New commits:
|                                                                                                                                          |                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
|[2908e57](https://github.com/sagemath/sagetrac-mirror/commit/2908e5797bb558895695abd5443ad718cc14d5fb)|`Remove useless C/API calls`|



---

archive/issue_comments_137992.json:
```json
{
    "body": "Changing commit from \"97f39849ff27767c6a99608d3a29db9b5738ae01\" to \"2908e5797bb558895695abd5443ad718cc14d5fb\"",
    "created_at": "2014-12-19T18:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137992",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "97f39849ff27767c6a99608d3a29db9b5738ae01" to "2908e5797bb558895695abd5443ad718cc14d5fb"



---

archive/issue_comments_137993.json:
```json
{
    "body": "<a id='comment:13'></a>\nQuestion: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?",
    "created_at": "2014-12-19T18:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137993",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?



---

archive/issue_comments_137994.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-19T19:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137994",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_041531.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-19T19:45:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10962#event-41531"
}
```



---

archive/issue_comments_137995.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [jdemeyer](#comment%3A13):\n> Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?\n\n\nNo. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...",
    "created_at": "2014-12-20T07:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137995",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
Replying to [jdemeyer](#comment%3A13):
> Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?


No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...



---

archive/issue_comments_137996.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/10962\" to \"u/vdelecroix/10962\"",
    "created_at": "2014-12-20T07:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137996",
    "user": "https://github.com/videlec"
}
```

Changing branch from "u/jdemeyer/ticket/10962" to "u/vdelecroix/10962"



---

archive/issue_comments_137997.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-12-20T07:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137997",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_137998.json:
```json
{
    "body": "Changing commit from \"2908e5797bb558895695abd5443ad718cc14d5fb\" to \"da81792004986e23a3dee4c92b0cc229b64741f2\"",
    "created_at": "2014-12-20T07:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137998",
    "user": "https://github.com/videlec"
}
```

Changing commit from "2908e5797bb558895695abd5443ad718cc14d5fb" to "da81792004986e23a3dee4c92b0cc229b64741f2"



---

archive/issue_comments_137999.json:
```json
{
    "body": "<a id='comment:16'></a>\nNew commits:\n|                                                                                                                                          |                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[da81792](https://github.com/sagemath/sagetrac-mirror/commit/da81792004986e23a3dee4c92b0cc229b64741f2)|`trac #10962: fix unpickle (Sequences is not a parent)`|",
    "created_at": "2014-12-20T07:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-137999",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>
New commits:
|                                                                                                                                          |                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[da81792](https://github.com/sagemath/sagetrac-mirror/commit/da81792004986e23a3dee4c92b0cc229b64741f2)|`trac #10962: fix unpickle (Sequences is not a parent)`|



---

archive/issue_comments_138000.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/10962\" to \"u/jdemeyer/ticket/10962\"",
    "created_at": "2014-12-20T08:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138000",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/vdelecroix/10962" to "u/jdemeyer/ticket/10962"



---

archive/issue_comments_138001.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2014-12-20T08:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138001",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_138002.json:
```json
{
    "body": "<a id='comment:18'></a>\nI added one extra commit to simplify the code and remove a compiler warning for `parent.pyx` (which is not your fault, but which should be fixed anyway).\n\n---\nNew commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[4b5c373](https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27)|`Remove useless C/API calls; improve error message`|",
    "created_at": "2014-12-20T08:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138002",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
I added one extra commit to simplify the code and remove a compiler warning for `parent.pyx` (which is not your fault, but which should be fixed anyway).

---
New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[4b5c373](https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27)|`Remove useless C/API calls; improve error message`|



---

archive/issue_comments_138003.json:
```json
{
    "body": "Changing commit from \"da81792004986e23a3dee4c92b0cc229b64741f2\" to \"4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27\"",
    "created_at": "2014-12-20T08:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138003",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "da81792004986e23a3dee4c92b0cc229b64741f2" to "4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27"



---

archive/issue_comments_138004.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-20T10:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138004",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_138005.json:
```json
{
    "body": "<a id='comment:19'></a>\n\n```\nsage -t --long src/sage/symbolic/maxima_wrapper.py\n**********************************************************************\nFile \"src/sage/symbolic/maxima_wrapper.py\", line 113, in sage.symbolic.maxima_wrapper.MaximaWrapper._symbolic_\nFailed example:\n    SR(u) is t # indirect doctest\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.maxima_wrapper.MaximaWrapper._symbolic_[2]>\", line 1, in <module>\n        SR(u) is t # indirect doctest\n      File \"sage/structure/parent.pyx\", line 1104, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9585)\n        mor = <map.Map> self._internal_convert_map_from(R)\n      File \"sage/structure/parent.pyx\", line 2583, in sage.structure.parent.Parent._internal_convert_map_from (build/cythonized/sage/structure/parent.c:19460)\n        mor = self.discover_convert_map_from(S)\n      File \"sage/structure/parent.pyx\", line 2632, in sage.structure.parent.Parent.discover_convert_map_from (build/cythonized/sage/structure/parent.c:20119)\n        mor = self._generic_convert_map(S)\n      File \"sage/structure/parent_old.pyx\", line 534, in sage.structure.parent_old.Parent._generic_convert_map (build/cythonized/sage/structure/parent_old.c:8211)\n        return parent.Parent._generic_convert_map(self, S)\n      File \"sage/structure/parent.pyx\", line 2142, in sage.structure.parent.Parent._generic_convert_map (build/cythonized/sage/structure/parent.c:16530)\n        return coerce_maps.DefaultConvertMap_unique(S, self)\n      File \"sage/structure/coerce_maps.pyx\", line 39, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (build/cythonized/sage/structure/coerce_maps.c:2712)\n        domain = Set_PythonType(domain)\n      File \"sage/structure/parent.pyx\", line 2996, in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24328)\n        cpdef Parent Set_PythonType(theType):\n      File \"sage/structure/parent.pyx\", line 3027, in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24237)\n        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)\n      File \"sage/structure/parent.pyx\", line 3061, in sage.structure.parent.Set_PythonType_class.__init__ (build/cythonized/sage/structure/parent.c:24455)\n        raise TypeError(\"must be intialized with a type, not %r\" % theType)\n    TypeError: must be intialized with a type, not parent(log(sqrt(2) + 1) + log(sqrt(2) - 1))\n**********************************************************************\n```",
    "created_at": "2014-12-20T10:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138005",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>

```
sage -t --long src/sage/symbolic/maxima_wrapper.py
**********************************************************************
File "src/sage/symbolic/maxima_wrapper.py", line 113, in sage.symbolic.maxima_wrapper.MaximaWrapper._symbolic_
Failed example:
    SR(u) is t # indirect doctest
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.maxima_wrapper.MaximaWrapper._symbolic_[2]>", line 1, in <module>
        SR(u) is t # indirect doctest
      File "sage/structure/parent.pyx", line 1104, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9585)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2583, in sage.structure.parent.Parent._internal_convert_map_from (build/cythonized/sage/structure/parent.c:19460)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2632, in sage.structure.parent.Parent.discover_convert_map_from (build/cythonized/sage/structure/parent.c:20119)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent_old.pyx", line 534, in sage.structure.parent_old.Parent._generic_convert_map (build/cythonized/sage/structure/parent_old.c:8211)
        return parent.Parent._generic_convert_map(self, S)
      File "sage/structure/parent.pyx", line 2142, in sage.structure.parent.Parent._generic_convert_map (build/cythonized/sage/structure/parent.c:16530)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 39, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (build/cythonized/sage/structure/coerce_maps.c:2712)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 2996, in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24328)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3027, in sage.structure.parent.Set_PythonType (build/cythonized/sage/structure/parent.c:24237)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3061, in sage.structure.parent.Set_PythonType_class.__init__ (build/cythonized/sage/structure/parent.c:24455)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not parent(log(sqrt(2) + 1) + log(sqrt(2) - 1))
**********************************************************************
```



---

archive/issue_comments_138006.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[edf526e](https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7)|`Define a parent() method for MaximaWrapper objects`|",
    "created_at": "2014-12-20T11:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138006",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[edf526e](https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7)|`Define a parent() method for MaximaWrapper objects`|



---

archive/issue_comments_138007.json:
```json
{
    "body": "Changing commit from \"4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27\" to \"edf526e2a9b181c058620e1b42b1b378c37d99a7\"",
    "created_at": "2014-12-20T11:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138007",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27" to "edf526e2a9b181c058620e1b42b1b378c37d99a7"



---

archive/issue_comments_138008.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-12-20T11:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138008",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_138009.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [vdelecroix](#comment%3A15):\n> Replying to [jdemeyer](#comment%3A13):\n> > Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?\n\n> \n> No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...\n\n\nThe category corresponding to `Parent` is `Sets`. Now, why is there both `Parent` and `Sets`? The latter is an abstract class, while the former is a concrete implementation (and currently the only concrete base implementation; but we could imagine having others). Of course, a lot of the current features of `Parent` really should be moved up in `Sets` or in other categories. Some just need to be taken care of (handling some backward compatibility issues). Some are more intrinsically difficult\nbecause of the lack of multiple inheritance in Cython; that's analog to the `Ring` versus `Rings`\nsituation.",
    "created_at": "2014-12-20T11:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138009",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:22'></a>
Replying to [vdelecroix](#comment%3A15):
> Replying to [jdemeyer](#comment%3A13):
> > Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?

> 
> No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...


The category corresponding to `Parent` is `Sets`. Now, why is there both `Parent` and `Sets`? The latter is an abstract class, while the former is a concrete implementation (and currently the only concrete base implementation; but we could imagine having others). Of course, a lot of the current features of `Parent` really should be moved up in `Sets` or in other categories. Some just need to be taken care of (handling some backward compatibility issues). Some are more intrinsically difficult
because of the lack of multiple inheritance in Cython; that's analog to the `Ring` versus `Rings`
situation.



---

archive/issue_comments_138010.json:
```json
{
    "body": "<a id='comment:23'></a>\nThis finally passes all doctests. We just need somebody to review my last two commits:\n* [https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27](https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27)\n* [https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7](https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7)",
    "created_at": "2014-12-20T12:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138010",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
This finally passes all doctests. We just need somebody to review my last two commits:
* [https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27](https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27)
* [https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7](https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7)



---

archive/issue_comments_138011.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [nthiery](#comment%3A22):\n> Replying to [vdelecroix](#comment%3A15):\n> > Replying to [jdemeyer](#comment%3A13):\n> > > Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?\n\n> > \n> > No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...\n  \n> \n> The category corresponding to `Parent` is `Sets`. Now, why is there both `Parent` and `Sets`? The latter is an abstract class, while the former is a concrete implementation (and currently the only concrete base implementation; but we could imagine having others). Of course, a lot of the current features of `Parent` really should be moved up in `Sets` or in other categories. Some just need to be taken care of (handling some backward compatibility issues). Some are more intrinsically difficult\n> because of the lack of multiple inheritance in Cython; that's analog to the `Ring` versus `Rings`\n> situation.\n\n\nThanks Nicolas. But I do not understand why it is an answer to my question: \"why Posets and Sequences are categories and not Parent?\" As far as I understand, to declare something to have a category it needs to inherit from Parent (via `Parent.__init__(category=XYZ)`). So I do not see how to avoid `Parent`  by \"having others\".\nThe issue of `Ring` versus `Rings` has nothing to do with my question, or I missed something.\n\nVincent",
    "created_at": "2014-12-20T20:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138011",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>
Replying to [nthiery](#comment%3A22):
> Replying to [vdelecroix](#comment%3A15):
> > Replying to [jdemeyer](#comment%3A13):
> > > Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?

> > 
> > No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...
  
> 
> The category corresponding to `Parent` is `Sets`. Now, why is there both `Parent` and `Sets`? The latter is an abstract class, while the former is a concrete implementation (and currently the only concrete base implementation; but we could imagine having others). Of course, a lot of the current features of `Parent` really should be moved up in `Sets` or in other categories. Some just need to be taken care of (handling some backward compatibility issues). Some are more intrinsically difficult
> because of the lack of multiple inheritance in Cython; that's analog to the `Ring` versus `Rings`
> situation.


Thanks Nicolas. But I do not understand why it is an answer to my question: "why Posets and Sequences are categories and not Parent?" As far as I understand, to declare something to have a category it needs to inherit from Parent (via `Parent.__init__(category=XYZ)`). So I do not see how to avoid `Parent`  by "having others".
The issue of `Ring` versus `Rings` has nothing to do with my question, or I missed something.

Vincent



---

archive/issue_comments_138012.json:
```json
{
    "body": "Changing author from \"Vincent Delecroix\" to \"Vincent Delecroix, Jeroen Demeyer\"",
    "created_at": "2014-12-20T21:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138012",
    "user": "https://github.com/videlec"
}
```

Changing author from "Vincent Delecroix" to "Vincent Delecroix, Jeroen Demeyer"



---

archive/issue_comments_138013.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-12-20T21:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138013",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_138014.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [jdemeyer](#comment%3A23):\n> This finally passes all doctests. We just need somebody to review my last two commits:\n> * [https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27](https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27)\n> * [https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7](https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7)\n\n\nI am fine with the first one. But the result of `.parent()` should be a parent isn't it? Why not\n\n```\ndef parent(self):\n    return Set_PythonType(type(self))\n```\n\nOn the other hand, the `MaximaWrapper` does not inherit from `Element` which is perfectly fine. I am worried that we need this method. The bug for me is the following behavior\n\n```\nsage: parent(sin(1).maxima_methods())\nparent(sin(1))\n```\nwhich should just behave like\n\n```\nsage: parent(int(1))\n<type 'int'>\n```\n(which is also strange but perfectly fine if uniform).\n\nThe reason is that there is a too permissive `__getattr__` in `MaximaWrapper` which never raises `AttributeError`. I would really prefer that:\n- either we move your solution at the level of `SageObject`\n- or we hack `__getattr__` of `MaximaWrapper`\n\nVincent",
    "created_at": "2014-12-20T21:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138014",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
Replying to [jdemeyer](#comment%3A23):
> This finally passes all doctests. We just need somebody to review my last two commits:
> * [https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27](https://github.com/sagemath/sagetrac-mirror/commit/4b5c3732a910b99b8f43b5b4eb0da13c8f1c7f27)
> * [https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7](https://github.com/sagemath/sagetrac-mirror/commit/edf526e2a9b181c058620e1b42b1b378c37d99a7)


I am fine with the first one. But the result of `.parent()` should be a parent isn't it? Why not

```
def parent(self):
    return Set_PythonType(type(self))
```

On the other hand, the `MaximaWrapper` does not inherit from `Element` which is perfectly fine. I am worried that we need this method. The bug for me is the following behavior

```
sage: parent(sin(1).maxima_methods())
parent(sin(1))
```
which should just behave like

```
sage: parent(int(1))
<type 'int'>
```
(which is also strange but perfectly fine if uniform).

The reason is that there is a too permissive `__getattr__` in `MaximaWrapper` which never raises `AttributeError`. I would really prefer that:
- either we move your solution at the level of `SageObject`
- or we hack `__getattr__` of `MaximaWrapper`

Vincent



---

archive/issue_comments_138015.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [vdelecroix](#comment%3A24):\n> Replying to [nthiery](#comment%3A22):\n> > Replying to [vdelecroix](#comment%3A15):\n> > > Replying to [jdemeyer](#comment%3A13):\n> > > > Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?\n\n> > > \n> > > No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...\n  \n> > \n> > The category corresponding to `Parent` is `Sets`. Now, why is there both `Parent` and `Sets`? The latter is an abstract class, while the former is a concrete implementation (and currently the only concrete base implementation; but we could imagine having others). Of course, a lot of the current features of `Parent` really should be moved up in `Sets` or in other categories. Some just need to be taken care of (handling some backward compatibility issues). Some are more intrinsically difficult\n> > because of the lack of multiple inheritance in Cython; that's analog to the `Ring` versus `Rings`\n> > situation.\n\n> \n> Thanks Nicolas. But I do not understand why it is an answer to my question: \"why Posets and Sequences are categories and not Parent?\" As far as I understand, to declare something to have a category it needs to inherit from Parent (via `Parent.__init__(category=XYZ)`). So I do not see how to avoid `Parent`  by \"having others\".\n> The issue of `Ring` versus `Rings` has nothing to do with my question, or I missed something.\n\n\nHmm I am not sure I understand your question then. Can you rephrase it?\n\nJust a quick note for now: to have a category, you need to be a CategoryObject (surprise surprise ...).",
    "created_at": "2014-12-20T21:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138015",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:26'></a>
Replying to [vdelecroix](#comment%3A24):
> Replying to [nthiery](#comment%3A22):
> > Replying to [vdelecroix](#comment%3A15):
> > > Replying to [jdemeyer](#comment%3A13):
> > > > Question: would it be valid to use `Set_PythonType()` on a `Category` instead of a `type`?

> > > 
> > > No. By the way I do not understand why `Posets`  and `Sequences` are categories and not `Parent`...
  
> > 
> > The category corresponding to `Parent` is `Sets`. Now, why is there both `Parent` and `Sets`? The latter is an abstract class, while the former is a concrete implementation (and currently the only concrete base implementation; but we could imagine having others). Of course, a lot of the current features of `Parent` really should be moved up in `Sets` or in other categories. Some just need to be taken care of (handling some backward compatibility issues). Some are more intrinsically difficult
> > because of the lack of multiple inheritance in Cython; that's analog to the `Ring` versus `Rings`
> > situation.

> 
> Thanks Nicolas. But I do not understand why it is an answer to my question: "why Posets and Sequences are categories and not Parent?" As far as I understand, to declare something to have a category it needs to inherit from Parent (via `Parent.__init__(category=XYZ)`). So I do not see how to avoid `Parent`  by "having others".
> The issue of `Ring` versus `Rings` has nothing to do with my question, or I missed something.


Hmm I am not sure I understand your question then. Can you rephrase it?

Just a quick note for now: to have a category, you need to be a CategoryObject (surprise surprise ...).



---

archive/issue_comments_138016.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [vdelecroix](#comment%3A25):\n> But the result of `.parent()` should be a parent isn't it?\n\nIt doesn't have to be. For things which don't have a parent, it's accepted to return a `type` instead. After all, the global `parent(x)` function returns `type(x)` if x has no parent.",
    "created_at": "2014-12-20T22:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138016",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Replying to [vdelecroix](#comment%3A25):
> But the result of `.parent()` should be a parent isn't it?

It doesn't have to be. For things which don't have a parent, it's accepted to return a `type` instead. After all, the global `parent(x)` function returns `type(x)` if x has no parent.



---

archive/issue_comments_138017.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[f28f02a](https://github.com/sagemath/sagetrac-mirror/commit/f28f02aeb6008daa88a267dc31d31963664c17dc)|`Define parent() to be type() for SageObject`|",
    "created_at": "2014-12-21T09:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138017",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[f28f02a](https://github.com/sagemath/sagetrac-mirror/commit/f28f02aeb6008daa88a267dc31d31963664c17dc)|`Define parent() to be type() for SageObject`|



---

archive/issue_comments_138018.json:
```json
{
    "body": "Changing commit from \"edf526e2a9b181c058620e1b42b1b378c37d99a7\" to \"f28f02aeb6008daa88a267dc31d31963664c17dc\"",
    "created_at": "2014-12-21T09:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138018",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "edf526e2a9b181c058620e1b42b1b378c37d99a7" to "f28f02aeb6008daa88a267dc31d31963664c17dc"



---

archive/issue_comments_138019.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [vdelecroix](#comment%3A25):\n>  - either we move your solution at the level of `SageObject`\n \nDone! This commit *replaces* the last one.",
    "created_at": "2014-12-21T09:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138019",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
Replying to [vdelecroix](#comment%3A25):
>  - either we move your solution at the level of `SageObject`
 
Done! This commit *replaces* the last one.



---

archive/issue_comments_138020.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-12-21T09:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138020",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_138021.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [nthiery](#comment%3A26):\n> Hmm I am not sure I understand your question then. Can you rephrase it?\n\n\nWhy `Posets` and `Sequences` do not inherit from `CategoryObject`?\n\nVincent",
    "created_at": "2014-12-21T11:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138021",
    "user": "https://github.com/videlec"
}
```

<a id='comment:30'></a>
Replying to [nthiery](#comment%3A26):
> Hmm I am not sure I understand your question then. Can you rephrase it?


Why `Posets` and `Sequences` do not inherit from `CategoryObject`?

Vincent



---

archive/issue_comments_138022.json:
```json
{
    "body": "<a id='comment:31'></a>\nAll right. Thanks.",
    "created_at": "2014-12-21T11:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138022",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>
All right. Thanks.



---

archive/issue_comments_138023.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-12-21T11:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138023",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_138024.json:
```json
{
    "body": "Changing reviewer from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Vincent Delecroix\"",
    "created_at": "2014-12-21T11:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138024",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "Jeroen Demeyer" to "Jeroen Demeyer, Vincent Delecroix"



---

archive/issue_comments_138025.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-01-02T15:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138025",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_041532.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-02T15:46:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10962#event-41532"
}
```



---

archive/issue_comments_138026.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/10962\" to \"f28f02aeb6008daa88a267dc31d31963664c17dc\"",
    "created_at": "2015-01-02T15:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10962#issuecomment-138026",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/ticket/10962" to "f28f02aeb6008daa88a267dc31d31963664c17dc"
