# Issue 10491: Dump environment before building

archive/issues_010438.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-GeorgSWeber"
    ],
    "body": "\n\nKeywords: **scripts install**\n\nComponent: **scripts**\n\nAuthor: **Jeroen Demeyer, Leif Leonhardy**\n\nReviewer: **Volker Braun**\n\nMerged: **sage-4.6.1.rc1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10491_\n\n",
    "closed_at": "2011-01-05T08:20:02Z",
    "created_at": "2010-12-18T09:48:41Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Dump environment before building",
    "type": "issue",
    "updated_at": "2011-01-05T08:20:02Z",
    "url": "https://github.com/sagemath/sage/issues/10491",
    "user": "https://github.com/jdemeyer"
}
```


Keywords: **scripts install**

Component: **scripts**

Author: **Jeroen Demeyer, Leif Leonhardy**

Reviewer: **Volker Braun**

Merged: **sage-4.6.1.rc1**

_Issue created by migration from https://trac.sagemath.org/ticket/10491_





---

archive/issue_events_138251.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T09:48:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "milestone_number": null,
    "milestone_title": "sage-4.6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138251"
}
```



---

archive/issue_events_138252.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T09:48:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138252"
}
```



---

archive/issue_events_138253.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T09:48:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138253"
}
```



---

archive/issue_events_138254.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2010-12-18T09:48:41Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138254"
}
```



---

archive/issue_events_138255.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T09:49:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138255"
}
```



---

archive/issue_events_138256.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T09:49:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138256"
}
```



---

archive/issue_comments_098625.json:
```json
{
    "body": "SCRIPTS",
    "created_at": "2010-12-18T09:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98625",
    "user": "https://github.com/jdemeyer"
}
```

SCRIPTS



---

archive/issue_events_138257.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T16:38:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138257"
}
```



---

archive/issue_events_138258.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-18T16:38:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20scripts",
    "label_color": "000080",
    "label_name": "c: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138258"
}
```



---

archive/issue_comments_098626.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[10491_install_dump_env.patch.gz](https://github.com/sagemath/sage/files/ticket10491/10491_install_dump_env.patch.gz)**",
    "created_at": "2010-12-18T16:38:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98626",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[10491_install_dump_env.patch.gz](https://github.com/sagemath/sage/files/ticket10491/10491_install_dump_env.patch.gz)**



---

archive/issue_comments_098627.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nLooks good!",
    "created_at": "2010-12-24T18:59:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98627",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

Looks good!



---

archive/issue_comments_098628.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2010-12-24T18:59:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98628",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_events_138259.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-24T18:59:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138259"
}
```



---

archive/issue_events_138260.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-24T18:59:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138260"
}
```



---

archive/issue_comments_098629.json:
```json
{
    "body": "Merged: **sage-4.6.1.rc0**",
    "created_at": "2010-12-24T20:01:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98629",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.6.1.rc0**



---

archive/issue_events_138261.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-24T20:01:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138261"
}
```



---

archive/issue_events_138262.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-24T20:01:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138262"
}
```



---

archive/issue_comments_098630.json:
```json
{
    "body": "Work Issues: **Don't always dump the whole environment.**",
    "created_at": "2010-12-27T01:09:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98630",
    "user": "https://github.com/nexttime"
}
```

Work Issues: **Don't always dump the whole environment.**



---

archive/issue_comments_098631.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIMHO **needs work**.\n\nIt's totally odd to dump the whole environment whenever `make something` is run, where `something` includes `doc`, `ptestlong` and most of all other targets.\n\nI would\n* make the output depend on some environment variable (*not* `SAGE_DEBUG` ;-) , but perhaps `SAGE_DEBUG_BUILD` to be also used elsewhere),\n* limit the output to \"relevant\" variables; I e.g. personally use\n\n```sh\nprintenv | egrep \"SAGE|MAKE|CC|CXX|FLAG|LC|TMP|TEMP\" | sort\n```\n (which you would certainly extend I think),\n* use `printenv`, the shell built-in, instead of `env`.\n\n\nSorry, had some \"Sage-free Days\"...",
    "created_at": "2010-12-27T01:09:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98631",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

IMHO **needs work**.

It's totally odd to dump the whole environment whenever `make something` is run, where `something` includes `doc`, `ptestlong` and most of all other targets.

I would
* make the output depend on some environment variable (*not* `SAGE_DEBUG` ;-) , but perhaps `SAGE_DEBUG_BUILD` to be also used elsewhere),
* limit the output to "relevant" variables; I e.g. personally use

```sh
printenv | egrep "SAGE|MAKE|CC|CXX|FLAG|LC|TMP|TEMP" | sort
```
 (which you would certainly extend I think),
* use `printenv`, the shell built-in, instead of `env`.


Sorry, had some "Sage-free Days"...



---

archive/issue_comments_098632.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou could also do (one of or some other combination of) the following:\n\n```diff\n--- Makefile.orig\t2010-12-24 13:39:58.000000000 +0100\n+++ Makefile\t2010-12-27 02:38:20.000000000 +0100\n@@ -43,7 +43,7 @@\n #\ttest -x $@ # or make it executable if it exists; sanity check only anyway\n \n build: $(PIPE)\n-\tcd spkg && \"../$(PIPE)\" \"./install all 2>&1\" \"tee -a ../install.log\"\n+\tcd spkg && env MAKECMDGOALS=\"$(MAKECMDGOALS)\" \"../$(PIPE)\" \"./install all 2>&1\" \"tee -a ../install.log\"\n \n doc: doc-html\n \n--- spkg/install.orig\t2010-12-26 23:28:59.000000000 +0100\n+++ spkg/install\t2010-12-27 03:10:04.000000000 +0100\n@@ -432,10 +432,26 @@\n export ZNPOLY\n \n \n-# Dump environment for debugging purposes:\n-echo \"*** ALL ENVIRONMENT VARIABLES BEFORE BUILD: ***\"\n-env\n-echo \"***********************************************\"\n+# Skip the rest if nothing to do (i.e., to [re]build):\n+# (Note that we should use $MAKE here, but we currently don't use\n+# it further below either unless SAGE_PARALLEL_SPKG_BUILD=yes, which\n+# I consider a \"bug\".)\n+if make -q -f standard/deps $1; then\n+    echo\n+    echo \"Nothing to (re)build / all up-to-date.\"\n+    echo\n+    exit 0\n+fi\n+\n+# ALTERNATIVELY:\n+\n+# Only dump the environment when 'make' or 'make build' was issued:\n+if ! echo $MAKECMDGOALS | egrep \"doc|test\" >/dev/null; then\n+    # Dump environment for debugging purposes:\n+    echo \"*** ALL ENVIRONMENT VARIABLES BEFORE BUILD: ***\"\n+    env\n+    echo \"***********************************************\"\n+fi\n \n \n ###############################################################################\n```\n\n---\n\nP.S.: I did not know you are the copyright owner of our rewritten `pipestatus`... ;-)",
    "created_at": "2010-12-27T02:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98632",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:6" align="right">comment:6</div>

You could also do (one of or some other combination of) the following:

```diff
--- Makefile.orig	2010-12-24 13:39:58.000000000 +0100
+++ Makefile	2010-12-27 02:38:20.000000000 +0100
@@ -43,7 +43,7 @@
 #	test -x $@ # or make it executable if it exists; sanity check only anyway
 
 build: $(PIPE)
-	cd spkg && "../$(PIPE)" "./install all 2>&1" "tee -a ../install.log"
+	cd spkg && env MAKECMDGOALS="$(MAKECMDGOALS)" "../$(PIPE)" "./install all 2>&1" "tee -a ../install.log"
 
 doc: doc-html
 
--- spkg/install.orig	2010-12-26 23:28:59.000000000 +0100
+++ spkg/install	2010-12-27 03:10:04.000000000 +0100
@@ -432,10 +432,26 @@
 export ZNPOLY
 
 
-# Dump environment for debugging purposes:
-echo "*** ALL ENVIRONMENT VARIABLES BEFORE BUILD: ***"
-env
-echo "***********************************************"
+# Skip the rest if nothing to do (i.e., to [re]build):
+# (Note that we should use $MAKE here, but we currently don't use
+# it further below either unless SAGE_PARALLEL_SPKG_BUILD=yes, which
+# I consider a "bug".)
+if make -q -f standard/deps $1; then
+    echo
+    echo "Nothing to (re)build / all up-to-date."
+    echo
+    exit 0
+fi
+
+# ALTERNATIVELY:
+
+# Only dump the environment when 'make' or 'make build' was issued:
+if ! echo $MAKECMDGOALS | egrep "doc|test" >/dev/null; then
+    # Dump environment for debugging purposes:
+    echo "*** ALL ENVIRONMENT VARIABLES BEFORE BUILD: ***"
+    env
+    echo "***********************************************"
+fi
 
 
 ###############################################################################
```

---

P.S.: I did not know you are the copyright owner of our rewritten `pipestatus`... ;-)



---

archive/issue_comments_098633.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n(You could invert the test on `$MAKECMDGOALS` to\n\n```sh\nif [ -z \"$MAKECMDGOALS\" ] || (echo $MAKECMDGOALS | egrep \"build|all\" >/dev/null); then\n    # dump all (or some) env vars\n    ...\nfi\n```\n)\n\nThe \"early exit\" in my patch above is IMHO useful anyway, since always printing\n\n```\nTo install gap, gp, singular, etc., scripts\nin a standard bin directory, start sage and\ntype something like\n   sage: install_scripts('/usr/local/bin')\nat the Sage command prompt.\n\nTo build the documentation, run\n   make doc\n\nSage build/upgrade complete!\n```\nis also dumb.",
    "created_at": "2010-12-27T02:38:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98633",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:7" align="right">comment:7</div>

(You could invert the test on `$MAKECMDGOALS` to

```sh
if [ -z "$MAKECMDGOALS" ] || (echo $MAKECMDGOALS | egrep "build|all" >/dev/null); then
    # dump all (or some) env vars
    ...
fi
```
)

The "early exit" in my patch above is IMHO useful anyway, since always printing

```
To install gap, gp, singular, etc., scripts
in a standard bin directory, start sage and
type something like
   sage: install_scripts('/usr/local/bin')
at the Sage command prompt.

To build the documentation, run
   make doc

Sage build/upgrade complete!
```
is also dumb.



---

archive/issue_comments_098634.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nP.P.S., related:\n\nImplementing `sage -printenv` is also on my TODO list since a while...\n\n(This should only print relevant variables, e.g. set/used in `sage-env`, grouped by category.)",
    "created_at": "2010-12-27T02:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98634",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:8" align="right">comment:8</div>

P.P.S., related:

Implementing `sage -printenv` is also on my TODO list since a while...

(This should only print relevant variables, e.g. set/used in `sage-env`, grouped by category.)



---

archive/issue_comments_098635.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@nexttime](#comment:5):\n> It's totally odd to dump the whole environment whenever `make something` is run, where `something` includes `doc`, `ptestlong` and most of all other targets.\n\nAgreed.\n\n> I would\n> * make the output depend on some environment variable (*not* `SAGE_DEBUG` ;-) , but perhaps `SAGE_DEBUG_BUILD` to be also used elsewhere),\n\nMakes sense.\n\n> * limit the output to \"relevant\" variables; I e.g. personally use\n\nDisagree, you never know in advance which environment variables are \"relevant\".  If a build fails, it might be because of some obscure environment variable.  That's why I added this patch.\n\n> * use `printenv`, the shell built-in, instead of `env`.\n\nDisagree, `env` is more portable than `printenv`.",
    "created_at": "2010-12-27T12:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98635",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@nexttime](#comment:5):
> It's totally odd to dump the whole environment whenever `make something` is run, where `something` includes `doc`, `ptestlong` and most of all other targets.

Agreed.

> I would
> * make the output depend on some environment variable (*not* `SAGE_DEBUG` ;-) , but perhaps `SAGE_DEBUG_BUILD` to be also used elsewhere),

Makes sense.

> * limit the output to "relevant" variables; I e.g. personally use

Disagree, you never know in advance which environment variables are "relevant".  If a build fails, it might be because of some obscure environment variable.  That's why I added this patch.

> * use `printenv`, the shell built-in, instead of `env`.

Disagree, `env` is more portable than `printenv`.



---

archive/issue_comments_098636.json:
```json
{
    "body": "Changed work issues from **Don't always dump the whole environment.** to **Don't always dump the environment.**",
    "created_at": "2010-12-27T12:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98636",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **Don't always dump the whole environment.** to **Don't always dump the environment.**



---

archive/issue_comments_098637.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nTo me, it makes sense to me to always dump the environment before running make ptest/ptestlong. For example, say, I change an environment variable and testing breaks today, but I know it worked yesterday... For the same reason, I don't like it to be contingent on some \"debug\" environment variable. Its good to be able to compare with previously working tests.\n\nAnd if you look at the size of the `install.log`, thats just a drop of water in the ocean. Saving 4k of disk space? really, we are even discussing this?",
    "created_at": "2010-12-27T16:08:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98637",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

To me, it makes sense to me to always dump the environment before running make ptest/ptestlong. For example, say, I change an environment variable and testing breaks today, but I know it worked yesterday... For the same reason, I don't like it to be contingent on some "debug" environment variable. Its good to be able to compare with previously working tests.

And if you look at the size of the `install.log`, thats just a drop of water in the ocean. Saving 4k of disk space? really, we are even discussing this?



---

archive/issue_comments_098638.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nEdit your `~/.sagerc`.\n\nMost of the environment is completely unrelated to Sage, and will annoy ordinary users.\n\n\n\nWe already had long discussions regarding the removal of (short!) useless messages like \"*Building a 64-bit version of Sage*\".\n\n\n\nI'm also strongly in favour of first running `make -q` before (usually one-time) build-related messages are printed. `ptestlong` etc. are likely to be run much more often than a real (re)build is performed.\n\nIf you need it, you can add `ptestlong-debug` etc. targets to the top-level `Makefile`.",
    "created_at": "2010-12-27T16:26:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98638",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:11" align="right">comment:11</div>

Edit your `~/.sagerc`.

Most of the environment is completely unrelated to Sage, and will annoy ordinary users.



We already had long discussions regarding the removal of (short!) useless messages like "*Building a 64-bit version of Sage*".



I'm also strongly in favour of first running `make -q` before (usually one-time) build-related messages are printed. `ptestlong` etc. are likely to be run much more often than a real (re)build is performed.

If you need it, you can add `ptestlong-debug` etc. targets to the top-level `Makefile`.



---

archive/issue_comments_098639.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nFine. I don't really care what the color of your bike shed is. If you post a patch that at least somehow adds a dump of environment variables to the log then I'll review it positively for you. If its not in time for Sage-4.6.1 then preferably in a different ticket.",
    "created_at": "2010-12-27T18:55:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98639",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">comment:12</div>

Fine. I don't really care what the color of your bike shed is. If you post a patch that at least somehow adds a dump of environment variables to the log then I'll review it positively for you. If its not in time for Sage-4.6.1 then preferably in a different ticket.



---

archive/issue_comments_098640.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@nexttime](#comment:11):\n> Most of the environment is completely unrelated to Sage\n\nThis is certainly true, but as I have said before: you never know in advance which environment variables are relevant, so better print them all.",
    "created_at": "2011-01-03T10:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98640",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@nexttime](#comment:11):
> Most of the environment is completely unrelated to Sage

This is certainly true, but as I have said before: you never know in advance which environment variables are relevant, so better print them all.



---

archive/issue_comments_098641.json:
```json
{
    "body": "Attachment: **[10491_skip.patch.gz](https://github.com/sagemath/sage/files/ticket10491/10491_skip.patch.gz)**\n\nSCRIPTS, Apply on top of previous",
    "created_at": "2011-01-03T10:36:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98641",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[10491_skip.patch.gz](https://github.com/sagemath/sage/files/ticket10491/10491_skip.patch.gz)**

SCRIPTS, Apply on top of previous



---

archive/issue_comments_098642.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nLeif, I implemented your \"skip the rest of the script if nothing to do\" patch.",
    "created_at": "2011-01-03T10:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98642",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Leif, I implemented your "skip the rest of the script if nothing to do" patch.



---

archive/issue_comments_098643.json:
```json
{
    "body": "Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, Leif Leonhardy**",
    "created_at": "2011-01-03T10:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98643",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, Leif Leonhardy**



---

archive/issue_events_138263.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-03T10:37:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138263"
}
```



---

archive/issue_events_138264.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-01-03T11:12:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138264"
}
```



---

archive/issue_events_138265.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-01-03T11:12:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138265"
}
```



---

archive/issue_comments_098644.json:
```json
{
    "body": "Changed merged from **sage-4.6.1.rc0** to none",
    "created_at": "2011-01-03T11:12:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98644",
    "user": "https://github.com/vbraun"
}
```

Changed merged from **sage-4.6.1.rc0** to none



---

archive/issue_comments_098645.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nLooks good to me.\n\nFor the release manager: First apply 10491_install_dump_env.patch (merged in Sage-4.6.1.rc0), then 10491_skip.patch\n\nAll patches apply within `$SAGE_ROOT/spkg/`",
    "created_at": "2011-01-03T11:12:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98645",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>

Looks good to me.

For the release manager: First apply 10491_install_dump_env.patch (merged in Sage-4.6.1.rc0), then 10491_skip.patch

All patches apply within `$SAGE_ROOT/spkg/`



---

archive/issue_events_138266.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-05T08:20:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138266"
}
```



---

archive/issue_events_138267.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-05T08:20:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10491#event-138267"
}
```



---

archive/issue_comments_098646.json:
```json
{
    "body": "Changed work issues from **Don't always dump the environment.** to none",
    "created_at": "2011-01-05T08:20:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98646",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **Don't always dump the environment.** to none



---

archive/issue_comments_098647.json:
```json
{
    "body": "Merged: **sage-4.6.1.rc1**",
    "created_at": "2011-01-05T08:20:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10491#issuecomment-98647",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.6.1.rc1**
