# Issue 10791: Fix and upgrade Gram-Schmidt

archive/issues_010726.json:
```json
{
    "body": "If a set of vectors has a linearly dependent subset, followed by a vector outside the span of that subset, then the presence of a zero vector in the orthogonal set causes division by a zero dot product.\n\nThere are various other improvements that can be made in this routine.\n\n```\nsage: A=matrix(QQ, [[1,2],[2,4],[1,1]])\nsage: A.gram_schmidt()\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n\n/sage/sage-4.6.2.alpha4/<ipython console> in <module>()\n\n/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.gram_schmidt (sage/matrix/matrix2.c:31979)()\n\n/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/modules/misc.pyc in gram_schmidt(B)\n     55     for i in range(1,n):\n     56         for j in range(i):\n---> 57             mu[i,j] = B[i].dot_product(Bstar[j]) / (Bstar[j].dot_product(Bstar[j]))\n     58         Bstar.append(B[i] - sum(mu[i,j]*Bstar[j] for j in range(i)))\n     59     return Bstar, mu\n\n/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__div__ (sage/structure/element.c:11981)()\n\n/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/rings/rational.so in sage.rings.rational.Rational._div_ (sage/rings/rational.c:15177)()\n\nZeroDivisionError: Rational division by zero\n```\n\nPatch summary:\n\n* Original Gram-Schmidt has been adjusted to raise an error on linearly dependent input.\n\n* Free module version of original Gram-Schmidt was used just one place, and it has been referenced directly, rather than through the matrix version.\n\n* Matrix version is totally rewritten, building on QR factorizations as possible to get orthonormal bases.  Linearly dependent subsets should be handled properly now.  Return format has, by necessity, changed.\n\n* The \"noscale\" helper method is reminiscent of the old code, but written in a column-oriented QR style.\n\n**Apply:**\n1. [attachment:trac_10791-fix-gram-schmidt-v3.patch]\n2. [attachment:trac_10791-gram-schmidt-negative-zero.patch]\n3. [attachment:trac_10791-gram-schmidt-qqbar-doctests.patch]\n\n**Depends on:**\n1. #10536\n2. #10683\n3. #10794\n\n\nAssignee: jason, was\n\nKeywords: sd32\n\nResolution: fixed\n\nAuthor: Rob Beezer\n\nReviewer: Martin Raum, John Palmieri\n\nMerged: sage-4.8.alpha5\n\nIssue created by migration from https://trac.sagemath.org/ticket/10791\n\n",
    "closed_at": "2011-12-17T09:12:05Z",
    "created_at": "2011-02-16T17:48:23Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Fix and upgrade Gram-Schmidt",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10791",
    "user": "https://github.com/rbeezer"
}
```
If a set of vectors has a linearly dependent subset, followed by a vector outside the span of that subset, then the presence of a zero vector in the orthogonal set causes division by a zero dot product.

There are various other improvements that can be made in this routine.

```
sage: A=matrix(QQ, [[1,2],[2,4],[1,1]])
sage: A.gram_schmidt()
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)

/sage/sage-4.6.2.alpha4/<ipython console> in <module>()

/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.gram_schmidt (sage/matrix/matrix2.c:31979)()

/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/modules/misc.pyc in gram_schmidt(B)
     55     for i in range(1,n):
     56         for j in range(i):
---> 57             mu[i,j] = B[i].dot_product(Bstar[j]) / (Bstar[j].dot_product(Bstar[j]))
     58         Bstar.append(B[i] - sum(mu[i,j]*Bstar[j] for j in range(i)))
     59     return Bstar, mu

/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__div__ (sage/structure/element.c:11981)()

/sage/sage-4.6.2.alpha4/local/lib/python2.6/site-packages/sage/rings/rational.so in sage.rings.rational.Rational._div_ (sage/rings/rational.c:15177)()

ZeroDivisionError: Rational division by zero
```

Patch summary:

* Original Gram-Schmidt has been adjusted to raise an error on linearly dependent input.

* Free module version of original Gram-Schmidt was used just one place, and it has been referenced directly, rather than through the matrix version.

* Matrix version is totally rewritten, building on QR factorizations as possible to get orthonormal bases.  Linearly dependent subsets should be handled properly now.  Return format has, by necessity, changed.

* The "noscale" helper method is reminiscent of the old code, but written in a column-oriented QR style.

**Apply:**
1. [attachment:trac_10791-fix-gram-schmidt-v3.patch]
2. [attachment:trac_10791-gram-schmidt-negative-zero.patch]
3. [attachment:trac_10791-gram-schmidt-qqbar-doctests.patch]

**Depends on:**
1. #10536
2. #10683
3. #10794


Assignee: jason, was

Keywords: sd32

Resolution: fixed

Author: Rob Beezer

Reviewer: Martin Raum, John Palmieri

Merged: sage-4.8.alpha5

Issue created by migration from https://trac.sagemath.org/ticket/10791





---

archive/issue_comments_112761.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-02-27T01:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112761",
    "user": "https://github.com/rbeezer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_112762.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [trac_10791-fix-gram-schmidt.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-fix-gram-schmidt.patch) by @rbeezer created at 2011-02-27 01:38:58",
    "created_at": "2011-02-27T01:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112762",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:1'></a>Attachment [trac_10791-fix-gram-schmidt.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-fix-gram-schmidt.patch) by @rbeezer created at 2011-02-27 01:38:58



---

archive/issue_comments_112763.json:
```json
{
    "body": "<a id='comment:2'></a>fix patchbot comment",
    "created_at": "2011-03-23T22:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112763",
    "user": "https://github.com/kini"
}
```

<a id='comment:2'></a>fix patchbot comment



---

archive/issue_comments_112764.json:
```json
{
    "body": "<a id='comment:3'></a>In line 6364: properly contains\nIn line 6444: For the integers and the rationals the field \n\nThere is only one thing you didn't catch. If you fix that I can give this a positive review (please provide a patch that depends on the current one, to make my life easier) :\n\nFile \"/scratch/mraum/sagedev/devel/sage-dev/sage/modules/misc.py\", line 66:\n    sage: gram_schmidt(V)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mraum/sagedev/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mraum/sagedev/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mraum/sagedev/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[16]>\", line 1, in <module>\n        gram_schmidt(V)###line 66:\n    sage: gram_schmidt(V)\n      File \"/scratch/mraum/sagedev/local/lib/python/site-packages/sage/modules/misc.py\", line 83, in gram_schmidt\n        raise ValueError(\"linearly dependent input for module version of Gram-Schmidt\")\n    ValueError: linearly dependent input for module version of Gram-Schmidt",
    "created_at": "2011-03-26T01:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112764",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:3'></a>In line 6364: properly contains
In line 6444: For the integers and the rationals the field 

There is only one thing you didn't catch. If you fix that I can give this a positive review (please provide a patch that depends on the current one, to make my life easier) :

File "/scratch/mraum/sagedev/devel/sage-dev/sage/modules/misc.py", line 66:
    sage: gram_schmidt(V)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mraum/sagedev/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mraum/sagedev/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mraum/sagedev/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[16]>", line 1, in <module>
        gram_schmidt(V)###line 66:
    sage: gram_schmidt(V)
      File "/scratch/mraum/sagedev/local/lib/python/site-packages/sage/modules/misc.py", line 83, in gram_schmidt
        raise ValueError("linearly dependent input for module version of Gram-Schmidt")
    ValueError: linearly dependent input for module version of Gram-Schmidt



---

archive/issue_comments_112765.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-03-26T01:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112765",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_112766.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-27T05:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112766",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_112767.json:
```json
{
    "body": "<a id='comment:4'></a>Attachment [trac_10791-gram-schmidt-doctests.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-doctests.patch) by @rbeezer created at 2011-03-27 05:34:33\n\nMartin - thanks for the careful review and for catching these three items.\n\n\"doctests\" patch implements changes to fix all three.\n\nRob",
    "created_at": "2011-03-27T05:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112767",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:4'></a>Attachment [trac_10791-gram-schmidt-doctests.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-doctests.patch) by @rbeezer created at 2011-03-27 05:34:33

Martin - thanks for the careful review and for catching these three items.

"doctests" patch implements changes to fix all three.

Rob



---

archive/issue_comments_112768.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-03-30T19:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112768",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_112769.json:
```json
{
    "body": "<a id='comment:5'></a>Ok, the doctest patch fixes all issues. So this gets a positive review",
    "created_at": "2011-03-30T19:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112769",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:5'></a>Ok, the doctest patch fixes all issues. So this gets a positive review



---

archive/issue_comments_112770.json:
```json
{
    "body": "<a id='comment:6'></a>Problems while building the documentation:\n\n```\ndocstring of sage.matrix.matrix2.Matrix.gram_schmidt:47: (WARNING/2) Literal block expected; none found.\ndocstring of sage.matrix.matrix2.Matrix.gram_schmidt:217: (WARNING/2) Literal block expected; none found.\n```",
    "created_at": "2011-04-13T12:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112770",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Problems while building the documentation:

```
docstring of sage.matrix.matrix2.Matrix.gram_schmidt:47: (WARNING/2) Literal block expected; none found.
docstring of sage.matrix.matrix2.Matrix.gram_schmidt:217: (WARNING/2) Literal block expected; none found.
```



---

archive/issue_comments_112771.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-04-13T12:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112771",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_112772.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-14T05:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112772",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_112773.json:
```json
{
    "body": "<a id='comment:7'></a>Attachment [trac_10791-gram-schmidt-doctests-v2.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-doctests-v2.patch) by @rbeezer created at 2011-04-14 05:47:04\n\nDocumentation fixes are added into a v2 version of the doctest patch.\n\nJust had to change two `::` to `:` in sage/matrix/matrix2.pyx.\n\nSo this change is ready for review.",
    "created_at": "2011-04-14T05:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112773",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:7'></a>Attachment [trac_10791-gram-schmidt-doctests-v2.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-doctests-v2.patch) by @rbeezer created at 2011-04-14 05:47:04

Documentation fixes are added into a v2 version of the doctest patch.

Just had to change two `::` to `:` in sage/matrix/matrix2.pyx.

So this change is ready for review.



---

archive/issue_comments_112774.json:
```json
{
    "body": "<a id='comment:8'></a>The patchbot does not apply the patches this depends on. Do you, Robert, know how to fix that in the ticket description?",
    "created_at": "2011-04-18T11:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112774",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:8'></a>The patchbot does not apply the patches this depends on. Do you, Robert, know how to fix that in the ticket description?



---

archive/issue_comments_112775.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 mraum]:\n> The patchbot does not apply the patches this depends on. Do you, Robert, know how to fix that in the ticket description?\n\n\nI have tried to chase back the dependencies and get everything in order for the patchbot.  We'll see.  The only change since this *had* a positive review was a couple of extra double-colons that had to be removed, so the documentation would build right.",
    "created_at": "2011-04-19T00:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112775",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:9'></a>Replying to [comment:8 mraum]:
> The patchbot does not apply the patches this depends on. Do you, Robert, know how to fix that in the ticket description?


I have tried to chase back the dependencies and get everything in order for the patchbot.  We'll see.  The only change since this *had* a positive review was a couple of extra double-colons that had to be removed, so the documentation would build right.



---

archive/issue_comments_112776.json:
```json
{
    "body": "<a id='comment:10'></a>Feeding the patchbot:\n\nDepends on #10536, #10683, #10794 \n\nApply: trac_10791-fix-gram-schmidt.patch, trac_10791-gram-schmidt-doctests-v2.patch",
    "created_at": "2011-04-19T00:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112776",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:10'></a>Feeding the patchbot:

Depends on #10536, #10683, #10794 

Apply: trac_10791-fix-gram-schmidt.patch, trac_10791-gram-schmidt-doctests-v2.patch



---

archive/issue_comments_112777.json:
```json
{
    "body": "A copy of trac_10791-gram-schmidt-doctests-v2.patch",
    "created_at": "2011-05-06T14:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112777",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

A copy of trac_10791-gram-schmidt-doctests-v2.patch



---

archive/issue_comments_112778.json:
```json
{
    "body": "<a id='comment:11'></a>Attachment [trac-10791-gram-schmidt-doctests-v2.patch](tarball://root/attachments/some-uuid/ticket10791/trac-10791-gram-schmidt-doctests-v2.patch) by mraum created at 2011-05-06 14:24:12\n\nOne more try to make the patchbot retry: I added a copy of the last patch.\n\nDepends on #10536, #10683, #10794\n\nApply: trac_10791-fix-gram-schmidt.patch, trac-10791-gram-schmidt-doctests-v2.patch",
    "created_at": "2011-05-06T14:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112778",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:11'></a>Attachment [trac-10791-gram-schmidt-doctests-v2.patch](tarball://root/attachments/some-uuid/ticket10791/trac-10791-gram-schmidt-doctests-v2.patch) by mraum created at 2011-05-06 14:24:12

One more try to make the patchbot retry: I added a copy of the last patch.

Depends on #10536, #10683, #10794

Apply: trac_10791-fix-gram-schmidt.patch, trac-10791-gram-schmidt-doctests-v2.patch



---

archive/issue_comments_112779.json:
```json
{
    "body": "<a id='comment:12'></a>Using a bare `except:` (line 6303 of `sage/matrix/matrix2.pyx`) is a very bad idea.  You should catch specific exceptions, not all.",
    "created_at": "2011-05-07T10:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112779",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Using a bare `except:` (line 6303 of `sage/matrix/matrix2.pyx`) is a very bad idea.  You should catch specific exceptions, not all.



---

archive/issue_comments_112780.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 jdemeyer]:\n> Using a bare `except:` (line 6303 of `sage/matrix/matrix2.pyx`) is a very bad idea.  You should catch specific exceptions, not all.\n\n\nYes, I became aware of this many months ago.  However, I never know just what to be catching.  In other words, it would be nice to use a `__call___` method as a way to sanitize input, but I often have trouble figuring out just how the code will react when it fails (just what type of error will come back).\n\nSo which is preferable:\n\n```\ntry:\n   n = Integer(n_input)\nexcept SomeError:\n   raise ....\n```\n\nor\n\n```\nif not is_Integer(n_input):\n    raise ...\nelse:\n    n = Integer(n_input)\n```\n\nIn the first case is it enough to just catch  `TypeError` and `ValueError`?\n\nIn the second case, I am often at a loss to decide which to use, in particular I once spent a very long time trying to determine if an input was a real number.\n\nSo my naked except is really an act of desperation.  Advice would be appreciated.\n\nRob",
    "created_at": "2011-05-08T20:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112780",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:13'></a>Replying to [comment:12 jdemeyer]:
> Using a bare `except:` (line 6303 of `sage/matrix/matrix2.pyx`) is a very bad idea.  You should catch specific exceptions, not all.


Yes, I became aware of this many months ago.  However, I never know just what to be catching.  In other words, it would be nice to use a `__call___` method as a way to sanitize input, but I often have trouble figuring out just how the code will react when it fails (just what type of error will come back).

So which is preferable:

```
try:
   n = Integer(n_input)
except SomeError:
   raise ....
```

or

```
if not is_Integer(n_input):
    raise ...
else:
    n = Integer(n_input)
```

In the first case is it enough to just catch  `TypeError` and `ValueError`?

In the second case, I am often at a loss to decide which to use, in particular I once spent a very long time trying to determine if an input was a real number.

So my naked except is really an act of desperation.  Advice would be appreciated.

Rob



---

archive/issue_comments_112781.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-05-08T20:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112781",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_112782.json:
```json
{
    "body": "<a id='comment:14'></a>Attachment [trac_10791-fix-gram-schmidt-v2.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-fix-gram-schmidt-v2.patch) by @rbeezer created at 2011-07-18 17:37:32\n\nThe naked except has been corrected to:\n\n```\n        try:\n            F = R.fraction_field()\n        except TypeError:\n            raise TypeError(<snipped>)\n```\n\nThis had a positive review back at comment 5.  Since then it has received a documentation fix (double colons) and the fix on the except clause.  Those are the only changes since then.\n\nI do not know what is up with the patchbot, as it seems totally dead at the moment.  In any event, it seems counter-productive to wait on it while it is still being developed.  This is passing all tests for me right now.",
    "created_at": "2011-07-18T17:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112782",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:14'></a>Attachment [trac_10791-fix-gram-schmidt-v2.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-fix-gram-schmidt-v2.patch) by @rbeezer created at 2011-07-18 17:37:32

The naked except has been corrected to:

```
        try:
            F = R.fraction_field()
        except TypeError:
            raise TypeError(<snipped>)
```

This had a positive review back at comment 5.  Since then it has received a documentation fix (double colons) and the fix on the except clause.  Those are the only changes since then.

I do not know what is up with the patchbot, as it seems totally dead at the moment.  In any event, it seems counter-productive to wait on it while it is still being developed.  This is passing all tests for me right now.



---

archive/issue_comments_112783.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-07-18T17:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112783",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_112784.json:
```json
{
    "body": "Apply **only** this patch",
    "created_at": "2011-07-18T17:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112784",
    "user": "https://github.com/rbeezer"
}
```

Apply **only** this patch



---

archive/issue_comments_112785.json:
```json
{
    "body": "<a id='comment:15'></a>Attachment [trac_10791-fix-gram-schmidt-v3.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-fix-gram-schmidt-v3.patch) by @rbeezer created at 2011-07-18 18:00:35\n\nGot confused with the various patches here, so I just rolled everything into one, the v3 patch.  So only apply this one patch.",
    "created_at": "2011-07-18T18:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112785",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:15'></a>Attachment [trac_10791-fix-gram-schmidt-v3.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-fix-gram-schmidt-v3.patch) by @rbeezer created at 2011-07-18 18:00:35

Got confused with the various patches here, so I just rolled everything into one, the v3 patch.  So only apply this one patch.



---

archive/issue_comments_112786.json:
```json
{
    "body": "<a id='comment:16'></a>I checked this once more. The documentation builds fine, indeed. And everything since nothing but the exception has changed, I can set this again to positive review.",
    "created_at": "2011-08-06T15:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112786",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:16'></a>I checked this once more. The documentation builds fine, indeed. And everything since nothing but the exception has changed, I can set this again to positive review.



---

archive/issue_comments_112787.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-08-06T15:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112787",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_112788.json:
```json
{
    "body": "<a id='comment:17'></a>Thanks, Martin!  I'm just getting caught up now that email notifications are working again.\n\nRob",
    "created_at": "2011-08-11T05:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112788",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:17'></a>Thanks, Martin!  I'm just getting caught up now that email notifications are working again.

Rob



---

archive/issue_events_027837.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-11T13:09:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10791#event-27837"
}
```



---

archive/issue_comments_112789.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-08-18T22:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112789",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_027838.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:02:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10791#event-27838"
}
```



---

archive/issue_comments_112790.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-08-24T14:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112790",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_112791.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-08-24T14:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112791",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_027839.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T14:54:06Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10791#event-27839"
}
```



---

archive/issue_comments_112792.json:
```json
{
    "body": "<a id='comment:20'></a>Doctest failure on flavius ():\n\n```\nsage -t -long  -force_lib devel/sage/sage/matrix/matrix2.pyx\n**********************************************************************\nFile \"/home/buildbot/build/sage/flavius-1/flavius_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix2.pyx\", line 7722:\n    sage: M.round(10)\nExpected:\n    [-2.4494897428           0.0           0.0]\n    [-3.6742346142  0.7071067812           0.0]\n    [-4.8989794856  1.4142135624           0.0]\nGot:\n    [-2.4494897428           0.0           0.0]\n    [-3.6742346142  0.7071067812           0.0]\n    [-4.8989794856  1.4142135624          -0.0]\n**********************************************************************\n```",
    "created_at": "2011-08-24T14:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112792",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>Doctest failure on flavius ():

```
sage -t -long  -force_lib devel/sage/sage/matrix/matrix2.pyx
**********************************************************************
File "/home/buildbot/build/sage/flavius-1/flavius_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix2.pyx", line 7722:
    sage: M.round(10)
Expected:
    [-2.4494897428           0.0           0.0]
    [-3.6742346142  0.7071067812           0.0]
    [-4.8989794856  1.4142135624           0.0]
Got:
    [-2.4494897428           0.0           0.0]
    [-3.6742346142  0.7071067812           0.0]
    [-4.8989794856  1.4142135624          -0.0]
**********************************************************************
```



---

archive/issue_comments_112793.json:
```json
{
    "body": "<a id='comment:21'></a>Doctest failure on bsd (OS X 10.8.0 x86_64):\n\n```\nsage -t -long  -force_lib devel/sage/sage/matrix/matrix2.pyx\n**********************************************************************\nFile \"/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix2.pyx\", line 7718:\n    sage: G.round(6)\nExpected:\n    [-0.408248 -0.408248 -0.816497]\n    [ 0.707107 -0.707107      -0.0]\n    [ -0.57735  -0.57735   0.57735]\nGot:\n    [-0.408248 -0.408248 -0.816497]\n    [ 0.707107 -0.707107       0.0]\n    [ -0.57735  -0.57735   0.57735]\n**********************************************************************\n```",
    "created_at": "2011-08-24T21:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112793",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Doctest failure on bsd (OS X 10.8.0 x86_64):

```
sage -t -long  -force_lib devel/sage/sage/matrix/matrix2.pyx
**********************************************************************
File "/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix2.pyx", line 7718:
    sage: G.round(6)
Expected:
    [-0.408248 -0.408248 -0.816497]
    [ 0.707107 -0.707107      -0.0]
    [ -0.57735  -0.57735   0.57735]
Got:
    [-0.408248 -0.408248 -0.816497]
    [ 0.707107 -0.707107       0.0]
    [ -0.57735  -0.57735   0.57735]
**********************************************************************
```



---

archive/issue_comments_112794.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-08-24T21:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112794",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_112795.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-08-24T21:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112795",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_112796.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2011-08-25T02:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112796",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_112797.json:
```json
{
    "body": "<a id='comment:23'></a>Turns out the IEEE specification includes a \"negative zero.\"  Rounding and `.zero_at()` might do the trick.\n\nSix such changes in the \"negative zero\" patch.  Successful with one instance where I converted a `-0.0` to `0.0`.\n\nJeroen - could you easily test/review this on the two failing machines?  If it works across three architectures, I'll then apply the same technique to #10795, #10837 with some confidence.\n\nThanks for your patience with this (exasperating) numerical work.\n\nRob",
    "created_at": "2011-08-25T02:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112797",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:23'></a>Turns out the IEEE specification includes a "negative zero."  Rounding and `.zero_at()` might do the trick.

Six such changes in the "negative zero" patch.  Successful with one instance where I converted a `-0.0` to `0.0`.

Jeroen - could you easily test/review this on the two failing machines?  If it works across three architectures, I'll then apply the same technique to #10795, #10837 with some confidence.

Thanks for your patience with this (exasperating) numerical work.

Rob



---

archive/issue_comments_112798.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd32\".",
    "created_at": "2011-08-25T18:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112798",
    "user": "https://github.com/rbeezer"
}
```

Changing keywords from "" to "sd32".



---

archive/issue_comments_112799.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-09-19T02:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112799",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_112800.json:
```json
{
    "body": "<a id='comment:26'></a>What's needed now?  Jeroen just needs to test this last doctest fix on flavius and bsd?  (or should we set it back to positive review, since the doctest changes are minor, and depend on the more widespread release testing to catch it on the platforms we don't have easy access to?)\n\nI think I would prefer setting this back to positive review, since Jeroen will be implicitly testing it on those two platforms when he merges it (as long as it still passes on Rob's platform).",
    "created_at": "2011-12-04T00:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112800",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:26'></a>What's needed now?  Jeroen just needs to test this last doctest fix on flavius and bsd?  (or should we set it back to positive review, since the doctest changes are minor, and depend on the more widespread release testing to catch it on the platforms we don't have easy access to?)

I think I would prefer setting this back to positive review, since Jeroen will be implicitly testing it on those two platforms when he merges it (as long as it still passes on Rob's platform).



---

archive/issue_comments_112801.json:
```json
{
    "body": "<a id='comment:27'></a>There are errors on sage.math and on OS X 10.6.8, applied to Sage 4.8.alpha3:\n\n```\nsage -t --long \"devel/sage/sage/matrix/matrix2.pyx\"         \n**********************************************************************\nFile \"/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx\", line 8072:\n    sage: G*G.transpose()\nExpected:\n    [      1 0.?e-37 0.?e-35]\n    [0.?e-37       1 0.?e-35]\n    [0.?e-35 0.?e-35       1]\nGot:\n    [      1 0.?e-18 0.?e-19]\n    [0.?e-18       1 0.?e-18]\n    [0.?e-19 0.?e-18       1]\n**********************************************************************\nFile \"/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx\", line 8087:\n    sage: G\nExpected:\n    [                         -0.3849001794597505?  -0.1924500897298753? - 0.1924500897298753?*I   0.3849001794597505? + 0.7698003589195010?*I                          -0.1924500897298753?]\n    [-0.06165497274852388? - 0.1387236886841787?*I  0.8188551068163327? - 0.10018933071635130?*I  0.2003786614327026? + 0.05394810115495839?*I  0.02119389688230508? + 0.5028733714801478?*I]\n    [  0.3842387256410419? - 0.5694103019142261?*I  0.1416892863096208? - 0.06139779741542298?*I  0.4633778333528464? - 0.01285039016180503?*I  0.02658516588219101? - 0.5373044261814995?*I]\nGot:\n    [                         -0.3849001794597505?  -0.1924500897298753? - 0.1924500897298753?*I   0.3849001794597505? + 0.7698003589195010?*I                          -0.1924500897298753?]\n    [-0.06165497274852388? - 0.1387236886841787?*I  0.8188551068163327? - 0.10018933071635130?*I  0.2003786614327026? + 0.05394810115495839?*I  0.02119389688230508? + 0.5028733714801478?*I]\n    [  0.3842387256410419? - 0.5694103019142261?*I   0.1416892863096208? - 0.0613977974154230?*I  0.4633778333528464? - 0.01285039016180503?*I  0.02658516588219101? - 0.5373044261814995?*I]\n**********************************************************************\nFile \"/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx\", line 8091:\n    sage: M\nExpected:\n    [                        5.196152422706632?                                          0                                          0]\n    [-3.079201435678004? + 3.464101615137755?*I             19.22286447225071? + 0.?e-37*I                                          0]\n    [  4.426352063787131? - 8.66025403784439?*I -5.117362738127481? - 3.502773139275513?*I             7.480012456446966? + 0.?e-35*I]\nGot:\n    [                        5.196152422706632?                                          0                                          0]\n    [-3.079201435678004? + 3.464101615137755?*I             19.22286447225071? + 0.?e-17*I                                          0]\n    [  4.426352063787131? - 8.66025403784439?*I -5.117362738127481? - 3.502773139275513?*I             7.480012456446966? + 0.?e-16*I]\n**********************************************************************\nFile \"/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx\", line 8095:\n    sage: M*G-A\nExpected:\n    [            0.?e-37 0.?e-37 + 0.?e-37*I 0.?e-37 + 0.?e-37*I             0.?e-37]\n    [0.?e-36 + 0.?e-36*I 0.?e-35 + 0.?e-36*I 0.?e-36 + 0.?e-36*I 0.?e-36 + 0.?e-36*I]\n    [0.?e-35 + 0.?e-35*I 0.?e-35 + 0.?e-35*I 0.?e-35 + 0.?e-35*I 0.?e-35 + 0.?e-35*I]\nGot:\n    [            0.?e-18 0.?e-18 + 0.?e-18*I 0.?e-18 + 0.?e-17*I             0.?e-18]\n    [0.?e-17 + 0.?e-17*I 0.?e-16 + 0.?e-17*I 0.?e-16 + 0.?e-17*I 0.?e-17 + 0.?e-16*I]\n    [0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I]\n**********************************************************************\nFile \"/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx\", line 8099:\n    sage: G*G.conjugate().transpose()\nExpected:\n    [1.000000000000000? + 0.?e-37*I            0.?e-37 + 0.?e-37*I            0.?e-36 + 0.?e-36*I]\n    [           0.?e-37 + 0.?e-37*I 1.000000000000000? + 0.?e-37*I            0.?e-36 + 0.?e-36*I]\n    [           0.?e-36 + 0.?e-36*I            0.?e-36 + 0.?e-36*I 1.000000000000000? + 0.?e-35*I]\nGot:\n    [1.000000000000000? + 0.?e-18*I            0.?e-18 + 0.?e-18*I            0.?e-17 + 0.?e-16*I]\n    [           0.?e-18 + 0.?e-18*I 1.000000000000000? + 0.?e-18*I            0.?e-16 + 0.?e-17*I]\n    [           0.?e-17 + 0.?e-16*I            0.?e-16 + 0.?e-17*I 1.000000000000000? + 0.?e-16*I]\n**********************************************************************\nFile \"/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx\", line 8130:\n    sage: G*G.transpose()\nExpected:\n    [      1 0.?e-35]\n    [0.?e-35       1]\nGot:\n    [      1 0.?e-18]\n    [0.?e-18       1]\n**********************************************************************\n1 items had failures:\n   6 of  68 in __main__.example_97\n***Test Failed*** 6 failures.\nFor whitespace errors, see the file /Users/palmieri/.sage//tmp/matrix2_40831.py\n\t [37.9 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t --long \"devel/sage/sage/matrix/matrix2.pyx\"\nTotal time for all tests: 37.9 seconds\n```",
    "created_at": "2011-12-04T00:48:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112801",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>There are errors on sage.math and on OS X 10.6.8, applied to Sage 4.8.alpha3:

```
sage -t --long "devel/sage/sage/matrix/matrix2.pyx"         
**********************************************************************
File "/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx", line 8072:
    sage: G*G.transpose()
Expected:
    [      1 0.?e-37 0.?e-35]
    [0.?e-37       1 0.?e-35]
    [0.?e-35 0.?e-35       1]
Got:
    [      1 0.?e-18 0.?e-19]
    [0.?e-18       1 0.?e-18]
    [0.?e-19 0.?e-18       1]
**********************************************************************
File "/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx", line 8087:
    sage: G
Expected:
    [                         -0.3849001794597505?  -0.1924500897298753? - 0.1924500897298753?*I   0.3849001794597505? + 0.7698003589195010?*I                          -0.1924500897298753?]
    [-0.06165497274852388? - 0.1387236886841787?*I  0.8188551068163327? - 0.10018933071635130?*I  0.2003786614327026? + 0.05394810115495839?*I  0.02119389688230508? + 0.5028733714801478?*I]
    [  0.3842387256410419? - 0.5694103019142261?*I  0.1416892863096208? - 0.06139779741542298?*I  0.4633778333528464? - 0.01285039016180503?*I  0.02658516588219101? - 0.5373044261814995?*I]
Got:
    [                         -0.3849001794597505?  -0.1924500897298753? - 0.1924500897298753?*I   0.3849001794597505? + 0.7698003589195010?*I                          -0.1924500897298753?]
    [-0.06165497274852388? - 0.1387236886841787?*I  0.8188551068163327? - 0.10018933071635130?*I  0.2003786614327026? + 0.05394810115495839?*I  0.02119389688230508? + 0.5028733714801478?*I]
    [  0.3842387256410419? - 0.5694103019142261?*I   0.1416892863096208? - 0.0613977974154230?*I  0.4633778333528464? - 0.01285039016180503?*I  0.02658516588219101? - 0.5373044261814995?*I]
**********************************************************************
File "/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx", line 8091:
    sage: M
Expected:
    [                        5.196152422706632?                                          0                                          0]
    [-3.079201435678004? + 3.464101615137755?*I             19.22286447225071? + 0.?e-37*I                                          0]
    [  4.426352063787131? - 8.66025403784439?*I -5.117362738127481? - 3.502773139275513?*I             7.480012456446966? + 0.?e-35*I]
Got:
    [                        5.196152422706632?                                          0                                          0]
    [-3.079201435678004? + 3.464101615137755?*I             19.22286447225071? + 0.?e-17*I                                          0]
    [  4.426352063787131? - 8.66025403784439?*I -5.117362738127481? - 3.502773139275513?*I             7.480012456446966? + 0.?e-16*I]
**********************************************************************
File "/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx", line 8095:
    sage: M*G-A
Expected:
    [            0.?e-37 0.?e-37 + 0.?e-37*I 0.?e-37 + 0.?e-37*I             0.?e-37]
    [0.?e-36 + 0.?e-36*I 0.?e-35 + 0.?e-36*I 0.?e-36 + 0.?e-36*I 0.?e-36 + 0.?e-36*I]
    [0.?e-35 + 0.?e-35*I 0.?e-35 + 0.?e-35*I 0.?e-35 + 0.?e-35*I 0.?e-35 + 0.?e-35*I]
Got:
    [            0.?e-18 0.?e-18 + 0.?e-18*I 0.?e-18 + 0.?e-17*I             0.?e-18]
    [0.?e-17 + 0.?e-17*I 0.?e-16 + 0.?e-17*I 0.?e-16 + 0.?e-17*I 0.?e-17 + 0.?e-16*I]
    [0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I]
**********************************************************************
File "/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx", line 8099:
    sage: G*G.conjugate().transpose()
Expected:
    [1.000000000000000? + 0.?e-37*I            0.?e-37 + 0.?e-37*I            0.?e-36 + 0.?e-36*I]
    [           0.?e-37 + 0.?e-37*I 1.000000000000000? + 0.?e-37*I            0.?e-36 + 0.?e-36*I]
    [           0.?e-36 + 0.?e-36*I            0.?e-36 + 0.?e-36*I 1.000000000000000? + 0.?e-35*I]
Got:
    [1.000000000000000? + 0.?e-18*I            0.?e-18 + 0.?e-18*I            0.?e-17 + 0.?e-16*I]
    [           0.?e-18 + 0.?e-18*I 1.000000000000000? + 0.?e-18*I            0.?e-16 + 0.?e-17*I]
    [           0.?e-17 + 0.?e-16*I            0.?e-16 + 0.?e-17*I 1.000000000000000? + 0.?e-16*I]
**********************************************************************
File "/Applications/sage_builds/sage-4.8.alpha3/devel/sage/sage/matrix/matrix2.pyx", line 8130:
    sage: G*G.transpose()
Expected:
    [      1 0.?e-35]
    [0.?e-35       1]
Got:
    [      1 0.?e-18]
    [0.?e-18       1]
**********************************************************************
1 items had failures:
   6 of  68 in __main__.example_97
***Test Failed*** 6 failures.
For whitespace errors, see the file /Users/palmieri/.sage//tmp/matrix2_40831.py
	 [37.9 s]
 
----------------------------------------------------------------------
The following tests failed:


	sage -t --long "devel/sage/sage/matrix/matrix2.pyx"
Total time for all tests: 37.9 seconds
```



---

archive/issue_comments_112802.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-04T00:48:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112802",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_112803.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:26 jason]:\n> and depend on the more widespread release testing to catch it on the platforms we don't have easy access to?\n\n\nYes.  If you think a patch looks reasonable and has been tested to some extent, just set it to positive_review.",
    "created_at": "2011-12-04T11:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112803",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>Replying to [comment:26 jason]:
> and depend on the more widespread release testing to catch it on the platforms we don't have easy access to?


Yes.  If you think a patch looks reasonable and has been tested to some extent, just set it to positive_review.



---

archive/issue_comments_112804.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 jhpalmieri]:\n> There are errors on sage.math and on OS X 10.6.8, applied to Sage 4.8.alpha3:\n\n\nJason, John, Jeroen - thanks for the attention to this, and the other outstanding linear algebra tickets.  I've been on an (extended) Sage vacation, but I think you are reeling me back in.  ;-)\n\nThis does need work.  Fix at #11544 prevents printing from having a side-effect that increases precision over QQbar.  I think this work predates that change.  So it does need work at the moment.\n\nI am building a fresh alpha right now and will try to get on top of outstanding tickets later today.  It'd be great to get a few of thse into 4.8 if it is not too late - I'll be using this stuff in class in the spring with my Sage-enabled textbook and a few of us are working on this CRC linear algebra handbook chapter that will be doctestable.\n\nThanks,\nRob",
    "created_at": "2011-12-04T19:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112804",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:29'></a>Replying to [comment:27 jhpalmieri]:
> There are errors on sage.math and on OS X 10.6.8, applied to Sage 4.8.alpha3:


Jason, John, Jeroen - thanks for the attention to this, and the other outstanding linear algebra tickets.  I've been on an (extended) Sage vacation, but I think you are reeling me back in.  ;-)

This does need work.  Fix at #11544 prevents printing from having a side-effect that increases precision over QQbar.  I think this work predates that change.  So it does need work at the moment.

I am building a fresh alpha right now and will try to get on top of outstanding tickets later today.  It'd be great to get a few of thse into 4.8 if it is not too late - I'll be using this stuff in class in the spring with my Sage-enabled textbook and a few of us are working on this CRC linear algebra handbook chapter that will be doctestable.

Thanks,
Rob



---

archive/issue_comments_112805.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-05T05:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112805",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_112806.json:
```json
{
    "body": "<a id='comment:30'></a>Attachment [trac_10791-gram-schmidt-qqbar-doctests.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-qqbar-doctests.patch) by @rbeezer created at 2011-12-05 05:12:50\n\nOh man, that was painful.  I am really rusty.  Use it or lose it.  But I'm back.\n\nPatch fixes failing doctests over QQbar, mostly by checking small norms on matrices which should be the zero matrix.  A bit brutal, but we don't have `round()` and `zero_at()` for matrices over QQbar.  (Those'd be a nice additions, no?).\n\nI got identical failures on Ubuntu.  Now passing all tests in matrix/matrix2.pyx.  My 4.8.alpha3 has some weirdness (Atlas segfaults), but I think this should be OK.\n\nThanks for the look, John and Jason.  Off to investigate a few other things.\n\nRob",
    "created_at": "2011-12-05T05:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112806",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:30'></a>Attachment [trac_10791-gram-schmidt-qqbar-doctests.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-qqbar-doctests.patch) by @rbeezer created at 2011-12-05 05:12:50

Oh man, that was painful.  I am really rusty.  Use it or lose it.  But I'm back.

Patch fixes failing doctests over QQbar, mostly by checking small norms on matrices which should be the zero matrix.  A bit brutal, but we don't have `round()` and `zero_at()` for matrices over QQbar.  (Those'd be a nice additions, no?).

I got identical failures on Ubuntu.  Now passing all tests in matrix/matrix2.pyx.  My 4.8.alpha3 has some weirdness (Atlas segfaults), but I think this should be OK.

Thanks for the look, John and Jason.  Off to investigate a few other things.

Rob



---

archive/issue_comments_112807.json:
```json
{
    "body": "<a id='comment:31'></a>Looks good.  Tested on OSX 10.6.8 and passes tests in matrix/*.pyx on sage-4.7.2.alpha3 (+some other patches I've applied)",
    "created_at": "2011-12-13T15:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112807",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:31'></a>Looks good.  Tested on OSX 10.6.8 and passes tests in matrix/*.pyx on sage-4.7.2.alpha3 (+some other patches I've applied)



---

archive/issue_comments_112808.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-13T15:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112808",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_112809.json:
```json
{
    "body": "<a id='comment:32'></a>The commit message of [attachment:trac_10791-gram-schmidt-negative-zero.patch] needs to be updated.",
    "created_at": "2011-12-16T10:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112809",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>The commit message of [attachment:trac_10791-gram-schmidt-negative-zero.patch] needs to be updated.



---

archive/issue_comments_112810.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-12-16T10:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112810",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_112811.json:
```json
{
    "body": "<a id='comment:33'></a>Attachment [trac_10791-gram-schmidt-negative-zero.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-negative-zero.patch) by @rbeezer created at 2011-12-16 16:04:31\n\nJeroen,\n\nMy mistake - very sorry about that.\n\nI have replaced the problem patch with one containing a commit message.\n\nRob",
    "created_at": "2011-12-16T16:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112811",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:33'></a>Attachment [trac_10791-gram-schmidt-negative-zero.patch](tarball://root/attachments/some-uuid/ticket10791/trac_10791-gram-schmidt-negative-zero.patch) by @rbeezer created at 2011-12-16 16:04:31

Jeroen,

My mistake - very sorry about that.

I have replaced the problem patch with one containing a commit message.

Rob



---

archive/issue_comments_112812.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-12-16T16:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112812",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_027840.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-17T09:12:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10791#event-27840"
}
```



---

archive/issue_comments_112813.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-12-17T09:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10791#issuecomment-112813",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
