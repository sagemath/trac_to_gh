# Issue 10637: Implement sage -sws2rst

archive/issues_010584.json:
```json
{
    "body": "Implement:\n\n```\n    sage -sws2rst bla.sws bli.sws ...\n```\n\nwhich given worksheets\n\n`bla.sws, bli.sws, ...` would create ReST files `bla.rst, bli.rst, ...` together with media directories:\n\n```\nmedia/bla/\nmedia/bla/data/\nmedia/bla/7/sage0.png\n...\nmedia/bli/\n...\n```\n\nThe proposed implementation adds a script\n`local/bin/sage-sws2rst`, edits `spkg/bin/sage` to add\nthe sws2rst option, and add some libraries in\n`sagenb-main/sagenb/notebook/`. It further depends on the\nBeautifulSoup Python library (released under Python's license).\n\nThe script builds the ReST file from the worksheet.html file included in the .sws as follow:\n\n- Preparsing to handle the input / output fields\n- Parsing of the resulting html using BeautifulSoup\n- Manipulation on the obtained tree\n\nSuggestions for better file layout or implementation welcome!\n\n## Install instructions\n\n* Install sagenb 0.10.6 (#14330)\n* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  \n* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository\n* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n\n## Release Manager Instructions\n* Add beautiful soup to the optional spkg directory: [http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository\n* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n\n**Assignee:** @jasongrout, @qed777, @williamstein\n\n**CC:**  @nthiery @hivert @seblabbe @kcrisman beezer whuss @novoselt @kini @jdemeyer\n\n**Keywords:** ReST, worksheet\n\n**Upstream:** Workaround found; Bug reported upstream.\n\n**Reviewer:** Nicolas M. Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo\n\n**Author:** Pablo Angulo, Karl-Dieter Crisman\n\n**Merged:** sage-5.12.beta0\n\n**Dependencies:** #14330\n\nIssue created by migration from https://trac.sagemath.org/ticket/10637\n\n",
    "closed_at": "2013-08-02T14:14:20Z",
    "created_at": "2011-01-17T18:12:35Z",
    "labels": [
        "component: notebook",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Implement sage -sws2rst",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10637",
    "user": "https://github.com/nthiery"
}
```
Implement:

```
    sage -sws2rst bla.sws bli.sws ...
```

which given worksheets

`bla.sws, bli.sws, ...` would create ReST files `bla.rst, bli.rst, ...` together with media directories:

```
media/bla/
media/bla/data/
media/bla/7/sage0.png
...
media/bli/
...
```

The proposed implementation adds a script
`local/bin/sage-sws2rst`, edits `spkg/bin/sage` to add
the sws2rst option, and add some libraries in
`sagenb-main/sagenb/notebook/`. It further depends on the
BeautifulSoup Python library (released under Python's license).

The script builds the ReST file from the worksheet.html file included in the .sws as follow:

- Preparsing to handle the input / output fields
- Parsing of the resulting html using BeautifulSoup
- Manipulation on the obtained tree

Suggestions for better file layout or implementation welcome!

## Install instructions

* Install sagenb 0.10.6 (#14330)
* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  
* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository
* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository

## Release Manager Instructions
* Add beautiful soup to the optional spkg directory: [http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository
* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository

**Assignee:** @jasongrout, @qed777, @williamstein

**CC:**  @nthiery @hivert @seblabbe @kcrisman beezer whuss @novoselt @kini @jdemeyer

**Keywords:** ReST, worksheet

**Upstream:** Workaround found; Bug reported upstream.

**Reviewer:** Nicolas M. Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo

**Author:** Pablo Angulo, Karl-Dieter Crisman

**Merged:** sage-5.12.beta0

**Dependencies:** #14330

Issue created by migration from https://trac.sagemath.org/ticket/10637





---

archive/issue_comments_105269.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,8 +6,7 @@\n \n which given worksheets\n \n-`bla.sws, bli.sws, ...` would create ReST files {{{bla.rst,\n-bli.rst, ...}}} together with media directories:\n+`bla.sws, bli.sws, ...` would create ReST files `bla.rst, bli.rst, ...` together with media directories:\n \n ```\n media/bla/\n@@ -24,10 +23,9 @@\n `sagenb-main/sagenb/notebook/`. It further depends on the\n BeautifulSoup Python library (released under Python's license).\n \n-The script builds the ReST file from the included worksheet.html file\n-as follow:\n+The script builds the ReST file from the worksheet.html file included in the .sws as follow:\n \n-- Preparsing to handle the ` / `\n+- Preparsing to handle the input / output fields\n - Parsing of the resulting html using BeautifulSoup\n - Manipulation on the obtained tree\n \n``````\n",
    "created_at": "2011-01-17T18:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105269",
    "user": "https://github.com/nthiery"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,8 +6,7 @@
 
 which given worksheets
 
-`bla.sws, bli.sws, ...` would create ReST files {{{bla.rst,
-bli.rst, ...}}} together with media directories:
+`bla.sws, bli.sws, ...` would create ReST files `bla.rst, bli.rst, ...` together with media directories:
 
 ```
 media/bla/
@@ -24,10 +23,9 @@
 `sagenb-main/sagenb/notebook/`. It further depends on the
 BeautifulSoup Python library (released under Python's license).
 
-The script builds the ReST file from the included worksheet.html file
-as follow:
+The script builds the ReST file from the worksheet.html file included in the .sws as follow:
 
-- Preparsing to handle the ` / `
+- Preparsing to handle the input / output fields
 - Parsing of the resulting html using BeautifulSoup
 - Manipulation on the obtained tree
 
``````




---

archive/issue_comments_105270.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -29,3 +29,4 @@\n - Parsing of the resulting html using BeautifulSoup\n - Manipulation on the obtained tree\n \n+Suggestions for better file layout or implementation welcome!\n``````\n",
    "created_at": "2011-01-17T18:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105270",
    "user": "https://github.com/nthiery"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -29,3 +29,4 @@
 - Parsing of the resulting html using BeautifulSoup
 - Manipulation on the obtained tree
 
+Suggestions for better file layout or implementation welcome!
``````




---

archive/issue_comments_105271.json:
```json
{
    "body": "sage package for BeautifulSoup",
    "created_at": "2011-01-17T23:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105271",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

sage package for BeautifulSoup



---

archive/attachments_013924.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "beautifulsoup-3.2.0.p0.spkg",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/beautifulsoup-3.2.0.p0.spkg",
    "created_at": "2011-01-17T23:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.spkg",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105272.json:
```json
{
    "body": "<a id='comment:3'></a>\nSo I have some preliminary code, but after a conversation with Vincent there is some things I have to check. For the moment, I have uploaded a sage package for BeautifulSoup, which I think is important in dealing with the html code generated by tinyMCE, and which I use in the preliminary code. It's pretty straightforward so I hope it works in other platforms. I only tested on linux 32 bits, but it's a pure python file.",
    "created_at": "2011-01-17T23:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105272",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:3'></a>
So I have some preliminary code, but after a conversation with Vincent there is some things I have to check. For the moment, I have uploaded a sage package for BeautifulSoup, which I think is important in dealing with the html code generated by tinyMCE, and which I use in the preliminary code. It's pretty straightforward so I hope it works in other platforms. I only tested on linux 32 bits, but it's a pure python file.



---

archive/attachments_013925.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "add_sws2rst.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/add_sws2rst.patch",
    "created_at": "2011-01-19T18:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105273.json:
```json
{
    "body": "patch to be applied on local/bin",
    "created_at": "2011-01-19T18:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105273",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

patch to be applied on local/bin



---

archive/issue_comments_105274.json:
```json
{
    "body": "patch to be applied on sagenb",
    "created_at": "2011-01-19T18:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105274",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

patch to be applied on sagenb



---

archive/attachments_013926.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "tools_for_sws2rst.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/tools_for_sws2rst.patch",
    "created_at": "2011-01-19T18:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105275.json:
```json
{
    "body": "<a id='comment:4'></a>\n## Install instructions\n\n* It's necessary to install the beautifulsoup spkg\n\n* A first patch adds the sage-sws2rst script, and it must be imported on the local/bin dir\n\n* A second patch sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a\n\n```\n    sage -python setup.py install && sage -python setup.py develop\n```\n\n## Comments\n\nThe code above is preliminary and undocumented, but I post it in order to guide the discussion. I'll write comments and make improvements when we decide on some issues.\n\nI have to warn the task is not trivial, as html is more relaxed than rst, so that some editing is required after the conversion. The result from the script produces rst files that get compiled correctly only on occassion, but usually the modifications required are not much.\n\n## How it works\n\nThe sws file is uncompressed, and the images inside the 'data' and the 'cell/xx' dirs ar copied to a '_media' dir (this is done by the sage-sws2rst file). \n\nThen the file worksheet.html is parsed, and split into comments, source code and output. The first is handled using the library BeautifulSoup. Source code is mostly untouched, and results are parsed to find some patterns like \"image\", \"latex\", \"docstring\", \"other html patterns\" and \"plain text\". The first two are displayed. The docstring, or any unrecognized html in the result cells are discarded. Plain text is indented, and is recognized as the output of the previous cell.\n\n## Issues\n\n* rest does not understand that images or latex are the output of some code cells.\n\n* docstrings are ignored. I felt stupid trying to parse some html that comes from a rst file. Maybe I can grab the rst file from the source, but only if it belongs to the library, so is it worth it?\n\nPlease add your concerns here.",
    "created_at": "2011-01-19T18:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105275",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:4'></a>
## Install instructions

* It's necessary to install the beautifulsoup spkg

* A first patch adds the sage-sws2rst script, and it must be imported on the local/bin dir

* A second patch sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a

```
    sage -python setup.py install && sage -python setup.py develop
```

## Comments

The code above is preliminary and undocumented, but I post it in order to guide the discussion. I'll write comments and make improvements when we decide on some issues.

I have to warn the task is not trivial, as html is more relaxed than rst, so that some editing is required after the conversion. The result from the script produces rst files that get compiled correctly only on occassion, but usually the modifications required are not much.

## How it works

The sws file is uncompressed, and the images inside the 'data' and the 'cell/xx' dirs ar copied to a '_media' dir (this is done by the sage-sws2rst file). 

Then the file worksheet.html is parsed, and split into comments, source code and output. The first is handled using the library BeautifulSoup. Source code is mostly untouched, and results are parsed to find some patterns like "image", "latex", "docstring", "other html patterns" and "plain text". The first two are displayed. The docstring, or any unrecognized html in the result cells are discarded. Plain text is indented, and is recognized as the output of the previous cell.

## Issues

* rest does not understand that images or latex are the output of some code cells.

* docstrings are ignored. I felt stupid trying to parse some html that comes from a rst file. Maybe I can grab the rst file from the source, but only if it belongs to the library, so is it worth it?

Please add your concerns here.



---

archive/issue_comments_105276.json:
```json
{
    "body": "<a id='comment:6'></a>\nI dont know if it can help but this week I found this makefile which helped me to understand how to call sphinx with which options :\n\n```\ndevel/sage-main/doc/en/tutorial/Makefile\n```",
    "created_at": "2011-01-21T00:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105276",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:6'></a>
I dont know if it can help but this week I found this makefile which helped me to understand how to call sphinx with which options :

```
devel/sage-main/doc/en/tutorial/Makefile
```



---

archive/attachments_013927.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "add_sws2rst_2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/add_sws2rst_2.patch",
    "created_at": "2011-02-28T11:42:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105277.json:
```json
{
    "body": "replaces the first patch",
    "created_at": "2011-02-28T11:42:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105277",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

replaces the first patch



---

archive/attachments_013928.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "tools_sws2rst_2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/tools_sws2rst_2.patch",
    "created_at": "2011-02-28T11:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105278.json:
```json
{
    "body": "replaces the first patch",
    "created_at": "2011-02-28T11:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105278",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

replaces the first patch



---

archive/issue_comments_105279.json:
```json
{
    "body": "<a id='comment:7'></a>\nI have tested this patch against a huge group of complex worksheets, and I'm satisfied with the result. I took into account many little things that are Sage specific or tinyMCE specific, but this new patch is still not 100% guaranteed to produce valid rst. However, it's very likely that the result will get compiled by sage -docbuild, and it's very likely that only small changes are required.\n\nI'm still open to general suggestions.",
    "created_at": "2011-02-28T11:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105279",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:7'></a>
I have tested this patch against a huge group of complex worksheets, and I'm satisfied with the result. I took into account many little things that are Sage specific or tinyMCE specific, but this new patch is still not 100% guaranteed to produce valid rst. However, it's very likely that the result will get compiled by sage -docbuild, and it's very likely that only small changes are required.

I'm still open to general suggestions.



---

archive/issue_events_083869.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pang",
    "created_at": "2011-02-28T11:49:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83869"
}
```



---

archive/issue_comments_105280.json:
```json
{
    "body": "<a id='comment:9'></a>\nHi Pablo!\n\nI just used your script for preparing my next demo from a previous\nworksheet. It worked smoothly, thanks so much! It would be really good\nto get this in; alas, I don't feel qualified to review code touching\nthe notebook. A couple tiny comments:\n\n* Could you add the installation instructions to the ticket\n  description? This will make Jeroen happy :-)\n\n* I had to fix the execution rights on the script:\n\n  ```\n   chmod +x /opt/sage/local/bin/sage-sws2rst\n  ```\n\n* Shall the advertisement of the option appear in `sage -h` or\n  `sage -advanced`. I could argue for `sage -h` since this\n  functionality is for sage users as much as developpers.\n\n* Support for converting several sws at once would be handy.\n\n* I got this warning each time I ran the script:\n\n  ```\n    /opt/sage/local/bin/sage-sws2rst:19: RuntimeWarning: tempnam is a potential security risk to your program\n    tempname = os.tempnam('.')\n  ```\n\nCheers,\n  \t\t\t\tNicolas",
    "created_at": "2011-03-30T19:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105280",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:9'></a>
Hi Pablo!

I just used your script for preparing my next demo from a previous
worksheet. It worked smoothly, thanks so much! It would be really good
to get this in; alas, I don't feel qualified to review code touching
the notebook. A couple tiny comments:

* Could you add the installation instructions to the ticket
  description? This will make Jeroen happy :-)

* I had to fix the execution rights on the script:

  ```
   chmod +x /opt/sage/local/bin/sage-sws2rst
  ```

* Shall the advertisement of the option appear in `sage -h` or
  `sage -advanced`. I could argue for `sage -h` since this
  functionality is for sage users as much as developpers.

* Support for converting several sws at once would be handy.

* I got this warning each time I ran the script:

  ```
    /opt/sage/local/bin/sage-sws2rst:19: RuntimeWarning: tempnam is a potential security risk to your program
    tempname = os.tempnam('.')
  ```

Cheers,
  				Nicolas



---

archive/issue_comments_105281.json:
```json
{
    "body": "<a id='comment:10'></a>\nnthiery, this is still reviewing!  I'm adding you, even if you don't feel like you can give positive review.\n\nAlso, we'll want correct commit messages for the release manager.\n\nIt is really a shame that the work here, at tex2sws, and sws2tex are not coordinated.  I'm just cc:ing some of those people so they are aware of this.  Eventually, of course, those should both be part of the standard Sage, and one could refactor some of them.  Well, at least of sws2tex and sws2rst.",
    "created_at": "2011-03-30T20:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105281",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
nthiery, this is still reviewing!  I'm adding you, even if you don't feel like you can give positive review.

Also, we'll want correct commit messages for the release manager.

It is really a shame that the work here, at tex2sws, and sws2tex are not coordinated.  I'm just cc:ing some of those people so they are aware of this.  Eventually, of course, those should both be part of the standard Sage, and one could refactor some of them.  Well, at least of sws2tex and sws2rst.



---

archive/issue_comments_105282.json:
```json
{
    "body": "**Reviewer:** Nicolas Thi\u00e9ry",
    "created_at": "2011-03-30T20:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105282",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Nicolas Thiéry



---

archive/issue_comments_105283.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry\" to \"Nicolas Thi\u00e9ry, ...\".",
    "created_at": "2011-03-31T07:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105283",
    "user": "https://github.com/nthiery"
}
```

**Changing reviewer** from "Nicolas Thiéry" to "Nicolas Thiéry, ...".



---

archive/issue_comments_105284.json:
```json
{
    "body": "<a id='comment:11'></a>\nAh, I forgot to mention:\n\nWhat about using '----' instead of ':::::' to underline subsection titles?\n\nIt seems a bit more readable, and ':' is already used quite a lot by\nSphinx; and one could imagine a very (very!) short title producing a\nconfusing '::'.\n\nCheers,\n\t\t\t\tNicolas",
    "created_at": "2011-03-31T07:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105284",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:11'></a>
Ah, I forgot to mention:

What about using '----' instead of ':::::' to underline subsection titles?

It seems a bit more readable, and ':' is already used quite a lot by
Sphinx; and one could imagine a very (very!) short title producing a
confusing '::'.

Cheers,
				Nicolas



---

archive/issue_comments_105285.json:
```json
{
    "body": "<a id='comment:12'></a>\nFor the record, the following tests fail with the patches applied on 4.6.2 with `Error: TAB character found`\n\n```\n   sage -t  \"4.6.2/devel/sagenb-main/sagenb/misc/worksheet2rst.py\"\n   sage -t  \"4.6.2/devel/sagenb-main/sagenb/misc/comments2rst.py\"\n```",
    "created_at": "2011-04-06T06:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105285",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:12'></a>
For the record, the following tests fail with the patches applied on 4.6.2 with `Error: TAB character found`

```
   sage -t  "4.6.2/devel/sagenb-main/sagenb/misc/worksheet2rst.py"
   sage -t  "4.6.2/devel/sagenb-main/sagenb/misc/comments2rst.py"
```



---

archive/issue_comments_105286.json:
```json
{
    "body": "<a id='comment:13'></a>\nHello: I've addressed those issues, but I can't pass a test with a message:\n\n```\nExpected:\n    '::\\n\\n    sage: 2+2'\nGot:\n    '::\\n\\n    sage: 2+2'\n```\n\nThey look the same. They both use spaces, not tabs.\n\nIf I run the test from a sage console, it works (with ==).\n\nany ideas?",
    "created_at": "2011-04-06T14:06:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105286",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:13'></a>
Hello: I've addressed those issues, but I can't pass a test with a message:

```
Expected:
    '::\n\n    sage: 2+2'
Got:
    '::\n\n    sage: 2+2'
```

They look the same. They both use spaces, not tabs.

If I run the test from a sage console, it works (with ==).

any ideas?



---

archive/attachments_013929.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "add_sws2rst_3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/add_sws2rst_3.patch",
    "created_at": "2011-04-08T10:40:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105287.json:
```json
{
    "body": "add_sws2rst_3.patch (replaces earlier versions)",
    "created_at": "2011-04-08T10:40:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105287",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

add_sws2rst_3.patch (replaces earlier versions)



---

archive/issue_comments_105288.json:
```json
{
    "body": "tools_sws2rst_3.patch (replaces earlier versions)",
    "created_at": "2011-04-08T10:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105288",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

tools_sws2rst_3.patch (replaces earlier versions)



---

archive/issue_comments_105289.json:
```json
{
    "body": "**Changing assignee** from @jasongrout, @qed777, @williamstein to pang.",
    "created_at": "2011-04-08T10:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105289",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

**Changing assignee** from @jasongrout, @qed777, @williamstein to pang.



---

archive/issue_comments_105290.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -30,3 +30,17 @@\n - Manipulation on the obtained tree\n \n Suggestions for better file layout or implementation welcome!\n+\n+Edit: \n+## Install instructions\n+\n+* Install the beautifulsoup spkg\n+\n+* A first patch (add_sws2rst_3.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir\n+\n+* A second patch (tools_sws2rst_3.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a\n+\n+```\n+    sage -python setup.py install && sage -python setup.py develop\n+```\n+\n``````\n",
    "created_at": "2011-04-08T10:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105290",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -30,3 +30,17 @@
 - Manipulation on the obtained tree
 
 Suggestions for better file layout or implementation welcome!
+
+Edit: 
+## Install instructions
+
+* Install the beautifulsoup spkg
+
+* A first patch (add_sws2rst_3.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir
+
+* A second patch (tools_sws2rst_3.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a
+
+```
+    sage -python setup.py install && sage -python setup.py develop
+```
+
``````




---

archive/attachments_013930.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "tools_sws2rst_3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/tools_sws2rst_3.patch",
    "created_at": "2011-04-08T10:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105291.json:
```json
{
    "body": "<a id='comment:14'></a>\nDone. I also added some tests:\n\n   * I replaced ''' by \"\"\", otherwise tests are ignored!!!\n   * I don't use the tests which include the word sage:, because they fail in weird ways. This is a consequence of the testing framework.",
    "created_at": "2011-04-08T10:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105291",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:14'></a>
Done. I also added some tests:

   * I replaced ''' by """, otherwise tests are ignored!!!
   * I don't use the tests which include the word sage:, because they fail in weird ways. This is a consequence of the testing framework.



---

archive/issue_comments_105292.json:
```json
{
    "body": "**Changing assignee** from pang to @jasongrout, @qed777, @williamstein.",
    "created_at": "2011-04-08T10:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105292",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

**Changing assignee** from pang to @jasongrout, @qed777, @williamstein.



---

archive/issue_comments_105293.json:
```json
{
    "body": "<a id='comment:15'></a>\nDone. I also added some tests:\n \n   * I replaced ' ' ' by \" \" \", otherwise tests are ignored!!!\n   * I don't use the tests which include the word sage:, because they fail in weird ways. This is a consequence of the testing framework.",
    "created_at": "2011-04-08T10:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105293",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:15'></a>
Done. I also added some tests:
 
   * I replaced ' ' ' by " " ", otherwise tests are ignored!!!
   * I don't use the tests which include the word sage:, because they fail in weird ways. This is a consequence of the testing framework.



---

archive/issue_comments_105294.json:
```json
{
    "body": "<a id='comment:16'></a>\nThis is great! I notice that when this is run on old notebook files, one gets the following error:\n\n```\n    Traceback (most recent call last):\n  File \"/usr/local/src/sage/sage-4.7.rc0/local/bin/sage-sws2rst\", line 66, in <module>\n    process_sws(file_name)\n  File \"/usr/local/src/sage/sage-4.7.rc0/local/bin/sage-sws2rst\", line 38, in process_sws\n    for cell in os.listdir(cells_path):\nOSError: [Errno 2] No such file or directory: '/tmp/Iterators and backtracking.sws/sage_worksheet/cells'\n```\n\nI think this is because there is another directory level on these old-style worksheets:\n\n```\n   '/tmp/Iterators and backtracking.sws/sage_worksheet/<some number>/cells'\n```\n\nIt would be nice if this error could be caught and the user given a message to the effect of \"Conversion failed. Try opening your notebook with a recent version of sage, resaving it, and running the script again\".",
    "created_at": "2011-05-01T12:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105294",
    "user": "https://github.com/jbandlow"
}
```

<a id='comment:16'></a>
This is great! I notice that when this is run on old notebook files, one gets the following error:

```
    Traceback (most recent call last):
  File "/usr/local/src/sage/sage-4.7.rc0/local/bin/sage-sws2rst", line 66, in <module>
    process_sws(file_name)
  File "/usr/local/src/sage/sage-4.7.rc0/local/bin/sage-sws2rst", line 38, in process_sws
    for cell in os.listdir(cells_path):
OSError: [Errno 2] No such file or directory: '/tmp/Iterators and backtracking.sws/sage_worksheet/cells'
```

I think this is because there is another directory level on these old-style worksheets:

```
   '/tmp/Iterators and backtracking.sws/sage_worksheet/<some number>/cells'
```

It would be nice if this error could be caught and the user given a message to the effect of "Conversion failed. Try opening your notebook with a recent version of sage, resaving it, and running the script again".



---

archive/issue_comments_105295.json:
```json
{
    "body": "<a id='comment:17'></a>\n''' This post is just an attempt to close the boldface.",
    "created_at": "2011-05-01T12:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105295",
    "user": "https://github.com/jbandlow"
}
```

<a id='comment:17'></a>
''' This post is just an attempt to close the boldface.



---

archive/issue_comments_105296.json:
```json
{
    "body": "<a id='comment:18'></a>\nI followed the directions in the description to install, but got this when I tried running it:\n\n```\n\n% sage -sws2rst mysheet.sws\n/Users/grout/sage/local/bin/sage-sage: line 385: /Users/grout/sage/local/bin/sage-sws2rst: Permission denied\n```\n\nSo perhaps it needs an executable bit, or the patch needs to be exported in git format to pick that up?",
    "created_at": "2011-06-10T07:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105296",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:18'></a>
I followed the directions in the description to install, but got this when I tried running it:

```

% sage -sws2rst mysheet.sws
/Users/grout/sage/local/bin/sage-sage: line 385: /Users/grout/sage/local/bin/sage-sws2rst: Permission denied
```

So perhaps it needs an executable bit, or the patch needs to be exported in git format to pick that up?



---

archive/issue_comments_105297.json:
```json
{
    "body": "<a id='comment:19'></a>\nMy worksheet name included spaces.  A few images led to this being in the text: \n\n```\n.. image:: PREP Quickstart, NumAnalysis_media/cell_5_sage0.png\n\n```\n\nHowever, the html output from running sphinx on the rst file included a link to this image:\n\n```\n<img alt=\"PREPQuickstart,NumAnalysis_media/cell_5_sage0.png\" class=\"align-center\" src=\"PREPQuickstart,NumAnalysis_media/cell_5_sage0.png\" /> \n\n```\n\n(notice the missing spaces)\n\nI looked around and this is a bug report here: https://bitbucket.org/birkenfeld/sphinx/issue/453/spaces-get-stripped-from-image-file-names\n\nAccording to http://docutils.sourceforge.net/docs/howto/rst-directives.html#image, the first thing done in the image directive is to discard all whitespace, so this script should probably discard all whitespace when making the image links.",
    "created_at": "2011-06-10T07:16:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105297",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:19'></a>
My worksheet name included spaces.  A few images led to this being in the text: 

```
.. image:: PREP Quickstart, NumAnalysis_media/cell_5_sage0.png

```

However, the html output from running sphinx on the rst file included a link to this image:

```
<img alt="PREPQuickstart,NumAnalysis_media/cell_5_sage0.png" class="align-center" src="PREPQuickstart,NumAnalysis_media/cell_5_sage0.png" /> 

```

(notice the missing spaces)

I looked around and this is a bug report here: https://bitbucket.org/birkenfeld/sphinx/issue/453/spaces-get-stripped-from-image-file-names

According to http://docutils.sourceforge.net/docs/howto/rst-directives.html#image, the first thing done in the image directive is to discard all whitespace, so this script should probably discard all whitespace when making the image links.



---

archive/issue_comments_105298.json:
```json
{
    "body": "<a id='comment:20'></a>\nI just converted a worksheet, and the input/output of a cell got converted so that the output was indented with a tab:\n\n```\n\n    sage: spline[1]\n\t1/2*(x - 2)*((-14.3540674845*x + 37.3205750783)*(x - 2) + 25.741626739501953) + 20.0\n```\n\nIt seems like the output should be indented 4 spaces instead.",
    "created_at": "2011-06-10T11:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105298",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:20'></a>
I just converted a worksheet, and the input/output of a cell got converted so that the output was indented with a tab:

```

    sage: spline[1]
	1/2*(x - 2)*((-14.3540674845*x + 37.3205750783)*(x - 2) + 25.741626739501953) + 20.0
```

It seems like the output should be indented 4 spaces instead.



---

archive/attachments_013931.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "add_sws2rst_4.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/add_sws2rst_4.patch",
    "created_at": "2011-06-27T14:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105299.json:
```json
{
    "body": "add_sws2rst_4.patch (replaces earlier versions)",
    "created_at": "2011-06-27T14:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105299",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

add_sws2rst_4.patch (replaces earlier versions)



---

archive/issue_comments_105300.json:
```json
{
    "body": "tools_sws2rst_43.patch (replaces earlier versions)",
    "created_at": "2011-06-27T14:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105300",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

tools_sws2rst_43.patch (replaces earlier versions)



---

archive/issue_comments_105301.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -36,9 +36,9 @@\n \n * Install the beautifulsoup spkg\n \n-* A first patch (add_sws2rst_3.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir\n+* A first patch (add_sws2rst_4.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir\n \n-* A second patch (tools_sws2rst_3.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a\n+* A second patch (tools_sws2rst_4.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a\n \n ```\n     sage -python setup.py install && sage -python setup.py develop\n``````\n",
    "created_at": "2011-06-27T14:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105301",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -36,9 +36,9 @@
 
 * Install the beautifulsoup spkg
 
-* A first patch (add_sws2rst_3.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir
+* A first patch (add_sws2rst_4.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir
 
-* A second patch (tools_sws2rst_3.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a
+* A second patch (tools_sws2rst_4.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a
 
 ```
     sage -python setup.py install && sage -python setup.py develop
``````




---

archive/attachments_013932.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "tools_sws2rst_4.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/tools_sws2rst_4.patch",
    "created_at": "2011-06-27T14:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105302.json:
```json
{
    "body": "<a id='comment:21'></a>\n",
    "created_at": "2011-06-27T14:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105302",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:21'></a>




---

archive/issue_comments_105303.json:
```json
{
    "body": "<a id='comment:22'></a>\nSolved the problems mentioned by jason: thanks for testing it.",
    "created_at": "2011-06-27T14:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105303",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:22'></a>
Solved the problems mentioned by jason: thanks for testing it.



---

archive/issue_comments_105304.json:
```json
{
    "body": "<a id='comment:23'></a>\njbandlow, \u00bfcan you send me an old worksheet file? in the old worksheets that I keep, it's rather\n\n```\n/tmp_dir/<some number>/cells\n```\nthan \n\n```\n/tmp_dir/sage_worksheet/<some number>/cells\n```\nIt is possible to deal with the old style directly, unless you have a reason to force the user to pass the worksheet through a newer version...",
    "created_at": "2011-06-27T14:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105304",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:23'></a>
jbandlow, ¿can you send me an old worksheet file? in the old worksheets that I keep, it's rather

```
/tmp_dir/<some number>/cells
```
than 

```
/tmp_dir/sage_worksheet/<some number>/cells
```
It is possible to deal with the old style directly, unless you have a reason to force the user to pass the worksheet through a newer version...



---

archive/issue_comments_105305.json:
```json
{
    "body": "<a id='comment:24'></a>\nHere is another related project - [sws2tex](https://bitbucket.org/whuss/sws2tex/), though it uses `HTMLParser` instead of `Beautiful Soup`.",
    "created_at": "2011-07-01T01:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105305",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>
Here is another related project - [sws2tex](https://bitbucket.org/whuss/sws2tex/), though it uses `HTMLParser` instead of `Beautiful Soup`.



---

archive/issue_comments_105306.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [kcrisman](#comment%3A24):\n> Here is another related project - [sws2tex](https://bitbucket.org/whuss/sws2tex/), though it uses `HTMLParser` instead of `Beautiful Soup`.\n\n\nI know, someone told me about that project before. Though it may seem like duplicated effort, the approach is different: sws2tex converts html+css style into latex style, color by color, font by font, while sws2rst ignores all style. Still I might learn from the code, for sure.",
    "created_at": "2011-07-01T09:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105306",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:25'></a>
Replying to [kcrisman](#comment%3A24):
> Here is another related project - [sws2tex](https://bitbucket.org/whuss/sws2tex/), though it uses `HTMLParser` instead of `Beautiful Soup`.


I know, someone told me about that project before. Though it may seem like duplicated effort, the approach is different: sws2tex converts html+css style into latex style, color by color, font by font, while sws2rst ignores all style. Still I might learn from the code, for sure.



---

archive/issue_comments_105307.json:
```json
{
    "body": "<a id='comment:26'></a>\nJust checking, but has `tools_sws2rst_4.patch` been ported to the new notebook at http://github.com/sagemath/sagenb ?",
    "created_at": "2012-05-25T00:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105307",
    "user": "https://github.com/kini"
}
```

<a id='comment:26'></a>
Just checking, but has `tools_sws2rst_4.patch` been ported to the new notebook at http://github.com/sagemath/sagenb ?



---

archive/issue_comments_105308.json:
```json
{
    "body": "**Dependencies:** #11080",
    "created_at": "2012-05-25T20:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105308",
    "user": "https://github.com/kini"
}
```

**Dependencies:** #11080



---

archive/issue_comments_105309.json:
```json
{
    "body": "<a id='comment:27'></a>\nSetting #11080 as a dependency because the old notebook is basically abandoned now.",
    "created_at": "2012-05-25T20:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105309",
    "user": "https://github.com/kini"
}
```

<a id='comment:27'></a>
Setting #11080 as a dependency because the old notebook is basically abandoned now.



---

archive/issue_comments_105310.json:
```json
{
    "body": "<a id='comment:28'></a>\nLow-priority comment: Beautiful Soup is now at [version 4](http://www.crummy.com/software/BeautifulSoup/), though that is under the MIT license.  It works with Python 2.7 and 3.  The 3.2.1 maintenance release is as of last February, also not too old.",
    "created_at": "2012-06-04T21:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105310",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:28'></a>
Low-priority comment: Beautiful Soup is now at [version 4](http://www.crummy.com/software/BeautifulSoup/), though that is under the MIT license.  It works with Python 2.7 and 3.  The 3.2.1 maintenance release is as of last February, also not too old.



---

archive/issue_comments_105311.json:
```json
{
    "body": "<a id='comment:29'></a>\nTechnical comment: see [the latest spkg-install instructions](http://www.sagemath.org/doc/developer/producing_spkgs.html#section-spkg-install) for a slight update on the shell commands - in particular, we should have a nonempty exit check at the end, and the `SAGE_LOCAL` bit has changed slightly.\n\nAlso, you don't need to make this a `p0` package, because there are no patches!  :)",
    "created_at": "2012-06-04T21:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105311",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:29'></a>
Technical comment: see [the latest spkg-install instructions](http://www.sagemath.org/doc/developer/producing_spkgs.html#section-spkg-install) for a slight update on the shell commands - in particular, we should have a nonempty exit check at the end, and the `SAGE_LOCAL` bit has changed slightly.

Also, you don't need to make this a `p0` package, because there are no patches!  :)



---

archive/issue_comments_105312.json:
```json
{
    "body": "**Changing upstream** from \"N/A\" to \"Reported upstream. No feedback yet.\".",
    "created_at": "2012-06-04T21:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105312",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "N/A" to "Reported upstream. No feedback yet.".



---

archive/issue_events_083870.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-04T21:25:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83870"
}
```



---

archive/issue_events_083871.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-04T21:25:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83871"
}
```



---

archive/issue_comments_105313.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, ...\" to \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow\".",
    "created_at": "2012-06-04T21:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105313",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nicolas Thiéry, ..." to "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow".



---

archive/issue_comments_105314.json:
```json
{
    "body": "<a id='comment:30'></a>\nLess trivially, and for this 'needs work':\n* Your patch probably won't apply - there is no longer the script `sage-sage`!  See e.g. [the 5.0 sage-sage rump](http://hg.sagemath.org/scripts-main/file/9a82a7ebfb54/sage-sage#l1).  Luckily, you can probably create nearly the same patch to the new script (which is the old script) at `$SAGE_ROOT/spkg/bin/sage`.\n* The notebook is now \"upstream\", so to speak, so we need to report this there and can't really merge it until the new notebook is in in any case.  I've submitted an upstream issue report at [this location](https://github.com/sagemath/sagenb/issues/51).\n\nSo might as well upgrade Beautiful Soup and fix the other stuff too.  I would like to try this over the next few weeks to finally start migrating some documentation to ReST format, so I may do all this if I get a chance.",
    "created_at": "2012-06-04T21:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105314",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:30'></a>
Less trivially, and for this 'needs work':
* Your patch probably won't apply - there is no longer the script `sage-sage`!  See e.g. [the 5.0 sage-sage rump](http://hg.sagemath.org/scripts-main/file/9a82a7ebfb54/sage-sage#l1).  Luckily, you can probably create nearly the same patch to the new script (which is the old script) at `$SAGE_ROOT/spkg/bin/sage`.
* The notebook is now "upstream", so to speak, so we need to report this there and can't really merge it until the new notebook is in in any case.  I've submitted an upstream issue report at [this location](https://github.com/sagemath/sagenb/issues/51).

So might as well upgrade Beautiful Soup and fix the other stuff too.  I would like to try this over the next few weeks to finally start migrating some documentation to ReST format, so I may do all this if I get a chance.



---

archive/issue_comments_105315.json:
```json
{
    "body": "<a id='comment:31'></a>\nThanks a lot for the careful comment on what needs to be updated. I'll take care soon.",
    "created_at": "2012-06-05T09:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105315",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:31'></a>
Thanks a lot for the careful comment on what needs to be updated. I'll take care soon.



---

archive/issue_comments_105316.json:
```json
{
    "body": "<a id='comment:32'></a>\n> Thanks a lot for the careful comment on what needs to be updated. I'll take care soon.\n\nGreat; I would much rather *review* this functionality so that I can use it than do all of that!  Looking forward to it.",
    "created_at": "2012-06-05T13:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105316",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:32'></a>
> Thanks a lot for the careful comment on what needs to be updated. I'll take care soon.

Great; I would much rather *review* this functionality so that I can use it than do all of that!  Looking forward to it.



---

archive/issue_comments_105317.json:
```json
{
    "body": "<a id='comment:33'></a>\nJust to encourage you, I took a look and it looks like you can really practically take the identical patch, just on this new file!  Since all the other files are new, and don't seem to interact with anything else, they should be fine.\n\nI'm even wondering whether `sage-sws2rst` would need to live in Sage.  This is nearly pure notebook functionality.   But maybe that would be for another ticket; far more important to get this in.  I may try at least doing this \"by hand\" next week to work on my project.",
    "created_at": "2012-06-16T03:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105317",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:33'></a>
Just to encourage you, I took a look and it looks like you can really practically take the identical patch, just on this new file!  Since all the other files are new, and don't seem to interact with anything else, they should be fine.

I'm even wondering whether `sage-sws2rst` would need to live in Sage.  This is nearly pure notebook functionality.   But maybe that would be for another ticket; far more important to get this in.  I may try at least doing this "by hand" next week to work on my project.



---

archive/issue_comments_105318.json:
```json
{
    "body": "<a id='comment:34'></a>\nNew Beautiful Soup spkg at [http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg) this location.  I'm going with the maintenance release for now because I don't want to have to think about licenses.\n\nI'll try to figure out what to do with the other stuff soon; shouldn't be hard, but I always have trouble with the new notebook upstream business...",
    "created_at": "2012-06-21T00:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105318",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:34'></a>
New Beautiful Soup spkg at [http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg) this location.  I'm going with the maintenance release for now because I don't want to have to think about licenses.

I'll try to figure out what to do with the other stuff soon; shouldn't be hard, but I always have trouble with the new notebook upstream business...



---

archive/issue_comments_105319.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -34,7 +34,7 @@\n Edit: \n ## Install instructions\n \n-* Install the beautifulsoup spkg\n+* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n \n * A first patch (add_sws2rst_4.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir\n \n``````\n",
    "created_at": "2012-06-21T00:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105319",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -34,7 +34,7 @@
 Edit: 
 ## Install instructions
 
-* Install the beautifulsoup spkg
+* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
 
 * A first patch (add_sws2rst_4.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir
 
``````




---

archive/issue_comments_105320.json:
```json
{
    "body": "<a id='comment:35'></a>\nRebased the patch for the sage script for the root directory.  I put its advanced message in documentation because all the other sections were even worse, and it certainly can lead to documentation.  I'm open to ideas about that, though.",
    "created_at": "2012-06-21T00:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105320",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:35'></a>
Rebased the patch for the sage script for the root directory.  I put its advanced message in documentation because all the other sections were even worse, and it certainly can lead to documentation.  I'm open to ideas about that, though.



---

archive/issue_comments_105321.json:
```json
{
    "body": "Apply to local/bin",
    "created_at": "2012-06-21T00:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105321",
    "user": "https://github.com/kcrisman"
}
```

Apply to local/bin



---

archive/issue_events_083872.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T00:43:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83872"
}
```



---

archive/issue_events_083873.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T00:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83873"
}
```



---

archive/issue_comments_105322.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow\" to \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, Karl-Dieter Crisman\".",
    "created_at": "2012-06-21T00:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105322",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow" to "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, Karl-Dieter Crisman".



---

archive/attachments_013933.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10637-scripts.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/trac_10637-scripts.patch",
    "created_at": "2012-06-21T00:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_105323.json:
```json
{
    "body": "<a id='comment:36'></a>\n",
    "created_at": "2012-06-21T00:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105323",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:36'></a>




---

archive/issue_comments_105324.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -31,14 +31,13 @@\n \n Suggestions for better file layout or implementation welcome!\n \n-Edit: \n ## Install instructions\n \n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n+* Apply [attachment:trac_10637-root.patch] to the root repository\n+* Apply [attachment:trac_10637-scripts.patc] to the scripts repository\n \n-* A first patch (add_sws2rst_4.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir\n-\n-* A second patch (tools_sws2rst_4.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a\n+* Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by\n \n ```\n     sage -python setup.py install && sage -python setup.py develop\n``````\n",
    "created_at": "2012-06-21T00:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105324",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -31,14 +31,13 @@
 
 Suggestions for better file layout or implementation welcome!
 
-Edit: 
 ## Install instructions
 
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
+* Apply [attachment:trac_10637-root.patch] to the root repository
+* Apply [attachment:trac_10637-scripts.patc] to the scripts repository
 
-* A first patch (add_sws2rst_4.patch) adds the sage-sws2rst script, and it must be imported on the local/bin dir
-
-* A second patch (tools_sws2rst_4.patch) sends three files to sagenb/misc and it must be imported on the devel/sagenb dir, and followed by a
+* Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by
 
 ```
     sage -python setup.py install && sage -python setup.py develop
``````




---

archive/issue_comments_105325.json:
```json
{
    "body": "<a id='comment:37'></a>\nOkay, at this point one could just review this as-is.  Naturally, the sagenb stuff needs to be applied upstream, but these instructions would work.  I'm not sure what the whole setup.py business is about, but I guess it's worth doing?  I don't know if you'd have to be in the sagenb directory for that...\n\n* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n* Apply [attachment:trac_10637-root.patch] to the root repository\n* Apply [attachment:trac_10637-scripts.patch] to the scripts repository\n\n* Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by\n\n```\n    sage -python setup.py install && sage -python setup.py develop\n```",
    "created_at": "2012-06-21T00:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105325",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:37'></a>
Okay, at this point one could just review this as-is.  Naturally, the sagenb stuff needs to be applied upstream, but these instructions would work.  I'm not sure what the whole setup.py business is about, but I guess it's worth doing?  I don't know if you'd have to be in the sagenb directory for that...

* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
* Apply [attachment:trac_10637-root.patch] to the root repository
* Apply [attachment:trac_10637-scripts.patch] to the scripts repository

* Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by

```
    sage -python setup.py install && sage -python setup.py develop
```



---

archive/issue_comments_105326.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -35,7 +35,7 @@\n \n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n * Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patc] to the scripts repository\n+* Apply [attachment:trac_10637-scripts.patch] to the scripts repository\n \n * Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by\n \n``````\n",
    "created_at": "2012-06-21T00:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105326",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -35,7 +35,7 @@
 
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
 * Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patc] to the scripts repository
+* Apply [attachment:trac_10637-scripts.patch] to the scripts repository
 
 * Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by
 
``````




---

archive/issue_comments_105327.json:
```json
{
    "body": "<a id='comment:38'></a>\nPablo, why do these files need to be in the notebook?  I'm a little confused about this.  They don't seem to use anything in the notebook.  Couldn't one just have them be in some other directory in the main Sage library?  I do understand that they are about the notebook, so maybe it would be best to have them there, but then it's weird that the script isn't also in the notebook.\n\nAnyway, that's a side issue, I guess.",
    "created_at": "2012-06-21T00:48:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105327",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:38'></a>
Pablo, why do these files need to be in the notebook?  I'm a little confused about this.  They don't seem to use anything in the notebook.  Couldn't one just have them be in some other directory in the main Sage library?  I do understand that they are about the notebook, so maybe it would be best to have them there, but then it's weird that the script isn't also in the notebook.

Anyway, that's a side issue, I guess.



---

archive/issue_comments_105328.json:
```json
{
    "body": "<a id='comment:39'></a>\nOkay, I tried this, but got\n\n```\n$ ../../sage -sws2rst ~/Downloads/Test4sws2rst.sws \n<snip>\n  File \"/Users/.../sage-5.1.beta1-flask/local/lib/python/os.py\", line 157, in makedirs\n    mkdir(name, mode)\nOSError: [Errno 20] Not a directory: '/Users/.../Test4sws2rst.sws/sage_worksheet'\n```\nwhich might make sense based on [comment:23](#comment%3A23), except this was a brand-new worksheet.  Maybe I'm doing something wrong in using it?\n\nThe specific place in sage-sws2rst that breaks is\n\n```\nsws_file.extractall(tempname)\n```\nand the rest the Python this calls.\n\nHere is the problem, in pure Python\n\n```\n>>> tempname = os.path.join(tempfile.gettempdir(), \"/Users/.../Test4sws2rst.sws\")\n>>> tempname\n'/Users/.../Test4sws2rst.sws'\n>>> tempfile.gettempdir()\n'/var/folders/Yy/YytEJm5VEB0+pBRD7JNLe++++TQ/-Tmp-'\n```\nWhy isn't this working right?  Ah, looking at the help tells me...\n\n```\nIf any component is an absolute path, all previous path components\n    will be discarded.\n```\nSo apparently one can only do an extraction from the same directory (`../` gives a similar problem).\n\nBut then!\n\n```\n\n$ ./sage -sws2rst Test4sws2rst.sws \nTest4sws2rst.sws\nTraceback (most recent call last):\n  File \"/Users/.../sage-5.1.beta1-flask/local/bin/sage-sws2rst\", line 66, in <module>\n    process_sws(file_name)\n  File \"/Users/.../sage-5.1.beta1-flask/local/bin/sage-sws2rst\", line 39, in process_sws\n    for cell in os.listdir(cells_path):\nOSError: [Errno 2] No such file or directory: '/var/folders/Yy/YytEJm5VEB0+pBRD7JNLe++++TQ/-Tmp-/Test4sws2rst.sws/sage_worksheet/cells'\n```\nAnd now I nearly give up.  Isn't the point exactly to create such things?  I'm doing something wrong here, or maybe I rebased the patches wrong?  I don't think so...\n\nHere we go.\n\n```\n$ ls /var/folders/Yy/YytEJm5VEB0+pBRD7JNLe++++TQ/-Tmp-/Test4sws2rst.sws/sage_worksheet/\nworksheet.html\t\tworksheet.txt\t\tworksheet_conf.pickle\n```\n\nNo cells.  I wonder why?  worksheet.html does have stuff in it.  Now I really am stumped.",
    "created_at": "2012-06-21T01:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105328",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:39'></a>
Okay, I tried this, but got

```
$ ../../sage -sws2rst ~/Downloads/Test4sws2rst.sws 
<snip>
  File "/Users/.../sage-5.1.beta1-flask/local/lib/python/os.py", line 157, in makedirs
    mkdir(name, mode)
OSError: [Errno 20] Not a directory: '/Users/.../Test4sws2rst.sws/sage_worksheet'
```
which might make sense based on [comment:23](#comment%3A23), except this was a brand-new worksheet.  Maybe I'm doing something wrong in using it?

The specific place in sage-sws2rst that breaks is

```
sws_file.extractall(tempname)
```
and the rest the Python this calls.

Here is the problem, in pure Python

```
>>> tempname = os.path.join(tempfile.gettempdir(), "/Users/.../Test4sws2rst.sws")
>>> tempname
'/Users/.../Test4sws2rst.sws'
>>> tempfile.gettempdir()
'/var/folders/Yy/YytEJm5VEB0+pBRD7JNLe++++TQ/-Tmp-'
```
Why isn't this working right?  Ah, looking at the help tells me...

```
If any component is an absolute path, all previous path components
    will be discarded.
```
So apparently one can only do an extraction from the same directory (`../` gives a similar problem).

But then!

```

$ ./sage -sws2rst Test4sws2rst.sws 
Test4sws2rst.sws
Traceback (most recent call last):
  File "/Users/.../sage-5.1.beta1-flask/local/bin/sage-sws2rst", line 66, in <module>
    process_sws(file_name)
  File "/Users/.../sage-5.1.beta1-flask/local/bin/sage-sws2rst", line 39, in process_sws
    for cell in os.listdir(cells_path):
OSError: [Errno 2] No such file or directory: '/var/folders/Yy/YytEJm5VEB0+pBRD7JNLe++++TQ/-Tmp-/Test4sws2rst.sws/sage_worksheet/cells'
```
And now I nearly give up.  Isn't the point exactly to create such things?  I'm doing something wrong here, or maybe I rebased the patches wrong?  I don't think so...

Here we go.

```
$ ls /var/folders/Yy/YytEJm5VEB0+pBRD7JNLe++++TQ/-Tmp-/Test4sws2rst.sws/sage_worksheet/
worksheet.html		worksheet.txt		worksheet_conf.pickle
```

No cells.  I wonder why?  worksheet.html does have stuff in it.  Now I really am stumped.



---

archive/issue_events_083874.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T13:13:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83874"
}
```



---

archive/issue_events_083875.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T13:13:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83875"
}
```



---

archive/issue_comments_105329.json:
```json
{
    "body": "<a id='comment:40'></a>\nThis needs work - the `sage -advanced` list now has a file conversion category, and I didn't base this on the most recent version of Sage.  Patch coming.",
    "created_at": "2012-06-21T13:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105329",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:40'></a>
This needs work - the `sage -advanced` list now has a file conversion category, and I didn't base this on the most recent version of Sage.  Patch coming.



---

archive/issue_comments_105330.json:
```json
{
    "body": "**Changing author** from \"Pablo Angulo\" to \"Pablo Angulo, Karl-Dieter Crisman\".",
    "created_at": "2012-06-21T13:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105330",
    "user": "https://github.com/kcrisman"
}
```

**Changing author** from "Pablo Angulo" to "Pablo Angulo, Karl-Dieter Crisman".



---

archive/issue_comments_105331.json:
```json
{
    "body": "<a id='comment:41'></a>\nOkay, I put it there, and also removed it from the non-advanced list, since the rst2sws and rst2txt were not in the normal list.",
    "created_at": "2012-06-21T13:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105331",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:41'></a>
Okay, I put it there, and also removed it from the non-advanced list, since the rst2sws and rst2txt were not in the normal list.



---

archive/issue_comments_105332.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, Karl-Dieter Crisman\" to \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow\".",
    "created_at": "2012-06-21T13:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105332",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, Karl-Dieter Crisman" to "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow".



---

archive/issue_events_083876.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T13:19:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83876"
}
```



---

archive/issue_events_083877.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T13:19:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83877"
}
```



---

archive/issue_comments_105333.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Workaround found; Bug reported upstream.\".",
    "created_at": "2012-06-21T15:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105333",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Workaround found; Bug reported upstream.".



---

archive/issue_comments_105334.json:
```json
{
    "body": "<a id='comment:42'></a>\nSee [this pull request at sagenb](https://github.com/sagemath/sagenb/pull/75) for the latest upstream report.",
    "created_at": "2012-06-21T15:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105334",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:42'></a>
See [this pull request at sagenb](https://github.com/sagemath/sagenb/pull/75) for the latest upstream report.



---

archive/issue_comments_105335.json:
```json
{
    "body": "<a id='comment:43'></a>\nI wonder why you are doing this conversion from scratch instead of using the docutils syntax tree. We already ship docutils - doesn't it have a way to convert HTML to rST? Why do we need BeautifulSoup?",
    "created_at": "2012-06-21T16:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105335",
    "user": "https://github.com/kini"
}
```

<a id='comment:43'></a>
I wonder why you are doing this conversion from scratch instead of using the docutils syntax tree. We already ship docutils - doesn't it have a way to convert HTML to rST? Why do we need BeautifulSoup?



---

archive/issue_comments_105336.json:
```json
{
    "body": "<a id='comment:44'></a>\n> I wonder why you are doing this conversion from scratch instead of using the docutils syntax tree. We already ship docutils - doesn't it have a way to convert HTML to rST? Why do we need BeautifulSoup?\n\nI'm sure that's a good question, but maybe that would be an improvement for later...",
    "created_at": "2012-06-21T16:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105336",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:44'></a>
> I wonder why you are doing this conversion from scratch instead of using the docutils syntax tree. We already ship docutils - doesn't it have a way to convert HTML to rST? Why do we need BeautifulSoup?

I'm sure that's a good question, but maybe that would be an improvement for later...



---

archive/issue_comments_105337.json:
```json
{
    "body": "<a id='comment:45'></a>\n**WOW!!! **  This is really awesome!  I did a moderately complicated worksheet just now, and had only one error message.\n\n```\n: WARNING: Bullet list ends without a blank line; unexpected unindent.\n```\nThis was in a sublist.  Here is the html source in `sage_worksheet`.\n\n```\n<p>This works because Sage is very collaborative. &nbsp;</p>\n<ul>\n<li>Anyone who has access to the server can be invited to share a document.</li>\n<li>In this case, the teacher would post a lab, and the students could share a copy of it with each other to work on it.</li>\n<li>Then, when they are done, they can:\n<ul>\n<li>Publish it to the server for the teacher to view, or&nbsp;</li>\n<li>Share it with the teacher, or&nbsp;</li>\n<li>Download it to be uploaded by the teacher...</li>\n</ul>\n</li>\n</ul>\n```\nI don't know whether this is 'needs work' or for a future ticket, since it still looks right in the built Sphinx output.\n\nAlso, along the same priority lines, if you include jpg images in the data directory, I guess they don't always look quite right - that is, they don't scale with the size of the picture.  I guess that is just because they are jpg files, not png - probably there is no real solution to this.  The graphics from Sage do fine.\n\n---\n\nMore importantly, I think that there we need to add some documentation as to how to use this somewhere.  What do you think?  I think that [the Sphinx tutorial](http://sphinx.pocoo.org/tutorial.html) in conjunction with the following would do it.\n\n* To turn a worksheet into nice documentation outside the Sage doc tree, first make a folder somewhere convenient labeled (say) `MyProject`.\n* Then move your `.sws` file into that folder, and cd into it.\n* Now the key is to use Sage's shell to run Sphinx on it!  Run `sage -sh` here.\n* Now type `sphinx-quickstart` and follow the instructions in the Sphinx tutorial.  you will probably want to render math with MathJax.\n* If you now type `make html` you should get a beautiful-looking web page in `_build/html`.  Other things like `make pdf` will do the same.\n\nHere's another thing.  As far as I can tell, one can pretty much only run this on an `.sws` that is in the directory you live in.  So we need to document this in the same place.\n\n---\n\nSo here are the issues for 'needs work'.  \n* Make `sage -sws2rst` fail gracefully if one hasn't installed the beautifulsoup spkg.  Naturally, this requires beautifulsoup to be an optional or at least experimental spkg.  Since it's just a Python thing, that shouldn't be a problem.\n* Add documentation.  This doesn't need to be intense.\n* Somehow we have to resolve this issue with the older worksheets (if it is in fact an issue).\n* Figure out how to deal with the case where there are no `cells/` in the worksheet for some reason.",
    "created_at": "2012-06-21T16:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105337",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:45'></a>
**WOW!!! **  This is really awesome!  I did a moderately complicated worksheet just now, and had only one error message.

```
: WARNING: Bullet list ends without a blank line; unexpected unindent.
```
This was in a sublist.  Here is the html source in `sage_worksheet`.

```
<p>This works because Sage is very collaborative. &nbsp;</p>
<ul>
<li>Anyone who has access to the server can be invited to share a document.</li>
<li>In this case, the teacher would post a lab, and the students could share a copy of it with each other to work on it.</li>
<li>Then, when they are done, they can:
<ul>
<li>Publish it to the server for the teacher to view, or&nbsp;</li>
<li>Share it with the teacher, or&nbsp;</li>
<li>Download it to be uploaded by the teacher...</li>
</ul>
</li>
</ul>
```
I don't know whether this is 'needs work' or for a future ticket, since it still looks right in the built Sphinx output.

Also, along the same priority lines, if you include jpg images in the data directory, I guess they don't always look quite right - that is, they don't scale with the size of the picture.  I guess that is just because they are jpg files, not png - probably there is no real solution to this.  The graphics from Sage do fine.

---

More importantly, I think that there we need to add some documentation as to how to use this somewhere.  What do you think?  I think that [the Sphinx tutorial](http://sphinx.pocoo.org/tutorial.html) in conjunction with the following would do it.

* To turn a worksheet into nice documentation outside the Sage doc tree, first make a folder somewhere convenient labeled (say) `MyProject`.
* Then move your `.sws` file into that folder, and cd into it.
* Now the key is to use Sage's shell to run Sphinx on it!  Run `sage -sh` here.
* Now type `sphinx-quickstart` and follow the instructions in the Sphinx tutorial.  you will probably want to render math with MathJax.
* If you now type `make html` you should get a beautiful-looking web page in `_build/html`.  Other things like `make pdf` will do the same.

Here's another thing.  As far as I can tell, one can pretty much only run this on an `.sws` that is in the directory you live in.  So we need to document this in the same place.

---

So here are the issues for 'needs work'.  
* Make `sage -sws2rst` fail gracefully if one hasn't installed the beautifulsoup spkg.  Naturally, this requires beautifulsoup to be an optional or at least experimental spkg.  Since it's just a Python thing, that shouldn't be a problem.
* Add documentation.  This doesn't need to be intense.
* Somehow we have to resolve this issue with the older worksheets (if it is in fact an issue).
* Figure out how to deal with the case where there are no `cells/` in the worksheet for some reason.



---

archive/issue_comments_105338.json:
```json
{
    "body": "<a id='comment:46'></a>\n> I'm sure that's a good question, but maybe that would be an improvement for later...\n\n\nSo, we add BeautifulSoup as a dependency for sagenb in this ticket, and then deem removing it again a followup? That's a bit... odd...\n\n> * Make sage -sws2rst fail gracefully if one hasn't installed the beautifulsoup spkg. Naturally, this requires beautifulsoup to be an optional or at least experimental spkg. Since it's just a Python thing, that shouldn't be a problem.\n\n\nThat's more like it :)",
    "created_at": "2012-06-21T17:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105338",
    "user": "https://github.com/kini"
}
```

<a id='comment:46'></a>
> I'm sure that's a good question, but maybe that would be an improvement for later...


So, we add BeautifulSoup as a dependency for sagenb in this ticket, and then deem removing it again a followup? That's a bit... odd...

> * Make sage -sws2rst fail gracefully if one hasn't installed the beautifulsoup spkg. Naturally, this requires beautifulsoup to be an optional or at least experimental spkg. Since it's just a Python thing, that shouldn't be a problem.


That's more like it :)



---

archive/issue_comments_105339.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [kini](#comment%3A43):\n> I wonder why you are doing this conversion from scratch instead of using the docutils syntax tree. We already ship docutils - doesn't it have a way to convert HTML to rST? Why do we need BeautifulSoup?\n\n\nAs far as I know, docutils reads rst only. It translates this into plenty of format (odt, .html, .tex, s5, etc.) but not the other way around. To implement sws2rst, you need some html reader like beautiful soup.\n\nS\u00e9bastien",
    "created_at": "2012-06-21T18:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105339",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:47'></a>
Replying to [kini](#comment%3A43):
> I wonder why you are doing this conversion from scratch instead of using the docutils syntax tree. We already ship docutils - doesn't it have a way to convert HTML to rST? Why do we need BeautifulSoup?


As far as I know, docutils reads rst only. It translates this into plenty of format (odt, .html, .tex, s5, etc.) but not the other way around. To implement sws2rst, you need some html reader like beautiful soup.

Sébastien



---

archive/issue_comments_105340.json:
```json
{
    "body": "<a id='comment:48'></a>\nWith respect to this worksheet with no cells, it gets weirder.  As soon as I downloaded it from sagenb.org and uploaded it locally, then downloaded again, it had everything and worked fine.   Continuing to test.",
    "created_at": "2012-06-21T18:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105340",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:48'></a>
With respect to this worksheet with no cells, it gets weirder.  As soon as I downloaded it from sagenb.org and uploaded it locally, then downloaded again, it had everything and worked fine.   Continuing to test.



---

archive/issue_comments_105341.json:
```json
{
    "body": "<a id='comment:49'></a>\nOkay, I can reproduce this.\n* Create a new worksheet.\n* Save it immediately (no computation).\n* Download it and process with `sage -sws2rst`.\n\nProbably something like \"delete all output\" could also make this happen.\nI don't know why a worksheet wouldn't have cells in other cases, but at any rate this can happen under \"natural\" circumstances as well as my weird one.\n\n\n---\n\nBy the way, the stuff generated is not perfect, mainly because many of us use TinyMCE header styles to do larger fonts - just easier than trying to figure out how to make larger text and center it.  So semantics and actual use don't coincide.  But I figure if someone wanted to turn this into a rst file then they would know that might happen.",
    "created_at": "2012-06-21T18:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105341",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:49'></a>
Okay, I can reproduce this.
* Create a new worksheet.
* Save it immediately (no computation).
* Download it and process with `sage -sws2rst`.

Probably something like "delete all output" could also make this happen.
I don't know why a worksheet wouldn't have cells in other cases, but at any rate this can happen under "natural" circumstances as well as my weird one.


---

By the way, the stuff generated is not perfect, mainly because many of us use TinyMCE header styles to do larger fonts - just easier than trying to figure out how to make larger text and center it.  So semantics and actual use don't coincide.  But I figure if someone wanted to turn this into a rst file then they would know that might happen.



---

archive/issue_comments_105342.json:
```json
{
    "body": "<a id='comment:50'></a>\nAt #11459, slabbe points out that `sage-rst2sws` has pretty good docs right in the script itself that print out with `sage -sws2rst -h`.  That would suffice for the purposes here.",
    "created_at": "2012-06-21T18:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105342",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:50'></a>
At #11459, slabbe points out that `sage-rst2sws` has pretty good docs right in the script itself that print out with `sage -sws2rst -h`.  That would suffice for the purposes here.



---

archive/issue_events_083878.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T18:42:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83878"
}
```



---

archive/issue_events_083879.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T18:42:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83879"
}
```



---

archive/issue_comments_105343.json:
```json
{
    "body": "**Work_Issues:** fail nicely if no beautifulsoup, add doc in sage-sws2rst, case with no cells/ directory",
    "created_at": "2012-06-21T18:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105343",
    "user": "https://github.com/kcrisman"
}
```

**Work_Issues:** fail nicely if no beautifulsoup, add doc in sage-sws2rst, case with no cells/ directory



---

archive/issue_comments_105344.json:
```json
{
    "body": "<a id='comment:51'></a>\nSo I changed enough to add a second patch for clarity of what is what.  I have now plenty of documentation with `sage -sws2rst -h` and then `sage -sws2rst --sphinxify` (which is mentioned in the help message.\n\nAlso, it turns out that this already *does* fail nicely if there is no BeautifulSoup, except it recommends to download from this Trac ticket.  Wow, an entire spkg attached to a ticket!  So that needs to be fixed, but that is only a tiny change. Patch coming up there too.",
    "created_at": "2012-06-22T01:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105344",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:51'></a>
So I changed enough to add a second patch for clarity of what is what.  I have now plenty of documentation with `sage -sws2rst -h` and then `sage -sws2rst --sphinxify` (which is mentioned in the help message.

Also, it turns out that this already *does* fail nicely if there is no BeautifulSoup, except it recommends to download from this Trac ticket.  Wow, an entire spkg attached to a ticket!  So that needs to be fixed, but that is only a tiny change. Patch coming up there too.



---

archive/issue_comments_105345.json:
```json
{
    "body": "Apply to sagenb",
    "created_at": "2012-06-22T01:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105345",
    "user": "https://github.com/kcrisman"
}
```

Apply to sagenb



---

archive/attachments_013934.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10637-root-docsandmore.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/trac_10637-root-docsandmore.patch",
    "created_at": "2012-06-22T01:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_105346.json:
```json
{
    "body": "Apply to root repository",
    "created_at": "2012-06-22T01:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105346",
    "user": "https://github.com/kcrisman"
}
```

Apply to root repository



---

archive/issue_events_083880.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-22T01:33:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83880"
}
```



---

archive/issue_events_083881.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-22T01:33:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83881"
}
```



---

archive/issue_events_083882.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-22T01:33:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83882"
}
```



---

archive/issue_events_083883.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-22T01:33:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83883"
}
```



---

archive/issue_comments_105347.json:
```json
{
    "body": "<a id='comment:52'></a>\nTo patchbot and others, instructions:\n\n* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637-root-docsandmore.patch] to the root repository\n* Apply [attachment:trac_10637-scripts.patch] to the scripts repository\n\n* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n\n```\n    sage -python setup.py install && sage -python setup.py develop\n```\n\n---\n\nOkay, this should take care of all the work issues.  I've made enough changes in the `sage-sws2rst` file that it definitely needs review, whether from pang or slabbe or someone else.  Please try especially to break it with weird input; but everything else should really be okay, given that my changes to Pablo's great core work is very minimal. \n\nNote that not only my review patches need review, but also the original sagenb patches as well.  The sagenb stuff is up-to-date in the pull request [75](https://github.com/sagemath/sagenb/pull/75) of sagenb.\n\nI'm sure there are more elegant ways to do it, but the original scripts patch is fine.  \n\nI suppose someone should also review the spkg, though there is really almost nothing to review other than bringing it up to developer guide guidelines.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/XckI9KRYLOc) for a vote about whether this is allowed to be an optional spkg.",
    "created_at": "2012-06-22T01:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105347",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:52'></a>
To patchbot and others, instructions:

* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637-root-docsandmore.patch] to the root repository
* Apply [attachment:trac_10637-scripts.patch] to the scripts repository

* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by

```
    sage -python setup.py install && sage -python setup.py develop
```

---

Okay, this should take care of all the work issues.  I've made enough changes in the `sage-sws2rst` file that it definitely needs review, whether from pang or slabbe or someone else.  Please try especially to break it with weird input; but everything else should really be okay, given that my changes to Pablo's great core work is very minimal. 

Note that not only my review patches need review, but also the original sagenb patches as well.  The sagenb stuff is up-to-date in the pull request [75](https://github.com/sagemath/sagenb/pull/75) of sagenb.

I'm sure there are more elegant ways to do it, but the original scripts patch is fine.  

I suppose someone should also review the spkg, though there is really almost nothing to review other than bringing it up to developer guide guidelines.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/XckI9KRYLOc) for a vote about whether this is allowed to be an optional spkg.



---

archive/issue_comments_105348.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -34,10 +34,10 @@\n ## Install instructions\n \n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n-* Apply [attachment:trac_10637-root.patch] to the root repository\n+* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637-root-docsandmore.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] to the scripts repository\n \n-* Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by\n+* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n \n ```\n     sage -python setup.py install && sage -python setup.py develop\n``````\n",
    "created_at": "2012-06-22T01:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105348",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -34,10 +34,10 @@
 ## Install instructions
 
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
-* Apply [attachment:trac_10637-root.patch] to the root repository
+* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637-root-docsandmore.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] to the scripts repository
 
-* Apply [attachment:tools_sws2rst_4.patch] to sagenb, possibly followed by
+* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by
 
 ```
     sage -python setup.py install && sage -python setup.py develop
``````




---

archive/issue_comments_105349.json:
```json
{
    "body": "**Changing work_issues** from \"fail nicely if no beautifulsoup, add doc in sage-sws2rst, case with no cells/ directory\" to \"\".",
    "created_at": "2012-06-22T01:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105349",
    "user": "https://github.com/kcrisman"
}
```

**Changing work_issues** from "fail nicely if no beautifulsoup, add doc in sage-sws2rst, case with no cells/ directory" to "".



---

archive/issue_comments_105350.json:
```json
{
    "body": "<a id='comment:53'></a>\n> I suppose someone should also review the spkg, though there is really almost nothing to review other than bringing it up to developer guide guidelines.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/XckI9KRYLOc) for a vote about whether this is allowed to be an optional spkg.\n\n\nNo response, but given that this is available via both `pip` and `easy_install`, I say it should be optional at the end of this.\n\nNow we just need review of the review patches, and the sagenb patches.",
    "created_at": "2012-06-25T15:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105350",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:53'></a>
> I suppose someone should also review the spkg, though there is really almost nothing to review other than bringing it up to developer guide guidelines.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/XckI9KRYLOc) for a vote about whether this is allowed to be an optional spkg.


No response, but given that this is available via both `pip` and `easy_install`, I say it should be optional at the end of this.

Now we just need review of the review patches, and the sagenb patches.



---

archive/issue_comments_105351.json:
```json
{
    "body": "<a id='comment:54'></a>\nThanks a lot for you care Karl.\n\nI downloaded a source version of sage 5.0.1, and tried to:\n\n\"Apply trac_10637-root.patch to the root repository\", with the result:\n\n\n```\npatching file spkg/bin/sage\nHunk #1 FAILED at 189\nHunk #2 succeeded at 397 (offset -23 lines).\n1 out of 2 hunks FAILED -- saving rejects to file spkg/bin/sage.rej\npatch failed to apply\nspkg/bin/sage\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_10637-root.patch\n```\n\nwhere spkg/bin/sage.rej reads:\n\n\n```\n--- sage\n+++ sage\n@@ -190,6 +190,8 @@\n     echo \"                         reStructuredText source.\"\n     echo \"  -rst2sws [...]      -- Generates Sage worksheet (.sws) from standalone\"\n     echo \"                         reStructuredText source.\"\n+    echo \"  -sws2rst <sws doc>  -- Generates a reStructuredText source file from\"\n+    echo \"                         a Sage worksheet (.sws) document.\"\n \n     echo\n     ####  1.......................26..................................................78\n```\n\nWhat am I dong wrong?",
    "created_at": "2012-06-26T17:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105351",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:54'></a>
Thanks a lot for you care Karl.

I downloaded a source version of sage 5.0.1, and tried to:

"Apply trac_10637-root.patch to the root repository", with the result:


```
patching file spkg/bin/sage
Hunk #1 FAILED at 189
Hunk #2 succeeded at 397 (offset -23 lines).
1 out of 2 hunks FAILED -- saving rejects to file spkg/bin/sage.rej
patch failed to apply
spkg/bin/sage
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_10637-root.patch
```

where spkg/bin/sage.rej reads:


```
--- sage
+++ sage
@@ -190,6 +190,8 @@
     echo "                         reStructuredText source."
     echo "  -rst2sws [...]      -- Generates Sage worksheet (.sws) from standalone"
     echo "                         reStructuredText source."
+    echo "  -sws2rst <sws doc>  -- Generates a reStructuredText source file from"
+    echo "                         a Sage worksheet (.sws) document."
 
     echo
     ####  1.......................26..................................................78
```

What am I dong wrong?



---

archive/issue_comments_105352.json:
```json
{
    "body": "**Changing dependencies** from \"#11080\" to \"#11080, #11459\".",
    "created_at": "2012-06-26T17:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105352",
    "user": "https://github.com/kcrisman"
}
```

**Changing dependencies** from "#11080" to "#11080, #11459".



---

archive/issue_comments_105353.json:
```json
{
    "body": "<a id='comment:55'></a>\nI based it on a later beta because of the model from rst2sws - this depends on #11459, I guess, sorry for not making that more explicit.",
    "created_at": "2012-06-26T17:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105353",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:55'></a>
I based it on a later beta because of the model from rst2sws - this depends on #11459, I guess, sorry for not making that more explicit.



---

archive/issue_comments_105354.json:
```json
{
    "body": "<a id='comment:56'></a>\nok, now \n\n```\napplying trac_10637-root.patch\nnow at: trac_10637-root.patch\n```\n\nworks, but the next patch fails\n\n```\napplying trac_10637-root-docsandmore.patch\nunable to find 'sage-sws2rst' for patching\n5 out of 5 hunks FAILED -- saving rejects to file sage-sws2rst.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_10637-root-docsandmore.patch\n```\n\nI attach sage-sws2rst.rej...",
    "created_at": "2012-06-27T11:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105354",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:56'></a>
ok, now 

```
applying trac_10637-root.patch
now at: trac_10637-root.patch
```

works, but the next patch fails

```
applying trac_10637-root-docsandmore.patch
unable to find 'sage-sws2rst' for patching
5 out of 5 hunks FAILED -- saving rejects to file sage-sws2rst.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_10637-root-docsandmore.patch
```

I attach sage-sws2rst.rej...



---

archive/attachments_013935.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "sage-sws2rst.rej",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/sage-sws2rst.rej",
    "created_at": "2012-06-27T11:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.rej",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105355.json:
```json
{
    "body": "",
    "created_at": "2012-06-27T11:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105355",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```





---

archive/issue_comments_105356.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,9 +33,10 @@\n \n ## Install instructions\n \n+* Be sure you have a recent beta, and/or that #11080 and #11459 are included.\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n-* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637-root-docsandmore.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch] to the scripts repository\n+* Apply [attachment:trac_10637-root.patch] to the root repository\n+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-root-docsandmore.patch] to the scripts repository\n \n * Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n \n``````\n",
    "created_at": "2012-06-27T12:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105356",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,9 +33,10 @@
 
 ## Install instructions
 
+* Be sure you have a recent beta, and/or that #11080 and #11459 are included.
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
-* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637-root-docsandmore.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch] to the scripts repository
+* Apply [attachment:trac_10637-root.patch] to the root repository
+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-root-docsandmore.patch] to the scripts repository
 
 * Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by
 
``````




---

archive/issue_comments_105357.json:
```json
{
    "body": "<a id='comment:57'></a>\nI'm stupid.  That patch, despite the name, applies to the *scripts* (local/bin) repository.  Sorry; updating instructions here and in the description.\n\n---\n\n\nTo patchbot and others, instructions:\n\n* Be sure you have a recent beta, and/or that #11080 and #11459 are included.\n* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n* Apply [attachment:trac_10637-root.patch] to the root repository\n* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-root-docsandmore.patch] to the scripts repository\n\n* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n\n```\n    sage -python setup.py install && sage -python setup.py develop\n```",
    "created_at": "2012-06-27T12:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105357",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:57'></a>
I'm stupid.  That patch, despite the name, applies to the *scripts* (local/bin) repository.  Sorry; updating instructions here and in the description.

---


To patchbot and others, instructions:

* Be sure you have a recent beta, and/or that #11080 and #11459 are included.
* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
* Apply [attachment:trac_10637-root.patch] to the root repository
* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-root-docsandmore.patch] to the scripts repository

* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by

```
    sage -python setup.py install && sage -python setup.py develop
```



---

archive/issue_comments_105358.json:
```json
{
    "body": "<a id='comment:58'></a>\npang commented elsewhere:\n> Hi, karl: It's working now, I just need to doctest the full sage library and stuff like that. \n> Currently my hardware is limited, so I cannot do this at any time.\n\n\nYou may want to get an account on the sage.math cluster.\n\nAnyway, I wouldn't worry too much about doctests outside of sagenb, since this doesn't actually change the Sage library at all!  The changes are in the actual script, and so checking that it still works the same as you intended and has correct logic is the most important thing.\n\nOnce that was true, all that would remain would be for me or someone else other than you to review the actual sagenb stuff you originally included in [attachment:tools_sws2rst_4.patch].  I may eventually be able to do so, but such parsing is slow going for me.  I wonder if one of the folks from sage-combinat might be recruited to do so?  On the plus side, there is very little chance of bitrot on the sagenb end, and fixing it on the Sage end should be relatively straightforward.",
    "created_at": "2012-06-28T14:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105358",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:58'></a>
pang commented elsewhere:
> Hi, karl: It's working now, I just need to doctest the full sage library and stuff like that. 
> Currently my hardware is limited, so I cannot do this at any time.


You may want to get an account on the sage.math cluster.

Anyway, I wouldn't worry too much about doctests outside of sagenb, since this doesn't actually change the Sage library at all!  The changes are in the actual script, and so checking that it still works the same as you intended and has correct logic is the most important thing.

Once that was true, all that would remain would be for me or someone else other than you to review the actual sagenb stuff you originally included in [attachment:tools_sws2rst_4.patch].  I may eventually be able to do so, but such parsing is slow going for me.  I wonder if one of the folks from sage-combinat might be recruited to do so?  On the plus side, there is very little chance of bitrot on the sagenb end, and fixing it on the Sage end should be relatively straightforward.



---

archive/issue_comments_105359.json:
```json
{
    "body": "<a id='comment:59'></a>\nOkay, I've read through the code, and here is everything I have to say without actually trying it out on a variety of worksheets.  Anyone have any comments on my patch to the actual script?\n\n---\n\nTo me, the main issue is that the code needs to be fairly well-formed.  Is worksheet.html really always that well-formed of HTML?  I just don't know.   \n\nThe reasons this doesn't concern me too much are \n1. The worst that could happen is that the rst doesn't look good, but nothing gets destroyed\n2. Presumably someone wouldn't bother to use this functionality in the first place without checking that the worksheet at least looked nice\n3. Presumably BeautifulSoup makes the html more well-formed\n\nPlaces this could go wrong, maybe, with weird input, below.  Keep in mind I'm not at all a regex wizard, so that could be part of my questions.  I'd appreciate any responses to whether these could be problems; although most of them wouldn't be a big issue, I still feel like especially the first several really require (for me) explanation.\n* $$ that are intended to be empty LaTeX for later filling in - definitely counts on $$ always existing in pairs\n* I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?\n* It looks like in visiting ordered lists, that all sublists will automatically becomes numbered.  But couldn't one have an unordered list inside an ordered list?\n* in the replace_latex thing, is it conceivable that the re's would match something by mistake?  It looks like e.g. latex_beginning is matching anything that starts and ends with a dollar sign, as long as it really does end with a dollar sign and not \\$, where that would include any character (possibly zero) before that.  Again, in a well-formed worksheet that wouldn't be a problem, but maybe sometimes people would do things like \"$\\$$\".\n* Or what if the TinyMCE was (completely) \"h$x+y=z$\", then wouldn't this get replaced by \":math:`x+y=z`\" with the h gone?  It seems like you're assuming \\\\1 is a whitespace character?\n* How could the branch of visit_strong with _inside_code_tag be reached?  The only place this flag seems to be True is in visit_code, but in that case one just gets plain text and and wouldn't visit_strong, it seems to me\n* What if there was an anchor tag that was NOT an \"href\"?  There are other uses for anchors.\n* There is potential for malformed `///` or }}} without the others or cell id's missing and | missing to cause trouble\n* <p> could be appended to no purpose; I guess this counts heavily on all tags being properly paired\n* In results sections, is all html being removed?  Is there a reason for this?  I assume that this is to take care of a specific type of result that can occur that I can't think of right now.  After all, a Sage cell is a Python cell, and html certainly could be legitimate output.\n* Is it conceivable that the rest will do something wrong with the escape_chars + and friends when it's not replaced? I assume not since they're turned into :math: mode\n* Am I correct in saying that once inside a code tag, all other tags are ignored?  That appears to be what is going on here.\n* In the table, I suppose it's at least possible there could be a tfoot element.  Does this not come out of TinyMCE?\n* What other preformatted text <pre> do we expect?  Should they all be ::'ed?\n* I know this might not happen a lot, but in theory a cell could do sage: sage: sage: and it should all be removed... not that this is a very big deal.\n* I do like that most of the traceback is removed - am I right in that?  Why is there not a continue traceback thing?\n\nWell, that's a lot of dumb little questions.  On the *very* positive plus side, it looks like this is at least as good, if not much better, than other html2rst things on the web - one even advertises \"no support for tables, don't even try\".  I like the infrastructure for extending this should there be call for more to go, and the use of ints but via the names. Great work!",
    "created_at": "2012-07-03T02:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105359",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:59'></a>
Okay, I've read through the code, and here is everything I have to say without actually trying it out on a variety of worksheets.  Anyone have any comments on my patch to the actual script?

---

To me, the main issue is that the code needs to be fairly well-formed.  Is worksheet.html really always that well-formed of HTML?  I just don't know.   

The reasons this doesn't concern me too much are 
1. The worst that could happen is that the rst doesn't look good, but nothing gets destroyed
2. Presumably someone wouldn't bother to use this functionality in the first place without checking that the worksheet at least looked nice
3. Presumably BeautifulSoup makes the html more well-formed

Places this could go wrong, maybe, with weird input, below.  Keep in mind I'm not at all a regex wizard, so that could be part of my questions.  I'd appreciate any responses to whether these could be problems; although most of them wouldn't be a big issue, I still feel like especially the first several really require (for me) explanation.
* $$ that are intended to be empty LaTeX for later filling in - definitely counts on $$ always existing in pairs
* I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?
* It looks like in visiting ordered lists, that all sublists will automatically becomes numbered.  But couldn't one have an unordered list inside an ordered list?
* in the replace_latex thing, is it conceivable that the re's would match something by mistake?  It looks like e.g. latex_beginning is matching anything that starts and ends with a dollar sign, as long as it really does end with a dollar sign and not \$, where that would include any character (possibly zero) before that.  Again, in a well-formed worksheet that wouldn't be a problem, but maybe sometimes people would do things like "$\$$".
* Or what if the TinyMCE was (completely) "h$x+y=z$", then wouldn't this get replaced by ":math:`x+y=z`" with the h gone?  It seems like you're assuming \\1 is a whitespace character?
* How could the branch of visit_strong with _inside_code_tag be reached?  The only place this flag seems to be True is in visit_code, but in that case one just gets plain text and and wouldn't visit_strong, it seems to me
* What if there was an anchor tag that was NOT an "href"?  There are other uses for anchors.
* There is potential for malformed `///` or }}} without the others or cell id's missing and | missing to cause trouble
* <p> could be appended to no purpose; I guess this counts heavily on all tags being properly paired
* In results sections, is all html being removed?  Is there a reason for this?  I assume that this is to take care of a specific type of result that can occur that I can't think of right now.  After all, a Sage cell is a Python cell, and html certainly could be legitimate output.
* Is it conceivable that the rest will do something wrong with the escape_chars + and friends when it's not replaced? I assume not since they're turned into :math: mode
* Am I correct in saying that once inside a code tag, all other tags are ignored?  That appears to be what is going on here.
* In the table, I suppose it's at least possible there could be a tfoot element.  Does this not come out of TinyMCE?
* What other preformatted text <pre> do we expect?  Should they all be ::'ed?
* I know this might not happen a lot, but in theory a cell could do sage: sage: sage: and it should all be removed... not that this is a very big deal.
* I do like that most of the traceback is removed - am I right in that?  Why is there not a continue traceback thing?

Well, that's a lot of dumb little questions.  On the *very* positive plus side, it looks like this is at least as good, if not much better, than other html2rst things on the web - one even advertises "no support for tables, don't even try".  I like the infrastructure for extending this should there be call for more to go, and the use of ints but via the names. Great work!



---

archive/issue_comments_105360.json:
```json
{
    "body": "<a id='comment:60'></a>\nThanks again, Karl. I will address most comments later, after some experiment, but I'd love to hear your opinion on one of them. You said:\n\nReplying to [kcrisman](#comment%3A59):\n> * In results sections, is all html being removed?  Is there a reason for this?  I assume that this is to take care of a specific type of result that can occur that I can't think of right now.  After all, a Sage cell is a Python cell, and html certainly could be legitimate output.\n\n\nWhat should I do? I don't feel like parsing it into rst, because it's output, and parsing is lossy. I cannot be too literal either, because I have to leave something that works when the rst files are rendered into html, tex or whatever.\n\nThe question is related to others, like the one on tracebacks for example. I didn't like long tracebacks in the docs, which would scare my non-technical prospective readers. Should I rewrite sws2rst to incorporate several config options, like long_tracebacks or parse_html_in_results or replace_monospace_font_by_code_tags? Can you think of others?",
    "created_at": "2012-07-03T07:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105360",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:60'></a>
Thanks again, Karl. I will address most comments later, after some experiment, but I'd love to hear your opinion on one of them. You said:

Replying to [kcrisman](#comment%3A59):
> * In results sections, is all html being removed?  Is there a reason for this?  I assume that this is to take care of a specific type of result that can occur that I can't think of right now.  After all, a Sage cell is a Python cell, and html certainly could be legitimate output.


What should I do? I don't feel like parsing it into rst, because it's output, and parsing is lossy. I cannot be too literal either, because I have to leave something that works when the rst files are rendered into html, tex or whatever.

The question is related to others, like the one on tracebacks for example. I didn't like long tracebacks in the docs, which would scare my non-technical prospective readers. Should I rewrite sws2rst to incorporate several config options, like long_tracebacks or parse_html_in_results or replace_monospace_font_by_code_tags? Can you think of others?



---

archive/issue_comments_105361.json:
```json
{
    "body": "<a id='comment:61'></a>\n> > * In results sections, is all html being removed?  Is there a reason for this?  I assume that this is to take care of a specific type of result that can occur that I can't think of right now.  After all, a Sage cell is a Python cell, and html certainly could be legitimate output.\n \nHere's an example - `@`interact output is html.  In sws2tex, whuss and friends just completely ignore them - perhaps not the worst idea, given that it's supposed to be interactive and a tex (or rst) document isn't, by definition.\n> What should I do? I don't feel like parsing it into rst, because it's output, and parsing is lossy. I cannot be too literal either, because I have to leave something that works when the rst files are rendered into html, tex or whatever.\n\nI suppose one could start the tree all over again?  But that seems less than ideal.  Would it be possible to place the html in code tags?  I am wondering what some of the typical examples you ran across were.  Certainly we can't (or at least don't want to, maybe rest supports this) support all the style stuff html would support.\n> The question is related to others, like the one on tracebacks for example. I didn't like long tracebacks in the docs, which would scare my non-technical prospective readers. Should I rewrite sws2rst to incorporate several config options, like long_tracebacks or parse_html_in_results or replace_monospace_font_by_code_tags? Can you think of others?\n\nMaybe in another ticket, in general.  The html one I was a little unsure, since html output could be legitimate.  I do think that the monospace (Courier, I guess?) by code shouldn't be the default, just because that seems to be your own personal trick, but conceivably others might just want text, and might be surprised if all text that was in lots of TinyMCE fonts looks the same, except the text in that particular font.  I wish we had a way to turn the different font sizes into different rest...\n\nAnyway, it's clear that there are no *major* changes required here.  I'm going to start testing the same set of worksheets Jason tried last year now, since I'm hoping to convert them anyway, and see what happens.  Let's hope this can get in by Sage 5.3!",
    "created_at": "2012-07-03T13:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105361",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:61'></a>
> > * In results sections, is all html being removed?  Is there a reason for this?  I assume that this is to take care of a specific type of result that can occur that I can't think of right now.  After all, a Sage cell is a Python cell, and html certainly could be legitimate output.
 
Here's an example - `@`interact output is html.  In sws2tex, whuss and friends just completely ignore them - perhaps not the worst idea, given that it's supposed to be interactive and a tex (or rst) document isn't, by definition.
> What should I do? I don't feel like parsing it into rst, because it's output, and parsing is lossy. I cannot be too literal either, because I have to leave something that works when the rst files are rendered into html, tex or whatever.

I suppose one could start the tree all over again?  But that seems less than ideal.  Would it be possible to place the html in code tags?  I am wondering what some of the typical examples you ran across were.  Certainly we can't (or at least don't want to, maybe rest supports this) support all the style stuff html would support.
> The question is related to others, like the one on tracebacks for example. I didn't like long tracebacks in the docs, which would scare my non-technical prospective readers. Should I rewrite sws2rst to incorporate several config options, like long_tracebacks or parse_html_in_results or replace_monospace_font_by_code_tags? Can you think of others?

Maybe in another ticket, in general.  The html one I was a little unsure, since html output could be legitimate.  I do think that the monospace (Courier, I guess?) by code shouldn't be the default, just because that seems to be your own personal trick, but conceivably others might just want text, and might be surprised if all text that was in lots of TinyMCE fonts looks the same, except the text in that particular font.  I wish we had a way to turn the different font sizes into different rest...

Anyway, it's clear that there are no *major* changes required here.  I'm going to start testing the same set of worksheets Jason tried last year now, since I'm hoping to convert them anyway, and see what happens.  Let's hope this can get in by Sage 5.3!



---

archive/issue_comments_105362.json:
```json
{
    "body": "Apply to scripts",
    "created_at": "2012-07-03T14:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105362",
    "user": "https://github.com/kcrisman"
}
```

Apply to scripts



---

archive/attachments_013936.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10637-scripts-docsandmore.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/trac_10637-scripts-docsandmore.patch",
    "created_at": "2012-07-03T14:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_105363.json:
```json
{
    "body": "<a id='comment:62'></a>\nMade a very minor change to the sphinxify help message, so I renamed that patch so it makes more sense now.",
    "created_at": "2012-07-03T14:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105363",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:62'></a>
Made a very minor change to the sphinxify help message, so I renamed that patch so it makes more sense now.



---

archive/issue_comments_105364.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -36,7 +36,7 @@\n * Be sure you have a recent beta, and/or that #11080 and #11459 are included.\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n * Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-root-docsandmore.patch] to the scripts repository\n+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n * Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n \n``````\n",
    "created_at": "2012-07-03T14:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105364",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -36,7 +36,7 @@
 * Be sure you have a recent beta, and/or that #11080 and #11459 are included.
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
 * Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-root-docsandmore.patch] to the scripts repository
+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
 * Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by
 
``````




---

archive/issue_comments_105365.json:
```json
{
    "body": "<a id='comment:63'></a>\nOkay, here are some comments from a first try of a bunch of worksheets.  It is a long list!  So before I get to it, I want to say that **in general, this is working great; everything that doesn't work is easily fixable in the rst source file by a very much non-expert in ReST like myself**.  If some of these things are fixable - particularly the extra newline needed in lists, and the issue with math formatting - that would be best before this makes it into Sage, but most of the rest should be in an upgrade.  Great work!\n\n---\n\n* As I suspected, intra-worksheets links are not respected.  For example, I had \n\n```\n<a href=\"#Main\">below</a>\n```\n   and then later\n\n```\n<p id=\"Main\">The main part of ...\n```\n   The ReST is \n\n```\nplease skip  `below <#Main>`_ .\n```\n   I don't know if that is easy to fix, but anyway it's not perfect.  Again, given the goals of this, that could be in a second version, but I wanted to point it out.  Maybe if the text is `#foo` it could be prepended somehow?  But of course the ids are mostly gone, I guess.\n* The way you replace a span by a `\\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.\n\n```\nPlot a green <span style=\"color: #008000;\">$y=\\sin(x)$</span> together with...\n```\n   and then it made a new line there.  I'm wondering why you chose to make `\\n` instead of just a space - surely you encountered some \"real-life\" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.\n* I think one might need a few other new lines in other places.  Here is an example of something that didn't work right.  The html:\n\n```\n<p>For a typical mathematical function, it's pretty straightforward to define it. &nbsp;Below, we define the function $$f(x)=x^2\\; .$$</p>\n```\n   which became\n\n```\nFor a typical mathematical function, it's pretty straightforward to define it.  Below, we define the function\n.. MATH::\n\n    f(x)=x^2\\; .\n```\n   which typeset with the `.. MATH:` as part of the paragraph, interpreting the double colon as making it an input cell (which it then looked like.  I'm not sure what happened here, but I'm guessing it has something to do with the removal of the paragraphs with double dollar signs.  \n* Here's an even worse example of math not behaving right.\n\n```\n<ul>\n<li>For instance, it isn't too hard to add things like $$\\zeta(s)=\\sum_{n=1}^{\\infty}\\frac{1}{n^s}=\\prod_p \\left(\\frac{1}{1-p^{-s}}\\right)\\; .$$&nbsp;</li>\n<li>One just types things like&nbsp;\"\\$\\$\\zeta(s)=\\sum_{n=1}^{\\infty}\\frac{1}{n^s}=\\prod_p \\left(\\frac{1}{1-p^{-s}}\\right)\\$\\$\" in the word processor. &nbsp;</li>\n<li>Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible. &nbsp;</li>\n<li>More realistically, we might type \"\\$f(x)=x^2\\$\" so that we remember that $f(x)=x^2$ in this worksheet.</li>\n</ul>\n```\n   became all math mode, because the indentation\n\n```\n  - For instance, it isn't too hard to add things like\n.. MATH::\n  \n    \\zeta(s)=\\sum_{n=1}^{\\infty}\\frac{1}{n^s}=\\prod_p \\left(\\frac{1}{1-p^{-s}}\\right)\\; .\n\n\n\n  - One just types things like \"\\$\\$\\zeta(s)=\\sum_{n=1}^{\\infty}\\frac{1}{n^s}=\\prod_p \\left(\\frac{1}{1\\-p^{\\-s}}\\right)\\$\\$$\n    \n  - Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible.\n\n```\n   all was interpreted as being part of the math block!  Instead, the math block should have been inside the list, I guess?\n* This is just amusing.  \n\n```\narrow $\\mapsto$ as \"|--&gt;\").\n```\n   becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?\n* In that same line, Sphinx says \n\n```\nWARNING: Inline substitution_reference start-string without end-string.\n```\n   which I assume is related because of the open pipe `|` without a close pipe.\n* Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the \"live\" documentation... that's obviously very low priority.\n* Hyperlinks (to other sites, which do work) add an extra space on either side.  That looks ok if there isn't punctuation, but if there is, it looks weird.\n\n```\nthe  `Sage website <http://www.sagemath.org/help.html>`_ , which\n```\n   Note the space before the comma, which shows up in the built doc as well.\n* Here is an example of the very common error about bullet lists.\n\n```\n - Sage uses the Python programming language, which uses this syntax, 'under the hood', and\n\n - Because it makes it easier to distinguish among\n  - The mathematical object,\n```\n   yields\n\n```\nWARNING: Bullet list ends without a blank line; unexpected unindent.\n```\n   pretty consistently.   This should be fixed, and probably isn't too hard to do by adding an extra `\\n` somewhere in the ul code.  I would say that 90% of the Sphinx errors I got were this.\n* There were also a few like this.\n\n```\nWARNING: Block quote ends without a blank line; unexpected unindent.\n```\n   This comes from turning things like\n\n```\n<p>The most obvious one is simply turning $$\\int f(x)dx$$ into $$\\int_a^b f(x)dx\\; ,$$ as indicated in the Calculus I section. &nbsp;</p>\n```\ninto \n\n```\nThe most obvious one is simply turning\n.. MATH::\n\n    \\int f(x)dx\n\n  into\n.. MATH::\n\n    \\int_a^b f(x)dx\\; ,\n\n  as indicated in the Calculus I section.\n```\n   Not only is there the issue with the reinterpretation of the math block as a literal block, but it interprets the extra words as part of the literal block - but only because they for some reason got extra spaces.\n* I found one thing that doesn't show up properly because of the html blocks being removed - documentation!  If one evaluates a cell like `binomial??` then that is all html, and just disappears.  Maybe just making it plain text?  I'm not sure either, you are right about that being a pain in the neck to do anything intelligent with.\n* There isn't much you can do about this, but since \"the order enforced will be the order as encountered\" with section heading markup, one can pretty easily get a lot of `SEVERE: Title level inconsistent:` warnings.  This is because we have a WYSIWYG editor which doesn't remember state between cells.\n* Back to issues about lists.  I think that you are starting too big.  The first indent level should just be at the main level; the ones after that can be indented by one.  Isn't this\n\n```\n- item one\n\n - item 1a\n - item 1b\n\n- item two\n\n - item 2a\n -item 2b\n```\n   more correct than\n\n```\n - item one\n  - item 1a\n  - item 1b\n\n - item two\n  - item 2a\n  -item 2b\n```\n   which you currently have?  If you look at rendered worksheets, you'll see what I mean - everything is just a little too far in.",
    "created_at": "2012-07-03T15:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105365",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:63'></a>
Okay, here are some comments from a first try of a bunch of worksheets.  It is a long list!  So before I get to it, I want to say that **in general, this is working great; everything that doesn't work is easily fixable in the rst source file by a very much non-expert in ReST like myself**.  If some of these things are fixable - particularly the extra newline needed in lists, and the issue with math formatting - that would be best before this makes it into Sage, but most of the rest should be in an upgrade.  Great work!

---

* As I suspected, intra-worksheets links are not respected.  For example, I had 

```
<a href="#Main">below</a>
```
   and then later

```
<p id="Main">The main part of ...
```
   The ReST is 

```
please skip  `below <#Main>`_ .
```
   I don't know if that is easy to fix, but anyway it's not perfect.  Again, given the goals of this, that could be in a second version, but I wanted to point it out.  Maybe if the text is `#foo` it could be prepended somehow?  But of course the ids are mostly gone, I guess.
* The way you replace a span by a `\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.

```
Plot a green <span style="color: #008000;">$y=\sin(x)$</span> together with...
```
   and then it made a new line there.  I'm wondering why you chose to make `\n` instead of just a space - surely you encountered some "real-life" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.
* I think one might need a few other new lines in other places.  Here is an example of something that didn't work right.  The html:

```
<p>For a typical mathematical function, it's pretty straightforward to define it. &nbsp;Below, we define the function $$f(x)=x^2\; .$$</p>
```
   which became

```
For a typical mathematical function, it's pretty straightforward to define it.  Below, we define the function
.. MATH::

    f(x)=x^2\; .
```
   which typeset with the `.. MATH:` as part of the paragraph, interpreting the double colon as making it an input cell (which it then looked like.  I'm not sure what happened here, but I'm guessing it has something to do with the removal of the paragraphs with double dollar signs.  
* Here's an even worse example of math not behaving right.

```
<ul>
<li>For instance, it isn't too hard to add things like $$\zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^s}=\prod_p \left(\frac{1}{1-p^{-s}}\right)\; .$$&nbsp;</li>
<li>One just types things like&nbsp;"\$\$\zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^s}=\prod_p \left(\frac{1}{1-p^{-s}}\right)\$\$" in the word processor. &nbsp;</li>
<li>Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible. &nbsp;</li>
<li>More realistically, we might type "\$f(x)=x^2\$" so that we remember that $f(x)=x^2$ in this worksheet.</li>
</ul>
```
   became all math mode, because the indentation

```
  - For instance, it isn't too hard to add things like
.. MATH::
  
    \zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^s}=\prod_p \left(\frac{1}{1-p^{-s}}\right)\; .



  - One just types things like "\$\$\zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^s}=\prod_p \left(\frac{1}{1\-p^{\-s}}\right)\$\$$
    
  - Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible.

```
   all was interpreted as being part of the math block!  Instead, the math block should have been inside the list, I guess?
* This is just amusing.  

```
arrow $\mapsto$ as "|--&gt;").
```
   becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?
* In that same line, Sphinx says 

```
WARNING: Inline substitution_reference start-string without end-string.
```
   which I assume is related because of the open pipe `|` without a close pipe.
* Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the "live" documentation... that's obviously very low priority.
* Hyperlinks (to other sites, which do work) add an extra space on either side.  That looks ok if there isn't punctuation, but if there is, it looks weird.

```
the  `Sage website <http://www.sagemath.org/help.html>`_ , which
```
   Note the space before the comma, which shows up in the built doc as well.
* Here is an example of the very common error about bullet lists.

```
 - Sage uses the Python programming language, which uses this syntax, 'under the hood', and

 - Because it makes it easier to distinguish among
  - The mathematical object,
```
   yields

```
WARNING: Bullet list ends without a blank line; unexpected unindent.
```
   pretty consistently.   This should be fixed, and probably isn't too hard to do by adding an extra `\n` somewhere in the ul code.  I would say that 90% of the Sphinx errors I got were this.
* There were also a few like this.

```
WARNING: Block quote ends without a blank line; unexpected unindent.
```
   This comes from turning things like

```
<p>The most obvious one is simply turning $$\int f(x)dx$$ into $$\int_a^b f(x)dx\; ,$$ as indicated in the Calculus I section. &nbsp;</p>
```
into 

```
The most obvious one is simply turning
.. MATH::

    \int f(x)dx

  into
.. MATH::

    \int_a^b f(x)dx\; ,

  as indicated in the Calculus I section.
```
   Not only is there the issue with the reinterpretation of the math block as a literal block, but it interprets the extra words as part of the literal block - but only because they for some reason got extra spaces.
* I found one thing that doesn't show up properly because of the html blocks being removed - documentation!  If one evaluates a cell like `binomial??` then that is all html, and just disappears.  Maybe just making it plain text?  I'm not sure either, you are right about that being a pain in the neck to do anything intelligent with.
* There isn't much you can do about this, but since "the order enforced will be the order as encountered" with section heading markup, one can pretty easily get a lot of `SEVERE: Title level inconsistent:` warnings.  This is because we have a WYSIWYG editor which doesn't remember state between cells.
* Back to issues about lists.  I think that you are starting too big.  The first indent level should just be at the main level; the ones after that can be indented by one.  Isn't this

```
- item one

 - item 1a
 - item 1b

- item two

 - item 2a
 -item 2b
```
   more correct than

```
 - item one
  - item 1a
  - item 1b

 - item two
  - item 2a
  -item 2b
```
   which you currently have?  If you look at rendered worksheets, you'll see what I mean - everything is just a little too far in.



---

archive/issue_comments_105366.json:
```json
{
    "body": "<a id='comment:64'></a>\nAnd as a followup, doing another group of simpler worksheets yielded only three bullet list errors and a few other things.    I did have a couple MathJax issues, but I'm pretty sure that's what they are, nothing to do with the patches here.",
    "created_at": "2012-07-03T17:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105366",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:64'></a>
And as a followup, doing another group of simpler worksheets yielded only three bullet list errors and a few other things.    I did have a couple MathJax issues, but I'm pretty sure that's what they are, nothing to do with the patches here.



---

archive/issue_comments_105367.json:
```json
{
    "body": "<a id='comment:65'></a>\nMaybe a patch like the following would allow passing absolute path names as arguments:\n\n```diff\ndiff --git a/sage-sws2rst b/sage-sws2rst\n--- a/sage-sws2rst\n+++ b/sage-sws2rst\n@@ -51,10 +51,10 @@ def process_sws(file_name):\n     #TODO: python complains about using tempnam, but I don't\n     #know hot to fix it or see any danger\n #    tempname = os.tempnam('.')\n-    tempname = os.path.join(tempfile.gettempdir(), file_name)\n-    sws_file.extractall(tempname)\n     base_name = os.path.split(os.path.splitext(file_name)[0])[1]\n     base_name_clean = base_name.replace(' ','_')\n+    tempname = os.path.join(tempfile.gettempdir(), base_name_clean)\n+    sws_file.extractall(tempname)\n \n     #Images\n     images_dir = base_name_clean + '_media'\n```\nThis needs serious testing, but being unable to pass absolute paths is a show-stopper for me. By the way, you could also use `os.path.basename` instead of `os.path.split` to define `base_name`.",
    "created_at": "2012-07-03T18:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105367",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:65'></a>
Maybe a patch like the following would allow passing absolute path names as arguments:

```diff
diff --git a/sage-sws2rst b/sage-sws2rst
--- a/sage-sws2rst
+++ b/sage-sws2rst
@@ -51,10 +51,10 @@ def process_sws(file_name):
     #TODO: python complains about using tempnam, but I don't
     #know hot to fix it or see any danger
 #    tempname = os.tempnam('.')
-    tempname = os.path.join(tempfile.gettempdir(), file_name)
-    sws_file.extractall(tempname)
     base_name = os.path.split(os.path.splitext(file_name)[0])[1]
     base_name_clean = base_name.replace(' ','_')
+    tempname = os.path.join(tempfile.gettempdir(), base_name_clean)
+    sws_file.extractall(tempname)
 
     #Images
     images_dir = base_name_clean + '_media'
```
This needs serious testing, but being unable to pass absolute paths is a show-stopper for me. By the way, you could also use `os.path.basename` instead of `os.path.split` to define `base_name`.



---

archive/issue_comments_105368.json:
```json
{
    "body": "<a id='comment:66'></a>\nOkay, after thinking about it some more, here is what would be absolutely required for positive review.  \n\n* All questions in [comment:59](#comment%3A59) and [comment:63](#comment%3A63) need to be answered.  Not solved!  Just to have some answer, even if it's \"I don't know\".  This will help tremendously for any followup work.\n* The issue with the math formatting needing the new line must be fixed.\n* The variety of bullet issues should be made better.\n  * The unexpected indent warning\n  * Display math in lists\n  * If not already true, allow unordered lists as sublists of ordered ones (? maybe not as important as the others)\n\nHumbly disagreeing with jhpalmieri about the absolute paths, since I documented it - but of course that would be great, what magic makes this work but not the other version?  If this does in fact work, then I guess that would be good too.\n\nThe point is that we don't want to make the review process overly long here.",
    "created_at": "2012-07-03T18:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105368",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:66'></a>
Okay, after thinking about it some more, here is what would be absolutely required for positive review.  

* All questions in [comment:59](#comment%3A59) and [comment:63](#comment%3A63) need to be answered.  Not solved!  Just to have some answer, even if it's "I don't know".  This will help tremendously for any followup work.
* The issue with the math formatting needing the new line must be fixed.
* The variety of bullet issues should be made better.
  * The unexpected indent warning
  * Display math in lists
  * If not already true, allow unordered lists as sublists of ordered ones (? maybe not as important as the others)

Humbly disagreeing with jhpalmieri about the absolute paths, since I documented it - but of course that would be great, what magic makes this work but not the other version?  If this does in fact work, then I guess that would be good too.

The point is that we don't want to make the review process overly long here.



---

archive/issue_comments_105369.json:
```json
{
    "body": "**Work_Issues:** answer questions, math formatting, lists, maybe absolute paths?",
    "created_at": "2012-07-03T18:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105369",
    "user": "https://github.com/kcrisman"
}
```

**Work_Issues:** answer questions, math formatting, lists, maybe absolute paths?



---

archive/issue_comments_105370.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,7 +18,7 @@\n ```\n \n The proposed implementation adds a script\n-`local/bin/sage-sws2rst`, edits `local/bin/sage-sage` to add\n+`local/bin/sage-sws2rst`, edits `spkg/bin/sage` to add\n the sws2rst option, and add some libraries in\n `sagenb-main/sagenb/notebook/`. It further depends on the\n BeautifulSoup Python library (released under Python's license).\n``````\n",
    "created_at": "2012-07-03T18:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105370",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,7 +18,7 @@
 ```
 
 The proposed implementation adds a script
-`local/bin/sage-sws2rst`, edits `local/bin/sage-sage` to add
+`local/bin/sage-sws2rst`, edits `spkg/bin/sage` to add
 the sws2rst option, and add some libraries in
 `sagenb-main/sagenb/notebook/`. It further depends on the
 BeautifulSoup Python library (released under Python's license).
``````




---

archive/issue_comments_105371.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow\" to \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri\".",
    "created_at": "2012-07-03T18:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105371",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow" to "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri".



---

archive/issue_events_083884.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-07-03T18:57:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83884"
}
```



---

archive/issue_events_083885.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-07-03T18:57:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83885"
}
```



---

archive/issue_comments_105372.json:
```json
{
    "body": "<a id='comment:67'></a>\nSome suggestions for code.  Ignore if stupid.\n\n---\n\n>  * This is just amusing.  \n \n> {{{\n> arrow $\\mapsto$ as \"|--&gt;\").\n> }}}\n>    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?\n\n\nOkay, I think that what happens is that in `replace_latex` you only replace these characters *if* there was no LaTeX to replace in the first place.  But of course that might not always be the case.  This isn't a huge issue, but worth pointing out and probably easy to fix.\n\n---\n\nIn `visit_li`, I think that replacing\n\n```\n        return (' '*self._nested_list \n                + ('#. ' if self._inside_ol else '- ') \n                +' '.join(self.visit(tag) for tag in node.contents))\n```\nwith `' '*(self._nested_list-1)` should work.  That was also a very minor point.\n\n---\n\nWould reversing the setting in `visit_ol` for `visit_ul` work for allowing nested mixed lists?\n\n```\nself._inside_ol = False\nblah\nself._inside_ol = True\n```\n\n---\n\nWould replacing, in `visit_display`,\n\n```\nreturn ('\\n.. MATH::\\n\\n    ' + \n```\nwith\n\n```\nreturn ('\\n\\n.. MATH::\\n\\n    ' + \n```\nhelp with the math display issue?\n\n---\n\nIn `visit_li`, maybe a number of potential issues (in addition to the math not being indented enough) could be solved by \n\n```\n    def visit_li(self, node): \n        return (' '*self._nested_list \n                + ('#. ' if self._inside_ol else '- ') \n                +' '.join(self.visit(tag) for tag in node.contents))\n```\nwith\n\n```\n    def visit_li(self, node):\n        spacing = ' '*(self._nested_list - 1) \n        return (spacing \n                + ('#. ' if self._inside_ol else '- ') \n                +' '.join(self.visit(tag) for tag in node.contents).replace('\\n','\\n'+spacing) )\n```\nWhat do you think?  This just preserves the indentation until the soup gives us the end of the list item, if I did it right.\n\n---\n\nTo solve the issue with the unexpected indent, it looks like it would suffice to change the `visit_ul` and `visit_ol` to have\n\n```\nresult = '\\n' + '\\n'.join(self.visit(tag) for tag in node.contents)\n```\nI think that changing `visit_li` will be less optimal, since there are already newlines between all of those things.  This is where it should be handled.\n\n---\n\nSorry for not having nice diffs like John - I haven't tried these out, just thinking out loud about code.",
    "created_at": "2012-07-03T19:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105372",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:67'></a>
Some suggestions for code.  Ignore if stupid.

---

>  * This is just amusing.  
 
> {{{
> arrow $\mapsto$ as "|--&gt;").
> }}}
>    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?


Okay, I think that what happens is that in `replace_latex` you only replace these characters *if* there was no LaTeX to replace in the first place.  But of course that might not always be the case.  This isn't a huge issue, but worth pointing out and probably easy to fix.

---

In `visit_li`, I think that replacing

```
        return (' '*self._nested_list 
                + ('#. ' if self._inside_ol else '- ') 
                +' '.join(self.visit(tag) for tag in node.contents))
```
with `' '*(self._nested_list-1)` should work.  That was also a very minor point.

---

Would reversing the setting in `visit_ol` for `visit_ul` work for allowing nested mixed lists?

```
self._inside_ol = False
blah
self._inside_ol = True
```

---

Would replacing, in `visit_display`,

```
return ('\n.. MATH::\n\n    ' + 
```
with

```
return ('\n\n.. MATH::\n\n    ' + 
```
help with the math display issue?

---

In `visit_li`, maybe a number of potential issues (in addition to the math not being indented enough) could be solved by 

```
    def visit_li(self, node): 
        return (' '*self._nested_list 
                + ('#. ' if self._inside_ol else '- ') 
                +' '.join(self.visit(tag) for tag in node.contents))
```
with

```
    def visit_li(self, node):
        spacing = ' '*(self._nested_list - 1) 
        return (spacing 
                + ('#. ' if self._inside_ol else '- ') 
                +' '.join(self.visit(tag) for tag in node.contents).replace('\n','\n'+spacing) )
```
What do you think?  This just preserves the indentation until the soup gives us the end of the list item, if I did it right.

---

To solve the issue with the unexpected indent, it looks like it would suffice to change the `visit_ul` and `visit_ol` to have

```
result = '\n' + '\n'.join(self.visit(tag) for tag in node.contents)
```
I think that changing `visit_li` will be less optimal, since there are already newlines between all of those things.  This is where it should be handled.

---

Sorry for not having nice diffs like John - I haven't tried these out, just thinking out loud about code.



---

archive/issue_comments_105373.json:
```json
{
    "body": "<a id='comment:68'></a>\nHere is something more minor, but proving to be just as annoying as replacing all the other things as I use the actual documents I created with this.  Do we really need `.. end of output` in addition to a couple `\\n`s?  It only functions as a comment, and at least in normal Sage documentation this is never there.  I understand its semantic purpose, but it seems like this would be something better handled as a switch.  Again, that could be for a second version...",
    "created_at": "2012-07-04T21:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105373",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:68'></a>
Here is something more minor, but proving to be just as annoying as replacing all the other things as I use the actual documents I created with this.  Do we really need `.. end of output` in addition to a couple `\n`s?  It only functions as a comment, and at least in normal Sage documentation this is never there.  I understand its semantic purpose, but it seems like this would be something better handled as a switch.  Again, that could be for a second version...



---

archive/issue_comments_105374.json:
```json
{
    "body": "<a id='comment:69'></a>\nJust as a shoutout, #13260 is mostly possible due to this patch :)",
    "created_at": "2012-07-16T21:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105374",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:69'></a>
Just as a shoutout, #13260 is mostly possible due to this patch :)



---

archive/issue_comments_105375.json:
```json
{
    "body": "<a id='comment:71'></a>\nAnother thing possibly to do here would be to test this in  sage/tests/cmdline.py as pointed out at [comment:41](#comment%3A41):ticket:11459.",
    "created_at": "2012-07-26T15:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105375",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:71'></a>
Another thing possibly to do here would be to test this in  sage/tests/cmdline.py as pointed out at [comment:41](#comment%3A41):ticket:11459.



---

archive/issue_comments_105376.json:
```json
{
    "body": "<a id='comment:72'></a>\nReplying to [kcrisman](#comment%3A59):\n> * $$ that are intended to be empty LaTeX for later filling in - definitely counts on $$ always existing in pairs\n\n\nI work around a possible problem if $$ and <p>...</p> are not correctly nested, because I observed that this happens, but I assumed that there is no unpaired $$ because the jsmath in the notebook makes that kind of mistake pretty obvious.\n\n> * I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?\n\n\nDone: I don't use that function any more\n\n> * It looks like in visiting ordered lists, that all sublists will automatically becomes numbered.  But couldn't one have an unordered list inside an ordered list?\n\n\nSolved\n\n> * in the replace_latex thing, is it conceivable that the re's would match something by mistake?  It looks like e.g. latex_beginning is matching anything that starts and ends with a dollar sign, as long as it really does end with a dollar sign and not \\$, where that would include any character (possibly zero) before that.  Again, in a well-formed worksheet that wouldn't be a problem, but maybe sometimes people would do things like \"$\\$$\".\n\n\nNice catch! I've taken care of that.\n\n> * Or what if the TinyMCE was (completely) \"h$x+y=z$\", then wouldn't this get replaced by \":math:`x+y=z`\" with the h gone?  It seems like you're assuming \\\\1 is a whitespace character?\n\n\nNope, I collect that char too.\n\n> * How could the branch of visit_strong with _inside_code_tag be reached?  The only place this flag seems to be True is in visit_code, but in that case one just gets plain text and and wouldn't visit_strong, it seems to me\n\n\nYou're damn right.\n\n> * What if there was an anchor tag that was NOT an \"href\"?  There are other uses for anchors.\n\n\nok, done.\n\n> * There is potential for malformed `///` or }}} without the others or cell id's missing and | missing to cause trouble\n\n\nYes, but that's not tinyMCE dependent, and I haven't seen it fail. With any parser, there is wrong input that will produce problems.\n\n> * <p> could be appended to no purpose; I guess this counts heavily on all tags being properly paired\n\n\ncan you give an example? I've tried several configurations and BeautifulSoup seems pretty robust\n\n> * Is it conceivable that the rest will do something wrong with the escape_chars + and friends when it's not replaced? I assume not since they're turned into :math: mode\n\n\nnot sure I understand, haven't seen any problem in this line\n\n> * Am I correct in saying that once inside a code tag, all other tags are ignored?  That appears to be what is going on here.\n\n\nThat's correct. That was probably to deal with <code>var = <strong>my_func</strong>(spam, eggs)</code>, but if you'd rather do something else I'd like to know.\n\n> * In the table, I suppose it's at least possible there could be a tfoot element.  Does this not come out of TinyMCE?\n\n\nNo, TinyMCE does not use the footer, but it's no big deal: now we take care of both.\n\n\n> * What other preformatted text <pre> do we expect?  Should they all be ::'ed?\n\n\nplease detail\n\n> * I know this might not happen a lot, but in theory a cell could do sage: sage: sage: and it should all be removed... not that this is a very big deal.\n\n\nforgot that one, so I'll leave that to a further patch",
    "created_at": "2012-09-04T11:03:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105376",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:72'></a>
Replying to [kcrisman](#comment%3A59):
> * $$ that are intended to be empty LaTeX for later filling in - definitely counts on $$ always existing in pairs


I work around a possible problem if $$ and <p>...</p> are not correctly nested, because I observed that this happens, but I assumed that there is no unpaired $$ because the jsmath in the notebook makes that kind of mistake pretty obvious.

> * I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?


Done: I don't use that function any more

> * It looks like in visiting ordered lists, that all sublists will automatically becomes numbered.  But couldn't one have an unordered list inside an ordered list?


Solved

> * in the replace_latex thing, is it conceivable that the re's would match something by mistake?  It looks like e.g. latex_beginning is matching anything that starts and ends with a dollar sign, as long as it really does end with a dollar sign and not \$, where that would include any character (possibly zero) before that.  Again, in a well-formed worksheet that wouldn't be a problem, but maybe sometimes people would do things like "$\$$".


Nice catch! I've taken care of that.

> * Or what if the TinyMCE was (completely) "h$x+y=z$", then wouldn't this get replaced by ":math:`x+y=z`" with the h gone?  It seems like you're assuming \\1 is a whitespace character?


Nope, I collect that char too.

> * How could the branch of visit_strong with _inside_code_tag be reached?  The only place this flag seems to be True is in visit_code, but in that case one just gets plain text and and wouldn't visit_strong, it seems to me


You're damn right.

> * What if there was an anchor tag that was NOT an "href"?  There are other uses for anchors.


ok, done.

> * There is potential for malformed `///` or }}} without the others or cell id's missing and | missing to cause trouble


Yes, but that's not tinyMCE dependent, and I haven't seen it fail. With any parser, there is wrong input that will produce problems.

> * <p> could be appended to no purpose; I guess this counts heavily on all tags being properly paired


can you give an example? I've tried several configurations and BeautifulSoup seems pretty robust

> * Is it conceivable that the rest will do something wrong with the escape_chars + and friends when it's not replaced? I assume not since they're turned into :math: mode


not sure I understand, haven't seen any problem in this line

> * Am I correct in saying that once inside a code tag, all other tags are ignored?  That appears to be what is going on here.


That's correct. That was probably to deal with <code>var = <strong>my_func</strong>(spam, eggs)</code>, but if you'd rather do something else I'd like to know.

> * In the table, I suppose it's at least possible there could be a tfoot element.  Does this not come out of TinyMCE?


No, TinyMCE does not use the footer, but it's no big deal: now we take care of both.


> * What other preformatted text <pre> do we expect?  Should they all be ::'ed?


please detail

> * I know this might not happen a lot, but in theory a cell could do sage: sage: sage: and it should all be removed... not that this is a very big deal.


forgot that one, so I'll leave that to a further patch



---

archive/issue_comments_105377.json:
```json
{
    "body": "<a id='comment:73'></a>\nReplying to [kcrisman](#comment%3A67):\n> Some suggestions for code.  Ignore if stupid.\n> \n> \n> ---\n> \n> >  * This is just amusing.  \n \n> > {{{\n> > arrow $\\mapsto$ as \"|--&gt;\").\n> > }}}\n> >    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?\n\n> \n> Okay, I think that what happens is that in `replace_latex` you only replace these characters *if* there was no LaTeX to replace in the first place.  But of course that might not always be the case.  This isn't a huge issue, but worth pointing out and probably easy to fix.\n\n\nSolved: now I replace those chars outside of LaTex as many times as needed.\n\n\n> In `visit_li`, I think that replacing\n> \n> ```\n>         return (' '*self._nested_list \n>                 + ('#. ' if self._inside_ol else '- ') \n>                 +' '.join(self.visit(tag) for tag in node.contents))\n> ```\n> with `' '*(self._nested_list-1)` should work.  That was also a very minor point.\n\n\nok, did something similar. It did improve a lot.\n \n \n> Would reversing the setting in `visit_ol` for `visit_ul` work for allowing nested mixed lists?\n> \n> ```\n> self._inside_ol = False\n> blah\n> self._inside_ol = True\n> ```\n\n \nok, but I did something slightly more complex. Your proposal would not cover all situations, like more than two nesting levels.\n \n> Would replacing, in `visit_display`,\n> \n> ```\n> return ('\\n.. MATH::\\n\\n    ' + \n> ```\n> with\n> \n> ```\n> return ('\\n\\n.. MATH::\\n\\n    ' + \n> ```\n> help with the math display issue?\n\n\nIt did\n \n\n> To solve the issue with the unexpected indent, it looks like it would suffice to change the `visit_ul` and `visit_ol` to have\n> \n> ```\n> result = '\\n' + '\\n'.join(self.visit(tag) for tag in node.contents)\n> ```\n> I think that changing `visit_li` will be less optimal, since there are already newlines between all of those things.  This is where it should be handled.\n\n\nYou're right. Problem is: with tinyMCE I got a nested list that was inside an <li> tag for the parent list, but of course I want to allow also for the nested ul to be inside the ul directly, so: is there is any problem is I just add an excess of blank lines:\n\n`result = '\\n\\n' + '\\n'.join(self.visit(tag) for tag in node.contents)`",
    "created_at": "2012-09-04T11:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105377",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:73'></a>
Replying to [kcrisman](#comment%3A67):
> Some suggestions for code.  Ignore if stupid.
> 
> 
> ---
> 
> >  * This is just amusing.  
 
> > {{{
> > arrow $\mapsto$ as "|--&gt;").
> > }}}
> >    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?

> 
> Okay, I think that what happens is that in `replace_latex` you only replace these characters *if* there was no LaTeX to replace in the first place.  But of course that might not always be the case.  This isn't a huge issue, but worth pointing out and probably easy to fix.


Solved: now I replace those chars outside of LaTex as many times as needed.


> In `visit_li`, I think that replacing
> 
> ```
>         return (' '*self._nested_list 
>                 + ('#. ' if self._inside_ol else '- ') 
>                 +' '.join(self.visit(tag) for tag in node.contents))
> ```
> with `' '*(self._nested_list-1)` should work.  That was also a very minor point.


ok, did something similar. It did improve a lot.
 
 
> Would reversing the setting in `visit_ol` for `visit_ul` work for allowing nested mixed lists?
> 
> ```
> self._inside_ol = False
> blah
> self._inside_ol = True
> ```

 
ok, but I did something slightly more complex. Your proposal would not cover all situations, like more than two nesting levels.
 
> Would replacing, in `visit_display`,
> 
> ```
> return ('\n.. MATH::\n\n    ' + 
> ```
> with
> 
> ```
> return ('\n\n.. MATH::\n\n    ' + 
> ```
> help with the math display issue?


It did
 

> To solve the issue with the unexpected indent, it looks like it would suffice to change the `visit_ul` and `visit_ol` to have
> 
> ```
> result = '\n' + '\n'.join(self.visit(tag) for tag in node.contents)
> ```
> I think that changing `visit_li` will be less optimal, since there are already newlines between all of those things.  This is where it should be handled.


You're right. Problem is: with tinyMCE I got a nested list that was inside an <li> tag for the parent list, but of course I want to allow also for the nested ul to be inside the ul directly, so: is there is any problem is I just add an excess of blank lines:

`result = '\n\n' + '\n'.join(self.visit(tag) for tag in node.contents)`



---

archive/issue_comments_105378.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [kcrisman](#comment%3A63):\n>  * As I suspected, intra-worksheets links are not respected.  \n\n\nThey are now\n\n>  * The way you replace a span by a `\\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.\n \n> {{{\n> Plot a green <span style=\"color: #008000;\">$y=\\sin(x)$</span> together with...\n> }}}\n>    and then it made a new line there.  I'm wondering why you chose to make `\\n` instead of just a space - surely you encountered some \"real-life\" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.\n\n\nI don't really remember why I did that, but it also screwed html tables in some situations, so it's best, and more naturally, made into a space.\n\n>  * I think one might need a few other new lines in other places. \n\n\n\n\n>  * Here's an even worse example of math not behaving right.\n \n> {{{\n> <ul>\n> <li>For instance, it isn't too hard to add things like $$\\zeta(s)=\\sum_{n=1}<sup>{\\infty}\\frac{1}{n</sup>s}=\\prod_p \\left(\\frac{1}{1-p^{-s}}\\right)\\; .$$&nbsp;</li>\n> <li>One just types things like&nbsp;\"\\$\\$\\zeta(s)=\\sum_{n=1}<sup>{\\infty}\\frac{1}{n</sup>s}=\\prod_p \\left(\\frac{1}{1-p^{-s}}\\right)\\$\\$\" in the word processor. &nbsp;</li>\n> <li>Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible. &nbsp;</li>\n> <li>More realistically, we might type \"\\$f(x)=x^2\\$\" so that we remember that $f(x)=x^2$ in this worksheet.</li>\n> </ul>\n> }}}\n>    became all math mode, because the indentation\n> \n> ```\n>   - For instance, it isn't too hard to add things like\n> .. MATH::\n>   \n>     \\zeta(s)=\\sum_{n=1}^{\\infty}\\frac{1}{n^s}=\\prod_p \\left(\\frac{1}{1-p^{-s}}\\right)\\; .\n> \n> \n> \n>   - One just types things like \"\\$\\$\\zeta(s)=\\sum_{n=1}^{\\infty}\\frac{1}{n^s}=\\prod_p \\left(\\frac{1}{1\\-p^{\\-s}}\\right)\\$\\$$\n>     \n>   - Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible.\n> \n> ```\n>    all was interpreted as being part of the math block!  Instead, the math block should have been inside the list, I guess?\n\n\nThat was solved by unindenting the list items one place, as proposed in other place. Would not work if you have display math inside a nested list. A solution was to place comments \".. end of MATH\" after any display math environment. I could do the same with lists and any other indentation-dependent environment.\n\n\n>  * This is just amusing.  \n \n> {{{\n> arrow $\\mapsto$ as \"|--&gt;\").\n> }}}\n>    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?\n\n\nSolved: now I replace those chars outside of LaTex as many times as needed.\n\n>  * Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the \"live\" documentation... that's obviously very low priority.\n\n\nforgot that one too\n\n>  * Hyperlinks (to other sites, which do work) add an extra space on either side.  That looks ok if there isn't punctuation, but if there is, it looks weird.\n \n> {{{\n> the  `Sage website <http://www.sagemath.org/help.html>`_ , which\n> }}}\n>    Note the space before the comma, which shows up in the built doc as well.\n\n\nfixed\n\n\n>  * I found one thing that doesn't show up properly because of the html blocks being removed - documentation!  If one evaluates a cell like `binomial??` then that is all html, and just disappears.  Maybe just making it plain text?  I'm not sure either, you are right about that being a pain in the neck to do anything intelligent with.\n\n\nRegarding docstring like in binomial??, how about we change the sage code that turns the doctring into html and displays the result, so that it also leaves a comment with the plain rst? The we could simply catch the comment...\n\n\n>  * There isn't much you can do about this, but since \"the order enforced will be the order as encountered\" with section heading markup, one can pretty easily get a lot of `SEVERE: Title level inconsistent:` warnings.  This is because we have a WYSIWYG editor which doesn't remember state between cells.\n\n\nThe use case that I find more likely is a worksheet with no heading at all. I could catch those ones and use the file name as a title: what do you think?",
    "created_at": "2012-09-04T11:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105378",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:74'></a>
Replying to [kcrisman](#comment%3A63):
>  * As I suspected, intra-worksheets links are not respected.  


They are now

>  * The way you replace a span by a `\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.
 
> {{{
> Plot a green <span style="color: #008000;">$y=\sin(x)$</span> together with...
> }}}
>    and then it made a new line there.  I'm wondering why you chose to make `\n` instead of just a space - surely you encountered some "real-life" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.


I don't really remember why I did that, but it also screwed html tables in some situations, so it's best, and more naturally, made into a space.

>  * I think one might need a few other new lines in other places. 




>  * Here's an even worse example of math not behaving right.
 
> {{{
> <ul>
> <li>For instance, it isn't too hard to add things like $$\zeta(s)=\sum_{n=1}<sup>{\infty}\frac{1}{n</sup>s}=\prod_p \left(\frac{1}{1-p^{-s}}\right)\; .$$&nbsp;</li>
> <li>One just types things like&nbsp;"\$\$\zeta(s)=\sum_{n=1}<sup>{\infty}\frac{1}{n</sup>s}=\prod_p \left(\frac{1}{1-p^{-s}}\right)\$\$" in the word processor. &nbsp;</li>
> <li>Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible. &nbsp;</li>
> <li>More realistically, we might type "\$f(x)=x^2\$" so that we remember that $f(x)=x^2$ in this worksheet.</li>
> </ul>
> }}}
>    became all math mode, because the indentation
> 
> ```
>   - For instance, it isn't too hard to add things like
> .. MATH::
>   
>     \zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^s}=\prod_p \left(\frac{1}{1-p^{-s}}\right)\; .
> 
> 
> 
>   - One just types things like "\$\$\zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^s}=\prod_p \left(\frac{1}{1\-p^{\-s}}\right)\$\$$
>     
>   - Whether this shows up as nicely as possible depends on what fonts you have in your browser, but it should be legible.
> 
> ```
>    all was interpreted as being part of the math block!  Instead, the math block should have been inside the list, I guess?


That was solved by unindenting the list items one place, as proposed in other place. Would not work if you have display math inside a nested list. A solution was to place comments ".. end of MATH" after any display math environment. I could do the same with lists and any other indentation-dependent environment.


>  * This is just amusing.  
 
> {{{
> arrow $\mapsto$ as "|--&gt;").
> }}}
>    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?


Solved: now I replace those chars outside of LaTex as many times as needed.

>  * Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the "live" documentation... that's obviously very low priority.


forgot that one too

>  * Hyperlinks (to other sites, which do work) add an extra space on either side.  That looks ok if there isn't punctuation, but if there is, it looks weird.
 
> {{{
> the  `Sage website <http://www.sagemath.org/help.html>`_ , which
> }}}
>    Note the space before the comma, which shows up in the built doc as well.


fixed


>  * I found one thing that doesn't show up properly because of the html blocks being removed - documentation!  If one evaluates a cell like `binomial??` then that is all html, and just disappears.  Maybe just making it plain text?  I'm not sure either, you are right about that being a pain in the neck to do anything intelligent with.


Regarding docstring like in binomial??, how about we change the sage code that turns the doctring into html and displays the result, so that it also leaves a comment with the plain rst? The we could simply catch the comment...


>  * There isn't much you can do about this, but since "the order enforced will be the order as encountered" with section heading markup, one can pretty easily get a lot of `SEVERE: Title level inconsistent:` warnings.  This is because we have a WYSIWYG editor which doesn't remember state between cells.


The use case that I find more likely is a worksheet with no heading at all. I could catch those ones and use the file name as a title: what do you think?



---

archive/issue_comments_105379.json:
```json
{
    "body": "<a id='comment:75'></a>\nOne general comment: I was introducing plenty of extra blank lines. This was the easy way to be safe in case there is no whitespace, and to make it work in some non-perfect-but-real situations like the ul nested inside the li. I took the easy way: introduce as many blank lines as I need at each point, then replace any ocurrence of two or more blank lines with exacly one blank line.\n\nTo jhpalmieri: Your patch works allright, and it's now included.",
    "created_at": "2012-09-04T11:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105379",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:75'></a>
One general comment: I was introducing plenty of extra blank lines. This was the easy way to be safe in case there is no whitespace, and to make it work in some non-perfect-but-real situations like the ul nested inside the li. I took the easy way: introduce as many blank lines as I need at each point, then replace any ocurrence of two or more blank lines with exacly one blank line.

To jhpalmieri: Your patch works allright, and it's now included.



---

archive/issue_comments_105380.json:
```json
{
    "body": "<a id='comment:76'></a>\nHi Pablo!  Wow, what a reply.\n\nI don't have time to test this all the way now, or even try it, but I just wanted to know whether you felt like the stuff I listed in [comment:66](#comment%3A66) was addressed thoroughly.  I assume so!  In that case, presumably any potential reviewer could just look at your responses and see what they think, not just me, which would be good for getting this in.\n\nFor full integration, I guess we'd need to know exactly what patches to apply, and we'd *really* need some update of the fork I made for this at [this pull request](https://github.com/sagemath/sagenb/pull/75).  I think that my current git version of sagenb is too corrupted or I just can't figure it out, so I'd need to start afresh.",
    "created_at": "2012-09-06T19:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105380",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:76'></a>
Hi Pablo!  Wow, what a reply.

I don't have time to test this all the way now, or even try it, but I just wanted to know whether you felt like the stuff I listed in [comment:66](#comment%3A66) was addressed thoroughly.  I assume so!  In that case, presumably any potential reviewer could just look at your responses and see what they think, not just me, which would be good for getting this in.

For full integration, I guess we'd need to know exactly what patches to apply, and we'd *really* need some update of the fork I made for this at [this pull request](https://github.com/sagemath/sagenb/pull/75).  I think that my current git version of sagenb is too corrupted or I just can't figure it out, so I'd need to start afresh.



---

archive/issue_comments_105381.json:
```json
{
    "body": "<a id='comment:77'></a>\nI've just downloaded sage 5.3, compiled for ubuntu 12.04, and I could apply all the patches:\n\ndo you need me to do anything with mercurial, queues and patches? I'll investigate the github thing later. If I have ever used it, I don't remember.",
    "created_at": "2012-09-18T16:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105381",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:77'></a>
I've just downloaded sage 5.3, compiled for ubuntu 12.04, and I could apply all the patches:

do you need me to do anything with mercurial, queues and patches? I'll investigate the github thing later. If I have ever used it, I don't remember.



---

archive/issue_comments_105382.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -36,7 +36,7 @@\n * Be sure you have a recent beta, and/or that #11080 and #11459 are included.\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n * Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to the scripts repository\n \n * Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n \n``````\n",
    "created_at": "2012-09-18T16:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105382",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -36,7 +36,7 @@
 * Be sure you have a recent beta, and/or that #11080 and #11459 are included.
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
 * Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to the scripts repository
 
 * Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by
 
``````




---

archive/issue_comments_105383.json:
```json
{
    "body": "<a id='comment:79'></a>\nReplying to [pang](#comment%3A77):\n> I've just downloaded sage 5.3, compiled for ubuntu 12.04, and I could apply all the patches:\n> \n> do you need me to do anything with mercurial, queues and patches? I'll investigate the github thing later. If I have ever used it, I don't remember.\n\n\nYes, technically we need to create a pull request.  See [here](https://github.com/sagemath/sagenb/pull/75) for the current, outdated one. Unfortunately I have a lot of trouble with github (not so much git as the process of syncing with it) so I'd be grateful if you were able to check out a clone of the master and then do this; luckily, nearly everything is just a new file.  \n\nMaybe you could even change that pull request, though I doubt it. Cc:ing kini on the off chance he knows some slick way to do that.",
    "created_at": "2012-09-18T16:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105383",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:79'></a>
Replying to [pang](#comment%3A77):
> I've just downloaded sage 5.3, compiled for ubuntu 12.04, and I could apply all the patches:
> 
> do you need me to do anything with mercurial, queues and patches? I'll investigate the github thing later. If I have ever used it, I don't remember.


Yes, technically we need to create a pull request.  See [here](https://github.com/sagemath/sagenb/pull/75) for the current, outdated one. Unfortunately I have a lot of trouble with github (not so much git as the process of syncing with it) so I'd be grateful if you were able to check out a clone of the master and then do this; luckily, nearly everything is just a new file.  

Maybe you could even change that pull request, though I doubt it. Cc:ing kini on the off chance he knows some slick way to do that.



---

archive/issue_comments_105384.json:
```json
{
    "body": "<a id='comment:80'></a>\nI can't change the pull request, since you created and own it. Only you can change it. I can however make a new pull request if you don't know how to change your pull request. I'm currently traveling, though, so I can't do it immediately, I'm afraid.",
    "created_at": "2012-09-20T14:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105384",
    "user": "https://github.com/kini"
}
```

<a id='comment:80'></a>
I can't change the pull request, since you created and own it. Only you can change it. I can however make a new pull request if you don't know how to change your pull request. I'm currently traveling, though, so I can't do it immediately, I'm afraid.



---

archive/issue_comments_105385.json:
```json
{
    "body": "<a id='comment:81'></a>\n> > * $$ that are intended to be empty LaTeX for later filling in - definitely counts on $$ always existing in pairs\n \n> \n> I work around a possible problem if $$ and <p>...</p> are not correctly nested, because I observed that this happens, but I assumed that there is no unpaired $$ because the jsmath in the notebook makes that kind of mistake pretty obvious.\n\n\nHmm, good point.\n\n> > * I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?\n \n> \n> Done: I don't use that function any more\n\n\nWhat do you do instead?  What happens to things in code tags?\n\n> > * It looks like in visiting ordered lists, that all sublists will automatically becomes numbered.  But couldn't one have an unordered list inside an ordered list?\n \n> \n> Solved\n\nYup.\n> > * in the replace_latex thing, is it conceivable that the re's would match something by mistake?  It looks like e.g. latex_beginning is matching anything that starts and ends with a dollar sign, as long as it really does end with a dollar sign and not \\$, where that would include any character (possibly zero) before that.  Again, in a well-formed worksheet that wouldn't be a problem, but maybe sometimes people would do things like \"$\\$$\".\n \n> \n> Nice catch! I've taken care of that.\n\n\nI see that, and I *think* it works.  I may have to look at it more closely, as `single_dollar` is one I have to consult my regex resources for :)\n\nMore to come...",
    "created_at": "2012-09-21T17:46:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105385",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:81'></a>
> > * $$ that are intended to be empty LaTeX for later filling in - definitely counts on $$ always existing in pairs
 
> 
> I work around a possible problem if $$ and <p>...</p> are not correctly nested, because I observed that this happens, but I assumed that there is no unpaired $$ because the jsmath in the notebook makes that kind of mistake pretty obvious.


Hmm, good point.

> > * I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?
 
> 
> Done: I don't use that function any more


What do you do instead?  What happens to things in code tags?

> > * It looks like in visiting ordered lists, that all sublists will automatically becomes numbered.  But couldn't one have an unordered list inside an ordered list?
 
> 
> Solved

Yup.
> > * in the replace_latex thing, is it conceivable that the re's would match something by mistake?  It looks like e.g. latex_beginning is matching anything that starts and ends with a dollar sign, as long as it really does end with a dollar sign and not \$, where that would include any character (possibly zero) before that.  Again, in a well-formed worksheet that wouldn't be a problem, but maybe sometimes people would do things like "$\$$".
 
> 
> Nice catch! I've taken care of that.


I see that, and I *think* it works.  I may have to look at it more closely, as `single_dollar` is one I have to consult my regex resources for :)

More to come...



---

archive/issue_comments_105386.json:
```json
{
    "body": "<a id='comment:82'></a>\n> > * What if there was an anchor tag that was NOT an \"href\"?  There are other uses for anchors.\n \n> \n> ok, done.\n\nGood solution.  Since in ReST things are supposed to be unique, there could conceivably be some nastiness if one had links in several worksheets that pointed to the same thing, but that would be fixable by the user.\n\n> > * <p> could be appended to no purpose; I guess this counts heavily on all tags being properly paired\n \n> \n> can you give an example? I've tried several configurations and BeautifulSoup seems pretty robust\n\nIf I could, I can't any more.  We'll let it pass.\n\n> > * In the table, I suppose it's at least possible there could be a tfoot element.  Does this not come out of TinyMCE?\n \n> \n> No, TinyMCE does not use the footer, but it's no big deal: now we take care of both.\n\nOk.\n> \n> > * What other preformatted text <pre> do we expect?  Should they all be ::'ed?\n \n> \n> please detail\n\nI don't remember any more.  I think that I was just wondering what sort of other things might end up in a <pre> tag, and whether some might not be \"block literals\" in Sphinx terms.  I don't know the answer to this.\n\n> > * I know this might not happen a lot, but in theory a cell could do sage: sage: sage: and it should all be removed... not that this is a very big deal.\n \n> \n> forgot that one, so I'll leave that to a further patch\n\n\nWell, and hopefully it would all doctest correctly.",
    "created_at": "2012-09-21T19:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105386",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:82'></a>
> > * What if there was an anchor tag that was NOT an "href"?  There are other uses for anchors.
 
> 
> ok, done.

Good solution.  Since in ReST things are supposed to be unique, there could conceivably be some nastiness if one had links in several worksheets that pointed to the same thing, but that would be fixable by the user.

> > * <p> could be appended to no purpose; I guess this counts heavily on all tags being properly paired
 
> 
> can you give an example? I've tried several configurations and BeautifulSoup seems pretty robust

If I could, I can't any more.  We'll let it pass.

> > * In the table, I suppose it's at least possible there could be a tfoot element.  Does this not come out of TinyMCE?
 
> 
> No, TinyMCE does not use the footer, but it's no big deal: now we take care of both.

Ok.
> 
> > * What other preformatted text <pre> do we expect?  Should they all be ::'ed?
 
> 
> please detail

I don't remember any more.  I think that I was just wondering what sort of other things might end up in a <pre> tag, and whether some might not be "block literals" in Sphinx terms.  I don't know the answer to this.

> > * I know this might not happen a lot, but in theory a cell could do sage: sage: sage: and it should all be removed... not that this is a very big deal.
 
> 
> forgot that one, so I'll leave that to a further patch


Well, and hopefully it would all doctest correctly.



---

archive/issue_comments_105387.json:
```json
{
    "body": "<a id='comment:83'></a>\n> > Okay, I think that what happens is that in `replace_latex` you only replace these characters *if* there was no LaTeX to replace in the first place.  But of course that might not always be the case.  This isn't a huge issue, but worth pointing out and probably easy to fix.\n\n> \n> Solved: now I replace those chars outside of LaTex as many times as needed.\n\nCheck.\n\n> > In `visit_li`, I think that replacing\n> > \n> > ```\n> >         return (' '*self._nested_list \n> >                 + ('#. ' if self._inside_ol else '- ') \n> >                 +' '.join(self.visit(tag) for tag in node.contents))\n> > ```\n> > with `' '*(self._nested_list-1)` should work.  That was also a very minor point.\n\n> \n> ok, did something similar. It did improve a lot.\n\nOk, I found it - a little tricky!  \n\n> > Would reversing the setting in `visit_ol` for `visit_ul` work for allowing nested mixed lists?\n> > \n> > ```\n> > self._inside_ol = False\n> > blah\n> > self._inside_ol = True\n> > ```\n\n>  \n> ok, but I did something slightly more complex.\n\nYup, and I like it.\n> > Would replacing, in `visit_display`,\n> > \n> > ```\n> > return ('\\n.. MATH::\\n\\n    ' + \n> > ```\n> > with\n> > \n> > ```\n> > return ('\\n\\n.. MATH::\\n\\n    ' + \n> > ```\n> > help with the math display issue?\n\n> \n> It did\n\nGreat.\n> \n> > To solve the issue with the unexpected indent, it looks like it would suffice to change the `visit_ul` and `visit_ol` to have\n> > \n> > ```\n> > result = '\\n' + '\\n'.join(self.visit(tag) for tag in node.contents)\n> > ```\n> > I think that changing `visit_li` will be less optimal, since there are already newlines between all of those things.  This is where it should be handled.\n\n> \n> You're right. Problem is: with tinyMCE I got a nested list that was inside an <li> tag for the parent list, but of course I want to allow also for the nested ul to be inside the ul directly, so: is there is any problem is I just add an excess of blank lines:\n> \n> `result = '\\n\\n' + '\\n'.join(self.visit(tag) for tag in node.contents)`\n\nThat should be okay, I think.",
    "created_at": "2012-09-21T19:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105387",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:83'></a>
> > Okay, I think that what happens is that in `replace_latex` you only replace these characters *if* there was no LaTeX to replace in the first place.  But of course that might not always be the case.  This isn't a huge issue, but worth pointing out and probably easy to fix.

> 
> Solved: now I replace those chars outside of LaTex as many times as needed.

Check.

> > In `visit_li`, I think that replacing
> > 
> > ```
> >         return (' '*self._nested_list 
> >                 + ('#. ' if self._inside_ol else '- ') 
> >                 +' '.join(self.visit(tag) for tag in node.contents))
> > ```
> > with `' '*(self._nested_list-1)` should work.  That was also a very minor point.

> 
> ok, did something similar. It did improve a lot.

Ok, I found it - a little tricky!  

> > Would reversing the setting in `visit_ol` for `visit_ul` work for allowing nested mixed lists?
> > 
> > ```
> > self._inside_ol = False
> > blah
> > self._inside_ol = True
> > ```

>  
> ok, but I did something slightly more complex.

Yup, and I like it.
> > Would replacing, in `visit_display`,
> > 
> > ```
> > return ('\n.. MATH::\n\n    ' + 
> > ```
> > with
> > 
> > ```
> > return ('\n\n.. MATH::\n\n    ' + 
> > ```
> > help with the math display issue?

> 
> It did

Great.
> 
> > To solve the issue with the unexpected indent, it looks like it would suffice to change the `visit_ul` and `visit_ol` to have
> > 
> > ```
> > result = '\n' + '\n'.join(self.visit(tag) for tag in node.contents)
> > ```
> > I think that changing `visit_li` will be less optimal, since there are already newlines between all of those things.  This is where it should be handled.

> 
> You're right. Problem is: with tinyMCE I got a nested list that was inside an <li> tag for the parent list, but of course I want to allow also for the nested ul to be inside the ul directly, so: is there is any problem is I just add an excess of blank lines:
> 
> `result = '\n\n' + '\n'.join(self.visit(tag) for tag in node.contents)`

That should be okay, I think.



---

archive/issue_comments_105388.json:
```json
{
    "body": "<a id='comment:84'></a>\n> >  * As I suspected, intra-worksheets links are not respected.  \n \n> \n> They are now\n\nGood.\n\n> >  * Here's an even worse example of math not behaving right.\n \n> That was solved by unindenting the list items one place, as proposed in other place. Would not work if you have display math inside a nested list. A solution was to place comments \".. end of MATH\" after any display math environment. I could do the same with lists and any other indentation-dependent environment.\nFor now this fix is fine.\n\n> >  * This is just amusing.  \n \n> > {{{\n> > arrow $\\mapsto$ as \"|--&gt;\").\n> > }}}\n> >    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?\n\n> \n> Solved: now I replace those chars outside of LaTex as many times as needed.\n\nYup, at the end.  Good.\n\n> >  * Hyperlinks (to other sites, which do work) add an extra space on either side.  That looks ok if there isn't punctuation, but if there is, it looks weird.\n \n> > {{{\n> > the  `Sage website <http://www.sagemath.org/help.html>`_ , which\n> > }}}\n> >    Note the space before the comma, which shows up in the built doc as well.\n\n> \n> fixed\n\nOk.\n\nJust a few more to look at, and then the regex checking...",
    "created_at": "2012-09-21T19:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105388",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:84'></a>
> >  * As I suspected, intra-worksheets links are not respected.  
 
> 
> They are now

Good.

> >  * Here's an even worse example of math not behaving right.
 
> That was solved by unindenting the list items one place, as proposed in other place. Would not work if you have display math inside a nested list. A solution was to place comments ".. end of MATH" after any display math environment. I could do the same with lists and any other indentation-dependent environment.
For now this fix is fine.

> >  * This is just amusing.  
 
> > {{{
> > arrow $\mapsto$ as "|--&gt;").
> > }}}
> >    becomes the same thing, so it doesn't turn back into `|-->`, the arrow!  Not sure what to do about that; why didn't the greater than sign just become a greater than sign when translated from html back?    Also, I thought that `|` was one of the characters you escaped, but maybe this one escaped being escaped?

> 
> Solved: now I replace those chars outside of LaTex as many times as needed.

Yup, at the end.  Good.

> >  * Hyperlinks (to other sites, which do work) add an extra space on either side.  That looks ok if there isn't punctuation, but if there is, it looks weird.
 
> > {{{
> > the  `Sage website <http://www.sagemath.org/help.html>`_ , which
> > }}}
> >    Note the space before the comma, which shows up in the built doc as well.

> 
> fixed

Ok.

Just a few more to look at, and then the regex checking...



---

archive/issue_comments_105389.json:
```json
{
    "body": "<a id='comment:85'></a>\n> >  * The way you replace a span by a `\\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.\n \n> > {{{\n> > Plot a green <span style=\"color: #008000;\">$y=\\sin(x)$</span> together with...\n> > }}}\n> >    and then it made a new line there.  I'm wondering why you chose to make `\\n` instead of just a space - surely you encountered some \"real-life\" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.\n\n> \n> I don't really remember why I did that, but it also screwed html tables in some situations, so it's best, and more naturally, made into a space.\n\nIs this the change in `visit_inline_no_tag`?  Sorry, I just can't figure that one out.\n> >  * Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the \"live\" documentation... that's obviously very low priority.\n \n> \n> forgot that one too\n> \n\nI can't find where you did this.\n> >  * I found one thing that doesn't show up properly because of the html blocks being removed - documentation!  If one evaluates a cell like `binomial??` then that is all html, and just disappears.  Maybe just making it plain text?  I'm not sure either, you are right about that being a pain in the neck to do anything intelligent with.\n \n> \n> Regarding docstring like in binomial??, how about we change the sage code that turns the doctring into html and displays the result, so that it also leaves a comment with the plain rst? The we could simply catch the comment...\n\n\nWell, maybe.  That should be a different patch; we should really get this in.\n\n> >  * There isn't much you can do about this, but since \"the order enforced will be the order as encountered\" with section heading markup, one can pretty easily get a lot of `SEVERE: Title level inconsistent:` warnings.  This is because we have a WYSIWYG editor which doesn't remember state between cells.\n \n> \n> The use case that I find more likely is a worksheet with no heading at all. I could catch those ones and use the file name as a title: what do you think?\n\n\nThat's not a bad idea.  And I like your catching of the identical heading thing - that may have been a little of the problem.  That said, if only we could catch this thing... anyway, fixing the no heading worksheet is a good idea.\n\nFinally, I'm just wondering about a few changes - surely it's obvious what they do, but I'm lazy.\n* The change to `ALL_ENTITIES` in `soup`.\n* The `images_dir` stuff - was that in response to anything I said?",
    "created_at": "2012-09-21T19:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105389",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:85'></a>
> >  * The way you replace a span by a `\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.
 
> > {{{
> > Plot a green <span style="color: #008000;">$y=\sin(x)$</span> together with...
> > }}}
> >    and then it made a new line there.  I'm wondering why you chose to make `\n` instead of just a space - surely you encountered some "real-life" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.

> 
> I don't really remember why I did that, but it also screwed html tables in some situations, so it's best, and more naturally, made into a space.

Is this the change in `visit_inline_no_tag`?  Sorry, I just can't figure that one out.
> >  * Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the "live" documentation... that's obviously very low priority.
 
> 
> forgot that one too
> 

I can't find where you did this.
> >  * I found one thing that doesn't show up properly because of the html blocks being removed - documentation!  If one evaluates a cell like `binomial??` then that is all html, and just disappears.  Maybe just making it plain text?  I'm not sure either, you are right about that being a pain in the neck to do anything intelligent with.
 
> 
> Regarding docstring like in binomial??, how about we change the sage code that turns the doctring into html and displays the result, so that it also leaves a comment with the plain rst? The we could simply catch the comment...


Well, maybe.  That should be a different patch; we should really get this in.

> >  * There isn't much you can do about this, but since "the order enforced will be the order as encountered" with section heading markup, one can pretty easily get a lot of `SEVERE: Title level inconsistent:` warnings.  This is because we have a WYSIWYG editor which doesn't remember state between cells.
 
> 
> The use case that I find more likely is a worksheet with no heading at all. I could catch those ones and use the file name as a title: what do you think?


That's not a bad idea.  And I like your catching of the identical heading thing - that may have been a little of the problem.  That said, if only we could catch this thing... anyway, fixing the no heading worksheet is a good idea.

Finally, I'm just wondering about a few changes - surely it's obvious what they do, but I'm lazy.
* The change to `ALL_ENTITIES` in `soup`.
* The `images_dir` stuff - was that in response to anything I said?



---

archive/issue_comments_105390.json:
```json
{
    "body": "<a id='comment:86'></a>\nReplying to [kcrisman](#comment%3A81):\n \n> > > * I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?\n \n> > \n> > Done: I don't use that function any more\n\n> \n> What do you do instead?  What happens to things in code tags?\n\n\nCode tags work the same, but I don't turn <span style=\"font-family...courier...\">foo(bar)=spam+eggs</span> into <code>foo(bar)=spam+eggs</code>",
    "created_at": "2012-09-24T10:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105390",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:86'></a>
Replying to [kcrisman](#comment%3A81):
 
> > > * I'm not sure about the replace_courier thing.  Are you saying that you, personally, use Courier font to indicate code in TinyMCE, and this is how you replace it with <code></code> tags?  It would be nice for this to be customizable; otherwise, what happens to the poor sap who happens to like Courier and then finds all their text replaced by code?
 
> > 
> > Done: I don't use that function any more

> 
> What do you do instead?  What happens to things in code tags?


Code tags work the same, but I don't turn <span style="font-family...courier...">foo(bar)=spam+eggs</span> into <code>foo(bar)=spam+eggs</code>



---

archive/issue_comments_105391.json:
```json
{
    "body": "<a id='comment:87'></a>\n> > What do you do instead?  What happens to things in code tags?\n\n> \n> Code tags work the same, but I don't turn <span style=\"font-family...courier...\">foo(bar)=spam+eggs</span> into <code>foo(bar)=spam+eggs</code>\n\n\nOh, of course - sorry for the question, even.  I was trying to look only at the patches and not the full code.",
    "created_at": "2012-09-24T12:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105391",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:87'></a>
> > What do you do instead?  What happens to things in code tags?

> 
> Code tags work the same, but I don't turn <span style="font-family...courier...">foo(bar)=spam+eggs</span> into <code>foo(bar)=spam+eggs</code>


Oh, of course - sorry for the question, even.  I was trying to look only at the patches and not the full code.



---

archive/issue_comments_105392.json:
```json
{
    "body": "<a id='comment:88'></a>\nReplying to [kcrisman](#comment%3A85):\n> > >  * The way you replace a span by a `\\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.\n \n> > > {{{\n> > > Plot a green <span style=\"color: #008000;\">$y=\\sin(x)$</span> together with...\n> > > }}}\n> > >    and then it made a new line there.  I'm wondering why you chose to make `\\n` instead of just a space - surely you encountered some \"real-life\" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.\n\n> > \n> > I don't really remember why I did that, but it also screwed html tables in some situations, so it's best, and more naturally, made into a space.\n\n> Is this the change in `visit_inline_no_tag`?  Sorry, I just can't figure that one out.\n\nNo, it's the\n147\t \t            'p': 'inline_no_tag', \n \t159\t            'p': 'p', \n\nplus the:\n\n \t331\t    def visit_p(self, node): \n \t332\t        return ''.join(self.visit(tag) for tag in node.contents) + '\\n\\n' \n\nby the way, the following lines are garbage:\n\n \t333\t        cs = [self.visit(tag) for tag in node.contents] \n \t334\t        return ' '.join(c for c in cs if c.strip()) + '\\n\\n' \n\nKarl, should I make a single patch, and fix also this little stupid thing?\n\n> > >  * Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the \"live\" documentation... that's obviously very low priority.\n \n> > \n> > forgot that one too\n> > \n\n> I can't find where you did this.\n\nI've done nothing, I guess I could drop the code that discards the empty code cells, but on the other hand, I want them out of my pdf...\n\n> Finally, I'm just wondering about a few changes - surely it's obvious what they do, but I'm lazy.\n> * The change to `ALL_ENTITIES` in `soup`.\n\n\nFollowing the documentation of BeautifulSoup, that should convert entities like &amp; into & and $lt; into <, but it doesn't work, so I do it later anyway. In a later ticket, I'll update to a newer version of BeautifulSoup, and this will be a useful reminder.\n\n>  * The `images_dir` stuff - was that in response to anything I said? \n\n\nNo, that's in order to be able to use worksheet2rst as a sage-independent script. Found it useful during testing.",
    "created_at": "2012-09-24T12:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105392",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:88'></a>
Replying to [kcrisman](#comment%3A85):
> > >  * The way you replace a span by a `\n` means that sometimes TinyMCE stuff left over from trying to unformat things gets in a new line.  TinyMCE is annoying that way - sometimes to unitalicize you have to do a few things.  Anyway, users will have to expect lots of newlines because of that.  In one case, I *intentionally* had used a lot of different ones, and since bold isn't a span, but everything else you can do is, the doc looked kind of weird, lots of new lines.  In another case, the text was colored on purpose.
 
> > > {{{
> > > Plot a green <span style="color: #008000;">$y=\sin(x)$</span> together with...
> > > }}}
> > >    and then it made a new line there.  I'm wondering why you chose to make `\n` instead of just a space - surely you encountered some "real-life" examples where that was the better option.  I'm assuming we can't easily take the color info in, if that's the only info.

> > 
> > I don't really remember why I did that, but it also screwed html tables in some situations, so it's best, and more naturally, made into a space.

> Is this the change in `visit_inline_no_tag`?  Sorry, I just can't figure that one out.

No, it's the
147	 	            'p': 'inline_no_tag', 
 	159	            'p': 'p', 

plus the:

 	331	    def visit_p(self, node): 
 	332	        return ''.join(self.visit(tag) for tag in node.contents) + '\n\n' 

by the way, the following lines are garbage:

 	333	        cs = [self.visit(tag) for tag in node.contents] 
 	334	        return ' '.join(c for c in cs if c.strip()) + '\n\n' 

Karl, should I make a single patch, and fix also this little stupid thing?

> > >  * Dumb question; is there a way to have an empty cell?  Currently you remove them, but if the input *and* output are empty, then maybe it's supposed to be an empty cell in the "live" documentation... that's obviously very low priority.
 
> > 
> > forgot that one too
> > 

> I can't find where you did this.

I've done nothing, I guess I could drop the code that discards the empty code cells, but on the other hand, I want them out of my pdf...

> Finally, I'm just wondering about a few changes - surely it's obvious what they do, but I'm lazy.
> * The change to `ALL_ENTITIES` in `soup`.


Following the documentation of BeautifulSoup, that should convert entities like &amp; into & and $lt; into <, but it doesn't work, so I do it later anyway. In a later ticket, I'll update to a newer version of BeautifulSoup, and this will be a useful reminder.

>  * The `images_dir` stuff - was that in response to anything I said? 


No, that's in order to be able to use worksheet2rst as a sage-independent script. Found it useful during testing.



---

archive/issue_comments_105393.json:
```json
{
    "body": "<a id='comment:89'></a>\n> No, it's the\n> 147\t \t            'p': 'inline_no_tag', \n>  \t159\t            'p': 'p', \n> \n> plus the:\n> \n>  \t331\t    def visit_p(self, node): \n>  \t332\t        return ''.join(self.visit(tag) for tag in node.contents) + '\\n\\n' \n\n\nCheck, thanks.\n\n> by the way, the following lines are garbage:\n> \n>  \t333\t        cs = [self.visit(tag) for tag in node.contents] \n>  \t334\t        return ' '.join(c for c in cs if c.strip()) + '\\n\\n' \n> \n> Karl, should I make a single patch, and fix also this little stupid thing?\n\n\nDon't make a single patch, but do change the `response_to_kcrisman` patch and add this and that thing where you catch a worksheet with an empty title and add a title.\n\n> I've done nothing, I guess I could drop the code that discards the empty code cells, but on the other hand, I want them out of my pdf...\n\nEventually one would want this to be a switch, but I guess it's ok for now.  That could be an enhancement request.\n\nThanks for the answers to the other two questions.\n\nSo now I should probably actually test that this works on the things I used it on before :) and then hopefully a pull request will be possible to make.",
    "created_at": "2012-09-24T17:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105393",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:89'></a>
> No, it's the
> 147	 	            'p': 'inline_no_tag', 
>  	159	            'p': 'p', 
> 
> plus the:
> 
>  	331	    def visit_p(self, node): 
>  	332	        return ''.join(self.visit(tag) for tag in node.contents) + '\n\n' 


Check, thanks.

> by the way, the following lines are garbage:
> 
>  	333	        cs = [self.visit(tag) for tag in node.contents] 
>  	334	        return ' '.join(c for c in cs if c.strip()) + '\n\n' 
> 
> Karl, should I make a single patch, and fix also this little stupid thing?


Don't make a single patch, but do change the `response_to_kcrisman` patch and add this and that thing where you catch a worksheet with an empty title and add a title.

> I've done nothing, I guess I could drop the code that discards the empty code cells, but on the other hand, I want them out of my pdf...

Eventually one would want this to be a switch, but I guess it's ok for now.  That could be an enhancement request.

Thanks for the answers to the other two questions.

So now I should probably actually test that this works on the things I used it on before :) and then hopefully a pull request will be possible to make.



---

archive/issue_comments_105394.json:
```json
{
    "body": "<a id='comment:90'></a>\nReplying to [kcrisman](#comment%3A89):\n> > Karl, should I make a single patch, and fix also this little stupid thing?\n\n> \n> Don't make a single patch, but do change the `response_to_kcrisman` patch and add this and that thing where you catch a worksheet with an empty title and add a title.\n\n\nDone: are you happy with the \"catch a worksheet with an empty title and add a title\"? It's nothing special, I wasn't fully satisfied with other ideas, so went for the simpler one.",
    "created_at": "2012-10-01T10:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105394",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:90'></a>
Replying to [kcrisman](#comment%3A89):
> > Karl, should I make a single patch, and fix also this little stupid thing?

> 
> Don't make a single patch, but do change the `response_to_kcrisman` patch and add this and that thing where you catch a worksheet with an empty title and add a title.


Done: are you happy with the "catch a worksheet with an empty title and add a title"? It's nothing special, I wasn't fully satisfied with other ideas, so went for the simpler one.



---

archive/issue_events_083886.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-10-01T16:41:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83886"
}
```



---

archive/issue_events_083887.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-10-01T16:41:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83887"
}
```



---

archive/issue_comments_105395.json:
```json
{
    "body": "<a id='comment:91'></a>\nGood on those things.  Now we really do just need final review (if from me, requires checking the most recent patch regex stuff and checking a bunch of worksheets to see that nothing horrible happens), no more 'needs work', then a new pull request.  I'm sorry I can't do any of those the next couple days.  I'm pretty confident this will look quite good, though.",
    "created_at": "2012-10-01T16:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105395",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:91'></a>
Good on those things.  Now we really do just need final review (if from me, requires checking the most recent patch regex stuff and checking a bunch of worksheets to see that nothing horrible happens), no more 'needs work', then a new pull request.  I'm sorry I can't do any of those the next couple days.  I'm pretty confident this will look quite good, though.



---

archive/issue_comments_105396.json:
```json
{
    "body": "<a id='comment:92'></a>\nKarl, please hold on this. I've noticed one bug. It should be asey to fix, but I cannot take care now. Please leave your testing for later.",
    "created_at": "2012-10-03T14:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105396",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:92'></a>
Karl, please hold on this. I've noticed one bug. It should be asey to fix, but I cannot take care now. Please leave your testing for later.



---

archive/issue_comments_105397.json:
```json
{
    "body": "<a id='comment:93'></a>\n> Karl, please hold on this. I've noticed one bug. It should be asey to fix, but I cannot take care now. Please leave your testing for later.\n\nNo problem; if you've noticed, I haven't had the time since the summer :)",
    "created_at": "2012-10-03T14:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105397",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:93'></a>
> Karl, please hold on this. I've noticed one bug. It should be asey to fix, but I cannot take care now. Please leave your testing for later.

No problem; if you've noticed, I haven't had the time since the summer :)



---

archive/attachments_013937.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10637_answer_to_kcrisman.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/trac_10637_answer_to_kcrisman.patch",
    "created_at": "2012-10-09T16:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```



---

archive/issue_comments_105398.json:
```json
{
    "body": "minor updates suggested by kcrisman",
    "created_at": "2012-10-09T16:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105398",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

minor updates suggested by kcrisman



---

archive/issue_comments_105399.json:
```json
{
    "body": "<a id='comment:94'></a>\nThe bug is gone. It was a regex mistake that swallowed one character. I introduced it while trying to pass all your tests. Negative lookbehind was the answer:\n\nhttp://www.regular-expressions.info/lookaround.html",
    "created_at": "2012-10-09T16:42:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105399",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:94'></a>
The bug is gone. It was a regex mistake that swallowed one character. I introduced it while trying to pass all your tests. Negative lookbehind was the answer:

http://www.regular-expressions.info/lookaround.html



---

archive/issue_comments_105400.json:
```json
{
    "body": "<a id='comment:95'></a>\nWhat is the status of the sagenb pull request?  Is it up to date?",
    "created_at": "2012-10-30T15:27:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105400",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:95'></a>
What is the status of the sagenb pull request?  Is it up to date?



---

archive/issue_comments_105401.json:
```json
{
    "body": "<a id='comment:96'></a>\nNo, the pull request has not been updated since whenever it was created, as far as I know.  \n\nAs to review, I think that Pablo implicitly liked my additions (?) and so, as I say in [comment:91](#comment%3A91), someone needs to check that the regex changes in attachment:trac_10637_answer_to_kcrisman.patch are ok (the rest of that patch is fine, I think) and then presumably test actual worksheets one more time.\n\nSo we'd both be grateful for an independent viewer to do those things.  I don't think I will even know how to update my pull request right now because when I upgraded my computer I just deleted my standalone sagenb repository - I still  have a lot of trouble making it do the \"right\" thing with respect to github.  But this stuff is really within epsilon of being ready, and would be really useful.",
    "created_at": "2012-10-30T15:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105401",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:96'></a>
No, the pull request has not been updated since whenever it was created, as far as I know.  

As to review, I think that Pablo implicitly liked my additions (?) and so, as I say in [comment:91](#comment%3A91), someone needs to check that the regex changes in attachment:trac_10637_answer_to_kcrisman.patch are ok (the rest of that patch is fine, I think) and then presumably test actual worksheets one more time.

So we'd both be grateful for an independent viewer to do those things.  I don't think I will even know how to update my pull request right now because when I upgraded my computer I just deleted my standalone sagenb repository - I still  have a lot of trouble making it do the "right" thing with respect to github.  But this stuff is really within epsilon of being ready, and would be really useful.



---

archive/issue_comments_105402.json:
```json
{
    "body": "<a id='comment:97'></a>\nHow about when this is positively reviewed, I'll merge the sagenb patch(es) in.",
    "created_at": "2012-10-30T15:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105402",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:97'></a>
How about when this is positively reviewed, I'll merge the sagenb patch(es) in.



---

archive/issue_comments_105403.json:
```json
{
    "body": "<a id='comment:98'></a>\n> How about when this is positively reviewed, I'll merge the sagenb patch(es) in.\n\nOkay; I didn't know who was the current sagenb master master, so I was hesitant.  I'll try to make this a priority - Sandy did slow things down somewhat here, though perhaps the extra time would be best spent grading rather than reviewing patches ;-) but I really want Pablo's hard work in as well.  At least it can't really bitrot too much.",
    "created_at": "2012-10-30T15:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105403",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:98'></a>
> How about when this is positively reviewed, I'll merge the sagenb patch(es) in.

Okay; I didn't know who was the current sagenb master master, so I was hesitant.  I'll try to make this a priority - Sandy did slow things down somewhat here, though perhaps the extra time would be best spent grading rather than reviewing patches ;-) but I really want Pablo's hard work in as well.  At least it can't really bitrot too much.



---

archive/issue_comments_105404.json:
```json
{
    "body": "<a id='comment:99'></a>\nWell, the sagenb merge maestro position has been somewhat vacant, as you may have noticed.  Today I decided to clean up a bunch of pending pull requests, though.",
    "created_at": "2012-10-30T15:57:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105404",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:99'></a>
Well, the sagenb merge maestro position has been somewhat vacant, as you may have noticed.  Today I decided to clean up a bunch of pending pull requests, though.



---

archive/issue_comments_105405.json:
```json
{
    "body": "<a id='comment:0'></a>\nYes, sorry about that, by the way. I guess I was sort of the \"sagenb merge maestro\" for a while but I've been pretty busy for the last month and a half or so and have been neglecting Sage. I'll probably be out for the rest of the calendar year as well, actually - sorry about that :(",
    "created_at": "2012-10-30T16:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105405",
    "user": "https://github.com/kini"
}
```

<a id='comment:0'></a>
Yes, sorry about that, by the way. I guess I was sort of the "sagenb merge maestro" for a while but I've been pretty busy for the last month and a half or so and have been neglecting Sage. I'll probably be out for the rest of the calendar year as well, actually - sorry about that :(



---

archive/issue_comments_105406.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe instructions in the ticket descriptions don't work. I get\n\n```\nsimon@linux-sqwp:~/SAGE/prerelease/sage-5.6.rc0/local/bin> hg qimport -P http://trac.sagemath.org/sage_trac/raw-attachment/ticket/10637/trac_10637_answer_to_kcrisman.patch\nF\u00fcge trac_10637_answer_to_kcrisman.patch zur Seriendatei hinzu\nWende trac_10637_answer_to_kcrisman.patch an\nKann 'sagenb/misc/comments2rst.py' nicht zum Patchen finden\n14 von 14 Teilst\u00fccken sind FEHLGESCHLAGEN -- speichere Ausschuss in Datei sagenb/misc/comments2rst.py.rej\nKann 'sagenb/misc/worksheet2rst.py' nicht zum Patchen finden\n4 von 4 Teilst\u00fccken sind FEHLGESCHLAGEN -- speichere Ausschuss in Datei sagenb/misc/worksheet2rst.py.rej\nPatch schlug fehl und Fortsetzung unm\u00f6glich (versuche -v)\nPatch schlug fehl, Fehlerabschnitte noch im Arbeitsverzeichnis\nFehler beim Anwenden. Bitte beheben und trac_10637_answer_to_kcrisman.patch aktualisieren\n```\n\nI guess one first needs to do the sagenb thingy mentioned in the ticket description.",
    "created_at": "2013-02-07T15:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105406",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
The instructions in the ticket descriptions don't work. I get

```
simon@linux-sqwp:~/SAGE/prerelease/sage-5.6.rc0/local/bin> hg qimport -P http://trac.sagemath.org/sage_trac/raw-attachment/ticket/10637/trac_10637_answer_to_kcrisman.patch
Füge trac_10637_answer_to_kcrisman.patch zur Seriendatei hinzu
Wende trac_10637_answer_to_kcrisman.patch an
Kann 'sagenb/misc/comments2rst.py' nicht zum Patchen finden
14 von 14 Teilstücken sind FEHLGESCHLAGEN -- speichere Ausschuss in Datei sagenb/misc/comments2rst.py.rej
Kann 'sagenb/misc/worksheet2rst.py' nicht zum Patchen finden
4 von 4 Teilstücken sind FEHLGESCHLAGEN -- speichere Ausschuss in Datei sagenb/misc/worksheet2rst.py.rej
Patch schlug fehl und Fortsetzung unmöglich (versuche -v)
Patch schlug fehl, Fehlerabschnitte noch im Arbeitsverzeichnis
Fehler beim Anwenden. Bitte beheben und trac_10637_answer_to_kcrisman.patch aktualisieren
```

I guess one first needs to do the sagenb thingy mentioned in the ticket description.



---

archive/issue_comments_105407.json:
```json
{
    "body": "<a id='comment:2'></a>\nAha! Could it be that [attachment:trac_10637_answer_to_kcrisman.patch] is to be applied to the sagenb and not to the scripts repository?",
    "created_at": "2013-02-07T15:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105407",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:2'></a>
Aha! Could it be that [attachment:trac_10637_answer_to_kcrisman.patch] is to be applied to the sagenb and not to the scripts repository?



---

archive/issue_comments_105408.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -36,9 +36,9 @@\n * Be sure you have a recent beta, and/or that #11080 and #11459 are included.\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n * Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to the scripts repository\n+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n-* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by\n+* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to sagenb, possibly followed by\n \n ```\n     sage -python setup.py install && sage -python setup.py develop\n``````\n",
    "created_at": "2013-02-07T15:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105408",
    "user": "https://github.com/simon-king-jena"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -36,9 +36,9 @@
 * Be sure you have a recent beta, and/or that #11080 and #11459 are included.
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
 * Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to the scripts repository
+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
-* Apply [attachment:tools_sws2rst_4.patch] and [attachment:trac_10637-sagenb-reviewer.patch] to sagenb, possibly followed by
+* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to sagenb, possibly followed by
 
 ```
     sage -python setup.py install && sage -python setup.py develop
``````




---

archive/issue_comments_105409.json:
```json
{
    "body": "<a id='comment:3'></a>\nYep. At least [attachment:trac_10637_answer_to_kcrisman.patch] does apply in sagenb.",
    "created_at": "2013-02-07T15:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105409",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>
Yep. At least [attachment:trac_10637_answer_to_kcrisman.patch] does apply in sagenb.



---

archive/issue_comments_105410.json:
```json
{
    "body": "<a id='comment:4'></a>\nIs there a sagenb repository in sage-5.7.beta2? I tried to apply the sagenb patches when I was in SAGE_ROOT/devel/sagenb, but the patch would create SAGE_ROOT/sagenb/misc and put stuff there!\n\nSo, please elaborate on the installation instructions.",
    "created_at": "2013-02-07T16:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105410",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
Is there a sagenb repository in sage-5.7.beta2? I tried to apply the sagenb patches when I was in SAGE_ROOT/devel/sagenb, but the patch would create SAGE_ROOT/sagenb/misc and put stuff there!

So, please elaborate on the installation instructions.



---

archive/issue_comments_105411.json:
```json
{
    "body": "<a id='comment:5'></a>\nHi Simon, thanks for looking at this ticket! We did decide not to ship the repository with sagenb anymore (as it is quite large due to various... well, some might term them \"mistakes\" in the past :) ). The patch itself has been migrated to a git branch, which you can see here:\n\nhttps://github.com/sagemath/sagenb/pull/75\n\nIn order to \"apply\" it, you'll need to install the sagenb repository / development version. There are some instructions on how to do this at the main github project page, https://github.com/sagemath/sagenb (scroll down to the bottom). Hope that helps. I have to go now, but I may post further details later.",
    "created_at": "2013-02-07T16:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105411",
    "user": "https://github.com/kini"
}
```

<a id='comment:5'></a>
Hi Simon, thanks for looking at this ticket! We did decide not to ship the repository with sagenb anymore (as it is quite large due to various... well, some might term them "mistakes" in the past :) ). The patch itself has been migrated to a git branch, which you can see here:

https://github.com/sagemath/sagenb/pull/75

In order to "apply" it, you'll need to install the sagenb repository / development version. There are some instructions on how to do this at the main github project page, https://github.com/sagemath/sagenb (scroll down to the bottom). Hope that helps. I have to go now, but I may post further details later.



---

archive/issue_comments_105412.json:
```json
{
    "body": "<a id='comment:6'></a>\nSorry, I meant look at INSTALL.rst",
    "created_at": "2013-02-07T16:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105412",
    "user": "https://github.com/kini"
}
```

<a id='comment:6'></a>
Sorry, I meant look at INSTALL.rst



---

archive/issue_comments_105413.json:
```json
{
    "body": "<a id='comment:7'></a>\nSimon, if you could finish reviewing this, that would be awesome.  See [comment:96](#comment%3A96) for what remains to be reviewed - basically one thing with regex and then to go ahead and make sure a bunch of worksheets look okay when using it.",
    "created_at": "2013-02-07T16:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105413",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>
Simon, if you could finish reviewing this, that would be awesome.  See [comment:96](#comment%3A96) for what remains to be reviewed - basically one thing with regex and then to go ahead and make sure a bunch of worksheets look okay when using it.



---

archive/issue_comments_105414.json:
```json
{
    "body": "<a id='comment:108'></a>\nReplying to [kini](#comment%3A105):\n> Hi Simon, thanks for looking at this ticket! We did decide not to ship the repository with sagenb anymore (as it is quite large due to various... well, some might term them \"mistakes\" in the past :) ). The patch itself has been migrated to a git branch\n\n\nArrgh. So, I'd need to learn git first...",
    "created_at": "2013-02-07T16:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105414",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:108'></a>
Replying to [kini](#comment%3A105):
> Hi Simon, thanks for looking at this ticket! We did decide not to ship the repository with sagenb anymore (as it is quite large due to various... well, some might term them "mistakes" in the past :) ). The patch itself has been migrated to a git branch


Arrgh. So, I'd need to learn git first...



---

archive/issue_comments_105415.json:
```json
{
    "body": "<a id='comment:9'></a>\nIn the short run: Would it work to take the patches from here and manually apply them with that `patch` command, i.e., without using a version control system?",
    "created_at": "2013-02-07T16:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105415",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:9'></a>
In the short run: Would it work to take the patches from here and manually apply them with that `patch` command, i.e., without using a version control system?



---

archive/issue_comments_105416.json:
```json
{
    "body": "<a id='comment:0'></a>\n> In the short run: Would it work to take the patches from here and manually apply them with that patch command, i.e., without using a version control system?\n\nI don't see why not.\n\n> > Hi Simon, thanks for looking at this ticket! We did decide not to ship the repository with sagenb anymore (as it is quite large due to various... well, some might term them \"mistakes\" in the past :) ). The patch itself has been migrated to a git branch\n\n> \n> Arrgh. So, I'd need to learn git first...\n  \nHopefully there would be some sequence of cut-and-paste commands someone could provide... unfortunately, that person is not me.",
    "created_at": "2013-02-07T16:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105416",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:0'></a>
> In the short run: Would it work to take the patches from here and manually apply them with that patch command, i.e., without using a version control system?

I don't see why not.

> > Hi Simon, thanks for looking at this ticket! We did decide not to ship the repository with sagenb anymore (as it is quite large due to various... well, some might term them "mistakes" in the past :) ). The patch itself has been migrated to a git branch

> 
> Arrgh. So, I'd need to learn git first...
  
Hopefully there would be some sequence of cut-and-paste commands someone could provide... unfortunately, that person is not me.



---

archive/issue_comments_105417.json:
```json
{
    "body": "<a id='comment:1'></a>\nWhat seems to work (around) is to initialise a new hg repository in SAGE_ROOT/devel/sagenb. Of course I am aware that at some point in the near future I need to learn git...\n\nNow that I have successfully transformed my worksheet into rst with these warnings:\n\n```\nProcessing How to implement new algebraic structures in Sage.sws\nWarning: node not supported (or something else?) address\nWarning: node not supported (or something else?) address\nWarning: node not supported (or something else?) address\nWarning: node not supported (or something else?) address\nWarning: node not supported (or something else?) address\nWarning: node not supported (or something else?) h5\nWarning: node not supported (or something else?) h5\nWarning: node not supported (or something else?) h5\nWarning: node not supported (or something else?) h5\nWarning: node not supported (or something else?) h5\n```\nwhat remains to do to turn the .rst file into html?",
    "created_at": "2013-02-07T16:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105417",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
What seems to work (around) is to initialise a new hg repository in SAGE_ROOT/devel/sagenb. Of course I am aware that at some point in the near future I need to learn git...

Now that I have successfully transformed my worksheet into rst with these warnings:

```
Processing How to implement new algebraic structures in Sage.sws
Warning: node not supported (or something else?) address
Warning: node not supported (or something else?) address
Warning: node not supported (or something else?) address
Warning: node not supported (or something else?) address
Warning: node not supported (or something else?) address
Warning: node not supported (or something else?) h5
Warning: node not supported (or something else?) h5
Warning: node not supported (or something else?) h5
Warning: node not supported (or something else?) h5
Warning: node not supported (or something else?) h5
```
what remains to do to turn the .rst file into html?



---

archive/issue_comments_105418.json:
```json
{
    "body": "<a id='comment:2'></a>\nPerhaps rst2html.py?\n\nIt gave me the warnings\n\n```\n(sage-sh) simon@linux-sqwp:Worksheets$ rst2html.py How_to_implement_new_algebraic_structures_in_Sage.rst > How_to_implement_new_algebraic_structures_in_Sage.html\nHow_to_implement_new_algebraic_structures_in_Sage.rst:173: (ERROR/3) Unknown interpreted text role \"class\".\nHow_to_implement_new_algebraic_structures_in_Sage.rst:192: (WARNING/2) Inline strong start-string without end-string.\nHow_to_implement_new_algebraic_structures_in_Sage.rst:829: (WARNING/2) Inline strong start-string without end-string.\nHow_to_implement_new_algebraic_structures_in_Sage.rst:1234: (WARNING/2) Inline interpreted text or phrase reference start-string without end-string.\n```\n\nBut I think my problem is that the .rst file really belongs (and links to) to the docs of Sage. So, I'll try to put it into devel/sage/doc/en/thematic_tutorials/ and let sage -docbuild do the work.",
    "created_at": "2013-02-07T16:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105418",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:2'></a>
Perhaps rst2html.py?

It gave me the warnings

```
(sage-sh) simon@linux-sqwp:Worksheets$ rst2html.py How_to_implement_new_algebraic_structures_in_Sage.rst > How_to_implement_new_algebraic_structures_in_Sage.html
How_to_implement_new_algebraic_structures_in_Sage.rst:173: (ERROR/3) Unknown interpreted text role "class".
How_to_implement_new_algebraic_structures_in_Sage.rst:192: (WARNING/2) Inline strong start-string without end-string.
How_to_implement_new_algebraic_structures_in_Sage.rst:829: (WARNING/2) Inline strong start-string without end-string.
How_to_implement_new_algebraic_structures_in_Sage.rst:1234: (WARNING/2) Inline interpreted text or phrase reference start-string without end-string.
```

But I think my problem is that the .rst file really belongs (and links to) to the docs of Sage. So, I'll try to put it into devel/sage/doc/en/thematic_tutorials/ and let sage -docbuild do the work.



---

archive/issue_comments_105419.json:
```json
{
    "body": "<a id='comment:113'></a>\n> Perhaps rst2html.py?\n\nNo.\n> But I think my problem is that the .rst file really belongs (and links to) to the docs of Sage. So, I'll try to put it into devel/sage/doc/en/thematic_tutorials/ and let sage -docbuild do the work.\n\nThat's reasonable.  I used Sphinx quickstart inside Sage - I thought I documented that somewhere here, but perhaps I didn't.",
    "created_at": "2013-02-07T16:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105419",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:113'></a>
> Perhaps rst2html.py?

No.
> But I think my problem is that the .rst file really belongs (and links to) to the docs of Sage. So, I'll try to put it into devel/sage/doc/en/thematic_tutorials/ and let sage -docbuild do the work.

That's reasonable.  I used Sphinx quickstart inside Sage - I thought I documented that somewhere here, but perhaps I didn't.



---

archive/issue_comments_105420.json:
```json
{
    "body": "<a id='comment:4'></a>\nSince the resulting .rst file is supposed to end up in the thematic tutorials anyway, I tried it, and it seems to work more or less. Some details are not as they were intended.\n\n* The original worksheet contained an address in some html block. It came out verbously, i.e., in the html page, I see\n\n```\n<address style=\u201dtext-align: right;\u201d><span style=\u201dfont-size: small;\u201d>Simon King</span></address> <address style=\u201dtext-align: right;\u201d><span style=\u201dfont-size: small;\u201d>Friedrich-Schiller-Universit\u00e4t Jena</span></address> <address style=\u201dtext-align: right;\u201d><span style=\u201dfont-size: small;\u201d>E-mail: simon dot king at uni hyphen jena dot de</span></address> <address style=\u201dtext-align: right;\u201d><span style=\u201dfont-size: small;\u201d>\u00a9 2011</span></address> <address><br /></address>\n```\n* Is there the possibility to insert Sage-specific links, such as <code>:class:\\`sage.structure.parent.Parent\\`</code>? I think adding this would be a nice feature.\n* Indentation does not work. See below.\n* In my worksheet, I have:\n    **methods *for all objects of a category***, and ***for all elements** of such objects*.\n\n  This became\n    **methods *for all objects** of a category*, and ***for all elements** of such objects*\n* Headers of level 5 are not recognised. Hence, `<h5 style=\u201dpadding-left: 30px;\u201d><span style=\u201dfont-size: large;\u201d>1. A coercion is a map, a conversion may be a <em>partial</em> map</span></h5>` is printed verbously.\n\nConcerning indentation:\n\nIn my worksheet, I have something in a html field that looks like this:\n\n**__Outline__**\n\n**Use existing base classes**\n\n    There are sub-classes of sage.structure.parent.Parent resp. of sage.structure.element.Element that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.\n\n    Arithmetic operations should be implemented by single underscore methods, such as `_add_`, _mul_.\n\nThe outcome then looks like\n\n**Outline**\n\n**Use existing base classes**\n\nThere are sub-classes of sage.structure.parent.Parent resp. of sage.structure.element.Element that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.\n\nArithmetic operations should be implemented by single underscore methods, such as `_add_`, _mul_.",
    "created_at": "2013-02-07T17:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105420",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
Since the resulting .rst file is supposed to end up in the thematic tutorials anyway, I tried it, and it seems to work more or less. Some details are not as they were intended.

* The original worksheet contained an address in some html block. It came out verbously, i.e., in the html page, I see

```
<address style=”text-align: right;”><span style=”font-size: small;”>Simon King</span></address> <address style=”text-align: right;”><span style=”font-size: small;”>Friedrich-Schiller-Universität Jena</span></address> <address style=”text-align: right;”><span style=”font-size: small;”>E-mail: simon dot king at uni hyphen jena dot de</span></address> <address style=”text-align: right;”><span style=”font-size: small;”>© 2011</span></address> <address><br /></address>
```
* Is there the possibility to insert Sage-specific links, such as <code>:class:\`sage.structure.parent.Parent\`</code>? I think adding this would be a nice feature.
* Indentation does not work. See below.
* In my worksheet, I have:
    **methods *for all objects of a category***, and ***for all elements** of such objects*.

  This became
    **methods *for all objects** of a category*, and ***for all elements** of such objects*
* Headers of level 5 are not recognised. Hence, `<h5 style=”padding-left: 30px;”><span style=”font-size: large;”>1. A coercion is a map, a conversion may be a <em>partial</em> map</span></h5>` is printed verbously.

Concerning indentation:

In my worksheet, I have something in a html field that looks like this:

**__Outline__**

**Use existing base classes**

    There are sub-classes of sage.structure.parent.Parent resp. of sage.structure.element.Element that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.

    Arithmetic operations should be implemented by single underscore methods, such as `_add_`, _mul_.

The outcome then looks like

**Outline**

**Use existing base classes**

There are sub-classes of sage.structure.parent.Parent resp. of sage.structure.element.Element that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.

Arithmetic operations should be implemented by single underscore methods, such as `_add_`, _mul_.



---

archive/issue_comments_105421.json:
```json
{
    "body": "<a id='comment:5'></a>\nPS: At the end of my previous post, note that the word \"Outline\" was bold and underlined in the worksheet, but came out just as bold. Also font sizes were not respected. But I didnt use `<h2>` and those things here, so, it could be considered my fault.",
    "created_at": "2013-02-07T17:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105421",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>
PS: At the end of my previous post, note that the word "Outline" was bold and underlined in the worksheet, but came out just as bold. Also font sizes were not respected. But I didnt use `<h2>` and those things here, so, it could be considered my fault.



---

archive/issue_comments_105422.json:
```json
{
    "body": "<a id='comment:6'></a>\nHmm, not recognizing level 5 (or 6) headers might be a problem.  Otherwise:\n\n---\n\nYou can insert the links yourself, but I think that adding them all the time wouldn't make sense, as such rst files might not necessarily become part of Sage documentation, per se.\n\nUnrecognized tags will not be guessed at, I think that is a feature.\n\nIndentation I'm not sure about.  Whitespace doesn't count; you should really be using some formatting for that, I think - not exactly user error, but probably not something one could design around.  What does the *original* worksheet have there (in its html version)?  What that looks like would have a big impact on it.\n\n```\n<p>Here is some text.</p>\n<p><span style=\"white-space: pre;\"> </span>Here, I've tabbed.</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Here I just used spaces.</p>\n```\nis what I get, and it looks to me like the tabs from TinyMCE might not really get much done to them; I bet the third line would work, though.  I'd consider this an enhancement request.",
    "created_at": "2013-02-07T18:18:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105422",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
Hmm, not recognizing level 5 (or 6) headers might be a problem.  Otherwise:

---

You can insert the links yourself, but I think that adding them all the time wouldn't make sense, as such rst files might not necessarily become part of Sage documentation, per se.

Unrecognized tags will not be guessed at, I think that is a feature.

Indentation I'm not sure about.  Whitespace doesn't count; you should really be using some formatting for that, I think - not exactly user error, but probably not something one could design around.  What does the *original* worksheet have there (in its html version)?  What that looks like would have a big impact on it.

```
<p>Here is some text.</p>
<p><span style="white-space: pre;"> </span>Here, I've tabbed.</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Here I just used spaces.</p>
```
is what I get, and it looks to me like the tabs from TinyMCE might not really get much done to them; I bet the third line would work, though.  I'd consider this an enhancement request.



---

archive/issue_comments_105423.json:
```json
{
    "body": "<a id='comment:117'></a>\nReplying to [kcrisman](#comment%3A116):\n> You can insert the links yourself, but I think that adding them all the time wouldn't make sense, as such rst files might not necessarily become part of Sage documentation, per se.\n\n\nOK. I guess that in the end I have to edit the rst file anyway.\n\n> Unrecognized tags will not be guessed at, I think that is a feature.\n\n\nThe notebook comes with an editor (`tinyMCE`, or what is it's name?), and I think sws2rst should be able to work with what is produced by the editor.\n\n> Indentation I'm not sure about.  Whitespace doesn't count; you should really be using some formatting for that,\n\n\nI used the editor in the notebook. Shouldn't that be fine?\n\n> I think - not exactly user error, but probably not something one could design around.  What does the *original* worksheet have there (in its html version)?  What that looks like would have a big impact on it.\n\n\nWhen I click on the \"text\" link, I see\n\n```\n<p><span style=\"text-decoration: underline;\"><strong><span style=\"font-size: x-large;\">Outline</span></strong></span></p>\n<p><strong>Use existing base classes</strong></p>\n<p style=\"padding-left: 30px;\">There are sub-classes of <span style=\"font-family: arial,helvetica,sans-serif;\">sage.structure.parent.Parent</span> resp. of <span style=\"font-family: arial,helvetica,sans-serif;\">sage.structure.element.Element</span> that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.</p>\n<p style=\"padding-left: 30px;\">Arithmetic operations should be implemented by <span style=\"text-decoration: underline;\"><em>single underscore</em></span> methods, such as <span style=\"font-family: arial,helvetica,sans-serif;\">_add_, _mul_</span>.</p>\n<p><strong>Turn your parent structure into an object of a category</strong></p>\n<p style=\"padding-left: 30px;\">Declare the category during initialisation - Your parent structure will inherit further useful methods and consistency tests.</p>\n<p><strong>Provide your parent structure with an element class</strong></p>\n<p style=\"padding-left: 30px;\">Assign to it an attribute called \"Element\" - The elements will inherit further useful methods from the category.</p>\n<p style=\"padding-left: 30px;\">In addition, some basic conversions will immediately work.</p>\n<p><strong>Implement further conversions<br /></strong></p>\n<p style=\"padding-left: 30px;\">Never override a parent's __call__ method! Provide <span style=\"font-family: arial,helvetica,sans-serif;\">_element_constructor_</span> instead.</p>\n<p><strong>Declare coercions</strong></p>\n<p style=\"padding-left: 30px;\">If a conversion happens to be a morphism, you may consider to turn it into a coercion. It will then <em>implicitly</em> be used in arithmetic operations.</p>\n<p><strong><span style=\"text-decoration: underline;\">Advanced coercion:</span> Define construction functors for your parent structure</strong></p>\n<p style=\"padding-left: 30px;\">Sage will automatically create new parents for you when needed, by some kind of \"pushout\" construction.</p>\n<p><strong>Run the automatic test suites</strong></p>\n<p style=\"padding-left: 30px;\">Each method should be documented and provide a doc test (we are not giving examples here). In addition, any method defined for a category should be supported by a test method that is executed when running the test suite.</p>\n```\nSo, that's what is produced by the editor.",
    "created_at": "2013-02-07T19:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105423",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:117'></a>
Replying to [kcrisman](#comment%3A116):
> You can insert the links yourself, but I think that adding them all the time wouldn't make sense, as such rst files might not necessarily become part of Sage documentation, per se.


OK. I guess that in the end I have to edit the rst file anyway.

> Unrecognized tags will not be guessed at, I think that is a feature.


The notebook comes with an editor (`tinyMCE`, or what is it's name?), and I think sws2rst should be able to work with what is produced by the editor.

> Indentation I'm not sure about.  Whitespace doesn't count; you should really be using some formatting for that,


I used the editor in the notebook. Shouldn't that be fine?

> I think - not exactly user error, but probably not something one could design around.  What does the *original* worksheet have there (in its html version)?  What that looks like would have a big impact on it.


When I click on the "text" link, I see

```
<p><span style="text-decoration: underline;"><strong><span style="font-size: x-large;">Outline</span></strong></span></p>
<p><strong>Use existing base classes</strong></p>
<p style="padding-left: 30px;">There are sub-classes of <span style="font-family: arial,helvetica,sans-serif;">sage.structure.parent.Parent</span> resp. of <span style="font-family: arial,helvetica,sans-serif;">sage.structure.element.Element</span> that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.</p>
<p style="padding-left: 30px;">Arithmetic operations should be implemented by <span style="text-decoration: underline;"><em>single underscore</em></span> methods, such as <span style="font-family: arial,helvetica,sans-serif;">_add_, _mul_</span>.</p>
<p><strong>Turn your parent structure into an object of a category</strong></p>
<p style="padding-left: 30px;">Declare the category during initialisation - Your parent structure will inherit further useful methods and consistency tests.</p>
<p><strong>Provide your parent structure with an element class</strong></p>
<p style="padding-left: 30px;">Assign to it an attribute called "Element" - The elements will inherit further useful methods from the category.</p>
<p style="padding-left: 30px;">In addition, some basic conversions will immediately work.</p>
<p><strong>Implement further conversions<br /></strong></p>
<p style="padding-left: 30px;">Never override a parent's __call__ method! Provide <span style="font-family: arial,helvetica,sans-serif;">_element_constructor_</span> instead.</p>
<p><strong>Declare coercions</strong></p>
<p style="padding-left: 30px;">If a conversion happens to be a morphism, you may consider to turn it into a coercion. It will then <em>implicitly</em> be used in arithmetic operations.</p>
<p><strong><span style="text-decoration: underline;">Advanced coercion:</span> Define construction functors for your parent structure</strong></p>
<p style="padding-left: 30px;">Sage will automatically create new parents for you when needed, by some kind of "pushout" construction.</p>
<p><strong>Run the automatic test suites</strong></p>
<p style="padding-left: 30px;">Each method should be documented and provide a doc test (we are not giving examples here). In addition, any method defined for a category should be supported by a test method that is executed when running the test suite.</p>
```
So, that's what is produced by the editor.



---

archive/issue_comments_105424.json:
```json
{
    "body": "<a id='comment:118'></a>\n> The notebook comes with an editor (`tinyMCE`, or what is it's name?), and I think sws2rst should be able to work with what is produced by the editor.\n\nWell, I don't think that arbitrary stuff should be.  For instance, we currently ignore 3D graphics.\n> > Indentation I'm not sure about.  Whitespace doesn't count; you should really be using some formatting for that,\n\n> \n> I used the editor in the notebook. Shouldn't that be fine?\n\nYes, in principle, but I'm not sure we can support every single feature of TinyMCE, an upstream project.\n> > I think - not exactly user error, but probably not something one could design around.  What does the *original* worksheet have there (in its html version)?  What that looks like would have a big impact on it.\n\n> When I click on the \"text\" link, I see\n> \n> ```\n> <p><span style=\"text-decoration: underline;\"><strong><span style=\"font-size: x-large;\">Outline</span></strong></span></p>\n> <p><strong>Use existing base classes</strong></p>\n> <p style=\"padding-left: 30px;\">There are sub-classes of <span style=\"font-family: arial,helvetica,sans-serif;\">sage.structure.parent.Parent</span> resp. of <span style=\"font-family: arial,helvetica,sans-serif;\">sage.structure.element.Element</span> that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.</p>\n> <p style=\"padding-left: 30px;\">Arithmetic operations should be implemented by <span style=\"text-decoration: underline;\"><em>single underscore</em></span> methods, such as <span style=\"font-family: arial,helvetica,sans-serif;\">_add_, _mul_</span>.</p>\n> <p><strong>Turn your parent structure into an object of a category</strong></p>\n> <p style=\"padding-left: 30px;\">Declare the category during initialisation - Your parent structure will inherit further useful methods and consistency tests.</p>\n> <p><strong>Provide your parent structure with an element class</strong></p>\n> <p style=\"padding-left: 30px;\">Assign to it an attribute called \"Element\" - The elements will inherit further useful methods from the category.</p>\n> <p style=\"padding-left: 30px;\">In addition, some basic conversions will immediately work.</p>\n> <p><strong>Implement further conversions<br /></strong></p>\n> <p style=\"padding-left: 30px;\">Never override a parent's __call__ method! Provide <span style=\"font-family: arial,helvetica,sans-serif;\">_element_constructor_</span> instead.</p>\n> <p><strong>Declare coercions</strong></p>\n> <p style=\"padding-left: 30px;\">If a conversion happens to be a morphism, you may consider to turn it into a coercion. It will then <em>implicitly</em> be used in arithmetic operations.</p>\n> <p><strong><span style=\"text-decoration: underline;\">Advanced coercion:</span> Define construction functors for your parent structure</strong></p>\n> <p style=\"padding-left: 30px;\">Sage will automatically create new parents for you when needed, by some kind of \"pushout\" construction.</p>\n> <p><strong>Run the automatic test suites</strong></p>\n> <p style=\"padding-left: 30px;\">Each method should be documented and provide a doc test (we are not giving examples here). In addition, any method defined for a category should be supported by a test method that is executed when running the test suite.</p>\n> ```\n> So, that's what is produced by the editor.\n\nHopefully Pablo can answer this.",
    "created_at": "2013-02-07T19:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105424",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:118'></a>
> The notebook comes with an editor (`tinyMCE`, or what is it's name?), and I think sws2rst should be able to work with what is produced by the editor.

Well, I don't think that arbitrary stuff should be.  For instance, we currently ignore 3D graphics.
> > Indentation I'm not sure about.  Whitespace doesn't count; you should really be using some formatting for that,

> 
> I used the editor in the notebook. Shouldn't that be fine?

Yes, in principle, but I'm not sure we can support every single feature of TinyMCE, an upstream project.
> > I think - not exactly user error, but probably not something one could design around.  What does the *original* worksheet have there (in its html version)?  What that looks like would have a big impact on it.

> When I click on the "text" link, I see
> 
> ```
> <p><span style="text-decoration: underline;"><strong><span style="font-size: x-large;">Outline</span></strong></span></p>
> <p><strong>Use existing base classes</strong></p>
> <p style="padding-left: 30px;">There are sub-classes of <span style="font-family: arial,helvetica,sans-serif;">sage.structure.parent.Parent</span> resp. of <span style="font-family: arial,helvetica,sans-serif;">sage.structure.element.Element</span> that will help you a lot. Inheriting from these classes is essential for using Sage's coercion system.</p>
> <p style="padding-left: 30px;">Arithmetic operations should be implemented by <span style="text-decoration: underline;"><em>single underscore</em></span> methods, such as <span style="font-family: arial,helvetica,sans-serif;">_add_, _mul_</span>.</p>
> <p><strong>Turn your parent structure into an object of a category</strong></p>
> <p style="padding-left: 30px;">Declare the category during initialisation - Your parent structure will inherit further useful methods and consistency tests.</p>
> <p><strong>Provide your parent structure with an element class</strong></p>
> <p style="padding-left: 30px;">Assign to it an attribute called "Element" - The elements will inherit further useful methods from the category.</p>
> <p style="padding-left: 30px;">In addition, some basic conversions will immediately work.</p>
> <p><strong>Implement further conversions<br /></strong></p>
> <p style="padding-left: 30px;">Never override a parent's __call__ method! Provide <span style="font-family: arial,helvetica,sans-serif;">_element_constructor_</span> instead.</p>
> <p><strong>Declare coercions</strong></p>
> <p style="padding-left: 30px;">If a conversion happens to be a morphism, you may consider to turn it into a coercion. It will then <em>implicitly</em> be used in arithmetic operations.</p>
> <p><strong><span style="text-decoration: underline;">Advanced coercion:</span> Define construction functors for your parent structure</strong></p>
> <p style="padding-left: 30px;">Sage will automatically create new parents for you when needed, by some kind of "pushout" construction.</p>
> <p><strong>Run the automatic test suites</strong></p>
> <p style="padding-left: 30px;">Each method should be documented and provide a doc test (we are not giving examples here). In addition, any method defined for a category should be supported by a test method that is executed when running the test suite.</p>
> ```
> So, that's what is produced by the editor.

Hopefully Pablo can answer this.



---

archive/issue_comments_105425.json:
```json
{
    "body": "<a id='comment:9'></a>\nIn general, we ignore style completely. That's part of the goal, not a failure.\n\nThe goal of this script is to turn worksheets into simpler, more maintainable, doctest-friendly, restructured text. Restructured text does not support style, it's roughly equivalent to (a subset of) html without css. For instance, there is no construct for underlined text. Html docs generated from rst sources could be shown underlined, depending on the style used by rst2html.\n\nSo some info is lost, but that means it will be easier for the next guy to keep your documentation at sync with the current sage version, and correct typos.\n\nIf your text is bold and cursive because it is \"strong\", then this script must recognize it and sorround it with asterisks. If it bold and cursive because you applied some style, it's not going to work, and it's hopeless and a loss of time to try to convert html into rst so that it generates html with the exact same style. Any way of doing so involves hacking sphinx so that it keeps the original html in a style file, in one way or another. By the way, I don't think rst supports text that is both strong and em, I vaguely recall some problems trying to nest one inside the other. I'll check this eventually, forgive my lousy memory.\n\nRegarding indentation, please think which html tag would correspond to the text you wanted to indent: is it a quote? is a code snippet? Then a sws to rst converter will have a chance.\n\nIt is true that tinyMCE abuses style, at points at which tags could be used. For example, I had to use the courier font to mark variable names within the text. I wrote a plugin for tinyMCE to add a code button that worked much like the strong button. It was quick dirty code, and the tinyMCE guys ignored the suggestion, but it's definitely doable. May be could tweak the editor so that uses more tags and less style.\n\nIn the meantime, different people might use underline and indent to mean different things, and there's little I can do. Please take this script as a help in your conversion work. At some points, it won't guess the canonical way to map your intentions into the simpler rst format, and you'll have to do it manually.\n\nThis said, thanks a lot for trying the code, and finding the h5 bug. For some reason, I stopped at h4: there are only 5 levels, are there?. It's hard to know if I can do anything about the rest, given the goal I described above. I'll check carefully, but will probably need more info.",
    "created_at": "2013-02-08T09:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105425",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:9'></a>
In general, we ignore style completely. That's part of the goal, not a failure.

The goal of this script is to turn worksheets into simpler, more maintainable, doctest-friendly, restructured text. Restructured text does not support style, it's roughly equivalent to (a subset of) html without css. For instance, there is no construct for underlined text. Html docs generated from rst sources could be shown underlined, depending on the style used by rst2html.

So some info is lost, but that means it will be easier for the next guy to keep your documentation at sync with the current sage version, and correct typos.

If your text is bold and cursive because it is "strong", then this script must recognize it and sorround it with asterisks. If it bold and cursive because you applied some style, it's not going to work, and it's hopeless and a loss of time to try to convert html into rst so that it generates html with the exact same style. Any way of doing so involves hacking sphinx so that it keeps the original html in a style file, in one way or another. By the way, I don't think rst supports text that is both strong and em, I vaguely recall some problems trying to nest one inside the other. I'll check this eventually, forgive my lousy memory.

Regarding indentation, please think which html tag would correspond to the text you wanted to indent: is it a quote? is a code snippet? Then a sws to rst converter will have a chance.

It is true that tinyMCE abuses style, at points at which tags could be used. For example, I had to use the courier font to mark variable names within the text. I wrote a plugin for tinyMCE to add a code button that worked much like the strong button. It was quick dirty code, and the tinyMCE guys ignored the suggestion, but it's definitely doable. May be could tweak the editor so that uses more tags and less style.

In the meantime, different people might use underline and indent to mean different things, and there's little I can do. Please take this script as a help in your conversion work. At some points, it won't guess the canonical way to map your intentions into the simpler rst format, and you'll have to do it manually.

This said, thanks a lot for trying the code, and finding the h5 bug. For some reason, I stopped at h4: there are only 5 levels, are there?. It's hard to know if I can do anything about the rest, given the goal I described above. I'll check carefully, but will probably need more info.



---

archive/issue_comments_105426.json:
```json
{
    "body": "<a id='comment:120'></a>\nReplying to [pang](#comment%3A119):\n> For instance, there is no construct for underlined text.\n\n\nDidn't know that.\n\n> If your text is bold and cursive because it is \"strong\", then this script must recognize it and sorround it with asterisks. If it bold and cursive because you applied some style, it's not going to work, and it's hopeless and a loss of time to try to convert html into rst so that it generates html with the exact same style.\n\n\nIt is bold and cursive because I clicked the bold and cursive buttons in the editor that comes with the notebook. Since bold and cursive *is* supported by rst, my uneducated guess is that a converter should be able to deal with it.\n\n> By the way, I don't think rst supports text that is both strong and em\n\n\nOK, if that's the case then I have to withdraw my previous statement, and the converter can of course not deal with it.\n\n> Regarding indentation, please think which html tag would correspond to the text you wanted to indent: is it a quote? is a code snippet? Then a sws to rst converter will have a chance.\n\n\nIndentation is indentation, I'd say. It isn't code, because it is in a text field, and not in a code cell. It isn't a quote because -- well, I don't have the notebook open, but I think the editor has some button to typeset quotes, and I didn't click this.\n\n> This said, thanks a lot for trying the code, and finding the h5 bug. For some reason, I stopped at h4: there are only 5 levels, are there?.\n\n\nI don't know. But in any case, I am aware that no converter will work perfectly, and I need to edit the result anyway.",
    "created_at": "2013-02-08T10:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105426",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:120'></a>
Replying to [pang](#comment%3A119):
> For instance, there is no construct for underlined text.


Didn't know that.

> If your text is bold and cursive because it is "strong", then this script must recognize it and sorround it with asterisks. If it bold and cursive because you applied some style, it's not going to work, and it's hopeless and a loss of time to try to convert html into rst so that it generates html with the exact same style.


It is bold and cursive because I clicked the bold and cursive buttons in the editor that comes with the notebook. Since bold and cursive *is* supported by rst, my uneducated guess is that a converter should be able to deal with it.

> By the way, I don't think rst supports text that is both strong and em


OK, if that's the case then I have to withdraw my previous statement, and the converter can of course not deal with it.

> Regarding indentation, please think which html tag would correspond to the text you wanted to indent: is it a quote? is a code snippet? Then a sws to rst converter will have a chance.


Indentation is indentation, I'd say. It isn't code, because it is in a text field, and not in a code cell. It isn't a quote because -- well, I don't have the notebook open, but I think the editor has some button to typeset quotes, and I didn't click this.

> This said, thanks a lot for trying the code, and finding the h5 bug. For some reason, I stopped at h4: there are only 5 levels, are there?.


I don't know. But in any case, I am aware that no converter will work perfectly, and I need to edit the result anyway.



---

archive/issue_comments_105427.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe rst file created from a worksheet seems to end each code cell by\n\n```\n.. end of output\n```\n\nIs there any use of that line? When I removed it, the resulting html looked the same.",
    "created_at": "2013-02-08T12:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105427",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
The rst file created from a worksheet seems to end each code cell by

```
.. end of output
```

Is there any use of that line? When I removed it, the resulting html looked the same.



---

archive/issue_comments_105428.json:
```json
{
    "body": "<a id='comment:122'></a>\nReplying to [SimonKing](#comment%3A121):\n> The rst file created from a worksheet seems to end each code cell by\n> \n> ```\n> .. end of output\n> ```\n> \n> Is there any use of that line? When I removed it, the resulting html looked the same.\n\n\nThe problem, if i remember correctly, comes if there is a list after an output cell. The list is indented one space, but the output cell does not end until it finds a non-indented line.",
    "created_at": "2013-02-08T12:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105428",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:122'></a>
Replying to [SimonKing](#comment%3A121):
> The rst file created from a worksheet seems to end each code cell by
> 
> ```
> .. end of output
> ```
> 
> Is there any use of that line? When I removed it, the resulting html looked the same.


The problem, if i remember correctly, comes if there is a list after an output cell. The list is indented one space, but the output cell does not end until it finds a non-indented line.



---

archive/issue_comments_105429.json:
```json
{
    "body": "<a id='comment:3'></a>\n> It is bold and cursive because I clicked the bold and cursive buttons in the editor that comes with the notebook. Since bold and cursive is supported by rst, my uneducated guess is that a converter should be able to deal with it.\n\n\nYes, that does make sense.  I guess the question is whether \"premature optimization is the root of all evil\" or not.  In this case, I think that having an sws2rst converter in Sage that at least converts *some* stuff, but can't handle styles, is worse than having no sws2rst converter at all.  I have found this to be extremely useful in its current state, so I'm not sure it's worth postponing it indefinitely for this reason (as opposed to checking the code itself, which I have lamentably not had time to finish off, but which I should do today).\n\nI think that the problem is that \n\n```\n<p style=\"padding-left: 30px;\">\n```\nis how you achieved your indentation.  That's an HTML style, not whitespace.   \n\nOkay, on further investigation, what you must have done is clicked the \"indent\" button.  Usually I only use this with lists, which creates more levels of lists (and which sws2rst already handles correctly).\n\nPablo, do you think that finding this particular thing?  That is, if we have\n\n```\nstyle=\"padding-left: 60px;\"\n```\nwhere 60 could be any positive integer multiple of 30, as a specific thing in the tag `<p ...>`, could that specific thing be searched for and then replaced with an equivalent amount of whitespace (maybe four `&nbsp;` for instance, per 30px)?  Certainly it would be nightmarish to try to make that into an appropriate amount of lists, and in any case we don't want the list bullets in that case.\n\n---\nA question for Simon - did the Sage root and scripts patches apply fine on a recent beta of 5.7?  I assume so, just checking with respect to rebasing.\n\n---\n\nOkay, for positive review we need the following, in my opinion.  The previous work issues were dealt with long ago.\n* Still to check that regex, though apparently it's working fine\n* Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)\n* Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that\n* Decide whether it's feasible to replace the specific style of indentation mentioned above, and do it if so\n* Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)",
    "created_at": "2013-02-08T14:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105429",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
> It is bold and cursive because I clicked the bold and cursive buttons in the editor that comes with the notebook. Since bold and cursive is supported by rst, my uneducated guess is that a converter should be able to deal with it.


Yes, that does make sense.  I guess the question is whether "premature optimization is the root of all evil" or not.  In this case, I think that having an sws2rst converter in Sage that at least converts *some* stuff, but can't handle styles, is worse than having no sws2rst converter at all.  I have found this to be extremely useful in its current state, so I'm not sure it's worth postponing it indefinitely for this reason (as opposed to checking the code itself, which I have lamentably not had time to finish off, but which I should do today).

I think that the problem is that 

```
<p style="padding-left: 30px;">
```
is how you achieved your indentation.  That's an HTML style, not whitespace.   

Okay, on further investigation, what you must have done is clicked the "indent" button.  Usually I only use this with lists, which creates more levels of lists (and which sws2rst already handles correctly).

Pablo, do you think that finding this particular thing?  That is, if we have

```
style="padding-left: 60px;"
```
where 60 could be any positive integer multiple of 30, as a specific thing in the tag `<p ...>`, could that specific thing be searched for and then replaced with an equivalent amount of whitespace (maybe four `&nbsp;` for instance, per 30px)?  Certainly it would be nightmarish to try to make that into an appropriate amount of lists, and in any case we don't want the list bullets in that case.

---
A question for Simon - did the Sage root and scripts patches apply fine on a recent beta of 5.7?  I assume so, just checking with respect to rebasing.

---

Okay, for positive review we need the following, in my opinion.  The previous work issues were dealt with long ago.
* Still to check that regex, though apparently it's working fine
* Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)
* Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that
* Decide whether it's feasible to replace the specific style of indentation mentioned above, and do it if so
* Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)



---

archive/issue_comments_105430.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri\" to \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King\".",
    "created_at": "2013-02-08T14:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105430",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri" to "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King".



---

archive/issue_events_083888.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-02-08T14:48:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83888"
}
```



---

archive/issue_events_083889.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-02-08T14:48:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83889"
}
```



---

archive/issue_comments_105431.json:
```json
{
    "body": "**Changing work_issues** from \"answer questions, math formatting, lists, maybe absolute paths?\" to \"\".",
    "created_at": "2013-02-08T14:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105431",
    "user": "https://github.com/kcrisman"
}
```

**Changing work_issues** from "answer questions, math formatting, lists, maybe absolute paths?" to "".



---

archive/issue_comments_105432.json:
```json
{
    "body": "<a id='comment:124'></a>\nReplying to [kcrisman](#comment%3A123):\n> I guess the question is whether \"premature optimization is the root of all evil\" or not.  In this case, I think that having an sws2rst converter in Sage that at least converts *some* stuff, but can't handle styles, is worse than having no sws2rst converter at all.\n\n\nI guess you mean \"is better than\"...\n\nAnyway. I found the converter very useful, and so I will soon be able to provide a new thematic tutorial, by conversion of a worksheet that I occasionally used in talks on coercion. So, from me it is \"+1\" to make it available.\n\nHowever, I am no sphinx/rst expert nor an expert notebook user. So, I don't feel qualified to be a reviewer for this.\n\n> ---\n> A question for Simon - did the Sage root and scripts patches apply fine on a recent beta of 5.7?  I assume so, just checking with respect to rebasing.\n> \n> ---\n\n\nEverything applied find to sage-5.7.beta2 (at least after creating a hg repository in devel/sagenb...).",
    "created_at": "2013-02-08T18:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105432",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:124'></a>
Replying to [kcrisman](#comment%3A123):
> I guess the question is whether "premature optimization is the root of all evil" or not.  In this case, I think that having an sws2rst converter in Sage that at least converts *some* stuff, but can't handle styles, is worse than having no sws2rst converter at all.


I guess you mean "is better than"...

Anyway. I found the converter very useful, and so I will soon be able to provide a new thematic tutorial, by conversion of a worksheet that I occasionally used in talks on coercion. So, from me it is "+1" to make it available.

However, I am no sphinx/rst expert nor an expert notebook user. So, I don't feel qualified to be a reviewer for this.

> ---
> A question for Simon - did the Sage root and scripts patches apply fine on a recent beta of 5.7?  I assume so, just checking with respect to rebasing.
> 
> ---


Everything applied find to sage-5.7.beta2 (at least after creating a hg repository in devel/sagenb...).



---

archive/issue_comments_105433.json:
```json
{
    "body": "<a id='comment:125'></a>\n> Okay, for positive review we need the following, in my opinion.  The previous work issues were dealt with long ago.\n> * Still to check that regex, though apparently it's working fine\n> * Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)\n\nSee [here](http://sphinx-doc.org/rest.html#sections) for some conventions, but anyway it should be easy to add something for these, just two places to do it.\n>  * Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that\n>  * Decide whether it's feasible to replace the specific style of indentation mentioned above, and do it if so\n>  * Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)\n\n\n---\n\n> Anyway. I found the converter very useful, and so I will soon be able to provide a new thematic tutorial, by conversion of a worksheet that I occasionally used in talks on coercion. So, from me it is \"+1\" to make it available.\n  \nGreat!\n> However, I am no sphinx/rst expert nor an expert notebook user. So, I don't feel qualified to be a reviewer for this.\n\nNo problem.\n> Everything applied find to sage-5.7.beta2 (at least after creating a hg repository in devel/sagenb...).\n\nGood news.",
    "created_at": "2013-02-08T19:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105433",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:125'></a>
> Okay, for positive review we need the following, in my opinion.  The previous work issues were dealt with long ago.
> * Still to check that regex, though apparently it's working fine
> * Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)

See [here](http://sphinx-doc.org/rest.html#sections) for some conventions, but anyway it should be easy to add something for these, just two places to do it.
>  * Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that
>  * Decide whether it's feasible to replace the specific style of indentation mentioned above, and do it if so
>  * Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)


---

> Anyway. I found the converter very useful, and so I will soon be able to provide a new thematic tutorial, by conversion of a worksheet that I occasionally used in talks on coercion. So, from me it is "+1" to make it available.
  
Great!
> However, I am no sphinx/rst expert nor an expert notebook user. So, I don't feel qualified to be a reviewer for this.

No problem.
> Everything applied find to sage-5.7.beta2 (at least after creating a hg repository in devel/sagenb...).

Good news.



---

archive/issue_comments_105434.json:
```json
{
    "body": "<a id='comment:126'></a>\n> Now that I have successfully transformed my worksheet into rst with these warnings:\n> what remains to do to turn the .rst file into html?\n\nSee the doc you get from running `sage --sws2rst`, like\n\n```\nsage --sws2rst -h \nsage --sws2rst --sphinxify\n```\nSorry I forgot about that earlier; it's been a while!",
    "created_at": "2013-02-08T19:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105434",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:126'></a>
> Now that I have successfully transformed my worksheet into rst with these warnings:
> what remains to do to turn the .rst file into html?

See the doc you get from running `sage --sws2rst`, like

```
sage --sws2rst -h 
sage --sws2rst --sphinxify
```
Sorry I forgot about that earlier; it's been a while!



---

archive/issue_comments_105435.json:
```json
{
    "body": "**Work_Issues:** address tag, h5 and h6 tags",
    "created_at": "2013-04-10T12:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105435",
    "user": "https://github.com/kcrisman"
}
```

**Work_Issues:** address tag, h5 and h6 tags



---

archive/issue_comments_105436.json:
```json
{
    "body": "<a id='comment:127'></a>\n> > Okay, for positive review we need the following, in my opinion.  The previous work issues were dealt with long ago.\n> > * Still to check that regex, though apparently it's working fine\n\nStill need to do.\n> >  * Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)\n \n> See [here](http://sphinx-doc.org/rest.html#sections) for some conventions, but anyway it should be easy to add something for these, just two places to do it.\nThis will be easy, I believe.\n> >  * Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that\n \nLet's just turn it into pre for now.\n> >  * Decide whether it's feasible to replace the specific style of indentation mentioned above, and do it if so\n \nI think we need to save that for another ticket; although it's unfortunate that TinyMCE does this, I have a feeling this will never get in at all if we wait for one of us to have time to do it (there will be some tricky parsing to do).\n> >  * Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)\n \nShouldn't be a problem, probably one of the sagenb folks can help with this as well.",
    "created_at": "2013-04-10T12:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105436",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:127'></a>
> > Okay, for positive review we need the following, in my opinion.  The previous work issues were dealt with long ago.
> > * Still to check that regex, though apparently it's working fine

Still need to do.
> >  * Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)
 
> See [here](http://sphinx-doc.org/rest.html#sections) for some conventions, but anyway it should be easy to add something for these, just two places to do it.
This will be easy, I believe.
> >  * Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that
 
Let's just turn it into pre for now.
> >  * Decide whether it's feasible to replace the specific style of indentation mentioned above, and do it if so
 
I think we need to save that for another ticket; although it's unfortunate that TinyMCE does this, I have a feeling this will never get in at all if we wait for one of us to have time to do it (there will be some tricky parsing to do).
> >  * Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)
 
Shouldn't be a problem, probably one of the sagenb folks can help with this as well.



---

archive/issue_comments_105437.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,8 +33,7 @@\n \n ## Install instructions\n \n-* Be sure you have a recent beta, and/or that #11080 and #11459 are included.\n-* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n+* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  (To release manager: this would need to be moved to the optional spkg directory.)\n * Apply [attachment:trac_10637-root.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n@@ -43,4 +42,3 @@\n ```\n     sage -python setup.py install && sage -python setup.py develop\n ```\n-\n``````\n",
    "created_at": "2013-04-12T01:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105437",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,8 +33,7 @@
 
 ## Install instructions
 
-* Be sure you have a recent beta, and/or that #11080 and #11459 are included.
-* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
+* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  (To release manager: this would need to be moved to the optional spkg directory.)
 * Apply [attachment:trac_10637-root.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
@@ -43,4 +42,3 @@
 ```
     sage -python setup.py install && sage -python setup.py develop
 ```
-
``````




---

archive/issue_comments_105438.json:
```json
{
    "body": "**Changing work_issues** from \"address tag, h5 and h6 tags\" to \"\".",
    "created_at": "2013-04-12T03:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105438",
    "user": "https://github.com/kcrisman"
}
```

**Changing work_issues** from "address tag, h5 and h6 tags" to "".



---

archive/issue_events_083890.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-12T03:21:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83890"
}
```



---

archive/issue_events_083891.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-12T03:21:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83891"
}
```



---

archive/issue_comments_105439.json:
```json
{
    "body": "<a id='comment:129'></a>\n> > >  * Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)\n \n> > See [here](http://sphinx-doc.org/rest.html#sections) for some conventions, but anyway it should be easy to add something for these, just two places to do it.\n> This will be easy, I believe.\nYes.  The reason it didn't work for Simon is that Pablo added it to the list of headers, but not the list of tags!  I'll be updating the pull shortly and posting a patch here for reference.\n> > >  * Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that\n \nAlso done.  It turned out that making it into em is the best way to emulate what is there.\n\nI *did* discover a different issue - it turns out that we probably aren't dealing with line breaks correctly inside of things like strong and em.  In HTML you can have multiple lines inside of such a tag, but just adding a newline doesn't work for this, as ReST treats\n\n```\n*Your name\nYour email*\n```\nas one line of text, which is the usual behavior, but\n\n```\n*Your name\n\nYour email*\n```\nis no longer emphasized.  I don't think there is a super-easy way to fix this, and as pointed out above one will always have to do some tweaking of the output.  Making it em for now seems like a good option, and I've fixed the `br` tag to have two newlines.  I didn't fix it in the pre and math cases because those are working ok as they have a different role with the indentation and all.\n\n> > >  * Still to check that regex, though apparently it's working fine\n \nOkay, I did my best to mess with it, but I think that the only things it won't do correctly wouldn't look very good in a Sage worksheet anyway, so they would be user errors (like `\\$$x$$` and the like).\n\n\n> > >  * Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)\n \n> Shouldn't be a problem, probably one of the sagenb folks can help with this as well.\nI just updated my pull request with Pablo's second patch as well as my own extra patch, so we are there!\n\n---\n\nI think that the **only** thing that has to be done is, at most, for Pablo to confirm that my change to the br tag is okay.  It's too late for me to check this with actual worksheets today.",
    "created_at": "2013-04-12T03:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105439",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:129'></a>
> > >  * Add levels `<h5>` and `<h6>` (see [here](http://www.w3.org/TR/html401/struct/global.html#h-7.5.5), h6 is also actually supported by TinyMCE in Sage)
 
> > See [here](http://sphinx-doc.org/rest.html#sections) for some conventions, but anyway it should be easy to add something for these, just two places to do it.
> This will be easy, I believe.
Yes.  The reason it didn't work for Simon is that Pablo added it to the list of headers, but not the list of tags!  I'll be updating the pull shortly and posting a patch here for reference.
> > >  * Decide what to do with address tag (possibly turn it into pre tag? just an idea) and do that
 
Also done.  It turned out that making it into em is the best way to emulate what is there.

I *did* discover a different issue - it turns out that we probably aren't dealing with line breaks correctly inside of things like strong and em.  In HTML you can have multiple lines inside of such a tag, but just adding a newline doesn't work for this, as ReST treats

```
*Your name
Your email*
```
as one line of text, which is the usual behavior, but

```
*Your name

Your email*
```
is no longer emphasized.  I don't think there is a super-easy way to fix this, and as pointed out above one will always have to do some tweaking of the output.  Making it em for now seems like a good option, and I've fixed the `br` tag to have two newlines.  I didn't fix it in the pre and math cases because those are working ok as they have a different role with the indentation and all.

> > >  * Still to check that regex, though apparently it's working fine
 
Okay, I did my best to mess with it, but I think that the only things it won't do correctly wouldn't look very good in a Sage worksheet anyway, so they would be user errors (like `\$$x$$` and the like).


> > >  * Make an updated pull request for sagenb (luckily not a problem with respect to rebasing, since we only add new files)
 
> Shouldn't be a problem, probably one of the sagenb folks can help with this as well.
I just updated my pull request with Pablo's second patch as well as my own extra patch, so we are there!

---

I think that the **only** thing that has to be done is, at most, for Pablo to confirm that my change to the br tag is okay.  It's too late for me to check this with actual worksheets today.



---

archive/issue_comments_105440.json:
```json
{
    "body": "<a id='comment:0'></a>\nOops, need to update the Sage patches, I think.",
    "created_at": "2013-04-12T03:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105440",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:0'></a>
Oops, need to update the Sage patches, I think.



---

archive/issue_comments_105441.json:
```json
{
    "body": "Apply to root repository",
    "created_at": "2013-04-12T03:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105441",
    "user": "https://github.com/kcrisman"
}
```

Apply to root repository



---

archive/attachments_013938.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10637-second-review.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/trac_10637-second-review.patch",
    "created_at": "2013-04-12T03:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_105442.json:
```json
{
    "body": "",
    "created_at": "2013-04-12T03:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105442",
    "user": "https://github.com/kcrisman"
}
```





---

archive/issue_comments_105443.json:
```json
{
    "body": "**Changing dependencies** from \"#11080, #11459\" to \"\".",
    "created_at": "2013-04-12T03:34:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105443",
    "user": "https://github.com/kcrisman"
}
```

**Changing dependencies** from "#11080, #11459" to "".



---

archive/issue_comments_105444.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -37,7 +37,7 @@\n * Apply [attachment:trac_10637-root.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n-* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to sagenb, possibly followed by\n+* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], [attachment:trac_10637_answer_to_kcrisman.patch], and [attachment:trac_10637-second-review.patch] to sagenb, possibly followed by\n \n ```\n     sage -python setup.py install && sage -python setup.py develop\n``````\n",
    "created_at": "2013-04-12T03:34:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105444",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -37,7 +37,7 @@
 * Apply [attachment:trac_10637-root.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
-* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], and [attachment:trac_10637_answer_to_kcrisman.patch] to sagenb, possibly followed by
+* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], [attachment:trac_10637_answer_to_kcrisman.patch], and [attachment:trac_10637-second-review.patch] to sagenb, possibly followed by
 
 ```
     sage -python setup.py install && sage -python setup.py develop
``````




---

archive/issue_comments_105445.json:
```json
{
    "body": "<a id='comment:1'></a>\nOkay, for full review I suppose it would be nice for\n* Pablo to confirm that br tag is okay now *or* for someone (could be me) to try some worksheets with that to test\n* Jeroen or someone else who knows their way around spkg/bin/sage to make sure the update to the root patch is ok even though the exit etc. is gone (but it seems to be gone from the others as well)\n\nKeshav, the pull requests are updated, so please don't release the next sagenb until this is done.",
    "created_at": "2013-04-12T03:34:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105445",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'></a>
Okay, for full review I suppose it would be nice for
* Pablo to confirm that br tag is okay now *or* for someone (could be me) to try some worksheets with that to test
* Jeroen or someone else who knows their way around spkg/bin/sage to make sure the update to the root patch is ok even though the exit etc. is gone (but it seems to be gone from the others as well)

Keshav, the pull requests are updated, so please don't release the next sagenb until this is done.



---

archive/issue_comments_105446.json:
```json
{
    "body": "<a id='comment:2'></a>\nKarl, I confirm the br tag is ok, and better, with your fix, and I say \"thanks a lot\". I've been busy switching job, forgot this one!",
    "created_at": "2013-04-12T08:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105446",
    "user": "https://trac.sagemath.org/admin/accounts/users/pang"
}
```

<a id='comment:2'></a>
Karl, I confirm the br tag is ok, and better, with your fix, and I say "thanks a lot". I've been busy switching job, forgot this one!



---

archive/issue_comments_105447.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King\" to \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo\".",
    "created_at": "2013-04-12T12:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105447",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King" to "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo".



---

archive/issue_comments_105448.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,7 +33,7 @@\n \n ## Install instructions\n \n-* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  (To release manager: this would need to be moved to the optional spkg directory.)\n+* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  \n * Apply [attachment:trac_10637-root.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n@@ -42,3 +42,9 @@\n ```\n     sage -python setup.py install && sage -python setup.py develop\n ```\n+\n+## Release Manager Instructions\n+* Add beautiful soup to the optional spkg directory\n+* Apply [attachment:trac_10637-root.patch] to the root repository\n+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n+* Merge with [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (no ticket as yet)\n``````\n",
    "created_at": "2013-04-12T12:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105448",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,7 +33,7 @@
 
 ## Install instructions
 
-* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  (To release manager: this would need to be moved to the optional spkg directory.)
+* Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  
 * Apply [attachment:trac_10637-root.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
@@ -42,3 +42,9 @@
 ```
     sage -python setup.py install && sage -python setup.py develop
 ```
+
+## Release Manager Instructions
+* Add beautiful soup to the optional spkg directory
+* Apply [attachment:trac_10637-root.patch] to the root repository
+* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
+* Merge with [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (no ticket as yet)
``````




---

archive/issue_comments_105449.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks so much!\n\nJeroen, I'm setting this to positive review, but please ask for a fix on the root repo patch if that is not the new way these scripts are called.",
    "created_at": "2013-04-12T12:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105449",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
Thanks so much!

Jeroen, I'm setting this to positive review, but please ask for a fix on the root repo patch if that is not the new way these scripts are called.



---

archive/issue_events_083892.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-12T12:50:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83892"
}
```



---

archive/issue_events_083893.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-12T12:50:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83893"
}
```



---

archive/issue_comments_105450.json:
```json
{
    "body": "<a id='comment:4'></a>\nCongratulations guys for finishing this! I am looking forward to it!",
    "created_at": "2013-04-12T13:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105450",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:4'></a>
Congratulations guys for finishing this! I am looking forward to it!



---

archive/issue_comments_105451.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo\" to \"Nicolas M. Thi\u00e9ry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo\".",
    "created_at": "2013-04-12T13:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105451",
    "user": "https://github.com/nthiery"
}
```

**Changing reviewer** from "Nicolas Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo" to "Nicolas M. Thiéry, Jason Grout, Karl-Dieter Crisman, Jason Bandlow, John Palmieri, Simon King, Karl-Dieter Crisman, Pablo Angulo".



---

archive/issue_events_083894.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-12T13:54:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83894"
}
```



---

archive/issue_events_083895.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-12T13:54:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83895"
}
```



---

archive/issue_comments_105452.json:
```json
{
    "body": "**Dependencies:** sagenb-0.10.6",
    "created_at": "2013-04-12T13:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105452",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** sagenb-0.10.6



---

archive/issue_events_083896.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-12T13:55:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83896"
}
```



---

archive/issue_events_083897.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-12T13:55:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83897"
}
```



---

archive/issue_comments_105453.json:
```json
{
    "body": "**Changing dependencies** from \"sagenb-0.10.6\" to \"#14330\".",
    "created_at": "2013-04-13T13:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105453",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "sagenb-0.10.6" to "#14330".



---

archive/issue_comments_105454.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,18 +33,13 @@\n \n ## Install instructions\n \n+* Install sagenb 0.10.6 (#14330)\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  \n * Apply [attachment:trac_10637-root.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n-\n-* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], [attachment:trac_10637_answer_to_kcrisman.patch], and [attachment:trac_10637-second-review.patch] to sagenb, possibly followed by\n-\n-```\n-    sage -python setup.py install && sage -python setup.py develop\n-```\n \n ## Release Manager Instructions\n * Add beautiful soup to the optional spkg directory\n * Apply [attachment:trac_10637-root.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n-* Merge with [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (no ticket as yet)\n+* Merge at the same time as [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (#14330)\n``````\n",
    "created_at": "2013-04-30T06:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105454",
    "user": "https://github.com/kini"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,18 +33,13 @@
 
 ## Install instructions
 
+* Install sagenb 0.10.6 (#14330)
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  
 * Apply [attachment:trac_10637-root.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
-
-* Apply [attachment:tools_sws2rst_4.patch], [attachment:trac_10637-sagenb-reviewer.patch], [attachment:trac_10637_answer_to_kcrisman.patch], and [attachment:trac_10637-second-review.patch] to sagenb, possibly followed by
-
-```
-    sage -python setup.py install && sage -python setup.py develop
-```
 
 ## Release Manager Instructions
 * Add beautiful soup to the optional spkg directory
 * Apply [attachment:trac_10637-root.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
-* Merge with [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (no ticket as yet)
+* Merge at the same time as [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (#14330)
``````




---

archive/issue_comments_105455.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -42,4 +42,3 @@\n * Add beautiful soup to the optional spkg directory\n * Apply [attachment:trac_10637-root.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n-* Merge at the same time as [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (#14330)\n``````\n",
    "created_at": "2013-04-30T09:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105455",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -42,4 +42,3 @@
 * Add beautiful soup to the optional spkg directory
 * Apply [attachment:trac_10637-root.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
-* Merge at the same time as [sagenb 0.10.6](https://groups.google.com/forum/?fromgroups=#!topic/sage-notebook/oHcBEL7_vLA) (#14330)
``````




---

archive/issue_events_083898.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-30T15:07:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83898"
}
```



---

archive/issue_events_083899.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-30T15:07:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83899"
}
```



---

archive/issue_comments_105456.json:
```json
{
    "body": "<a id='comment:0'></a>\n\n```\nsage -t devel/sagenb-main/sagenb/misc/comments2rst.py\n**********************************************************************\nFile \"devel/sagenb-main/sagenb/misc/comments2rst.py\", line 47, in sagenb.misc.comments2rst.preprocess_display_latex\nFailed example:\n    from sagenb.misc.comments2rst import preprocess_display_latex\nException raised:\n    Traceback (most recent call last):\n      File \"/mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 454, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 813, in execute\n        exec compiled in globs\n      File \"<doctest sagenb.misc.comments2rst.preprocess_display_latex[0]>\", line 1, in <module>\n        from sagenb.misc.comments2rst import preprocess_display_latex\n      File \"/mazur/release/merger/sage-5.10.beta2/devel/sagenb/sagenb/misc/comments2rst.py\", line 34, in <module>\n        \"\"\"\n    ImportError: BeautifulSoup must be installed.\n\n    Please either install using Sage spkg installation\n\n        sage -i beautifulsoup\n\n    or by using one of\n\n        pip install BeautifulSoup\n        easy_install BeautifulSoup\n\n    in the Sage shell (sage --sh).\n\n**********************************************************************\n```",
    "created_at": "2013-04-30T15:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105456",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:0'></a>

```
sage -t devel/sagenb-main/sagenb/misc/comments2rst.py
**********************************************************************
File "devel/sagenb-main/sagenb/misc/comments2rst.py", line 47, in sagenb.misc.comments2rst.preprocess_display_latex
Failed example:
    from sagenb.misc.comments2rst import preprocess_display_latex
Exception raised:
    Traceback (most recent call last):
      File "/mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 454, in _run
        self.execute(example, compiled, test.globs)
      File "/mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 813, in execute
        exec compiled in globs
      File "<doctest sagenb.misc.comments2rst.preprocess_display_latex[0]>", line 1, in <module>
        from sagenb.misc.comments2rst import preprocess_display_latex
      File "/mazur/release/merger/sage-5.10.beta2/devel/sagenb/sagenb/misc/comments2rst.py", line 34, in <module>
        """
    ImportError: BeautifulSoup must be installed.

    Please either install using Sage spkg installation

        sage -i beautifulsoup

    or by using one of

        pip install BeautifulSoup
        easy_install BeautifulSoup

    in the Sage shell (sage --sh).

**********************************************************************
```



---

archive/issue_comments_105457.json:
```json
{
    "body": "<a id='comment:141'></a>\nReplying to [jdemeyer](#comment%3A140):\nhow about\n\n```\nsage -i beautifulsoup\n```\nfirst?\n\nWell, with this I have a different failure (on OSX 10.6.8), rc0 (do I need rc1???)\n\n```\n$ sage -t devel/sagenb-main/sagenb/misc/comments2rst.py\nRunning doctests with ID 2013-04-30-23-31-02-a3c02abb.\nDoctesting 1 file.\nsage -t devel/sagenb-main/sagenb/misc/comments2rst.py\n**********************************************************************\nFile \"devel/sagenb-main/sagenb/misc/comments2rst.py\", line 373, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text\nFailed example:\n    html2rst('<p>Some text with <em>math</em>: $e^{\\pi i}=-1$</p>', '')\nExpected:\n    u'Some text with  *math* : :math:`e^{\\\\pi i}=-1`\\n'\nGot:\n    u'Some text with  *math* :  :math:`e^{\\\\pi i}=-1`\\n\\n'\n**********************************************************************\nFile \"devel/sagenb-main/sagenb/misc/comments2rst.py\", line 375, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text\nFailed example:\n    html2rst('<p>Text with <em>incorrect</p> nesting</em>.', '')       \nExpected:\n    u'Text with  *incorrect*\\n\\n nesting\\n.'\nGot:\n    u'Text with  *incorrect* \\n\\n nesting\\n.'\n**********************************************************************\nFile \"devel/sagenb-main/sagenb/misc/comments2rst.py\", line 377, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text\nFailed example:\n    html2rst('<pre>Preformatted: \\n    a+2\\n</pre><p> Not preformatted: \\n    a+2\\n</p>', '')\nExpected:\n    u'::\\n\\n    Preformatted: \\n        a+2\\n    \\nNot preformatted:     a\\\\+2\\n'\nGot:\n    u'::\\n\\n    Preformatted: \\n        a+2\\n    \\n Not preformatted:     a\\\\+2\\n\\n'\n**********************************************************************\nFile \"devel/sagenb-main/sagenb/misc/comments2rst.py\", line 381, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text\nFailed example:\n    html2rst('<p>some text</p><p>$$</p><p>3.183098861 \\cdot 10^{-1}</p><p>$$</p>','')\nExpected:\n    u'some text\\n\\n.. MATH::\\n\\n    3.183098861 \\\\cdot 10^{-1}\\n'\nGot:\n    u'some text\\n\\n.. MATH::\\n\\n    3.183098861 \\\\cdot 10^{-1}\\n\\n.. end of math\\n\\n'\n**********************************************************************\n1 item had failures:\n   4 of   7 in sagenb.misc.comments2rst.Soup2Rst.get_plain_text\n    [23 tests, 4 failures, 0.09 s]\n----------------------------------------------------------------------\nsage -t devel/sagenb-main/sagenb/misc/comments2rst.py  # 4 doctests failed\n```",
    "created_at": "2013-04-30T15:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105457",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:141'></a>
Replying to [jdemeyer](#comment%3A140):
how about

```
sage -i beautifulsoup
```
first?

Well, with this I have a different failure (on OSX 10.6.8), rc0 (do I need rc1???)

```
$ sage -t devel/sagenb-main/sagenb/misc/comments2rst.py
Running doctests with ID 2013-04-30-23-31-02-a3c02abb.
Doctesting 1 file.
sage -t devel/sagenb-main/sagenb/misc/comments2rst.py
**********************************************************************
File "devel/sagenb-main/sagenb/misc/comments2rst.py", line 373, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text
Failed example:
    html2rst('<p>Some text with <em>math</em>: $e^{\pi i}=-1$</p>', '')
Expected:
    u'Some text with  *math* : :math:`e^{\\pi i}=-1`\n'
Got:
    u'Some text with  *math* :  :math:`e^{\\pi i}=-1`\n\n'
**********************************************************************
File "devel/sagenb-main/sagenb/misc/comments2rst.py", line 375, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text
Failed example:
    html2rst('<p>Text with <em>incorrect</p> nesting</em>.', '')       
Expected:
    u'Text with  *incorrect*\n\n nesting\n.'
Got:
    u'Text with  *incorrect* \n\n nesting\n.'
**********************************************************************
File "devel/sagenb-main/sagenb/misc/comments2rst.py", line 377, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text
Failed example:
    html2rst('<pre>Preformatted: \n    a+2\n</pre><p> Not preformatted: \n    a+2\n</p>', '')
Expected:
    u'::\n\n    Preformatted: \n        a+2\n    \nNot preformatted:     a\\+2\n'
Got:
    u'::\n\n    Preformatted: \n        a+2\n    \n Not preformatted:     a\\+2\n\n'
**********************************************************************
File "devel/sagenb-main/sagenb/misc/comments2rst.py", line 381, in sagenb.misc.comments2rst.Soup2Rst.get_plain_text
Failed example:
    html2rst('<p>some text</p><p>$$</p><p>3.183098861 \cdot 10^{-1}</p><p>$$</p>','')
Expected:
    u'some text\n\n.. MATH::\n\n    3.183098861 \\cdot 10^{-1}\n'
Got:
    u'some text\n\n.. MATH::\n\n    3.183098861 \\cdot 10^{-1}\n\n.. end of math\n\n'
**********************************************************************
1 item had failures:
   4 of   7 in sagenb.misc.comments2rst.Soup2Rst.get_plain_text
    [23 tests, 4 failures, 0.09 s]
----------------------------------------------------------------------
sage -t devel/sagenb-main/sagenb/misc/comments2rst.py  # 4 doctests failed
```



---

archive/issue_comments_105458.json:
```json
{
    "body": "<a id='comment:2'></a>\nDoctests should pass without optional packages. Add\n\n```\n# optional - beautifulsoup\n```\nwhere needed.",
    "created_at": "2013-04-30T15:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105458",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Doctests should pass without optional packages. Add

```
# optional - beautifulsoup
```
where needed.



---

archive/issue_comments_105459.json:
```json
{
    "body": "<a id='comment:143'></a>\nReplying to [jdemeyer](#comment%3A142):\n> Doctests should pass without optional packages. Add\n> \n> ```\n> # optional - beautifulsoup\n> ```\n> where needed.\n\n\nshouldn't we consider making it standard? it's 32.5K and the MIT license...",
    "created_at": "2013-04-30T16:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105459",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:143'></a>
Replying to [jdemeyer](#comment%3A142):
> Doctests should pass without optional packages. Add
> 
> ```
> # optional - beautifulsoup
> ```
> where needed.


shouldn't we consider making it standard? it's 32.5K and the MIT license...



---

archive/issue_comments_105460.json:
```json
{
    "body": "<a id='comment:4'></a>\nHuh, I didn't consider running tests since this is upstream and why would we be running upstream tests?  ;-)\n\nI won't have time to fix this immediately.  But maybe I can try to do a pull request \"manually\" on github.   As you can see, all the text failures are due to an additional space and extra newlines which I didn't think to check, so easy to fix.\n\nI don't know whether we should really put the optional EVERYwhere.   I guess we can.\n\nI don't see the need to make beautifulsoup standard, though; it's only needed for this one thing, and the import error is pretty informative.",
    "created_at": "2013-04-30T16:54:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105460",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Huh, I didn't consider running tests since this is upstream and why would we be running upstream tests?  ;-)

I won't have time to fix this immediately.  But maybe I can try to do a pull request "manually" on github.   As you can see, all the text failures are due to an additional space and extra newlines which I didn't think to check, so easy to fix.

I don't know whether we should really put the optional EVERYwhere.   I guess we can.

I don't see the need to make beautifulsoup standard, though; it's only needed for this one thing, and the import error is pretty informative.



---

archive/issue_comments_105461.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've opened [Github issue 159](https://github.com/sagemath/sagenb/issues/159) for this.",
    "created_at": "2013-04-30T17:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105461",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
I've opened [Github issue 159](https://github.com/sagemath/sagenb/issues/159) for this.



---

archive/issue_comments_105462.json:
```json
{
    "body": "<a id='comment:146'></a>\n> I've opened [Github issue 159](https://github.com/sagemath/sagenb/issues/159) for this.\n\nAnd [pull request 160](https://github.com/sagemath/sagenb/pull/160) should (?) fix it.  I think this is easier than making things standard.",
    "created_at": "2013-04-30T17:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105462",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:146'></a>
> I've opened [Github issue 159](https://github.com/sagemath/sagenb/issues/159) for this.

And [pull request 160](https://github.com/sagemath/sagenb/pull/160) should (?) fix it.  I think this is easier than making things standard.



---

archive/issue_events_083900.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-30T17:36:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83900"
}
```



---

archive/issue_events_083901.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-30T17:36:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83901"
}
```



---

archive/issue_comments_105463.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe sws2rst problems should be gone now, as that pull request has been merged upstream.  However, #14330 is not currently ready, so I'm leaving this as sage-pending.",
    "created_at": "2013-05-07T16:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105463",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
The sws2rst problems should be gone now, as that pull request has been merged upstream.  However, #14330 is not currently ready, so I'm leaving this as sage-pending.



---

archive/issue_events_083902.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-05-07T16:41:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83902"
}
```



---

archive/issue_events_083903.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-05-07T16:41:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83903"
}
```



---

archive/issue_comments_105464.json:
```json
{
    "body": "<a id='comment:9'></a>\nAnd while we're waiting for #14330...\n\nAnyone involved on this ticket ever seen [this extension](https://github.com/kriskda/sws_rst_converter)?",
    "created_at": "2013-06-06T16:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105464",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
And while we're waiting for #14330...

Anyone involved on this ticket ever seen [this extension](https://github.com/kriskda/sws_rst_converter)?



---

archive/attachments_013939.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "exp1.sws",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/exp1.sws",
    "created_at": "2013-06-08T11:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.sws",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_105465.json:
```json
{
    "body": "example sws with an error",
    "created_at": "2013-06-08T11:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105465",
    "user": "https://github.com/dimpase"
}
```

example sws with an error



---

archive/issue_comments_105466.json:
```json
{
    "body": "<a id='comment:0'></a>\nI am getting\n\n```\n$ /usr/local/src/sage/sage-5.10.rc1/sage -sws2rst exp1.sws\nProcessing exp1.sws\nFile at exp1.rst\nImage directory at exp1_media\n  File \"exp1.sws\", line 1\nSyntaxError: Non-ASCII character '\\xa2' in file exp1.sws on line 1, but no encoding declared; see http://www.python.org/peps/pep-0263.html for details\n```\non the attached [attachment:exp1.sws]. This is with sage-5.10.rc1 on OSX 10.6.8.\nAny ideas why? Is it just me?\n\nThe error message is really weird, by the way. as sws files are not ASCII...",
    "created_at": "2013-06-08T11:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105466",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
I am getting

```
$ /usr/local/src/sage/sage-5.10.rc1/sage -sws2rst exp1.sws
Processing exp1.sws
File at exp1.rst
Image directory at exp1_media
  File "exp1.sws", line 1
SyntaxError: Non-ASCII character '\xa2' in file exp1.sws on line 1, but no encoding declared; see http://www.python.org/peps/pep-0263.html for details
```
on the attached [attachment:exp1.sws]. This is with sage-5.10.rc1 on OSX 10.6.8.
Any ideas why? Is it just me?

The error message is really weird, by the way. as sws files are not ASCII...



---

archive/issue_comments_105467.json:
```json
{
    "body": "<a id='comment:1'></a>\nI can look into this eventually.  Given that the title is\n\n```\n~/exp1\n```\nI suspect that may be the problem.  Probably it can't handle certain titles at this point, presumably we could fix this.  Weirdly, I can't find where in worksheet.html the title shows up any more.  I thought in the past that was in that file, but when I open it, it isn't there (not just this worksheet).\n\nHowever, unless all your worksheets are suddenly corrupted by this, I think it's not worth rescinding the review.",
    "created_at": "2013-06-08T12:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105467",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'></a>
I can look into this eventually.  Given that the title is

```
~/exp1
```
I suspect that may be the problem.  Probably it can't handle certain titles at this point, presumably we could fix this.  Weirdly, I can't find where in worksheet.html the title shows up any more.  I thought in the past that was in that file, but when I open it, it isn't there (not just this worksheet).

However, unless all your worksheets are suddenly corrupted by this, I think it's not worth rescinding the review.



---

archive/issue_comments_105468.json:
```json
{
    "body": "another, trivial, example of sws giving an error",
    "created_at": "2013-06-08T14:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105468",
    "user": "https://github.com/dimpase"
}
```

another, trivial, example of sws giving an error



---

archive/attachments_013940.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "blah.sws",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/blah.sws",
    "created_at": "2013-06-08T14:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.sws",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_105469.json:
```json
{
    "body": "<a id='comment:152'></a>\nReplying to [kcrisman](#comment%3A151):\n> I can look into this eventually.  Given that the title is\n> \n> ```\n> ~/exp1\n> ```\n> I suspect that may be the problem.  Probably it can't handle certain titles at this point, presumably we could fix this.  Weirdly, I can't find where in worksheet.html the title shows up any more.  I thought in the past that was in that file, but when I open it, it isn't there (not just this worksheet).\n\n\n\nDo you mean you can reproduce the error I get on this sws?\nI attach another one, completely trivial.\n\nIn a way, it's not a real error, it's just an error message; I get all the files created as they should.\n \n\n> \n> However, unless all your worksheets are suddenly corrupted by this, I think it's not worth rescinding the review.\n\n\nWell, it could be the new sagenb spkg and the new Sage release (5.10.rc1).",
    "created_at": "2013-06-08T14:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105469",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:152'></a>
Replying to [kcrisman](#comment%3A151):
> I can look into this eventually.  Given that the title is
> 
> ```
> ~/exp1
> ```
> I suspect that may be the problem.  Probably it can't handle certain titles at this point, presumably we could fix this.  Weirdly, I can't find where in worksheet.html the title shows up any more.  I thought in the past that was in that file, but when I open it, it isn't there (not just this worksheet).



Do you mean you can reproduce the error I get on this sws?
I attach another one, completely trivial.

In a way, it's not a real error, it's just an error message; I get all the files created as they should.
 

> 
> However, unless all your worksheets are suddenly corrupted by this, I think it's not worth rescinding the review.


Well, it could be the new sagenb spkg and the new Sage release (5.10.rc1).



---

archive/attachments_013941.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10637_missing_exec.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10637/trac_10637_missing_exec.patch",
    "created_at": "2013-06-08T15:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_105470.json:
```json
{
    "body": "adding missing exec in spkg/bin/sage",
    "created_at": "2013-06-08T15:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105470",
    "user": "https://github.com/dimpase"
}
```

adding missing exec in spkg/bin/sage



---

archive/issue_comments_105471.json:
```json
{
    "body": "<a id='comment:3'></a>\nI've found the source of trouble - it's missing `exec` in invocation of `sage-sws2rst` in `spkg/bin/sage`.This causes a different way to parse the argument. More precisely, without `exec` the script does not exit immediately, but proceeds to analyze other possible execution, and it proceeds to execute `sage-run` on the sws input! \n\nThe 1-line patch is attached. (And only it needs review).",
    "created_at": "2013-06-08T15:10:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105471",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
I've found the source of trouble - it's missing `exec` in invocation of `sage-sws2rst` in `spkg/bin/sage`.This causes a different way to parse the argument. More precisely, without `exec` the script does not exit immediately, but proceeds to analyze other possible execution, and it proceeds to execute `sage-run` on the sws input! 

The 1-line patch is attached. (And only it needs review).



---

archive/issue_comments_105472.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -36,9 +36,10 @@\n * Install sagenb 0.10.6 (#14330)\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  \n * Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] \n+and [attachment:trac_10637_missing_exec.patch] to the scripts repository\n \n ## Release Manager Instructions\n * Add beautiful soup to the optional spkg directory\n * Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] and [attachment:trac_10637_missing_exec.patch] to the scripts repository\n``````\n",
    "created_at": "2013-06-08T15:10:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105472",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -36,9 +36,10 @@
 * Install sagenb 0.10.6 (#14330)
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  
 * Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] 
+and [attachment:trac_10637_missing_exec.patch] to the scripts repository
 
 ## Release Manager Instructions
 * Add beautiful soup to the optional spkg directory
 * Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch] and [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] and [attachment:trac_10637_missing_exec.patch] to the scripts repository
``````




---

archive/issue_events_083904.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-06-08T15:10:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83904"
}
```



---

archive/issue_events_083905.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-06-08T15:10:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83905"
}
```



---

archive/issue_events_083906.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-06-08T15:10:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83906"
}
```



---

archive/issue_events_083907.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-06-08T15:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83907"
}
```



---

archive/issue_events_083908.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-09T02:59:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83908"
}
```



---

archive/issue_events_083909.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-09T02:59:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83909"
}
```



---

archive/issue_comments_105473.json:
```json
{
    "body": "<a id='comment:5'></a>\n> Do you mean you can reproduce the error I get on this sws? I attach another one, completely trivial.\n\nNo, I had to ditch the upstream because of the error I mention on #14430.  I was referring to something else.\n> Jeroen, I'm setting this to positive review, but please ask for a fix on the root repo patch if that is not the new way these scripts are called.\n\nI should have not been this passive about it, in retrospect.  Of course this totally makes sense looking at the other ones.  I do not, however, have time to actually try this out.  But I think this should be okay.",
    "created_at": "2013-06-09T02:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105473",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
> Do you mean you can reproduce the error I get on this sws? I attach another one, completely trivial.

No, I had to ditch the upstream because of the error I mention on #14430.  I was referring to something else.
> Jeroen, I'm setting this to positive review, but please ask for a fix on the root repo patch if that is not the new way these scripts are called.

I should have not been this passive about it, in retrospect.  Of course this totally makes sense looking at the other ones.  I do not, however, have time to actually try this out.  But I think this should be okay.



---

archive/issue_comments_105474.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -35,11 +35,10 @@\n \n * Install sagenb 0.10.6 (#14330)\n * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  \n-* Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] \n-and [attachment:trac_10637_missing_exec.patch] to the scripts repository\n+* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository\n+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n ## Release Manager Instructions\n * Add beautiful soup to the optional spkg directory\n-* Apply [attachment:trac_10637-root.patch] to the root repository\n-* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] and [attachment:trac_10637_missing_exec.patch] to the scripts repository\n+* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository\n+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n``````\n",
    "created_at": "2013-06-09T07:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105474",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -35,11 +35,10 @@
 
 * Install sagenb 0.10.6 (#14330)
 * Install the beautifulsoup spkg [here](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg).  
-* Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] 
-and [attachment:trac_10637_missing_exec.patch] to the scripts repository
+* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository
+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
 ## Release Manager Instructions
 * Add beautiful soup to the optional spkg directory
-* Apply [attachment:trac_10637-root.patch] to the root repository
-* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] and [attachment:trac_10637_missing_exec.patch] to the scripts repository
+* Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository
+* Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
``````




---

archive/issue_events_083910.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-11T15:01:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83910"
}
```



---

archive/issue_events_083911.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-11T15:01:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83911"
}
```



---

archive/issue_comments_105475.json:
```json
{
    "body": "**Merged:** sage-5.11.beta1",
    "created_at": "2013-06-11T15:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105475",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.11.beta1



---

archive/issue_comments_105476.json:
```json
{
    "body": "**Changing merged** from \"sage-5.11.beta1\" to \"\".",
    "created_at": "2013-06-13T10:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105476",
    "user": "https://github.com/jdemeyer"
}
```

**Changing merged** from "sage-5.11.beta1" to "".



---

archive/issue_comments_105477.json:
```json
{
    "body": "<a id='comment:8'></a>\nMerged by mistake since it depends on #14330.",
    "created_at": "2013-06-13T10:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105477",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Merged by mistake since it depends on #14330.



---

archive/issue_events_083912.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-13T10:25:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83912"
}
```



---

archive/issue_events_083913.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-13T10:25:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83913"
}
```



---

archive/issue_events_083914.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-13T10:25:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83914"
}
```



---

archive/issue_comments_105478.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -39,6 +39,6 @@\n * Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n \n ## Release Manager Instructions\n-* Add beautiful soup to the optional spkg directory\n+* Add beautiful soup to the optional spkg directory: [http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)\n * Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository\n * Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository\n``````\n",
    "created_at": "2013-06-14T07:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105478",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -39,6 +39,6 @@
 * Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
 
 ## Release Manager Instructions
-* Add beautiful soup to the optional spkg directory
+* Add beautiful soup to the optional spkg directory: [http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg](http://sage.math.washington.edu/home/kcrisman/beautifulsoup-3.2.1.spkg)
 * Apply [attachment:trac_10637-root.patch] and [attachment:trac_10637_missing_exec.patch] to the root repository
 * Apply [attachment:trac_10637-scripts.patch], [attachment:trac_10637-scripts-docsandmore.patch] to the scripts repository
``````




---

archive/issue_events_083915.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-14T07:09:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83915"
}
```



---

archive/issue_events_083916.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-14T07:09:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83916"
}
```



---

archive/issue_comments_105479.json:
```json
{
    "body": "<a id='comment:3'></a>\nthe optional spkg is on the server",
    "created_at": "2013-06-14T10:28:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105479",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:3'></a>
the optional spkg is on the server



---

archive/issue_events_083917.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-15T12:22:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83917"
}
```



---

archive/issue_events_083918.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-15T12:22:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83918"
}
```



---

archive/issue_comments_105480.json:
```json
{
    "body": "<a id='comment:5'></a>\nWhat is needed from  #14330 here?\nI tried this ticket with the sagenb included in Sage 5.9, and it seems to work just fine!",
    "created_at": "2013-06-15T13:21:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105480",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
What is needed from  #14330 here?
I tried this ticket with the sagenb included in Sage 5.9, and it seems to work just fine!



---

archive/issue_events_083919.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:40:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83919"
}
```



---

archive/issue_events_083920.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:40:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83920"
}
```



---

archive/issue_events_083921.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:14:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83921"
}
```



---

archive/issue_events_083922.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:14:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10637#event-83922"
}
```



---

archive/issue_comments_105481.json:
```json
{
    "body": "**Merged:** sage-5.12.beta0",
    "created_at": "2013-08-02T14:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10637#issuecomment-105481",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.12.beta0
