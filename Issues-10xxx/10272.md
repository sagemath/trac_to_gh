# Issue 10272: laurent series truncate behaviour different from power series truncate

archive/issues_010271.json:
```json
{
    "body": "There is the following difference in behaviour between truncate() for power series and laurent series:\n\n```\nsage: P.<p> = PowerSeriesRing(QQ)\nsage: L.<l> = LaurentSeriesRing(QQ)\nsage: f = p^2 + p^3 + p^5 +p^6 + O(p^7)\nsage: g = l^2 + l^3 + l^5 +l^6 + O(l^7)\nsage: f.truncate(6)\np^5 + p^3 + p^2\nsage: g.truncate(6)\nl^2 + l^3 + l^5 + O(l^6)\nsage: f.truncate_powerseries(6)\np^2 + p^3 + p^5 + O(p^6)\n```\nThe problem is simply that g.truncate() calls truncate_powerseries() on its underlying power series.\n\nThe attached patch changes LaurentSeries.truncate() such that is calls truncate() on the underlying powerseries. For the current behaviour, it also adds a method truncate_laurentseries() which calls truncate_powerseries() on the underlying powerseries.\n\nIn my opinion, the methods truncate_powerseries and truncate_laurentseries are superfluous since they are equivalent to add_bigoh().\n\nAssignee: @malb\n\nKeywords: laurent series, truncate sd40.5\n\nReviewer: Marshall Hampton, Jeroen Demeyer, Karl-Dieter Crisman\n\nAuthor: Timo Kluck\n\nMerged: sage-5.1.beta3\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10272\n\n",
    "closed_at": "2012-06-05T11:52:51Z",
    "created_at": "2010-11-15T14:28:46Z",
    "labels": [
        "component: commutative algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "laurent series truncate behaviour different from power series truncate",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10272",
    "user": "https://github.com/tkluck"
}
```
There is the following difference in behaviour between truncate() for power series and laurent series:

```
sage: P.<p> = PowerSeriesRing(QQ)
sage: L.<l> = LaurentSeriesRing(QQ)
sage: f = p^2 + p^3 + p^5 +p^6 + O(p^7)
sage: g = l^2 + l^3 + l^5 +l^6 + O(l^7)
sage: f.truncate(6)
p^5 + p^3 + p^2
sage: g.truncate(6)
l^2 + l^3 + l^5 + O(l^6)
sage: f.truncate_powerseries(6)
p^2 + p^3 + p^5 + O(p^6)
```
The problem is simply that g.truncate() calls truncate_powerseries() on its underlying power series.

The attached patch changes LaurentSeries.truncate() such that is calls truncate() on the underlying powerseries. For the current behaviour, it also adds a method truncate_laurentseries() which calls truncate_powerseries() on the underlying powerseries.

In my opinion, the methods truncate_powerseries and truncate_laurentseries are superfluous since they are equivalent to add_bigoh().

Assignee: @malb

Keywords: laurent series, truncate sd40.5

Reviewer: Marshall Hampton, Jeroen Demeyer, Karl-Dieter Crisman

Author: Timo Kluck

Merged: sage-5.1.beta3

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10272





---

archive/issue_comments_132227.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,6 @@\n There is the following difference in behaviour between truncate() for power series and laurent series:\n \n+```\n sage: P.<p> = PowerSeriesRing(QQ)\n sage: L.<l> = LaurentSeriesRing(QQ)\n sage: f = p^2 + p^3 + p^5 +p^6 + O(p^7)\n@@ -10,7 +11,7 @@\n l^2 + l^3 + l^5 + O(l^6)\n sage: f.truncate_powerseries(6)\n p^2 + p^3 + p^5 + O(p^6)\n-\n+```\n The problem is simply that g.truncate() calls truncate_powerseries() on its underlying power series.\n \n The attached patch changes LaurentSeries.truncate() such that is calls truncate() on the underlying powerseries. For the current behaviour, it also adds a method truncate_laurentseries() which calls truncate_powerseries() on the underlying powerseries.\n``````\n",
    "created_at": "2010-11-15T14:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132227",
    "user": "https://github.com/tkluck"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,6 @@
 There is the following difference in behaviour between truncate() for power series and laurent series:
 
+```
 sage: P.<p> = PowerSeriesRing(QQ)
 sage: L.<l> = LaurentSeriesRing(QQ)
 sage: f = p^2 + p^3 + p^5 +p^6 + O(p^7)
@@ -10,7 +11,7 @@
 l^2 + l^3 + l^5 + O(l^6)
 sage: f.truncate_powerseries(6)
 p^2 + p^3 + p^5 + O(p^6)
-
+```
 The problem is simply that g.truncate() calls truncate_powerseries() on its underlying power series.
 
 The attached patch changes LaurentSeries.truncate() such that is calls truncate() on the underlying powerseries. For the current behaviour, it also adds a method truncate_laurentseries() which calls truncate_powerseries() on the underlying powerseries.
``````




---

archive/issue_comments_132228.json:
```json
{
    "body": "<a id='comment:2'></a>\nIs this ready for review?  If so, you should change its status to \"needs review\".",
    "created_at": "2011-01-11T05:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132228",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:2'></a>
Is this ready for review?  If so, you should change its status to "needs review".



---

archive/issue_comments_132229.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-01-11T13:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132229",
    "user": "https://github.com/tkluck"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_132230.json:
```json
{
    "body": "<a id='comment:4'></a>\nThanks, I just did.",
    "created_at": "2011-01-11T13:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132230",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:4'></a>
Thanks, I just did.



---

archive/issue_comments_132231.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-12T00:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132231",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_132232.json:
```json
{
    "body": "<a id='comment:5'></a>\nLooks good, positive review.  Doesn't break any doctests in rings because Laurent series are so poorly tested!\nOnly bad thing is that you should include the ticket number on the patch, i.e. this one should have been named something like trac_10272_laurent_series_truncate.patch.  This helps the release manager and others in a variety of ways.",
    "created_at": "2011-01-12T00:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132232",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:5'></a>
Looks good, positive review.  Doesn't break any doctests in rings because Laurent series are so poorly tested!
Only bad thing is that you should include the ticket number on the patch, i.e. this one should have been named something like trac_10272_laurent_series_truncate.patch.  This helps the release manager and others in a variety of ways.



---

archive/issue_comments_132233.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Marshall Hampton\"",
    "created_at": "2011-01-12T00:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132233",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Changing reviewer from "" to "Marshall Hampton"



---

archive/issue_events_031782.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-17T17:16:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10272#event-31782"
}
```



---

archive/issue_comments_132234.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-01-17T17:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132234",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_132235.json:
```json
{
    "body": "<a id='comment:8'></a>\nPatches should be created using `hg export tip`, not `hg diff`.  I also remind you that a patch should have a sensible commit message (use `hg qrefresh -e` for that) and that the ticket number should appear on the first line of the commit message.",
    "created_at": "2011-01-17T17:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132235",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Patches should be created using `hg export tip`, not `hg diff`.  I also remind you that a patch should have a sensible commit message (use `hg qrefresh -e` for that) and that the ticket number should appear on the first line of the commit message.



---

archive/issue_comments_132236.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-16T16:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132236",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132237.json:
```json
{
    "body": "<a id='comment:9'></a>\nI just added the patch in the right format, i.e. the output of `hg_sage.export()` instead of a normal diff.",
    "created_at": "2011-03-16T16:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132237",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:9'></a>
I just added the patch in the right format, i.e. the output of `hg_sage.export()` instead of a normal diff.



---

archive/issue_comments_132238.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-03-16T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132238",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_132239.json:
```json
{
    "body": "<a id='comment:10'></a>\nPlease read [http://sagemath.org/doc/developer/conventions.html#documentation-strings](http://sagemath.org/doc/developer/conventions.html#documentation-strings) and fix the documentation of this new function accordingly.  In particular, you should add at least one example.",
    "created_at": "2011-03-16T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132239",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Please read [http://sagemath.org/doc/developer/conventions.html#documentation-strings](http://sagemath.org/doc/developer/conventions.html#documentation-strings) and fix the documentation of this new function accordingly.  In particular, you should add at least one example.



---

archive/issue_comments_132240.json:
```json
{
    "body": "Changing work_issues from \"\" to \"docstring\"",
    "created_at": "2011-03-16T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132240",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "" to "docstring"



---

archive/issue_comments_132241.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-17T16:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132241",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132242.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks, just added docstrings and examples.",
    "created_at": "2011-03-17T16:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132242",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:11'></a>
Thanks, just added docstrings and examples.



---

archive/issue_comments_132243.json:
```json
{
    "body": "Changing reviewer from \"Marshall Hampton\" to \"Marshall Hampton, Jeroen Demeyer\"",
    "created_at": "2011-04-05T15:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132243",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Marshall Hampton" to "Marshall Hampton, Jeroen Demeyer"



---

archive/issue_comments_132244.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-05T15:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132244",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_132245.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-04-05T16:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132245",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_132246.json:
```json
{
    "body": "Changing work_issues from \"docstring\" to \"rebase\"",
    "created_at": "2011-04-05T16:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132246",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "docstring" to "rebase"



---

archive/issue_comments_132247.json:
```json
{
    "body": "<a id='comment:13'></a>\nThis needs to be rebased:\n\n```\napplying /scratch/jdemeyer/merger/downloads/trac_10272_laurent_series_truncate.patch\npatching file sage/rings/laurent_series_ring_element.pyx\nHunk #1 FAILED at 725\n1 out of 1 hunks FAILED -- saving rejects to file sage/rings/laurent_series_ring_element.pyx.rej\nabort: patch failed to apply\n```",
    "created_at": "2011-04-05T16:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132247",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
This needs to be rebased:

```
applying /scratch/jdemeyer/merger/downloads/trac_10272_laurent_series_truncate.patch
patching file sage/rings/laurent_series_ring_element.pyx
Hunk #1 FAILED at 725
1 out of 1 hunks FAILED -- saving rejects to file sage/rings/laurent_series_ring_element.pyx.rej
abort: patch failed to apply
```



---

archive/issue_comments_132248.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-30T18:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132248",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132249.json:
```json
{
    "body": "<a id='comment:14'></a>\nAttachment [trac_10272_laurent_series_truncate.patch](tarball://root/attachments/some-uuid/ticket10272/trac_10272_laurent_series_truncate.patch) by @tkluck created at 2011-11-30 18:49:28\n\nSorry for not having done this earlier, I totally forgot. I just uploaded a new version that should apply cleanly against the current version. Please review.",
    "created_at": "2011-11-30T18:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132249",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:14'></a>
Attachment [trac_10272_laurent_series_truncate.patch](tarball://root/attachments/some-uuid/ticket10272/trac_10272_laurent_series_truncate.patch) by @tkluck created at 2011-11-30 18:49:28

Sorry for not having done this earlier, I totally forgot. I just uploaded a new version that should apply cleanly against the current version. Please review.



---

archive/issue_comments_132250.json:
```json
{
    "body": "Changing reviewer from \"Marshall Hampton, Jeroen Demeyer\" to \"Marshall Hampton, Jeroen Demeyer, Karl-Dieter Crisman\"",
    "created_at": "2012-05-26T07:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132250",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "Marshall Hampton, Jeroen Demeyer" to "Marshall Hampton, Jeroen Demeyer, Karl-Dieter Crisman"



---

archive/issue_comments_132251.json:
```json
{
    "body": "<a id='comment:15'></a>\n\n```\n\nsage -t  \"devel/sage-main/sage/rings/laurent_series_ring_element.pyx\"\n\t [2.1 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 2.1 seconds\n```\nAnd it still applies.",
    "created_at": "2012-05-26T07:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132251",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>

```

sage -t  "devel/sage-main/sage/rings/laurent_series_ring_element.pyx"
	 [2.1 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 2.1 seconds
```
And it still applies.



---

archive/issue_comments_132252.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-26T07:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132252",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_132253.json:
```json
{
    "body": "Changing keywords from \"laurent series, truncate\" to \"laurent series, truncate sd40.5\".",
    "created_at": "2012-05-26T07:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132253",
    "user": "https://github.com/kcrisman"
}
```

Changing keywords from "laurent series, truncate" to "laurent series, truncate sd40.5".



---

archive/issue_comments_132254.json:
```json
{
    "body": "Changing work_issues from \"rebase\" to \"\"",
    "created_at": "2012-05-29T01:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132254",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "rebase" to ""



---

archive/issue_events_031783.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-05T11:52:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10272#event-31783"
}
```



---

archive/issue_comments_132255.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-06-05T11:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132255",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_132256.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.1.beta3\"",
    "created_at": "2012-06-05T11:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10272#issuecomment-132256",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.1.beta3"
