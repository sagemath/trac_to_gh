# Issue 10732: computing support of sum of two divisors doesn't work due to careless error

archive/issues_010669.json:
```json
{
    "body": "```\n\nsage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)\nsage: pts = C.rational_points()\nsage: D = C.divisor([(2,pts[0])])\nsage: D.support()\n[(0 : 4 : 1)]\nsage: (D+D).support()\nTraceback (most recent call last):...\n```\n\nAssignee: @aghitza\n\nBranch/Commit: 4e4716a3d758dbec59b2a5c040e15516f33833a2\n\nReviewer: Peter Bruin\n\nAuthor: Alex Ghitza\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10732\n\n",
    "closed_at": "2014-04-25T14:20:51Z",
    "created_at": "2011-02-03T00:22:28Z",
    "labels": [
        "component: algebraic geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "computing support of sum of two divisors doesn't work due to careless error",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10732",
    "user": "https://github.com/williamstein"
}
```
```

sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)
sage: pts = C.rational_points()
sage: D = C.divisor([(2,pts[0])])
sage: D.support()
[(0 : 4 : 1)]
sage: (D+D).support()
Traceback (most recent call last):...
```

Assignee: @aghitza

Branch/Commit: 4e4716a3d758dbec59b2a5c040e15516f33833a2

Reviewer: Peter Bruin

Author: Alex Ghitza

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10732





---

archive/issue_comments_117479.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,7 @@\n \\`\\`\\`\n \n-sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)sage: pts = C.rational_points()\n+sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)\n+sage: pts = C.rational_points()\n sage: D = C.divisor([(2,pts[0])])\n sage: D.support()\n [(0 : 4 : 1)]\n```\n",
    "created_at": "2011-02-03T00:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117479",
    "user": "https://github.com/williamstein"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,7 @@
 \`\`\`
 
-sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)sage: pts = C.rational_points()
+sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)
+sage: pts = C.rational_points()
 sage: D = C.divisor([(2,pts[0])])
 sage: D.support()
 [(0 : 4 : 1)]
```




---

archive/issue_events_027645.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10732#event-27645"
}
```



---

archive/issue_events_027646.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10732#event-27646"
}
```



---

archive/issue_events_027647.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10732#event-27647"
}
```



---

archive/issue_comments_117480.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-18T22:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117480",
    "user": "https://github.com/aghitza"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_117481.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2014-04-18T22:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117481",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_117482.json:
```json
{
    "body": "<a id='comment:6'></a>It should be `This checks that :trac:` and not `This checks that trac::`",
    "created_at": "2014-04-20T08:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117482",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>It should be `This checks that :trac:` and not `This checks that trac::`



---

archive/issue_comments_117483.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-20T08:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117483",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117484.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-22T22:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117484",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117485.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-22T22:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117485",
    "user": "https://github.com/aghitza"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117486.json:
```json
{
    "body": "<a id='comment:9'></a>I haven't looked at this in detail, but you use the method `rational_points()` of the subscheme defined by the divisor.  Wouldn't `irreducible_components()` be the right thing to use, to handle the case where the support contains non-rational points?",
    "created_at": "2014-04-23T11:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117486",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:9'></a>I haven't looked at this in detail, but you use the method `rational_points()` of the subscheme defined by the divisor.  Wouldn't `irreducible_components()` be the right thing to use, to handle the case where the support contains non-rational points?



---

archive/issue_comments_117487.json:
```json
{
    "body": "<a id='comment:10'></a>I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).\n\nHow about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.",
    "created_at": "2014-04-24T06:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117487",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:10'></a>I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).

How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.



---

archive/issue_comments_117488.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 AlexGhitza]:\n> I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).\n\nWow, and there doesn't even seem to be a ticket for it!  I'm not sure if I agree with the TODO; I would say a divisor is a sum of prime divisors (closed points of the scheme), and if you want arbitrary sums of *L*-rational points you have to base change to *L*.\n> How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.\n\nThat is a good idea.  Could you also delete the trailing whitespace in the first empty line after the function?  Then you can set it to positive review.",
    "created_at": "2014-04-24T11:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117488",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:11'></a>Replying to [comment:10 AlexGhitza]:
> I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).

Wow, and there doesn't even seem to be a ticket for it!  I'm not sure if I agree with the TODO; I would say a divisor is a sum of prime divisors (closed points of the scheme), and if you want arbitrary sums of *L*-rational points you have to base change to *L*.
> How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.

That is a good idea.  Could you also delete the trailing whitespace in the first empty line after the function?  Then you can set it to positive review.



---

archive/issue_comments_117489.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:11 pbruin]:\n> there doesn't even seem to be a ticket for it\n\nThis is now #16225.",
    "created_at": "2014-04-24T11:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117489",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:12'></a>Replying to [comment:11 pbruin]:
> there doesn't even seem to be a ticket for it

This is now #16225.



---

archive/issue_comments_117490.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-24T13:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117490",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117491.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-24T13:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117491",
    "user": "https://github.com/aghitza"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_027648.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-25T14:20:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10732#event-27648"
}
```



---

archive/issue_comments_117492.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-25T14:20:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10732#issuecomment-117492",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
