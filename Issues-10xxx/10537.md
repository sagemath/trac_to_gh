# Issue 10537: Fix dictionary input to sparse vector constructor

archive/issues_010484.json:
```json
{
    "body": "A dictionary can be used to specify the entries of a vector, and then the result will be sparse.  The degree of the vector is implicitly determined by the largest key/index.  You can fool this by creating a zero entry with a large key/index.  But then problems arise later if you try to use this constructor with a dictionary created programatically - you can't fool it twice.\n\nSo working with sparse matrices is either unreliable (as described), or inefficient (convert from dictionaries to lists and back again).\n\nPatch slowly ate away at the old `prepare_dict` until almost nothing was left, and then it got subsumed into `prepare`.  Passes all tests in sage/modules and I will run full tests overnight.\n\nDepends on 4.6.1.alpha3 and #10364 which had improved error messages for this situation.\n\nAssignee: jason, was\n\nResolution: fixed\n\nAuthor: Rob Beezer\n\nReviewer: Dmitrii Pasechnik\n\nMerged: sage-4.6.2.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/10537\n\n",
    "closed_at": "2011-01-26T22:28:41Z",
    "created_at": "2010-12-31T09:51:32Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "Fix dictionary input to sparse vector constructor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10537",
    "user": "https://github.com/rbeezer"
}
```
A dictionary can be used to specify the entries of a vector, and then the result will be sparse.  The degree of the vector is implicitly determined by the largest key/index.  You can fool this by creating a zero entry with a large key/index.  But then problems arise later if you try to use this constructor with a dictionary created programatically - you can't fool it twice.

So working with sparse matrices is either unreliable (as described), or inefficient (convert from dictionaries to lists and back again).

Patch slowly ate away at the old `prepare_dict` until almost nothing was left, and then it got subsumed into `prepare`.  Passes all tests in sage/modules and I will run full tests overnight.

Depends on 4.6.1.alpha3 and #10364 which had improved error messages for this situation.

Assignee: jason, was

Resolution: fixed

Author: Rob Beezer

Reviewer: Dmitrii Pasechnik

Merged: sage-4.6.2.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/10537





---

archive/issue_comments_137804.json:
```json
{
    "body": "<a id='comment:1'></a>\nPatchbot:\n\nApply trac_10537_dictionary_vector_input.patch\n\nDepends on #10364",
    "created_at": "2010-12-31T10:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137804",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:1'></a>
Patchbot:

Apply trac_10537_dictionary_vector_input.patch

Depends on #10364



---

archive/issue_comments_137805.json:
```json
{
    "body": "Changing author from \"\" to \"Rob Beezer\"",
    "created_at": "2010-12-31T10:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137805",
    "user": "https://github.com/rbeezer"
}
```

Changing author from "" to "Rob Beezer"



---

archive/issue_comments_137806.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-12-31T10:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137806",
    "user": "https://github.com/rbeezer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_137807.json:
```json
{
    "body": "Attachment [trac_10537_dictionary_vector_input.patch](tarball://root/attachments/some-uuid/ticket10537/trac_10537_dictionary_vector_input.patch) by @rbeezer created at 2010-12-31 10:29:24",
    "created_at": "2010-12-31T10:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137807",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_10537_dictionary_vector_input.patch](tarball://root/attachments/some-uuid/ticket10537/trac_10537_dictionary_vector_input.patch) by @rbeezer created at 2010-12-31 10:29:24



---

archive/issue_comments_137808.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-11T23:55:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137808",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_137809.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dmitrii Pasechnik\"",
    "created_at": "2011-01-25T09:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137809",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Dmitrii Pasechnik"



---

archive/issue_events_032451.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T22:28:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10537#event-32451"
}
```



---

archive/issue_comments_137810.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-26T22:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137810",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_137811.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.6.2.alpha3\"",
    "created_at": "2011-01-26T22:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10537#issuecomment-137811",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.6.2.alpha3"
