# Issue 10735: Simon 2-descent only returns an upper bound on the 2-Selmer rank

archive/issues_010672.json:
```json
{
    "body": "[See #15608 for a list of open simon_two_descent tickets]\n\nGiven an elliptic curve E the method E.simon_two_descent() returns an ordered triple. This consists of a lower bound on the Mordell-Weil rank of E, an integer which is supposed to be the F_2 dimension of the 2-Selmer group of E, and list of points, generating the part of the Mordell-Weil group that has been found.\n\nSometimes the second entry is larger than the actual 2-Selmer rank as computed by mwrank, and predicted by BSD. The first curve I know of for which this happens is the elliptic curve '438e1' from Cremona's tables.\n\n```\nsage: E=EllipticCurve('438e1')\nsage: E.simon_two_descent()\n(0, 3, [(13 : -7 : 1)])\nsage: E.selmer_rank() #uses mwrank\n1\nsage: E.sha().an()\n1\n```\n\nThe explanation for this is that `E.simon_two_descent()`, unlike Cremona's `mwrank`, does not do a second descent and therefore only determines an upper bound on the 2-Selmer rank.\n\nAssignee: @JohnCremona\n\nCC:  @JohnCremona @williamstein @rlmill\n\nKeywords: simon_two_descent\n\nBranch/Commit: [732191df41bcc093230a41e747514bcdef46fd40](https://github.com/sagemath/sagetrac-mirror/commit/732191df41bcc093230a41e747514bcdef46fd40)\n\nUpstream: Reported upstream. No feedback yet.\n\nReviewer: Chris Wuthrich\n\nAuthor: Peter Bruin\n\nDependencies: #11005, #9322\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10735\n\n",
    "closed_at": "2014-03-31T21:12:33Z",
    "created_at": "2011-02-03T05:59:32Z",
    "labels": [
        "component: elliptic curves",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Simon 2-descent only returns an upper bound on the 2-Selmer rank",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10735",
    "user": "https://trac.sagemath.org/admin/accounts/users/weigandt"
}
```
[See #15608 for a list of open simon_two_descent tickets]

Given an elliptic curve E the method E.simon_two_descent() returns an ordered triple. This consists of a lower bound on the Mordell-Weil rank of E, an integer which is supposed to be the F_2 dimension of the 2-Selmer group of E, and list of points, generating the part of the Mordell-Weil group that has been found.

Sometimes the second entry is larger than the actual 2-Selmer rank as computed by mwrank, and predicted by BSD. The first curve I know of for which this happens is the elliptic curve '438e1' from Cremona's tables.

```
sage: E=EllipticCurve('438e1')
sage: E.simon_two_descent()
(0, 3, [(13 : -7 : 1)])
sage: E.selmer_rank() #uses mwrank
1
sage: E.sha().an()
1
```

The explanation for this is that `E.simon_two_descent()`, unlike Cremona's `mwrank`, does not do a second descent and therefore only determines an upper bound on the 2-Selmer rank.

Assignee: @JohnCremona

CC:  @JohnCremona @williamstein @rlmill

Keywords: simon_two_descent

Branch/Commit: [732191df41bcc093230a41e747514bcdef46fd40](https://github.com/sagemath/sagetrac-mirror/commit/732191df41bcc093230a41e747514bcdef46fd40)

Upstream: Reported upstream. No feedback yet.

Reviewer: Chris Wuthrich

Author: Peter Bruin

Dependencies: #11005, #9322

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10735





---

archive/issue_events_033110.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10735#event-33110"
}
```



---

archive/issue_comments_141551.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis is a bug in Simon's script indeed. I have emailed him about this one, too, as it happens with the later version of his file in gp, too.",
    "created_at": "2013-12-28T01:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141551",
    "user": "https://github.com/categorie"
}
```

<a id='comment:2'></a>
This is a bug in Simon's script indeed. I have emailed him about this one, too, as it happens with the later version of his file in gp, too.



---

archive/issue_comments_141552.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2013-12-28T01:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141552",
    "user": "https://github.com/categorie"
}
```

Changing upstream from "N/A" to "Reported upstream. No feedback yet."



---

archive/issue_comments_141553.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+[See #15608 for a list of open simon_two_descent tickets]\n+\n Given an elliptic curve E the method E.simon_two_descent() returns an ordered triple. This consists of a lower bound on the Mordell-Weil rank of E, an integer which is supposed to be the F_2 dimension of the 2-Selmer group of E, and list of points, generating the part of the Mordell-Weil group that has been found.\n \n Sometimes the second entry is larger than the actual 2-Selmer rank as computed by mwrank, and predicted by BSD. The first curve I know of for which this happens is the elliptic curve '438e1' from Cremona's tables.\n``````\n",
    "created_at": "2013-12-30T16:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141553",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+[See #15608 for a list of open simon_two_descent tickets]
+
 Given an elliptic curve E the method E.simon_two_descent() returns an ordered triple. This consists of a lower bound on the Mordell-Weil rank of E, an integer which is supposed to be the F_2 dimension of the 2-Selmer group of E, and list of points, generating the part of the Mordell-Weil group that has been found.
 
 Sometimes the second entry is larger than the actual 2-Selmer rank as computed by mwrank, and predicted by BSD. The first curve I know of for which this happens is the elliptic curve '438e1' from Cremona's tables.
``````




---

archive/issue_events_033111.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10735#event-33111"
}
```



---

archive/issue_events_033112.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10735#event-33112"
}
```



---

archive/issue_comments_141554.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#11005\"",
    "created_at": "2014-02-11T19:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141554",
    "user": "https://github.com/pjbruin"
}
```

Changing dependencies from "" to "#11005"



---

archive/issue_comments_141555.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe problem still exists after #11005, which upgrades Simon's scripts to the latest version:\n\n```\nsage: E=EllipticCurve('438e1')\nsage: E.simon_two_descent()\n(0, 3, [])\n```\n(Note: the torsion point (13, -7) is no longer returned since #13593.)",
    "created_at": "2014-02-11T19:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141555",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:6'></a>
The problem still exists after #11005, which upgrades Simon's scripts to the latest version:

```
sage: E=EllipticCurve('438e1')
sage: E.simon_two_descent()
(0, 3, [])
```
(Note: the torsion point (13, -7) is no longer returned since #13593.)



---

archive/issue_comments_141556.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt seems to me that the bug is *not* caused by failing to detect non-solubility at the real place.  In fact, Simon's script computes the same 2-isogeny Selmer ranks as `mwrank`, but deduces an incorrect 2-Selmer rank from these.\n\nOutput of `mwrank`:\n\n```\nCurve [1,0,1,-130,-556] :\t\n1 points of order 2:\n[13:-7:1]\n\nUsing 2-isogenous curve [0,-314,0,73,0] (minimal model [1,0,1,-2050,-35884])\n-------------------------------------------------------\nFirst step, determining 1st descent Selmer groups\n-------------------------------------------------------\nAfter first local descent, rank bound = 2\nrk(S^{phi}(E'))=\t3\nrk(S^{phi'}(E))=\t1\n\n-------------------------------------------------------\nSecond step, determining 2nd descent Selmer groups\n-------------------------------------------------------\nAfter second local descent, rank bound = 0\nrk(phi'(S^{2}(E)))=\t1\nrk(phi(S^{2}(E')))=\t1\nrk(S^{2}(E))=\t1\nrk(S^{2}(E'))=\t3\n\nThird step, determining E(Q)/phi(E'(Q)) and E'(Q)/phi'(E(Q))\n-------------------------------------------------------\n1. E(Q)/phi(E'(Q))\n-------------------------------------------------------\n(c,d)  =(157,6144)\n(c',d')=(-314,73)\nThis component of the rank is 0\n-------------------------------------------------------\n2. E'(Q)/phi'(E(Q))\n-------------------------------------------------------\nThis component of the rank is 0\n\n-------------------------------------------------------\nSummary of results:\n-------------------------------------------------------\n\trank(E) = 0\n\t#E(Q)/2E(Q) = 2\n\nInformation on III(E/Q):\n\t#III(E/Q)[phi']    = 1\n\t#III(E/Q)[2]       = 1\n\nInformation on III(E'/Q):\n\t#phi'(III(E/Q)[2]) = 1\n\t#III(E'/Q)[phi]    = 4\n\t#III(E'/Q)[2]      = 4\n\n\nUsed descent via 2-isogeny with isogenous curve E' = [1,0,1,-2050,-35884]\nRank = 0\nRank of S^2(E)  = 1\nRank of S^2(E') = 3\nRank of S^phi(E') = 3\nRank of S^phi'(E) = 1\n\nProcessing points found during 2-descent...done:\n  now regulator = 1\n\n\nRegulator = 1\n\nThe rank and full Mordell-Weil basis have been determined unconditionally.\n (0.098 seconds)\n```\nOutput of `simon_two_descent`:\n\n```\nellrank([1,0,1,-130,-556]);\n Elliptic curve: Y^2 = x^3 + x^2 - 2072*x - 35568\n E[2] = [[0], [52, 0]]\n Elliptic curve: Y^2 = x^3 + 157*x^2 + 6144*x\n  Algorithm of 2-descent via isogenies\n trivial points on E(Q) = [[0, 0], [1, 1, 0], [0, 0], [0, 0]]\n\n  #K(b,2)gen          = 3\n  K(b,2)gen = [-1, 2, 3]~\n  quartic ELS: Y^2 = -x^4 + 157*x^2 - 6144\n  no point found on the quartic\n  quartic ELS: Y^2 = 2*x^4 + 157*x^2 + 3072\n  no point found on the quartic\n  quartic ELS: Y^2 = -2*x^4 + 157*x^2 - 3072\n  no point found on the quartic\n  quartic ELS: Y^2 = 3*x^4 + 157*x^2 + 2048\n  no point found on the quartic\n  quartic ELS: Y^2 = -3*x^4 + 157*x^2 - 2048\n  no point found on the quartic\n  point on the quartic\n points on E(Q) = [[0, 0]]\n\n[E(Q):phi'(E'(Q))] >= 2\n#S^(phi')(E'/Q)     = 8  # agrees with mwrank\n#III(E'/Q)[phi']   <= 4\n\n  #K(a^2-4b,2)gen     = 2\n  K(a^2-4b,2)gen     = [-1, 73]~\n trivial points on E'(Q) = [[0, 0], [1, 1, 0], [0, 0], [0, 0]]\n\n  point on the quartic\n points on E'(Q) = [[0, 0]]\n points on E(Q) = [[0, 0]]\n\n[E'(Q):phi(E(Q))]   = 2\n#S^(phi)(E/Q)       = 2  # agrees with mwrank\n#III(E/Q)[phi]      = 1\n\n#III(E/Q)[2]       <= 4\n#E(Q)[2]            = 2\n#E(Q)/2E(Q)        >= 2\n\n0 <= rank          <= 2\n\npoints = [[0, 0]]\nv =  [0, 3, [[13, -7]]]\n```\nThe 3 in the last line, which should be the rank of the 2-Selmer group according to the documentation, is the result of computing (rank of `S^(phi)(E/Q)`) + (rank of `S^(phi')(E'/Q)`) + (rank of `E(Q)[2]`) - 2 = 1 + 3 + 1 - 2 = 3.  There must be something wrong with this formula, as it is symmetric in *E* and *E' * (in this particular case, since `E(Q)[2]` and `E'(Q)[2]` both have rank 1) while the 2-Selmer ranks of *E* and *E' * are in fact different (1 and 3, respectively).",
    "created_at": "2014-02-13T23:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141556",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:7'></a>
It seems to me that the bug is *not* caused by failing to detect non-solubility at the real place.  In fact, Simon's script computes the same 2-isogeny Selmer ranks as `mwrank`, but deduces an incorrect 2-Selmer rank from these.

Output of `mwrank`:

```
Curve [1,0,1,-130,-556] :	
1 points of order 2:
[13:-7:1]

Using 2-isogenous curve [0,-314,0,73,0] (minimal model [1,0,1,-2050,-35884])
-------------------------------------------------------
First step, determining 1st descent Selmer groups
-------------------------------------------------------
After first local descent, rank bound = 2
rk(S^{phi}(E'))=	3
rk(S^{phi'}(E))=	1

-------------------------------------------------------
Second step, determining 2nd descent Selmer groups
-------------------------------------------------------
After second local descent, rank bound = 0
rk(phi'(S^{2}(E)))=	1
rk(phi(S^{2}(E')))=	1
rk(S^{2}(E))=	1
rk(S^{2}(E'))=	3

Third step, determining E(Q)/phi(E'(Q)) and E'(Q)/phi'(E(Q))
-------------------------------------------------------
1. E(Q)/phi(E'(Q))
-------------------------------------------------------
(c,d)  =(157,6144)
(c',d')=(-314,73)
This component of the rank is 0
-------------------------------------------------------
2. E'(Q)/phi'(E(Q))
-------------------------------------------------------
This component of the rank is 0

-------------------------------------------------------
Summary of results:
-------------------------------------------------------
	rank(E) = 0
	#E(Q)/2E(Q) = 2

Information on III(E/Q):
	#III(E/Q)[phi']    = 1
	#III(E/Q)[2]       = 1

Information on III(E'/Q):
	#phi'(III(E/Q)[2]) = 1
	#III(E'/Q)[phi]    = 4
	#III(E'/Q)[2]      = 4


Used descent via 2-isogeny with isogenous curve E' = [1,0,1,-2050,-35884]
Rank = 0
Rank of S^2(E)  = 1
Rank of S^2(E') = 3
Rank of S^phi(E') = 3
Rank of S^phi'(E) = 1

Processing points found during 2-descent...done:
  now regulator = 1


Regulator = 1

The rank and full Mordell-Weil basis have been determined unconditionally.
 (0.098 seconds)
```
Output of `simon_two_descent`:

```
ellrank([1,0,1,-130,-556]);
 Elliptic curve: Y^2 = x^3 + x^2 - 2072*x - 35568
 E[2] = [[0], [52, 0]]
 Elliptic curve: Y^2 = x^3 + 157*x^2 + 6144*x
  Algorithm of 2-descent via isogenies
 trivial points on E(Q) = [[0, 0], [1, 1, 0], [0, 0], [0, 0]]

  #K(b,2)gen          = 3
  K(b,2)gen = [-1, 2, 3]~
  quartic ELS: Y^2 = -x^4 + 157*x^2 - 6144
  no point found on the quartic
  quartic ELS: Y^2 = 2*x^4 + 157*x^2 + 3072
  no point found on the quartic
  quartic ELS: Y^2 = -2*x^4 + 157*x^2 - 3072
  no point found on the quartic
  quartic ELS: Y^2 = 3*x^4 + 157*x^2 + 2048
  no point found on the quartic
  quartic ELS: Y^2 = -3*x^4 + 157*x^2 - 2048
  no point found on the quartic
  point on the quartic
 points on E(Q) = [[0, 0]]

[E(Q):phi'(E'(Q))] >= 2
#S^(phi')(E'/Q)     = 8  # agrees with mwrank
#III(E'/Q)[phi']   <= 4

  #K(a^2-4b,2)gen     = 2
  K(a^2-4b,2)gen     = [-1, 73]~
 trivial points on E'(Q) = [[0, 0], [1, 1, 0], [0, 0], [0, 0]]

  point on the quartic
 points on E'(Q) = [[0, 0]]
 points on E(Q) = [[0, 0]]

[E'(Q):phi(E(Q))]   = 2
#S^(phi)(E/Q)       = 2  # agrees with mwrank
#III(E/Q)[phi]      = 1

#III(E/Q)[2]       <= 4
#E(Q)[2]            = 2
#E(Q)/2E(Q)        >= 2

0 <= rank          <= 2

points = [[0, 0]]
v =  [0, 3, [[13, -7]]]
```
The 3 in the last line, which should be the rank of the 2-Selmer group according to the documentation, is the result of computing (rank of `S^(phi)(E/Q)`) + (rank of `S^(phi')(E'/Q)`) + (rank of `E(Q)[2]`) - 2 = 1 + 3 + 1 - 2 = 3.  There must be something wrong with this formula, as it is symmetric in *E* and *E' * (in this particular case, since `E(Q)[2]` and `E'(Q)[2]` both have rank 1) while the 2-Selmer ranks of *E* and *E' * are in fact different (1 and 3, respectively).



---

archive/issue_comments_141557.json:
```json
{
    "body": "<a id='comment:8'></a>\nThat is indeed bad. The fomula (after the first descent) is indeed\n\n dim Sel_phi + dim Sel_phihat + dim E[2] - 2 .\n\nthis is a upper bound to dim Sel_2 and they have the same parity. But they need not be equal as the second descent in mwrank finds. The difference is a subquotient of Sha(E').\n\nConclusion: The output of Simon's algorithm is an upper bound on the 2-Selmer group, which is correct in parity, but not necessarily equal.\n\nIn propose that we change the documentation, for I don't image that Simon's script could give back to full answer - though I have not looked at it.",
    "created_at": "2014-02-15T00:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141557",
    "user": "https://github.com/categorie"
}
```

<a id='comment:8'></a>
That is indeed bad. The fomula (after the first descent) is indeed

 dim Sel_phi + dim Sel_phihat + dim E[2] - 2 .

this is a upper bound to dim Sel_2 and they have the same parity. But they need not be equal as the second descent in mwrank finds. The difference is a subquotient of Sha(E').

Conclusion: The output of Simon's algorithm is an upper bound on the 2-Selmer group, which is correct in parity, but not necessarily equal.

In propose that we change the documentation, for I don't image that Simon's script could give back to full answer - though I have not looked at it.



---

archive/issue_comments_141558.json:
```json
{
    "body": "<a id='comment:9'></a>\nYou are right.  DS does no second descent (unlike mwrank when over Q and with 2-torsion) and the second descent can give a better upper bound on the rank.",
    "created_at": "2014-02-15T11:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141558",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:9'></a>
You are right.  DS does no second descent (unlike mwrank when over Q and with 2-torsion) and the second descent can give a better upper bound on the rank.



---

archive/issue_comments_141559.json:
```json
{
    "body": "<a id='comment:10'></a>\nChanging the documentation does indeed sound like the right solution here.  The correctness of the parity of this upper bound probably relies on finiteness of \u0428, or doesn't it?",
    "created_at": "2014-02-15T12:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141559",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:10'></a>
Changing the documentation does indeed sound like the right solution here.  The correctness of the parity of this upper bound probably relies on finiteness of ле, or doesn't it?



---

archive/issue_comments_141560.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,8 +3,6 @@\n Given an elliptic curve E the method E.simon_two_descent() returns an ordered triple. This consists of a lower bound on the Mordell-Weil rank of E, an integer which is supposed to be the F_2 dimension of the 2-Selmer group of E, and list of points, generating the part of the Mordell-Weil group that has been found.\n \n Sometimes the second entry is larger than the actual 2-Selmer rank as computed by mwrank, and predicted by BSD. The first curve I know of for which this happens is the elliptic curve '438e1' from Cremona's tables.\n-\n-This curve definitely possesses 2-covers which are everywhere locally soluble EXCEPT at that infinite place. These probably explain the discrepancy.\n \n ```\n sage: E=EllipticCurve('438e1')\n@@ -16,3 +14,4 @@\n 1\n ```\n \n+The explanation for this is that `E.simon_two_descent()`, unlike Cremona's `mwrank`, does not do a second descent and therefore only determines an upper bound on the 2-Selmer rank.\n``````\n",
    "created_at": "2014-02-15T12:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141560",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,8 +3,6 @@
 Given an elliptic curve E the method E.simon_two_descent() returns an ordered triple. This consists of a lower bound on the Mordell-Weil rank of E, an integer which is supposed to be the F_2 dimension of the 2-Selmer group of E, and list of points, generating the part of the Mordell-Weil group that has been found.
 
 Sometimes the second entry is larger than the actual 2-Selmer rank as computed by mwrank, and predicted by BSD. The first curve I know of for which this happens is the elliptic curve '438e1' from Cremona's tables.
-
-This curve definitely possesses 2-covers which are everywhere locally soluble EXCEPT at that infinite place. These probably explain the discrepancy.
 
 ```
 sage: E=EllipticCurve('438e1')
@@ -16,3 +14,4 @@
 1
 ```
 
+The explanation for this is that `E.simon_two_descent()`, unlike Cremona's `mwrank`, does not do a second descent and therefore only determines an upper bound on the 2-Selmer rank.
``````




---

archive/issue_events_033113.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "rename": {
        "from": "Simon 2-descent may not check for solubility at archimedean  places.",
        "to": "Simon 2-descent only returns an upper bound on the 2-Selmer rank"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10735#event-33113"
}
```



---

archive/issue_comments_141561.json:
```json
{
    "body": "<a id='comment:11'></a>\nNo the correctness of the parity is unconditional. (This is used for instance in the proof of the p-parity conjecture via p-isogeny.)",
    "created_at": "2014-02-15T13:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141561",
    "user": "https://github.com/categorie"
}
```

<a id='comment:11'></a>
No the correctness of the parity is unconditional. (This is used for instance in the proof of the p-parity conjecture via p-isogeny.)



---

archive/issue_comments_141562.json:
```json
{
    "body": "Changing branch from \"\" to \"u/pbruin/10735-simon_two_descent_doc\"",
    "created_at": "2014-02-17T21:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141562",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "" to "u/pbruin/10735-simon_two_descent_doc"



---

archive/issue_comments_141563.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-02-17T21:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141563",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_141564.json:
```json
{
    "body": "Changing author from \"\" to \"Peter Bruin\"",
    "created_at": "2014-02-17T21:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141564",
    "user": "https://github.com/pjbruin"
}
```

Changing author from "" to "Peter Bruin"



---

archive/issue_comments_141565.json:
```json
{
    "body": "<a id='comment:12'></a>\nHere is a patch for the documentation of `simon_two_descent()`, including a new doctest using the example from the ticket description.\n\nThere are a few other improvements to the docstring.  In particular, it contained several calls to `set_random_seed()`.  These can't have any effect, because Simon's script runs inside a separate GP interpreter with its own random state, so I removed these.",
    "created_at": "2014-02-17T21:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141565",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:12'></a>
Here is a patch for the documentation of `simon_two_descent()`, including a new doctest using the example from the ticket description.

There are a few other improvements to the docstring.  In particular, it contained several calls to `set_random_seed()`.  These can't have any effect, because Simon's script runs inside a separate GP interpreter with its own random state, so I removed these.



---

archive/issue_comments_141566.json:
```json
{
    "body": "Changing commit from \"\" to \"a47b7a1281fdc057ac148535e88a01ed113dd8fc\"",
    "created_at": "2014-02-17T21:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141566",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "" to "a47b7a1281fdc057ac148535e88a01ed113dd8fc"



---

archive/issue_comments_141567.json:
```json
{
    "body": "<a id='comment:13'></a>\nAnother thing: the method `simon_two_descent()` is currently not quite consistent between **Q** and other number fields: the method over **Q** removes points of finite order from the list (at least since #5153), but the corresponding method over general number fields does not.  I made the documentation consistent with this, but did not change any code.  If we want to fix this, it is probably best to do it as part of #10745.",
    "created_at": "2014-02-17T21:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141567",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:13'></a>
Another thing: the method `simon_two_descent()` is currently not quite consistent between **Q** and other number fields: the method over **Q** removes points of finite order from the list (at least since #5153), but the corresponding method over general number fields does not.  I made the documentation consistent with this, but did not change any code.  If we want to fix this, it is probably best to do it as part of #10745.



---

archive/issue_comments_141568.json:
```json
{
    "body": "<a id='comment:14'></a>\nWe removed the points of finite order from `.gens()` for number fields but not from `simon_two_descent()`, which is a bit inconsistent, indeed. I agree to adress this in #10745.\n\nNow to this ticket. I have run all tests and I am certainly happy with the improvement. So I give a positive review. I am not sure about the random seed issue above, but I trust you. Otherwise someone will complain at some point.",
    "created_at": "2014-03-28T17:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141568",
    "user": "https://github.com/categorie"
}
```

<a id='comment:14'></a>
We removed the points of finite order from `.gens()` for number fields but not from `simon_two_descent()`, which is a bit inconsistent, indeed. I agree to adress this in #10745.

Now to this ticket. I have run all tests and I am certainly happy with the improvement. So I give a positive review. I am not sure about the random seed issue above, but I trust you. Otherwise someone will complain at some point.



---

archive/issue_comments_141569.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-28T17:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141569",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_141570.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Chris Wuthrich\"",
    "created_at": "2014-03-28T17:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141570",
    "user": "https://github.com/categorie"
}
```

Changing reviewer from "" to "Chris Wuthrich"



---

archive/issue_comments_141571.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-03-28T19:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141571",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_141572.json:
```json
{
    "body": "Changing commit from \"a47b7a1281fdc057ac148535e88a01ed113dd8fc\" to \"732191df41bcc093230a41e747514bcdef46fd40\"",
    "created_at": "2014-03-28T19:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141572",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a47b7a1281fdc057ac148535e88a01ed113dd8fc" to "732191df41bcc093230a41e747514bcdef46fd40"



---

archive/issue_comments_141573.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:\n|                                                                                                                                          |                                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|\n|[b2b66c5](https://github.com/sagemath/sagetrac-mirror/commit/b2b66c54b8fd220e976c9d5ddcaeb6eec8ba7ff8)|`Fixed calls to simon's two descent to use his own defaults (by default).`|\n|[594de7b](https://github.com/sagemath/sagetrac-mirror/commit/594de7b4cabd1359de0c33748e17dc9209f4b61b)|`Merge branch 'u/mmasdeu/9322-defaults-for-two-descent' of git://trac.sagemath.org/sage into ticket/9322-simon_two_descent_defaults`|\n|[db79035](https://github.com/sagemath/sagetrac-mirror/commit/db790353ddf534dc32fced15afdadb54f96cce94)|`Merge branch 'develop' into gp_simon_relative`|\n|[a92a80e](https://github.com/sagemath/sagetrac-mirror/commit/a92a80eb918e5f6de14269f04317a1b95b3a4b4b)|`Changed the doctest to make it independent of variable output.`|\n|[275e4be](https://github.com/sagemath/sagetrac-mirror/commit/275e4bef0c5027517163a50248cf417308d6bde7)|`fix a bug in Denis Simon's 2-descent program`|\n|[8bceb36](https://github.com/sagemath/sagetrac-mirror/commit/8bceb36e55fe51e86815f8432eec201d401595ea)|`Merge branch 'u/pbruin/16022-simon_two_descent_bug' of trac.sagemath.org:sage into gp_simon_relative`|\n|[962d338](https://github.com/sagemath/sagetrac-mirror/commit/962d338206fb9d7ace6b1367b24f12d97e53601a)|`Merge branch 'ticket/16009-gp_simon_relative' into ticket/9322-simon_two_descent_defaults`|\n|[4bdb538](https://github.com/sagemath/sagetrac-mirror/commit/4bdb5389e8b1a41ebfcf00a5c2561f0841113854)|`fix doctests in ell_number_field.py`|\n|[ecd28b4](https://github.com/sagemath/sagetrac-mirror/commit/ecd28b4f5ba2bff231807a512170a6e02e2a32aa)|`use default limtriv=3 for simon_two_descent over Q`|\n|[732191d](https://github.com/sagemath/sagetrac-mirror/commit/732191df41bcc093230a41e747514bcdef46fd40)|`Merge branch 'ticket/9322-simon_two_descent_defaults' into ticket/10735-two_selmer_discrepancy`|",
    "created_at": "2014-03-28T19:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:
|                                                                                                                                          |                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
|[b2b66c5](https://github.com/sagemath/sagetrac-mirror/commit/b2b66c54b8fd220e976c9d5ddcaeb6eec8ba7ff8)|`Fixed calls to simon's two descent to use his own defaults (by default).`|
|[594de7b](https://github.com/sagemath/sagetrac-mirror/commit/594de7b4cabd1359de0c33748e17dc9209f4b61b)|`Merge branch 'u/mmasdeu/9322-defaults-for-two-descent' of git://trac.sagemath.org/sage into ticket/9322-simon_two_descent_defaults`|
|[db79035](https://github.com/sagemath/sagetrac-mirror/commit/db790353ddf534dc32fced15afdadb54f96cce94)|`Merge branch 'develop' into gp_simon_relative`|
|[a92a80e](https://github.com/sagemath/sagetrac-mirror/commit/a92a80eb918e5f6de14269f04317a1b95b3a4b4b)|`Changed the doctest to make it independent of variable output.`|
|[275e4be](https://github.com/sagemath/sagetrac-mirror/commit/275e4bef0c5027517163a50248cf417308d6bde7)|`fix a bug in Denis Simon's 2-descent program`|
|[8bceb36](https://github.com/sagemath/sagetrac-mirror/commit/8bceb36e55fe51e86815f8432eec201d401595ea)|`Merge branch 'u/pbruin/16022-simon_two_descent_bug' of trac.sagemath.org:sage into gp_simon_relative`|
|[962d338](https://github.com/sagemath/sagetrac-mirror/commit/962d338206fb9d7ace6b1367b24f12d97e53601a)|`Merge branch 'ticket/16009-gp_simon_relative' into ticket/9322-simon_two_descent_defaults`|
|[4bdb538](https://github.com/sagemath/sagetrac-mirror/commit/4bdb5389e8b1a41ebfcf00a5c2561f0841113854)|`fix doctests in ell_number_field.py`|
|[ecd28b4](https://github.com/sagemath/sagetrac-mirror/commit/ecd28b4f5ba2bff231807a512170a6e02e2a32aa)|`use default limtriv=3 for simon_two_descent over Q`|
|[732191d](https://github.com/sagemath/sagetrac-mirror/commit/732191df41bcc093230a41e747514bcdef46fd40)|`Merge branch 'ticket/9322-simon_two_descent_defaults' into ticket/10735-two_selmer_discrepancy`|



---

archive/issue_comments_141574.json:
```json
{
    "body": "Changing dependencies from \"#11005\" to \"#11005, #9322\"",
    "created_at": "2014-03-28T19:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141574",
    "user": "https://github.com/pjbruin"
}
```

Changing dependencies from "#11005" to "#11005, #9322"



---

archive/issue_comments_141575.json:
```json
{
    "body": "<a id='comment:16'></a>\nThere was just a trivial merge conflict with #9322, which also has positive review, so I merged that branch and made it a dependency.",
    "created_at": "2014-03-28T19:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141575",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:16'></a>
There was just a trivial merge conflict with #9322, which also has positive review, so I merged that branch and made it a dependency.



---

archive/issue_comments_141576.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-28T19:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141576",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_141577.json:
```json
{
    "body": "Changing branch from \"u/pbruin/10735-simon_two_descent_doc\" to \"732191df41bcc093230a41e747514bcdef46fd40\"",
    "created_at": "2014-03-31T21:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141577",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/pbruin/10735-simon_two_descent_doc" to "732191df41bcc093230a41e747514bcdef46fd40"



---

archive/issue_events_033114.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-31T21:12:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10735#event-33114"
}
```



---

archive/issue_comments_141578.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-03-31T21:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10735#issuecomment-141578",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
