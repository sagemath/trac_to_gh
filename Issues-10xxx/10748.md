# Issue 10748: Extend p-adic L-series to handle nontrivial Teichmuller components

archive/issues_010685.json:
```json
{
    "body": "The p-adic L-function of an elliptic curve is rightfully a distribution on `Zp*`. The current code only sees its Delta-invariant part, where Delta is the group of `(p-1)`st roots of unity.\n\nI have coded up a quick fix for this, with the help of Chris Wuthrich and drawing on some code written by Chan-Ho Kim at Sage Days 22 (see [http://wiki.sagemath.org/days22/wuthrich](http://wiki.sagemath.org/days22/wuthrich).\n\n**Assignee:** @JohnCremona\n\n**CC:**  @categorie\n\n**Keywords:** p-adic L-function\n\n**Resolution:** fixed\n\n**Author:** David Loeffler\n\n**Reviewer:** Chris Wuthrich\n\n**Merged:** sage-4.7.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/10748\n\n",
    "closed_at": "2011-03-08T21:47:00Z",
    "created_at": "2011-02-06T00:31:31Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "Extend p-adic L-series to handle nontrivial Teichmuller components",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10748",
    "user": "https://github.com/loefflerd"
}
```
The p-adic L-function of an elliptic curve is rightfully a distribution on `Zp*`. The current code only sees its Delta-invariant part, where Delta is the group of `(p-1)`st roots of unity.

I have coded up a quick fix for this, with the help of Chris Wuthrich and drawing on some code written by Chan-Ho Kim at Sage Days 22 (see [http://wiki.sagemath.org/days22/wuthrich](http://wiki.sagemath.org/days22/wuthrich).

**Assignee:** @JohnCremona

**CC:**  @categorie

**Keywords:** p-adic L-function

**Resolution:** fixed

**Author:** David Loeffler

**Reviewer:** Chris Wuthrich

**Merged:** sage-4.7.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/10748





---

archive/issue_comments_141815.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-02-06T00:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141815",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_141816.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [trac_10748.patch](tarball://root/attachments/some-uuid/ticket10748/trac_10748.patch) by @loefflerd created at 2011-02-06 00:33:43",
    "created_at": "2011-02-06T00:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141816",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:1'></a>
Attachment [trac_10748.patch](tarball://root/attachments/some-uuid/ticket10748/trac_10748.patch) by @loefflerd created at 2011-02-06 00:33:43



---

archive/issue_comments_141817.json:
```json
{
    "body": "<a id='comment:3'></a>\nGreat. Thanks a lot David. I will have a look at this during the coming week.\n\nAside: The long term plan would be to implement it for all twists, but then the coefficients of the power series are no longer ZZ_p but finite extensions of it. So it will take more work.",
    "created_at": "2011-02-06T11:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141817",
    "user": "https://github.com/categorie"
}
```

<a id='comment:3'></a>
Great. Thanks a lot David. I will have a look at this during the coming week.

Aside: The long term plan would be to implement it for all twists, but then the coefficients of the power series are no longer ZZ_p but finite extensions of it. So it will take more work.



---

archive/issue_comments_141818.json:
```json
{
    "body": "**Reviewer:** Chris Wuthrich",
    "created_at": "2011-02-07T14:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141818",
    "user": "https://github.com/categorie"
}
```

**Reviewer:** Chris Wuthrich



---

archive/issue_comments_141819.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-02-07T14:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141819",
    "user": "https://github.com/categorie"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_141820.json:
```json
{
    "body": "<a id='comment:4'></a>\nAll tests passed. \n\nHere is a further example to illustrate the code. Maybe, we should add it in the docstring somewhere ?\n\n```\nsage: E=EllipticCurve('11a1')\nsage: lp=E.padic_lseries(7)\nsage: lp.series(4,eta=1)\n6 + 2*7^3 + 5*7^4 + O(7^6) + (4*7 + 2*7^2 + O(7^3))*T + (2 + 3*7^2 + O(7^3))*T^2 + (1 + 2*7 + 2*7^2 + O(7^3))*T^3 + (1 + 3*7^2 + O(7^3))*T^4 + O(T^5)\nsage: lp.series(4,eta=2)\n5 + 6*7 + 4*7^2 + 2*7^3 + 3*7^4 + 2*7^5 + O(7^6) + (6 + 4*7 + 7^2 + O(7^3))*T + (3 + 2*7^2 + O(7^3))*T^2 + (1 + 4*7 + 7^2 + O(7^3))*T^3 + (6 + 6*7 + 6*7^2 + O(7^3))*T^4 + O(T^5)\nsage: lp.series(4,eta=3)\nO(7^6) + (3 + 2*7 + 5*7^2 + O(7^3))*T + (5 + 4*7 + 5*7^2 + O(7^3))*T^2 + (3*7 + 7^2 + O(7^3))*T^3 + (2*7 + 7^2 + O(7^3))*T^4 + O(T^5)\n```\n\nThe last vanishes at T=0, which is good, because it corresponds to the positive rank over sqrt(-7):\n\n```\nsage: E.quadratic_twist(-7).rank()\n1\n```\n\nThis proves that E has rank 1 over Q(zeta_7).",
    "created_at": "2011-02-07T14:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141820",
    "user": "https://github.com/categorie"
}
```

<a id='comment:4'></a>
All tests passed. 

Here is a further example to illustrate the code. Maybe, we should add it in the docstring somewhere ?

```
sage: E=EllipticCurve('11a1')
sage: lp=E.padic_lseries(7)
sage: lp.series(4,eta=1)
6 + 2*7^3 + 5*7^4 + O(7^6) + (4*7 + 2*7^2 + O(7^3))*T + (2 + 3*7^2 + O(7^3))*T^2 + (1 + 2*7 + 2*7^2 + O(7^3))*T^3 + (1 + 3*7^2 + O(7^3))*T^4 + O(T^5)
sage: lp.series(4,eta=2)
5 + 6*7 + 4*7^2 + 2*7^3 + 3*7^4 + 2*7^5 + O(7^6) + (6 + 4*7 + 7^2 + O(7^3))*T + (3 + 2*7^2 + O(7^3))*T^2 + (1 + 4*7 + 7^2 + O(7^3))*T^3 + (6 + 6*7 + 6*7^2 + O(7^3))*T^4 + O(T^5)
sage: lp.series(4,eta=3)
O(7^6) + (3 + 2*7 + 5*7^2 + O(7^3))*T + (5 + 4*7 + 5*7^2 + O(7^3))*T^2 + (3*7 + 7^2 + O(7^3))*T^3 + (2*7 + 7^2 + O(7^3))*T^4 + O(T^5)
```

The last vanishes at T=0, which is good, because it corresponds to the positive rank over sqrt(-7):

```
sage: E.quadratic_twist(-7).rank()
1
```

This proves that E has rank 1 over Q(zeta_7).



---

archive/issue_comments_141821.json:
```json
{
    "body": "Attachment [trac_10748-example.patch](tarball://root/attachments/some-uuid/ticket10748/trac_10748-example.patch) by @loefflerd created at 2011-02-10 17:19:47\n\nadd an example",
    "created_at": "2011-02-10T17:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141821",
    "user": "https://github.com/loefflerd"
}
```

Attachment [trac_10748-example.patch](tarball://root/attachments/some-uuid/ticket10748/trac_10748-example.patch) by @loefflerd created at 2011-02-10 17:19:47

add an example



---

archive/issue_comments_141822.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've done a patch which adds your example to the class docstring. For form's sake, could you give it a quick glance and if you're happy set it back to positive review?",
    "created_at": "2011-02-10T17:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141822",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:5'></a>
I've done a patch which adds your example to the class docstring. For form's sake, could you give it a quick glance and if you're happy set it back to positive review?



---

archive/issue_comments_141823.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2011-02-10T17:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141823",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_141824.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-02-10T17:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141824",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_141825.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-02-11T10:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141825",
    "user": "https://github.com/categorie"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_141826.json:
```json
{
    "body": "<a id='comment:7'></a>\nYes, that is fine, too.\nBoth patches one after the other must be applied.",
    "created_at": "2011-02-11T10:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141826",
    "user": "https://github.com/categorie"
}
```

<a id='comment:7'></a>
Yes, that is fine, too.
Both patches one after the other must be applied.



---

archive/issue_events_033142.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-03-08T21:47:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10748#event-33142"
}
```



---

archive/issue_comments_141827.json:
```json
{
    "body": "**Merged:** sage-4.7.alpha1",
    "created_at": "2011-03-08T21:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141827",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.alpha1



---

archive/issue_comments_141828.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2011-03-08T21:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10748#issuecomment-141828",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed
