# Issue 10795: Fix and upgrade double dense matrix QR decomposition

archive/issues_010730.json:
```json
{
    "assignees": [],
    "body": "The Q matrix of a QR decomposition should be unitary, hence invertible.  For zero-column trivial cases, this is broken.\n\n```\nsage: A = zero_matrix(CDF, 5, 0)\nsage: Q, R = A.QR()\nsage: Q\n[0 0 0 0 0]\n[0 0 0 0 0]\n[0 0 0 0 0]\n[0 0 0 0 0]\n[0 0 0 0 0]\n```\n\nBesides a bugfix this patch will upgrade the documentation to make it clear how this routine works over the complex numbers.  In particular, `SciPy` routines are using a Hermitian inner product - documentation upgrade will reflect that.\n\n**Apply**:\n1.  [attachment: trac_10795-QR-decomposition-double-dense-v2.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)\n2.  [attachment: trac_10795-QR-decomposition-formatting.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-formatting.patch.gz)\n\nAssignee: **@jasongrout, @williamstein**\n\nCC:  @jasongrout @dandrake\n\nKeywords: **sd40.5**\n\nReviewer: **Martin Raum, Dan Drake**\n\nAuthor: **Rob Beezer**\n\nMerged: **sage-5.2.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10795_\n\n",
    "closed_at": "2012-07-13T11:43:27Z",
    "created_at": "2011-02-17T22:24:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix and upgrade double dense matrix QR decomposition",
    "type": "issue",
    "updated_at": "2012-07-13T11:43:27Z",
    "url": "https://github.com/sagemath/sage/issues/10795",
    "user": "https://github.com/rbeezer"
}
```
The Q matrix of a QR decomposition should be unitary, hence invertible.  For zero-column trivial cases, this is broken.

```
sage: A = zero_matrix(CDF, 5, 0)
sage: Q, R = A.QR()
sage: Q
[0 0 0 0 0]
[0 0 0 0 0]
[0 0 0 0 0]
[0 0 0 0 0]
[0 0 0 0 0]
```

Besides a bugfix this patch will upgrade the documentation to make it clear how this routine works over the complex numbers.  In particular, `SciPy` routines are using a Hermitian inner product - documentation upgrade will reflect that.

**Apply**:
1.  [attachment: trac_10795-QR-decomposition-double-dense-v2.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)
2.  [attachment: trac_10795-QR-decomposition-formatting.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-formatting.patch.gz)

Assignee: **@jasongrout, @williamstein**

CC:  @jasongrout @dandrake

Keywords: **sd40.5**

Reviewer: **Martin Raum, Dan Drake**

Author: **Rob Beezer**

Merged: **sage-5.2.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/10795_





---

archive/issue_events_130204.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-17T22:24:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130204"
}
```



---

archive/issue_events_130205.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-17T22:24:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130205"
}
```



---

archive/issue_events_130206.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-17T22:24:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130206"
}
```



---

archive/issue_events_130207.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-17T22:24:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130207"
}
```



---

archive/issue_events_130208.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-17T22:24:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/good%20first%20issue",
    "label_color": "7057ff",
    "label_name": "good first issue",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130208"
}
```



---

archive/issue_events_130209.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-17T23:03:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130209"
}
```



---

archive/issue_comments_106143.json:
```json
{
    "body": "Author: **Rob Beezer**",
    "created_at": "2011-02-17T23:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106143",
    "user": "https://github.com/rbeezer"
}
```

Author: **Rob Beezer**



---

archive/issue_comments_106144.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nJust one change to the code, to return an identity matrix in a trivial case.  Everything else is documentation.  Unfortunately, this file is not included in the documentation (yet).  You can check that it builds without warnings, then look at it in the notebook to verify the contents and appearance.",
    "created_at": "2011-02-17T23:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106144",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:1" align="right">Comment 1</div>

Just one change to the code, to return an identity matrix in a trivial case.  Everything else is documentation.  Unfortunately, this file is not included in the documentation (yet).  You can check that it builds without warnings, then look at it in the notebook to verify the contents and appearance.



---

archive/issue_comments_106145.json:
```json
{
    "body": "Reviewer: **Martin Raum**",
    "created_at": "2011-08-06T16:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106145",
    "user": "https://github.com/sagetrac-mraum"
}
```

Reviewer: **Martin Raum**



---

archive/issue_comments_106146.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nEverything is OK with this patch.",
    "created_at": "2011-08-06T16:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106146",
    "user": "https://github.com/sagetrac-mraum"
}
```

<div id="comment:2" align="right">Comment 2</div>

Everything is OK with this patch.



---

archive/issue_events_130210.json:
```json
{
    "actor": "https://github.com/sagetrac-mraum",
    "created_at": "2011-08-06T16:36:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130210"
}
```



---

archive/issue_events_130211.json:
```json
{
    "actor": "https://github.com/sagetrac-mraum",
    "created_at": "2011-08-06T16:36:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130211"
}
```



---

archive/issue_events_130212.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-11T13:10:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130212"
}
```



---

archive/issue_events_130213.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-11T13:10:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130213"
}
```



---

archive/issue_comments_106147.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha2**",
    "created_at": "2011-08-18T22:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106147",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.2.alpha2**



---

archive/issue_events_130214.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:02:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130214"
}
```



---

archive/issue_events_130215.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:02:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130215"
}
```



---

archive/issue_comments_106148.json:
```json
{
    "body": "Changed merged from **sage-4.7.2.alpha2** to none",
    "created_at": "2011-08-24T08:22:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106148",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.2.alpha2** to none



---

archive/issue_comments_106149.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nOn various systems, there are doctest failures:\n\nhawk (OpenSolaris 06/2009 i86pc Xeon W3580):\n\n```\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1766:\n    sage: Q\nExpected:\n    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]\n    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]\n    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]\n    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]\nGot:\n    [-0.359210604054  0.569326179705  0.409076682956  0.616028985113]\n    [ 0.179605302027 -0.144590775798 -0.683704756325   0.69237507842]\n    [ 0.179605302027 -0.704880032016  0.575201135981  0.374205463771]\n    [ 0.898026510134  0.397624633445  0.185331397251 0.0330954856071]\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1771:\n    sage: R\nExpected:\n    [    -5.56776436283       2.6940795304      -2.6940795304]\n    [                 0     -3.56958477752      3.56958477752]\n    [                 0                  0 -9.93013661299e-16]\n    [                 0                  0                  0]\nGot:\n    [   -5.56776436283      2.6940795304     -2.6940795304]\n    [                0    -3.56958477752     3.56958477752]\n    [                0                 0 -4.4408920985e-16]\n    [                0                 0                 0]\n**********************************************************************\n```\n\nbsd (OS X 10.8.0 x86_64) 64-bit:\n\n```\n**********************************************************************\nFile \"/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1766:\n    sage: Q\nExpected:\n    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]\n    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]\n    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]\n    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]\nGot:\n    [ -0.359210604054   0.569326179705   0.146337376237   0.724859169325]\n    [  0.179605302027  -0.144590775798   0.973035382602 0.00613084354877]\n    [  0.179605302027  -0.704880032016  -0.142125402809   0.671331844787]\n    [  0.898026510134   0.397624633445  -0.107647045464   0.154451130063]\n**********************************************************************\nFile \"/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1771:\n    sage: R\nExpected:\n    [    -5.56776436283       2.6940795304      -2.6940795304]\n    [                 0     -3.56958477752      3.56958477752]\n    [                 0                  0 -9.93013661299e-16]\n    [                 0                  0                  0]\nGot:\n    [   -5.56776436283      2.6940795304     -2.6940795304]\n    [                0    -3.56958477752     3.56958477752]\n    [                0                 0 6.28036983474e-16]\n    [                0                 0                 0]\n**********************************************************************\n```\n\ncleo (RHEL 5.3 ia64 Itanium 2):\n\n```\n**********************************************************************\nFile \"/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1766:\n    sage: Q\nExpected:\n    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]\n    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]\n    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]\n    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]\nGot:\n    [ -0.359210604054   0.569326179705   0.146859067236   0.724753652911]\n    [  0.179605302027  -0.144590775798   0.973039543327 0.00543048428303]\n    [  0.179605302027  -0.704880032016  -0.141642164231   0.671433967908]\n    [  0.898026510134   0.397624633445  -0.107535848925   0.154528570726]\n**********************************************************************\nFile \"/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1771:\n    sage: R\nExpected:\n    [    -5.56776436283       2.6940795304      -2.6940795304]\n    [                 0     -3.56958477752      3.56958477752]\n    [                 0                  0 -9.93013661299e-16]\n    [                 0                  0                  0]\nGot:\n    [   -5.56776436283      2.6940795304     -2.6940795304]\n    [                0    -3.56958477752     3.56958477752]\n    [                0                 0 9.81879219451e-16]\n    [                0                 0                 0]\n**********************************************************************\n```",
    "created_at": "2011-08-24T08:22:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106149",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">Comment 5</div>

On various systems, there are doctest failures:

hawk (OpenSolaris 06/2009 i86pc Xeon W3580):

```
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1766:
    sage: Q
Expected:
    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]
    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]
    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]
    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]
Got:
    [-0.359210604054  0.569326179705  0.409076682956  0.616028985113]
    [ 0.179605302027 -0.144590775798 -0.683704756325   0.69237507842]
    [ 0.179605302027 -0.704880032016  0.575201135981  0.374205463771]
    [ 0.898026510134  0.397624633445  0.185331397251 0.0330954856071]
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1771:
    sage: R
Expected:
    [    -5.56776436283       2.6940795304      -2.6940795304]
    [                 0     -3.56958477752      3.56958477752]
    [                 0                  0 -9.93013661299e-16]
    [                 0                  0                  0]
Got:
    [   -5.56776436283      2.6940795304     -2.6940795304]
    [                0    -3.56958477752     3.56958477752]
    [                0                 0 -4.4408920985e-16]
    [                0                 0                 0]
**********************************************************************
```

bsd (OS X 10.8.0 x86_64) 64-bit:

```
**********************************************************************
File "/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1766:
    sage: Q
Expected:
    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]
    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]
    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]
    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]
Got:
    [ -0.359210604054   0.569326179705   0.146337376237   0.724859169325]
    [  0.179605302027  -0.144590775798   0.973035382602 0.00613084354877]
    [  0.179605302027  -0.704880032016  -0.142125402809   0.671331844787]
    [  0.898026510134   0.397624633445  -0.107647045464   0.154451130063]
**********************************************************************
File "/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1771:
    sage: R
Expected:
    [    -5.56776436283       2.6940795304      -2.6940795304]
    [                 0     -3.56958477752      3.56958477752]
    [                 0                  0 -9.93013661299e-16]
    [                 0                  0                  0]
Got:
    [   -5.56776436283      2.6940795304     -2.6940795304]
    [                0    -3.56958477752     3.56958477752]
    [                0                 0 6.28036983474e-16]
    [                0                 0                 0]
**********************************************************************
```

cleo (RHEL 5.3 ia64 Itanium 2):

```
**********************************************************************
File "/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1766:
    sage: Q
Expected:
    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]
    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]
    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]
    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]
Got:
    [ -0.359210604054   0.569326179705   0.146859067236   0.724753652911]
    [  0.179605302027  -0.144590775798   0.973039543327 0.00543048428303]
    [  0.179605302027  -0.704880032016  -0.141642164231   0.671433967908]
    [  0.898026510134   0.397624633445  -0.107535848925   0.154528570726]
**********************************************************************
File "/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1771:
    sage: R
Expected:
    [    -5.56776436283       2.6940795304      -2.6940795304]
    [                 0     -3.56958477752      3.56958477752]
    [                 0                  0 -9.93013661299e-16]
    [                 0                  0                  0]
Got:
    [   -5.56776436283      2.6940795304     -2.6940795304]
    [                0    -3.56958477752     3.56958477752]
    [                0                 0 9.81879219451e-16]
    [                0                 0                 0]
**********************************************************************
```



---

archive/issue_events_130216.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:55:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130216"
}
```



---

archive/issue_comments_106150.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nIt seems that this patch causes failures in a\nnon-reproducible way.  Is there some randomness in the algorithm?\nFor example, I just got this failure on sage.math.washington.edu (a\nmachine on which I remember the test succeeding):\n\n```\nsage -t -long  -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx\n**********************************************************************\nFile\n\"/mnt/usb1/scratch/buildbot/sage/sage-1/sage_binary/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\",\nline 1766:\n    sage: Q\nExpected:\n    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]\n    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]\n    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]\n    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]\nGot:\n    [-0.359210604054  0.569326179705  0.616028985113  0.409076682956]\n    [ 0.179605302027 -0.144590775798   0.69237507842 -0.683704756325]\n    [ 0.179605302027 -0.704880032016  0.374205463771  0.575201135981]\n    [ 0.898026510134  0.397624633445 0.0330954856071  0.185331397251]\n**********************************************************************\nFile\n\"/mnt/usb1/scratch/buildbot/sage/sage-1/sage_binary/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx\",\nline 1771:\n    sage: R\nExpected:\n    [    -5.56776436283       2.6940795304      -2.6940795304]\n    [                 0     -3.56958477752      3.56958477752]\n    [                 0                  0 -9.93013661299e-16]\n    [                 0                  0                  0]\nGot:\n    [   -5.56776436283      2.6940795304     -2.6940795304]\n    [                0    -3.56958477752     3.56958477752]\n    [                0                 0 -4.4408920985e-16]\n    [                0                 0                 0]\n**********************************************************************\n```",
    "created_at": "2011-08-24T21:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106150",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">Comment 6</div>

It seems that this patch causes failures in a
non-reproducible way.  Is there some randomness in the algorithm?
For example, I just got this failure on sage.math.washington.edu (a
machine on which I remember the test succeeding):

```
sage -t -long  -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx
**********************************************************************
File
"/mnt/usb1/scratch/buildbot/sage/sage-1/sage_binary/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx",
line 1766:
    sage: Q
Expected:
    [ -0.359210604054   0.569326179705   0.368048420509   0.641385845805]
    [  0.179605302027  -0.144590775798   0.925041158846  -0.301884576418]
    [  0.179605302027  -0.704880032016  0.0774617736597   0.681825307224]
    [  0.898026510134   0.397624633445 -0.0532812182975   0.180566192161]
Got:
    [-0.359210604054  0.569326179705  0.616028985113  0.409076682956]
    [ 0.179605302027 -0.144590775798   0.69237507842 -0.683704756325]
    [ 0.179605302027 -0.704880032016  0.374205463771  0.575201135981]
    [ 0.898026510134  0.397624633445 0.0330954856071  0.185331397251]
**********************************************************************
File
"/mnt/usb1/scratch/buildbot/sage/sage-1/sage_binary/build/sage-4.7.2.alpha2/devel/sage-main/sage/matrix/matrix_double_dense.pyx",
line 1771:
    sage: R
Expected:
    [    -5.56776436283       2.6940795304      -2.6940795304]
    [                 0     -3.56958477752      3.56958477752]
    [                 0                  0 -9.93013661299e-16]
    [                 0                  0                  0]
Got:
    [   -5.56776436283      2.6940795304     -2.6940795304]
    [                0    -3.56958477752     3.56958477752]
    [                0                 0 -4.4408920985e-16]
    [                0                 0                 0]
**********************************************************************
```



---

archive/issue_events_130217.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:56:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130217"
}
```



---

archive/issue_events_130218.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:56:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130218"
}
```



---

archive/issue_comments_106151.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,7 @@\n ```\n \n Besides a bugfix this patch will upgrade the documentation to make it clear how this routine works over the complex numbers.  In particular, `SciPy` routines are using a Hermitian inner product - documentation upgrade will reflect that.\n+\n+**Apply**:\n+1.  [attachment: trac_10795-QR-decomposition-double-dense.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense.patch.gz)\n+2.  [attachment: trac_10795-QR-decomposition-numerical.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-numerical.patch.gz)\n``````\n",
    "created_at": "2011-09-19T03:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106151",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,7 @@
 ```
 
 Besides a bugfix this patch will upgrade the documentation to make it clear how this routine works over the complex numbers.  In particular, `SciPy` routines are using a Hermitian inner product - documentation upgrade will reflect that.
+
+**Apply**:
+1.  [attachment: trac_10795-QR-decomposition-double-dense.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense.patch.gz)
+2.  [attachment: trac_10795-QR-decomposition-numerical.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-numerical.patch.gz)
``````




---

archive/issue_events_130219.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-09-19T03:23:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/good%20first%20issue",
    "label_color": "7057ff",
    "label_name": "good first issue",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130219"
}
```



---

archive/issue_events_130220.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-09-19T03:23:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130220"
}
```



---

archive/issue_events_130221.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-09-19T03:23:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130221"
}
```



---

archive/issue_comments_106152.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\n\"numerical\" patch applies accumulated techniques for these numerical computations and should address the doctest failures.",
    "created_at": "2011-09-19T03:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106152",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:8" align="right">Comment 8</div>

"numerical" patch applies accumulated techniques for these numerical computations and should address the doctest failures.



---

archive/issue_comments_106153.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nSame question on here as on #10791 -- is it appropriate to set this back to positive review (assuming the tests still pass on Rob's machine)?",
    "created_at": "2011-12-04T00:15:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106153",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:9" align="right">Comment 9</div>

Same question on here as on #10791 -- is it appropriate to set this back to positive review (assuming the tests still pass on Rob's machine)?



---

archive/issue_comments_106154.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nApplies and passes all tests on 4.8.alpha3.",
    "created_at": "2011-12-05T05:45:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106154",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:10" align="right">Comment 10</div>

Applies and passes all tests on 4.8.alpha3.



---

archive/issue_comments_106155.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nBased on jdmeyer's response to my question on #10791: the fixing patch looks reasonable and Rob tested it.  I'd test it as well, except I'm currently building python 2.7 and testing it.",
    "created_at": "2011-12-14T04:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106155",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:11" align="right">Comment 11</div>

Based on jdmeyer's response to my question on #10791: the fixing patch looks reasonable and Rob tested it.  I'd test it as well, except I'm currently building python 2.7 and testing it.



---

archive/issue_events_130222.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-12-14T04:09:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130222"
}
```



---

archive/issue_events_130223.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-12-14T04:09:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130223"
}
```



---

archive/issue_comments_106156.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nSorry, I meant jdemeyer's response...",
    "created_at": "2011-12-14T04:20:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106156",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:12" align="right">Comment 12</div>

Sorry, I meant jdemeyer's response...



---

archive/issue_comments_106157.json:
```json
{
    "body": "Merged: **sage-4.8.alpha5**",
    "created_at": "2011-12-17T09:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106157",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.8.alpha5**



---

archive/issue_events_130224.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-17T09:11:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130224"
}
```



---

archive/issue_events_130225.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-17T09:11:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130225"
}
```



---

archive/issue_comments_106158.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nThis sometimes gives a doctest failure:\n\n```\nsage -t -long  -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx\n**********************************************************************\nFile \"/mnt/usb1/scratch/buildbot/sage/sage-1/sage_binary/build/sage-4.8.alpha5/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 2243:\n    sage: Q.round(6).zero_at(10^-6)\nExpected:\n    [-0.359211  0.569326  0.368048  0.641386]\n    [ 0.179605 -0.144591  0.925041 -0.301885]\n    [ 0.179605  -0.70488  0.077462  0.681825]\n    [ 0.898027  0.397625 -0.053281  0.180566]\nGot:\n    [-0.359211  0.569326 -0.631992 -0.383955]\n    [ 0.179605 -0.144591   -0.6643  0.711014]\n    [ 0.179605  -0.70488  -0.39705 -0.559676]\n    [ 0.898027  0.397625 -0.040527 -0.183849]\n**********************************************************************\n```\n\nIt's not clear why it happens.  Because on the same machine I have one Sage build where it works, one where it doesn't with the exact same source, but different gcc version.\n\nDoes this code use any external libraries (ATLAS comes to mind)?",
    "created_at": "2011-12-19T21:30:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106158",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">Comment 14</div>

This sometimes gives a doctest failure:

```
sage -t -long  -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx
**********************************************************************
File "/mnt/usb1/scratch/buildbot/sage/sage-1/sage_binary/build/sage-4.8.alpha5/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 2243:
    sage: Q.round(6).zero_at(10^-6)
Expected:
    [-0.359211  0.569326  0.368048  0.641386]
    [ 0.179605 -0.144591  0.925041 -0.301885]
    [ 0.179605  -0.70488  0.077462  0.681825]
    [ 0.898027  0.397625 -0.053281  0.180566]
Got:
    [-0.359211  0.569326 -0.631992 -0.383955]
    [ 0.179605 -0.144591   -0.6643  0.711014]
    [ 0.179605  -0.70488  -0.39705 -0.559676]
    [ 0.898027  0.397625 -0.040527 -0.183849]
**********************************************************************
```

It's not clear why it happens.  Because on the same machine I have one Sage build where it works, one where it doesn't with the exact same source, but different gcc version.

Does this code use any external libraries (ATLAS comes to mind)?



---

archive/issue_comments_106159.json:
```json
{
    "body": "Changed merged from **sage-4.8.alpha5** to none",
    "created_at": "2011-12-19T21:30:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106159",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.8.alpha5** to none



---

archive/issue_comments_106160.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nOn Fedora 15-64 (flavius):\n\n```\nsage -t -long  -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx\n**********************************************************************\nFile \"/home/buildbot/build/sage/flavius-1/flavius_full/build/sage-4.8.alpha5/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 2243:\n    sage: Q.round(6).zero_at(10^-6)\nExpected:\n    [-0.359211  0.569326  0.368048  0.641386]\n    [ 0.179605 -0.144591  0.925041 -0.301885]\n    [ 0.179605  -0.70488  0.077462  0.681825]\n    [ 0.898027  0.397625 -0.053281  0.180566]\nGot:\n    [-0.359211  0.569326  0.616029  0.409077]\n    [ 0.179605 -0.144591  0.692375 -0.683705]\n    [ 0.179605  -0.70488  0.374205  0.575201]\n    [ 0.898027  0.397625  0.033095  0.185331]\n**********************************************************************\n```",
    "created_at": "2011-12-21T09:24:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106160",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">Comment 15</div>

On Fedora 15-64 (flavius):

```
sage -t -long  -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx
**********************************************************************
File "/home/buildbot/build/sage/flavius-1/flavius_full/build/sage-4.8.alpha5/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 2243:
    sage: Q.round(6).zero_at(10^-6)
Expected:
    [-0.359211  0.569326  0.368048  0.641386]
    [ 0.179605 -0.144591  0.925041 -0.301885]
    [ 0.179605  -0.70488  0.077462  0.681825]
    [ 0.898027  0.397625 -0.053281  0.180566]
Got:
    [-0.359211  0.569326  0.616029  0.409077]
    [ 0.179605 -0.144591  0.692375 -0.683705]
    [ 0.179605  -0.70488  0.374205  0.575201]
    [ 0.898027  0.397625  0.033095  0.185331]
**********************************************************************
```



---

archive/issue_events_130226.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-21T09:24:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130226"
}
```



---

archive/issue_events_130227.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-21T09:24:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130227"
}
```



---

archive/issue_events_130228.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-21T09:24:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130228"
}
```



---

archive/issue_comments_106161.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nThanks, Jeroen.  Sorry for the delay in getting back to this one.\n\nYes, this uses SciPy, which in turn will use ATLAS.  It seems a 2-dimensional eigenspace is being returned with different basis vectors.\n\nThis is mostly a documentation patch, so I think it would be best to make the tests more functional - checking that returned matrices have the desired properties - and less about the actual entries of the matrices.  I'll put that on my list.\n\nRob",
    "created_at": "2011-12-21T19:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106161",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:17" align="right">Comment 17</div>

Thanks, Jeroen.  Sorry for the delay in getting back to this one.

Yes, this uses SciPy, which in turn will use ATLAS.  It seems a 2-dimensional eigenspace is being returned with different basis vectors.

This is mostly a documentation patch, so I think it would be best to make the tests more functional - checking that returned matrices have the desired properties - and less about the actual entries of the matrices.  I'll put that on my list.

Rob



---

archive/issue_comments_106162.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\n*** bump ***",
    "created_at": "2012-01-24T09:15:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106162",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">Comment 18</div>

*** bump ***



---

archive/issue_comments_106163.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nAttachment: **[trac_10795-QR-decomposition-double-dense-v2.patch.gz](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)**\n\n* Jeroen - thanks for the bump.\n* Needed a rebase, so did that and also tidied up a few things. Almost entirely documentation, with one code change.  Will need a new review since the documentation has changed.\n* Doctest failures.  Seems different platforms give different bases for the dimension 2 left kernel of the matrix.  No harm in just removing it and explaining the situation, along with definitive evidence that the result behaves as expected.",
    "created_at": "2012-05-28T02:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106163",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:19" align="right">Comment 19</div>

Attachment: **[trac_10795-QR-decomposition-double-dense-v2.patch.gz](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)**

* Jeroen - thanks for the bump.
* Needed a rebase, so did that and also tidied up a few things. Almost entirely documentation, with one code change.  Will need a new review since the documentation has changed.
* Doctest failures.  Seems different platforms give different bases for the dimension 2 left kernel of the matrix.  No harm in just removing it and explaining the situation, along with definitive evidence that the result behaves as expected.



---

archive/issue_events_130229.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2012-05-28T02:43:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130229"
}
```



---

archive/issue_events_130230.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2012-05-28T02:43:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130230"
}
```



---

archive/issue_comments_106164.json:
```json
{
    "body": "Changed keywords from none to **sd40.5**",
    "created_at": "2012-05-28T02:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106164",
    "user": "https://github.com/rbeezer"
}
```

Changed keywords from none to **sd40.5**



---

archive/issue_comments_106165.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,5 +14,4 @@\n Besides a bugfix this patch will upgrade the documentation to make it clear how this routine works over the complex numbers.  In particular, `SciPy` routines are using a Hermitian inner product - documentation upgrade will reflect that.\n \n **Apply**:\n-1.  [attachment: trac_10795-QR-decomposition-double-dense.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense.patch.gz)\n-2.  [attachment: trac_10795-QR-decomposition-numerical.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-numerical.patch.gz)\n+1.  [attachment: trac_10795-QR-decomposition-double-dense-v2.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)\n``````\n",
    "created_at": "2012-05-28T02:44:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106165",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,5 +14,4 @@
 Besides a bugfix this patch will upgrade the documentation to make it clear how this routine works over the complex numbers.  In particular, `SciPy` routines are using a Hermitian inner product - documentation upgrade will reflect that.
 
 **Apply**:
-1.  [attachment: trac_10795-QR-decomposition-double-dense.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense.patch.gz)
-2.  [attachment: trac_10795-QR-decomposition-numerical.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-numerical.patch.gz)
+1.  [attachment: trac_10795-QR-decomposition-double-dense-v2.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)
``````




---

archive/issue_comments_106166.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nThis looks good, and I think it is reasonable to use the Q as it is.\n\nCould you please go over the patch and correct the ``Q`` and Q to `Q` (and I think in some places R is missing the quotes also). Then I can give this a positive review.",
    "created_at": "2012-05-28T08:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106166",
    "user": "https://github.com/sagetrac-mraum"
}
```

<div id="comment:21" align="right">Comment 21</div>

This looks good, and I think it is reasonable to use the Q as it is.

Could you please go over the patch and correct the ``Q`` and Q to `Q` (and I think in some places R is missing the quotes also). Then I can give this a positive review.



---

archive/issue_comments_106167.json:
```json
{
    "body": "Attachment: **[trac_10795-QR-decomposition-formatting.patch.gz](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-formatting.patch.gz)**",
    "created_at": "2012-05-28T16:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106167",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_10795-QR-decomposition-formatting.patch.gz](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-formatting.patch.gz)**



---

archive/issue_comments_106168.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nDear Martin,\n\nThanks for participating remotely in Sage Days 40.5.  ;-)\n\n\"formatting\" patch is an add-on, so you can see the changes.  I did the \"OUTPUT\" section entirely with math quotes, other than the result objects.  The rest is in code quotes.\n\nUpdated the output description, which needed work.  Added some left kernel explanation for Dan Drake, who was also looking at this here at SD 40.5.\n\nThanks again,\nRob",
    "created_at": "2012-05-28T16:20:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106168",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:22" align="right">Comment 22</div>

Dear Martin,

Thanks for participating remotely in Sage Days 40.5.  ;-)

"formatting" patch is an add-on, so you can see the changes.  I did the "OUTPUT" section entirely with math quotes, other than the result objects.  The rest is in code quotes.

Updated the output description, which needed work.  Added some left kernel explanation for Dan Drake, who was also looking at this here at SD 40.5.

Thanks again,
Rob



---

archive/issue_comments_106169.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,4 @@\n \n **Apply**:\n 1.  [attachment: trac_10795-QR-decomposition-double-dense-v2.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)\n+2.  [attachment: trac_10795-QR-decomposition-formatting.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-formatting.patch.gz)\n``````\n",
    "created_at": "2012-05-28T16:20:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106169",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,4 @@
 
 **Apply**:
 1.  [attachment: trac_10795-QR-decomposition-double-dense-v2.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-double-dense-v2.patch.gz)
+2.  [attachment: trac_10795-QR-decomposition-formatting.patch](https://github.com/sagemath/sage/files/ticket10795/trac_10795-QR-decomposition-formatting.patch.gz)
``````




---

archive/issue_comments_106170.json:
```json
{
    "body": "Changed reviewer from **Martin Raum** to **Martin Raum, Dan Drake**",
    "created_at": "2012-05-28T17:02:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106170",
    "user": "https://github.com/dandrake"
}
```

Changed reviewer from **Martin Raum** to **Martin Raum, Dan Drake**



---

archive/issue_comments_106171.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nThis is a big improvement over what we previously had. Positive review.\n\nJust for the patchbot: apply \ntrac_10795-QR-decomposition-double-dense-v2.patch \ntrac_10795-QR-decomposition-formatting.patch",
    "created_at": "2012-05-28T17:02:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106171",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:23" align="right">Comment 23</div>

This is a big improvement over what we previously had. Positive review.

Just for the patchbot: apply 
trac_10795-QR-decomposition-double-dense-v2.patch 
trac_10795-QR-decomposition-formatting.patch



---

archive/issue_events_130231.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2012-05-28T17:02:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130231"
}
```



---

archive/issue_events_130232.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2012-05-28T17:02:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130232"
}
```



---

archive/issue_events_130233.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T10:22:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130233"
}
```



---

archive/issue_events_130234.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T10:22:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130234"
}
```



---

archive/issue_comments_106172.json:
```json
{
    "body": "Merged: **sage-5.1.beta5**",
    "created_at": "2012-06-18T10:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106172",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.1.beta5**



---

archive/issue_comments_106173.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nAs reported on sage-devel, this gives doctest failures on OS X Lion, see #13140.",
    "created_at": "2012-06-20T06:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106173",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">Comment 25</div>

As reported on sage-devel, this gives doctest failures on OS X Lion, see #13140.



---

archive/issue_comments_106174.json:
```json
{
    "body": "Changed merged from **sage-5.1.beta5** to none",
    "created_at": "2012-06-26T06:50:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106174",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-5.1.beta5** to none



---

archive/issue_comments_106175.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nUnmerging due to #13140.",
    "created_at": "2012-06-26T06:50:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106175",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">Comment 26</div>

Unmerging due to #13140.



---

archive/issue_events_130235.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-26T06:50:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130235"
}
```



---

archive/issue_events_130236.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-26T06:50:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130236"
}
```



---

archive/issue_comments_106176.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nShould this be marked \"positive review\" again, since #13140 is ready?",
    "created_at": "2012-07-11T13:53:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106176",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:27" align="right">Comment 27</div>

Should this be marked "positive review" again, since #13140 is ready?



---

archive/issue_comments_106177.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nReplying to [@jhpalmieri](#comment%3A27):\n> Should this be marked \"positive review\" again, since #13140 is ready?\n\nI think so. If that was the only reason this got unmerged, and that ticket is now fixed, this should again be ready.",
    "created_at": "2012-07-11T14:26:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106177",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:28" align="right">Comment 28</div>

Replying to [@jhpalmieri](#comment%3A27):
> Should this be marked "positive review" again, since #13140 is ready?

I think so. If that was the only reason this got unmerged, and that ticket is now fixed, this should again be ready.



---

archive/issue_events_130237.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2012-07-11T14:26:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130237"
}
```



---

archive/issue_events_130238.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2012-07-11T14:26:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130238"
}
```



---

archive/issue_events_130239.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2012-07-11T14:26:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130239"
}
```



---

archive/issue_comments_106178.json:
```json
{
    "body": "Merged: **sage-5.2.beta1**",
    "created_at": "2012-07-13T11:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10795#issuecomment-106178",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.2.beta1**



---

archive/issue_events_130240.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-13T11:43:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130240"
}
```



---

archive/issue_events_130241.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-13T11:43:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10795",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10795#event-130241"
}
```
