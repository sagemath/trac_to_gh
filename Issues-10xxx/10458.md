# Issue 10458: Doctest framework fails to parse multiline input pasted from sage interactive prompt

archive/issues_010405.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-mvngu"
    ],
    "body": "See [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) for some discussion about the changes proposed by this ticket.\n\nAfter some confusion trying to get a docstring to pass doctesting, I think input line continuations are \"not working\", in that lines directly pasted from the sage interpreter prompt do not pass doctests when single inputs span multiple lines. Pasted below is some terminal output (analysis continued afterwards):\n\n```\nkeshav@esterhazy /opt/sage/devel $ cat test.rst \nEXAMPLE::\n\n    sage: [1,2,3]\n    [1, 2, 3]\n    sage: [1,\n    ....: 2,3\n    ....: ]\n    [1, 2, 3]\n    sage: x=3;\\\n    ....: x\n    3\n\nkeshav@esterhazy /opt/sage/devel $ sage -t -verbose test.rst \nsage -t -verbose \"4.6/devel/test.rst\"                       \nTraceback (most recent call last):\n  File \"/home/keshav/.sage//tmp/.doctest_test.py\", line 60, in <module>\n    runner=runner)\n  File \"/opt/sage/local/bin/sagedoctest.py\", line 54, in testmod_returning_runner\n    runner=runner)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 1819, in testmod_returning_runner\n    for test in finder.find(m, name, globs=globs, extraglobs=extraglobs):\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 839, in find\n    self._find(tests, obj, name, module, source_lines, globs, {})\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 893, in _find\n    globs, seen)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 881, in _find\n    test = self._get_test(obj, name, module, globs, source_lines)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 965, in _get_test\n    filename, lineno)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 594, in get_doctest\n    return DocTest(self.get_examples(string, name), globs,\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 608, in get_examples\n    return [x for x in self.parse(string, name)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 570, in parse\n    self._parse_example(m, name, lineno)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 628, in _parse_example\n    self._check_prompt_blank(source_lines, indent, name, lineno)\n  File \"/opt/sage/local/bin/ncadoctest.py\", line 715, in _check_prompt_blank\n    line[indent:indent+3], line))\nValueError: line 10 of the docstring for __main__.example_0 lacks blank after ...: '    ....: Integer(2),Integer(3)'\n [3.1 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\nsage -t -verbose \"4.6/devel/test.rst\" # Exception from doctest framework\nTotal time for all tests: 3.1 seconds\nkeshav@esterhazy /opt/sage/devel $ sed \"s/\\.\\.\\.:/\\.\\./\" test.rst > test2.rst\nkeshav@esterhazy /opt/sage/devel $ sage -t -verbose test2.rst \nsage -t -verbose \"4.6/devel/test2.rst\"                      \nTrying:\n    set_random_seed(0L)\nExpecting nothing\nok\nTrying:\n    change_warning_output(sys.stdout)\nExpecting nothing\nok\nTrying:\n    [Integer(1),Integer(2),Integer(3)]###line 3:_sage_    >>> [1,2,3]\nExpecting:\n    [1, 2, 3]\nok\nTrying:\n    [Integer(1),###line 5:_sage_    >>> [1,\n    Integer(2),Integer(3)\n    ]\nExpecting:\n    [1, 2, 3]\nok\nTrying:\n    x=Integer(3); x###line 10:_sage_    >>> x=3; x\nExpecting:\n    3\nok\n3 items had no tests:\n    __main__\n    __main__.change_warning_output\n    __main__.warning_function\n1 items passed all tests:\n   5 tests in __main__.example_0\n5 tests in 4 items.\n5 passed and 0 failed.\nTest passed.\n [3.0 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 3.0 seconds\nkeshav@esterhazy /opt/sage/devel $ \n```\n\n\nAfter I replace all \"....: \" with \"... \" using `sed`, everything seems to work fine.\n\nIt seems to me that the problem is that sage is not converting \"....: \" to \"... \", which is what the standard python interactive prompt uses as a prefix for continued input lines. However, the sage prompt uses \"....: \", so IMHO the doctesting framework should allow for this, so that lines from sage sessions can really be just dumped into a docstring without any further editing.\n\nComponent: **doctest coverage**\n\nKeywords: **continuation, multiline input, interactive prompt**\n\nReviewer: **Keshav Kini**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10458_\n\n",
    "closed_at": "2013-02-08T13:22:30Z",
    "created_at": "2010-12-10T09:45:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Doctest framework fails to parse multiline input pasted from sage interactive prompt",
    "type": "issue",
    "updated_at": "2015-09-06T17:00:30Z",
    "url": "https://github.com/sagemath/sage/issues/10458",
    "user": "https://github.com/kini"
}
```
See [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) for some discussion about the changes proposed by this ticket.

After some confusion trying to get a docstring to pass doctesting, I think input line continuations are "not working", in that lines directly pasted from the sage interpreter prompt do not pass doctests when single inputs span multiple lines. Pasted below is some terminal output (analysis continued afterwards):

```
keshav@esterhazy /opt/sage/devel $ cat test.rst 
EXAMPLE::

    sage: [1,2,3]
    [1, 2, 3]
    sage: [1,
    ....: 2,3
    ....: ]
    [1, 2, 3]
    sage: x=3;\
    ....: x
    3

keshav@esterhazy /opt/sage/devel $ sage -t -verbose test.rst 
sage -t -verbose "4.6/devel/test.rst"                       
Traceback (most recent call last):
  File "/home/keshav/.sage//tmp/.doctest_test.py", line 60, in <module>
    runner=runner)
  File "/opt/sage/local/bin/sagedoctest.py", line 54, in testmod_returning_runner
    runner=runner)
  File "/opt/sage/local/bin/ncadoctest.py", line 1819, in testmod_returning_runner
    for test in finder.find(m, name, globs=globs, extraglobs=extraglobs):
  File "/opt/sage/local/bin/ncadoctest.py", line 839, in find
    self._find(tests, obj, name, module, source_lines, globs, {})
  File "/opt/sage/local/bin/ncadoctest.py", line 893, in _find
    globs, seen)
  File "/opt/sage/local/bin/ncadoctest.py", line 881, in _find
    test = self._get_test(obj, name, module, globs, source_lines)
  File "/opt/sage/local/bin/ncadoctest.py", line 965, in _get_test
    filename, lineno)
  File "/opt/sage/local/bin/ncadoctest.py", line 594, in get_doctest
    return DocTest(self.get_examples(string, name), globs,
  File "/opt/sage/local/bin/ncadoctest.py", line 608, in get_examples
    return [x for x in self.parse(string, name)
  File "/opt/sage/local/bin/ncadoctest.py", line 570, in parse
    self._parse_example(m, name, lineno)
  File "/opt/sage/local/bin/ncadoctest.py", line 628, in _parse_example
    self._check_prompt_blank(source_lines, indent, name, lineno)
  File "/opt/sage/local/bin/ncadoctest.py", line 715, in _check_prompt_blank
    line[indent:indent+3], line))
ValueError: line 10 of the docstring for __main__.example_0 lacks blank after ...: '    ....: Integer(2),Integer(3)'
 [3.1 s]
 
----------------------------------------------------------------------
The following tests failed:


sage -t -verbose "4.6/devel/test.rst" # Exception from doctest framework
Total time for all tests: 3.1 seconds
keshav@esterhazy /opt/sage/devel $ sed "s/\.\.\.:/\.\./" test.rst > test2.rst
keshav@esterhazy /opt/sage/devel $ sage -t -verbose test2.rst 
sage -t -verbose "4.6/devel/test2.rst"                      
Trying:
    set_random_seed(0L)
Expecting nothing
ok
Trying:
    change_warning_output(sys.stdout)
Expecting nothing
ok
Trying:
    [Integer(1),Integer(2),Integer(3)]###line 3:_sage_    >>> [1,2,3]
Expecting:
    [1, 2, 3]
ok
Trying:
    [Integer(1),###line 5:_sage_    >>> [1,
    Integer(2),Integer(3)
    ]
Expecting:
    [1, 2, 3]
ok
Trying:
    x=Integer(3); x###line 10:_sage_    >>> x=3; x
Expecting:
    3
ok
3 items had no tests:
    __main__
    __main__.change_warning_output
    __main__.warning_function
1 items passed all tests:
   5 tests in __main__.example_0
5 tests in 4 items.
5 passed and 0 failed.
Test passed.
 [3.0 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 3.0 seconds
keshav@esterhazy /opt/sage/devel $ 
```


After I replace all "....: " with "... " using `sed`, everything seems to work fine.

It seems to me that the problem is that sage is not converting "....: " to "... ", which is what the standard python interactive prompt uses as a prefix for continued input lines. However, the sage prompt uses "....: ", so IMHO the doctesting framework should allow for this, so that lines from sage sessions can really be just dumped into a docstring without any further editing.

Component: **doctest coverage**

Keywords: **continuation, multiline input, interactive prompt**

Reviewer: **Keshav Kini**

_Issue created by migration from https://trac.sagemath.org/ticket/10458_





---

archive/issue_events_135738.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2010-12-10T09:45:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135738"
}
```



---

archive/issue_events_135739.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2010-12-10T09:45:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135739"
}
```



---

archive/issue_events_135740.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2010-12-10T09:45:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135740"
}
```



---

archive/issue_events_135741.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2010-12-10T09:45:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135741"
}
```



---

archive/issue_events_135742.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-12-10T09:45:43Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "subject": "https://github.com/kini",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135742"
}
```



---

archive/issue_comments_098020.json:
```json
{
    "body": "Attachment: **[test.rst.gz](https://github.com/sagemath/sage/files/ticket10458/test.rst.gz)**\n\ntesting docstring",
    "created_at": "2010-12-10T09:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98020",
    "user": "https://github.com/kini"
}
```

Attachment: **[test.rst.gz](https://github.com/sagemath/sage/files/ticket10458/test.rst.gz)**

testing docstring



---

archive/issue_comments_098021.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe Sage command line interface uses IPython, which is responsible for printing line continuation of the form \"...:\". It could be more appropriate to fix this issue upstream in the IPython project. We could send a patch upstream or find out how to get IPython to do line continuation of the form \"...\".",
    "created_at": "2010-12-10T13:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98021",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:1" align="right">comment:1</div>

The Sage command line interface uses IPython, which is responsible for printing line continuation of the form "...:". It could be more appropriate to fix this issue upstream in the IPython project. We could send a patch upstream or find out how to get IPython to do line continuation of the form "...".



---

archive/issue_comments_098022.json:
```json
{
    "body": "patch to make sage recognize \"....:\" continuation line prefixes in doctests",
    "created_at": "2010-12-13T19:11:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98022",
    "user": "https://github.com/kini"
}
```

patch to make sage recognize "....:" continuation line prefixes in doctests



---

archive/issue_comments_098023.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[continuation.patch.gz](https://github.com/sagemath/sage/files/ticket10458/continuation.patch.gz)**\n\nWell, Sage already replaces \"sage:\" with \">>>\", so why not replace \"....:\" with \"...\"? In any case, \"....:\" looks better, since it is the same length as \"sage:\", making the line prefix look more like a separate \"column\", as it should (note that it is \"....:\" with four periods, not \"...:\" as you have written).\n\nHere is a patch which seems to work (at least the attached test.rst passes). What do you think? I'm currently running `sage -testall` with the patch applied to see if anything broke...\n\nI'm new to sage_trac, so forgive me if setting my username as the \"Author\" was not the correct thing to do.",
    "created_at": "2010-12-13T19:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98023",
    "user": "https://github.com/kini"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[continuation.patch.gz](https://github.com/sagemath/sage/files/ticket10458/continuation.patch.gz)**

Well, Sage already replaces "sage:" with ">>>", so why not replace "....:" with "..."? In any case, "....:" looks better, since it is the same length as "sage:", making the line prefix look more like a separate "column", as it should (note that it is "....:" with four periods, not "...:" as you have written).

Here is a patch which seems to work (at least the attached test.rst passes). What do you think? I'm currently running `sage -testall` with the patch applied to see if anything broke...

I'm new to sage_trac, so forgive me if setting my username as the "Author" was not the correct thing to do.



---

archive/issue_comments_098024.json:
```json
{
    "body": "Author: **kini**",
    "created_at": "2010-12-13T19:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98024",
    "user": "https://github.com/kini"
}
```

Author: **kini**



---

archive/issue_comments_098025.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nOK, that didn't take all that long. All tests pass.",
    "created_at": "2010-12-13T20:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98025",
    "user": "https://github.com/kini"
}
```

<div id="comment:3" align="right">comment:3</div>

OK, that didn't take all that long. All tests pass.



---

archive/issue_comments_098026.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+See this [sage-devel](https://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) thread for some discussion about the changes proposed by this ticket.\n+\n After some confusion trying to get a docstring to pass doctesting, I think input line continuations are \"not working\", in that lines directly pasted from the sage interpreter prompt do not pass doctests when single inputs span multiple lines. Pasted below is some terminal output (analysis continued afterwards):\n \n ```\n``````\n",
    "created_at": "2010-12-14T13:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98026",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+See this [sage-devel](https://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) thread for some discussion about the changes proposed by this ticket.
+
 After some confusion trying to get a docstring to pass doctesting, I think input line continuations are "not working", in that lines directly pasted from the sage interpreter prompt do not pass doctests when single inputs span multiple lines. Pasted below is some terminal output (analysis continued afterwards):
 
 ```
``````




---

archive/issue_comments_098027.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis is really a major change to how the doctesting framework behaves. The issue needs to be raised on sage-devel for some discussion.",
    "created_at": "2010-12-14T13:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98027",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:4" align="right">comment:4</div>

This is really a major change to how the doctesting framework behaves. The issue needs to be raised on sage-devel for some discussion.



---

archive/issue_comments_098028.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-See this [sage-devel](https://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) thread for some discussion about the changes proposed by this ticket.\n+See [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) for some discussion about the changes proposed by this ticket.\n \n After some confusion trying to get a docstring to pass doctesting, I think input line continuations are \"not working\", in that lines directly pasted from the sage interpreter prompt do not pass doctests when single inputs span multiple lines. Pasted below is some terminal output (analysis continued afterwards):\n \n``````\n",
    "created_at": "2010-12-14T17:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98028",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-See this [sage-devel](https://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) thread for some discussion about the changes proposed by this ticket.
+See [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/d61251f4ee1429d3) for some discussion about the changes proposed by this ticket.
 
 After some confusion trying to get a docstring to pass doctesting, I think input line continuations are "not working", in that lines directly pasted from the sage interpreter prompt do not pass doctests when single inputs span multiple lines. Pasted below is some terminal output (analysis continued afterwards):
 
``````




---

archive/issue_comments_098029.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nJust fixed the `https://`.\n\nAnd the *Author(s)* field. (This should contain the real name(s).)",
    "created_at": "2010-12-14T17:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98029",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

Just fixed the `https://`.

And the *Author(s)* field. (This should contain the real name(s).)



---

archive/issue_comments_098030.json:
```json
{
    "body": "Changed author from **kini** to **Keshav Kini**",
    "created_at": "2010-12-14T17:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98030",
    "user": "https://github.com/nexttime"
}
```

Changed author from **kini** to **Keshav Kini**



---

archive/issue_comments_098031.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOn topic:\n\nI would consistently add the trailing blank in the prompt substitutions.\n\nAt first glance it seems we currently lose the original (non-preparsed) source code of continuation lines (but also that this isn't a regression).",
    "created_at": "2010-12-14T17:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98031",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:6" align="right">comment:6</div>

On topic:

I would consistently add the trailing blank in the prompt substitutions.

At first glance it seems we currently lose the original (non-preparsed) source code of continuation lines (but also that this isn't a regression).



---

archive/issue_comments_098032.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI'm not sure what you mean by \"consistently add the trailing blank\". The substitutions I patched in do not remove or add any further spaces, so no loss of trailing blanks will occur. If there was a blank after a \"...\", \"....:\", or \"sage:\", there will correspondingly be one after the \"...\", \"...\", or \">>>\" respectively.\n\nYeah, I'm not too sure why the source code disappears from all but the first line.",
    "created_at": "2010-12-15T11:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98032",
    "user": "https://github.com/kini"
}
```

<div id="comment:7" align="right">comment:7</div>

I'm not sure what you mean by "consistently add the trailing blank". The substitutions I patched in do not remove or add any further spaces, so no loss of trailing blanks will occur. If there was a blank after a "...", "....:", or "sage:", there will correspondingly be one after the "...", "...", or ">>>" respectively.

Yeah, I'm not too sure why the source code disappears from all but the first line.



---

archive/issue_comments_098033.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@kini](#comment%3A7):\n> I'm not sure what you mean by \"consistently add the trailing blank\". The substitutions I patched in do not remove or add any further spaces, so no loss of trailing blanks will occur. If there was a blank after a \"...\", \"....:\", or \"sage:\", there will correspondingly be one after the \"...\", \"...\", or \">>>\" respectively.\n\nI mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).",
    "created_at": "2010-12-15T12:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98033",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@kini](#comment%3A7):
> I'm not sure what you mean by "consistently add the trailing blank". The substitutions I patched in do not remove or add any further spaces, so no loss of trailing blanks will occur. If there was a blank after a "...", "....:", or "sage:", there will correspondingly be one after the "...", "...", or ">>>" respectively.

I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).



---

archive/issue_comments_098034.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nP.S.: The patch lacks a ticket number in the commit message.\n\nWe have the convention to prepend (e.g.) `#10458` to the commit messages, and also `trac_10458-` to the filenames of patches we upload.",
    "created_at": "2010-12-15T12:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98034",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:9" align="right">comment:9</div>

P.S.: The patch lacks a ticket number in the commit message.

We have the convention to prepend (e.g.) `#10458` to the commit messages, and also `trac_10458-` to the filenames of patches we upload.



---

archive/issue_comments_098035.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@nexttime](#comment%3A8):\n> I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).\n> \n\nAh, I see. Yes, I left those alone because changing them would change the behavior of the doctesting framework for docstrings containing lines like \"sage:dostuff()\" or \"...dostuff()\". Arguably the doctest framework *shouldn't* be allowing lines like that anyway, but at the moment it does...\n\nReplying to [@nexttime](#comment%3A9):\n> We have the convention to prepend (e.g.) #10458 to the commit messages, and also trac_10458- to the filenames of patches we upload.\n\nOK, I'll fix the patch up then.\n\nBy the way, when changing my patch submission should I be uploading further patch files to layer on top of the one I've got here, or replacing this patch with new patches which diff to 4.6?",
    "created_at": "2010-12-15T12:22:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98035",
    "user": "https://github.com/kini"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@nexttime](#comment%3A8):
> I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).
> 

Ah, I see. Yes, I left those alone because changing them would change the behavior of the doctesting framework for docstrings containing lines like "sage:dostuff()" or "...dostuff()". Arguably the doctest framework *shouldn't* be allowing lines like that anyway, but at the moment it does...

Replying to [@nexttime](#comment%3A9):
> We have the convention to prepend (e.g.) #10458 to the commit messages, and also trac_10458- to the filenames of patches we upload.

OK, I'll fix the patch up then.

By the way, when changing my patch submission should I be uploading further patch files to layer on top of the one I've got here, or replacing this patch with new patches which diff to 4.6?



---

archive/issue_comments_098036.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@kini](#comment%3A10):\n> Replying to [@nexttime](#comment%3A8):\n> > I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).\n> > \n\n> \n> Ah, I see. Yes, I left those alone because changing them would change the behavior of the doctesting framework for docstrings containing lines like \"sage:dostuff()\" or \"...dostuff()\". Arguably the doctest framework *shouldn't* be allowing lines like that anyway, but at the moment it does...\n\nWell, that's just another bug (we should fix here, too).\n\n\n\n\n> By the way, when changing my patch submission should I be uploading further patch files to layer on top of the one I've got here, or replacing this patch with new patches which diff to 4.6?\n\nDepends on the changes. Unfortunately, ordinary trac users cannot *delete* (or rename) attachments, not even their own.\n\nSo you could upload a new patch with `trac_XXXXX-` in the filename, and let someone else delete the old one.\n\nIn general, it's ok to replace your patch with an updated one (sometimes better than having `-v2` etc.); in case you make further changes *rather unrelated* to the previous ones, it's usually better to attach a second patch which is *based on* your previous one. (The attachment comment should then say \"*Apply on top of ...*\".)\n\nAlso, patches should be based on the most recent *developer* version of Sage, i.e. the current alpha or rc. Unless there are merge conflicts (because someone else has changed code near to your changes), it's ok to have it based on some previous official release, too. (But you should always check your patch applies clean to the latest developer release.)\n\nThe attachment comment should contain the name of the repository to which to apply the patch (the \"default\" is the Sage library), in this case \"Scripts repo\", and usually also mentions on what Sage release it is based, since it is not unusual new releases get out before a ticket gets merged.",
    "created_at": "2010-12-15T13:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98036",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@kini](#comment%3A10):
> Replying to [@nexttime](#comment%3A8):
> > I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).
> > 

> 
> Ah, I see. Yes, I left those alone because changing them would change the behavior of the doctesting framework for docstrings containing lines like "sage:dostuff()" or "...dostuff()". Arguably the doctest framework *shouldn't* be allowing lines like that anyway, but at the moment it does...

Well, that's just another bug (we should fix here, too).




> By the way, when changing my patch submission should I be uploading further patch files to layer on top of the one I've got here, or replacing this patch with new patches which diff to 4.6?

Depends on the changes. Unfortunately, ordinary trac users cannot *delete* (or rename) attachments, not even their own.

So you could upload a new patch with `trac_XXXXX-` in the filename, and let someone else delete the old one.

In general, it's ok to replace your patch with an updated one (sometimes better than having `-v2` etc.); in case you make further changes *rather unrelated* to the previous ones, it's usually better to attach a second patch which is *based on* your previous one. (The attachment comment should then say "*Apply on top of ...*".)

Also, patches should be based on the most recent *developer* version of Sage, i.e. the current alpha or rc. Unless there are merge conflicts (because someone else has changed code near to your changes), it's ok to have it based on some previous official release, too. (But you should always check your patch applies clean to the latest developer release.)

The attachment comment should contain the name of the repository to which to apply the patch (the "default" is the Sage library), in this case "Scripts repo", and usually also mentions on what Sage release it is based, since it is not unusual new releases get out before a ticket gets merged.



---

archive/issue_comments_098037.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@nexttime](#comment%3A11):\n> Replying to [@kini](#comment%3A10):\n> > Replying to [@nexttime](#comment%3A8):\n> > > I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).\n> > > \n\n> > \n> > Ah, I see. Yes, I left those alone because changing them would change the behavior of the doctesting framework for docstrings containing lines like \"sage:dostuff()\" or \"...dostuff()\". Arguably the doctest framework *shouldn't* be allowing lines like that anyway, but at the moment it does...\n\n> \n> Well, that's just another bug (we should fix here, too).\n\nI've applied the following patch to (the vanilla) `sage-doctest` and all tests passed (Sage 4.6.1.alpha3, `ptestlong`), so these changes are not only reasonable or desirable, but also safe: ;-)\n\n```diff\ndiff --git a/sage-doctest b/sage-doctest\n--- a/sage-doctest\n+++ b/sage-doctest\n@@ -248,7 +248,7 @@\n     \"\"\"\n     Run the preparser on the documentation string s.\n     This *only* preparses the input lines, i.e., those\n-    that begin with \"sage:\".or with \"...\"\n+    that begin with \"sage: \".or with \"... \"\n     \"\"\"\n     sl = s.lower()\n \n@@ -260,16 +260,16 @@\n     last_prompt_comment = ''\n     \n     for L in s.splitlines():\n-        begin = L.lstrip()[:5]\n+        begin = L.lstrip()[:6]\n         comment = ''\n-        if begin == 'sage:':\n+        if begin == 'sage: ':\n             c, comment = comment_modifier(L)\n             last_prompt_comment = comment\n             line = ''\n             if LONG_TIME in c and not long_time:\n                 L = '\\n'  # extra line so output ignored\n             if RANDOM in c:\n-                L = L.replace('sage:', 'sage: print \"ignore this\"; ') \n+                L = L.replace('sage: ', 'sage: print \"ignore this\"; ') \n             if NOT_TESTED in c:\n                 L = '\\n'   # not tested\n             if NOT_IMPLEMENTED in c:\n@@ -287,10 +287,10 @@\n                 line += '\\n' + ' '*i + 'ignore ...\\n'\n             t.append(line)\n             \n-        elif begin.startswith('...'):\n+        elif begin.startswith('... '):\n             comment = last_prompt_comment\n             i = L.find('.')\n-            t.append(L[:i+3] + sage.misc.preparser.preparse(L[i+3:]))\n+            t.append(L[:i+4] + sage.misc.preparser.preparse(L[i+4:]))\n             \n         else:\n             comment = last_prompt_comment\n@@ -380,11 +380,11 @@\n     j = 0\n     while j < len(F):\n         L = F[j].rstrip()\n-        if L.lstrip()[:5] == 'sage:':\n+        if L.lstrip()[:6] == 'sage: ':\n             while j < len(F) and L.endswith('\\\\') and not L.endswith('\\\\\\\\'):\n                 j += 1\n                 i += 1\n-                L = L[:-1] + F[j].lstrip().lstrip('...').rstrip()\n+                L = L[:-1] + F[j].lstrip().lstrip('... ').rstrip()\n             L += '###_sage\"line %s:_sage_    %s_sage\"'%(i, L.strip())\n         j += 1\n         i += 1\n@@ -478,8 +478,8 @@\n         return  ''\n     s += test_code(os.path.abspath(file_name))\n \n-    # Allow for \"sage:\" instead of the traditional Python \">>>\".\n-    s = s.replace(\"sage:\",\">>>\").replace('_sage\"','')\n+    # Allow for \"sage: \" instead of the traditional Python \">>> \".\n+    s = s.replace(\"sage: \",\">>> \").replace('_sage\"','')\n     \n     return s\n \n@@ -607,8 +607,8 @@\n         cnt += 1\n         if cnt > 1000:\n             break\n-    s = s.replace(':_sage_',':\\n').replace('>>>','sage:')\n-    c = '###line [0-9]*\\n'\n+    s = s.replace(':_sage_',':\\n').replace('>>> ','sage: ')\n+    c = '###line [0-9]+\\n'\n     r = re.compile(c)\n     s = r.sub('\\n',s)\n     if cnt > 0:\n```\n\n(Note that there are more occurrences than I had found in your patch / mentioned above.)\n\nSo I would suggest to [re]base your enhancement (accepting \"`....: `\" line continuations) on these changes, in which case I would attach a proper Mercurial patch for my changes.\n \nAfter that we could address the \"lost original source code of continuation lines\" issue, with another patch, perhaps on a follow-up ticket if you like.",
    "created_at": "2010-12-15T17:02:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98037",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@nexttime](#comment%3A11):
> Replying to [@kini](#comment%3A10):
> > Replying to [@nexttime](#comment%3A8):
> > > I mean add the space to *all* prompt patterns to match (and of course their substitutes), e.g. line 485 (it's in the comment, but not the code) and line 613 (also in the comment on line 251).
> > > 

> > 
> > Ah, I see. Yes, I left those alone because changing them would change the behavior of the doctesting framework for docstrings containing lines like "sage:dostuff()" or "...dostuff()". Arguably the doctest framework *shouldn't* be allowing lines like that anyway, but at the moment it does...

> 
> Well, that's just another bug (we should fix here, too).

I've applied the following patch to (the vanilla) `sage-doctest` and all tests passed (Sage 4.6.1.alpha3, `ptestlong`), so these changes are not only reasonable or desirable, but also safe: ;-)

```diff
diff --git a/sage-doctest b/sage-doctest
--- a/sage-doctest
+++ b/sage-doctest
@@ -248,7 +248,7 @@
     """
     Run the preparser on the documentation string s.
     This *only* preparses the input lines, i.e., those
-    that begin with "sage:".or with "..."
+    that begin with "sage: ".or with "... "
     """
     sl = s.lower()
 
@@ -260,16 +260,16 @@
     last_prompt_comment = ''
     
     for L in s.splitlines():
-        begin = L.lstrip()[:5]
+        begin = L.lstrip()[:6]
         comment = ''
-        if begin == 'sage:':
+        if begin == 'sage: ':
             c, comment = comment_modifier(L)
             last_prompt_comment = comment
             line = ''
             if LONG_TIME in c and not long_time:
                 L = '\n'  # extra line so output ignored
             if RANDOM in c:
-                L = L.replace('sage:', 'sage: print "ignore this"; ') 
+                L = L.replace('sage: ', 'sage: print "ignore this"; ') 
             if NOT_TESTED in c:
                 L = '\n'   # not tested
             if NOT_IMPLEMENTED in c:
@@ -287,10 +287,10 @@
                 line += '\n' + ' '*i + 'ignore ...\n'
             t.append(line)
             
-        elif begin.startswith('...'):
+        elif begin.startswith('... '):
             comment = last_prompt_comment
             i = L.find('.')
-            t.append(L[:i+3] + sage.misc.preparser.preparse(L[i+3:]))
+            t.append(L[:i+4] + sage.misc.preparser.preparse(L[i+4:]))
             
         else:
             comment = last_prompt_comment
@@ -380,11 +380,11 @@
     j = 0
     while j < len(F):
         L = F[j].rstrip()
-        if L.lstrip()[:5] == 'sage:':
+        if L.lstrip()[:6] == 'sage: ':
             while j < len(F) and L.endswith('\\') and not L.endswith('\\\\'):
                 j += 1
                 i += 1
-                L = L[:-1] + F[j].lstrip().lstrip('...').rstrip()
+                L = L[:-1] + F[j].lstrip().lstrip('... ').rstrip()
             L += '###_sage"line %s:_sage_    %s_sage"'%(i, L.strip())
         j += 1
         i += 1
@@ -478,8 +478,8 @@
         return  ''
     s += test_code(os.path.abspath(file_name))
 
-    # Allow for "sage:" instead of the traditional Python ">>>".
-    s = s.replace("sage:",">>>").replace('_sage"','')
+    # Allow for "sage: " instead of the traditional Python ">>> ".
+    s = s.replace("sage: ",">>> ").replace('_sage"','')
     
     return s
 
@@ -607,8 +607,8 @@
         cnt += 1
         if cnt > 1000:
             break
-    s = s.replace(':_sage_',':\n').replace('>>>','sage:')
-    c = '###line [0-9]*\n'
+    s = s.replace(':_sage_',':\n').replace('>>> ','sage: ')
+    c = '###line [0-9]+\n'
     r = re.compile(c)
     s = r.sub('\n',s)
     if cnt > 0:
```

(Note that there are more occurrences than I had found in your patch / mentioned above.)

So I would suggest to [re]base your enhancement (accepting "`....: `" line continuations) on these changes, in which case I would attach a proper Mercurial patch for my changes.
 
After that we could address the "lost original source code of continuation lines" issue, with another patch, perhaps on a follow-up ticket if you like.



---

archive/issue_comments_098038.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nP.S.:\n\nWe already had trouble with lines starting with \"`...`\" interpreted as continuation lines, though they were meant as \"don't care\" *output* of a test (since ellipsis is meant to match anything / partial random output - like e.g. line numbers in tracebacks - of a doctest).",
    "created_at": "2010-12-15T17:08:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98038",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:13" align="right">comment:13</div>

P.S.:

We already had trouble with lines starting with "`...`" interpreted as continuation lines, though they were meant as "don't care" *output* of a test (since ellipsis is meant to match anything / partial random output - like e.g. line numbers in tracebacks - of a doctest).



---

archive/issue_comments_098039.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nping",
    "created_at": "2011-07-18T00:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98039",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

ping



---

archive/issue_comments_098040.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI've added this ticket to the !leet meta-ticket for doctesting issues, #11337. :)",
    "created_at": "2011-07-18T00:54:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98040",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:15" align="right">comment:15</div>

I've added this ticket to the !leet meta-ticket for doctesting issues, #11337. :)



---

archive/issue_comments_098041.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAnother, slightly related issue is that you can't simply copy tracebacks from the `sage:` prompt into docstrings because they look a bit different in the doctest framework (and specific line numbers should of course be avoided in a doctest). This ticket certainly won't fix *that* though.\n\nBut we could document (in the Developer's Guide) that one has to strip the exception type, i.e. anything up to `Traceback`, and replace anything containing filenames or line numbers by `...`, still on another ticket I think.",
    "created_at": "2011-07-23T23:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98041",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

Another, slightly related issue is that you can't simply copy tracebacks from the `sage:` prompt into docstrings because they look a bit different in the doctest framework (and specific line numbers should of course be avoided in a doctest). This ticket certainly won't fix *that* though.

But we could document (in the Developer's Guide) that one has to strip the exception type, i.e. anything up to `Traceback`, and replace anything containing filenames or line numbers by `...`, still on another ticket I think.



---

archive/issue_comments_098042.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@nexttime](#comment%3A16):\n> Another, slightly related issue is that you can't simply copy tracebacks from the `sage:` prompt into docstrings because they look a bit different in the doctest framework (and specific line numbers should of course be avoided in a doctest). This ticket certainly won't fix *that* though.\n\nAnd someplace the first line of a traceback lacks a colon, and a doctest needs one.  And maybe in the notebook it is different yet again?  Or something like that.\n\nSee semi-related, new ticket #11621.  Does it belong in the meta-ticket?  I tripped over it as part of doctesting Sage examples placed into a textbook where I need to be careful about long lines for the printed version.",
    "created_at": "2011-07-24T18:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98042",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@nexttime](#comment%3A16):
> Another, slightly related issue is that you can't simply copy tracebacks from the `sage:` prompt into docstrings because they look a bit different in the doctest framework (and specific line numbers should of course be avoided in a doctest). This ticket certainly won't fix *that* though.

And someplace the first line of a traceback lacks a colon, and a doctest needs one.  And maybe in the notebook it is different yet again?  Or something like that.

See semi-related, new ticket #11621.  Does it belong in the meta-ticket?  I tripped over it as part of doctesting Sage examples placed into a textbook where I need to be careful about long lines for the printed version.



---

archive/issue_comments_098043.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@rbeezer](#comment%3A17):\n> See semi-related, new ticket #11621.  Does it belong in the meta-ticket?\n\nAs it only deals with the preparser and not the doctesting framework, I don't think so.\n\n> I tripped over it as part of doctesting Sage examples placed into a textbook where I need to be careful about long lines for the printed version.\n\nRelease date / deadline? ;-)",
    "created_at": "2011-07-25T04:56:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98043",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@rbeezer](#comment%3A17):
> See semi-related, new ticket #11621.  Does it belong in the meta-ticket?

As it only deals with the preparser and not the doctesting framework, I don't think so.

> I tripped over it as part of doctesting Sage examples placed into a textbook where I need to be careful about long lines for the printed version.

Release date / deadline? ;-)



---

archive/issue_comments_098044.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@nexttime](#comment%3A18):\n> Release date / deadline? ;-)\n\nOpen source.  So, no deadline.\n\nRelease date: maybe within the week.  Watch sage-edu/sage-devel.\n\nI solved my immediate problem by breaking the input into pieces.  Not as pretty as it could be, but not bad either.\n\nRob",
    "created_at": "2011-07-25T07:33:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98044",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@nexttime](#comment%3A18):
> Release date / deadline? ;-)

Open source.  So, no deadline.

Release date: maybe within the week.  Watch sage-edu/sage-devel.

I solved my immediate problem by breaking the input into pieces.  Not as pretty as it could be, but not bad either.

Rob



---

archive/issue_comments_098045.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI think this is fixed by #12415.",
    "created_at": "2013-02-05T19:30:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98045",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

I think this is fixed by #12415.



---

archive/issue_comments_098046.json:
```json
{
    "body": "Reviewer: **Keshav Kini**",
    "created_at": "2013-02-05T19:30:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98046",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Keshav Kini**



---

archive/issue_events_135743.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-05T19:30:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135743"
}
```



---

archive/issue_comments_098047.json:
```json
{
    "body": "Changed author from **Keshav Kini** to none",
    "created_at": "2013-02-05T19:30:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98047",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Keshav Kini** to none



---

archive/issue_events_135744.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-05T19:31:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135744"
}
```



---

archive/issue_events_135745.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-05T19:31:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135745"
}
```



---

archive/issue_comments_098048.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAwesome! :) A bit sad that the first patch I ever wrote for Sage is going to be thrown away, but it was a mere bandaid compared to #12415's cyborgization :P",
    "created_at": "2013-02-05T19:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98048",
    "user": "https://github.com/kini"
}
```

<div id="comment:22" align="right">comment:22</div>

Awesome! :) A bit sad that the first patch I ever wrote for Sage is going to be thrown away, but it was a mere bandaid compared to #12415's cyborgization :P



---

archive/issue_events_135746.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-08T13:22:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135746"
}
```



---

archive/issue_events_135747.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-08T13:22:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "c6c6c6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135747"
}
```



---

archive/issue_events_135748.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-08T13:22:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135748"
}
```



---

archive/issue_events_135749.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-08T13:22:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10458#event-135749"
}
```



---

archive/issue_comments_098049.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jdemeyer](#comment%3A20):\n> I think this is fixed by #12415.\n\nSee also #14512.",
    "created_at": "2013-05-09T00:48:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98049",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jdemeyer](#comment%3A20):
> I think this is fixed by #12415.

See also #14512.



---

archive/issue_comments_098050.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,13 +44,13 @@\n   File \"/opt/sage/local/bin/ncadoctest.py\", line 715, in _check_prompt_blank\n     line[indent:indent+3], line))\n ValueError: line 10 of the docstring for __main__.example_0 lacks blank after ...: '    ....: Integer(2),Integer(3)'\n-\t [3.1 s]\n+ [3.1 s]\n  \n ----------------------------------------------------------------------\n The following tests failed:\n \n \n-\tsage -t -verbose \"4.6/devel/test.rst\" # Exception from doctest framework\n+sage -t -verbose \"4.6/devel/test.rst\" # Exception from doctest framework\n Total time for all tests: 3.1 seconds\n keshav@esterhazy /opt/sage/devel $ sed \"s/\\.\\.\\.:/\\.\\./\" test.rst > test2.rst\n keshav@esterhazy /opt/sage/devel $ sage -t -verbose test2.rst \n@@ -89,7 +89,7 @@\n 5 tests in 4 items.\n 5 passed and 0 failed.\n Test passed.\n-\t [3.0 s]\n+ [3.0 s]\n  \n ----------------------------------------------------------------------\n All tests passed!\n``````\n",
    "created_at": "2015-09-06T17:00:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10458",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10458#issuecomment-98050",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,13 +44,13 @@
   File "/opt/sage/local/bin/ncadoctest.py", line 715, in _check_prompt_blank
     line[indent:indent+3], line))
 ValueError: line 10 of the docstring for __main__.example_0 lacks blank after ...: '    ....: Integer(2),Integer(3)'
-	 [3.1 s]
+ [3.1 s]
  
 ----------------------------------------------------------------------
 The following tests failed:
 
 
-	sage -t -verbose "4.6/devel/test.rst" # Exception from doctest framework
+sage -t -verbose "4.6/devel/test.rst" # Exception from doctest framework
 Total time for all tests: 3.1 seconds
 keshav@esterhazy /opt/sage/devel $ sed "s/\.\.\.:/\.\./" test.rst > test2.rst
 keshav@esterhazy /opt/sage/devel $ sage -t -verbose test2.rst 
@@ -89,7 +89,7 @@
 5 tests in 4 items.
 5 passed and 0 failed.
 Test passed.
-	 [3.0 s]
+ [3.0 s]
  
 ----------------------------------------------------------------------
 All tests passed!
``````

