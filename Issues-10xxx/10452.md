# Issue 10452: Round values returned by CPLEX when the variable's type is integer/binary

archive/issues_010452.json:
```json
{
    "body": "Assignee: @nathanncohen\n\nCPLEX is a funny guy who does not understand that 1.546846847 e-17 is not a proper value for a binary variable. As I often forgot to replace test ``== 1`` by ``> .5`` and as it is anyway what CPLEX should return, this patch rounds values given to the variables before returning them when it is sound. It amounts to copying two lines from ``is_variable_continuous`` in the ``get_variable_value`` method, and doctests pass better with CPLEX (which is not the case with the new patch for TSP #10497)\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/10505\n\n",
    "closed_at": "2011-10-18T20:14:42Z",
    "created_at": "2010-12-20T16:13:04Z",
    "labels": [
        "component: linear programming",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Round values returned by CPLEX when the variable's type is integer/binary",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10452",
    "user": "https://github.com/nathanncohen"
}
```
Assignee: @nathanncohen

CPLEX is a funny guy who does not understand that 1.546846847 e-17 is not a proper value for a binary variable. As I often forgot to replace test ``== 1`` by ``> .5`` and as it is anyway what CPLEX should return, this patch rounds values given to the variables before returning them when it is sound. It amounts to copying two lines from ``is_variable_continuous`` in the ``get_variable_value`` method, and doctests pass better with CPLEX (which is not the case with the new patch for TSP #10497)

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/10505





---

archive/issue_comments_107684.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-12-20T16:14:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107684",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_107685.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-10-14T09:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107685",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_107686.json:
```json
{
    "body": "The returned value is not of integer type (2.0 instead of 2). Should we cast it to Integer, or int, or leave it like that ?",
    "created_at": "2011-10-14T09:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107686",
    "user": "https://github.com/dcoudert"
}
```

The returned value is not of integer type (2.0 instead of 2). Should we cast it to Integer, or int, or leave it like that ?



---

archive/issue_comments_107687.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-10-14T09:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107687",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_107688.json:
```json
{
    "body": "Oops... You are right !\n\nThe thing is that casting it to Integer would mean having to create a new object for each returned variable, even when using the code from the C level. And casting it to a Python int would mean that you can not divide is safely anymore (1/2 becomes 0).\n\nWhat do you think of letting it stay like that ? The goal was really to be able to test (variable == 0) without fearing that variable (declared as binary in the LP) would have 0.0000001 as a value.\n\nWe can still *really* cast the values to integer in situations where the user expect it, like in #11367 which just got reviewed.\n\nWhile I was at it, though, I noticed a mistake in the documentation generated from the mip.pyx file : the first line contained a math equation which was not properly written.. I just updated the patch to fix it ! `:-)`\n\nNathann",
    "created_at": "2011-10-14T09:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107688",
    "user": "https://github.com/nathanncohen"
}
```

Oops... You are right !

The thing is that casting it to Integer would mean having to create a new object for each returned variable, even when using the code from the C level. And casting it to a Python int would mean that you can not divide is safely anymore (1/2 becomes 0).

What do you think of letting it stay like that ? The goal was really to be able to test (variable == 0) without fearing that variable (declared as binary in the LP) would have 0.0000001 as a value.

We can still *really* cast the values to integer in situations where the user expect it, like in #11367 which just got reviewed.

While I was at it, though, I noticed a mistake in the documentation generated from the mip.pyx file : the first line contained a math equation which was not properly written.. I just updated the patch to fix it ! `:-)`

Nathann



---

archive/issue_comments_107689.json:
```json
{
    "body": "OK, you can live it like this, but it should be clearly indicated in the documentation to avoid confusion. Users can cast afterwards depending of their needs.\n\nConcerning the documentation, I don't see any improvement. In fact, most of the math equations are not properly displayed in the page. I see only the latex code (e.g., w_i \\in \\mathbb{Z}).",
    "created_at": "2011-10-14T09:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107689",
    "user": "https://github.com/dcoudert"
}
```

OK, you can live it like this, but it should be clearly indicated in the documentation to avoid confusion. Users can cast afterwards depending of their needs.

Concerning the documentation, I don't see any improvement. In fact, most of the math equations are not properly displayed in the page. I see only the latex code (e.g., w_i \in \mathbb{Z}).



---

archive/issue_comments_107690.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-10-14T09:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107690",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_107691.json:
```json
{
    "body": "> OK, you can live it like this, but it should be clearly indicated in the documentation to avoid confusion. Users can cast afterwards depending of their needs.\n\n\nPatch updated. I added a note in the documentation of ``MixedIntegerLinearProgram.get_values``.\n\n> Concerning the documentation, I don't see any improvement. In fact, most of the math equations are not properly displayed in the page. I see only the latex code (e.g., w_i \\in \\mathbb{Z}). \n\n\nAre you talking of the HTML documentation ? The LaTeX formula will of course never appear in the console ! In my version of it, I find nothing wrong with the others formulas contained in this page. `O_o`\n\nNathann",
    "created_at": "2011-10-14T10:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107691",
    "user": "https://github.com/nathanncohen"
}
```

> OK, you can live it like this, but it should be clearly indicated in the documentation to avoid confusion. Users can cast afterwards depending of their needs.


Patch updated. I added a note in the documentation of ``MixedIntegerLinearProgram.get_values``.

> Concerning the documentation, I don't see any improvement. In fact, most of the math equations are not properly displayed in the page. I see only the latex code (e.g., w_i \in \mathbb{Z}). 


Are you talking of the HTML documentation ? The LaTeX formula will of course never appear in the console ! In my version of it, I find nothing wrong with the others formulas contained in this page. `O_o`

Nathann



---

archive/issue_comments_107692.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-10-14T10:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107692",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_107693.json:
```json
{
    "body": "Attachment [trac_10505.patch](tarball://root/attachments/some-uuid/ticket10505/trac_10505.patch) by @dcoudert created at 2011-10-14 11:43:35\n\nI'm now satisfied with this patch.",
    "created_at": "2011-10-14T11:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107693",
    "user": "https://github.com/dcoudert"
}
```

Attachment [trac_10505.patch](tarball://root/attachments/some-uuid/ticket10505/trac_10505.patch) by @dcoudert created at 2011-10-14 11:43:35

I'm now satisfied with this patch.



---

archive/issue_comments_107694.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-10-14T11:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107694",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_026934.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-18T20:14:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10452#event-26934"
}
```



---

archive/issue_comments_107695.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-10-18T20:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107695",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_107696.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10452#issuecomment-107696",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_events_026935.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:16:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10452",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10452#event-26935"
}
```
