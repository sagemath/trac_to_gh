# Issue 10303: clean up sage-check-64 and use of SAGE64

archive/issues_010302.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-GeorgSWeber"
    ],
    "body": "There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like \"sage -hg\": \n\n``` \n$ sage -hg status \nDetected SAGE64 flag \nBuilding Sage on OS X in 64-bit mode \n``` \nThis is annoying on its own, but it also produces incorrect information when running \"sage -pkg\": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted. \n\nThe attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. \n\n---\n\nI've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought.\n\n---\n\nFollow-up ticket: #11077.\n\n---\n\nInstructions:\n\n- apply [attachment: trac_10303-scripts-SAGE64.v5.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v5.patch.gz) to the scripts repo.\n- apply [attachment: trac_10303-root-repo.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-root-repo.patch.gz) to the root repo.\n- apply [attachment: 10303-add-sage-check-64-dot-hgignore.patch](https://github.com/sagemath/sage/files/ticket10303/10303-add-sage-check-64-dot-hgignore.patch.gz) to the spkg/base repo.\n\nThis depends on the patch at #9960.  \n\nCC:  @sagetrac-drkirkby @nexttime @qed777\n\nKeywords: **64**\n\nReviewer: **John Palmieri, David Kirkby, Leif Leonhardy**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10303_\n\n",
    "closed_at": "2012-08-23T13:05:54Z",
    "created_at": "2010-11-21T00:05:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "clean up sage-check-64 and use of SAGE64",
    "type": "issue",
    "updated_at": "2012-08-23T13:05:54Z",
    "url": "https://github.com/sagemath/sage/issues/10303",
    "user": "https://github.com/jhpalmieri"
}
```
There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like "sage -hg": 

``` 
$ sage -hg status 
Detected SAGE64 flag 
Building Sage on OS X in 64-bit mode 
``` 
This is annoying on its own, but it also produces incorrect information when running "sage -pkg": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted. 

The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. 

---

I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought.

---

Follow-up ticket: #11077.

---

Instructions:

- apply [attachment: trac_10303-scripts-SAGE64.v5.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v5.patch.gz) to the scripts repo.
- apply [attachment: trac_10303-root-repo.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-root-repo.patch.gz) to the root repo.
- apply [attachment: 10303-add-sage-check-64-dot-hgignore.patch](https://github.com/sagemath/sage/files/ticket10303/10303-add-sage-check-64-dot-hgignore.patch.gz) to the spkg/base repo.

This depends on the patch at #9960.  

CC:  @sagetrac-drkirkby @nexttime @qed777

Keywords: **64**

Reviewer: **John Palmieri, David Kirkby, Leif Leonhardy**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/10303_





---

archive/issue_events_134079.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-21T00:05:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "milestone_number": null,
    "milestone_title": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134079"
}
```



---

archive/issue_events_134080.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-21T00:05:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134080"
}
```



---

archive/issue_events_134081.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-21T00:05:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134081"
}
```



---

archive/issue_events_134082.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-21T00:05:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134082"
}
```



---

archive/issue_events_134083.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2010-11-21T00:05:21Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "subject": "https://github.com/jhpalmieri",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134083"
}
```



---

archive/issue_comments_096456.json:
```json
{
    "body": "scripts repo",
    "created_at": "2010-11-21T00:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96456",
    "user": "https://github.com/jhpalmieri"
}
```

scripts repo



---

archive/issue_events_134084.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-21T00:43:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134084"
}
```



---

archive/issue_comments_096457.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n \n Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build.  This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted.\n \n-The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.\n+The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.  Since it gets run by sage-spkg, it is now included in spkg/base.\n \n ---\n \n``````\n",
    "created_at": "2010-11-21T00:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96457",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 
 Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build.  This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted.
 
-The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.
+The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.  Since it gets run by sage-spkg, it is now included in spkg/base.
 
 ---
 
``````




---

archive/issue_comments_096458.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_10303-scripts-SAGE64.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.patch.gz)**",
    "created_at": "2010-11-21T00:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96458",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_10303-scripts-SAGE64.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.patch.gz)**



---

archive/issue_comments_096459.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHere is another choice, the \"v2\" patch.  This one writes either \"yes\" or \"no\" to the file sage-64.txt.  If SAGE64 is unset, then it gets its value from this file.  If it is set and the setting is not compatible with the file, then a warning is printed and the user is asked if they want to continue.  This requires modifying the file spkg/install, so that it can run this check before attempting to install any spkgs.  (Otherwise, it behaves badly with parallel building.)  So to use v2, apply that patch and also patch the file spkg/install with the attached patch.",
    "created_at": "2010-11-21T05:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96459",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

Here is another choice, the "v2" patch.  This one writes either "yes" or "no" to the file sage-64.txt.  If SAGE64 is unset, then it gets its value from this file.  If it is set and the setting is not compatible with the file, then a warning is printed and the user is asked if they want to continue.  This requires modifying the file spkg/install, so that it can run this check before attempting to install any spkgs.  (Otherwise, it behaves badly with parallel building.)  So to use v2, apply that patch and also patch the file spkg/install with the attached patch.



---

archive/issue_comments_096460.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWell, not [my style](https://github.com/sagemath/sage/issues/10138#comment:9)... ;-) (which is a bit more compact)\n\nI wonder if the sanity check on `SAGE64`'s setting should be in `sage-env`. (I assume it's still there, not visible in the patch.)\n\nNobody should call `sage-check-64` directly, but therefore I would\n* test if `SAGE64` is either `yes`, `no` or empty **there** (otherwise one could call / source it with e.g. `SAGE64=foo`),\n* make sure that `SAGE_LOCAL` is defined,\n* prevent running it directly by substituting\n\n```sh\n#!/usr/bin/env bash\n```\n   by\n\n```sh\n#!/this/file/should/be/sourced\n```\n   (and/or perhaps `chmod -x`).\n\nI think we could drop \"uname-specific\" messages (and it's unlikely that `SAGE64` will work on 32-bit hosts).\n\nNote that `SAGE64=yes` is (currently) not supported (or doesn't make sense) on anything but MacOS X and [Open]Solaris; this isn't clear from the `echo` in `sage-env` (which is \"commented out\" IIRC, but people could read it; also, *\"Creating SAGE_LOCAL/lib/sage-64.txt since it does not exist.\"* might be equally confusing to people building on e.g. 32-bit Linux).\n\n---\n\nThe name of the variable (and the \"flag\" file) is odd anyway (it should IMHO be `SAGE_FORCE_64BIT_BUILD`), and there's [currently] no (analogous) way to force a 32-bit build on systems that default to 64-bit...",
    "created_at": "2010-11-21T19:33:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96460",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:3" align="right">comment:3</div>

Well, not [my style](https://github.com/sagemath/sage/issues/10138#comment:9)... ;-) (which is a bit more compact)

I wonder if the sanity check on `SAGE64`'s setting should be in `sage-env`. (I assume it's still there, not visible in the patch.)

Nobody should call `sage-check-64` directly, but therefore I would
* test if `SAGE64` is either `yes`, `no` or empty **there** (otherwise one could call / source it with e.g. `SAGE64=foo`),
* make sure that `SAGE_LOCAL` is defined,
* prevent running it directly by substituting

```sh
#!/usr/bin/env bash
```
   by

```sh
#!/this/file/should/be/sourced
```
   (and/or perhaps `chmod -x`).

I think we could drop "uname-specific" messages (and it's unlikely that `SAGE64` will work on 32-bit hosts).

Note that `SAGE64=yes` is (currently) not supported (or doesn't make sense) on anything but MacOS X and [Open]Solaris; this isn't clear from the `echo` in `sage-env` (which is "commented out" IIRC, but people could read it; also, *"Creating SAGE_LOCAL/lib/sage-64.txt since it does not exist."* might be equally confusing to people building on e.g. 32-bit Linux).

---

The name of the variable (and the "flag" file) is odd anyway (it should IMHO be `SAGE_FORCE_64BIT_BUILD`), and there's [currently] no (analogous) way to force a 32-bit build on systems that default to 64-bit...



---

archive/issue_comments_096461.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@nexttime](#comment:3):\n> Well, not [my style](https://github.com/sagemath/sage/issues/10138#comment:9)... ;-) (which is a bit more compact)\n> \n> I wonder if the sanity check on `SAGE64`'s setting should be in `sage-env`. (I assume it's still there, not visible in the patch.)\n\nIt's still there, but it makes sense to move it to sage-check-64.\n\n> Nobody should call `sage-check-64` directly, but therefore I would\n> * test if `SAGE64` is either `yes`, `no` or empty **there** (otherwise one could call / source it with e.g. `SAGE64=foo`),\n> * make sure that `SAGE_LOCAL` is defined,\n>   * prevent running it directly by substituting\n\n\n```sh\n#!/usr/bin/env bash\n```\n>    by\n\n\n```sh\n#!/this/file/should/be/sourced\n```\n>    (and/or perhaps `chmod -x`).\n\nOkay, we can do these.\n\n> I think we could drop \"uname-specific\" messages (and it's unlikely that `SAGE64` will work on 32-bit hosts).\n> \n> Note that `SAGE64=yes` is (currently) not supported (or doesn't make sense) on anything but MacOS X and [Open]Solaris; \n\nIf SAGE64 is set to \"yes\", then the compiler flag \"-m64\" is added by certain spkgs with no check on the platform.  Is it the case this flag has no effect except on OS X and Solaris?\n\n> The name of the variable (and the \"flag\" file) is odd anyway (it should IMHO be `SAGE_FORCE_64BIT_BUILD`), and there's [currently] no (analogous) way to force a 32-bit build on systems that default to 64-bit...\n\nI don't think we can change the name of the variable, but the flag file could be renamed, since it's only used in sage-check-64.  Any suggestions?",
    "created_at": "2010-11-21T20:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96461",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@nexttime](#comment:3):
> Well, not [my style](https://github.com/sagemath/sage/issues/10138#comment:9)... ;-) (which is a bit more compact)
> 
> I wonder if the sanity check on `SAGE64`'s setting should be in `sage-env`. (I assume it's still there, not visible in the patch.)

It's still there, but it makes sense to move it to sage-check-64.

> Nobody should call `sage-check-64` directly, but therefore I would
> * test if `SAGE64` is either `yes`, `no` or empty **there** (otherwise one could call / source it with e.g. `SAGE64=foo`),
> * make sure that `SAGE_LOCAL` is defined,
>   * prevent running it directly by substituting


```sh
#!/usr/bin/env bash
```
>    by


```sh
#!/this/file/should/be/sourced
```
>    (and/or perhaps `chmod -x`).

Okay, we can do these.

> I think we could drop "uname-specific" messages (and it's unlikely that `SAGE64` will work on 32-bit hosts).
> 
> Note that `SAGE64=yes` is (currently) not supported (or doesn't make sense) on anything but MacOS X and [Open]Solaris; 

If SAGE64 is set to "yes", then the compiler flag "-m64" is added by certain spkgs with no check on the platform.  Is it the case this flag has no effect except on OS X and Solaris?

> The name of the variable (and the "flag" file) is odd anyway (it should IMHO be `SAGE_FORCE_64BIT_BUILD`), and there's [currently] no (analogous) way to force a 32-bit build on systems that default to 64-bit...

I don't think we can change the name of the variable, but the flag file could be renamed, since it's only used in sage-check-64.  Any suggestions?



---

archive/issue_comments_096462.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@jhpalmieri](#comment:4):\n> Replying to [@nexttime](#comment:3):\n> > I think we could drop \"uname-specific\" messages (and it's unlikely that `SAGE64` will work on 32-bit hosts).\n> > \n> > Note that `SAGE64=yes` is (currently) not supported (or doesn't make sense) on anything but MacOS X and [Open]Solaris; \n\n> \n> If SAGE64 is set to \"yes\", then the compiler flag \"-m64\" is added by certain spkgs with no check on the platform.  Is it the case this flag has no effect except on OS X and Solaris?\n\nNo. I think we should check the platform once, in `sage-check-64`. While `-m64` is superfluous on systems defaulting to 64-bit builds (with `gcc`), it's illegal on typical 32-bit systems.\n\n`SAGE64=yes` should simply only be used on 64-bit MacOS X and [Open]Solaris; we could give an error message on 32-bit systems, I think no need to give a warning on 64-bit Linuces.\n\n\n\n\n> > The name of the variable (and the \"flag\" file) is odd anyway (it should IMHO be `SAGE_FORCE_64BIT_BUILD`), and there's [currently] no (analogous) way to force a 32-bit build on systems that default to 64-bit...\n\n> \n> I don't think we can change the name of the variable, but the flag file could be renamed, since it's only used in sage-check-64.  Any suggestions?\n\nWell, we could use a new variable name but keep \"backwards compatibility\".\n\n`sage-build-arch.txt` (or `-abi`) is perhaps inappropriate for a file containing \"yes\" or \"no\"... ;-)\n\nJust omit the actual filename from the message? (*\"Recording build ABI...\"*) At least if `SAGE64=no`?\n\nChanging the contents of the file (e.g. \"32\"/\"64\" instead of \"no\"/\"yes\") is of course another option, but would currently only complicate the tests. (Would make sense if we introduce `SAGE_BUILD_ABI` and set `SAGE64` accordingly, or the other way around if `SAGE64` is set instead of that. Then we could rename the script to e.g. `sage-check-abi` as well...)",
    "created_at": "2010-11-21T21:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96462",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@jhpalmieri](#comment:4):
> Replying to [@nexttime](#comment:3):
> > I think we could drop "uname-specific" messages (and it's unlikely that `SAGE64` will work on 32-bit hosts).
> > 
> > Note that `SAGE64=yes` is (currently) not supported (or doesn't make sense) on anything but MacOS X and [Open]Solaris; 

> 
> If SAGE64 is set to "yes", then the compiler flag "-m64" is added by certain spkgs with no check on the platform.  Is it the case this flag has no effect except on OS X and Solaris?

No. I think we should check the platform once, in `sage-check-64`. While `-m64` is superfluous on systems defaulting to 64-bit builds (with `gcc`), it's illegal on typical 32-bit systems.

`SAGE64=yes` should simply only be used on 64-bit MacOS X and [Open]Solaris; we could give an error message on 32-bit systems, I think no need to give a warning on 64-bit Linuces.




> > The name of the variable (and the "flag" file) is odd anyway (it should IMHO be `SAGE_FORCE_64BIT_BUILD`), and there's [currently] no (analogous) way to force a 32-bit build on systems that default to 64-bit...

> 
> I don't think we can change the name of the variable, but the flag file could be renamed, since it's only used in sage-check-64.  Any suggestions?

Well, we could use a new variable name but keep "backwards compatibility".

`sage-build-arch.txt` (or `-abi`) is perhaps inappropriate for a file containing "yes" or "no"... ;-)

Just omit the actual filename from the message? (*"Recording build ABI..."*) At least if `SAGE64=no`?

Changing the contents of the file (e.g. "32"/"64" instead of "no"/"yes") is of course another option, but would currently only complicate the tests. (Would make sense if we introduce `SAGE_BUILD_ABI` and set `SAGE64` accordingly, or the other way around if `SAGE64` is set instead of that. Then we could rename the script to e.g. `sage-check-abi` as well...)



---

archive/issue_comments_096463.json:
```json
{
    "body": "the file spkg/install -- for use with the 'v2' patch",
    "created_at": "2010-11-22T00:10:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96463",
    "user": "https://github.com/jhpalmieri"
}
```

the file spkg/install -- for use with the 'v2' patch



---

archive/issue_comments_096464.json:
```json
{
    "body": "Attachment: **[trac_10303-install.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-install.gz)**\n\ndiff between old spkg/install and new one",
    "created_at": "2010-11-22T00:11:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96464",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_10303-install.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-install.gz)**

diff between old spkg/install and new one



---

archive/issue_comments_096465.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[trac_10303-install.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-install.patch.gz)**\n\nHere's a new version of the \"v2\" patch.  I haven't changed the variable or the file name, but this does check whether SAGE64 is set to anything except \"no\" on a non-OS X or Solaris machine, and gives an error in that case.  I'm checking the return code for sage-check-64 where it's called.\n\n> SAGE64=yes should simply only be used on 64-bit MacOS X and [Open]Solaris; we could give an error message on 32-bit systems, I think no need to give a warning on 64-bit Linuces.\n\nI don't know how to check for 32-bit systems in a shell script, so I'm not doing this, just checking for \"Darwin\" or \"SunOS\".",
    "created_at": "2010-11-22T00:14:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96465",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[trac_10303-install.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-install.patch.gz)**

Here's a new version of the "v2" patch.  I haven't changed the variable or the file name, but this does check whether SAGE64 is set to anything except "no" on a non-OS X or Solaris machine, and gives an error in that case.  I'm checking the return code for sage-check-64 where it's called.

> SAGE64=yes should simply only be used on 64-bit MacOS X and [Open]Solaris; we could give an error message on 32-bit systems, I think no need to give a warning on 64-bit Linuces.

I don't know how to check for 32-bit systems in a shell script, so I'm not doing this, just checking for "Darwin" or "SunOS".



---

archive/issue_comments_096466.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jhpalmieri](#comment:6):\n> Here's a new version of the \"v2\" patch.\n\nHmmm, now we get *\"32-bit build, so writing 'no' to SAGE_LOCAL/lib/sage-64.txt.\"* on every non-OS X / non-[Open]Solaris system...\n\n(And if `SAGE64` is not set, we usually read the flag file twice.)\n\n\n\n\n\n> > SAGE64=yes should simply only be used on 64-bit MacOS X and [Open]Solaris; we could give an error message on 32-bit systems, I think no need to give a warning on 64-bit Linuces.\n\n> \n> I don't know how to check for 32-bit systems in a shell script, so I'm not doing this, just checking for \"Darwin\" or \"SunOS\".\n\nYou could check if <code>... \\`uname -m\\` in i[3456]86|ppc) ...</code>, Dave will know what in addition to look for on [Open]Solaris (e.g. \"x86\") and especially SPARC.\n\n(On Darwin PPCs, `uname -m` might report more weird \"processor names\" like \"Power Macintosh\", but that's IMHO a minor issue since the build would fail later on 32-bit OSs anyway if we pass `-m64`. We do not support 64-bit builds on PowerPCs at all, so looking for `i[3456]86|ppc*|[Pp]ower*` would be ok, too.)\n\n---\n\nIf you edit `sage-check-64` again, you could remove the persistent superfluous semicolon from `echo \"SAGE_LOCAL undefined ... exiting\";` ;-) and replace <code>\\`uname\\`</code> by `\"$UNAME\"`.",
    "created_at": "2010-11-22T02:42:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96466",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jhpalmieri](#comment:6):
> Here's a new version of the "v2" patch.

Hmmm, now we get *"32-bit build, so writing 'no' to SAGE_LOCAL/lib/sage-64.txt."* on every non-OS X / non-[Open]Solaris system...

(And if `SAGE64` is not set, we usually read the flag file twice.)





> > SAGE64=yes should simply only be used on 64-bit MacOS X and [Open]Solaris; we could give an error message on 32-bit systems, I think no need to give a warning on 64-bit Linuces.

> 
> I don't know how to check for 32-bit systems in a shell script, so I'm not doing this, just checking for "Darwin" or "SunOS".

You could check if <code>... \`uname -m\` in i[3456]86|ppc) ...</code>, Dave will know what in addition to look for on [Open]Solaris (e.g. "x86") and especially SPARC.

(On Darwin PPCs, `uname -m` might report more weird "processor names" like "Power Macintosh", but that's IMHO a minor issue since the build would fail later on 32-bit OSs anyway if we pass `-m64`. We do not support 64-bit builds on PowerPCs at all, so looking for `i[3456]86|ppc*|[Pp]ower*` would be ok, too.)

---

If you edit `sage-check-64` again, you could remove the persistent superfluous semicolon from `echo "SAGE_LOCAL undefined ... exiting";` ;-) and replace <code>\`uname\`</code> by `"$UNAME"`.



---

archive/issue_comments_096467.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nP.S.:\n\nWhat about\n\n```sh\n    ...\n    case \"$UNAME\" in\n        Darwin|SunOS)\n            # Do the right thing...\n\n            ;;\n        *)\n            if [ -n \"$SAGE64\" ]; then\n                echo \"Warning: Ignoring setting of SAGE64 (=$SAGE64) [since it is only used on MacOS X and Solaris]...\"\n            fi\n            # We don't care if there's a sage-64.txt file\n            return 0\n    esac\n```\n?",
    "created_at": "2010-11-22T02:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96467",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:8" align="right">comment:8</div>

P.S.:

What about

```sh
    ...
    case "$UNAME" in
        Darwin|SunOS)
            # Do the right thing...

            ;;
        *)
            if [ -n "$SAGE64" ]; then
                echo "Warning: Ignoring setting of SAGE64 (=$SAGE64) [since it is only used on MacOS X and Solaris]..."
            fi
            # We don't care if there's a sage-64.txt file
            return 0
    esac
```
?



---

archive/issue_comments_096468.json:
```json
{
    "body": "scripts repo",
    "created_at": "2010-11-22T04:48:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96468",
    "user": "https://github.com/jhpalmieri"
}
```

scripts repo



---

archive/issue_comments_096469.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAttachment: **[trac_10303-scripts-SAGE64.v2.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v2.patch.gz)**\n\nOkay, this version of the patch still doesn't check for 32-bit.  Doing that right may involve more testing than I have time to do right now.  (Is there any authoritative listing of the possible outputs for \"uname -m\" anywhere, with information about each platform, like whether it's 64-bit or not?)  This version does check for the platform; if not OS X or Solaris (or OpenSolaris), if SAGE64 is not \"no\" or unset, there is an error.  If SAGE64 is okay, it just exits immediately and silently.",
    "created_at": "2010-11-22T04:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96469",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

Attachment: **[trac_10303-scripts-SAGE64.v2.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v2.patch.gz)**

Okay, this version of the patch still doesn't check for 32-bit.  Doing that right may involve more testing than I have time to do right now.  (Is there any authoritative listing of the possible outputs for "uname -m" anywhere, with information about each platform, like whether it's 64-bit or not?)  This version does check for the platform; if not OS X or Solaris (or OpenSolaris), if SAGE64 is not "no" or unset, there is an error.  If SAGE64 is okay, it just exits immediately and silently.



---

archive/issue_comments_096470.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nSeems you really like negation... ;-) (perhaps because proofs by contradiction are usually easier?)\n\nLooks ok to me, though still a bit complicated.\n\nGiving an (early) error if someone tries to build a 64-bit version on a 32-bit platform is IMHO less important, and there are still ticket numbers available.\n\n---\n\nRegarding `uname`, unfortunately every OS implementor is free to let the `uname()` system call return whatever he/she likes (i.e. almost prose, and no official standards); I now recall Solaris returns e.g. \"`i86pc`\", not \"`i386`\" or alike, and the `uname` command just returns what it gets from that call.\n\nFor the purpose of Sage, the list of possible values shouldn't be that long though, but I'm not aware of a compilation, and just testing `uname -m` might not even be sufficient. A good resource are autotools sources (i.e. `config.guess` and `configure` scripts); our Skynet machines wiki page also contains entries for `uname -a` IIRC.\n\nAnother, safer way to detect if 64-bit builds are supported is to use `getconf`, e.g.\n\n```sh\n    if [ `getconf _POSIX_V6_LP64_OFF64` -eq 1 ]; then\n        # 64-bit builds supported\n        echo \"Max. unsigned long: `getconf -v POSIX_V6_LP64_OFF64 ULONG_MAX`\"\n        # should give 2^64-1\n    fi\n```",
    "created_at": "2010-11-22T06:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96470",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Seems you really like negation... ;-) (perhaps because proofs by contradiction are usually easier?)

Looks ok to me, though still a bit complicated.

Giving an (early) error if someone tries to build a 64-bit version on a 32-bit platform is IMHO less important, and there are still ticket numbers available.

---

Regarding `uname`, unfortunately every OS implementor is free to let the `uname()` system call return whatever he/she likes (i.e. almost prose, and no official standards); I now recall Solaris returns e.g. "`i86pc`", not "`i386`" or alike, and the `uname` command just returns what it gets from that call.

For the purpose of Sage, the list of possible values shouldn't be that long though, but I'm not aware of a compilation, and just testing `uname -m` might not even be sufficient. A good resource are autotools sources (i.e. `config.guess` and `configure` scripts); our Skynet machines wiki page also contains entries for `uname -a` IIRC.

Another, safer way to detect if 64-bit builds are supported is to use `getconf`, e.g.

```sh
    if [ `getconf _POSIX_V6_LP64_OFF64` -eq 1 ]; then
        # 64-bit builds supported
        echo "Max. unsigned long: `getconf -v POSIX_V6_LP64_OFF64 ULONG_MAX`"
        # should give 2^64-1
    fi
```



---

archive/issue_comments_096471.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nLike Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit.",
    "created_at": "2010-11-22T17:56:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96471",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:11" align="right">comment:11</div>

Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit.



---

archive/issue_comments_096472.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@nexttime](#comment:10):\n> Another, safer way to detect if 64-bit builds are supported is to use `getconf`, e.g.\n> \n> ```sh\n>     if [ `getconf _POSIX_V6_LP64_OFF64` -eq 1 ]; then\n>         # 64-bit builds supported\n>         echo \"Max. unsigned long: `getconf -v POSIX_V6_LP64_OFF64 ULONG_MAX`\"\n>         # should give 2^64-1\n>     fi\n> ```\n\nThat's not true. Read the section on \"Exit Status\" on the OpenGroup web site. \n\nDave",
    "created_at": "2010-11-22T18:00:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96472",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@nexttime](#comment:10):
> Another, safer way to detect if 64-bit builds are supported is to use `getconf`, e.g.
> 
> ```sh
>     if [ `getconf _POSIX_V6_LP64_OFF64` -eq 1 ]; then
>         # 64-bit builds supported
>         echo "Max. unsigned long: `getconf -v POSIX_V6_LP64_OFF64 ULONG_MAX`"
>         # should give 2^64-1
>     fi
> ```

That's not true. Read the section on "Exit Status" on the OpenGroup web site. 

Dave



---

archive/issue_comments_096473.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@sagetrac-drkirkby](#comment:11):\n> Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit. \n\nI don't have a strong opinion about this, but I lean slightly toward agreeing with you.  At least allowing SAGE64=yes on any system maintains the status quo, more or less.\n\nDo you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?",
    "created_at": "2010-11-22T19:05:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96473",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@sagetrac-drkirkby](#comment:11):
> Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit. 

I don't have a strong opinion about this, but I lean slightly toward agreeing with you.  At least allowing SAGE64=yes on any system maintains the status quo, more or less.

Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?



---

archive/issue_comments_096474.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jhpalmieri](#comment:13):\n> Replying to [@sagetrac-drkirkby](#comment:11):\n> > Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit. \n\n> \n> I don't have a strong opinion about this, but I lean slightly toward agreeing with you.  At least allowing SAGE64=yes on any system maintains the status quo, more or less.\n\nIt's basically what in the installation guide says: \n\nhttp://www.sagemath.org/doc/installation/source.html#environment-variables says:\n\n> Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?\n\nI don't feel the need to print any message it's unsupported. \n\nAnyone using using something other than Linux, Solaris or OS X gets a message that the system in unsupported. They have to set SAGE_PORT to something non-empty. I don't feel the need to hold their hand any more.",
    "created_at": "2010-11-22T19:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96474",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jhpalmieri](#comment:13):
> Replying to [@sagetrac-drkirkby](#comment:11):
> > Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit. 

> 
> I don't have a strong opinion about this, but I lean slightly toward agreeing with you.  At least allowing SAGE64=yes on any system maintains the status quo, more or less.

It's basically what in the installation guide says: 

http://www.sagemath.org/doc/installation/source.html#environment-variables says:

> Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?

I don't feel the need to print any message it's unsupported. 

Anyone using using something other than Linux, Solaris or OS X gets a message that the system in unsupported. They have to set SAGE_PORT to something non-empty. I don't feel the need to hold their hand any more.



---

archive/issue_comments_096475.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOkay, here's a \"v3\" patch which allows the use of SAGE64 on any platform.  It also requires replacing spkg/install with the attached version (that's the same for v2 and v3).  I'm leaving v2 up here in case there is more debate about which approach is better: to allow SAGE64 on any system or not.",
    "created_at": "2010-11-22T21:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96475",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

Okay, here's a "v3" patch which allows the use of SAGE64 on any platform.  It also requires replacing spkg/install with the attached version (that's the same for v2 and v3).  I'm leaving v2 up here in case there is more debate about which approach is better: to allow SAGE64 on any system or not.



---

archive/issue_comments_096476.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,3 +19,11 @@\n \n I've asked some questions about this on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42573acff76e26b0?tvc=2).   If the answers are not what I expect, then this may need to be rethought.\n \n+---\n+\n+Instructions:\n+\n+- apply trac_10303-scripts-SAGE64.v2.patch or trac_10303-scripts-SAGE64.v3.patch, depending on your mood.  (The first insists that SAGE64 should not be used except on OS X or Solaris; the second has no such restriction.)\n+\n+- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n+\n``````\n",
    "created_at": "2010-11-22T21:55:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96476",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,3 +19,11 @@
 
 I've asked some questions about this on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42573acff76e26b0?tvc=2).   If the answers are not what I expect, then this may need to be rethought.
 
+---
+
+Instructions:
+
+- apply trac_10303-scripts-SAGE64.v2.patch or trac_10303-scripts-SAGE64.v3.patch, depending on your mood.  (The first insists that SAGE64 should not be used except on OS X or Solaris; the second has no such restriction.)
+
+- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
+
``````




---

archive/issue_comments_096477.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@sagetrac-drkirkby](#comment:12):\n> Replying to [@nexttime](#comment:10):\n> > Another, safer way to detect if 64-bit builds are supported is to use `getconf`, e.g.\n\n\n```sh\n    if [ `getconf _POSIX_V6_LP64_OFF64` -eq 1 ]; then\n        # 64-bit builds supported\n        echo \"Max. unsigned long: `getconf -v POSIX_V6_LP64_OFF64 ULONG_MAX`\"\n        # should give 2^64-1\n    fi\n```\n> \n> That's not true. Read the section on \"Exit Status\" on the OpenGroup web site.\n\nThat was just an example. I know one shouldn't test for equality (`-eq 1`), but check that the result (output) is something else than `\"-1\"` and `\"undefined\"`, but that's unrelated to its exit status.\n\nBut using `getconf` is safe and IMHO the right direction.",
    "created_at": "2010-11-23T05:07:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96477",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@sagetrac-drkirkby](#comment:12):
> Replying to [@nexttime](#comment:10):
> > Another, safer way to detect if 64-bit builds are supported is to use `getconf`, e.g.


```sh
    if [ `getconf _POSIX_V6_LP64_OFF64` -eq 1 ]; then
        # 64-bit builds supported
        echo "Max. unsigned long: `getconf -v POSIX_V6_LP64_OFF64 ULONG_MAX`"
        # should give 2^64-1
    fi
```
> 
> That's not true. Read the section on "Exit Status" on the OpenGroup web site.

That was just an example. I know one shouldn't test for equality (`-eq 1`), but check that the result (output) is something else than `"-1"` and `"undefined"`, but that's unrelated to its exit status.

But using `getconf` is safe and IMHO the right direction.



---

archive/issue_comments_096478.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@sagetrac-drkirkby](#comment:14):\n> Replying to [@jhpalmieri](#comment:13):\n> > Replying to [@sagetrac-drkirkby](#comment:11):\n> > > Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit. \n\n> > \n> > I don't have a strong opinion about this, but I lean slightly toward agreeing with you.  At least allowing SAGE64=yes on any system maintains the status quo, more or less.\n\n> \n> It's basically what in the installation guide says: \n\n... where operating systems other than MacOS X, Solaris and OpenSolaris means Linux, since we currently don't support any other. And it doesn't make any sense to mess with `SAGE64` and flag files on systems not defaulting to 64-bit builds, unless or until we also support the opposite, 32-bit builds on systems that default to 64-bit.\n\nAs we support more OSs, it's trivial to add them to `sage-check-64`.\n\n\n\n\n> > Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?\n\n> \n> I don't feel the need to print any message it's unsupported. \n\nBecause of its bad name, people erroneously set `SAGE64` in the past.\n\n> Anyone using using something other than Linux, Solaris or OS X gets a message that the system in unsupported.\n\nWhich is pretty correct.\n\n> They have to set SAGE_PORT to something non-empty. I don't feel the need to hold their hand any more. \n\n\n\nBtw, one can configure GCC to default to 32-bit builds on (almost) any system. (And one could configure GCC to default to 64-bit builds on e.g. Solaris as well.)",
    "created_at": "2010-11-23T05:31:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96478",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@sagetrac-drkirkby](#comment:14):
> Replying to [@jhpalmieri](#comment:13):
> > Replying to [@sagetrac-drkirkby](#comment:11):
> > > Like Peter on sage-devel, I think it's bad to restrict this SAGE64 to OS X and Solaris, as these two systems are certainly not the only ones which default to 32-bit, but can build 64-bit. 

> > 
> > I don't have a strong opinion about this, but I lean slightly toward agreeing with you.  At least allowing SAGE64=yes on any system maintains the status quo, more or less.

> 
> It's basically what in the installation guide says: 

... where operating systems other than MacOS X, Solaris and OpenSolaris means Linux, since we currently don't support any other. And it doesn't make any sense to mess with `SAGE64` and flag files on systems not defaulting to 64-bit builds, unless or until we also support the opposite, 32-bit builds on systems that default to 64-bit.

As we support more OSs, it's trivial to add them to `sage-check-64`.




> > Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?

> 
> I don't feel the need to print any message it's unsupported. 

Because of its bad name, people erroneously set `SAGE64` in the past.

> Anyone using using something other than Linux, Solaris or OS X gets a message that the system in unsupported.

Which is pretty correct.

> They have to set SAGE_PORT to something non-empty. I don't feel the need to hold their hand any more. 



Btw, one can configure GCC to default to 32-bit builds on (almost) any system. (And one could configure GCC to default to 64-bit builds on e.g. Solaris as well.)



---

archive/issue_comments_096479.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@nexttime](#comment:18):\n> And it doesn't make any sense to mess with `SAGE64` and flag files on systems not defaulting to 64-bit builds, unless or until we also support the opposite, 32-bit builds on systems that default to 64-bit.\n\nShould of course read *\"on systems defaulting to 64-bit builds\"* (or *\"**not** defaulting to **32-bit** builds\"*).\n\n\n\n> > > Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?\n\n> > \n> > I don't feel the need to print any message it's unsupported. \n\n> \n> Because of its bad name, people erroneously set `SAGE64` in the past.\n\nNote that there are (still) spkgs around that do more than just adding e.g. `-m64` if `SAGE64=yes`, i.e. setting it at least currently has other side effects.\n\nSo giving an error message on unexpected (and therefore unsupported) situations makes sense to me.\n\nWe could suppress such messages if `SAGE_PORT` is non-empty.",
    "created_at": "2010-11-23T06:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96479",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@nexttime](#comment:18):
> And it doesn't make any sense to mess with `SAGE64` and flag files on systems not defaulting to 64-bit builds, unless or until we also support the opposite, 32-bit builds on systems that default to 64-bit.

Should of course read *"on systems defaulting to 64-bit builds"* (or *"**not** defaulting to **32-bit** builds"*).



> > > Do you think we should print a warning saying that it might not be fully supported, or just accept SAGE64=yes silently on platforms other than OS X and Solaris?

> > 
> > I don't feel the need to print any message it's unsupported. 

> 
> Because of its bad name, people erroneously set `SAGE64` in the past.

Note that there are (still) spkgs around that do more than just adding e.g. `-m64` if `SAGE64=yes`, i.e. setting it at least currently has other side effects.

So giving an error message on unexpected (and therefore unsupported) situations makes sense to me.

We could suppress such messages if `SAGE_PORT` is non-empty.



---

archive/issue_comments_096480.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jhpalmieri](#comment:15):\n> Okay, here's a \"v3\" patch which allows the use of SAGE64 on any platform.  It also requires replacing spkg/install with the attached version (that's the same for v2 and v3).  I'm leaving v2 up here in case there is more debate about which approach is better: to allow SAGE64 on any system or not.\n\nI don't know if that's intentional, but to me the \"v3\" is simply a regression.\n\n* The information on `SAGE64` in `sage-env` is again misleading.\n\n* If `SAGE64` is not set, the message when creating `sage-64.txt` is simply wrong on systems defaulting to 64-bit builds.\n\n\nIf `SAGE64` is not set, we still read the flag file twice if it exists (which is the usual case).",
    "created_at": "2010-11-23T07:00:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96480",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jhpalmieri](#comment:15):
> Okay, here's a "v3" patch which allows the use of SAGE64 on any platform.  It also requires replacing spkg/install with the attached version (that's the same for v2 and v3).  I'm leaving v2 up here in case there is more debate about which approach is better: to allow SAGE64 on any system or not.

I don't know if that's intentional, but to me the "v3" is simply a regression.

* The information on `SAGE64` in `sage-env` is again misleading.

* If `SAGE64` is not set, the message when creating `sage-64.txt` is simply wrong on systems defaulting to 64-bit builds.


If `SAGE64` is not set, we still read the flag file twice if it exists (which is the usual case).



---

archive/issue_comments_096481.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHere's a new version of the v3 patch.",
    "created_at": "2010-11-23T16:49:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96481",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

Here's a new version of the v3 patch.



---

archive/issue_comments_096482.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI'm a bit puzzled. Is the file trac_10303-install, which is said to be for version 2, supposed to work with version 3 too? \n\n\nI thought I'd create a new standard package  \n\n```\nsage-4.6.1.alpha2/spkg/standard/sage_scripts-4.6.1.alpha2.spkg \n```\n\nwith the patches applied before running *make* for the first time. But that does not work, as then I get a failure as \n\n```\nsage-4.6.1.alpha2/local/bin/sage-check-64\n```\n\ndoes not exist. \n\nIf I'm not mistaken, some of the files in the sage-scripts package also need to be copied to  `$SAGE_ROOT/spkg/base` too, which is rather confusing.They then get copied to `$SAGE_ROOT/local/bin` which add further to the confusion. \n\nAm I mistaken? \n\nI was hoping to test out on my laptop, which I just stuck Solaris 11 Express on it. I need to install the developers tools first on this, though a sage binary created on 'hawk' works OK. \n\nPerhaps you can clarify matters. By which time I should have ehough tools on here to build Sage on the laptop and test the patch more thoroughly \n\nBTW, I would avoid using `source` and simply replace it with a `.` - i.e. just a dot. It is more portable, and will work on shells which don't support `source`. \n\nDave",
    "created_at": "2010-11-24T23:55:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96482",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:22" align="right">comment:22</div>

I'm a bit puzzled. Is the file trac_10303-install, which is said to be for version 2, supposed to work with version 3 too? 


I thought I'd create a new standard package  

```
sage-4.6.1.alpha2/spkg/standard/sage_scripts-4.6.1.alpha2.spkg 
```

with the patches applied before running *make* for the first time. But that does not work, as then I get a failure as 

```
sage-4.6.1.alpha2/local/bin/sage-check-64
```

does not exist. 

If I'm not mistaken, some of the files in the sage-scripts package also need to be copied to  `$SAGE_ROOT/spkg/base` too, which is rather confusing.They then get copied to `$SAGE_ROOT/local/bin` which add further to the confusion. 

Am I mistaken? 

I was hoping to test out on my laptop, which I just stuck Solaris 11 Express on it. I need to install the developers tools first on this, though a sage binary created on 'hawk' works OK. 

Perhaps you can clarify matters. By which time I should have ehough tools on here to build Sage on the laptop and test the patch more thoroughly 

BTW, I would avoid using `source` and simply replace it with a `.` - i.e. just a dot. It is more portable, and will work on shells which don't support `source`. 

Dave



---

archive/issue_comments_096483.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@sagetrac-drkirkby](#comment:22):\n> I'm a bit puzzled. Is the file trac_10303-install, which is said to be for version 2, supposed to work with version 3 too? \n\nYes.  See the instructions in the ticket description.\n\n> I thought I'd create a new standard package...\n\nI think it's best to take a working version of Sage, apply the patch to the scripts repo (by cd'ing to SAGE_ROOT/local/bin and applying it), and then run \"sage -sdist ...\".  (I guess it doesn't have to be a \"working version\", but enough things have to be installed for \"sage -sdist ...\" to work.)  This will copy the appropriate files, which now include sage-check-64, to spkg/base.\n\n> BTW, I would avoid using `source` and simply replace it with a `.` - i.e. just a dot. It is more portable, and will work on shells which don't support `source`. \n\nAre there any differences between . and source?  That is, if I make this change, does it require other changes (do I still use \"return\" rather than \"exit\" in sage-check-64, for instance)?",
    "created_at": "2010-11-25T00:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96483",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@sagetrac-drkirkby](#comment:22):
> I'm a bit puzzled. Is the file trac_10303-install, which is said to be for version 2, supposed to work with version 3 too? 

Yes.  See the instructions in the ticket description.

> I thought I'd create a new standard package...

I think it's best to take a working version of Sage, apply the patch to the scripts repo (by cd'ing to SAGE_ROOT/local/bin and applying it), and then run "sage -sdist ...".  (I guess it doesn't have to be a "working version", but enough things have to be installed for "sage -sdist ..." to work.)  This will copy the appropriate files, which now include sage-check-64, to spkg/base.

> BTW, I would avoid using `source` and simply replace it with a `.` - i.e. just a dot. It is more portable, and will work on shells which don't support `source`. 

Are there any differences between . and source?  That is, if I make this change, does it require other changes (do I still use "return" rather than "exit" in sage-check-64, for instance)?



---

archive/issue_comments_096484.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nBy the way:\n\n```\n$ csh\n(...local/bin) [4:51pm]>> . sage-check-64\n.: Permission denied.\n(...local/bin) [4:51pm]>> source sage-check-64\nSAGE_LOCAL: Undefined variable.\n```  \nSo `.` doesn't work, and `source` doesn't behave the way I want.  In bash:\n\n```\n$ source sage-check-64\n\nSAGE_LOCAL undefined ... exiting\nDo not call sage-check-64 directly!\n```",
    "created_at": "2010-11-25T00:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96484",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

By the way:

```
$ csh
(...local/bin) [4:51pm]>> . sage-check-64
.: Permission denied.
(...local/bin) [4:51pm]>> source sage-check-64
SAGE_LOCAL: Undefined variable.
```  
So `.` doesn't work, and `source` doesn't behave the way I want.  In bash:

```
$ source sage-check-64

SAGE_LOCAL undefined ... exiting
Do not call sage-check-64 directly!
```



---

archive/issue_comments_096485.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nTo my knowledge, `source` and dot are the same for **Bourne** type shells, which includes `/bin/sh` and `/bin/bash` as well as other shells like the Korn shell.\n\nHowever csh and tcsh are different animals. It not really a good idea to use them for scripts - see \n\nhttp://www.faqs.org/faqs/unix-faq/shell/csh-whynot/\n\nFor interactive use, csh/tcsh have their own syntax which is quite different from sh/bash/ksh etc. \n\nAssuming you have forced your scripts to use bash, then using `source` is acceptable. But I think it's better to get into a habit of using more portable constructs, avoiding bashisms. \n\nThere were (perhaps still are) some error messages generated in Sage when building on Solaris due to the use of `source`. They might have all gone now though, if a shell now uses bash rather than /bin/sh. \n\nNote using bash for scripts is in general not a great idea, as its size makes it slow. That's why some Linux distributions like Ubunta & Debian link /bin/sh to /bin/dash and use the lighter-weight dash shell. But if you use #!/bin/sh at the top, you need to be more careful about what you write if you want it to be portable. \n\nIf you source a file, no matter how you do it, then if it exits you will still be back in script you sourced it from. So what you see is to be expected. \n\nIf the script is only called from one place, you might consider just writing it inline, and not sourcing the file at all.\n\n\nDave",
    "created_at": "2010-11-25T02:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96485",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:25" align="right">comment:25</div>

To my knowledge, `source` and dot are the same for **Bourne** type shells, which includes `/bin/sh` and `/bin/bash` as well as other shells like the Korn shell.

However csh and tcsh are different animals. It not really a good idea to use them for scripts - see 

http://www.faqs.org/faqs/unix-faq/shell/csh-whynot/

For interactive use, csh/tcsh have their own syntax which is quite different from sh/bash/ksh etc. 

Assuming you have forced your scripts to use bash, then using `source` is acceptable. But I think it's better to get into a habit of using more portable constructs, avoiding bashisms. 

There were (perhaps still are) some error messages generated in Sage when building on Solaris due to the use of `source`. They might have all gone now though, if a shell now uses bash rather than /bin/sh. 

Note using bash for scripts is in general not a great idea, as its size makes it slow. That's why some Linux distributions like Ubunta & Debian link /bin/sh to /bin/dash and use the lighter-weight dash shell. But if you use #!/bin/sh at the top, you need to be more careful about what you write if you want it to be portable. 

If you source a file, no matter how you do it, then if it exits you will still be back in script you sourced it from. So what you see is to be expected. 

If the script is only called from one place, you might consider just writing it inline, and not sourcing the file at all.


Dave



---

archive/issue_comments_096486.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nJohn,\ndo you want to make any changes? If not, I'm happy to give this a positive review now. \n\nIt is a definite improvement over the current system. It works as expected, from a fresh build on my laptop, which runs Solaris 11 Express. \n\nDave",
    "created_at": "2010-11-25T10:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96486",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:26" align="right">comment:26</div>

John,
do you want to make any changes? If not, I'm happy to give this a positive review now. 

It is a definite improvement over the current system. It works as expected, from a fresh build on my laptop, which runs Solaris 11 Express. 

Dave



---

archive/issue_comments_096487.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n\n```sh\necho \"WARNING: At least some of the following information is outdated.\"\necho \"See the Sage installation guide for more up-to-date information\" \necho \"about environment variables related to Sage.\"\n```\n\nSo still needs work? ;-) Funny I never noticed the *enviroment[sic]*s.\n\nLooks better, though I still don't like messing around with `SAGE64` and the flag file at all on systems that don't use / require it. I personally would make a distinction on the OS and, to not annoy some developers, `SAGE_PORT` (i.e., only take care of `SAGE64` on MacOS X 10.4 and 10.5, Solaris and OpenSolaris, or if `SAGE_PORT` is non-empty. Allowing `SAGE64=ignore` would be another option, perhaps automatically setting this on other platforms.)\n\nDoes the Sage Installation Guide mention how to \"cure\" an installation which erroneously defaults to `SAGE64=no` because the user forgot to set it in the first place?\n\n[Want to get rid of this ticket, so positive review. I assume Dave agrees.]",
    "created_at": "2010-11-25T12:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96487",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:27" align="right">comment:27</div>


```sh
echo "WARNING: At least some of the following information is outdated."
echo "See the Sage installation guide for more up-to-date information" 
echo "about environment variables related to Sage."
```

So still needs work? ;-) Funny I never noticed the *enviroment[sic]*s.

Looks better, though I still don't like messing around with `SAGE64` and the flag file at all on systems that don't use / require it. I personally would make a distinction on the OS and, to not annoy some developers, `SAGE_PORT` (i.e., only take care of `SAGE64` on MacOS X 10.4 and 10.5, Solaris and OpenSolaris, or if `SAGE_PORT` is non-empty. Allowing `SAGE64=ignore` would be another option, perhaps automatically setting this on other platforms.)

Does the Sage Installation Guide mention how to "cure" an installation which erroneously defaults to `SAGE64=no` because the user forgot to set it in the first place?

[Want to get rid of this ticket, so positive review. I assume Dave agrees.]



---

archive/issue_comments_096488.json:
```json
{
    "body": "Reviewer: **David Kirkby, Leif Leonhardy**",
    "created_at": "2010-11-25T12:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96488",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **David Kirkby, Leif Leonhardy**



---

archive/issue_events_134085.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-25T12:35:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134085"
}
```



---

archive/issue_events_134086.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-25T12:35:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134086"
}
```



---

archive/issue_comments_096489.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nP.S.:\n\n```sh\n#!/this/file/must/be/sourced\n\nflagfile=... # whatever its name / location is\n\n# Set SAGE64 to \"ignore\" on everything but MacOS X / [Open]Solaris unless SAGE_PORT is set:\ntest -z \"$SAGE_PORT\" && \n    case \"$UNAME\" in\n        Darwin|SunOS) # Add other operating systems later if appropriate.\n            # Do nothing here.\n            ;;\n        *)\n            export SAGE64=ignore\n    esac\n\ntest -z \"$SAGE64\" && export SAGE64=no # default to no if not set\n\ncase \"$SAGE64\" in\n    yes|no)\n        # Also make sure SAGE_LOCAL is defined if it is used; here or above.\n\n        if [ -f \"$flagfile\" ]; then\n            saved64=`cat \"$flagfile\"`\n            if [ \"$saved64\" != \"$SAGE64\" ]; then\n                # inconsistent -> error\n            fi\n        else\n            echo $SAGE64 > \"$flagfile\"\n        fi\n       ;;\n    ignore) # do nothing\n       ;;\n    *)\n        # invalid value -> error\nesac\n\n# And no messages, only errors to stderr\n```\n\nA bit shorter, isn't it?",
    "created_at": "2010-11-25T12:58:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96489",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:28" align="right">comment:28</div>

P.S.:

```sh
#!/this/file/must/be/sourced

flagfile=... # whatever its name / location is

# Set SAGE64 to "ignore" on everything but MacOS X / [Open]Solaris unless SAGE_PORT is set:
test -z "$SAGE_PORT" && 
    case "$UNAME" in
        Darwin|SunOS) # Add other operating systems later if appropriate.
            # Do nothing here.
            ;;
        *)
            export SAGE64=ignore
    esac

test -z "$SAGE64" && export SAGE64=no # default to no if not set

case "$SAGE64" in
    yes|no)
        # Also make sure SAGE_LOCAL is defined if it is used; here or above.

        if [ -f "$flagfile" ]; then
            saved64=`cat "$flagfile"`
            if [ "$saved64" != "$SAGE64" ]; then
                # inconsistent -> error
            fi
        else
            echo $SAGE64 > "$flagfile"
        fi
       ;;
    ignore) # do nothing
       ;;
    *)
        # invalid value -> error
esac

# And no messages, only errors to stderr
```

A bit shorter, isn't it?



---

archive/issue_comments_096490.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nPerhaps\n\n```sh\ntest -z \"$SAGE64\" && export SAGE64=no # default to no if not set\n```\nshould be\n\n```sh\ntest -z \"$SAGE64\" && export SAGE64=`cat \"$flagfile\" || echo no`\n```",
    "created_at": "2010-11-25T13:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96490",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:29" align="right">comment:29</div>

Perhaps

```sh
test -z "$SAGE64" && export SAGE64=no # default to no if not set
```
should be

```sh
test -z "$SAGE64" && export SAGE64=`cat "$flagfile" || echo no`
```



---

archive/issue_comments_096491.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@nexttime](#comment:27):\n> Funny I never noticed the *enviroment[sic]*s.\n\nG**gle has many hits on it, [this one](http://www.wsu.edu/~brians/errors/enviroment.html) is nice.",
    "created_at": "2010-11-25T13:27:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96491",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@nexttime](#comment:27):
> Funny I never noticed the *enviroment[sic]*s.

G**gle has many hits on it, [this one](http://www.wsu.edu/~brians/errors/enviroment.html) is nice.



---

archive/issue_comments_096492.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n Instructions:\n \n-- apply trac_10303-scripts-SAGE64.v2.patch or trac_10303-scripts-SAGE64.v3.patch, depending on your mood.  (The first insists that SAGE64 should not be used except on OS X or Solaris; the second has no such restriction.)\n+- apply trac_10303-scripts-SAGE64.v3.patch.\n \n - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n \n``````\n",
    "created_at": "2010-11-25T16:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96492",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 Instructions:
 
-- apply trac_10303-scripts-SAGE64.v2.patch or trac_10303-scripts-SAGE64.v3.patch, depending on your mood.  (The first insists that SAGE64 should not be used except on OS X or Solaris; the second has no such restriction.)
+- apply trac_10303-scripts-SAGE64.v3.patch.
 
 - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
 
``````




---

archive/issue_comments_096493.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@nexttime](#comment:27):\n>\n\n```sh\necho \"WARNING: At least some of the following information is outdated.\"\necho \"See the Sage installation guide for more up-to-date information\" \necho \"about environment variables related to Sage.\"\n```\n> \n> So still needs work? ;-) \n\nProbably so, but not on this ticket :p   Does it work to set $AR or $RANLIB or many of these other variables?  We should probably delete all of this and just update the information in the installation guide.  (There are also other typos in this passage of the code, but it doesn't seem worth spending more time on.)\n\n> Funny I never noticed the *enviroment[sic]*s.\n\nMe neither, until the last patch.\n\n> Looks better, though I still don't like messing around with `SAGE64` and the flag file at all on systems that don't use / require it. I personally would make a distinction on the OS and, to not annoy some developers, `SAGE_PORT` (i.e., only take care of `SAGE64` on MacOS X 10.4 and 10.5, Solaris and OpenSolaris, or if `SAGE_PORT` is non-empty. Allowing `SAGE64=ignore` would be another option, perhaps automatically setting this on other platforms.)\n\nI didn't see any support on sage-devel to change the status quo which allows the use of SAGE64 on any system, so I think for now, doing more documenting of what's going on is the right choice.\n\n> Does the Sage Installation Guide mention how to \"cure\" an installation which erroneously defaults to `SAGE64=no` because the user forgot to set it in the first place?\n\nI doubt it.\n \n> [Want to get rid of this ticket, so positive review. I assume Dave agrees.]\n\n...\n\n> A bit shorter, isn't it?\n\nYes, but you left out many of the comments and messages; for example, your \"# inconsistent -> error\" replaced 15 lines of my version.  Shortening it that way doesn't count.  ;)",
    "created_at": "2010-11-25T16:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96493",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@nexttime](#comment:27):
>

```sh
echo "WARNING: At least some of the following information is outdated."
echo "See the Sage installation guide for more up-to-date information" 
echo "about environment variables related to Sage."
```
> 
> So still needs work? ;-) 

Probably so, but not on this ticket :p   Does it work to set $AR or $RANLIB or many of these other variables?  We should probably delete all of this and just update the information in the installation guide.  (There are also other typos in this passage of the code, but it doesn't seem worth spending more time on.)

> Funny I never noticed the *enviroment[sic]*s.

Me neither, until the last patch.

> Looks better, though I still don't like messing around with `SAGE64` and the flag file at all on systems that don't use / require it. I personally would make a distinction on the OS and, to not annoy some developers, `SAGE_PORT` (i.e., only take care of `SAGE64` on MacOS X 10.4 and 10.5, Solaris and OpenSolaris, or if `SAGE_PORT` is non-empty. Allowing `SAGE64=ignore` would be another option, perhaps automatically setting this on other platforms.)

I didn't see any support on sage-devel to change the status quo which allows the use of SAGE64 on any system, so I think for now, doing more documenting of what's going on is the right choice.

> Does the Sage Installation Guide mention how to "cure" an installation which erroneously defaults to `SAGE64=no` because the user forgot to set it in the first place?

I doubt it.
 
> [Want to get rid of this ticket, so positive review. I assume Dave agrees.]

...

> A bit shorter, isn't it?

Yes, but you left out many of the comments and messages; for example, your "# inconsistent -> error" replaced 15 lines of my version.  Shortening it that way doesn't count.  ;)



---

archive/issue_comments_096494.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@jhpalmieri](#comment:32):\n> Replying to [@nexttime](#comment:27):\n> > Looks better, though I still don't like messing around with `SAGE64` and the flag file at all on systems that don't use / require it. I personally would make a distinction on the OS and, to not annoy some developers, `SAGE_PORT` (i.e., only take care of `SAGE64` on MacOS X 10.4 and 10.5, Solaris and OpenSolaris, or if `SAGE_PORT` is non-empty. Allowing `SAGE64=ignore` would be another option, perhaps automatically setting this on other platforms.)\n\n> \n> I didn't see any support on sage-devel to change the status quo which allows the use of SAGE64 on any system, so I think for now, doing more documenting of what's going on is the right choice.\n\nWell, the status quo is (or was) to **do nothing on any operating system other than MacOS X or SunOS/Solaris**. (I.e., `SAGE64` **was** effectively ignored w.r.t. `sage-env` / `sage-check-64`. The assumption in `spkg-install`s is that a non-empty `SAGE64` *implies* MacOS X or SunOS; we previously had tests like `if [ \"$SAGE64\" = yes -a \"$UNAME\" = Darwin ]`, until Dave began to port to Solaris, first *adding* a test for SunOS, then dropping the distinction on `$UNAME`, which as a side-effect then slightly changed the meaning or possible interpretations of the `spkg-install` files regarded in isolation. Of course removing the OS dependency **there** makes sense, as long as the overall meaning is kept.)\n\nSo this patch introduces quite different behavoir on the other platforms rather than just removing stupid messages (and fixing the previous ill and incomplete logic).\n\n\n\n> Yes, but you left out many of the comments and messages; for example, your \"# inconsistent -> error\" replaced 15 lines of my version.  Shortening it that way doesn't count.  ;)\n\nI moved more detailed documentation to the Installation Guide... ;-)\n\nMy version also contains lots of (brief) comments and empty lines, nevertheless fits on half a page, so is easier to read and maintain. (Dave also likes saving a few bytes.) :D\n\nThe messages are a matter of taste; perhaps we should add more `--verbose` and `--quiet` options (and/or corresponding enviro**n**ment variables) to Sage.",
    "created_at": "2010-11-25T18:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96494",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@jhpalmieri](#comment:32):
> Replying to [@nexttime](#comment:27):
> > Looks better, though I still don't like messing around with `SAGE64` and the flag file at all on systems that don't use / require it. I personally would make a distinction on the OS and, to not annoy some developers, `SAGE_PORT` (i.e., only take care of `SAGE64` on MacOS X 10.4 and 10.5, Solaris and OpenSolaris, or if `SAGE_PORT` is non-empty. Allowing `SAGE64=ignore` would be another option, perhaps automatically setting this on other platforms.)

> 
> I didn't see any support on sage-devel to change the status quo which allows the use of SAGE64 on any system, so I think for now, doing more documenting of what's going on is the right choice.

Well, the status quo is (or was) to **do nothing on any operating system other than MacOS X or SunOS/Solaris**. (I.e., `SAGE64` **was** effectively ignored w.r.t. `sage-env` / `sage-check-64`. The assumption in `spkg-install`s is that a non-empty `SAGE64` *implies* MacOS X or SunOS; we previously had tests like `if [ "$SAGE64" = yes -a "$UNAME" = Darwin ]`, until Dave began to port to Solaris, first *adding* a test for SunOS, then dropping the distinction on `$UNAME`, which as a side-effect then slightly changed the meaning or possible interpretations of the `spkg-install` files regarded in isolation. Of course removing the OS dependency **there** makes sense, as long as the overall meaning is kept.)

So this patch introduces quite different behavoir on the other platforms rather than just removing stupid messages (and fixing the previous ill and incomplete logic).



> Yes, but you left out many of the comments and messages; for example, your "# inconsistent -> error" replaced 15 lines of my version.  Shortening it that way doesn't count.  ;)

I moved more detailed documentation to the Installation Guide... ;-)

My version also contains lots of (brief) comments and empty lines, nevertheless fits on half a page, so is easier to read and maintain. (Dave also likes saving a few bytes.) :D

The messages are a matter of taste; perhaps we should add more `--verbose` and `--quiet` options (and/or corresponding enviro**n**ment variables) to Sage.



---

archive/issue_comments_096495.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@nexttime](#comment:33):\n> Well, the status quo is (or was) to **do nothing on any operating system other than MacOS X or SunOS/Solaris**. (I.e., `SAGE64` **was** effectively ignored w.r.t. `sage-env` / `sage-check-64`. The assumption in `spkg-install`s is that a non-empty `SAGE64` *implies* MacOS X or SunOS; we previously had tests like `if [ \"$SAGE64\" = yes -a \"$UNAME\" = Darwin ]`, until Dave began to port to Solaris, first *adding* a test for SunOS, then dropping the distinction on `$UNAME`, which as a side-effect then slightly changed the meaning or possible interpretations of the `spkg-install` files regarded in isolation. Of course removing the OS dependency **there** makes sense, as long as the overall meaning is kept.)\n> \n> So this patch introduces quite different behavoir on the other platforms rather than just removing stupid messages (and fixing the previous ill and incomplete logic).\n\n\"Quite different\" is not accurate. The only functional difference was that previously on non OS X or Solaris systems, if SAGE64=yes, then the file sage-64.txt would not be created or read.  Now it is.  Some extra messages are also printed.  (Yes, previously sage-check-64 ignored SAGE64 on Linux boxes, but many spkg-install files do not.)",
    "created_at": "2010-11-25T19:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96495",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@nexttime](#comment:33):
> Well, the status quo is (or was) to **do nothing on any operating system other than MacOS X or SunOS/Solaris**. (I.e., `SAGE64` **was** effectively ignored w.r.t. `sage-env` / `sage-check-64`. The assumption in `spkg-install`s is that a non-empty `SAGE64` *implies* MacOS X or SunOS; we previously had tests like `if [ "$SAGE64" = yes -a "$UNAME" = Darwin ]`, until Dave began to port to Solaris, first *adding* a test for SunOS, then dropping the distinction on `$UNAME`, which as a side-effect then slightly changed the meaning or possible interpretations of the `spkg-install` files regarded in isolation. Of course removing the OS dependency **there** makes sense, as long as the overall meaning is kept.)
> 
> So this patch introduces quite different behavoir on the other platforms rather than just removing stupid messages (and fixing the previous ill and incomplete logic).

"Quite different" is not accurate. The only functional difference was that previously on non OS X or Solaris systems, if SAGE64=yes, then the file sage-64.txt would not be created or read.  Now it is.  Some extra messages are also printed.  (Yes, previously sage-check-64 ignored SAGE64 on Linux boxes, but many spkg-install files do not.)



---

archive/issue_comments_096496.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI'm happy with this The variable name `SAGE64` implies absolutely **nothing** about the operating system, so I don't see any reason it should behave any differently on different operating systems. As John said, nobody on sage-devel objected to this either. \n\nNo two people are likely to want to code a script in exactly the same way, or use the exact same messages. One could spend ages worrying about such small things, and not have any significant impact on Sage. \n\nFor me personally, I try to make my scripts as portable as possible, so they don't rely on bash. Then I can bit of the scripts on other software projects, were people don't rely on bash. \n\nDave",
    "created_at": "2010-11-25T20:29:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96496",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:35" align="right">comment:35</div>

I'm happy with this The variable name `SAGE64` implies absolutely **nothing** about the operating system, so I don't see any reason it should behave any differently on different operating systems. As John said, nobody on sage-devel objected to this either. 

No two people are likely to want to code a script in exactly the same way, or use the exact same messages. One could spend ages worrying about such small things, and not have any significant impact on Sage. 

For me personally, I try to make my scripts as portable as possible, so they don't rely on bash. Then I can bit of the scripts on other software projects, were people don't rely on bash. 

Dave



---

archive/issue_comments_096497.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@jhpalmieri](#comment:34):\n> Replying to [@nexttime](#comment:33):\n> > Well, the status quo is (or was) to **do nothing on any operating system other than MacOS X or SunOS/Solaris**. (I.e., `SAGE64` **was** effectively ignored w.r.t. `sage-env` / `sage-check-64`. The assumption in `spkg-install`s is that a non-empty `SAGE64` *implies* MacOS X or SunOS; we previously had tests like `if [ \"$SAGE64\" = yes -a \"$UNAME\" = Darwin ]`, until Dave began to port to Solaris, first *adding* a test for SunOS, then dropping the distinction on `$UNAME`, which as a side-effect then slightly changed the meaning or possible interpretations of the `spkg-install` files regarded in isolation. Of course removing the OS dependency **there** makes sense, as long as the overall meaning is kept.)\n> > \n> > So this patch introduces quite different behavoir on the other platforms rather than just removing stupid messages (and fixing the previous ill and incomplete logic).\n\n> \n> \"Quite different\" is not accurate. The only functional difference was that previously on non OS X or Solaris systems, if SAGE64=yes, then the file sage-64.txt would not be created or read.  Now it is.\n\nAnd exactly *that* is the \"problem\", besides interpreting `SAGE64` not set as \"use previous setting\", which wasn't recorded on e.g. Linux.\n\nIf a user now erroneously sets `SAGE64=yes` once, potential problems persist, where previously doing `unset SAGE64` (or simply leaving / changing the shell) was sufficient. This has to be documented.\n\n(Though it's [at least meanwhile] simply wrong what some spkgs still do when `SAGE64` is set [to \"yes\"], namely e.g. also modifying flags unrelated to building 32- or 64-bit. We've already removed lots of wrong *Building a 32-bit version of ...* messages.)\n\nIMHO setting `SAGE64` (to \"yes\" or anything else then \"no\", and perhaps in the future \"ignore\") on e.g. Linux should raise an error, nothing else, since the behavior is - at least currently - more or less \"undefined\" in that case.\n\n> Some extra messages are also printed.\n\nI won't mind that.\n\n> (Yes, previously sage-check-64 ignored SAGE64 on Linux boxes, but many spkg-install files do not.)\n\nBecause `SAGE64` is not expected to be set on platforms not defaulting to 32-bit builds; this should be catched in a central place, where also new OSs would and easily could be added in the first place.",
    "created_at": "2010-11-25T20:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96497",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@jhpalmieri](#comment:34):
> Replying to [@nexttime](#comment:33):
> > Well, the status quo is (or was) to **do nothing on any operating system other than MacOS X or SunOS/Solaris**. (I.e., `SAGE64` **was** effectively ignored w.r.t. `sage-env` / `sage-check-64`. The assumption in `spkg-install`s is that a non-empty `SAGE64` *implies* MacOS X or SunOS; we previously had tests like `if [ "$SAGE64" = yes -a "$UNAME" = Darwin ]`, until Dave began to port to Solaris, first *adding* a test for SunOS, then dropping the distinction on `$UNAME`, which as a side-effect then slightly changed the meaning or possible interpretations of the `spkg-install` files regarded in isolation. Of course removing the OS dependency **there** makes sense, as long as the overall meaning is kept.)
> > 
> > So this patch introduces quite different behavoir on the other platforms rather than just removing stupid messages (and fixing the previous ill and incomplete logic).

> 
> "Quite different" is not accurate. The only functional difference was that previously on non OS X or Solaris systems, if SAGE64=yes, then the file sage-64.txt would not be created or read.  Now it is.

And exactly *that* is the "problem", besides interpreting `SAGE64` not set as "use previous setting", which wasn't recorded on e.g. Linux.

If a user now erroneously sets `SAGE64=yes` once, potential problems persist, where previously doing `unset SAGE64` (or simply leaving / changing the shell) was sufficient. This has to be documented.

(Though it's [at least meanwhile] simply wrong what some spkgs still do when `SAGE64` is set [to "yes"], namely e.g. also modifying flags unrelated to building 32- or 64-bit. We've already removed lots of wrong *Building a 32-bit version of ...* messages.)

IMHO setting `SAGE64` (to "yes" or anything else then "no", and perhaps in the future "ignore") on e.g. Linux should raise an error, nothing else, since the behavior is - at least currently - more or less "undefined" in that case.

> Some extra messages are also printed.

I won't mind that.

> (Yes, previously sage-check-64 ignored SAGE64 on Linux boxes, but many spkg-install files do not.)

Because `SAGE64` is not expected to be set on platforms not defaulting to 32-bit builds; this should be catched in a central place, where also new OSs would and easily could be added in the first place.



---

archive/issue_comments_096498.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@sagetrac-drkirkby](#comment:35):\n> The variable name `SAGE64` implies absolutely **nothing** about the operating system,\n\nHence it should be named `SAGE_FORCE_64_BIT_BUILD`.\n\nNote that it used to, and you're right in the sense that its *documentation* has now (actually recently) changed, but that doesn't really reflect the current situation in Sage. (It will hopefully in the future, but currently it's a \"should\" rather than \"is\", for developers rather than users.)\n\n\n\n> so I don't see any reason it should behave any differently on different operating systems.\n\nIts only (intended) use is to force 64-bit builds (on **operating systems** *that default to 32-bit*, and therefore doesn't make sense on others, while it should *in principle* do no harm there either, or more precisely it shouldn't have *any* effect there).\n\n> As John said, nobody on sage-devel objected to this either.\n\nI haven't followed that thread, but in general that doesn't mean much to me. How many people did read the thread? Two people besides you two posted; William just noted that `SAGE64` was introduced solely for MacOS X, with **no impact** on anything else. (Of course that wasn't a very good decision, since lots of code had to be changed for Solaris in essentially the same manner again.)\n\nMay I cite Peter's statement?\n\n  ''Generically adding '-m64' when SAGE64 is set is definitely wrong because\n  not all compilers will support that flag.  In addition, gcc treats x86\n  and x86_64 as different variants of the one architecture - so gcc on a\n  32-bit platform can compile x86_64 code.  On 32-bit x86 Linux and *BSD,\n  using '-m64' will cause gcc to build x86_64 code - which the kernel won't\n  be able to execute - so this is highly undesirable.''\n\n  ''Ideally, all skpg files should inherit {C,CPP,CXX,FC,LD}FLAGS from the\n  environment (adding spkg-specific options if required).  This would\n  allow SAGE64 to be processed in one spot fairly early on in the build\n  -- adding '-m64' or equivalent to {C,FCC,FC,LD}FLAGS, which is then\n  inherited by all succeeding spkg builds.  This would remove a lot of\n  special-casing from the build.''\n\nIf all spkgs really contained just what John posted,\n\n```sh\nf [ -z $CFLAG64 ] ; then\n   CFLAG64=-m64\nfi\n\nif [ \"x$SAGE64\" = xyes ]; then\n   echo \"64 bit build of cddlib\"\n   CFLAGS=\"$CFLAGS $CFLAG64\"; export CFLAGS\nfi\n```\n(which definitely **isn't** the case, so also the thread didn't really address the issue), the situation would be different, and as Peter noted, we could easily move that code snippet into e.g. `sage-env`, as well as others by the way.\n\nOther aspects we discussed here weren't discussed there at all.",
    "created_at": "2010-11-25T21:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96498",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@sagetrac-drkirkby](#comment:35):
> The variable name `SAGE64` implies absolutely **nothing** about the operating system,

Hence it should be named `SAGE_FORCE_64_BIT_BUILD`.

Note that it used to, and you're right in the sense that its *documentation* has now (actually recently) changed, but that doesn't really reflect the current situation in Sage. (It will hopefully in the future, but currently it's a "should" rather than "is", for developers rather than users.)



> so I don't see any reason it should behave any differently on different operating systems.

Its only (intended) use is to force 64-bit builds (on **operating systems** *that default to 32-bit*, and therefore doesn't make sense on others, while it should *in principle* do no harm there either, or more precisely it shouldn't have *any* effect there).

> As John said, nobody on sage-devel objected to this either.

I haven't followed that thread, but in general that doesn't mean much to me. How many people did read the thread? Two people besides you two posted; William just noted that `SAGE64` was introduced solely for MacOS X, with **no impact** on anything else. (Of course that wasn't a very good decision, since lots of code had to be changed for Solaris in essentially the same manner again.)

May I cite Peter's statement?

  ''Generically adding '-m64' when SAGE64 is set is definitely wrong because
  not all compilers will support that flag.  In addition, gcc treats x86
  and x86_64 as different variants of the one architecture - so gcc on a
  32-bit platform can compile x86_64 code.  On 32-bit x86 Linux and *BSD,
  using '-m64' will cause gcc to build x86_64 code - which the kernel won't
  be able to execute - so this is highly undesirable.''

  ''Ideally, all skpg files should inherit {C,CPP,CXX,FC,LD}FLAGS from the
  environment (adding spkg-specific options if required).  This would
  allow SAGE64 to be processed in one spot fairly early on in the build
  -- adding '-m64' or equivalent to {C,FCC,FC,LD}FLAGS, which is then
  inherited by all succeeding spkg builds.  This would remove a lot of
  special-casing from the build.''

If all spkgs really contained just what John posted,

```sh
f [ -z $CFLAG64 ] ; then
   CFLAG64=-m64
fi

if [ "x$SAGE64" = xyes ]; then
   echo "64 bit build of cddlib"
   CFLAGS="$CFLAGS $CFLAG64"; export CFLAGS
fi
```
(which definitely **isn't** the case, so also the thread didn't really address the issue), the situation would be different, and as Peter noted, we could easily move that code snippet into e.g. `sage-env`, as well as others by the way.

Other aspects we discussed here weren't discussed there at all.



---

archive/issue_comments_096499.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nWith a build from scratch, I get\n\n```\nspkg/pipestatus \"cd spkg && ./install all 2>&1\" \"tee -a ../install.log\"\n./install: line 77: /scratch/jdemeyer/merger/sage-4.6.1.alpha3/local/bin/sage-check-64: No such file or directory\nmake: *** [build] Error 1\n```",
    "created_at": "2010-11-25T22:06:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96499",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

With a build from scratch, I get

```
spkg/pipestatus "cd spkg && ./install all 2>&1" "tee -a ../install.log"
./install: line 77: /scratch/jdemeyer/merger/sage-4.6.1.alpha3/local/bin/sage-check-64: No such file or directory
make: *** [build] Error 1
```



---

archive/issue_events_134087.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-25T22:06:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134087"
}
```



---

archive/issue_events_134088.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-25T22:06:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134088"
}
```



---

archive/issue_comments_096500.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@jdemeyer](#comment:38):\n> With a build from scratch, I get\n> \n> ```\n> spkg/pipestatus \"cd spkg && ./install all 2>&1\" \"tee -a ../install.log\"\n> ./install: line 77: /scratch/jdemeyer/merger/sage-4.6.1.alpha3/local/bin/sage-check-64: No such file or directory\n> make: *** [build] Error 1\n> ```\n\nIt needs at least some of the files must be copied to `$SAGE_ROOT/spkg/base` too. Then they get to `$SAGE_LOCAL/bin`. \n\n\nI can't understand why some files are in two repositories, but that seems to be the case. Some things in `$SAGE_ROOT/spkg/base` are also in the sage-scripts package.",
    "created_at": "2010-11-25T22:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96500",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@jdemeyer](#comment:38):
> With a build from scratch, I get
> 
> ```
> spkg/pipestatus "cd spkg && ./install all 2>&1" "tee -a ../install.log"
> ./install: line 77: /scratch/jdemeyer/merger/sage-4.6.1.alpha3/local/bin/sage-check-64: No such file or directory
> make: *** [build] Error 1
> ```

It needs at least some of the files must be copied to `$SAGE_ROOT/spkg/base` too. Then they get to `$SAGE_LOCAL/bin`. 


I can't understand why some files are in two repositories, but that seems to be the case. Some things in `$SAGE_ROOT/spkg/base` are also in the sage-scripts package.



---

archive/issue_comments_096501.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nAt least the following are both in `sage_scripts-4.6.1.alpha2.spkg` and in `$SAGE_ROOT/spkg/base`\n\n```\nsage-env\nsage-make_relative\nsage-spkg\n```\n\nI think `sage-check-64` needs to be put into `$SAGE_ROOT/spkg/base` and any of the above files which get modified by Johns patch.",
    "created_at": "2010-11-25T22:20:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96501",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:40" align="right">comment:40</div>

At least the following are both in `sage_scripts-4.6.1.alpha2.spkg` and in `$SAGE_ROOT/spkg/base`

```
sage-env
sage-make_relative
sage-spkg
```

I think `sage-check-64` needs to be put into `$SAGE_ROOT/spkg/base` and any of the above files which get modified by Johns patch.



---

archive/issue_events_134089.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-11-25T23:15:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134089"
}
```



---

archive/issue_events_134090.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-11-25T23:15:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134090"
}
```



---

archive/issue_comments_096502.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\n## To the release manager\n\nI wish I understood the logic of this, but it appears that \n\n```\nsage-env\nsage-make_relative\nsage-spkg\n```\n\nin `$SAGE_ROOT/spkg/base` are in `.hgignore`. I'm adding a patch which adds `sage-check-64` to `$SAGE_ROOT/spkg/base/.hgignore`. After that is added, the files \n\n```\nsage-env\nsage-make_relative\nsage-spkg\nsage-check-64\n```\n\nshould all be copied to  `$SAGE_ROOT/spkg/base` \n\nAt least that is my understanding of what's needed.",
    "created_at": "2010-11-25T23:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96502",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:41" align="right">comment:41</div>

## To the release manager

I wish I understood the logic of this, but it appears that 

```
sage-env
sage-make_relative
sage-spkg
```

in `$SAGE_ROOT/spkg/base` are in `.hgignore`. I'm adding a patch which adds `sage-check-64` to `$SAGE_ROOT/spkg/base/.hgignore`. After that is added, the files 

```
sage-env
sage-make_relative
sage-spkg
sage-check-64
```

should all be copied to  `$SAGE_ROOT/spkg/base` 

At least that is my understanding of what's needed.



---

archive/issue_comments_096503.json:
```json
{
    "body": "Adds sage-check-64 to .hgignore",
    "created_at": "2010-11-25T23:17:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96503",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Adds sage-check-64 to .hgignore



---

archive/issue_events_134091.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-25T23:38:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134091"
}
```



---

archive/issue_events_134092.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-11-25T23:38:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134092"
}
```



---

archive/issue_comments_096504.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nAttachment: **[10303-add-sage-check-64-dot-hgignore.patch.gz](https://github.com/sagemath/sage/files/ticket10303/10303-add-sage-check-64-dot-hgignore.patch.gz)**\n\nPositive review for Dave's patch.\n\nReplying to [@jdemeyer](#comment:38):\n> With a build from scratch, I get\n\n\n```\nspkg/pipestatus \"cd spkg && ./install all 2>&1\" \"tee -a ../install.log\"\n./install: line 77: /scratch/jdemeyer/merger/sage-4.6.1.alpha3/local/bin/sage-check-64: No such file or directory\nmake: *** [build] Error 1\n```\n\nHow did you apply the patch?  After you apply it to the scripts repo, you have to run \"sage -sdist\" to make sure the appropriate files are copied to SAGE_ROOT/spkg/base.",
    "created_at": "2010-11-25T23:38:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96504",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:42" align="right">comment:42</div>

Attachment: **[10303-add-sage-check-64-dot-hgignore.patch.gz](https://github.com/sagemath/sage/files/ticket10303/10303-add-sage-check-64-dot-hgignore.patch.gz)**

Positive review for Dave's patch.

Replying to [@jdemeyer](#comment:38):
> With a build from scratch, I get


```
spkg/pipestatus "cd spkg && ./install all 2>&1" "tee -a ../install.log"
./install: line 77: /scratch/jdemeyer/merger/sage-4.6.1.alpha3/local/bin/sage-check-64: No such file or directory
make: *** [build] Error 1
```

How did you apply the patch?  After you apply it to the scripts repo, you have to run "sage -sdist" to make sure the appropriate files are copied to SAGE_ROOT/spkg/base.



---

archive/issue_comments_096505.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,3 +27,6 @@\n \n - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n \n+- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base).\n+\n+To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.\n``````\n",
    "created_at": "2010-11-25T23:38:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96505",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,3 +27,6 @@
 
 - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
 
+- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base).
+
+To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.
``````




---

archive/issue_comments_096506.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nIs there any good reason for the placing of these files in the scripts repository, copying them to `$SAGE_ROOT/spkg/base` and then having them added to `$SAGE_ROOT/spkg/base/.hgignore` ? Perhaps I'm missing something, but it would seem more logical to me to:\n\n* Remove the files from the scripts repository\n* Put then in the `$SAGE_ROOT/spkg/base` and remove them from the `$SAGE_ROOT/spkg/base/.hgignore`\n\nPerhaps on another ticket, we address this issue, if there is a more logical way of doing this, as to me at least, this is pretty illogical. \n\nDave",
    "created_at": "2010-11-26T03:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96506",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:43" align="right">comment:43</div>

Is there any good reason for the placing of these files in the scripts repository, copying them to `$SAGE_ROOT/spkg/base` and then having them added to `$SAGE_ROOT/spkg/base/.hgignore` ? Perhaps I'm missing something, but it would seem more logical to me to:

* Remove the files from the scripts repository
* Put then in the `$SAGE_ROOT/spkg/base` and remove them from the `$SAGE_ROOT/spkg/base/.hgignore`

Perhaps on another ticket, we address this issue, if there is a more logical way of doing this, as to me at least, this is pretty illogical. 

Dave



---

archive/issue_comments_096507.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@sagetrac-drkirkby](#comment:43):\n> Is there any good reason for the placing of these files in the scripts repository, copying them to `$SAGE_ROOT/spkg/base` and then having them added to `$SAGE_ROOT/spkg/base/.hgignore` ? \n\nI don't know.  These are scripts that get used both in the installation process and in day-to-day use of Sage (at least when doing things like  installing optional skpgs).  If you add them to base, then you need to remove them from scripts.  One advantage to having them in the scripts repo is that it is an actively updated, well-documented, repo, whereas base is not.  Is base even mentioned in the developer's guide?",
    "created_at": "2010-11-26T04:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96507",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@sagetrac-drkirkby](#comment:43):
> Is there any good reason for the placing of these files in the scripts repository, copying them to `$SAGE_ROOT/spkg/base` and then having them added to `$SAGE_ROOT/spkg/base/.hgignore` ? 

I don't know.  These are scripts that get used both in the installation process and in day-to-day use of Sage (at least when doing things like  installing optional skpgs).  If you add them to base, then you need to remove them from scripts.  One advantage to having them in the scripts repo is that it is an actively updated, well-documented, repo, whereas base is not.  Is base even mentioned in the developer's guide?



---

archive/issue_comments_096508.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nDave: I agree 100% that having files in `spkg/base` and in the `scripts` repo is a mess.  This has caused problems for me countless times.  I will now also handle `sage-check-64` specially, so it should work.",
    "created_at": "2010-11-26T09:24:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96508",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

Dave: I agree 100% that having files in `spkg/base` and in the `scripts` repo is a mess.  This has caused problems for me countless times.  I will now also handle `sage-check-64` specially, so it should work.



---

archive/issue_comments_096509.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nThe commit message of [attachment: trac_10303-scripts-SAGE64.v3.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v3.patch.gz) should not be one long line.  Provide a short description on the first line (this will appear in `hg log`).  Any further info should go on following lines.",
    "created_at": "2010-12-02T14:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96509",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

The commit message of [attachment: trac_10303-scripts-SAGE64.v3.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v3.patch.gz) should not be one long line.  Provide a short description on the first line (this will appear in `hg log`).  Any further info should go on following lines.



---

archive/issue_events_134093.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-02T14:45:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134093"
}
```



---

archive/issue_events_134094.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-02T14:45:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134094"
}
```



---

archive/issue_comments_096510.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@jdemeyer](#comment:46):\n> The commit message of [attachment: trac_10303-scripts-SAGE64.v3.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v3.patch.gz) should not be one long line.  Provide a short description on the first line (this will appear in `hg log`).  Any further info should go on following lines.\n\nI was aware of that, but didn't want to appear to picky... ;-)",
    "created_at": "2010-12-02T14:53:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96510",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@jdemeyer](#comment:46):
> The commit message of [attachment: trac_10303-scripts-SAGE64.v3.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v3.patch.gz) should not be one long line.  Provide a short description on the first line (this will appear in `hg log`).  Any further info should go on following lines.

I was aware of that, but didn't want to appear to picky... ;-)



---

archive/issue_events_134095.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-12-03T00:34:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134095"
}
```



---

archive/issue_events_134096.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-12-03T00:34:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134096"
}
```



---

archive/issue_comments_096511.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nSeriously?  You're holding up the patch because of this?  The release manager can easily fix an issue like this in about 2 minutes.  Instead, ten hours later, I'm going to post a new patch.",
    "created_at": "2010-12-03T00:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96511",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:48" align="right">comment:48</div>

Seriously?  You're holding up the patch because of this?  The release manager can easily fix an issue like this in about 2 minutes.  Instead, ten hours later, I'm going to post a new patch.



---

archive/issue_comments_096512.json:
```json
{
    "body": "Attachment: **[trac_10303-scripts-SAGE64.v3.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v3.patch.gz)**\n\nscripts repo",
    "created_at": "2010-12-03T00:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96512",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_10303-scripts-SAGE64.v3.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v3.patch.gz)**

scripts repo



---

archive/issue_comments_096513.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@jhpalmieri](#comment:48):\n> You're holding up the patch because of this?\n\nNo, I'm not.\n\nOf course, the release manager can do it, but I think it is better that I point out these minor issues to the aurhors and that they fix them (does it matter if it takes 10 hours?).  Imagine you have 10 tickets with various of these minor issues.",
    "created_at": "2010-12-03T08:34:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96513",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@jhpalmieri](#comment:48):
> You're holding up the patch because of this?

No, I'm not.

Of course, the release manager can do it, but I think it is better that I point out these minor issues to the aurhors and that they fix them (does it matter if it takes 10 hours?).  Imagine you have 10 tickets with various of these minor issues.



---

archive/issue_comments_096514.json:
```json
{
    "body": "Attachment: **[trac_10303-scripts-SAGE64.v4.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v4.patch.gz)**\n\nFixed commit message (first line was blank)",
    "created_at": "2010-12-03T09:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96514",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[trac_10303-scripts-SAGE64.v4.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v4.patch.gz)**

Fixed commit message (first line was blank)



---

archive/issue_comments_096515.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@jdemeyer](#comment:49):\n> Replying to [@jhpalmieri](#comment:48):\n> > You're holding up the patch because of this?\n\n> \n> No, I'm not.\n\nChanging it \"needs work\" instead of merging it seems like holding it up...\n \n> Of course, the release manager can do it, but I think it is better that I point out these minor issues to the aurhors\n\nSure.\n\n> and that they fix them \n\nWhy?  If it's trivial to fix, why does it matter who does it?  If you insist that the authors do it every time, you're adding needless bureaucracy.  If anyone notices a problem that's trivial to fix, they should just do it.  Sage is not run by the French government: it is not supposed to be governed by rigid bureaucratic rules, but instead by common sense whenever possible.  Leif, the same goes for you: if you see a problem like missing line breaks in the commit message, and if it seems clear that other work on the ticket has stopped, why not just fix it?  That seems more productive than waiting until someone else (like the release manager) notices it and then commenting \"I was aware of that.\"\n\n> (does it matter if it takes 10 hours?).\n\nIf it's the 10 hours during which a version is released, yes.  But 10 hours is just an example.  What if I were on vacation or at a conference with little or no internet access, or swamped with grading or research or other issues, and couldn't get to this for a week or two?  This particular ticket is not very important, so if it had missed being included in the upcoming version of Sage, no big deal, but why incur a possible long delay and require the author to fix it?\n\n> Imagine you have 10 tickets with various of these minor issues.\n\nI don't have to imagine it, I've been release manager and fixed a number of issues like this (for example, commit messages without the ticket number).  I may have then posted to the ticket what the problem was, but I took care of fixing it myself.",
    "created_at": "2010-12-03T16:33:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96515",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@jdemeyer](#comment:49):
> Replying to [@jhpalmieri](#comment:48):
> > You're holding up the patch because of this?

> 
> No, I'm not.

Changing it "needs work" instead of merging it seems like holding it up...
 
> Of course, the release manager can do it, but I think it is better that I point out these minor issues to the aurhors

Sure.

> and that they fix them 

Why?  If it's trivial to fix, why does it matter who does it?  If you insist that the authors do it every time, you're adding needless bureaucracy.  If anyone notices a problem that's trivial to fix, they should just do it.  Sage is not run by the French government: it is not supposed to be governed by rigid bureaucratic rules, but instead by common sense whenever possible.  Leif, the same goes for you: if you see a problem like missing line breaks in the commit message, and if it seems clear that other work on the ticket has stopped, why not just fix it?  That seems more productive than waiting until someone else (like the release manager) notices it and then commenting "I was aware of that."

> (does it matter if it takes 10 hours?).

If it's the 10 hours during which a version is released, yes.  But 10 hours is just an example.  What if I were on vacation or at a conference with little or no internet access, or swamped with grading or research or other issues, and couldn't get to this for a week or two?  This particular ticket is not very important, so if it had missed being included in the upcoming version of Sage, no big deal, but why incur a possible long delay and require the author to fix it?

> Imagine you have 10 tickets with various of these minor issues.

I don't have to imagine it, I've been release manager and fixed a number of issues like this (for example, commit messages without the ticket number).  I may have then posted to the ticket what the problem was, but I took care of fixing it myself.



---

archive/issue_comments_096516.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@jhpalmieri](#comment:50):\n> Leif, the same goes for you: if you see a problem like missing line breaks in the commit message, and if it seems clear that other work on the ticket has stopped, why not just fix it?  That seems more productive than waiting until someone else (like the release manager) notices it and then commenting \"I was aware of that.\"\n\nAs I said, I considered it a minor issue (and was pretty sure *you* were also aware of it), so did not even mention it.\n\nPerhaps I should have, but it's IMHO relatively useless to upload another patch just fixing the commit message, since that usually causes more confusion. (I actually did so on other tickets, because *I knew* the author was busy / unavailable.)\n\nIf we had different access rights on trac (e.g. reviewers as \"invited\" co-authors with the ability to change attachments of others), that would be different.",
    "created_at": "2010-12-03T17:36:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96516",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@jhpalmieri](#comment:50):
> Leif, the same goes for you: if you see a problem like missing line breaks in the commit message, and if it seems clear that other work on the ticket has stopped, why not just fix it?  That seems more productive than waiting until someone else (like the release manager) notices it and then commenting "I was aware of that."

As I said, I considered it a minor issue (and was pretty sure *you* were also aware of it), so did not even mention it.

Perhaps I should have, but it's IMHO relatively useless to upload another patch just fixing the commit message, since that usually causes more confusion. (I actually did so on other tickets, because *I knew* the author was busy / unavailable.)

If we had different access rights on trac (e.g. reviewers as "invited" co-authors with the ability to change attachments of others), that would be different.



---

archive/issue_comments_096517.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@jhpalmieri](#comment:50):\n> Changing it \"needs work\" instead of merging it seems like holding it up...\n\nMy interpretation is: changing it to \"needs_work\" is a way of signaling the author, that's all...",
    "created_at": "2010-12-03T19:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96517",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@jhpalmieri](#comment:50):
> Changing it "needs work" instead of merging it seems like holding it up...

My interpretation is: changing it to "needs_work" is a way of signaling the author, that's all...



---

archive/issue_events_134097.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-03T19:05:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134097"
}
```



---

archive/issue_events_134098.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-03T19:05:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134098"
}
```



---

archive/issue_comments_096518.json:
```json
{
    "body": "Merged: **sage-4.6.1.alpha3**",
    "created_at": "2010-12-03T19:05:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96518",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.6.1.alpha3**



---

archive/issue_comments_096519.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nApparently this doesn't work with upgrades, if the flag file already exists.\n\nI think `spkg/install` should check if one with the previous semantics (present, but usually empty => `SAGE64=yes`) exists and then write the new one, containing \"yes\" or \"no\".\n\n`sage-env` and `sage-check-64` have to be the new versions immediately after this as well.",
    "created_at": "2010-12-06T10:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96519",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:54" align="right">comment:54</div>

Apparently this doesn't work with upgrades, if the flag file already exists.

I think `spkg/install` should check if one with the previous semantics (present, but usually empty => `SAGE64=yes`) exists and then write the new one, containing "yes" or "no".

`sage-env` and `sage-check-64` have to be the new versions immediately after this as well.



---

archive/issue_comments_096520.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@nexttime](#comment:54):\n> Apparently this doesn't work with upgrades, if the flag file already exists.\n> \n> I think `spkg/install` should check if one with the previous semantics (present, but usually empty => `SAGE64=yes`) exists and then write the new one, containing \"yes\" or \"no\".\n> \n> `sage-env` and `sage-check-64` have to be the new versions immediately after this as well.\n\nSee for example http://build.sagemath.org/sage/builders/OSX%2010.6-64%20up%20%28bsd%29/builds/8/steps/shell_2/logs/stdio .",
    "created_at": "2010-12-06T10:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96520",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@nexttime](#comment:54):
> Apparently this doesn't work with upgrades, if the flag file already exists.
> 
> I think `spkg/install` should check if one with the previous semantics (present, but usually empty => `SAGE64=yes`) exists and then write the new one, containing "yes" or "no".
> 
> `sage-env` and `sage-check-64` have to be the new versions immediately after this as well.

See for example http://build.sagemath.org/sage/builders/OSX%2010.6-64%20up%20%28bsd%29/builds/8/steps/shell_2/logs/stdio .



---

archive/issue_comments_096521.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nTrouble with `sage -ba`, see #10436.",
    "created_at": "2010-12-06T14:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96521",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Trouble with `sage -ba`, see #10436.



---

archive/issue_comments_096522.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nI don't think I have any time to work on this right now.  If no one else has time either, then the best solution might be to back it out; it was not very high priority to begin with.",
    "created_at": "2010-12-06T17:05:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96522",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:57" align="right">comment:57</div>

I don't think I have any time to work on this right now.  If no one else has time either, then the best solution might be to back it out; it was not very high priority to begin with.



---

archive/issue_comments_096523.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@jhpalmieri](#comment:57):\n> I don't think I have any time to work on this right now.  If no one else has time either, then the best solution might be to back it out;\n\nAllright, current plan is to **unmerge** this in sage-4.6.1.rc0.",
    "created_at": "2010-12-16T09:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96523",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@jhpalmieri](#comment:57):
> I don't think I have any time to work on this right now.  If no one else has time either, then the best solution might be to back it out;

Allright, current plan is to **unmerge** this in sage-4.6.1.rc0.



---

archive/issue_events_134099.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-19T09:35:18Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134099"
}
```



---

archive/issue_comments_096524.json:
```json
{
    "body": "Changed merged from **sage-4.6.1.alpha3** to none",
    "created_at": "2010-12-19T09:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96524",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.6.1.alpha3** to none



---

archive/issue_events_134100.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-19T09:35:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134100"
}
```



---

archive/issue_comments_096525.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nNew patches here should perhaps be based on #9960 (which currently needs review, but hopefully gets merged soon before it further rottens - just rebased it to Sage 4.6.1.rc0.)\n\n(#9960 mainly patches `sage-spkg`, but also `sage-sage` and `sage-env`.)",
    "created_at": "2010-12-31T05:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96525",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:62" align="right">comment:62</div>

New patches here should perhaps be based on #9960 (which currently needs review, but hopefully gets merged soon before it further rottens - just rebased it to Sage 4.6.1.rc0.)

(#9960 mainly patches `sage-spkg`, but also `sage-sage` and `sage-env`.)



---

archive/issue_events_134101.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-18T13:48:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134101"
}
```



---

archive/issue_events_134102.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-18T13:48:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134102"
}
```



---

archive/issue_comments_096526.json:
```json
{
    "body": "Replying to [ticket:10303 jhpalmieri]:\n> There are some problems with SAGE64 and sage-check-64.  First, sage-check-64 gets run whenever sage-env gets run, which is way too often.  As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like \"sage -hg\":\n> \n> ```\n> $ sage -hg status\n> Detected SAGE64 flag\n> Building Sage on OS X in 64-bit mode\n> ```\n> This is annoying on its own, but it also produces incorrect information when running \"sage -pkg\": the extra messages make hg think that there are unchecked in changes.\n> \n> Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform.\n> \n> In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris.\n> \n> Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build.  This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted.\n> \n> The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.  Since it gets run by sage-spkg, it is now included in spkg/base.\n> \n> \n> ---\n> \n> I've asked some questions about this on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42573acff76e26b0?tvc=2).   If the answers are not what I expect, then this may need to be rethought.\n> \n> \n> ---\n> \n> Instructions:\n> \n> - apply trac_10303-scripts-SAGE64.v3.patch.\n> \n> - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n> \n> - apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base).\n> \n> To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.",
    "created_at": "2011-01-28T20:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96526",
    "user": "https://github.com/sagetrac-patioheater12"
}
```

Replying to [ticket:10303 jhpalmieri]:
> There are some problems with SAGE64 and sage-check-64.  First, sage-check-64 gets run whenever sage-env gets run, which is way too often.  As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like "sage -hg":
> 
> ```
> $ sage -hg status
> Detected SAGE64 flag
> Building Sage on OS X in 64-bit mode
> ```
> This is annoying on its own, but it also produces incorrect information when running "sage -pkg": the extra messages make hg think that there are unchecked in changes.
> 
> Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform.
> 
> In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris.
> 
> Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build.  This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted.
> 
> The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.  Since it gets run by sage-spkg, it is now included in spkg/base.
> 
> 
> ---
> 
> I've asked some questions about this on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42573acff76e26b0?tvc=2).   If the answers are not what I expect, then this may need to be rethought.
> 
> 
> ---
> 
> Instructions:
> 
> - apply trac_10303-scripts-SAGE64.v3.patch.
> 
> - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
> 
> - apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base).
> 
> To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.



---

archive/issue_comments_096527.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,32 +1,5 @@\n-There are some problems with SAGE64 and sage-check-64.  First, sage-check-64 gets run whenever sage-env gets run, which is way too often.  As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like \"sage -hg\":\n+## Patio Heaters - Its Convenience Matters\n \n-```\n-$ sage -hg status\n-Detected SAGE64 flag\n-Building Sage on OS X in 64-bit mode\n-```\n-This is annoying on its own, but it also produces incorrect information when running \"sage -pkg\": the extra messages make hg think that there are unchecked in changes.\n+![](http://www.charlescamping.ie/onlinestore/images/patio%20heater.JPG)\n \n-Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform.\n-\n-In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris.\n-\n-Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build.  This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted.\n-\n-The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.  Since it gets run by sage-spkg, it is now included in spkg/base.\n-\n----\n-\n-I've asked some questions about this on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42573acff76e26b0?tvc=2).   If the answers are not what I expect, then this may need to be rethought.\n-\n----\n-\n-Instructions:\n-\n-- apply trac_10303-scripts-SAGE64.v3.patch.\n-\n-- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n-\n-- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base).\n-\n-To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.\n+**[Patio heaters](http://patioheaterz.com/)** has many different forms and it can also be transported anywhere you like. It provides you the moderate amount of warmth that you need and it is more convenient for you to use because you can put it anywhere. You can spend a lot of time with your family even on a cold winter season.\n``````\n",
    "created_at": "2011-01-28T20:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96527",
    "user": "https://github.com/sagetrac-patioheater12"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,32 +1,5 @@
-There are some problems with SAGE64 and sage-check-64.  First, sage-check-64 gets run whenever sage-env gets run, which is way too often.  As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like "sage -hg":
+## Patio Heaters - Its Convenience Matters
 
-```
-$ sage -hg status
-Detected SAGE64 flag
-Building Sage on OS X in 64-bit mode
-```
-This is annoying on its own, but it also produces incorrect information when running "sage -pkg": the extra messages make hg think that there are unchecked in changes.
+![](http://www.charlescamping.ie/onlinestore/images/patio%20heater.JPG)
 
-Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform.
-
-In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris.
-
-Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build.  This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted.
-
-The attached patch gets rid of the distinction between OS X, Solaris, and everything else.  It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already).  It no longer runs it from sage-env.  Since it gets run by sage-spkg, it is now included in spkg/base.
-
----
-
-I've asked some questions about this on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42573acff76e26b0?tvc=2).   If the answers are not what I expect, then this may need to be rethought.
-
----
-
-Instructions:
-
-- apply trac_10303-scripts-SAGE64.v3.patch.
-
-- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
-
-- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base).
-
-To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.
+**[Patio heaters](http://patioheaterz.com/)** has many different forms and it can also be transported anywhere you like. It provides you the moderate amount of warmth that you need and it is more convenient for you to use because you can put it anywhere. You can spend a lot of time with your family even on a cold winter season.
``````




---

archive/issue_comments_096528.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,9 @@\n-## Patio Heaters - Its Convenience Matters\n+There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like \"sage -hg\": ` $ sage -hg status Detected SAGE64 flag Building Sage on OS X in 64-bit mode ` This is annoying on its own, but it also produces incorrect information when running \"sage -pkg\": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted. The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. \n \n-![](http://www.charlescamping.ie/onlinestore/images/patio%20heater.JPG)\n+---\n \n-**[Patio heaters](http://patioheaterz.com/)** has many different forms and it can also be transported anywhere you like. It provides you the moderate amount of warmth that you need and it is more convenient for you to use because you can put it anywhere. You can spend a lot of time with your family even on a cold winter season.\n+I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought. -\n+\n+---\n+\n+Instructions: - apply trac_10303-scripts-SAGE64.v3.patch. - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file. - apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.\n``````\n",
    "created_at": "2011-01-28T23:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96528",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,9 @@
-## Patio Heaters - Its Convenience Matters
+There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like "sage -hg": ` $ sage -hg status Detected SAGE64 flag Building Sage on OS X in 64-bit mode ` This is annoying on its own, but it also produces incorrect information when running "sage -pkg": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted. The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. 
 
-![](http://www.charlescamping.ie/onlinestore/images/patio%20heater.JPG)
+---
 
-**[Patio heaters](http://patioheaterz.com/)** has many different forms and it can also be transported anywhere you like. It provides you the moderate amount of warmth that you need and it is more convenient for you to use because you can put it anywhere. You can spend a lot of time with your family even on a cold winter season.
+I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought. -
+
+---
+
+Instructions: - apply trac_10303-scripts-SAGE64.v3.patch. - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file. - apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.
``````




---

archive/issue_comments_096529.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nWhat's the status for this issue?\n\nIt breaks `sage -combinat install` on the OS X machine of a\ncolleague, precisely due to the SAGE64 verbosity effect in\n`sage -hg`.\n\nThanks!\n                        Nicolas",
    "created_at": "2011-03-03T08:48:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96529",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:66" align="right">comment:66</div>

What's the status for this issue?

It breaks `sage -combinat install` on the OS X machine of a
colleague, precisely due to the SAGE64 verbosity effect in
`sage -hg`.

Thanks!
                        Nicolas



---

archive/issue_comments_096530.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,22 @@\n-There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like \"sage -hg\": ` $ sage -hg status Detected SAGE64 flag Building Sage on OS X in 64-bit mode ` This is annoying on its own, but it also produces incorrect information when running \"sage -pkg\": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted. The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. \n+There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like \"sage -hg\": \n+\n+``` \n+$ sage -hg status \n+Detected SAGE64 flag \n+Building Sage on OS X in 64-bit mode \n+``` \n+This is annoying on its own, but it also produces incorrect information when running \"sage -pkg\": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to \"yes\", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to \"no\", then this file should be ignored, and in fact deleted. \n+\n+The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is \"no\". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. \n \n ---\n \n-I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought. -\n+I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought.\n \n ---\n \n-Instructions: - apply trac_10303-scripts-SAGE64.v3.patch. - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file. - apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.\n+Instructions:\n+\n+- apply trac_10303-scripts-SAGE64.v3.patch.\n+- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n+- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.\n``````\n",
    "created_at": "2011-03-04T06:07:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96530",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,22 @@
-There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like "sage -hg": ` $ sage -hg status Detected SAGE64 flag Building Sage on OS X in 64-bit mode ` This is annoying on its own, but it also produces incorrect information when running "sage -pkg": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted. The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. 
+There are some problems with SAGE64 and sage-check-64. First, sage-check-64 gets run whenever sage-env gets run, which is way too often. As a consequence, if SAGE64 is set, I get extra messages printed whenever I run anything like "sage -hg": 
+
+``` 
+$ sage -hg status 
+Detected SAGE64 flag 
+Building Sage on OS X in 64-bit mode 
+``` 
+This is annoying on its own, but it also produces incorrect information when running "sage -pkg": the extra messages make hg think that there are unchecked in changes. Also, in several files in the scripts repo, comments say that SAGE64 is only for use on OS X or Solaris, but there are no such distinctions in various spkg-install files that I've looked at: if SAGE64 is set, then it tries to build in 64-bit mode, regardless of the platform. In contrast, the file sage-check-64 only prints messages about building 64-bit if on OS X or Solaris. Finally, the script sage-check-64 creates a file SAGE_LOCAL/lib/sage-64.txt if SAGE64 is set to "yes", to record the fact that this is a 64-bit build. This makes sense if SAGE64 is unset, but if the user sets SAGE64 to "no", then this file should be ignored, and in fact deleted. 
+
+The attached patch gets rid of the distinction between OS X, Solaris, and everything else. It deletes sage-64.txt if SAGE64 is "no". It also only runs sage-check-64 from sage-spkg (which is what calls spkg-install) and sage-build (which may not be strictly necessary, but it was there already). It no longer runs it from sage-env. Since it gets run by sage-spkg, it is now included in spkg/base. 
 
 ---
 
-I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought. -
+I've asked some questions about this on  sage-devel. If the answers are not what I expect, then this may need to be rethought.
 
 ---
 
-Instructions: - apply trac_10303-scripts-SAGE64.v3.patch. - copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file. - apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.
+Instructions:
+
+- apply trac_10303-scripts-SAGE64.v3.patch.
+- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
+- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.
``````




---

archive/issue_comments_096531.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nThe status is, the patches here don't work with upgrades.  There was also some debate about the approach in general.  If someone else has the time and energy to work on it, please go ahead; it might be best to start over.",
    "created_at": "2011-03-04T06:07:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96531",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:67" align="right">comment:67</div>

The status is, the patches here don't work with upgrades.  There was also some debate about the approach in general.  If someone else has the time and energy to work on it, please go ahead; it might be best to start over.



---

archive/issue_comments_096532.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nFor future reference: if the proposed fix works like the old one -- copying sage-check-64 to spkg/base -- then you must add sage-check-64 to the .hgignore file for the base repo.  See also #11073 for other issues dealing with the base repo.",
    "created_at": "2011-03-28T20:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96532",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:68" align="right">comment:68</div>

For future reference: if the proposed fix works like the old one -- copying sage-check-64 to spkg/base -- then you must add sage-check-64 to the .hgignore file for the base repo.  See also #11073 for other issues dealing with the base repo.



---

archive/issue_comments_096533.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nI'm considering reviving this ticket.  As it stands, this ticket deals with two separate issues:\n\n- where sage-check-64 is called, where the variable $SAGE64 is set (in sage-env or sage-check-64), etc.\n- what sage-check-64 actually does: which platforms are relevant, does it write anything to the file SAGE_ROOT/local/lib/sage-64.txt, etc.\n\nThe second of these is more controversial, and also more complicated, so I think it should go on a separate ticket.  The first of these can be solved, I think, by using a slight modification of the \"v4\" patch.  Basically, we should modify everything touched by that patch *except* for sage-check-64.  I'll test this and see how things go; if it looks good, I'll post a patch and open up a second ticket for rewriting sage-check-64.",
    "created_at": "2011-03-28T22:17:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96533",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:69" align="right">comment:69</div>

I'm considering reviving this ticket.  As it stands, this ticket deals with two separate issues:

- where sage-check-64 is called, where the variable $SAGE64 is set (in sage-env or sage-check-64), etc.
- what sage-check-64 actually does: which platforms are relevant, does it write anything to the file SAGE_ROOT/local/lib/sage-64.txt, etc.

The second of these is more controversial, and also more complicated, so I think it should go on a separate ticket.  The first of these can be solved, I think, by using a slight modification of the "v4" patch.  Basically, we should modify everything touched by that patch *except* for sage-check-64.  I'll test this and see how things go; if it looks good, I'll post a patch and open up a second ticket for rewriting sage-check-64.



---

archive/issue_comments_096534.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@jhpalmieri](#comment:69):\n> I'm considering reviving this ticket. \n\nBrave of you John!\n\nI've just spent 15 minutes reading all the comments. This is another of the many tickets that gets out of hand, with a huge number of requested changes. \n\n> As it stands, this ticket deals with two separate issues:\n\nThey should be on separate tickets. \n\nIt might be simpler to ask the release manager to close this ticket as \"duplicate\", and open two new tickets which deal with two issues in isolation. That will save there being a lot of irrelevant comments on this ticket. This has become too large for comfort. \n\nDave",
    "created_at": "2011-03-28T23:08:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96534",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@jhpalmieri](#comment:69):
> I'm considering reviving this ticket. 

Brave of you John!

I've just spent 15 minutes reading all the comments. This is another of the many tickets that gets out of hand, with a huge number of requested changes. 

> As it stands, this ticket deals with two separate issues:

They should be on separate tickets. 

It might be simpler to ask the release manager to close this ticket as "duplicate", and open two new tickets which deal with two issues in isolation. That will save there being a lot of irrelevant comments on this ticket. This has become too large for comfort. 

Dave



---

archive/issue_events_134103.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-03-29T04:45:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134103"
}
```



---

archive/issue_events_134104.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-03-29T04:45:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134104"
}
```



---

archive/issue_comments_096535.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,8 +15,14 @@\n \n ---\n \n+Follow-up ticket: #11077.\n+\n+---\n+\n Instructions:\n \n-- apply trac_10303-scripts-SAGE64.v3.patch.\n-- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.\n-- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run \"sage -sdist ...\" to make sure that the necessary files from the scripts repo are copied to spkg/base.\n+- apply [attachment: trac_10303-scripts-SAGE64.v5.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v5.patch.gz) to the scripts repo.\n+- apply [attachment: trac_10303-root-repo.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-root-repo.patch.gz) to the root repo.\n+- apply [attachment: 10303-add-sage-check-64-dot-hgignore.patch](https://github.com/sagemath/sage/files/ticket10303/10303-add-sage-check-64-dot-hgignore.patch.gz) to the spkg/base repo.\n+\n+This depends on the patch at #9960.  \n``````\n",
    "created_at": "2011-03-29T04:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96535",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,8 +15,14 @@
 
 ---
 
+Follow-up ticket: #11077.
+
+---
+
 Instructions:
 
-- apply trac_10303-scripts-SAGE64.v3.patch.
-- copy trac_10303-install to SAGE_ROOT/spkg/install, or apply the corresponding patch for that file.
-- apply 10303-add-sage-check-64-dot-hgignore.patch to the base repo (SAGE_ROOT/spkg/base). To produce a version with which to test from scratch, you then have to run "sage -sdist ..." to make sure that the necessary files from the scripts repo are copied to spkg/base.
+- apply [attachment: trac_10303-scripts-SAGE64.v5.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v5.patch.gz) to the scripts repo.
+- apply [attachment: trac_10303-root-repo.patch](https://github.com/sagemath/sage/files/ticket10303/trac_10303-root-repo.patch.gz) to the root repo.
+- apply [attachment: 10303-add-sage-check-64-dot-hgignore.patch](https://github.com/sagemath/sage/files/ticket10303/10303-add-sage-check-64-dot-hgignore.patch.gz) to the spkg/base repo.
+
+This depends on the patch at #9960.  
``````




---

archive/issue_comments_096536.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nHere are some patches.  I believe these should also fix the problem at #10436.  (I think you can see that problem if you apply the scripts patch, but then revert just the file sage-build.  Then build the polybori spkg without SAGE64 being set.)",
    "created_at": "2011-03-29T04:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96536",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:71" align="right">comment:71</div>

Here are some patches.  I believe these should also fix the problem at #10436.  (I think you can see that problem if you apply the scripts patch, but then revert just the file sage-build.  Then build the polybori spkg without SAGE64 being set.)



---

archive/issue_comments_096537.json:
```json
{
    "body": "Attachment: **[trac_10303-scripts-SAGE64.v5.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v5.patch.gz)**\n\nscripts repo",
    "created_at": "2011-03-29T04:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96537",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_10303-scripts-SAGE64.v5.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-scripts-SAGE64.v5.patch.gz)**

scripts repo



---

archive/issue_comments_096538.json:
```json
{
    "body": "root repo",
    "created_at": "2011-03-29T04:46:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96538",
    "user": "https://github.com/jhpalmieri"
}
```

root repo



---

archive/issue_comments_096539.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nAttachment: **[trac_10303-root-repo.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-root-repo.patch.gz)**\n\nBy the way, I took Sage 4.7.alpha2, applied #9960 and the patches here, and created a [tar file](http://sage.math.washington.edu/home/palmieri/misc/10303/sage-4.7.10303.tar) and an upgrade path: \n\n- [http://sage.math.washington.edu/home/palmieri/misc/10303/sage-4.7.10303/](http://sage.math.washington.edu/home/palmieri/misc/10303/sage-4.7.10303/).",
    "created_at": "2011-03-29T04:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96539",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:72" align="right">comment:72</div>

Attachment: **[trac_10303-root-repo.patch.gz](https://github.com/sagemath/sage/files/ticket10303/trac_10303-root-repo.patch.gz)**

By the way, I took Sage 4.7.alpha2, applied #9960 and the patches here, and created a [tar file](http://sage.math.washington.edu/home/palmieri/misc/10303/sage-4.7.10303.tar) and an upgrade path: 

- [http://sage.math.washington.edu/home/palmieri/misc/10303/sage-4.7.10303/](http://sage.math.washington.edu/home/palmieri/misc/10303/sage-4.7.10303/).



---

archive/issue_comments_096540.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nI don't know enough about the build process of Sage, i.e. the role of all these scripts, to comment much more on this ticket. It is also dependent on #9960 which is listed as needing work. \n\nI'm happy to apply the patches and try some builds with and without setting SAGE64. But I'm not going to be the one to give this a positive review, as I don't understand it enough. \n\nI'll also take a look at #11077 and put some comments there. \n\nDave",
    "created_at": "2011-03-29T15:54:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96540",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:73" align="right">comment:73</div>

I don't know enough about the build process of Sage, i.e. the role of all these scripts, to comment much more on this ticket. It is also dependent on #9960 which is listed as needing work. 

I'm happy to apply the patches and try some builds with and without setting SAGE64. But I'm not going to be the one to give this a positive review, as I don't understand it enough. 

I'll also take a look at #11077 and put some comments there. 

Dave



---

archive/issue_events_134105.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-12T15:10:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "milestone_number": null,
    "milestone_title": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134105"
}
```



---

archive/issue_events_134106.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-12T15:10:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134106"
}
```



---

archive/issue_comments_096541.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nChanging milestone to 4.7.1 since it depends on #9960.",
    "created_at": "2011-05-12T15:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96541",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:74" align="right">comment:74</div>

Changing milestone to 4.7.1 since it depends on #9960.



---

archive/issue_events_134107.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-09T07:50:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134107"
}
```



---

archive/issue_events_134108.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-09T07:50:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134108"
}
```



---

archive/issue_events_134109.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-23T13:05:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134109"
}
```



---

archive/issue_events_134110.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-23T13:05:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "c6c6c6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134110"
}
```



---

archive/issue_events_134111.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-23T13:05:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134111"
}
```



---

archive/issue_events_134112.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-23T13:05:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134112"
}
```



---

archive/issue_events_134113.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-23T13:05:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10303#event-134113"
}
```



---

archive/issue_comments_096542.json:
```json
{
    "body": "Changed reviewer from **David Kirkby, Leif Leonhardy** to **John Palmieri, David Kirkby, Leif Leonhardy**",
    "created_at": "2012-08-23T13:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96542",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **David Kirkby, Leif Leonhardy** to **John Palmieri, David Kirkby, Leif Leonhardy**



---

archive/issue_comments_096543.json:
```json
{
    "body": "Changed author from **John Palmieri** to none",
    "created_at": "2012-08-23T13:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96543",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **John Palmieri** to none



---

archive/issue_comments_096544.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nI think none of the issues mentioned are still relevant (some were fixed at #12789).  I'm going to close, but feel to protest and disagree.",
    "created_at": "2012-08-23T13:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10303#issuecomment-96544",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:76" align="right">comment:76</div>

I think none of the issues mentioned are still relevant (some were fixed at #12789).  I'm going to close, but feel to protest and disagree.
