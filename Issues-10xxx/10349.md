# Issue 10349: Implementation of mutations for matrices

archive/issues_010348.json:
```json
{
    "body": "This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n\n**CC:**  hthomas@unb.ca\n\n**Keywords:** matrix mutation\n\n**Dependencies:** #10347\n\n**Author:** Christian Stump\n\n**Reviewer:** Hugh Thomas\n\n**Merged:** sage-5.0.beta6\n\nIssue created by migration from https://trac.sagemath.org/ticket/10349\n\n",
    "closed_at": "2012-02-27T11:20:13Z",
    "created_at": "2010-11-27T23:13:35Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Implementation of mutations for matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10349",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```
This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.

**CC:**  hthomas@unb.ca

**Keywords:** matrix mutation

**Dependencies:** #10347

**Author:** Christian Stump

**Reviewer:** Hugh Thomas

**Merged:** sage-5.0.beta6

Issue created by migration from https://trac.sagemath.org/ticket/10349





---

archive/issue_comments_123542.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-02-08T16:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123542",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_123543.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n+\n+Depends on #10347.\n``````\n",
    "created_at": "2011-02-22T18:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123543",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.
+
+Depends on #10347.
``````




---

archive/issue_comments_123544.json:
```json
{
    "body": "<a id='comment:3'></a>\nFor the buildbot:\n\nDepends on #10347.",
    "created_at": "2011-02-24T17:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123544",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:3'></a>
For the buildbot:

Depends on #10347.



---

archive/issue_comments_123545.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n-\n-Depends on #10347.\n``````\n",
    "created_at": "2011-06-08T17:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123545",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1 @@
 This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.
-
-Depends on #10347.
``````




---

archive/issue_comments_123546.json:
```json
{
    "body": "**Dependencies:** 10347",
    "created_at": "2011-06-08T17:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123546",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Dependencies:** 10347



---

archive/issue_comments_123547.json:
```json
{
    "body": "**Changing dependencies** from \"10347\" to \"#10347\".",
    "created_at": "2011-06-10T14:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123547",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Changing dependencies** from "10347" to "#10347".



---

archive/issue_comments_123548.json:
```json
{
    "body": "<a id='comment:6'></a>\nHi Christian--\n\nWhat do you think about the idea of checking that 0 <= k < min(ncols,nrows)?  Your code is very nicely written to be safe even if someone tries to mutate a 2x2 matrix at row 15, but they shouldn't be doing that.  More importantly, they shouldn't be trying to mutate a 2n x n matrix at row j for n<= j < 2n -- for such a parameter, mutation is *undefined*.  Returning what looks like meaningful output in such a case is potentially deceptive.  (That's my view, at any rate, though if you disagree, I could be convinced otherwise.)  \n\nIt's also true that the principal part of B should be skew-symmetrizable, but I don't think it's necessary to check that -- though maybe it would be good to mention this in the documentation?  (The legit range of k values should also go in the documentation, I guess.)\n\nAnd, Zelevinsky :)\n\nOtherwise, though, it looks good.\n\ncheers,\n\nHugh",
    "created_at": "2011-06-12T09:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123548",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:6'></a>
Hi Christian--

What do you think about the idea of checking that 0 <= k < min(ncols,nrows)?  Your code is very nicely written to be safe even if someone tries to mutate a 2x2 matrix at row 15, but they shouldn't be doing that.  More importantly, they shouldn't be trying to mutate a 2n x n matrix at row j for n<= j < 2n -- for such a parameter, mutation is *undefined*.  Returning what looks like meaningful output in such a case is potentially deceptive.  (That's my view, at any rate, though if you disagree, I could be convinced otherwise.)  

It's also true that the principal part of B should be skew-symmetrizable, but I don't think it's necessary to check that -- though maybe it would be good to mention this in the documentation?  (The legit range of k values should also go in the documentation, I guess.)

And, Zelevinsky :)

Otherwise, though, it looks good.

cheers,

Hugh



---

archive/issue_comments_123549.json:
```json
{
    "body": "**Reviewer:** Hugh Thomas",
    "created_at": "2011-06-12T09:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123549",
    "user": "https://github.com/hughrthomas"
}
```

**Reviewer:** Hugh Thomas



---

archive/issue_comments_123550.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2011-06-12T09:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123550",
    "user": "https://github.com/hughrthomas"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_123551.json:
```json
{
    "body": "<a id='comment:7'></a>\nOh, one more comment, in the doc-string, you have \"b-matrix\"; I'd prefer \"B-matrix\".    \n\ncheers\n\nHugh",
    "created_at": "2011-06-12T09:52:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123551",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:7'></a>
Oh, one more comment, in the doc-string, you have "b-matrix"; I'd prefer "B-matrix".    

cheers

Hugh



---

archive/issue_comments_123552.json:
```json
{
    "body": "<a id='comment:8'></a>\nDear Hugh,\n\nI added the changes you suggested -- thanks a lot for looking at it!\n\nChristian",
    "created_at": "2011-06-12T12:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123552",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:8'></a>
Dear Hugh,

I added the changes you suggested -- thanks a lot for looking at it!

Christian



---

archive/issue_comments_123553.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-06-15T13:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123553",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_events_032184.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/stumpc5",
    "created_at": "2011-06-16T21:40:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10349#event-32184"
}
```



---

archive/issue_comments_123554.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [stumpc5](#comment%3A8):\n\nI just pushed a new version which should be compatible with the #10347, if you also wanna have a look here...\n\nBest, Christian",
    "created_at": "2012-02-15T08:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123554",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:11'></a>
Replying to [stumpc5](#comment%3A8):

I just pushed a new version which should be compatible with the #10347, if you also wanna have a look here...

Best, Christian



---

archive/issue_comments_123555.json:
```json
{
    "body": "<a id='comment:12'></a>\nI'll take a look.\n\ncheers,\n\nHugh",
    "created_at": "2012-02-15T12:38:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123555",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:12'></a>
I'll take a look.

cheers,

Hugh



---

archive/issue_comments_123556.json:
```json
{
    "body": "<a id='comment:13'></a>\nHi Christian--\n\nWhat's the point of declaring k to be of type Py_ssize_t?  I thought the point was that this would allow k to be huge, but in that case, it seems that you would get overflows when you run into the fact that i and j are declared to be integers.  \n\ncheers,\n\nHugh",
    "created_at": "2012-02-18T14:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123556",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:13'></a>
Hi Christian--

What's the point of declaring k to be of type Py_ssize_t?  I thought the point was that this would allow k to be huge, but in that case, it seems that you would get overflows when you run into the fact that i and j are declared to be integers.  

cheers,

Hugh



---

archive/issue_comments_123557.json:
```json
{
    "body": "<a id='comment:14'></a>\nOtherwise, I am happy.  The patchbot was happy with this patch before, right?  So I assume that its present unhappiness (?) is unrelated to the patch itself, so I guess all that's left is the question in my previous comment.",
    "created_at": "2012-02-18T14:47:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123557",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:14'></a>
Otherwise, I am happy.  The patchbot was happy with this patch before, right?  So I assume that its present unhappiness (?) is unrelated to the patch itself, so I guess all that's left is the question in my previous comment.



---

archive/issue_comments_123558.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n+This patch implehttp://www.python.org/dev/peps/pep-0353/ments a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n``````\n",
    "created_at": "2012-02-18T15:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123558",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.
+This patch implehttp://www.python.org/dev/peps/pep-0353/ments a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.
``````




---

archive/issue_comments_123559.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [hthomas](#comment%3A13):\n> Hi Christian--\n> \n> What's the point of declaring k to be of type Py_ssize_t?  I thought the point was that this would allow k to be huge, but in that case, it seems that you would get overflows when you run into the fact that i and j are declared to be integers.  \n\n\nHi Hugh,\n\n`Py_ssize_t` is the recommended integer type for cython, see http://www.python.org/dev/peps/pep-0353/. In fact, in our current situation there is no advantage of using this type over using `int`. It is used all over in the code for matrices, see for example the method `get_unsafe` - that's why I also used it.",
    "created_at": "2012-02-18T15:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123559",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:15'></a>
Replying to [hthomas](#comment%3A13):
> Hi Christian--
> 
> What's the point of declaring k to be of type Py_ssize_t?  I thought the point was that this would allow k to be huge, but in that case, it seems that you would get overflows when you run into the fact that i and j are declared to be integers.  


Hi Hugh,

`Py_ssize_t` is the recommended integer type for cython, see http://www.python.org/dev/peps/pep-0353/. In fact, in our current situation there is no advantage of using this type over using `int`. It is used all over in the code for matrices, see for example the method `get_unsafe` - that's why I also used it.



---

archive/issue_comments_123560.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This patch implehttp://www.python.org/dev/peps/pep-0353/ments a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n+This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.\n``````\n",
    "created_at": "2012-02-18T15:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123560",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-This patch implehttp://www.python.org/dev/peps/pep-0353/ments a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.
+This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.
``````




---

archive/issue_comments_123561.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [stumpc5](#comment%3A16):\n\nThen why not declare i,j,_ also to be the same type?  It seems to me that if it's ever useful to have chosen that type, you would also have needed i,j,_ to have been of that type.",
    "created_at": "2012-02-18T21:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123561",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:17'></a>
Replying to [stumpc5](#comment%3A16):

Then why not declare i,j,_ also to be the same type?  It seems to me that if it's ever useful to have chosen that type, you would also have needed i,j,_ to have been of that type.



---

archive/attachments_013551.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10349_matrix_mutation-cs.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket10349/trac_10349_matrix_mutation-cs.patch",
    "created_at": "2012-02-19T13:51:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```



---

archive/issue_comments_123562.json:
```json
{
    "body": "contains matrix method mutate",
    "created_at": "2012-02-19T13:51:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123562",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

contains matrix method mutate



---

archive/issue_comments_123563.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [hthomas](#comment%3A17):\n> Replying to [stumpc5](#comment%3A16):\n> \n> Then why not declare i,j,_ also to be the same type?  It seems to me that if it's ever useful to have chosen that type, you would also have needed i,j,_ to have been of that type.  \n\n\nDone!",
    "created_at": "2012-02-19T13:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123563",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:18'></a>
Replying to [hthomas](#comment%3A17):
> Replying to [stumpc5](#comment%3A16):
> 
> Then why not declare i,j,_ also to be the same type?  It seems to me that if it's ever useful to have chosen that type, you would also have needed i,j,_ to have been of that type.  


Done!



---

archive/issue_comments_123564.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-02-22T01:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123564",
    "user": "https://github.com/hughrthomas"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_123565.json:
```json
{
    "body": "<a id='comment:19'></a>\nOkay, then, I think it's ready.  \n\ncheers,\n\nHugh",
    "created_at": "2012-02-22T01:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123565",
    "user": "https://github.com/hughrthomas"
}
```

<a id='comment:19'></a>
Okay, then, I think it's ready.  

cheers,

Hugh



---

archive/issue_events_032185.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-27T11:20:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10349#event-32185"
}
```



---

archive/issue_comments_123566.json:
```json
{
    "body": "**Merged:** sage-5.0.beta6",
    "created_at": "2012-02-27T11:20:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123566",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.beta6



---

archive/issue_comments_123567.json:
```json
{
    "body": "<a id='comment:21'></a>\nHi!\n\nThis patch is merged in, and we want the cluster algebra material to get in. So this comment is for the future.\n\nThe functionality implemented in this ticket is rather specific to the context of cluster algebras. The average matrix user will have no clue what this is about, and might get confused with the unrelated concept of mutability (as in set_immutable). So I would recommend, in a later ticket, to:\n\n- Rename this method to something more specific like cluster_algebra_mutate\n  Maybe even move it into the cluster algebra library\n- Add a minimal description of what the method actually does\n- Add links to the cluster algebra library / tutorial (when it exists)\n- Add link to the _check_symmetrizability",
    "created_at": "2012-03-06T08:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10349",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10349#issuecomment-123567",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:21'></a>
Hi!

This patch is merged in, and we want the cluster algebra material to get in. So this comment is for the future.

The functionality implemented in this ticket is rather specific to the context of cluster algebras. The average matrix user will have no clue what this is about, and might get confused with the unrelated concept of mutability (as in set_immutable). So I would recommend, in a later ticket, to:

- Rename this method to something more specific like cluster_algebra_mutate
  Maybe even move it into the cluster algebra library
- Add a minimal description of what the method actually does
- Add links to the cluster algebra library / tutorial (when it exists)
- Add link to the _check_symmetrizability
