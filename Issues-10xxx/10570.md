# Issue 10570: sage leaves a lot of stackframes alive at startup

archive/issues_010517.json:
```json
{
    "body": "This is a really really bad thing and probably related to a lot of the memory leaks shown up recently. All the ipython frames are probably ok on the stack. But most of the other frames come from a call stack frame which is unneccesarily alive.\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: import gc\nsage: import inspect\nsage: l1=gc.get_objects()\nsage: frames=[x for x in l1 if inspect.isframe(x)]\nsage: len(frames)\n26\nsage: for i in frames: inspect.getframeinfo(i) \n....: \nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/Shell.py', lineno=81, function='mainloop', code_context=['        self.IP.mainloop(banner)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=1577, function='mainloop', code_context=['                self.interact(banner)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=1813, function='interact', code_context=['                more = self.push(line)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=2121, function='push', code_context=['        return more\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=2045, function='runsource', code_context=['            return False\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=2093, function='runcode', code_context=['        return outflag\\n'], index=0)\nTraceback(filename='<ipython console>', lineno=1, function='<module>', code_context=None, index=None)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=5800, function='_init_qqbar', code_context=[\"    ZZX_x = ZZ['x'].gen()\\n\"], index=0)\nTraceback(filename='coerce_actions.pyx', lineno=184, function='sage.structure.coerce_actions.detect_element_action (sage/structure/coerce_actions.c:4184)', code_context=None, index=None)\nTraceback(filename='coerce_actions.pyx', lineno=184, function='sage.structure.coerce_actions.detect_element_action (sage/structure/coerce_actions.c:4184)', code_context=None, index=None)\nTraceback(filename='coerce_actions.pyx', lineno=184, function='sage.structure.coerce_actions.detect_element_action (sage/structure/coerce_actions.c:4184)', code_context=None, index=None)\nTraceback(filename='coerce_actions.pyx', lineno=237, function='sage.structure.coerce_actions.ModuleAction.__init__ (sage/structure/coerce_actions.c:4713)', code_context=None, index=None)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=5253, function='_interval_fast', code_context=['        return v\\n'], index=0)\nTraceback(filename='coerce_actions.pyx', lineno=278, function='sage.structure.coerce_actions.ModuleAction.__init__ (sage/structure/coerce_actions.c:5174)', code_context=None, index=None)\nTraceback(filename='coerce_actions.pyx', lineno=278, function='sage.structure.coerce_actions.ModuleAction.__init__ (sage/structure/coerce_actions.c:5174)', code_context=None, index=None)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=2177, function='__init__', code_context=['        self._value = self._descr._interval_fast(64)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=2854, function='__init__', code_context=['        AlgebraicNumber_base.__init__(self, QQbar, x)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/bin/sage-ipython', lineno=52, function='<module>', code_context=[\"ipy_sage.mainloop(sys_exit=1, banner='')\\n\"], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/Shell.py', lineno=1233, function='start', code_context=['    return shell(user_ns = user_ns)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/Shell.py', lineno=78, function='__init__', code_context=['                               debug=debug,shell_class=shell_class)\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/ipmaker.py', lineno=782, function='make_IPython', code_context=['    return IP\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/ipmaker.py', lineno=66, function='force_import', code_context=['        __import__(modname)\\n'], index=0)\nTraceback(filename='ipy_profile_sage.py', lineno=33, function='<module>', code_context=[\"    _ip.expose_magic('prun', lambda self, s: old_prun(preparse(s)))\\n\"], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/all_cmdline.py', lineno=35, function='<module>', code_context=['sage.misc.session.init()\\n'], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/all.py', lineno=313, function='<module>', code_context=[\"sage.structure.sage_object.register_unpickle_override('sage.categories.category_types', 'ModularAbelianVarieties', ModularAbelianVarieties)\\n\"], index=0)\nTraceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/combinat/species/generating_series.py', lineno=269, function='factorial_gen', code_context=['def factorial_gen():\\n'], index=0)\n```\nApply nothing\n| Sage Version 4.6.1.alpha3, Release Date: 2010-12-05                |\n| Type notebook() for the GUI, and license() for information.        |\n\n**Assignee:** @rlmill\n\n**CC:**  @jdemeyer\n\n**Resolution:** duplicate\n\n**Reviewer:** Burcin Erocal\n\nIssue created by migration from https://trac.sagemath.org/ticket/10570\n\n",
    "closed_at": "2011-05-31T17:16:20Z",
    "created_at": "2011-01-08T00:36:00Z",
    "labels": [
        "component: memleak",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "sage leaves a lot of stackframes alive at startup",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10570",
    "user": "https://github.com/koffie"
}
```
This is a really really bad thing and probably related to a lot of the memory leaks shown up recently. All the ipython frames are probably ok on the stack. But most of the other frames come from a call stack frame which is unneccesarily alive.

```
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: import gc
sage: import inspect
sage: l1=gc.get_objects()
sage: frames=[x for x in l1 if inspect.isframe(x)]
sage: len(frames)
26
sage: for i in frames: inspect.getframeinfo(i) 
....: 
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/Shell.py', lineno=81, function='mainloop', code_context=['        self.IP.mainloop(banner)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=1577, function='mainloop', code_context=['                self.interact(banner)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=1813, function='interact', code_context=['                more = self.push(line)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=2121, function='push', code_context=['        return more\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=2045, function='runsource', code_context=['            return False\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/iplib.py', lineno=2093, function='runcode', code_context=['        return outflag\n'], index=0)
Traceback(filename='<ipython console>', lineno=1, function='<module>', code_context=None, index=None)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=5800, function='_init_qqbar', code_context=["    ZZX_x = ZZ['x'].gen()\n"], index=0)
Traceback(filename='coerce_actions.pyx', lineno=184, function='sage.structure.coerce_actions.detect_element_action (sage/structure/coerce_actions.c:4184)', code_context=None, index=None)
Traceback(filename='coerce_actions.pyx', lineno=184, function='sage.structure.coerce_actions.detect_element_action (sage/structure/coerce_actions.c:4184)', code_context=None, index=None)
Traceback(filename='coerce_actions.pyx', lineno=184, function='sage.structure.coerce_actions.detect_element_action (sage/structure/coerce_actions.c:4184)', code_context=None, index=None)
Traceback(filename='coerce_actions.pyx', lineno=237, function='sage.structure.coerce_actions.ModuleAction.__init__ (sage/structure/coerce_actions.c:4713)', code_context=None, index=None)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=5253, function='_interval_fast', code_context=['        return v\n'], index=0)
Traceback(filename='coerce_actions.pyx', lineno=278, function='sage.structure.coerce_actions.ModuleAction.__init__ (sage/structure/coerce_actions.c:5174)', code_context=None, index=None)
Traceback(filename='coerce_actions.pyx', lineno=278, function='sage.structure.coerce_actions.ModuleAction.__init__ (sage/structure/coerce_actions.c:5174)', code_context=None, index=None)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=2177, function='__init__', code_context=['        self._value = self._descr._interval_fast(64)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/rings/qqbar.py', lineno=2854, function='__init__', code_context=['        AlgebraicNumber_base.__init__(self, QQbar, x)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/bin/sage-ipython', lineno=52, function='<module>', code_context=["ipy_sage.mainloop(sys_exit=1, banner='')\n"], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/Shell.py', lineno=1233, function='start', code_context=['    return shell(user_ns = user_ns)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/Shell.py', lineno=78, function='__init__', code_context=['                               debug=debug,shell_class=shell_class)\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/ipmaker.py', lineno=782, function='make_IPython', code_context=['    return IP\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/IPython/ipmaker.py', lineno=66, function='force_import', code_context=['        __import__(modname)\n'], index=0)
Traceback(filename='ipy_profile_sage.py', lineno=33, function='<module>', code_context=["    _ip.expose_magic('prun', lambda self, s: old_prun(preparse(s)))\n"], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/all_cmdline.py', lineno=35, function='<module>', code_context=['sage.misc.session.init()\n'], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/all.py', lineno=313, function='<module>', code_context=["sage.structure.sage_object.register_unpickle_override('sage.categories.category_types', 'ModularAbelianVarieties', ModularAbelianVarieties)\n"], index=0)
Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/combinat/species/generating_series.py', lineno=269, function='factorial_gen', code_context=['def factorial_gen():\n'], index=0)
```
Apply nothing
| Sage Version 4.6.1.alpha3, Release Date: 2010-12-05                |
| Type notebook() for the GUI, and license() for information.        |

**Assignee:** @rlmill

**CC:**  @jdemeyer

**Resolution:** duplicate

**Reviewer:** Burcin Erocal

Issue created by migration from https://trac.sagemath.org/ticket/10570





---

archive/issue_comments_138454.json:
```json
{
    "body": "<a id='comment:1'></a>\nps. The unnecessary frames are there since at least sage 4.4.4",
    "created_at": "2011-01-08T00:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138454",
    "user": "https://github.com/koffie"
}
```

<a id='comment:1'></a>
ps. The unnecessary frames are there since at least sage 4.4.4



---

archive/issue_comments_138455.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe vast majority of the stack frames are saved by the coercion model for use in its introspection mechanism. Adding the line\n\n```\nget_coercion_model().exception_stack()\n```\n\nat the end of `sage/all.py` kills all but 9 of the 26 stack frames listed above. Of the remaining 9, 8 are to do with IPython. The other one is some silly generator in the combinatorics module that is there to compute factorials; I don't know why they don't call the general-purpose factorial function.",
    "created_at": "2011-01-20T15:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138455",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:2'></a>
The vast majority of the stack frames are saved by the coercion model for use in its introspection mechanism. Adding the line

```
get_coercion_model().exception_stack()
```

at the end of `sage/all.py` kills all but 9 of the 26 stack frames listed above. Of the remaining 9, 8 are to do with IPython. The other one is some silly generator in the combinatorics module that is there to compute factorials; I don't know why they don't call the general-purpose factorial function.



---

archive/issue_comments_138456.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis shows that #10548 is actually the cause of the factorial generator.\n\n```\nsage: import gc\nsage: import inspect\nsage: frames=[x for x in gc.get_objects() if inspect.isframe(x)]\nsage: l=objgraph.find_backref_chain(frames[0],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])\nsage: l=objgraph.find_backref_chain(frames[8],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])\nsage: map(type,l)\n[<type 'module'>, <type 'dict'>, <type 'sage.structure.coerce.CoercionModel_cache_maps'>, <type 'list'>, <type 'tuple'>, <type 'traceback'>, <type 'frame'>, <type 'frame'>, <type 'frame'>, <type 'frame'>]\n```\nI'm going to add a patch to remove all the other stack frames in the way david sugested so this ticket can be closed. (since when there is a fix for 10548 it should also remove last stackframe)",
    "created_at": "2011-03-21T22:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138456",
    "user": "https://github.com/koffie"
}
```

<a id='comment:3'></a>
This shows that #10548 is actually the cause of the factorial generator.

```
sage: import gc
sage: import inspect
sage: frames=[x for x in gc.get_objects() if inspect.isframe(x)]
sage: l=objgraph.find_backref_chain(frames[0],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])
sage: l=objgraph.find_backref_chain(frames[8],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])
sage: map(type,l)
[<type 'module'>, <type 'dict'>, <type 'sage.structure.coerce.CoercionModel_cache_maps'>, <type 'list'>, <type 'tuple'>, <type 'traceback'>, <type 'frame'>, <type 'frame'>, <type 'frame'>, <type 'frame'>]
```
I'm going to add a patch to remove all the other stack frames in the way david sugested so this ticket can be closed. (since when there is a fix for 10548 it should also remove last stackframe)



---

archive/issue_comments_138457.json:
```json
{
    "body": "<a id='comment:4'></a>\nAttachment [trac_10570.patch](tarball://root/attachments/some-uuid/ticket10570/trac_10570.patch) by @koffie created at 2011-03-22 01:19:43",
    "created_at": "2011-03-22T01:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138457",
    "user": "https://github.com/koffie"
}
```

<a id='comment:4'></a>
Attachment [trac_10570.patch](tarball://root/attachments/some-uuid/ticket10570/trac_10570.patch) by @koffie created at 2011-03-22 01:19:43



---

archive/issue_comments_138458.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-03-22T01:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138458",
    "user": "https://github.com/koffie"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_138459.json:
```json
{
    "body": "<a id='comment:5'></a>\nAfter applying the two-patch series at #10548, this patch tests fine whether or not the last line is commented out -- that is, the issue itself seems to be fixed by #10548 independently.\n\nI will merge this patch into your doctest patch at #10548 and upload it there.",
    "created_at": "2011-03-24T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138459",
    "user": "https://github.com/kini"
}
```

<a id='comment:5'></a>
After applying the two-patch series at #10548, this patch tests fine whether or not the last line is commented out -- that is, the issue itself seems to be fixed by #10548 independently.

I will merge this patch into your doctest patch at #10548 and upload it there.



---

archive/issue_comments_138460.json:
```json
{
    "body": "**Author:** Maarten Derickx",
    "created_at": "2011-03-24T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138460",
    "user": "https://github.com/kini"
}
```

**Author:** Maarten Derickx



---

archive/issue_comments_138461.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-03-24T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138461",
    "user": "https://github.com/kini"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_138462.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -46,3 +46,6 @@\n ```\n | Sage Version 4.6.1.alpha3, Release Date: 2010-12-05                |\n | Type notebook() for the GUI, and license() for information.        |\n+\n+Apply trac_10570.v2.patch\n+Depends on #10548\n``````\n",
    "created_at": "2011-03-24T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138462",
    "user": "https://github.com/kini"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -46,3 +46,6 @@
 ```
 | Sage Version 4.6.1.alpha3, Release Date: 2010-12-05                |
 | Type notebook() for the GUI, and license() for information.        |
+
+Apply trac_10570.v2.patch
+Depends on #10548
``````




---

archive/issue_comments_138463.json:
```json
{
    "body": "**Reviewer:** Keshav Kini",
    "created_at": "2011-03-24T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138463",
    "user": "https://github.com/kini"
}
```

**Reviewer:** Keshav Kini



---

archive/issue_comments_138464.json:
```json
{
    "body": "<a id='comment:6'></a>\nThere is now only the factorial remaining, but now for a different reason then before:\n\nsage: import gc\nsage: import inspect\nsage: l1=gc.get_objects()\nsage: frames=[x for x in l1 if inspect.isframe(x)]\nsage: len(frames)\n9\nsage: l=objgraph.find_backref_chain(frames[8],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])\nsage: map(type,l)\n[<type 'module'>, <type 'dict'>, <class 'sage.combinat.species.stream.Stream_class'>, <type 'dict'>, <type 'generator'>, <type 'frame'>]",
    "created_at": "2011-03-24T22:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138464",
    "user": "https://github.com/koffie"
}
```

<a id='comment:6'></a>
There is now only the factorial remaining, but now for a different reason then before:

sage: import gc
sage: import inspect
sage: l1=gc.get_objects()
sage: frames=[x for x in l1 if inspect.isframe(x)]
sage: len(frames)
9
sage: l=objgraph.find_backref_chain(frames[8],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])
sage: map(type,l)
[<type 'module'>, <type 'dict'>, <class 'sage.combinat.species.stream.Stream_class'>, <type 'dict'>, <type 'generator'>, <type 'frame'>]



---

archive/issue_comments_138465.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2011-03-24T22:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138465",
    "user": "https://github.com/koffie"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_138466.json:
```json
{
    "body": "<a id='comment:7'></a>\n\n```\nsage: sage: import gc\nsage: sage: import inspect\nsage: sage: l1=gc.get_objects()\nsage: sage: frames=[x for x in l1 if inspect.isframe(x)]\nsage: sage: len(frames)\n9\nsage: sage: l=objgraph.find_backref_chain(frames[8],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])\nsage: sage: map(type,l)\n[<type 'module'>, <type 'dict'>, <class 'sage.combinat.species.stream.Stream_class'>, <type 'dict'>, <type 'generator'>, <type 'frame'>]\n```",
    "created_at": "2011-03-24T22:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138466",
    "user": "https://github.com/koffie"
}
```

<a id='comment:7'></a>

```
sage: sage: import gc
sage: sage: import inspect
sage: sage: l1=gc.get_objects()
sage: sage: frames=[x for x in l1 if inspect.isframe(x)]
sage: sage: len(frames)
9
sage: sage: l=objgraph.find_backref_chain(frames[8],inspect.ismodule,max_depth=15,extra_ignore=[id(frames)])
sage: sage: map(type,l)
[<type 'module'>, <type 'dict'>, <class 'sage.combinat.species.stream.Stream_class'>, <type 'dict'>, <type 'generator'>, <type 'frame'>]
```



---

archive/issue_comments_138467.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-03-24T23:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138467",
    "user": "https://github.com/koffie"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_events_032570.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2011-03-24T23:31:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10570#event-32570"
}
```



---

archive/issue_comments_138468.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,4 @@\n-This is a really really bad thing and probably related to a lot of the memory leaks shown up recently.\n-All the ipython frames are probably ok on the stack. But most of the other frames come from a call stack frame which is unneccesarily alive. \n+This is a really really bad thing and probably related to a lot of the memory leaks shown up recently. All the ipython frames are probably ok on the stack. But most of the other frames come from a call stack frame which is unneccesarily alive.\n \n ```\n ----------------------------------------------------------------------\n@@ -44,8 +43,6 @@\n Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/all.py', lineno=313, function='<module>', code_context=[\"sage.structure.sage_object.register_unpickle_override('sage.categories.category_types', 'ModularAbelianVarieties', ModularAbelianVarieties)\\n\"], index=0)\n Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/combinat/species/generating_series.py', lineno=269, function='factorial_gen', code_context=['def factorial_gen():\\n'], index=0)\n ```\n+Apply nothing\n | Sage Version 4.6.1.alpha3, Release Date: 2010-12-05                |\n | Type notebook() for the GUI, and license() for information.        |\n-\n-Apply trac_10570.v2.patch\n-Depends on #10548\n``````\n",
    "created_at": "2011-03-24T23:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138468",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,4 @@
-This is a really really bad thing and probably related to a lot of the memory leaks shown up recently.
-All the ipython frames are probably ok on the stack. But most of the other frames come from a call stack frame which is unneccesarily alive. 
+This is a really really bad thing and probably related to a lot of the memory leaks shown up recently. All the ipython frames are probably ok on the stack. But most of the other frames come from a call stack frame which is unneccesarily alive.
 
 ```
 ----------------------------------------------------------------------
@@ -44,8 +43,6 @@
 Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/all.py', lineno=313, function='<module>', code_context=["sage.structure.sage_object.register_unpickle_override('sage.categories.category_types', 'ModularAbelianVarieties', ModularAbelianVarieties)\n"], index=0)
 Traceback(filename='/Applications/sage-4.6.rc0/local/lib/python2.6/site-packages/sage/combinat/species/generating_series.py', lineno=269, function='factorial_gen', code_context=['def factorial_gen():\n'], index=0)
 ```
+Apply nothing
 | Sage Version 4.6.1.alpha3, Release Date: 2010-12-05                |
 | Type notebook() for the GUI, and license() for information.        |
-
-Apply trac_10570.v2.patch
-Depends on #10548
``````




---

archive/issue_comments_138469.json:
```json
{
    "body": "<a id='comment:8'></a>\nI don't consider the remaining frame corresponding to the factorial generator a bug. It is there because appearantly someone thinks that the factorial generator should be available as a generator instead of a function in some module.",
    "created_at": "2011-03-24T23:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138469",
    "user": "https://github.com/koffie"
}
```

<a id='comment:8'></a>
I don't consider the remaining frame corresponding to the factorial generator a bug. It is there because appearantly someone thinks that the factorial generator should be available as a generator instead of a function in some module.



---

archive/issue_comments_138470.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [mderickx](#comment%3A8):\n> I don't consider the remaining frame corresponding to the factorial generator a bug. It is there because appearantly someone thinks that the factorial generator should be available as a generator instead of a function in some module.\n\n\nI agree that the main problem was solved by #10548 and this can be closed.",
    "created_at": "2011-05-31T13:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138470",
    "user": "https://github.com/burcin"
}
```

<a id='comment:9'></a>
Replying to [mderickx](#comment%3A8):
> I don't consider the remaining frame corresponding to the factorial generator a bug. It is there because appearantly someone thinks that the factorial generator should be available as a generator instead of a function in some module.


I agree that the main problem was solved by #10548 and this can be closed.



---

archive/issue_comments_138471.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-05-31T13:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138471",
    "user": "https://github.com/burcin"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_138472.json:
```json
{
    "body": "**Changing author** from \"Maarten Derickx\" to \"\".",
    "created_at": "2011-05-31T14:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138472",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Maarten Derickx" to "".



---

archive/issue_comments_138473.json:
```json
{
    "body": "**Changing reviewer** from \"Keshav Kini\" to \"Burcin Erocal\".",
    "created_at": "2011-05-31T14:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138473",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Keshav Kini" to "Burcin Erocal".



---

archive/issue_comments_138474.json:
```json
{
    "body": "**Resolution:** duplicate",
    "created_at": "2011-05-31T17:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10570#issuecomment-138474",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** duplicate



---

archive/issue_events_032571.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-31T17:16:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10570",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10570#event-32571"
}
```
