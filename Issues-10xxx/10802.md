# Issue 10802: Singular values of matrices over CDF

archive/issues_010736.json:
```json
{
    "body": "This method serves two purposes:\n\n(a) a convenience for getting singular values and clipping small values to zero.\n\n(b) a starting point for reasonable quality control on numerical approximations from CDF matrices.  This will make a rank computation easy (though not fool-proof) and this can be used in other situations as a consistency check.  See #7392.\n\n---\n**Depends:**\n1. #10837\n\n**Apply:**\n1. [attachment:trac_10802-singular-values-CDF-v3.patch]\n2. [attachment:trac-10802-singular-values-CDF-review-v2.patch]\n3. [attachment:trac_10802-doctest-noise.patch]\n\n\nDepends on #10837\n\n**Assignee:** @jasongrout, @williamstein\n\n**Keywords:** sd32\n\n**Author:** Rob Beezer\n\n**Reviewer:** Martin Raum, Jeroen Demeyer\n\n**Merged:** sage-4.7.2.alpha4\n\nIssue created by migration from https://trac.sagemath.org/ticket/10802\n\n",
    "closed_at": "2011-10-05T07:46:49Z",
    "created_at": "2011-02-19T06:16:15Z",
    "labels": [
        "component: linear algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "title": "Singular values of matrices over CDF",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/10802",
    "user": "https://github.com/rbeezer"
}
```
This method serves two purposes:

(a) a convenience for getting singular values and clipping small values to zero.

(b) a starting point for reasonable quality control on numerical approximations from CDF matrices.  This will make a rank computation easy (though not fool-proof) and this can be used in other situations as a consistency check.  See #7392.

---
**Depends:**
1. #10837

**Apply:**
1. [attachment:trac_10802-singular-values-CDF-v3.patch]
2. [attachment:trac-10802-singular-values-CDF-review-v2.patch]
3. [attachment:trac_10802-doctest-noise.patch]


Depends on #10837

**Assignee:** @jasongrout, @williamstein

**Keywords:** sd32

**Author:** Rob Beezer

**Reviewer:** Martin Raum, Jeroen Demeyer

**Merged:** sage-4.7.2.alpha4

Issue created by migration from https://trac.sagemath.org/ticket/10802





---

archive/attachments_014146.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10802-singular-values-CDF.patch",
    "asset_url": "tarball://root/attachments/ticket10802/trac_10802-singular-values-CDF.patch",
    "created_at": "2011-02-19T06:18:59Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_106254.json:
```json
{
    "body": "Attachment [trac_10802-singular-values-CDF.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF.patch) by @rbeezer created at 2011-02-19 06:18:59",
    "created_at": "2011-02-19T06:18:59Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106254",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_10802-singular-values-CDF.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF.patch) by @rbeezer created at 2011-02-19 06:18:59



---

archive/issue_comments_106255.json:
```json
{
    "body": "**Author:** Rob Beezer",
    "created_at": "2011-02-19T06:19:41Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106255",
    "user": "https://github.com/rbeezer"
}
```

**Author:** Rob Beezer



---

archive/issue_events_083701.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-02-19T06:19:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83701"
}
```



---

archive/issue_events_083702.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2011-03-25T04:09:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83702"
}
```



---

archive/issue_events_083703.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2011-03-25T04:09:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83703"
}
```



---

archive/issue_comments_106256.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,7 @@\n (a) a convenience for getting singular values and clipping small values to zero.\n \n (b) a starting point for reasonable quality control on numerical approximations from CDF matrices.  This will make a rank computation easy (though not fool-proof) and this can be used in other situations as a consistency check.  See #7392.\n+\n+**Apply:**\n+1. [attachment:trac_10802-singular-values-CDF.patch]\n+\n``````\n",
    "created_at": "2011-03-25T04:09:05Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106256",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,7 @@
 (a) a convenience for getting singular values and clipping small values to zero.
 
 (b) a starting point for reasonable quality control on numerical approximations from CDF matrices.  This will make a rank computation easy (though not fool-proof) and this can be used in other situations as a consistency check.  See #7392.
+
+**Apply:**
+1. [attachment:trac_10802-singular-values-CDF.patch]
+
``````




---

archive/issue_comments_106257.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis looks very good to me; No complains at all. All test pass.",
    "created_at": "2011-03-25T04:09:05Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106257",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:2'></a>
This looks very good to me; No complains at all. All test pass.



---

archive/issue_comments_106258.json:
```json
{
    "body": "**Reviewer:** Martin Raum",
    "created_at": "2011-03-25T04:09:05Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106258",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Reviewer:** Martin Raum



---

archive/issue_events_083704.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-04T09:27:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83704"
}
```



---

archive/issue_events_083705.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-04T09:27:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83705"
}
```



---

archive/issue_comments_106259.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis patch conflicts with #10837.",
    "created_at": "2011-04-04T09:27:11Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106259",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
This patch conflicts with #10837.



---

archive/issue_comments_106260.json:
```json
{
    "body": "<a id='comment:4'></a>\nRobert, I think it is a good idea to rebase this patch to #10837. It's just very many changes at the same time, so this had to happen.\n\nBut also mind that the patch bot complains. None of the issues showed up on my computer, but it seems like the list tests are obviously wrong. Also the numerical noise needs to be addressed. You might want to compare against a bound 10^-15 or so.",
    "created_at": "2011-04-04T17:59:13Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106260",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:4'></a>
Robert, I think it is a good idea to rebase this patch to #10837. It's just very many changes at the same time, so this had to happen.

But also mind that the patch bot complains. None of the issues showed up on my computer, but it seems like the list tests are obviously wrong. Also the numerical noise needs to be addressed. You might want to compare against a bound 10^-15 or so.



---

archive/issue_comments_106261.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mraum](#comment%3A4):\n> But also mind that the patch bot complains. None of the issues showed up on my computer, but it seems like the list tests are obviously wrong. Also the numerical noise needs to be addressed. You might want to compare against a bound 10^-15 or so.\n\nIndeed, this also need to be fixed.",
    "created_at": "2011-04-04T18:13:57Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106261",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Replying to [mraum](#comment%3A4):
> But also mind that the patch bot complains. None of the issues showed up on my computer, but it seems like the list tests are obviously wrong. Also the numerical noise needs to be addressed. You might want to compare against a bound 10^-15 or so.

Indeed, this also need to be fixed.



---

archive/issue_comments_106262.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks, Martin and Jeroen, for the help and suggestions.  I'm building a 4.7.alpha3 right now (and working on another project) and will get to this (and other conflicts) in a few hours from now.\n\nRob",
    "created_at": "2011-04-04T18:32:25Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106262",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:6'></a>
Thanks, Martin and Jeroen, for the help and suggestions.  I'm building a 4.7.alpha3 right now (and working on another project) and will get to this (and other conflicts) in a few hours from now.

Rob



---

archive/issue_events_083706.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-04-05T02:50:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83706"
}
```



---

archive/issue_events_083707.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-04-05T02:50:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83707"
}
```



---

archive/attachments_014147.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10802-singular-values-CDF-v2.patch",
    "asset_url": "tarball://root/attachments/ticket10802/trac_10802-singular-values-CDF-v2.patch",
    "created_at": "2011-04-05T02:50:34Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF-v2.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_106263.json:
```json
{
    "body": "<a id='comment:7'></a>\nAttachment [trac_10802-singular-values-CDF-v2.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF-v2.patch) by @rbeezer created at 2011-04-05 02:50:34\n\nv2 patch rebases to depend on #10837 on 4.7.alpha3 and reworks the doctests.\n\nOne new doctest at the beginning that is a full-rank matrix (no zero singular values!) and should be stable numerically.  includes a confidence building test on correctness.\n\nAll the other matrices stay the same, including the difficult Hilbert matrix.  Using rounding liberally, plus ellipsis (...) and inequalities in a few places to get everything to behave, without obscuring the real nature of the method.\n\nNo changes to the code.  New doctests pass on my Intel i7-2600 machine and on sage.math.\n\nThe changes to the doctests should be reviewed.",
    "created_at": "2011-04-05T02:50:34Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106263",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:7'></a>
Attachment [trac_10802-singular-values-CDF-v2.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF-v2.patch) by @rbeezer created at 2011-04-05 02:50:34

v2 patch rebases to depend on #10837 on 4.7.alpha3 and reworks the doctests.

One new doctest at the beginning that is a full-rank matrix (no zero singular values!) and should be stable numerically.  includes a confidence building test on correctness.

All the other matrices stay the same, including the difficult Hilbert matrix.  Using rounding liberally, plus ellipsis (...) and inequalities in a few places to get everything to behave, without obscuring the real nature of the method.

No changes to the code.  New doctests pass on my Intel i7-2600 machine and on sage.math.

The changes to the doctests should be reviewed.



---

archive/issue_comments_106264.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,6 +4,10 @@\n \n (b) a starting point for reasonable quality control on numerical approximations from CDF matrices.  This will make a rank computation easy (though not fool-proof) and this can be used in other situations as a consistency check.  See #7392.\n \n+---\n+**Depends:**\n+1. #10837\n+\n **Apply:**\n-1. [attachment:trac_10802-singular-values-CDF.patch]\n+1. [attachment:trac_10802-singular-values-CDF-v2.patch]\n \n``````\n",
    "created_at": "2011-04-05T02:50:34Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106264",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,6 +4,10 @@
 
 (b) a starting point for reasonable quality control on numerical approximations from CDF matrices.  This will make a rank computation easy (though not fool-proof) and this can be used in other situations as a consistency check.  See #7392.
 
+---
+**Depends:**
+1. #10837
+
 **Apply:**
-1. [attachment:trac_10802-singular-values-CDF.patch]
+1. [attachment:trac_10802-singular-values-CDF-v2.patch]
 
``````




---

archive/issue_comments_106265.json:
```json
{
    "body": "**Dependencies:** #10837",
    "created_at": "2011-06-11T20:33:48Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106265",
    "user": "https://github.com/fchapoton"
}
```

**Dependencies:** #10837



---

archive/attachments_014148.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-10802-singular-values-CDF-review.patch",
    "asset_url": "tarball://root/attachments/ticket10802/trac-10802-singular-values-CDF-review.patch",
    "created_at": "2011-08-06T17:56:11Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10802/trac-10802-singular-values-CDF-review.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_106266.json:
```json
{
    "body": "Attachment [trac-10802-singular-values-CDF-review.patch](https://github.com/sagemath/sage/files/ticket10802/trac-10802-singular-values-CDF-review.patch) by mraum created at 2011-08-06 17:56:11",
    "created_at": "2011-08-06T17:56:11Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106266",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-10802-singular-values-CDF-review.patch](https://github.com/sagemath/sage/files/ticket10802/trac-10802-singular-values-CDF-review.patch) by mraum created at 2011-08-06 17:56:11



---

archive/issue_comments_106267.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,4 +10,5 @@\n \n **Apply:**\n 1. [attachment:trac_10802-singular-values-CDF-v2.patch]\n+2. [attachment:trac_10802-singular-values-CDF-review.patch]\n \n``````\n",
    "created_at": "2011-08-06T18:00:02Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106267",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,4 +10,5 @@
 
 **Apply:**
 1. [attachment:trac_10802-singular-values-CDF-v2.patch]
+2. [attachment:trac_10802-singular-values-CDF-review.patch]
 
``````




---

archive/issue_comments_106268.json:
```json
{
    "body": "<a id='comment:9'></a>\nI propose only one tiny change to the doctest involving the condition:\nThe exact value is\n\n```\nsage: c2 = sqrt(sum(map(operator.mul, B.inverse().list(), B.inverse().list())))\nsage: c1 = sqrt(sum(map(operator.mul, B.list(), B.list())))\nsage: c1/c2\n1/338581401811897828348589105304331884576*sqrt(805082999949990227/30)*sqrt(158090646384497588170245117213)\nsage: N(c1*c2)\n1.75177509695064e16\n```\nso indeed only the first two digits of what you computed are right. I changed the doctest accordingly.\n\nIf also modified one if clause; it now checks eps is None.\n\nIf you approve the changes, we can give this a \"virtual positive review\", depending on the approval of #10837.",
    "created_at": "2011-08-06T18:00:02Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106268",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:9'></a>
I propose only one tiny change to the doctest involving the condition:
The exact value is

```
sage: c2 = sqrt(sum(map(operator.mul, B.inverse().list(), B.inverse().list())))
sage: c1 = sqrt(sum(map(operator.mul, B.list(), B.list())))
sage: c1/c2
1/338581401811897828348589105304331884576*sqrt(805082999949990227/30)*sqrt(158090646384497588170245117213)
sage: N(c1*c2)
1.75177509695064e16
```
so indeed only the first two digits of what you computed are right. I changed the doctest accordingly.

If also modified one if clause; it now checks eps is None.

If you approve the changes, we can give this a "virtual positive review", depending on the approval of #10837.



---

archive/issue_comments_106269.json:
```json
{
    "body": "<a id='comment:10'></a>\nThanks for the improved accuracy on that test.  Looks good.\n\nYes, let's call this \"virtual positive review\" and I will wait on #10837 before actually flipping the ticket.\n\nThanks for your careful work on these.  The improvements are welcome.\n\nRob",
    "created_at": "2011-08-12T19:38:15Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106269",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:10'></a>
Thanks for the improved accuracy on that test.  Looks good.

Yes, let's call this "virtual positive review" and I will wait on #10837 before actually flipping the ticket.

Thanks for your careful work on these.  The improvements are welcome.

Rob



---

archive/issue_comments_106270.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,5 +10,5 @@\n \n **Apply:**\n 1. [attachment:trac_10802-singular-values-CDF-v2.patch]\n-2. [attachment:trac_10802-singular-values-CDF-review.patch]\n+2. [attachment:trac-10802-singular-values-CDF-review-v2.patch]\n \n``````\n",
    "created_at": "2011-08-15T05:12:31Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106270",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,5 +10,5 @@
 
 **Apply:**
 1. [attachment:trac_10802-singular-values-CDF-v2.patch]
-2. [attachment:trac_10802-singular-values-CDF-review.patch]
+2. [attachment:trac-10802-singular-values-CDF-review-v2.patch]
 
``````




---

archive/attachments_014149.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-10802-singular-values-CDF-review-v2.patch",
    "asset_url": "tarball://root/attachments/ticket10802/trac-10802-singular-values-CDF-review-v2.patch",
    "created_at": "2011-08-15T05:12:31Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10802/trac-10802-singular-values-CDF-review-v2.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_106271.json:
```json
{
    "body": "<a id='comment:11'></a>\nAttachment [trac-10802-singular-values-CDF-review-v2.patch](https://github.com/sagemath/sage/files/ticket10802/trac-10802-singular-values-CDF-review-v2.patch) by @rbeezer created at 2011-08-15 05:12:31\n\nReview patch looks good, and passes long tests, and #10837 is ready-to-go.  So \"positive review\" here.\n\nI made a v2 version of the review patch with a commit string, and Martin as the user.",
    "created_at": "2011-08-15T05:12:31Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106271",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:11'></a>
Attachment [trac-10802-singular-values-CDF-review-v2.patch](https://github.com/sagemath/sage/files/ticket10802/trac-10802-singular-values-CDF-review-v2.patch) by @rbeezer created at 2011-08-15 05:12:31

Review patch looks good, and passes long tests, and #10837 is ready-to-go.  So "positive review" here.

I made a v2 version of the review patch with a commit string, and Martin as the user.



---

archive/issue_events_083708.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-08-15T05:12:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83708"
}
```



---

archive/issue_events_083709.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-08-15T05:12:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83709"
}
```



---

archive/issue_events_083710.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-16T09:35:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83710"
}
```



---

archive/issue_events_083711.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-16T09:35:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83711"
}
```



---

archive/issue_comments_106272.json:
```json
{
    "body": "**Merged:** sage-4.7.2.alpha2",
    "created_at": "2011-08-18T22:02:55Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106272",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.2.alpha2



---

archive/issue_events_083712.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:02:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83712"
}
```



---

archive/issue_events_083713.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:02:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83713"
}
```



---

archive/issue_comments_106273.json:
```json
{
    "body": "<a id='comment:14'></a>\nSorry, too quick to close this ticket.  One of the patches applies only with fuzz 2 (probably because of #10839), so this should be rebased to sage-4.7.2.alpha1 + #10837.",
    "created_at": "2011-08-22T09:51:05Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106273",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Sorry, too quick to close this ticket.  One of the patches applies only with fuzz 2 (probably because of #10839), so this should be rebased to sage-4.7.2.alpha1 + #10837.



---

archive/issue_events_083714.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T09:51:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83714"
}
```



---

archive/issue_events_083715.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T09:51:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83715"
}
```



---

archive/issue_events_083716.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T09:51:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83716"
}
```



---

archive/issue_comments_106274.json:
```json
{
    "body": "**Changing merged** from \"sage-4.7.2.alpha2\" to \"\".",
    "created_at": "2011-08-22T19:53:34Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106274",
    "user": "https://github.com/jdemeyer"
}
```

**Changing merged** from "sage-4.7.2.alpha2" to "".



---

archive/issue_comments_106275.json:
```json
{
    "body": "Rebase",
    "created_at": "2011-08-23T04:21:22Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106275",
    "user": "https://github.com/rbeezer"
}
```

Rebase



---

archive/attachments_014150.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10802-singular-values-CDF-v3.patch",
    "asset_url": "tarball://root/attachments/ticket10802/trac_10802-singular-values-CDF-v3.patch",
    "created_at": "2011-08-23T04:21:43Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF-v3.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_106276.json:
```json
{
    "body": "Attachment [trac_10802-singular-values-CDF-v3.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF-v3.patch) by @rbeezer created at 2011-08-23 04:21:43\n\nNumerical noise in doctests",
    "created_at": "2011-08-23T04:21:43Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106276",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_10802-singular-values-CDF-v3.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-singular-values-CDF-v3.patch) by @rbeezer created at 2011-08-23 04:21:43

Numerical noise in doctests



---

archive/issue_events_083717.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-08-23T04:26:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83717"
}
```



---

archive/issue_events_083718.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-08-23T04:26:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83718"
}
```



---

archive/attachments_014151.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_10802-doctest-noise.patch",
    "asset_url": "tarball://root/attachments/ticket10802/trac_10802-doctest-noise.patch",
    "created_at": "2011-08-23T04:26:40Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket10802/trac_10802-doctest-noise.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_106277.json:
```json
{
    "body": "<a id='comment:18'></a>\nAttachment [trac_10802-doctest-noise.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-doctest-noise.patch) by @rbeezer created at 2011-08-23 04:26:40\n\n4.7.2.alpha1 + #10837\n\n\"v3\" is a very trivial rebase for fuzzieness.\n\nTwo doctests now fail  (did ATLAS change?).  \"doctest-noise\" patch brutally makes these failures go away, but will necessitate a review.",
    "created_at": "2011-08-23T04:26:40Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106277",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:18'></a>
Attachment [trac_10802-doctest-noise.patch](https://github.com/sagemath/sage/files/ticket10802/trac_10802-doctest-noise.patch) by @rbeezer created at 2011-08-23 04:26:40

4.7.2.alpha1 + #10837

"v3" is a very trivial rebase for fuzzieness.

Two doctests now fail  (did ATLAS change?).  "doctest-noise" patch brutally makes these failures go away, but will necessitate a review.



---

archive/issue_comments_106278.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,6 +9,7 @@\n 1. #10837\n \n **Apply:**\n-1. [attachment:trac_10802-singular-values-CDF-v2.patch]\n+1. [attachment:trac_10802-singular-values-CDF-v3.patch]\n 2. [attachment:trac-10802-singular-values-CDF-review-v2.patch]\n+3. [attachment:trac_10802-doctest-noise.patch]\n \n``````\n",
    "created_at": "2011-08-23T04:26:40Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106278",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,6 +9,7 @@
 1. #10837
 
 **Apply:**
-1. [attachment:trac_10802-singular-values-CDF-v2.patch]
+1. [attachment:trac_10802-singular-values-CDF-v3.patch]
 2. [attachment:trac-10802-singular-values-CDF-review-v2.patch]
+3. [attachment:trac_10802-doctest-noise.patch]
 
``````




---

archive/issue_comments_106279.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [rbeezer](#comment%3A18):\n> Two doctests now fail  (did ATLAS change?).  \"doctest-noise\" patch brutally makes these failures go away, but will necessitate a review.\n\nOn which system did you see this?  On Linux x86_64 I did not get such a failure.  It is true that ATLAS did change in sage-4.7.2.alpha0.",
    "created_at": "2011-08-23T06:38:38Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106279",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Replying to [rbeezer](#comment%3A18):
> Two doctests now fail  (did ATLAS change?).  "doctest-noise" patch brutally makes these failures go away, but will necessitate a review.

On which system did you see this?  On Linux x86_64 I did not get such a failure.  It is true that ATLAS did change in sage-4.7.2.alpha0.



---

archive/issue_comments_106280.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jdemeyer](#comment%3A19):\n> On which system did you see this?  On Linux x86_64 I did not get such a failure.  It is true that ATLAS did change in sage-4.7.2.alpha0.\n\n\nJeroen,\n\nHere are the failures (these are the only ones on sage/matrix/matrix_double_dense.pyx).\n\n```\nrob@pearl:/sage/sage-4.7.2.alpha1/devel/sage$ ../../sage -t sage/matrix/matrix_double_dense.pyx\nsage -t  \"devel/sage-main/sage/matrix/matrix_double_dense.pyx\"\n**********************************************************************\nFile \"/sage/sage-4.7.2.alpha1/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 968:\n    sage: sv[2:3]\nExpected:\n    [2.92724029018e-16]\nGot:\n    [2.01161346159e-16]\n**********************************************************************\nFile \"/sage/sage-4.7.2.alpha1/devel/sage-main/sage/matrix/matrix_double_dense.pyx\", line 1032:\n    sage: sv = A.singular_values(eps='auto'); sv\nExpected:\n    verbose 1 (<module>) singular values, smallest-non-zero:cutoff:largest-zero, 2.2766...:6.2421...e-14:1.4160...e-15\n    [35.139963659, 2.27661020871, 0.0, 0.0]\nGot:\n    verbose 1 (<module>) singular values, smallest-non-zero:cutoff:largest-zero, 2.27661020871:6.2421114782e-14:8.24999265856e-16\n    [35.139963659, 2.27661020871, 0.0, 0.0]\n**********************************************************************\n```\n\nSo they are not too bad - an order of magnitude or so on (typically) very small values.\n\nSystem is not too unusual.  At Sage Days so do not have another system to test.\n\nVery newly installed 64-bit Ubuntu 11.10 on Intel i7 M620.\n\n```\n$ gcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/x86_64-linux-gnu/gcc/x86_64-linux-gnu/4.5.2/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.5.2-8ubuntu4' --with-bugurl=file:///usr/share/doc/gcc-4.5/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.5 --enable-shared --enable-multiarch --with-multiarch-defaults=x86_64-linux-gnu --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib/x86_64-linux-gnu --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.5 --libdir=/usr/lib/x86_64-linux-gnu --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-plugin --enable-gold --enable-ld=default --with-plugin-ld=ld.gold --enable-objc-gc --disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 4.5.2 (Ubuntu/Linaro 4.5.2-8ubuntu4) \n```\n\nRob",
    "created_at": "2011-08-23T15:04:29Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106280",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:20'></a>
Replying to [jdemeyer](#comment%3A19):
> On which system did you see this?  On Linux x86_64 I did not get such a failure.  It is true that ATLAS did change in sage-4.7.2.alpha0.


Jeroen,

Here are the failures (these are the only ones on sage/matrix/matrix_double_dense.pyx).

```
rob@pearl:/sage/sage-4.7.2.alpha1/devel/sage$ ../../sage -t sage/matrix/matrix_double_dense.pyx
sage -t  "devel/sage-main/sage/matrix/matrix_double_dense.pyx"
**********************************************************************
File "/sage/sage-4.7.2.alpha1/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 968:
    sage: sv[2:3]
Expected:
    [2.92724029018e-16]
Got:
    [2.01161346159e-16]
**********************************************************************
File "/sage/sage-4.7.2.alpha1/devel/sage-main/sage/matrix/matrix_double_dense.pyx", line 1032:
    sage: sv = A.singular_values(eps='auto'); sv
Expected:
    verbose 1 (<module>) singular values, smallest-non-zero:cutoff:largest-zero, 2.2766...:6.2421...e-14:1.4160...e-15
    [35.139963659, 2.27661020871, 0.0, 0.0]
Got:
    verbose 1 (<module>) singular values, smallest-non-zero:cutoff:largest-zero, 2.27661020871:6.2421114782e-14:8.24999265856e-16
    [35.139963659, 2.27661020871, 0.0, 0.0]
**********************************************************************
```

So they are not too bad - an order of magnitude or so on (typically) very small values.

System is not too unusual.  At Sage Days so do not have another system to test.

Very newly installed 64-bit Ubuntu 11.10 on Intel i7 M620.

```
$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/x86_64-linux-gnu/gcc/x86_64-linux-gnu/4.5.2/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.5.2-8ubuntu4' --with-bugurl=file:///usr/share/doc/gcc-4.5/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.5 --enable-shared --enable-multiarch --with-multiarch-defaults=x86_64-linux-gnu --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib/x86_64-linux-gnu --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.5 --libdir=/usr/lib/x86_64-linux-gnu --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-plugin --enable-gold --enable-ld=default --with-plugin-ld=ld.gold --enable-objc-gc --disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.5.2 (Ubuntu/Linaro 4.5.2-8ubuntu4) 
```

Rob



---

archive/issue_events_083719.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T07:24:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83719"
}
```



---

archive/issue_events_083720.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T07:24:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83720"
}
```



---

archive/issue_comments_106281.json:
```json
{
    "body": "**Changing reviewer** from \"Martin Raum\" to \"Martin Raum, Jeroen Demeyer\".",
    "created_at": "2011-08-24T07:24:56Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106281",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Martin Raum" to "Martin Raum, Jeroen Demeyer".



---

archive/issue_comments_106282.json:
```json
{
    "body": "<a id='comment:21'></a>\nnoise patch looks okay",
    "created_at": "2011-08-24T07:24:56Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106282",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
noise patch looks okay



---

archive/issue_comments_106283.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd32\".",
    "created_at": "2011-08-25T19:05:16Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106283",
    "user": "https://github.com/rbeezer"
}
```

**Changing keywords** from "" to "sd32".



---

archive/issue_comments_106284.json:
```json
{
    "body": "<a id='comment:23'></a>\n#10837, on which this ticket depends, needs work...",
    "created_at": "2011-09-09T00:15:54Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106284",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
#10837, on which this ticket depends, needs work...



---

archive/issue_comments_106285.json:
```json
{
    "body": "**Merged:** sage-4.7.2.alpha4",
    "created_at": "2011-10-05T07:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10802#issuecomment-106285",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.2.alpha4



---

archive/issue_events_083721.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-05T07:46:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83721"
}
```



---

archive/issue_events_083722.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-05T07:46:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10802",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10802#event-83722"
}
```
