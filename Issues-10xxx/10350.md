# Issue 10350: Fix some remaining issues with sphinx-1.0.4.p3.spkg

archive/issues_010349.json:
```json
{
    "body": "**This ticket is a follow-up to #10118 (merged in sage-4.6.1.alpha2)**\n\nHere are some trivial problems in the file `SPKG.txt` of version \".p3\" of the Sphinx package:\n\n* In the section\n\n```\n## Dependencies\n\nThis depends on Jinja >= 2, Pygments >= 0.8, and docutils >= 0.4.\n```\n we should have \"Pygments >= 1.3.1\" due to ticket #10290, and \"Jinja2 >= 2**.2**\". But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.\n\n* In the section\n\n```\n* patches/pngmath.patch: This replaces \\usepackage[utf8x]{inputenc}\n  by \\usepackage[utf8]{inputenc} in the LaTeX preamble for building\n  images in the HTML documentation.  This change is done because some\n  LaTeX installations have only utf8, not utf8x (utf8x adds support for\n  much more Unicode characters, but these are needed used to typeset the\n  mathematics in the Sage documentation).\n```\n the fragment\n {{{\nbut these are needed used to typeset the\n }}}\n should be changed to\n {{{\nbut these are used to typeset the\n }}}\n\nTested on the following platforms:\n\n* {sage.math, bsd.math, hawk}: Both HTML and PDF versions of documentation built OK. For the PDF version, building the reference manual produced some warnings about \"unusable reference target\", which are to do with relative links to other documents in the Sage standard documentation.\n\n* {cleo, iras}.skynet: Sage 4.6.1.alpha2 fails to build on this machine, hence the documentation doesn't get built at all.\n\n* {cicero, eno, lena, sextus, taurus, t2}: The HTML version of the documentation mostly built OK, but with warnings about a missing LaTeX installation. Consequently, the PDF version of the documentation can't be built.\n\n* flavius.skynet -- The PDF version of the documentation built fine, but with some warnings about unusable relative links. The HTML version built with numerous warnings due to missing the dvipng command.\n\n* {gcc11, gcc16}.fsffrance.org: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command \"dvipng\". This machine has a LaTeX installation, but it is missing the file titlesec.sty, hence building the PDF version of any document in the standard documentation would hang at the error message:\n {{{\nStyle option: `fancybox' v1.3 <2000/09/19> (tvz)\n)\n\n! LaTeX Error: File `titlesec.sty' not found.\n\nType X to quit or <RETURN> to proceed,\nor enter new name. (Default extension: sty)\n }}}\n\n* rh.math: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command \"dvipng\". This means that LaTeX typesetting does not render at all in the HTML version. This machine has a LaTeX installation, but it is missing the file utf8x.def, hence building any document in the standard documentation would hang at the error message that prompts for utf8x.def. Note that we have the patch\n {{{#!diff\ndiff -r -u src.old/sphinx/ext/pngmath.py src/sphinx/ext/pngmath.py\n--- src/sphinx/ext/pngmath.py   2010-07-24 12:07:36.000000000 +0200\n+++ src/sphinx/ext/pngmath.py   2010-11-18 09:38:05.428635584 +0100\n`@``@` -34,7 +34,7 `@``@`\n\n DOC_HEAD = r'''\n \\documentclass[12pt]{article}\n-\\usepackage[utf8x]{inputenc}\n+\\usepackage[utf8]{inputenc}\n \\usepackage{amsmath}\n \\usepackage{amsthm}\n \\usepackage{amssymb}\n }}}\n to use only utf8 instead of utf8x. The same change needs to be made to the file `doc/common/conf.py`. See my reviewer patch [attachment:trac-10118_use-utf8.patch]. With this patch, we get pass the issue of the missing utf8x.def, but we now run into the following error:\n {{{\nStyle option: `fancybox' v1.3 <2000/09/19> (tvz)\n)\n\n! LaTeX Error: File `titlesec.sty' not found.\n\nType X to quit or <RETURN> to proceed,\nor enter new name. (Default extension: sty)\n }}}\n\n**Apply:**\n\n* http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg\n\nAssignee: tbd\n\nCC:  @kcrisman @TimDumol @jhpalmieri @mwhansen\n\nKeywords: sphinx spkg utf8x LaTeX error titlesec\n\nResolution: fixed\n\nAuthor: Jeroen Demeyer\n\nReviewer: Minh Van Nguyen\n\nMerged: sage-4.6.1.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/10350\n\n",
    "closed_at": "2010-12-05T11:51:52Z",
    "created_at": "2010-11-28T10:45:23Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.1",
    "title": "Fix some remaining issues with sphinx-1.0.4.p3.spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10350",
    "user": "https://github.com/jdemeyer"
}
```
**This ticket is a follow-up to #10118 (merged in sage-4.6.1.alpha2)**

Here are some trivial problems in the file `SPKG.txt` of version ".p3" of the Sphinx package:

* In the section

```
## Dependencies

This depends on Jinja >= 2, Pygments >= 0.8, and docutils >= 0.4.
```
 we should have "Pygments >= 1.3.1" due to ticket #10290, and "Jinja2 >= 2**.2**". But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.

* In the section

```
* patches/pngmath.patch: This replaces \usepackage[utf8x]{inputenc}
  by \usepackage[utf8]{inputenc} in the LaTeX preamble for building
  images in the HTML documentation.  This change is done because some
  LaTeX installations have only utf8, not utf8x (utf8x adds support for
  much more Unicode characters, but these are needed used to typeset the
  mathematics in the Sage documentation).
```
 the fragment
 {{{
but these are needed used to typeset the
 }}}
 should be changed to
 {{{
but these are used to typeset the
 }}}

Tested on the following platforms:

* {sage.math, bsd.math, hawk}: Both HTML and PDF versions of documentation built OK. For the PDF version, building the reference manual produced some warnings about "unusable reference target", which are to do with relative links to other documents in the Sage standard documentation.

* {cleo, iras}.skynet: Sage 4.6.1.alpha2 fails to build on this machine, hence the documentation doesn't get built at all.

* {cicero, eno, lena, sextus, taurus, t2}: The HTML version of the documentation mostly built OK, but with warnings about a missing LaTeX installation. Consequently, the PDF version of the documentation can't be built.

* flavius.skynet -- The PDF version of the documentation built fine, but with some warnings about unusable relative links. The HTML version built with numerous warnings due to missing the dvipng command.

* {gcc11, gcc16}.fsffrance.org: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command "dvipng". This machine has a LaTeX installation, but it is missing the file titlesec.sty, hence building the PDF version of any document in the standard documentation would hang at the error message:
 {{{
Style option: `fancybox' v1.3 <2000/09/19> (tvz)
)

! LaTeX Error: File `titlesec.sty' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: sty)
 }}}

* rh.math: The HTML version of all documents in the standard documentation mostly built OK, but with warnings about the missing command "dvipng". This means that LaTeX typesetting does not render at all in the HTML version. This machine has a LaTeX installation, but it is missing the file utf8x.def, hence building any document in the standard documentation would hang at the error message that prompts for utf8x.def. Note that we have the patch
 {{{#!diff
diff -r -u src.old/sphinx/ext/pngmath.py src/sphinx/ext/pngmath.py
--- src/sphinx/ext/pngmath.py   2010-07-24 12:07:36.000000000 +0200
+++ src/sphinx/ext/pngmath.py   2010-11-18 09:38:05.428635584 +0100
`@``@` -34,7 +34,7 `@``@`

 DOC_HEAD = r'''
 \documentclass[12pt]{article}
-\usepackage[utf8x]{inputenc}
+\usepackage[utf8]{inputenc}
 \usepackage{amsmath}
 \usepackage{amsthm}
 \usepackage{amssymb}
 }}}
 to use only utf8 instead of utf8x. The same change needs to be made to the file `doc/common/conf.py`. See my reviewer patch [attachment:trac-10118_use-utf8.patch]. With this patch, we get pass the issue of the missing utf8x.def, but we now run into the following error:
 {{{
Style option: `fancybox' v1.3 <2000/09/19> (tvz)
)

! LaTeX Error: File `titlesec.sty' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: sty)
 }}}

**Apply:**

* http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg

Assignee: tbd

CC:  @kcrisman @TimDumol @jhpalmieri @mwhansen

Keywords: sphinx spkg utf8x LaTeX error titlesec

Resolution: fixed

Author: Jeroen Demeyer

Reviewer: Minh Van Nguyen

Merged: sage-4.6.1.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/10350





---

archive/issue_comments_127992.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p4.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p4.spkg)",
    "created_at": "2010-11-28T13:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127992",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
New spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p4.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p4.spkg)



---

archive/issue_comments_127993.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-11-28T13:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127993",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_127994.json:
```json
{
    "body": "Patch from p3 to p4, for review",
    "created_at": "2010-11-28T13:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127994",
    "user": "https://github.com/jdemeyer"
}
```

Patch from p3 to p4, for review



---

archive/issue_comments_127995.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-12-03T15:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127995",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_127996.json:
```json
{
    "body": "<a id='comment:2'></a>\nAttachment [sphinx-1.0.4.p4.patch](tarball://root/attachments/some-uuid/ticket10350/sphinx-1.0.4.p4.patch) by @nexttime created at 2010-12-03 15:07:45\n\nFrom sage-release:\n\n```\nI have an interesting (repeatable) error.\n\nProcessing dependencies for Sphinx==1.0.4\nSearching for Jinja2>=2.2\nReading http://pypi.python.org/simple/Jinja2/\nDownload error: [Errno 8] nodename nor servname provided, or not known\n-- Some packages may not be found!\nReading http://pypi.python.org/simple/Jinja2/\nDownload error: [Errno 8] nodename nor servname provided, or not known\n-- Some packages may not be found!\nCouldn't retrieve index page for 'Jinja2'\nScanning index of all packages (this may take a while)\nReading http://pypi.python.org/simple/\nDownload error: [Errno 8] nodename nor servname provided, or not known\n-- Some packages may not be found!\nNo local packages or download links found for Jinja2>=2.2\nerror: Could not find suitable distribution for\nRequirement.parse('Jinja2>=2.2')\nError building Sphinx: 'Error installing Sphinx'\nreal\t0m3.594s\nuser\t0m1.063s\nsys\t0m0.514s\nsage: An error occurred while installing sphinx-1.0.4.p3\n\n\nThis sort of mystified me, and retyping 'make' didn't help, until I\nplugged my computer back into the Internet.  Then I got:\n\n\nProcessing dependencies for Sphinx==1.0.4\nSearching for Jinja2>=2.2\nReading http://pypi.python.org/simple/Jinja2/\nReading http://jinja.pocoo.org/\nBest match: Jinja2 2.5.5\nDownloading http://pypi.python.org/packages/source/J/Jinja2/Jinja2-2.5.5.tar.gz#md5=83b20c1eeb31f49d8e6392efae91b7d5\n\n\nand all is well.\n\nIs the internet now a prerequisite for building Sage?  Obviously it is\na prereq for downloading it, but in theory one would want to be able\nto build it while offline (or to buy a CD with the source, or\nwhatever).  I am pretty sure that in the past this was not supposed to\nbe true.\n\n- kcrisman\n```",
    "created_at": "2010-12-03T15:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127996",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>
Attachment [sphinx-1.0.4.p4.patch](tarball://root/attachments/some-uuid/ticket10350/sphinx-1.0.4.p4.patch) by @nexttime created at 2010-12-03 15:07:45

From sage-release:

```
I have an interesting (repeatable) error.

Processing dependencies for Sphinx==1.0.4
Searching for Jinja2>=2.2
Reading http://pypi.python.org/simple/Jinja2/
Download error: [Errno 8] nodename nor servname provided, or not known
-- Some packages may not be found!
Reading http://pypi.python.org/simple/Jinja2/
Download error: [Errno 8] nodename nor servname provided, or not known
-- Some packages may not be found!
Couldn't retrieve index page for 'Jinja2'
Scanning index of all packages (this may take a while)
Reading http://pypi.python.org/simple/
Download error: [Errno 8] nodename nor servname provided, or not known
-- Some packages may not be found!
No local packages or download links found for Jinja2>=2.2
error: Could not find suitable distribution for
Requirement.parse('Jinja2>=2.2')
Error building Sphinx: 'Error installing Sphinx'
real	0m3.594s
user	0m1.063s
sys	0m0.514s
sage: An error occurred while installing sphinx-1.0.4.p3


This sort of mystified me, and retyping 'make' didn't help, until I
plugged my computer back into the Internet.  Then I got:


Processing dependencies for Sphinx==1.0.4
Searching for Jinja2>=2.2
Reading http://pypi.python.org/simple/Jinja2/
Reading http://jinja.pocoo.org/
Best match: Jinja2 2.5.5
Downloading http://pypi.python.org/packages/source/J/Jinja2/Jinja2-2.5.5.tar.gz#md5=83b20c1eeb31f49d8e6392efae91b7d5


and all is well.

Is the internet now a prerequisite for building Sage?  Obviously it is
a prereq for downloading it, but in theory one would want to be able
to build it while offline (or to buy a CD with the source, or
whatever).  I am pretty sure that in the past this was not supposed to
be true.

- kcrisman
```



---

archive/issue_comments_127997.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2010-12-03T15:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127997",
    "user": "https://github.com/nexttime"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_127998.json:
```json
{
    "body": "<a id='comment:4'></a>\nP.S.: We should catch such automatically by `grep -iw downloading install.log`.",
    "created_at": "2010-12-03T15:19:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127998",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
P.S.: We should catch such automatically by `grep -iw downloading install.log`.



---

archive/issue_comments_127999.json:
```json
{
    "body": "<a id='comment:5'></a>\nWe have the correct dependencies in `spkg/standard/deps`:\n\n```make\n$(INST)/$(SPHINX): $(BASE) $(INST)/$(JINJA2) $(INST)/$(PATCH)\n\t$(INSTALL) \"$(SAGE_SPKG) $(SPHINX) 2>&1\" \"tee -a $(SAGE_LOGS)/$(SPHINX).log\"\n```\n\nbut our Jinja2 is too old:\n\n```sh\n~/Sage/sage-4.6.1.alpha2$ ls spkg/standard/jinja2-* \nspkg/standard/jinja2-2.1.1.p0.spkg\n```",
    "created_at": "2010-12-03T15:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-127999",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
We have the correct dependencies in `spkg/standard/deps`:

```make
$(INST)/$(SPHINX): $(BASE) $(INST)/$(JINJA2) $(INST)/$(PATCH)
	$(INSTALL) "$(SAGE_SPKG) $(SPHINX) 2>&1" "tee -a $(SAGE_LOGS)/$(SPHINX).log"
```

but our Jinja2 is too old:

```sh
~/Sage/sage-4.6.1.alpha2$ ls spkg/standard/jinja2-* 
spkg/standard/jinja2-2.1.1.p0.spkg
```



---

archive/issue_comments_128000.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Provide an upgraded  Jinja2 (>=2.2) spkg\"",
    "created_at": "2010-12-03T15:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128000",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "" to "Provide an upgraded  Jinja2 (>=2.2) spkg"



---

archive/issue_comments_128001.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n \n This depends on Jinja >= 2, Pygments >= 0.8, and docutils >= 0.4.\n ```\n- we should have \"Pygments >= 1.3.1\" due to ticket #10290. But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.\n+ we should have \"Pygments >= 1.3.1\" due to ticket #10290, and \"Jinja2 >= 2**.2**\". But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.\n \n * In the section\n \n``````\n",
    "created_at": "2010-12-03T15:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128001",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 
 This depends on Jinja >= 2, Pygments >= 0.8, and docutils >= 0.4.
 ```
- we should have "Pygments >= 1.3.1" due to ticket #10290. But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.
+ we should have "Pygments >= 1.3.1" due to ticket #10290, and "Jinja2 >= 2**.2**". But this is no biggy; it's a trivial typo that can either (i) be fixed in a new ticket, or (ii) fixed in the current ticket.
 
 * In the section
 
``````




---

archive/issue_comments_128002.json:
```json
{
    "body": "<a id='comment:8'></a>\nCC'ing the Jinja2 spkg maintainers.",
    "created_at": "2010-12-03T15:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128002",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>
CC'ing the Jinja2 spkg maintainers.



---

archive/issue_comments_128003.json:
```json
{
    "body": "<a id='comment:9'></a>\nI think an upgraded Jinja2 spkg is on the way, just a little patience...",
    "created_at": "2010-12-03T16:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128003",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>
I think an upgraded Jinja2 spkg is on the way, just a little patience...



---

archive/issue_comments_128004.json:
```json
{
    "body": "<a id='comment:10'></a>\nI've opened #10423 for a new Jinja2 spkg (2.5.5), coming up soon.",
    "created_at": "2010-12-03T17:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128004",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>
I've opened #10423 for a new Jinja2 spkg (2.5.5), coming up soon.



---

archive/issue_comments_128005.json:
```json
{
    "body": "Changing work_issues from \"Provide an upgraded  Jinja2 (>=2.2) spkg\" to \"\"",
    "created_at": "2010-12-03T17:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128005",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "Provide an upgraded  Jinja2 (>=2.2) spkg" to ""



---

archive/issue_comments_128006.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [leif](#comment%3A10):\n> I've opened #10423 for a new Jinja2 spkg (2.5.5), coming up soon.\n\n\nUpgraded Jinja2 spkg ready for review.",
    "created_at": "2010-12-03T18:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128006",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
Replying to [leif](#comment%3A10):
> I've opened #10423 for a new Jinja2 spkg (2.5.5), coming up soon.


Upgraded Jinja2 spkg ready for review.



---

archive/issue_comments_128007.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-12-03T19:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128007",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_128008.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [leif](#comment%3A4):\n> P.S.: We should catch such automatically by `grep -iw downloading install.log`.\n\n\nDone, thanks for the suggestion.",
    "created_at": "2010-12-03T19:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128008",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Replying to [leif](#comment%3A4):
> P.S.: We should catch such automatically by `grep -iw downloading install.log`.


Done, thanks for the suggestion.



---

archive/issue_comments_128009.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-12-05T02:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128009",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_128010.json:
```json
{
    "body": "<a id='comment:13'></a>\nTested on the following machines together with sphinx-1.0.4.p4.spkg and jinja2-2.5.5.p0.spkg. I put these updated packages in the source tarball of Sage 4.6.1.alpha2 and built Sage from source. After a successful build from source, I grep'd through `install.log` for the word \"Downloading\" as follows:\n\n```\n$ grep -iw 'Downloading' install.log\n```\n\nGrep'ing through the various `install.log` files didn't show any signs of packages being downloaded during the build.\n\n* {cleo, iras}.skynet: Sage didn't build from source, so the documentation can't be built at all.\n\n* {cicero, eno, lena, sextus, taurus, t2}: The HTML version of the documentation built OK, but with warnings about a missing LaTeX installation so LaTeX expressions won't be nicely typeset in the generated HTML files. There wasn't a LaTeX installation on this machine, so I wasn't able to build the PDF version of the documentation. \n\n* flavius.skynet: The HTML version of the documentation built OK, but with warnings about the missing 'dvipng' command, so the LaTeX expressions won't be nicely typeset in the generated HTML files. The PDF version built OK.\n\n* {gcc11, gcc16}.fsffrance.org: The HTML version of the documentation built OK. The PDF didn't build at all due to the following error:\n {{{\n! LaTeX Error: File `titlesec.sty' not found.\n }}}\n The documentation build process didn't hang at the above error, but continued on until the end.\n\n* rh.math: The HTML version of the documentation built OK, but with warnings about missing the command 'dvipng' so LaTeX expressions won't be nicely typeset in the generated HTML files. The PDF version of the documentation didn't build at all. The relevant error is:\n {{{\n! LaTeX Error: File `utf8x.def' not found.\n }}}\n The documentation build process didn't hang at the above error, but continued on until the end.\n\n* {bsd, hawk, sage}: Both the HTML and PDF versions of the documentation built OK.\n\nI'm OK with all changes in the updated spkg. But note the following minor issues:\n\n1. In the following line of `SPKG.txt`\n {{{\nThis depends on Jinja >= 2, Pygments >= 1.3.1, docutils >= 0.4.\n }}}\n the part \"Jinja >= 2,\" should be changed to \"Jinja >= 2.5.5,\" as per ticket #10423.\n1. The change log for sphinx-1.0.4.p4 should reference the number of the current ticket.\n\nIf the above changes are made, this ticket should get a positive review.",
    "created_at": "2010-12-05T02:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128010",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:13'></a>
Tested on the following machines together with sphinx-1.0.4.p4.spkg and jinja2-2.5.5.p0.spkg. I put these updated packages in the source tarball of Sage 4.6.1.alpha2 and built Sage from source. After a successful build from source, I grep'd through `install.log` for the word "Downloading" as follows:

```
$ grep -iw 'Downloading' install.log
```

Grep'ing through the various `install.log` files didn't show any signs of packages being downloaded during the build.

* {cleo, iras}.skynet: Sage didn't build from source, so the documentation can't be built at all.

* {cicero, eno, lena, sextus, taurus, t2}: The HTML version of the documentation built OK, but with warnings about a missing LaTeX installation so LaTeX expressions won't be nicely typeset in the generated HTML files. There wasn't a LaTeX installation on this machine, so I wasn't able to build the PDF version of the documentation. 

* flavius.skynet: The HTML version of the documentation built OK, but with warnings about the missing 'dvipng' command, so the LaTeX expressions won't be nicely typeset in the generated HTML files. The PDF version built OK.

* {gcc11, gcc16}.fsffrance.org: The HTML version of the documentation built OK. The PDF didn't build at all due to the following error:
 {{{
! LaTeX Error: File `titlesec.sty' not found.
 }}}
 The documentation build process didn't hang at the above error, but continued on until the end.

* rh.math: The HTML version of the documentation built OK, but with warnings about missing the command 'dvipng' so LaTeX expressions won't be nicely typeset in the generated HTML files. The PDF version of the documentation didn't build at all. The relevant error is:
 {{{
! LaTeX Error: File `utf8x.def' not found.
 }}}
 The documentation build process didn't hang at the above error, but continued on until the end.

* {bsd, hawk, sage}: Both the HTML and PDF versions of the documentation built OK.

I'm OK with all changes in the updated spkg. But note the following minor issues:

1. In the following line of `SPKG.txt`
 {{{
This depends on Jinja >= 2, Pygments >= 1.3.1, docutils >= 0.4.
 }}}
 the part "Jinja >= 2," should be changed to "Jinja >= 2.5.5," as per ticket #10423.
1. The change log for sphinx-1.0.4.p4 should reference the number of the current ticket.

If the above changes are made, this ticket should get a positive review.



---

archive/issue_comments_128011.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Minh Van Nguyen\"",
    "created_at": "2010-12-05T02:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128011",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing reviewer from "" to "Minh Van Nguyen"



---

archive/issue_comments_128012.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mvngu](#comment%3A13):\n>  1. In the following line of `SPKG.txt`\n  \n{{{\nThis depends on Jinja >= 2, Pygments >= 1.3.1, docutils >= 0.4.\n}}}\n>  the part \"Jinja >= 2,\" should be changed to \"Jinja >= 2.5.5,\" as per ticket #10423.\n\n\nI'd say >=2.2 as required by this Sphinx version; 2.5.5 is currently the latest.\n\nBtw, any ideas about *Jinja2's* true dependencies (cf. [comment:ticket:10423:1 this comment])?\n\nUpstream only explicitly mentions Python and setuptools (alternatively, preferably \"distribute\").",
    "created_at": "2010-12-05T02:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128012",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [mvngu](#comment%3A13):
>  1. In the following line of `SPKG.txt`
  
{{{
This depends on Jinja >= 2, Pygments >= 1.3.1, docutils >= 0.4.
}}}
>  the part "Jinja >= 2," should be changed to "Jinja >= 2.5.5," as per ticket #10423.


I'd say >=2.2 as required by this Sphinx version; 2.5.5 is currently the latest.

Btw, any ideas about *Jinja2's* true dependencies (cf. [comment:ticket:10423:1 this comment])?

Upstream only explicitly mentions Python and setuptools (alternatively, preferably "distribute").



---

archive/issue_comments_128013.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2010-12-05T09:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128013",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_128014.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-12-05T11:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128014",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_128015.json:
```json
{
    "body": "<a id='comment:16'></a>\nNew spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg)",
    "created_at": "2010-12-05T11:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128015",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
New spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg)



---

archive/issue_comments_128016.json:
```json
{
    "body": "p4 to p5 patch for reference",
    "created_at": "2010-12-05T11:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128016",
    "user": "https://github.com/jdemeyer"
}
```

p4 to p5 patch for reference



---

archive/issue_comments_128017.json:
```json
{
    "body": "<a id='comment:17'></a>\nAttachment [sphinx-1.0.4.p5.patch](tarball://root/attachments/some-uuid/ticket10350/sphinx-1.0.4.p5.patch) by mvngu created at 2010-12-05 11:43:45\n\nThe updated spkg is good to go. Thanks!",
    "created_at": "2010-12-05T11:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128017",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:17'></a>
Attachment [sphinx-1.0.4.p5.patch](tarball://root/attachments/some-uuid/ticket10350/sphinx-1.0.4.p5.patch) by mvngu created at 2010-12-05 11:43:45

The updated spkg is good to go. Thanks!



---

archive/issue_comments_128018.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -76,3 +76,7 @@\n Type X to quit or <RETURN> to proceed,\n or enter new name. (Default extension: sty)\n  }}}\n+\n+**Apply:**\n+\n+* http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg\n``````\n",
    "created_at": "2010-12-05T11:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128018",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -76,3 +76,7 @@
 Type X to quit or <RETURN> to proceed,
 or enter new name. (Default extension: sty)
  }}}
+
+**Apply:**
+
+* http://sage.math.washington.edu/home/jdemeyer/spkg/sphinx-1.0.4.p5.spkg
``````




---

archive/issue_comments_128019.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-12-05T11:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128019",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_128020.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-12-05T11:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128020",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_128021.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.6.1.alpha3\"",
    "created_at": "2010-12-05T11:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128021",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.6.1.alpha3"



---

archive/issue_events_026618.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-05T11:51:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10350#event-26618"
}
```



---

archive/issue_comments_128022.json:
```json
{
    "body": "<a id='comment:19'></a>\nStylewise, I would have used a `make` variable for redirecting `stdin`.\n\nThis could easily be modified without touching the patch at all.\n\nI would also use `utf8` instead of `utf8x` *conditionally*, i.e., first check if `utf8x` is available.",
    "created_at": "2010-12-05T15:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128022",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:19'></a>
Stylewise, I would have used a `make` variable for redirecting `stdin`.

This could easily be modified without touching the patch at all.

I would also use `utf8` instead of `utf8x` *conditionally*, i.e., first check if `utf8x` is available.



---

archive/issue_comments_128023.json:
```json
{
    "body": "Changing keywords from \"sphinx spkg\" to \"sphinx spkg utf8x LaTeX error titlesec\".",
    "created_at": "2010-12-05T15:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128023",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "sphinx spkg" to "sphinx spkg utf8x LaTeX error titlesec".



---

archive/issue_comments_128024.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [leif](#comment%3A19):\n> Stylewise, I would have used a `make` variable for redirecting `stdin`.\n\nI suppose there is no harm in doing this, but I don't see much gain either.\n\n> I would also use `utf8` instead of `utf8x` *conditionally*, i.e., first check if `utf8x` is available.\n\nWhy?  I dislike conditional stuff without a good reason.",
    "created_at": "2010-12-05T15:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128024",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Replying to [leif](#comment%3A19):
> Stylewise, I would have used a `make` variable for redirecting `stdin`.

I suppose there is no harm in doing this, but I don't see much gain either.

> I would also use `utf8` instead of `utf8x` *conditionally*, i.e., first check if `utf8x` is available.

Why?  I dislike conditional stuff without a good reason.



---

archive/issue_comments_128025.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [jdemeyer](#comment%3A20):\n> Replying to [leif](#comment%3A19):\n> > Stylewise, I would have used a `make` variable for redirecting `stdin`.\n\n> I suppose there is no harm in doing this, but I don't see much gain either.\n\nIt's more flexible and eases maintaining, in any case.\n\n\n\n> > I would also use `utf8` instead of `utf8x` *conditionally*, i.e., first check if `utf8x` is available.\n\n> Why?  I dislike conditional stuff without a good reason.\n\nI don't like generally disabling things or introducing artificial limits just because there are problems on **some** platforms or installations.\n\nIn the case of `utf8x`, it's not unlikely someone would use it for his documents, or Sage documentation in other languages perhaps, and it should be more wide-spread in the future (while I assume disabling it in Sage will last for a long time...)",
    "created_at": "2010-12-05T16:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128025",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>
Replying to [jdemeyer](#comment%3A20):
> Replying to [leif](#comment%3A19):
> > Stylewise, I would have used a `make` variable for redirecting `stdin`.

> I suppose there is no harm in doing this, but I don't see much gain either.

It's more flexible and eases maintaining, in any case.



> > I would also use `utf8` instead of `utf8x` *conditionally*, i.e., first check if `utf8x` is available.

> Why?  I dislike conditional stuff without a good reason.

I don't like generally disabling things or introducing artificial limits just because there are problems on **some** platforms or installations.

In the case of `utf8x`, it's not unlikely someone would use it for his documents, or Sage documentation in other languages perhaps, and it should be more wide-spread in the future (while I assume disabling it in Sage will last for a long time...)



---

archive/issue_comments_128026.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [leif](#comment%3A21):\n> In the case of `utf8x`, it's not unlikely someone would use it for his documents, or Sage documentation in other languages perhaps.\n\nIf that happens, we need to completely drop support for `utf8`.  A conditional build is also pointless in this case.",
    "created_at": "2010-12-05T22:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10350",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10350#issuecomment-128026",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [leif](#comment%3A21):
> In the case of `utf8x`, it's not unlikely someone would use it for his documents, or Sage documentation in other languages perhaps.

If that happens, we need to completely drop support for `utf8`.  A conditional build is also pointless in this case.
