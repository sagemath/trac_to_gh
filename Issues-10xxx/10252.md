# Issue 10252: ecm does not compile on some 32-bit Linux systems

archive/issues_010251.json:
```json
{
    "assignees": [],
    "body": "On the Skynet machine cicero and on a 32-bit Gentoo Linux Pentium D machine of my own, the ecm package from #5847 does not install in Sage.\n\nThe problem is with Sage's `spkg-install` as the pure upstream sources in `src/` work fine.\n\nThe following works:\n\n```\n$ ./configure\n$ make\n```\n\nThe following (emulating `spkg-install`) does NOT work:\n\n```\n$ export CFLAGS=\"-g -O3 -fPIC\"\n$ ./configure\n$ make\n```\n\nIt fails with the error\n\n```\nspv.c: In function 'spv_pwmul':\nspv.c:157: error: unknown register name '%xmm7' in 'asm'\nspv.c:157: error: unknown register name '%xmm6' in 'asm'\nspv.c:157: error: unknown register name '%xmm5' in 'asm'\nspv.c:157: error: unknown register name '%xmm3' in 'asm'\nspv.c:157: error: unknown register name '%xmm2' in 'asm'\nspv.c:157: error: unknown register name '%xmm1' in 'asm'\nspv.c:157: error: unknown register name '%xmm0' in 'asm'\n```\n\nIt doesn't actually matter what CFLAGS is set to, it fails even with\n\n```\n$ export CFLAGS=\" \"\n```\n\nThis is probably because Sage's CFLAGS overrides ecm's CFLAGS.  I think the easiest solution is simply not set any CFLAGS in ecm's `spkg-install`.  Since ecm really wants to optimize for a particular machine, I think the fact that ecm's CFLAGS are not used has also bad consequences for speed.\n\n---\n\nActually an upstream bug... (And not setting `CFLAGS` or `CC` is not an option. There are different ways to let the compiler produce processor-specific optimized code. Note that this anyway doesn't affect optimized assembly code, which ECM also comes with.)\n\n**New spkg (ecm-6.3.p2) fixing this** (including the upstream patch) **at #5847.**\n\n---\n\n**This ticket can be closed when #5847 got merged.**\n\n\nDepends on #5847\n\nCC:  @zimmermann6 @dimpase @nexttime @mwhansen\n\nKeywords: **ecm spkg-install SSE2**\n\nComponent: **packages: standard**\n\nReviewer: **Leif Leonhardy**\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10252_\n\n",
    "closed_at": "2011-09-12T19:00:30Z",
    "created_at": "2010-11-12T10:24:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "ecm does not compile on some 32-bit Linux systems",
    "type": "issue",
    "updated_at": "2012-01-03T23:57:03Z",
    "url": "https://github.com/sagemath/sage/issues/10252",
    "user": "https://github.com/jdemeyer"
}
```
On the Skynet machine cicero and on a 32-bit Gentoo Linux Pentium D machine of my own, the ecm package from #5847 does not install in Sage.

The problem is with Sage's `spkg-install` as the pure upstream sources in `src/` work fine.

The following works:

```
$ ./configure
$ make
```

The following (emulating `spkg-install`) does NOT work:

```
$ export CFLAGS="-g -O3 -fPIC"
$ ./configure
$ make
```

It fails with the error

```
spv.c: In function 'spv_pwmul':
spv.c:157: error: unknown register name '%xmm7' in 'asm'
spv.c:157: error: unknown register name '%xmm6' in 'asm'
spv.c:157: error: unknown register name '%xmm5' in 'asm'
spv.c:157: error: unknown register name '%xmm3' in 'asm'
spv.c:157: error: unknown register name '%xmm2' in 'asm'
spv.c:157: error: unknown register name '%xmm1' in 'asm'
spv.c:157: error: unknown register name '%xmm0' in 'asm'
```

It doesn't actually matter what CFLAGS is set to, it fails even with

```
$ export CFLAGS=" "
```

This is probably because Sage's CFLAGS overrides ecm's CFLAGS.  I think the easiest solution is simply not set any CFLAGS in ecm's `spkg-install`.  Since ecm really wants to optimize for a particular machine, I think the fact that ecm's CFLAGS are not used has also bad consequences for speed.

---

Actually an upstream bug... (And not setting `CFLAGS` or `CC` is not an option. There are different ways to let the compiler produce processor-specific optimized code. Note that this anyway doesn't affect optimized assembly code, which ECM also comes with.)

**New spkg (ecm-6.3.p2) fixing this** (including the upstream patch) **at #5847.**

---

**This ticket can be closed when #5847 got merged.**


Depends on #5847

CC:  @zimmermann6 @dimpase @nexttime @mwhansen

Keywords: **ecm spkg-install SSE2**

Component: **packages: standard**

Reviewer: **Leif Leonhardy**

Upstream: **Fixed upstream, but not in a stable release.**

_Issue created by migration from https://trac.sagemath.org/ticket/10252_





---

archive/issue_events_134622.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-12T10:24:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "milestone_number": null,
    "milestone_title": "sage-4.6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134622"
}
```



---

archive/issue_events_134623.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-12T10:24:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134623"
}
```



---

archive/issue_events_134624.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-12T10:24:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134624"
}
```



---

archive/issue_events_134625.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-12T10:24:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134625"
}
```



---

archive/issue_comments_095526.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nnote that GMP-ECM uses CC and CFLAGS from GMP, which ensures both portability and performance.\nThus overriding the choice of CFLAGS by GMP-ECM is a bad idea.\n\nWhat does `grep CFLAGS gmp.h` give on that machine?\n\nPaul",
    "created_at": "2010-11-12T10:38:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95526",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:2" align="right">comment:2</div>

note that GMP-ECM uses CC and CFLAGS from GMP, which ensures both portability and performance.
Thus overriding the choice of CFLAGS by GMP-ECM is a bad idea.

What does `grep CFLAGS gmp.h` give on that machine?

Paul



---

archive/issue_comments_095527.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@zimmermann6](#comment:2):\n> What does `grep CFLAGS gmp.h` give on that machine?\n\nOn my machine (32-bit Gentoo Linux Pentium D), I get with the mpir header installed by Sage:\n\n```\n#define __GMP_CFLAGS \"-g -O3 \"\n#define __MPIR_CFLAGS \"-g -O3 \"\n```\n\nWith the system-wide `/usr/include/gmp.h`, I get\n\n```\n#define __GMP_CFLAGS \"-pipe -march=nocona -O2 -mfpmath=sse\"\n```",
    "created_at": "2010-11-12T12:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95527",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@zimmermann6](#comment:2):
> What does `grep CFLAGS gmp.h` give on that machine?

On my machine (32-bit Gentoo Linux Pentium D), I get with the mpir header installed by Sage:

```
#define __GMP_CFLAGS "-g -O3 "
#define __MPIR_CFLAGS "-g -O3 "
```

With the system-wide `/usr/include/gmp.h`, I get

```
#define __GMP_CFLAGS "-pipe -march=nocona -O2 -mfpmath=sse"
```



---

archive/issue_comments_095528.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@jdemeyer](#comment:3):\n> Replying to [@zimmermann6](#comment:2):\n> > What does `grep CFLAGS gmp.h` give on that machine?\n\n> \n> On my machine (32-bit Gentoo Linux Pentium D), I get with the mpir header installed by Sage:\n> \n> ```\n> #define __GMP_CFLAGS \"-g -O3 \"\n> #define __MPIR_CFLAGS \"-g -O3 \"\n> ```\n> \n> With the system-wide `/usr/include/gmp.h`, I get\n> \n> ```\n> #define __GMP_CFLAGS \"-pipe -march=nocona -O2 -mfpmath=sse\"\n> ```\n\nthe spkg should work with the system-wide CFLAGS value. With `-g -O3` it seems `HAVE_SSE2` is defined but SSE2 is not supported.\n\nWhat is strange is that the GMP-ECM configure checks if SSE2 is really supported,\nand if it is not the SSE2 code should not be compiled.\n\nDo you confirm that the upstream package works with `CFLAGS=-g -O3`?\n\nPaul",
    "created_at": "2010-11-12T13:04:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95528",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@jdemeyer](#comment:3):
> Replying to [@zimmermann6](#comment:2):
> > What does `grep CFLAGS gmp.h` give on that machine?

> 
> On my machine (32-bit Gentoo Linux Pentium D), I get with the mpir header installed by Sage:
> 
> ```
> #define __GMP_CFLAGS "-g -O3 "
> #define __MPIR_CFLAGS "-g -O3 "
> ```
> 
> With the system-wide `/usr/include/gmp.h`, I get
> 
> ```
> #define __GMP_CFLAGS "-pipe -march=nocona -O2 -mfpmath=sse"
> ```

the spkg should work with the system-wide CFLAGS value. With `-g -O3` it seems `HAVE_SSE2` is defined but SSE2 is not supported.

What is strange is that the GMP-ECM configure checks if SSE2 is really supported,
and if it is not the SSE2 code should not be compiled.

Do you confirm that the upstream package works with `CFLAGS=-g -O3`?

Paul



---

archive/issue_comments_095529.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@zimmermann6](#comment:4):\n> Do you confirm that the upstream package works with `CFLAGS=-g -O3`?\n\nNo, the upstream package does not work with those CFLAGS.  The reports in this bug report concerned the **upstream** sources (built independently of Sage).",
    "created_at": "2010-11-12T13:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95529",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@zimmermann6](#comment:4):
> Do you confirm that the upstream package works with `CFLAGS=-g -O3`?

No, the upstream package does not work with those CFLAGS.  The reports in this bug report concerned the **upstream** sources (built independently of Sage).



---

archive/issue_comments_095530.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI can reproduce the problem on a 32-bit Pentium 4, both with ecm-6.3 and the svn version. I will\ntry to find a fix.\n\nPaul",
    "created_at": "2010-11-12T13:22:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95530",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:6" align="right">comment:6</div>

I can reproduce the problem on a 32-bit Pentium 4, both with ecm-6.3 and the svn version. I will
try to find a fix.

Paul



---

archive/issue_comments_095531.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n> I will try to find a fix.\n\nwith Pierrick Gaudry, we have analyzed and fixed the problem.\n\nLong story: the asm volatile instructions without constraints in the configure script compile fine without -msse2, but those from the `spv.c` file, which have constraints, do not compile\nwithout -msse2. The fix was to put instructions with constraints in configure.\n\nShort story: apply the following patch\n\n```\n--- configure.in        (revision 1545)\n+++ configure.in        (revision 1546)\n@@ -296,9 +296,9 @@\n   AC_MSG_CHECKING([for SSE2 support])\n   m4_define([SSE2_TEST_PROG], [AC_LANG_PROGRAM([], dnl\n [#if (defined(__GNUC__) || defined(__ICL)) && defined(__i386__)\n-/* When there are no constraints, registers are referred to by\n-   single % sign, not double. Argh */\n-asm volatile (\"pmuludq %xmm2, %xmm0\");\n+/* On some machines, a program without constraints may pass without -msse2 but\n+   those with constraints in spv.c fail, thus we test with constraints here. */\n+asm volatile (\"pmuludq %%xmm2, %%xmm0\" : : :\"%xmm0\");\n #else\n #error\n #IRIXdoesnotexitaterrordirective\n```",
    "created_at": "2010-11-12T14:17:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95531",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:7" align="right">comment:7</div>

> I will try to find a fix.

with Pierrick Gaudry, we have analyzed and fixed the problem.

Long story: the asm volatile instructions without constraints in the configure script compile fine without -msse2, but those from the `spv.c` file, which have constraints, do not compile
without -msse2. The fix was to put instructions with constraints in configure.

Short story: apply the following patch

```
--- configure.in        (revision 1545)
+++ configure.in        (revision 1546)
@@ -296,9 +296,9 @@
   AC_MSG_CHECKING([for SSE2 support])
   m4_define([SSE2_TEST_PROG], [AC_LANG_PROGRAM([], dnl
 [#if (defined(__GNUC__) || defined(__ICL)) && defined(__i386__)
-/* When there are no constraints, registers are referred to by
-   single % sign, not double. Argh */
-asm volatile ("pmuludq %xmm2, %xmm0");
+/* On some machines, a program without constraints may pass without -msse2 but
+   those with constraints in spv.c fail, thus we test with constraints here. */
+asm volatile ("pmuludq %%xmm2, %%xmm0" : : :"%xmm0");
 #else
 #error
 #IRIXdoesnotexitaterrordirective
```



---

archive/issue_comments_095532.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI can imagine that this bug-fix will make the ecm package work, but I believe that the deeper issue in Sage still needs to be addressed: namely that `spkg-install` (both for mpir and for ecm) is providing CFLAGS when it should leave that to the packages themselves.\n\nFor example, on sage.math.washington.edu, the upstream mpir package uses the flags `-O2 -m64 -march=core2 -mtune=core2` (i.e.: optimized for the particular machine) while within Sage, the flags `-g -O3` are used.",
    "created_at": "2010-11-12T14:29:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95532",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

I can imagine that this bug-fix will make the ecm package work, but I believe that the deeper issue in Sage still needs to be addressed: namely that `spkg-install` (both for mpir and for ecm) is providing CFLAGS when it should leave that to the packages themselves.

For example, on sage.math.washington.edu, the upstream mpir package uses the flags `-O2 -m64 -march=core2 -mtune=core2` (i.e.: optimized for the particular machine) while within Sage, the flags `-g -O3` are used.



---

archive/issue_comments_095533.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@jdemeyer](#comment:8):\n> I can imagine that this bug-fix will make the ecm package work, but I believe that the deeper issue in Sage still needs to be addressed: namely that `spkg-install` (both for mpir and for ecm) is providing CFLAGS when it should leave that to the packages themselves.\n> \n> For example, on sage.math.washington.edu, the upstream mpir package uses the flags `-O2 -m64 -march=core2 -mtune=core2` (i.e.: optimized for the particular machine) while within Sage, the flags `-g -O3` are used.\n\nHow does the upstream mpir find these optimized flags?",
    "created_at": "2010-11-12T17:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95533",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@jdemeyer](#comment:8):
> I can imagine that this bug-fix will make the ecm package work, but I believe that the deeper issue in Sage still needs to be addressed: namely that `spkg-install` (both for mpir and for ecm) is providing CFLAGS when it should leave that to the packages themselves.
> 
> For example, on sage.math.washington.edu, the upstream mpir package uses the flags `-O2 -m64 -march=core2 -mtune=core2` (i.e.: optimized for the particular machine) while within Sage, the flags `-g -O3` are used.

How does the upstream mpir find these optimized flags?



---

archive/issue_events_134626.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-19T10:45:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134626"
}
```



---

archive/issue_events_134627.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-19T10:45:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134627"
}
```



---

archive/issue_comments_095534.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@jdemeyer](#comment:8):\n> I can imagine that this bug-fix will make the ecm package work, but I believe that the deeper issue in Sage still needs to be addressed: namely that `spkg-install` (both for mpir and for ecm) is providing CFLAGS when it should leave that to the packages themselves.\n\nI consider such *upstream* issues, i.e., upstream should IMHO **\"modify\"** `CFLAGS` et al. if appropriate or necessary, rather than either ignoring them or (solely) using user-specified settings \"as is\".\n\n(Try e.g. `env CFLAGS=\"\" ./sage -ba-force && ./sage -c \"quit\"`... which *breaks* the Cython-generated C code, or at least used to do so.)\n\n\n\n\n> For example, on sage.math.washington.edu, the upstream mpir package uses the flags `-O2 -m64 -march=core2 -mtune=core2` (i.e.: optimized for the particular machine) while within Sage, the flags `-g -O3` are used.\n\nJust for the record: `-march=hobel` implies `-mtune=hobel` (and `-mcpu=hobel`).",
    "created_at": "2010-11-21T17:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95534",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@jdemeyer](#comment:8):
> I can imagine that this bug-fix will make the ecm package work, but I believe that the deeper issue in Sage still needs to be addressed: namely that `spkg-install` (both for mpir and for ecm) is providing CFLAGS when it should leave that to the packages themselves.

I consider such *upstream* issues, i.e., upstream should IMHO **"modify"** `CFLAGS` et al. if appropriate or necessary, rather than either ignoring them or (solely) using user-specified settings "as is".

(Try e.g. `env CFLAGS="" ./sage -ba-force && ./sage -c "quit"`... which *breaks* the Cython-generated C code, or at least used to do so.)




> For example, on sage.math.washington.edu, the upstream mpir package uses the flags `-O2 -m64 -march=core2 -mtune=core2` (i.e.: optimized for the particular machine) while within Sage, the flags `-g -O3` are used.

Just for the record: `-march=hobel` implies `-mtune=hobel` (and `-mcpu=hobel`).



---

archive/issue_comments_095535.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n> I consider such upstream issues, i.e., upstream should IMHO \"modify\" CFLAGS et al. if appropriate or necessary\n\nI disagree. If the user requests CFLAGS=..., upstream should use those flags.\n\nPaul Zimmermann",
    "created_at": "2010-11-21T19:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95535",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:12" align="right">comment:12</div>

> I consider such upstream issues, i.e., upstream should IMHO "modify" CFLAGS et al. if appropriate or necessary

I disagree. If the user requests CFLAGS=..., upstream should use those flags.

Paul Zimmermann



---

archive/issue_comments_095536.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@zimmermann6](#comment:12):\n> > I consider such upstream issues, i.e., upstream should IMHO \"modify\" CFLAGS et al. if appropriate or necessary\n\n> \n> I disagree. If the user requests CFLAGS=..., upstream should use those flags.\n\nYes, but not (necessarily) exclusively. ;-)\n\n(Almost all build scripts append or prepend to `CFLAGS` etc., which is convenient if one only wants to add e.g. \"`-g`\", \"`-march=native`\" or \"`-mcpu=i486`\". Here we want the former...)",
    "created_at": "2010-11-21T19:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95536",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@zimmermann6](#comment:12):
> > I consider such upstream issues, i.e., upstream should IMHO "modify" CFLAGS et al. if appropriate or necessary

> 
> I disagree. If the user requests CFLAGS=..., upstream should use those flags.

Yes, but not (necessarily) exclusively. ;-)

(Almost all build scripts append or prepend to `CFLAGS` etc., which is convenient if one only wants to add e.g. "`-g`", "`-march=native`" or "`-mcpu=i486`". Here we want the former...)



---

archive/issue_events_134628.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-22T01:11:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134628"
}
```



---

archive/issue_comments_095537.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSo we at least still have the problem of adding `-m64` if `SAGE64=yes` (i.e., if we want a 64-bit build on systems that default to 32-bit builds):\n\n```sh\n...\n# Note that GMP-ECM is written in C (and assembler) - no C++ sources.\n\nif [ \"$SAGE64\" = yes ]; then\n    echo \"Building a 64-bit version of GMP-ECM\"\n    if [ -z \"$CFLAG64\" ]; then\n        CFLAG64=-m64\n    fi\n    CFLAGS=\"$CFLAGS $CFLAG64 -fPIC\"\n    LDFLAGS=\"$CFLAG64\"; export LDFLAGS\nelse\n    CFLAGS=\"$CFLAGS -fPIC\"\nfi\n\n# We add debug symbols by default;\nif [ \"$SAGE_DEBUG\" = yes ]; then\n    # Disable optimization:\n    CFLAGS=\"$CFLAGS -g -O0\"\nelse\n    # Enable optimization, may be overridden by user settings:\n    CFLAGS=\"-g -O3 $CFLAGS\"\nfi\n\nexport CFLAGS # usually redundant, but safe(r)\n...\n```\n\nOf course I could add \"our\" (or worse, also *any user-specified*) `CFLAGS` to `CC`, i.e. the C compiler command, and `unset CFLAGS` to make ECM's effective, but I wouldn't like that. (And some settings then would get overridden by ECM's `CFLAGS` anyway.)\n\n---\n\nAn IMHO better solution is to also add `-march=native` to `CFLAGS`, since this enables SSE (to be precise, allows SSE2 instructions) if supported by the processor (when `configure` defines `HAVE_SSE2`), ignoring `SAGE_FAT_BINARY` at least for the moment (unless ECM's `configure` has an option like `--disable-sse` or similar; I haven't really checked that yet, perhaps just `--enable-sse2=no` on *32-bit* x86).\n\n\n\n\nI'm not sure what happens if we configure with `CFLAGS` set and `--enable-gmp-cflags=no` (which seems to be more appropriate when using ECM with MPIR).",
    "created_at": "2010-11-22T01:11:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95537",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

So we at least still have the problem of adding `-m64` if `SAGE64=yes` (i.e., if we want a 64-bit build on systems that default to 32-bit builds):

```sh
...
# Note that GMP-ECM is written in C (and assembler) - no C++ sources.

if [ "$SAGE64" = yes ]; then
    echo "Building a 64-bit version of GMP-ECM"
    if [ -z "$CFLAG64" ]; then
        CFLAG64=-m64
    fi
    CFLAGS="$CFLAGS $CFLAG64 -fPIC"
    LDFLAGS="$CFLAG64"; export LDFLAGS
else
    CFLAGS="$CFLAGS -fPIC"
fi

# We add debug symbols by default;
if [ "$SAGE_DEBUG" = yes ]; then
    # Disable optimization:
    CFLAGS="$CFLAGS -g -O0"
else
    # Enable optimization, may be overridden by user settings:
    CFLAGS="-g -O3 $CFLAGS"
fi

export CFLAGS # usually redundant, but safe(r)
...
```

Of course I could add "our" (or worse, also *any user-specified*) `CFLAGS` to `CC`, i.e. the C compiler command, and `unset CFLAGS` to make ECM's effective, but I wouldn't like that. (And some settings then would get overridden by ECM's `CFLAGS` anyway.)

---

An IMHO better solution is to also add `-march=native` to `CFLAGS`, since this enables SSE (to be precise, allows SSE2 instructions) if supported by the processor (when `configure` defines `HAVE_SSE2`), ignoring `SAGE_FAT_BINARY` at least for the moment (unless ECM's `configure` has an option like `--disable-sse` or similar; I haven't really checked that yet, perhaps just `--enable-sse2=no` on *32-bit* x86).




I'm not sure what happens if we configure with `CFLAGS` set and `--enable-gmp-cflags=no` (which seems to be more appropriate when using ECM with MPIR).



---

archive/issue_comments_095538.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nJust for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...",
    "created_at": "2010-11-22T04:52:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95538",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:15" align="right">comment:15</div>

Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...



---

archive/issue_events_134629.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-22T04:52:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134629"
}
```



---

archive/issue_events_134630.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-22T04:52:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134630"
}
```



---

archive/issue_comments_095539.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@nexttime](#comment:14):\n> So we at least still have the problem of adding `-m64` if `SAGE64=yes` [...]\n\nnot sure. GMP uses 64-bit words if available (even if the system is 32 bit), and GMP-ECM uses\nGMP CFLAGS.\n\nPaul",
    "created_at": "2010-11-22T08:29:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95539",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@nexttime](#comment:14):
> So we at least still have the problem of adding `-m64` if `SAGE64=yes` [...]

not sure. GMP uses 64-bit words if available (even if the system is 32 bit), and GMP-ECM uses
GMP CFLAGS.

Paul



---

archive/issue_comments_095540.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSo the solution is easy: don't set **any** `CFLAGS` in the mpir and ecm packages.  Right?",
    "created_at": "2010-11-22T08:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95540",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

So the solution is easy: don't set **any** `CFLAGS` in the mpir and ecm packages.  Right?



---

archive/issue_comments_095541.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jdemeyer](#comment:17):\n> So the solution is easy: don't set **any** `CFLAGS` in the mpir and ecm packages.  Right?\n\nthat is my advice. Same for MPFR, which also copies CFLAGS from GMP.\n\nPaul",
    "created_at": "2010-11-22T09:20:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95541",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jdemeyer](#comment:17):
> So the solution is easy: don't set **any** `CFLAGS` in the mpir and ecm packages.  Right?

that is my advice. Same for MPFR, which also copies CFLAGS from GMP.

Paul



---

archive/issue_comments_095542.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@nexttime](#comment:14):\n> An IMHO better solution is to also add `-march=native` to `CFLAGS`, since this enables SSE (to be precise, allows SSE2 instructions) if supported by the processor (when `configure` defines `HAVE_SSE2`), ignoring `SAGE_FAT_BINARY` at least for the moment (unless ECM's `configure` has an option like `--disable-sse` or similar; I haven't really checked that yet, perhaps just `--enable-sse2=no` on *32-bit* x86).\n\nYou know that -march=native is only supported on x86 and amd64 cpus right?\nI can tell you first hand that the compilation will stop straight away on ppc.\nAnd then you will get Dave telling you it is not supported by other compilers.",
    "created_at": "2010-11-22T09:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95542",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@nexttime](#comment:14):
> An IMHO better solution is to also add `-march=native` to `CFLAGS`, since this enables SSE (to be precise, allows SSE2 instructions) if supported by the processor (when `configure` defines `HAVE_SSE2`), ignoring `SAGE_FAT_BINARY` at least for the moment (unless ECM's `configure` has an option like `--disable-sse` or similar; I haven't really checked that yet, perhaps just `--enable-sse2=no` on *32-bit* x86).

You know that -march=native is only supported on x86 and amd64 cpus right?
I can tell you first hand that the compilation will stop straight away on ppc.
And then you will get Dave telling you it is not supported by other compilers.



---

archive/issue_comments_095543.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kiwifb](#comment:19):\n> You know that -march=native is only supported on x86 and amd64 cpus right?\n\nNot only, but ...\n\n> I can tell you first hand that the compilation will stop straight away on ppc.\n\nI was not going to try to enable SSE2 on PowerPCs (nor SPARC processors). ;-)\n\n\n\n\n\n> And then you will get Dave telling you it is not supported by other compilers.\n\nThere's very little support for other compilers in Sage, and it's easy to add a distinction when the day it gets necessary comes, though I could add it now.",
    "created_at": "2010-11-22T10:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95543",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kiwifb](#comment:19):
> You know that -march=native is only supported on x86 and amd64 cpus right?

Not only, but ...

> I can tell you first hand that the compilation will stop straight away on ppc.

I was not going to try to enable SSE2 on PowerPCs (nor SPARC processors). ;-)





> And then you will get Dave telling you it is not supported by other compilers.

There's very little support for other compilers in Sage, and it's easy to add a distinction when the day it gets necessary comes, though I could add it now.



---

archive/issue_comments_095544.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@nexttime](#comment:20):\n> Replying to [@kiwifb](#comment:19):\n> > You know that -march=native is only supported on x86 and amd64 cpus right?\n\n> \n> Not only, but ...\n> \n> > I can tell you first hand that the compilation will stop straight away on ppc.\n\n> \n> I was not going to try to enable SSE2 on PowerPCs (nor SPARC processors). ;-)\n> \n> \n\n> \n> \n> > And then you will get Dave telling you it is not supported by other compilers.\n\n> \n> There's very little support for other compilers in Sage, and it's easy to add a distinction when the day it gets necessary comes, though I could add it now.\n\nOk, I missed a little bit of context. I guess I didn't pay full attention to the whole thread. Sorry for the noise.",
    "created_at": "2010-11-22T10:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95544",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@nexttime](#comment:20):
> Replying to [@kiwifb](#comment:19):
> > You know that -march=native is only supported on x86 and amd64 cpus right?

> 
> Not only, but ...
> 
> > I can tell you first hand that the compilation will stop straight away on ppc.

> 
> I was not going to try to enable SSE2 on PowerPCs (nor SPARC processors). ;-)
> 
> 

> 
> 
> > And then you will get Dave telling you it is not supported by other compilers.

> 
> There's very little support for other compilers in Sage, and it's easy to add a distinction when the day it gets necessary comes, though I could add it now.

Ok, I missed a little bit of context. I guess I didn't pay full attention to the whole thread. Sorry for the noise.



---

archive/issue_events_134631.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-24T02:16:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134631"
}
```



---

archive/issue_events_134632.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-11-24T02:16:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134632"
}
```



---

archive/issue_comments_095545.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@nexttime](#comment:15):\n> Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...\n\nDid so...\n\nSetting this ticket to \"needs review\" too, can be closed as duplicate when #5847 gets a positive review / merged.",
    "created_at": "2010-11-24T02:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95545",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@nexttime](#comment:15):
> Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...

Did so...

Setting this ticket to "needs review" too, can be closed as duplicate when #5847 gets a positive review / merged.



---

archive/issue_comments_095546.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -37,3 +37,10 @@\n ```\n \n This is probably because Sage's CFLAGS overrides ecm's CFLAGS.  I think the easiest solution is simply not set any CFLAGS in ecm's `spkg-install`.  Since ecm really wants to optimize for a particular machine, I think the fact that ecm's CFLAGS are not used has also bad consequences for speed.\n+\n+---\n+\n+Actually an upstream bug... (And not setting `CFLAGS` or `CC` is not an option. There are different ways to let the compiler produce processor-specific optimized code. Note that this anyway doesn't affect optimized assembly code, which ECM also comes with.)\n+\n+**New spkg (ecm-6.3.p2) fixing this** (including the upstream patch) **at #5847.**\n+\n``````\n",
    "created_at": "2010-11-24T02:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95546",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -37,3 +37,10 @@
 ```
 
 This is probably because Sage's CFLAGS overrides ecm's CFLAGS.  I think the easiest solution is simply not set any CFLAGS in ecm's `spkg-install`.  Since ecm really wants to optimize for a particular machine, I think the fact that ecm's CFLAGS are not used has also bad consequences for speed.
+
+---
+
+Actually an upstream bug... (And not setting `CFLAGS` or `CC` is not an option. There are different ways to let the compiler produce processor-specific optimized code. Note that this anyway doesn't affect optimized assembly code, which ECM also comes with.)
+
+**New spkg (ecm-6.3.p2) fixing this** (including the upstream patch) **at #5847.**
+
``````




---

archive/issue_comments_095547.json:
```json
{
    "body": "Upstream: **Fixed upstream, but not in a stable release.**",
    "created_at": "2010-11-24T02:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95547",
    "user": "https://github.com/nexttime"
}
```

Upstream: **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_095548.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@nexttime](#comment:22):\n> Replying to [@nexttime](#comment:15):\n> > Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...\n\n> \n> Did so...\n> \n> Setting this ticket to \"needs review\" too, can be closed as duplicate when #5847 gets a positive review / merged.\n\nI've updated the p2 package at #5847 (some corrections, some improvements); same place, different md5sum, still or again needing testing (especially on PowerPCs) / review.\n\nSee https://github.com/sagemath/sage/issues/5847#comment:86 .",
    "created_at": "2010-11-25T14:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95548",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@nexttime](#comment:22):
> Replying to [@nexttime](#comment:15):
> > Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...

> 
> Did so...
> 
> Setting this ticket to "needs review" too, can be closed as duplicate when #5847 gets a positive review / merged.

I've updated the p2 package at #5847 (some corrections, some improvements); same place, different md5sum, still or again needing testing (especially on PowerPCs) / review.

See https://github.com/sagemath/sage/issues/5847#comment:86 .



---

archive/issue_comments_095549.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@nexttime](#comment:23):\n> Replying to [@nexttime](#comment:22):\n> > Replying to [@nexttime](#comment:15):\n> > > Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...\n\n> > \n> > Did so...\n> > \n> > Setting this ticket to \"needs review\" too, can be closed as duplicate when #5847 gets a positive review / merged.\n\n> \n> I've updated the p2 package at #5847 (some corrections, some improvements); same place, different md5sum, still or again needing testing (especially on PowerPCs) / review.\n> \n> See https://github.com/sagemath/sage/issues/5847#comment:86 .\n\nduly tested on PPC, see the other ticket.",
    "created_at": "2010-11-25T16:43:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95549",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@nexttime](#comment:23):
> Replying to [@nexttime](#comment:22):
> > Replying to [@nexttime](#comment:15):
> > > Just for the record: I'll upload a new spkg that also fixes this issue at #5847 (hopefully) soon...

> > 
> > Did so...
> > 
> > Setting this ticket to "needs review" too, can be closed as duplicate when #5847 gets a positive review / merged.

> 
> I've updated the p2 package at #5847 (some corrections, some improvements); same place, different md5sum, still or again needing testing (especially on PowerPCs) / review.
> 
> See https://github.com/sagemath/sage/issues/5847#comment:86 .

duly tested on PPC, see the other ticket.



---

archive/issue_comments_095550.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nIs there any reason this shouldn't be closed as a dup now?",
    "created_at": "2010-12-04T01:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95550",
    "user": "https://github.com/robertwb"
}
```

<div id="comment:25" align="right">comment:25</div>

Is there any reason this shouldn't be closed as a dup now?



---

archive/issue_events_134633.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-12-04T01:47:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "milestone_number": null,
    "milestone_title": "sage-4.6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134633"
}
```



---

archive/issue_events_134634.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-12-04T01:47:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134634"
}
```



---

archive/issue_events_134635.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-12-04T01:47:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134635"
}
```



---

archive/issue_events_134636.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-12-04T01:47:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134636"
}
```



---

archive/issue_events_134637.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-12-04T01:47:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134637"
}
```



---

archive/issue_comments_095551.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@robertwb](#comment:25):\n> Is there any reason this shouldn't be closed as a dup now?\n\nWell, it's a symbolic link to #5847, which still needs review, delaying the MPIR upgrade (#8664) further.\n\nWe should close it when #5847 got merged.",
    "created_at": "2010-12-04T02:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95551",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@robertwb](#comment:25):
> Is there any reason this shouldn't be closed as a dup now?

Well, it's a symbolic link to #5847, which still needs review, delaying the MPIR upgrade (#8664) further.

We should close it when #5847 got merged.



---

archive/issue_comments_095552.json:
```json
{
    "body": "Changed keywords from **ecm spkg-install** to **ecm spkg-install SSE2**",
    "created_at": "2011-09-09T04:48:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95552",
    "user": "https://github.com/nexttime"
}
```

Changed keywords from **ecm spkg-install** to **ecm spkg-install SSE2**



---

archive/issue_events_134638.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-09T04:48:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134638"
}
```



---

archive/issue_events_134639.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-09T04:48:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134639"
}
```



---

archive/issue_comments_095553.json:
```json
{
    "body": "Dependencies: **#5847**",
    "created_at": "2011-09-09T04:48:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95553",
    "user": "https://github.com/nexttime"
}
```

Dependencies: **#5847**



---

archive/issue_comments_095554.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,3 +44,7 @@\n \n **New spkg (ecm-6.3.p2) fixing this** (including the upstream patch) **at #5847.**\n \n+---\n+\n+**This ticket can be closed when #5847 got merged.**\n+\n``````\n",
    "created_at": "2011-09-09T04:48:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95554",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,3 +44,7 @@
 
 **New spkg (ecm-6.3.p2) fixing this** (including the upstream patch) **at #5847.**
 
+---
+
+**This ticket can be closed when #5847 got merged.**
+
``````




---

archive/issue_events_134640.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-09T04:48:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134640"
}
```



---

archive/issue_events_134641.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-09T04:48:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134641"
}
```



---

archive/issue_comments_095555.json:
```json
{
    "body": "Reviewer: **Leif Leonhardy**",
    "created_at": "2011-09-09T04:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95555",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **Leif Leonhardy**



---

archive/issue_comments_095556.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nfor your information, this bug is fixed upstream, but we have no new release yet. The fix\nconsists in adding -msse2 when required to compile the corresponding assembly files.\nSee around lines 297-326 of the configure.in file in the svn version upstream.\n\nPaul Zimmermann",
    "created_at": "2011-09-10T07:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95556",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:30" align="right">comment:30</div>

for your information, this bug is fixed upstream, but we have no new release yet. The fix
consists in adding -msse2 when required to compile the corresponding assembly files.
See around lines 297-326 of the configure.in file in the svn version upstream.

Paul Zimmermann



---

archive/issue_comments_095557.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@zimmermann6](#comment:30):\n> for your information, this bug is fixed upstream, but we have no new release yet.\n\nThanks. We already apply that patch (I think; from revision 1546) in the .p2 spkg at #5847.",
    "created_at": "2011-09-10T07:40:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95557",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@zimmermann6](#comment:30):
> for your information, this bug is fixed upstream, but we have no new release yet.

Thanks. We already apply that patch (I think; from revision 1546) in the .p2 spkg at #5847.



---

archive/issue_events_134642.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T19:00:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134642"
}
```



---

archive/issue_events_134643.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T19:00:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134643"
}
```



---

archive/issue_events_134644.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T19:00:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10252#event-134644"
}
```



---

archive/issue_comments_095558.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha3**",
    "created_at": "2011-09-12T19:00:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95558",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.2.alpha3**



---

archive/issue_comments_095559.json:
```json
{
    "body": "Changed merged from **sage-4.7.2.alpha3** to none",
    "created_at": "2011-09-26T08:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95559",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.2.alpha3** to none



---

archive/issue_comments_095560.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nthis problem is fixed in GMP-ECM 6.4, which has just been released.\n\nPaul Zimmermann",
    "created_at": "2012-01-03T23:57:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10252#issuecomment-95560",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:34" align="right">comment:34</div>

this problem is fixed in GMP-ECM 6.4, which has just been released.

Paul Zimmermann
