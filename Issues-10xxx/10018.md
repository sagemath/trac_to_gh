# Issue 10018: Improve PARI's stack allocation

archive/issues_010017.json:
```json
{
    "body": "Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount. And check for overflow in `init_stack()`.\n\nAlso make the default PARI stack size a lot smaller (1MB instead of 16MB).\n\n**Apply** [attachment:10018_pari_init_stack.patch]\n\nAssignee: @jdemeyer\n\nCC:  @nexttime\n\nKeywords: pari init_stack\n\nReviewer: Peter Bruin\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.13.beta4\n\nDependencies: #9640\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/10018\n\n",
    "closed_at": "2013-11-22T15:49:00Z",
    "created_at": "2010-09-26T11:49:57Z",
    "labels": [
        "component: c_lib",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "Improve PARI's stack allocation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10018",
    "user": "https://github.com/jdemeyer"
}
```
Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount. And check for overflow in `init_stack()`.

Also make the default PARI stack size a lot smaller (1MB instead of 16MB).

**Apply** [attachment:10018_pari_init_stack.patch]

Assignee: @jdemeyer

CC:  @nexttime

Keywords: pari init_stack

Reviewer: Peter Bruin

Author: Jeroen Demeyer

Merged: sage-5.13.beta4

Dependencies: #9640

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/10018





---

archive/issue_comments_126828.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n sage: K.<z> = CyclotomicField(23); bnf=K.pari_bnf(certify=False)\n sage: bnf.bnfcertify()\n ```\n-After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 10 seconds or so. It will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because typing\n+After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately). It will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because typing\n \n ```\n K.<z> = CyclotomicField(23)\n``````\n",
    "created_at": "2010-09-26T11:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126828",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 sage: K.<z> = CyclotomicField(23); bnf=K.pari_bnf(certify=False)
 sage: bnf.bnfcertify()
 ```
-After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 10 seconds or so. It will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because typing
+After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately). It will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because typing
 
 ```
 K.<z> = CyclotomicField(23)
``````




---

archive/issue_comments_126829.json:
```json
{
    "body": "Changing keywords from \"segfault segmentation fault bnfcertify\" to \"segfault segmentation fault bnfcertify allocatemem\".",
    "created_at": "2010-09-26T12:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126829",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "segfault segmentation fault bnfcertify" to "segfault segmentation fault bnfcertify allocatemem".



---

archive/issue_comments_126830.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis might be a bug with the handling of `allocatemem()` in PARI.  The same computation in `gp` gives:\n\n```\nbash$ sage -gp --fast --stacksize=10000000\n                                      GP/PARI CALCULATOR Version 2.4.3 (development svn-12577:12605)\n                                       amd64 running linux (x86-64/GMP-4.2.1 kernel) 64-bit version\n                                     compiled: Sep 24 2010, gcc-4.6.0 20100705 (experimental) (GCC)\n                                              (readline v6.0 enabled, extended help enabled)\n\n                                                  Copyright (C) 2000-2008 The PARI Group\n\nPARI/GP is free software, covered by the GNU General Public License, and comes WITHOUT ANY WARRANTY WHATSOEVER.\n\nType ? for help, \\q to quit.\nType ?12 for how to get moral (and possibly technical) support.\n\nparisize = 10000000, primelimit = 500509\n? bnf = bnfinit(polcyclo(23));\n? bnfcertify(bnf)\n  ***   at top-level: bnfcertify(bnf)\n  ***                 ^---------------\n  *** bnfcertify: the PARI stack overflows !\n  current stack size: 10000000 (9.537 Mbytes)\n  [hint] you can increase GP stack with allocatemem()\n\n  ***   Break loop: type 'break' to go back to GP\nbreak>\n```",
    "created_at": "2010-09-26T12:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126830",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
This might be a bug with the handling of `allocatemem()` in PARI.  The same computation in `gp` gives:

```
bash$ sage -gp --fast --stacksize=10000000
                                      GP/PARI CALCULATOR Version 2.4.3 (development svn-12577:12605)
                                       amd64 running linux (x86-64/GMP-4.2.1 kernel) 64-bit version
                                     compiled: Sep 24 2010, gcc-4.6.0 20100705 (experimental) (GCC)
                                              (readline v6.0 enabled, extended help enabled)

                                                  Copyright (C) 2000-2008 The PARI Group

PARI/GP is free software, covered by the GNU General Public License, and comes WITHOUT ANY WARRANTY WHATSOEVER.

Type ? for help, \q to quit.
Type ?12 for how to get moral (and possibly technical) support.

parisize = 10000000, primelimit = 500509
? bnf = bnfinit(polcyclo(23));
? bnfcertify(bnf)
  ***   at top-level: bnfcertify(bnf)
  ***                 ^---------------
  *** bnfcertify: the PARI stack overflows !
  current stack size: 10000000 (9.537 Mbytes)
  [hint] you can increase GP stack with allocatemem()

  ***   Break loop: type 'break' to go back to GP
break>
```



---

archive/issue_comments_126831.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,11 @@\n sage: K.<z> = CyclotomicField(23); bnf=K.pari_bnf(certify=False)\n sage: bnf.bnfcertify()\n ```\n-After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately). It will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because typing\n+After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).\n+\n+If **#9893 is not applied**, then the interrupt will never register (the computation will continue running).\n+\n+If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because doing anything with PARI, such as typing\n \n ```\n K.<z> = CyclotomicField(23)\n``````\n",
    "created_at": "2010-09-26T17:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126831",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,11 @@
 sage: K.<z> = CyclotomicField(23); bnf=K.pari_bnf(certify=False)
 sage: bnf.bnfcertify()
 ```
-After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately). It will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because typing
+After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).
+
+If **#9893 is not applied**, then the interrupt will never register (the computation will continue running).
+
+If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because doing anything with PARI, such as typing
 
 ```
 K.<z> = CyclotomicField(23)
``````




---

archive/issue_comments_126832.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \n If **#9893 is not applied**, then the interrupt will never register (the computation will continue running).\n \n-If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because doing anything with PARI, such as typing\n+If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a `KeyboardInterrupt` will show up.  However, something is wrong after this `KeyboardInterrupt`, because doing anything with PARI, such as typing\n \n ```\n K.<z> = CyclotomicField(23)\n``````\n",
    "created_at": "2010-09-26T18:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126832",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 
 If **#9893 is not applied**, then the interrupt will never register (the computation will continue running).
 
-If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a KeyboardInterrupt will show up.  However, something is wrong after this KeyboardInterrupt, because doing anything with PARI, such as typing
+If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a `KeyboardInterrupt` will show up.  However, something is wrong after this `KeyboardInterrupt`, because doing anything with PARI, such as typing
 
 ```
 K.<z> = CyclotomicField(23)
``````




---

archive/issue_comments_126833.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,3 +26,10 @@\n ------------------------------------------------------------\n ```\n \n+Dependency: #9898 (#9893 has been merged into this patch)\n+\n+Note that in some cases, after applying this patch, it might be necessary to do\n+\n+```\n+sage -ba\n+```\n``````\n",
    "created_at": "2010-09-27T09:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126833",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,3 +26,10 @@
 ------------------------------------------------------------
 ```
 
+Dependency: #9898 (#9893 has been merged into this patch)
+
+Note that in some cases, after applying this patch, it might be necessary to do
+
+```
+sage -ba
+```
``````




---

archive/issue_comments_126834.json:
```json
{
    "body": "Changing keywords from \"segfault segmentation fault bnfcertify allocatemem\" to \"segfault segmentation fault allocatemem interrupt _sig_on _sig_retry\".",
    "created_at": "2010-09-27T09:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126834",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "segfault segmentation fault bnfcertify allocatemem" to "segfault segmentation fault allocatemem interrupt _sig_on _sig_retry".



---

archive/issue_comments_126835.json:
```json
{
    "body": "<a id='comment:7'></a>\nA good place to also add some more case distinctions on PARI's `errnum`... ;-)",
    "created_at": "2010-09-27T09:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126835",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
A good place to also add some more case distinctions on PARI's `errnum`... ;-)



---

archive/issue_comments_126836.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [leif](#comment%3A7):\n> A good place to also add some more case distinctions on PARI's `errnum`... ;-)\n\n\nThis is planned for #9640 (in the not-so-near future though).",
    "created_at": "2010-09-27T10:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126836",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [leif](#comment%3A7):
> A good place to also add some more case distinctions on PARI's `errnum`... ;-)


This is planned for #9640 (in the not-so-near future though).



---

archive/issue_comments_126837.json:
```json
{
    "body": "Changing assignee from tba to @jdemeyer.",
    "created_at": "2010-09-27T11:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126837",
    "user": "https://github.com/jdemeyer"
}
```

Changing assignee from tba to @jdemeyer.



---

archive/issue_comments_126838.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,8 +28,10 @@\n \n Dependency: #9898 (#9893 has been merged into this patch)\n \n-Note that in some cases, after applying this patch, it might be necessary to do\n+In some cases, after applying this patch or changing it, it might be necessary to do\n \n ```\n sage -ba\n ```\n+\n+**NOTE:** this patch changes the behaviour of buggy Cython code: code which was previously not interruptible now gives a segmentation fault.  See for example #9564.\n``````\n",
    "created_at": "2010-09-27T11:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126838",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,8 +28,10 @@
 
 Dependency: #9898 (#9893 has been merged into this patch)
 
-Note that in some cases, after applying this patch, it might be necessary to do
+In some cases, after applying this patch or changing it, it might be necessary to do
 
 ```
 sage -ba
 ```
+
+**NOTE:** this patch changes the behaviour of buggy Cython code: code which was previously not interruptible now gives a segmentation fault.  See for example #9564.
``````




---

archive/issue_comments_126839.json:
```json
{
    "body": "Apply on top of #9898",
    "created_at": "2010-09-27T11:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126839",
    "user": "https://github.com/jdemeyer"
}
```

Apply on top of #9898



---

archive/issue_comments_126840.json:
```json
{
    "body": "<a id='comment:10'></a>\nAttachment [10018_sig_retry.patch](tarball://root/attachments/some-uuid/ticket10018/10018_sig_retry.patch) by @nexttime created at 2010-09-27 12:00:53\n\nReplying to [jdemeyer](#comment%3A8):\n> Replying to [leif](#comment%3A7):\n> > A good place to also add some more case distinctions on PARI's `errnum`... ;-)\n\n> \n> This is planned for #9640 (in the not-so-near future though).\n\n\nOk. I thought of just adding number 5 (`talker`?) here, mapping it to `ValueError`, which comes nearest (could also be `TypeError` (domain) or `RangeError` etc.).",
    "created_at": "2010-09-27T12:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126840",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>
Attachment [10018_sig_retry.patch](tarball://root/attachments/some-uuid/ticket10018/10018_sig_retry.patch) by @nexttime created at 2010-09-27 12:00:53

Replying to [jdemeyer](#comment%3A8):
> Replying to [leif](#comment%3A7):
> > A good place to also add some more case distinctions on PARI's `errnum`... ;-)

> 
> This is planned for #9640 (in the not-so-near future though).


Ok. I thought of just adding number 5 (`talker`?) here, mapping it to `ValueError`, which comes nearest (could also be `TypeError` (domain) or `RangeError` etc.).



---

archive/issue_comments_126841.json:
```json
{
    "body": "<a id='comment:11'></a>\n... because of #9640 *\"not-so-near future\"*.",
    "created_at": "2010-09-27T12:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126841",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
... because of #9640 *"not-so-near future"*.



---

archive/issue_comments_126842.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [leif](#comment%3A10):\n> Ok. I thought of just adding number 5 (`talker`?) here, mapping it to `ValueError`, which comes nearest (could also be `TypeError` (domain) or `RangeError` etc.). \n\n\nI think it is good that now all errors thrown by PARI are of the type `PariError`.  If you want to raise a different exception, I think it should be done by higher-level code, like:\n\n```\ntry:\n    # do something with PARI\nexcept PariError, err:\n    if err.errnum() == talker:\n        raise ValueError\n    raise err\n```\n\n(this currently only works with Cython because `talker` is defined in a PARI C header).",
    "created_at": "2010-09-27T12:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126842",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Replying to [leif](#comment%3A10):
> Ok. I thought of just adding number 5 (`talker`?) here, mapping it to `ValueError`, which comes nearest (could also be `TypeError` (domain) or `RangeError` etc.). 


I think it is good that now all errors thrown by PARI are of the type `PariError`.  If you want to raise a different exception, I think it should be done by higher-level code, like:

```
try:
    # do something with PARI
except PariError, err:
    if err.errnum() == talker:
        raise ValueError
    raise err
```

(this currently only works with Cython because `talker` is defined in a PARI C header).



---

archive/issue_comments_126843.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jdemeyer](#comment%3A12):\n> (this currently only works with Cython because `talker` is defined in a PARI C header).\n\n\n... and would require changing much more code. ;-)\n\nThe actual error message should be `vsnprintf()`'ed into a buffer (upstream) such that we can also propagate the real cause.",
    "created_at": "2010-09-27T13:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126843",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
Replying to [jdemeyer](#comment%3A12):
> (this currently only works with Cython because `talker` is defined in a PARI C header).


... and would require changing much more code. ;-)

The actual error message should be `vsnprintf()`'ed into a buffer (upstream) such that we can also propagate the real cause.



---

archive/issue_comments_126844.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [leif](#comment%3A13):\n> The actual error message should be `vsnprintf()`'ed into a buffer (upstream) such that we can also propagate the real cause.\n\n\nThat is more or less the idea of #9640.\n\nBut I also noticed that the whole exception-catching mechanism can be vastly improved (for example, now there is a general signal-handling facility in Sage and a specific error-handling facility for PARI which should be merged into one system).  Also, there is essentially no testing code for this Cython error handling.  Good testing code should have caught #10018.  All this should eventually be in #9678.",
    "created_at": "2010-09-27T13:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126844",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [leif](#comment%3A13):
> The actual error message should be `vsnprintf()`'ed into a buffer (upstream) such that we can also propagate the real cause.


That is more or less the idea of #9640.

But I also noticed that the whole exception-catching mechanism can be vastly improved (for example, now there is a general signal-handling facility in Sage and a specific error-handling facility for PARI which should be merged into one system).  Also, there is essentially no testing code for this Cython error handling.  Good testing code should have caught #10018.  All this should eventually be in #9678.



---

archive/issue_comments_126845.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [leif](#comment%3A13):\n> The actual error message should be `vsnprintf()`'ed into a buffer (upstream) such that we can also propagate the real cause.\n\n\nI added the following in `src/language/init.c` to debug PARI:\n\n```C\nvoid\npari_err(int numerr, ...)\n{\n  PariOUT *out = pariOut;\n  va_list ap;\n\n  va_start(ap,numerr);\n\n  if (numerr==talker) /* added part */\n  {\n    va_list ap2;\n    const char *fmt;\n\n    va_copy(ap2,ap);\n    fmt=(char*)va_arg(ap2,char*);\n\n    vfprintf(stderr,fmt,ap2); /* we can equally well write into a global buffer here */\n    fflush(stderr);           /* with vsnprintf() to propagate the error message */\n  }\n\n  ...\n```",
    "created_at": "2010-09-27T13:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126845",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>
Replying to [leif](#comment%3A13):
> The actual error message should be `vsnprintf()`'ed into a buffer (upstream) such that we can also propagate the real cause.


I added the following in `src/language/init.c` to debug PARI:

```C
void
pari_err(int numerr, ...)
{
  PariOUT *out = pariOut;
  va_list ap;

  va_start(ap,numerr);

  if (numerr==talker) /* added part */
  {
    va_list ap2;
    const char *fmt;

    va_copy(ap2,ap);
    fmt=(char*)va_arg(ap2,char*);

    vfprintf(stderr,fmt,ap2); /* we can equally well write into a global buffer here */
    fflush(stderr);           /* with vsnprintf() to propagate the error message */
  }

  ...
```



---

archive/issue_comments_126846.json:
```json
{
    "body": "<a id='comment:16'></a>\nI actually added some more `printf()`s:\n\n```C\n    ...\n    fprintf(stderr,\n      \"\\n******************** PARI ERROR: ********************\\n\");\n    vfprintf(stderr,fmt,ap2);\n    fprintf(stderr,\n      \"\\n*****************************************************\\n\");\n    fflush(stderr);\n    ...\n```\n\nOf course a temporary hack (and a bit odd in the interpreter), but an improvement to just\n\n```\n      File \"gen.pyx\", line 9460, in sage.libs.pari.gen._pari_trap (sage/libs/pari/gen.c:45047)\n    PariError:  (5)\n```\nand trivial enough s.t. it could be merged without any risk. ;-)\n\n(PARI's messages of course aren't always that informative without examining the stack.)",
    "created_at": "2010-09-27T14:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126846",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
I actually added some more `printf()`s:

```C
    ...
    fprintf(stderr,
      "\n******************** PARI ERROR: ********************\n");
    vfprintf(stderr,fmt,ap2);
    fprintf(stderr,
      "\n*****************************************************\n");
    fflush(stderr);
    ...
```

Of course a temporary hack (and a bit odd in the interpreter), but an improvement to just

```
      File "gen.pyx", line 9460, in sage.libs.pari.gen._pari_trap (sage/libs/pari/gen.c:45047)
    PariError:  (5)
```
and trivial enough s.t. it could be merged without any risk. ;-)

(PARI's messages of course aren't always that informative without examining the stack.)



---

archive/issue_comments_126847.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-09-27T21:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126847",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_126848.json:
```json
{
    "body": "<a id='comment:17'></a>\nWith `10018_sig_retry.patch`, all long doctests pass on a 32-bit PPC OS X 10.4, now testing on `sage.math.washington.edu` (64-bit Intel Linux).\n\nI also tried very hard to break things in PARI using many different combinations of pari.allocatemem(), other PARI functions and CTRL-C and I did not manage :-)",
    "created_at": "2010-09-27T21:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126848",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
With `10018_sig_retry.patch`, all long doctests pass on a 32-bit PPC OS X 10.4, now testing on `sage.math.washington.edu` (64-bit Intel Linux).

I also tried very hard to break things in PARI using many different combinations of pari.allocatemem(), other PARI functions and CTRL-C and I did not manage :-)



---

archive/issue_comments_126849.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,33 +5,14 @@\n sage: bnf.bnfcertify()\n ```\n After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).\n-\n-If **#9893 is not applied**, then the interrupt will never register (the computation will continue running).\n-\n-If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a `KeyboardInterrupt` will show up.  However, something is wrong after this `KeyboardInterrupt`, because doing anything with PARI, such as typing\n-\n-```\n-K.<z> = CyclotomicField(23)\n-```\n-immediately gives the dreaded\n-\n-```\n-------------------------------------------------------------\n-Unhandled SIGSEGV: A segmentation fault occurred in Sage.\n-This probably occurred because a *compiled* component\n-of Sage has a bug in it (typically accessing invalid memory)\n-or is not properly wrapped with _sig_on, _sig_off.\n-You might want to run Sage under gdb with 'sage -gdb' to debug this.\n-Sage will now terminate (sorry).\n-------------------------------------------------------------\n-```\n+The interrupt will never register (the computation will continue running).\n \n Dependency: #9898 (#9893 has been merged into this patch)\n \n In some cases, after applying this patch or changing it, it might be necessary to do\n \n ```\n-sage -ba\n+sage -ba-force\n ```\n \n-**NOTE:** this patch changes the behaviour of buggy Cython code: code which was previously not interruptible now gives a segmentation fault.  See for example #9564.\n+**NOTE:** this patch changes the behaviour of buggy Cython code: some code which was previously not interruptible now gives a segmentation fault when interrupted.  See for example #9564.\n``````\n",
    "created_at": "2010-09-28T13:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126849",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,33 +5,14 @@
 sage: bnf.bnfcertify()
 ```
 After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).
-
-If **#9893 is not applied**, then the interrupt will never register (the computation will continue running).
-
-If **#9893 is applied**, it will take a long time before the interrupt registers, but eventually a `KeyboardInterrupt` will show up.  However, something is wrong after this `KeyboardInterrupt`, because doing anything with PARI, such as typing
-
-```
-K.<z> = CyclotomicField(23)
-```
-immediately gives the dreaded
-
-```
-------------------------------------------------------------
-Unhandled SIGSEGV: A segmentation fault occurred in Sage.
-This probably occurred because a *compiled* component
-of Sage has a bug in it (typically accessing invalid memory)
-or is not properly wrapped with _sig_on, _sig_off.
-You might want to run Sage under gdb with 'sage -gdb' to debug this.
-Sage will now terminate (sorry).
-------------------------------------------------------------
-```
+The interrupt will never register (the computation will continue running).
 
 Dependency: #9898 (#9893 has been merged into this patch)
 
 In some cases, after applying this patch or changing it, it might be necessary to do
 
 ```
-sage -ba
+sage -ba-force
 ```
 
-**NOTE:** this patch changes the behaviour of buggy Cython code: code which was previously not interruptible now gives a segmentation fault.  See for example #9564.
+**NOTE:** this patch changes the behaviour of buggy Cython code: some code which was previously not interruptible now gives a segmentation fault when interrupted.  See for example #9564.
``````




---

archive/issue_comments_126850.json:
```json
{
    "body": "Changing keywords from \"segfault segmentation fault allocatemem interrupt _sig_on _sig_retry\" to \"pari segfault segmentation fault allocatemem interrupt _sig_on _sig_retry\".",
    "created_at": "2010-09-28T13:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126850",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "segfault segmentation fault allocatemem interrupt _sig_on _sig_retry" to "pari segfault segmentation fault allocatemem interrupt _sig_on _sig_retry".



---

archive/issue_comments_126851.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-10-13T13:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126851",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_126852.json:
```json
{
    "body": "<a id='comment:19'></a>\nProbably this will be absorbed by #9678.",
    "created_at": "2010-10-13T13:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126852",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Probably this will be absorbed by #9678.



---

archive/issue_comments_126853.json:
```json
{
    "body": "Changing keywords from \"pari segfault segmentation fault allocatemem interrupt _sig_on _sig_retry\" to \"pari segfault segmentation fault allocatemem interrupt sig_on sig_retry\".",
    "created_at": "2010-10-17T18:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126853",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "pari segfault segmentation fault allocatemem interrupt _sig_on _sig_retry" to "pari segfault segmentation fault allocatemem interrupt sig_on sig_retry".



---

archive/issue_comments_126854.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,12 +7,4 @@\n After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).\n The interrupt will never register (the computation will continue running).\n \n-Dependency: #9898 (#9893 has been merged into this patch)\n-\n-In some cases, after applying this patch or changing it, it might be necessary to do\n-\n-```\n-sage -ba-force\n-```\n-\n-**NOTE:** this patch changes the behaviour of buggy Cython code: some code which was previously not interruptible now gives a segmentation fault when interrupted.  See for example #9564.\n+Dependencies: #10115, #9893, #9678\n``````\n",
    "created_at": "2010-10-17T18:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126854",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,12 +7,4 @@
 After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).
 The interrupt will never register (the computation will continue running).
 
-Dependency: #9898 (#9893 has been merged into this patch)
-
-In some cases, after applying this patch or changing it, it might be necessary to do
-
-```
-sage -ba-force
-```
-
-**NOTE:** this patch changes the behaviour of buggy Cython code: some code which was previously not interruptible now gives a segmentation fault when interrupted.  See for example #9564.
+Dependencies: #10115, #9893, #9678
``````




---

archive/issue_comments_126855.json:
```json
{
    "body": "Attachment [10018_pari_sig_retry.patch](tarball://root/attachments/some-uuid/ticket10018/10018_pari_sig_retry.patch) by @jdemeyer created at 2011-04-13 12:19:13\n\nNew patch, ignore previous",
    "created_at": "2011-04-13T12:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126855",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [10018_pari_sig_retry.patch](tarball://root/attachments/some-uuid/ticket10018/10018_pari_sig_retry.patch) by @jdemeyer created at 2011-04-13 12:19:13

New patch, ignore previous



---

archive/issue_comments_126856.json:
```json
{
    "body": "<a id='comment:21'></a>\nI cannot reproduce this bug.  Has it been fixed in another ticket?",
    "created_at": "2011-11-12T17:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126856",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:21'></a>
I cannot reproduce this bug.  Has it been fixed in another ticket?



---

archive/issue_events_030689.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:34:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10018#event-30689"
}
```



---

archive/issue_comments_126857.json:
```json
{
    "body": "<a id='comment:23'></a>\nI tried and I also can't reproduce it. The comments mention #9678 which may have fixed it. I suggest figuring out how this bug was fixed before closing it.",
    "created_at": "2013-09-08T13:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126857",
    "user": "https://github.com/itaibn"
}
```

<a id='comment:23'></a>
I tried and I also can't reproduce it. The comments mention #9678 which may have fixed it. I suggest figuring out how this bug was fixed before closing it.



---

archive/issue_comments_126858.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2013-09-09T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126858",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_126859.json:
```json
{
    "body": "<a id='comment:24'></a>\nI can't reproduce it either.  I don't really see the point of trying to find out why this bug existed, since #9678 essentially rewrote the whole error-handling code.\n\nWhat is the status of [attachment:10018_pari_sig_retry.patch]?  Assuming that this bug has indeed disappeared, is the patch still relevant for the general plan to improve the PARI error handling mechanism (cf. #9640, #14894)?",
    "created_at": "2013-09-09T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126859",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:24'></a>
I can't reproduce it either.  I don't really see the point of trying to find out why this bug existed, since #9678 essentially rewrote the whole error-handling code.

What is the status of [attachment:10018_pari_sig_retry.patch]?  Assuming that this bug has indeed disappeared, is the patch still relevant for the general plan to improve the PARI error handling mechanism (cf. #9640, #14894)?



---

archive/issue_comments_126860.json:
```json
{
    "body": "<a id='comment:25'></a>\n#9678 changed a lot of the error-handling code, but it doesn't seem to make any changes to Pari. That's why I'm cautious. That said, I notice that both of these patches are by jdemeyer. He probably understands how these changes interact and if he abandoned this it's probably safe to close this.\n\nAlso, attachment:10018_pari_sig_retry.patch looks like it's many changing the memory management in Pari, while the tickets you mention look like they're about the interaction between error management in sage and in pari. They seem unrelated.",
    "created_at": "2013-09-11T22:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126860",
    "user": "https://github.com/itaibn"
}
```

<a id='comment:25'></a>
#9678 changed a lot of the error-handling code, but it doesn't seem to make any changes to Pari. That's why I'm cautious. That said, I notice that both of these patches are by jdemeyer. He probably understands how these changes interact and if he abandoned this it's probably safe to close this.

Also, attachment:10018_pari_sig_retry.patch looks like it's many changing the memory management in Pari, while the tickets you mention look like they're about the interaction between error management in sage and in pari. They seem unrelated.



---

archive/issue_comments_126861.json:
```json
{
    "body": "<a id='comment:26'></a>\nI don't have much time to think of this now, but [attachment:10018_pari_sig_retry.patch\u200b] is indeed changing the PARI error handling mechanism. Let's first look at #9640 and then at this patch.",
    "created_at": "2013-09-12T00:20:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126861",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
I don't have much time to think of this now, but [attachment:10018_pari_sig_retry.patch​] is indeed changing the PARI error handling mechanism. Let's first look at #9640 and then at this patch.



---

archive/issue_comments_126862.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1 @@\n-Do the following in Sage:\n \n-```\n-sage: K.<z> = CyclotomicField(23); bnf=K.pari_bnf(certify=False)\n-sage: bnf.bnfcertify()\n-```\n-After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).\n-The interrupt will never register (the computation will continue running).\n-\n-Dependencies: #10115, #9893, #9678\n``````\n",
    "created_at": "2013-11-01T22:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126862",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1 @@
-Do the following in Sage:
 
-```
-sage: K.<z> = CyclotomicField(23); bnf=K.pari_bnf(certify=False)
-sage: bnf.bnfcertify()
-```
-After typing the second line `bnf.bnfcertify()`, hit CTRL-c after 5 seconds or so (not immediately).
-The interrupt will never register (the computation will continue running).
-
-Dependencies: #10115, #9893, #9678
``````




---

archive/issue_events_030690.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "rename": {
        "from": "Unhandled SIGSEGV after bnfcertify()",
        "to": "Improve PARI's stack allocation"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10018#event-30690"
}
```



---

archive/issue_comments_126863.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2013-11-01T22:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126863",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_126864.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#9640\"",
    "created_at": "2013-11-01T22:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126864",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#9640"



---

archive/issue_comments_126865.json:
```json
{
    "body": "Changing keywords from \"pari segfault segmentation fault allocatemem interrupt sig_on sig_retry\" to \"pari init_stack\".",
    "created_at": "2013-11-01T22:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126865",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "pari segfault segmentation fault allocatemem interrupt sig_on sig_retry" to "pari init_stack".



---

archive/issue_comments_126866.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+**Apply** [attachment:10018_pari_init_stack.patch]\n``````\n",
    "created_at": "2013-11-02T11:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126866",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+**Apply** [attachment:10018_pari_init_stack.patch]
``````




---

archive/issue_comments_126867.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2013-11-02T11:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126867",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_126868.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n+Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount.\n+\n+Also make the default PARI stack size a lot smaller (1MB instead of 16MB).\n+\n **Apply** [attachment:10018_pari_init_stack.patch]\n``````\n",
    "created_at": "2013-11-02T11:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126868",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
+Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount.
+
+Also make the default PARI stack size a lot smaller (1MB instead of 16MB).
+
 **Apply** [attachment:10018_pari_init_stack.patch]
``````




---

archive/issue_comments_126869.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-11-02T11:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126869",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126870.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount.\n+Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount. And check for overflow in `init_stack()`.\n \n Also make the default PARI stack size a lot smaller (1MB instead of 16MB).\n \n``````\n",
    "created_at": "2013-11-02T11:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126870",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount.
+Make the PARI stack allocation more robust. In particular, if doubling fails, try to increase the stack by a smaller amount. And check for overflow in `init_stack()`.
 
 Also make the default PARI stack size a lot smaller (1MB instead of 16MB).
 
``````




---

archive/issue_comments_126871.json:
```json
{
    "body": "Attachment [10018_pari_init_stack.patch](tarball://root/attachments/some-uuid/ticket10018/10018_pari_init_stack.patch) by @jdemeyer created at 2013-11-03 07:53:51",
    "created_at": "2013-11-03T07:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126871",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [10018_pari_init_stack.patch](tarball://root/attachments/some-uuid/ticket10018/10018_pari_init_stack.patch) by @jdemeyer created at 2013-11-03 07:53:51



---

archive/issue_comments_126872.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-11-04T12:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126872",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126873.json:
```json
{
    "body": "<a id='comment:31'></a>\nThis looks good, it passes doctests, and I agree with the deprecation of `init_pari_stack()`.",
    "created_at": "2013-11-04T12:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126873",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:31'></a>
This looks good, it passes doctests, and I agree with the deprecation of `init_pari_stack()`.



---

archive/issue_comments_126874.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Peter Bruin\"",
    "created_at": "2013-11-04T12:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126874",
    "user": "https://github.com/pjbruin"
}
```

Changing reviewer from "" to "Peter Bruin"



---

archive/issue_comments_126875.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.13.beta4\"",
    "created_at": "2013-11-22T15:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126875",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.13.beta4"



---

archive/issue_comments_126876.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-11-22T15:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10018#issuecomment-126876",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_030691.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-11-22T15:49:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10018",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10018#event-30691"
}
```
