# Issue 10887: Upgrade scipy to 0.9

archive/issues_010816.json:
```json
{
    "assignees": [],
    "body": "Scipy 0.9 was released a few days ago.  We should upgrade.  There was at least one person that was having problems with the scipy in Sage, and the fix is in 0.9.\n\nThis should preferably be merged along with numpy-1.5.1 (#10792).\n\nSupport for SAGE_SPKG_INSTALL_DOCS will be added later in a different ticket.\n\nNew spkg: [http://spkg-upload.googlecode.com/files/scipy-0.9.spkg](http://spkg-upload.googlecode.com/files/scipy-0.9.spkg)\n\nApply:\n* [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)\n\nCC:  @kcrisman @rbeezer @kiwifb\n\nAuthor: **Fran\u00e7ois Bissey**\n\nReviewer: **Rob Beezer**\n\nMerged: **sage-4.7.alpha2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/10887_\n\n",
    "closed_at": "2011-03-18T13:41:27Z",
    "created_at": "2011-03-07T21:22:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade scipy to 0.9",
    "type": "issue",
    "updated_at": "2011-03-18T13:41:27Z",
    "url": "https://github.com/sagemath/sage/issues/10887",
    "user": "https://github.com/jasongrout"
}
```
Scipy 0.9 was released a few days ago.  We should upgrade.  There was at least one person that was having problems with the scipy in Sage, and the fix is in 0.9.

This should preferably be merged along with numpy-1.5.1 (#10792).

Support for SAGE_SPKG_INSTALL_DOCS will be added later in a different ticket.

New spkg: [http://spkg-upload.googlecode.com/files/scipy-0.9.spkg](http://spkg-upload.googlecode.com/files/scipy-0.9.spkg)

Apply:
* [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)

CC:  @kcrisman @rbeezer @kiwifb

Author: **Fran√ßois Bissey**

Reviewer: **Rob Beezer**

Merged: **sage-4.7.alpha2**

_Issue created by migration from https://trac.sagemath.org/ticket/10887_





---

archive/issue_events_131688.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-03-07T21:22:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "milestone_number": null,
    "milestone_title": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131688"
}
```



---

archive/issue_events_131689.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-03-07T21:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131689"
}
```



---

archive/issue_events_131690.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-03-07T21:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131690"
}
```



---

archive/issue_comments_107553.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nI will check if it breaks things shortly in sage-on-gentoo. I can make a spkg later, would be nice to have it alongside numpy-1.5.1 (although the later may suffer some delay).",
    "created_at": "2011-03-07T22:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107553",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'>Comment 2:</a>
I will check if it breaks things shortly in sage-on-gentoo. I can make a spkg later, would be nice to have it alongside numpy-1.5.1 (although the later may suffer some delay).



---

archive/issue_comments_107554.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nI am still going through the test suite but I should give a few pieces of info I collected so far. It takes a `_lot_` longer to compile. Not sure what landed but it must have been big. The jump is from 23mn to 1h05mn on this slow box.\nSo far there has been two tests failures related to the upgrade, one in matrix_double_dense.py, a warning about complex conversion to real like in numpy-1.5.1. Possibly something has been switched to numpy internally but it will have to be digged out.\nThe other is in sage/numerical/test.py some business with arpack which may turn out to be gentoo specific as we carry some arpack patches. While the test has not finished it seems like the amount of work needed will be minimal.\nI am planning to make a spkg in the next few days unless someone beats me to it and run another set of tests to check the arpack stuff.",
    "created_at": "2011-03-09T01:07:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107554",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'>Comment 3:</a>
I am still going through the test suite but I should give a few pieces of info I collected so far. It takes a `_lot_` longer to compile. Not sure what landed but it must have been big. The jump is from 23mn to 1h05mn on this slow box.
So far there has been two tests failures related to the upgrade, one in matrix_double_dense.py, a warning about complex conversion to real like in numpy-1.5.1. Possibly something has been switched to numpy internally but it will have to be digged out.
The other is in sage/numerical/test.py some business with arpack which may turn out to be gentoo specific as we carry some arpack patches. While the test has not finished it seems like the amount of work needed will be minimal.
I am planning to make a spkg in the next few days unless someone beats me to it and run another set of tests to check the arpack stuff.



---

archive/issue_comments_107555.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nAfter looking more carefully\n\n```\nsage -t -force_lib \"devel/sage/sage/matrix/matrix_double_dense.pyx\"\n**********************************************************************\nFile \"/usr/share/sage/devel/sage/sage/matrix/matrix_double_dense.pyx\", line 1527:\n    sage: A.exp(algorithm='eig')\nExpected:\n    doctest:94: ComplexWarning: Casting complex values to real discards the imaginary part\n    [51.9689561987  74.736564567]\n    [112.104846851 164.073803049]\nGot:\n    [51.9689561987  74.736564567]\n    [112.104846851 164.073803049]\n```\nThe warning actually disappeared - easy!",
    "created_at": "2011-03-09T07:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107555",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'>Comment 4:</a>
After looking more carefully

```
sage -t -force_lib "devel/sage/sage/matrix/matrix_double_dense.pyx"
**********************************************************************
File "/usr/share/sage/devel/sage/sage/matrix/matrix_double_dense.pyx", line 1527:
    sage: A.exp(algorithm='eig')
Expected:
    doctest:94: ComplexWarning: Casting complex values to real discards the imaginary part
    [51.9689561987  74.736564567]
    [112.104846851 164.073803049]
Got:
    [51.9689561987  74.736564567]
    [112.104846851 164.073803049]
```
The warning actually disappeared - easy!



---

archive/issue_comments_107556.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\n\n```\nsage -t  -long -force_lib \"devel/sage/sage/numerical/test.py\"\nsage -t -long -force_lib \"devel/sage/sage/numerical/test.py\"\n**********************************************************************\nFile \"/usr/share/sage/devel/sage/sage/numerical/test.py\", line 12:\n    sage: from scipy.sparse.linalg.eigen.arpack import speigs\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[10]>\", line 1, in <module>\n        from scipy.sparse.linalg.eigen.arpack import speigs###line 12:\n    sage: from scipy.sparse.linalg.eigen.arpack import speigs\n    ImportError: cannot import name speigs\n**********************************************************************\nFile \"/usr/share/sage/devel/sage/sage/numerical/test.py\", line 27:\n    sage: e,v=speigs.ARPACK_eigs(A.matvec,500,6,which='SM')\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[19]>\", line 1, in <module>\n        e,v=speigs.ARPACK_eigs(A.matvec,Integer(500),Integer(6),which='SM')###line 27:\n    sage: e,v=speigs.ARPACK_eigs(A.matvec,500,6,which='SM')\n    NameError: name 'speigs' is not defined\n**********************************************************************\nFile \"/usr/share/sage/devel/sage/sage/numerical/test.py\", line 28:\n    sage: e[0]*float(501/pi)**2\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[20]>\", line 1, in <module>\n        e[Integer(0)]*float(Integer(501)/pi)**Integer(2)###line 28:\n    sage: e[0]*float(501/pi)**2\n    TypeError: 'sage.symbolic.constants_c.E' object does not support indexing\n**********************************************************************\n```\nFrom scipy-0.9 release notes [http://docs.scipy.org/doc/scipy-0.9.0/reference/release.0.9.0.html](http://docs.scipy.org/doc/scipy-0.9.0/reference/release.0.9.0.html) this is probably a real problem as the arpack interface changed.",
    "created_at": "2011-03-10T03:51:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107556",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'>Comment 5:</a>

```
sage -t  -long -force_lib "devel/sage/sage/numerical/test.py"
sage -t -long -force_lib "devel/sage/sage/numerical/test.py"
**********************************************************************
File "/usr/share/sage/devel/sage/sage/numerical/test.py", line 12:
    sage: from scipy.sparse.linalg.eigen.arpack import speigs
Exception raised:
    Traceback (most recent call last):
      File "/usr/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[10]>", line 1, in <module>
        from scipy.sparse.linalg.eigen.arpack import speigs###line 12:
    sage: from scipy.sparse.linalg.eigen.arpack import speigs
    ImportError: cannot import name speigs
**********************************************************************
File "/usr/share/sage/devel/sage/sage/numerical/test.py", line 27:
    sage: e,v=speigs.ARPACK_eigs(A.matvec,500,6,which='SM')
Exception raised:
    Traceback (most recent call last):
      File "/usr/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[19]>", line 1, in <module>
        e,v=speigs.ARPACK_eigs(A.matvec,Integer(500),Integer(6),which='SM')###line 27:
    sage: e,v=speigs.ARPACK_eigs(A.matvec,500,6,which='SM')
    NameError: name 'speigs' is not defined
**********************************************************************
File "/usr/share/sage/devel/sage/sage/numerical/test.py", line 28:
    sage: e[0]*float(501/pi)**2
Exception raised:
    Traceback (most recent call last):
      File "/usr/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[20]>", line 1, in <module>
        e[Integer(0)]*float(Integer(501)/pi)**Integer(2)###line 28:
    sage: e[0]*float(501/pi)**2
    TypeError: 'sage.symbolic.constants_c.E' object does not support indexing
**********************************************************************
```
From scipy-0.9 release notes [http://docs.scipy.org/doc/scipy-0.9.0/reference/release.0.9.0.html](http://docs.scipy.org/doc/scipy-0.9.0/reference/release.0.9.0.html) this is probably a real problem as the arpack interface changed.



---

archive/issue_comments_107557.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nInterestingly, it now includes Qhull for triangulations.  This is an optional Sage package, but maybe after this upgrade we wouldn't need it as that any more?  (Of course, version rot could be a problem.)",
    "created_at": "2011-03-10T15:08:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107557",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'>Comment 6:</a>
Interestingly, it now includes Qhull for triangulations.  This is an optional Sage package, but maybe after this upgrade we wouldn't need it as that any more?  (Of course, version rot could be a problem.)



---

archive/issue_comments_107558.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@kcrisman](#comment%3A6):\n> Interestingly, it now includes Qhull for triangulations.  This is an optional Sage package, but maybe after this upgrade we wouldn't need it as that any more?  (Of course, version rot could be a problem.)\n\nI have looked a little bit more in depth at that. I noticed that in Gentoo scipy-0.9.0 now pulls qhull as a dependency. If there a version of libqhull.{so,a} on the system it will be used rather than the internally built static library. Said static library is not installed by scipy just rolled up in their created module.\n\nIn summary this version of scipy includes libqhull functionality (as far as scipy uses it at least) but doesn't provide the qhull library or any of the executables built by qhull normally.\n\nDepending on what you want to do I think that means you don't want to remove qhull from the optional spkg unless you want to force access to its functionality through the scipy interface.\n\nFor info it also bundles superLU from experimental in the same way.",
    "created_at": "2011-03-15T02:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107558",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@kcrisman](#comment%3A6):
> Interestingly, it now includes Qhull for triangulations.  This is an optional Sage package, but maybe after this upgrade we wouldn't need it as that any more?  (Of course, version rot could be a problem.)

I have looked a little bit more in depth at that. I noticed that in Gentoo scipy-0.9.0 now pulls qhull as a dependency. If there a version of libqhull.{so,a} on the system it will be used rather than the internally built static library. Said static library is not installed by scipy just rolled up in their created module.

In summary this version of scipy includes libqhull functionality (as far as scipy uses it at least) but doesn't provide the qhull library or any of the executables built by qhull normally.

Depending on what you want to do I think that means you don't want to remove qhull from the optional spkg unless you want to force access to its functionality through the scipy interface.

For info it also bundles superLU from experimental in the same way.



---

archive/issue_comments_107559.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nOK so my big doctest failure will turn out to be Gentoo specific because we don't have scipy_sandbox and relied on arpack functionality included in scipy. Arpack is also bundled in scipy so presumably we could switch to using \n\n```\nfrom scipy.sparse.linalg.eigen.arpack import arpack\n```\ninstead of \n\n```\nfrom arpack import speigs\n```\nthere are a few other things to clean afterwards but nothing serious. \nThe functionality has been shipped in scipy for a while. The other part of scipy_sandbox (delaunay) can be provided by matplotlib so we could drop scipy_sandbox altogether but that would be another ticket.\n\nI think this ticket should be merged at the same time or after numpy-1.5.1 (#10792) otherwise scipy will need artificial bumping when numpy is merged.\n\nI should get on with that spkg, I had forgotten that I didn't make one.",
    "created_at": "2011-03-15T03:19:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107559",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'>Comment 8:</a>
OK so my big doctest failure will turn out to be Gentoo specific because we don't have scipy_sandbox and relied on arpack functionality included in scipy. Arpack is also bundled in scipy so presumably we could switch to using 

```
from scipy.sparse.linalg.eigen.arpack import arpack
```
instead of 

```
from arpack import speigs
```
there are a few other things to clean afterwards but nothing serious. 
The functionality has been shipped in scipy for a while. The other part of scipy_sandbox (delaunay) can be provided by matplotlib so we could drop scipy_sandbox altogether but that would be another ticket.

I think this ticket should be merged at the same time or after numpy-1.5.1 (#10792) otherwise scipy will need artificial bumping when numpy is merged.

I should get on with that spkg, I had forgotten that I didn't make one.



---

archive/issue_comments_107560.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nHere is the spkg [http://spkg-upload.googlecode.com/files/scipy-0.9.spkg](http://spkg-upload.googlecode.com/files/scipy-0.9.spkg) I actually have no idea on how to build the doc. Which is why I didn't add support for SAGE_SPKG_INSTALL_DOCS. \n\nAfter testing I can confirm the issue with matrix_double_dense.pyx. numerical/test.py pass without problems as expected. So what needs to be done:\n* add support for installing the docs\n* patch matrix_double_dense.pyx",
    "created_at": "2011-03-16T03:22:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107560",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'>Comment 9:</a>
Here is the spkg [http://spkg-upload.googlecode.com/files/scipy-0.9.spkg](http://spkg-upload.googlecode.com/files/scipy-0.9.spkg) I actually have no idea on how to build the doc. Which is why I didn't add support for SAGE_SPKG_INSTALL_DOCS. 

After testing I can confirm the issue with matrix_double_dense.pyx. numerical/test.py pass without problems as expected. So what needs to be done:
* add support for installing the docs
* patch matrix_double_dense.pyx



---

archive/issue_events_131691.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-03-16T13:30:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131691"
}
```



---

archive/issue_comments_107561.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\n> After testing I can confirm the issue with matrix_double_dense.pyx. numerical/test.py pass without problems as expected. So what needs to be done:\n> * add support for installing the docs\n\nI would say that if this is nontrivial, it is better to get the new numpy and scipy in before next week's Sage Days, where many Numpy devels will be around.  We can always add another patch and ticket for this later.\n> * patch matrix_double_dense.pyx\n\nPutting as 'needs work' for this.",
    "created_at": "2011-03-16T13:30:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107561",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'>Comment 10:</a>
> After testing I can confirm the issue with matrix_double_dense.pyx. numerical/test.py pass without problems as expected. So what needs to be done:
> * add support for installing the docs

I would say that if this is nontrivial, it is better to get the new numpy and scipy in before next week's Sage Days, where many Numpy devels will be around.  We can always add another patch and ticket for this later.
> * patch matrix_double_dense.pyx

Putting as 'needs work' for this.



---

archive/issue_comments_107562.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\n+1 to getting the ticket in without delay, even if it doesn't have the doc-building thing.",
    "created_at": "2011-03-16T14:09:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107562",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:11'>Comment 11:</a>
+1 to getting the ticket in without delay, even if it doesn't have the doc-building thing.



---

archive/issue_comments_107563.json:
```json
{
    "body": "fix matrix_double_dense doctest",
    "created_at": "2011-03-16T20:01:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107563",
    "user": "https://github.com/kiwifb"
}
```

fix matrix_double_dense doctest



---

archive/issue_comments_107564.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n Scipy 0.9 was released a few days ago.  We should upgrade.  There was at least one person that was having problems with the scipy in Sage, and the fix is in 0.9.\n \n-While we're at it, it would also be cool to make the scipy package support SAGE_SPKG_INSTALL_DOCS (see #10823)\n+This should preferably be merged along with numpy-1.5.1 (#10792).\n+\n+Support for SAGE_SPKG_INSTALL_DOCS will be added later in a different ticket.\n+\n+New spkg: [http://spkg-upload.googlecode.com/files/scipy-0.9.spkg](http://spkg-upload.googlecode.com/files/scipy-0.9.spkg)\n+\n+Apply:\n+* [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)\n``````\n",
    "created_at": "2011-03-16T20:06:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107564",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
 Scipy 0.9 was released a few days ago.  We should upgrade.  There was at least one person that was having problems with the scipy in Sage, and the fix is in 0.9.
 
-While we're at it, it would also be cool to make the scipy package support SAGE_SPKG_INSTALL_DOCS (see #10823)
+This should preferably be merged along with numpy-1.5.1 (#10792).
+
+Support for SAGE_SPKG_INSTALL_DOCS will be added later in a different ticket.
+
+New spkg: [http://spkg-upload.googlecode.com/files/scipy-0.9.spkg](http://spkg-upload.googlecode.com/files/scipy-0.9.spkg)
+
+Apply:
+* [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)
``````




---

archive/issue_events_131692.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-03-16T20:06:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131692"
}
```



---

archive/issue_events_131693.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-03-16T20:06:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131693"
}
```



---

archive/issue_comments_107565.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nAttachment: **[trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)**\n\nOk, I am attaching a patch and an updated description. It would be cool to have #10936 on board as well.",
    "created_at": "2011-03-16T20:06:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107565",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:12'>Comment 12:</a>
Attachment: **[trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)**

Ok, I am attaching a patch and an updated description. It would be cool to have #10936 on board as well.



---

archive/issue_comments_107566.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nPatch to Sage library looks fine and applies to 4.7.alpha1.\n\nNew spkg installs and builds.\n\nCombination of the two passes all tests with \"make ptestlong\".\n\nThis is the first time I've reviewed an spkg upgrade.  Is there more to be done?  If so, feel free to flip this back to \"needs work.\"\n\nFran\u00e7ois - thanks for putting this together.  I'll go look at #10936 now, but I think the `NumPy` upgrade is beyond me right now.",
    "created_at": "2011-03-16T21:14:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107566",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:13'>Comment 13:</a>
Patch to Sage library looks fine and applies to 4.7.alpha1.

New spkg installs and builds.

Combination of the two passes all tests with "make ptestlong".

This is the first time I've reviewed an spkg upgrade.  Is there more to be done?  If so, feel free to flip this back to "needs work."

Fran√ßois - thanks for putting this together.  I'll go look at #10936 now, but I think the `NumPy` upgrade is beyond me right now.



---

archive/issue_comments_107567.json:
```json
{
    "body": "Author: **Fran\u00e7ois Bissey**",
    "created_at": "2011-03-16T21:14:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107567",
    "user": "https://github.com/rbeezer"
}
```

Author: **Fran√ßois Bissey**



---

archive/issue_events_131694.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-03-16T21:14:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131694"
}
```



---

archive/issue_events_131695.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-03-16T21:14:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131695"
}
```



---

archive/issue_comments_107568.json:
```json
{
    "body": "Reviewer: **Rob beezer**",
    "created_at": "2011-03-16T21:14:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107568",
    "user": "https://github.com/rbeezer"
}
```

Reviewer: **Rob beezer**



---

archive/issue_comments_107569.json:
```json
{
    "body": "Changed reviewer from **Rob beezer** to **Rob Beezer**",
    "created_at": "2011-03-16T21:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107569",
    "user": "https://github.com/rbeezer"
}
```

Changed reviewer from **Rob beezer** to **Rob Beezer**



---

archive/issue_comments_107570.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\n> This is the first time I've reviewed an spkg upgrade.  Is there more to be done?  If so, feel free to flip this back to \"needs work.\"\n\nIn theory, one should check if the spkg is properly formed, by unpacking it, reading any changes, and making sure that when one `sage -pkg`s it back up there are no red flags (e.g., unchecked changes).\n> Fran\u00e7ois - thanks for putting this together.  I'll go look at #10936 now, but I think the `NumPy` upgrade is beyond me right now.\n\nIt would be helpful to know if all these upgrades play well together, though, so that would helpful for finishing this ticket off.",
    "created_at": "2011-03-17T00:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107570",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'>Comment 15:</a>
> This is the first time I've reviewed an spkg upgrade.  Is there more to be done?  If so, feel free to flip this back to "needs work."

In theory, one should check if the spkg is properly formed, by unpacking it, reading any changes, and making sure that when one `sage -pkg`s it back up there are no red flags (e.g., unchecked changes).
> Fran√ßois - thanks for putting this together.  I'll go look at #10936 now, but I think the `NumPy` upgrade is beyond me right now.

It would be helpful to know if all these upgrades play well together, though, so that would helpful for finishing this ticket off.



---

archive/issue_comments_107571.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@kcrisman](#comment%3A15):\n> It would be helpful to know if all these upgrades play well together, though, so that would helpful for finishing this ticket off.\n\nAs far as I know they do. They are somewhat orthogonal and could be upgraded separately  without trouble. But you want to have scipy rebuilt after a numpy upgrade for \"safety\".\n\nThey certainly play well together on sage-on-gentoo, I now have many copies of \"vanilla\" sage all over the place with various patches and upgrades. I am not sure I have one with both but it wouldn't surprise me.",
    "created_at": "2011-03-17T00:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107571",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@kcrisman](#comment%3A15):
> It would be helpful to know if all these upgrades play well together, though, so that would helpful for finishing this ticket off.

As far as I know they do. They are somewhat orthogonal and could be upgraded separately  without trouble. But you want to have scipy rebuilt after a numpy upgrade for "safety".

They certainly play well together on sage-on-gentoo, I now have many copies of "vanilla" sage all over the place with various patches and upgrades. I am not sure I have one with both but it wouldn't surprise me.



---

archive/issue_comments_107572.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [@kcrisman](#comment%3A15):\n> > This is the first time I've reviewed an spkg upgrade.  Is there more to be done?  If so, feel free to flip this back to \"needs work.\"\n\n> In theory, one should check if the spkg is properly formed, by unpacking it, reading any changes, and making sure that when one `sage -pkg`s it back up there are no red flags (e.g., unchecked changes).\n\nWhich is all fine.",
    "created_at": "2011-03-17T00:45:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107572",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [@kcrisman](#comment%3A15):
> > This is the first time I've reviewed an spkg upgrade.  Is there more to be done?  If so, feel free to flip this back to "needs work."

> In theory, one should check if the spkg is properly formed, by unpacking it, reading any changes, and making sure that when one `sage -pkg`s it back up there are no red flags (e.g., unchecked changes).

Which is all fine.



---

archive/issue_comments_107573.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@kcrisman](#comment%3A17):\n> Which is all fine.\n\nThanks, KDC.  I figured maybe I should peek inside, but was unsure just what to look at.  Next time.\n\nI'm testing #10936 right now.  I'll put this on top of it and see how that goes.  but I'm going to stay away from the numpy ticket.  Too many cooks already on that one.  ;-)",
    "created_at": "2011-03-17T03:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107573",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@kcrisman](#comment%3A17):
> Which is all fine.

Thanks, KDC.  I figured maybe I should peek inside, but was unsure just what to look at.  Next time.

I'm testing #10936 right now.  I'll put this on top of it and see how that goes.  but I'm going to stay away from the numpy ticket.  Too many cooks already on that one.  ;-)



---

archive/issue_comments_107574.json:
```json
{
    "body": "Description changed:\n``````diff\n\n``````\n",
    "created_at": "2011-03-17T19:27:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107574",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff

``````




---

archive/issue_comments_107575.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\n@jdemeyer - I've seen you make that change on a few patches.  I'm pretty sure that Trac picks up the link and makes it active anyway (without the brackets); is there something additional that adding the brackets does?  (Such as making patchbot actually read the Description?  That would be convenient.)",
    "created_at": "2011-03-17T20:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107575",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'>Comment 20:</a>
@jdemeyer - I've seen you make that change on a few patches.  I'm pretty sure that Trac picks up the link and makes it active anyway (without the brackets); is there something additional that adding the brackets does?  (Such as making patchbot actually read the Description?  That would be convenient.)



---

archive/issue_comments_107576.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nI guess you're right, but the brackets make the word \"attachment:\" disappear from the link.  Compare:\n- [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)\n- [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)",
    "created_at": "2011-03-17T21:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107576",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'>Comment 21:</a>
I guess you're right, but the brackets make the word "attachment:" disappear from the link.  Compare:
- [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)
- [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)



---

archive/issue_comments_107577.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nReplying to [@jdemeyer](#comment%3A21):\n> I guess you're right, but the brackets make the word \"attachment:\" disappear from the link.  Compare:\n> - [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)\n> - [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)\n\nUnderstood.  Brackets it is!",
    "created_at": "2011-03-17T21:22:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107577",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'>Comment 22:</a>
Replying to [@jdemeyer](#comment%3A21):
> I guess you're right, but the brackets make the word "attachment:" disappear from the link.  Compare:
> - [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)
> - [attachment: trac_10887-fix_matrix_double_dense_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket10887/trac_10887-fix_matrix_double_dense_doctest.patch.gz)

Understood.  Brackets it is!



---

archive/issue_events_131696.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-03-18T13:41:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131696"
}
```



---

archive/issue_events_131697.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-03-18T13:41:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/10887#event-131697"
}
```



---

archive/issue_comments_107578.json:
```json
{
    "body": "Merged: **sage-4.7.alpha2**",
    "created_at": "2011-03-18T13:41:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/10887",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/10887#issuecomment-107578",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.alpha2**
