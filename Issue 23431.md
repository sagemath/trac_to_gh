# Issue 23431: GCD over p-adics with relative precision produces wrong results

Issue created by migration from https://trac.sagemath.org/ticket/23668

Original creator: edgarcosta

Original creation time: 2017-08-21 21:38:29

CC:  jen

Keywords: days88

Here is an example:

```
ZZx.<x> = ZZ[];
fcoeff = [52222, 17732, 35637, 1384, 41519, 29525, 1, 1];
gcoeff = [44711, 10182, 101820, 6854, 46396, 75921, 1];
f, g = [ZZx(elt) for elt in [fcoeff, gcoeff]]
print "Over ZZ GCD(f, g) = %s\n" % GCD(f,g)

for R in [Qp(3, 10, type = 'capped-rel'), Zp(3, 10, type = 'capped-rel'), Zp(3, 20, type = 'capped-rel'), Zp(3, 10, type = 'capped-abs')]:
    Ry.<y> = R[];
    fy, gy = [Ry(elt) for elt in [fcoeff, gcoeff]]
    print R
    print "GCD(f, g) = %s\n" % GCD(fy, gy)
```


```
Over ZZ GCD(f, g) = 1

3-adic Field with capped relative precision 10
GCD(f, g) = (1 + O(3^2))*y + (2*3^2 + 3^3 + O(3^4))

3-adic Ring with capped relative precision 10
GCD(f, g) = (O(3^7))*y^7 + (O(3^7))*y^6 + (O(3^7))*y^5 + (O(3^7))*y^4 + (O(3^7))*y^3 + (O(3^6))*y^2 + (1 + 3 + 3^2 + 3^4 + 2*3^5 + O(3^6))*y + (2*3^2 + 3^4 + 3^6 + O(3^7))

3-adic Ring with capped relative precision 20
GCD(f, g) = 1 + O(3^20)

3-adic Ring with capped absolute precision 10
GCD(f, g) = 1 + O(3^10)
```



---

Comment by caruso created at 2017-08-22 07:47:06

Yep. 

For correct results, you have to use lattice precision (see ticket #23505) but it's slow :-).

For monic polynomials given at flat precision (i.e. all coefficients are given at the same precision), I described a fast and stable algorithm for computing gcd in [this paper](http://xavier.toonywood.org/papers/publis/euclide.pdf). I had the project to implement it at some point but gave up because it was difficult to increase temporarily the precision. Now thanks to ticket #20310, this becomes possible (and easy).


---

Comment by roed created at 2018-07-22 20:43:45

Changing keywords from "days88" to "days88, padicIMA".
