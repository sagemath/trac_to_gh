# Issue 10411: m-th power residue symbol

Issue created by migration from Trac.

Original creator: katestange

Original creation time: 2010-12-10 22:24:47

Assignee: davidloeffler

CC:  katestange

Keywords: cubic residue

implement m-th power residue symbol (generalising Legendre/Kronecker symbol)


---

Comment by katestange created at 2010-12-11 03:05:13

Changing status from new to needs_review.


---

Attachment


---

Comment by davidloeffler created at 2010-12-16 13:21:35

Changing status from needs_review to needs_work.


---

Comment by davidloeffler created at 2010-12-16 13:21:35

I like the look of this, but the formatting of the docstrings isn't quite right -- the text `"Quadratic Residue (7 is not a square modulo 11)"` shouldn't be inside the code block. You should remove the double colon after `EXAMPLES`, unindent the description lines and put a double colon at the end of each one. Other than that very trivial fix this looks absolutely fine.


---

Comment by fwclarke created at 2010-12-16 22:16:16

I think there are a couple of things which will make the ideal `residue_symbol` function a little faster:

 1. There should be no need to have the default `check=True` when recursively applying the function to the prime factors of the ideal since all the checks will have already been performed.
 1. The final loop can be avoided by calculating a discrete log in the residue field.

Thus I think the last few lines of the definition should read something like:


```
        if not self.is_prime():
            return prod(Q.residue_symbol(e, m, check=False)**i for Q, i in self.factor())
        k = self.residue_field()
        r = k(e)**((k.order() - 1)/m)
        resroot = primroot**(rootorder/m)
        from sage.groups.generic import discrete_log
        j = discrete_log(k(resroot), k(r), ord=m)
        return resroot**j
```

One other little thing.  I think it is safer to write `self.smallest_integer()` rather than `ZZ(self.gens()[0])`.


---

Attachment

Thanks all for the comments and suggestions; they were very helpful.  I've uploaded a new version of the patch that has taken into account all of them.  (I couldn't figure out how to replace the file with one of the same name as suggested in the development walkthrough guide.)


---

Comment by katestange created at 2011-09-12 16:37:45

Changing status from needs_work to needs_review.


---

Comment by davidloeffler created at 2011-09-12 18:29:57

There is something messed up with this patch: each new method is defined twice over.


---

Comment by davidloeffler created at 2011-09-12 18:29:57

Changing status from needs_review to needs_work.


---

Attachment


---

Comment by katestange created at 2011-09-12 19:48:07

Sorry!  I must have cloned the wrong branch at some point, but I should have noticed in the diff -- newbie mistake.  Anyway, it's now been fixed.  (I also see now how to replace the old patch, but at this point I think that would be more confusing, so this is labelled '3'.)


---

Comment by katestange created at 2011-09-12 19:48:07

Changing status from needs_work to needs_review.


---

Comment by fwclarke created at 2011-09-12 21:46:36

It's all fine now.  I'd give it a positive review but for one thing.  The docstring for `sage.rings.number_field.number_field_element.NumberFieldElement.residue_symbol` says 

```
        - ``P`` - proper ideal of the number field (or an extension) 
```

I think that there needs to be a doctest illustrating the case where P is an ideal in an extension.


---

Attachment


---

Comment by katestange created at 2011-09-13 00:52:52

Thanks for pointing that out.  I've fleshed out the documentation somewhat, and in the process found a small bug which has been fixed (the faster routine kronecker_symbol was called on some inappropriate cases).


---

Comment by fwclarke created at 2011-09-13 06:23:26

Changing status from needs_review to positive_review.


---

Comment by fwclarke created at 2011-09-13 06:23:26

All looks good now.  Positive review.


---

Comment by leif created at 2011-09-16 11:50:04

Please put into the ticket's description which patches to apply [in which order, i.e., in the order they should be applied, and perhaps to which repository].

(The trac wiki syntax for referring to attached files is `[attachment:here_comes_the_filename]`, hence in this case `[attachment:trac_10464_residue_symbol.4.patch]`.)

Also, using the comment field of attachments isn't bad.


---

Comment by leif created at 2011-09-17 04:35:09

Resolution: fixed
