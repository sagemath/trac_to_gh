# Issue 29930: Relabeled Coxeter groups implemented with coxeter3

Issue created by migration from https://trac.sagemath.org/ticket/30167

Original creator: @cemulate

Original creation time: 2020-07-18 10:50:47




---

Comment by @cemulate created at 2020-07-18 11:00:24

Changing keywords from "" to "coxeter, coxeter3, relabel, CoxeterGroup".


---

Comment by @cemulate created at 2020-07-18 11:00:24

Changing priority from major to minor.


---

Comment by @cemulate created at 2020-07-18 11:00:24

Changing type from PLEASE CHANGE to enhancement.


---

Comment by @cemulate created at 2020-07-18 11:00:24

Changing component from PLEASE CHANGE to combinatorics.


---

Comment by @cemulate created at 2020-07-18 11:05:05

Changing status from new to needs_review.


---

Comment by git created at 2020-07-18 13:49:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-07-27 19:57:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-07-28 04:50:40

This will now allow twisted affine types as being valid input, which I am not sure we want.

These changes also need to be done:

```
-        Successfully initializes from a relabeled Cartan type ::
+        Successfully initializes from a relabeled Cartan type::
 
             sage: ctype = CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1})
-            sage: W = CoxGroup(ctype)
-            sage: CoxeterMatrix(W.coxeter_matrix(), ctype.index_set()) == CoxeterMatrix(ctype)
+            sage: W = CoxGroup(ctype)  # optional - coxeter3
+            sage: CoxeterMatrix(W.coxeter_matrix(), ctype.index_set()) == CoxeterMatrix(ctype)  # optional - coxeter3
             True
```

and

```diff
-            sage: CoxeterGroup(CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1}))
+            sage: CoxeterGroup(CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1}))  # optional - coxeter3
             Coxeter group of type ['B', 3] relabelled by {1: 3, 2: 2, 3: 1} implemented by Coxeter3
```


Other than those things, this looks good.


---

Comment by git created at 2020-07-28 05:56:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @cemulate created at 2020-07-28 06:04:29

Thanks, it seems there is `.is_untwisted_affine()` to detect that case, but some CartanTypes fail to have that method. Nevertheless, good to be explicit about disallowing it, since that's what was done before.

In the course of working with coxeter3 groups, I've discovered a few other minor bugs that come from discrepancies in the indexing of the CoxeterMatrix, that prevent coxeter3-implemented Coxeter groups from being used in certain contexts. I'll see about cleaning those up in another ticket.

Thanks for the comments!


---

Comment by tscrim created at 2020-07-28 06:12:07

You are still missing one of the doctests to mark as `# optional`. Also there should not be a bare `except:`; instead use `except AttributeError:`. Also, we follow the Python convention for error messages:

```diff
-raise NotImplementedError('Twisted affine groups are not supported in coxeter3.')
+raise NotImplementedError('twisted affine groups are not supported in coxeter3')
```

Although in some ways twisted types only make sense for root systems and Lie algebras...but a `NotImplementedError` is (still) reasonable here.


---

Comment by git created at 2020-07-28 06:22:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @cemulate created at 2020-07-28 06:25:32

Done! I'll keep that convention in mind.


---

Comment by tscrim created at 2020-07-28 06:44:09

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-07-28 06:44:09

Then let it be so.


---

Comment by vbraun created at 2020-08-07 19:05:28

Resolution: fixed
