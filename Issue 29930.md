# Issue 29930: Relabeled Coxeter groups implemented with coxeter3

archive/issues_029930.json:
```json
{
    "body": "\n\nIssue created by migration from https://trac.sagemath.org/ticket/30167\n\n",
    "created_at": "2020-07-18T10:50:47Z",
    "labels": [],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Relabeled Coxeter groups implemented with coxeter3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29930",
    "user": "https://github.com/cemulate"
}
```


Issue created by migration from https://trac.sagemath.org/ticket/30167





---

archive/issue_comments_424623.json:
```json
{
    "body": "Changing keywords from \"\" to \"coxeter, coxeter3, relabel, CoxeterGroup\".",
    "created_at": "2020-07-18T11:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424623",
    "user": "https://github.com/cemulate"
}
```

Changing keywords from "" to "coxeter, coxeter3, relabel, CoxeterGroup".



---

archive/issue_comments_424624.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2020-07-18T11:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424624",
    "user": "https://github.com/cemulate"
}
```

Changing priority from major to minor.



---

archive/issue_comments_424625.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-07-18T11:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424625",
    "user": "https://github.com/cemulate"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_424626.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2020-07-18T11:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424626",
    "user": "https://github.com/cemulate"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_424627.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-18T11:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424627",
    "user": "https://github.com/cemulate"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_424628.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-18T13:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424628",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_424629.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-27T19:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_424630.json:
```json
{
    "body": "This will now allow twisted affine types as being valid input, which I am not sure we want.\n\nThese changes also need to be done:\n\n```\n-        Successfully initializes from a relabeled Cartan type ::\n+        Successfully initializes from a relabeled Cartan type::\n \n             sage: ctype = CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1})\n-            sage: W = CoxGroup(ctype)\n-            sage: CoxeterMatrix(W.coxeter_matrix(), ctype.index_set()) == CoxeterMatrix(ctype)\n+            sage: W = CoxGroup(ctype)  # optional - coxeter3\n+            sage: CoxeterMatrix(W.coxeter_matrix(), ctype.index_set()) == CoxeterMatrix(ctype)  # optional - coxeter3\n             True\n```\nand\n\n```diff\n-            sage: CoxeterGroup(CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1}))\n+            sage: CoxeterGroup(CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1}))  # optional - coxeter3\n             Coxeter group of type ['B', 3] relabelled by {1: 3, 2: 2, 3: 1} implemented by Coxeter3\n```\n\nOther than those things, this looks good.",
    "created_at": "2020-07-28T04:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424630",
    "user": "https://github.com/tscrim"
}
```

This will now allow twisted affine types as being valid input, which I am not sure we want.

These changes also need to be done:

```
-        Successfully initializes from a relabeled Cartan type ::
+        Successfully initializes from a relabeled Cartan type::
 
             sage: ctype = CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1})
-            sage: W = CoxGroup(ctype)
-            sage: CoxeterMatrix(W.coxeter_matrix(), ctype.index_set()) == CoxeterMatrix(ctype)
+            sage: W = CoxGroup(ctype)  # optional - coxeter3
+            sage: CoxeterMatrix(W.coxeter_matrix(), ctype.index_set()) == CoxeterMatrix(ctype)  # optional - coxeter3
             True
```
and

```diff
-            sage: CoxeterGroup(CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1}))
+            sage: CoxeterGroup(CartanType(['B', 3]).relabel({1: 3, 2: 2, 3: 1}))  # optional - coxeter3
             Coxeter group of type ['B', 3] relabelled by {1: 3, 2: 2, 3: 1} implemented by Coxeter3
```

Other than those things, this looks good.



---

archive/issue_comments_424631.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-28T05:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424631",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_424632.json:
```json
{
    "body": "Thanks, it seems there is `.is_untwisted_affine()` to detect that case, but some CartanTypes fail to have that method. Nevertheless, good to be explicit about disallowing it, since that's what was done before.\n\nIn the course of working with coxeter3 groups, I've discovered a few other minor bugs that come from discrepancies in the indexing of the CoxeterMatrix, that prevent coxeter3-implemented Coxeter groups from being used in certain contexts. I'll see about cleaning those up in another ticket.\n\nThanks for the comments!",
    "created_at": "2020-07-28T06:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424632",
    "user": "https://github.com/cemulate"
}
```

Thanks, it seems there is `.is_untwisted_affine()` to detect that case, but some CartanTypes fail to have that method. Nevertheless, good to be explicit about disallowing it, since that's what was done before.

In the course of working with coxeter3 groups, I've discovered a few other minor bugs that come from discrepancies in the indexing of the CoxeterMatrix, that prevent coxeter3-implemented Coxeter groups from being used in certain contexts. I'll see about cleaning those up in another ticket.

Thanks for the comments!



---

archive/issue_comments_424633.json:
```json
{
    "body": "You are still missing one of the doctests to mark as `# optional`. Also there should not be a bare `except:`; instead use `except AttributeError:`. Also, we follow the Python convention for error messages:\n\n```diff\n-raise NotImplementedError('Twisted affine groups are not supported in coxeter3.')\n+raise NotImplementedError('twisted affine groups are not supported in coxeter3')\n```\nAlthough in some ways twisted types only make sense for root systems and Lie algebras...but a `NotImplementedError` is (still) reasonable here.",
    "created_at": "2020-07-28T06:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424633",
    "user": "https://github.com/tscrim"
}
```

You are still missing one of the doctests to mark as `# optional`. Also there should not be a bare `except:`; instead use `except AttributeError:`. Also, we follow the Python convention for error messages:

```diff
-raise NotImplementedError('Twisted affine groups are not supported in coxeter3.')
+raise NotImplementedError('twisted affine groups are not supported in coxeter3')
```
Although in some ways twisted types only make sense for root systems and Lie algebras...but a `NotImplementedError` is (still) reasonable here.



---

archive/issue_comments_424634.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-28T06:22:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424634",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_424635.json:
```json
{
    "body": "Done! I'll keep that convention in mind.",
    "created_at": "2020-07-28T06:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424635",
    "user": "https://github.com/cemulate"
}
```

Done! I'll keep that convention in mind.



---

archive/issue_comments_424636.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-28T06:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424636",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_424637.json:
```json
{
    "body": "Then let it be so.",
    "created_at": "2020-07-28T06:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424637",
    "user": "https://github.com/tscrim"
}
```

Then let it be so.



---

archive/issue_comments_424638.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-07T19:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29930#issuecomment-424638",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_077803.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-07T19:05:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29930",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29930#event-77803"
}
```
