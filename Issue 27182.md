# Issue 27182: Segmentation fault in integer division

archive/issues_027182.json:
```json
{
    "body": "CC:  @dimpase\n\nthis was reported to me by Jean-Luc Garambois, with Sage 8.6. I get the same\nissue with Sage 8.5. I do not copy the whole error message because it is too long.\n\n```\nsage: u=9913\nsage: v=2203\nsage: p=2^v-1\nsage: q=(2^(v+1)-1)*(2^u-1)+2^(u-v)*(2^(u+1)-1)\nsage: q/p\n------------------------------------------------------------------------\n/home/garambois/SageMath/local/lib/python2.7/site-packages/cysignals/signals.so\\\n(+0x7898)[0x7f4f1377a898]\n\n/home/garambois/SageMath/local/lib/python2.7/site-packages/cysignals/signals.so\\\n(+0x793f)[0x7f4f1377a93f]\n\n/home/garambois/SageMath/local/lib/python2.7/site-packages/cysignals/signals.so\\\n(+0xa37c)[0x7f4f1377d37c]\n...------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n------------------------------------------------------------------------\nSegmentation fault\n```\n\n\nNote: I get no error when the division is not exact, for example with `(q+1)/p`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27419\n\n",
    "created_at": "2019-03-04T13:19:48Z",
    "labels": [
        "component: basic arithmetic",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Segmentation fault in integer division",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27182",
    "user": "https://github.com/zimmermann6"
}
```
CC:  @dimpase

this was reported to me by Jean-Luc Garambois, with Sage 8.6. I get the same
issue with Sage 8.5. I do not copy the whole error message because it is too long.

```
sage: u=9913
sage: v=2203
sage: p=2^v-1
sage: q=(2^(v+1)-1)*(2^u-1)+2^(u-v)*(2^(u+1)-1)
sage: q/p
------------------------------------------------------------------------
/home/garambois/SageMath/local/lib/python2.7/site-packages/cysignals/signals.so\
(+0x7898)[0x7f4f1377a898]

/home/garambois/SageMath/local/lib/python2.7/site-packages/cysignals/signals.so\
(+0x793f)[0x7f4f1377a93f]

/home/garambois/SageMath/local/lib/python2.7/site-packages/cysignals/signals.so\
(+0xa37c)[0x7f4f1377d37c]
...------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------
Segmentation fault
```


Note: I get no error when the division is not exact, for example with `(q+1)/p`.

Issue created by migration from https://trac.sagemath.org/ticket/27419





---

archive/issue_comments_382487.json:
```json
{
    "body": "Replying to [ticket:27419 zimmerma]:\n> I do not copy the whole error message because it is too long.\n\nThen at least include it as attachment.",
    "created_at": "2019-03-04T14:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382487",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:27419 zimmerma]:
> I do not copy the whole error message because it is too long.

Then at least include it as attachment.



---

archive/issue_comments_382488.json:
```json
{
    "body": "I cannot reproduce this with Sage 8.7.beta6. I get the answer\n\n```\n15260302207367206383069757609205726622576246796622352874530340764747803930674910462543534158391298009280468309455062051462034133472388679771326900418479900543441313005574680867783239849485498348032594898873808871849760260873671227327451536011464719731957103677405553998111544319202058609180411161800282178513416995210144585842079374158997803223560281743100929381835531771844471416114057891626607277008114810309616776453909652955151440052103203465932658797087157661710535502620808196655815155790858125309720046573598789605719011928260470375066538229555844421475930716239327486323245359128209308605465031709752973704896721393656809462422955581859486550788533603837906118857545464038319716621736437121288939699620122417520449648533249078582162988486337730143019996277846697360330117518025973451898442298351071843624062524085903114331959471809291637096166532162429698494838457420137366665646518880232258225983016092618828529789340108457845309914820774369003286108910465927531355652454503113723598055212083076258754649543248555806020498659192505535091938488017216000655531776120813041422579843517599292757523450240591564732664096902630935829794670229930282773024106225280986022084976459772761217929898608866580733082856627253997713866102102158387478110647188418064363420460930124692061199329484867790187666978164971819405143891052113509298650969228021749819417755844748174698721420658226535641059630841238231852133754154172896650273406245951305406058542207171693496257130826042394808791679770241721614460804970841779751330341035356492624945715368908261334979219476209166549340781090509154058120706938417070656806840423200055380212689342537288829627600814467839760251568815684197283990466997876698570050988042178114350277250783466316039272870313462368551198232629024860776460268178202033319623650962822621025253422755392142119985261217112910855574785816389083725336495020326093740931272846082475545278335498224468477103571666945788510960981287912284878872415495212913619125561780803414964754590595943778724171952752876007169917929441212137533720662011975588469081994018715053850355103797421316465067506094743047591231330918125629039327643925721356651000582416972163071089825302423505731693336058095640738661196716217611406508464284466150201640344711601348683867827017077380760502649515988720582822013367686557407149161402715109221411753706478686009905757699317350816736314272510194295886072820232644696559593938223226287993737344348172304663013914744055887677194057453733107880666506256603676995899587181656898228310596199280150935181556986925490340267597374182767788281125231086616177346769824319572207086743802904804211803015770885894329720203816614442857141593932084133284474303106217142633494448074470455094988594581337508871810780886127389708579520916381430335371923241979057907713427755851591994136556262440921918369978146075778851691070015069052078745571710369723456754502416477508964223111111581593785902370083613518228987126265393274592562218469810579848227620794797601251492986020567979105745410670889135830700178949913967854531969117848300684686839608196314370942208267244059107922114502739982819680536069225717257083328568144535545727825237364273507259318309624576600747789909295909216136965784197796051188832785718442574751006091006479627298188554864129011749783322318401424063885465822856163224171661697940826771482216632204037429500752569998449785879987042866670540135087773745115627180942472725968270108168984296386200670559867235648366988414233385162769349454681736873919594168894722961851326257059363544377275771520659569882265572546724157237403300233241582700944317137681690806438578998942484567455613110178517124748544439769923597151681063498272280386050944630925248235950966013016647525565645810275222481987344895672613161006896175124538127217538403437029701475201532661746031811980736770185442546324580706059997356077422396038844121921112839192336867726404314772319522082538127039916336216521120959322928406998784191819706007753696941351497531394528018333547416839220456022964360766248920839372561476062839362896444775788497190543390404601404867610218240670327622807340093378796963452532037427942928682871836219313089272488422927187004988023972587334653083239375938276362426642359904421255334941602903634932946476411078803457538968492676783857469843094775552264849765851891910347215478442856487752926942272979416516866420211148219875048890755457337401527450397281858300479099706796754128190984070220436727865870820124580737787111523131795732055602637889022586039820199420458452738284681447179137832108415867517981051474750771039981849435204226752913910040172707791146511371007360314497114662761889296105156699585849949161521151\n```\n",
    "created_at": "2019-03-04T14:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382488",
    "user": "https://github.com/jdemeyer"
}
```

I cannot reproduce this with Sage 8.7.beta6. I get the answer

```
15260302207367206383069757609205726622576246796622352874530340764747803930674910462543534158391298009280468309455062051462034133472388679771326900418479900543441313005574680867783239849485498348032594898873808871849760260873671227327451536011464719731957103677405553998111544319202058609180411161800282178513416995210144585842079374158997803223560281743100929381835531771844471416114057891626607277008114810309616776453909652955151440052103203465932658797087157661710535502620808196655815155790858125309720046573598789605719011928260470375066538229555844421475930716239327486323245359128209308605465031709752973704896721393656809462422955581859486550788533603837906118857545464038319716621736437121288939699620122417520449648533249078582162988486337730143019996277846697360330117518025973451898442298351071843624062524085903114331959471809291637096166532162429698494838457420137366665646518880232258225983016092618828529789340108457845309914820774369003286108910465927531355652454503113723598055212083076258754649543248555806020498659192505535091938488017216000655531776120813041422579843517599292757523450240591564732664096902630935829794670229930282773024106225280986022084976459772761217929898608866580733082856627253997713866102102158387478110647188418064363420460930124692061199329484867790187666978164971819405143891052113509298650969228021749819417755844748174698721420658226535641059630841238231852133754154172896650273406245951305406058542207171693496257130826042394808791679770241721614460804970841779751330341035356492624945715368908261334979219476209166549340781090509154058120706938417070656806840423200055380212689342537288829627600814467839760251568815684197283990466997876698570050988042178114350277250783466316039272870313462368551198232629024860776460268178202033319623650962822621025253422755392142119985261217112910855574785816389083725336495020326093740931272846082475545278335498224468477103571666945788510960981287912284878872415495212913619125561780803414964754590595943778724171952752876007169917929441212137533720662011975588469081994018715053850355103797421316465067506094743047591231330918125629039327643925721356651000582416972163071089825302423505731693336058095640738661196716217611406508464284466150201640344711601348683867827017077380760502649515988720582822013367686557407149161402715109221411753706478686009905757699317350816736314272510194295886072820232644696559593938223226287993737344348172304663013914744055887677194057453733107880666506256603676995899587181656898228310596199280150935181556986925490340267597374182767788281125231086616177346769824319572207086743802904804211803015770885894329720203816614442857141593932084133284474303106217142633494448074470455094988594581337508871810780886127389708579520916381430335371923241979057907713427755851591994136556262440921918369978146075778851691070015069052078745571710369723456754502416477508964223111111581593785902370083613518228987126265393274592562218469810579848227620794797601251492986020567979105745410670889135830700178949913967854531969117848300684686839608196314370942208267244059107922114502739982819680536069225717257083328568144535545727825237364273507259318309624576600747789909295909216136965784197796051188832785718442574751006091006479627298188554864129011749783322318401424063885465822856163224171661697940826771482216632204037429500752569998449785879987042866670540135087773745115627180942472725968270108168984296386200670559867235648366988414233385162769349454681736873919594168894722961851326257059363544377275771520659569882265572546724157237403300233241582700944317137681690806438578998942484567455613110178517124748544439769923597151681063498272280386050944630925248235950966013016647525565645810275222481987344895672613161006896175124538127217538403437029701475201532661746031811980736770185442546324580706059997356077422396038844121921112839192336867726404314772319522082538127039916336216521120959322928406998784191819706007753696941351497531394528018333547416839220456022964360766248920839372561476062839362896444775788497190543390404601404867610218240670327622807340093378796963452532037427942928682871836219313089272488422927187004988023972587334653083239375938276362426642359904421255334941602903634932946476411078803457538968492676783857469843094775552264849765851891910347215478442856487752926942272979416516866420211148219875048890755457337401527450397281858300479099706796754128190984070220436727865870820124580737787111523131795732055602637889022586039820199420458452738284681447179137832108415867517981051474750771039981849435204226752913910040172707791146511371007360314497114662761889296105156699585849949161521151
```




---

archive/issue_comments_382489.json:
```json
{
    "body": "Attachment [log](tarball://root/attachments/some-uuid/ticket27419/log) by @zimmermann6 created at 2019-03-04 14:41:35\n\nlog file",
    "created_at": "2019-03-04T14:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382489",
    "user": "https://github.com/zimmermann6"
}
```

Attachment [log](tarball://root/attachments/some-uuid/ticket27419/log) by @zimmermann6 created at 2019-03-04 14:41:35

log file



---

archive/issue_comments_382490.json:
```json
{
    "body": "> Then at least include it as attachment.\n\ndone.",
    "created_at": "2019-03-04T14:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382490",
    "user": "https://github.com/zimmermann6"
}
```

> Then at least include it as attachment.

done.



---

archive/issue_comments_382491.json:
```json
{
    "body": "> I cannot reproduce this with Sage 8.7.beta6.\n\ncan you reproduce it with 8.5 or 8.6?",
    "created_at": "2019-03-04T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382491",
    "user": "https://github.com/zimmermann6"
}
```

> I cannot reproduce this with Sage 8.7.beta6.

can you reproduce it with 8.5 or 8.6?



---

archive/issue_comments_382492.json:
```json
{
    "body": "On a different system, I can reproduce it on 8.6",
    "created_at": "2019-03-04T15:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382492",
    "user": "https://github.com/jdemeyer"
}
```

On a different system, I can reproduce it on 8.6



---

archive/issue_comments_382493.json:
```json
{
    "body": "I do not get the error on my Ubuntu 18.04 machine with Sage 8.6 (running Python3).",
    "created_at": "2019-03-05T00:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382493",
    "user": "https://github.com/tscrim"
}
```

I do not get the error on my Ubuntu 18.04 machine with Sage 8.6 (running Python3).



---

archive/issue_comments_382494.json:
```json
{
    "body": "On the same system I mentioned in [comment:5] I can reproduce the error also on 8.7.beta6.",
    "created_at": "2019-03-05T06:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382494",
    "user": "https://github.com/jdemeyer"
}
```

On the same system I mentioned in [comment:5] I can reproduce the error also on 8.7.beta6.



---

archive/issue_comments_382495.json:
```json
{
    "body": "maybe add this as a non-regression test in `integer.pyx`?",
    "created_at": "2019-03-05T06:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382495",
    "user": "https://github.com/zimmermann6"
}
```

maybe add this as a non-regression test in `integer.pyx`?



---

archive/issue_comments_382496.json:
```json
{
    "body": "does the bug occur when GMP is used in place of MPIR?",
    "created_at": "2019-03-05T09:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382496",
    "user": "https://github.com/zimmermann6"
}
```

does the bug occur when GMP is used in place of MPIR?



---

archive/issue_comments_382497.json:
```json
{
    "body": "To me this smells like a gcc bug. As gcc 4.9 is [no longer maintained](https://gcc.gnu.org/gcc-4.9/), I don't see how this can be a blocker... \n\nBy the way, #27212 allows for choosing between system's GMP (or perhaps system MPIR in GMP-compatible mode), and Sage's supplied MPIR or GMP.\n\n(One issue that is left unresolved there is how to handle dynamic package changes, i.e. `./sage -i mpir` would break things...)",
    "created_at": "2019-03-05T10:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382497",
    "user": "https://github.com/dimpase"
}
```

To me this smells like a gcc bug. As gcc 4.9 is [no longer maintained](https://gcc.gnu.org/gcc-4.9/), I don't see how this can be a blocker... 

By the way, #27212 allows for choosing between system's GMP (or perhaps system MPIR in GMP-compatible mode), and Sage's supplied MPIR or GMP.

(One issue that is left unresolved there is how to handle dynamic package changes, i.e. `./sage -i mpir` would break things...)



---

archive/issue_comments_382498.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> To me this smells like a gcc bug.\n\nI agree but we should exclude that it's an MPIR bug.",
    "created_at": "2019-03-05T10:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382498",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:16 dimpase]:
> To me this smells like a gcc bug.

I agree but we should exclude that it's an MPIR bug.



---

archive/issue_comments_382499.json:
```json
{
    "body": "on my machine where the bug occurs with Sage 8.5, it was compiled with GCC 7.2.0 according to `config.status`.",
    "created_at": "2019-03-05T10:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382499",
    "user": "https://github.com/zimmermann6"
}
```

on my machine where the bug occurs with Sage 8.5, it was compiled with GCC 7.2.0 according to `config.status`.



---

archive/issue_comments_382500.json:
```json
{
    "body": "OK, is it a Xeon-only bug then (so far)?",
    "created_at": "2019-03-05T10:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382500",
    "user": "https://github.com/dimpase"
}
```

OK, is it a Xeon-only bug then (so far)?



---

archive/issue_comments_382501.json:
```json
{
    "body": "Surely, not every Xeon+gcc, e.g. with gcc 8.2.0 and some Intel(R) Xeon(R) CPU `@` 2.60GHz\n(not sure how to get more relevant details from /proc/cpuinfo)\nand MPIR it seem to work just fine...",
    "created_at": "2019-03-05T11:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382501",
    "user": "https://github.com/dimpase"
}
```

Surely, not every Xeon+gcc, e.g. with gcc 8.2.0 and some Intel(R) Xeon(R) CPU `@` 2.60GHz
(not sure how to get more relevant details from /proc/cpuinfo)
and MPIR it seem to work just fine...



---

archive/issue_comments_382502.json:
```json
{
    "body": "It would be good if everybody would post the top lines of `logs/pkgs/mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868.p0.log`. For example, on my failing system, I have\n\n```\n****************************************************\nHost system:\nLinux sage4 4.14.78-gentoo #3 SMP Tue Nov 20 16:05:28 CET 2018 x86_64 Intel(R) Xeon(R) CPU X5660 @ 2.80GHz GenuineIntel GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=/usr/x86_64-pc-linux-gnu/gcc-bin/4.9.3/gcc\nCOLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-pc-linux-gnu/4.9.3/lto-wrapper\nTarget: x86_64-pc-linux-gnu\nConfigured with: /var/tmp/portage/sys-devel/gcc-4.9.3/work/gcc-4.9.3/configure --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/4.9.3 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/include/g++-v4 --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/python --enable-languages=c,c++,fortran --enable-obsolete --enable-secureplt --disable-werror --with-system-zlib --enable-nls --without-included-gettext --enable-checking=release --with-bugurl=https://bugs.gentoo.org/ --with-pkgversion='Gentoo 4.9.3 p1.5, pie-0.6.4' --enable-libstdcxx-time --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-multilib --with-multilib-list=m32,m64 --disable-altivec --disable-fixed-point --enable-targets=all --disable-libgcj --enable-libgomp --disable-libmudflap --disable-libssp --disable-libcilkrts --enable-vtable-verify --enable-libvtv --enable-lto --without-cloog --enable-libsanitizer\nThread model: posix\ngcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4)\n****************************************************\nMachine type (default): x86_64-unknown-linux-gnu\nMachine type (mpir): westmere-unknown-linux-gnu\nBuilding a 64-bit version of MPIR.\n```\n",
    "created_at": "2019-03-05T11:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382502",
    "user": "https://github.com/jdemeyer"
}
```

It would be good if everybody would post the top lines of `logs/pkgs/mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868.p0.log`. For example, on my failing system, I have

```
****************************************************
Host system:
Linux sage4 4.14.78-gentoo #3 SMP Tue Nov 20 16:05:28 CET 2018 x86_64 Intel(R) Xeon(R) CPU X5660 @ 2.80GHz GenuineIntel GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=/usr/x86_64-pc-linux-gnu/gcc-bin/4.9.3/gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-pc-linux-gnu/4.9.3/lto-wrapper
Target: x86_64-pc-linux-gnu
Configured with: /var/tmp/portage/sys-devel/gcc-4.9.3/work/gcc-4.9.3/configure --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/4.9.3 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/include/g++-v4 --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/python --enable-languages=c,c++,fortran --enable-obsolete --enable-secureplt --disable-werror --with-system-zlib --enable-nls --without-included-gettext --enable-checking=release --with-bugurl=https://bugs.gentoo.org/ --with-pkgversion='Gentoo 4.9.3 p1.5, pie-0.6.4' --enable-libstdcxx-time --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-multilib --with-multilib-list=m32,m64 --disable-altivec --disable-fixed-point --enable-targets=all --disable-libgcj --enable-libgomp --disable-libmudflap --disable-libssp --disable-libcilkrts --enable-vtable-verify --enable-libvtv --enable-lto --without-cloog --enable-libsanitizer
Thread model: posix
gcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4)
****************************************************
Machine type (default): x86_64-unknown-linux-gnu
Machine type (mpir): westmere-unknown-linux-gnu
Building a 64-bit version of MPIR.
```




---

archive/issue_comments_382503.json:
```json
{
    "body": "Here is is what I have on my seemingly OK Xeon:\n\n```\nLinux gent-linux 4.18.0-1006-gcp #7-Ubuntu SMP Tue Jan 15 13:28:52 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/8/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 8.2.0-7ubuntu1' --with-bugurl=file:///usr/share/doc/gcc-8/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-8 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 8.2.0 (Ubuntu 8.2.0-7ubuntu1) \n****************************************************\nMachine type (default): x86_64-unknown-linux-gnu\nMachine type (mpir): sandybridge-unknown-linux-gnu\n```\n\n\n(Jeroen, you know this machine I suppose :-))\n\nSo `sandybridge` seems OK. I also cannot reproduce this on `i7-6600U CPU `@` 2.60GHz skylakeavx`.",
    "created_at": "2019-03-05T11:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382503",
    "user": "https://github.com/dimpase"
}
```

Here is is what I have on my seemingly OK Xeon:

```
Linux gent-linux 4.18.0-1006-gcp #7-Ubuntu SMP Tue Jan 15 13:28:52 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/8/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 8.2.0-7ubuntu1' --with-bugurl=file:///usr/share/doc/gcc-8/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-8 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 8.2.0 (Ubuntu 8.2.0-7ubuntu1) 
****************************************************
Machine type (default): x86_64-unknown-linux-gnu
Machine type (mpir): sandybridge-unknown-linux-gnu
```


(Jeroen, you know this machine I suppose :-))

So `sandybridge` seems OK. I also cannot reproduce this on `i7-6600U CPU `@` 2.60GHz skylakeavx`.



---

archive/issue_comments_382504.json:
```json
{
    "body": "With my `Intel(R) Core(TM) i7-8700` (not getting the error):\n\n```\n****************************************************\nHost system:\nLinux SMP-36PQ8T2 4.15.0-45-generic #48-Ubuntu SMP Tue Jan 29 16:28:13 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/8/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 8.2.0-1ubuntu2~18.04' --with-bugurl=file:///usr/share/doc/gcc-8/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-8 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 8.2.0 (Ubuntu 8.2.0-1ubuntu2~18.04) \n****************************************************\nMachine type (default): x86_64-unknown-linux-gnu\nMachine type (mpir): x86_64-unknown-linux-gnu\n```\n",
    "created_at": "2019-03-05T22:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382504",
    "user": "https://github.com/tscrim"
}
```

With my `Intel(R) Core(TM) i7-8700` (not getting the error):

```
****************************************************
Host system:
Linux SMP-36PQ8T2 4.15.0-45-generic #48-Ubuntu SMP Tue Jan 29 16:28:13 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/8/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 8.2.0-1ubuntu2~18.04' --with-bugurl=file:///usr/share/doc/gcc-8/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-8 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 8.2.0 (Ubuntu 8.2.0-1ubuntu2~18.04) 
****************************************************
Machine type (default): x86_64-unknown-linux-gnu
Machine type (mpir): x86_64-unknown-linux-gnu
```




---

archive/issue_comments_382505.json:
```json
{
    "body": "My laptop (not getting the error):\n\n```\n****************************************************\nHost system:\nLinux tamiyo 3.17.7-gentoo #2 SMP PREEMPT Fri Dec 23 18:13:49 CET 2016 x86_64 Intel(R) Core(TM) i7-2640M CPU @ 2.80GHz GenuineIntel GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=/usr/x86_64-pc-linux-gnu/gcc-bin/6.4.0/gcc\nCOLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-pc-linux-gnu/6.4.0/lto-wrapper\nTarget: x86_64-pc-linux-gnu\nConfigured with: /var/tmp/portage/sys-devel/gcc-6.4.0-r1/work/gcc-6.4.0/configure --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/6.4.0 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/6.4.0/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/6.4.0 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/6.4.0/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/6.4.0/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/6.4.0/include/g++-v6 --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/6.4.0/python --enable-languages=c,c++,fortran --enable-obsolete --enable-secureplt --disable-werror --with-system-zlib --enable-nls --without-included-gettext --enable-checking=release --with-bugurl=https://bugs.gentoo.org/ --with-pkgversion='Gentoo 6.4.0-r1 p1.3' --disable-esp --enable-libstdcxx-time --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-multilib --with-multilib-list=m32,m64 --disable-altivec --disable-fixed-point --enable-targets=all --disable-libgcj --enable-libgomp --disable-libmudflap --disable-libssp --disable-libcilkrts --disable-libmpx --enable-vtable-verify --enable-libvtv --enable-lto --without-isl --enable-libsanitizer --enable-default-pie --enable-default-ssp\nThread model: posix\ngcc version 6.4.0 (Gentoo 6.4.0-r1 p1.3) \n****************************************************\nMachine type (default): x86_64-unknown-linux-gnu\nMachine type (mpir): sandybridge-unknown-linux-gnu\nBuilding a 64-bit version of MPIR.\n```\n",
    "created_at": "2019-03-06T08:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382505",
    "user": "https://github.com/jdemeyer"
}
```

My laptop (not getting the error):

```
****************************************************
Host system:
Linux tamiyo 3.17.7-gentoo #2 SMP PREEMPT Fri Dec 23 18:13:49 CET 2016 x86_64 Intel(R) Core(TM) i7-2640M CPU @ 2.80GHz GenuineIntel GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=/usr/x86_64-pc-linux-gnu/gcc-bin/6.4.0/gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-pc-linux-gnu/6.4.0/lto-wrapper
Target: x86_64-pc-linux-gnu
Configured with: /var/tmp/portage/sys-devel/gcc-6.4.0-r1/work/gcc-6.4.0/configure --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/6.4.0 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/6.4.0/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/6.4.0 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/6.4.0/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/6.4.0/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/6.4.0/include/g++-v6 --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/6.4.0/python --enable-languages=c,c++,fortran --enable-obsolete --enable-secureplt --disable-werror --with-system-zlib --enable-nls --without-included-gettext --enable-checking=release --with-bugurl=https://bugs.gentoo.org/ --with-pkgversion='Gentoo 6.4.0-r1 p1.3' --disable-esp --enable-libstdcxx-time --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-multilib --with-multilib-list=m32,m64 --disable-altivec --disable-fixed-point --enable-targets=all --disable-libgcj --enable-libgomp --disable-libmudflap --disable-libssp --disable-libcilkrts --disable-libmpx --enable-vtable-verify --enable-libvtv --enable-lto --without-isl --enable-libsanitizer --enable-default-pie --enable-default-ssp
Thread model: posix
gcc version 6.4.0 (Gentoo 6.4.0-r1 p1.3) 
****************************************************
Machine type (default): x86_64-unknown-linux-gnu
Machine type (mpir): sandybridge-unknown-linux-gnu
Building a 64-bit version of MPIR.
```




---

archive/issue_comments_382506.json:
```json
{
    "body": "With my laptop's `Intel(R) Core(TM) i7-4720HQ` with Ubunutu 16.04 LTS (no error on 8.7.beta5):\n\n```\nHost system:\nLinux apricot 3.11.0-15-generic #25~precise1-Ubuntu SMP Thu Jan 30 17:39:31 UTC 2014 x86_6\n4 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/7/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 7.3.0-21ubuntu1~16.04' --wi\nth-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,f\nortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --prog\nram-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/li\nb --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-\nsysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with\n-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-lib\nmpx --enable-plugin --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --e\nnable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m\n32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --wi\nthout-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 7.3.0 (Ubuntu 7.3.0-21ubuntu1~16.04) \n****************************************************\nOld-style or corrupt stamp file '/home/travis/sage-build/local/var/lib/sage/installed/mpir\n-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868'\nNo legacy uninstaller found for 'mpir'; nothing to do\nMachine type (default): x86_64-unknown-linux-gnu\nMachine type (mpir): haswellavx-unknown-linux-gnu\nBuilding a 64-bit version of MPIR.\nBuilding MPIR with the C++ interface and (also) static libraries.\n```\n",
    "created_at": "2019-03-06T11:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382506",
    "user": "https://github.com/tscrim"
}
```

With my laptop's `Intel(R) Core(TM) i7-4720HQ` with Ubunutu 16.04 LTS (no error on 8.7.beta5):

```
Host system:
Linux apricot 3.11.0-15-generic #25~precise1-Ubuntu SMP Thu Jan 30 17:39:31 UTC 2014 x86_6
4 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/7/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 7.3.0-21ubuntu1~16.04' --wi
th-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,f
ortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --prog
ram-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/li
b --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-
sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with
-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-lib
mpx --enable-plugin --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --e
nable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m
32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --wi
thout-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 7.3.0 (Ubuntu 7.3.0-21ubuntu1~16.04) 
****************************************************
Old-style or corrupt stamp file '/home/travis/sage-build/local/var/lib/sage/installed/mpir
-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868'
No legacy uninstaller found for 'mpir'; nothing to do
Machine type (default): x86_64-unknown-linux-gnu
Machine type (mpir): haswellavx-unknown-linux-gnu
Building a 64-bit version of MPIR.
Building MPIR with the C++ interface and (also) static libraries.
```




---

archive/issue_comments_382507.json:
```json
{
    "body": "https://gmplib.org/list-archives/gmp-devel/2014-March/003721.html seems vaguely related.",
    "created_at": "2019-03-14T16:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382507",
    "user": "https://github.com/embray"
}
```

https://gmplib.org/list-archives/gmp-devel/2014-March/003721.html seems vaguely related.



---

archive/issue_comments_382508.json:
```json
{
    "body": "Seems to be Westmere microarchitecture specific, for consumer CPUs one should try with a first-generation Intel Core. E.g. i7-970, i5-6xx. I don't have anything that old lying around...",
    "created_at": "2019-03-15T12:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382508",
    "user": "https://github.com/vbraun"
}
```

Seems to be Westmere microarchitecture specific, for consumer CPUs one should try with a first-generation Intel Core. E.g. i7-970, i5-6xx. I don't have anything that old lying around...



---

archive/issue_comments_382509.json:
```json
{
    "body": "This computation works well with our MPIR on my old OSX Core 2 Duo machine. (Well, built with clang, not with gcc).\nThat's as old as it goes among CPUs  that I have working.\n\n```\n****************************************************\nHost system:\nDarwin dimas-air.lan 17.7.0 Darwin Kernel Version 17.7.0: Thu Dec 20 21:47:19 PST 2018; root:xnu-4570.71.22~1/RELEASE_X86_64 x86_64\n****************************************************\nC compiler: clang\nC compiler version:\nApple LLVM version 10.0.0 (clang-1000.10.44.4)\nTarget: x86_64-apple-darwin17.7.0\nThread model: posix\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\n****************************************************\nMachine type (default): x86_64-apple-darwin17.7.0\nMachine type (mpir): penryn-apple-darwin17.7.0\nBuilding a 64-bit version of MPIR, which is the default.\nBuilding MPIR with the C++ interface and (also) static libraries.\n```\n",
    "created_at": "2019-03-15T12:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382509",
    "user": "https://github.com/dimpase"
}
```

This computation works well with our MPIR on my old OSX Core 2 Duo machine. (Well, built with clang, not with gcc).
That's as old as it goes among CPUs  that I have working.

```
****************************************************
Host system:
Darwin dimas-air.lan 17.7.0 Darwin Kernel Version 17.7.0: Thu Dec 20 21:47:19 PST 2018; root:xnu-4570.71.22~1/RELEASE_X86_64 x86_64
****************************************************
C compiler: clang
C compiler version:
Apple LLVM version 10.0.0 (clang-1000.10.44.4)
Target: x86_64-apple-darwin17.7.0
Thread model: posix
InstalledDir: /Library/Developer/CommandLineTools/usr/bin
****************************************************
Machine type (default): x86_64-apple-darwin17.7.0
Machine type (mpir): penryn-apple-darwin17.7.0
Building a 64-bit version of MPIR, which is the default.
Building MPIR with the C++ interface and (also) static libraries.
```




---

archive/issue_comments_382510.json:
```json
{
    "body": "It's still not clear to me whether the problem is due to CPU architecture or due to the compiler.",
    "created_at": "2019-03-15T12:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382510",
    "user": "https://github.com/jdemeyer"
}
```

It's still not clear to me whether the problem is due to CPU architecture or due to the compiler.



---

archive/issue_comments_382511.json:
```json
{
    "body": "Presumably both, i.e. the optimizer does something wrong on Westmere (or mpir has some hand-written optimization that is used only on Westmere and fails). \n\nWould be useful to check if it works on Nehalem (the previous microarch). Westmere is mainly a die shrink so there are very few new isa extensions (i.e. only AES-NI and PCLMULQDQ according to WP)",
    "created_at": "2019-03-15T15:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382511",
    "user": "https://github.com/vbraun"
}
```

Presumably both, i.e. the optimizer does something wrong on Westmere (or mpir has some hand-written optimization that is used only on Westmere and fails). 

Would be useful to check if it works on Nehalem (the previous microarch). Westmere is mainly a die shrink so there are very few new isa extensions (i.e. only AES-NI and PCLMULQDQ according to WP)



---

archive/issue_comments_382512.json:
```json
{
    "body": "I don't think that this should be a blocker (but I'll let the release manager decide): this bug probably dates back to the last MPIR upgrade (#24085). If a bug is that old and nobody noticed before, then it can't be that serious.",
    "created_at": "2019-03-21T06:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382512",
    "user": "https://github.com/jdemeyer"
}
```

I don't think that this should be a blocker (but I'll let the release manager decide): this bug probably dates back to the last MPIR upgrade (#24085). If a bug is that old and nobody noticed before, then it can't be that serious.



---

archive/issue_comments_382513.json:
```json
{
    "body": "if the bug is related to MPIR, it should be reported upstream.",
    "created_at": "2019-03-21T07:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382513",
    "user": "https://github.com/zimmermann6"
}
```

if the bug is related to MPIR, it should be reported upstream.



---

archive/issue_comments_382514.json:
```json
{
    "body": "Replying to [comment:32 zimmerma]:\n> if the bug is related to MPIR, it should be reported upstream.\n\ngiven that noone here is able to reproduce this bug, it would be great to gather more info from your source: \n\n* what is the info requested in comment:21 in this case ?\n\n* does the error go away if MPIR is replaced by GMP?",
    "created_at": "2019-03-21T11:24:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382514",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:32 zimmerma]:
> if the bug is related to MPIR, it should be reported upstream.

given that noone here is able to reproduce this bug, it would be great to gather more info from your source: 

* what is the info requested in comment:21 in this case ?

* does the error go away if MPIR is replaced by GMP?



---

archive/issue_comments_382515.json:
```json
{
    "body": "Well, some people can reproduce it on some systems. But we don't have sufficient information for now to decide if it's an MPIR or GCC bug.",
    "created_at": "2019-03-21T11:51:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382515",
    "user": "https://github.com/jdemeyer"
}
```

Well, some people can reproduce it on some systems. But we don't have sufficient information for now to decide if it's an MPIR or GCC bug.



---

archive/issue_comments_382516.json:
```json
{
    "body": "Is the best way to reproduce the problem just the example in the ticket description, or has anyone narrowed it down to something simpler?\n\nI could try to build a GCC 4.9.3 and see if I can reproduce the problem.  If so that'd be great, because then I could try a newer (or older) GCC and see if it goes away, and then git-bisect until I narrow down on the issue (assuming it's related to GCC).  But if the bug is CPU-specific that might be harder.",
    "created_at": "2019-03-21T12:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382516",
    "user": "https://github.com/embray"
}
```

Is the best way to reproduce the problem just the example in the ticket description, or has anyone narrowed it down to something simpler?

I could try to build a GCC 4.9.3 and see if I can reproduce the problem.  If so that'd be great, because then I could try a newer (or older) GCC and see if it goes away, and then git-bisect until I narrow down on the issue (assuming it's related to GCC).  But if the bug is CPU-specific that might be harder.



---

archive/issue_comments_382517.json:
```json
{
    "body": "Replying to [comment:35 embray]:\n> Is the best way to reproduce the problem just the example in the ticket description, or has anyone narrowed it down to something simpler?\n\nIt's a division of 2 large integers, that's simple enough to understand.",
    "created_at": "2019-03-21T12:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382517",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:35 embray]:
> Is the best way to reproduce the problem just the example in the ticket description, or has anyone narrowed it down to something simpler?

It's a division of 2 large integers, that's simple enough to understand.



---

archive/issue_comments_382518.json:
```json
{
    "body": "Okay, duh.  I didn't actually read the example closely.",
    "created_at": "2019-03-21T13:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382518",
    "user": "https://github.com/embray"
}
```

Okay, duh.  I didn't actually read the example closely.



---

archive/issue_comments_382519.json:
```json
{
    "body": "I guess, a more useful question is, can it be reproduced just by calling mpz_divexact from a simpler C program without the overhead of Sage?  And can it be reproduced with different values?",
    "created_at": "2019-03-21T13:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382519",
    "user": "https://github.com/embray"
}
```

I guess, a more useful question is, can it be reproduced just by calling mpz_divexact from a simpler C program without the overhead of Sage?  And can it be reproduced with different values?



---

archive/issue_comments_382520.json:
```json
{
    "body": "Replying to [comment:38 embray]:\n> And can it be reproduced with different values?\n\nYes, I checked this some time ago. You can play with the exponents and get the same error for different values. But all crashing examples that I found are pretty large (over 2<sup>600</sup> or so).",
    "created_at": "2019-03-21T13:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382520",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:38 embray]:
> And can it be reproduced with different values?

Yes, I checked this some time ago. You can play with the exponents and get the same error for different values. But all crashing examples that I found are pretty large (over 2<sup>600</sup> or so).



---

archive/issue_comments_382521.json:
```json
{
    "body": "Yes, it can be reproduced easily from C, see attachment.",
    "created_at": "2019-03-21T13:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382521",
    "user": "https://github.com/jdemeyer"
}
```

Yes, it can be reproduced easily from C, see attachment.



---

archive/issue_comments_382522.json:
```json
{
    "body": "Attachment [test.c](tarball://root/attachments/some-uuid/ticket27419/test.c) by @jdemeyer created at 2019-03-21 13:47:50",
    "created_at": "2019-03-21T13:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382522",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [test.c](tarball://root/attachments/some-uuid/ticket27419/test.c) by @jdemeyer created at 2019-03-21 13:47:50



---

archive/issue_comments_382523.json:
```json
{
    "body": "Another interesting data point would be whether the binary compiled on the affected machine works on another machine, or vice versa.\n\nUnless a patch materializes real soon this is not going to be fixed in Sage-8.7 though.",
    "created_at": "2019-03-21T14:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382523",
    "user": "https://github.com/vbraun"
}
```

Another interesting data point would be whether the binary compiled on the affected machine works on another machine, or vice versa.

Unless a patch materializes real soon this is not going to be fixed in Sage-8.7 though.



---

archive/issue_comments_382524.json:
```json
{
    "body": "Changing component from basic arithmetic to packages: standard.",
    "created_at": "2019-03-21T14:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382524",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from basic arithmetic to packages: standard.



---

archive/issue_comments_382525.json:
```json
{
    "body": "Changing priority from blocker to critical.",
    "created_at": "2019-03-21T14:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382525",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from blocker to critical.



---

archive/issue_comments_382526.json:
```json
{
    "body": "Moving all blocker/critical issues from 8.7 to 8.8.",
    "created_at": "2019-03-25T10:41:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382526",
    "user": "https://github.com/embray"
}
```

Moving all blocker/critical issues from 8.7 to 8.8.



---

archive/issue_comments_382527.json:
```json
{
    "body": "Replying to [comment:40 jdemeyer]:\n> Yes, it can be reproduced easily from C, see attachment.\n\nJeroen, please can you give the exact environment where you can reproduce it (processor, operating system, compiler, mpir or gmp, ...)? I tried on a Intel(R) Xeon(R) CPU E7540 with Debian GNU/Linux buster/sid, gcc 8.3.0 (Debian 8.3.0-2) and mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868 (the mpir tarball shipped with Sage 8.6) and was unable to reproduce the error.",
    "created_at": "2019-03-25T15:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382527",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:40 jdemeyer]:
> Yes, it can be reproduced easily from C, see attachment.

Jeroen, please can you give the exact environment where you can reproduce it (processor, operating system, compiler, mpir or gmp, ...)? I tried on a Intel(R) Xeon(R) CPU E7540 with Debian GNU/Linux buster/sid, gcc 8.3.0 (Debian 8.3.0-2) and mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868 (the mpir tarball shipped with Sage 8.6) and was unable to reproduce the error.



---

archive/issue_comments_382528.json:
```json
{
    "body": "Perhaps, per Volker's suggestion, you could also attach a binary of `test.c` exhibiting the issue.",
    "created_at": "2019-03-25T16:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382528",
    "user": "https://github.com/embray"
}
```

Perhaps, per Volker's suggestion, you could also attach a binary of `test.c` exhibiting the issue.



---

archive/issue_comments_382529.json:
```json
{
    "body": "Moving open critical and blocker issues to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382529",
    "user": "https://github.com/embray"
}
```

Moving open critical and blocker issues to the next release milestone (optimistically).



---

archive/issue_comments_382530.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382530",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_382531.json:
```json
{
    "body": "I think this can be closed as outdated. We have switched default MP to `gmp`, and there has not been new information in a while.",
    "created_at": "2021-03-18T22:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382531",
    "user": "https://github.com/mkoeppe"
}
```

I think this can be closed as outdated. We have switched default MP to `gmp`, and there has not been new information in a while.



---

archive/issue_comments_382532.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-18T22:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382532",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_382533.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-03-19T00:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382533",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_382534.json:
```json
{
    "body": "I think so as well. If something else comes up, we can always get a new ticket.",
    "created_at": "2021-03-19T00:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382534",
    "user": "https://github.com/tscrim"
}
```

I think so as well. If something else comes up, we can always get a new ticket.



---

archive/issue_comments_382535.json:
```json
{
    "body": "I still can reproduce the bug with Sage 9.1 on an Intel(R) Core(TM) i5-4590 under Ubuntu.",
    "created_at": "2021-03-19T10:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382535",
    "user": "https://github.com/zimmermann6"
}
```

I still can reproduce the bug with Sage 9.1 on an Intel(R) Core(TM) i5-4590 under Ubuntu.



---

archive/issue_comments_382536.json:
```json
{
    "body": "and the latest version of Sage (9.2) still enables --with-mp=mpir, thus unless the bug has been fixed upstream in mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868.tar.bz2, it is still there.",
    "created_at": "2021-03-19T10:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382536",
    "user": "https://github.com/zimmermann6"
}
```

and the latest version of Sage (9.2) still enables --with-mp=mpir, thus unless the bug has been fixed upstream in mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868.tar.bz2, it is still there.



---

archive/issue_comments_382537.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-03-19T10:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382537",
    "user": "https://github.com/zimmermann6"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_382538.json:
```json
{
    "body": "Well, can you reproduce the bug with 9.3.beta9?",
    "created_at": "2021-03-19T18:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382538",
    "user": "https://github.com/mkoeppe"
}
```

Well, can you reproduce the bug with 9.3.beta9?



---

archive/issue_comments_382539.json:
```json
{
    "body": "Jean-Luc Garambois tells me that the bug still appears with the pre-compiled 9.2 binary on his machine (but if he compiles the 9.2 sources on his machine, it works fine). Thus the bug is still present. I don't have time to try 9.3.beta9, but I can ask Jean-Luc Garambois more details if needed.",
    "created_at": "2021-03-22T11:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382539",
    "user": "https://github.com/zimmermann6"
}
```

Jean-Luc Garambois tells me that the bug still appears with the pre-compiled 9.2 binary on his machine (but if he compiles the 9.2 sources on his machine, it works fine). Thus the bug is still present. I don't have time to try 9.3.beta9, but I can ask Jean-Luc Garambois more details if needed.



---

archive/issue_comments_382540.json:
```json
{
    "body": "the precompiled version that Jean-Luc Garambois used is the 9.2 one for Ubuntu 18.04 on\nhttp://www-ftp.lip6.fr/pub/math/sagemath/linux/64bit/index.html",
    "created_at": "2021-03-22T16:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382540",
    "user": "https://github.com/zimmermann6"
}
```

the precompiled version that Jean-Luc Garambois used is the 9.2 one for Ubuntu 18.04 on
http://www-ftp.lip6.fr/pub/math/sagemath/linux/64bit/index.html



---

archive/issue_comments_382541.json:
```json
{
    "body": "Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage",
    "created_at": "2021-04-02T20:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382541",
    "user": "https://github.com/mkoeppe"
}
```

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage



---

archive/issue_comments_382542.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-10-10T20:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382542",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_382543.json:
```json
{
    "body": "outdated after mpir removal in #32549",
    "created_at": "2021-10-10T20:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382543",
    "user": "https://github.com/mkoeppe"
}
```

outdated after mpir removal in #32549



---

archive/issue_comments_382544.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-11T07:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382544",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_382545.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-10-25T15:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27182#issuecomment-382545",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
