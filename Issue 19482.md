# Issue 19482: Port ATLAS to ppc64le

Issue created by migration from https://trac.sagemath.org/ticket/19719

Original creator: jdemeyer

Original creation time: 2015-12-15 12:07:52

CC:  vbraun jpflori leif dimpase jhpalmieri

ATLAS plainly refuses to build on a `ppc64le` system.


---

Comment by fbissey created at 2015-12-15 20:21:10

You need to update to a more recent ATLAS (3.11.something), upstream worked hard to make it build on power8 relatively recently.


---

Comment by fbissey created at 2015-12-16 01:43:31

From the horse's mouth: http://ehc.ac/p/math-atlas/mailman/message/34330714/


---

Comment by jdemeyer created at 2015-12-16 20:17:40

Thanks for the info, I will check it out.

So far, I managed to build all packages except ATLAS and packages depending on it.


---

Comment by jdemeyer created at 2015-12-17 21:52:10

Can anyone get this branch working? On my Linux Core i7 system, I get

```
./xgmmsearch -p s -f 4
xgmmsearch: /usr/local/src/sage-config/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/blas/gemm/gmmsearch.c:233: FullSrchMUNU: Assertion `mfB > 0
.0' failed.
TIMING BCAST VS SPLAT MVEC WITH: B=(120,120,120) U=(2,4,1)
   BCAST = -nan MFLOP
   SPLAT = -nan MFLOP
VBCAST PROVIDES -nan SPEEDUP
Full search on MUxNU for nb=120, NREG=16, VLEN=4, KVEC=0
   MU= 1, NU= 1, MFLOP=-nan
   MU= 1, NU= 2, MFLOP=-nan
   MU= 1, NU= 3, MFLOP=-nan
   MU= 1, NU= 4, MFLOP=-nan
   MU= 1, NU= 5, MFLOP=-nan
[...]
Makefile:445: recipe for target 'res/snreg' failed
make[6]: *** [res/snreg] Aborted
[...]
ERROR 539 DURING CACHESIZE SEARCH!!.  CHECK INSTALL_LOG/Stage1.log FOR DETAILS.
[...]
```

----
New commits:


---

Comment by fbissey created at 2015-12-17 22:05:22

Haven't tried the branch yet but I have built it from ebuild on my machine. That being said my first attempt failed in the same way at the exact same point.

It got past once I set the ebuild to use threads which would have added `-t -1 -Si omp 0` to the build options. I also had `--use-ifko` enabled, it took ~3h30mn to build on my 12 cores machine.


---

Comment by jdemeyer created at 2015-12-21 09:05:02

Replying to [comment:8 fbissey]:
> Haven't tried the branch yet but I have built it from ebuild on my machine.
Do you know exactly which version that was?


---

Comment by git created at 2015-12-21 09:36:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-21 10:06:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2015-12-21 10:42:17

Replying to [comment:9 jdemeyer]:
> Replying to [comment:8 fbissey]:
> > Haven't tried the branch yet but I have built it from ebuild on my machine.
> Do you know exactly which version that was?
3.11.38 the same one.

How many cores does your machine have?


---

Comment by jdemeyer created at 2015-12-21 10:49:03

Replying to [comment:13 fbissey]:
> How many cores does your machine have?
Depends how you count... there are 24 cores, but it has multi-threading, so ATLAS detects 192 processors.


---

Comment by jdemeyer created at 2015-12-21 11:16:38

ATLAS is finally building now...


---

Comment by git created at 2015-12-21 20:26:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-22 08:41:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2015-12-22 08:54:21

I see that you have meet `scipy`'s use of `lapack` deprecated function https://archives.gentoo.org/gentoo-science/message/e5cb5f1117bc956cd829a667918026f4 and after. The good news is there is already a commit removing them from the unreleased `0.17` https://github.com/scipy/scipy/pull/5518 and it can be otherwise solved by telling `lapack` to build with deprecated functions. According to the Gentoo ebuild after running `configure` you can do 

```
echo "BUILD_DEPRECATED=1" >> src/lapack/reference/make.inc.example
```

in your build directory and it will add back the deprecated functions in `lapack-3.6.0`.
----
New commits:


---

Comment by jdemeyer created at 2015-12-22 09:09:42

Replying to [comment:19 fbissey]:
> I see that you have meet `scipy`'s use of `lapack` deprecated function

I guess you mean _removed_ functions, despite what LAPACK calls them. If they are not built by default, they are de facto removed, not deprecated.

I am going for the easy way out, which is using LAPACK 3.5.0 and SciPy 0.16.1 clean from upstream.


---

Comment by jdemeyer created at 2015-12-22 09:10:26

I any case, I needed to make a new ATLAS tarball, because there were some mistakes with the `ARCHS` directory.


---

Comment by git created at 2015-12-22 09:12:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-12-22 12:54:22

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-12-22 14:56:28

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-12-22 14:56:28

ATLAS works fine on my `x86_64` laptop and the _previous_ version built fine on POWER8. Unfortunately, the latest version of this branch failed on POWER8. I'm trying again to see if this a reproducible problem.


---

Comment by jdemeyer created at 2015-12-23 07:13:37

It succeeded the second time (without changes). I don't know how common this failure is or why it happened, but I do have a working ATLAS now.


---

Comment by fbissey created at 2015-12-23 07:23:16

That's very curious. It is probably a bug in `ATLAS`'s build system that's a bit random. I am somewhat worried about the randomness. I may have to test on more hardware.


---

Comment by jdemeyer created at 2015-12-23 08:11:41

I reported the random build failure at http://sourceforge.net/p/math-atlas/support-requests/1013/


---

Comment by git created at 2015-12-23 08:22:42

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-12-23 08:23:33

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-12-23 08:23:33

Rebased to 7.0.beta0. Volker, can you test this on the buildbot?


---

Comment by vbraun created at 2015-12-23 08:32:32

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2015-12-23 13:58:32

Sage 7.0.beta0 is causing new problems: #19767


---

Comment by vbraun created at 2015-12-23 16:11:53

On Arando it dies with

```
make -f Make.top time
make[4]: Entering directory `/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build'
./xatlbench -dc /home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/bin/INSTALL_LOG -dp 
Error around argument 4 (Out of args)!
USAGE: ./xatlbench [flags]
   -dp <prior benchmark directory>
   -dc <current benchmark directory>
   -f <filename w/o prefix>
   -o <outfile> : default=stdout
make[4]: *** [time] Error 4
make[4]: Leaving directory `/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build'
make[3]: *** [time] Error 2
make[3]: Leaving directory `/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build'
The ATLAS timing data failed to be collected.
```

see http://build.sagedev.org/release/builders/%20%20fast%20Oxford%20arando%20%28Ubuntu%2013.04%20i686%29%20incremental/builds/731/steps/compile/logs/atlas


---

Comment by vbraun created at 2015-12-23 16:18:21

A different failure on http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu14_32s02%20%28Ubuntu%2014.04%2032%20bit%29%20incremental/builds/279/steps/compile/logs/atlas possibly because of

```
/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/blas/gemm/gmmsearch.c:1:0: warning: SSE instruction set disabled, using 387 arithmetics [enabled by default]
 /*
 ^
./xgmmsearch -p s -f 4
ERROR IN COMMAND: make xsammtime_pt mb=120 nb=120 kb=120 mmrout=ATL_samm120_4m_4x4x1.c mu=4 nu=4 ku=1 mvA=1 mvB=1 mvC=0 kmoves=" -DATL_MOVEA -DATL_MOVEB" beta=1 outF="-f res/tmpout.ktim" > /dev/null 2>&1
   PROPOSED FILENAME: res/tmpout.ktim
   GENSTR='make gen_amm pre=s rt=ATL_samm120_4m_4x4x1.c vec=mdim vlen=4 mu=4 nu=4 ku=1 bcast=1'
TIMING BCAST VS SPLAT MVEC WITH: B=(120,120,120) U=(1,4,1)
make[9]: *** [res/snreg] Error 255
make[9]: Leaving directory `/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemm'
make[8]: *** [res/snreg] Error 2
make[8]: Leaving directory `/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/sysinfo'
xsyssum: /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/sysinfo/GetSysSum.c:129: getmmnreg: Assertion `system(fnam) == 0' failed.
```



---

Comment by vbraun created at 2015-12-23 17:08:32

On the Ubuntu 15.10 64-bit machine ATLAS builds but then runs into an assertion in the Sage doctests:

```
sage: import sage.matrix.benchmark as b ## line 724 ##
sage: ts = b.matrix_multiply_GF(100, p=19) ## line 725 ##
assertion K > 2 && K <= 96 failed, line 23 of file /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//src/blas/ammm/ATL_GetRankKInfo.c
```

See http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu1510_64s02%20%28Ubuntu%2015.10%2064%20bit%29%20incremental/builds/12/steps/shell_4/logs/stdio


---

Comment by jdemeyer created at 2015-12-23 18:10:15

Replying to [comment:32 vbraun]:
> On Arando it dies with
> {{{
> make -f Make.top time
> make[4]: Entering directory `/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build'
> ./xatlbench -dc /home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/bin/INSTALL_LOG -dp 
> Error around argument 4 (Out of args)!
> USAGE: ./xatlbench [flags]
>    -dp <prior benchmark directory>
>    -dc <current benchmark directory>
>    -f <filename w/o prefix>
>    -o <outfile> : default=stdout
> make[4]: *** [time] Error 4
> make[4]: Leaving directory `/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build'
> make[3]: *** [time] Error 2
> make[3]: Leaving directory `/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build'
> The ATLAS timing data failed to be collected.
> }}}
> see http://build.sagedev.org/release/builders/%20%20fast%20Oxford%20arando%20%28Ubuntu%2013.04%20i686%29%20incremental/builds/731/steps/compile/logs/atlas

That's not actually considered to be an error (because I made it so).


---

Comment by jdemeyer created at 2015-12-23 20:03:44

Replying to [comment:33 vbraun]:
> A different failure on http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu14_32s02%20%28Ubuntu%2014.04%2032%20bit%29%20incremental/builds/279/steps/compile/logs/atlas possibly because of
> {{{
> /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/blas/gemm/gmmsearch.c:1:0: warning: SSE instruction set disabled, using 387 arithmetics [enabled by default]
>  /*
>  ^
> ./xgmmsearch -p s -f 4
> ERROR IN COMMAND: make xsammtime_pt mb=120 nb=120 kb=120 mmrout=ATL_samm120_4m_4x4x1.c mu=4 nu=4 ku=1 mvA=1 mvB=1 mvC=0 kmoves=" -DATL_MOVEA -DATL_MOVEB" beta=1 outF="-f res/tmpout.ktim" > /dev/null 2>&1
>    PROPOSED FILENAME: res/tmpout.ktim
>    GENSTR='make gen_amm pre=s rt=ATL_samm120_4m_4x4x1.c vec=mdim vlen=4 mu=4 nu=4 ku=1 bcast=1'
> TIMING BCAST VS SPLAT MVEC WITH: B=(120,120,120) U=(1,4,1)
> make[9]: *** [res/snreg] Error 255
> make[9]: Leaving directory `/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemm'
> make[8]: *** [res/snreg] Error 2
> make[8]: Leaving directory `/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/sysinfo'
> xsyssum: /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/sysinfo/GetSysSum.c:129: getmmnreg: Assertion `system(fnam) == 0' failed.
> }}}

For this one, could you try a different GCC version?


---

Comment by jdemeyer created at 2015-12-23 20:06:18

Replying to [comment:34 vbraun]:
> On the Ubuntu 15.10 64-bit machine ATLAS builds but then runs into an assertion in the Sage doctests:
> {{{
> sage: import sage.matrix.benchmark as b ## line 724 ##
> sage: ts = b.matrix_multiply_GF(100, p=19) ## line 725 ##
> assertion K > 2 && K <= 96 failed, line 23 of file /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//src/blas/ammm/ATL_GetRankKInfo.c
> }}}
> See http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu1510_64s02%20%28Ubuntu%2015.10%2064%20bit%29%20incremental/builds/12/steps/shell_4/logs/stdio

Hmm, for this one a traceback would be nice.


---

Comment by vbraun created at 2015-12-23 20:12:53

You do have an account on the AIMS buildbot slaves, right?


---

Comment by jdemeyer created at 2015-12-23 20:18:57

I forgot, but it seems I do.


---

Comment by jdemeyer created at 2015-12-23 22:24:58

On ppc64le, I built this successfully (that's 2 out of 3) on 7.0.beta0 after adding an `LD_LIBRARY_PATH` workaround for #19767.


---

Comment by vbraun created at 2015-12-24 10:56:28

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2015-12-24 11:53:28

On my ppc64le machine, the score is now 2 successful builds out of 4 tries. The last time it failed with:

```
if [ -s "/home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/src/blas/gemv/Make_dmvn" ]; then \
           cd  /home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/src/blas/gemv ; make -j1 -f Make_dmvn killall ; \
           rm -f /home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/src/blas/gemv/Make_dmvn ; \
        fi
./xmvnhgen -p d -F res/dMVNK.sum -d dmvnoutd
xmvnhgen: /home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//include/atlas_genparse.h:239: GetDoubleArr: Assertion `sscanf(str, "%le",
 d+i) == 1' failed.
Makefile:682: recipe for target 'dmvninstall' failed
make[7]: *** [dmvninstall] Aborted
make[7]: Leaving directory '/home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemv'
Makefile:422: recipe for target 'res/dMVNK.sum' failed
make[6]: *** [res/dMVNK.sum] Error 2
make[6]: Leaving directory '/home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemv'
Makefile:334: recipe for target '/home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemv/res/dMVNK.sum' failed
make[5]: *** [/home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemv/res/dMVNK.sum] Error 2
make[5]: Leaving directory '/home/jdemeyer/sage/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/bin'
ERROR 626 DURING MVNTUNE!!.  CHECK INSTALL_LOG/dMVNTUNE.LOG FOR DETAILS.
```


I'm afraid that this new ATLAS is full of random failures...


---

Comment by vbraun created at 2015-12-24 12:11:15

My experience with atlas unstable releases was similar...


---

Comment by jdemeyer created at 2015-12-24 14:34:56

Failed twice more with the same error as [comment:43]. It turns out there is a buffer overflow somewhere because the command line is too long.

Yet another "WTF??? Implementing a build system in C"


---

Comment by vbraun created at 2015-12-24 15:23:52

Yep, I remember fixing buffer overflows in the ATLAS build system before...


---

Comment by jdemeyer created at 2015-12-24 15:31:47

At least it's good to know that it's not a random error.


---

Comment by jdemeyer created at 2015-12-24 16:01:54

It's not a buffer overflow, it is somehow choking on the commas in `-Wl,rpath,...`


---

Comment by git created at 2015-12-25 10:13:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-25 10:16:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-12-26 18:09:03

After fixing the comma issue, I tried twice more to build ATLAS on ppc64le. There was 1 success, 1 failure (the same as the first time). So the score is now 3/5.


---

Comment by git created at 2015-12-26 18:42:23

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-12-27 09:48:43

The buildbot failure on `sagebu1510_64s02` is a random failure.

On `sagebu14_32s02`, I got the same failure as the buildbot.


---

Comment by jdemeyer created at 2015-12-28 10:52:10

The reproducible build problem on `sagebu14_32s02` is fixed by using GCC 4.9.x instead of GCC 4.8.4.

Unfortunately, there are still doctest failures:

```
sage -t --long --warn-long 90.7 src/sage/matrix/matrix_modn_dense_template.pxi
**********************************************************************
File "src/sage/matrix/matrix_modn_dense_template.pxi", line 1037, in sage.matrix.matrix_modn_dense_template.Matrix_modn_dense_template._matrix_times_matrix_
Failed example:
    (MS(0) * A) == 0
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/matrix/matrix_modn_dense_template.pxi", line 1040, in sage.matrix.matrix_modn_dense_template.Matrix_modn_dense_template._matrix_times_matrix_
Failed example:
    (MS(1) * A) == A
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/matrix/matrix_modn_dense_template.pxi", line 1082, in sage.matrix.matrix_modn_dense_template.Matrix_modn_dense_template._matrix_times_matrix_
Failed example:
    (MS(0) * A) == 0
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/matrix/matrix_modn_dense_template.pxi", line 1085, in sage.matrix.matrix_modn_dense_template.Matrix_modn_dense_template._matrix_times_matrix_
Failed example:
    (MS(1) * A) == A
Expected:
    True
Got:
    False
**********************************************************************
```


These are testing that multiplying a matrix over a finite field with the zero or identity matrix work as expected.


---

Comment by git created at 2015-12-30 22:08:34

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jpflori created at 2016-01-07 10:31:37

`@`jeroen: From what you wrote on #19701, I understand there are no doctests failures anymore?


---

Comment by jdemeyer created at 2016-01-07 10:33:19

There are no _reproducible_ doctest failures anymore. However, there seem to be some pexpect problems with GAP which are hard to reproduce and therefore debug.


---

Comment by jpflori created at 2016-01-07 10:40:29

Ok, I saw the GAP issue, I was just wondering about ATLAS, I'm building it right now.


---

Comment by jdemeyer created at 2016-01-08 08:42:02

I also get "Bad exit: 2" sometimes, for example

```
sage -t --long --warn-long 92.8 src/sage/homology/simplicial_complex.py
    Bad exit: 2
**********************************************************************
Tests run before process (pid=88791) failed:
sage: SimplicialComplex([[1], [3, 7]]) ## line 76 ##
[...]
sage: SimplicialComplex([[]]).connected_component() ## line 3119 ##
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 3123 ##
0
sage: S1 = simplicial_complexes.Sphere(1) ## line 3162 ##
sage: S1.fundamental_group() ## line 3163 ##

**********************************************************************
```


See #19845.


---

Comment by jpflori created at 2016-01-12 13:41:57

Replying to [comment:36 jdemeyer]:
> Replying to [comment:33 vbraun]:
> > A different failure on http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu14_32s02%20%28Ubuntu%2014.04%2032%20bit%29%20incremental/builds/279/steps/compile/logs/atlas possibly because of
> > {{{
> > /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/blas/gemm/gmmsearch.c:1:0: warning: SSE instruction set disabled, using 387 arithmetics [enabled by default]
> >  /*
> >  ^
> > ./xgmmsearch -p s -f 4
> > ERROR IN COMMAND: make xsammtime_pt mb=120 nb=120 kb=120 mmrout=ATL_samm120_4m_4x4x1.c mu=4 nu=4 ku=1 mvA=1 mvB=1 mvC=0 kmoves=" -DATL_MOVEA -DATL_MOVEB" beta=1 outF="-f res/tmpout.ktim" > /dev/null 2>&1
> >    PROPOSED FILENAME: res/tmpout.ktim
> >    GENSTR='make gen_amm pre=s rt=ATL_samm120_4m_4x4x1.c vec=mdim vlen=4 mu=4 nu=4 ku=1 bcast=1'
> > TIMING BCAST VS SPLAT MVEC WITH: B=(120,120,120) U=(1,4,1)
> > make[9]: *** [res/snreg] Error 255
> > make[9]: Leaving directory `/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/blas/gemm'
> > make[8]: *** [res/snreg] Error 2
> > make[8]: Leaving directory `/mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/tune/sysinfo'
> > xsyssum: /mnt/highperf/buildbot/slave/sage_git/build/local/var/tmp/sage/build/atlas-3.11.38/src/ATLAS-build/../ATLAS//tune/sysinfo/GetSysSum.c:129: getmmnreg: Assertion `system(fnam) == 0' failed.
> > }}}
> 
> For this one, could you try a different GCC version?
Also got hit by that one on POWER8.
Presumably because of the system GCC 4.9.2.
Fixed by installing Sage's GCC 4.9.3.


---

Comment by git created at 2016-01-13 08:41:36

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by cpernet created at 2016-02-22 13:17:19

In case porting ATLAS to Power8 gets too painfull, I just wanted to remind that in a hopefully not too distant future, OpenBLAS should replace ATLAS (#20096) and OpenBLAS compiles cleanly on Power8.


---

Comment by git created at 2016-02-29 13:23:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2016-03-04 08:41:52

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by leif created at 2016-10-02 13:47:47

Changing keywords from "" to "BLAS, LAPACK, --with-blas".


---

Comment by slelievre created at 2019-01-13 17:13:41

Note: ATLAS 3.11.40 was released on 2018-10-02.

- announcement: https://sourceforge.net/p/math-atlas/mailman/message/36431164/


---

Comment by slelievre created at 2019-01-13 17:20:33

And apparently ATLAS 3.11.41 a couple of days later.

No announcement but listed in the "Developer" folder at

- https://sourceforge.net/projects/math-atlas/files/


---

Comment by embray created at 2019-03-25 10:56:15

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)


---

Comment by embray created at 2019-06-14 14:50:27

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-08-13 14:44:39

Latest as of 2020-08-13 is 3.11.40, released 2018-10-02, see https://github.com/math-atlas/math-atlas/releases

Do we want to make the upgrade, or downgrade atlas to experimental, or remove the spkg altogether?


---

Comment by jhpalmieri created at 2020-08-13 17:51:25

Any way of knowing if anyone uses it with Sage, short of just removing it and see who complains?


---

Comment by jhpalmieri created at 2020-08-13 17:55:48

Oh, also, with the most recent release almost two years old, I don't see any reason for us to put much work into it. So I vote for either downgrading to experimental or removing.


---

Comment by mkoeppe created at 2020-08-13 17:58:03

My preferred approach would be to just remove it. Making it experimental is too complicated.


---

Comment by mkoeppe created at 2020-08-13 18:04:24

But if we remove it, let's still keep the makefile variable `BLAS` (used in the `dependencies`) and configure variable `SAGE_BLAS`, rather than hardcoding openblas. It will make it easier to plug in another BLAS implementation if one comes along, and I also need it for #29387.


---

Comment by mkoeppe created at 2020-08-13 18:13:09

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-08-13 18:13:09

I've opened #30350 (Remove ATLAS).

Let's close the present ticket.


---

Comment by dimpase created at 2020-08-13 18:21:30

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-08-13 18:21:30

ok


---

Comment by chapoton created at 2020-11-18 10:13:23

Resolution: invalid
