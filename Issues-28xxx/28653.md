# Issue 28653: Faster iterator for permutation groups

archive/issues_028416.json:
```json
{
    "body": "The default iterator for permutation group makes use of a strong generating system (when the group is not cyclic). This is expensive and should be avoided for faster code when the group is well known or small. However, as noticed in #28539, the `RecursiveEnumeratedSet` generates elements in a different order in Python 2 and Python 3 and makes it delicate to use.\n\nFor some named permutation groups (symmetric, alternating, dihedral) we implement direct straightforward algorithms.\n\nCC:  @slel\n\nAuthor: Vincent Delecroix\n\nBranch: public/ticket-28653\n\nCommit: 78088d9dffc46835743683937e22f0e438fd871b\n\nIssue created by migration from https://trac.sagemath.org/ticket/28653\n\n",
    "created_at": "2019-10-25T04:16:29Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Faster iterator for permutation groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28653",
    "user": "https://github.com/videlec"
}
```
The default iterator for permutation group makes use of a strong generating system (when the group is not cyclic). This is expensive and should be avoided for faster code when the group is well known or small. However, as noticed in #28539, the `RecursiveEnumeratedSet` generates elements in a different order in Python 2 and Python 3 and makes it delicate to use.

For some named permutation groups (symmetric, alternating, dihedral) we implement direct straightforward algorithms.

CC:  @slel

Author: Vincent Delecroix

Branch: public/ticket-28653

Commit: 78088d9dffc46835743683937e22f0e438fd871b

Issue created by migration from https://trac.sagemath.org/ticket/28653





---

archive/issue_comments_400957.json:
```json
{
    "body": "<a id='comment:2'></a>Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400957",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'></a>Ticket retargeted after milestone closed



---

archive/issue_events_072163.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72163"
}
```



---

archive/issue_events_072164.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72164"
}
```



---

archive/issue_events_072165.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72165"
}
```



---

archive/issue_comments_400958.json:
```json
{
    "body": "<a id='comment:3'></a>Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400958",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_072166.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72166"
}
```



---

archive/issue_events_072167.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72167"
}
```



---

archive/issue_comments_400959.json:
```json
{
    "body": "<a id='comment:5'></a>Different order in Python 2 and Python 3 is no longer be a problem.",
    "created_at": "2020-08-31T20:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400959",
    "user": "https://github.com/slel"
}
```

<a id='comment:5'></a>Different order in Python 2 and Python 3 is no longer be a problem.



---

archive/issue_comments_400960.json:
```json
{
    "body": "<a id='comment:6'></a>voila une premiere tentative naive. Pas bien plus rapide, en fait\n\n---\nNew commits:",
    "created_at": "2020-10-13T17:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400960",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>voila une premiere tentative naive. Pas bien plus rapide, en fait

---
New commits:



---

archive/issue_comments_400961.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-13T18:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400961",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_400962.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-13T20:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400962",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400963.json:
```json
{
    "body": "<a id='comment:9'></a>is this reasonable now ?",
    "created_at": "2020-10-13T20:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400963",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>is this reasonable now ?



---

archive/issue_comments_400964.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2020-10-13T20:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400964",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_400965.json:
```json
{
    "body": "<a id='comment:10'></a>What I thought was to reuse `sage.combinat.permutation_cython.pyx`. But in this module, it was decided to use `unsigned int` whereas `PermutationGroupElement` uses `int`. This is quite unfortunate.\n\nIf you use the swap algorithm from Knuth, it is trivial to make it work for `A_n` since permutations are alternatively even and odd (two neighboring permutations in the iterator differs by a transposition).",
    "created_at": "2020-10-14T06:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400965",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>What I thought was to reuse `sage.combinat.permutation_cython.pyx`. But in this module, it was decided to use `unsigned int` whereas `PermutationGroupElement` uses `int`. This is quite unfortunate.

If you use the swap algorithm from Knuth, it is trivial to make it work for `A_n` since permutations are alternatively even and odd (two neighboring permutations in the iterator differs by a transposition).



---

archive/issue_comments_400966.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-12-06T17:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400966",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_400967.json:
```json
{
    "body": "<a id='comment:11'></a>Voila une nouvelle tentative.",
    "created_at": "2020-12-06T17:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400967",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>Voila une nouvelle tentative.



---

archive/issue_comments_400968.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-12-06T17:24:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400968",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_400969.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-06T19:17:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400970.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-06T19:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400970",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400971.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T07:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400971",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400972.json:
```json
{
    "body": "<a id='comment:17'></a>bon, alors evidemment, ca casse un certain nombre de doctests. Avant de se lancer dans l'etude au cas par cas de ces doctests, je voudrais savoir si le code propos\u00e9 est une bonne id\u00e9e ou pas.\n\nEn particulier, pour les permutations, vaut-il mieux passer par itertools comme je le fait ou bien faire la meme chose que pour les permutations altern\u00e9es ?\n\npeut-etre aussi peut-on utiliser une maniere plus efficace de cr\u00e9er une permutation ?",
    "created_at": "2020-12-07T09:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400972",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>bon, alors evidemment, ca casse un certain nombre de doctests. Avant de se lancer dans l'etude au cas par cas de ces doctests, je voudrais savoir si le code proposé est une bonne idée ou pas.

En particulier, pour les permutations, vaut-il mieux passer par itertools comme je le fait ou bien faire la meme chose que pour les permutations alternées ?

peut-etre aussi peut-on utiliser une maniere plus efficace de créer une permutation ?



---

archive/issue_comments_400973.json:
```json
{
    "body": "<a id='comment:18'></a>Les permutations sont des tableaux d'entiers en C. Voir [This is the Trac macro *comment:10* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:10-macro).",
    "created_at": "2020-12-07T09:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400973",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>Les permutations sont des tableaux d'entiers en C. Voir [This is the Trac macro *comment:10* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:10-macro).



---

archive/issue_comments_400974.json:
```json
{
    "body": "<a id='comment:19'></a>Certes. Mais tu veux dire quoi, exactement ? Qu'il faut r\u00e9-implementer l'algo de Knuth au lieu d'utiliser la version existante, qui ne se passe pas au niveau array ?",
    "created_at": "2020-12-07T09:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400974",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>Certes. Mais tu veux dire quoi, exactement ? Qu'il faut ré-implementer l'algo de Knuth au lieu d'utiliser la version existante, qui ne se passe pas au niveau array ?



---

archive/issue_comments_400975.json:
```json
{
    "body": "<a id='comment:20'></a>Qu'il faut r\u00e9\u00e9crire les fonctions de `sage/combinat/permutation_cython.pyx` de mani\u00e8re \u00e0 ce qu'elles soient aussi utilisables par `PermutationGroupElement`.",
    "created_at": "2020-12-07T17:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400975",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Qu'il faut réécrire les fonctions de `sage/combinat/permutation_cython.pyx` de manière à ce qu'elles soient aussi utilisables par `PermutationGroupElement`.



---

archive/issue_events_072168.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72168"
}
```



---

archive/issue_events_072169.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72169"
}
```



---

archive/issue_comments_400976.json:
```json
{
    "body": "<a id='comment:21'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400976",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_400977.json:
```json
{
    "body": "<a id='comment:22'></a>There are multiple failing tests.",
    "created_at": "2021-04-28T07:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400977",
    "user": "https://github.com/roed314"
}
```

<a id='comment:22'></a>There are multiple failing tests.



---

archive/issue_comments_400978.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-28T07:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400978",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_072170.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72170"
}
```



---

archive/issue_events_072171.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72171"
}
```



---

archive/issue_comments_400979.json:
```json
{
    "body": "<a id='comment:23'></a>Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28653#issuecomment-400979",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_072172.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72172"
}
```



---

archive/issue_events_072173.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72173"
}
```



---

archive/issue_events_072174.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72174"
}
```



---

archive/issue_events_072175.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72175"
}
```



---

archive/issue_events_072176.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72176"
}
```



---

archive/issue_events_072177.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28653",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28653#event-72177"
}
```
