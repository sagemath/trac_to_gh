# Issue 28787: _add_ method for tensors with indices

archive/issues_028550.json:
```json
{
    "body": "One may want to add/contract tensors with indices in the following way : \n \n`T[\"<sup>ijklm_m]+T[\"</sup>mklij_m\"]`\n\nThis entails to implement \n* _get_item_ method \n* _set_item_ method \n* _add_ method\nwhich all keep track of the indices names.\n\n\nAssignee: @LBrunswic\n\nCC:  @egourgoulhon\n\nKeywords: tensor, contraction, symmetries, tensor with indices, manifolds\n\nBranch/Commit: a1b963050be2f849e23d84cb0d74c6c8fcd45009\n\nReviewer: Eric Gourgoulhon, Travis Scrimshaw\n\nAuthor: L\u00e9o Brunswic\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28787\n\n",
    "closed_at": "2020-01-25T17:27:29Z",
    "created_at": "2019-11-22T13:17:25Z",
    "labels": [
        "component: linear algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "_add_ method for tensors with indices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28787",
    "user": "https://github.com/LBrunswic"
}
```
One may want to add/contract tensors with indices in the following way : 
 
`T["<sup>ijklm_m]+T["</sup>mklij_m"]`

This entails to implement 
* _get_item_ method 
* _set_item_ method 
* _add_ method
which all keep track of the indices names.


Assignee: @LBrunswic

CC:  @egourgoulhon

Keywords: tensor, contraction, symmetries, tensor with indices, manifolds

Branch/Commit: a1b963050be2f849e23d84cb0d74c6c8fcd45009

Reviewer: Eric Gourgoulhon, Travis Scrimshaw

Author: LÃ©o Brunswic

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28787





---

archive/issue_comments_429091.json:
```json
{
    "body": "Set assignee to @LBrunswic.",
    "created_at": "2019-11-22T13:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429091",
    "user": "https://github.com/LBrunswic"
}
```

Set assignee to @LBrunswic.



---

archive/issue_comments_429092.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-23T23:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429092",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429093.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-27T21:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429093",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429094.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-28T02:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429094",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429095.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-28T03:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429095",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429096.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-28T14:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429096",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429097.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-11-28T14:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429097",
    "user": "https://github.com/LBrunswic"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_429098.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-28T15:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429098",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429099.json:
```json
{
    "body": "<a id='comment:10'></a>Thanks for providing this functionality! The code looks nice. \nHowever, as revealed by the [patchbot](https://patchbot.sagemath.org/ticket/28787/), there are a few minor issues:\n- running `sage -coverage src/sage/tensor/modules/tensor_with_indices.py` reveals incomplete coverage\n- `SymmetricGroup` is imported but not used\n- there are invalid escape sequences in the lines \n\n```\n            if re.search(\"[()\\[\\]]\",con) is not None:\n                raise ValueError(\"No symmetry allowed\")\n            if re.search(\"[()\\[\\]]\",cov) is not None:\n                raise ValueError(\"No symmetry allowed\")\n```\n  Most probably, you should prefix the string `\"[()\\[\\]]\"` with `r` to make it a raw string. *Side remark:* the error message passed to exceptions should start with a lower case letter; so please change `\"No symmetry allowed\"` to `\"no symmetry allowed\"`\n- Building the documentation via `sage -docbuild reference/tensor_free_modules html` yields some errors, two of them being related to the characters `\\]` and `\\[` above and should be fixed with the `r` prefix",
    "created_at": "2019-12-01T20:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429099",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:10'></a>Thanks for providing this functionality! The code looks nice. 
However, as revealed by the [patchbot](https://patchbot.sagemath.org/ticket/28787/), there are a few minor issues:
- running `sage -coverage src/sage/tensor/modules/tensor_with_indices.py` reveals incomplete coverage
- `SymmetricGroup` is imported but not used
- there are invalid escape sequences in the lines 

```
            if re.search("[()\[\]]",con) is not None:
                raise ValueError("No symmetry allowed")
            if re.search("[()\[\]]",cov) is not None:
                raise ValueError("No symmetry allowed")
```
  Most probably, you should prefix the string `"[()\[\]]"` with `r` to make it a raw string. *Side remark:* the error message passed to exceptions should start with a lower case letter; so please change `"No symmetry allowed"` to `"no symmetry allowed"`
- Building the documentation via `sage -docbuild reference/tensor_free_modules html` yields some errors, two of them being related to the characters `\]` and `\[` above and should be fixed with the `r` prefix



---

archive/issue_comments_429100.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-02T11:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429101.json:
```json
{
    "body": "<a id='comment:12'></a>Thx for the review. I'm sorry, I'm still familiarizing myself with the tools involved in the review process.",
    "created_at": "2019-12-02T11:54:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429101",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:12'></a>Thx for the review. I'm sorry, I'm still familiarizing myself with the tools involved in the review process.



---

archive/issue_comments_429102.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 gh-LBrunswic]:\n> Thx for the review. I'm sorry, I'm still familiarizing myself with the tools involved in the review process.\n\nNo problem. I fully understand this of course. To get access to the patchbot reports, click on the button with the Sage version in the top right of the ticket description panel.",
    "created_at": "2019-12-02T13:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429102",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:13'></a>Replying to [comment:12 gh-LBrunswic]:
> Thx for the review. I'm sorry, I'm still familiarizing myself with the tools involved in the review process.

No problem. I fully understand this of course. To get access to the patchbot reports, click on the button with the Sage version in the top right of the ticket description panel.



---

archive/issue_comments_429103.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-02T13:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429104.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-02T14:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429105.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-02T20:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429106.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-03T14:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429107.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-03T14:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429108.json:
```json
{
    "body": "<a id='comment:19'></a>Sometime the plugin is wrong:\n\n```\n-    EXAMPLES:\n+    EXAMPLES::\n```\nwas a wrong move, because this is not followed by doctests, but by more text..",
    "created_at": "2019-12-03T20:36:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429108",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>Sometime the plugin is wrong:

```
-    EXAMPLES:
+    EXAMPLES::
```
was a wrong move, because this is not followed by doctests, but by more text..



---

archive/issue_comments_429109.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-04T11:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429109",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_429110.json:
```json
{
    "body": "<a id='comment:20'></a>I've performed some corrections to the docstrings, including that mentioned by Fr\u00e9d\u00e9ric (comment:19). Now the documentation should build successfully. Note that some of the changes are mere deletions of white space characters on empty lines or at the end of lines (you should configure your editor to do that automatically when saving the file to disk). \n\nThe documentation of the new functionalities added by this ticket does not appear in the html output (i.e. in `local/share/doc/sage/html/en/reference/tensor_free_modules/sage/tensor/modules/tensor_with_indices.html`) because the doc of underscored methods, such as `__add__`, is not generated. You should therefore add relevant examples in the main docstring of `TensorWithIndices`. \n\n---\nNew commits:",
    "created_at": "2019-12-04T11:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429110",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:20'></a>I've performed some corrections to the docstrings, including that mentioned by FrÃ©dÃ©ric (comment:19). Now the documentation should build successfully. Note that some of the changes are mere deletions of white space characters on empty lines or at the end of lines (you should configure your editor to do that automatically when saving the file to disk). 

The documentation of the new functionalities added by this ticket does not appear in the html output (i.e. in `local/share/doc/sage/html/en/reference/tensor_free_modules/sage/tensor/modules/tensor_with_indices.html`) because the doc of underscored methods, such as `__add__`, is not generated. You should therefore add relevant examples in the main docstring of `TensorWithIndices`. 

---
New commits:



---

archive/issue_comments_429111.json:
```json
{
    "body": "<a id='comment:21'></a>PS: to see my changes, simply click on the blue `8fcd437` above.",
    "created_at": "2019-12-04T11:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429111",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:21'></a>PS: to see my changes, simply click on the blue `8fcd437` above.



---

archive/issue_comments_429112.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-12-04T11:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429112",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_429113.json:
```json
{
    "body": "<a id='comment:22'></a>Setting the ticket back to needs_review for the patchbot to run on it.",
    "created_at": "2019-12-04T11:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429113",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:22'></a>Setting the ticket back to needs_review for the patchbot to run on it.



---

archive/issue_comments_429114.json:
```json
{
    "body": "<a id='comment:23'></a>Thanks a lot, I  spent an unreasonable amount of time yesterday trying to understand what was the problem. \n\nI will consider putting some time into patchbot to see how one could improve on this. Trying to understand the issue I've already read some of the code of patchbot.",
    "created_at": "2019-12-04T11:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429114",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:23'></a>Thanks a lot, I  spent an unreasonable amount of time yesterday trying to understand what was the problem. 

I will consider putting some time into patchbot to see how one could improve on this. Trying to understand the issue I've already read some of the code of patchbot.



---

archive/issue_comments_429115.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [comment:23 gh-LBrunswic]:\n> Thanks a lot, I  spent an unreasonable amount of time yesterday trying to understand what was the problem. \n\n\nThe worst part being that I was actually able to build sagemath with the doc without errors. Only patchbot was raising errors...\n\n> I will consider putting some time into patchbot to see how one could improve on this. Trying to understand the issue I've already read some of the code of patchbot.",
    "created_at": "2019-12-04T11:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429115",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:24'></a>Replying to [comment:23 gh-LBrunswic]:
> Thanks a lot, I  spent an unreasonable amount of time yesterday trying to understand what was the problem. 


The worst part being that I was actually able to build sagemath with the doc without errors. Only patchbot was raising errors...

> I will consider putting some time into patchbot to see how one could improve on this. Trying to understand the issue I've already read some of the code of patchbot.



---

archive/issue_comments_429116.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 gh-LBrunswic]:\n> Replying to [comment:23 gh-LBrunswic]:\n> > Thanks a lot, I  spent an unreasonable amount of time yesterday trying to understand what was the problem. \n\n> \n> The worst part being that I was actually able to build sagemath with the doc without errors. Only patchbot was raising errors...\n\n\nActually, the patchbot reports are to be taken with a grain of salt. A human eye has always to take a look. Apart from the `EXAMPLE:` case pointed by Fr\u00e9d\u00e9ric (maybe in that case the patchbot error was triggered by `EXAMPLE:` not being followed by an empty line), another case is some spurious report of unused import (see e.g. [this example](https://trac.sagemath.org/ticket/27865#comment:13)).\n\n\n> > I will consider putting some time into patchbot to see how one could improve on this.\n\n\nThanks!",
    "created_at": "2019-12-04T12:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429116",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:25'></a>Replying to [comment:24 gh-LBrunswic]:
> Replying to [comment:23 gh-LBrunswic]:
> > Thanks a lot, I  spent an unreasonable amount of time yesterday trying to understand what was the problem. 

> 
> The worst part being that I was actually able to build sagemath with the doc without errors. Only patchbot was raising errors...


Actually, the patchbot reports are to be taken with a grain of salt. A human eye has always to take a look. Apart from the `EXAMPLE:` case pointed by FrÃ©dÃ©ric (maybe in that case the patchbot error was triggered by `EXAMPLE:` not being followed by an empty line), another case is some spurious report of unused import (see e.g. [this example](https://trac.sagemath.org/ticket/27865#comment:13)).


> > I will consider putting some time into patchbot to see how one could improve on this.


Thanks!



---

archive/issue_comments_429117.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-04T19:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429117",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429118.json:
```json
{
    "body": "<a id='comment:27'></a>Doctest lines after TESTS:: should be indented, as for EXAMPLES::\n\n```\n+        TESTS::\n+\n+        sage: from sage.tensor.modules.tensor_with_indices import TensorWithIndices\n+        sage: TensorWithIndices._parse_indices('([..])')  # nested symmetries\n+        Traceback (most recent call last):\n```\n\nThe patchbot plugins are not smart, but there is no simple way to make them smarter. When they give a red light, you should judge by yourself if there is an error or not.",
    "created_at": "2019-12-04T19:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429118",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>Doctest lines after TESTS:: should be indented, as for EXAMPLES::

```
+        TESTS::
+
+        sage: from sage.tensor.modules.tensor_with_indices import TensorWithIndices
+        sage: TensorWithIndices._parse_indices('([..])')  # nested symmetries
+        Traceback (most recent call last):
```

The patchbot plugins are not smart, but there is no simple way to make them smarter. When they give a red light, you should judge by yourself if there is an error or not.



---

archive/issue_comments_429119.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-04T19:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429119",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429120.json:
```json
{
    "body": "<a id='comment:29'></a>I'm not critisizing the work that has been put in the patchbot and I realize the work there is more than simply changing a few regex.\nOn the contrary, I do appreciate the work that has been put into the review process of sagemath, which includes the patchbot. I feel that improving on the process (and the documentation) is improving sagemath on the long run.",
    "created_at": "2019-12-04T20:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429120",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:29'></a>I'm not critisizing the work that has been put in the patchbot and I realize the work there is more than simply changing a few regex.
On the contrary, I do appreciate the work that has been put into the review process of sagemath, which includes the patchbot. I feel that improving on the process (and the documentation) is improving sagemath on the long run.



---

archive/issue_comments_429121.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-04T20:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429121",
    "user": "https://github.com/LBrunswic"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_429122.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-04T21:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429123.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-12-04T21:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429123",
    "user": "https://github.com/LBrunswic"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_429124.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-05T00:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429124",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429125.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-05T00:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429125",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429126.json:
```json
{
    "body": "<a id='comment:35'></a>typo \"Decompostion\"",
    "created_at": "2019-12-05T12:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429126",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:35'></a>typo "Decompostion"



---

archive/issue_comments_429127.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-05T14:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429127",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429128.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-06T10:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429128",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429129.json:
```json
{
    "body": "<a id='comment:38'></a>I've just pushed a new commit, with very minor tweaks (mostly indentation in `_parse_indices()` docstring). \n\nA last point: could you please document further the argument `permutation` of the method ` permute_indices()`, in particular stating in which format it is expected, possibly providing more examples?",
    "created_at": "2019-12-06T10:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429129",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:38'></a>I've just pushed a new commit, with very minor tweaks (mostly indentation in `_parse_indices()` docstring). 

A last point: could you please document further the argument `permutation` of the method ` permute_indices()`, in particular stating in which format it is expected, possibly providing more examples?



---

archive/issue_comments_429130.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-07T01:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429130",
    "user": "https://github.com/LBrunswic"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_429131.json:
```json
{
    "body": "<a id='comment:39'></a>I then will add some overloading to accept a permutation given by an element of a symmetric group. This seems natural.",
    "created_at": "2019-12-07T01:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429131",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:39'></a>I then will add some overloading to accept a permutation given by an element of a symmetric group. This seems natural.



---

archive/issue_comments_429132.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:39 gh-LBrunswic]:\n> I then will add some overloading to accept a permutation given by an element of a symmetric group. This seems natural.\n\n\nI was not asking that much, but simply that you document `permutation` in the `INPUT` section by something like \"tuple/list of index positions describing the permutation...\". But I agree it is quite natural to pass an element of a symmetric group as well.",
    "created_at": "2019-12-07T08:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429132",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:40'></a>Replying to [comment:39 gh-LBrunswic]:
> I then will add some overloading to accept a permutation given by an element of a symmetric group. This seems natural.


I was not asking that much, but simply that you document `permutation` in the `INPUT` section by something like "tuple/list of index positions describing the permutation...". But I agree it is quite natural to pass an element of a symmetric group as well.



---

archive/issue_comments_429133.json:
```json
{
    "body": "<a id='comment:41'></a>I struggled with adding more general permutation for several reasons : \n* The word problem is only implemented for permutation group acting on [1,...,n] while we more commonly use 0-indexed notations. Therefore, one would need to translate a permutation acting on [0,...,n-1] into a permutation acting on [1,...,n]. While this is not difficult, it seems particularly unnatural : such conversion should be done in the Permutation group module.  \n\n* The overloading would depends on the overloading of PermutationGroupElement \n\nTherefore, I think it's better to postpone this supplementaty functionality.",
    "created_at": "2019-12-19T10:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429133",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:41'></a>I struggled with adding more general permutation for several reasons : 
* The word problem is only implemented for permutation group acting on [1,...,n] while we more commonly use 0-indexed notations. Therefore, one would need to translate a permutation acting on [0,...,n-1] into a permutation acting on [1,...,n]. While this is not difficult, it seems particularly unnatural : such conversion should be done in the Permutation group module.  

* The overloading would depends on the overloading of PermutationGroupElement 

Therefore, I think it's better to postpone this supplementaty functionality.



---

archive/issue_comments_429134.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-19T10:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429134",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429135.json:
```json
{
    "body": "<a id='comment:43'></a>Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429135",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>Ticket retargeted after milestone closed



---

archive/issue_events_072720.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28787#event-72720"
}
```



---

archive/issue_comments_429136.json:
```json
{
    "body": "<a id='comment:44'></a>May I ask about the status of this ticket? Is it again ready for review?",
    "created_at": "2020-01-12T09:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429136",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:44'></a>May I ask about the status of this ticket? Is it again ready for review?



---

archive/issue_comments_429137.json:
```json
{
    "body": "<a id='comment:45'></a>I haven't taken the time rework on it since the holydays (and the launch of sage9). I have to go through it again.",
    "created_at": "2020-01-13T09:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429137",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:45'></a>I haven't taken the time rework on it since the holydays (and the launch of sage9). I have to go through it again.



---

archive/issue_comments_429138.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-13T09:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429138",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429139.json:
```json
{
    "body": "<a id='comment:47'></a>It seems okay to me, I thought I had asked for review after my previous commit.",
    "created_at": "2020-01-13T09:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429139",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:47'></a>It seems okay to me, I thought I had asked for review after my previous commit.



---

archive/issue_comments_429140.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-13T09:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429140",
    "user": "https://github.com/LBrunswic"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_429141.json:
```json
{
    "body": "<a id='comment:49'></a>It looks good to me, except that the patchbot \"blocks\" plugin reports this [error](https://patchbot.sagemath.org/log/28787/Linux/1_SMP_Thu_Nov_14_17:32:43_UTC_2019/x86_64/4.14.152-127.182.amzn2.x86_64/unizaramazon2a/2020-01-13%2013:43:00?plugin=blocks&diff=/log/0/Linux/1_SMP_Thu_Nov_14_17%3A32%3A43_UTC_2019/x86_64/4.14.152-127.182.amzn2.x86_64/unizaramazon2a/2020-01-10%2003%3A55%3A52&ticket=28787&base=9.1.beta0). \nThis plugin forbids \"Returns\" at the start of a new line, see rule no. 6 in line 581 of the [plugin source code](https://github.com/sagemath/sage-patchbot/blob/master/sage_patchbot/plugins.py). This is because, according to [PEP 257](https://www.python.org/dev/peps/pep-0257/), *\"The docstring is a phrase ending in a period. It prescribes the function or method's effect as a command (\"Do this\", \"Return that\"), not as a description; e.g. don't write \"Returns the pathname ...\"*. So the doctstring of the method `_parse_indices` should start with \"Parse\", not \"Parses\", etc. Could you fix this please?",
    "created_at": "2020-01-13T21:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429141",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:49'></a>It looks good to me, except that the patchbot "blocks" plugin reports this [error](https://patchbot.sagemath.org/log/28787/Linux/1_SMP_Thu_Nov_14_17:32:43_UTC_2019/x86_64/4.14.152-127.182.amzn2.x86_64/unizaramazon2a/2020-01-13%2013:43:00?plugin=blocks&diff=/log/0/Linux/1_SMP_Thu_Nov_14_17%3A32%3A43_UTC_2019/x86_64/4.14.152-127.182.amzn2.x86_64/unizaramazon2a/2020-01-10%2003%3A55%3A52&ticket=28787&base=9.1.beta0). 
This plugin forbids "Returns" at the start of a new line, see rule no. 6 in line 581 of the [plugin source code](https://github.com/sagemath/sage-patchbot/blob/master/sage_patchbot/plugins.py). This is because, according to [PEP 257](https://www.python.org/dev/peps/pep-0257/), *"The docstring is a phrase ending in a period. It prescribes the function or method's effect as a command ("Do this", "Return that"), not as a description; e.g. don't write "Returns the pathname ..."*. So the doctstring of the method `_parse_indices` should start with "Parse", not "Parses", etc. Could you fix this please?



---

archive/issue_comments_429142.json:
```json
{
    "body": "<a id='comment:50'></a>This is likely a doc problem:\n\n```diff\n         - ``permutation`` -- permutation that has to be applied to the indices\n-            the input should be a ``list`` containing the second line of the permutation\n-            in Cauchy notation.\n+          the input should be a ``list`` containing the second line of the permutation\n+          in Cauchy notation\n```",
    "created_at": "2020-01-14T16:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429142",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:50'></a>This is likely a doc problem:

```diff
         - ``permutation`` -- permutation that has to be applied to the indices
-            the input should be a ``list`` containing the second line of the permutation
-            in Cauchy notation.
+          the input should be a ``list`` containing the second line of the permutation
+          in Cauchy notation
```



---

archive/issue_comments_429143.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-15T22:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429143",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429144.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-15T22:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429144",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429145.json:
```json
{
    "body": "<a id='comment:53'></a>Thanks for the changes. The (relevant) patchbot in now all green.\n\nThanks for this nice enhancement!",
    "created_at": "2020-01-17T20:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429145",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:53'></a>Thanks for the changes. The (relevant) patchbot in now all green.

Thanks for this nice enhancement!



---

archive/issue_comments_429146.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-17T20:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429146",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_429147.json:
```json
{
    "body": "<a id='comment:54'></a>Thanks! I understand the importance of the constraints on the docstrings but it's plainful to get blocked for a whitespace.",
    "created_at": "2020-01-17T21:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429147",
    "user": "https://github.com/LBrunswic"
}
```

<a id='comment:54'></a>Thanks! I understand the importance of the constraints on the docstrings but it's plainful to get blocked for a whitespace.



---

archive/issue_comments_429148.json:
```json
{
    "body": "<a id='comment:55'></a>On Python 2:\n\n```\n[dochtml]   File \"/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/tensor/modules/tensor_with_indices.py\", line 941\n[dochtml]     [swap(*param, self._tensor.tensor_rank()) for param in swap_params],\n[dochtml] SyntaxError: only named arguments may follow *expression\n```",
    "created_at": "2020-01-19T20:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429148",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:55'></a>On Python 2:

```
[dochtml]   File "/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/tensor/modules/tensor_with_indices.py", line 941
[dochtml]     [swap(*param, self._tensor.tensor_rank()) for param in swap_params],
[dochtml] SyntaxError: only named arguments may follow *expression
```



---

archive/issue_comments_429149.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-01-19T20:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429149",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_429150.json:
```json
{
    "body": "<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-19T22:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429150",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429151.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-20T00:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429151",
    "user": "https://github.com/LBrunswic"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_429152.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-20T03:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429152",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_072721.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-25T17:27:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28787#event-72721"
}
```



---

archive/issue_comments_429153.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-25T17:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28787#issuecomment-429153",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
