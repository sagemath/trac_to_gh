# Issue 28554: Scalar Field Restrictions

archive/issues_028317.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nHow is a scalar field implemented which is piecewisely defined with different expressions in one particular chart?\n\nTake for instance a scalar field `f` on the real line with standard \"top\" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using\n\n```\nf = M.scalar_field( unit_step(x + 1)*unit_step(1 - x)*(1 - abs(x)) )\n```\n(see [#28519 comment:46](https://github.com/sagemath/sage/issues/28519#comment:46)).\n\nThis solution is quite unhandy and becomes even more so for more complicated scalar fields.\n\nThis ticket is part of the metaticket #28519.\n\n**This ticket includes:**\n\n- `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)\n- `set_restriction` method added smilar to tensor fields\n\nCC:  @tscrim @egourgoulhon\n\nComponent: **geometry**\n\nKeywords: **scalar fields**\n\nAuthor: **Michael Jung**\n\nBranch/Commit: **[`a126d91`](https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737)**\n\nReviewer: **Eric Gourgoulhon**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28554_\n\n",
    "closed_at": "2019-10-29T23:41:59Z",
    "created_at": "2019-10-03T17:40:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/c%3A%20manifolds"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Scalar Field Restrictions",
    "type": "issue",
    "updated_at": "2019-10-29T23:41:59Z",
    "url": "https://github.com/sagemath/sage/issues/28554",
    "user": "https://github.com/DeRhamSource"
}
```
<div id="comment:0"></div>

How is a scalar field implemented which is piecewisely defined with different expressions in one particular chart?

Take for instance a scalar field `f` on the real line with standard "top" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using

```
f = M.scalar_field( unit_step(x + 1)*unit_step(1 - x)*(1 - abs(x)) )
```
(see [#28519 comment:46](https://github.com/sagemath/sage/issues/28519#comment:46)).

This solution is quite unhandy and becomes even more so for more complicated scalar fields.

This ticket is part of the metaticket #28519.

**This ticket includes:**

- `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)
- `set_restriction` method added smilar to tensor fields

CC:  @tscrim @egourgoulhon

Component: **geometry**

Keywords: **scalar fields**

Author: **Michael Jung**

Branch/Commit: **[`a126d91`](https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737)**

Reviewer: **Eric Gourgoulhon**

_Issue created by migration from https://trac.sagemath.org/ticket/28554_





---

archive/issue_events_388973.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-03T17:40:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388973"
}
```



---

archive/issue_events_388974.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-03T17:40:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388974"
}
```



---

archive/issue_events_388975.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-03T17:40:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388975"
}
```



---

archive/issue_events_388976.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-03T17:40:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388976"
}
```



---

archive/issue_events_388977.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-03T17:40:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20manifolds",
    "label_color": "0000ff",
    "label_name": "c: manifolds",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388977"
}
```



---

archive/issue_comments_445089.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nEric, in the ticket mentioned above, I suggested to display all *known* expressions (on the greatest domain) and compute new expressions only if a particular chart is stated. It seems, there is no big difference to the previous code then, and the additional computation time might be negligible. What do you say? Is this a good compromise for you? Moreover, this approach seems to be the easiest one.\n\nOr one implements an additional flag `display_all` for which the user is aware of additional computation time when using it?\n\nHowever, do you have an example for me with much computation time to test my current algorithm how long it takes? Then, I can compare computation times. I have a feeling that the current algorithm is not that much slower than before because it starts from the top charts -- what happens anyway and, I guess, it only makes a significant difference if the scalar field is picewisely defined.",
    "created_at": "2019-10-04T09:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445089",
    "user": "https://github.com/DeRhamSource"
}
```

<div id="comment:1" align="right">comment:1</div>

Eric, in the ticket mentioned above, I suggested to display all *known* expressions (on the greatest domain) and compute new expressions only if a particular chart is stated. It seems, there is no big difference to the previous code then, and the additional computation time might be negligible. What do you say? Is this a good compromise for you? Moreover, this approach seems to be the easiest one.

Or one implements an additional flag `display_all` for which the user is aware of additional computation time when using it?

However, do you have an example for me with much computation time to test my current algorithm how long it takes? Then, I can compare computation times. I have a feeling that the current algorithm is not that much slower than before because it starts from the top charts -- what happens anyway and, I guess, it only makes a significant difference if the scalar field is picewisely defined.



---

archive/issue_comments_445090.json:
```json
{
    "body": "Branch: **[u/gh-DeRhamSource/scalar_field_restrictions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/scalar_field_restrictions)**",
    "created_at": "2019-10-04T18:37:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445090",
    "user": "https://github.com/DeRhamSource"
}
```

Branch: **[u/gh-DeRhamSource/scalar_field_restrictions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/scalar_field_restrictions)**



---

archive/issue_comments_445091.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,20 @@\n \n This solution is quite unhandy and becomes even more so for more complicated scalar fields.\n \n-In this ticket, I try to solve this issue by adding a `set_restriction` method (similar to tensor fields) and modifying the `display` method.\n+How is a scalar field implemented which is split into different expressions in one particular chart?\n+\n+Take for instance a scalar field `f` on the real line with standard \"top\" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using\n+\n+```\n+f = M.scalar_field( unit_step(x + 1)*unit_step(1 - x)*(1 - abs(x)) )\n+```\n+(see [#28519 comment:46](https://github.com/sagemath/sage/issues/28519#comment:46)).\n+\n+This solution is quite unhandy and becomes even more so for more complicated scalar fields.\n+\n+**This ticket includes:**\n+\n+- modification of namings after algebraic operations, such as `f*g` (`f \\cdot g` for LaTeX code), `f/g` and `f+g`\n+- `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)\n+- `set_restriction` method added smilar to tensor fields\n+- `_is_zero` attribute copied for a copy\n``````\n",
    "created_at": "2019-10-04T18:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445091",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,20 @@
 
 This solution is quite unhandy and becomes even more so for more complicated scalar fields.
 
-In this ticket, I try to solve this issue by adding a `set_restriction` method (similar to tensor fields) and modifying the `display` method.
+How is a scalar field implemented which is split into different expressions in one particular chart?
+
+Take for instance a scalar field `f` on the real line with standard "top" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using
+
+```
+f = M.scalar_field( unit_step(x + 1)*unit_step(1 - x)*(1 - abs(x)) )
+```
+(see [#28519 comment:46](https://github.com/sagemath/sage/issues/28519#comment:46)).
+
+This solution is quite unhandy and becomes even more so for more complicated scalar fields.
+
+**This ticket includes:**
+
+- modification of namings after algebraic operations, such as `f*g` (`f \cdot g` for LaTeX code), `f/g` and `f+g`
+- `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)
+- `set_restriction` method added smilar to tensor fields
+- `_is_zero` attribute copied for a copy
``````




---

archive/issue_comments_445092.json:
```json
{
    "body": "Commit: **[`0c645ca`](https://github.com/sagemath/sagetrac-mirror/commit/0c645ca987eb13c63cfc7841aac1c4d320eec253)**",
    "created_at": "2019-10-04T18:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445092",
    "user": "https://github.com/DeRhamSource"
}
```

Commit: **[`0c645ca`](https://github.com/sagemath/sagetrac-mirror/commit/0c645ca987eb13c63cfc7841aac1c4d320eec253)**



---

archive/issue_comments_445093.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c645ca987eb13c63cfc7841aac1c4d320eec253\"><code>0c645ca</code></a></td><td><code>'set_restriction' added + 'display' modified + naming modified</code></td></tr></table>\n",
    "created_at": "2019-10-04T18:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445093",
    "user": "https://github.com/DeRhamSource"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c645ca987eb13c63cfc7841aac1c4d320eec253"><code>0c645ca</code></a></td><td><code>'set_restriction' added + 'display' modified + naming modified</code></td></tr></table>




---

archive/issue_comments_445094.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,15 +1,4 @@\n-How is a scalar field implemented which is split into different expressions in one particular chart?\n-\n-Take for instance a scalar field `f` on the real line with standard \"top\" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using\n-\n-```\n-f = M.scalar_field( unit_step(x + 1)*unit_step(1 - x)*(1 - abs(x)) )\n-```\n-(see [#28519 comment:46](https://github.com/sagemath/sage/issues/28519#comment:46)).\n-\n-This solution is quite unhandy and becomes even more so for more complicated scalar fields.\n-\n-How is a scalar field implemented which is split into different expressions in one particular chart?\n+How is a scalar field implemented which is piecewisely defined with different expressions in one particular chart?\n \n Take for instance a scalar field `f` on the real line with standard \"top\" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using\n \n``````\n",
    "created_at": "2019-10-04T18:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445094",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,15 +1,4 @@
-How is a scalar field implemented which is split into different expressions in one particular chart?
-
-Take for instance a scalar field `f` on the real line with standard "top" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using
-
-```
-f = M.scalar_field( unit_step(x + 1)*unit_step(1 - x)*(1 - abs(x)) )
-```
-(see [#28519 comment:46](https://github.com/sagemath/sage/issues/28519#comment:46)).
-
-This solution is quite unhandy and becomes even more so for more complicated scalar fields.
-
-How is a scalar field implemented which is split into different expressions in one particular chart?
+How is a scalar field implemented which is piecewisely defined with different expressions in one particular chart?
 
 Take for instance a scalar field `f` on the real line with standard "top" chart `x`, defined via `f(x)=0 for x<-1`, `f(x)=x+1 for -1<=x<0`, `f(x)=1-x for 0<=x<1` and `f(x)=0 for x>=1`. Currently, this is solved by using
 
``````




---

archive/issue_comments_445095.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI compared computation times.\n\n**Before:**\n\n\n```\n...$ ./sage -t src/sage/manifolds/scalarfield.py \ntoo few successful tests, not using stored timings\nRunning doctests with ID 2019-10-04-19-03-38-e810720b.\nGit branch: scalar_field_restrictions\nUsing --optional=build,dochtml,memlimit,python2,sage\nDoctesting 1 file.\nsage -t src/sage/manifolds/scalarfield.py\n    [715 tests, 31.77 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 32.0 seconds\n    cpu time: 33.2 seconds\n    cumulative wall time: 31.8 seconds\n```\n\n**With this ticket:**\n\n```\n...$ ./sage -t src/sage/manifolds/scalarfield.py\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2019-10-04-20-45-12-df0ec794.\nGit branch: scalar_field_restrictions\nUsing --optional=build,dochtml,memlimit,python2,sage\nDoctesting 1 file.\nsage -t src/sage/manifolds/scalarfield.py\n    [735 tests, 34.59 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 34.8 seconds\n    cpu time: 35.9 seconds\n    cumulative wall time: 34.6 seconds\n```\n\nWhat do you say?",
    "created_at": "2019-10-04T18:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445095",
    "user": "https://github.com/DeRhamSource"
}
```

<div id="comment:5" align="right">comment:5</div>

I compared computation times.

**Before:**


```
...$ ./sage -t src/sage/manifolds/scalarfield.py 
too few successful tests, not using stored timings
Running doctests with ID 2019-10-04-19-03-38-e810720b.
Git branch: scalar_field_restrictions
Using --optional=build,dochtml,memlimit,python2,sage
Doctesting 1 file.
sage -t src/sage/manifolds/scalarfield.py
    [715 tests, 31.77 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 32.0 seconds
    cpu time: 33.2 seconds
    cumulative wall time: 31.8 seconds
```

**With this ticket:**

```
...$ ./sage -t src/sage/manifolds/scalarfield.py
too few successful tests, not using stored timings
Running doctests with ID 2019-10-04-20-45-12-df0ec794.
Git branch: scalar_field_restrictions
Using --optional=build,dochtml,memlimit,python2,sage
Doctesting 1 file.
sage -t src/sage/manifolds/scalarfield.py
    [735 tests, 34.59 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 34.8 seconds
    cpu time: 35.9 seconds
    cumulative wall time: 34.6 seconds
```

What do you say?



---

archive/issue_comments_445096.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b85f6ec46f9878c48ed4d8843123b46b844cb252\"><code>b85f6ec</code></a></td><td><code>Typos fixed</code></td></tr></table>\n",
    "created_at": "2019-10-04T19:03:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445096",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b85f6ec46f9878c48ed4d8843123b46b844cb252"><code>b85f6ec</code></a></td><td><code>Typos fixed</code></td></tr></table>




---

archive/issue_comments_445097.json:
```json
{
    "body": "Changed commit from **[`0c645ca`](https://github.com/sagemath/sagetrac-mirror/commit/0c645ca987eb13c63cfc7841aac1c4d320eec253)** to **[`b85f6ec`](https://github.com/sagemath/sagetrac-mirror/commit/b85f6ec46f9878c48ed4d8843123b46b844cb252)**",
    "created_at": "2019-10-04T19:03:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445097",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0c645ca`](https://github.com/sagemath/sagetrac-mirror/commit/0c645ca987eb13c63cfc7841aac1c4d320eec253)** to **[`b85f6ec`](https://github.com/sagemath/sagetrac-mirror/commit/b85f6ec46f9878c48ed4d8843123b46b844cb252)**



---

archive/issue_comments_445098.json:
```json
{
    "body": "Changed commit from **[`b85f6ec`](https://github.com/sagemath/sagetrac-mirror/commit/b85f6ec46f9878c48ed4d8843123b46b844cb252)** to **[`1d68a1f`](https://github.com/sagemath/sagetrac-mirror/commit/1d68a1f83e9fbb0135077e5e0ec60be0f5beb141)**",
    "created_at": "2019-10-06T13:23:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445098",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b85f6ec`](https://github.com/sagemath/sagetrac-mirror/commit/b85f6ec46f9878c48ed4d8843123b46b844cb252)** to **[`1d68a1f`](https://github.com/sagemath/sagetrac-mirror/commit/1d68a1f83e9fbb0135077e5e0ec60be0f5beb141)**



---

archive/issue_comments_445099.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d68a1f83e9fbb0135077e5e0ec60be0f5beb141\"><code>1d68a1f</code></a></td><td><code>'set_restriction' added + some restriction modifications</code></td></tr></table>\n",
    "created_at": "2019-10-06T13:23:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445099",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d68a1f83e9fbb0135077e5e0ec60be0f5beb141"><code>1d68a1f</code></a></td><td><code>'set_restriction' added + some restriction modifications</code></td></tr></table>




---

archive/issue_comments_445100.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,5 @@\n \n **This ticket includes:**\n \n-- modification of namings after algebraic operations, such as `f*g` (`f \\cdot g` for LaTeX code), `f/g` and `f+g`\n - `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)\n - `set_restriction` method added smilar to tensor fields\n-- `_is_zero` attribute copied for a copy\n``````\n",
    "created_at": "2019-10-06T13:24:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445100",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,5 @@
 
 **This ticket includes:**
 
-- modification of namings after algebraic operations, such as `f*g` (`f \cdot g` for LaTeX code), `f/g` and `f+g`
 - `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)
 - `set_restriction` method added smilar to tensor fields
-- `_is_zero` attribute copied for a copy
``````




---

archive/issue_comments_445101.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,6 +9,8 @@\n \n This solution is quite unhandy and becomes even more so for more complicated scalar fields.\n \n+This ticket is part of the metaticket #28519.\n+\n **This ticket includes:**\n \n - `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)\n``````\n",
    "created_at": "2019-10-06T14:41:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445101",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,6 +9,8 @@
 
 This solution is quite unhandy and becomes even more so for more complicated scalar fields.
 
+This ticket is part of the metaticket #28519.
+
 **This ticket includes:**
 
 - `display` method modified in such a way that all distinct expressions are shown (a small slowdown in computation time)
``````




---

archive/issue_comments_445102.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nPlease give me a short feedback so that I can work further on this.\n\nThis ticket is essential for my future implementation of characteristic classes (due to the `set_restriction` method).",
    "created_at": "2019-10-07T19:22:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445102",
    "user": "https://github.com/DeRhamSource"
}
```

<div id="comment:10" align="right">comment:10</div>

Please give me a short feedback so that I can work further on this.

This ticket is essential for my future implementation of characteristic classes (due to the `set_restriction` method).



---

archive/issue_events_388978.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-07T19:58:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388978"
}
```



---

archive/issue_comments_445103.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSorry for the delay. The ticket looks good; it clearly improves the treatment of restrictions of scalar fields. I have a few remarks:\n- Regarding the change in `display()`, I agree that your solution is a good compromise\n- I guess the method `_new_instance()` has been introduced in scalar fields by analogy of what is done for tensor fields. However in the present case, this method is quite trivial, since it returns a mere `type(self)(self.parent())`. IMHO this adds some code complexity (a new method) for not a big gain; for someone reading the code, \n\n```\n   res = type(self)(self.parent())\n```\n  is at least as clear as\n\n```\n   res = self._new_instance()\n```\n   Moreover the latter involves one extra function call. Therefore I would suggest to revert this change.\n- When you perform significant changes/additions to some file, I would suggest that you add your name to the `AUTHORS` field and copyright statement. For instance in `src/sage/mnifolds/scalarfield.py`, you could add to the `AUTHORS` field something like \n\n```\n- Michael Jung (2019) : improve restrictions; make ``display()`` show all\n  distinct expressions\n```\n  The same holds for #28628 and other tickets of #28519.",
    "created_at": "2019-10-26T15:46:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445103",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:12" align="right">comment:12</div>

Sorry for the delay. The ticket looks good; it clearly improves the treatment of restrictions of scalar fields. I have a few remarks:
- Regarding the change in `display()`, I agree that your solution is a good compromise
- I guess the method `_new_instance()` has been introduced in scalar fields by analogy of what is done for tensor fields. However in the present case, this method is quite trivial, since it returns a mere `type(self)(self.parent())`. IMHO this adds some code complexity (a new method) for not a big gain; for someone reading the code, 

```
   res = type(self)(self.parent())
```
  is at least as clear as

```
   res = self._new_instance()
```
   Moreover the latter involves one extra function call. Therefore I would suggest to revert this change.
- When you perform significant changes/additions to some file, I would suggest that you add your name to the `AUTHORS` field and copyright statement. For instance in `src/sage/mnifolds/scalarfield.py`, you could add to the `AUTHORS` field something like 

```
- Michael Jung (2019) : improve restrictions; make ``display()`` show all
  distinct expressions
```
  The same holds for #28628 and other tickets of #28519.



---

archive/issue_comments_445104.json:
```json
{
    "body": "Changed commit from **[`1d68a1f`](https://github.com/sagemath/sagetrac-mirror/commit/1d68a1f83e9fbb0135077e5e0ec60be0f5beb141)** to **[`512d2b1`](https://github.com/sagemath/sagetrac-mirror/commit/512d2b1a31d7491e5ecce1bb167b74830929b06d)**",
    "created_at": "2019-10-27T13:29:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445104",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1d68a1f`](https://github.com/sagemath/sagetrac-mirror/commit/1d68a1f83e9fbb0135077e5e0ec60be0f5beb141)** to **[`512d2b1`](https://github.com/sagemath/sagetrac-mirror/commit/512d2b1a31d7491e5ecce1bb167b74830929b06d)**



---

archive/issue_comments_445105.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e999f17a5dc78a4903e4f759a0ea31a1bfe4314\"><code>4e999f1</code></a></td><td><code>Merge branch 'develop' into t/28554/scalar_field_restrictions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/512d2b1a31d7491e5ecce1bb167b74830929b06d\"><code>512d2b1</code></a></td><td><code>Revert '_new_instance' + authorship</code></td></tr></table>\n",
    "created_at": "2019-10-27T13:29:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445105",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e999f17a5dc78a4903e4f759a0ea31a1bfe4314"><code>4e999f1</code></a></td><td><code>Merge branch 'develop' into t/28554/scalar_field_restrictions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/512d2b1a31d7491e5ecce1bb167b74830929b06d"><code>512d2b1</code></a></td><td><code>Revert '_new_instance' + authorship</code></td></tr></table>




---

archive/issue_events_388979.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-27T13:31:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388979"
}
```



---

archive/issue_events_388980.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-27T13:31:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388980"
}
```



---

archive/issue_comments_445106.json:
```json
{
    "body": "Author: **Michael Jung**",
    "created_at": "2019-10-27T13:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445106",
    "user": "https://github.com/DeRhamSource"
}
```

Author: **Michael Jung**



---

archive/issue_comments_445107.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThanks! There we go. :)",
    "created_at": "2019-10-27T13:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445107",
    "user": "https://github.com/DeRhamSource"
}
```

<div id="comment:14" align="right">comment:14</div>

Thanks! There we go. :)



---

archive/issue_events_388981.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-27T14:27:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388981"
}
```



---

archive/issue_events_388982.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-27T14:27:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388982"
}
```



---

archive/issue_comments_445108.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nWith Sage 9.0.beta3, there are two failed doctests:\n\n```\n**********************************************************************\nFile \"src/sage/manifolds/section.py\", line 971, in sage.manifolds.section.Section.add_expr_from_subdomain\nFailed example:\n    sorted(s._components.values())[0]._comp[(1,)].display()\nExpected:\n    S^2 --> R\n    on U: (x, y) |--> x\nGot:\n    S^2 --> R\n    on U: (x, y) |--> x\n    on W: (u, v) |--> u/(u^2 + v^2)\n**********************************************************************\n\n**********************************************************************\nFile \"src/sage/manifolds/differentiable/pseudo_riemannian_submanifold.py\", line 1517, in sage.manifolds.differentiable.pseudo_riemannian_submanifold.?.principal_curvatures\nFailed example:\n    N.principal_curvatures(stereoN)[0].display()  # long time\nExpected:\n    k_0: N --> R\n    on U: x |--> -1\nGot:\n    k_0: N --> R\n    on U: x |--> -1\n    on W: y |--> -1\n**********************************************************************\n```",
    "created_at": "2019-10-27T14:27:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445108",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:15" align="right">comment:15</div>

With Sage 9.0.beta3, there are two failed doctests:

```
**********************************************************************
File "src/sage/manifolds/section.py", line 971, in sage.manifolds.section.Section.add_expr_from_subdomain
Failed example:
    sorted(s._components.values())[0]._comp[(1,)].display()
Expected:
    S^2 --> R
    on U: (x, y) |--> x
Got:
    S^2 --> R
    on U: (x, y) |--> x
    on W: (u, v) |--> u/(u^2 + v^2)
**********************************************************************

**********************************************************************
File "src/sage/manifolds/differentiable/pseudo_riemannian_submanifold.py", line 1517, in sage.manifolds.differentiable.pseudo_riemannian_submanifold.?.principal_curvatures
Failed example:
    N.principal_curvatures(stereoN)[0].display()  # long time
Expected:
    k_0: N --> R
    on U: x |--> -1
Got:
    k_0: N --> R
    on U: x |--> -1
    on W: y |--> -1
**********************************************************************
```



---

archive/issue_comments_445109.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nBtw, thanks for reverting `_new_instance()`.",
    "created_at": "2019-10-27T14:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445109",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:16" align="right">comment:16</div>

Btw, thanks for reverting `_new_instance()`.



---

archive/issue_comments_445110.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/763f69c5224ff93bb34e9030de814e1b7f481522\"><code>763f69c</code></a></td><td><code>Merge branch 'develop' into t/28554/scalar_field_restrictions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737\"><code>a126d91</code></a></td><td><code>Doctest errors fixed</code></td></tr></table>\n",
    "created_at": "2019-10-27T14:44:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445110",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/763f69c5224ff93bb34e9030de814e1b7f481522"><code>763f69c</code></a></td><td><code>Merge branch 'develop' into t/28554/scalar_field_restrictions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737"><code>a126d91</code></a></td><td><code>Doctest errors fixed</code></td></tr></table>




---

archive/issue_comments_445111.json:
```json
{
    "body": "Changed commit from **[`512d2b1`](https://github.com/sagemath/sagetrac-mirror/commit/512d2b1a31d7491e5ecce1bb167b74830929b06d)** to **[`a126d91`](https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737)**",
    "created_at": "2019-10-27T14:44:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445111",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`512d2b1`](https://github.com/sagemath/sagetrac-mirror/commit/512d2b1a31d7491e5ecce1bb167b74830929b06d)** to **[`a126d91`](https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737)**



---

archive/issue_comments_445112.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI totally missed that we are in beta3 already!\n\nPlease check once again.\n\nThanks for your effort so far! :)",
    "created_at": "2019-10-27T14:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445112",
    "user": "https://github.com/DeRhamSource"
}
```

<div id="comment:18" align="right">comment:18</div>

I totally missed that we are in beta3 already!

Please check once again.

Thanks for your effort so far! :)



---

archive/issue_events_388983.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-27T14:45:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388983"
}
```



---

archive/issue_events_388984.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-27T14:45:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388984"
}
```



---

archive/issue_events_388985.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-28T17:56:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388985"
}
```



---

archive/issue_events_388986.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-28T17:56:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388986"
}
```



---

archive/issue_comments_445113.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nEverything is fine now. Thanks.",
    "created_at": "2019-10-28T17:56:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445113",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:20" align="right">comment:20</div>

Everything is fine now. Thanks.



---

archive/issue_comments_445114.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2019-10-28T18:25:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445114",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_comments_445115.json:
```json
{
    "body": "Changed branch from **[u/gh-DeRhamSource/scalar_field_restrictions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/scalar_field_restrictions)** to **[`a126d91`](https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737)**",
    "created_at": "2019-10-29T23:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28554#issuecomment-445115",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-DeRhamSource/scalar_field_restrictions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/scalar_field_restrictions)** to **[`a126d91`](https://github.com/sagemath/sagetrac-mirror/commit/a126d9187fed8552fd14351248f54704dac26737)**



---

archive/issue_events_388987.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-29T23:41:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388987"
}
```



---

archive/issue_events_388988.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b960e6998dc3465274cb08bf6fda2d3221cbf025",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-10-29T23:41:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28554",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28554#event-388988"
}
```
