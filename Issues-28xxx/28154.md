# Issue 28154: SciPy: patch for missing coding lines in some source files

archive/issues_027917.json:
```json
{
    "body": "As originally reported at https://github.com/scipy/scipy/issues/9606 there are a few .py modules in scipy that contain unicode characters in docstrings without supplying a required \"coding\" line, resulting in a `SyntaxError` when you try to compile them.\n\nNormally this is not a problem, because when you build scipy with its `setup.py` it just compiles all `.pyc` while assuming utf-8 encoding for the source files.  If you already have the `.pyc` file, then, nothing goes wrong because the `SyntaxError` only arises when the Python compiler tries to read the original source file at runtime.\n\nBut if for some reason your files' mtimes get messed up (as apparently happened to me at some point; not sure how) and the .pyc has to be regenerated then you'll get a `SyntaxError` at import time for these modules.\n\nFor now it should suffice to include the following patch:\n\nhttps://github.com/scipy/scipy/commit/4a8a35f2c27be9f209cfc6f347e7a57a4a62e693.patch\n\nKeywords: scipy\n\nBranch/Commit: e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a\n\nReviewer: Vincent Klein\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28154\n\n",
    "closed_at": "2019-09-02T21:40:52Z",
    "created_at": "2019-07-10T10:16:23Z",
    "labels": [
        "component: packages: standard",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "SciPy: patch for missing coding lines in some source files",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28154",
    "user": "https://github.com/embray"
}
```
As originally reported at https://github.com/scipy/scipy/issues/9606 there are a few .py modules in scipy that contain unicode characters in docstrings without supplying a required "coding" line, resulting in a `SyntaxError` when you try to compile them.

Normally this is not a problem, because when you build scipy with its `setup.py` it just compiles all `.pyc` while assuming utf-8 encoding for the source files.  If you already have the `.pyc` file, then, nothing goes wrong because the `SyntaxError` only arises when the Python compiler tries to read the original source file at runtime.

But if for some reason your files' mtimes get messed up (as apparently happened to me at some point; not sure how) and the .pyc has to be regenerated then you'll get a `SyntaxError` at import time for these modules.

For now it should suffice to include the following patch:

https://github.com/scipy/scipy/commit/4a8a35f2c27be9f209cfc6f347e7a57a4a62e693.patch

Keywords: scipy

Branch/Commit: e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a

Reviewer: Vincent Klein

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28154





---

archive/issue_comments_545441.json:
```json
{
    "body": "Changing author from \"\" to \"Erik Bray\"",
    "created_at": "2019-07-10T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545441",
    "user": "https://github.com/embray"
}
```

Changing author from "" to "Erik Bray"



---

archive/issue_comments_545442.json:
```json
{
    "body": "Changing commit from \"\" to \"e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a\"",
    "created_at": "2019-07-10T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545442",
    "user": "https://github.com/embray"
}
```

Changing commit from "" to "e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a"



---

archive/issue_comments_545443.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-07-10T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545443",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_545444.json:
```json
{
    "body": "Changing branch from \"\" to \"u/embray/ticket-28154\"",
    "created_at": "2019-07-10T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545444",
    "user": "https://github.com/embray"
}
```

Changing branch from "" to "u/embray/ticket-28154"



---

archive/issue_comments_545445.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|\n|[e6ae4f7](https://git.sagemath.org/sage.git/commit?id=e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a)|`Trac #28154: Patch scipy to including missing coding lines on some source files containing unicode.`|",
    "created_at": "2019-07-10T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545445",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
|[e6ae4f7](https://git.sagemath.org/sage.git/commit?id=e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a)|`Trac #28154: Patch scipy to including missing coding lines on some source files containing unicode.`|



---

archive/issue_comments_545446.json:
```json
{
    "body": "<a id='comment:2'></a>\nI guess a package version update is missing : `1.2.0 => 1.2.0.p0`.",
    "created_at": "2019-07-12T11:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545446",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:2'></a>
I guess a package version update is missing : `1.2.0 => 1.2.0.p0`.



---

archive/issue_comments_545447.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Klein\"",
    "created_at": "2019-07-12T12:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545447",
    "user": "https://github.com/vinklein"
}
```

Changing reviewer from "" to "Vincent Klein"



---

archive/issue_comments_545448.json:
```json
{
    "body": "<a id='comment:3'></a>\nApart from that the patch is working and fixes the problem.",
    "created_at": "2019-07-12T12:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545448",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:3'></a>
Apart from that the patch is working and fixes the problem.



---

archive/issue_comments_545449.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis patch is really only relevant if you're installing scipy from scratch in the first place.  If it's already built this affects nothing at runtime so it's not necessary to increase the patch level and force needless reinstalls of scipy.",
    "created_at": "2019-08-29T14:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545449",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
This patch is really only relevant if you're installing scipy from scratch in the first place.  If it's already built this affects nothing at runtime so it's not necessary to increase the patch level and force needless reinstalls of scipy.



---

archive/issue_comments_545450.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-29T14:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545450",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_545451.json:
```json
{
    "body": "<a id='comment:5'></a>\nOk then.",
    "created_at": "2019-08-29T14:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545451",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:5'></a>
Ok then.



---

archive/issue_comments_545452.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-09-02T21:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545452",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069915.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-09-02T21:40:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28154#event-69915"
}
```



---

archive/issue_comments_545453.json:
```json
{
    "body": "Changing branch from \"u/embray/ticket-28154\" to \"e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a\"",
    "created_at": "2019-09-02T21:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28154#issuecomment-545453",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/embray/ticket-28154" to "e6ae4f7b909b468e23d12f2c40d3aa0ca91d8a2a"
