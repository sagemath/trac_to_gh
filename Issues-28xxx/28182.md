# Issue 28182: Linear algorithm for squares in words

archive/issues_027945.json:
```json
{
    "body": "This ticket implement a linear time algorithm to retrieve all the distinct squares in a word.\n\nCC:  @saliola @nadialafreniere\n\nKeywords: fpsac2019, suffix_trees\n\nBranch/Commit: 71f2ab7344a059a8c36d9049f01ad42a658cefc6\n\nReviewer: Nadia Lafreni\u00e8re, Travis Scrimshaw\n\nAuthor: \u00c9mile Nadeau\n\nDependencies: #23573\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28182\n\n",
    "closed_at": "2019-10-31T22:40:38Z",
    "created_at": "2019-07-12T09:46:24Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Linear algorithm for squares in words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28182",
    "user": "https://github.com/enadeau"
}
```
This ticket implement a linear time algorithm to retrieve all the distinct squares in a word.

CC:  @saliola @nadialafreniere

Keywords: fpsac2019, suffix_trees

Branch/Commit: 71f2ab7344a059a8c36d9049f01ad42a658cefc6

Reviewer: Nadia Lafrenière, Travis Scrimshaw

Author: Émile Nadeau

Dependencies: #23573

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28182





---

archive/issue_comments_420155.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2019-07-12T12:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420155",
    "user": "https://github.com/enadeau"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_420156.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-07-12T12:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420156",
    "user": "https://github.com/enadeau"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_420157.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+This ticket implement a linear time algorithm to retrieve all the distinct squares in a word.\n \n Comment: 1\n \n```\n",
    "created_at": "2019-07-12T12:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420157",
    "user": "https://github.com/enadeau"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+This ticket implement a linear time algorithm to retrieve all the distinct squares in a word.
 
 Comment: 1
 
```




---

archive/issue_comments_420158.json:
```json
{
    "body": "Changing keywords from \"\" to \"fpsac2019, suffix_trees\".",
    "created_at": "2019-07-12T12:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420158",
    "user": "https://github.com/enadeau"
}
```

Changing keywords from "" to "fpsac2019, suffix_trees".



---

archive/issue_comments_420159.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-12T13:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420159",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420160.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-12T13:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420160",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420161.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-07-12T14:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420161",
    "user": "https://github.com/enadeau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_420162.json:
```json
{
    "body": "<a id='comment:9'></a>The `leftmost_covering_set` function does not work properly:\n\n```\nsage: v = Word('aaaaa')\nsage: Tv = v.suffix_tree()\nsage: Tv.leftmost_covering_set()\n[[4, 2], [], [8], [6], [4]]\n```\n\nIs that wrong? Shouldn't `i+l` be smaller than the length of the word, since it is the position where the factors are supposed to end?\nI think the errors are in the 2nd condition. Testing it with the word `'aaaaa'` on the first block (of size 1), the 2nd condition returns `[(-1, 4), (-2, 6), (-3, 8)]`, which seems a bit weird, the first entry of the tuple being the position at which the square starts.\nPlease, fix it and add a test/example to make sure this casee is covered.\nIf you fix this, I'm ok with `leftmost_covering_set`.\n\nFor `square_vocabulary`, I think you should be more explicit in the description and say what the pairs are (a //couple// containing the position at which the square starts and its length).\n\n---\nNew commits:",
    "created_at": "2019-07-14T00:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420162",
    "user": "https://github.com/nadialafreniere"
}
```

<a id='comment:9'></a>The `leftmost_covering_set` function does not work properly:

```
sage: v = Word('aaaaa')
sage: Tv = v.suffix_tree()
sage: Tv.leftmost_covering_set()
[[4, 2], [], [8], [6], [4]]
```

Is that wrong? Shouldn't `i+l` be smaller than the length of the word, since it is the position where the factors are supposed to end?
I think the errors are in the 2nd condition. Testing it with the word `'aaaaa'` on the first block (of size 1), the 2nd condition returns `[(-1, 4), (-2, 6), (-3, 8)]`, which seems a bit weird, the first entry of the tuple being the position at which the square starts.
Please, fix it and add a test/example to make sure this casee is covered.
If you fix this, I'm ok with `leftmost_covering_set`.

For `square_vocabulary`, I think you should be more explicit in the description and say what the pairs are (a //couple// containing the position at which the square starts and its length).

---
New commits:



---

archive/issue_comments_420163.json:
```json
{
    "body": "<a id='comment:11'></a>I've made the change to match the new signature of `suffix_walk`, see ticket:23573\n\n---\nLast 10 new commits:",
    "created_at": "2019-07-14T12:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420163",
    "user": "https://github.com/enadeau"
}
```

<a id='comment:11'></a>I've made the change to match the new signature of `suffix_walk`, see ticket:23573

---
Last 10 new commits:



---

archive/issue_comments_420164.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-14T12:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420164",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420165.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-15T00:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420165",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420166.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-07-15T12:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420166",
    "user": "https://github.com/nadialafreniere"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_420167.json:
```json
{
    "body": "<a id='comment:14'></a>Great! I'm happy with most of the changes and the algorithm for squares is indeed faster than the naive one.\n\nWith the naive algorithm, I had:\n\n```\nsage: w = words.ThueMorseWord()[:1000]\nsage: %timeit squares(w)\n10 loops, best of 3: 72.3 ms per loop\nsage: u = words.ThueMorseWord()[:2000]\nsage: %timeit squares(u)\n1 loop, best of 3: 283 ms per loop\n```\nwhile the new one gives\n\n```\nsage: w = words.ThueMorseWord()[:1000]\nsage: %timeit w.squares()\n10 loops, best of 3: 30.5 ms per loop\nsage: u = words.ThueMorseWord()[:2000]\nsage: %timeit u.squares()\n10 loops, best of 3: 60.8 ms per loop\n```\nwhich is much faster.\n\nI'll repeat what I suggested in comment:9, because you seem to have forgotten to apply it:\n> For `square_vocabulary`, I think you should be more explicit in the description and say what the pairs are (a //couple// containing the position at which the square starts and its length). \n\nIf you disagree with this comment, I'd like to hear your point of view. Otherwise, please change it.",
    "created_at": "2019-07-15T12:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420167",
    "user": "https://github.com/nadialafreniere"
}
```

<a id='comment:14'></a>Great! I'm happy with most of the changes and the algorithm for squares is indeed faster than the naive one.

With the naive algorithm, I had:

```
sage: w = words.ThueMorseWord()[:1000]
sage: %timeit squares(w)
10 loops, best of 3: 72.3 ms per loop
sage: u = words.ThueMorseWord()[:2000]
sage: %timeit squares(u)
1 loop, best of 3: 283 ms per loop
```
while the new one gives

```
sage: w = words.ThueMorseWord()[:1000]
sage: %timeit w.squares()
10 loops, best of 3: 30.5 ms per loop
sage: u = words.ThueMorseWord()[:2000]
sage: %timeit u.squares()
10 loops, best of 3: 60.8 ms per loop
```
which is much faster.

I'll repeat what I suggested in comment:9, because you seem to have forgotten to apply it:
> For `square_vocabulary`, I think you should be more explicit in the description and say what the pairs are (a //couple// containing the position at which the square starts and its length). 

If you disagree with this comment, I'd like to hear your point of view. Otherwise, please change it.



---

archive/issue_comments_420168.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-16T11:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420169.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-16T12:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420170.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-07-16T12:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420170",
    "user": "https://github.com/nadialafreniere"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_420171.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-07-16T12:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_420172.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2019-07-16T12:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_420173.json:
```json
{
    "body": "<a id='comment:19'></a>I've detailed the documentation as you suggested and also fixed some other details pointed out by the patchbot.",
    "created_at": "2019-07-16T12:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420173",
    "user": "https://github.com/enadeau"
}
```

<a id='comment:19'></a>I've detailed the documentation as you suggested and also fixed some other details pointed out by the patchbot.



---

archive/issue_comments_420174.json:
```json
{
    "body": "<a id='comment:21'></a>New commits:",
    "created_at": "2019-07-16T14:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420174",
    "user": "https://github.com/nadialafreniere"
}
```

<a id='comment:21'></a>New commits:



---

archive/issue_comments_420175.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-16T14:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420175",
    "user": "https://github.com/nadialafreniere"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420176.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-07-17T09:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420176",
    "user": "https://github.com/enadeau"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_420177.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-14T10:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420178.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-14T14:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420178",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420179.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-08-15T13:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420179",
    "user": "https://github.com/enadeau"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_420180.json:
```json
{
    "body": "<a id='comment:27'></a>Great! I'm happy there's now a fast algorithm for computing the squares and everything looks fine.",
    "created_at": "2019-08-30T22:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420180",
    "user": "https://github.com/nadialafreniere"
}
```

<a id='comment:27'></a>Great! I'm happy there's now a fast algorithm for computing the squares and everything looks fine.



---

archive/issue_comments_420181.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-30T22:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420181",
    "user": "https://github.com/nadialafreniere"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420182.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-09-05T20:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420182",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_420183.json:
```json
{
    "body": "<a id='comment:28'></a>I'm getting a number of py3 failures of the sort \n\n```\n**********************************************************************\nFile \"src/sage/combinat/words/suffix_trees.py\", line 1633, in sage.combinat.words.suffix_trees.DecoratedSuffixTree._partial_labeling\nFailed example:\n    T = DecoratedSuffixTree(w)\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.words.suffix_trees.DecoratedSuffixTree._partial_labeling[2]>\", line 1, in <module>\n        T = DecoratedSuffixTree(w)\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py\", line 1609, in __init__\n        self.labeling = self._complete_labeling()\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py\", line 1786, in _complete_labeling\n        prelabeling = self._partial_labeling()\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py\", line 1703, in _partial_labeling\n        treat_node(0, None)\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py\", line 1683, in treat_node\n        if D.has_key(current_node):\n    AttributeError: 'dict' object has no attribute 'has_key'\n**********************************************************************\n```\nNote: `has_key` is removed in python 3, use `in` instead.",
    "created_at": "2019-09-05T20:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420183",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'></a>I'm getting a number of py3 failures of the sort 

```
**********************************************************************
File "src/sage/combinat/words/suffix_trees.py", line 1633, in sage.combinat.words.suffix_trees.DecoratedSuffixTree._partial_labeling
Failed example:
    T = DecoratedSuffixTree(w)
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.words.suffix_trees.DecoratedSuffixTree._partial_labeling[2]>", line 1, in <module>
        T = DecoratedSuffixTree(w)
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py", line 1609, in __init__
        self.labeling = self._complete_labeling()
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py", line 1786, in _complete_labeling
        prelabeling = self._partial_labeling()
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py", line 1703, in _partial_labeling
        treat_node(0, None)
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/words/suffix_trees.py", line 1683, in treat_node
        if D.has_key(current_node):
    AttributeError: 'dict' object has no attribute 'has_key'
**********************************************************************
```
Note: `has_key` is removed in python 3, use `in` instead.



---

archive/issue_comments_420184.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-09-06T06:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420184",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_420185.json:
```json
{
    "body": "<a id='comment:29'></a>There were a few other things that also needed fixing (including a failing doctest on Python3) and that could be optimized. This now passes tests for me on Python3.\n\n---\nNew commits:",
    "created_at": "2019-09-06T06:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420185",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:29'></a>There were a few other things that also needed fixing (including a failing doctest on Python3) and that could be optimized. This now passes tests for me on Python3.

---
New commits:



---

archive/issue_comments_420186.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-09-12T09:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420186",
    "user": "https://github.com/enadeau"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420187.json:
```json
{
    "body": "<a id='comment:30'></a>Looks good. Thanks for your help.",
    "created_at": "2019-09-12T09:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420187",
    "user": "https://github.com/enadeau"
}
```

<a id='comment:30'></a>Looks good. Thanks for your help.



---

archive/issue_comments_420188.json:
```json
{
    "body": "<a id='comment:31'></a>moving milestone to 9.0 (after release of 8.9)",
    "created_at": "2019-09-30T08:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420188",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'></a>moving milestone to 9.0 (after release of 8.9)



---

archive/issue_events_070034.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28182#event-70034"
}
```



---

archive/issue_comments_420189.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-10-07T22:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420189",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_420190.json:
```json
{
    "body": "<a id='comment:32'></a>Getting some random failures:\n\n```\nsage -t --long src/sage/combinat/words/finite_word.py\n**********************************************************************\nFile \"src/sage/combinat/words/finite_word.py\", line 6879, in sage.combinat.words.finite_word.FiniteWord_class.squares\nFailed example:\n    w.squares()\nExpected:\n    [word: , word: 01100110, word: 00110011, word: 00, word: 11, word: 1010]\nGot:\n    [word: , word: 00110011, word: 00, word: 01100110, word: 11, word: 1010]\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.combinat.words.finite_word.FiniteWord_class.squares\n    [1318 tests, 1 failure, 3.32 s]\n```",
    "created_at": "2019-10-07T22:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420190",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:32'></a>Getting some random failures:

```
sage -t --long src/sage/combinat/words/finite_word.py
**********************************************************************
File "src/sage/combinat/words/finite_word.py", line 6879, in sage.combinat.words.finite_word.FiniteWord_class.squares
Failed example:
    w.squares()
Expected:
    [word: , word: 01100110, word: 00110011, word: 00, word: 11, word: 1010]
Got:
    [word: , word: 00110011, word: 00, word: 01100110, word: 11, word: 1010]
**********************************************************************
1 item had failures:
   1 of   5 in sage.combinat.words.finite_word.FiniteWord_class.squares
    [1318 tests, 1 failure, 3.32 s]
```



---

archive/issue_comments_420191.json:
```json
{
    "body": "<a id='comment:33'></a>and one missing empty line here:\n\n```\n+        EXAMPLES::\n+            sage: from sage.combinat.words.suffix_trees import DecoratedSuffixTree\n```",
    "created_at": "2019-10-08T07:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420191",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'></a>and one missing empty line here:

```
+        EXAMPLES::
+            sage: from sage.combinat.words.suffix_trees import DecoratedSuffixTree
```



---

archive/issue_comments_420192.json:
```json
{
    "body": "<a id='comment:35'></a>Why don't you return the squares as a set, just like factors and palindromes? That would solve the problem of the failing doctest.",
    "created_at": "2019-10-08T14:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420192",
    "user": "https://github.com/nadialafreniere"
}
```

<a id='comment:35'></a>Why don't you return the squares as a set, just like factors and palindromes? That would solve the problem of the failing doctest.



---

archive/issue_comments_420193.json:
```json
{
    "body": "<a id='comment:36'></a>I could change it for a `set` if we want to be consistent with the output from `factors` and `palindromes`. However, Python has no guarantee about order of the elements in a set. This means that it wouldn't fix the doctest since it is sensitive to the order the elements are printed. To fix the doctest using `sorted` is the good way to do it. Tests for `palindromes` are also written that way.\n\nDo you still think the output should be changed to a set?",
    "created_at": "2019-10-08T15:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420193",
    "user": "https://github.com/enadeau"
}
```

<a id='comment:36'></a>I could change it for a `set` if we want to be consistent with the output from `factors` and `palindromes`. However, Python has no guarantee about order of the elements in a set. This means that it wouldn't fix the doctest since it is sensitive to the order the elements are printed. To fix the doctest using `sorted` is the good way to do it. Tests for `palindromes` are also written that way.

Do you still think the output should be changed to a set?



---

archive/issue_comments_420194.json:
```json
{
    "body": "<a id='comment:37'></a>I think consistency is something we should aim for, so that would be an improvement. But you are also right about the doctests.",
    "created_at": "2019-10-08T20:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420194",
    "user": "https://github.com/nadialafreniere"
}
```

<a id='comment:37'></a>I think consistency is something we should aim for, so that would be an improvement. But you are also right about the doctests.



---

archive/issue_comments_420195.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-09T09:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420195",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420196.json:
```json
{
    "body": "<a id='comment:39'></a>INPUTS: should be INPUT:",
    "created_at": "2019-10-09T14:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420196",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'></a>INPUTS: should be INPUT:



---

archive/issue_comments_420197.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-09T15:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420198.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-10T14:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420198",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_420199.json:
```json
{
    "body": "<a id='comment:41'></a>you should set back to needs review once you made all the required changes",
    "created_at": "2019-10-10T14:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420199",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:41'></a>you should set back to needs review once you made all the required changes



---

archive/issue_comments_420200.json:
```json
{
    "body": "<a id='comment:42'></a>LGTM as I believe all suggestions have been addressed.",
    "created_at": "2019-10-30T04:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420200",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:42'></a>LGTM as I believe all suggestions have been addressed.



---

archive/issue_comments_420201.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-30T04:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420201",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420202.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-31T22:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28182#issuecomment-420202",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_070035.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-31T22:40:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28182",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28182#event-70035"
}
```
