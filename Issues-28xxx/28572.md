# Issue 28572: conversion of quotient rings to macaulay2

archive/issues_028335.json:
```json
{
    "body": "Currently, conversion of quotient rings to M2 is not supported; we add this functionality:\n\n```\nsage: R.<x,y> = PolynomialRing(QQ)\nsage: I = R.ideal([x^2 - y])\nsage: macaulay2(R.quotient_ring(I))\n```\n\nThis also improves the conversion of ideals by moving the `MPolynomialIdeal_macaulay2_repr._macaulay2_` to `Ideal_generic._macaulay2_init_`; for example, the following now work but didn't before (see the doctests for examples):\n- ideals in univariate polynomial rings\n\n```\nsage: R.<x> = PolynomialRing(ZZ)\nsage: macaulay2(R.ideal(x^2))\n```\n- ideals in PIDs\n\n```\nsage: macaulay2(ideal(5))\n```\n\n\nNote that quotient rings in M2 inherit variable names from the ambient ring, so we mimic this behaviour in Sage::\n\n```\nsage: R = macaulay2(\"ZZ/7[x,y]\")\nsage: I = macaulay2(\"ideal (x^3 - y^2)\")\nsage: (R/I).gens()\n{x, y}\nsage: (R/I).sage().gens()\n(x, y)\n```\n\nWe also implement conversion of polynomials from quotient rings from/to M2:\n\n```\nsage: x, y = (R/I).gens()\nsage: f = (x^3 + 2*y^2*x)^7; f\n    18    14\n2x*y   + y\nsage: f.sage()\n2*x*y^18 + y^14\nsage: _.parent()\nQuotient of Multivariate Polynomial Ring in x, y over Finite Field of size 7 by the ideal (x^3 - y^2)\nsage: macaulay2(f.sage())\n    18    14\n2x*y   + y\n```\n\n\n\nCC:  @dimpase @mwageringel @antonleykin\n\nKeywords: IMA Coding Sprint, macaulay2, interfaces\n\nBranch/Commit: 3f4f6f577654bb038692a140df4dc9ca9be03219\n\nReviewer: Markus Wageringel, Dima Pasechnik\n\nAuthor: Franco Saliola\n\nDependencies: #28567, #28571, #28074, #28591\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28572\n\n",
    "closed_at": "2019-10-29T23:41:57Z",
    "created_at": "2019-10-07T17:19:43Z",
    "labels": [
        "component: interfaces: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "conversion of quotient rings to macaulay2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28572",
    "user": "https://github.com/saliola"
}
```
Currently, conversion of quotient rings to M2 is not supported; we add this functionality:

```
sage: R.<x,y> = PolynomialRing(QQ)
sage: I = R.ideal([x^2 - y])
sage: macaulay2(R.quotient_ring(I))
```

This also improves the conversion of ideals by moving the `MPolynomialIdeal_macaulay2_repr._macaulay2_` to `Ideal_generic._macaulay2_init_`; for example, the following now work but didn't before (see the doctests for examples):
- ideals in univariate polynomial rings

```
sage: R.<x> = PolynomialRing(ZZ)
sage: macaulay2(R.ideal(x^2))
```
- ideals in PIDs

```
sage: macaulay2(ideal(5))
```


Note that quotient rings in M2 inherit variable names from the ambient ring, so we mimic this behaviour in Sage::

```
sage: R = macaulay2("ZZ/7[x,y]")
sage: I = macaulay2("ideal (x^3 - y^2)")
sage: (R/I).gens()
{x, y}
sage: (R/I).sage().gens()
(x, y)
```

We also implement conversion of polynomials from quotient rings from/to M2:

```
sage: x, y = (R/I).gens()
sage: f = (x^3 + 2*y^2*x)^7; f
    18    14
2x*y   + y
sage: f.sage()
2*x*y^18 + y^14
sage: _.parent()
Quotient of Multivariate Polynomial Ring in x, y over Finite Field of size 7 by the ideal (x^3 - y^2)
sage: macaulay2(f.sage())
    18    14
2x*y   + y
```



CC:  @dimpase @mwageringel @antonleykin

Keywords: IMA Coding Sprint, macaulay2, interfaces

Branch/Commit: 3f4f6f577654bb038692a140df4dc9ca9be03219

Reviewer: Markus Wageringel, Dima Pasechnik

Author: Franco Saliola

Dependencies: #28567, #28571, #28074, #28591

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28572





---

archive/issue_comments_426018.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-10-07T17:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426018",
    "user": "https://github.com/saliola"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_426019.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-07T19:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426020.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-07T20:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426021.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-07T20:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426021",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426022.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-07T21:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426023.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -19,6 +19,36 @@\n sage: macaulay2(ideal(5))\n \\`\\`\\`\n \n+\n+Note that quotient rings in M2 inherit variable names from the ambient ring, so we mimic this behaviour in Sage::\n+\n+\\`\\`\\`\n+sage: R = macaulay2(\"ZZ/7[x,y]\")\n+sage: I = macaulay2(\"ideal (x^3 - y^2)\")\n+sage: (R/I).gens()\n+{x, y}\n+sage: (R/I).sage().gens()\n+(x, y)\n+\\`\\`\\`\n+\n+We also implement conversion of polynomials from quotient rings from/to M2:\n+\n+\\`\\`\\`\n+sage: x, y = (R/I).gens()\n+sage: f = (x^3 + 2*y^2*x)^7; f\n+    18    14\n+2x*y   + y\n+sage: f.sage()\n+2*x*y^18 + y^14\n+sage: _.parent()\n+Quotient of Multivariate Polynomial Ring in x, y over Finite Field of size 7 by the ideal (x^3 - y^2)\n+sage: macaulay2(f.sage())\n+    18    14\n+2x*y   + y\n+\\`\\`\\`\n+\n+\n+\n Author: Franco Saliola\n \n Dependencies: 28571, 28074\n```\n",
    "created_at": "2019-10-07T21:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426023",
    "user": "https://github.com/saliola"
}
```

Description changed:
```diff
--- 
+++ 
@@ -19,6 +19,36 @@
 sage: macaulay2(ideal(5))
 \`\`\`
 
+
+Note that quotient rings in M2 inherit variable names from the ambient ring, so we mimic this behaviour in Sage::
+
+\`\`\`
+sage: R = macaulay2("ZZ/7[x,y]")
+sage: I = macaulay2("ideal (x^3 - y^2)")
+sage: (R/I).gens()
+{x, y}
+sage: (R/I).sage().gens()
+(x, y)
+\`\`\`
+
+We also implement conversion of polynomials from quotient rings from/to M2:
+
+\`\`\`
+sage: x, y = (R/I).gens()
+sage: f = (x^3 + 2*y^2*x)^7; f
+    18    14
+2x*y   + y
+sage: f.sage()
+2*x*y^18 + y^14
+sage: _.parent()
+Quotient of Multivariate Polynomial Ring in x, y over Finite Field of size 7 by the ideal (x^3 - y^2)
+sage: macaulay2(f.sage())
+    18    14
+2x*y   + y
+\`\`\`
+
+
+
 Author: Franco Saliola
 
 Dependencies: 28571, 28074
```




---

archive/issue_comments_426024.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-07T22:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426024",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426025.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-07T22:31:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426025",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426026.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-08T00:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426026",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426027.json:
```json
{
    "body": "<a id='comment:10'></a>The following does not work yet (not even with #28574):\n\n```\nsage: R = QQ['x,y'].quotient('x^2-y')['z,t']\nsage: f = R.base_ring()('x')^2 - R('z^2')\nsage: macaulay2(f)  # fails\n```\nThis fails because the variable names in the quotient ring are named `xbar,ybar` in Sage, but `x,y` in Macaulay2. The conversion routine for polynomials does not currently take this into account when the base ring is a quotient ring.\n\nOther than that, everything looks good to me up until here.",
    "created_at": "2019-10-08T01:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426027",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:10'></a>The following does not work yet (not even with #28574):

```
sage: R = QQ['x,y'].quotient('x^2-y')['z,t']
sage: f = R.base_ring()('x')^2 - R('z^2')
sage: macaulay2(f)  # fails
```
This fails because the variable names in the quotient ring are named `xbar,ybar` in Sage, but `x,y` in Macaulay2. The conversion routine for polynomials does not currently take this into account when the base ring is a quotient ring.

Other than that, everything looks good to me up until here.



---

archive/issue_comments_426028.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-10T16:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426029.json:
```json
{
    "body": "<a id='comment:13'></a>I added a dependency to #28567 because this did not merge cleanly on top of it (and I merged it into this branch).",
    "created_at": "2019-10-10T16:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426029",
    "user": "https://github.com/saliola"
}
```

<a id='comment:13'></a>I added a dependency to #28567 because this did not merge cleanly on top of it (and I merged it into this branch).



---

archive/issue_comments_426030.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-10T19:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426030",
    "user": "https://github.com/mwageringel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_426031.json:
```json
{
    "body": "<a id='comment:14'></a>Ok.",
    "created_at": "2019-10-10T19:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426031",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:14'></a>Ok.



---

archive/issue_comments_426032.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-10-15T22:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426032",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_426033.json:
```json
{
    "body": "<a id='comment:15'></a>Merge conflict (please merge in next beta)",
    "created_at": "2019-10-15T22:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426033",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>Merge conflict (please merge in next beta)



---

archive/issue_comments_426034.json:
```json
{
    "body": "<a id='comment:17'></a>rebased on top of the branch of #28591\n\n---\nLast 10 new commits:",
    "created_at": "2019-10-22T21:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426034",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>rebased on top of the branch of #28591

---
Last 10 new commits:



---

archive/issue_comments_426035.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-10-22T21:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426035",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_071715.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-29T23:41:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28572#event-71715"
}
```



---

archive/issue_comments_426036.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-29T23:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28572",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28572#issuecomment-426036",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
