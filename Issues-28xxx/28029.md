# Issue 28029: Increase number of tries in unpack_archive

archive/issues_027792.json:
```json
{
    "body": "In Cygwin under Windows, unpacking archives sometimes leads\nto a permission problem.\n\nThis is due to Windows locking files when they are opened\nby another application, and might mean an antivirus inspecting\na file prevents you from writing to it.\n\nBuilding Sage in Cygwin in Windows 7 on some computer reliably\nfailed before this ticket, and reliably works with it.\n\nCC:  @embray @slel\n\nKeywords: cygwin, days101\n\nBranch/Commit: 53becef88b6ad3d1471aa0e66f0f9b4927b42e2e\n\nReviewer: Samuel Leli\u00e8vre\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28029\n\n",
    "closed_at": "2019-06-28T04:29:35Z",
    "created_at": "2019-06-20T15:57:49Z",
    "labels": [
        "component: porting: cygwin"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Increase number of tries in unpack_archive",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28029",
    "user": "https://github.com/slel"
}
```
In Cygwin under Windows, unpacking archives sometimes leads
to a permission problem.

This is due to Windows locking files when they are opened
by another application, and might mean an antivirus inspecting
a file prevents you from writing to it.

Building Sage in Cygwin in Windows 7 on some computer reliably
failed before this ticket, and reliably works with it.

CC:  @embray @slel

Keywords: cygwin, days101

Branch/Commit: 53becef88b6ad3d1471aa0e66f0f9b4927b42e2e

Reviewer: Samuel Leli√®vre

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28029





---

archive/issue_comments_536271.json:
```json
{
    "body": "Changing keywords from \"cygwin\" to \"cygwin, days101\".",
    "created_at": "2019-06-20T15:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536271",
    "user": "https://github.com/slel"
}
```

Changing keywords from "cygwin" to "cygwin, days101".



---

archive/issue_comments_536272.json:
```json
{
    "body": "Changing branch from \"\" to \"u/slelievre/cygwin-retry-harder\"",
    "created_at": "2019-06-20T15:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536272",
    "user": "https://github.com/slel"
}
```

Changing branch from "" to "u/slelievre/cygwin-retry-harder"



---

archive/issue_comments_536273.json:
```json
{
    "body": "Changing branch from \"u/slelievre/cygwin-retry-harder\" to \"\"",
    "created_at": "2019-06-20T15:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536273",
    "user": "https://github.com/slel"
}
```

Changing branch from "u/slelievre/cygwin-retry-harder" to ""



---

archive/issue_comments_536274.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-20T15:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536274",
    "user": "https://github.com/slel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_536275.json:
```json
{
    "body": "Changing commit from \"\" to \"53becef88b6ad3d1471aa0e66f0f9b4927b42e2e\"",
    "created_at": "2019-06-20T16:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536275",
    "user": "https://github.com/slel"
}
```

Changing commit from "" to "53becef88b6ad3d1471aa0e66f0f9b4927b42e2e"



---

archive/issue_comments_536276.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-20T16:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536276",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_536277.json:
```json
{
    "body": "Changing branch from \"\" to \"u/slelievre/cygwin-retry-harder\"",
    "created_at": "2019-06-20T16:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536277",
    "user": "https://github.com/slel"
}
```

Changing branch from "" to "u/slelievre/cygwin-retry-harder"



---

archive/issue_comments_536278.json:
```json
{
    "body": "<a id='comment:4'></a>\nNew commits:\n|                                                                                                                                          |                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[53becef](https://github.com/sagemath/sagetrac-mirror/commit/53becef88b6ad3d1471aa0e66f0f9b4927b42e2e)|`cygwin: retry harder`|",
    "created_at": "2019-06-20T16:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536278",
    "user": "https://github.com/slel"
}
```

<a id='comment:4'></a>
New commits:
|                                                                                                                                          |                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[53becef](https://github.com/sagemath/sagetrac-mirror/commit/53becef88b6ad3d1471aa0e66f0f9b4927b42e2e)|`cygwin: retry harder`|



---

archive/issue_comments_536279.json:
```json
{
    "body": "<a id='comment:5'></a>\nFWIW the `retry=len(archive.names)` is pretty arbitrary here.  It's just setting the number of retries needed to a factor of the number of files extracted (that might be getting checked one by one by a virus scanner or whatever).  In practice it should need way fewer retries than this since the default retry is every 1s.",
    "created_at": "2019-06-20T17:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536279",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
FWIW the `retry=len(archive.names)` is pretty arbitrary here.  It's just setting the number of retries needed to a factor of the number of files extracted (that might be getting checked one by one by a virus scanner or whatever).  In practice it should need way fewer retries than this since the default retry is every 1s.



---

archive/issue_comments_536280.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-28T04:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536280",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_536281.json:
```json
{
    "body": "Changing branch from \"u/slelievre/cygwin-retry-harder\" to \"53becef88b6ad3d1471aa0e66f0f9b4927b42e2e\"",
    "created_at": "2019-06-28T04:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28029#issuecomment-536281",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/slelievre/cygwin-retry-harder" to "53becef88b6ad3d1471aa0e66f0f9b4927b42e2e"



---

archive/issue_events_086632.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-28T04:29:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28029",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28029#event-86632"
}
```
