# Issue 28814: Conversion of scientific notation floats/RDF,etc... incorrect in Mathematica interface

archive/issues_028577.json:
```json
{
    "assignees": [],
    "body": "Exploration of a problem reported in an [ask.sagemath question](https://ask.sagemath.org/question/48908/how-to-avoid-scientific-notation-of-numbers-in-the-mathematica-interface/).\n\nThe conversion of large or small floating point constants (needing scientific notation) to mathematica is incorrect:\n\n```\n# Reference\nsage: 3.5.log().n()\n1.25276296849537\n# This works\nsage: mathematica.N(mathematica.Log(3.5)).sage()\n1.252762968495368\n# Scale up works in Sage:\nsage: 3.5e6.log().n()\n15.0682735264596\n# Doesn't work when translated to to mathematica\nsage: mathematica.N(mathematica.Log(3.5e6)).sage()\nlog(3.5*e6)\n# Possible cause : confusion with SR\nsage: mathematica.N(mathematica.Log(3.5e6)).sage().parent()\nSymbolic Ring\n# Ditto for small values. OK in Sage\nsage: sin(1e-8).n()\n1.00000000000000e-8\n# Fails when converted to mathematica:\nsage: mathematica.N(mathematica.Sin(1e-8)).sage()\n-1.0*sin(-1.0*e + 8.0)\n# Same possible cause\nsage: mathematica.N(mathematica.Sin(1e-8)).sage().parent()\nSymbolic Ring\n```\n\nThe reverse conversion (Mathematica --> Sage) works...\n\n```\nsage: mathematica.N(mathematica.Exp(500))\n1.4035922178528375*^217\nsage: mathematica.N(mathematica.Exp(500)).sage()\n1.4035922178528375e+217\nsage: mathematica.N(mathematica.Exp(-500))\n7.124576406741286*^-218\nsage: mathematica.N(mathematica.Exp(-500)).sage()\n7.124576406741286e-218\n```\n\n...as long as Sage is able to express it:\n\n```\nsage: mathematica.N(mathematica.Exp(1000))\n1.970071114017*^434\nsage: mathematica.N(mathematica.Exp(1000)).sage()\n+infinity\nsage: mathematica.N(mathematica.Exp(-1000))\n5.0759588975495*^-435\nsage: mathematica.N(mathematica.Exp(-1000)).sage()\n0.0\n```\n\nThe latter quantities over/underflow the default Sage floating point systems...\n\n\nCC:  @yuan-zhou\n\nKeywords: **mathematica conversions**\n\nBranch/Commit: **[`37c5e19`](https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Markus Wageringel**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28814_\n\n",
    "closed_at": "2020-09-15T22:00:52Z",
    "created_at": "2019-11-28T14:10:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Conversion of scientific notation floats/RDF,etc... incorrect in Mathematica interface",
    "type": "issue",
    "updated_at": "2020-09-15T22:00:52Z",
    "url": "https://github.com/sagemath/sage/issues/28814",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
Exploration of a problem reported in an [ask.sagemath question](https://ask.sagemath.org/question/48908/how-to-avoid-scientific-notation-of-numbers-in-the-mathematica-interface/).

The conversion of large or small floating point constants (needing scientific notation) to mathematica is incorrect:

```
# Reference
sage: 3.5.log().n()
1.25276296849537
# This works
sage: mathematica.N(mathematica.Log(3.5)).sage()
1.252762968495368
# Scale up works in Sage:
sage: 3.5e6.log().n()
15.0682735264596
# Doesn't work when translated to to mathematica
sage: mathematica.N(mathematica.Log(3.5e6)).sage()
log(3.5*e6)
# Possible cause : confusion with SR
sage: mathematica.N(mathematica.Log(3.5e6)).sage().parent()
Symbolic Ring
# Ditto for small values. OK in Sage
sage: sin(1e-8).n()
1.00000000000000e-8
# Fails when converted to mathematica:
sage: mathematica.N(mathematica.Sin(1e-8)).sage()
-1.0*sin(-1.0*e + 8.0)
# Same possible cause
sage: mathematica.N(mathematica.Sin(1e-8)).sage().parent()
Symbolic Ring
```

The reverse conversion (Mathematica --> Sage) works...

```
sage: mathematica.N(mathematica.Exp(500))
1.4035922178528375*^217
sage: mathematica.N(mathematica.Exp(500)).sage()
1.4035922178528375e+217
sage: mathematica.N(mathematica.Exp(-500))
7.124576406741286*^-218
sage: mathematica.N(mathematica.Exp(-500)).sage()
7.124576406741286e-218
```

...as long as Sage is able to express it:

```
sage: mathematica.N(mathematica.Exp(1000))
1.970071114017*^434
sage: mathematica.N(mathematica.Exp(1000)).sage()
+infinity
sage: mathematica.N(mathematica.Exp(-1000))
5.0759588975495*^-435
sage: mathematica.N(mathematica.Exp(-1000)).sage()
0.0
```

The latter quantities over/underflow the default Sage floating point systems...


CC:  @yuan-zhou

Keywords: **mathematica conversions**

Branch/Commit: **[`37c5e19`](https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2)**

Reviewer: **Dima Pasechnik**

Author: **Markus Wageringel**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/28814_





---

archive/issue_events_397796.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-11-28T14:10:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397796"
}
```



---

archive/issue_events_397797.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-11-28T14:10:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397797"
}
```



---

archive/issue_events_397798.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-11-28T14:10:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397798"
}
```



---

archive/issue_events_397799.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-11-28T14:10:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397799"
}
```



---

archive/issue_events_397800.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-11-28T21:06:38Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "title_is": "Conversion of scientific notation floats/RDF,etc... incorrect in Mathematica interface",
    "title_was": "Conversion of scientific notation floats/RDF,etc... incorrect",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397800"
}
```



---

archive/issue_comments_449332.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAnother workaround to avoid scientific notation:\n\n```\nsage: mathematica.Log(3.5e6.str(no_sci=2)).sage()\n15.068273526459642\n```\nThe overflows might be difficult to avoid since that is a problem of `SR`, and the symbolic ring is the closest thing in Sage that Mathematica expressions can convert to.",
    "created_at": "2019-11-28T21:06:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449332",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:1" align="right">comment:1</div>

Another workaround to avoid scientific notation:

```
sage: mathematica.Log(3.5e6.str(no_sci=2)).sage()
15.068273526459642
```
The overflows might be difficult to avoid since that is a problem of `SR`, and the symbolic ring is the closest thing in Sage that Mathematica expressions can convert to.



---

archive/issue_events_397801.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-11-28T21:06:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397801"
}
```



---

archive/issue_events_397802.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-11-28T21:06:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "c: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397802"
}
```



---

archive/issue_events_397803.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-11-28T21:13:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "c: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397803"
}
```



---

archive/issue_events_397804.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-11-28T21:13:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397804"
}
```



---

archive/issue_comments_449333.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe Mathematica interface is standard (as is Maple's). What is optional is having Mathematica (or Maple) installed...",
    "created_at": "2019-11-28T21:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449333",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:2" align="right">comment:2</div>

The Mathematica interface is standard (as is Maple's). What is optional is having Mathematica (or Maple) installed...



---

archive/issue_events_397805.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2019-11-28T21:13:58Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "subject": "https://github.com/EmmanuelCharpentier",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397805"
}
```



---

archive/issue_comments_449334.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSorry, I must have inavertently assigned this ticket to \"was\".",
    "created_at": "2019-11-28T21:16:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449334",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:3" align="right">comment:3</div>

Sorry, I must have inavertently assigned this ticket to "was".



---

archive/issue_events_397806.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2019-11-28T21:16:06Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "subject": "https://github.com/EmmanuelCharpentier",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397806"
}
```



---

archive/issue_comments_449335.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@mwageringel](#comment:1):\n> Another workaround to avoid scientific notation:\n> \n> ```\n> sage: mathematica.Log(3.5e6.str(no_sci=2)).sage()\n> 15.068273526459642\n> ```\n\nThanks ! I was unaware of this one...\n\n> The overflows might be difficult to avoid since that is a problem of `SR`, and the symbolic ring is the closest thing in Sage that Mathematica expressions can convert to.\n\nIndeed. That's a consequence of [IEE 754](https://fr.wikipedia.org/wiki/IEEE_754). Do we need Mathematica's large-absolute-magnitude floats ?",
    "created_at": "2019-11-28T21:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449335",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@mwageringel](#comment:1):
> Another workaround to avoid scientific notation:
> 
> ```
> sage: mathematica.Log(3.5e6.str(no_sci=2)).sage()
> 15.068273526459642
> ```

Thanks ! I was unaware of this one...

> The overflows might be difficult to avoid since that is a problem of `SR`, and the symbolic ring is the closest thing in Sage that Mathematica expressions can convert to.

Indeed. That's a consequence of [IEE 754](https://fr.wikipedia.org/wiki/IEEE_754). Do we need Mathematica's large-absolute-magnitude floats ?



---

archive/issue_comments_449336.json:
```json
{
    "body": "Commit: **[`af20e1f`](https://github.com/sagemath/sagetrac-mirror/commit/af20e1f8b94d3fdfc8943260e93934fe8bea21c1)**",
    "created_at": "2019-12-21T16:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449336",
    "user": "https://github.com/mwageringel"
}
```

Commit: **[`af20e1f`](https://github.com/sagemath/sagetrac-mirror/commit/af20e1f8b94d3fdfc8943260e93934fe8bea21c1)**



---

archive/issue_events_397807.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-12-21T16:57:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397807"
}
```



---

archive/issue_comments_449337.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@EmmanuelCharpentier](#comment:4):\n> > The overflows might be difficult to avoid since that is a problem of `SR`, and the symbolic ring is the closest thing in Sage that Mathematica expressions can convert to.\n\n> \n> Indeed. That's a consequence of [IEE 754](https://fr.wikipedia.org/wiki/IEEE_754). Do we need Mathematica's large-absolute-magnitude floats ?\n\nActually I was wrong about `SR` \u2013 it does support arbitrary precision floating point numbers. The conversion from Mathematica to Sage treats them as elements of `RDF` before embedding them in `SR`, though. Here is a branch where they are converted to elements of `RealField` instead which automatically chooses a suitable precision.\n\nMoreover, I implemented the conversions from Sage to Mathematica for elements of `RDF`, `CDF`, `RealField` and `ComplexField` in order to handle the scientific notation.\n\n---\n\nThese changes have the potential for some numerical noise. The function `symbolic_expression_from_string` is also used by `SR` to create expressions from strings, so floating point numbers parsed from strings are now backed by `RealField` elements instead of `RDF`. This is also why some tests in sandpiles fail with the current branch.\n\n```\nsage: SR('.3333333333333333333333333333333333333')  # before: internally an element of RDF\n0.3333333333333333\nsage: SR('.3333333333333333333333333333333333333')  # after: now internally an element of RealField\n0.333333333333333333333333333333333333\nsage: SR(.3333333333333333333333333333333333333)    # unaffected by these changes\n0.333333333333333333333333333333333333\n```\n\nIs it ok to change this? It seems desirable to preserve the precision here, but I am not sure if this might have other negative consequences.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af20e1f8b94d3fdfc8943260e93934fe8bea21c1\"><code>af20e1f</code></a></td><td><code>28814: fix Mathematica-conversion of floating-point numbers</code></td></tr></table>\n",
    "created_at": "2019-12-21T16:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449337",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@EmmanuelCharpentier](#comment:4):
> > The overflows might be difficult to avoid since that is a problem of `SR`, and the symbolic ring is the closest thing in Sage that Mathematica expressions can convert to.

> 
> Indeed. That's a consequence of [IEE 754](https://fr.wikipedia.org/wiki/IEEE_754). Do we need Mathematica's large-absolute-magnitude floats ?

Actually I was wrong about `SR` – it does support arbitrary precision floating point numbers. The conversion from Mathematica to Sage treats them as elements of `RDF` before embedding them in `SR`, though. Here is a branch where they are converted to elements of `RealField` instead which automatically chooses a suitable precision.

Moreover, I implemented the conversions from Sage to Mathematica for elements of `RDF`, `CDF`, `RealField` and `ComplexField` in order to handle the scientific notation.

---

These changes have the potential for some numerical noise. The function `symbolic_expression_from_string` is also used by `SR` to create expressions from strings, so floating point numbers parsed from strings are now backed by `RealField` elements instead of `RDF`. This is also why some tests in sandpiles fail with the current branch.

```
sage: SR('.3333333333333333333333333333333333333')  # before: internally an element of RDF
0.3333333333333333
sage: SR('.3333333333333333333333333333333333333')  # after: now internally an element of RealField
0.333333333333333333333333333333333333
sage: SR(.3333333333333333333333333333333333333)    # unaffected by these changes
0.333333333333333333333333333333333333
```

Is it ok to change this? It seems desirable to preserve the precision here, but I am not sure if this might have other negative consequences.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af20e1f8b94d3fdfc8943260e93934fe8bea21c1"><code>af20e1f</code></a></td><td><code>28814: fix Mathematica-conversion of floating-point numbers</code></td></tr></table>




---

archive/issue_comments_449338.json:
```json
{
    "body": "Branch: **[public/28814](https://github.com/sagemath/sagetrac-mirror/tree/public/28814)**",
    "created_at": "2019-12-21T16:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449338",
    "user": "https://github.com/mwageringel"
}
```

Branch: **[public/28814](https://github.com/sagemath/sagetrac-mirror/tree/public/28814)**



---

archive/issue_events_397808.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-12-21T16:57:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397808"
}
```



---

archive/issue_events_397809.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-12-21T16:57:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397809"
}
```



---

archive/issue_comments_449339.json:
```json
{
    "body": "Changed commit from **[`af20e1f`](https://github.com/sagemath/sagetrac-mirror/commit/af20e1f8b94d3fdfc8943260e93934fe8bea21c1)** to **[`0c2b269`](https://github.com/sagemath/sagetrac-mirror/commit/0c2b2696fe173db5fdb9a3110ead0b95c200859f)**",
    "created_at": "2020-02-03T20:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449339",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`af20e1f`](https://github.com/sagemath/sagetrac-mirror/commit/af20e1f8b94d3fdfc8943260e93934fe8bea21c1)** to **[`0c2b269`](https://github.com/sagemath/sagetrac-mirror/commit/0c2b2696fe173db5fdb9a3110ead0b95c200859f)**



---

archive/issue_comments_449340.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e82b76814e91b97dc280c5c18c17385becd6e31\"><code>6e82b76</code></a></td><td><code>28814: fix Mathematica-conversion of floating-point numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c2b2696fe173db5fdb9a3110ead0b95c200859f\"><code>0c2b269</code></a></td><td><code>28814: fix mathematica doctests in sandpiles</code></td></tr></table>\n",
    "created_at": "2020-02-03T20:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449340",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e82b76814e91b97dc280c5c18c17385becd6e31"><code>6e82b76</code></a></td><td><code>28814: fix Mathematica-conversion of floating-point numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c2b2696fe173db5fdb9a3110ead0b95c200859f"><code>0c2b269</code></a></td><td><code>28814: fix mathematica doctests in sandpiles</code></td></tr></table>




---

archive/issue_comments_449341.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI have fixed the remaining doctest failures, so this could be reviewed.",
    "created_at": "2020-02-03T20:04:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449341",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:8" align="right">comment:8</div>

I have fixed the remaining doctest failures, so this could be reviewed.



---

archive/issue_events_397810.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-03T20:04:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397810"
}
```



---

archive/issue_events_397811.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-03T20:04:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397811"
}
```



---

archive/issue_comments_449342.json:
```json
{
    "body": "Author: **Markus Wageringel**",
    "created_at": "2020-02-04T21:23:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449342",
    "user": "https://github.com/mwageringel"
}
```

Author: **Markus Wageringel**



---

archive/issue_events_397812.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397812"
}
```



---

archive/issue_events_397813.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397813"
}
```



---

archive/issue_comments_449343.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nMoving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449343",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_comments_449344.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-09-08T10:40:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449344",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_449345.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTested with Mathematica 12 that comes free on Raspberry Pi 4.\nThere the equivalent of `math` command is `wolfram`, so I created  a symbolic link named `math` in my PATH to point to `wolfram`.  :-)\n\n```\n$ uname -a\nLinux raspberrypi 5.4.51-v7l+ #1333 SMP Mon Aug 10 16:51:40 BST 2020 armv7l GNU/Linux\n$ ls -l `which math`\nlrwxrwxrwx 1 pi pi 16 Sep  8 11:22 /home/pi/bin/math -> /usr/bin/wolfram\n```",
    "created_at": "2020-09-08T10:40:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449345",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Tested with Mathematica 12 that comes free on Raspberry Pi 4.
There the equivalent of `math` command is `wolfram`, so I created  a symbolic link named `math` in my PATH to point to `wolfram`.  :-)

```
$ uname -a
Linux raspberrypi 5.4.51-v7l+ #1333 SMP Mon Aug 10 16:51:40 BST 2020 armv7l GNU/Linux
$ ls -l `which math`
lrwxrwxrwx 1 pi pi 16 Sep  8 11:22 /home/pi/bin/math -> /usr/bin/wolfram
```



---

archive/issue_events_397814.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-08T10:40:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397814"
}
```



---

archive/issue_events_397815.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-08T10:40:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397815"
}
```



---

archive/issue_events_397816.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-09-08T17:07:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397816"
}
```



---

archive/issue_events_397817.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-09-08T17:07:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397817"
}
```



---

archive/issue_comments_449346.json:
```json
{
    "body": "Changed commit from **[`0c2b269`](https://github.com/sagemath/sagetrac-mirror/commit/0c2b2696fe173db5fdb9a3110ead0b95c200859f)** to **[`37c5e19`](https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2)**",
    "created_at": "2020-09-08T17:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449346",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0c2b269`](https://github.com/sagemath/sagetrac-mirror/commit/0c2b2696fe173db5fdb9a3110ead0b95c200859f)** to **[`37c5e19`](https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2)**



---

archive/issue_comments_449347.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6cd28b3b4909ed8ba4a109d9931b0d7657bad2f\"><code>b6cd28b</code></a></td><td><code>28814: Merge tag '9.2.beta12' into #28814</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2\"><code>37c5e19</code></a></td><td><code>28814: fix libgiac doctest</code></td></tr></table>\n",
    "created_at": "2020-09-08T17:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449347",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6cd28b3b4909ed8ba4a109d9931b0d7657bad2f"><code>b6cd28b</code></a></td><td><code>28814: Merge tag '9.2.beta12' into #28814</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2"><code>37c5e19</code></a></td><td><code>28814: fix libgiac doctest</code></td></tr></table>




---

archive/issue_comments_449348.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSorry, there was a failing doctest in the file `src/sage/libs/giac/giac.pyx` which has recently been added. The failure was due to the fact that, after this ticket, `SR('1.3')` is equivalent to `SR(RR('1.3'))` rather than `SR(RDF('1.3'))`.\n\nNice to see that this work with a Raspberry Pi. On Linux, the `math` and `wolfram` scripts appear to be equal. I cannot find any documentation about `math`, so perhaps we should just replace it by `wolfram` \u2013 though, I am not sure about the situation on other platforms.",
    "created_at": "2020-09-08T17:08:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449348",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:14" align="right">comment:14</div>

Sorry, there was a failing doctest in the file `src/sage/libs/giac/giac.pyx` which has recently been added. The failure was due to the fact that, after this ticket, `SR('1.3')` is equivalent to `SR(RR('1.3'))` rather than `SR(RDF('1.3'))`.

Nice to see that this work with a Raspberry Pi. On Linux, the `math` and `wolfram` scripts appear to be equal. I cannot find any documentation about `math`, so perhaps we should just replace it by `wolfram` – though, I am not sure about the situation on other platforms.



---

archive/issue_comments_449349.json:
```json
{
    "body": "Changed stopgaps from **Cast those inconvenient quantities to rationals** to none",
    "created_at": "2020-09-08T17:08:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449349",
    "user": "https://github.com/mwageringel"
}
```

Changed stopgaps from **Cast those inconvenient quantities to rationals** to none



---

archive/issue_comments_449350.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@dimpase](#comment:12):\n> Tested with Mathematica 12 that comes free on Raspberry Pi 4.\n> There the equivalent of `math` command is `wolfram`, so I created  a symbolic link named `math` in my PATH to point to `wolfram`.  :-)\n> \n> ```\n> $ uname -a\n> Linux raspberrypi 5.4.51-v7l+ #1333 SMP Mon Aug 10 16:51:40 BST 2020 armv7l GNU/Linux\n> $ ls -l `which math`\n> lrwxrwxrwx 1 pi pi 16 Sep  8 11:22 /home/pi/bin/math -> /usr/bin/wolfram\n> ```\n\nImagine a Beowulf cluster of these!",
    "created_at": "2020-09-08T17:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449350",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@dimpase](#comment:12):
> Tested with Mathematica 12 that comes free on Raspberry Pi 4.
> There the equivalent of `math` command is `wolfram`, so I created  a symbolic link named `math` in my PATH to point to `wolfram`.  :-)
> 
> ```
> $ uname -a
> Linux raspberrypi 5.4.51-v7l+ #1333 SMP Mon Aug 10 16:51:40 BST 2020 armv7l GNU/Linux
> $ ls -l `which math`
> lrwxrwxrwx 1 pi pi 16 Sep  8 11:22 /home/pi/bin/math -> /usr/bin/wolfram
> ```

Imagine a Beowulf cluster of these!



---

archive/issue_comments_449351.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@mwageringel](#comment:14):\n> Sorry, there was a failing doctest in the file `src/sage/libs/giac/giac.pyx` which has recently been added. The failure was due to the fact that, after this ticket, `SR('1.3')` is equivalent to `SR(RR('1.3'))` rather than `SR(RDF('1.3'))`.\n> \n> Nice to see that this work with a Raspberry Pi. On Linux, the `math` and `wolfram` scripts appear to be equal. I cannot find any documentation about `math`, so perhaps we should just replace it by `wolfram` \u2013 though, I am not sure about the situation on other platforms.\n\n`math` was the name  until some versions ago, then in version 11 (or maybe earlier) one got both wolfram and math.\n\nPerhaps, add a runtime check for the correct name?",
    "created_at": "2020-09-08T18:20:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449351",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@mwageringel](#comment:14):
> Sorry, there was a failing doctest in the file `src/sage/libs/giac/giac.pyx` which has recently been added. The failure was due to the fact that, after this ticket, `SR('1.3')` is equivalent to `SR(RR('1.3'))` rather than `SR(RDF('1.3'))`.
> 
> Nice to see that this work with a Raspberry Pi. On Linux, the `math` and `wolfram` scripts appear to be equal. I cannot find any documentation about `math`, so perhaps we should just replace it by `wolfram` – though, I am not sure about the situation on other platforms.

`math` was the name  until some versions ago, then in version 11 (or maybe earlier) one got both wolfram and math.

Perhaps, add a runtime check for the correct name?



---

archive/issue_comments_449352.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOn macOS, neither is provided; one needs to use `/Applications/Mathematica.app/Contents//MacOS/WolframKernel`",
    "created_at": "2020-09-08T18:24:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449352",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

On macOS, neither is provided; one needs to use `/Applications/Mathematica.app/Contents//MacOS/WolframKernel`



---

archive/issue_comments_449353.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mwageringel](#comment:14):\n> Sorry, there was a failing doctest in the file `src/sage/libs/giac/giac.pyx` which has recently been added. The failure was due to the fact that, after this ticket, `SR('1.3')` is equivalent to `SR(RR('1.3'))` rather than `SR(RDF('1.3'))`.\n\nOK, this works.",
    "created_at": "2020-09-08T18:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449353",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mwageringel](#comment:14):
> Sorry, there was a failing doctest in the file `src/sage/libs/giac/giac.pyx` which has recently been added. The failure was due to the fact that, after this ticket, `SR('1.3')` is equivalent to `SR(RR('1.3'))` rather than `SR(RDF('1.3'))`.

OK, this works.



---

archive/issue_events_397818.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-08T18:40:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397818"
}
```



---

archive/issue_events_397819.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-08T18:40:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397819"
}
```



---

archive/issue_comments_449354.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThank you.",
    "created_at": "2020-09-08T19:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449354",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:19" align="right">comment:19</div>

Thank you.



---

archive/issue_events_397820.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-15T22:00:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397820"
}
```



---

archive/issue_events_397821.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0e79ab3e4ca4c895e19074a85213a79e231e51b8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-09-15T22:00:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28814#event-397821"
}
```



---

archive/issue_comments_449355.json:
```json
{
    "body": "Changed branch from **[public/28814](https://github.com/sagemath/sagetrac-mirror/tree/public/28814)** to **[`37c5e19`](https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2)**",
    "created_at": "2020-09-15T22:00:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28814",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28814#issuecomment-449355",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/28814](https://github.com/sagemath/sagetrac-mirror/tree/public/28814)** to **[`37c5e19`](https://github.com/sagemath/sagetrac-mirror/commit/37c5e193d9229517fd24be077f2e6cf2fc82b9b2)**
