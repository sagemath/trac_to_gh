# Issue 28698: py3: HTML documentation for GlobalOptions does not show up correctly

archive/issues_028461.json:
```json
{
    "body": "With Python 3, the HTML documentation for `GlobalOptions` does not show the docstring, but something else. For example in the case of `QQbar.options`, this is what gets displayed:\n\n```\noptions = Current options for AlgebraicField - display_format: decimal\n```\nThis is what is called \"String form\" in the introspection `QQbar.options?`.\n\nWith Python 2, the HTML documentation shows the \"Docstring\" as desired:\n\n```\noptions(*get_value, **set_value)\nOPTIONS:\n\n* \"display_format\" -- (default: \"decimal\")\n\n  * \"decimal\" -- Always display a decimal approximation\n\n  * \"radical\" -- Display using radicals (if possible)\n\nSee \"GlobalOptions\" for more features of these options.\n```\n\nThis is not unique to `QQbar`, but can also be seen with `Tableaux.options`, for instance.\n\nCC:  @kwankyu\n\nBranch/Commit: 16b5e119b4db974e0f180c0fcd3f87d04022a446\n\nReviewer: Markus Wageringel\n\nAuthor: Kwankyu Lee\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28698\n\n",
    "closed_at": "2019-11-24T16:58:49Z",
    "created_at": "2019-11-06T19:35:11Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "py3: HTML documentation for GlobalOptions does not show up correctly",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28698",
    "user": "https://github.com/mwageringel"
}
```
With Python 3, the HTML documentation for `GlobalOptions` does not show the docstring, but something else. For example in the case of `QQbar.options`, this is what gets displayed:

```
options = Current options for AlgebraicField - display_format: decimal
```
This is what is called "String form" in the introspection `QQbar.options?`.

With Python 2, the HTML documentation shows the "Docstring" as desired:

```
options(*get_value, **set_value)
OPTIONS:

* "display_format" -- (default: "decimal")

  * "decimal" -- Always display a decimal approximation

  * "radical" -- Display using radicals (if possible)

See "GlobalOptions" for more features of these options.
```

This is not unique to `QQbar`, but can also be seen with `Tableaux.options`, for instance.

CC:  @kwankyu

Branch/Commit: 16b5e119b4db974e0f180c0fcd3f87d04022a446

Reviewer: Markus Wageringel

Author: Kwankyu Lee

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28698





---

archive/issue_comments_557071.json:
```json
{
    "body": "<a id='comment:1'></a>Can you provide more details? From the Sage command line or from the Jupyter notebook, if I type `QQbar.options?`, I see the same thing in Python 2 or Python 3.",
    "created_at": "2019-11-06T19:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557071",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>Can you provide more details? From the Sage command line or from the Jupyter notebook, if I type `QQbar.options?`, I see the same thing in Python 2 or Python 3.



---

archive/issue_comments_557072.json:
```json
{
    "body": "<a id='comment:2'></a>It is displayed correctly on the command line. The problem is with the HTML files that get generated as part of the documentation. Currently, the problem can be seen here online: [Python 2](http://doc.sagemath.org/html/en/reference/number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField_common.options)/[Python 3](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField_common.options).",
    "created_at": "2019-11-06T19:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557072",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:2'></a>It is displayed correctly on the command line. The problem is with the HTML files that get generated as part of the documentation. Currently, the problem can be seen here online: [Python 2](http://doc.sagemath.org/html/en/reference/number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField_common.options)/[Python 3](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField_common.options).



---

archive/issue_comments_557073.json:
```json
{
    "body": "<a id='comment:3'></a>I confirm the bug in Sage 9.0.beta4 (Python 3 version). It holds for `Manifold.options` as well.",
    "created_at": "2019-11-06T21:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557073",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'></a>I confirm the bug in Sage 9.0.beta4 (Python 3 version). It holds for `Manifold.options` as well.



---

archive/issue_comments_557074.json:
```json
{
    "body": "<a id='comment:4'></a>The following (non-sensical) change in `sage_autodoc.AttributeDocumenter.can_document_member` appears to fix this problem.\n\n```diff\n--- a/src/sage_setup/docbuild/ext/sage_autodoc.py\n+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py\n@@ -1477,17 +1477,17 @@ class AttributeDocumenter(DocstringStripSignatureMixin, ClassLevelDocumenter):\n\n         isattribute = isdatadesc or (not isinstance(parent, ModuleDocumenter) and isattr)\n\n         # Trac #26522: This condition is here just to pass objects of classes\n         # that inherit ClasscallMetaclass as attributes rather than method\n         # descriptors.\n         isattribute = isattribute or isinstance(type(member), ClasscallMetaclass)\n\n-        if PY2:\n+        if PY2 or True:\n             return isattribute\n\n         # That last condition addresses an obscure case of C-defined\n         # methods using a deprecated type in Python 3, that is not otherwise\n         # exported anywhere by Python\n         return isattribute or (not isinstance(parent, ModuleDocumenter) and\n                               not inspect.isroutine(member) and\n                               not isinstance(member, type))\n```\n\nThe problem is that `sage_autodoc` determines that `QQbar.options` should be documented as an attribute rather than a function, in Python 3, because the expression in the last return statement is true.\n\nNote that `class options(GlobalOptions)` does not create a subclass, but an instance of `GlobalOptions` by some magic, so it acually is an attribute, which nevertheless should not be documented as such.\n\nAlso note that `sage_autodoc` is a modified copy of [Sphinx' autodoc](https://github.com/sphinx-doc/sphinx/blob/v1.8.5/sphinx/ext/autodoc/__init__.py#L1383-L1396). The problematic expression has not been added by Sage, but is part of the upstream version. The PY2-check was added in #26949 when `sage_autodoc` was updated to be more in line with the upstream version (which is Python-3-only I assume).\n\nAny ideas how to solve this? It would be good if we could avoid adding a special case for `GlobalOptions` and also avoid deviating from upstream too much.",
    "created_at": "2019-11-09T11:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557074",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:4'></a>The following (non-sensical) change in `sage_autodoc.AttributeDocumenter.can_document_member` appears to fix this problem.

```diff
--- a/src/sage_setup/docbuild/ext/sage_autodoc.py
+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py
@@ -1477,17 +1477,17 @@ class AttributeDocumenter(DocstringStripSignatureMixin, ClassLevelDocumenter):

         isattribute = isdatadesc or (not isinstance(parent, ModuleDocumenter) and isattr)

         # Trac #26522: This condition is here just to pass objects of classes
         # that inherit ClasscallMetaclass as attributes rather than method
         # descriptors.
         isattribute = isattribute or isinstance(type(member), ClasscallMetaclass)

-        if PY2:
+        if PY2 or True:
             return isattribute

         # That last condition addresses an obscure case of C-defined
         # methods using a deprecated type in Python 3, that is not otherwise
         # exported anywhere by Python
         return isattribute or (not isinstance(parent, ModuleDocumenter) and
                               not inspect.isroutine(member) and
                               not isinstance(member, type))
```

The problem is that `sage_autodoc` determines that `QQbar.options` should be documented as an attribute rather than a function, in Python 3, because the expression in the last return statement is true.

Note that `class options(GlobalOptions)` does not create a subclass, but an instance of `GlobalOptions` by some magic, so it acually is an attribute, which nevertheless should not be documented as such.

Also note that `sage_autodoc` is a modified copy of [Sphinx' autodoc](https://github.com/sphinx-doc/sphinx/blob/v1.8.5/sphinx/ext/autodoc/__init__.py#L1383-L1396). The problematic expression has not been added by Sage, but is part of the upstream version. The PY2-check was added in #26949 when `sage_autodoc` was updated to be more in line with the upstream version (which is Python-3-only I assume).

Any ideas how to solve this? It would be good if we could avoid adding a special case for `GlobalOptions` and also avoid deviating from upstream too much.



---

archive/issue_comments_557075.json:
```json
{
    "body": "<a id='comment:5'></a>`@`klee: any suggestions?",
    "created_at": "2019-11-09T23:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557075",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>`@`klee: any suggestions?



---

archive/issue_comments_557076.json:
```json
{
    "body": "Changing author from \"\" to \"Kwankyu Lee\"",
    "created_at": "2019-11-14T04:57:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557076",
    "user": "https://github.com/kwankyu"
}
```

Changing author from "" to "Kwankyu Lee"



---

archive/issue_comments_557077.json:
```json
{
    "body": "Changing branch from \"\" to \"u/klee/28698\"",
    "created_at": "2019-11-14T04:57:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557077",
    "user": "https://github.com/kwankyu"
}
```

Changing branch from "" to "u/klee/28698"



---

archive/issue_comments_557078.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-14T04:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557078",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_557079.json:
```json
{
    "body": "Changing commit from \"\" to \"16b5e119b4db974e0f180c0fcd3f87d04022a446\"",
    "created_at": "2019-11-14T04:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557079",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "16b5e119b4db974e0f180c0fcd3f87d04022a446"



---

archive/issue_comments_557080.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [gh-mwageringel](#comment%3A4):\n> Any ideas how to solve this? It would be good if we could avoid adding a special case for `GlobalOptions` and also avoid deviating from upstream too much.\n\n\nThe problem is that `GlobalOptions` attribute get documented by `AttributeDocumenter` unlike by `FunctionDocumenter` in python 2. This  is because of the extra check for \"obscure case\" in python 3.\n\nI don't clearly understand what the \"obscure case\" is. Anyway, the extra check is apparently doing more harm than good to sage documentation. In the patch, I turned off that check, as you originally suggested. I expect the generated documentation is more close to the version in python 2. \n\nWe need to examine the generated documentation to see if there is any regression from the version in python 2.",
    "created_at": "2019-11-14T05:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557080",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:8'></a>Replying to [gh-mwageringel](#comment%3A4):
> Any ideas how to solve this? It would be good if we could avoid adding a special case for `GlobalOptions` and also avoid deviating from upstream too much.


The problem is that `GlobalOptions` attribute get documented by `AttributeDocumenter` unlike by `FunctionDocumenter` in python 2. This  is because of the extra check for "obscure case" in python 3.

I don't clearly understand what the "obscure case" is. Anyway, the extra check is apparently doing more harm than good to sage documentation. In the patch, I turned off that check, as you originally suggested. I expect the generated documentation is more close to the version in python 2. 

We need to examine the generated documentation to see if there is any regression from the version in python 2.



---

archive/issue_comments_557081.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-11-14T06:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557081",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_557082.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2019-11-16T14:51:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557082",
    "user": "https://github.com/mwageringel"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_557083.json:
```json
{
    "body": "<a id='comment:10'></a>I ran a diff on the generated html files before and after the patch using Python 3. The change mainly affects all the `options` classes that are now documented as function rather than attribute.\n\nBesides `options`, there are two or three cases where the documentation also switched from attribute to function, for example\n\n[FiniteStateMachine.default_format_letter](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FiniteStateMachine.default_format_letter)\n\nwhich is just an alias to an imported function\n\n```\n    default_format_letter = latex\n```\nso `default_format_letter` now shows the documentation from `latex`, which seems correct.\n\nHowever, this patch also affects a number of attributes that completely disappear from the documentation after the patch, for example:\n\n[AbstractGrowthGroupFunctor.rank](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor.rank),\n[GenericGrowthGroup.CartesianProduct](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.GenericGrowthGroup.CartesianProduct),\n[GenericSymbolicSubringFunctor.coercion_reversed](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/calculus/sage/symbolic/subring.html#sage.symbolic.subring.GenericSymbolicSubringFunctor.coercion_reversed),\n[CartesianProductFunctor.symbol](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/categories/sage/categories/cartesian_product.html#sage.categories.cartesian_product.CartesianProductFunctor.symbol),\n[A000027.link](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/sloane_functions.html#sage.combinat.sloane_functions.A000027.link),\n[CNFEncoder.permutations](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/sat/sage/sat/converters/polybori.html#sage.sat.converters.polybori.CNFEncoder.permutations)\n\nAre these supposed to appear in the documentation or not? Most of them do not have documentation strings attached to them, but some do (possibly unintentionally), for example:\n\n[FSMState.initial_probability](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FSMState.initial_probability)",
    "created_at": "2019-11-16T14:51:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557083",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:10'></a>I ran a diff on the generated html files before and after the patch using Python 3. The change mainly affects all the `options` classes that are now documented as function rather than attribute.

Besides `options`, there are two or three cases where the documentation also switched from attribute to function, for example

[FiniteStateMachine.default_format_letter](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FiniteStateMachine.default_format_letter)

which is just an alias to an imported function

```
    default_format_letter = latex
```
so `default_format_letter` now shows the documentation from `latex`, which seems correct.

However, this patch also affects a number of attributes that completely disappear from the documentation after the patch, for example:

[AbstractGrowthGroupFunctor.rank](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor.rank),
[GenericGrowthGroup.CartesianProduct](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.GenericGrowthGroup.CartesianProduct),
[GenericSymbolicSubringFunctor.coercion_reversed](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/calculus/sage/symbolic/subring.html#sage.symbolic.subring.GenericSymbolicSubringFunctor.coercion_reversed),
[CartesianProductFunctor.symbol](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/categories/sage/categories/cartesian_product.html#sage.categories.cartesian_product.CartesianProductFunctor.symbol),
[A000027.link](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/sloane_functions.html#sage.combinat.sloane_functions.A000027.link),
[CNFEncoder.permutations](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/sat/sage/sat/converters/polybori.html#sage.sat.converters.polybori.CNFEncoder.permutations)

Are these supposed to appear in the documentation or not? Most of them do not have documentation strings attached to them, but some do (possibly unintentionally), for example:

[FSMState.initial_probability](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FSMState.initial_probability)



---

archive/issue_comments_557084.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [gh-mwageringel](#comment%3A10):\n> I ran a diff on the generated html files before and after the patch using Python 3. \n\n\nThanks.\n\n> The change mainly affects all the `options` classes that are now documented as function rather than attribute.\n\n\nGood.\n\n> Besides `options`, there are two or three cases where the documentation also switched from attribute to function, for example\n> \n> [FiniteStateMachine.default_format_letter](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FiniteStateMachine.default_format_letter)\n> \n> which is just an alias to an imported function\n> \n> ```\n>     default_format_letter = latex\n> ```\n> so `default_format_letter` now shows the documentation from `latex`, which seems correct.\n\n\nSeems ok.\n\n> However, this patch also affects a number of attributes that completely disappear from the documentation after the patch, for example:\n> \n> [AbstractGrowthGroupFunctor.rank](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor.rank),\n> [GenericGrowthGroup.CartesianProduct](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.GenericGrowthGroup.CartesianProduct),\n> [GenericSymbolicSubringFunctor.coercion_reversed](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/calculus/sage/symbolic/subring.html#sage.symbolic.subring.GenericSymbolicSubringFunctor.coercion_reversed),\n> [CartesianProductFunctor.symbol](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/categories/sage/categories/cartesian_product.html#sage.categories.cartesian_product.CartesianProductFunctor.symbol),\n> [A000027.link](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/sloane_functions.html#sage.combinat.sloane_functions.A000027.link),\n> [CNFEncoder.permutations](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/sat/sage/sat/converters/polybori.html#sage.sat.converters.polybori.CNFEncoder.permutations)\n> \n> Are these supposed to appear in the documentation or not? \n\n\nThey did not appear in python 2 documentation, but started to appear in python 3 documentation by #26949, perhaps because of the extra check in `AttributeDocumenter`. So I think they should not appear in the documentation. I regard this as an improvement.\n\n>Most of them do not have documentation strings attached to them, but some do (possibly unintentionally), for example:\n>> \n>> [FSMState.initial_probability](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FSMState.initial_probability)\n\n\nThis example is interesting. \n\nThe attribute `initial_probability` did have docstring, but as of sage 9.0.beta4, the docstring is removed, or rather moved into the class (`FSMState`) docstring. This is why `initial_probability` (and `is_initial`) disappeared from the python 3 documentation. \n\nThen why the docstring was moved to class docstring? Perhaps because the attribute docstrings do not get doctested. I think this is a defect of sage doctesting -- the original docstring was nice!\n\nTo summarize, I see no regression from your report.",
    "created_at": "2019-11-18T01:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557084",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:11'></a>Replying to [gh-mwageringel](#comment%3A10):
> I ran a diff on the generated html files before and after the patch using Python 3. 


Thanks.

> The change mainly affects all the `options` classes that are now documented as function rather than attribute.


Good.

> Besides `options`, there are two or three cases where the documentation also switched from attribute to function, for example
> 
> [FiniteStateMachine.default_format_letter](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FiniteStateMachine.default_format_letter)
> 
> which is just an alias to an imported function
> 
> ```
>     default_format_letter = latex
> ```
> so `default_format_letter` now shows the documentation from `latex`, which seems correct.


Seems ok.

> However, this patch also affects a number of attributes that completely disappear from the documentation after the patch, for example:
> 
> [AbstractGrowthGroupFunctor.rank](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor.rank),
> [GenericGrowthGroup.CartesianProduct](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/asymptotic/sage/rings/asymptotic/growth_group.html#sage.rings.asymptotic.growth_group.GenericGrowthGroup.CartesianProduct),
> [GenericSymbolicSubringFunctor.coercion_reversed](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/calculus/sage/symbolic/subring.html#sage.symbolic.subring.GenericSymbolicSubringFunctor.coercion_reversed),
> [CartesianProductFunctor.symbol](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/categories/sage/categories/cartesian_product.html#sage.categories.cartesian_product.CartesianProductFunctor.symbol),
> [A000027.link](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/sloane_functions.html#sage.combinat.sloane_functions.A000027.link),
> [CNFEncoder.permutations](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/sat/sage/sat/converters/polybori.html#sage.sat.converters.polybori.CNFEncoder.permutations)
> 
> Are these supposed to appear in the documentation or not? 


They did not appear in python 2 documentation, but started to appear in python 3 documentation by #26949, perhaps because of the extra check in `AttributeDocumenter`. So I think they should not appear in the documentation. I regard this as an improvement.

>Most of them do not have documentation strings attached to them, but some do (possibly unintentionally), for example:
>> 
>> [FSMState.initial_probability](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/combinat/sage/combinat/finite_state_machine.html#sage.combinat.finite_state_machine.FSMState.initial_probability)


This example is interesting. 

The attribute `initial_probability` did have docstring, but as of sage 9.0.beta4, the docstring is removed, or rather moved into the class (`FSMState`) docstring. This is why `initial_probability` (and `is_initial`) disappeared from the python 3 documentation. 

Then why the docstring was moved to class docstring? Perhaps because the attribute docstrings do not get doctested. I think this is a defect of sage doctesting -- the original docstring was nice!

To summarize, I see no regression from your report.



---

archive/issue_comments_557085.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-11-18T01:46:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557085",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_557086.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Markus Wageringel\"",
    "created_at": "2019-11-18T21:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557086",
    "user": "https://github.com/mwageringel"
}
```

Changing reviewer from "" to "Markus Wageringel"



---

archive/issue_comments_557087.json:
```json
{
    "body": "<a id='comment:13'></a>Ok, thank you for the explanations. Considering that the documentation in Python 3 now seems to agree with the usual Python 2 documentation, this is good to go then.",
    "created_at": "2019-11-18T21:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557087",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:13'></a>Ok, thank you for the explanations. Considering that the documentation in Python 3 now seems to agree with the usual Python 2 documentation, this is good to go then.



---

archive/issue_comments_557088.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-11-18T21:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557088",
    "user": "https://github.com/mwageringel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_072305.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-11-24T16:58:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28698#event-72305"
}
```



---

archive/issue_comments_557089.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-11-24T16:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557089",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_557090.json:
```json
{
    "body": "Changing branch from \"u/klee/28698\" to \"16b5e119b4db974e0f180c0fcd3f87d04022a446\"",
    "created_at": "2019-11-24T16:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28698#issuecomment-557090",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/klee/28698" to "16b5e119b4db974e0f180c0fcd3f87d04022a446"
