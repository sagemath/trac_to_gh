# Issue 28762: 2 doctests failed in cmdline.py related to rst2ipynb

archive/issues_028525.json:
```json
{
    "body": "With 9.0.beta6, Release Date: 2019-11-18, the following\n\n```\nsage -t --optional=sage,optional,external src/sage/tests/cmdline.py\n```\n\ngives\n\n```\nsage -t src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 658, in sage.tests.cmdline.test_executable\nFailed example:\n    print(out)                           # optional - rst2ipynb\nExpected:\n    {\n     \"nbformat_minor\": ...,\n     \"nbformat\": ...,\n     \"cells\": [\n      {\n       \"source\": [\n        \"$$\\n\",\n        \"\\\\def\\\\CC{\\\\bf C}\\n\",\n        \"\\\\def\\\\QQ{\\\\bf Q}\\n\",\n        \"\\\\def\\\\RR{\\\\bf R}\\n\",\n        \"\\\\def\\\\ZZ{\\\\bf Z}\\n\",\n        \"\\\\def\\\\NN{\\\\bf N}\\n\",\n        \"$$\"\n       ],\n       \"cell_type\": \"markdown\",\n       \"metadata\": {}\n      },\n      {\n       \"execution_count\": null,\n       \"cell_type\": \"code\",\n       \"source\": [\n        \"2^10\"\n       ],\n       \"outputs\": [\n        {\n         \"execution_count\": 1,\n         \"output_type\": \"execute_result\",\n         \"data\": {\n          \"text/plain\": [\n           \"1024\"\n          ]\n         },\n         \"metadata\": {}\n        }\n       ],\n       \"metadata\": {}\n      },\n      {\n       \"execution_count\": null,\n       \"cell_type\": \"code\",\n       \"source\": [\n        \"2 + 2\"\n       ],\n       \"outputs\": [\n        {\n         \"execution_count\": 1,\n         \"output_type\": \"execute_result\",\n         \"data\": {\n          \"text/plain\": [\n           \"4\"\n          ]\n         },\n         \"metadata\": {}\n        }\n       ],\n       \"metadata\": {}\n      }\n     ],\n     \"metadata\": {\n      \"kernelspec\": {\n       \"display_name\": \"sagemath\",\n       \"name\": \"sagemath\"\n      }\n     }\n    }\nGot:\n    {\n     \"cells\": [\n      {\n       \"cell_type\": \"markdown\",\n       \"metadata\": {},\n       \"source\": [\n        \"$$\\n\",\n        \"\\\\def\\\\CC{\\\\bf C}\\n\",\n        \"\\\\def\\\\QQ{\\\\bf Q}\\n\",\n        \"\\\\def\\\\RR{\\\\bf R}\\n\",\n        \"\\\\def\\\\ZZ{\\\\bf Z}\\n\",\n        \"\\\\def\\\\NN{\\\\bf N}\\n\",\n        \"$$\"\n       ]\n      },\n      {\n       \"cell_type\": \"code\",\n       \"execution_count\": null,\n       \"metadata\": {},\n       \"outputs\": [\n        {\n         \"data\": {\n          \"text/plain\": [\n           \"1024\"\n          ]\n         },\n         \"execution_count\": 1,\n         \"metadata\": {},\n         \"output_type\": \"execute_result\"\n        }\n       ],\n       \"source\": [\n        \"2^10\"\n       ]\n      },\n      {\n       \"cell_type\": \"code\",\n       \"execution_count\": null,\n       \"metadata\": {},\n       \"outputs\": [\n        {\n         \"data\": {\n          \"text/plain\": [\n           \"4\"\n          ]\n         },\n         \"execution_count\": 1,\n         \"metadata\": {},\n         \"output_type\": \"execute_result\"\n        }\n       ],\n       \"source\": [\n        \"2 + 2\"\n       ]\n      }\n     ],\n     \"metadata\": {\n      \"kernelspec\": {\n       \"display_name\": \"sagemath\",\n       \"name\": \"sagemath\"\n      }\n     },\n     \"nbformat\": 4,\n     \"nbformat_minor\": 2\n    }\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 739, in sage.tests.cmdline.test_executable\nFailed example:\n    print(open(output, 'r').read()) # optional - rst2ipynb\nExpected:\n    {\n     \"nbformat_minor\": ...,\n     \"nbformat\": ...,\n     \"cells\": [\n      {\n       \"source\": [\n        \"$$\\n\",\n        \"\\\\def\\\\CC{\\\\bf C}\\n\",\n        \"\\\\def\\\\QQ{\\\\bf Q}\\n\",\n    ...\n     \"metadata\": {\n      \"kernelspec\": {\n       \"display_name\": \"sagemath\",\n       \"name\": \"sagemath\"\n      }\n     }\n    }\nGot:\n    {\n     \"cells\": [\n      {\n       \"cell_type\": \"markdown\",\n       \"metadata\": {},\n       \"source\": [\n        \"$$\\n\",\n        \"\\\\def\\\\CC{\\\\bf C}\\n\",\n        \"\\\\def\\\\QQ{\\\\bf Q}\\n\",\n        \"\\\\def\\\\RR{\\\\bf R}\\n\",\n        \"\\\\def\\\\ZZ{\\\\bf Z}\\n\",\n        \"\\\\def\\\\NN{\\\\bf N}\\n\",\n        \"$$\"\n       ]\n      },\n      {\n       \"cell_type\": \"code\",\n       \"execution_count\": null,\n       \"metadata\": {},\n       \"outputs\": [\n        {\n         \"data\": {\n          \"text/plain\": [\n           \"1024\"\n          ]\n         },\n         \"execution_count\": 1,\n         \"metadata\": {},\n         \"output_type\": \"execute_result\"\n        }\n       ],\n       \"source\": [\n        \"2^10\"\n       ]\n      },\n      {\n       \"cell_type\": \"code\",\n       \"execution_count\": null,\n       \"metadata\": {},\n       \"outputs\": [\n        {\n         \"data\": {\n          \"text/plain\": [\n           \"4\"\n          ]\n         },\n         \"execution_count\": 1,\n         \"metadata\": {},\n         \"output_type\": \"execute_result\"\n        }\n       ],\n       \"source\": [\n        \"2 + 2\"\n       ]\n      }\n     ],\n     \"metadata\": {\n      \"kernelspec\": {\n       \"display_name\": \"sagemath\",\n       \"name\": \"sagemath\"\n      }\n     },\n     \"nbformat\": 4,\n     \"nbformat_minor\": 2\n    }\n**********************************************************************\n1 item had failures:\n   2 of 249 in sage.tests.cmdline.test_executable\n    [248 tests, 2 failures, 29.00 s]\n----------------------------------------------------------------------\nsage -t src/sage/tests/cmdline.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 29.2 seconds\n    cpu time: 0.3 seconds\n    cumulative wall time: 29.0 seconds\nExternal software detected for doctesting: internet,pandoc\n```\n\nCC:  tmonteil\n\nBranch/Commit: a8ec0ca1c519a6cc19e2d7c8112d2ff05b159b37\n\nReviewer: Travis Scrimshaw\n\nAuthor: S\u00e9bastien Labb\u00e9\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28762\n\n",
    "closed_at": "2019-12-11T21:46:26Z",
    "created_at": "2019-11-19T08:59:34Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "2 doctests failed in cmdline.py related to rst2ipynb",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28762",
    "user": "https://github.com/seblabbe"
}
```
With 9.0.beta6, Release Date: 2019-11-18, the following

```
sage -t --optional=sage,optional,external src/sage/tests/cmdline.py
```

gives

```
sage -t src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 658, in sage.tests.cmdline.test_executable
Failed example:
    print(out)                           # optional - rst2ipynb
Expected:
    {
     "nbformat_minor": ...,
     "nbformat": ...,
     "cells": [
      {
       "source": [
        "$$\n",
        "\\def\\CC{\\bf C}\n",
        "\\def\\QQ{\\bf Q}\n",
        "\\def\\RR{\\bf R}\n",
        "\\def\\ZZ{\\bf Z}\n",
        "\\def\\NN{\\bf N}\n",
        "$$"
       ],
       "cell_type": "markdown",
       "metadata": {}
      },
      {
       "execution_count": null,
       "cell_type": "code",
       "source": [
        "2^10"
       ],
       "outputs": [
        {
         "execution_count": 1,
         "output_type": "execute_result",
         "data": {
          "text/plain": [
           "1024"
          ]
         },
         "metadata": {}
        }
       ],
       "metadata": {}
      },
      {
       "execution_count": null,
       "cell_type": "code",
       "source": [
        "2 + 2"
       ],
       "outputs": [
        {
         "execution_count": 1,
         "output_type": "execute_result",
         "data": {
          "text/plain": [
           "4"
          ]
         },
         "metadata": {}
        }
       ],
       "metadata": {}
      }
     ],
     "metadata": {
      "kernelspec": {
       "display_name": "sagemath",
       "name": "sagemath"
      }
     }
    }
Got:
    {
     "cells": [
      {
       "cell_type": "markdown",
       "metadata": {},
       "source": [
        "$$\n",
        "\\def\\CC{\\bf C}\n",
        "\\def\\QQ{\\bf Q}\n",
        "\\def\\RR{\\bf R}\n",
        "\\def\\ZZ{\\bf Z}\n",
        "\\def\\NN{\\bf N}\n",
        "$$"
       ]
      },
      {
       "cell_type": "code",
       "execution_count": null,
       "metadata": {},
       "outputs": [
        {
         "data": {
          "text/plain": [
           "1024"
          ]
         },
         "execution_count": 1,
         "metadata": {},
         "output_type": "execute_result"
        }
       ],
       "source": [
        "2^10"
       ]
      },
      {
       "cell_type": "code",
       "execution_count": null,
       "metadata": {},
       "outputs": [
        {
         "data": {
          "text/plain": [
           "4"
          ]
         },
         "execution_count": 1,
         "metadata": {},
         "output_type": "execute_result"
        }
       ],
       "source": [
        "2 + 2"
       ]
      }
     ],
     "metadata": {
      "kernelspec": {
       "display_name": "sagemath",
       "name": "sagemath"
      }
     },
     "nbformat": 4,
     "nbformat_minor": 2
    }
    <BLANKLINE>
**********************************************************************
File "src/sage/tests/cmdline.py", line 739, in sage.tests.cmdline.test_executable
Failed example:
    print(open(output, 'r').read()) # optional - rst2ipynb
Expected:
    {
     "nbformat_minor": ...,
     "nbformat": ...,
     "cells": [
      {
       "source": [
        "$$\n",
        "\\def\\CC{\\bf C}\n",
        "\\def\\QQ{\\bf Q}\n",
    ...
     "metadata": {
      "kernelspec": {
       "display_name": "sagemath",
       "name": "sagemath"
      }
     }
    }
Got:
    {
     "cells": [
      {
       "cell_type": "markdown",
       "metadata": {},
       "source": [
        "$$\n",
        "\\def\\CC{\\bf C}\n",
        "\\def\\QQ{\\bf Q}\n",
        "\\def\\RR{\\bf R}\n",
        "\\def\\ZZ{\\bf Z}\n",
        "\\def\\NN{\\bf N}\n",
        "$$"
       ]
      },
      {
       "cell_type": "code",
       "execution_count": null,
       "metadata": {},
       "outputs": [
        {
         "data": {
          "text/plain": [
           "1024"
          ]
         },
         "execution_count": 1,
         "metadata": {},
         "output_type": "execute_result"
        }
       ],
       "source": [
        "2^10"
       ]
      },
      {
       "cell_type": "code",
       "execution_count": null,
       "metadata": {},
       "outputs": [
        {
         "data": {
          "text/plain": [
           "4"
          ]
         },
         "execution_count": 1,
         "metadata": {},
         "output_type": "execute_result"
        }
       ],
       "source": [
        "2 + 2"
       ]
      }
     ],
     "metadata": {
      "kernelspec": {
       "display_name": "sagemath",
       "name": "sagemath"
      }
     },
     "nbformat": 4,
     "nbformat_minor": 2
    }
**********************************************************************
1 item had failures:
   2 of 249 in sage.tests.cmdline.test_executable
    [248 tests, 2 failures, 29.00 s]
----------------------------------------------------------------------
sage -t src/sage/tests/cmdline.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 29.2 seconds
    cpu time: 0.3 seconds
    cumulative wall time: 29.0 seconds
External software detected for doctesting: internet,pandoc
```

CC:  tmonteil

Branch/Commit: a8ec0ca1c519a6cc19e2d7c8112d2ff05b159b37

Reviewer: Travis Scrimshaw

Author: Sébastien Labbé

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28762





---

archive/issue_comments_402356.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-11-20T20:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28762#issuecomment-402356",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_402357.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2019-11-20T20:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28762#issuecomment-402357",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_402358.json:
```json
{
    "body": "<a id='comment:3'></a>These look like much more robust doctests.",
    "created_at": "2019-12-09T02:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28762#issuecomment-402358",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>These look like much more robust doctests.



---

archive/issue_comments_402359.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-09T02:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28762#issuecomment-402359",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_402360.json:
```json
{
    "body": "<a id='comment:4'></a>Thanks for the review.",
    "created_at": "2019-12-09T22:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28762#issuecomment-402360",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:4'></a>Thanks for the review.



---

archive/issue_comments_402361.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-11T21:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28762#issuecomment-402361",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_072581.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-11T21:46:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28762",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28762#event-72581"
}
```
