# Issue 28115: Fix dependencies on png.h, m4ri.h, m4rie.h

archive/issues_028115.json:
```json
{
    "body": "CC:  @dimpase @embray\n\nThe following dependencies were incorrect:\n- `sage.matrix.matrix_mod2_dense` does not use `png.h`\n- `sage.modules.vector_mod2_dense` does not use `png.h`\n- `sage.matrix.matrix_rational_dense` does not use `m4ri.h`\n\nThe following dependencies are in Cython files, so Cython picks them up automatically:\n- `sage.matrix.matrix_mod2_dense dependency` on `m4ri.h`\n- `sage.modules.vector_mod2_dense dependency` on `m4ri.h`\n- `sage.matrix.matrix_gf2e_dense dependency` on `m4rie.h`\n    \nThe following include and dependency was removed:\n- `pb_wrap.h` included `m4ri/m4ri.h` for no apparent reason, everything still works after removing that include (and therefore also the dependency)\n\nIssue created by migration from https://trac.sagemath.org/ticket/28352\n\n",
    "closed_at": "2019-08-15T20:30:22Z",
    "created_at": "2019-08-14T08:51:36Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Fix dependencies on png.h, m4ri.h, m4rie.h",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28115",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @dimpase @embray

The following dependencies were incorrect:
- `sage.matrix.matrix_mod2_dense` does not use `png.h`
- `sage.modules.vector_mod2_dense` does not use `png.h`
- `sage.matrix.matrix_rational_dense` does not use `m4ri.h`

The following dependencies are in Cython files, so Cython picks them up automatically:
- `sage.matrix.matrix_mod2_dense dependency` on `m4ri.h`
- `sage.modules.vector_mod2_dense dependency` on `m4ri.h`
- `sage.matrix.matrix_gf2e_dense dependency` on `m4rie.h`
    
The following include and dependency was removed:
- `pb_wrap.h` included `m4ri/m4ri.h` for no apparent reason, everything still works after removing that include (and therefore also the dependency)

Issue created by migration from https://trac.sagemath.org/ticket/28352





---

archive/issue_comments_396763.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-08-14T08:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396763",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396764.json:
```json
{
    "body": "If Cython can pick up such header dependencies automatically, why do we still also need the `depends` for `sage.rings.polynomial.pbori`?",
    "created_at": "2019-08-14T08:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396764",
    "user": "https://github.com/embray"
}
```

If Cython can pick up such header dependencies automatically, why do we still also need the `depends` for `sage.rings.polynomial.pbori`?



---

archive/issue_comments_396765.json:
```json
{
    "body": "Replying to [comment:3 embray]:\n> If Cython can pick up such header dependencies automatically, why do we still also need the `depends` for `sage.rings.polynomial.pbori`?\n\n\nCython picks up dependencies automatically if they appear in a `cdef extern from \"header.h\"`\n\nBut in this case, the dependency is through `pb_wrap.h`.",
    "created_at": "2019-08-14T09:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396765",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:3 embray]:
> If Cython can pick up such header dependencies automatically, why do we still also need the `depends` for `sage.rings.polynomial.pbori`?


Cython picks up dependencies automatically if they appear in a `cdef extern from "header.h"`

But in this case, the dependency is through `pb_wrap.h`.



---

archive/issue_comments_396766.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-14T09:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396766",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396767.json:
```json
{
    "body": "I see.  I suppose in principle one could put an empty `cdef extern from \"polybori/polybori.h\"` in the Cython file then.  I would still like to see the use of `SAGE_INC` there go away, but that can be handled in #28349 or a different ticket.",
    "created_at": "2019-08-14T09:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396767",
    "user": "https://github.com/embray"
}
```

I see.  I suppose in principle one could put an empty `cdef extern from "polybori/polybori.h"` in the Cython file then.  I would still like to see the use of `SAGE_INC` there go away, but that can be handled in #28349 or a different ticket.



---

archive/issue_comments_396768.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-14T09:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396768",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396769.json:
```json
{
    "body": "Replying to [comment:5 embray]:\n> I suppose in principle one could put an empty `cdef extern from \"polybori/polybori.h\"` in the Cython file then.\n\n\nIndeed, I was thinking the same thing.",
    "created_at": "2019-08-14T09:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396769",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 embray]:
> I suppose in principle one could put an empty `cdef extern from "polybori/polybori.h"` in the Cython file then.


Indeed, I was thinking the same thing.



---

archive/issue_events_070809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-15T20:30:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28115#event-70809"
}
```



---

archive/issue_comments_396770.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-15T20:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28115#issuecomment-396770",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
