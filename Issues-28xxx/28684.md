# Issue 28684: Fixing precision of Tate elliptic curves over Qp

archive/issues_028447.json:
```json
{
    "body": "While reviewing #28645, I noticed a couple of problems in the file:\n\n`src/sage/schemes/elliptic_curves/ell_tate_curve.py`\n\n1- We are always hitting `AttributeError` in the `try` blocks in `def parameter`, `def curve`, and `def _Csquare`, as it should be calling `precision_absolute` instead of `absolute_precision`\n\n2- We should be checking `precision_relative`\n\n3- If one fixes the above, the code would return the items with perhaps more precision than desired.\n\nI have fixed the 3 items\n\n\nCC:  @categorie\n\nBranch/Commit: 456f57e84f6ea592b3dcc123c10fe8859e6e8561\n\nReviewer: Chris Wuthrich\n\nAuthor: Edgar Costa\n\nDependencies: #28645\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28684\n\n",
    "closed_at": "2019-12-09T22:54:32Z",
    "created_at": "2019-11-01T16:39:05Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Fixing precision of Tate elliptic curves over Qp",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28684",
    "user": "https://github.com/edgarcosta"
}
```
While reviewing #28645, I noticed a couple of problems in the file:

`src/sage/schemes/elliptic_curves/ell_tate_curve.py`

1- We are always hitting `AttributeError` in the `try` blocks in `def parameter`, `def curve`, and `def _Csquare`, as it should be calling `precision_absolute` instead of `absolute_precision`

2- We should be checking `precision_relative`

3- If one fixes the above, the code would return the items with perhaps more precision than desired.

I have fixed the 3 items


CC:  @categorie

Branch/Commit: 456f57e84f6ea592b3dcc123c10fe8859e6e8561

Reviewer: Chris Wuthrich

Author: Edgar Costa

Dependencies: #28645

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28684





---

archive/issue_comments_556853.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-11-01T16:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556853",
    "user": "https://github.com/edgarcosta"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_556854.json:
```json
{
    "body": "Changing stopgaps from \"\" to \"#28645\"",
    "created_at": "2019-11-01T16:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556854",
    "user": "https://github.com/edgarcosta"
}
```

Changing stopgaps from "" to "#28645"



---

archive/issue_comments_556855.json:
```json
{
    "body": "Changing stopgaps from \"#28645\" to \"\"",
    "created_at": "2019-11-01T16:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556855",
    "user": "https://github.com/edgarcosta"
}
```

Changing stopgaps from "#28645" to ""



---

archive/issue_comments_556856.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#28645\"",
    "created_at": "2019-11-01T16:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556856",
    "user": "https://github.com/edgarcosta"
}
```

Changing dependencies from "" to "#28645"



---

archive/issue_comments_556857.json:
```json
{
    "body": "<a id='comment:4'></a>\nfailing doctests, see patchbot",
    "created_at": "2019-11-01T19:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556857",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
failing doctests, see patchbot



---

archive/issue_comments_556858.json:
```json
{
    "body": "Changing commit from \"be4619e3efd1dfe119ace84f54a86c1222c888f8\" to \"58f126f2b8978c5da3c77c732753ca049a11ba14\"",
    "created_at": "2019-11-01T21:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "be4619e3efd1dfe119ace84f54a86c1222c888f8" to "58f126f2b8978c5da3c77c732753ca049a11ba14"



---

archive/issue_comments_556859.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[2862adf](https://git.sagemath.org/sage.git/commit/?id=2862adf3d228e21843826c504ac85397ddcc1dd7)|`making u a p-adic element`|\n|[cefc6cc](https://git.sagemath.org/sage.git/commit/?id=cefc6cce9ac6baed4e7c160c06dc6e73066db9e8)|`reordering things`|\n|[58f126f](https://git.sagemath.org/sage.git/commit/?id=58f126f2b8978c5da3c77c732753ca049a11ba14)|`making None the default prec, when another parameter is passed`|",
    "created_at": "2019-11-01T21:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556859",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[2862adf](https://git.sagemath.org/sage.git/commit/?id=2862adf3d228e21843826c504ac85397ddcc1dd7)|`making u a p-adic element`|
|[cefc6cc](https://git.sagemath.org/sage.git/commit/?id=cefc6cce9ac6baed4e7c160c06dc6e73066db9e8)|`reordering things`|
|[58f126f](https://git.sagemath.org/sage.git/commit/?id=58f126f2b8978c5da3c77c732753ca049a11ba14)|`making None the default prec, when another parameter is passed`|



---

archive/issue_comments_556860.json:
```json
{
    "body": "<a id='comment:6'></a>\nSorry about that. I changed the code a bit more and fixed the tests.",
    "created_at": "2019-11-03T15:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556860",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:6'></a>
Sorry about that. I changed the code a bit more and fixed the tests.



---

archive/issue_comments_556861.json:
```json
{
    "body": "Changing commit from \"58f126f2b8978c5da3c77c732753ca049a11ba14\" to \"ee33771d262b76a9f1b4d25dda59fa86606d0a76\"",
    "created_at": "2019-11-03T15:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556861",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "58f126f2b8978c5da3c77c732753ca049a11ba14" to "ee33771d262b76a9f1b4d25dda59fa86606d0a76"



---

archive/issue_comments_556862.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[ee33771](https://git.sagemath.org/sage.git/commit/?id=ee33771d262b76a9f1b4d25dda59fa86606d0a76)|`fixing two docstrings`|",
    "created_at": "2019-11-03T15:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[ee33771](https://git.sagemath.org/sage.git/commit/?id=ee33771d262b76a9f1b4d25dda59fa86606d0a76)|`fixing two docstrings`|



---

archive/issue_comments_556863.json:
```json
{
    "body": "Changing author from \"\" to \"Edgar Costa\"",
    "created_at": "2019-11-08T20:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556863",
    "user": "https://github.com/edgarcosta"
}
```

Changing author from "" to "Edgar Costa"



---

archive/issue_comments_556864.json:
```json
{
    "body": "<a id='comment:9'></a>\nOh, sorry I only spotted now that this was opened. I will review this.",
    "created_at": "2019-12-06T21:24:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556864",
    "user": "https://github.com/categorie"
}
```

<a id='comment:9'></a>
Oh, sorry I only spotted now that this was opened. I will review this.



---

archive/issue_comments_556865.json:
```json
{
    "body": "<a id='comment:10'></a>\nI added some small improvements to the documentation while we are at it. I tested the code and I am happy with it. If the new version is ok on the patchbot, I set it to positive review.\n\n---\nNew commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[55b3bee](https://git.sagemath.org/sage.git/commit?id=55b3bee487ef8eb778d7454ad9fb389cffb66f94)|`Merge branch 9.0.beta8 into ticket28684_tate`|\n|[3c6548e](https://git.sagemath.org/sage.git/commit?id=3c6548e818ad7fd43641c8c04144e1de1e459235)|`some doctests improvements`|\n|[456f57e](https://git.sagemath.org/sage.git/commit?id=456f57e84f6ea592b3dcc123c10fe8859e6e8561)|`another small doc string improvement`|",
    "created_at": "2019-12-07T00:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556865",
    "user": "https://github.com/categorie"
}
```

<a id='comment:10'></a>
I added some small improvements to the documentation while we are at it. I tested the code and I am happy with it. If the new version is ok on the patchbot, I set it to positive review.

---
New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[55b3bee](https://git.sagemath.org/sage.git/commit?id=55b3bee487ef8eb778d7454ad9fb389cffb66f94)|`Merge branch 9.0.beta8 into ticket28684_tate`|
|[3c6548e](https://git.sagemath.org/sage.git/commit?id=3c6548e818ad7fd43641c8c04144e1de1e459235)|`some doctests improvements`|
|[456f57e](https://git.sagemath.org/sage.git/commit?id=456f57e84f6ea592b3dcc123c10fe8859e6e8561)|`another small doc string improvement`|



---

archive/issue_comments_556866.json:
```json
{
    "body": "Changing commit from \"ee33771d262b76a9f1b4d25dda59fa86606d0a76\" to \"456f57e84f6ea592b3dcc123c10fe8859e6e8561\"",
    "created_at": "2019-12-07T00:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556866",
    "user": "https://github.com/categorie"
}
```

Changing commit from "ee33771d262b76a9f1b4d25dda59fa86606d0a76" to "456f57e84f6ea592b3dcc123c10fe8859e6e8561"



---

archive/issue_comments_556867.json:
```json
{
    "body": "Changing branch from \"u/edgarcosta/tate\" to \"u/wuthrich/tate28684\"",
    "created_at": "2019-12-07T00:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556867",
    "user": "https://github.com/categorie"
}
```

Changing branch from "u/edgarcosta/tate" to "u/wuthrich/tate28684"



---

archive/issue_comments_556868.json:
```json
{
    "body": "Changing reviewer from \"\" to \"wuthrich\"",
    "created_at": "2019-12-07T00:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556868",
    "user": "https://github.com/categorie"
}
```

Changing reviewer from "" to "wuthrich"



---

archive/issue_comments_556869.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-07T21:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556869",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_556870.json:
```json
{
    "body": "<a id='comment:12'></a>\nreviewer name should be full name",
    "created_at": "2019-12-08T07:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556870",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>
reviewer name should be full name



---

archive/issue_comments_556871.json:
```json
{
    "body": "Changing reviewer from \"wuthrich\" to \"Chris Wuthrich\"",
    "created_at": "2019-12-08T11:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556871",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "wuthrich" to "Chris Wuthrich"



---

archive/issue_comments_556872.json:
```json
{
    "body": "Changing branch from \"u/wuthrich/tate28684\" to \"456f57e84f6ea592b3dcc123c10fe8859e6e8561\"",
    "created_at": "2019-12-09T22:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556872",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/wuthrich/tate28684" to "456f57e84f6ea592b3dcc123c10fe8859e6e8561"



---

archive/issue_comments_556873.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-09T22:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28684#issuecomment-556873",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_072260.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-09T22:54:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28684",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28684#event-72260"
}
```
