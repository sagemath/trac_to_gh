# Issue 28967: implement easy cases of inverse_mod for general commutative rings

archive/issues_028730.json:
```json
{
    "body": "The definition of `inverse_mod(x, I)` for the class `CommutativeRingElement` always raises a `NotImplementedError`. It would be better to return the correct value in the easy cases (when `x` is a unit, or `x` is in `I`). This would provide a complete implementation for fields.\n\nBranch/Commit: 4db45698a8a3e554a7eadf95aab3951309eab5da\n\nReviewer: Travis Scrimshaw\n\nAuthor: Dave Morris\n\nDependencies: #28969\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28967\n\n",
    "closed_at": "2020-01-20T21:17:47Z",
    "created_at": "2020-01-07T19:25:28Z",
    "labels": [
        "component: commutative algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "implement easy cases of inverse_mod for general commutative rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28967",
    "user": "https://github.com/DaveWitteMorris"
}
```
The definition of `inverse_mod(x, I)` for the class `CommutativeRingElement` always raises a `NotImplementedError`. It would be better to return the correct value in the easy cases (when `x` is a unit, or `x` is in `I`). This would provide a complete implementation for fields.

Branch/Commit: 4db45698a8a3e554a7eadf95aab3951309eab5da

Reviewer: Travis Scrimshaw

Author: Dave Morris

Dependencies: #28969

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28967





---

archive/issue_comments_562925.json:
```json
{
    "body": "Changing branch from \"\" to \"public/28967\"",
    "created_at": "2020-01-07T20:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562925",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing branch from "" to "public/28967"



---

archive/issue_comments_562926.json:
```json
{
    "body": "Changing author from \"\" to \"Dave Morris\"",
    "created_at": "2020-01-07T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562926",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing author from "" to "Dave Morris"



---

archive/issue_comments_562927.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-07T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562927",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_562928.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[139c8d2](https://git.sagemath.org/sage.git/commit?id=139c8d2a71f849e1ccdd10a8dbd9d67cc193d4b8)|`implement basic functionality`|",
    "created_at": "2020-01-07T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562928",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[139c8d2](https://git.sagemath.org/sage.git/commit?id=139c8d2a71f849e1ccdd10a8dbd9d67cc193d4b8)|`implement basic functionality`|



---

archive/issue_comments_562929.json:
```json
{
    "body": "Changing commit from \"\" to \"139c8d2a71f849e1ccdd10a8dbd9d67cc193d4b8\"",
    "created_at": "2020-01-07T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562929",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing commit from "" to "139c8d2a71f849e1ccdd10a8dbd9d67cc193d4b8"



---

archive/issue_comments_562930.json:
```json
{
    "body": "<a id='comment:3'></a>\nFailed doctest (because I fixed a typo and didn't notice it was in a doctest).  Also, probably should have a better error message for commutative rings that do not implement `is_unit`.",
    "created_at": "2020-01-07T22:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562930",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:3'></a>
Failed doctest (because I fixed a typo and didn't notice it was in a doctest).  Also, probably should have a better error message for commutative rings that do not implement `is_unit`.



---

archive/issue_comments_562931.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-01-07T22:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562931",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_562932.json:
```json
{
    "body": "Changing commit from \"139c8d2a71f849e1ccdd10a8dbd9d67cc193d4b8\" to \"f312d7c3b42c0815271e08e7a97f5880b8267a7d\"",
    "created_at": "2020-01-08T00:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "139c8d2a71f849e1ccdd10a8dbd9d67cc193d4b8" to "f312d7c3b42c0815271e08e7a97f5880b8267a7d"



---

archive/issue_comments_562933.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|\n|[46e1047](https://git.sagemath.org/sage.git/commit/?id=46e1047b4ffa282de479d1691e074c62e7d00513)|`better handling of is_unit`|\n|[a817901](https://git.sagemath.org/sage.git/commit/?id=a817901535dea364c31c9d33259b307e948fbd77)|`fix typo in error message`|\n|[587652c](https://git.sagemath.org/sage.git/commit/?id=587652c9de0bae096c3e0206c74197039978720b)|`also correct file element.pyx`|\n|[f312d7c](https://git.sagemath.org/sage.git/commit/?id=f312d7c3b42c0815271e08e7a97f5880b8267a7d)|`merge ticket 28969 to fix doctest`|",
    "created_at": "2020-01-08T00:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562933",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
|[46e1047](https://git.sagemath.org/sage.git/commit/?id=46e1047b4ffa282de479d1691e074c62e7d00513)|`better handling of is_unit`|
|[a817901](https://git.sagemath.org/sage.git/commit/?id=a817901535dea364c31c9d33259b307e948fbd77)|`fix typo in error message`|
|[587652c](https://git.sagemath.org/sage.git/commit/?id=587652c9de0bae096c3e0206c74197039978720b)|`also correct file element.pyx`|
|[f312d7c](https://git.sagemath.org/sage.git/commit/?id=f312d7c3b42c0815271e08e7a97f5880b8267a7d)|`merge ticket 28969 to fix doctest`|



---

archive/issue_comments_562934.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#28969\"",
    "created_at": "2020-01-08T00:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562934",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing dependencies from "" to "#28969"



---

archive/issue_comments_562935.json:
```json
{
    "body": "<a id='comment:5'></a>\nSlightly improved the handling of `is_unit`, and changed the `ValueError` message to match the one given by univariate polynomial rings. Ticket #28969 should fix the doctest error.",
    "created_at": "2020-01-08T00:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562935",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:5'></a>
Slightly improved the handling of `is_unit`, and changed the `ValueError` message to match the one given by univariate polynomial rings. Ticket #28969 should fix the doctest error.



---

archive/issue_comments_562936.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-08T00:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562936",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_562937.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe error message `Impossible inverse modulo` is a little strange to me, and moreover from the ticket description, it does not seem correct. Could we instead change it to\n\n```\nraise NotImplementedError(\"unable to compute the inverse modulo this ideal\")\n```\n\nOn #28969, it would have been good to also remove that period at the end of it in order to follow Python's error message convention. Oh well, that already has a positive review...",
    "created_at": "2020-01-14T17:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562937",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
The error message `Impossible inverse modulo` is a little strange to me, and moreover from the ticket description, it does not seem correct. Could we instead change it to

```
raise NotImplementedError("unable to compute the inverse modulo this ideal")
```

On #28969, it would have been good to also remove that period at the end of it in order to follow Python's error message convention. Oh well, that already has a positive review...



---

archive/issue_comments_562938.json:
```json
{
    "body": "Changing commit from \"f312d7c3b42c0815271e08e7a97f5880b8267a7d\" to \"e2a84fab1a646c82539f559323e2603219c227ef\"",
    "created_at": "2020-01-15T02:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562938",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f312d7c3b42c0815271e08e7a97f5880b8267a7d" to "e2a84fab1a646c82539f559323e2603219c227ef"



---

archive/issue_comments_562939.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[e2a84fa](https://git.sagemath.org/sage.git/commit/?id=e2a84fab1a646c82539f559323e2603219c227ef)|`change error message`|",
    "created_at": "2020-01-15T02:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562939",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[e2a84fa](https://git.sagemath.org/sage.git/commit/?id=e2a84fab1a646c82539f559323e2603219c227ef)|`change error message`|



---

archive/issue_comments_562940.json:
```json
{
    "body": "<a id='comment:8'></a>\nBeing a beginner at sagemath development, I thought I should copy an error message, instead of making up my own, but, since you agree that it is weird, I will change it. However, this is a `ValueError`, not a `NotImplementedError`, because the inverse does not exist. (This error message is for the case where x is in I and I is not the entire ring. Since x is in I, we have <x,I> = I. Also, if the inverse of x modulo I exists, then <x,I>  must be the entire ring. So I = <x,I> is the entire ring, which is a contradiction.)  I changed the error message to\n\n```\nraise ValueError(\"An element of a proper ideal does not have an inverse modulo that ideal\")\n```\n\n---\nNew commits:\n|                                                                                                                                          |                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[e2a84fa](https://git.sagemath.org/sage.git/commit?id=e2a84fab1a646c82539f559323e2603219c227ef)|`change error message`|",
    "created_at": "2020-01-15T02:51:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562940",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:8'></a>
Being a beginner at sagemath development, I thought I should copy an error message, instead of making up my own, but, since you agree that it is weird, I will change it. However, this is a `ValueError`, not a `NotImplementedError`, because the inverse does not exist. (This error message is for the case where x is in I and I is not the entire ring. Since x is in I, we have <x,I> = I. Also, if the inverse of x modulo I exists, then <x,I>  must be the entire ring. So I = <x,I> is the entire ring, which is a contradiction.)  I changed the error message to

```
raise ValueError("An element of a proper ideal does not have an inverse modulo that ideal")
```

---
New commits:
|                                                                                                                                          |                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[e2a84fa](https://git.sagemath.org/sage.git/commit?id=e2a84fab1a646c82539f559323e2603219c227ef)|`change error message`|



---

archive/issue_comments_562941.json:
```json
{
    "body": "Changing component from linear algebra to commutative algebra.",
    "created_at": "2020-01-15T03:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562941",
    "user": "https://github.com/tscrim"
}
```

Changing component from linear algebra to commutative algebra.



---

archive/issue_comments_562942.json:
```json
{
    "body": "<a id='comment:9'></a>\nI see, I misunderstood the case. If you could just change the error message to start with a lowercase letter (this is a general Python convention we follow), then you can set a positive review.",
    "created_at": "2020-01-15T03:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562942",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
I see, I misunderstood the case. If you could just change the error message to start with a lowercase letter (this is a general Python convention we follow), then you can set a positive review.



---

archive/issue_comments_562943.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2020-01-15T03:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562943",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_562944.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[4db4569](https://git.sagemath.org/sage.git/commit/?id=4db45698a8a3e554a7eadf95aab3951309eab5da)|`error message should be lowercase`|",
    "created_at": "2020-01-15T03:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562944",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[4db4569](https://git.sagemath.org/sage.git/commit/?id=4db45698a8a3e554a7eadf95aab3951309eab5da)|`error message should be lowercase`|



---

archive/issue_comments_562945.json:
```json
{
    "body": "Changing commit from \"e2a84fab1a646c82539f559323e2603219c227ef\" to \"4db45698a8a3e554a7eadf95aab3951309eab5da\"",
    "created_at": "2020-01-15T03:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e2a84fab1a646c82539f559323e2603219c227ef" to "4db45698a8a3e554a7eadf95aab3951309eab5da"



---

archive/issue_comments_562946.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks for the comments and corrections. I'll try to write error messages correctly in the future.",
    "created_at": "2020-01-15T03:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562946",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:11'></a>
Thanks for the comments and corrections. I'll try to write error messages correctly in the future.



---

archive/issue_comments_562947.json:
```json
{
    "body": "<a id='comment:12'></a>\nThanks.",
    "created_at": "2020-01-15T04:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562947",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Thanks.



---

archive/issue_comments_562948.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-15T04:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562948",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_073345.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-20T21:17:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28967#event-73345"
}
```



---

archive/issue_comments_562949.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-20T21:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562949",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_562950.json:
```json
{
    "body": "Changing branch from \"public/28967\" to \"4db45698a8a3e554a7eadf95aab3951309eab5da\"",
    "created_at": "2020-01-20T21:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28967#issuecomment-562950",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/28967" to "4db45698a8a3e554a7eadf95aab3951309eab5da"
