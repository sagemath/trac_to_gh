# Issue 28355: Allow precision to be passed into the elliptic_j function

archive/issues_028118.json:
```json
{
    "body": "For example, Wikipedia says that the j-invariant of (1+sqrt(-163))/2 is an integer, but if one computes elliptic_j for this symbolic ring element, it returns a complex number with an imaginary part not close to 0. See: \n\nhttps://en.wikipedia.org/wiki/J-invariant\n\n\n```\nsage: b = sqrt(-163)\nsage: b = (1+b)/2\nsage: elliptic_j(b)\n-2.62537412640767e17 + 732.558854258998*I\nsage: elliptic_j(ComplexField(100(b))\n-2.6253741264076799999999999999e17 + 1.3012822400356887122945119790e-12*I\n```\n\nKeywords: elliptic_j, precision, elliptic curves\n\nReviewer: Kevin Lui, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Gerardo E Zelaya Eufemia, Kevin Lui\n\nBranch: 58ba0e8ed3f0e007b67b07c3fc9f1c80ca21cffb\n\nCommit: 58ba0e8ed3f0e007b67b07c3fc9f1c80ca21cffb\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28355\n\n",
    "closed_at": "2019-12-11T21:46:20Z",
    "created_at": "2019-08-14T20:20:39Z",
    "labels": [
        "component: elliptic curves",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Allow precision to be passed into the elliptic_j function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28355",
    "user": "https://trac.sagemath.org/admin/accounts/users/menosgeze"
}
```
For example, Wikipedia says that the j-invariant of (1+sqrt(-163))/2 is an integer, but if one computes elliptic_j for this symbolic ring element, it returns a complex number with an imaginary part not close to 0. See: 

https://en.wikipedia.org/wiki/J-invariant


```
sage: b = sqrt(-163)
sage: b = (1+b)/2
sage: elliptic_j(b)
-2.62537412640767e17 + 732.558854258998*I
sage: elliptic_j(ComplexField(100(b))
-2.6253741264076799999999999999e17 + 1.3012822400356887122945119790e-12*I
```

Keywords: elliptic_j, precision, elliptic curves

Reviewer: Kevin Lui, Frédéric Chapoton

Author: Gerardo E Zelaya Eufemia, Kevin Lui

Branch: 58ba0e8ed3f0e007b67b07c3fc9f1c80ca21cffb

Commit: 58ba0e8ed3f0e007b67b07c3fc9f1c80ca21cffb

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28355





---

archive/issue_comments_396794.json:
```json
{
    "body": "<a id='comment:2'></a>I see that the PARI function `ellj` also takes in precision. Should we also pass in the precision into that as well?\n\n# Style Suggestions:\n* Add extra line before function.\n* Delete spaces around equal sign.\n* Indentation should be a multiple of 4.\n\n# Doc string suggestions:\n* Add prec to the input line of documentation.",
    "created_at": "2019-08-14T22:39:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396794",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:2'></a>I see that the PARI function `ellj` also takes in precision. Should we also pass in the precision into that as well?

# Style Suggestions:
* Add extra line before function.
* Delete spaces around equal sign.
* Indentation should be a multiple of 4.

# Doc string suggestions:
* Add prec to the input line of documentation.



---

archive/issue_comments_396795.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-06T22:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396796.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-06T22:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396797.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-06T23:07:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396798.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-06T23:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396798",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396799.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-06T23:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396800.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-09-06T23:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396800",
    "user": "https://trac.sagemath.org/admin/accounts/users/menosgeze"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396801.json:
```json
{
    "body": "<a id='comment:8'></a>The `elliptic_j` function needed an extra precision argument `prec`, and I fixed the indentation for the `elliptic_j` function. \n\n---\nNew commits:",
    "created_at": "2019-09-06T23:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396801",
    "user": "https://trac.sagemath.org/admin/accounts/users/menosgeze"
}
```

<a id='comment:8'></a>The `elliptic_j` function needed an extra precision argument `prec`, and I fixed the indentation for the `elliptic_j` function. 

---
New commits:



---

archive/issue_comments_396802.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-09T16:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396802",
    "user": "https://github.com/kevinywlui"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_396803.json:
```json
{
    "body": "<a id='comment:9'></a>Docstring formatting error in the input section.\n\nIndentation of L309 is off by one.",
    "created_at": "2019-09-09T16:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396803",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:9'></a>Docstring formatting error in the input section.

Indentation of L309 is off by one.



---

archive/issue_comments_396804.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-10T02:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396804",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396805.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-09-10T02:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396805",
    "user": "https://trac.sagemath.org/admin/accounts/users/menosgeze"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_396806.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-09-10T16:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396806",
    "user": "https://github.com/kevinywlui"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396807.json:
```json
{
    "body": "<a id='comment:12'></a>Looks good to me now. I think this is a useful change.\n\nI think the current patchbot failures aren't relevant here. The tests pass on my machine.",
    "created_at": "2019-09-10T16:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396807",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:12'></a>Looks good to me now. I think this is a useful change.

I think the current patchbot failures aren't relevant here. The tests pass on my machine.



---

archive/issue_comments_396808.json:
```json
{
    "body": "<a id='comment:13'></a>reviewer name is missing",
    "created_at": "2019-09-11T19:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396808",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>reviewer name is missing



---

archive/issue_comments_396809.json:
```json
{
    "body": "<a id='comment:14'></a>Opps. Thanks!",
    "created_at": "2019-09-11T19:18:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396809",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:14'></a>Opps. Thanks!



---

archive/issue_events_070812.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28355#event-70812"
}
```



---

archive/issue_comments_396810.json:
```json
{
    "body": "<a id='comment:15'></a>moving milestone to 9.0 (after release of 8.9)",
    "created_at": "2019-09-30T08:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396810",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>moving milestone to 9.0 (after release of 8.9)



---

archive/issue_comments_396811.json:
```json
{
    "body": "<a id='comment:16'></a>On Ubuntu 10 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/functions/special.py\", line 344, in sage.functions.special.elliptic_j\nFailed example:\n    -elliptic_j(tau)\nExpected:\n    2.62537412640767e17 - 732.558854258998*I\nGot:\n    2.62537412640767e17 - 732.558854103088*I\n**********************************************************************\nFile \"src/sage/functions/special.py\", line 346, in sage.functions.special.elliptic_j\nFailed example:\n    -elliptic_j(tau,75)\nExpected:\n    2.625374126407680000000e17 - 0.0001309913593909879441262*I\nGot:\n    2.625374126407680000000e17 - 0.0001309913596969636273570*I\n**********************************************************************\nFile \"src/sage/functions/special.py\", line 348, in sage.functions.special.elliptic_j\nFailed example:\n    -elliptic_j(tau,100)\nExpected:\n    2.6253741264076799999999999999e17 - 1.3012822400356887122945119790e-12*I\nGot:\n    2.6253741264076799999999999999e17 - 1.3012822398031636140364186716e-12*I\n**********************************************************************\n1 item had failures:\n   3 of  12 in sage.functions.special.elliptic_j\n    [125 tests, 3 failures, 3.96 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/functions/special.py  # 3 doctests failed\n```",
    "created_at": "2019-10-05T23:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396811",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>On Ubuntu 10 32-bit:

```
**********************************************************************
File "src/sage/functions/special.py", line 344, in sage.functions.special.elliptic_j
Failed example:
    -elliptic_j(tau)
Expected:
    2.62537412640767e17 - 732.558854258998*I
Got:
    2.62537412640767e17 - 732.558854103088*I
**********************************************************************
File "src/sage/functions/special.py", line 346, in sage.functions.special.elliptic_j
Failed example:
    -elliptic_j(tau,75)
Expected:
    2.625374126407680000000e17 - 0.0001309913593909879441262*I
Got:
    2.625374126407680000000e17 - 0.0001309913596969636273570*I
**********************************************************************
File "src/sage/functions/special.py", line 348, in sage.functions.special.elliptic_j
Failed example:
    -elliptic_j(tau,100)
Expected:
    2.6253741264076799999999999999e17 - 1.3012822400356887122945119790e-12*I
Got:
    2.6253741264076799999999999999e17 - 1.3012822398031636140364186716e-12*I
**********************************************************************
1 item had failures:
   3 of  12 in sage.functions.special.elliptic_j
    [125 tests, 3 failures, 3.96 s]
----------------------------------------------------------------------
sage -t --long src/sage/functions/special.py  # 3 doctests failed
```



---

archive/issue_comments_396812.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-10-05T23:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396812",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_396813.json:
```json
{
    "body": "<a id='comment:18'></a>I did a rebase and I added tolerance for the fixing numerical doctests on 32-bit machine. I don't have access to a 32-bit machine so let's see what the patchbot say.\n\nI'm not too sure about what to do with the ticket fields. Do I remove myself from reviewer and add myself to author? Just leave it as it?\n\n---\nNew commits:",
    "created_at": "2019-10-13T20:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396813",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:18'></a>I did a rebase and I added tolerance for the fixing numerical doctests on 32-bit machine. I don't have access to a 32-bit machine so let's see what the patchbot say.

I'm not too sure about what to do with the ticket fields. Do I remove myself from reviewer and add myself to author? Just leave it as it?

---
New commits:



---

archive/issue_comments_396814.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-13T20:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396814",
    "user": "https://github.com/kevinywlui"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_396815.json:
```json
{
    "body": "<a id='comment:19'></a>\n```\nsage -t --long src/sage/functions/special.py  # 3 doctests failed\n```\nThe tag \"rel tol\" should be on the command line in the doctest, not on the result line.\n\nYou can add yourself as author and stay also reviewer. You need someone else to review your own changes.",
    "created_at": "2019-11-15T20:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396815",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>
```
sage -t --long src/sage/functions/special.py  # 3 doctests failed
```
The tag "rel tol" should be on the command line in the doctest, not on the result line.

You can add yourself as author and stay also reviewer. You need someone else to review your own changes.



---

archive/issue_comments_396816.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-11-16T08:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396816",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_396817.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-21T07:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396817",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396818.json:
```json
{
    "body": "<a id='comment:23'></a>I did a rebase on develop followed by fixing the location of the tol flags.",
    "created_at": "2019-11-21T07:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396818",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:23'></a>I did a rebase on develop followed by fixing the location of the tol flags.



---

archive/issue_comments_396819.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-11-21T07:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396819",
    "user": "https://github.com/kevinywlui"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_396820.json:
```json
{
    "body": "<a id='comment:24'></a>ok",
    "created_at": "2019-12-10T21:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396820",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'></a>ok



---

archive/issue_comments_396821.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-10T21:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396821",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_070813.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-11T21:46:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28355#event-70813"
}
```



---

archive/issue_comments_396822.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-11T21:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28355#issuecomment-396822",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
