# Issue 28454: py3 failure in src/sage/libs/eclib/interface.py

archive/issues_028217.json:
```json
{
    "body": "On some machines, there is a Python 3 doctest failure at line 597 in the file `src/sage/libs/eclib/interface.py`:\n\n```\nsage -t --warn-long 39.6 src/sage/libs/eclib/interface.py\n**********************************************************************\nFile \"src/sage/libs/eclib/interface.py\", line 597, in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate\nFailed example:\n    E.saturation([Q1,Q2])\nExpected:\n    ([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)\nGot:\n    Attempt to round -0.2617840677e25 to a long int fails, aborting!\n    ([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)\n**********************************************************************\n1 item had failures:\n   1 of   9 in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate\n    [192 tests, 1 failure, 3.62 s]\n----------------------------------------------------------------------\nsage -t --warn-long 39.6 src/sage/libs/eclib/interface.py  # 1 doctest failed\n```\n\n**CC:**  @JohnCremona\n\n**Upstream:** None of the above - read trac for reasoning.\n\n**Reviewer:** John Cremona\n\n**Author:** John Cremona, John Palmieri\n\n**Resolution:** duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/28454\n\n",
    "closed_at": "2019-09-14T06:04:59Z",
    "created_at": "2019-09-04T21:51:52Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "py3 failure in src/sage/libs/eclib/interface.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28454",
    "user": "https://github.com/jhpalmieri"
}
```
On some machines, there is a Python 3 doctest failure at line 597 in the file `src/sage/libs/eclib/interface.py`:

```
sage -t --warn-long 39.6 src/sage/libs/eclib/interface.py
**********************************************************************
File "src/sage/libs/eclib/interface.py", line 597, in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate
Failed example:
    E.saturation([Q1,Q2])
Expected:
    ([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)
Got:
    Attempt to round -0.2617840677e25 to a long int fails, aborting!
    ([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)
**********************************************************************
1 item had failures:
   1 of   9 in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate
    [192 tests, 1 failure, 3.62 s]
----------------------------------------------------------------------
sage -t --warn-long 39.6 src/sage/libs/eclib/interface.py  # 1 doctest failed
```

**CC:**  @JohnCremona

**Upstream:** None of the above - read trac for reasoning.

**Reviewer:** John Cremona

**Author:** John Cremona, John Palmieri

**Resolution:** duplicate

Issue created by migration from https://trac.sagemath.org/ticket/28454





---

archive/issue_comments_553053.json:
```json
{
    "body": "<a id='comment:1'></a>\nI was trying to track this down. The message \"Attempt to round ...\" is from the eclib source code, so I put in some print statements, after which the \"Attempt to round ...\" message appeared after a different doctest. So then I thought I should flush the output after the \"Attempt to round ...\" message, to try to clarify where it was appearing. For reasons I don't understand, flushing the output caused the message to disappear entirely. Is this a valid fix for the problem?\n\nIn a bit more detail: I added the attached file to `build/pkgs/eclib/patches` (after creating that directory). Then I rebuilt eclib, after which this file passed its doctests.",
    "created_at": "2019-09-04T21:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553053",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
I was trying to track this down. The message "Attempt to round ..." is from the eclib source code, so I put in some print statements, after which the "Attempt to round ..." message appeared after a different doctest. So then I thought I should flush the output after the "Attempt to round ..." message, to try to clarify where it was appearing. For reasons I don't understand, flushing the output caused the message to disappear entirely. Is this a valid fix for the problem?

In a bit more detail: I added the attached file to `build/pkgs/eclib/patches` (after creating that directory). Then I rebuilt eclib, after which this file passed its doctests.



---

archive/issue_comments_553054.json:
```json
{
    "body": "<a id='comment:2'></a>\nAttachment [eclib-flush.patch](tarball://root/attachments/some-uuid/ticket28454/eclib-flush.patch) by @jhpalmieri created at 2019-09-04 22:00:55",
    "created_at": "2019-09-04T22:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553054",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
Attachment [eclib-flush.patch](tarball://root/attachments/some-uuid/ticket28454/eclib-flush.patch) by @jhpalmieri created at 2019-09-04 22:00:55



---

archive/issue_comments_553055.json:
```json
{
    "body": "<a id='comment:3'></a>\nIt seems weird to me the switching python versions could affect what happens in a C++ library, which is what eclib is.  The warning from eclib just means that an integer has been computed as a floating point which it then tries to fit into a long int (not a multiprecision int) and fails since it has too many digits.\n\nI will raise an Issue in eclib for this, as there may be some underlying problem being revealed.\n\nNote that the doctest in question was added in 2015 in #18031\nafter an upstream fix.",
    "created_at": "2019-09-05T08:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553055",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>
It seems weird to me the switching python versions could affect what happens in a C++ library, which is what eclib is.  The warning from eclib just means that an integer has been computed as a floating point which it then tries to fit into a long int (not a multiprecision int) and fails since it has too many digits.

I will raise an Issue in eclib for this, as there may be some underlying problem being revealed.

Note that the doctest in question was added in 2015 in #18031
after an upstream fix.



---

archive/issue_comments_553056.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe \"Attempt to round...\" warning in eclib comes from a function which as far as I can tell should not be called by E.saturate().\n\nCould someone who saw this message and has a python3 build try one thing:  in line 2604 of src/schemes/elliptic_curves/ell_rational_field change\n\n```\nprec = 100\n```\nto \n\n```\nprec = 200\n```\nand test again?  This is only the starting precision (in bits) and the code increases the precision by 50 in a loop until eclib reports that saturation has been completed.  Not long ago eclib changed from using decimal precision to bit precision, and at that time I reviewed all the places in sage where eclib's precision was being set, but may not have got this right.\n\nIf that fails I'll dig deeper.",
    "created_at": "2019-09-05T08:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553056",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>
The "Attempt to round..." warning in eclib comes from a function which as far as I can tell should not be called by E.saturate().

Could someone who saw this message and has a python3 build try one thing:  in line 2604 of src/schemes/elliptic_curves/ell_rational_field change

```
prec = 100
```
to 

```
prec = 200
```
and test again?  This is only the starting precision (in bits) and the code increases the precision by 50 in a loop until eclib reports that saturation has been completed.  Not long ago eclib changed from using decimal precision to bit precision, and at that time I reviewed all the places in sage where eclib's precision was being set, but may not have got this right.

If that fails I'll dig deeper.



---

archive/issue_comments_553057.json:
```json
{
    "body": "<a id='comment:5'></a>\nIn the \"Report upstream\" box there should be an option \"developers do not know whether it is a bug or not\"!  Right now I neither acknowledge that there is a bug in eclib nor deny it.  Anyway, I think that the author of a library has the right to issue warnings, and it is surely a Sage problem if a warning in a dependent library is triggered under python2 but not under python3?",
    "created_at": "2019-09-05T09:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553057",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'></a>
In the "Report upstream" box there should be an option "developers do not know whether it is a bug or not"!  Right now I neither acknowledge that there is a bug in eclib nor deny it.  Anyway, I think that the author of a library has the right to issue warnings, and it is surely a Sage problem if a warning in a dependent library is triggered under python2 but not under python3?



---

archive/issue_comments_553058.json:
```json
{
    "body": "**Changing upstream** from \"N/A\" to \"None of the above - read trac for reasoning.\".",
    "created_at": "2019-09-05T09:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553058",
    "user": "https://github.com/JohnCremona"
}
```

**Changing upstream** from "N/A" to "None of the above - read trac for reasoning.".



---

archive/issue_comments_553059.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [cremona](#comment%3A4):\n> The \"Attempt to round...\" warning in eclib comes from a function which as far as I can tell should not be called by E.saturate().\n\n\nAs I said in[comment:1](#comment%3A1), I first added some print statements to `mrank1.cc` to figure out which call of `ROUNDUP` or `ROUNDDOWN` was causing the message, and this made the message appear after a different doctest. So then I tried flushing the output, as in the patch, and this made the error disappear altogether. So I have no idea what's going on.\n\n> Could someone who saw this message and has a python3 build try one thing:  in line 2604 of src/schemes/elliptic_curves/ell_rational_field change\n> \n> ```\n> prec = 100\n> ```\n> to \n> \n> ```\n> prec = 200\n> ```\n> and test again?\n\n\nNo change.\n\nI hope others look at this, too. I am running Debian using VirtualBox on my Mac, which is not an ideal environment. I have taken it for granted that this a Python3-only bug (as reported at #28298), but I don't have a Python 2 build on this machine to test. I'm trying to build one now, but I may run out of disk space.",
    "created_at": "2019-09-05T17:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553059",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
Replying to [cremona](#comment%3A4):
> The "Attempt to round..." warning in eclib comes from a function which as far as I can tell should not be called by E.saturate().


As I said in[comment:1](#comment%3A1), I first added some print statements to `mrank1.cc` to figure out which call of `ROUNDUP` or `ROUNDDOWN` was causing the message, and this made the message appear after a different doctest. So then I tried flushing the output, as in the patch, and this made the error disappear altogether. So I have no idea what's going on.

> Could someone who saw this message and has a python3 build try one thing:  in line 2604 of src/schemes/elliptic_curves/ell_rational_field change
> 
> ```
> prec = 100
> ```
> to 
> 
> ```
> prec = 200
> ```
> and test again?


No change.

I hope others look at this, too. I am running Debian using VirtualBox on my Mac, which is not an ideal environment. I have taken it for granted that this a Python3-only bug (as reported at #28298), but I don't have a Python 2 build on this machine to test. I'm trying to build one now, but I may run out of disk space.



---

archive/issue_comments_553060.json:
```json
{
    "body": "<a id='comment:7'></a>\nThanks, that is helpful -- my guess is that the warning message is being created in an earlier doctest but only appearing in this one.  That code in mrank1.cc is only run when doing 2-descent on elliptic curves with no 2-torsion.  So the next step would be to manually run some subset of the doctests in that file interface.py.\n\nI'll make myself a new python3 build and see if I can get to the bottom of this.",
    "created_at": "2019-09-05T18:20:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553060",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>
Thanks, that is helpful -- my guess is that the warning message is being created in an earlier doctest but only appearing in this one.  That code in mrank1.cc is only run when doing 2-descent on elliptic curves with no 2-torsion.  So the next step would be to manually run some subset of the doctests in that file interface.py.

I'll make myself a new python3 build and see if I can get to the bottom of this.



---

archive/issue_comments_553061.json:
```json
{
    "body": "<a id='comment:8'></a>\nNote that it is also platform-specific: I don't see it on OS X, for example. It is conceivable that it depends on a combination of the OS and the processor, or it could just be the OS. It makes it (along with a few other Python 3 failures) annoying to debug and fix.",
    "created_at": "2019-09-05T18:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553061",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Note that it is also platform-specific: I don't see it on OS X, for example. It is conceivable that it depends on a combination of the OS and the processor, or it could just be the OS. It makes it (along with a few other Python 3 failures) annoying to debug and fix.



---

archive/issue_comments_553062.json:
```json
{
    "body": "<a id='comment:9'></a>\nAnd of course, I am happy to test things on my virtual machine. Let me know how I can help.",
    "created_at": "2019-09-05T19:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553062",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
And of course, I am happy to test things on my virtual machine. Let me know how I can help.



---

archive/issue_comments_553063.json:
```json
{
    "body": "<a id='comment:10'></a>\nI've done more investigating. I think the message actually comes from this doctest:\n\n```\n    sage: EllipticCurve([0, prod(prime_range(100))]).mwrank_curve().two_descent()\n    Traceback (most recent call last):\n    ...\n    RuntimeError: Aborted\n```\nIf I create a new file with just\n\n```\nr\"\"\"\nEXAMPLES::\n\n    sage: EllipticCurve([0, prod(prime_range(100))]).mwrank_curve().two_descent()\n    Traceback (most recent call last):\n    ...\n    RuntimeError: Aborted\n\n    sage: E = EllipticCurve([0,-1,1,-266,968])\n    sage: Q1 = E([-1995,3674,125])\n    sage: Q2 = E([157,1950,1])\n    sage: E.saturation([Q1,Q2])\n    ([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)\n\"\"\"\n```\nthen I get the doctest failure. If I run the command\n\n```\nEllipticCurve([0, prod(prime_range(100))]).mwrank_curve().two_descent()\n```\ndirectly in Sage, I get the message \"Attempt to round ...\" as part of the traceback (and I see this on my Mac, not just linux, and I see it with Python 2 and 3). So I think that when I flush the output, this message is absorbed into the \"...\" part of the doctest output, as it should be. When it's not flushed, it appears somewhere else and causes the failure. So maybe this is a valid fix.\n\nI still don't know why this only happens with some operating systems, and why only with Python 3, and why the \"Attempt to round ...\" message appears in this particular place, but it now makes a bit more sense. Should we flush the output in the `ROUNDDOWN` function as well?",
    "created_at": "2019-09-06T23:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553063",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>
I've done more investigating. I think the message actually comes from this doctest:

```
    sage: EllipticCurve([0, prod(prime_range(100))]).mwrank_curve().two_descent()
    Traceback (most recent call last):
    ...
    RuntimeError: Aborted
```
If I create a new file with just

```
r"""
EXAMPLES::

    sage: EllipticCurve([0, prod(prime_range(100))]).mwrank_curve().two_descent()
    Traceback (most recent call last):
    ...
    RuntimeError: Aborted

    sage: E = EllipticCurve([0,-1,1,-266,968])
    sage: Q1 = E([-1995,3674,125])
    sage: Q2 = E([157,1950,1])
    sage: E.saturation([Q1,Q2])
    ([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)
"""
```
then I get the doctest failure. If I run the command

```
EllipticCurve([0, prod(prime_range(100))]).mwrank_curve().two_descent()
```
directly in Sage, I get the message "Attempt to round ..." as part of the traceback (and I see this on my Mac, not just linux, and I see it with Python 2 and 3). So I think that when I flush the output, this message is absorbed into the "..." part of the doctest output, as it should be. When it's not flushed, it appears somewhere else and causes the failure. So maybe this is a valid fix.

I still don't know why this only happens with some operating systems, and why only with Python 3, and why the "Attempt to round ..." message appears in this particular place, but it now makes a bit more sense. Should we flush the output in the `ROUNDDOWN` function as well?



---

archive/issue_comments_553064.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks, that is extremely helpful.   mwrank bails out almost immediately if the input curve has very large coefficients and no 2-torsion, since when certain variables which are loop bounds are too large to fit into long ints (64-bit) the loop will not run in reasonable time, so it does not make sense for the code to use multiprecision ints at that point.  But it should catch this and issue a better warning/error, specifically saying that the curve's coefficients are too big.  I will look into that.  When this example is run with mwrank from the command line it core dumps after this message, certainly not good.\n\nHowever that is just half the story: it should be when this happens from within Sage, it raises a proper python error, and this output appears immediately.  Right now the error message goes into a buffer and it is very system-dependent when the message appears.\n\nIf you can see how to flush the output without changing eclib source code that would be the fastest fix, while I try to do something better for the longer term.",
    "created_at": "2019-09-07T11:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553064",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:11'></a>
Thanks, that is extremely helpful.   mwrank bails out almost immediately if the input curve has very large coefficients and no 2-torsion, since when certain variables which are loop bounds are too large to fit into long ints (64-bit) the loop will not run in reasonable time, so it does not make sense for the code to use multiprecision ints at that point.  But it should catch this and issue a better warning/error, specifically saying that the curve's coefficients are too big.  I will look into that.  When this example is run with mwrank from the command line it core dumps after this message, certainly not good.

However that is just half the story: it should be when this happens from within Sage, it raises a proper python error, and this output appears immediately.  Right now the error message goes into a buffer and it is very system-dependent when the message appears.

If you can see how to flush the output without changing eclib source code that would be the fastest fix, while I try to do something better for the longer term.



---

archive/issue_comments_553065.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [cremona](#comment%3A11):\n> If you can see how to flush the output without changing eclib source code that would be the fastest fix, while I try to do something better for the longer term.\n\n\nI don't know how to do this. I mean, I can find sites like https://eli.thegreenplace.net/2015/redirecting-all-kinds-of-stdout-in-python/ or https://stackoverflow.com/questions/5081657/how-do-i-prevent-a-c-shared-library-to-print-on-stdout-in-python or others, but they don't quite address the issue, so they would require modification. In addition, they look complicated and I don't understand them. Instead, as a stopgap, I would suggest a patch in `build/pkgs/eclib/patches` like the one I've posted here. It's not going to help with a version of eclib installed system-wide (#28333), but it's simple and will work for Sage-installed versions of eclib.\n\nDo you have some objection to flushing the output in those functions?",
    "created_at": "2019-09-07T21:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553065",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
Replying to [cremona](#comment%3A11):
> If you can see how to flush the output without changing eclib source code that would be the fastest fix, while I try to do something better for the longer term.


I don't know how to do this. I mean, I can find sites like https://eli.thegreenplace.net/2015/redirecting-all-kinds-of-stdout-in-python/ or https://stackoverflow.com/questions/5081657/how-do-i-prevent-a-c-shared-library-to-print-on-stdout-in-python or others, but they don't quite address the issue, so they would require modification. In addition, they look complicated and I don't understand them. Instead, as a stopgap, I would suggest a patch in `build/pkgs/eclib/patches` like the one I've posted here. It's not going to help with a version of eclib installed system-wide (#28333), but it's simple and will work for Sage-installed versions of eclib.

Do you have some objection to flushing the output in those functions?



---

archive/issue_comments_553066.json:
```json
{
    "body": "<a id='comment:13'></a>\nNo objection.   I know that it is a *bad thing* for library functions to call abort() and ideally I would recode the places where that happens, but there are hundreds of such places since I seem to use it whenever something invalid is tried such as adding two vectors of different lengths, as well as when memory allocation fails or (as here) when an attempt is made to put a too large integer into a long int.  As a stopgap I will make sure that when some warning is output just before abort() then the output is flushed.\n\nThis will need a new eclib version, so patching ROUNDUP and ROUNDOWN in mwrank1.cc as suggested would be a reasonable stopgap.",
    "created_at": "2019-09-09T08:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553066",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:13'></a>
No objection.   I know that it is a *bad thing* for library functions to call abort() and ideally I would recode the places where that happens, but there are hundreds of such places since I seem to use it whenever something invalid is tried such as adding two vectors of different lengths, as well as when memory allocation fails or (as here) when an attempt is made to put a too large integer into a long int.  As a stopgap I will make sure that when some warning is output just before abort() then the output is flushed.

This will need a new eclib version, so patching ROUNDUP and ROUNDOWN in mwrank1.cc as suggested would be a reasonable stopgap.



---

archive/issue_comments_553067.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [cremona](#comment%3A13):\n> No objection.   I know that it is a *bad thing* for library functions to call abort() and ideally I would recode the places where that happens, but there are hundreds of such places since I seem to use it whenever something invalid is tried such as adding two vectors of different lengths, as well as when memory allocation fails or (as here) when an attempt is made to put a too large integer into a long int.  As a stopgap I will make sure that when some warning is output just before abort() then the output is flushed.\n> \n> This will need a new eclib version, so patching ROUNDUP and ROUNDOWN in mwrank1.cc as suggested would be a reasonable stopgap.\n\n\n\nThere will soon be a new version of eclib (tarball is at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/eclib-20190909.tar.bz2) which removes all calls to abort() and does something reasonable wherever that used to happen, including flushing output.  I have not made this new version into an official release yet.  The behaviour of mwrank on being given a curve with huge coefficients is \n\n```\n$ ./progs/mwrank -v 0 \nProgram mwrank: uses 2-descent (via 2-isogeny if possible) to\ndetermine the rank of an elliptic curve E over Q, and list a\nset of points which generate E(Q) modulo 2E(Q).\nand finally saturate to obtain generating points on the curve.\nFor more details see the mwrank documentation.\nFor details of algorithms see the author's book.\n\nPlease acknowledge use of this program in published work, \nand send problems to john.cremona@gmail.com.\n\nVersion compiled on Sep  9 2019 at 15:05:13 by GCC 5.4.0 20160609\nusing NTL bigints and NTL real and complex multiprecision floating point\nEnter curve: 0 0 0 0 429347239472947294723947203947209422347204720472021\nCurve [0,0,0,0,429347239472947294723947203947209422347204720472021] :   Attempt to convert -0.85368380442727e34 to long fails!\n2-descent: lower bound -0.85368380442727e34 on c too large\nAttempt to convert -0.13658940870836e36 to long fails!\n2-descent: lower bound -0.13658940870836e36 on c too large\nFailed to compute rank\n```\n\nresulting in something (a success flag) which Sage could test (as it already does in some circumstances).  It will need a little more work before Sage can install this version and pass tests, but it could be tested as is.",
    "created_at": "2019-09-09T14:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553067",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:14'></a>
Replying to [cremona](#comment%3A13):
> No objection.   I know that it is a *bad thing* for library functions to call abort() and ideally I would recode the places where that happens, but there are hundreds of such places since I seem to use it whenever something invalid is tried such as adding two vectors of different lengths, as well as when memory allocation fails or (as here) when an attempt is made to put a too large integer into a long int.  As a stopgap I will make sure that when some warning is output just before abort() then the output is flushed.
> 
> This will need a new eclib version, so patching ROUNDUP and ROUNDOWN in mwrank1.cc as suggested would be a reasonable stopgap.



There will soon be a new version of eclib (tarball is at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/eclib-20190909.tar.bz2) which removes all calls to abort() and does something reasonable wherever that used to happen, including flushing output.  I have not made this new version into an official release yet.  The behaviour of mwrank on being given a curve with huge coefficients is 

```
$ ./progs/mwrank -v 0 
Program mwrank: uses 2-descent (via 2-isogeny if possible) to
determine the rank of an elliptic curve E over Q, and list a
set of points which generate E(Q) modulo 2E(Q).
and finally saturate to obtain generating points on the curve.
For more details see the mwrank documentation.
For details of algorithms see the author's book.

Please acknowledge use of this program in published work, 
and send problems to john.cremona@gmail.com.

Version compiled on Sep  9 2019 at 15:05:13 by GCC 5.4.0 20160609
using NTL bigints and NTL real and complex multiprecision floating point
Enter curve: 0 0 0 0 429347239472947294723947203947209422347204720472021
Curve [0,0,0,0,429347239472947294723947203947209422347204720472021] :   Attempt to convert -0.85368380442727e34 to long fails!
2-descent: lower bound -0.85368380442727e34 on c too large
Attempt to convert -0.13658940870836e36 to long fails!
2-descent: lower bound -0.13658940870836e36 on c too large
Failed to compute rank
```

resulting in something (a success flag) which Sage could test (as it already does in some circumstances).  It will need a little more work before Sage can install this version and pass tests, but it could be tested as is.



---

archive/issue_comments_553068.json:
```json
{
    "body": "<a id='comment:15'></a>\nThe tarball in comment 14 is looking good (to me).  After installing it in a python2 Sage I only needed to adjust one doctest in this file interface.py: line 359 now says\n\n```\nRuntimeError: A 2-descent did not complete successfully.\n```\n\nI have not yet done any python3 testing.",
    "created_at": "2019-09-09T16:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553068",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>
The tarball in comment 14 is looking good (to me).  After installing it in a python2 Sage I only needed to adjust one doctest in this file interface.py: line 359 now says

```
RuntimeError: A 2-descent did not complete successfully.
```

I have not yet done any python3 testing.



---

archive/issue_comments_553069.json:
```json
{
    "body": "<a id='comment:16'></a>\nIt looks good to me, too, at least as far as the doctests in `libs/eclib/` are concerned: I just see the one problem you mentioned. This is with Python 3.\n\nI think I will still prepare a patch for the old version, since it's easy to do, and if we end up not needing it and going straight to your new version, that's fine with me.",
    "created_at": "2019-09-09T18:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553069",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
It looks good to me, too, at least as far as the doctests in `libs/eclib/` are concerned: I just see the one problem you mentioned. This is with Python 3.

I think I will still prepare a patch for the old version, since it's easy to do, and if we end up not needing it and going straight to your new version, that's fine with me.



---

archive/issue_comments_553070.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [jhpalmieri](#comment%3A16):\n> It looks good to me, too, at least as far as the doctests in `libs/eclib/` are concerned: I just see the one problem you mentioned. This is with Python 3.\n> \n\n\nGood.  I had a successful \"make ptestlong\" too (python2).\n\n> I think I will still prepare a patch for the old version, since it's easy to do, and if we end up not needing it and going straight to your new version, that's fine with me.\n\n\nThanks.",
    "created_at": "2019-09-09T18:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553070",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:17'></a>
Replying to [jhpalmieri](#comment%3A16):
> It looks good to me, too, at least as far as the doctests in `libs/eclib/` are concerned: I just see the one problem you mentioned. This is with Python 3.
> 


Good.  I had a successful "make ptestlong" too (python2).

> I think I will still prepare a patch for the old version, since it's easy to do, and if we end up not needing it and going straight to your new version, that's fine with me.


Thanks.



---

archive/issue_comments_553071.json:
```json
{
    "body": "**Branch:** [u/jhpalmieri/eclib-flush](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/eclib-flush)",
    "created_at": "2019-09-09T18:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553071",
    "user": "https://github.com/jhpalmieri"
}
```

**Branch:** [u/jhpalmieri/eclib-flush](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/eclib-flush)



---

archive/issue_comments_553072.json:
```json
{
    "body": "**Commit:** [ad86cbe9689b2488f481a9295f5c25e5a3e69d7a](https://github.com/sagemath/sagetrac-mirror/commit/ad86cbe9689b2488f481a9295f5c25e5a3e69d7a)",
    "created_at": "2019-09-09T18:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553072",
    "user": "https://github.com/jhpalmieri"
}
```

**Commit:** [ad86cbe9689b2488f481a9295f5c25e5a3e69d7a](https://github.com/sagemath/sagetrac-mirror/commit/ad86cbe9689b2488f481a9295f5c25e5a3e69d7a)



---

archive/issue_comments_553073.json:
```json
{
    "body": "<a id='comment:19'></a>\nOkay, done. I think I need you to decide whether to use the patch or wait for a new version, since I don't know your timeline. If a new release won't be ready within a week or so, I would suggest using the patch. I'd certainly rather do that than have you feel under any time pressure to produce a new release. (Full Python 3 support, with all tests passing, is very close, and I want to make progress quickly when possible.)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad86cbe9689b2488f481a9295f5c25e5a3e69d7a\">ad86cbe</a></td><td><code>trac 28454: patch eclib to flush output after printing some messages.</code></td></tr></table>\n",
    "created_at": "2019-09-09T18:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553073",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
Okay, done. I think I need you to decide whether to use the patch or wait for a new version, since I don't know your timeline. If a new release won't be ready within a week or so, I would suggest using the patch. I'd certainly rather do that than have you feel under any time pressure to produce a new release. (Full Python 3 support, with all tests passing, is very close, and I want to make progress quickly when possible.)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad86cbe9689b2488f481a9295f5c25e5a3e69d7a">ad86cbe</a></td><td><code>trac 28454: patch eclib to flush output after printing some messages.</code></td></tr></table>




---

archive/issue_comments_553074.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe other good news is that because of this ticket, I realized that the same non-flushing problem causes another Python 3 doctest failure (#28334), which I had no idea how to diagnose before.",
    "created_at": "2019-09-09T19:09:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553074",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>
The other good news is that because of this ticket, I realized that the same non-flushing problem causes another Python 3 doctest failure (#28334), which I had no idea how to diagnose before.



---

archive/issue_comments_553075.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/eclib-flush](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/eclib-flush)\" to \"[u/cremona/28454](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/28454)\".",
    "created_at": "2019-09-10T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553075",
    "user": "https://github.com/JohnCremona"
}
```

**Changing branch** from "[u/jhpalmieri/eclib-flush](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/eclib-flush)" to "[u/cremona/28454](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/28454)".



---

archive/issue_comments_553076.json:
```json
{
    "body": "**Author:** John Cremona, John Palmieri",
    "created_at": "2019-09-10T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553076",
    "user": "https://github.com/JohnCremona"
}
```

**Author:** John Cremona, John Palmieri



---

archive/issue_comments_553077.json:
```json
{
    "body": "**Changing commit** from \"[ad86cbe9689b2488f481a9295f5c25e5a3e69d7a](https://github.com/sagemath/sagetrac-mirror/commit/ad86cbe9689b2488f481a9295f5c25e5a3e69d7a)\" to \"[6ab659a47a1318932020dc2edec2dbb7eefc9295](https://github.com/sagemath/sagetrac-mirror/commit/6ab659a47a1318932020dc2edec2dbb7eefc9295)\".",
    "created_at": "2019-09-10T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553077",
    "user": "https://github.com/JohnCremona"
}
```

**Changing commit** from "[ad86cbe9689b2488f481a9295f5c25e5a3e69d7a](https://github.com/sagemath/sagetrac-mirror/commit/ad86cbe9689b2488f481a9295f5c25e5a3e69d7a)" to "[6ab659a47a1318932020dc2edec2dbb7eefc9295](https://github.com/sagemath/sagetrac-mirror/commit/6ab659a47a1318932020dc2edec2dbb7eefc9295)".



---

archive/issue_comments_553078.json:
```json
{
    "body": "**Reviewer:** John Cremona",
    "created_at": "2019-09-10T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553078",
    "user": "https://github.com/JohnCremona"
}
```

**Reviewer:** John Cremona



---

archive/issue_comments_553079.json:
```json
{
    "body": "<a id='comment:21'></a>\nI hope I have not broken any etiquette by replacing your patch with my own, which just patches the file sage.libs.eclib.wrap.cpp to ensure that both cout and cerr are flushed after every eclib library call which might bail out.  (I have a good idea of which these are having gone through over 200 places where eclib library functions call abort() yesterday).\n\nThe behaviour originally reported never happened for me anyway (on ubuntu) so I cannot really test, but \"make ptestlong\" had failures in 28 files (around 80 doctests in all) none of which are related to this as far as I can see.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ab659a47a1318932020dc2edec2dbb7eefc9295\">6ab659a</a></td><td><code>#28454: systematic flushing of cout and cerr after calling eclib functions</code></td></tr></table>\n",
    "created_at": "2019-09-10T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553079",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:21'></a>
I hope I have not broken any etiquette by replacing your patch with my own, which just patches the file sage.libs.eclib.wrap.cpp to ensure that both cout and cerr are flushed after every eclib library call which might bail out.  (I have a good idea of which these are having gone through over 200 places where eclib library functions call abort() yesterday).

The behaviour originally reported never happened for me anyway (on ubuntu) so I cannot really test, but "make ptestlong" had failures in 28 files (around 80 doctests in all) none of which are related to this as far as I can see.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ab659a47a1318932020dc2edec2dbb7eefc9295">6ab659a</a></td><td><code>#28454: systematic flushing of cout and cerr after calling eclib functions</code></td></tr></table>




---

archive/issue_comments_553080.json:
```json
{
    "body": "<a id='comment:22'></a>\nTicket #28472 has an eclib upgrade.  No reason why the patch here cannot be merged first.",
    "created_at": "2019-09-10T18:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553080",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:22'></a>
Ticket #28472 has an eclib upgrade.  No reason why the patch here cannot be merged first.



---

archive/issue_comments_553081.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2019-09-10T18:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553081",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_553082.json:
```json
{
    "body": "<a id='comment:23'></a>\nI get a doctest failure with Python 3 on debian: similar, but the output is flushed almost (but not quite) immediately, so the message appears in the doctest after the one where it should:\n\n```\nFile \"src/sage/libs/eclib/interface.py\", line 368, in sage.libs.eclib.interface.mwrank_EllipticCurve.?\nFailed example:\n    E.two_descent(verbose=False)\nExpected:\n    True\nGot:\n    Attempt to round -0.2617840677e25 to a long int fails, aborting!\n    True\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.libs.eclib.interface.mwrank_EllipticCurve.?\n    [192 tests, 1 failure, 7.16 s]\n----------------------------------------------------------------------\nsage -t --warn-long 206.6 src/sage/libs/eclib/interface.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-09-10T18:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553082",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
I get a doctest failure with Python 3 on debian: similar, but the output is flushed almost (but not quite) immediately, so the message appears in the doctest after the one where it should:

```
File "src/sage/libs/eclib/interface.py", line 368, in sage.libs.eclib.interface.mwrank_EllipticCurve.?
Failed example:
    E.two_descent(verbose=False)
Expected:
    True
Got:
    Attempt to round -0.2617840677e25 to a long int fails, aborting!
    True
**********************************************************************
1 item had failures:
   1 of   6 in sage.libs.eclib.interface.mwrank_EllipticCurve.?
    [192 tests, 1 failure, 7.16 s]
----------------------------------------------------------------------
sage -t --warn-long 206.6 src/sage/libs/eclib/interface.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_553083.json:
```json
{
    "body": "<a id='comment:24'></a>\n(No breach of etiquette at all, by the way. I just want to get the problem fixed.)",
    "created_at": "2019-09-10T19:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553083",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>
(No breach of etiquette at all, by the way. I just want to get the problem fixed.)



---

archive/issue_comments_553084.json:
```json
{
    "body": "<a id='comment:25'></a>\nStrange.  I'll double check that I put in all the flushes, and perhaps insert some more before as well as after each library call.",
    "created_at": "2019-09-10T21:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553084",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:25'></a>
Strange.  I'll double check that I put in all the flushes, and perhaps insert some more before as well as after each library call.



---

archive/issue_comments_553085.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [cremona](#comment%3A25):\n> Strange.  I'll double check that I put in all the flushes, and perhaps insert some more before as well as after each library call.\n\n\nI think that accepting #28472 now is the best way to go.",
    "created_at": "2019-09-11T08:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553085",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:26'></a>
Replying to [cremona](#comment%3A25):
> Strange.  I'll double check that I put in all the flushes, and perhaps insert some more before as well as after each library call.


I think that accepting #28472 now is the best way to go.



---

archive/issue_comments_553086.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2019-09-11T18:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553086",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_080643.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-09-11T18:38:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28454#event-80643"
}
```



---

archive/issue_comments_553087.json:
```json
{
    "body": "<a id='comment:27'></a>\nI agree. I'm marking this as a duplicate.",
    "created_at": "2019-09-11T18:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553087",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>
I agree. I'm marking this as a duplicate.



---

archive/issue_comments_553088.json:
```json
{
    "body": "<a id='comment:28'></a>\n(deleting the branch so it doesn't get merged by accident)",
    "created_at": "2019-09-12T21:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553088",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
(deleting the branch so it doesn't get merged by accident)



---

archive/issue_comments_553089.json:
```json
{
    "body": "**Changing branch** from \"[u/cremona/28454](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/28454)\" to \"\".",
    "created_at": "2019-09-12T21:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553089",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing branch** from "[u/cremona/28454](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/28454)" to "".



---

archive/issue_comments_553090.json:
```json
{
    "body": "**Changing commit** from \"[6ab659a47a1318932020dc2edec2dbb7eefc9295](https://github.com/sagemath/sagetrac-mirror/commit/6ab659a47a1318932020dc2edec2dbb7eefc9295)\" to \"\".",
    "created_at": "2019-09-12T21:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553090",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing commit** from "[6ab659a47a1318932020dc2edec2dbb7eefc9295](https://github.com/sagemath/sagetrac-mirror/commit/6ab659a47a1318932020dc2edec2dbb7eefc9295)" to "".



---

archive/issue_comments_553091.json:
```json
{
    "body": "**Resolution:** duplicate",
    "created_at": "2019-09-14T06:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553091",
    "user": "https://github.com/fchapoton"
}
```

**Resolution:** duplicate



---

archive/issue_events_080644.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-14T06:04:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28454#event-80644"
}
```



---

archive/issue_comments_553092.json:
```json
{
    "body": "<a id='comment:30'></a>\nI know this is closed, but can you reproduce the issue if you run the tests with `--memlimit=0`?",
    "created_at": "2019-09-18T11:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553092",
    "user": "https://github.com/embray"
}
```

<a id='comment:30'></a>
I know this is closed, but can you reproduce the issue if you run the tests with `--memlimit=0`?



---

archive/issue_comments_553093.json:
```json
{
    "body": "<a id='comment:31'></a>\n`./sage -t --memlimit=0 src/sage/lib/eclib/interface.py` fails the same way.",
    "created_at": "2019-09-18T16:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28454#issuecomment-553093",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'></a>
`./sage -t --memlimit=0 src/sage/lib/eclib/interface.py` fails the same way.
