# Issue 28341: Allow doc to build with SAGE_PARI_CFG undefined

archive/issues_028104.json:
```json
{
    "body": "Follow up to #28242 which introduced `SAGE_PARI_CFG` in documentation build to identity whether or not pari is external.\n\nThis is inconvenient to distros and the behavior for external `pari` should be assumed if `SAGE_PARI_CFG` is undefined.\n\nCC:  @dimpase @timokau\n\nBranch/Commit: 27f17ffa52d68349ea978cea1f2acc5c55e52c19\n\nReviewer: Dima Pasechnik\n\nAuthor: Fran\u00e7ois Bissey\n\nDependencies: #28242\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28341\n\n",
    "closed_at": "2019-08-13T22:39:20Z",
    "created_at": "2019-08-11T01:02:32Z",
    "labels": [
        "component: distribution",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Allow doc to build with SAGE_PARI_CFG undefined",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28341",
    "user": "https://github.com/kiwifb"
}
```
Follow up to #28242 which introduced `SAGE_PARI_CFG` in documentation build to identity whether or not pari is external.

This is inconvenient to distros and the behavior for external `pari` should be assumed if `SAGE_PARI_CFG` is undefined.

CC:  @dimpase @timokau

Branch/Commit: 27f17ffa52d68349ea978cea1f2acc5c55e52c19

Reviewer: Dima Pasechnik

Author: François Bissey

Dependencies: #28242

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28341





---

archive/issue_comments_549774.json:
```json
{
    "body": "<a id='comment:1'></a>Will replace `os.environ['SAGE_PARI_CFG']` by `os.environ.get('SAGE_PARI_CFG')` in `sage_setuo/docbuild/__init__.py`.",
    "created_at": "2019-08-11T01:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549774",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>Will replace `os.environ['SAGE_PARI_CFG']` by `os.environ.get('SAGE_PARI_CFG')` in `sage_setuo/docbuild/__init__.py`.



---

archive/issue_comments_549775.json:
```json
{
    "body": "<a id='comment:3'></a>`@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?",
    "created_at": "2019-08-11T22:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549775",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>`@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?



---

archive/issue_comments_549776.json:
```json
{
    "body": "<a id='comment:5'></a>using SAGE_PARI_CFG in docbuild is a hack.\nOne should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. \n\nSAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc",
    "created_at": "2019-08-11T22:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549776",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>using SAGE_PARI_CFG in docbuild is a hack.
One should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. 

SAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc



---

archive/issue_comments_549777.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [dimpase](#comment%3A5):\n> using SAGE_PARI_CFG in docbuild is a hack.\n> One should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. \n> \n> SAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc\n\n\nYes, I figured that out. On the other hand `sage_setup/docbuild/__init__.py` may not be the right place to check. So at the moment I just want to make sure that on distro where you don't run `configure` you get the same result as what you would expect if sage doesn't build `pari` but finds it on the system.",
    "created_at": "2019-08-11T22:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549777",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>Replying to [dimpase](#comment%3A5):
> using SAGE_PARI_CFG in docbuild is a hack.
> One should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. 
> 
> SAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc


Yes, I figured that out. On the other hand `sage_setup/docbuild/__init__.py` may not be the right place to check. So at the moment I just want to make sure that on distro where you don't run `configure` you get the same result as what you would expect if sage doesn't build `pari` but finds it on the system.



---

archive/issue_comments_549778.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [fbissey](#comment%3A3):\n> `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?\n\n\nThis is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.",
    "created_at": "2019-08-11T22:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549778",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Replying to [fbissey](#comment%3A3):
> `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?


This is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.



---

archive/issue_comments_549779.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [dimpase](#comment%3A7):\n> Replying to [fbissey](#comment%3A3):\n> > `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?\n\n> \n> This is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.\n\n\nI remarked on that in #28242. This is about having something working out of the box without extra patching or settings. Just using `os.environ.get()` already does enable me to build the doc without `SAGE_PARI_CFG` being set, which is a progress. I am testing the alternative builder now. Not that I can currently build the doc on Volker's branch because there is a label missing in the doc for manifolds from one of the tickets he is trying to merge.",
    "created_at": "2019-08-11T23:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549779",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>Replying to [dimpase](#comment%3A7):
> Replying to [fbissey](#comment%3A3):
> > `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?

> 
> This is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.


I remarked on that in #28242. This is about having something working out of the box without extra patching or settings. Just using `os.environ.get()` already does enable me to build the doc without `SAGE_PARI_CFG` being set, which is a progress. I am testing the alternative builder now. Not that I can currently build the doc on Volker's branch because there is a label missing in the doc for manifolds from one of the tickets he is trying to merge.



---

archive/issue_comments_549780.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549780",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_549781.json:
```json
{
    "body": "<a id='comment:9'></a>Last 10 new commits:",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549781",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>Last 10 new commits:



---

archive/issue_comments_549782.json:
```json
{
    "body": "Changing commit from \"\" to \"27f17ffa52d68349ea978cea1f2acc5c55e52c19\"",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549782",
    "user": "https://github.com/kiwifb"
}
```

Changing commit from "" to "27f17ffa52d68349ea978cea1f2acc5c55e52c19"



---

archive/issue_comments_549783.json:
```json
{
    "body": "Changing author from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549783",
    "user": "https://github.com/kiwifb"
}
```

Changing author from "" to "François Bissey"



---

archive/issue_comments_549784.json:
```json
{
    "body": "Changing dependencies from \"\" to \"28242\"",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549784",
    "user": "https://github.com/kiwifb"
}
```

Changing dependencies from "" to "28242"



---

archive/issue_comments_549785.json:
```json
{
    "body": "Changing branch from \"\" to \"u/fbissey/pari_cfg_doc\"",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549785",
    "user": "https://github.com/kiwifb"
}
```

Changing branch from "" to "u/fbissey/pari_cfg_doc"



---

archive/issue_comments_549786.json:
```json
{
    "body": "Changing dependencies from \"28242\" to \"#28242\"",
    "created_at": "2019-08-12T05:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549786",
    "user": "https://github.com/dimpase"
}
```

Changing dependencies from "28242" to "#28242"



---

archive/issue_comments_549787.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2019-08-12T05:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549787",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_549788.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-12T05:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549788",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_549789.json:
```json
{
    "body": "<a id='comment:11'></a>lgtm",
    "created_at": "2019-08-12T05:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549789",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>lgtm



---

archive/issue_events_070781.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-13T22:39:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28341#event-70781"
}
```



---

archive/issue_comments_549790.json:
```json
{
    "body": "Changing branch from \"u/fbissey/pari_cfg_doc\" to \"27f17ffa52d68349ea978cea1f2acc5c55e52c19\"",
    "created_at": "2019-08-13T22:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549790",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/fbissey/pari_cfg_doc" to "27f17ffa52d68349ea978cea1f2acc5c55e52c19"



---

archive/issue_comments_549791.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-13T22:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-549791",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
