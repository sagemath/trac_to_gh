# Issue 28341: Allow doc to build with SAGE_PARI_CFG undefined

archive/issues_028104.json:
```json
{
    "body": "Follow up to #28242 which introduced `SAGE_PARI_CFG` in documentation build to identity whether or not pari is external.\n\nThis is inconvenient to distros and the behavior for external `pari` should be assumed if `SAGE_PARI_CFG` is undefined.\n\nCC:  @dimpase @timokau\n\nBranch/Commit: 27f17ffa52d68349ea978cea1f2acc5c55e52c19\n\nReviewer: Dima Pasechnik\n\nAuthor: Fran\u00e7ois Bissey\n\nDependencies: #28242\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28341\n\n",
    "closed_at": "2019-08-13T22:39:20Z",
    "created_at": "2019-08-11T01:02:32Z",
    "labels": [
        "component: distribution",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Allow doc to build with SAGE_PARI_CFG undefined",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28341",
    "user": "https://github.com/kiwifb"
}
```
Follow up to #28242 which introduced `SAGE_PARI_CFG` in documentation build to identity whether or not pari is external.

This is inconvenient to distros and the behavior for external `pari` should be assumed if `SAGE_PARI_CFG` is undefined.

CC:  @dimpase @timokau

Branch/Commit: 27f17ffa52d68349ea978cea1f2acc5c55e52c19

Reviewer: Dima Pasechnik

Author: Fran√ßois Bissey

Dependencies: #28242

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28341





---

archive/issue_comments_396615.json:
```json
{
    "body": "<a id='comment:1'></a>Will replace `os.environ['SAGE_PARI_CFG']` by `os.environ.get('SAGE_PARI_CFG')` in `sage_setuo/docbuild/__init__.py`.",
    "created_at": "2019-08-11T01:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396615",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>Will replace `os.environ['SAGE_PARI_CFG']` by `os.environ.get('SAGE_PARI_CFG')` in `sage_setuo/docbuild/__init__.py`.



---

archive/issue_comments_396616.json:
```json
{
    "body": "<a id='comment:3'></a>`@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?",
    "created_at": "2019-08-11T22:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396616",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>`@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?



---

archive/issue_comments_396617.json:
```json
{
    "body": "<a id='comment:5'></a>using SAGE_PARI_CFG in docbuild is a hack.\nOne should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. \n\nSAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc",
    "created_at": "2019-08-11T22:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396617",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>using SAGE_PARI_CFG in docbuild is a hack.
One should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. 

SAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc



---

archive/issue_comments_396618.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 dimpase]:\n> using SAGE_PARI_CFG in docbuild is a hack.\n> One should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. \n> \n> SAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc\n\n\nYes, I figured that out. On the other hand `sage_setup/docbuild/__init__.py` may not be the right place to check. So at the moment I just want to make sure that on distro where you don't run `configure` you get the same result as what you would expect if sage doesn't build `pari` but finds it on the system.",
    "created_at": "2019-08-11T22:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396618",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>Replying to [comment:5 dimpase]:
> using SAGE_PARI_CFG in docbuild is a hack.
> One should really test whether the external pari is multithreaded, this is something that can be done, I just didn't do. 
> 
> SAGE_PARI_CFG is storing the location of pari.cfg, something hard to find out, and needed to install gp2c, see https://git.sagemath.org/sage.git/diff/build/pkgs/gp2c/spkg-configure.m4?id=46772dbb31f2be940bda299136455f495c6a21dc


Yes, I figured that out. On the other hand `sage_setup/docbuild/__init__.py` may not be the right place to check. So at the moment I just want to make sure that on distro where you don't run `configure` you get the same result as what you would expect if sage doesn't build `pari` but finds it on the system.



---

archive/issue_comments_396619.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:3 fbissey]:\n> `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?\n\n\nThis is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.",
    "created_at": "2019-08-11T22:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396619",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Replying to [comment:3 fbissey]:
> `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?


This is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.



---

archive/issue_comments_396620.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 dimpase]:\n> Replying to [comment:3 fbissey]:\n> > `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?\n\n> \n> This is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.\n\n\nI remarked on that in #28242. This is about having something working out of the box without extra patching or settings. Just using `os.environ.get()` already does enable me to build the doc without `SAGE_PARI_CFG` being set, which is a progress. I am testing the alternative builder now. Not that I can currently build the doc on Volker's branch because there is a label missing in the doc for manifolds from one of the tickets he is trying to merge.",
    "created_at": "2019-08-11T23:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396620",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>Replying to [comment:7 dimpase]:
> Replying to [comment:3 fbissey]:
> > `@`Dima just so I don't make a mistake. `''` is the value you get when `pari` is coming from the system?

> 
> This is the value I *set*. But you can just unconditionally switch to the appropriate docbuilder in Gentoo.


I remarked on that in #28242. This is about having something working out of the box without extra patching or settings. Just using `os.environ.get()` already does enable me to build the doc without `SAGE_PARI_CFG` being set, which is a progress. I am testing the alternative builder now. Not that I can currently build the doc on Volker's branch because there is a label missing in the doc for manifolds from one of the tickets he is trying to merge.



---

archive/issue_comments_396621.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396621",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396622.json:
```json
{
    "body": "<a id='comment:9'></a>Last 10 new commits:",
    "created_at": "2019-08-12T00:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396622",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>Last 10 new commits:



---

archive/issue_comments_396623.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-12T05:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396623",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396624.json:
```json
{
    "body": "<a id='comment:11'></a>lgtm",
    "created_at": "2019-08-12T05:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396624",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>lgtm



---

archive/issue_events_070781.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-13T22:39:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28341#event-70781"
}
```



---

archive/issue_comments_396625.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-13T22:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28341#issuecomment-396625",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
