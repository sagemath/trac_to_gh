# Issue 28673: Do not create ipython symlink

archive/issues_028436.json:
```json
{
    "body": "When `python` runs Python 3, the IPython `spkg-install` script creates a symlink `ipython3 -> ipython` in `SAGE_LOCAL/bin`, and this interferes with the installation process.\n\n\nCC:  @dimpase\n\nBranch/Commit: d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9\n\nReviewer: Dima Pasechnik\n\nAuthor: John Palmieri\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28673\n\n",
    "closed_at": "2019-10-31T22:40:51Z",
    "created_at": "2019-10-29T22:39:08Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Do not create ipython symlink",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28673",
    "user": "https://github.com/jhpalmieri"
}
```
When `python` runs Python 3, the IPython `spkg-install` script creates a symlink `ipython3 -> ipython` in `SAGE_LOCAL/bin`, and this interferes with the installation process.


CC:  @dimpase

Branch/Commit: d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9

Reviewer: Dima Pasechnik

Author: John Palmieri

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28673





---

archive/issue_comments_427595.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2019-10-29T22:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427595",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_427596.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-10-29T22:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427596",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_427597.json:
```json
{
    "body": "<a id='comment:3'></a>By the way, the deleted lines never really functioned as intended: in earlier versions of Sage, `python` was always installed as Python 2. In the most recent versions of Sage, with a Python 3 build, `python2` is not installed, so there is no `$SAGE_LOCAL/bin/python`. In that case the test\n\n```\nif python -c 'import sys; sys.exit(sys.version_info.major != 3)'\n```\nwill only test positively if the system `python` runs Python 3.\n\nAlso, the `spkg-install` procedure involves building elsewhere and then installing all at once into `SAGE_LOCAL`, so manually creating the symlink makes no sense at all.",
    "created_at": "2019-10-29T22:55:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427597",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>By the way, the deleted lines never really functioned as intended: in earlier versions of Sage, `python` was always installed as Python 2. In the most recent versions of Sage, with a Python 3 build, `python2` is not installed, so there is no `$SAGE_LOCAL/bin/python`. In that case the test

```
if python -c 'import sys; sys.exit(sys.version_info.major != 3)'
```
will only test positively if the system `python` runs Python 3.

Also, the `spkg-install` procedure involves building elsewhere and then installing all at once into `SAGE_LOCAL`, so manually creating the symlink makes no sense at all.



---

archive/issue_comments_427598.json:
```json
{
    "body": "<a id='comment:4'></a>is there a need to put `rm -f \"$SAGE_LOCAL\"/bin/ipython` into `if` clause?\nCertainly not needed on Linux...",
    "created_at": "2019-10-29T22:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427598",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>is there a need to put `rm -f "$SAGE_LOCAL"/bin/ipython` into `if` clause?
Certainly not needed on Linux...



---

archive/issue_comments_427599.json:
```json
{
    "body": "<a id='comment:5'></a>I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)",
    "created_at": "2019-10-29T23:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427599",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)



---

archive/issue_comments_427600.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-10-29T23:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427600",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_427601.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:5 jhpalmieri]:\n> I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)\n\n\nunistall only happens if it was properly installed (with sdh_... script), with the corresponding uninstall info stored.\nIf not, it would be left there.\n\nIMHO \"rf -f blah\" ignores the result  - if blah was not there, there is still no error (although OSX might be different...)",
    "created_at": "2019-10-30T06:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427601",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Replying to [comment:5 jhpalmieri]:
> I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)


unistall only happens if it was properly installed (with sdh_... script), with the corresponding uninstall info stored.
If not, it would be left there.

IMHO "rf -f blah" ignores the result  - if blah was not there, there is still no error (although OSX might be different...)



---

archive/issue_comments_427602.json:
```json
{
    "body": "<a id='comment:8'></a>looks good to me. Please double-check that repeatedly running\n`./sage -f ipython` on MacOS works, then you can set it to positive review.",
    "created_at": "2019-10-30T07:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427602",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>looks good to me. Please double-check that repeatedly running
`./sage -f ipython` on MacOS works, then you can set it to positive review.



---

archive/issue_comments_427603.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-30T17:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427603",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_072215.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-31T22:40:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28673#event-72215"
}
```



---

archive/issue_comments_427604.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-31T22:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28673#issuecomment-427604",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
