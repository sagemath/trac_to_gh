# Issue 28673: Do not create ipython symlink

archive/issues_028436.json:
```json
{
    "assignees": [],
    "body": "When `python` runs Python 3, the IPython `spkg-install` script creates a symlink `ipython3 -> ipython` in `SAGE_LOCAL/bin`, and this interferes with the installation process.\n\n\nCC:  @dimpase\n\nBranch/Commit: **[`d2873c2`](https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **John Palmieri**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28673_\n\n",
    "closed_at": "2019-10-31T22:40:51Z",
    "created_at": "2019-10-29T22:39:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Do not create ipython symlink",
    "type": "issue",
    "updated_at": "2019-10-31T22:40:51Z",
    "url": "https://github.com/sagemath/sage/issues/28673",
    "user": "https://github.com/jhpalmieri"
}
```
When `python` runs Python 3, the IPython `spkg-install` script creates a symlink `ipython3 -> ipython` in `SAGE_LOCAL/bin`, and this interferes with the installation process.


CC:  @dimpase

Branch/Commit: **[`d2873c2`](https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9)**

Reviewer: **Dima Pasechnik**

Author: **John Palmieri**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/28673_





---

archive/issue_events_393835.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-29T22:39:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393835"
}
```



---

archive/issue_events_393836.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-29T22:39:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393836"
}
```



---

archive/issue_events_393837.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-29T22:39:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393837"
}
```



---

archive/issue_events_393838.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-29T22:39:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393838"
}
```



---

archive/issue_comments_447379.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/ipython-no-symlink](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ipython-no-symlink)**",
    "created_at": "2019-10-29T22:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447379",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/ipython-no-symlink](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ipython-no-symlink)**



---

archive/issue_comments_447380.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5b5d4f6490d2227e76ef5e2447022f1e3f9016f\"><code>f5b5d4f</code></a></td><td><code>trac 28673: when installing IPython, do not create a symlink in spkg-install</code></td></tr></table>\n",
    "created_at": "2019-10-29T22:39:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447380",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5b5d4f6490d2227e76ef5e2447022f1e3f9016f"><code>f5b5d4f</code></a></td><td><code>trac 28673: when installing IPython, do not create a symlink in spkg-install</code></td></tr></table>




---

archive/issue_events_393839.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-29T22:39:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393839"
}
```



---

archive/issue_comments_447381.json:
```json
{
    "body": "Commit: **[`f5b5d4f`](https://github.com/sagemath/sagetrac-mirror/commit/f5b5d4f6490d2227e76ef5e2447022f1e3f9016f)**",
    "created_at": "2019-10-29T22:39:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447381",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[`f5b5d4f`](https://github.com/sagemath/sagetrac-mirror/commit/f5b5d4f6490d2227e76ef5e2447022f1e3f9016f)**



---

archive/issue_comments_447382.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nBy the way, the deleted lines never really functioned as intended: in earlier versions of Sage, `python` was always installed as Python 2. In the most recent versions of Sage, with a Python 3 build, `python2` is not installed, so there is no `$SAGE_LOCAL/bin/python`. In that case the test\n\n```\nif python -c 'import sys; sys.exit(sys.version_info.major != 3)'\n```\nwill only test positively if the system `python` runs Python 3.\n\nAlso, the `spkg-install` procedure involves building elsewhere and then installing all at once into `SAGE_LOCAL`, so manually creating the symlink makes no sense at all.",
    "created_at": "2019-10-29T22:55:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447382",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

By the way, the deleted lines never really functioned as intended: in earlier versions of Sage, `python` was always installed as Python 2. In the most recent versions of Sage, with a Python 3 build, `python2` is not installed, so there is no `$SAGE_LOCAL/bin/python`. In that case the test

```
if python -c 'import sys; sys.exit(sys.version_info.major != 3)'
```
will only test positively if the system `python` runs Python 3.

Also, the `spkg-install` procedure involves building elsewhere and then installing all at once into `SAGE_LOCAL`, so manually creating the symlink makes no sense at all.



---

archive/issue_comments_447383.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nis there a need to put `rm -f \"$SAGE_LOCAL\"/bin/ipython` into `if` clause?\nCertainly not needed on Linux...",
    "created_at": "2019-10-29T22:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447383",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

is there a need to put `rm -f "$SAGE_LOCAL"/bin/ipython` into `if` clause?
Certainly not needed on Linux...



---

archive/issue_comments_447384.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)",
    "created_at": "2019-10-29T23:41:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447384",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)



---

archive/issue_comments_447385.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9\"><code>d2873c2</code></a></td><td><code>trac 28673: when installing IPython, do not create a symlink in spkg-install</code></td></tr></table>\n",
    "created_at": "2019-10-29T23:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447385",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9"><code>d2873c2</code></a></td><td><code>trac 28673: when installing IPython, do not create a symlink in spkg-install</code></td></tr></table>




---

archive/issue_comments_447386.json:
```json
{
    "body": "Changed commit from **[`f5b5d4f`](https://github.com/sagemath/sagetrac-mirror/commit/f5b5d4f6490d2227e76ef5e2447022f1e3f9016f)** to **[`d2873c2`](https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9)**",
    "created_at": "2019-10-29T23:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447386",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f5b5d4f`](https://github.com/sagemath/sagetrac-mirror/commit/f5b5d4f6490d2227e76ef5e2447022f1e3f9016f)** to **[`d2873c2`](https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9)**



---

archive/issue_comments_447387.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jhpalmieri](#comment:5):\n> I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)\n\nunistall only happens if it was properly installed (with sdh_... script), with the corresponding uninstall info stored.\nIf not, it would be left there.\n\nIMHO \"rf -f blah\" ignores the result  - if blah was not there, there is still no error (although OSX might be different...)",
    "created_at": "2019-10-30T06:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447387",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jhpalmieri](#comment:5):
> I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)

unistall only happens if it was properly installed (with sdh_... script), with the corresponding uninstall info stored.
If not, it would be left there.

IMHO "rf -f blah" ignores the result  - if blah was not there, there is still no error (although OSX might be different...)



---

archive/issue_comments_447388.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2019-10-30T07:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447388",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_447389.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nlooks good to me. Please double-check that repeatedly running\n`./sage -f ipython` on MacOS works, then you can set it to positive review.",
    "created_at": "2019-10-30T07:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447389",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

looks good to me. Please double-check that repeatedly running
`./sage -f ipython` on MacOS works, then you can set it to positive review.



---

archive/issue_events_393840.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-30T17:02:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393840"
}
```



---

archive/issue_events_393841.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-10-30T17:02:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393841"
}
```



---

archive/issue_events_393842.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-31T22:40:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393842"
}
```



---

archive/issue_events_393843.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bb8c66fda2e1000c959c1a0ccc5332a286136ee6",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-10-31T22:40:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28673#event-393843"
}
```



---

archive/issue_comments_447390.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/ipython-no-symlink](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ipython-no-symlink)** to **[`d2873c2`](https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9)**",
    "created_at": "2019-10-31T22:40:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28673#issuecomment-447390",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/ipython-no-symlink](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ipython-no-symlink)** to **[`d2873c2`](https://github.com/sagemath/sagetrac-mirror/commit/d2873c2af9f2e36f7249bcf3d9a0d05e83601cb9)**
