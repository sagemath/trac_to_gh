# Issue 28925: Modify find_python_sources to support modularization of sagelib by native namespace packages (PEP 420)

archive/issues_028688.json:
```json
{
    "assignees": [],
    "body": "This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.\n\nOrdinary packages (directories of modules) can be turned into namespace packages by removing the empty `__init__.py` file.\nThen several distribution package can share the same namespace. \n\nBecause our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.\n\nPer convention in the Sage library, namespace packages are recognized by the presence of `all.py` or `all__*.py` files (#33033).\n\nIn this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, \nin which `__init__.py` are removed from the `MANIFEST.in` files.\n\nBecause the actual files are not removed from the source tree, the normal build of the Sage distribution is not affected.\n\nTo test these two distributions:\n\n```\n./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-objects && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'\n\n./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-categories && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'\n```\n\nFollow-up tickets:\n- #33011 Remove the `__init__.py` files for packages designated to be namespace packages\n- Wishlist item: Warn or give errors if the `sage_setup: distribution` directives, `namespace` and `nonamespace` files indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n- #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages\n\nSee also:\n- #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n- Initial discussion of namespace packages for Sage in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4\n- #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n\n\n\n\nDepends on #33803\n\nCC:  @isuruf @embray @jdemeyer @dimpase @dcoudert @videlec @vbraun @tobiasdiez @kiwifb\n\nKeywords: **sd111**\n\nBranch/Commit: **[`f9df1ae`](https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974)**\n\nReviewer: **Kwankyu Lee, Dima Pasechnik**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28925_\n\n",
    "closed_at": "2022-07-10T22:35:02Z",
    "created_at": "2019-12-30T01:31:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Modify find_python_sources to support modularization of sagelib by native namespace packages (PEP 420)",
    "type": "issue",
    "updated_at": "2022-07-10T22:35:02Z",
    "url": "https://github.com/sagemath/sage/issues/28925",
    "user": "https://github.com/mkoeppe"
}
```
This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.

Ordinary packages (directories of modules) can be turned into namespace packages by removing the empty `__init__.py` file.
Then several distribution package can share the same namespace. 

Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.

Per convention in the Sage library, namespace packages are recognized by the presence of `all.py` or `all__*.py` files (#33033).

In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, 
in which `__init__.py` are removed from the `MANIFEST.in` files.

Because the actual files are not removed from the source tree, the normal build of the Sage distribution is not affected.

To test these two distributions:

```
./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-objects && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'

./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-categories && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'
```

Follow-up tickets:
- #33011 Remove the `__init__.py` files for packages designated to be namespace packages
- Wishlist item: Warn or give errors if the `sage_setup: distribution` directives, `namespace` and `nonamespace` files indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
- #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages

See also:
- #29705: Meta-ticket: Modularize sagelib into separate distutils packages
- Initial discussion of namespace packages for Sage in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4
- #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory




Depends on #33803

CC:  @isuruf @embray @jdemeyer @dimpase @dcoudert @videlec @vbraun @tobiasdiez @kiwifb

Keywords: **sd111**

Branch/Commit: **[`f9df1ae`](https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974)**

Reviewer: **Kwankyu Lee, Dima Pasechnik**

Author: **Matthias Koeppe**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/28925_





---

archive/issue_events_394431.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-12-30T01:31:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394431"
}
```



---

archive/issue_events_394432.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-12-30T01:31:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394432"
}
```



---

archive/issue_events_394433.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-12-30T01:31:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394433"
}
```



---

archive/issue_events_394434.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-12-30T01:31:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394434"
}
```



---

archive/issue_comments_451531.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\npushing these forward to 9.2",
    "created_at": "2020-04-14T06:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451531",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

pushing these forward to 9.2



---

archive/issue_events_394435.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:38:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394435"
}
```



---

archive/issue_events_394436.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:38:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394436"
}
```



---

archive/issue_comments_451532.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,8 @@\n \n One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n \n+We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.\n+\n+See also:\n+- #29701 Meta-ticket: Replace use of OptionalExtension by namespace packages\n+\n``````\n",
    "created_at": "2020-05-17T21:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451532",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,8 @@
 
 One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
 
+We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.
+
+See also:
+- #29701 Meta-ticket: Replace use of OptionalExtension by namespace packages
+
``````




---

archive/issue_comments_451533.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,5 +5,5 @@\n We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.\n \n See also:\n-- #29701 Meta-ticket: Replace use of OptionalExtension by namespace packages\n+- #29701 Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n \n``````\n",
    "created_at": "2020-05-17T21:43:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451533",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,5 +5,5 @@
 We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.
 
 See also:
-- #29701 Meta-ticket: Replace use of OptionalExtension by namespace packages
+- #29701 Meta-ticket: Replace use of `OptionalExtension` by namespace packages
 
``````




---

archive/issue_comments_451534.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of namespace packages - See \u200bhttps://packaging.python.org/guides/packaging-namespace-packages/\n+As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See \u200bhttps://packaging.python.org/guides/packaging-namespace-packages/\n \n One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n \n``````\n",
    "created_at": "2020-05-17T21:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451534",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of namespace packages - See ​https://packaging.python.org/guides/packaging-namespace-packages/
+As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See ​https://packaging.python.org/guides/packaging-namespace-packages/
 
 One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
 
``````




---

archive/issue_events_394437.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-17T21:51:30Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "title_is": "Modify clean_stale_files to support modularization of sagelib by native namespace packages (PEP 420)",
    "title_was": "Modify clean_stale_files to support modularization of sagelib by namespace packages",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394437"
}
```



---

archive/issue_comments_451535.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,5 @@\n \n See also:\n - #29701 Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n+- #21654 `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n \n``````\n",
    "created_at": "2020-05-18T00:26:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451535",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,5 @@
 
 See also:
 - #29701 Meta-ticket: Replace use of `OptionalExtension` by namespace packages
+- #21654 `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
 
``````




---

archive/issue_events_394438.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-18T00:36:02Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "title_is": "Modify find_python_sources, clean_stale_files to support modularization of sagelib by native namespace packages (PEP 420)",
    "title_was": "Modify clean_stale_files to support modularization of sagelib by native namespace packages (PEP 420)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394438"
}
```



---

archive/issue_comments_451536.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,13 @@\n As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See \u200bhttps://packaging.python.org/guides/packaging-namespace-packages/\n \n-One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n+1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n+\n+2. We also need to adjust the mechanism for source discovery. Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...\n \n We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.\n \n See also:\n-- #29701 Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n-- #21654 `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n+- #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n+- #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n+- #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n \n``````\n",
    "created_at": "2020-05-18T00:36:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451536",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,13 @@
 As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See ​https://packaging.python.org/guides/packaging-namespace-packages/
 
-One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
+1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
+
+2. We also need to adjust the mechanism for source discovery. Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...
 
 We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.
 
 See also:
-- #29701 Meta-ticket: Replace use of `OptionalExtension` by namespace packages
-- #21654 `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
+- #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages
+- #29705: Meta-ticket: Modularize sagelib into separate distutils packages
+- #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
 
``````




---

archive/issue_comments_451537.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,20 @@\n \n 1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n \n-2. We also need to adjust the mechanism for source discovery. Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...\n+2. We also need to adjust the mechanism for source discovery. \n+\n+   Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. \n+\n+   a) We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), ...\n+\n+   b) or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...\n+\n+```\n+   # distutils_package: sage_tdlib\n+```\n+    (This would be parsed by `find_python_sources`.)\n+\n+3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.\n \n We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.\n \n``````\n",
    "created_at": "2020-05-18T21:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451537",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,20 @@
 
 1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
 
-2. We also need to adjust the mechanism for source discovery. Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...
+2. We also need to adjust the mechanism for source discovery. 
+
+   Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. 
+
+   a) We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), ...
+
+   b) or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...
+
+```
+   # distutils_package: sage_tdlib
+```
+    (This would be parsed by `find_python_sources`.)
+
+3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.
 
 We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.
 
``````




---

archive/issue_comments_451538.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n ```\n    # distutils_package: sage_tdlib\n ```\n-    (This would be parsed by `find_python_sources`.)\n+    (This would be parsed by `find_python_sources`, which would also warn or give errors if these comments indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.)\n \n 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.\n \n``````\n",
    "created_at": "2020-05-19T04:51:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451538",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 ```
    # distutils_package: sage_tdlib
 ```
-    (This would be parsed by `find_python_sources`.)
+    (This would be parsed by `find_python_sources`, which would also warn or give errors if these comments indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.)
 
 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.
 
``````




---

archive/issue_comments_451539.json:
```json
{
    "body": "Branch: **[u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_)**",
    "created_at": "2020-05-20T04:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451539",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_)**



---

archive/issue_comments_451540.json:
```json
{
    "body": "Commit: **[`8bc5662`](https://github.com/sagemath/sagetrac-mirror/commit/8bc56623abb2579ca435b99f324a9d5eef89c857)**",
    "created_at": "2020-05-20T04:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451540",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`8bc5662`](https://github.com/sagemath/sagetrac-mirror/commit/8bc56623abb2579ca435b99f324a9d5eef89c857)**



---

archive/issue_comments_451541.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e50bbedfa921c599fbdffd33138a510c93ced89\"><code>8e50bbe</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dff6e62730735a23e6c1a90183627142a7e39eaa\"><code>dff6e62</code></a></td><td><code>Mark src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bc56623abb2579ca435b99f324a9d5eef89c857\"><code>8bc5662</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages and 'nonamespace' files</code></td></tr></table>\n",
    "created_at": "2020-05-20T04:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451541",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e50bbedfa921c599fbdffd33138a510c93ced89"><code>8e50bbe</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dff6e62730735a23e6c1a90183627142a7e39eaa"><code>dff6e62</code></a></td><td><code>Mark src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bc56623abb2579ca435b99f324a9d5eef89c857"><code>8bc5662</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages and 'nonamespace' files</code></td></tr></table>




---

archive/issue_comments_451542.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-05-20T04:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451542",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_451543.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,9 +6,11 @@\n \n    Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. \n \n-   a) We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), ...\n+   a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.\n \n-   b) or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...\n+   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the ``nodoctest`` file).\n+\n+   c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:\n \n ```\n    # distutils_package: sage_tdlib\n@@ -17,7 +19,7 @@\n \n 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.\n \n-We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.\n+We test this on one example module: `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package.\n \n See also:\n - #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n``````\n",
    "created_at": "2020-05-20T04:55:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451543",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,9 +6,11 @@
 
    Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. 
 
-   a) We either need to list the namespace package explicitly in `setup.py` (`packages=python_packages + find_namespace_packages(include=['sage.x.y.z'])`), ...
+   a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.
 
-   b) or invent something Sage-specific... such as a comment on the top of a module file that indicates into which distutils package a given module belongs...
+   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the ``nodoctest`` file).
+
+   c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:
 
 ```
    # distutils_package: sage_tdlib
@@ -17,7 +19,7 @@
 
 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.
 
-We test this on one example module: `sage.graphs.graph_decompositions.tdlib`.
+We test this on one example module: `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package.
 
 See also:
 - #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages
``````




---

archive/issue_comments_451544.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,9 @@\n ```\n     (This would be parsed by `find_python_sources`, which would also warn or give errors if these comments indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.)\n \n-3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.\n+3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. \n+\n+   TBD: Create a function similar to `find_python_sources` for this as well.\n \n We test this on one example module: `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package.\n \n``````\n",
    "created_at": "2020-05-20T04:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451544",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,9 @@
 ```
     (This would be parsed by `find_python_sources`, which would also warn or give errors if these comments indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.)
 
-3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. We should probably create a function similar to `find_python_sources` for this as well.
+3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. 
+
+   TBD: Create a function similar to `find_python_sources` for this as well.
 
 We test this on one example module: `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package.
 
``````




---

archive/issue_comments_451545.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \n    a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.\n \n-   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the ``nodoctest`` file).\n+   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the `nodoctest` file).\n \n    c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:\n \n``````\n",
    "created_at": "2020-05-20T04:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451545",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 
    a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.
 
-   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the ``nodoctest`` file).
+   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the `nodoctest` file).
 
    c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:
 
``````




---

archive/issue_comments_451546.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \n    a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.\n \n-   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the `nodoctest` file).\n+   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).\n \n    c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:\n \n``````\n",
    "created_at": "2020-05-20T04:58:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451546",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 
    a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.
 
-   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file ``nonamespace`` (I just made this up, in analogy to the `nodoctest` file).
+   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).
 
    c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:
 
``````




---

archive/issue_comments_451547.json:
```json
{
    "body": "Changed commit from **[`8bc5662`](https://github.com/sagemath/sagetrac-mirror/commit/8bc56623abb2579ca435b99f324a9d5eef89c857)** to **[`606a509`](https://github.com/sagemath/sagetrac-mirror/commit/606a509168111b4cf7306fa283e1d5f0cccd41d0)**",
    "created_at": "2020-05-20T05:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451547",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8bc5662`](https://github.com/sagemath/sagetrac-mirror/commit/8bc56623abb2579ca435b99f324a9d5eef89c857)** to **[`606a509`](https://github.com/sagemath/sagetrac-mirror/commit/606a509168111b4cf7306fa283e1d5f0cccd41d0)**



---

archive/issue_comments_451548.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/606a509168111b4cf7306fa283e1d5f0cccd41d0\"><code>606a509</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr></table>\n",
    "created_at": "2020-05-20T05:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451548",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/606a509168111b4cf7306fa283e1d5f0cccd41d0"><code>606a509</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr></table>




---

archive/issue_comments_451549.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,7 +21,11 @@\n \n    TBD: Create a function similar to `find_python_sources` for this as well.\n \n-We test this on one example module: `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package.\n+We test this new mechanism on two example modules: \n+\n+- `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package. The module is maintained in the sage source tree.\n+\n+- `sage.numerical.backends.coin_backend`. The package `sage.numerical.backends` is turned into a namespace package. It serves as an example of a module in a namespace package that is maintained outside of the sage source tree (here: https://github.com/mkoeppe/sage-numerical-backends-namespace)\n \n See also:\n - #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n``````\n",
    "created_at": "2020-05-20T05:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451549",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,7 +21,11 @@
 
    TBD: Create a function similar to `find_python_sources` for this as well.
 
-We test this on one example module: `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package.
+We test this new mechanism on two example modules: 
+
+- `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package. The module is maintained in the sage source tree.
+
+- `sage.numerical.backends.coin_backend`. The package `sage.numerical.backends` is turned into a namespace package. It serves as an example of a module in a namespace package that is maintained outside of the sage source tree (here: https://github.com/mkoeppe/sage-numerical-backends-namespace)
 
 See also:
 - #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages
``````




---

archive/issue_comments_451550.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nNext steps: adjust the cleaner, find Cython sources",
    "created_at": "2020-05-20T05:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451550",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Next steps: adjust the cleaner, find Cython sources



---

archive/issue_comments_451551.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe Cython source finder could perhaps also parse a new directive that controls `OptionalExtension` behavior (until we get rid of `OptionalExtension` altogether in #29701) so that we can get rid of `module_list.py` completely (see #29706)",
    "created_at": "2020-05-20T05:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451551",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

The Cython source finder could perhaps also parse a new directive that controls `OptionalExtension` behavior (until we get rid of `OptionalExtension` altogether in #29701) so that we can get rid of `module_list.py` completely (see #29706)



---

archive/issue_comments_451552.json:
```json
{
    "body": "Changed commit from **[`606a509`](https://github.com/sagemath/sagetrac-mirror/commit/606a509168111b4cf7306fa283e1d5f0cccd41d0)** to **[`a7b2287`](https://github.com/sagemath/sagetrac-mirror/commit/a7b2287a8b69e814781b20434849e788d00884ca)**",
    "created_at": "2020-05-20T22:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451552",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`606a509`](https://github.com/sagemath/sagetrac-mirror/commit/606a509168111b4cf7306fa283e1d5f0cccd41d0)** to **[`a7b2287`](https://github.com/sagemath/sagetrac-mirror/commit/a7b2287a8b69e814781b20434849e788d00884ca)**



---

archive/issue_comments_451553.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7b2287a8b69e814781b20434849e788d00884ca\"><code>a7b2287</code></a></td><td><code>find_python_sources: New optional argunment sage_packages, filter by # distutils: sage_package = PACKAGE</code></td></tr></table>\n",
    "created_at": "2020-05-20T22:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451553",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7b2287a8b69e814781b20434849e788d00884ca"><code>a7b2287</code></a></td><td><code>find_python_sources: New optional argunment sage_packages, filter by # distutils: sage_package = PACKAGE</code></td></tr></table>




---

archive/issue_comments_451554.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,16 +10,18 @@\n \n    b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).\n \n-   c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:\n+   c) Mark Python modules as belonging to a specific distutils package, using a distutils directive on the top of a module file:\n \n ```\n-   # distutils_package: sage_tdlib\n+   # distutils: sage_package: sage_tdlib\n ```\n-    (This would be parsed by `find_python_sources`, which would also warn or give errors if these comments indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.)\n+    `find_python_sources` parses these directives by using existing Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).\n+\n+   TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n \n 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. \n \n-   TBD: Create a function similar to `find_python_sources` for this as well.\n+   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_package` directive.\n \n We test this new mechanism on two example modules: \n \n``````\n",
    "created_at": "2020-05-20T22:42:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451554",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,16 +10,18 @@
 
    b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).
 
-   c) TBD: Mark Python modules as belonging to a specific distutils package, using a comment on the top of a module file:
+   c) Mark Python modules as belonging to a specific distutils package, using a distutils directive on the top of a module file:
 
 ```
-   # distutils_package: sage_tdlib
+   # distutils: sage_package: sage_tdlib
 ```
-    (This would be parsed by `find_python_sources`, which would also warn or give errors if these comments indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.)
+    `find_python_sources` parses these directives by using existing Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).
+
+   TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
 
 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. 
 
-   TBD: Create a function similar to `find_python_sources` for this as well.
+   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_package` directive.
 
 We test this new mechanism on two example modules: 
 
``````




---

archive/issue_comments_451555.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/194d3b430666c3bb72885a945274589ea54bd4be\"><code>194d3b4</code></a></td><td><code>sage_setup.find.find_python_sources: Also find Cython modules</code></td></tr></table>\n",
    "created_at": "2020-05-21T04:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451555",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/194d3b430666c3bb72885a945274589ea54bd4be"><code>194d3b4</code></a></td><td><code>sage_setup.find.find_python_sources: Also find Cython modules</code></td></tr></table>




---

archive/issue_comments_451556.json:
```json
{
    "body": "Changed commit from **[`a7b2287`](https://github.com/sagemath/sagetrac-mirror/commit/a7b2287a8b69e814781b20434849e788d00884ca)** to **[`194d3b4`](https://github.com/sagemath/sagetrac-mirror/commit/194d3b430666c3bb72885a945274589ea54bd4be)**",
    "created_at": "2020-05-21T04:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451556",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a7b2287`](https://github.com/sagemath/sagetrac-mirror/commit/a7b2287a8b69e814781b20434849e788d00884ca)** to **[`194d3b4`](https://github.com/sagemath/sagetrac-mirror/commit/194d3b430666c3bb72885a945274589ea54bd4be)**



---

archive/issue_comments_451557.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adc39e3248884eed30d3fe489fb8707036d34121\"><code>adc39e3</code></a></td><td><code>WIP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad3ebad7af2f4f1eea0f4a771dc029382ce60d96\"><code>ad3ebad</code></a></td><td><code>Merge tag '9.2.beta0' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2020-06-02T00:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451557",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adc39e3248884eed30d3fe489fb8707036d34121"><code>adc39e3</code></a></td><td><code>WIP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad3ebad7af2f4f1eea0f4a771dc029382ce60d96"><code>ad3ebad</code></a></td><td><code>Merge tag '9.2.beta0' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451558.json:
```json
{
    "body": "Changed commit from **[`194d3b4`](https://github.com/sagemath/sagetrac-mirror/commit/194d3b430666c3bb72885a945274589ea54bd4be)** to **[`ad3ebad`](https://github.com/sagemath/sagetrac-mirror/commit/ad3ebad7af2f4f1eea0f4a771dc029382ce60d96)**",
    "created_at": "2020-06-02T00:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451558",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`194d3b4`](https://github.com/sagemath/sagetrac-mirror/commit/194d3b430666c3bb72885a945274589ea54bd4be)** to **[`ad3ebad`](https://github.com/sagemath/sagetrac-mirror/commit/ad3ebad7af2f4f1eea0f4a771dc029382ce60d96)**



---

archive/issue_comments_451559.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,12 +10,12 @@\n \n    b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).\n \n-   c) Mark Python modules as belonging to a specific distutils package, using a distutils directive on the top of a module file:\n+   c) Mark Python modules as belonging to a specific distutils package, using a directive on the top of a module file:\n \n ```\n-   # distutils: sage_package: sage_tdlib\n+   # sage_setup: distribution = sage_tdlib\n ```\n-    `find_python_sources` parses these directives by using existing Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).\n+    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).\n \n    TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n \n``````\n",
    "created_at": "2020-06-02T00:36:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451559",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,12 +10,12 @@
 
    b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).
 
-   c) Mark Python modules as belonging to a specific distutils package, using a distutils directive on the top of a module file:
+   c) Mark Python modules as belonging to a specific distutils package, using a directive on the top of a module file:
 
 ```
-   # distutils: sage_package: sage_tdlib
+   # sage_setup: distribution = sage_tdlib
 ```
-    `find_python_sources` parses these directives by using existing Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).
+    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).
 
    TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
 
``````




---

archive/issue_comments_451560.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/004dd5240961beb9e2c4fab328d77688df57a862\"><code>004dd52</code></a></td><td><code>Merge tag '9.2.beta0' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2020-06-02T00:45:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451560",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/004dd5240961beb9e2c4fab328d77688df57a862"><code>004dd52</code></a></td><td><code>Merge tag '9.2.beta0' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451561.json:
```json
{
    "body": "Changed commit from **[`ad3ebad`](https://github.com/sagemath/sagetrac-mirror/commit/ad3ebad7af2f4f1eea0f4a771dc029382ce60d96)** to **[`004dd52`](https://github.com/sagemath/sagetrac-mirror/commit/004dd5240961beb9e2c4fab328d77688df57a862)**",
    "created_at": "2020-06-02T00:45:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451561",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ad3ebad`](https://github.com/sagemath/sagetrac-mirror/commit/ad3ebad7af2f4f1eea0f4a771dc029382ce60d96)** to **[`004dd52`](https://github.com/sagemath/sagetrac-mirror/commit/004dd5240961beb9e2c4fab328d77688df57a862)**



---

archive/issue_comments_451562.json:
```json
{
    "body": "Changed commit from **[`004dd52`](https://github.com/sagemath/sagetrac-mirror/commit/004dd5240961beb9e2c4fab328d77688df57a862)** to **[`3a68b37`](https://github.com/sagemath/sagetrac-mirror/commit/3a68b37aba6be39b55a404874f2f66dc1ed4b0eb)**",
    "created_at": "2020-06-02T02:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451562",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`004dd52`](https://github.com/sagemath/sagetrac-mirror/commit/004dd5240961beb9e2c4fab328d77688df57a862)** to **[`3a68b37`](https://github.com/sagemath/sagetrac-mirror/commit/3a68b37aba6be39b55a404874f2f66dc1ed4b0eb)**



---

archive/issue_comments_451563.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a68b37aba6be39b55a404874f2f66dc1ed4b0eb\"><code>3a68b37</code></a></td><td><code>src/sage_setup/find.py: Switch to parsing directive 'sage_setup: distribution = PKG'</code></td></tr></table>\n",
    "created_at": "2020-06-02T02:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451563",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a68b37aba6be39b55a404874f2f66dc1ed4b0eb"><code>3a68b37</code></a></td><td><code>src/sage_setup/find.py: Switch to parsing directive 'sage_setup: distribution = PKG'</code></td></tr></table>




---

archive/issue_comments_451564.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d900139267b5aeceaa399ee6ffa190e4fd821748\"><code>d900139</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr></table>\n",
    "created_at": "2020-06-02T02:01:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451564",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d900139267b5aeceaa399ee6ffa190e4fd821748"><code>d900139</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr></table>




---

archive/issue_comments_451565.json:
```json
{
    "body": "Changed commit from **[`3a68b37`](https://github.com/sagemath/sagetrac-mirror/commit/3a68b37aba6be39b55a404874f2f66dc1ed4b0eb)** to **[`d900139`](https://github.com/sagemath/sagetrac-mirror/commit/d900139267b5aeceaa399ee6ffa190e4fd821748)**",
    "created_at": "2020-06-02T02:01:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451565",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3a68b37`](https://github.com/sagemath/sagetrac-mirror/commit/3a68b37aba6be39b55a404874f2f66dc1ed4b0eb)** to **[`d900139`](https://github.com/sagemath/sagetrac-mirror/commit/d900139267b5aeceaa399ee6ffa190e4fd821748)**



---

archive/issue_comments_451566.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,9 +13,9 @@\n    c) Mark Python modules as belonging to a specific distutils package, using a directive on the top of a module file:\n \n ```\n-   # sage_setup: distribution = sage_tdlib\n+   # sage_setup: distribution = sage-tdlib\n ```\n-    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).\n+    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers.\n \n    TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n \n``````\n",
    "created_at": "2020-06-02T02:06:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451566",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,9 +13,9 @@
    c) Mark Python modules as belonging to a specific distutils package, using a directive on the top of a module file:
 
 ```
-   # sage_setup: distribution = sage_tdlib
+   # sage_setup: distribution = sage-tdlib
 ```
-    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).
+    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers.
 
    TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
 
``````




---

archive/issue_comments_451567.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d71e74ac3a6ed2808e927664c593d70f11d9869\"><code>6d71e74</code></a></td><td><code>Add doctest</code></td></tr></table>\n",
    "created_at": "2020-06-02T02:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451567",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d71e74ac3a6ed2808e927664c593d70f11d9869"><code>6d71e74</code></a></td><td><code>Add doctest</code></td></tr></table>




---

archive/issue_comments_451568.json:
```json
{
    "body": "Changed commit from **[`d900139`](https://github.com/sagemath/sagetrac-mirror/commit/d900139267b5aeceaa399ee6ffa190e4fd821748)** to **[`6d71e74`](https://github.com/sagemath/sagetrac-mirror/commit/6d71e74ac3a6ed2808e927664c593d70f11d9869)**",
    "created_at": "2020-06-02T02:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451568",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d900139`](https://github.com/sagemath/sagetrac-mirror/commit/d900139267b5aeceaa399ee6ffa190e4fd821748)** to **[`6d71e74`](https://github.com/sagemath/sagetrac-mirror/commit/6d71e74ac3a6ed2808e927664c593d70f11d9869)**



---

archive/issue_comments_451569.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,7 +21,7 @@\n \n 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. \n \n-   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_package` directive.\n+   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_setup` directive.\n \n We test this new mechanism on two example modules: \n \n``````\n",
    "created_at": "2020-06-02T06:11:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451569",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,7 +21,7 @@
 
 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. 
 
-   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_package` directive.
+   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_setup` directive.
 
 We test this new mechanism on two example modules: 
 
``````




---

archive/issue_comments_451570.json:
```json
{
    "body": "Changed commit from **[`6d71e74`](https://github.com/sagemath/sagetrac-mirror/commit/6d71e74ac3a6ed2808e927664c593d70f11d9869)** to **[`f670f81`](https://github.com/sagemath/sagetrac-mirror/commit/f670f81d1db80ab3334292b7646bc4fd034b32b0)**",
    "created_at": "2020-06-02T07:07:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451570",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6d71e74`](https://github.com/sagemath/sagetrac-mirror/commit/6d71e74ac3a6ed2808e927664c593d70f11d9869)** to **[`f670f81`](https://github.com/sagemath/sagetrac-mirror/commit/f670f81d1db80ab3334292b7646bc4fd034b32b0)**



---

archive/issue_comments_451571.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a7fb4830e378aae3cbae527c410e0c368392565\"><code>0a7fb48</code></a></td><td><code>Move src/fpickle_setup.py to srs/sage_setup/</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4a9269040ed57b1456b41f5b69127feb4212b8d\"><code>f4a9269</code></a></td><td><code>src/setup.py: Move class sage_install to new module sage_setup.command.sage_install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5660d8f044f5564525357368138a8b4530fb12d3\"><code>5660d8f</code></a></td><td><code>src/module_list.py: Move library_order to new module sage_setup.library_order</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43d4f839cfd605dad863de3a34e4af7a3bf371c1\"><code>43d4f83</code></a></td><td><code>src/setup.py: Move classes sage_build_* to new modules sage_setup.command.sage_*</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09e32972afcdf667af8404878fc84d4122ebfbbc\"><code>09e3297</code></a></td><td><code>src/setup.py: Move excepthook to new module sage_setup.excepthook</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cfed7c676bd72db6100d81df7f397cd8d2442f3\"><code>1cfed7c</code></a></td><td><code>build/pkgs/sagelib/spkg-install: Do not poison SAGE_LOCAL, used in script installed by spkg pkgconf</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62c7531d7fb0c8718f3c664927cbf3291264d303\"><code>62c7531</code></a></td><td><code>Merge branch 't/29411/make_sagelib_a_script_package' into t/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3102e903a97eedab297c8c41d8de137b6a64211\"><code>b3102e9</code></a></td><td><code>Merge tag '9.2.beta0' into t/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5066f83b99be4d6e9f497fc6dc806b2abb65de89\"><code>5066f83</code></a></td><td><code>Merge branch 't/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f670f81d1db80ab3334292b7646bc4fd034b32b0\"><code>f670f81</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-06-02T07:07:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451571",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a7fb4830e378aae3cbae527c410e0c368392565"><code>0a7fb48</code></a></td><td><code>Move src/fpickle_setup.py to srs/sage_setup/</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4a9269040ed57b1456b41f5b69127feb4212b8d"><code>f4a9269</code></a></td><td><code>src/setup.py: Move class sage_install to new module sage_setup.command.sage_install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5660d8f044f5564525357368138a8b4530fb12d3"><code>5660d8f</code></a></td><td><code>src/module_list.py: Move library_order to new module sage_setup.library_order</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43d4f839cfd605dad863de3a34e4af7a3bf371c1"><code>43d4f83</code></a></td><td><code>src/setup.py: Move classes sage_build_* to new modules sage_setup.command.sage_*</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09e32972afcdf667af8404878fc84d4122ebfbbc"><code>09e3297</code></a></td><td><code>src/setup.py: Move excepthook to new module sage_setup.excepthook</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cfed7c676bd72db6100d81df7f397cd8d2442f3"><code>1cfed7c</code></a></td><td><code>build/pkgs/sagelib/spkg-install: Do not poison SAGE_LOCAL, used in script installed by spkg pkgconf</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62c7531d7fb0c8718f3c664927cbf3291264d303"><code>62c7531</code></a></td><td><code>Merge branch 't/29411/make_sagelib_a_script_package' into t/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3102e903a97eedab297c8c41d8de137b6a64211"><code>b3102e9</code></a></td><td><code>Merge tag '9.2.beta0' into t/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5066f83b99be4d6e9f497fc6dc806b2abb65de89"><code>5066f83</code></a></td><td><code>Merge branch 't/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f670f81d1db80ab3334292b7646bc4fd034b32b0"><code>f670f81</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_451572.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nNext: Fix `find_extra_files` so that it finds the `.pxd` files in `sage.numerical.backends`",
    "created_at": "2020-06-02T07:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451572",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Next: Fix `find_extra_files` so that it finds the `.pxd` files in `sage.numerical.backends`



---

archive/issue_comments_451573.json:
```json
{
    "body": "Dependencies: **#29702**",
    "created_at": "2020-06-02T07:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451573",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29702**



---

archive/issue_comments_451574.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd858270985630f780a0d367c2b4b1581c755404\"><code>bd85827</code></a></td><td><code>is_package_or_namespace_package_dir: New, monkeypatch into Cython.Build.Dependencies</code></td></tr></table>\n",
    "created_at": "2020-06-03T01:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451574",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd858270985630f780a0d367c2b4b1581c755404"><code>bd85827</code></a></td><td><code>is_package_or_namespace_package_dir: New, monkeypatch into Cython.Build.Dependencies</code></td></tr></table>




---

archive/issue_comments_451575.json:
```json
{
    "body": "Changed commit from **[`f670f81`](https://github.com/sagemath/sagetrac-mirror/commit/f670f81d1db80ab3334292b7646bc4fd034b32b0)** to **[`bd85827`](https://github.com/sagemath/sagetrac-mirror/commit/bd858270985630f780a0d367c2b4b1581c755404)**",
    "created_at": "2020-06-03T01:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451575",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f670f81`](https://github.com/sagemath/sagetrac-mirror/commit/f670f81d1db80ab3334292b7646bc4fd034b32b0)** to **[`bd85827`](https://github.com/sagemath/sagetrac-mirror/commit/bd858270985630f780a0d367c2b4b1581c755404)**



---

archive/issue_comments_451576.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/532bb21b12f289e579c2dc033dbc41dab47c4330\"><code>532bb21</code></a></td><td><code>is_package_or_namespace_package_dir: Make self-contained, patch into more of Cython</code></td></tr></table>\n",
    "created_at": "2020-06-03T02:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451576",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/532bb21b12f289e579c2dc033dbc41dab47c4330"><code>532bb21</code></a></td><td><code>is_package_or_namespace_package_dir: Make self-contained, patch into more of Cython</code></td></tr></table>




---

archive/issue_comments_451577.json:
```json
{
    "body": "Changed commit from **[`bd85827`](https://github.com/sagemath/sagetrac-mirror/commit/bd858270985630f780a0d367c2b4b1581c755404)** to **[`532bb21`](https://github.com/sagemath/sagetrac-mirror/commit/532bb21b12f289e579c2dc033dbc41dab47c4330)**",
    "created_at": "2020-06-03T02:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451577",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bd85827`](https://github.com/sagemath/sagetrac-mirror/commit/bd858270985630f780a0d367c2b4b1581c755404)** to **[`532bb21`](https://github.com/sagemath/sagetrac-mirror/commit/532bb21b12f289e579c2dc033dbc41dab47c4330)**



---

archive/issue_comments_451578.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b4202996338185c1078a82b5ab728c32ea6cb69\"><code>2b42029</code></a></td><td><code>src/sage_setup/command/__init__.py: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a830304883bce352fe65f1f8fe584ef0b6d64f74\"><code>a830304</code></a></td><td><code>src/sage_setup/command/sage_build_cython.py: Fix adding setup.py as dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3080a5ceefc9d952a35f94df618a8a29efe36b1\"><code>d3080a5</code></a></td><td><code>Merge branch 't/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0aa36935e2656eeb0b8139f98d7352afed8221cb\"><code>0aa3693</code></a></td><td><code>Mark src as nonamespace</code></td></tr></table>\n",
    "created_at": "2020-06-03T02:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451578",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b4202996338185c1078a82b5ab728c32ea6cb69"><code>2b42029</code></a></td><td><code>src/sage_setup/command/__init__.py: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a830304883bce352fe65f1f8fe584ef0b6d64f74"><code>a830304</code></a></td><td><code>src/sage_setup/command/sage_build_cython.py: Fix adding setup.py as dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3080a5ceefc9d952a35f94df618a8a29efe36b1"><code>d3080a5</code></a></td><td><code>Merge branch 't/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0aa36935e2656eeb0b8139f98d7352afed8221cb"><code>0aa3693</code></a></td><td><code>Mark src as nonamespace</code></td></tr></table>




---

archive/issue_comments_451579.json:
```json
{
    "body": "Changed commit from **[`532bb21`](https://github.com/sagemath/sagetrac-mirror/commit/532bb21b12f289e579c2dc033dbc41dab47c4330)** to **[`0aa3693`](https://github.com/sagemath/sagetrac-mirror/commit/0aa36935e2656eeb0b8139f98d7352afed8221cb)**",
    "created_at": "2020-06-03T02:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451579",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`532bb21`](https://github.com/sagemath/sagetrac-mirror/commit/532bb21b12f289e579c2dc033dbc41dab47c4330)** to **[`0aa3693`](https://github.com/sagemath/sagetrac-mirror/commit/0aa36935e2656eeb0b8139f98d7352afed8221cb)**



---

archive/issue_comments_451580.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47cb57898d62e3d71ad18a4b27ea0a99ee3a982e\"><code>47cb578</code></a></td><td><code>is_package_or_namespace_package_dir: Recognize namespace packages by file 'namespace'</code></td></tr></table>\n",
    "created_at": "2020-06-03T03:07:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451580",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47cb57898d62e3d71ad18a4b27ea0a99ee3a982e"><code>47cb578</code></a></td><td><code>is_package_or_namespace_package_dir: Recognize namespace packages by file 'namespace'</code></td></tr></table>




---

archive/issue_comments_451581.json:
```json
{
    "body": "Changed commit from **[`0aa3693`](https://github.com/sagemath/sagetrac-mirror/commit/0aa36935e2656eeb0b8139f98d7352afed8221cb)** to **[`47cb578`](https://github.com/sagemath/sagetrac-mirror/commit/47cb57898d62e3d71ad18a4b27ea0a99ee3a982e)**",
    "created_at": "2020-06-03T03:07:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451581",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0aa3693`](https://github.com/sagemath/sagetrac-mirror/commit/0aa36935e2656eeb0b8139f98d7352afed8221cb)** to **[`47cb578`](https://github.com/sagemath/sagetrac-mirror/commit/47cb57898d62e3d71ad18a4b27ea0a99ee3a982e)**



---

archive/issue_comments_451582.json:
```json
{
    "body": "Changed commit from **[`47cb578`](https://github.com/sagemath/sagetrac-mirror/commit/47cb57898d62e3d71ad18a4b27ea0a99ee3a982e)** to **[`4c51133`](https://github.com/sagemath/sagetrac-mirror/commit/4c51133f6e3458abf3f9303d49303e49b1b1cbb8)**",
    "created_at": "2020-06-03T03:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451582",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`47cb578`](https://github.com/sagemath/sagetrac-mirror/commit/47cb57898d62e3d71ad18a4b27ea0a99ee3a982e)** to **[`4c51133`](https://github.com/sagemath/sagetrac-mirror/commit/4c51133f6e3458abf3f9303d49303e49b1b1cbb8)**



---

archive/issue_comments_451583.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/381a5079da7ea334410ae78e3dd6b386e93aa092\"><code>381a507</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c51133f6e3458abf3f9303d49303e49b1b1cbb8\"><code>4c51133</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr></table>\n",
    "created_at": "2020-06-03T03:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451583",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/381a5079da7ea334410ae78e3dd6b386e93aa092"><code>381a507</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c51133f6e3458abf3f9303d49303e49b1b1cbb8"><code>4c51133</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr></table>




---

archive/issue_comments_451584.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0a2ed74a42cf8b575fa2cf26228e513bd69dfbd\"><code>c0a2ed7</code></a></td><td><code>src/module_list.py: Remove explicit listing of sage.graphs.graph_decompositions extensions</code></td></tr></table>\n",
    "created_at": "2020-06-03T03:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451584",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0a2ed74a42cf8b575fa2cf26228e513bd69dfbd"><code>c0a2ed7</code></a></td><td><code>src/module_list.py: Remove explicit listing of sage.graphs.graph_decompositions extensions</code></td></tr></table>




---

archive/issue_comments_451585.json:
```json
{
    "body": "Changed commit from **[`4c51133`](https://github.com/sagemath/sagetrac-mirror/commit/4c51133f6e3458abf3f9303d49303e49b1b1cbb8)** to **[`c0a2ed7`](https://github.com/sagemath/sagetrac-mirror/commit/c0a2ed74a42cf8b575fa2cf26228e513bd69dfbd)**",
    "created_at": "2020-06-03T03:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451585",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4c51133`](https://github.com/sagemath/sagetrac-mirror/commit/4c51133f6e3458abf3f9303d49303e49b1b1cbb8)** to **[`c0a2ed7`](https://github.com/sagemath/sagetrac-mirror/commit/c0a2ed74a42cf8b575fa2cf26228e513bd69dfbd)**



---

archive/issue_comments_451586.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -34,3 +34,8 @@\n - #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n \n+\n+The branch on this meta-ticket is not intended for merging.\n+It is an integration branch to facilitate testing. See https://github.com/mkoeppe/sage/pull/35 for automated tests\n+\n+\n``````\n",
    "created_at": "2020-06-03T20:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451586",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -34,3 +34,8 @@
 - #29705: Meta-ticket: Modularize sagelib into separate distutils packages
 - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
 
+
+The branch on this meta-ticket is not intended for merging.
+It is an integration branch to facilitate testing. See https://github.com/mkoeppe/sage/pull/35 for automated tests
+
+
``````




---

archive/issue_comments_451587.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,7 +21,7 @@\n \n 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. \n \n-   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_setup` directive.\n+   We extend `find_python_sources` so that it returns Cython modules as an additional result.  In a follow-up ticket, we then remove the use of `module_list.py`.\n \n We test this new mechanism on two example modules: \n \n@@ -35,7 +35,4 @@\n - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n \n \n-The branch on this meta-ticket is not intended for merging.\n-It is an integration branch to facilitate testing. See https://github.com/mkoeppe/sage/pull/35 for automated tests\n \n-\n``````\n",
    "created_at": "2020-06-03T21:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451587",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,7 +21,7 @@
 
 3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. 
 
-   TBD: Extend `find_python_sources` so that it returns Cython modules as an additional result, handling `OptionalExtensions` logic via the new `sage_setup` directive.
+   We extend `find_python_sources` so that it returns Cython modules as an additional result.  In a follow-up ticket, we then remove the use of `module_list.py`.
 
 We test this new mechanism on two example modules: 
 
@@ -35,7 +35,4 @@
 - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
 
 
-The branch on this meta-ticket is not intended for merging.
-It is an integration branch to facilitate testing. See https://github.com/mkoeppe/sage/pull/35 for automated tests
 
-
``````




---

archive/issue_comments_451588.json:
```json
{
    "body": "Work Issues: **rebase on top of #29701**",
    "created_at": "2020-06-03T22:57:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451588",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **rebase on top of #29701**



---

archive/issue_events_394439.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-03T22:58:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394439"
}
```



---

archive/issue_events_394440.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-03T22:58:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394440"
}
```



---

archive/issue_comments_451589.json:
```json
{
    "body": "Changed dependencies from **#29702** to **#29702, #29701**",
    "created_at": "2020-06-03T22:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451589",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29702** to **#29702, #29701**



---

archive/issue_comments_451590.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,18 +10,18 @@\n \n    b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).\n \n-   c) Mark Python modules as belonging to a specific distutils package, using a directive on the top of a module file:\n+   c) #29701 already introduced a directive on the top of Cython extension source files:\n \n ```\n    # sage_setup: distribution = sage-tdlib\n ```\n-    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers.\n+    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers. \n+\n+   In this ticket, we extend this to Python modules - to mark them as belonging to a specific distutils package.\n \n    TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n \n-3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. \n-\n-   We extend `find_python_sources` so that it returns Cython modules as an additional result.  In a follow-up ticket, we then remove the use of `module_list.py`.\n+3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.\n \n We test this new mechanism on two example modules: \n \n@@ -30,7 +30,6 @@\n - `sage.numerical.backends.coin_backend`. The package `sage.numerical.backends` is turned into a namespace package. It serves as an example of a module in a namespace package that is maintained outside of the sage source tree (here: https://github.com/mkoeppe/sage-numerical-backends-namespace)\n \n See also:\n-- #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages\n - #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n \n``````\n",
    "created_at": "2020-06-07T19:15:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451590",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,18 +10,18 @@
 
    b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).
 
-   c) Mark Python modules as belonging to a specific distutils package, using a directive on the top of a module file:
+   c) #29701 already introduced a directive on the top of Cython extension source files:
 
 ```
    # sage_setup: distribution = sage-tdlib
 ```
-    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers.
+    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers. 
+
+   In this ticket, we extend this to Python modules - to mark them as belonging to a specific distutils package.
 
    TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
 
-3. For Cython extensions, currently we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. 
-
-   We extend `find_python_sources` so that it returns Cython modules as an additional result.  In a follow-up ticket, we then remove the use of `module_list.py`.
+3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.
 
 We test this new mechanism on two example modules: 
 
@@ -30,7 +30,6 @@
 - `sage.numerical.backends.coin_backend`. The package `sage.numerical.backends` is turned into a namespace package. It serves as an example of a module in a namespace package that is maintained outside of the sage source tree (here: https://github.com/mkoeppe/sage-numerical-backends-namespace)
 
 See also:
-- #29701: Meta-ticket: Replace use of `OptionalExtension` by namespace packages
 - #29705: Meta-ticket: Modularize sagelib into separate distutils packages
 - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
 
``````




---

archive/issue_comments_451591.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a43bf0763b5425ec7f7c575f56e309645c69f93d\"><code>a43bf07</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a6d12fc60d15560ad55881fce36611f2b0ca29b\"><code>7a6d12f</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files, Cython modules, directive 'sage_setup: distribution = PKG'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4a6c7da2115a980e73cd6fcdce20df350689081\"><code>f4a6c7d</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cee98e717edf03ae95d8c62463f6ee6e629d1ab8\"><code>cee98e7</code></a></td><td><code>Add doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7873513999b415e2f60973352301a50b64e64346\"><code>7873513</code></a></td><td><code>is_package_or_namespace_package_dir: New, monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d01495e299a4ae387baea6f897315969c5f703e8\"><code>d01495e</code></a></td><td><code>Mark src as nonamespace</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/899dc329f2e22482cdae8b72c3587c1afecb3bfa\"><code>899dc32</code></a></td><td><code>is_package_or_namespace_package_dir: Recognize namespace packages by file 'namespace'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b97b1e0ae8bec27c1062b7ae63924e370468c529\"><code>b97b1e0</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b8181b59ba855df9ce3dee6021ee04548caab56\"><code>4b8181b</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40bc47392ab35b9a7e4059bb46a455828d5d7673\"><code>40bc473</code></a></td><td><code>src/module_list.py: Remove explicit listing of sage.graphs.graph_decompositions extensions</code></td></tr></table>\n",
    "created_at": "2020-06-10T02:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451591",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a43bf0763b5425ec7f7c575f56e309645c69f93d"><code>a43bf07</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a6d12fc60d15560ad55881fce36611f2b0ca29b"><code>7a6d12f</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files, Cython modules, directive 'sage_setup: distribution = PKG'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4a6c7da2115a980e73cd6fcdce20df350689081"><code>f4a6c7d</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cee98e717edf03ae95d8c62463f6ee6e629d1ab8"><code>cee98e7</code></a></td><td><code>Add doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7873513999b415e2f60973352301a50b64e64346"><code>7873513</code></a></td><td><code>is_package_or_namespace_package_dir: New, monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d01495e299a4ae387baea6f897315969c5f703e8"><code>d01495e</code></a></td><td><code>Mark src as nonamespace</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/899dc329f2e22482cdae8b72c3587c1afecb3bfa"><code>899dc32</code></a></td><td><code>is_package_or_namespace_package_dir: Recognize namespace packages by file 'namespace'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b97b1e0ae8bec27c1062b7ae63924e370468c529"><code>b97b1e0</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b8181b59ba855df9ce3dee6021ee04548caab56"><code>4b8181b</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40bc47392ab35b9a7e4059bb46a455828d5d7673"><code>40bc473</code></a></td><td><code>src/module_list.py: Remove explicit listing of sage.graphs.graph_decompositions extensions</code></td></tr></table>




---

archive/issue_comments_451592.json:
```json
{
    "body": "Changed commit from **[`c0a2ed7`](https://github.com/sagemath/sagetrac-mirror/commit/c0a2ed74a42cf8b575fa2cf26228e513bd69dfbd)** to **[`40bc473`](https://github.com/sagemath/sagetrac-mirror/commit/40bc47392ab35b9a7e4059bb46a455828d5d7673)**",
    "created_at": "2020-06-10T02:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451592",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c0a2ed7`](https://github.com/sagemath/sagetrac-mirror/commit/c0a2ed74a42cf8b575fa2cf26228e513bd69dfbd)** to **[`40bc473`](https://github.com/sagemath/sagetrac-mirror/commit/40bc47392ab35b9a7e4059bb46a455828d5d7673)**



---

archive/issue_comments_451593.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nSquashed some commits",
    "created_at": "2020-06-10T02:52:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451593",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:47" align="right">comment:47</div>

Squashed some commits



---

archive/issue_comments_451594.json:
```json
{
    "body": "Changed commit from **[`40bc473`](https://github.com/sagemath/sagetrac-mirror/commit/40bc47392ab35b9a7e4059bb46a455828d5d7673)** to **[`975b4a0`](https://github.com/sagemath/sagetrac-mirror/commit/975b4a0d1504887dafac780eb66120b58f204440)**",
    "created_at": "2020-06-10T02:57:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451594",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`40bc473`](https://github.com/sagemath/sagetrac-mirror/commit/40bc47392ab35b9a7e4059bb46a455828d5d7673)** to **[`975b4a0`](https://github.com/sagemath/sagetrac-mirror/commit/975b4a0d1504887dafac780eb66120b58f204440)**



---

archive/issue_comments_451595.json:
```json
{
    "body": "<div id=\"comment:48\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/226aa5a13ddb91a71ac8d25be7ced29cf8570795\"><code>226aa5a</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/906fb233d359eada18f77e848c426146281f73ff\"><code>906fb23</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a2eee0827fb0249857091b17cac267c08cc9ecb\"><code>4a2eee0</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files, Cython modules, directive 'sage_setup: distribution = PKG'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8b03161d5ef065ee4c5afc2b1d3c53716b97eca\"><code>a8b0316</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92bd8ae5281153ef354e7ef4947d4226eacfdf9b\"><code>92bd8ae</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6647d095cccd47893319f44b794f53de766bc397\"><code>6647d09</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/975b4a0d1504887dafac780eb66120b58f204440\"><code>975b4a0</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr></table>\n",
    "created_at": "2020-06-10T02:57:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451595",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:48"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/226aa5a13ddb91a71ac8d25be7ced29cf8570795"><code>226aa5a</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/906fb233d359eada18f77e848c426146281f73ff"><code>906fb23</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a2eee0827fb0249857091b17cac267c08cc9ecb"><code>4a2eee0</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files, Cython modules, directive 'sage_setup: distribution = PKG'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8b03161d5ef065ee4c5afc2b1d3c53716b97eca"><code>a8b0316</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92bd8ae5281153ef354e7ef4947d4226eacfdf9b"><code>92bd8ae</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6647d095cccd47893319f44b794f53de766bc397"><code>6647d09</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/975b4a0d1504887dafac780eb66120b58f204440"><code>975b4a0</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr></table>




---

archive/issue_comments_451596.json:
```json
{
    "body": "Changed commit from **[`975b4a0`](https://github.com/sagemath/sagetrac-mirror/commit/975b4a0d1504887dafac780eb66120b58f204440)** to **[`650c661`](https://github.com/sagemath/sagetrac-mirror/commit/650c661e50e10f57da6f121942158f654de835ec)**",
    "created_at": "2020-06-10T03:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451596",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`975b4a0`](https://github.com/sagemath/sagetrac-mirror/commit/975b4a0d1504887dafac780eb66120b58f204440)** to **[`650c661`](https://github.com/sagemath/sagetrac-mirror/commit/650c661e50e10f57da6f121942158f654de835ec)**



---

archive/issue_comments_451597.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d5803ef5920f894bcac69ed1268e1e03ea9dd5e\"><code>5d5803e</code></a></td><td><code>src/sage/graphs/planarity.pyx: Add forgotten distutils directive</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0be9b64ce3623fe4470d7b2483d21f343225ca7\"><code>a0be9b6</code></a></td><td><code>Merge branch 't/29790/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_5__sage_graphs_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0eb84e4864aee9cdae74def8a1857c05e8499d4\"><code>d0eb84e</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c82fb01c72e1416ef6fc4e2e84c0d4c22bea84fe\"><code>c82fb01</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d90e3b602ecbd7ac569361ceba51b1385f1af98a\"><code>d90e3b6</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f598e042e0b47a9da93b8c1b24b6b2503484b1bd\"><code>f598e04</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f522b095648089e50bf2b6cc796951b712ccf618\"><code>f522b09</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50df6d57d89b6f2ad048701ae51eef90926ce3a3\"><code>50df6d5</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e34c028d92a2dca994a70bfef9b69bd1b8c86558\"><code>e34c028</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/650c661e50e10f57da6f121942158f654de835ec\"><code>650c661</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr></table>\n",
    "created_at": "2020-06-10T03:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451597",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d5803ef5920f894bcac69ed1268e1e03ea9dd5e"><code>5d5803e</code></a></td><td><code>src/sage/graphs/planarity.pyx: Add forgotten distutils directive</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0be9b64ce3623fe4470d7b2483d21f343225ca7"><code>a0be9b6</code></a></td><td><code>Merge branch 't/29790/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_5__sage_graphs_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0eb84e4864aee9cdae74def8a1857c05e8499d4"><code>d0eb84e</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c82fb01c72e1416ef6fc4e2e84c0d4c22bea84fe"><code>c82fb01</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d90e3b602ecbd7ac569361ceba51b1385f1af98a"><code>d90e3b6</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f598e042e0b47a9da93b8c1b24b6b2503484b1bd"><code>f598e04</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f522b095648089e50bf2b6cc796951b712ccf618"><code>f522b09</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50df6d57d89b6f2ad048701ae51eef90926ce3a3"><code>50df6d5</code></a></td><td><code>src/module_list.py: Remove sage.graphs.graph_decompositions.* from explicit Cython module list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e34c028d92a2dca994a70bfef9b69bd1b8c86558"><code>e34c028</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/650c661e50e10f57da6f121942158f654de835ec"><code>650c661</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr></table>




---

archive/issue_comments_451598.json:
```json
{
    "body": "Changed work issues from **rebase on top of #29701** to none",
    "created_at": "2020-06-10T03:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451598",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **rebase on top of #29701** to none



---

archive/issue_comments_451599.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nRebased on top of #29701",
    "created_at": "2020-06-10T03:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451599",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:50" align="right">comment:50</div>

Rebased on top of #29701



---

archive/issue_comments_451600.json:
```json
{
    "body": "Changed dependencies from **#29702, #29701** to **#29701**",
    "created_at": "2020-06-10T03:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451600",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29702, #29701** to **#29701**



---

archive/issue_comments_451601.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,14 @@\n As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See \u200bhttps://packaging.python.org/guides/packaging-namespace-packages/\n \n 1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n+\n+   Solution: \n+\n+   i) On this ticket, sage-the-distribution continues to use the sagelib package (as the monolithic install including the optional extensions via #29701). The cleaner is only modified so it does not forget to collect namespace packages. No other distribution writes into the same tree.\n+\n+   ii) Follow-up tickets will set up PyPI deployment, using a mildly modularized version of `sagelib` called `sage-core`, and separate packages for each optional extension.  None of these packages will use the sage cleaner; they are installed using pip. \n+\n+   iii) After that, in a next step, #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages together with the monolithic sagelib installation.\n \n 2. We also need to adjust the mechanism for source discovery. \n \n@@ -23,11 +31,11 @@\n \n 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.\n \n-We test this new mechanism on two example modules: \n+We test this new mechanism on an example package: \n+`sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`.\n+(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864)\n+.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.\n \n-- `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package. The module is maintained in the sage source tree.\n-\n-- `sage.numerical.backends.coin_backend`. The package `sage.numerical.backends` is turned into a namespace package. It serves as an example of a module in a namespace package that is maintained outside of the sage source tree (here: https://github.com/mkoeppe/sage-numerical-backends-namespace)\n \n See also:\n - #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n``````\n",
    "created_at": "2020-07-16T04:43:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451601",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,14 @@
 As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See ​https://packaging.python.org/guides/packaging-namespace-packages/
 
 1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
+
+   Solution: 
+
+   i) On this ticket, sage-the-distribution continues to use the sagelib package (as the monolithic install including the optional extensions via #29701). The cleaner is only modified so it does not forget to collect namespace packages. No other distribution writes into the same tree.
+
+   ii) Follow-up tickets will set up PyPI deployment, using a mildly modularized version of `sagelib` called `sage-core`, and separate packages for each optional extension.  None of these packages will use the sage cleaner; they are installed using pip. 
+
+   iii) After that, in a next step, #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages together with the monolithic sagelib installation.
 
 2. We also need to adjust the mechanism for source discovery. 
 
@@ -23,11 +31,11 @@
 
 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.
 
-We test this new mechanism on two example modules: 
+We test this new mechanism on an example package: 
+`sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`.
+(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864)
+.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.
 
-- `sage.graphs.graph_decompositions.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package. The module is maintained in the sage source tree.
-
-- `sage.numerical.backends.coin_backend`. The package `sage.numerical.backends` is turned into a namespace package. It serves as an example of a module in a namespace package that is maintained outside of the sage source tree (here: https://github.com/mkoeppe/sage-numerical-backends-namespace)
 
 See also:
 - #29705: Meta-ticket: Modularize sagelib into separate distutils packages
``````




---

archive/issue_comments_451602.json:
```json
{
    "body": "Work Issues: **move cleaning modifications to #30152, break sage_install into several classes for the different use cases**",
    "created_at": "2020-07-16T04:43:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451602",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **move cleaning modifications to #30152, break sage_install into several classes for the different use cases**



---

archive/issue_comments_451603.json:
```json
{
    "body": "Changed commit from **[`650c661`](https://github.com/sagemath/sagetrac-mirror/commit/650c661e50e10f57da6f121942158f654de835ec)** to **[`474b200`](https://github.com/sagemath/sagetrac-mirror/commit/474b2007d3b68cbf14d10feb1cc3b2750bf0c02e)**",
    "created_at": "2020-07-16T20:09:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451603",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`650c661`](https://github.com/sagemath/sagetrac-mirror/commit/650c661e50e10f57da6f121942158f654de835ec)** to **[`474b200`](https://github.com/sagemath/sagetrac-mirror/commit/474b2007d3b68cbf14d10feb1cc3b2750bf0c02e)**



---

archive/issue_comments_451604.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14396af45af31c8f3a48d934d0e1ad424712ba4c\"><code>14396af</code></a></td><td><code>Merge tag '9.2.beta2' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d62da1559ca1448b07962ea69fcde212cfea75f0\"><code>d62da15</code></a></td><td><code>sage_setup.command.sage_build: Add the extensions to the distribution</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06a360974cc56699a85f291494a493fed041dbc9\"><code>06a3609</code></a></td><td><code>sage_setup.find.find_python_sources: Add benchmark doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/174626c7f81e7b9417bbad49fd110144a07165a6\"><code>174626c</code></a></td><td><code>Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/034a7f71a52fffc9a6566bda3e63abccdb5d6825\"><code>034a7f7</code></a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3c608b0d59077ef2ec58d32a5da0dccdbcddfd8\"><code>d3c608b</code></a></td><td><code>Merge tag '9.2.beta3' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d99e94284314a7435c8368e9f9910c57986e7af2\"><code>d99e942</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/474b2007d3b68cbf14d10feb1cc3b2750bf0c02e\"><code>474b200</code></a></td><td><code>Merge tag '9.2.beta5' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2020-07-16T20:09:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451604",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14396af45af31c8f3a48d934d0e1ad424712ba4c"><code>14396af</code></a></td><td><code>Merge tag '9.2.beta2' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d62da1559ca1448b07962ea69fcde212cfea75f0"><code>d62da15</code></a></td><td><code>sage_setup.command.sage_build: Add the extensions to the distribution</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06a360974cc56699a85f291494a493fed041dbc9"><code>06a3609</code></a></td><td><code>sage_setup.find.find_python_sources: Add benchmark doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/174626c7f81e7b9417bbad49fd110144a07165a6"><code>174626c</code></a></td><td><code>Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/034a7f71a52fffc9a6566bda3e63abccdb5d6825"><code>034a7f7</code></a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3c608b0d59077ef2ec58d32a5da0dccdbcddfd8"><code>d3c608b</code></a></td><td><code>Merge tag '9.2.beta3' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d99e94284314a7435c8368e9f9910c57986e7af2"><code>d99e942</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/474b2007d3b68cbf14d10feb1cc3b2750bf0c02e"><code>474b200</code></a></td><td><code>Merge tag '9.2.beta5' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451605.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -33,8 +33,8 @@\n \n We test this new mechanism on an example package: \n `sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`.\n-(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864)\n-.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.\n+(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)\n+The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.\n \n \n See also:\n``````\n",
    "created_at": "2020-07-17T01:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451605",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -33,8 +33,8 @@
 
 We test this new mechanism on an example package: 
 `sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`.
-(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864)
-.tdlib`. The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.
+(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)
+The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.
 
 
 See also:
``````




---

archive/issue_comments_451606.json:
```json
{
    "body": "<div id=\"comment:55\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eaadf77da8c6eb84b8eb77b5f3f42577c11d3658\"><code>eaadf77</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59151ab92187c072b03e8a4ce7d461cc6d9792f1\"><code>59151ab</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/713a8384f497a715dab2d6bc4c8cad21af6d67eb\"><code>713a838</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4faff4369440fdcf92a8cddb0d8ed0027ec1866e\"><code>4faff43</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de17c1cfb98d40a8fdddbae13ae9a0c496430fde\"><code>de17c1c</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6761b7d5ead08ac619008353dfa593a0a7273386\"><code>6761b7d</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65f3739a89689ac3502fe16d6e371dd2226b8887\"><code>65f3739</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c20f3e9bc5707df799cfc06ccbdfe82a215c814\"><code>8c20f3e</code></a></td><td><code>Revert \"sage_setup/command/sage_install.py: WIP: Disable cleaning\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37bd1cacc3a71a7ff0ffe30cf182a449fdc1fba9\"><code>37bd1ca</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in src/setup.py; refactor through new class sage_install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e79d33db38da4da9a87561f534f6b6ca813904a\"><code>2e79d33</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-08-18T02:16:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451606",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:55"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eaadf77da8c6eb84b8eb77b5f3f42577c11d3658"><code>eaadf77</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59151ab92187c072b03e8a4ce7d461cc6d9792f1"><code>59151ab</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/713a8384f497a715dab2d6bc4c8cad21af6d67eb"><code>713a838</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4faff4369440fdcf92a8cddb0d8ed0027ec1866e"><code>4faff43</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de17c1cfb98d40a8fdddbae13ae9a0c496430fde"><code>de17c1c</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6761b7d5ead08ac619008353dfa593a0a7273386"><code>6761b7d</code></a></td><td><code>src/module_list.py: Remove explicit list of sage.numerical.backends extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65f3739a89689ac3502fe16d6e371dd2226b8887"><code>65f3739</code></a></td><td><code>sage_setup/command/sage_install.py: WIP: Disable cleaning</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c20f3e9bc5707df799cfc06ccbdfe82a215c814"><code>8c20f3e</code></a></td><td><code>Revert "sage_setup/command/sage_install.py: WIP: Disable cleaning"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37bd1cacc3a71a7ff0ffe30cf182a449fdc1fba9"><code>37bd1ca</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in src/setup.py; refactor through new class sage_install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e79d33db38da4da9a87561f534f6b6ca813904a"><code>2e79d33</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_451607.json:
```json
{
    "body": "Changed commit from **[`474b200`](https://github.com/sagemath/sagetrac-mirror/commit/474b2007d3b68cbf14d10feb1cc3b2750bf0c02e)** to **[`2e79d33`](https://github.com/sagemath/sagetrac-mirror/commit/2e79d33db38da4da9a87561f534f6b6ca813904a)**",
    "created_at": "2020-08-18T02:16:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451607",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`474b200`](https://github.com/sagemath/sagetrac-mirror/commit/474b2007d3b68cbf14d10feb1cc3b2750bf0c02e)** to **[`2e79d33`](https://github.com/sagemath/sagetrac-mirror/commit/2e79d33db38da4da9a87561f534f6b6ca813904a)**



---

archive/issue_comments_451608.json:
```json
{
    "body": "Changed commit from **[`2e79d33`](https://github.com/sagemath/sagetrac-mirror/commit/2e79d33db38da4da9a87561f534f6b6ca813904a)** to **[`98a1b88`](https://github.com/sagemath/sagetrac-mirror/commit/98a1b883f8cab1fc5d3ec829a937acfa148b6347)**",
    "created_at": "2020-08-18T02:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451608",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2e79d33`](https://github.com/sagemath/sagetrac-mirror/commit/2e79d33db38da4da9a87561f534f6b6ca813904a)** to **[`98a1b88`](https://github.com/sagemath/sagetrac-mirror/commit/98a1b883f8cab1fc5d3ec829a937acfa148b6347)**



---

archive/issue_comments_451609.json:
```json
{
    "body": "<div id=\"comment:56\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca\"><code>8a19fe2</code></a></td><td><code>build/make/Makefile.in (sagelib-clean): Clean the new build location</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473\"><code>ccc67b0</code></a></td><td><code>src/sage_setup: Update cythonized_dir in doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df38027371870edf09f9e06fe1771d3cb2846aac\"><code>df38027</code></a></td><td><code>Merge branch 't/29950/build_sagelib_using_installed_sage_setup' into t/30277/remove_src_module_list_py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef4e554812b01ee5027992e8c9fc35392dcfa02b\"><code>ef4e554</code></a></td><td><code>Merge branch 't/30277/remove_src_module_list_py' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6282b8de7334a75a8f4c1fffee375841e2cb8b79\"><code>6282b8d</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c10680650f5860ae8cbcad56b6152d84bdd585b\"><code>7c10680</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e682596f98b12504338274cc80e0047250fbbfb\"><code>6e68259</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b71c3a6e796519cc15f1b7174888f4d4564a67a6\"><code>b71c3a6</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a12146fcf1872487d85b89c5ed1f1db44d6836a\"><code>3a12146</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/98a1b883f8cab1fc5d3ec829a937acfa148b6347\"><code>98a1b88</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in src/setup.py; refactor through new class sage_install</code></td></tr></table>\n",
    "created_at": "2020-08-18T02:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451609",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:56"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca"><code>8a19fe2</code></a></td><td><code>build/make/Makefile.in (sagelib-clean): Clean the new build location</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473"><code>ccc67b0</code></a></td><td><code>src/sage_setup: Update cythonized_dir in doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df38027371870edf09f9e06fe1771d3cb2846aac"><code>df38027</code></a></td><td><code>Merge branch 't/29950/build_sagelib_using_installed_sage_setup' into t/30277/remove_src_module_list_py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef4e554812b01ee5027992e8c9fc35392dcfa02b"><code>ef4e554</code></a></td><td><code>Merge branch 't/30277/remove_src_module_list_py' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6282b8de7334a75a8f4c1fffee375841e2cb8b79"><code>6282b8d</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c10680650f5860ae8cbcad56b6152d84bdd585b"><code>7c10680</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e682596f98b12504338274cc80e0047250fbbfb"><code>6e68259</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b71c3a6e796519cc15f1b7174888f4d4564a67a6"><code>b71c3a6</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a12146fcf1872487d85b89c5ed1f1db44d6836a"><code>3a12146</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/98a1b883f8cab1fc5d3ec829a937acfa148b6347"><code>98a1b88</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in src/setup.py; refactor through new class sage_install</code></td></tr></table>




---

archive/issue_comments_451610.json:
```json
{
    "body": "Changed work issues from **move cleaning modifications to #30152, break sage_install into several classes for the different use cases** to none",
    "created_at": "2020-08-18T02:28:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451610",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **move cleaning modifications to #30152, break sage_install into several classes for the different use cases** to none



---

archive/issue_comments_451611.json:
```json
{
    "body": "Changed dependencies from **#29701** to **#30277**",
    "created_at": "2020-08-18T02:28:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451611",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29701** to **#30277**



---

archive/issue_comments_451612.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,15 +27,13 @@\n \n    In this ticket, we extend this to Python modules - to mark them as belonging to a specific distutils package.\n \n-   TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n+   Wishlist item: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n \n 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.\n \n-We test this new mechanism on an example package: \n-`sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`.\n-(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)\n-The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.\n-\n+We test this new mechanism on two example packages: \n+- `sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`. (This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)\n+- `sage.numerical.backends`. (This is preparation for later work, in #30152.)\n \n See also:\n - #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n``````\n",
    "created_at": "2020-08-18T02:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451612",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,15 +27,13 @@
 
    In this ticket, we extend this to Python modules - to mark them as belonging to a specific distutils package.
 
-   TBD: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
+   Wishlist item: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
 
 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.
 
-We test this new mechanism on an example package: 
-`sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`.
-(This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)
-The package `sage.graphs.graph_decompositions` is turned into a namespace package by removing. The module continues to be maintained in the sage source tree.
-
+We test this new mechanism on two example packages: 
+- `sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`. (This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)
+- `sage.numerical.backends`. (This is preparation for later work, in #30152.)
 
 See also:
 - #29705: Meta-ticket: Modularize sagelib into separate distutils packages
``````




---

archive/issue_events_394441.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-18T02:43:23Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "title_is": "Modify find_python_sources to support modularization of sagelib by native namespace packages (PEP 420)",
    "title_was": "Modify find_python_sources, clean_stale_files to support modularization of sagelib by native namespace packages (PEP 420)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394441"
}
```



---

archive/issue_comments_451613.json:
```json
{
    "body": "<div id=\"comment:59\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32a86d2d5338d43bbe52b9737d7283e11270ca8e\"><code>32a86d2</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/742ab8777c8010a2e3d6435428c8baa7acdea128\"><code>742ab87</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-08-18T04:53:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451613",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32a86d2d5338d43bbe52b9737d7283e11270ca8e"><code>32a86d2</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/742ab8777c8010a2e3d6435428c8baa7acdea128"><code>742ab87</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_451614.json:
```json
{
    "body": "Changed commit from **[`98a1b88`](https://github.com/sagemath/sagetrac-mirror/commit/98a1b883f8cab1fc5d3ec829a937acfa148b6347)** to **[`742ab87`](https://github.com/sagemath/sagetrac-mirror/commit/742ab8777c8010a2e3d6435428c8baa7acdea128)**",
    "created_at": "2020-08-18T04:53:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451614",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`98a1b88`](https://github.com/sagemath/sagetrac-mirror/commit/98a1b883f8cab1fc5d3ec829a937acfa148b6347)** to **[`742ab87`](https://github.com/sagemath/sagetrac-mirror/commit/742ab8777c8010a2e3d6435428c8baa7acdea128)**



---

archive/issue_comments_451615.json:
```json
{
    "body": "Work Issues: **installed_files_by_module**",
    "created_at": "2020-08-18T04:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451615",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **installed_files_by_module**



---

archive/issue_comments_451616.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -31,8 +31,12 @@\n \n 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.\n \n-We test this new mechanism on two example packages: \n-- `sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`. (This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)\n+We test this new mechanism on 6 example packages (by replacing the `__init__.py` file by a `namespace` file): \n+- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe`).\n+- `sage.libs` (for `.meataxe`, `.sirocco`, `.coexter3`, `.fes`)\n+- `sage.interfaces` (for `.primecount`)\n+- `sage.graphs` (for `.bliss`, `.mcqd`)\n+- `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)\n - `sage.numerical.backends`. (This is preparation for later work, in #30152.)\n \n See also:\n``````\n",
    "created_at": "2020-08-18T05:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451616",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -31,8 +31,12 @@
 
 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.
 
-We test this new mechanism on two example packages: 
-- `sage.graphs.graph_decompositions`, which we turn into a namespace package by removing `__init__.py`. (This is preparation for shipping  `sage.graphs.graph_decompositions.tdlib` as a separate distribution `sage-tdlib` in #29864.)
+We test this new mechanism on 6 example packages (by replacing the `__init__.py` file by a `namespace` file): 
+- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe`).
+- `sage.libs` (for `.meataxe`, `.sirocco`, `.coexter3`, `.fes`)
+- `sage.interfaces` (for `.primecount`)
+- `sage.graphs` (for `.bliss`, `.mcqd`)
+- `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)
 - `sage.numerical.backends`. (This is preparation for later work, in #30152.)
 
 See also:
``````




---

archive/issue_comments_451617.json:
```json
{
    "body": "<div id=\"comment:63\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/776c979c8744c3d47275436377d9ea258bb78576\"><code>776c979</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e61adaf7bca46adc04ebf8cde025415c764ec69\"><code>2e61ada</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/26b1ca03aa1bc4fa250d69f4bb73fa6237883d08\"><code>26b1ca0</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a733af51eb86abfe98f09786c628190127610b43\"><code>a733af5</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c08c511d6ad344f0e2e98914af4246e9fe6812ec\"><code>c08c511</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4407e5ea4748f926739fb0735cb094485d7f0ea8\"><code>4407e5e</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in src/setup.py; refactor through new class sage_install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a13c126de7f89a2838ad0ec7a3a6e0bb0f882f48\"><code>a13c126</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a967aca4491de98118612f30cbdf8bd75ab4efa9\"><code>a967aca</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-09-09T01:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451617",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:63"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/776c979c8744c3d47275436377d9ea258bb78576"><code>776c979</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e61adaf7bca46adc04ebf8cde025415c764ec69"><code>2e61ada</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/26b1ca03aa1bc4fa250d69f4bb73fa6237883d08"><code>26b1ca0</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a733af51eb86abfe98f09786c628190127610b43"><code>a733af5</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c08c511d6ad344f0e2e98914af4246e9fe6812ec"><code>c08c511</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4407e5ea4748f926739fb0735cb094485d7f0ea8"><code>4407e5e</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in src/setup.py; refactor through new class sage_install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a13c126de7f89a2838ad0ec7a3a6e0bb0f882f48"><code>a13c126</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a967aca4491de98118612f30cbdf8bd75ab4efa9"><code>a967aca</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_451618.json:
```json
{
    "body": "Changed commit from **[`742ab87`](https://github.com/sagemath/sagetrac-mirror/commit/742ab8777c8010a2e3d6435428c8baa7acdea128)** to **[`a967aca`](https://github.com/sagemath/sagetrac-mirror/commit/a967aca4491de98118612f30cbdf8bd75ab4efa9)**",
    "created_at": "2020-09-09T01:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451618",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`742ab87`](https://github.com/sagemath/sagetrac-mirror/commit/742ab8777c8010a2e3d6435428c8baa7acdea128)** to **[`a967aca`](https://github.com/sagemath/sagetrac-mirror/commit/a967aca4491de98118612f30cbdf8bd75ab4efa9)**



---

archive/issue_comments_451619.json:
```json
{
    "body": "Changed dependencies from **#30277** to none",
    "created_at": "2020-09-09T01:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451619",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30277** to none



---

archive/issue_comments_451620.json:
```json
{
    "body": "Dependencies: **#30578**",
    "created_at": "2020-09-15T22:49:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451620",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#30578**



---

archive/issue_comments_451621.json:
```json
{
    "body": "Changed work issues from **installed_files_by_module** to **installed_files_by_module; rebase on top of #30578**",
    "created_at": "2020-09-15T22:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451621",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **installed_files_by_module** to **installed_files_by_module; rebase on top of #30578**



---

archive/issue_comments_451622.json:
```json
{
    "body": "Changed work issues from **installed_files_by_module; rebase on top of #30578** to **installed_files_by_module; rebase on top of #30780**",
    "created_at": "2020-10-16T22:19:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451622",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **installed_files_by_module; rebase on top of #30578** to **installed_files_by_module; rebase on top of #30780**



---

archive/issue_comments_451623.json:
```json
{
    "body": "Changed dependencies from **#30578** to **#30780**",
    "created_at": "2020-10-16T22:19:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451623",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30578** to **#30780**



---

archive/issue_comments_451624.json:
```json
{
    "body": "Changed commit from **[`a967aca`](https://github.com/sagemath/sagetrac-mirror/commit/a967aca4491de98118612f30cbdf8bd75ab4efa9)** to **[`a4e5683`](https://github.com/sagemath/sagetrac-mirror/commit/a4e5683b1ecf6121bc766bf60bd90d312371b9cf)**",
    "created_at": "2020-10-16T22:39:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451624",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a967aca`](https://github.com/sagemath/sagetrac-mirror/commit/a967aca4491de98118612f30cbdf8bd75ab4efa9)** to **[`a4e5683`](https://github.com/sagemath/sagetrac-mirror/commit/a4e5683b1ecf6121bc766bf60bd90d312371b9cf)**



---

archive/issue_comments_451625.json:
```json
{
    "body": "<div id=\"comment:68\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79801309c0aa7e455db183a9865a57b8f49ad2b5\"><code>7980130</code></a></td><td><code>Merge branch 't/30779/duplicate_src_setup_py' into t/30780/sage_setup__separate_installing_and_cleaning</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b9562827f92371c91109fc62380fecf7af8f65d\"><code>9b95628</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in build/pkgs/sagelib/src/setup.py; refactor through new class sage_install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/886ef6d639e931122f0e3ef98fe69045e51ef455\"><code>886ef6d</code></a></td><td><code>Merge branch 't/30780/sage_setup__separate_installing_and_cleaning' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b9559dbf4bf4411bfc65d33be58253ea49cc412\"><code>3b9559d</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88085b199607317e87e9b4289cd4f1895930d36b\"><code>88085b1</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c39a76d8f42b97e611ecce7503d6e71aadc7e5b\"><code>9c39a76</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0604626a8df6e555c00563363720311a98d442e\"><code>b060462</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe9a7d5e9d26e75755066cec8ddbde9f193ca011\"><code>fe9a7d5</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2fe380dba6872147c89df6903e7cf72ab2e3bdc\"><code>d2fe380</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4e5683b1ecf6121bc766bf60bd90d312371b9cf\"><code>a4e5683</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-10-16T22:39:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451625",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:68"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79801309c0aa7e455db183a9865a57b8f49ad2b5"><code>7980130</code></a></td><td><code>Merge branch 't/30779/duplicate_src_setup_py' into t/30780/sage_setup__separate_installing_and_cleaning</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b9562827f92371c91109fc62380fecf7af8f65d"><code>9b95628</code></a></td><td><code>sage_setup.command.sage_install.sage_install: Rename to sage_install_and_clean, update use it in build/pkgs/sagelib/src/setup.py; refactor through new class sage_install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/886ef6d639e931122f0e3ef98fe69045e51ef455"><code>886ef6d</code></a></td><td><code>Merge branch 't/30780/sage_setup__separate_installing_and_cleaning' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b9559dbf4bf4411bfc65d33be58253ea49cc412"><code>3b9559d</code></a></td><td><code>sage.graphs.graph_decompositions: Make it a namespace package by removing __init__.py (which had unnecessary reimports only)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88085b199607317e87e9b4289cd4f1895930d36b"><code>88085b1</code></a></td><td><code>sage.numerical.backends: Make it a namespace package by removing __init__.py (which was empty)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c39a76d8f42b97e611ecce7503d6e71aadc7e5b"><code>9c39a76</code></a></td><td><code>Mark src and src/sage/ext_data as directories that are not namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0604626a8df6e555c00563363720311a98d442e"><code>b060462</code></a></td><td><code>sage_setup.find.find_python_sources: Handle native namespace packages, 'nonamespace' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe9a7d5e9d26e75755066cec8ddbde9f193ca011"><code>fe9a7d5</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2fe380dba6872147c89df6903e7cf72ab2e3bdc"><code>d2fe380</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4e5683b1ecf6121bc766bf60bd90d312371b9cf"><code>a4e5683</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_451626.json:
```json
{
    "body": "Changed work issues from **installed_files_by_module; rebase on top of #30780** to **installed_files_by_module**",
    "created_at": "2020-10-16T22:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451626",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **installed_files_by_module; rebase on top of #30780** to **installed_files_by_module**



---

archive/issue_comments_451627.json:
```json
{
    "body": "<div id=\"comment:70\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d42aa1225b122147952c4ef9e0913bb812307401\"><code>d42aa12</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29ca24b3c12dd9ca1bcd40374893b9fa946cfc4d\"><code>29ca24b</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1957acd77a730120760f2466fca342d3a72fee12\"><code>1957acd</code></a></td><td><code>src/sage_setup/clean.py: Update comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b37214c8c3bad2a3e046798f3b6ada33580dd31\"><code>8b37214</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-10-17T00:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451627",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:70"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d42aa1225b122147952c4ef9e0913bb812307401"><code>d42aa12</code></a></td><td><code>is_package_or_namespace_package_dir: New, recognize namespace packages by file 'namespace', monkeypatch into Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29ca24b3c12dd9ca1bcd40374893b9fa946cfc4d"><code>29ca24b</code></a></td><td><code>Make sage.graphs, sage.matrix, sage.libs, sage.interfaces namespace packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1957acd77a730120760f2466fca342d3a72fee12"><code>1957acd</code></a></td><td><code>src/sage_setup/clean.py: Update comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b37214c8c3bad2a3e046798f3b6ada33580dd31"><code>8b37214</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_451628.json:
```json
{
    "body": "Changed commit from **[`a4e5683`](https://github.com/sagemath/sagetrac-mirror/commit/a4e5683b1ecf6121bc766bf60bd90d312371b9cf)** to **[`8b37214`](https://github.com/sagemath/sagetrac-mirror/commit/8b37214c8c3bad2a3e046798f3b6ada33580dd31)**",
    "created_at": "2020-10-17T00:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451628",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a4e5683`](https://github.com/sagemath/sagetrac-mirror/commit/a4e5683b1ecf6121bc766bf60bd90d312371b9cf)** to **[`8b37214`](https://github.com/sagemath/sagetrac-mirror/commit/8b37214c8c3bad2a3e046798f3b6ada33580dd31)**



---

archive/issue_comments_451629.json:
```json
{
    "body": "Changed commit from **[`8b37214`](https://github.com/sagemath/sagetrac-mirror/commit/8b37214c8c3bad2a3e046798f3b6ada33580dd31)** to **[`44a4456`](https://github.com/sagemath/sagetrac-mirror/commit/44a44560071ce851fce1e415000b13bc0cda3d90)**",
    "created_at": "2020-10-17T01:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451629",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8b37214`](https://github.com/sagemath/sagetrac-mirror/commit/8b37214c8c3bad2a3e046798f3b6ada33580dd31)** to **[`44a4456`](https://github.com/sagemath/sagetrac-mirror/commit/44a44560071ce851fce1e415000b13bc0cda3d90)**



---

archive/issue_comments_451630.json:
```json
{
    "body": "<div id=\"comment:71\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92f11456e90a24e2da0ba4cbd2dbabf5819265e1\"><code>92f1145</code></a></td><td><code>sage_install_and_clean: If all_distributions is a list, do not clean files that do not belong to this list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44a44560071ce851fce1e415000b13bc0cda3d90\"><code>44a4456</code></a></td><td><code>src/sage_setup/command/sage_install.py: Also handle modules in namespace packages</code></td></tr></table>\n",
    "created_at": "2020-10-17T01:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451630",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:71"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92f11456e90a24e2da0ba4cbd2dbabf5819265e1"><code>92f1145</code></a></td><td><code>sage_install_and_clean: If all_distributions is a list, do not clean files that do not belong to this list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44a44560071ce851fce1e415000b13bc0cda3d90"><code>44a4456</code></a></td><td><code>src/sage_setup/command/sage_install.py: Also handle modules in namespace packages</code></td></tr></table>




---

archive/issue_comments_451631.json:
```json
{
    "body": "Changed work issues from **installed_files_by_module** to none",
    "created_at": "2020-10-17T01:54:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451631",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **installed_files_by_module** to none



---

archive/issue_events_394442.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-17T01:57:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394442"
}
```



---

archive/issue_comments_451632.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad9402f606204d6dd9a454b9b055bed63247d97a\"><code>ad9402f</code></a></td><td><code>sage_setup.command.sage_install: Fixup: Remove cleaning code (moved to sage_install_and_clean)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88455dc42bfe6639c6f8dfc91f3d2fca3c51fb3e\"><code>88455dc</code></a></td><td><code>Merge branch 't/30780/sage_setup__separate_installing_and_cleaning' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2020-10-17T02:19:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451632",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad9402f606204d6dd9a454b9b055bed63247d97a"><code>ad9402f</code></a></td><td><code>sage_setup.command.sage_install: Fixup: Remove cleaning code (moved to sage_install_and_clean)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88455dc42bfe6639c6f8dfc91f3d2fca3c51fb3e"><code>88455dc</code></a></td><td><code>Merge branch 't/30780/sage_setup__separate_installing_and_cleaning' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451633.json:
```json
{
    "body": "Changed commit from **[`44a4456`](https://github.com/sagemath/sagetrac-mirror/commit/44a44560071ce851fce1e415000b13bc0cda3d90)** to **[`88455dc`](https://github.com/sagemath/sagetrac-mirror/commit/88455dc42bfe6639c6f8dfc91f3d2fca3c51fb3e)**",
    "created_at": "2020-10-17T02:19:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451633",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`44a4456`](https://github.com/sagemath/sagetrac-mirror/commit/44a44560071ce851fce1e415000b13bc0cda3d90)** to **[`88455dc`](https://github.com/sagemath/sagetrac-mirror/commit/88455dc42bfe6639c6f8dfc91f3d2fca3c51fb3e)**



---

archive/issue_comments_451634.json:
```json
{
    "body": "Changed commit from **[`88455dc`](https://github.com/sagemath/sagetrac-mirror/commit/88455dc42bfe6639c6f8dfc91f3d2fca3c51fb3e)** to **[`a9933b6`](https://github.com/sagemath/sagetrac-mirror/commit/a9933b6b1282992d49976ce0ec586aa97e1d4c26)**",
    "created_at": "2020-10-17T04:25:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451634",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`88455dc`](https://github.com/sagemath/sagetrac-mirror/commit/88455dc42bfe6639c6f8dfc91f3d2fca3c51fb3e)** to **[`a9933b6`](https://github.com/sagemath/sagetrac-mirror/commit/a9933b6b1282992d49976ce0ec586aa97e1d4c26)**



---

archive/issue_comments_451635.json:
```json
{
    "body": "<div id=\"comment:75\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9933b6b1282992d49976ce0ec586aa97e1d4c26\"><code>a9933b6</code></a></td><td><code>sage_build_cython: Pass built_distributions to find_extra_files</code></td></tr></table>\n",
    "created_at": "2020-10-17T04:25:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451635",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:75"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9933b6b1282992d49976ce0ec586aa97e1d4c26"><code>a9933b6</code></a></td><td><code>sage_build_cython: Pass built_distributions to find_extra_files</code></td></tr></table>




---

archive/issue_comments_451636.json:
```json
{
    "body": "Changed dependencies from **#30780** to **#30780, #30784**",
    "created_at": "2020-10-17T17:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451636",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30780** to **#30780, #30784**



---

archive/issue_comments_451637.json:
```json
{
    "body": "Changed commit from **[`a9933b6`](https://github.com/sagemath/sagetrac-mirror/commit/a9933b6b1282992d49976ce0ec586aa97e1d4c26)** to **[`e4ce720`](https://github.com/sagemath/sagetrac-mirror/commit/e4ce7207371e0d27eb1747fbe03855af108beb57)**",
    "created_at": "2020-10-17T17:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451637",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a9933b6`](https://github.com/sagemath/sagetrac-mirror/commit/a9933b6b1282992d49976ce0ec586aa97e1d4c26)** to **[`e4ce720`](https://github.com/sagemath/sagetrac-mirror/commit/e4ce7207371e0d27eb1747fbe03855af108beb57)**



---

archive/issue_comments_451638.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea0d15a3d546c76a902a37c0db1d09ae54c5f3d9\"><code>ea0d15a</code></a></td><td><code>sage.matrix: Resolve circular imports without using __init__.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4ce7207371e0d27eb1747fbe03855af108beb57\"><code>e4ce720</code></a></td><td><code>Merge branch 't/30784/sage_matrix__resolve_circular_imports_without_using___init___py' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2020-10-17T17:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451638",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:77"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea0d15a3d546c76a902a37c0db1d09ae54c5f3d9"><code>ea0d15a</code></a></td><td><code>sage.matrix: Resolve circular imports without using __init__.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4ce7207371e0d27eb1747fbe03855af108beb57"><code>e4ce720</code></a></td><td><code>Merge branch 't/30784/sage_matrix__resolve_circular_imports_without_using___init___py' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451639.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -32,8 +32,8 @@\n 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.\n \n We test this new mechanism on 6 example packages (by replacing the `__init__.py` file by a `namespace` file): \n-- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe`).\n-- `sage.libs` (for `.meataxe`, `.sirocco`, `.coexter3`, `.fes`)\n+- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe` - #30151).\n+- `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)\n - `sage.interfaces` (for `.primecount`)\n - `sage.graphs` (for `.bliss`, `.mcqd`)\n - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)\n``````\n",
    "created_at": "2020-10-17T18:02:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451639",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -32,8 +32,8 @@
 3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.
 
 We test this new mechanism on 6 example packages (by replacing the `__init__.py` file by a `namespace` file): 
-- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe`).
-- `sage.libs` (for `.meataxe`, `.sirocco`, `.coexter3`, `.fes`)
+- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe` - #30151).
+- `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)
 - `sage.interfaces` (for `.primecount`)
 - `sage.graphs` (for `.bliss`, `.mcqd`)
 - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)
``````




---

archive/issue_comments_451640.json:
```json
{
    "body": "Changed commit from **[`e4ce720`](https://github.com/sagemath/sagetrac-mirror/commit/e4ce7207371e0d27eb1747fbe03855af108beb57)** to **[`6aaa958`](https://github.com/sagemath/sagetrac-mirror/commit/6aaa95887be0f4f5257208e6662cd3ca821bc0bc)**",
    "created_at": "2020-10-17T18:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451640",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e4ce720`](https://github.com/sagemath/sagetrac-mirror/commit/e4ce7207371e0d27eb1747fbe03855af108beb57)** to **[`6aaa958`](https://github.com/sagemath/sagetrac-mirror/commit/6aaa95887be0f4f5257208e6662cd3ca821bc0bc)**



---

archive/issue_comments_451641.json:
```json
{
    "body": "<div id=\"comment:79\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6aaa95887be0f4f5257208e6662cd3ca821bc0bc\"><code>6aaa958</code></a></td><td><code>sage_install_and_clean: Move all_distributions into class</code></td></tr></table>\n",
    "created_at": "2020-10-17T18:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451641",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:79"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6aaa95887be0f4f5257208e6662cd3ca821bc0bc"><code>6aaa958</code></a></td><td><code>sage_install_and_clean: Move all_distributions into class</code></td></tr></table>




---

archive/issue_comments_451642.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nReady for review",
    "created_at": "2020-10-17T18:23:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451642",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:80" align="right">comment:80</div>

Ready for review



---

archive/issue_comments_451643.json:
```json
{
    "body": "<div id=\"comment:81\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39be6390197b4c39382420e27653c83dd99a3503\"><code>39be639</code></a></td><td><code>FileDocTestSource.in_lib: Handle namespace packages</code></td></tr></table>\n",
    "created_at": "2020-10-17T18:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451643",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:81"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39be6390197b4c39382420e27653c83dd99a3503"><code>39be639</code></a></td><td><code>FileDocTestSource.in_lib: Handle namespace packages</code></td></tr></table>




---

archive/issue_comments_451644.json:
```json
{
    "body": "Changed commit from **[`6aaa958`](https://github.com/sagemath/sagetrac-mirror/commit/6aaa95887be0f4f5257208e6662cd3ca821bc0bc)** to **[`39be639`](https://github.com/sagemath/sagetrac-mirror/commit/39be6390197b4c39382420e27653c83dd99a3503)**",
    "created_at": "2020-10-17T18:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451644",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6aaa958`](https://github.com/sagemath/sagetrac-mirror/commit/6aaa95887be0f4f5257208e6662cd3ca821bc0bc)** to **[`39be639`](https://github.com/sagemath/sagetrac-mirror/commit/39be6390197b4c39382420e27653c83dd99a3503)**



---

archive/issue_comments_451645.json:
```json
{
    "body": "<div id=\"comment:82\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64c5120b0a03c5a907cb56f63bf9df360976bd44\"><code>64c5120</code></a></td><td><code>find_python_sources: Also collect namespace packages - so that package_data works</code></td></tr></table>\n",
    "created_at": "2020-10-17T21:54:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451645",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:82"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64c5120b0a03c5a907cb56f63bf9df360976bd44"><code>64c5120</code></a></td><td><code>find_python_sources: Also collect namespace packages - so that package_data works</code></td></tr></table>




---

archive/issue_comments_451646.json:
```json
{
    "body": "Changed commit from **[`39be639`](https://github.com/sagemath/sagetrac-mirror/commit/39be6390197b4c39382420e27653c83dd99a3503)** to **[`64c5120`](https://github.com/sagemath/sagetrac-mirror/commit/64c5120b0a03c5a907cb56f63bf9df360976bd44)**",
    "created_at": "2020-10-17T21:54:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451646",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`39be639`](https://github.com/sagemath/sagetrac-mirror/commit/39be6390197b4c39382420e27653c83dd99a3503)** to **[`64c5120`](https://github.com/sagemath/sagetrac-mirror/commit/64c5120b0a03c5a907cb56f63bf9df360976bd44)**



---

archive/issue_comments_451647.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,46 +1,40 @@\n-As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See \u200bhttps://packaging.python.org/guides/packaging-namespace-packages/\n+This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.\n \n-1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.\n+Ordinary packages (directories of modules) are turned into namespace packages by removing the empty `__init__.py` file.\n \n-   Solution: \n+Then a different distribution (distutils package) can share the same namespace. \n \n-   i) On this ticket, sage-the-distribution continues to use the sagelib package (as the monolithic install including the optional extensions via #29701). The cleaner is only modified so it does not forget to collect namespace packages. No other distribution writes into the same tree.\n+In the first stage of modularization, planned for Sage 9.3, we use this new mechanism to split out all \"optional extension modules\" (which depend on some optional library) from the `sagelib` distribution to separate pip-installable packages. This will simplify deployment and dependency management.\n \n-   ii) Follow-up tickets will set up PyPI deployment, using a mildly modularized version of `sagelib` called `sage-core`, and separate packages for each optional extension.  None of these packages will use the sage cleaner; they are installed using pip. \n+(The source code remains in the same place in `src/sage` in the git tree; the new pip-installable packages will have separate metadata in `build/pkgs/SPKG`.)\n \n-   iii) After that, in a next step, #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages together with the monolithic sagelib installation.\n-\n-2. We also need to adjust the mechanism for source discovery. \n-\n-   Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. \n-\n-   a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.\n-\n-   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).\n-\n-   c) #29701 already introduced a directive on the top of Cython extension source files:\n-\n-```\n-   # sage_setup: distribution = sage-tdlib\n-```\n-    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers. \n-\n-   In this ticket, we extend this to Python modules - to mark them as belonging to a specific distutils package.\n-\n-   Wishlist item: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n-\n-3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.\n-\n-We test this new mechanism on 6 example packages (by replacing the `__init__.py` file by a `namespace` file): \n-- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe` - #30151).\n+1. To this end, this ticket changes the following packages to namespace packages (by removing `__init__.py`): \n+- `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)\n - `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)\n - `sage.interfaces` (for `.primecount`)\n - `sage.graphs` (for `.bliss`, `.mcqd`)\n - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)\n - `sage.numerical.backends`. (This is preparation for later work, in #30152.)\n \n+2. Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.\n+\n+To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named \n+- `namespace` to mark a directory without `__init__.py` as a namespace package; \n+- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)\n+\n+(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)\n+\n+3. Also the incremental installation mechanisms of sagelib's build system need adjustment. `clean_stale_files`, which deletes installed Python modules in `$SAGE_LIB/sage` = `..../site-packages/sage` that are no longer present in the current version of the source tree, is changed so that it does not delete modules in a namespace package that are provided by a separate distribution (pip-installable package).\n+\n+\n+\n+Follow-up tickets:\n+- Wishlist item: Warn or give errors if the `sage_setup: distribution` directives, `namespace` and `nonamespace` files indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n+- #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages\n+\n See also:\n - #29705: Meta-ticket: Modularize sagelib into separate distutils packages\n+- Initial discussion of namespace packages for Sage in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4\n - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory\n \n \n``````\n",
    "created_at": "2020-10-18T03:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451647",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,46 +1,40 @@
-As discussed in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4, it may be useful to modularize sage by the use of native namespace packages (PEP 420) - See ​https://packaging.python.org/guides/packaging-namespace-packages/
+This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.
 
-1. One obstacle to using namespace packages is that `src/setup.py` (`clean_stale_files`) deletes unknown files in the installation tree (`$SAGE_LIB/sage` = `..../site-packages/sage`). This would remove installed namespace packages within the `sage` package.
+Ordinary packages (directories of modules) are turned into namespace packages by removing the empty `__init__.py` file.
 
-   Solution: 
+Then a different distribution (distutils package) can share the same namespace. 
 
-   i) On this ticket, sage-the-distribution continues to use the sagelib package (as the monolithic install including the optional extensions via #29701). The cleaner is only modified so it does not forget to collect namespace packages. No other distribution writes into the same tree.
+In the first stage of modularization, planned for Sage 9.3, we use this new mechanism to split out all "optional extension modules" (which depend on some optional library) from the `sagelib` distribution to separate pip-installable packages. This will simplify deployment and dependency management.
 
-   ii) Follow-up tickets will set up PyPI deployment, using a mildly modularized version of `sagelib` called `sage-core`, and separate packages for each optional extension.  None of these packages will use the sage cleaner; they are installed using pip. 
+(The source code remains in the same place in `src/sage` in the git tree; the new pip-installable packages will have separate metadata in `build/pkgs/SPKG`.)
 
-   iii) After that, in a next step, #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages together with the monolithic sagelib installation.
-
-2. We also need to adjust the mechanism for source discovery. 
-
-   Ordinary packages are turned into namespace packages by removing the empty `__init__.py` file. But `find_python_sources` uses `__init__.py` to recognize package directories. 
-
-   a) Instead of using `find_namespace_packages` from `setuptools`, we modify `sage_setup.find.find_python_sources` to also find modules in namespace packages.
-
-   b) We have a few directories that contain Python files but should not be namespace packages. We mark them with a file `nonamespace` (I just made this up, in analogy to the `nodoctest` file).
-
-   c) #29701 already introduced a directive on the top of Cython extension source files:
-
-```
-   # sage_setup: distribution = sage-tdlib
-```
-    `find_python_sources` parses these directives using code adapted from Cython infrastructure (`Cython.Build.Dependencies.DistutilsInfo`).  We use dashes in these distribution names to emphasize that they are names of distutils packages (distributions), NOT Python package identifiers. 
-
-   In this ticket, we extend this to Python modules - to mark them as belonging to a specific distutils package.
-
-   Wishlist item: Warn or give errors if these directives indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
-
-3. For Cython extensions, as of Sage 9.1, we use a mix of explicitly named modules and wildcards in `src/module_list.py`. This is very different from how we discover Python modules. #29701 (Replace use of `module_list` and `OptionalExtension` by extending `find_python_sources`) changes this, so 2. above applies to Cython as well.
-
-We test this new mechanism on 6 example packages (by replacing the `__init__.py` file by a `namespace` file): 
-- `sage.matrix` (for `.matrix_gfpn_dense` -> `sage-meataxe` - #30151).
+1. To this end, this ticket changes the following packages to namespace packages (by removing `__init__.py`): 
+- `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)
 - `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)
 - `sage.interfaces` (for `.primecount`)
 - `sage.graphs` (for `.bliss`, `.mcqd`)
 - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)
 - `sage.numerical.backends`. (This is preparation for later work, in #30152.)
 
+2. Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.
+
+To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named 
+- `namespace` to mark a directory without `__init__.py` as a namespace package; 
+- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)
+
+(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)
+
+3. Also the incremental installation mechanisms of sagelib's build system need adjustment. `clean_stale_files`, which deletes installed Python modules in `$SAGE_LIB/sage` = `..../site-packages/sage` that are no longer present in the current version of the source tree, is changed so that it does not delete modules in a namespace package that are provided by a separate distribution (pip-installable package).
+
+
+
+Follow-up tickets:
+- Wishlist item: Warn or give errors if the `sage_setup: distribution` directives, `namespace` and `nonamespace` files indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
+- #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages
+
 See also:
 - #29705: Meta-ticket: Modularize sagelib into separate distutils packages
+- Initial discussion of namespace packages for Sage in #28175 and https://github.com/mkoeppe/sage-numerical-backends-coin/pull/4
 - #21654: `src/setup.py`: Disentangle cleaning of stale installed files in build directory and in install directory
 
 
``````




---

archive/issue_comments_451648.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nWhat's the advantage/reason to introduce the sage-specific namespace/nonamespace convention instead of following PEP 420 and keep the `__init__.py` file as a marker for namespace packages together with `setuptools.find_namespace_packages()`?",
    "created_at": "2020-10-18T09:25:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451648",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:84" align="right">comment:84</div>

What's the advantage/reason to introduce the sage-specific namespace/nonamespace convention instead of following PEP 420 and keep the `__init__.py` file as a marker for namespace packages together with `setuptools.find_namespace_packages()`?



---

archive/issue_comments_451649.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nReplying to [@tobiasdiez](#comment:84):\n> What's the advantage/reason to introduce the sage-specific namespace/nonamespace convention instead of following PEP 420 and keep the `__init__.py` file as a marker for namespace packages together with `setuptools.find_namespace_packages()`?\n\nOne **cannot** keep `__init__.py` for native namespace packages. PEP 420 is quite clear about it. Sub-packages of namespace packages do have `__init__.py`; and also the present ticket keeps them.",
    "created_at": "2020-10-19T21:31:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451649",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:85" align="right">comment:85</div>

Replying to [@tobiasdiez](#comment:84):
> What's the advantage/reason to introduce the sage-specific namespace/nonamespace convention instead of following PEP 420 and keep the `__init__.py` file as a marker for namespace packages together with `setuptools.find_namespace_packages()`?

One **cannot** keep `__init__.py` for native namespace packages. PEP 420 is quite clear about it. Sub-packages of namespace packages do have `__init__.py`; and also the present ticket keeps them.



---

archive/issue_comments_451650.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\n`find_namespace_packages` accepts any directory as a package directory:\n\n```\nclass PEP420PackageFinder(PackageFinder):\n    @staticmethod\n    def _looks_like_package(path):\n        return True\n```\n(https://github.com/pypa/setuptools/blob/f991fbb3c9d0e10a0a78ae2b508b3fd99f9cdef2/setuptools/__init__.py#L110)\n\nBut our source tree has some directories that should not be considered package directories. I have marked these with the `nonamespace` file.\n\nHaving both `nonamespace` and `namespace` files results in simpler changes to the existing code.",
    "created_at": "2020-10-19T21:37:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451650",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:86" align="right">comment:86</div>

`find_namespace_packages` accepts any directory as a package directory:

```
class PEP420PackageFinder(PackageFinder):
    @staticmethod
    def _looks_like_package(path):
        return True
```
(https://github.com/pypa/setuptools/blob/f991fbb3c9d0e10a0a78ae2b508b3fd99f9cdef2/setuptools/__init__.py#L110)

But our source tree has some directories that should not be considered package directories. I have marked these with the `nonamespace` file.

Having both `nonamespace` and `namespace` files results in simpler changes to the existing code.



---

archive/issue_comments_451651.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nOh ok, sorry, I've misunderstood the ticket description. You are of course right, implicit namespace packages don't have a `__init__.py` file.\n\nConcerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.\n\nIf you do prefer to have these files, I would like to ask you to add documentation to the dev docs.",
    "created_at": "2020-10-19T22:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451651",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:87" align="right">comment:87</div>

Oh ok, sorry, I've misunderstood the ticket description. You are of course right, implicit namespace packages don't have a `__init__.py` file.

Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.

If you do prefer to have these files, I would like to ask you to add documentation to the dev docs.



---

archive/issue_comments_451652.json:
```json
{
    "body": "Changed commit from **[`64c5120`](https://github.com/sagemath/sagetrac-mirror/commit/64c5120b0a03c5a907cb56f63bf9df360976bd44)** to **[`3c7d675`](https://github.com/sagemath/sagetrac-mirror/commit/3c7d6751b4bdc7c419ecc94a2add7b1da21be212)**",
    "created_at": "2020-10-20T03:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451652",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`64c5120`](https://github.com/sagemath/sagetrac-mirror/commit/64c5120b0a03c5a907cb56f63bf9df360976bd44)** to **[`3c7d675`](https://github.com/sagemath/sagetrac-mirror/commit/3c7d6751b4bdc7c419ecc94a2add7b1da21be212)**



---

archive/issue_comments_451653.json:
```json
{
    "body": "<div id=\"comment:88\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c7d6751b4bdc7c419ecc94a2add7b1da21be212\"><code>3c7d675</code></a></td><td><code>src/sage_setup/find.py (find_python_sources): Update doc, doctests</code></td></tr></table>\n",
    "created_at": "2020-10-20T03:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451653",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:88"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c7d6751b4bdc7c419ecc94a2add7b1da21be212"><code>3c7d675</code></a></td><td><code>src/sage_setup/find.py (find_python_sources): Update doc, doctests</code></td></tr></table>




---

archive/issue_comments_451654.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nReplying to [@tobiasdiez](#comment:87):\n> Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.\n\nThanks for the input and the pointer to PEP 382.\nI'll try out if your suggestion can be implemented without major changes.",
    "created_at": "2020-10-20T03:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451654",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:89" align="right">comment:89</div>

Replying to [@tobiasdiez](#comment:87):
> Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.

Thanks for the input and the pointer to PEP 382.
I'll try out if your suggestion can be implemented without major changes.



---

archive/issue_events_394443.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-20T03:20:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394443"
}
```



---

archive/issue_events_394444.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-20T03:20:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394444"
}
```



---

archive/issue_comments_451655.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nTBD: In incremental builds, the cleaner fails to remove previously installed `__init__.py` files:\n\n```\n**********************************************************************\nFile \"src/sage_setup/find.py\", line 343, in sage_setup.find.installed_files_by_module\nFailed example:\n    files_by_module['sage.graphs.graph_decompositions']\nExpected nothing\nGot:\n    {'sage/graphs/graph_decompositions/__init__.py',\n     'sage/graphs/graph_decompositions/__pycache__/__init__.cpython-37.pyc'}\n**********************************************************************\n```",
    "created_at": "2020-10-20T03:20:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451655",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:90" align="right">comment:90</div>

TBD: In incremental builds, the cleaner fails to remove previously installed `__init__.py` files:

```
**********************************************************************
File "src/sage_setup/find.py", line 343, in sage_setup.find.installed_files_by_module
Failed example:
    files_by_module['sage.graphs.graph_decompositions']
Expected nothing
Got:
    {'sage/graphs/graph_decompositions/__init__.py',
     'sage/graphs/graph_decompositions/__pycache__/__init__.cpython-37.pyc'}
**********************************************************************
```



---

archive/issue_comments_451656.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,20 +9,20 @@\n (The source code remains in the same place in `src/sage` in the git tree; the new pip-installable packages will have separate metadata in `build/pkgs/SPKG`.)\n \n 1. To this end, this ticket changes the following packages to namespace packages (by removing `__init__.py`): \n-- `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)\n-- `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)\n-- `sage.interfaces` (for `.primecount`)\n-- `sage.graphs` (for `.bliss`, `.mcqd`)\n-- `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)\n-- `sage.numerical.backends`. (This is preparation for later work, in #30152.)\n+   - `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)\n+   - `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)\n+   - `sage.interfaces` (for `.primecount`)\n+   - `sage.graphs` (for `.bliss`, `.mcqd`)\n+   - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)\n+   - `sage.numerical.backends`. (This is preparation for later work, in #30152.)\n \n 2. Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.\n \n-To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named \n-- `namespace` to mark a directory without `__init__.py` as a namespace package; \n-- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)\n+   To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:\n+    - `namespace` to mark a directory without `__init__.py` as a namespace package; \n+    - `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)\n \n-(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)\n+   (In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)\n \n 3. Also the incremental installation mechanisms of sagelib's build system need adjustment. `clean_stale_files`, which deletes installed Python modules in `$SAGE_LIB/sage` = `..../site-packages/sage` that are no longer present in the current version of the source tree, is changed so that it does not delete modules in a namespace package that are provided by a separate distribution (pip-installable package).\n \n``````\n",
    "created_at": "2020-10-20T04:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451656",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,20 +9,20 @@
 (The source code remains in the same place in `src/sage` in the git tree; the new pip-installable packages will have separate metadata in `build/pkgs/SPKG`.)
 
 1. To this end, this ticket changes the following packages to namespace packages (by removing `__init__.py`): 
-- `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)
-- `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)
-- `sage.interfaces` (for `.primecount`)
-- `sage.graphs` (for `.bliss`, `.mcqd`)
-- `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)
-- `sage.numerical.backends`. (This is preparation for later work, in #30152.)
+   - `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)
+   - `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)
+   - `sage.interfaces` (for `.primecount`)
+   - `sage.graphs` (for `.bliss`, `.mcqd`)
+   - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)
+   - `sage.numerical.backends`. (This is preparation for later work, in #30152.)
 
 2. Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.
 
-To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named 
-- `namespace` to mark a directory without `__init__.py` as a namespace package; 
-- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)
+   To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:
+    - `namespace` to mark a directory without `__init__.py` as a namespace package; 
+    - `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)
 
-(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)
+   (In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)
 
 3. Also the incremental installation mechanisms of sagelib's build system need adjustment. `clean_stale_files`, which deletes installed Python modules in `$SAGE_LIB/sage` = `..../site-packages/sage` that are no longer present in the current version of the source tree, is changed so that it does not delete modules in a namespace package that are provided by a separate distribution (pip-installable package).
 
``````




---

archive/issue_comments_451657.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nNote that one annoying thing about `find_namespace_packages` when applied to our source tree is that we have lots of directories that do not contain any python files, leading to output like this from distutils:\n\n```\n[sagelib-9.2.rc2] package init file 'sage/schemes/generic/notes/__init__.py' not found (or not a regular file)\n```\nThe branch on this ticket handles such directories specially (no need for `nonamespace` files there). If there is a solution that could silence these notes, the code could be brought closer to `find_namespace_packages` behavior.",
    "created_at": "2020-10-20T04:57:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451657",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:92" align="right">comment:92</div>

Note that one annoying thing about `find_namespace_packages` when applied to our source tree is that we have lots of directories that do not contain any python files, leading to output like this from distutils:

```
[sagelib-9.2.rc2] package init file 'sage/schemes/generic/notes/__init__.py' not found (or not a regular file)
```
The branch on this ticket handles such directories specially (no need for `nonamespace` files there). If there is a solution that could silence these notes, the code could be brought closer to `find_namespace_packages` behavior.



---

archive/issue_comments_451658.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\n`find_namespace_packages` excepts `include` and `exclude` directories as arguments. So one option would be to get a list of all folders not including any python files, and pass this as `exclude` (or the same approach using a whitelist).",
    "created_at": "2020-10-20T08:35:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451658",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:93" align="right">comment:93</div>

`find_namespace_packages` excepts `include` and `exclude` directories as arguments. So one option would be to get a list of all folders not including any python files, and pass this as `exclude` (or the same approach using a whitelist).



---

archive/issue_comments_451659.json:
```json
{
    "body": "Changed keywords from none to **sd111**",
    "created_at": "2020-12-06T17:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451659",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from none to **sd111**



---

archive/issue_comments_451660.json:
```json
{
    "body": "Changed commit from **[`3c7d675`](https://github.com/sagemath/sagetrac-mirror/commit/3c7d6751b4bdc7c419ecc94a2add7b1da21be212)** to **[`a6e8447`](https://github.com/sagemath/sagetrac-mirror/commit/a6e8447748b8a2b4107c43a92daa2bcef30ff27b)**",
    "created_at": "2020-12-09T05:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451660",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3c7d675`](https://github.com/sagemath/sagetrac-mirror/commit/3c7d6751b4bdc7c419ecc94a2add7b1da21be212)** to **[`a6e8447`](https://github.com/sagemath/sagetrac-mirror/commit/a6e8447748b8a2b4107c43a92daa2bcef30ff27b)**



---

archive/issue_comments_451661.json:
```json
{
    "body": "<div id=\"comment:95\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6e8447748b8a2b4107c43a92daa2bcef30ff27b\"><code>a6e8447</code></a></td><td><code>Merge tag '9.3.beta3' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2020-12-09T05:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451661",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:95"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6e8447748b8a2b4107c43a92daa2bcef30ff27b"><code>a6e8447</code></a></td><td><code>Merge tag '9.3.beta3' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451662.json:
```json
{
    "body": "Work Issues: **comment 90**",
    "created_at": "2020-12-09T05:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451662",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **comment 90**



---

archive/issue_comments_451663.json:
```json
{
    "body": "Changed dependencies from **#30780, #30784** to none",
    "created_at": "2020-12-09T05:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451663",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30780, #30784** to none



---

archive/issue_comments_451664.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451664",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:97" align="right">comment:97</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_394445.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394445"
}
```



---

archive/issue_events_394446.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394446"
}
```



---

archive/issue_events_394447.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394447"
}
```



---

archive/issue_events_394448.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394448"
}
```



---

archive/issue_comments_451665.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451665",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:98" align="right">comment:98</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_451666.json:
```json
{
    "body": "Changed commit from **[`a6e8447`](https://github.com/sagemath/sagetrac-mirror/commit/a6e8447748b8a2b4107c43a92daa2bcef30ff27b)** to **[`f017b3f`](https://github.com/sagemath/sagetrac-mirror/commit/f017b3f879f77e70425ac65174982ccf9044baf4)**",
    "created_at": "2021-11-26T23:21:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451666",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a6e8447`](https://github.com/sagemath/sagetrac-mirror/commit/a6e8447748b8a2b4107c43a92daa2bcef30ff27b)** to **[`f017b3f`](https://github.com/sagemath/sagetrac-mirror/commit/f017b3f879f77e70425ac65174982ccf9044baf4)**



---

archive/issue_comments_451667.json:
```json
{
    "body": "<div id=\"comment:99\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f017b3f879f77e70425ac65174982ccf9044baf4\"><code>f017b3f</code></a></td><td><code>#28925 Modify find_python_sources to support modularization (squashed)</code></td></tr></table>\n",
    "created_at": "2021-11-26T23:21:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451667",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:99"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f017b3f879f77e70425ac65174982ccf9044baf4"><code>f017b3f</code></a></td><td><code>#28925 Modify find_python_sources to support modularization (squashed)</code></td></tr></table>




---

archive/issue_comments_451668.json:
```json
{
    "body": "<div id=\"comment:100\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfaeb1488e1048c3e51a898bd6eddbbb8d9a7e13\"><code>bfaeb14</code></a></td><td><code>28925: Modify find_python_sources to support modularization (squashed)</code></td></tr></table>\n",
    "created_at": "2021-11-26T23:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451668",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:100"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfaeb1488e1048c3e51a898bd6eddbbb8d9a7e13"><code>bfaeb14</code></a></td><td><code>28925: Modify find_python_sources to support modularization (squashed)</code></td></tr></table>




---

archive/issue_comments_451669.json:
```json
{
    "body": "Changed commit from **[`f017b3f`](https://github.com/sagemath/sagetrac-mirror/commit/f017b3f879f77e70425ac65174982ccf9044baf4)** to **[`bfaeb14`](https://github.com/sagemath/sagetrac-mirror/commit/bfaeb1488e1048c3e51a898bd6eddbbb8d9a7e13)**",
    "created_at": "2021-11-26T23:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451669",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f017b3f`](https://github.com/sagemath/sagetrac-mirror/commit/f017b3f879f77e70425ac65174982ccf9044baf4)** to **[`bfaeb14`](https://github.com/sagemath/sagetrac-mirror/commit/bfaeb1488e1048c3e51a898bd6eddbbb8d9a7e13)**



---

archive/issue_comments_451670.json:
```json
{
    "body": "Dependencies: **#32927**",
    "created_at": "2021-11-27T21:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451670",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#32927**



---

archive/issue_comments_451671.json:
```json
{
    "body": "<div id=\"comment:102\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6fc11169fb777a699b6c0dd7d99c6197eb9a1f9\"><code>c6fc111</code></a></td><td><code>Prettier diagram</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d6a44ce9551bfcdde44897c9676281028bafbdb\"><code>7d6a44c</code></a></td><td><code>Use :mod: as markup for packages/modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f83d424d1270d03643d41c47d697c0931b0627dc\"><code>f83d424</code></a></td><td><code>Improve ABC example</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/817a8d0ccc1b65d7bd2d38b2e4b8bcb572ced84f\"><code>817a8d0</code></a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: More :mod: and :class: markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b555735c504a86cb0f465afad5daee82db69d77f\"><code>b555735</code></a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: Link to pypi.org and to documentation of packaging metadata</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81e9c9a2f3ecad50854d98fe541869b64b4ea2f4\"><code>81e9c9a</code></a></td><td><code>Merge #32899</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ecc0886d2a3080c97ec0fbf70ac68210f325c712\"><code>ecc0886</code></a></td><td><code>Merge #31386</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00d5f59a1ec73a6c30152a8005fab338d1ef723b\"><code>00d5f59</code></a></td><td><code>build/pkgs/sagelib: Invoke install cleaner explicitly, remove it from pkgs/sagemath-standard/setup.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5aab69f95eea9b649785f04aec987f3ca5e207b\"><code>a5aab69</code></a></td><td><code>Merge #32927</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15813aa5f45d8cecf80ce12bbb1966ece00cace9\"><code>15813aa</code></a></td><td><code>Remove __init__.py files</code></td></tr></table>\n",
    "created_at": "2021-11-27T22:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451671",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:102"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6fc11169fb777a699b6c0dd7d99c6197eb9a1f9"><code>c6fc111</code></a></td><td><code>Prettier diagram</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d6a44ce9551bfcdde44897c9676281028bafbdb"><code>7d6a44c</code></a></td><td><code>Use :mod: as markup for packages/modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f83d424d1270d03643d41c47d697c0931b0627dc"><code>f83d424</code></a></td><td><code>Improve ABC example</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/817a8d0ccc1b65d7bd2d38b2e4b8bcb572ced84f"><code>817a8d0</code></a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: More :mod: and :class: markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b555735c504a86cb0f465afad5daee82db69d77f"><code>b555735</code></a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: Link to pypi.org and to documentation of packaging metadata</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81e9c9a2f3ecad50854d98fe541869b64b4ea2f4"><code>81e9c9a</code></a></td><td><code>Merge #32899</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ecc0886d2a3080c97ec0fbf70ac68210f325c712"><code>ecc0886</code></a></td><td><code>Merge #31386</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00d5f59a1ec73a6c30152a8005fab338d1ef723b"><code>00d5f59</code></a></td><td><code>build/pkgs/sagelib: Invoke install cleaner explicitly, remove it from pkgs/sagemath-standard/setup.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5aab69f95eea9b649785f04aec987f3ca5e207b"><code>a5aab69</code></a></td><td><code>Merge #32927</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15813aa5f45d8cecf80ce12bbb1966ece00cace9"><code>15813aa</code></a></td><td><code>Remove __init__.py files</code></td></tr></table>




---

archive/issue_comments_451672.json:
```json
{
    "body": "Changed commit from **[`bfaeb14`](https://github.com/sagemath/sagetrac-mirror/commit/bfaeb1488e1048c3e51a898bd6eddbbb8d9a7e13)** to **[`15813aa`](https://github.com/sagemath/sagetrac-mirror/commit/15813aa5f45d8cecf80ce12bbb1966ece00cace9)**",
    "created_at": "2021-11-27T22:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451672",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bfaeb14`](https://github.com/sagemath/sagetrac-mirror/commit/bfaeb1488e1048c3e51a898bd6eddbbb8d9a7e13)** to **[`15813aa`](https://github.com/sagemath/sagetrac-mirror/commit/15813aa5f45d8cecf80ce12bbb1966ece00cace9)**



---

archive/issue_comments_451673.json:
```json
{
    "body": "Changed dependencies from **#32927** to **#32927, #29865**",
    "created_at": "2021-12-11T04:25:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451673",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32927** to **#32927, #29865**



---

archive/issue_comments_451674.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,34 +1,20 @@\n This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.\n \n-Ordinary packages (directories of modules) are turned into namespace packages by removing the empty `__init__.py` file.\n+Ordinary packages (directories of modules) can be turned into namespace packages by removing the empty `__init__.py` file.\n+Then a different distribution package can share the same namespace. \n \n-Then a different distribution (distutils package) can share the same namespace. \n+Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.\n \n-In the first stage of modularization, planned for Sage 9.3, we use this new mechanism to split out all \"optional extension modules\" (which depend on some optional library) from the `sagelib` distribution to separate pip-installable packages. This will simplify deployment and dependency management.\n+To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:\n+- `namespace` to mark a directory without `__init__.py` as a namespace package; \n+- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)\n+(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)\n \n-(The source code remains in the same place in `src/sage` in the git tree; the new pip-installable packages will have separate metadata in `build/pkgs/SPKG`.)\n-\n-1. To this end, this ticket changes the following packages to namespace packages (by removing `__init__.py`): \n-   - `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)\n-   - `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)\n-   - `sage.interfaces` (for `.primecount`)\n-   - `sage.graphs` (for `.bliss`, `.mcqd`)\n-   - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)\n-   - `sage.numerical.backends`. (This is preparation for later work, in #30152.)\n-\n-2. Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.\n-\n-   To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:\n-    - `namespace` to mark a directory without `__init__.py` as a namespace package; \n-    - `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)\n-\n-   (In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)\n-\n-3. Also the incremental installation mechanisms of sagelib's build system need adjustment. `clean_stale_files`, which deletes installed Python modules in `$SAGE_LIB/sage` = `..../site-packages/sage` that are no longer present in the current version of the source tree, is changed so that it does not delete modules in a namespace package that are provided by a separate distribution (pip-installable package).\n-\n+In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages.\n \n \n Follow-up tickets:\n+- #33011 Remove the `__init__.py` files for packages designated to be namespace packages\n - Wishlist item: Warn or give errors if the `sage_setup: distribution` directives, `namespace` and `nonamespace` files indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.\n - #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages\n \n``````\n",
    "created_at": "2021-12-11T04:40:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451674",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,34 +1,20 @@
 This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.
 
-Ordinary packages (directories of modules) are turned into namespace packages by removing the empty `__init__.py` file.
+Ordinary packages (directories of modules) can be turned into namespace packages by removing the empty `__init__.py` file.
+Then a different distribution package can share the same namespace. 
 
-Then a different distribution (distutils package) can share the same namespace. 
+Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.
 
-In the first stage of modularization, planned for Sage 9.3, we use this new mechanism to split out all "optional extension modules" (which depend on some optional library) from the `sagelib` distribution to separate pip-installable packages. This will simplify deployment and dependency management.
+To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:
+- `namespace` to mark a directory without `__init__.py` as a namespace package; 
+- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)
+(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)
 
-(The source code remains in the same place in `src/sage` in the git tree; the new pip-installable packages will have separate metadata in `build/pkgs/SPKG`.)
-
-1. To this end, this ticket changes the following packages to namespace packages (by removing `__init__.py`): 
-   - `sage.matrix` (this allows the new distribution `sage-meataxe` introduced in #30151 to add the module `sage.matrix.matrix_gfpn_dense`) to the package)
-   - `sage.libs` (for `.meataxe` - #30151, `.sirocco`, `.coexter3`, `.fes`)
-   - `sage.interfaces` (for `.primecount`)
-   - `sage.graphs` (for `.bliss`, `.mcqd`)
-   - `sage.graphs.graph_decompositions` (for `.tdlib` -> `sage-tdlib`, #29864.)
-   - `sage.numerical.backends`. (This is preparation for later work, in #30152.)
-
-2. Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.
-
-   To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:
-    - `namespace` to mark a directory without `__init__.py` as a namespace package; 
-    - `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)
-
-   (In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)
-
-3. Also the incremental installation mechanisms of sagelib's build system need adjustment. `clean_stale_files`, which deletes installed Python modules in `$SAGE_LIB/sage` = `..../site-packages/sage` that are no longer present in the current version of the source tree, is changed so that it does not delete modules in a namespace package that are provided by a separate distribution (pip-installable package).
-
+In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages.
 
 
 Follow-up tickets:
+- #33011 Remove the `__init__.py` files for packages designated to be namespace packages
 - Wishlist item: Warn or give errors if the `sage_setup: distribution` directives, `namespace` and `nonamespace` files indicate an inconsistent structure such as when it was forgotten to remove `__init__.py`.
 - #30152 will make further changes to the cleaner that will allow out-of-tree namespace packages
 
``````




---

archive/issue_comments_451675.json:
```json
{
    "body": "Changed commit from **[`15813aa`](https://github.com/sagemath/sagetrac-mirror/commit/15813aa5f45d8cecf80ce12bbb1966ece00cace9)** to **[`8648741`](https://github.com/sagemath/sagetrac-mirror/commit/864874173a842a21f1087fab2367f4bec18bd351)**",
    "created_at": "2021-12-11T04:42:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451675",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`15813aa`](https://github.com/sagemath/sagetrac-mirror/commit/15813aa5f45d8cecf80ce12bbb1966ece00cace9)** to **[`8648741`](https://github.com/sagemath/sagetrac-mirror/commit/864874173a842a21f1087fab2367f4bec18bd351)**



---

archive/issue_comments_451676.json:
```json
{
    "body": "<div id=\"comment:105\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a72ee3bf0499608f8fc74d7736d568bca4b9315a\"><code>a72ee3b</code></a></td><td><code>src/sage/all__sagemath_objects.py: Add some more imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3ee49ba9c93a95b17ef252e2842e1709808f66d\"><code>f3ee49b</code></a></td><td><code>src/sage/all__sagemath_objects.py: Add definitions of Integer, RealNumber for doctesting</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a4a32384133408ef05edb4f40b9d363697d3087\"><code>2a4a323</code></a></td><td><code>Merge tag '9.5.beta7' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ef0567f0dcbbe8b7143f1571ae57f693e6a90fd\"><code>9ef0567</code></a></td><td><code>Merge #29039</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0399a10251b2c67642b2be81f9c25634dc0038e\"><code>e0399a1</code></a></td><td><code>pkgs/sagemath-objects: Install a fixed set of scripts, not all of src/bin</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7519048d7af6f8545574e6990e3ca77165f7cee6\"><code>7519048</code></a></td><td><code>src/bin/sage[-env]: Put SAGE_ROOT/src/bin in front of path only if run out of this directory</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00024e6f775ee0f6e50afb9ccf432fbdbcfd6787\"><code>00024e6</code></a></td><td><code>Merge #32933</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfc953b1b4d1049e3dfe052ffc337be8c8d850fa\"><code>bfc953b</code></a></td><td><code>src/sage/doctest/reporting.py: Indicate --environment if not default</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/36d6b097ab164189a244eb8169d2b8efb913972a\"><code>36d6b09</code></a></td><td><code>pkgs/sagemath-categories/setup.cfg.m4: Add scripts</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/864874173a842a21f1087fab2367f4bec18bd351\"><code>8648741</code></a></td><td><code>Merge #29865</code></td></tr></table>\n",
    "created_at": "2021-12-11T04:42:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451676",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:105"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a72ee3bf0499608f8fc74d7736d568bca4b9315a"><code>a72ee3b</code></a></td><td><code>src/sage/all__sagemath_objects.py: Add some more imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3ee49ba9c93a95b17ef252e2842e1709808f66d"><code>f3ee49b</code></a></td><td><code>src/sage/all__sagemath_objects.py: Add definitions of Integer, RealNumber for doctesting</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a4a32384133408ef05edb4f40b9d363697d3087"><code>2a4a323</code></a></td><td><code>Merge tag '9.5.beta7' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ef0567f0dcbbe8b7143f1571ae57f693e6a90fd"><code>9ef0567</code></a></td><td><code>Merge #29039</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0399a10251b2c67642b2be81f9c25634dc0038e"><code>e0399a1</code></a></td><td><code>pkgs/sagemath-objects: Install a fixed set of scripts, not all of src/bin</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7519048d7af6f8545574e6990e3ca77165f7cee6"><code>7519048</code></a></td><td><code>src/bin/sage[-env]: Put SAGE_ROOT/src/bin in front of path only if run out of this directory</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00024e6f775ee0f6e50afb9ccf432fbdbcfd6787"><code>00024e6</code></a></td><td><code>Merge #32933</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfc953b1b4d1049e3dfe052ffc337be8c8d850fa"><code>bfc953b</code></a></td><td><code>src/sage/doctest/reporting.py: Indicate --environment if not default</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/36d6b097ab164189a244eb8169d2b8efb913972a"><code>36d6b09</code></a></td><td><code>pkgs/sagemath-categories/setup.cfg.m4: Add scripts</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/864874173a842a21f1087fab2367f4bec18bd351"><code>8648741</code></a></td><td><code>Merge #29865</code></td></tr></table>




---

archive/issue_comments_451677.json:
```json
{
    "body": "Changed commit from **[`8648741`](https://github.com/sagemath/sagetrac-mirror/commit/864874173a842a21f1087fab2367f4bec18bd351)** to **[`fcfdf1d`](https://github.com/sagemath/sagetrac-mirror/commit/fcfdf1de2b481d149f2d9b17cff862f997132a43)**",
    "created_at": "2021-12-11T05:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451677",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8648741`](https://github.com/sagemath/sagetrac-mirror/commit/864874173a842a21f1087fab2367f4bec18bd351)** to **[`fcfdf1d`](https://github.com/sagemath/sagetrac-mirror/commit/fcfdf1de2b481d149f2d9b17cff862f997132a43)**



---

archive/issue_comments_451678.json:
```json
{
    "body": "<div id=\"comment:106\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcfdf1de2b481d149f2d9b17cff862f997132a43\"><code>fcfdf1d</code></a></td><td><code>Restore __init__.py files for #28925</code></td></tr></table>\n",
    "created_at": "2021-12-11T05:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451678",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:106"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcfdf1de2b481d149f2d9b17cff862f997132a43"><code>fcfdf1d</code></a></td><td><code>Restore __init__.py files for #28925</code></td></tr></table>




---

archive/issue_comments_451679.json:
```json
{
    "body": "Changed commit from **[`fcfdf1d`](https://github.com/sagemath/sagetrac-mirror/commit/fcfdf1de2b481d149f2d9b17cff862f997132a43)** to **[`31b9c16`](https://github.com/sagemath/sagetrac-mirror/commit/31b9c16578aec755cad21567fa9c5812c1d85a53)**",
    "created_at": "2021-12-11T06:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451679",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fcfdf1d`](https://github.com/sagemath/sagetrac-mirror/commit/fcfdf1de2b481d149f2d9b17cff862f997132a43)** to **[`31b9c16`](https://github.com/sagemath/sagetrac-mirror/commit/31b9c16578aec755cad21567fa9c5812c1d85a53)**



---

archive/issue_comments_451680.json:
```json
{
    "body": "<div id=\"comment:107\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31b9c16578aec755cad21567fa9c5812c1d85a53\"><code>31b9c16</code></a></td><td><code>src/sage_setup/command/sage_install.py (sage_clean): Do not fail if dist.py_modules is None</code></td></tr></table>\n",
    "created_at": "2021-12-11T06:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451680",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:107"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31b9c16578aec755cad21567fa9c5812c1d85a53"><code>31b9c16</code></a></td><td><code>src/sage_setup/command/sage_install.py (sage_clean): Do not fail if dist.py_modules is None</code></td></tr></table>




---

archive/issue_comments_451681.json:
```json
{
    "body": "<div id=\"comment:108\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5fd073d1aa41c40fe3c916e3fb07d5881abb7f7\"><code>f5fd073</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Remove __init__.py files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67d78e7c237a996f35508ecef8fe0783d94a6003\"><code>67d78e7</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Remove src/sage/categories/__init__.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4912f15ee4b375dbafa90c687cc34df744f989de\"><code>4912f15</code></a></td><td><code>src/sage/env.py: Get SAGE_LIB via sage.env's __file__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03909ae71dc00824e1e4a67f468b20a0553169d3\"><code>03909ae</code></a></td><td><code>src/sage/env.py (SAGE_LIB): Fix up</code></td></tr></table>\n",
    "created_at": "2021-12-11T06:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451681",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:108"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5fd073d1aa41c40fe3c916e3fb07d5881abb7f7"><code>f5fd073</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Remove __init__.py files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67d78e7c237a996f35508ecef8fe0783d94a6003"><code>67d78e7</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Remove src/sage/categories/__init__.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4912f15ee4b375dbafa90c687cc34df744f989de"><code>4912f15</code></a></td><td><code>src/sage/env.py: Get SAGE_LIB via sage.env's __file__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03909ae71dc00824e1e4a67f468b20a0553169d3"><code>03909ae</code></a></td><td><code>src/sage/env.py (SAGE_LIB): Fix up</code></td></tr></table>




---

archive/issue_comments_451682.json:
```json
{
    "body": "Changed commit from **[`31b9c16`](https://github.com/sagemath/sagetrac-mirror/commit/31b9c16578aec755cad21567fa9c5812c1d85a53)** to **[`03909ae`](https://github.com/sagemath/sagetrac-mirror/commit/03909ae71dc00824e1e4a67f468b20a0553169d3)**",
    "created_at": "2021-12-11T06:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451682",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`31b9c16`](https://github.com/sagemath/sagetrac-mirror/commit/31b9c16578aec755cad21567fa9c5812c1d85a53)** to **[`03909ae`](https://github.com/sagemath/sagetrac-mirror/commit/03909ae71dc00824e1e4a67f468b20a0553169d3)**



---

archive/issue_events_394449.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394449"
}
```



---

archive/issue_events_394450.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394450"
}
```



---

archive/issue_comments_451683.json:
```json
{
    "body": "Changed dependencies from **#32927, #29865** to **#32927, #29865, #33033**",
    "created_at": "2021-12-16T18:49:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451683",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32927, #29865** to **#32927, #29865, #33033**



---

archive/issue_comments_451684.json:
```json
{
    "body": "Changed commit from **[`03909ae`](https://github.com/sagemath/sagetrac-mirror/commit/03909ae71dc00824e1e4a67f468b20a0553169d3)** to **[`c7f8718`](https://github.com/sagemath/sagetrac-mirror/commit/c7f871899760c1d9c750c712a74d667b16c37e02)**",
    "created_at": "2021-12-16T19:52:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451684",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`03909ae`](https://github.com/sagemath/sagetrac-mirror/commit/03909ae71dc00824e1e4a67f468b20a0553169d3)** to **[`c7f8718`](https://github.com/sagemath/sagetrac-mirror/commit/c7f871899760c1d9c750c712a74d667b16c37e02)**



---

archive/issue_comments_451685.json:
```json
{
    "body": "<div id=\"comment:111\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c8c29c0e34452ffffc85483959f4a59146ee0f6\"><code>8c8c29c</code></a></td><td><code>WIP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3f6bcbfbf315cfaf2f1759d1136b2dbe7204487\"><code>c3f6bcb</code></a></td><td><code>src/sage/misc/namespace_package.py (is_package_or_sage_namespace_package_dir): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab23a145ba3961925f6e4b73eb45ea71f3708020\"><code>ab23a14</code></a></td><td><code>src/sage/doctest/sources.py: Use is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f05856b4efadc29ae22b4d7ae2ad604413a7afe\"><code>0f05856</code></a></td><td><code>src/sage/doctest/sources.py: Remove unnecessary conversion to bool</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8aa37c1998193670f894f1d54aac65663761ea4\"><code>d8aa37c</code></a></td><td><code>src/sage/misc/namespace_package.py: In doctests, use 'directory' instead of the single-letter variable name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2cf8d8dd40919429b6e1e25ac375f5dcf1e3b672\"><code>2cf8d8d</code></a></td><td><code>Merge #33033</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7f871899760c1d9c750c712a74d667b16c37e02\"><code>c7f8718</code></a></td><td><code>src/sage_setup/find.py: Use is_package_or_sage_namespace_package_dir</code></td></tr></table>\n",
    "created_at": "2021-12-16T19:52:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451685",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:111"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c8c29c0e34452ffffc85483959f4a59146ee0f6"><code>8c8c29c</code></a></td><td><code>WIP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3f6bcbfbf315cfaf2f1759d1136b2dbe7204487"><code>c3f6bcb</code></a></td><td><code>src/sage/misc/namespace_package.py (is_package_or_sage_namespace_package_dir): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab23a145ba3961925f6e4b73eb45ea71f3708020"><code>ab23a14</code></a></td><td><code>src/sage/doctest/sources.py: Use is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f05856b4efadc29ae22b4d7ae2ad604413a7afe"><code>0f05856</code></a></td><td><code>src/sage/doctest/sources.py: Remove unnecessary conversion to bool</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8aa37c1998193670f894f1d54aac65663761ea4"><code>d8aa37c</code></a></td><td><code>src/sage/misc/namespace_package.py: In doctests, use 'directory' instead of the single-letter variable name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2cf8d8dd40919429b6e1e25ac375f5dcf1e3b672"><code>2cf8d8d</code></a></td><td><code>Merge #33033</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7f871899760c1d9c750c712a74d667b16c37e02"><code>c7f8718</code></a></td><td><code>src/sage_setup/find.py: Use is_package_or_sage_namespace_package_dir</code></td></tr></table>




---

archive/issue_comments_451686.json:
```json
{
    "body": "<div id=\"comment:112\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3764bc2c73149b9a369027fc0c001f8243918f9\"><code>f3764bc</code></a></td><td><code>src/sage_setup/find.py: Get rid of use of 'nonamespace' files</code></td></tr></table>\n",
    "created_at": "2021-12-16T21:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451686",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:112"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3764bc2c73149b9a369027fc0c001f8243918f9"><code>f3764bc</code></a></td><td><code>src/sage_setup/find.py: Get rid of use of 'nonamespace' files</code></td></tr></table>




---

archive/issue_comments_451687.json:
```json
{
    "body": "Changed commit from **[`c7f8718`](https://github.com/sagemath/sagetrac-mirror/commit/c7f871899760c1d9c750c712a74d667b16c37e02)** to **[`f3764bc`](https://github.com/sagemath/sagetrac-mirror/commit/f3764bc2c73149b9a369027fc0c001f8243918f9)**",
    "created_at": "2021-12-16T21:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451687",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c7f8718`](https://github.com/sagemath/sagetrac-mirror/commit/c7f871899760c1d9c750c712a74d667b16c37e02)** to **[`f3764bc`](https://github.com/sagemath/sagetrac-mirror/commit/f3764bc2c73149b9a369027fc0c001f8243918f9)**



---

archive/issue_comments_451688.json:
```json
{
    "body": "<div id=\"comment:113\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19e93f0f60f5d5e900d04561a187be82318921bb\"><code>19e93f0</code></a></td><td><code>is_package_or_sage_namespace_package_dir: Make directories with __init__.pxd package directories</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e520abbe95063d046d61092d6386319d1b3d1d11\"><code>e520abb</code></a></td><td><code>Merge #33033</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6089ae892c72a41033524c137a6e6cecc853b4b6\"><code>6089ae8</code></a></td><td><code>src/sage_setup/find.py: Add doctest result</code></td></tr></table>\n",
    "created_at": "2021-12-16T22:04:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451688",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:113"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19e93f0f60f5d5e900d04561a187be82318921bb"><code>19e93f0</code></a></td><td><code>is_package_or_sage_namespace_package_dir: Make directories with __init__.pxd package directories</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e520abbe95063d046d61092d6386319d1b3d1d11"><code>e520abb</code></a></td><td><code>Merge #33033</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6089ae892c72a41033524c137a6e6cecc853b4b6"><code>6089ae8</code></a></td><td><code>src/sage_setup/find.py: Add doctest result</code></td></tr></table>




---

archive/issue_comments_451689.json:
```json
{
    "body": "Changed commit from **[`f3764bc`](https://github.com/sagemath/sagetrac-mirror/commit/f3764bc2c73149b9a369027fc0c001f8243918f9)** to **[`6089ae8`](https://github.com/sagemath/sagetrac-mirror/commit/6089ae892c72a41033524c137a6e6cecc853b4b6)**",
    "created_at": "2021-12-16T22:04:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451689",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f3764bc`](https://github.com/sagemath/sagetrac-mirror/commit/f3764bc2c73149b9a369027fc0c001f8243918f9)** to **[`6089ae8`](https://github.com/sagemath/sagetrac-mirror/commit/6089ae892c72a41033524c137a6e6cecc853b4b6)**



---

archive/issue_comments_451690.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,14 @@\n This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.\n \n Ordinary packages (directories of modules) can be turned into namespace packages by removing the empty `__init__.py` file.\n-Then a different distribution package can share the same namespace. \n+Then several distribution package can share the same namespace. \n \n Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.\n \n-To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:\n-- `namespace` to mark a directory without `__init__.py` as a namespace package; \n-- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)\n-(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)\n+Per convention in the Sage library, namespace packages are recognized by the presence of `all.py` or `all__*.py` files (#33033).\n \n-In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages.\n+In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, \n+in which `__init__.py` are removed from the `MANIFEST.in` files.\n \n \n Follow-up tickets:\n``````\n",
    "created_at": "2021-12-16T22:08:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451690",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,14 @@
 This ticket prepares the modularization of sagelib into separate distributions (pip-installable packages) by adding support for [native namespace packages](https://packaging.python.org/guides/packaging-namespace-packages/) (PEP 420) to sagelib's build system.
 
 Ordinary packages (directories of modules) can be turned into namespace packages by removing the empty `__init__.py` file.
-Then a different distribution package can share the same namespace. 
+Then several distribution package can share the same namespace. 
 
 Because our source discovery mechanism in sagelib's build system (`setup.py` + `sage_setup`) distinguishes package directories from other directories containing data files by the presence of the `__init__.py` file, the present ticket makes several adjustments to the build system - in particular to the functions `find_python_sources` and `find_extra_files`.
 
-To simplify the implementation and to allow for self-documentation of the directory structure, we introduce `sage_setup`-specific files named:
-- `namespace` to mark a directory without `__init__.py` as a namespace package; 
-- `nonamespace` to mark a directory as a data directory. (This is in analogy with the `nodoctest` files that control the Sage doctester.)
-(In the branch of this ticket, these are empty files; but they could contain comments that explain the purpose of a particular directory.)
+Per convention in the Sage library, namespace packages are recognized by the presence of `all.py` or `all__*.py` files (#33033).
 
-In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages.
+In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, 
+in which `__init__.py` are removed from the `MANIFEST.in` files.
 
 
 Follow-up tickets:
``````




---

archive/issue_comments_451691.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">comment:115</div>\n\nReplying to [@mkoeppe](#comment:89):\n> Replying to [@tobiasdiez](#comment:87):\n> > Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.\n\n> \n> Thanks for the input and the pointer to PEP 382.\n> I'll try out if your suggestion can be implemented without major changes.\n\nDone now via #33033.",
    "created_at": "2021-12-16T22:09:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451691",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:115" align="right">comment:115</div>

Replying to [@mkoeppe](#comment:89):
> Replying to [@tobiasdiez](#comment:87):
> > Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.

> 
> Thanks for the input and the pointer to PEP 382.
> I'll try out if your suggestion can be implemented without major changes.

Done now via #33033.



---

archive/issue_comments_451692.json:
```json
{
    "body": "Changed work issues from **comment 90** to none",
    "created_at": "2021-12-16T22:10:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451692",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **comment 90** to none



---

archive/issue_events_394451.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-16T23:46:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394451"
}
```



---

archive/issue_events_394452.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-16T23:46:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394452"
}
```



---

archive/issue_comments_451693.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,6 +10,13 @@\n In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, \n in which `__init__.py` are removed from the `MANIFEST.in` files.\n \n+To test these two distributions:\n+\n+```\n+./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-objects && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'\n+\n+./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-categories && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'\n+```\n \n Follow-up tickets:\n - #33011 Remove the `__init__.py` files for packages designated to be namespace packages\n``````\n",
    "created_at": "2021-12-16T23:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451693",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,6 +10,13 @@
 In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, 
 in which `__init__.py` are removed from the `MANIFEST.in` files.
 
+To test these two distributions:
+
+```
+./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-objects && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'
+
+./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-categories && SAGE_NUM_THREADS=16 tox -r -v -v -v -e py39)'
+```
 
 Follow-up tickets:
 - #33011 Remove the `__init__.py` files for packages designated to be namespace packages
``````




---

archive/issue_comments_451694.json:
```json
{
    "body": "<div id=\"comment:118\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c80dd4231bb889f4082312710805153e119b0d38\"><code>c80dd42</code></a></td><td><code>src/sage/{arith,ext,libs,rings,sets}/all__sagemath_objects.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d01d881d57c4f73e1a5db5421fce07630fb96c55\"><code>d01d881</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Exclude generated files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37a957915d1bac88f011cd185f400b9483a455b6\"><code>37a9579</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Exclude generated files</code></td></tr></table>\n",
    "created_at": "2021-12-16T23:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451694",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:118"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c80dd4231bb889f4082312710805153e119b0d38"><code>c80dd42</code></a></td><td><code>src/sage/{arith,ext,libs,rings,sets}/all__sagemath_objects.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d01d881d57c4f73e1a5db5421fce07630fb96c55"><code>d01d881</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Exclude generated files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37a957915d1bac88f011cd185f400b9483a455b6"><code>37a9579</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Exclude generated files</code></td></tr></table>




---

archive/issue_comments_451695.json:
```json
{
    "body": "Changed commit from **[`6089ae8`](https://github.com/sagemath/sagetrac-mirror/commit/6089ae892c72a41033524c137a6e6cecc853b4b6)** to **[`37a9579`](https://github.com/sagemath/sagetrac-mirror/commit/37a957915d1bac88f011cd185f400b9483a455b6)**",
    "created_at": "2021-12-16T23:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451695",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6089ae8`](https://github.com/sagemath/sagetrac-mirror/commit/6089ae892c72a41033524c137a6e6cecc853b4b6)** to **[`37a9579`](https://github.com/sagemath/sagetrac-mirror/commit/37a957915d1bac88f011cd185f400b9483a455b6)**



---

archive/issue_comments_451696.json:
```json
{
    "body": "Changed commit from **[`37a9579`](https://github.com/sagemath/sagetrac-mirror/commit/37a957915d1bac88f011cd185f400b9483a455b6)** to **[`2f6d473`](https://github.com/sagemath/sagetrac-mirror/commit/2f6d47334df875115f6d65611b83a00af21314d5)**",
    "created_at": "2021-12-17T00:03:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451696",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`37a9579`](https://github.com/sagemath/sagetrac-mirror/commit/37a957915d1bac88f011cd185f400b9483a455b6)** to **[`2f6d473`](https://github.com/sagemath/sagetrac-mirror/commit/2f6d47334df875115f6d65611b83a00af21314d5)**



---

archive/issue_comments_451697.json:
```json
{
    "body": "<div id=\"comment:119\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55e258dec6d26190d5b79d419756e786a08450b3\"><code>55e258d</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Remove src/sage/categories/__init__.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07ffddbad22fba076043e8113523d66dc2806e0a\"><code>07ffddb</code></a></td><td><code>src/sage/env.py: Get SAGE_LIB via sage.env's __file__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/320f2e0a6a2a67ae6e62fb4d91ad10719d4a97b1\"><code>320f2e0</code></a></td><td><code>src/sage/env.py (SAGE_LIB): Fix up</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85ef02e4754a31bd328eac91f62ef7a4356d2b68\"><code>85ef02e</code></a></td><td><code>WIP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95a7205f102853968a9392dd3bf65ebbdc692500\"><code>95a7205</code></a></td><td><code>src/sage_setup/find.py: Use is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ab1bd7bef1a6ab3f35f1252f19c2f4ff8e3858d\"><code>6ab1bd7</code></a></td><td><code>src/sage_setup/find.py: Get rid of use of 'nonamespace' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b3360503e97450646fa30760fbbe31bcb3b8a82\"><code>0b33605</code></a></td><td><code>src/sage_setup/find.py: Add doctest result</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e995dd6ff25613230fb2e617011f98c77a9ca3f\"><code>2e995dd</code></a></td><td><code>src/sage/{arith,ext,libs,rings,sets}/all__sagemath_objects.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f244b570b8d70fda82d7459336f8d75bcb919690\"><code>f244b57</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Exclude generated files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f6d47334df875115f6d65611b83a00af21314d5\"><code>2f6d473</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Exclude generated files</code></td></tr></table>\n",
    "created_at": "2021-12-17T00:03:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451697",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:119"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55e258dec6d26190d5b79d419756e786a08450b3"><code>55e258d</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Remove src/sage/categories/__init__.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07ffddbad22fba076043e8113523d66dc2806e0a"><code>07ffddb</code></a></td><td><code>src/sage/env.py: Get SAGE_LIB via sage.env's __file__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/320f2e0a6a2a67ae6e62fb4d91ad10719d4a97b1"><code>320f2e0</code></a></td><td><code>src/sage/env.py (SAGE_LIB): Fix up</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85ef02e4754a31bd328eac91f62ef7a4356d2b68"><code>85ef02e</code></a></td><td><code>WIP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95a7205f102853968a9392dd3bf65ebbdc692500"><code>95a7205</code></a></td><td><code>src/sage_setup/find.py: Use is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ab1bd7bef1a6ab3f35f1252f19c2f4ff8e3858d"><code>6ab1bd7</code></a></td><td><code>src/sage_setup/find.py: Get rid of use of 'nonamespace' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b3360503e97450646fa30760fbbe31bcb3b8a82"><code>0b33605</code></a></td><td><code>src/sage_setup/find.py: Add doctest result</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e995dd6ff25613230fb2e617011f98c77a9ca3f"><code>2e995dd</code></a></td><td><code>src/sage/{arith,ext,libs,rings,sets}/all__sagemath_objects.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f244b570b8d70fda82d7459336f8d75bcb919690"><code>f244b57</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Exclude generated files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f6d47334df875115f6d65611b83a00af21314d5"><code>2f6d473</code></a></td><td><code>pkgs/sagemath-categories/MANIFEST.in.m4: Exclude generated files</code></td></tr></table>




---

archive/issue_comments_451698.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,6 +9,8 @@\n \n In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, \n in which `__init__.py` are removed from the `MANIFEST.in` files.\n+\n+Because the actual files are not removed from the source tree, the normal build of the Sage distribution is not affected.\n \n To test these two distributions:\n \n``````\n",
    "created_at": "2021-12-17T00:04:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451698",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,6 +9,8 @@
 
 In this ticket, we apply it to turn **sagemath-objects** and **sagemath-categories** (from #29865) into namespace packages, 
 in which `__init__.py` are removed from the `MANIFEST.in` files.
+
+Because the actual files are not removed from the source tree, the normal build of the Sage distribution is not affected.
 
 To test these two distributions:
 
``````




---

archive/issue_comments_451699.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nRebased away from #32927.",
    "created_at": "2021-12-17T00:04:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451699",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:120" align="right">comment:120</div>

Rebased away from #32927.



---

archive/issue_comments_451700.json:
```json
{
    "body": "Changed dependencies from **#32927, #29865, #33033** to **#29865, #33033**",
    "created_at": "2021-12-17T00:04:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451700",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32927, #29865, #33033** to **#29865, #33033**



---

archive/issue_comments_451701.json:
```json
{
    "body": "<div id=\"comment:121\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf7371f1c340eabda3e133aca60e9c1da47c6ea0\"><code>cf7371f</code></a></td><td><code>src/sage_setup/find.py: Update import of is_package_or_namespace_package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5808f3d6b4241590adbc95925aa84c50535d9e65\"><code>5808f3d</code></a></td><td><code>src/sage/misc/package_dir.py: New file for is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5addb34e5dc66d461a757df1f9620dbe5184230\"><code>f5addb3</code></a></td><td><code>Merge #33033</code></td></tr></table>\n",
    "created_at": "2021-12-17T06:16:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451701",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:121"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf7371f1c340eabda3e133aca60e9c1da47c6ea0"><code>cf7371f</code></a></td><td><code>src/sage_setup/find.py: Update import of is_package_or_namespace_package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5808f3d6b4241590adbc95925aa84c50535d9e65"><code>5808f3d</code></a></td><td><code>src/sage/misc/package_dir.py: New file for is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5addb34e5dc66d461a757df1f9620dbe5184230"><code>f5addb3</code></a></td><td><code>Merge #33033</code></td></tr></table>




---

archive/issue_comments_451702.json:
```json
{
    "body": "Changed commit from **[`2f6d473`](https://github.com/sagemath/sagetrac-mirror/commit/2f6d47334df875115f6d65611b83a00af21314d5)** to **[`f5addb3`](https://github.com/sagemath/sagetrac-mirror/commit/f5addb34e5dc66d461a757df1f9620dbe5184230)**",
    "created_at": "2021-12-17T06:16:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451702",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2f6d473`](https://github.com/sagemath/sagetrac-mirror/commit/2f6d47334df875115f6d65611b83a00af21314d5)** to **[`f5addb3`](https://github.com/sagemath/sagetrac-mirror/commit/f5addb34e5dc66d461a757df1f9620dbe5184230)**



---

archive/issue_comments_451703.json:
```json
{
    "body": "<div id=\"comment:122\" align=\"right\">comment:122</div>\n\nReplying to [@mkoeppe](#comment:115):\n> Replying to [@mkoeppe](#comment:89):\n> > Replying to [@tobiasdiez](#comment:87):\n> > > Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.\n\n> > \n> > Thanks for the input and the pointer to PEP 382.\n> > I'll try out if your suggestion can be implemented without major changes.\n\n> \n> Done now via #33033.\n\nProbably I'm missing something here. The new mechanism seems to still rely on indicator/marker files, just that the are now named `all__`. Except for the different name this seems to be exactly the approach of the rejected PEP 382.\nThe point of my proposal was that only the setup file should know/decide on which packages it want to include and exclude. Then the general helper in #33033 would like\n\n```\nis_namespace_package(dir):\n   return dir in setuptools.find_namespace_packages(include=..., exclude=...)\n```\nAnd the setup.cfg would use https://setuptools.pypa.io/en/latest/userguide/package_discovery.html.",
    "created_at": "2021-12-17T12:45:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451703",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:122" align="right">comment:122</div>

Replying to [@mkoeppe](#comment:115):
> Replying to [@mkoeppe](#comment:89):
> > Replying to [@tobiasdiez](#comment:87):
> > > Concerning the package discovery, I would still prefer using `setuptools.find_namespace_packages()`, and then filter out unwanted folders based on a hard-coded list. The `(no)namespace` files just add complexity (especially for new developers). They are also very similar to the explicit declaration of namespace packages proposed by [PEP 382](https://www.python.org/dev/peps/pep-0382/), which was rejected in favor of PEP 420.

> > 
> > Thanks for the input and the pointer to PEP 382.
> > I'll try out if your suggestion can be implemented without major changes.

> 
> Done now via #33033.

Probably I'm missing something here. The new mechanism seems to still rely on indicator/marker files, just that the are now named `all__`. Except for the different name this seems to be exactly the approach of the rejected PEP 382.
The point of my proposal was that only the setup file should know/decide on which packages it want to include and exclude. Then the general helper in #33033 would like

```
is_namespace_package(dir):
   return dir in setuptools.find_namespace_packages(include=..., exclude=...)
```
And the setup.cfg would use https://setuptools.pypa.io/en/latest/userguide/package_discovery.html.



---

archive/issue_comments_451704.json:
```json
{
    "body": "<div id=\"comment:123\" align=\"right\">comment:123</div>\n\nReplying to [@tobiasdiez](#comment:122):\n> The new mechanism seems to still rely on indicator/marker files, just that the are now named `all__`. Except for the different name this seems to be exactly the approach of the rejected PEP 382.\n\nThat's certainly true, but at least the Sage source tree already has these files",
    "created_at": "2021-12-17T16:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451704",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:123" align="right">comment:123</div>

Replying to [@tobiasdiez](#comment:122):
> The new mechanism seems to still rely on indicator/marker files, just that the are now named `all__`. Except for the different name this seems to be exactly the approach of the rejected PEP 382.

That's certainly true, but at least the Sage source tree already has these files



---

archive/issue_comments_451705.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">comment:124</div>\n\nReplying to [@tobiasdiez](#comment:122):\n> The point of my proposal was that only the setup file should know/decide on which packages it want to include and exclude. Then the general helper in #33033 would like\n> \n> ```\n> is_namespace_package(dir):\n>    return dir in setuptools.find_namespace_packages(include=..., exclude=...)\n> ```\n\nThe helper function is added in #33033 for runtime use (doctesting). Doctesting needs to be able to work on (a) Sage source trees, (b) installed Sage packages (this is important, for example, for the downstream packagers), (c) arbitrary files. \nHardcoding inclusions and exclusions in the helper function seems a bit unmodular",
    "created_at": "2021-12-17T16:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451705",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:124" align="right">comment:124</div>

Replying to [@tobiasdiez](#comment:122):
> The point of my proposal was that only the setup file should know/decide on which packages it want to include and exclude. Then the general helper in #33033 would like
> 
> ```
> is_namespace_package(dir):
>    return dir in setuptools.find_namespace_packages(include=..., exclude=...)
> ```

The helper function is added in #33033 for runtime use (doctesting). Doctesting needs to be able to work on (a) Sage source trees, (b) installed Sage packages (this is important, for example, for the downstream packagers), (c) arbitrary files. 
Hardcoding inclusions and exclusions in the helper function seems a bit unmodular



---

archive/issue_comments_451706.json:
```json
{
    "body": "<div id=\"comment:125\" align=\"right\">comment:125</div>\n\nIn the end it comes down to who should have the control:\n- Should the doctest code decide what to test, and the setup.py/cfg file what to distribute and the sage startup script what to expose\n- or should the module/package be responsible to declare that it should be tested, distributed and exposed\n\nCurrently, this ticket (and the related ones) go in the direction of the second approach by using `all.py`. For me, using inversion of control and following the first approach seems more natural and flexible. Since you have a better overview though, I trust your judgement.",
    "created_at": "2021-12-17T17:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451706",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:125" align="right">comment:125</div>

In the end it comes down to who should have the control:
- Should the doctest code decide what to test, and the setup.py/cfg file what to distribute and the sage startup script what to expose
- or should the module/package be responsible to declare that it should be tested, distributed and exposed

Currently, this ticket (and the related ones) go in the direction of the second approach by using `all.py`. For me, using inversion of control and following the first approach seems more natural and flexible. Since you have a better overview though, I trust your judgement.



---

archive/issue_comments_451707.json:
```json
{
    "body": "Changed commit from **[`f5addb3`](https://github.com/sagemath/sagetrac-mirror/commit/f5addb34e5dc66d461a757df1f9620dbe5184230)** to **[`178d111`](https://github.com/sagemath/sagetrac-mirror/commit/178d111960e751d5d34bf3097ddd39c65f24c42d)**",
    "created_at": "2022-01-23T06:24:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451707",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f5addb3`](https://github.com/sagemath/sagetrac-mirror/commit/f5addb34e5dc66d461a757df1f9620dbe5184230)** to **[`178d111`](https://github.com/sagemath/sagetrac-mirror/commit/178d111960e751d5d34bf3097ddd39c65f24c42d)**



---

archive/issue_comments_451708.json:
```json
{
    "body": "<div id=\"comment:126\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3939af73870a71c320cb21bd91de9b9f7ba14a5d\"><code>3939af7</code></a></td><td><code>Merge tag '9.5.rc3' into t/33033/prepare_sage_doctest_for_namespace_packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/178d111960e751d5d34bf3097ddd39c65f24c42d\"><code>178d111</code></a></td><td><code>Merge #33033</code></td></tr></table>\n",
    "created_at": "2022-01-23T06:24:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451708",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:126"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3939af73870a71c320cb21bd91de9b9f7ba14a5d"><code>3939af7</code></a></td><td><code>Merge tag '9.5.rc3' into t/33033/prepare_sage_doctest_for_namespace_packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/178d111960e751d5d34bf3097ddd39c65f24c42d"><code>178d111</code></a></td><td><code>Merge #33033</code></td></tr></table>




---

archive/issue_comments_451709.json:
```json
{
    "body": "Changed dependencies from **#29865, #33033** to none",
    "created_at": "2022-02-14T03:33:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451709",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29865, #33033** to none



---

archive/issue_comments_451710.json:
```json
{
    "body": "Changed commit from **[`178d111`](https://github.com/sagemath/sagetrac-mirror/commit/178d111960e751d5d34bf3097ddd39c65f24c42d)** to **[`5c873e0`](https://github.com/sagemath/sagetrac-mirror/commit/5c873e0611693ecf766945a76ea7e60af0507636)**",
    "created_at": "2022-02-14T03:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451710",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`178d111`](https://github.com/sagemath/sagetrac-mirror/commit/178d111960e751d5d34bf3097ddd39c65f24c42d)** to **[`5c873e0`](https://github.com/sagemath/sagetrac-mirror/commit/5c873e0611693ecf766945a76ea7e60af0507636)**



---

archive/issue_comments_451711.json:
```json
{
    "body": "<div id=\"comment:128\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c873e0611693ecf766945a76ea7e60af0507636\"><code>5c873e0</code></a></td><td><code>Merge tag '9.6.beta1' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-02-14T03:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451711",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:128"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c873e0611693ecf766945a76ea7e60af0507636"><code>5c873e0</code></a></td><td><code>Merge tag '9.6.beta1' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451712.json:
```json
{
    "body": "<div id=\"comment:129\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37b329948b00172eaf702500bf11b04bbfc965b9\"><code>37b3299</code></a></td><td><code>pkgs/sagemath-{objects,categories}/setup.cfg.m4: Update python_requires</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5546c6358845073440ea2b92a7e6b8f1cfc8c76b\"><code>5546c63</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add sage.misc.package_dir</code></td></tr></table>\n",
    "created_at": "2022-02-14T04:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451712",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:129"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37b329948b00172eaf702500bf11b04bbfc965b9"><code>37b3299</code></a></td><td><code>pkgs/sagemath-{objects,categories}/setup.cfg.m4: Update python_requires</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5546c6358845073440ea2b92a7e6b8f1cfc8c76b"><code>5546c63</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add sage.misc.package_dir</code></td></tr></table>




---

archive/issue_comments_451713.json:
```json
{
    "body": "Changed commit from **[`5c873e0`](https://github.com/sagemath/sagetrac-mirror/commit/5c873e0611693ecf766945a76ea7e60af0507636)** to **[`5546c63`](https://github.com/sagemath/sagetrac-mirror/commit/5546c6358845073440ea2b92a7e6b8f1cfc8c76b)**",
    "created_at": "2022-02-14T04:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451713",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5c873e0`](https://github.com/sagemath/sagetrac-mirror/commit/5c873e0611693ecf766945a76ea7e60af0507636)** to **[`5546c63`](https://github.com/sagemath/sagetrac-mirror/commit/5546c6358845073440ea2b92a7e6b8f1cfc8c76b)**



---

archive/issue_comments_451714.json:
```json
{
    "body": "<div id=\"comment:130\" align=\"right\">comment:130</div>\n\nAll dependencies are merged",
    "created_at": "2022-02-14T04:47:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451714",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:130" align="right">comment:130</div>

All dependencies are merged



---

archive/issue_comments_451715.json:
```json
{
    "body": "<div id=\"comment:131\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f961a7d372809b232620c0224928e8341a09e99a\"><code>f961a7d</code></a></td><td><code>src/setup.py: Support namespace packages in Cython 0.x</code></td></tr></table>\n",
    "created_at": "2022-02-14T06:55:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451715",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:131"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f961a7d372809b232620c0224928e8341a09e99a"><code>f961a7d</code></a></td><td><code>src/setup.py: Support namespace packages in Cython 0.x</code></td></tr></table>




---

archive/issue_comments_451716.json:
```json
{
    "body": "Changed commit from **[`5546c63`](https://github.com/sagemath/sagetrac-mirror/commit/5546c6358845073440ea2b92a7e6b8f1cfc8c76b)** to **[`f961a7d`](https://github.com/sagemath/sagetrac-mirror/commit/f961a7d372809b232620c0224928e8341a09e99a)**",
    "created_at": "2022-02-14T06:55:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451716",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5546c63`](https://github.com/sagemath/sagetrac-mirror/commit/5546c6358845073440ea2b92a7e6b8f1cfc8c76b)** to **[`f961a7d`](https://github.com/sagemath/sagetrac-mirror/commit/f961a7d372809b232620c0224928e8341a09e99a)**



---

archive/issue_events_394453.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-22T02:02:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394453"
}
```



---

archive/issue_events_394454.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-22T02:02:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394454"
}
```



---

archive/issue_comments_451717.json:
```json
{
    "body": "<div id=\"comment:133\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2b529398016451fbf4766ecc2df3829a0efc1bb\"><code>d2b5293</code></a></td><td><code>Merge tag '9.6.beta5' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-03-13T17:46:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451717",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:133"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2b529398016451fbf4766ecc2df3829a0efc1bb"><code>d2b5293</code></a></td><td><code>Merge tag '9.6.beta5' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451718.json:
```json
{
    "body": "Changed commit from **[`f961a7d`](https://github.com/sagemath/sagetrac-mirror/commit/f961a7d372809b232620c0224928e8341a09e99a)** to **[`d2b5293`](https://github.com/sagemath/sagetrac-mirror/commit/d2b529398016451fbf4766ecc2df3829a0efc1bb)**",
    "created_at": "2022-03-13T17:46:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451718",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f961a7d`](https://github.com/sagemath/sagetrac-mirror/commit/f961a7d372809b232620c0224928e8341a09e99a)** to **[`d2b5293`](https://github.com/sagemath/sagetrac-mirror/commit/d2b529398016451fbf4766ecc2df3829a0efc1bb)**



---

archive/issue_comments_451719.json:
```json
{
    "body": "<div id=\"comment:134\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aac736c54ecd074b3d653f9c658e9fb9f29fd011\"><code>aac736c</code></a></td><td><code>build/pkgs/sage_setup/dependencies: Add all sage_setup source files</code></td></tr></table>\n",
    "created_at": "2022-03-13T18:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451719",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:134"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aac736c54ecd074b3d653f9c658e9fb9f29fd011"><code>aac736c</code></a></td><td><code>build/pkgs/sage_setup/dependencies: Add all sage_setup source files</code></td></tr></table>




---

archive/issue_comments_451720.json:
```json
{
    "body": "Changed commit from **[`d2b5293`](https://github.com/sagemath/sagetrac-mirror/commit/d2b529398016451fbf4766ecc2df3829a0efc1bb)** to **[`aac736c`](https://github.com/sagemath/sagetrac-mirror/commit/aac736c54ecd074b3d653f9c658e9fb9f29fd011)**",
    "created_at": "2022-03-13T18:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451720",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d2b5293`](https://github.com/sagemath/sagetrac-mirror/commit/d2b529398016451fbf4766ecc2df3829a0efc1bb)** to **[`aac736c`](https://github.com/sagemath/sagetrac-mirror/commit/aac736c54ecd074b3d653f9c658e9fb9f29fd011)**



---

archive/issue_events_394455.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394455"
}
```



---

archive/issue_events_394456.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394456"
}
```



---

archive/issue_comments_451721.json:
```json
{
    "body": "Changed commit from **[`aac736c`](https://github.com/sagemath/sagetrac-mirror/commit/aac736c54ecd074b3d653f9c658e9fb9f29fd011)** to **[`6258b79`](https://github.com/sagemath/sagetrac-mirror/commit/6258b79f1a3aa980bbc73d3257b404b320f133ec)**",
    "created_at": "2022-04-29T16:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451721",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`aac736c`](https://github.com/sagemath/sagetrac-mirror/commit/aac736c54ecd074b3d653f9c658e9fb9f29fd011)** to **[`6258b79`](https://github.com/sagemath/sagetrac-mirror/commit/6258b79f1a3aa980bbc73d3257b404b320f133ec)**



---

archive/issue_comments_451722.json:
```json
{
    "body": "<div id=\"comment:136\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6258b79f1a3aa980bbc73d3257b404b320f133ec\"><code>6258b79</code></a></td><td><code>Merge tag '9.6.rc2' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-04-29T16:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451722",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:136"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6258b79f1a3aa980bbc73d3257b404b320f133ec"><code>6258b79</code></a></td><td><code>Merge tag '9.6.rc2' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451723.json:
```json
{
    "body": "Dependencies: **#33803**",
    "created_at": "2022-05-05T17:34:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451723",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#33803**



---

archive/issue_comments_451724.json:
```json
{
    "body": "<div id=\"comment:138\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37f5cb5aa3fd6b5c72dc4b39cc516267b22064f9\"><code>37f5cb5</code></a></td><td><code>.github/workflows/sdist.yml: Build wheels too</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b273985fc06aca6d0424d9a3cde4219fe268af17\"><code>b273985</code></a></td><td><code>sage.env.cython_aliases: Handle ecl via default_required_modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ac30fd9ad7f787b0a1b1ae57cb9f8a25c59dec4\"><code>6ac30fd</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add missing sage.misc.package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/762dd7065e1a49300c5d9ead64909251e00c4d35\"><code>762dd70</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add sage.misc.sagedoc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33a15400bacc608f0a3ea6b5d111b8c2f8a96531\"><code>33a1540</code></a></td><td><code>pkgs/sagemath-{objects,categories}/README.rst: Mention dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8a98b13d16e29812321562983a34b7edb97973b\"><code>e8a98b1</code></a></td><td><code>Merge #33803</code></td></tr></table>\n",
    "created_at": "2022-05-05T17:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451724",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:138"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37f5cb5aa3fd6b5c72dc4b39cc516267b22064f9"><code>37f5cb5</code></a></td><td><code>.github/workflows/sdist.yml: Build wheels too</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b273985fc06aca6d0424d9a3cde4219fe268af17"><code>b273985</code></a></td><td><code>sage.env.cython_aliases: Handle ecl via default_required_modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ac30fd9ad7f787b0a1b1ae57cb9f8a25c59dec4"><code>6ac30fd</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add missing sage.misc.package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/762dd7065e1a49300c5d9ead64909251e00c4d35"><code>762dd70</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add sage.misc.sagedoc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33a15400bacc608f0a3ea6b5d111b8c2f8a96531"><code>33a1540</code></a></td><td><code>pkgs/sagemath-{objects,categories}/README.rst: Mention dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8a98b13d16e29812321562983a34b7edb97973b"><code>e8a98b1</code></a></td><td><code>Merge #33803</code></td></tr></table>




---

archive/issue_comments_451725.json:
```json
{
    "body": "Changed commit from **[`6258b79`](https://github.com/sagemath/sagetrac-mirror/commit/6258b79f1a3aa980bbc73d3257b404b320f133ec)** to **[`e8a98b1`](https://github.com/sagemath/sagetrac-mirror/commit/e8a98b13d16e29812321562983a34b7edb97973b)**",
    "created_at": "2022-05-05T17:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451725",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6258b79`](https://github.com/sagemath/sagetrac-mirror/commit/6258b79f1a3aa980bbc73d3257b404b320f133ec)** to **[`e8a98b1`](https://github.com/sagemath/sagetrac-mirror/commit/e8a98b13d16e29812321562983a34b7edb97973b)**



---

archive/issue_comments_451726.json:
```json
{
    "body": "Changed commit from **[`e8a98b1`](https://github.com/sagemath/sagetrac-mirror/commit/e8a98b13d16e29812321562983a34b7edb97973b)** to **[`06eec85`](https://github.com/sagemath/sagetrac-mirror/commit/06eec85b4f5fe564d56e3317ef9c22425903cc6e)**",
    "created_at": "2022-05-05T17:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451726",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e8a98b1`](https://github.com/sagemath/sagetrac-mirror/commit/e8a98b13d16e29812321562983a34b7edb97973b)** to **[`06eec85`](https://github.com/sagemath/sagetrac-mirror/commit/06eec85b4f5fe564d56e3317ef9c22425903cc6e)**



---

archive/issue_comments_451727.json:
```json
{
    "body": "<div id=\"comment:139\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32c831c47caf5e862e29919e955067268678dfb0\"><code>32c831c</code></a></td><td><code>sage.env.cython_aliases: Handle ecl via default_required_modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d75ff7421f3b2b46d4885984eff037abbe1f807\"><code>4d75ff7</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add missing sage.misc.package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/078d72d63584293339594a5a65bb27f118251a98\"><code>078d72d</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add sage.misc.sagedoc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4da43c52a03b932b9561337b311391746df022ce\"><code>4da43c5</code></a></td><td><code>pkgs/sagemath-{objects,categories}/README.rst: Mention dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06eec85b4f5fe564d56e3317ef9c22425903cc6e\"><code>06eec85</code></a></td><td><code>Merge #33803</code></td></tr></table>\n",
    "created_at": "2022-05-05T17:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451727",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:139"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32c831c47caf5e862e29919e955067268678dfb0"><code>32c831c</code></a></td><td><code>sage.env.cython_aliases: Handle ecl via default_required_modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d75ff7421f3b2b46d4885984eff037abbe1f807"><code>4d75ff7</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add missing sage.misc.package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/078d72d63584293339594a5a65bb27f118251a98"><code>078d72d</code></a></td><td><code>pkgs/sagemath-objects/MANIFEST.in: Add sage.misc.sagedoc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4da43c52a03b932b9561337b311391746df022ce"><code>4da43c5</code></a></td><td><code>pkgs/sagemath-{objects,categories}/README.rst: Mention dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06eec85b4f5fe564d56e3317ef9c22425903cc6e"><code>06eec85</code></a></td><td><code>Merge #33803</code></td></tr></table>




---

archive/issue_comments_451728.json:
```json
{
    "body": "Changed commit from **[`06eec85`](https://github.com/sagemath/sagetrac-mirror/commit/06eec85b4f5fe564d56e3317ef9c22425903cc6e)** to **[`4e95de9`](https://github.com/sagemath/sagetrac-mirror/commit/4e95de9b16dd4b1629847e9ac7837ea291bb9cb5)**",
    "created_at": "2022-05-06T16:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451728",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`06eec85`](https://github.com/sagemath/sagetrac-mirror/commit/06eec85b4f5fe564d56e3317ef9c22425903cc6e)** to **[`4e95de9`](https://github.com/sagemath/sagetrac-mirror/commit/4e95de9b16dd4b1629847e9ac7837ea291bb9cb5)**



---

archive/issue_comments_451729.json:
```json
{
    "body": "<div id=\"comment:140\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5d43bd1ab4184d66230d4b61f51c3bb0bfc21b1\"><code>c5d43bd</code></a></td><td><code>src/sage/env.py (cython_aliases): Fix up</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e95de9b16dd4b1629847e9ac7837ea291bb9cb5\"><code>4e95de9</code></a></td><td><code>Merge #33803</code></td></tr></table>\n",
    "created_at": "2022-05-06T16:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451729",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:140"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5d43bd1ab4184d66230d4b61f51c3bb0bfc21b1"><code>c5d43bd</code></a></td><td><code>src/sage/env.py (cython_aliases): Fix up</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e95de9b16dd4b1629847e9ac7837ea291bb9cb5"><code>4e95de9</code></a></td><td><code>Merge #33803</code></td></tr></table>




---

archive/issue_comments_451730.json:
```json
{
    "body": "<div id=\"comment:141\" align=\"right\">comment:141</div>\n\nThe failure in `src/sage/interfaces/expect.py` shown by the patchbot is unrelated.\nReady for review",
    "created_at": "2022-05-09T18:26:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451730",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:141" align="right">comment:141</div>

The failure in `src/sage/interfaces/expect.py` shown by the patchbot is unrelated.
Ready for review



---

archive/issue_comments_451731.json:
```json
{
    "body": "<div id=\"comment:142\" align=\"right\">comment:142</div>\n\nshould one `exclude` not only *.so, but *.dylib, too?",
    "created_at": "2022-05-10T22:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451731",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:142" align="right">comment:142</div>

should one `exclude` not only *.so, but *.dylib, too?



---

archive/issue_comments_451732.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">comment:143</div>\n\nOn macOS, the compiled python modules are also .so, not .dylib.",
    "created_at": "2022-05-10T22:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451732",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:143" align="right">comment:143</div>

On macOS, the compiled python modules are also .so, not .dylib.



---

archive/issue_comments_451733.json:
```json
{
    "body": "<div id=\"comment:145\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a92db463d340bff6819a10ca05c9c9ec1c2b95ad\"><code>a92db46</code></a></td><td><code>Merge tag '9.7.beta1' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-05-29T23:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451733",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:145"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a92db463d340bff6819a10ca05c9c9ec1c2b95ad"><code>a92db46</code></a></td><td><code>Merge tag '9.7.beta1' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451734.json:
```json
{
    "body": "Changed commit from **[`4e95de9`](https://github.com/sagemath/sagetrac-mirror/commit/4e95de9b16dd4b1629847e9ac7837ea291bb9cb5)** to **[`a92db46`](https://github.com/sagemath/sagetrac-mirror/commit/a92db463d340bff6819a10ca05c9c9ec1c2b95ad)**",
    "created_at": "2022-05-29T23:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451734",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4e95de9`](https://github.com/sagemath/sagetrac-mirror/commit/4e95de9b16dd4b1629847e9ac7837ea291bb9cb5)** to **[`a92db46`](https://github.com/sagemath/sagetrac-mirror/commit/a92db463d340bff6819a10ca05c9c9ec1c2b95ad)**



---

archive/issue_comments_451735.json:
```json
{
    "body": "<div id=\"comment:146\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a15f173f8e75f3e53d46fd44d01165dae9a0f1af\"><code>a15f173</code></a></td><td><code>pkgs/sagemath-categories/tox.ini: Fix instructions in comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8587d4715af8448ea283750a99a39b44dbed93de\"><code>8587d47</code></a></td><td><code>src/sage/misc/package_dir.py: New context manager cython_namespace_package_support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc0992d36b482cd42fe28f6ee1a4c81d7eec194c\"><code>bc0992d</code></a></td><td><code>src/sage/misc/cython.py: Activate cython_namespace_package_support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c98c36386a268740def9e93bbb340d3c1dfe5c6\"><code>7c98c36</code></a></td><td><code>src/setup.py: Fix up use of cython_namespace_package_support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79822e41a32907476352becb078e10f921c0eba9\"><code>79822e4</code></a></td><td><code>pkgs/sagemath-objects/setup.py: Monkey-patching cython is now done by the sage_build_cython command</code></td></tr></table>\n",
    "created_at": "2022-06-08T06:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451735",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:146"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a15f173f8e75f3e53d46fd44d01165dae9a0f1af"><code>a15f173</code></a></td><td><code>pkgs/sagemath-categories/tox.ini: Fix instructions in comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8587d4715af8448ea283750a99a39b44dbed93de"><code>8587d47</code></a></td><td><code>src/sage/misc/package_dir.py: New context manager cython_namespace_package_support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc0992d36b482cd42fe28f6ee1a4c81d7eec194c"><code>bc0992d</code></a></td><td><code>src/sage/misc/cython.py: Activate cython_namespace_package_support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c98c36386a268740def9e93bbb340d3c1dfe5c6"><code>7c98c36</code></a></td><td><code>src/setup.py: Fix up use of cython_namespace_package_support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79822e41a32907476352becb078e10f921c0eba9"><code>79822e4</code></a></td><td><code>pkgs/sagemath-objects/setup.py: Monkey-patching cython is now done by the sage_build_cython command</code></td></tr></table>




---

archive/issue_comments_451736.json:
```json
{
    "body": "Changed commit from **[`a92db46`](https://github.com/sagemath/sagetrac-mirror/commit/a92db463d340bff6819a10ca05c9c9ec1c2b95ad)** to **[`79822e4`](https://github.com/sagemath/sagetrac-mirror/commit/79822e41a32907476352becb078e10f921c0eba9)**",
    "created_at": "2022-06-08T06:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451736",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a92db46`](https://github.com/sagemath/sagetrac-mirror/commit/a92db463d340bff6819a10ca05c9c9ec1c2b95ad)** to **[`79822e4`](https://github.com/sagemath/sagetrac-mirror/commit/79822e41a32907476352becb078e10f921c0eba9)**



---

archive/issue_comments_451737.json:
```json
{
    "body": "Changed commit from **[`79822e4`](https://github.com/sagemath/sagetrac-mirror/commit/79822e41a32907476352becb078e10f921c0eba9)** to **[`39272c1`](https://github.com/sagemath/sagetrac-mirror/commit/39272c1c5c8e33072f29a80baea95af40f7f6ad1)**",
    "created_at": "2022-06-09T18:54:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451737",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`79822e4`](https://github.com/sagemath/sagetrac-mirror/commit/79822e41a32907476352becb078e10f921c0eba9)** to **[`39272c1`](https://github.com/sagemath/sagetrac-mirror/commit/39272c1c5c8e33072f29a80baea95af40f7f6ad1)**



---

archive/issue_comments_451738.json:
```json
{
    "body": "<div id=\"comment:147\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39272c1c5c8e33072f29a80baea95af40f7f6ad1\"><code>39272c1</code></a></td><td><code>src/sage_setup/command/sage_build_cython.py: Reduce verbosity</code></td></tr></table>\n",
    "created_at": "2022-06-09T18:54:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451738",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:147"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39272c1c5c8e33072f29a80baea95af40f7f6ad1"><code>39272c1</code></a></td><td><code>src/sage_setup/command/sage_build_cython.py: Reduce verbosity</code></td></tr></table>




---

archive/issue_comments_451739.json:
```json
{
    "body": "<div id=\"comment:148\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81237e15f8a7c035486811f51e365664b84ecae9\"><code>81237e1</code></a></td><td><code>Merge tag '9.7.beta2' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-06-12T18:46:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451739",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:148"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81237e15f8a7c035486811f51e365664b84ecae9"><code>81237e1</code></a></td><td><code>Merge tag '9.7.beta2' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451740.json:
```json
{
    "body": "Changed commit from **[`39272c1`](https://github.com/sagemath/sagetrac-mirror/commit/39272c1c5c8e33072f29a80baea95af40f7f6ad1)** to **[`81237e1`](https://github.com/sagemath/sagetrac-mirror/commit/81237e15f8a7c035486811f51e365664b84ecae9)**",
    "created_at": "2022-06-12T18:46:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451740",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`39272c1`](https://github.com/sagemath/sagetrac-mirror/commit/39272c1c5c8e33072f29a80baea95af40f7f6ad1)** to **[`81237e1`](https://github.com/sagemath/sagetrac-mirror/commit/81237e15f8a7c035486811f51e365664b84ecae9)**



---

archive/issue_comments_451741.json:
```json
{
    "body": "<div id=\"comment:149\" align=\"right\">comment:149</div>\n\nSorry for my ignorance, but I am unable to merge this ticket:\n\n```\n% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git\n[...]\n% cd sage\n% git-trac-merge 28925\n\n#28925\nremote branch: u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_\n\nFrom git://trac.sagemath.org/sage\n * branch                  u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_ -> FETCH_HEAD\n * [new branch]            u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_ -> trac/u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_\n\nAuto-merging build/pkgs/sage_setup/dependencies\nCONFLICT (content): Merge conflict in build/pkgs/sage_setup/dependencies\nAutomatic merge failed; fix conflicts and then commit the result.\n% \n```",
    "created_at": "2022-06-21T13:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451741",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:149" align="right">comment:149</div>

Sorry for my ignorance, but I am unable to merge this ticket:

```
% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git
[...]
% cd sage
% git-trac-merge 28925

#28925
remote branch: u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_

From git://trac.sagemath.org/sage
 * branch                  u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_ -> FETCH_HEAD
 * [new branch]            u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_ -> trac/u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_

Auto-merging build/pkgs/sage_setup/dependencies
CONFLICT (content): Merge conflict in build/pkgs/sage_setup/dependencies
Automatic merge failed; fix conflicts and then commit the result.
% 
```



---

archive/issue_comments_451742.json:
```json
{
    "body": "<div id=\"comment:150\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd2c525c3c191b9c72fda24e0cf99f9654ed7dfe\"><code>dd2c525</code></a></td><td><code>Merge tag '9.7.beta3' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-06-25T18:20:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451742",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:150"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd2c525c3c191b9c72fda24e0cf99f9654ed7dfe"><code>dd2c525</code></a></td><td><code>Merge tag '9.7.beta3' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451743.json:
```json
{
    "body": "Changed commit from **[`81237e1`](https://github.com/sagemath/sagetrac-mirror/commit/81237e15f8a7c035486811f51e365664b84ecae9)** to **[`dd2c525`](https://github.com/sagemath/sagetrac-mirror/commit/dd2c525c3c191b9c72fda24e0cf99f9654ed7dfe)**",
    "created_at": "2022-06-25T18:20:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451743",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`81237e1`](https://github.com/sagemath/sagetrac-mirror/commit/81237e15f8a7c035486811f51e365664b84ecae9)** to **[`dd2c525`](https://github.com/sagemath/sagetrac-mirror/commit/dd2c525c3c191b9c72fda24e0cf99f9654ed7dfe)**



---

archive/issue_comments_451744.json:
```json
{
    "body": "<div id=\"comment:151\" align=\"right\">comment:151</div>\n\nI've resolved the merge conflict",
    "created_at": "2022-06-25T18:20:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451744",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:151" align="right">comment:151</div>

I've resolved the merge conflict



---

archive/issue_comments_451745.json:
```json
{
    "body": "<div id=\"comment:152\" align=\"right\">comment:152</div>\n\nNot used import?\n\n```diff\ndiff --git a/pkgs/sagemath-objects/setup.py b/pkgs/sagemath-objects/setup.py\nindex 124f0cb218..907cabef83 100644\n--- a/pkgs/sagemath-objects/setup.py\n+++ b/pkgs/sagemath-objects/setup.py\n@@ -42,7 +42,7 @@ if sdist:\n     python_modules = []\n     cython_modules = []\n else:\n-    from sage_setup.find import find_python_sources, is_package_or_namespace_package_dir\n+    from sage_setup.find import find_python_sources\n     python_packages, python_modules, cython_modules = find_python_sources(\n         '.', ['sage'])   # for now, we do the filtering using MANIFEST\n```",
    "created_at": "2022-06-30T01:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451745",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:152" align="right">comment:152</div>

Not used import?

```diff
diff --git a/pkgs/sagemath-objects/setup.py b/pkgs/sagemath-objects/setup.py
index 124f0cb218..907cabef83 100644
--- a/pkgs/sagemath-objects/setup.py
+++ b/pkgs/sagemath-objects/setup.py
@@ -42,7 +42,7 @@ if sdist:
     python_modules = []
     cython_modules = []
 else:
-    from sage_setup.find import find_python_sources, is_package_or_namespace_package_dir
+    from sage_setup.find import find_python_sources
     python_packages, python_modules, cython_modules = find_python_sources(
         '.', ['sage'])   # for now, we do the filtering using MANIFEST
```



---

archive/issue_comments_451746.json:
```json
{
    "body": "Changed commit from **[`dd2c525`](https://github.com/sagemath/sagetrac-mirror/commit/dd2c525c3c191b9c72fda24e0cf99f9654ed7dfe)** to **[`cd4d8e9`](https://github.com/sagemath/sagetrac-mirror/commit/cd4d8e9aa0c9954019fef9dc29e43d26a891f460)**",
    "created_at": "2022-07-01T00:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451746",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dd2c525`](https://github.com/sagemath/sagetrac-mirror/commit/dd2c525c3c191b9c72fda24e0cf99f9654ed7dfe)** to **[`cd4d8e9`](https://github.com/sagemath/sagetrac-mirror/commit/cd4d8e9aa0c9954019fef9dc29e43d26a891f460)**



---

archive/issue_comments_451747.json:
```json
{
    "body": "<div id=\"comment:153\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2cc90024b8c3fb673dc1087b298a5ada9e6d93ad\"><code>2cc9002</code></a></td><td><code>pkgs/sagemath-objects/setup.py: Remove unused import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd4d8e9aa0c9954019fef9dc29e43d26a891f460\"><code>cd4d8e9</code></a></td><td><code>pkgs/sagemath-standard/setup.py: Monkey-patching cython is now done by the sage_build_cython command</code></td></tr></table>\n",
    "created_at": "2022-07-01T00:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451747",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:153"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2cc90024b8c3fb673dc1087b298a5ada9e6d93ad"><code>2cc9002</code></a></td><td><code>pkgs/sagemath-objects/setup.py: Remove unused import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd4d8e9aa0c9954019fef9dc29e43d26a891f460"><code>cd4d8e9</code></a></td><td><code>pkgs/sagemath-standard/setup.py: Monkey-patching cython is now done by the sage_build_cython command</code></td></tr></table>




---

archive/issue_comments_451748.json:
```json
{
    "body": "<div id=\"comment:154\" align=\"right\">comment:154</div>\n\nThanks!\n\nAnd I have applied the change that left that import unused also to another file.",
    "created_at": "2022-07-01T00:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451748",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:154" align="right">comment:154</div>

Thanks!

And I have applied the change that left that import unused also to another file.



---

archive/issue_comments_451749.json:
```json
{
    "body": "<div id=\"comment:155\" align=\"right\">comment:155</div>\n\nThanks. \n\nAnother comment: `clean_install_dir` and `find_extra_files` have a new argument `distributions`, but the docstrings do not explain it.",
    "created_at": "2022-07-01T01:25:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451749",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:155" align="right">comment:155</div>

Thanks. 

Another comment: `clean_install_dir` and `find_extra_files` have a new argument `distributions`, but the docstrings do not explain it.



---

archive/issue_comments_451750.json:
```json
{
    "body": "Changed commit from **[`cd4d8e9`](https://github.com/sagemath/sagetrac-mirror/commit/cd4d8e9aa0c9954019fef9dc29e43d26a891f460)** to **[`9ab3200`](https://github.com/sagemath/sagetrac-mirror/commit/9ab3200f0c30e6502f915a08136f636371a0e995)**",
    "created_at": "2022-07-01T01:49:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451750",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cd4d8e9`](https://github.com/sagemath/sagetrac-mirror/commit/cd4d8e9aa0c9954019fef9dc29e43d26a891f460)** to **[`9ab3200`](https://github.com/sagemath/sagetrac-mirror/commit/9ab3200f0c30e6502f915a08136f636371a0e995)**



---

archive/issue_comments_451751.json:
```json
{
    "body": "<div id=\"comment:156\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af9ac78b79cae957232b4b7929909533a162a7ed\"><code>af9ac78</code></a></td><td><code>src/sage_setup/find.py (find_extra_files): Document new arg 'distributions'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13e66a3a785cf098f64e93db35217d9343a4106c\"><code>13e66a3</code></a></td><td><code>src/sage_setup/find.py (find_extra_files): Fix indentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ab3200f0c30e6502f915a08136f636371a0e995\"><code>9ab3200</code></a></td><td><code>src/sage_setup/clean.py (clean_install_dir): Document new arg 'distributions'</code></td></tr></table>\n",
    "created_at": "2022-07-01T01:49:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451751",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:156"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af9ac78b79cae957232b4b7929909533a162a7ed"><code>af9ac78</code></a></td><td><code>src/sage_setup/find.py (find_extra_files): Document new arg 'distributions'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13e66a3a785cf098f64e93db35217d9343a4106c"><code>13e66a3</code></a></td><td><code>src/sage_setup/find.py (find_extra_files): Fix indentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ab3200f0c30e6502f915a08136f636371a0e995"><code>9ab3200</code></a></td><td><code>src/sage_setup/clean.py (clean_install_dir): Document new arg 'distributions'</code></td></tr></table>




---

archive/issue_comments_451752.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee, ...**",
    "created_at": "2022-07-04T02:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451752",
    "user": "https://github.com/kwankyu"
}
```

Reviewer: **Kwankyu Lee, ...**



---

archive/issue_comments_451753.json:
```json
{
    "body": "<div id=\"comment:157\" align=\"right\">comment:157</div>\n\nThank you for the update.\n\nI have been testing (using) this ticket and and the sequel #33011 for a while. They works well. I checked the code as far as I can (not very far), and it looks good to me. \n\nIf we don't have further comments on this ticket, then it would better be tested by more developers in the wild by merging this now, so that we can fix problems before the next release.\n\nI will wait for your (not Matthias) meta comments, and proceed to \"positive review\" in a couple of days.",
    "created_at": "2022-07-04T02:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451753",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:157" align="right">comment:157</div>

Thank you for the update.

I have been testing (using) this ticket and and the sequel #33011 for a while. They works well. I checked the code as far as I can (not very far), and it looks good to me. 

If we don't have further comments on this ticket, then it would better be tested by more developers in the wild by merging this now, so that we can fix problems before the next release.

I will wait for your (not Matthias) meta comments, and proceed to "positive review" in a couple of days.



---

archive/issue_comments_451754.json:
```json
{
    "body": "<div id=\"comment:158\" align=\"right\">comment:158</div>\n\nIs this\n\n```\n./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  \n```\nbroken? It doesn't work with (and without) this ticket.",
    "created_at": "2022-07-06T06:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451754",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:158" align="right">comment:158</div>

Is this

```
./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  
```
broken? It doesn't work with (and without) this ticket.



---

archive/issue_comments_451755.json:
```json
{
    "body": "<div id=\"comment:159\" align=\"right\">comment:159</div>\n\nReplying to [@kwankyu](#comment:158):\n> Is this\n> \n> ```\n> ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  \n> ```\n> broken? It doesn't work with (and without) this ticket.\n\nworks for me (after `make build` from a clean state done)",
    "created_at": "2022-07-06T09:00:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451755",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:159" align="right">comment:159</div>

Replying to [@kwankyu](#comment:158):
> Is this
> 
> ```
> ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  
> ```
> broken? It doesn't work with (and without) this ticket.

works for me (after `make build` from a clean state done)



---

archive/issue_comments_451756.json:
```json
{
    "body": "<div id=\"comment:160\" align=\"right\">comment:160</div>\n\nReplying to [@dimpase](#comment:159):\n> Replying to [@kwankyu](#comment:158):\n> > Is this\n> > \n> > ```\n> > ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  \n> > ```\n> > broken? It doesn't work with (and without) this ticket.\n\n> \n> works for me (after `make build` from a clean state done)\n\nI did `make distclean; make -j8; ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'`. So this is clean.\n\nThis is the initial part that goes wrong:\n\n```\nsage -t --random-seed=251639358214975434990568781743714015030 --environment=sage.all__sagemath_categories /Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx\n**********************************************************************\nFile \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx\", line 58, in sage.structure.coerce_actions.GenericAction.__init__\nFailed example:\n    M = MatrixSpace(ZZ,2)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.structure.coerce_actions.GenericAction.__init__[0]>\", line 1, in <module>\n        M = MatrixSpace(ZZ,Integer(2))\n    NameError: name 'MatrixSpace' is not defined\n```\nAny clue? I am on Mac.",
    "created_at": "2022-07-06T09:06:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451756",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:160" align="right">comment:160</div>

Replying to [@dimpase](#comment:159):
> Replying to [@kwankyu](#comment:158):
> > Is this
> > 
> > ```
> > ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  
> > ```
> > broken? It doesn't work with (and without) this ticket.

> 
> works for me (after `make build` from a clean state done)

I did `make distclean; make -j8; ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'`. So this is clean.

This is the initial part that goes wrong:

```
sage -t --random-seed=251639358214975434990568781743714015030 --environment=sage.all__sagemath_categories /Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx
**********************************************************************
File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx", line 58, in sage.structure.coerce_actions.GenericAction.__init__
Failed example:
    M = MatrixSpace(ZZ,2)
Exception raised:
    Traceback (most recent call last):
      File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.structure.coerce_actions.GenericAction.__init__[0]>", line 1, in <module>
        M = MatrixSpace(ZZ,Integer(2))
    NameError: name 'MatrixSpace' is not defined
```
Any clue? I am on Mac.



---

archive/issue_comments_451757.json:
```json
{
    "body": "Changed reviewer from **Kwankyu Lee, ...** to **Kwankyu Lee, Dima Pasechnik**",
    "created_at": "2022-07-06T10:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451757",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Kwankyu Lee, ...** to **Kwankyu Lee, Dima Pasechnik**



---

archive/issue_events_394457.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-07-06T10:28:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394457"
}
```



---

archive/issue_events_394458.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-07-06T10:28:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394458"
}
```



---

archive/issue_comments_451758.json:
```json
{
    "body": "<div id=\"comment:161\" align=\"right\">comment:161</div>\n\nI start from `git clean -fdx` - which cleans much more.\n\nYou'll probably want to move `upstream/` outside and after `git clean` make a symbolic link to it, otherwise it will re-download things.\n\nSo it's positive review from me.",
    "created_at": "2022-07-06T10:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451758",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:161" align="right">comment:161</div>

I start from `git clean -fdx` - which cleans much more.

You'll probably want to move `upstream/` outside and after `git clean` make a symbolic link to it, otherwise it will re-download things.

So it's positive review from me.



---

archive/issue_comments_451759.json:
```json
{
    "body": "<div id=\"comment:162\" align=\"right\">comment:162</div>\n\nReplying to [@dimpase](#comment:161):\n> I start from `git clean -fdx` - which cleans much more.\n\nThanks. But it didn't help. As far as I understand, the doctest failures are expected. The real problem is:\n\n```python\n$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 \nPython 3.9.13 (main, May 24 2022, 21:28:31) \n[Clang 13.1.6 (clang-1316.0.21.2)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> from sage.categories.category import Category\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/categories/category.py\", line 107, in <module>\n    from sage.misc.c3_controlled import _cmp_key, _cmp_key_named, C3_sorted_merge\n  File \"sage/misc/c3_controlled.pyx\", line 364, in init sage.misc.c3_controlled (build/cythonized/sage/misc/c3_controlled.c:11819)\n  File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/structure/__init__.py\", line 2, in <module>\n    import sage.structure.element\n  File \"sage/structure/element.pyx\", line 1, in init sage.structure.element (build/cythonized/sage/structure/element.c:36204)\n  File \"sage/structure/category_object.pyx\", line 60, in init sage.structure.category_object (build/cythonized/sage/structure/category_object.c:9982)\nImportError: cannot import name Category\n```\nStrangely this works \n\n```python\nHera:sage-dev$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 \nPython 3.9.13 (main, May 24 2022, 21:28:31) \n[Clang 13.1.6 (clang-1316.0.21.2)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> from sage.structure.sage_object import SageObject\n>>> from sage.categories.category import Category\n>>> \n```\n\nAnyway, this is not a problem of this ticket. The situation is the same without this ticket.\n\nHence my positive review to this ticket!",
    "created_at": "2022-07-06T12:57:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451759",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:162" align="right">comment:162</div>

Replying to [@dimpase](#comment:161):
> I start from `git clean -fdx` - which cleans much more.

Thanks. But it didn't help. As far as I understand, the doctest failures are expected. The real problem is:

```python
$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 
Python 3.9.13 (main, May 24 2022, 21:28:31) 
[Clang 13.1.6 (clang-1316.0.21.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> from sage.categories.category import Category
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/categories/category.py", line 107, in <module>
    from sage.misc.c3_controlled import _cmp_key, _cmp_key_named, C3_sorted_merge
  File "sage/misc/c3_controlled.pyx", line 364, in init sage.misc.c3_controlled (build/cythonized/sage/misc/c3_controlled.c:11819)
  File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/structure/__init__.py", line 2, in <module>
    import sage.structure.element
  File "sage/structure/element.pyx", line 1, in init sage.structure.element (build/cythonized/sage/structure/element.c:36204)
  File "sage/structure/category_object.pyx", line 60, in init sage.structure.category_object (build/cythonized/sage/structure/category_object.c:9982)
ImportError: cannot import name Category
```
Strangely this works 

```python
Hera:sage-dev$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 
Python 3.9.13 (main, May 24 2022, 21:28:31) 
[Clang 13.1.6 (clang-1316.0.21.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> from sage.structure.sage_object import SageObject
>>> from sage.categories.category import Category
>>> 
```

Anyway, this is not a problem of this ticket. The situation is the same without this ticket.

Hence my positive review to this ticket!



---

archive/issue_comments_451760.json:
```json
{
    "body": "<div id=\"comment:163\" align=\"right\">comment:163</div>\n\nhmm, do you have the current directory, i.e. `.`, in your `PATH`? IMHO this might mess things up.",
    "created_at": "2022-07-06T14:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451760",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:163" align="right">comment:163</div>

hmm, do you have the current directory, i.e. `.`, in your `PATH`? IMHO this might mess things up.



---

archive/issue_comments_451761.json:
```json
{
    "body": "<div id=\"comment:164\" align=\"right\">comment:164</div>\n\nReplying to [@dimpase](#comment:163):\n> hmm, do you have the current directory, i.e. `.`, in your `PATH`? IMHO this might mess things up.\n\nYes. But even after removing it from the path, it's the same. \n\n`./configure` shows `python3-3.10.3: using system package; SPKG will not be installed`, and\n\n```python\n$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 \nPython 3.9.13 (main, May 24 2022, 21:28:31) \n[Clang 13.1.6 (clang-1316.0.21.2)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import sys\n>>> sys.path\n['', '/usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python39.zip', '/usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9', '/usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/lib-dynload', '/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages']\n```\n\n```python\n$ pkgs/sagemath-categories/.tox/python/bin/python \nPython 3.10.4 (main, Apr 26 2022, 19:42:59) [Clang 13.1.6 (clang-1316.0.21.2)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import sys\n>>> sys.path\n['', '/usr/local/Cellar/python@3.10/3.10.4/Frameworks/Python.framework/Versions/3.10/lib/python310.zip', '/usr/local/Cellar/python@3.10/3.10.4/Frameworks/Python.framework/Versions/3.10/lib/python3.10', '/usr/local/Cellar/python@3.10/3.10.4/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload', '/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages']\n```",
    "created_at": "2022-07-06T14:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451761",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:164" align="right">comment:164</div>

Replying to [@dimpase](#comment:163):
> hmm, do you have the current directory, i.e. `.`, in your `PATH`? IMHO this might mess things up.

Yes. But even after removing it from the path, it's the same. 

`./configure` shows `python3-3.10.3: using system package; SPKG will not be installed`, and

```python
$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 
Python 3.9.13 (main, May 24 2022, 21:28:31) 
[Clang 13.1.6 (clang-1316.0.21.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.path
['', '/usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python39.zip', '/usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9', '/usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/lib-dynload', '/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages']
```

```python
$ pkgs/sagemath-categories/.tox/python/bin/python 
Python 3.10.4 (main, Apr 26 2022, 19:42:59) [Clang 13.1.6 (clang-1316.0.21.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.path
['', '/usr/local/Cellar/python@3.10/3.10.4/Frameworks/Python.framework/Versions/3.10/lib/python310.zip', '/usr/local/Cellar/python@3.10/3.10.4/Frameworks/Python.framework/Versions/3.10/lib/python3.10', '/usr/local/Cellar/python@3.10/3.10.4/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload', '/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages']
```



---

archive/issue_comments_451762.json:
```json
{
    "body": "<div id=\"comment:165\" align=\"right\">comment:165</div>\n\nReplying to [@dimpase](#comment:159):\n> Replying to [@kwankyu](#comment:158):\n> > Is this\n> > \n> > ```\n> > ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  \n> > ```\n> > broken? It doesn't work with (and without) this ticket.\n\n> \n> works for me (after `make build` from a clean state done)\n\nsagemath-categories (in contrast to sagemath-standard) does not need `make build` because all of its build and runtime dependencies can be found on PyPI.",
    "created_at": "2022-07-06T18:04:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451762",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:165" align="right">comment:165</div>

Replying to [@dimpase](#comment:159):
> Replying to [@kwankyu](#comment:158):
> > Is this
> > 
> > ```
> > ./sage -sh -c '(cd pkgs/sagemath-categories && tox -v -v -v)'  
> > ```
> > broken? It doesn't work with (and without) this ticket.

> 
> works for me (after `make build` from a clean state done)

sagemath-categories (in contrast to sagemath-standard) does not need `make build` because all of its build and runtime dependencies can be found on PyPI.



---

archive/issue_comments_451763.json:
```json
{
    "body": "<div id=\"comment:166\" align=\"right\">comment:166</div>\n\nReplying to [@kwankyu](#comment:160):\n> This is the initial part that goes wrong:\n> \n> ```\n> sage -t --random-seed=251639358214975434990568781743714015030 --environment=sage.all__sagemath_categories /Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx\n> **********************************************************************\n> File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx\", line 58, in sage.structure.coerce_actions.GenericAction.__init__\n> Failed example:\n>     M = MatrixSpace(ZZ,2)\n> Exception raised:\n>     Traceback (most recent call last):\n>       File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n>         self.compile_and_execute(example, compiler, test.globs)\n>       File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n>         exec(compiled, globs)\n>       File \"<doctest sage.structure.coerce_actions.GenericAction.__init__[0]>\", line 1, in <module>\n>         M = MatrixSpace(ZZ,Integer(2))\n>     NameError: name 'MatrixSpace' is not defined\n> ```\n\n**sagemath-categories** as of this ticket does not contain src/sage/matrix/matrix_space.py (see `pkgs/sagemath-categories/MANIFEST.in`), so `MatrixSpace` is not available in `sage.all__sagemath_categories`.\n\nNote that the `tox` run ends with the message \"lots of doctest failures are expected\". This is one of them.",
    "created_at": "2022-07-06T18:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451763",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:166" align="right">comment:166</div>

Replying to [@kwankyu](#comment:160):
> This is the initial part that goes wrong:
> 
> ```
> sage -t --random-seed=251639358214975434990568781743714015030 --environment=sage.all__sagemath_categories /Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx
> **********************************************************************
> File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/structure/coerce_actions.pyx", line 58, in sage.structure.coerce_actions.GenericAction.__init__
> Failed example:
>     M = MatrixSpace(ZZ,2)
> Exception raised:
>     Traceback (most recent call last):
>       File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
>         self.compile_and_execute(example, compiler, test.globs)
>       File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/python/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
>         exec(compiled, globs)
>       File "<doctest sage.structure.coerce_actions.GenericAction.__init__[0]>", line 1, in <module>
>         M = MatrixSpace(ZZ,Integer(2))
>     NameError: name 'MatrixSpace' is not defined
> ```

**sagemath-categories** as of this ticket does not contain src/sage/matrix/matrix_space.py (see `pkgs/sagemath-categories/MANIFEST.in`), so `MatrixSpace` is not available in `sage.all__sagemath_categories`.

Note that the `tox` run ends with the message "lots of doctest failures are expected". This is one of them.



---

archive/issue_comments_451764.json:
```json
{
    "body": "<div id=\"comment:167\" align=\"right\">comment:167</div>\n\nReplying to [@kwankyu](#comment:162):\n> The real problem is:\n> \n> ```python\n> $ pkgs/sagemath-categories/.tox/py39/bin/python3.9 \n> Python 3.9.13 (main, May 24 2022, 21:28:31) \n> [Clang 13.1.6 (clang-1316.0.21.2)] on darwin\n> Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n> >>> from sage.categories.category import Category\n> Traceback (most recent call last):\n>   File \"<stdin>\", line 1, in <module>\n>   File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/categories/category.py\", line 107, in <module>\n>     from sage.misc.c3_controlled import _cmp_key, _cmp_key_named, C3_sorted_merge\n>   File \"sage/misc/c3_controlled.pyx\", line 364, in init sage.misc.c3_controlled (build/cythonized/sage/misc/c3_controlled.c:11819)\n>   File \"/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/structure/__init__.py\", line 2, in <module>\n>     import sage.structure.element\n>   File \"sage/structure/element.pyx\", line 1, in init sage.structure.element (build/cythonized/sage/structure/element.c:36204)\n>   File \"sage/structure/category_object.pyx\", line 60, in init sage.structure.category_object (build/cythonized/sage/structure/category_object.c:9982)\n> ImportError: cannot import name Category\n> ```\n> Strangely this works \n> \n> ```python\n> Hera:sage-dev$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 \n> Python 3.9.13 (main, May 24 2022, 21:28:31) \n> [Clang 13.1.6 (clang-1316.0.21.2)] on darwin\n> Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n> >>> from sage.structure.sage_object import SageObject\n> >>> from sage.categories.category import Category\n> >>> \n> ```\n\nThe Sage library contains many cyclic imports. If one starts at the wrong place in an import cycle, one can run into problems with partially initialized modules. See #33580 (Meta-ticket: make all modules importable without sage.all)",
    "created_at": "2022-07-06T18:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451764",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:167" align="right">comment:167</div>

Replying to [@kwankyu](#comment:162):
> The real problem is:
> 
> ```python
> $ pkgs/sagemath-categories/.tox/py39/bin/python3.9 
> Python 3.9.13 (main, May 24 2022, 21:28:31) 
> [Clang 13.1.6 (clang-1316.0.21.2)] on darwin
> Type "help", "copyright", "credits" or "license" for more information.
> >>> from sage.categories.category import Category
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
>   File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/categories/category.py", line 107, in <module>
>     from sage.misc.c3_controlled import _cmp_key, _cmp_key_named, C3_sorted_merge
>   File "sage/misc/c3_controlled.pyx", line 364, in init sage.misc.c3_controlled (build/cythonized/sage/misc/c3_controlled.c:11819)
>   File "/Users/kwankyu/GitHub/sage-dev/pkgs/sagemath-categories/.tox/py39/lib/python3.9/site-packages/sage/structure/__init__.py", line 2, in <module>
>     import sage.structure.element
>   File "sage/structure/element.pyx", line 1, in init sage.structure.element (build/cythonized/sage/structure/element.c:36204)
>   File "sage/structure/category_object.pyx", line 60, in init sage.structure.category_object (build/cythonized/sage/structure/category_object.c:9982)
> ImportError: cannot import name Category
> ```
> Strangely this works 
> 
> ```python
> Hera:sage-dev$ pkgs/sagemath-categories/.tox/py39/bin/python3.9 
> Python 3.9.13 (main, May 24 2022, 21:28:31) 
> [Clang 13.1.6 (clang-1316.0.21.2)] on darwin
> Type "help", "copyright", "credits" or "license" for more information.
> >>> from sage.structure.sage_object import SageObject
> >>> from sage.categories.category import Category
> >>> 
> ```

The Sage library contains many cyclic imports. If one starts at the wrong place in an import cycle, one can run into problems with partially initialized modules. See #33580 (Meta-ticket: make all modules importable without sage.all)



---

archive/issue_comments_451765.json:
```json
{
    "body": "<div id=\"comment:168\" align=\"right\">comment:168</div>\n\nThanks both for the review!",
    "created_at": "2022-07-06T18:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451765",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:168" align="right">comment:168</div>

Thanks both for the review!



---

archive/issue_comments_451766.json:
```json
{
    "body": "<div id=\"comment:169\" align=\"right\">comment:169</div>\n\nReplying to [@mkoeppe](#comment:166): \n> Note that the `tox` run ends with the message \"lots of doctest failures are expected\". \n\nYes, it's there. It would perhaps better be colored red or green...",
    "created_at": "2022-07-07T04:45:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451766",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:169" align="right">comment:169</div>

Replying to [@mkoeppe](#comment:166): 
> Note that the `tox` run ends with the message "lots of doctest failures are expected". 

Yes, it's there. It would perhaps better be colored red or green...



---

archive/issue_events_394459.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-08T21:12:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394459"
}
```



---

archive/issue_events_394460.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-08T21:12:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394460"
}
```



---

archive/issue_comments_451767.json:
```json
{
    "body": "<div id=\"comment:170\" align=\"right\">comment:170</div>\n\nMerge failure on top of:\n\n843eb03e7e Updated [SageMath](../wiki/SageMath) version to 9.7.beta4\n\n\n\nmerge was not clean: conflicts in pkgs/sagemath-categories/tox.ini",
    "created_at": "2022-07-08T21:12:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451767",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:170" align="right">comment:170</div>

Merge failure on top of:

843eb03e7e Updated [SageMath](../wiki/SageMath) version to 9.7.beta4



merge was not clean: conflicts in pkgs/sagemath-categories/tox.ini



---

archive/issue_comments_451768.json:
```json
{
    "body": "<div id=\"comment:171\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974\"><code>f9df1ae</code></a></td><td><code>Merge tag '9.7.beta4' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>\n",
    "created_at": "2022-07-08T23:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451768",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:171"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974"><code>f9df1ae</code></a></td><td><code>Merge tag '9.7.beta4' into t/28925/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_</code></td></tr></table>




---

archive/issue_comments_451769.json:
```json
{
    "body": "Changed commit from **[`9ab3200`](https://github.com/sagemath/sagetrac-mirror/commit/9ab3200f0c30e6502f915a08136f636371a0e995)** to **[`f9df1ae`](https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974)**",
    "created_at": "2022-07-08T23:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451769",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9ab3200`](https://github.com/sagemath/sagetrac-mirror/commit/9ab3200f0c30e6502f915a08136f636371a0e995)** to **[`f9df1ae`](https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974)**



---

archive/issue_events_394461.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-08T23:35:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394461"
}
```



---

archive/issue_events_394462.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-08T23:35:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394462"
}
```



---

archive/issue_events_394463.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-10T22:35:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394463"
}
```



---

archive/issue_events_394464.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6294f36ee4eae0f3375044a71f7c639c9c0339bc",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-07-10T22:35:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28925#event-394464"
}
```



---

archive/issue_comments_451770.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_)** to **[`f9df1ae`](https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974)**",
    "created_at": "2022-07-10T22:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28925#issuecomment-451770",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/modify_find_python_sources__clean_stale_files_to_support_modularization_of_sagelib_by_native_namespace_packages__pep_420_)** to **[`f9df1ae`](https://github.com/sagemath/sagetrac-mirror/commit/f9df1ae6eef3dd955d060ca8005b9ed3f5af3974)**
