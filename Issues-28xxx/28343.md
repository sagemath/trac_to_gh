# Issue 28343: Three.js: Support basic mesh plots

archive/issues_028106.json:
```json
{
    "body": "This enhancement allows display of a black mesh grid on any surface by supplying the keyword `mesh=True`. To avoid z-fighting with the surface, the mesh is drawn twice, slightly above and slightly below the surface.\n\nIf the mesh alone is desired, it would be simple to hide the surface. The currently supported Boolean keyword does not allow this behavior, so some input would be needed as to best additional keyword practices. We could also allow setting the color and opacity of the grid separate from the material, but again input on appropriate keywords would be needed.\n\nThis ticket includes standardization of `Line` geometries in the Three.js template as well as additional cleanup and consistency. None of that should change existing behavior.\n\n**CC:**  @egourgoulhon\n\n**Keywords:** threejs\n\n**Branch/Commit:** [f55a9cecfdd02950da5ca90adeed539eb29d28dc](https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc)\n\n**Reviewer:** Eric Gourgoulhon\n\n**Author:** Paul Masson\n\nIssue created by migration from https://trac.sagemath.org/ticket/28343\n\n",
    "closed_at": "2019-08-20T22:28:38Z",
    "created_at": "2019-08-11T22:42:30Z",
    "labels": [
        "component: graphics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Three.js: Support basic mesh plots",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28343",
    "user": "https://github.com/paulmasson"
}
```
This enhancement allows display of a black mesh grid on any surface by supplying the keyword `mesh=True`. To avoid z-fighting with the surface, the mesh is drawn twice, slightly above and slightly below the surface.

If the mesh alone is desired, it would be simple to hide the surface. The currently supported Boolean keyword does not allow this behavior, so some input would be needed as to best additional keyword practices. We could also allow setting the color and opacity of the grid separate from the material, but again input on appropriate keywords would be needed.

This ticket includes standardization of `Line` geometries in the Three.js template as well as additional cleanup and consistency. None of that should change existing behavior.

**CC:**  @egourgoulhon

**Keywords:** threejs

**Branch/Commit:** [f55a9cecfdd02950da5ca90adeed539eb29d28dc](https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc)

**Reviewer:** Eric Gourgoulhon

**Author:** Paul Masson

Issue created by migration from https://trac.sagemath.org/ticket/28343





---

archive/issue_comments_525614.json:
```json
{
    "body": "**Branch:** [u/paulmasson/mesh](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/mesh)",
    "created_at": "2019-08-11T22:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525614",
    "user": "https://github.com/paulmasson"
}
```

**Branch:** [u/paulmasson/mesh](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/mesh)



---

archive/issue_comments_525615.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2019-08-11T22:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525615",
    "user": "https://github.com/paulmasson"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_525616.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38b59f97155111e6edc1c414a0f864a03be88b21\">38b59f9</a></td><td><code>Support basic mesh plots</code></td></tr></table>\n",
    "created_at": "2019-08-11T22:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525616",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38b59f97155111e6edc1c414a0f864a03be88b21">38b59f9</a></td><td><code>Support basic mesh plots</code></td></tr></table>




---

archive/issue_comments_525617.json:
```json
{
    "body": "**Commit:** [38b59f97155111e6edc1c414a0f864a03be88b21](https://github.com/sagemath/sagetrac-mirror/commit/38b59f97155111e6edc1c414a0f864a03be88b21)",
    "created_at": "2019-08-11T22:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525617",
    "user": "https://github.com/paulmasson"
}
```

**Commit:** [38b59f97155111e6edc1c414a0f864a03be88b21](https://github.com/sagemath/sagetrac-mirror/commit/38b59f97155111e6edc1c414a0f864a03be88b21)



---

archive/issue_comments_525618.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2019-08-14T20:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525618",
    "user": "https://github.com/egourgoulhon"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_525619.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks for this improvement!\nI've tested it on the examples with `mesh=True` of the *3D Graphics* section of the reference manual. It looks nice!\n\nThere is one failing doctest:\n\n```\nsage -t --long --warn-long 78.5 src/sage/plot/plot3d/index_face_set.pyx\n**********************************************************************\nFile \"src/sage/plot/plot3d/index_face_set.pyx\", line 1198, in sage.plot.plot3d.index_face_set.IndexFaceSet.json_repr\nFailed example:\n    S.json_repr(S.default_render_params())\nExpected:\n    ['{\"vertices\":[{\"x\":2,\"y\":0,\"z\":0},..., \"face_colors\":[\"#ff0000\",\"#ff9900\",\"#cbff00\",\"#33ff00\"], \"opacity\":1.0}']\nGot:\n    ['{\"vertices\":[{\"x\":2,\"y\":0,\"z\":0},{\"x\":0,\"y\":2,\"z\":0},{\"x\":0,\"y\":0,\"z\":2},{\"x\":0,\"y\":1,\"z\":1},{\"x\":1,\"y\":0,\"z\":1},{\"x\":1,\"y\":1,\"z\":0}], \"faces\":[[0,4,5],[3,4,5],[2,3,4],[1,3,5]], \"faceColors\":[\"#ff0000\",\"#ff9900\",\"#cbff00\",\"#33ff00\"], \"opacity\":1.0}']\n**********************************************************************\n1 item had failures:\n   1 of  11 in sage.plot.plot3d.index_face_set.IndexFaceSet.json_repr\n    [152 tests, 1 failure, 10.12 s]\n```",
    "created_at": "2019-08-14T20:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525619",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'></a>
Thanks for this improvement!
I've tested it on the examples with `mesh=True` of the *3D Graphics* section of the reference manual. It looks nice!

There is one failing doctest:

```
sage -t --long --warn-long 78.5 src/sage/plot/plot3d/index_face_set.pyx
**********************************************************************
File "src/sage/plot/plot3d/index_face_set.pyx", line 1198, in sage.plot.plot3d.index_face_set.IndexFaceSet.json_repr
Failed example:
    S.json_repr(S.default_render_params())
Expected:
    ['{"vertices":[{"x":2,"y":0,"z":0},..., "face_colors":["#ff0000","#ff9900","#cbff00","#33ff00"], "opacity":1.0}']
Got:
    ['{"vertices":[{"x":2,"y":0,"z":0},{"x":0,"y":2,"z":0},{"x":0,"y":0,"z":2},{"x":0,"y":1,"z":1},{"x":1,"y":0,"z":1},{"x":1,"y":1,"z":0}], "faces":[[0,4,5],[3,4,5],[2,3,4],[1,3,5]], "faceColors":["#ff0000","#ff9900","#cbff00","#33ff00"], "opacity":1.0}']
**********************************************************************
1 item had failures:
   1 of  11 in sage.plot.plot3d.index_face_set.IndexFaceSet.json_repr
    [152 tests, 1 failure, 10.12 s]
```



---

archive/issue_comments_525620.json:
```json
{
    "body": "**Reviewer:** Eric Gourgoulhon",
    "created_at": "2019-08-14T20:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525620",
    "user": "https://github.com/egourgoulhon"
}
```

**Reviewer:** Eric Gourgoulhon



---

archive/issue_comments_525621.json:
```json
{
    "body": "**Changing commit** from \"[38b59f97155111e6edc1c414a0f864a03be88b21](https://github.com/sagemath/sagetrac-mirror/commit/38b59f97155111e6edc1c414a0f864a03be88b21)\" to \"[f55a9cecfdd02950da5ca90adeed539eb29d28dc](https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc)\".",
    "created_at": "2019-08-18T21:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[38b59f97155111e6edc1c414a0f864a03be88b21](https://github.com/sagemath/sagetrac-mirror/commit/38b59f97155111e6edc1c414a0f864a03be88b21)" to "[f55a9cecfdd02950da5ca90adeed539eb29d28dc](https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc)".



---

archive/issue_comments_525622.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc\">f55a9ce</a></td><td><code>Fix doctest</code></td></tr></table>\n",
    "created_at": "2019-08-18T21:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc">f55a9ce</a></td><td><code>Fix doctest</code></td></tr></table>




---

archive/issue_comments_525623.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2019-08-18T21:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525623",
    "user": "https://github.com/paulmasson"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_525624.json:
```json
{
    "body": "<a id='comment:5'></a>\nDoctest fixed. Let's try to get this into 8.9.",
    "created_at": "2019-08-18T21:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525624",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:5'></a>
Doctest fixed. Let's try to get this into 8.9.



---

archive/issue_comments_525625.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2019-08-19T07:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525625",
    "user": "https://github.com/egourgoulhon"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_525626.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks!",
    "created_at": "2019-08-19T07:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525626",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:6'></a>
Thanks!



---

archive/issue_comments_525627.json:
```json
{
    "body": "**Changing branch** from \"[u/paulmasson/mesh](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/mesh)\" to \"[f55a9cecfdd02950da5ca90adeed539eb29d28dc](https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc)\".",
    "created_at": "2019-08-20T22:28:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28343#issuecomment-525627",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/paulmasson/mesh](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/mesh)" to "[f55a9cecfdd02950da5ca90adeed539eb29d28dc](https://github.com/sagemath/sagetrac-mirror/commit/f55a9cecfdd02950da5ca90adeed539eb29d28dc)".



---

archive/issue_events_079801.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-20T22:28:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28343",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28343#event-79801"
}
```
