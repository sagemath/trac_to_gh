# Issue 28467: wrong bound in "Cannot compute primes beyond ..."

archive/issues_028230.json:
```json
{
    "assignees": [],
    "body": "with Sage 8.8:\n\n```\nsage: sum(1./p for p in prime_range(436272668))\n...\nValueError: Cannot compute primes beyond 436273290\n```\nClearly the value 436272668 is below the given bound, thus the error message is misleading.\n\nCC:  @fchapoton\n\nBranch/Commit: **[18e4819](https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314)**\n\nReviewer: **Paul Zimmermann, Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix, Samuel Leli\u00e8vre, Dima Pasechnik**\n\nAuthor: **Dave Morris**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28467_\n\n",
    "closed_at": "2020-11-07T16:23:18Z",
    "created_at": "2019-09-09T15:52:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "wrong bound in \"Cannot compute primes beyond ...\"",
    "type": "issue",
    "updated_at": "2020-11-07T16:23:18Z",
    "url": "https://github.com/sagemath/sage/issues/28467",
    "user": "https://github.com/zimmermann6"
}
```
with Sage 8.8:

```
sage: sum(1./p for p in prime_range(436272668))
...
ValueError: Cannot compute primes beyond 436273290
```
Clearly the value 436272668 is below the given bound, thus the error message is misleading.

CC:  @fchapoton

Branch/Commit: **[18e4819](https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314)**

Reviewer: **Paul Zimmermann, Frédéric Chapoton, Vincent Delecroix, Samuel Lelièvre, Dima Pasechnik**

Author: **Dave Morris**

_Issue created by migration from https://trac.sagemath.org/ticket/28467_





---

archive/issue_events_359422.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-09-09T15:52:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359422"
}
```



---

archive/issue_events_359423.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-09-09T15:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359423"
}
```



---

archive/issue_events_359424.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-09-09T15:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359424"
}
```



---

archive/issue_events_359425.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-09-09T15:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359425"
}
```



---

archive/issue_comments_446596.json:
```json
{
    "body": "Branch: **[public/fix_prime_range](https://github.com/sagemath/sagetrac-mirror/tree/public/fix_prime_range)**",
    "created_at": "2019-10-07T20:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446596",
    "user": "https://github.com/DaveWitteMorris"
}
```

Branch: **[public/fix_prime_range](https://github.com/sagemath/sagetrac-mirror/tree/public/fix_prime_range)**



---

archive/issue_comments_446597.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nInstead of improving the error message, this PR eliminates the error. The function now prints a warning message and switches to the algorithm that works. This seems more user friendly, and addresses the misunderstanding expressed in https://groups.google.com/forum/#!topic/sage-support/TeBjfcKC9Jw\n\nI also revised the docstring, added a doctest, and deleted the declaration of the unused variable \"maxpr\".",
    "created_at": "2019-10-07T20:33:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446597",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:2'>Comment 2:</a>
Instead of improving the error message, this PR eliminates the error. The function now prints a warning message and switches to the algorithm that works. This seems more user friendly, and addresses the misunderstanding expressed in https://groups.google.com/forum/#!topic/sage-support/TeBjfcKC9Jw

I also revised the docstring, added a doctest, and deleted the declaration of the unused variable "maxpr".



---

archive/issue_comments_446598.json:
```json
{
    "body": "Commit: **[587b0bb](https://github.com/sagemath/sagetrac-mirror/commit/587b0bbfc4eec029bbb41f134ad011c2b3550839)**",
    "created_at": "2019-10-07T20:33:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446598",
    "user": "https://github.com/DaveWitteMorris"
}
```

Commit: **[587b0bb](https://github.com/sagemath/sagetrac-mirror/commit/587b0bbfc4eec029bbb41f134ad011c2b3550839)**



---

archive/issue_events_359426.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-07T20:34:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359426"
}
```



---

archive/issue_comments_446599.json:
```json
{
    "body": "Author: **Dave Morris**",
    "created_at": "2019-10-09T03:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446599",
    "user": "https://github.com/DaveWitteMorris"
}
```

Author: **Dave Morris**



---

archive/issue_comments_446600.json:
```json
{
    "body": "Attachment: **[openblas-0.3.6.p0.log](https://github.com/sagemath/sage/files/ticket28467/openblas-0.3.6.p0.log)**",
    "created_at": "2019-10-10T09:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446600",
    "user": "https://github.com/zimmermann6"
}
```

Attachment: **[openblas-0.3.6.p0.log](https://github.com/sagemath/sage/files/ticket28467/openblas-0.3.6.p0.log)**



---

archive/issue_comments_446601.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nI tried to compile the code in that branch, but it failed with openblas (see attached file):\n\n```\ngcc -O2 -DMAX_STACK_ALLOC=2048 -Wall -m64 ... -l4 -lgfortran -lm -lquadmath -lm -lc\n/usr/bin/ld: cannot find -l4\n```\nAny hint? My machine has gcc 9.2.1 20190909 (Debian 9.2.1-8).",
    "created_at": "2019-10-10T09:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446601",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:5'>Comment 5:</a>
I tried to compile the code in that branch, but it failed with openblas (see attached file):

```
gcc -O2 -DMAX_STACK_ALLOC=2048 -Wall -m64 ... -l4 -lgfortran -lm -lquadmath -lm -lc
/usr/bin/ld: cannot find -l4
```
Any hint? My machine has gcc 9.2.1 20190909 (Debian 9.2.1-8).



---

archive/issue_comments_446602.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nThanks for trying to test the patch. I'm not at all a sage expert, but I don't see how my patch would have caused this problem. Instead, the log file seems to suggest that it has to do with updating openblas (\"Uninstalling existing 'openblas'\", etc.), which should not be related to any changes in my patch. Your openblas does seem to be out of date (version 0.2.20.p2 instead of 0.3.6.p0), compared to my sage installation, but I am on Mac OS.\n\nCould you try building sage without the branch? If that works, then you could try to add the branch by using ./sage -br",
    "created_at": "2019-10-10T17:19:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446602",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:6'>Comment 6:</a>
Thanks for trying to test the patch. I'm not at all a sage expert, but I don't see how my patch would have caused this problem. Instead, the log file seems to suggest that it has to do with updating openblas ("Uninstalling existing 'openblas'", etc.), which should not be related to any changes in my patch. Your openblas does seem to be out of date (version 0.2.20.p2 instead of 0.3.6.p0), compared to my sage installation, but I am on Mac OS.

Could you try building sage without the branch? If that works, then you could try to add the branch by using ./sage -br



---

archive/issue_comments_446603.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nJust a minor note - I feel like we may have a way to generate warnings of this type that is more Sage-specific, similarly to how deprecations are handled.  On the other hand, I'm not sure we even want to generate warnings in standard output at all in this case, since there isn't anything mathematically wrong (I assume) done, just that we need big notes in the documentation for what will happen.  E.g. the `WARNING::` block in Sphinx, or whatever we use nowadays.\n\nThoughts?  Could be worth a sage-devel discussion if we don't have anything currently in the developer guide on this (not because this ticket is bad, just having a standardized way to deal with these things in the future will be helpful, if we don't already).",
    "created_at": "2019-10-13T01:39:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446603",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'>Comment 7:</a>
Just a minor note - I feel like we may have a way to generate warnings of this type that is more Sage-specific, similarly to how deprecations are handled.  On the other hand, I'm not sure we even want to generate warnings in standard output at all in this case, since there isn't anything mathematically wrong (I assume) done, just that we need big notes in the documentation for what will happen.  E.g. the `WARNING::` block in Sphinx, or whatever we use nowadays.

Thoughts?  Could be worth a sage-devel discussion if we don't have anything currently in the developer guide on this (not because this ticket is bad, just having a standardized way to deal with these things in the future will be helpful, if we don't already).



---

archive/issue_comments_446604.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nSorry, it didn't occur to me to write a warning in the docstring. I searched sage source for a function call that would produce a warning, but didn't find one. Instead, I found a function that printed a warning (I don't remember what), and I used that as a template. \n\nThere is indeed no mathematical error (that I know of). The warning addresses two issues: the user's request for a particular algorithm is being countermanded, and a small change in input may lead to a much slower calculation (because of the need to switch to the other algorithm).\n\nI defer to the sage experts (e.g., kcrisman) on what should be done. (A warning in the docs does seem reasonable to me. Or maybe there is no need for any warning at all.) I'll be happy to make whatever change is desired, but the branch is public, which I think means that anyone can fix it, without having to explain to me exactly what should be done.",
    "created_at": "2019-10-13T06:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446604",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:8'>Comment 8:</a>
Sorry, it didn't occur to me to write a warning in the docstring. I searched sage source for a function call that would produce a warning, but didn't find one. Instead, I found a function that printed a warning (I don't remember what), and I used that as a template. 

There is indeed no mathematical error (that I know of). The warning addresses two issues: the user's request for a particular algorithm is being countermanded, and a small change in input may lead to a much slower calculation (because of the need to switch to the other algorithm).

I defer to the sage experts (e.g., kcrisman) on what should be done. (A warning in the docs does seem reasonable to me. Or maybe there is no need for any warning at all.) I'll be happy to make whatever change is desired, but the branch is public, which I think means that anyone can fix it, without having to explain to me exactly what should be done.



---

archive/issue_comments_446605.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nOops. Even though the problem is dead easy, my code has a bug: start and stop should be cast to Integer before any comparison is made. We obviously want 90 < 100, but it is not true that \"90\" < \"100\". I'll make a PR to fix this.",
    "created_at": "2019-10-13T06:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446605",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:9'>Comment 9:</a>
Oops. Even though the problem is dead easy, my code has a bug: start and stop should be cast to Integer before any comparison is made. We obviously want 90 < 100, but it is not true that "90" < "100". I'll make a PR to fix this.



---

archive/issue_comments_446606.json:
```json
{
    "body": "Changed commit from **[587b0bb](https://github.com/sagemath/sagetrac-mirror/commit/587b0bbfc4eec029bbb41f134ad011c2b3550839)** to **[3e796ce](https://github.com/sagemath/sagetrac-mirror/commit/3e796ce2420a8124944512ddefd74f042e5510bc)**",
    "created_at": "2019-10-13T06:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446606",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[587b0bb](https://github.com/sagemath/sagetrac-mirror/commit/587b0bbfc4eec029bbb41f134ad011c2b3550839)** to **[3e796ce](https://github.com/sagemath/sagetrac-mirror/commit/3e796ce2420a8124944512ddefd74f042e5510bc)**



---

archive/issue_comments_446607.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e796ce2420a8124944512ddefd74f042e5510bc\">3e796ce</a></td><td><code>cast to Integer</code></td></tr></table>\n",
    "created_at": "2019-10-13T06:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446607",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e796ce2420a8124944512ddefd74f042e5510bc">3e796ce</a></td><td><code>cast to Integer</code></td></tr></table>




---

archive/issue_comments_446608.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nI have a question about the following:\n\n```\nsage: prime_range(\"90\",\"100\")\n[97]\n```\nThis syntax was not allowed before. What is the purpose?",
    "created_at": "2019-10-14T14:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446608",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:11'>Comment 11:</a>
I have a question about the following:

```
sage: prime_range("90","100")
[97]
```
This syntax was not allowed before. What is the purpose?



---

archive/issue_comments_446609.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nalso maybe the warning (if any) should be printed only once?",
    "created_at": "2019-10-14T14:41:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446609",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:12'>Comment 12:</a>
also maybe the warning (if any) should be printed only once?



---

archive/issue_comments_446610.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI don't know where the bound 1500 comes from, but in http://primerecords.dk/primegaps/maximal.htm we already see a gap of 1476 between primes of 61 bits, thus this bound might be wrong.",
    "created_at": "2019-10-14T14:49:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446610",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:13'>Comment 13:</a>
I don't know where the bound 1500 comes from, but in http://primerecords.dk/primegaps/maximal.htm we already see a gap of 1476 between primes of 61 bits, thus this bound might be wrong.



---

archive/issue_comments_446611.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\napart from the above tiny remarks, I have satisfied by this patch. Thank you!",
    "created_at": "2019-10-14T14:50:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446611",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:14'>Comment 14:</a>
apart from the above tiny remarks, I have satisfied by this patch. Thank you!



---

archive/issue_comments_446612.json:
```json
{
    "body": "Reviewer: **Paul Zimmermann**",
    "created_at": "2019-10-14T14:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446612",
    "user": "https://github.com/zimmermann6"
}
```

Reviewer: **Paul Zimmermann**



---

archive/issue_events_359427.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-10-14T14:51:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359427"
}
```



---

archive/issue_events_359428.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-10-14T14:51:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359428"
}
```



---

archive/issue_comments_446613.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@zimmermann6](#comment%3A11):\n> I have a question about the following:\n> \n> ```\n> sage: prime_range(\"90\",\"100\")\n> [97]\n> ```\n> This syntax was not allowed before. What is the purpose?\n\nThanks for your helpful comments. I'm sorry for taking so long to respond.\n\nIt's a surprise to me that this syntax was not allowed -- I assumed that it would be ok (but my cython knowledge is rudimentary and I never tested it).  It was accepted for the \"pari_isprime\" algorithm: \n\n```\nsage: prime_range(\"90\",\"100\", \"pari_isprime\")\n[97]\n```\nI would consider the incompatible behaviors of the two algorithms to be a (minor) bug.\n\nActually, though, my motivation for the doctest was not really about that particular syntax. The original code assumes that start and stop are integers (or None), and it's hard to predict how it will react if the user passes in some other type of object that is not exactly an integer. So I added `start = Integer(start)` (and similarly for stop), in order to make sure that each input will act exactly like an integer, and also to produce an understandable error message if the function is called on an unacceptable type. (My original code gave a misleading error message when the strings \"90\" and \"100\" were passed for start and stop. I think that message would give the clear impression that there was a bug, rather than user error.) It seems to me that type-checking or coercion should be in the code, but I don't know whether sage developers have some other standard convention for this.\n\nI added the doctest to verify that the `start = Integer(start)` patch is still there (but perhaps it would be better to have a doctest to confirm that non-Integer input produces a reasonable error message).",
    "created_at": "2019-10-24T01:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446613",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@zimmermann6](#comment%3A11):
> I have a question about the following:
> 
> ```
> sage: prime_range("90","100")
> [97]
> ```
> This syntax was not allowed before. What is the purpose?

Thanks for your helpful comments. I'm sorry for taking so long to respond.

It's a surprise to me that this syntax was not allowed -- I assumed that it would be ok (but my cython knowledge is rudimentary and I never tested it).  It was accepted for the "pari_isprime" algorithm: 

```
sage: prime_range("90","100", "pari_isprime")
[97]
```
I would consider the incompatible behaviors of the two algorithms to be a (minor) bug.

Actually, though, my motivation for the doctest was not really about that particular syntax. The original code assumes that start and stop are integers (or None), and it's hard to predict how it will react if the user passes in some other type of object that is not exactly an integer. So I added `start = Integer(start)` (and similarly for stop), in order to make sure that each input will act exactly like an integer, and also to produce an understandable error message if the function is called on an unacceptable type. (My original code gave a misleading error message when the strings "90" and "100" were passed for start and stop. I think that message would give the clear impression that there was a bug, rather than user error.) It seems to me that type-checking or coercion should be in the code, but I don't know whether sage developers have some other standard convention for this.

I added the doctest to verify that the `start = Integer(start)` patch is still there (but perhaps it would be better to have a doctest to confirm that non-Integer input produces a reasonable error message).



---

archive/issue_comments_446614.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [@zimmermann6](#comment%3A13):\n> I don't know where the bound 1500 comes from, but in http://primerecords.dk/primegaps/maximal.htm we already see a gap of 1476 between primes of 61 bits, thus this bound might be wrong.\n\nThat's a very good point! 1500 was already in the code and I assumed it had been chosen by a number theorist to be clearly large enough. However, we actually do not need `prime_gap_bound` to be anywhere near that large, because `c_stop` is less than than 436273290 in this part of the code. I have now revised the code to use a smaller value of `prime_gap_bound` (namely, 250) that can be confirmed by sage in less than 2 minutes on my 7-year-old laptop.\n\nPS The hardcoded limit 436273290 is because pari stores the list of small primes via a list of gaps between the primes, and no gap can be larger than 255. The first prime gap that is larger than 255 is from 436273009 to 436273291. So the prime 436273291 cannot be stored in this manner.",
    "created_at": "2019-10-24T01:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446614",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [@zimmermann6](#comment%3A13):
> I don't know where the bound 1500 comes from, but in http://primerecords.dk/primegaps/maximal.htm we already see a gap of 1476 between primes of 61 bits, thus this bound might be wrong.

That's a very good point! 1500 was already in the code and I assumed it had been chosen by a number theorist to be clearly large enough. However, we actually do not need `prime_gap_bound` to be anywhere near that large, because `c_stop` is less than than 436273290 in this part of the code. I have now revised the code to use a smaller value of `prime_gap_bound` (namely, 250) that can be confirmed by sage in less than 2 minutes on my 7-year-old laptop.

PS The hardcoded limit 436273290 is because pari stores the list of small primes via a list of gaps between the primes, and no gap can be larger than 255. The first prime gap that is larger than 255 is from 436273009 to 436273291. So the prime 436273291 cannot be stored in this manner.



---

archive/issue_comments_446615.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@zimmermann6](#comment%3A14):\n> apart from the above tiny remarks, I have satisfied by this patch. Thank you!\n\nThanks again for your comments! I will submit a PR that removes the warning. (Using a warning in this situation was an error in judgment on my part.) And I revised the docstring to be consistent with the new behaviour of the function, and made other edits in an attempt to make the documentation more clear and accurate.",
    "created_at": "2019-10-24T01:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446615",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@zimmermann6](#comment%3A14):
> apart from the above tiny remarks, I have satisfied by this patch. Thank you!

Thanks again for your comments! I will submit a PR that removes the warning. (Using a warning in this situation was an error in judgment on my part.) And I revised the docstring to be consistent with the new behaviour of the function, and made other edits in an attempt to make the documentation more clear and accurate.



---

archive/issue_comments_446616.json:
```json
{
    "body": "Changed commit from **[3e796ce](https://github.com/sagemath/sagetrac-mirror/commit/3e796ce2420a8124944512ddefd74f042e5510bc)** to **[acde22a](https://github.com/sagemath/sagetrac-mirror/commit/acde22add15084bb0a8efd69b15bf9caf09adfa3)**",
    "created_at": "2019-10-24T01:41:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446616",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3e796ce](https://github.com/sagemath/sagetrac-mirror/commit/3e796ce2420a8124944512ddefd74f042e5510bc)** to **[acde22a](https://github.com/sagemath/sagetrac-mirror/commit/acde22add15084bb0a8efd69b15bf9caf09adfa3)**



---

archive/issue_comments_446617.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a1fe5a317e180f22392681100bc65ed37ac769b\">8a1fe5a</a></td><td><code>eliminated warning and replaced 1500 with 250</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acde22add15084bb0a8efd69b15bf9caf09adfa3\">acde22a</a></td><td><code>revised docstring</code></td></tr></table>\n",
    "created_at": "2019-10-24T01:41:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446617",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a1fe5a317e180f22392681100bc65ed37ac769b">8a1fe5a</a></td><td><code>eliminated warning and replaced 1500 with 250</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acde22add15084bb0a8efd69b15bf9caf09adfa3">acde22a</a></td><td><code>revised docstring</code></td></tr></table>




---

archive/issue_events_359429.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-24T03:33:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359429"
}
```



---

archive/issue_events_359430.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-24T03:33:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359430"
}
```



---

archive/issue_events_359431.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-24T06:32:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359431"
}
```



---

archive/issue_events_359432.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-24T06:32:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359432"
}
```



---

archive/issue_comments_446618.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nFailed doctest:\n\n```\nFile \"src/sage/functions/prime_pi.pyx\", line 454, in sage.functions.prime_pi.PrimePi.plot\nFailed example:\n    prime_pi.plot(-2, sqrt(2501), thickness=2, vertical_lines=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.functions.prime_pi.PrimePi.plot[1]>\", line 1, in <module>\n        prime_pi.plot(-Integer(2), sqrt(Integer(2501)), thickness=Integer(2), vertical_lines=False)\n      File \"sage/functions/prime_pi.pyx\", line 465, in sage.functions.prime_pi.PrimePi.plot (build/cythonized/sage/functions/prime_pi.c:6223)\n        for p in prime_range(xmin+1, xmax+1, py_ints=True):\n      File \"sage/rings/fast_arith.pyx\", line 48, in sage.rings.fast_arith.prime_range (build/cythonized/sage/rings/fast_arith.c:3429)\n        cpdef prime_range(start, stop=None, algorithm=\"pari_primes\", bint py_ints=False):\n      File \"sage/rings/fast_arith.pyx\", line 145, in sage.rings.fast_arith.prime_range (build/cythonized/sage/rings/fast_arith.c:2760)\n        stop = Integer(stop)\n      File \"sage/rings/integer.pyx\", line 692, in sage.rings.integer.Integer.__init__ (build/cythonized/sage/rings/integer.c:6191)\n        set_from_Integer(self, otmp(the_integer_ring))\n      File \"sage/symbolic/expression.pyx\", line 1086, in sage.symbolic.expression.Expression._integer_ (build/cythonized/sage/symbolic/expression.cpp:8681)\n        raise TypeError(\"unable to convert %r to an integer\" % self)\n    TypeError: unable to convert sqrt(2501) + 1 to an integer\n```\nI will need to think about this. \n\nThe failed example calls `prime_range` with an argument that is a non-integer real number, which I did not think was allowed. It seems that, for backward compatibility, such an argument needs to be allowed at least when `algorithm=\"pari_primes\"`, even though the original function gives a `TypeError` when `algorithm=\"is_prime\"`.",
    "created_at": "2019-10-24T06:32:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446618",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:21'>Comment 21:</a>
Failed doctest:

```
File "src/sage/functions/prime_pi.pyx", line 454, in sage.functions.prime_pi.PrimePi.plot
Failed example:
    prime_pi.plot(-2, sqrt(2501), thickness=2, vertical_lines=False)
Exception raised:
    Traceback (most recent call last):
      File "/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.functions.prime_pi.PrimePi.plot[1]>", line 1, in <module>
        prime_pi.plot(-Integer(2), sqrt(Integer(2501)), thickness=Integer(2), vertical_lines=False)
      File "sage/functions/prime_pi.pyx", line 465, in sage.functions.prime_pi.PrimePi.plot (build/cythonized/sage/functions/prime_pi.c:6223)
        for p in prime_range(xmin+1, xmax+1, py_ints=True):
      File "sage/rings/fast_arith.pyx", line 48, in sage.rings.fast_arith.prime_range (build/cythonized/sage/rings/fast_arith.c:3429)
        cpdef prime_range(start, stop=None, algorithm="pari_primes", bint py_ints=False):
      File "sage/rings/fast_arith.pyx", line 145, in sage.rings.fast_arith.prime_range (build/cythonized/sage/rings/fast_arith.c:2760)
        stop = Integer(stop)
      File "sage/rings/integer.pyx", line 692, in sage.rings.integer.Integer.__init__ (build/cythonized/sage/rings/integer.c:6191)
        set_from_Integer(self, otmp(the_integer_ring))
      File "sage/symbolic/expression.pyx", line 1086, in sage.symbolic.expression.Expression._integer_ (build/cythonized/sage/symbolic/expression.cpp:8681)
        raise TypeError("unable to convert %r to an integer" % self)
    TypeError: unable to convert sqrt(2501) + 1 to an integer
```
I will need to think about this. 

The failed example calls `prime_range` with an argument that is a non-integer real number, which I did not think was allowed. It seems that, for backward compatibility, such an argument needs to be allowed at least when `algorithm="pari_primes"`, even though the original function gives a `TypeError` when `algorithm="is_prime"`.



---

archive/issue_comments_446619.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI do not see any reason to reject real numbers as inputs. (I don't think I ever realized before that the Python function `range` accepts real numbers.) So I have revised the code to take real numbers, and I added a note to the docstring.",
    "created_at": "2019-10-28T04:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446619",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:22'>Comment 22:</a>
I do not see any reason to reject real numbers as inputs. (I don't think I ever realized before that the Python function `range` accepts real numbers.) So I have revised the code to take real numbers, and I added a note to the docstring.



---

archive/issue_comments_446620.json:
```json
{
    "body": "Changed commit from **[acde22a](https://github.com/sagemath/sagetrac-mirror/commit/acde22add15084bb0a8efd69b15bf9caf09adfa3)** to **[27603bb](https://github.com/sagemath/sagetrac-mirror/commit/27603bb1a3bcbe456aabd7b789439dd4c91e1fec)**",
    "created_at": "2019-10-28T04:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446620",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[acde22a](https://github.com/sagemath/sagetrac-mirror/commit/acde22add15084bb0a8efd69b15bf9caf09adfa3)** to **[27603bb](https://github.com/sagemath/sagetrac-mirror/commit/27603bb1a3bcbe456aabd7b789439dd4c91e1fec)**



---

archive/issue_comments_446621.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4afb8861e39cf7084cd578344fa2f430c929a8aa\">4afb886</a></td><td><code>allow reals</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3bc1290838a0909b904a34ba02857045cd42b801\">3bc1290</a></td><td><code>added note to docstring</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27603bb1a3bcbe456aabd7b789439dd4c91e1fec\">27603bb</a></td><td><code>added real number to doctest</code></td></tr></table>\n",
    "created_at": "2019-10-28T04:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446621",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4afb8861e39cf7084cd578344fa2f430c929a8aa">4afb886</a></td><td><code>allow reals</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3bc1290838a0909b904a34ba02857045cd42b801">3bc1290</a></td><td><code>added note to docstring</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27603bb1a3bcbe456aabd7b789439dd4c91e1fec">27603bb</a></td><td><code>added real number to doctest</code></td></tr></table>




---

archive/issue_events_359433.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-28T07:43:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359433"
}
```



---

archive/issue_events_359434.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-10-28T07:43:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359434"
}
```



---

archive/issue_comments_446622.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nI'm dubious about allowing real numbers and strings. This was not allowed before, and if you propose to change this behaviour, I believe this should be in a separate ticket. If so, I would give a positive review.",
    "created_at": "2019-11-04T15:40:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446622",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:25'>Comment 25:</a>
I'm dubious about allowing real numbers and strings. This was not allowed before, and if you propose to change this behaviour, I believe this should be in a separate ticket. If so, I would give a positive review.



---

archive/issue_comments_446623.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nYou are right. I was confused. Before I started work on this, the algorithm \"pari_primes\" allowed real numbers, and the algorithm \"pari_isprime\" allowed strings, but neither allowed both. I will upload a PR to restore this behavior (i.e., the patch removes the code that tests and coerces the input). The patch also mentions this behavior in a note in the docstring.\n\nI opened ticket:28712 to discuss the allowable input.",
    "created_at": "2019-11-08T19:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446623",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:26'>Comment 26:</a>
You are right. I was confused. Before I started work on this, the algorithm "pari_primes" allowed real numbers, and the algorithm "pari_isprime" allowed strings, but neither allowed both. I will upload a PR to restore this behavior (i.e., the patch removes the code that tests and coerces the input). The patch also mentions this behavior in a note in the docstring.

I opened ticket:28712 to discuss the allowable input.



---

archive/issue_comments_446624.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d6ac58c505f329a7682565d4a3b92f2bbcc7dae0\">d6ac58c</a></td><td><code>remove input coercion</code></td></tr></table>\n",
    "created_at": "2019-11-08T20:07:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446624",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>Comment 27:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d6ac58c505f329a7682565d4a3b92f2bbcc7dae0">d6ac58c</a></td><td><code>remove input coercion</code></td></tr></table>




---

archive/issue_comments_446625.json:
```json
{
    "body": "Changed commit from **[27603bb](https://github.com/sagemath/sagetrac-mirror/commit/27603bb1a3bcbe456aabd7b789439dd4c91e1fec)** to **[d6ac58c](https://github.com/sagemath/sagetrac-mirror/commit/d6ac58c505f329a7682565d4a3b92f2bbcc7dae0)**",
    "created_at": "2019-11-08T20:07:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446625",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[27603bb](https://github.com/sagemath/sagetrac-mirror/commit/27603bb1a3bcbe456aabd7b789439dd4c91e1fec)** to **[d6ac58c](https://github.com/sagemath/sagetrac-mirror/commit/d6ac58c505f329a7682565d4a3b92f2bbcc7dae0)**



---

archive/issue_events_359435.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-11-13T10:15:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359435"
}
```



---

archive/issue_events_359436.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-11-13T10:15:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359436"
}
```



---

archive/issue_comments_446626.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nI give a positive review, but I'm still unable to try the new code because Sage fails to build on my machine (see #28104, comment [comment:12]).",
    "created_at": "2019-11-13T10:15:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446626",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:28'>Comment 28:</a>
I give a positive review, but I'm still unable to try the new code because Sage fails to build on my machine (see #28104, comment [comment:12]).



---

archive/issue_events_359437.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-11-13T20:10:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359437"
}
```



---

archive/issue_events_359438.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-11-13T20:10:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359438"
}
```



---

archive/issue_events_359439.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-11-16T12:49:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359439"
}
```



---

archive/issue_events_359440.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-11-16T12:49:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359440"
}
```



---

archive/issue_comments_446627.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nThis causes various py3-related test failures",
    "created_at": "2019-11-16T12:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446627",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'>Comment 30:</a>
This causes various py3-related test failures



---

archive/issue_comments_446628.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\n(which will be the default in the next beta, so mere that one in and run tests)",
    "created_at": "2019-11-16T12:50:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446628",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'>Comment 31:</a>
(which will be the default in the next beta, so mere that one in and run tests)



---

archive/issue_comments_446629.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nOK, I'm compiling a Python-3 version of sage, and I will try to figure out what is wrong. (I don't see how my \"innocent little patch\" could be causing build errors outside the file that I touched, so this is a learning opportunity for me.)",
    "created_at": "2019-11-19T01:59:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446629",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:32'>Comment 32:</a>
OK, I'm compiling a Python-3 version of sage, and I will try to figure out what is wrong. (I don't see how my "innocent little patch" could be causing build errors outside the file that I touched, so this is a learning opportunity for me.)



---

archive/issue_comments_446630.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nBug is fixed: we no longer ask `max` to compare an integer with `None`. This should eliminate the doctest failures, but I do not know why some of the patchbots gave build errors -- the problems do not seem to be related to this patch.\n\nUnfortunately, I cannot do a full doctest because I have not yet been able to compile a good copy of Python 3 sage. (My Mac OS Catalina installation has many doctest failures on an unmodified copy of the develop branch.)",
    "created_at": "2019-12-28T03:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446630",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:33'>Comment 33:</a>
Bug is fixed: we no longer ask `max` to compare an integer with `None`. This should eliminate the doctest failures, but I do not know why some of the patchbots gave build errors -- the problems do not seem to be related to this patch.

Unfortunately, I cannot do a full doctest because I have not yet been able to compile a good copy of Python 3 sage. (My Mac OS Catalina installation has many doctest failures on an unmodified copy of the develop branch.)



---

archive/issue_events_359441.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-12-28T03:58:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359441"
}
```



---

archive/issue_events_359442.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-12-28T03:58:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359442"
}
```



---

archive/issue_comments_446631.json:
```json
{
    "body": "Changed commit from **[d6ac58c](https://github.com/sagemath/sagetrac-mirror/commit/d6ac58c505f329a7682565d4a3b92f2bbcc7dae0)** to **[1754c2f](https://github.com/sagemath/sagetrac-mirror/commit/1754c2f3093d419bcf8d8c0e0e0a021b7d5ff3fa)**",
    "created_at": "2019-12-28T03:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446631",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d6ac58c](https://github.com/sagemath/sagetrac-mirror/commit/d6ac58c505f329a7682565d4a3b92f2bbcc7dae0)** to **[1754c2f](https://github.com/sagemath/sagetrac-mirror/commit/1754c2f3093d419bcf8d8c0e0e0a021b7d5ff3fa)**



---

archive/issue_comments_446632.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7cb0a27a1716ff15549228b58e7077f72ebddfa9\">7cb0a27</a></td><td><code>Merge branch 'fix_prime_range' into fix_prime_range_py3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1754c2f3093d419bcf8d8c0e0e0a021b7d5ff3fa\">1754c2f</a></td><td><code>bug fix: max does not compare integer with None</code></td></tr></table>\n",
    "created_at": "2019-12-28T03:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446632",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:34'>Comment 34:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7cb0a27a1716ff15549228b58e7077f72ebddfa9">7cb0a27</a></td><td><code>Merge branch 'fix_prime_range' into fix_prime_range_py3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1754c2f3093d419bcf8d8c0e0e0a021b7d5ff3fa">1754c2f</a></td><td><code>bug fix: max does not compare integer with None</code></td></tr></table>




---

archive/issue_events_359443.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-12-30T18:22:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359443"
}
```



---

archive/issue_events_359444.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2019-12-30T18:22:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359444"
}
```



---

archive/issue_comments_446633.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nLooks like this has a couple of clean patchbot runs under Py3 (which is officially the default now that 9.0 is released).",
    "created_at": "2020-01-01T23:35:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446633",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:36'>Comment 36:</a>
Looks like this has a couple of clean patchbot runs under Py3 (which is officially the default now that 9.0 is released).



---

archive/issue_comments_446634.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nbranch no longer applies cleanly",
    "created_at": "2020-02-15T10:52:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446634",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'>Comment 37:</a>
branch no longer applies cleanly



---

archive/issue_events_359445.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-15T10:52:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359445"
}
```



---

archive/issue_events_359446.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-15T10:52:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359446"
}
```



---

archive/issue_comments_446635.json:
```json
{
    "body": "Changed commit from **[1754c2f](https://github.com/sagemath/sagetrac-mirror/commit/1754c2f3093d419bcf8d8c0e0e0a021b7d5ff3fa)** to **[097ae95](https://github.com/sagemath/sagetrac-mirror/commit/097ae9503452adce65cc69e9e73e0d9195227507)**",
    "created_at": "2020-03-12T01:25:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446635",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1754c2f](https://github.com/sagemath/sagetrac-mirror/commit/1754c2f3093d419bcf8d8c0e0e0a021b7d5ff3fa)** to **[097ae95](https://github.com/sagemath/sagetrac-mirror/commit/097ae9503452adce65cc69e9e73e0d9195227507)**



---

archive/issue_comments_446636.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/097ae9503452adce65cc69e9e73e0d9195227507\">097ae95</a></td><td><code>merge with 9.1b6 to fix conflict with #29123</code></td></tr></table>\n",
    "created_at": "2020-03-12T01:25:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446636",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:38'>Comment 38:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/097ae9503452adce65cc69e9e73e0d9195227507">097ae95</a></td><td><code>merge with 9.1b6 to fix conflict with #29123</code></td></tr></table>




---

archive/issue_events_359447.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-03-12T01:28:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359447"
}
```



---

archive/issue_events_359448.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-03-12T01:28:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359448"
}
```



---

archive/issue_comments_446637.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nMerged with 9.1b6 to fix the conflict with #29123, which revised the documentation.",
    "created_at": "2020-03-12T01:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446637",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:39'>Comment 39:</a>
Merged with 9.1b6 to fix the conflict with #29123, which revised the documentation.



---

archive/issue_comments_446638.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nI tried not to mess up the intent of #29123, but I think chapoton should be informed that I revised the docstring.",
    "created_at": "2020-03-12T01:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446638",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:40'>Comment 40:</a>
I tried not to mess up the intent of #29123, but I think chapoton should be informed that I revised the docstring.



---

archive/issue_comments_446639.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nThe change in behavior you proposed is bad. If a user provides `algorithm=\"pari_primes\"` the function should not silently switch to the `\"pari_isprime\"` version. The adaptation should only applies when the algorithm is not explicitly specified.\n\nAlso, the NOTE is more confusing than anything else. You don't want to document that kind of behavior that forces you to stick to it in the future. If you feel it needs something, simply write: `if the input is not numerical then the behavior is not specified.`\n\nMinor comments\n- Instead of writing <code>The sage command \\`\\`primes\\`\\`</code> you would better use references <code>The sage command :func:\\`~sage.arith.misc.primes\\`</code>. That produces a link in the compiled documentation.\n- To describe strings as argument I think Sage preferrs <code>\\`\\`\"pari_primes\"\\`\\`</code> rather than `\"pari_primes\"`.\n- Don't write `trac ticket 28467` but <code>:trac:\\`28467\\`</code> (which produces a link in the compiled documentation).\n- Please test `prime_range(9.5, 14.3)` with both `\"pari_primes\"` and `\"pari_isprime\"`.",
    "created_at": "2020-04-12T08:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446639",
    "user": "https://github.com/videlec"
}
```

<a id='comment:41'>Comment 41:</a>
The change in behavior you proposed is bad. If a user provides `algorithm="pari_primes"` the function should not silently switch to the `"pari_isprime"` version. The adaptation should only applies when the algorithm is not explicitly specified.

Also, the NOTE is more confusing than anything else. You don't want to document that kind of behavior that forces you to stick to it in the future. If you feel it needs something, simply write: `if the input is not numerical then the behavior is not specified.`

Minor comments
- Instead of writing <code>The sage command \`\`primes\`\`</code> you would better use references <code>The sage command :func:\`~sage.arith.misc.primes\`</code>. That produces a link in the compiled documentation.
- To describe strings as argument I think Sage preferrs <code>\`\`"pari_primes"\`\`</code> rather than `"pari_primes"`.
- Don't write `trac ticket 28467` but <code>:trac:\`28467\`</code> (which produces a link in the compiled documentation).
- Please test `prime_range(9.5, 14.3)` with both `"pari_primes"` and `"pari_isprime"`.



---

archive/issue_events_359449.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-12T08:19:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359449"
}
```



---

archive/issue_events_359450.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-12T08:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359450"
}
```



---

archive/issue_comments_446640.json:
```json
{
    "body": "Changed commit from **[097ae95](https://github.com/sagemath/sagetrac-mirror/commit/097ae9503452adce65cc69e9e73e0d9195227507)** to **[3922747](https://github.com/sagemath/sagetrac-mirror/commit/392274775a13b653482258179f2d87581385227b)**",
    "created_at": "2020-04-12T22:31:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446640",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[097ae95](https://github.com/sagemath/sagetrac-mirror/commit/097ae9503452adce65cc69e9e73e0d9195227507)** to **[3922747](https://github.com/sagemath/sagetrac-mirror/commit/392274775a13b653482258179f2d87581385227b)**



---

archive/issue_comments_446641.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/392274775a13b653482258179f2d87581385227b\">3922747</a></td><td><code>corrections pointed out by reviewer</code></td></tr></table>\n",
    "created_at": "2020-04-12T22:31:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446641",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:43'>Comment 43:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/392274775a13b653482258179f2d87581385227b">3922747</a></td><td><code>corrections pointed out by reviewer</code></td></tr></table>




---

archive/issue_comments_446642.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nThanks for the corrections!\n\nPS IMHO, the two algorithms should have similar behavior, so the followup ticket #28712 addresses the fact that `prime_range(9.5, 14.3)` raises an error for one algorithm, but not the other.",
    "created_at": "2020-04-12T22:40:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446642",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:44'>Comment 44:</a>
Thanks for the corrections!

PS IMHO, the two algorithms should have similar behavior, so the followup ticket #28712 addresses the fact that `prime_range(9.5, 14.3)` raises an error for one algorithm, but not the other.



---

archive/issue_events_359451.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-12T22:40:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359451"
}
```



---

archive/issue_events_359452.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-12T22:40:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359452"
}
```



---

archive/issue_comments_446643.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nReplying to [@DaveWitteMorris](#comment%3A44):\n> Thanks for the corrections!\n> \n> PS IMHO, the two algorithms should have similar behavior,\n\nWhy is that? If one can not do beyond `436273290` and the other can, we should restrict the latter to not do it so that they behave the same?\n\n> so the followup ticket #28712 addresses the fact that `prime_range(9.5, 14.3)` raises an error for one algorithm, but not the other.\n\nThis is about the interface, and I agree that it should be consistent.",
    "created_at": "2020-04-15T07:34:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446643",
    "user": "https://github.com/videlec"
}
```

<a id='comment:45'>Comment 45:</a>
Replying to [@DaveWitteMorris](#comment%3A44):
> Thanks for the corrections!
> 
> PS IMHO, the two algorithms should have similar behavior,

Why is that? If one can not do beyond `436273290` and the other can, we should restrict the latter to not do it so that they behave the same?

> so the followup ticket #28712 addresses the fact that `prime_range(9.5, 14.3)` raises an error for one algorithm, but not the other.

This is about the interface, and I agree that it should be consistent.



---

archive/issue_comments_446644.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nYou're right: \"behavior\" was the wrong word. I'm glad you agree that the interface (or this part, at least) should be consistent.",
    "created_at": "2020-04-15T07:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446644",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:46'>Comment 46:</a>
You're right: "behavior" was the wrong word. I'm glad you agree that the interface (or this part, at least) should be consistent.



---

archive/issue_comments_446645.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nPlease clarify what you are trying to do with prime_pi. Doctest are not meant for comments about the code such as\n\n```\nTo avoid a doctest error in functions/prime_pi.pyx, prime_range must allow real input::\n```\nFirst of all, while reading the documentation nobody cares about the doctests in distinct files. Even though the information might be relevant for someone, its place is not in the doc. Moreover, if there is a doctest in `functions/prime_pi.pyx` why would you need to duplicate it here? Finally, if somebody decides to fix the underlying problem in `functions/prime_pi.pyx`, this doctest will remain here for no good reason at all.",
    "created_at": "2020-04-15T07:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446645",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'>Comment 47:</a>
Please clarify what you are trying to do with prime_pi. Doctest are not meant for comments about the code such as

```
To avoid a doctest error in functions/prime_pi.pyx, prime_range must allow real input::
```
First of all, while reading the documentation nobody cares about the doctests in distinct files. Even though the information might be relevant for someone, its place is not in the doc. Moreover, if there is a doctest in `functions/prime_pi.pyx` why would you need to duplicate it here? Finally, if somebody decides to fix the underlying problem in `functions/prime_pi.pyx`, this doctest will remain here for no good reason at all.



---

archive/issue_comments_446646.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nI was trying to be helpful (I was surprised that one of my edits caused a doctest failure in `functions/prime_pi.pyx`), but I now understand, from your explanation, that this redundant doctest is problematic.  I will delete it.",
    "created_at": "2020-04-15T07:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446646",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:48'>Comment 48:</a>
I was trying to be helpful (I was surprised that one of my edits caused a doctest failure in `functions/prime_pi.pyx`), but I now understand, from your explanation, that this redundant doctest is problematic.  I will delete it.



---

archive/issue_comments_446647.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/252a71269963822838e36856a64c562b3b2a7258\">252a712</a></td><td><code>remove redundant doctest</code></td></tr></table>\n",
    "created_at": "2020-04-15T08:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446647",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:49'>Comment 49:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/252a71269963822838e36856a64c562b3b2a7258">252a712</a></td><td><code>remove redundant doctest</code></td></tr></table>




---

archive/issue_comments_446648.json:
```json
{
    "body": "Changed commit from **[3922747](https://github.com/sagemath/sagetrac-mirror/commit/392274775a13b653482258179f2d87581385227b)** to **[252a712](https://github.com/sagemath/sagetrac-mirror/commit/252a71269963822838e36856a64c562b3b2a7258)**",
    "created_at": "2020-04-15T08:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446648",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3922747](https://github.com/sagemath/sagetrac-mirror/commit/392274775a13b653482258179f2d87581385227b)** to **[252a712](https://github.com/sagemath/sagetrac-mirror/commit/252a71269963822838e36856a64c562b3b2a7258)**



---

archive/issue_events_359453.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-07T02:29:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359453"
}
```



---

archive/issue_events_359454.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-07T02:29:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359454"
}
```



---

archive/issue_comments_446649.json:
```json
{
    "body": "Changed reviewer from **Paul Zimmermann** to **Paul Zimmermann, Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix, Samuel Leli\u00e8vre**",
    "created_at": "2020-08-22T19:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446649",
    "user": "https://github.com/slel"
}
```

Changed reviewer from **Paul Zimmermann** to **Paul Zimmermann, Frédéric Chapoton, Vincent Delecroix, Samuel Lelièvre**



---

archive/issue_comments_446650.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nMinor style comments.\n\nCompare to `None` with `is`, not `==`:\n\n```diff\n-    if algorithm == None:\n+    if algorithm is None:\n```\n\nTwo spaces before `#` for inline comments:\n\n```diff\n-    DEF small_prime_max = 436273009 # a prime < init_primes_max (preferably the largest)\n-    DEF prime_gap_bound = 250 # upper bound for gap between primes <= small_prime_max\n+    DEF small_prime_max = 436273009  # a prime < init_primes_max (preferably the largest)\n+    DEF prime_gap_bound = 250  # upper bound for gap between primes <= small_prime_max\n```\n\nProposed rephrasing and reformatting for the `ValueError` message:\n\n```diff\n         if max(start, stop or 0) > small_prime_max:\n-            raise ValueError('algorithm \"pari_primes\" cannot compute primes larger than'\n-                + ' {}'.format(small_prime_max - 1))\n+            s = 'algorithm \"pari_primes\" is limited to primes less than {}'\n+            raise ValueError(s.format(small_prime_max - 1))\n```\n\nPatchbots are happy. What do other reviewers think?",
    "created_at": "2020-08-22T19:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446650",
    "user": "https://github.com/slel"
}
```

<a id='comment:51'>Comment 51:</a>
Minor style comments.

Compare to `None` with `is`, not `==`:

```diff
-    if algorithm == None:
+    if algorithm is None:
```

Two spaces before `#` for inline comments:

```diff
-    DEF small_prime_max = 436273009 # a prime < init_primes_max (preferably the largest)
-    DEF prime_gap_bound = 250 # upper bound for gap between primes <= small_prime_max
+    DEF small_prime_max = 436273009  # a prime < init_primes_max (preferably the largest)
+    DEF prime_gap_bound = 250  # upper bound for gap between primes <= small_prime_max
```

Proposed rephrasing and reformatting for the `ValueError` message:

```diff
         if max(start, stop or 0) > small_prime_max:
-            raise ValueError('algorithm "pari_primes" cannot compute primes larger than'
-                + ' {}'.format(small_prime_max - 1))
+            s = 'algorithm "pari_primes" is limited to primes less than {}'
+            raise ValueError(s.format(small_prime_max - 1))
```

Patchbots are happy. What do other reviewers think?



---

archive/issue_comments_446651.json:
```json
{
    "body": "Changed commit from **[252a712](https://github.com/sagemath/sagetrac-mirror/commit/252a71269963822838e36856a64c562b3b2a7258)** to **[d21a0d4](https://github.com/sagemath/sagetrac-mirror/commit/d21a0d4969390e0fe4b286967142912c37acc7ef)**",
    "created_at": "2020-09-08T11:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446651",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[252a712](https://github.com/sagemath/sagetrac-mirror/commit/252a71269963822838e36856a64c562b3b2a7258)** to **[d21a0d4](https://github.com/sagemath/sagetrac-mirror/commit/d21a0d4969390e0fe4b286967142912c37acc7ef)**



---

archive/issue_comments_446652.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bba5b11eb86a101bf2af6a0ac386d0b9929f5f64\">bba5b11</a></td><td><code>Merge remote-tracking branch 'trac/develop' into public/fix_prime_range</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d21a0d4969390e0fe4b286967142912c37acc7ef\">d21a0d4</a></td><td><code>reviewer's comments</code></td></tr></table>\n",
    "created_at": "2020-09-08T11:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446652",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:52'>Comment 52:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bba5b11eb86a101bf2af6a0ac386d0b9929f5f64">bba5b11</a></td><td><code>Merge remote-tracking branch 'trac/develop' into public/fix_prime_range</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d21a0d4969390e0fe4b286967142912c37acc7ef">d21a0d4</a></td><td><code>reviewer's comments</code></td></tr></table>




---

archive/issue_comments_446653.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314\">18e4819</a></td><td><code>adjust doctest</code></td></tr></table>\n",
    "created_at": "2020-09-08T11:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446653",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:53'>Comment 53:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314">18e4819</a></td><td><code>adjust doctest</code></td></tr></table>




---

archive/issue_comments_446654.json:
```json
{
    "body": "Changed commit from **[d21a0d4](https://github.com/sagemath/sagetrac-mirror/commit/d21a0d4969390e0fe4b286967142912c37acc7ef)** to **[18e4819](https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314)**",
    "created_at": "2020-09-08T11:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446654",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d21a0d4](https://github.com/sagemath/sagetrac-mirror/commit/d21a0d4969390e0fe4b286967142912c37acc7ef)** to **[18e4819](https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314)**



---

archive/issue_comments_446655.json:
```json
{
    "body": "Changed reviewer from **Paul Zimmermann, Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix, Samuel Leli\u00e8vre** to **Paul Zimmermann, Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix, Samuel Leli\u00e8vre, Dima Pasechnik**",
    "created_at": "2020-09-08T12:05:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446655",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Paul Zimmermann, Frédéric Chapoton, Vincent Delecroix, Samuel Lelièvre** to **Paul Zimmermann, Frédéric Chapoton, Vincent Delecroix, Samuel Lelièvre, Dima Pasechnik**



---

archive/issue_comments_446656.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nlgtm",
    "created_at": "2020-09-08T12:05:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446656",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:54'>Comment 54:</a>
lgtm



---

archive/issue_events_359455.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-08T12:05:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359455"
}
```



---

archive/issue_events_359456.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-08T12:05:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359456"
}
```



---

archive/issue_comments_446657.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nThanks for the corrections, and the review!",
    "created_at": "2020-09-20T04:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446657",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:55'>Comment 55:</a>
Thanks for the corrections, and the review!



---

archive/issue_events_359457.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359457"
}
```



---

archive/issue_events_359458.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359458"
}
```



---

archive/issue_events_359459.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-07T16:23:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359459"
}
```



---

archive/issue_events_359460.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b2e2dd83816b22b64c5a927bf4b59d818e6e8986",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-11-07T16:23:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28467#event-359460"
}
```



---

archive/issue_comments_446658.json:
```json
{
    "body": "Changed branch from **[public/fix_prime_range](https://github.com/sagemath/sagetrac-mirror/tree/public/fix_prime_range)** to **[18e4819](https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314)**",
    "created_at": "2020-11-07T16:23:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28467#issuecomment-446658",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/fix_prime_range](https://github.com/sagemath/sagetrac-mirror/tree/public/fix_prime_range)** to **[18e4819](https://github.com/sagemath/sagetrac-mirror/commit/18e481910ad1785bf9fde990fab68ff75a4a7314)**
