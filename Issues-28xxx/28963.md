# Issue 28963: Dilation of polyhedron with both Vrep and Hrep (if backend supports it)

archive/issues_028963.json:
```json
{
    "body": "CC:  @jplab @laisrast\n\nKeywords: polyhedra, dilation, precomputed data\n\nCurrently the dilation of a polyhedron is done by computing the new double description from the new vertices.\n\nWith #28880 at hand, we can specify both Vrep and Hrep and the backend will use both (if available) or the shorter description. Either way, this will improve performance of polyhedra with many vertices but few facets (e.g. a hypercube).\n\nBefore this ticket we had the following timings:\n\n```\nsage: P = polytopes.hypercube(14)\nsage: %time _ = 2*P\nCPU times: user 2.77 s, sys: 19.8 ms, total: 2.79 s\nWall time: 2.79 s\nsage: P = polytopes.hypercube(7, backend='field')\nsage: %time _ = 2*P\nCPU times: user 3.58 s, sys: 35 \u00b5s, total: 3.58 s\nWall time: 3.58 s\nsage: P = polytopes.cross_polytope(8, backend='field')\nsage: %time _ = 2*P\nCPU times: user 15.5 s, sys: 23.9 ms, total: 15.6 s\nWall time: 15.6 s\nsage: P = polytopes.cross_polytope(13)\nsage: %time _ = 2*P\nCPU times: user 395 ms, sys: 0 ns, total: 395 ms\nWall time: 394 ms\n```\n\nWith this ticket we have:\n\n```\nsage: P = polytopes.hypercube(14)\nsage: %time _ = 2*P\nCPU times: user 589 ms, sys: 6 \u00b5s, total: 589 ms\nWall time: 588 ms\nsage: P = polytopes.hypercube(7, backend='field')\nsage: %time _ = 2*P\nCPU times: user 14.1 ms, sys: 0 ns, total: 14.1 ms\nWall time: 14.1 ms\nsage: P = polytopes.cross_polytope(8, backend='field')\nsage: %time _ = 2*P\nCPU times: user 49.2 ms, sys: 0 ns, total: 49.2 ms\nWall time: 48.3 ms\nsage: P = polytopes.cross_polytope(13)\nsage: %time _ = 2*P\nCPU times: user 428 ms, sys: 8.08 ms, total: 436 ms\nWall time: 436 ms\n```\n\nNote that for the last timing, the choice of only specifying Vrep was already good (at least for backend `ppl`). So with the new setup, thinks take a bit more time, as `dilation` computes the new Hrep, which `ppl` discards then.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29200\n\n",
    "closed_at": "2020-03-08T11:27:15Z",
    "created_at": "2020-02-14T16:10:16Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Dilation of polyhedron with both Vrep and Hrep (if backend supports it)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28963",
    "user": "https://github.com/kliem"
}
```
CC:  @jplab @laisrast

Keywords: polyhedra, dilation, precomputed data

Currently the dilation of a polyhedron is done by computing the new double description from the new vertices.

With #28880 at hand, we can specify both Vrep and Hrep and the backend will use both (if available) or the shorter description. Either way, this will improve performance of polyhedra with many vertices but few facets (e.g. a hypercube).

Before this ticket we had the following timings:

```
sage: P = polytopes.hypercube(14)
sage: %time _ = 2*P
CPU times: user 2.77 s, sys: 19.8 ms, total: 2.79 s
Wall time: 2.79 s
sage: P = polytopes.hypercube(7, backend='field')
sage: %time _ = 2*P
CPU times: user 3.58 s, sys: 35 µs, total: 3.58 s
Wall time: 3.58 s
sage: P = polytopes.cross_polytope(8, backend='field')
sage: %time _ = 2*P
CPU times: user 15.5 s, sys: 23.9 ms, total: 15.6 s
Wall time: 15.6 s
sage: P = polytopes.cross_polytope(13)
sage: %time _ = 2*P
CPU times: user 395 ms, sys: 0 ns, total: 395 ms
Wall time: 394 ms
```

With this ticket we have:

```
sage: P = polytopes.hypercube(14)
sage: %time _ = 2*P
CPU times: user 589 ms, sys: 6 µs, total: 589 ms
Wall time: 588 ms
sage: P = polytopes.hypercube(7, backend='field')
sage: %time _ = 2*P
CPU times: user 14.1 ms, sys: 0 ns, total: 14.1 ms
Wall time: 14.1 ms
sage: P = polytopes.cross_polytope(8, backend='field')
sage: %time _ = 2*P
CPU times: user 49.2 ms, sys: 0 ns, total: 49.2 ms
Wall time: 48.3 ms
sage: P = polytopes.cross_polytope(13)
sage: %time _ = 2*P
CPU times: user 428 ms, sys: 8.08 ms, total: 436 ms
Wall time: 436 ms
```

Note that for the last timing, the choice of only specifying Vrep was already good (at least for backend `ppl`). So with the new setup, thinks take a bit more time, as `dilation` computes the new Hrep, which `ppl` discards then.

Issue created by migration from https://trac.sagemath.org/ticket/29200





---

archive/issue_comments_409560.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-02-15T16:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409560",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_409561.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-15T16:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409561",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_409562.json:
```json
{
    "body": "Changing keywords from \"\" to \"polyhedra, dilation, precomputed data\".",
    "created_at": "2020-02-15T16:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409562",
    "user": "https://github.com/kliem"
}
```

Changing keywords from "" to "polyhedra, dilation, precomputed data".



---

archive/issue_comments_409563.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-05T21:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409563",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_409564.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-08T11:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409564",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_074169.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-08T11:27:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28963#event-74169"
}
```



---

archive/issue_comments_409565.json:
```json
{
    "body": "We forgot to update one doctest, see #29300",
    "created_at": "2020-03-08T17:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409565",
    "user": "https://github.com/seblabbe"
}
```

We forgot to update one doctest, see #29300



---

archive/issue_comments_409566.json:
```json
{
    "body": "Replying to [comment:4 slabbe]:\n> We forgot to update one doctest, see #29300\n\n\nYep, for such changes, it is important to test with and without optional packages... otherwise, we tend to forget this. Good catch.",
    "created_at": "2020-03-08T17:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28963#issuecomment-409566",
    "user": "https://github.com/jplab"
}
```

Replying to [comment:4 slabbe]:
> We forgot to update one doctest, see #29300


Yep, for such changes, it is important to test with and without optional packages... otherwise, we tend to forget this. Good catch.
