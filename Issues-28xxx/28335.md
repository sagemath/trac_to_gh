# Issue 28335: Cythonize Yen_k_shortest_simple_paths and feng_k_shortest_simple_paths

archive/issues_028098.json:
```json
{
    "body": "This ticket aims to implement these methods in Cython for speed up and performance gains.\n\nCC:  @dcoudert\n\nKeywords: gsoc2019\n\nReviewer: David Coudert\n\nAuthor: Rajat Mittal\n\nBranch: aac00c3e0005643c0771d85d8decb431e7f13f3c\n\nDependencies: #27859\n\nCommit: aac00c3e0005643c0771d85d8decb431e7f13f3c\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28335\n\n",
    "closed_at": "2019-08-29T20:02:10Z",
    "created_at": "2019-08-09T04:13:37Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Cythonize Yen_k_shortest_simple_paths and feng_k_shortest_simple_paths",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28335",
    "user": "https://github.com/rajat1433"
}
```
This ticket aims to implement these methods in Cython for speed up and performance gains.

CC:  @dcoudert

Keywords: gsoc2019

Reviewer: David Coudert

Author: Rajat Mittal

Branch: aac00c3e0005643c0771d85d8decb431e7f13f3c

Dependencies: #27859

Commit: aac00c3e0005643c0771d85d8decb431e7f13f3c

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28335





---

archive/issue_comments_396553.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2019-08-10T04:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396553",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_396554.json:
```json
{
    "body": "<a id='comment:3'></a>I have cythonized the Yen and Feng's methods here as can be seen from the last commit in the list of above commits.\n\nIn short I have used cython variables and cython data structures where ever possible in these methods.\n\nAlso I have named the cython methods as yen_k_shortest_simple_paths_cython and feng_k_shortest_simple_paths_cython to separate them from yen_k_shortest_simple_paths and feng_k_shortest_simple_paths for consistency and speed checks.\nfeng_k_shortest_simple_paths\nChanges will be more clear once #27859 gets included.",
    "created_at": "2019-08-10T04:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396554",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:3'></a>I have cythonized the Yen and Feng's methods here as can be seen from the last commit in the list of above commits.

In short I have used cython variables and cython data structures where ever possible in these methods.

Also I have named the cython methods as yen_k_shortest_simple_paths_cython and feng_k_shortest_simple_paths_cython to separate them from yen_k_shortest_simple_paths and feng_k_shortest_simple_paths for consistency and speed checks.
feng_k_shortest_simple_paths
Changes will be more clear once #27859 gets included.



---

archive/issue_comments_396555.json:
```json
{
    "body": "<a id='comment:4'></a>The way you declare the priority queue is incorrect. This will fail if edge weights are not integers.\n\nThe list `idx_to_path` stores all paths, and you never remove any. So it can become giant. Can't you instead use a dictionary and a counter to assign each new path a unique id, and remove paths that are no longer useful ? In fact, you can certainly combine `idx_to_path` and `heap_paths` in a unique dictionary, no ?",
    "created_at": "2019-08-10T11:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396555",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>The way you declare the priority queue is incorrect. This will fail if edge weights are not integers.

The list `idx_to_path` stores all paths, and you never remove any. So it can become giant. Can't you instead use a dictionary and a counter to assign each new path a unique id, and remove paths that are no longer useful ? In fact, you can certainly combine `idx_to_path` and `heap_paths` in a unique dictionary, no ?



---

archive/issue_comments_396556.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-10T19:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396556",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396557.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:4 dcoudert]:\n> The way you declare the priority queue is incorrect. This will fail if edge weights are not integers.\n> \n> The list `idx_to_path` stores all paths, and you never remove any. So it can become giant. Can't you instead use a dictionary and a counter to assign each new path a unique id, and remove paths that are no longer useful ? In fact, you can certainly combine `idx_to_path` and `heap_paths` in a unique dictionary, no ?\n\n\nI agree with both the statements and made the changes appropriately",
    "created_at": "2019-08-10T19:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396557",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:6'></a>Replying to [comment:4 dcoudert]:
> The way you declare the priority queue is incorrect. This will fail if edge weights are not integers.
> 
> The list `idx_to_path` stores all paths, and you never remove any. So it can become giant. Can't you instead use a dictionary and a counter to assign each new path a unique id, and remove paths that are no longer useful ? In fact, you can certainly combine `idx_to_path` and `heap_paths` in a unique dictionary, no ?


I agree with both the statements and made the changes appropriately



---

archive/issue_comments_396558.json:
```json
{
    "body": "<a id='comment:7'></a>Seems correct.\nThe next step is to speed up the test `hash_path not in idx_to_path.values()`, but I don't have good ideas yet on how to do that.",
    "created_at": "2019-08-11T07:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396558",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>Seems correct.
The next step is to speed up the test `hash_path not in idx_to_path.values()`, but I don't have good ideas yet on how to do that.



---

archive/issue_comments_396559.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-12T04:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396560.json:
```json
{
    "body": "<a id='comment:9'></a>\n```\nsage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths_cyth\n....: on\nsage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths\nsage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths\nsage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths_cytho\n....: n\nsage: sage: G = digraphs.RandomDirectedGNP(30, .05)\n....:         sage: while not G.is_strongly_connected():\n....:         ....:     G = digraphs.RandomDirectedGNP(30, .1)\n....:         sage: for u, v in list(G.edges(labels=False, sort=False)):\n....:         ....:     G.set_edge_label(u, v, randint(1, 10))\n....:         sage: V = G.vertices()\n....:         sage: shuffle(V)\n....:         sage: u, v = V[:2]\nsage: it_Y = feng_k_shortest_simple_paths_cython(G, u, v, by_weight=True, report\n....: _weight=True)\nsage: it_F = feng_k_shortest_simple_paths(G, u, v, by_weight=True, report_weight\n....: =True)\nsage: for i in range(205):\n....:     if(it_F.next()[0]!=it_Y.next()[0]):\n....:         print(\"wrong\")\n....:         \n....:     \n....: \nsage: it_Y = yen_k_shortest_simple_paths_cython(G, u, v, by_weight=True, report_\n....: weight=True)\nsage: it_F = yen_k_shortest_simple_paths(G, u, v, by_weight=True, report_weight=\n....: True)\nsage: for i in range(205):\n....:     if(it_F.next()[0]!=it_Y.next()[0]):\n....:         print(\"wrong\")\n....:         \n....:     \n....:\n```",
    "created_at": "2019-08-12T04:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396560",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:9'></a>
```
sage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths_cyth
....: on
sage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths
sage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths
sage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths_cytho
....: n
sage: sage: G = digraphs.RandomDirectedGNP(30, .05)
....:         sage: while not G.is_strongly_connected():
....:         ....:     G = digraphs.RandomDirectedGNP(30, .1)
....:         sage: for u, v in list(G.edges(labels=False, sort=False)):
....:         ....:     G.set_edge_label(u, v, randint(1, 10))
....:         sage: V = G.vertices()
....:         sage: shuffle(V)
....:         sage: u, v = V[:2]
sage: it_Y = feng_k_shortest_simple_paths_cython(G, u, v, by_weight=True, report
....: _weight=True)
sage: it_F = feng_k_shortest_simple_paths(G, u, v, by_weight=True, report_weight
....: =True)
sage: for i in range(205):
....:     if(it_F.next()[0]!=it_Y.next()[0]):
....:         print("wrong")
....:         
....:     
....: 
sage: it_Y = yen_k_shortest_simple_paths_cython(G, u, v, by_weight=True, report_
....: weight=True)
sage: it_F = yen_k_shortest_simple_paths(G, u, v, by_weight=True, report_weight=
....: True)
sage: for i in range(205):
....:     if(it_F.next()[0]!=it_Y.next()[0]):
....:         print("wrong")
....:         
....:     
....:
```



---

archive/issue_comments_396561.json:
```json
{
    "body": "<a id='comment:10'></a>After thinking about the utility of the hash_path not in idx_to_path.values() test , it seems like we don't really require it as per our algorithm as we are working on graphs without multiedges hence the path will no be repeated into the heap. So this test is unnecessary here.\n\nAlso the test supporting it is shown in the above comment.",
    "created_at": "2019-08-12T04:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396561",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:10'></a>After thinking about the utility of the hash_path not in idx_to_path.values() test , it seems like we don't really require it as per our algorithm as we are working on graphs without multiedges hence the path will no be repeated into the heap. So this test is unnecessary here.

Also the test supporting it is shown in the above comment.



---

archive/issue_comments_396562.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-12T04:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396563.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-12T04:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396564.json:
```json
{
    "body": "<a id='comment:13'></a>I'm not fully convinced by the removal of this test. It is part of the algorithm for a reason. Consider an unweighted graph with many paths from u to v with same cost. For instance a complete graph. A same path might certainly been found several times, no ?",
    "created_at": "2019-08-12T08:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396564",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:13'></a>I'm not fully convinced by the removal of this test. It is part of the algorithm for a reason. Consider an unweighted graph with many paths from u to v with same cost. For instance a complete graph. A same path might certainly been found several times, no ?



---

archive/issue_comments_396565.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 dcoudert]:\n> I'm not fully convinced by the removal of this test. It is part of the algorithm for a reason. Consider an unweighted graph with many paths from u to v with same cost. For instance a complete graph. A same path might certainly been found several times, no ?\n\n\nActual algorithm never specify to do this test. I added this test thinking that a path may be repeated in the heap, but the way Yen's algorithm unfolds its not possible to add the same path twice.\n\n\n\n\n```\nsage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths_cython\nsage: g = graphs.CompleteGraph(5)\nsage: it_Y = yen_k_shortest_simple_paths_cython(g, 0, 4)\nsage: list(it_Y)\n[[0, 4],\n [0, 1, 4],\n [0, 2, 4],\n [0, 3, 4],\n [0, 3, 1, 4],\n [0, 3, 2, 4],\n [0, 2, 1, 4],\n [0, 2, 3, 4],\n [0, 1, 2, 4],\n [0, 1, 3, 4],\n [0, 1, 3, 2, 4],\n [0, 1, 2, 3, 4],\n [0, 2, 3, 1, 4],\n [0, 2, 1, 3, 4],\n [0, 3, 2, 1, 4],\n [0, 3, 1, 2, 4]]\n\n```\n\n```\nsage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths\nsage: g = graphs.CompleteGraph(5)\nsage: it_Y = yen_k_shortest_simple_paths(g, 0, 4)\nsage: list(it_Y)\n[[0, 4],\n [0, 1, 4],\n [0, 2, 4],\n [0, 3, 4],\n [0, 1, 2, 4],\n [0, 1, 3, 4],\n [0, 2, 1, 4],\n [0, 2, 3, 4],\n [0, 3, 1, 4],\n [0, 3, 2, 4],\n [0, 1, 2, 3, 4],\n [0, 1, 3, 2, 4],\n [0, 2, 1, 3, 4],\n [0, 2, 3, 1, 4],\n [0, 3, 1, 2, 4],\n [0, 3, 2, 1, 4]]\n\n```",
    "created_at": "2019-08-12T11:57:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396565",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:14'></a>Replying to [comment:13 dcoudert]:
> I'm not fully convinced by the removal of this test. It is part of the algorithm for a reason. Consider an unweighted graph with many paths from u to v with same cost. For instance a complete graph. A same path might certainly been found several times, no ?


Actual algorithm never specify to do this test. I added this test thinking that a path may be repeated in the heap, but the way Yen's algorithm unfolds its not possible to add the same path twice.




```
sage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths_cython
sage: g = graphs.CompleteGraph(5)
sage: it_Y = yen_k_shortest_simple_paths_cython(g, 0, 4)
sage: list(it_Y)
[[0, 4],
 [0, 1, 4],
 [0, 2, 4],
 [0, 3, 4],
 [0, 3, 1, 4],
 [0, 3, 2, 4],
 [0, 2, 1, 4],
 [0, 2, 3, 4],
 [0, 1, 2, 4],
 [0, 1, 3, 4],
 [0, 1, 3, 2, 4],
 [0, 1, 2, 3, 4],
 [0, 2, 3, 1, 4],
 [0, 2, 1, 3, 4],
 [0, 3, 2, 1, 4],
 [0, 3, 1, 2, 4]]

```

```
sage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths
sage: g = graphs.CompleteGraph(5)
sage: it_Y = yen_k_shortest_simple_paths(g, 0, 4)
sage: list(it_Y)
[[0, 4],
 [0, 1, 4],
 [0, 2, 4],
 [0, 3, 4],
 [0, 1, 2, 4],
 [0, 1, 3, 4],
 [0, 2, 1, 4],
 [0, 2, 3, 4],
 [0, 3, 1, 4],
 [0, 3, 2, 4],
 [0, 1, 2, 3, 4],
 [0, 1, 3, 2, 4],
 [0, 2, 1, 3, 4],
 [0, 2, 3, 1, 4],
 [0, 3, 1, 2, 4],
 [0, 3, 2, 1, 4]]

```



---

archive/issue_comments_396566.json:
```json
{
    "body": "<a id='comment:15'></a>\n```\nsage: g = g.to_directed()\nsage: show(g)\nLaunched png viewer for Graphics object consisting of 30 graphics primitives\nsage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths_cython\nsage: it_F = feng_k_shortest_simple_paths_cython(g, 0, 4)\nsage: list(it_F)\n[[0, 4],\n [0, 3, 4],\n [0, 2, 4],\n [0, 1, 4],\n [0, 1, 3, 4],\n [0, 1, 2, 4],\n [0, 2, 3, 4],\n [0, 2, 1, 4],\n [0, 3, 2, 4],\n [0, 3, 1, 4],\n [0, 3, 1, 2, 4],\n [0, 3, 2, 1, 4],\n [0, 2, 1, 3, 4],\n [0, 2, 3, 1, 4],\n [0, 1, 2, 3, 4],\n [0, 1, 3, 2, 4]]\n```",
    "created_at": "2019-08-12T12:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396566",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:15'></a>
```
sage: g = g.to_directed()
sage: show(g)
Launched png viewer for Graphics object consisting of 30 graphics primitives
sage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths_cython
sage: it_F = feng_k_shortest_simple_paths_cython(g, 0, 4)
sage: list(it_F)
[[0, 4],
 [0, 3, 4],
 [0, 2, 4],
 [0, 1, 4],
 [0, 1, 3, 4],
 [0, 1, 2, 4],
 [0, 2, 3, 4],
 [0, 2, 1, 4],
 [0, 3, 2, 4],
 [0, 3, 1, 4],
 [0, 3, 1, 2, 4],
 [0, 3, 2, 1, 4],
 [0, 2, 1, 3, 4],
 [0, 2, 3, 1, 4],
 [0, 1, 2, 3, 4],
 [0, 1, 3, 2, 4]]
```



---

archive/issue_comments_396567.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-12T12:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396567",
    "user": "https://github.com/rajat1433"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396568.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-13T11:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396568",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396569.json:
```json
{
    "body": "<a id='comment:18'></a>I did some changes in Yen. I think it is cleaner this way. I have not touched Feng. You can certainly try to follow what I did to start improving it.",
    "created_at": "2019-08-13T11:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396569",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:18'></a>I did some changes in Yen. I think it is cleaner this way. I have not touched Feng. You can certainly try to follow what I did to start improving it.



---

archive/issue_comments_396570.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-14T03:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396570",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396571.json:
```json
{
    "body": "<a id='comment:20'></a>Following are the comparisons results between:\nThere's a slight improvement observed.\n\n```\nsage: g = DiGraph(graphs.Grid2dGraph(10, 10))\nsage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths_cyth\n....: on\nsage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths\nsage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths\nsage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths_cytho\n....: n\nsage:  p = yen_k_shortest_simple_paths(g, (0, 0), (9, 9))\nsage: %timeit [p.next() for i in range(1000)]\n1 loop, best of 3: 1.25 s per loop\nsage:  p = yen_k_shortest_simple_paths_cython(g, (0, 0), (9, 9))\nsage: %timeit [p.next() for i in range(1000)]\n1 loop, best of 3: 1.24 s per loop\nsage:  p = feng_k_shortest_simple_paths(g, (0, 0), (9, 9))\nsage: %timeit [p.next() for i in range(5000)]\n1 loop, best of 3: 4.62 s per loop\nsage:  p = feng_k_shortest_simple_paths_cython(g, (0, 0), (9, 9))\nsage: %timeit [p.next() for i in range(5000)]\n1 loop, best of 3: 4.72 s per loop\n\nsage: g = DiGraph()\nsage: for i in range(120):\n....: ....:     g.add_edge(i,i+1,i%5)\n....:     \nsage: for i in range(30, 40, 1):\n....: ....:     g.add_edge(i,120,i%2)\n....:     \nsage:  %timeit list(yen_k_shortest_simple_paths_directed(g, 0, 120, by_weight=Tr\n....: ue))\nsage:  %timeit list(yen_k_shortest_simple_paths(g, 0, 120, by_weight=True))\n10 loops, best of 3: 46.6 ms per loop\nsage:  %timeit list(yen_k_shortest_simple_paths_cython(g, 0, 120, by_weight=True\n....: ))\n10 loops, best of 3: 45.6 ms per loop\nsage:  %timeit list(feng_k_shortest_simple_paths_cython(g, 0, 120, by_weight=Tru\n....: e))\n100 loops, best of 3: 7.62 ms per loop\nsage:  %timeit list(feng_k_shortest_simple_paths(g, 0, 120, by_weight=True))\n100 loops, best of 3: 7.74 ms per loop\n\n```",
    "created_at": "2019-08-16T04:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396571",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:20'></a>Following are the comparisons results between:
There's a slight improvement observed.

```
sage: g = DiGraph(graphs.Grid2dGraph(10, 10))
sage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths_cyth
....: on
sage: from sage.graphs.path_enumeration import feng_k_shortest_simple_paths
sage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths
sage: from sage.graphs.path_enumeration import yen_k_shortest_simple_paths_cytho
....: n
sage:  p = yen_k_shortest_simple_paths(g, (0, 0), (9, 9))
sage: %timeit [p.next() for i in range(1000)]
1 loop, best of 3: 1.25 s per loop
sage:  p = yen_k_shortest_simple_paths_cython(g, (0, 0), (9, 9))
sage: %timeit [p.next() for i in range(1000)]
1 loop, best of 3: 1.24 s per loop
sage:  p = feng_k_shortest_simple_paths(g, (0, 0), (9, 9))
sage: %timeit [p.next() for i in range(5000)]
1 loop, best of 3: 4.62 s per loop
sage:  p = feng_k_shortest_simple_paths_cython(g, (0, 0), (9, 9))
sage: %timeit [p.next() for i in range(5000)]
1 loop, best of 3: 4.72 s per loop

sage: g = DiGraph()
sage: for i in range(120):
....: ....:     g.add_edge(i,i+1,i%5)
....:     
sage: for i in range(30, 40, 1):
....: ....:     g.add_edge(i,120,i%2)
....:     
sage:  %timeit list(yen_k_shortest_simple_paths_directed(g, 0, 120, by_weight=Tr
....: ue))
sage:  %timeit list(yen_k_shortest_simple_paths(g, 0, 120, by_weight=True))
10 loops, best of 3: 46.6 ms per loop
sage:  %timeit list(yen_k_shortest_simple_paths_cython(g, 0, 120, by_weight=True
....: ))
10 loops, best of 3: 45.6 ms per loop
sage:  %timeit list(feng_k_shortest_simple_paths_cython(g, 0, 120, by_weight=Tru
....: e))
100 loops, best of 3: 7.62 ms per loop
sage:  %timeit list(feng_k_shortest_simple_paths(g, 0, 120, by_weight=True))
100 loops, best of 3: 7.74 ms per loop

```



---

archive/issue_comments_396572.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-16T04:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396572",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396573.json:
```json
{
    "body": "<a id='comment:22'></a>Now that #27859 has been merged, it's much easier to check the code ;)\n\nInstead of creating new methods, I propose to replace the code of the previous Yen's method by the code of the Cython version, and to do the same for Feng.",
    "created_at": "2019-08-19T16:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396573",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:22'></a>Now that #27859 has been merged, it's much easier to check the code ;)

Instead of creating new methods, I propose to replace the code of the previous Yen's method by the code of the Cython version, and to do the same for Feng.



---

archive/issue_comments_396574.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-19T17:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396574",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396575.json:
```json
{
    "body": "<a id='comment:24'></a>LGTM. We have a better code for Yen, and I propose to postpone to another ticket possible improvements for Feng (it should be much faster, but it's not).",
    "created_at": "2019-08-20T16:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396575",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:24'></a>LGTM. We have a better code for Yen, and I propose to postpone to another ticket possible improvements for Feng (it should be much faster, but it's not).



---

archive/issue_comments_396576.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-20T16:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396576",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396577.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-08-20T18:06:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_396578.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2019-08-20T18:06:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396578",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_396579.json:
```json
{
    "body": "<a id='comment:26'></a>I think it was necessary to rebase this tkt on 8.9beta7 otherwise some merge conflict might happen.\nCan you please set it to positive review again.",
    "created_at": "2019-08-20T18:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396579",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:26'></a>I think it was necessary to rebase this tkt on 8.9beta7 otherwise some merge conflict might happen.
Can you please set it to positive review again.



---

archive/issue_comments_396580.json:
```json
{
    "body": "<a id='comment:27'></a>It was not necessary ! Firstly, I tested the ticket over beta 7, and secondly this does not prevent possible conflicts with other tickets (depends on the order in which the tickets are merged for next release).",
    "created_at": "2019-08-21T08:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396580",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:27'></a>It was not necessary ! Firstly, I tested the ticket over beta 7, and secondly this does not prevent possible conflicts with other tickets (depends on the order in which the tickets are merged for next release).



---

archive/issue_comments_396581.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-21T08:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396581",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396582.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-29T20:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28335#issuecomment-396582",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_070733.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-29T20:02:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28335",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28335#event-70733"
}
```
