# Issue 28989: Bug in proper cycles of indefinite binary quadratic forms

archive/issues_028752.json:
```json
{
    "body": "The proper cycle of the indefinite quadratic form x<sup>2</sup>+xy-y<sup>2</sup> consists of x<sup>2</sup>+xy-y<sup>2</sup> and -x<sup>2</sup>+xy+y<sup>2</sup>. Sage gives only one element.\n\n```\nsage: Q=BinaryQF(1,1,-1)\nsage: Q.cycle(proper=True) \n[x^2 + x*y - y^2]\n```\n\nAs a consequence, consider two quadratic forms of discriminant 5. Two such forms are always properly equivalent. However, we get\n\n```\nsage: Q1, Q2 = BinaryQF(1,1,-1), BinaryQF(-1,1,1) \nsage: Q1.is_equivalent(Q2, proper=True) \nFalse\n```\n\nTo check proper equivalence, note that\n\n```\nsage: M=Matrix(ZZ,2,2, [1,1,-1,0])\nsage: det(M)\n1\nsage: Q2 == Q1.matrix_action_right(M)\nTrue\n```\n\n\n\n\n**Keywords:** binary quadratic forms\n\n**Branch/Commit:** [b3c79005b3a51d9649408bf265a00584d8c76479](https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Steffen L\u00f6brich, Dave Morris\n\nIssue created by migration from https://trac.sagemath.org/ticket/28989\n\n",
    "closed_at": "2020-01-25T17:27:44Z",
    "created_at": "2020-01-11T10:21:07Z",
    "labels": [
        "component: number theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Bug in proper cycles of indefinite binary quadratic forms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28989",
    "user": "https://github.com/sloebrich"
}
```
The proper cycle of the indefinite quadratic form x<sup>2</sup>+xy-y<sup>2</sup> consists of x<sup>2</sup>+xy-y<sup>2</sup> and -x<sup>2</sup>+xy+y<sup>2</sup>. Sage gives only one element.

```
sage: Q=BinaryQF(1,1,-1)
sage: Q.cycle(proper=True) 
[x^2 + x*y - y^2]
```

As a consequence, consider two quadratic forms of discriminant 5. Two such forms are always properly equivalent. However, we get

```
sage: Q1, Q2 = BinaryQF(1,1,-1), BinaryQF(-1,1,1) 
sage: Q1.is_equivalent(Q2, proper=True) 
False
```

To check proper equivalence, note that

```
sage: M=Matrix(ZZ,2,2, [1,1,-1,0])
sage: det(M)
1
sage: Q2 == Q1.matrix_action_right(M)
True
```




**Keywords:** binary quadratic forms

**Branch/Commit:** [b3c79005b3a51d9649408bf265a00584d8c76479](https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479)

**Reviewer:** Travis Scrimshaw

**Author:** Steffen Löbrich, Dave Morris

Issue created by migration from https://trac.sagemath.org/ticket/28989





---

archive/issue_comments_537703.json:
```json
{
    "body": "**Branch:** [public/28989](https://github.com/sagemath/sagetrac-mirror/tree/public/28989)",
    "created_at": "2020-01-11T20:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537703",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Branch:** [public/28989](https://github.com/sagemath/sagetrac-mirror/tree/public/28989)



---

archive/issue_comments_537704.json:
```json
{
    "body": "<a id='comment:2'></a>\nThanks for reporting the bug. My patch fixes an error in the definition of the `cycle` function.\n\n```\nsage: Q=BinaryQF(1,1,-1)\nsage: Q.cycle(proper=True)\n[x^2 + x*y - y^2, -x^2 + x*y + y^2]\nsage: Q1, Q2 = BinaryQF(1,1,-1), BinaryQF(-1,1,1) \nsage: Q1.is_equivalent(Q2, proper=True)\nTrue\n```\n\nI am not setting this to \"needs review\" yet, for two reasons: the doctests need work, and I am not sure this gives correct answers for quadratic forms whose first coefficient is negative. (The reference [BV2007] seems to require the first coefficient to be positive.) I think I should be able to get this figured out, but it's great if someone who knows about quadratic forms wants to chime in.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa21ee131425248b6ca8ae4ffde91aac5c1521b1\">aa21ee1</a></td><td><code>proper cycle should not have odd length</code></td></tr></table>\n",
    "created_at": "2020-01-11T20:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537704",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:2'></a>
Thanks for reporting the bug. My patch fixes an error in the definition of the `cycle` function.

```
sage: Q=BinaryQF(1,1,-1)
sage: Q.cycle(proper=True)
[x^2 + x*y - y^2, -x^2 + x*y + y^2]
sage: Q1, Q2 = BinaryQF(1,1,-1), BinaryQF(-1,1,1) 
sage: Q1.is_equivalent(Q2, proper=True)
True
```

I am not setting this to "needs review" yet, for two reasons: the doctests need work, and I am not sure this gives correct answers for quadratic forms whose first coefficient is negative. (The reference [BV2007] seems to require the first coefficient to be positive.) I think I should be able to get this figured out, but it's great if someone who knows about quadratic forms wants to chime in.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa21ee131425248b6ca8ae4ffde91aac5c1521b1">aa21ee1</a></td><td><code>proper cycle should not have odd length</code></td></tr></table>




---

archive/issue_comments_537705.json:
```json
{
    "body": "**Commit:** [aa21ee131425248b6ca8ae4ffde91aac5c1521b1](https://github.com/sagemath/sagetrac-mirror/commit/aa21ee131425248b6ca8ae4ffde91aac5c1521b1)",
    "created_at": "2020-01-11T20:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537705",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Commit:** [aa21ee131425248b6ca8ae4ffde91aac5c1521b1](https://github.com/sagemath/sagetrac-mirror/commit/aa21ee131425248b6ca8ae4ffde91aac5c1521b1)



---

archive/issue_comments_537706.json:
```json
{
    "body": "**Changing author** from \"Steffen L\u00f6brich\" to \"Steffen L\u00f6brich, Dave Morris\".",
    "created_at": "2020-01-11T20:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537706",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Changing author** from "Steffen Löbrich" to "Steffen Löbrich, Dave Morris".



---

archive/issue_comments_537707.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe second item in the output of `Q.cycle(proper=True)` seems to have a sign error in the `y^2` term. I'll have to look into this.",
    "created_at": "2020-01-11T23:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537707",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:3'></a>
The second item in the output of `Q.cycle(proper=True)` seems to have a sign error in the `y^2` term. I'll have to look into this.



---

archive/issue_comments_537708.json:
```json
{
    "body": "**Changing commit** from \"[aa21ee131425248b6ca8ae4ffde91aac5c1521b1](https://github.com/sagemath/sagetrac-mirror/commit/aa21ee131425248b6ca8ae4ffde91aac5c1521b1)\" to \"[c24e07df70ad46cae0f6a2f58778a90dbb843e05](https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05)\".",
    "created_at": "2020-01-12T03:21:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[aa21ee131425248b6ca8ae4ffde91aac5c1521b1](https://github.com/sagemath/sagetrac-mirror/commit/aa21ee131425248b6ca8ae4ffde91aac5c1521b1)" to "[c24e07df70ad46cae0f6a2f58778a90dbb843e05](https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05)".



---

archive/issue_comments_537709.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05\">c24e07d</a></td><td><code>apply tau only to half of the terms</code></td></tr></table>\n",
    "created_at": "2020-01-12T03:21:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05">c24e07d</a></td><td><code>apply tau only to half of the terms</code></td></tr></table>




---

archive/issue_comments_537710.json:
```json
{
    "body": "<a id='comment:5'></a>\nI fixed an additional mistake in the definition of `cycle`. (The statement of Proposition 6.10.5 of [BV2007] is ambiguous, and the original algorithm interpreted it incorrectly.) I validated the new algorithm on a couple of examples from [BV2007], and will add these as doctests. \n\nHowever, I also still need to look at quadratic forms whose coefficient of `x^2` is negative.\n\nPS [BV2007] = Johannes Buchmann and Ulrich Vollmer, *Binary Quadratic Forms*, Springer, 2007.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05\">c24e07d</a></td><td><code>apply tau only to half of the terms</code></td></tr></table>\n",
    "created_at": "2020-01-12T03:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537710",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:5'></a>
I fixed an additional mistake in the definition of `cycle`. (The statement of Proposition 6.10.5 of [BV2007] is ambiguous, and the original algorithm interpreted it incorrectly.) I validated the new algorithm on a couple of examples from [BV2007], and will add these as doctests. 

However, I also still need to look at quadratic forms whose coefficient of `x^2` is negative.

PS [BV2007] = Johannes Buchmann and Ulrich Vollmer, *Binary Quadratic Forms*, Springer, 2007.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05">c24e07d</a></td><td><code>apply tau only to half of the terms</code></td></tr></table>




---

archive/issue_comments_537711.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The proper cycle of the indefinite quadratic form x<sup>2</sup>+xy-y<sup>2</sup> consists of x<sup>2</sup>+xy-y<sup>2</sup> and -x<sup>2</sup>+xy-y<sup>2</sup>. Sage gives only one element.\n+The proper cycle of the indefinite quadratic form x<sup>2</sup>+xy-y<sup>2</sup> consists of x<sup>2</sup>+xy-y<sup>2</sup> and -x<sup>2</sup>+xy+y<sup>2</sup>. Sage gives only one element.\n \n ```\n sage: Q=BinaryQF(1,1,-1)\n``````\n",
    "created_at": "2020-01-12T03:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537711",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The proper cycle of the indefinite quadratic form x<sup>2</sup>+xy-y<sup>2</sup> consists of x<sup>2</sup>+xy-y<sup>2</sup> and -x<sup>2</sup>+xy-y<sup>2</sup>. Sage gives only one element.
+The proper cycle of the indefinite quadratic form x<sup>2</sup>+xy-y<sup>2</sup> consists of x<sup>2</sup>+xy-y<sup>2</sup> and -x<sup>2</sup>+xy+y<sup>2</sup>. Sage gives only one element.
 
 ```
 sage: Q=BinaryQF(1,1,-1)
``````




---

archive/issue_comments_537712.json:
```json
{
    "body": "<a id='comment:6'></a>\nOK, I think the mathematics is correct, but I will modify the docstrings to clarify that the  definition of \"cycle\" used here is not quite the same as in [BV2007].",
    "created_at": "2020-01-12T06:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537712",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:6'></a>
OK, I think the mathematics is correct, but I will modify the docstrings to clarify that the  definition of "cycle" used here is not quite the same as in [BV2007].



---

archive/issue_comments_537713.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ac626a6157cb31f96dc0cc981d5d6bc9732a68e\">6ac626a</a></td><td><code>revise docstrings and fix another bug</code></td></tr></table>\n",
    "created_at": "2020-01-15T23:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537713",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ac626a6157cb31f96dc0cc981d5d6bc9732a68e">6ac626a</a></td><td><code>revise docstrings and fix another bug</code></td></tr></table>




---

archive/issue_comments_537714.json:
```json
{
    "body": "**Changing commit** from \"[c24e07df70ad46cae0f6a2f58778a90dbb843e05](https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05)\" to \"[6ac626a6157cb31f96dc0cc981d5d6bc9732a68e](https://github.com/sagemath/sagetrac-mirror/commit/6ac626a6157cb31f96dc0cc981d5d6bc9732a68e)\".",
    "created_at": "2020-01-15T23:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537714",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c24e07df70ad46cae0f6a2f58778a90dbb843e05](https://github.com/sagemath/sagetrac-mirror/commit/c24e07df70ad46cae0f6a2f58778a90dbb843e05)" to "[6ac626a6157cb31f96dc0cc981d5d6bc9732a68e](https://github.com/sagemath/sagetrac-mirror/commit/6ac626a6157cb31f96dc0cc981d5d6bc9732a68e)".



---

archive/issue_comments_537715.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2020-01-15T23:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537715",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_537716.json:
```json
{
    "body": "<a id='comment:8'></a>\nI added several doctests and corrected (or replaced) some of the ones that were already there, rewrote the docstring of `cycle`, and fixed two more bugs (including one that was my fault).\n\nThe main purpose of this ticket is to rewrite the few lines of code that compute proper cycles of indefinite forms. I believe that function is now correct. The ticket also fixes a bug in `is_equivalent`. (The quadratic form `self` might not be reduced, so it needed to be replaced with `selfred` at one point.) \n\nI verified a few examples by hand, and also validated against some examples that I found on the internet. I did not look at the code for definite forms at all, but that is older and presumably better tested.",
    "created_at": "2020-01-15T23:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537716",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:8'></a>
I added several doctests and corrected (or replaced) some of the ones that were already there, rewrote the docstring of `cycle`, and fixed two more bugs (including one that was my fault).

The main purpose of this ticket is to rewrite the few lines of code that compute proper cycles of indefinite forms. I believe that function is now correct. The ticket also fixes a bug in `is_equivalent`. (The quadratic form `self` might not be reduced, so it needed to be replaced with `selfred` at one point.) 

I verified a few examples by hand, and also validated against some examples that I found on the internet. I did not look at the code for definite forms at all, but that is older and presumably better tested.



---

archive/issue_comments_537717.json:
```json
{
    "body": "<a id='comment:9'></a>\nplease do not use comments (starting with #) in the documentation, but make sentences.",
    "created_at": "2020-01-17T12:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537717",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
please do not use comments (starting with #) in the documentation, but make sentences.



---

archive/issue_comments_537718.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48d6e8939ee7d9750f518e004ca99a51ce043815\">48d6e89</a></td><td><code>docs should not have # comments</code></td></tr></table>\n",
    "created_at": "2020-01-17T18:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537718",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48d6e8939ee7d9750f518e004ca99a51ce043815">48d6e89</a></td><td><code>docs should not have # comments</code></td></tr></table>




---

archive/issue_comments_537719.json:
```json
{
    "body": "**Changing commit** from \"[6ac626a6157cb31f96dc0cc981d5d6bc9732a68e](https://github.com/sagemath/sagetrac-mirror/commit/6ac626a6157cb31f96dc0cc981d5d6bc9732a68e)\" to \"[48d6e8939ee7d9750f518e004ca99a51ce043815](https://github.com/sagemath/sagetrac-mirror/commit/48d6e8939ee7d9750f518e004ca99a51ce043815)\".",
    "created_at": "2020-01-17T18:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6ac626a6157cb31f96dc0cc981d5d6bc9732a68e](https://github.com/sagemath/sagetrac-mirror/commit/6ac626a6157cb31f96dc0cc981d5d6bc9732a68e)" to "[48d6e8939ee7d9750f518e004ca99a51ce043815](https://github.com/sagemath/sagetrac-mirror/commit/48d6e8939ee7d9750f518e004ca99a51ce043815)".



---

archive/issue_comments_537720.json:
```json
{
    "body": "<a id='comment:11'></a>\nA few minor things:\n\n```diff\n-        TESTS::\n+        TESTS:\n \n         Check an example in :trac:`28989`::\n+\n-            sage: Q=BinaryQF(1,1,-1)\n+            sage: Q = BinaryQF(1,1,-1)\n             sage: Q.cycle(proper=True)\n             [x^2 + x*y - y^2, -x^2 + x*y + y^2]\n \n         This is Example 6.10.6 of [BUVO2007]_::\n+\n-            sage: Q=BinaryQF(1,7,-6)\n+            sage: Q = BinaryQF(1,7,-6)\n```\nand any other similar changes.\n\n```diff\n-        Try an example where a is negative::\n-            sage: Q=BinaryQF(-1, 8, 3)\n+        Try an example where `a` is negative::\n+\n+            sage: Q = BinaryQF(-1, 8, 3)\n```\nThe for-loop part is over-indented here:\n\n```\n            for i in range(len(C)//2):\n                    C[2*i+1] = C[2*i+1]._Tau()\n```\n\n```diff\n-                C = C + C\n+                C += C\n```\nI also don't understand the point of this test:\n\n```\n            sage: hasattr(Q, '_cycle_list')\n            False\n```",
    "created_at": "2020-01-20T04:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537720",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>
A few minor things:

```diff
-        TESTS::
+        TESTS:
 
         Check an example in :trac:`28989`::
+
-            sage: Q=BinaryQF(1,1,-1)
+            sage: Q = BinaryQF(1,1,-1)
             sage: Q.cycle(proper=True)
             [x^2 + x*y - y^2, -x^2 + x*y + y^2]
 
         This is Example 6.10.6 of [BUVO2007]_::
+
-            sage: Q=BinaryQF(1,7,-6)
+            sage: Q = BinaryQF(1,7,-6)
```
and any other similar changes.

```diff
-        Try an example where a is negative::
-            sage: Q=BinaryQF(-1, 8, 3)
+        Try an example where `a` is negative::
+
+            sage: Q = BinaryQF(-1, 8, 3)
```
The for-loop part is over-indented here:

```
            for i in range(len(C)//2):
                    C[2*i+1] = C[2*i+1]._Tau()
```

```diff
-                C = C + C
+                C += C
```
I also don't understand the point of this test:

```
            sage: hasattr(Q, '_cycle_list')
            False
```



---

archive/issue_comments_537721.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee545279bc385f49de0520aed348401fb83d4660\">ee54527</a></td><td><code>fix minor issues</code></td></tr></table>\n",
    "created_at": "2020-01-22T03:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee545279bc385f49de0520aed348401fb83d4660">ee54527</a></td><td><code>fix minor issues</code></td></tr></table>




---

archive/issue_comments_537722.json:
```json
{
    "body": "**Changing commit** from \"[48d6e8939ee7d9750f518e004ca99a51ce043815](https://github.com/sagemath/sagetrac-mirror/commit/48d6e8939ee7d9750f518e004ca99a51ce043815)\" to \"[ee545279bc385f49de0520aed348401fb83d4660](https://github.com/sagemath/sagetrac-mirror/commit/ee545279bc385f49de0520aed348401fb83d4660)\".",
    "created_at": "2020-01-22T03:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537722",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[48d6e8939ee7d9750f518e004ca99a51ce043815](https://github.com/sagemath/sagetrac-mirror/commit/48d6e8939ee7d9750f518e004ca99a51ce043815)" to "[ee545279bc385f49de0520aed348401fb83d4660](https://github.com/sagemath/sagetrac-mirror/commit/ee545279bc385f49de0520aed348401fb83d4660)".



---

archive/issue_comments_537723.json:
```json
{
    "body": "<a id='comment:13'></a>\nThanks for looking at the ticket, and for your corrections. I made all of the changes that you suggested, and searched to correct similar mistakes. I also noticed that the spacing in lists was inconsistent, so I standardized by always putting a space after commas.\n\nYou were right to question the `hasattr` test, because it does not really make sense as a doctest. So I deleted it, and also the similar test a few lines later.",
    "created_at": "2020-01-22T03:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537723",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:13'></a>
Thanks for looking at the ticket, and for your corrections. I made all of the changes that you suggested, and searched to correct similar mistakes. I also noticed that the spacing in lists was inconsistent, so I standardized by always putting a space after commas.

You were right to question the `hasattr` test, because it does not really make sense as a doctest. So I deleted it, and also the similar test a few lines later.



---

archive/issue_comments_537724.json:
```json
{
    "body": "<a id='comment:14'></a>\nThank you. However, all of these changes except for the one I pointed out are wrong:\n\n```diff\n-TESTS::\n+TESTS:\n```\nWhen there are two colons `::`, what should follow is indented and doctests. If there is only one colon `:`, then it should be normal text.",
    "created_at": "2020-01-22T03:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537724",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Thank you. However, all of these changes except for the one I pointed out are wrong:

```diff
-TESTS::
+TESTS:
```
When there are two colons `::`, what should follow is indented and doctests. If there is only one colon `:`, then it should be normal text.



---

archive/issue_comments_537725.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479\">b3c7900</a></td><td><code>double colons after TEST</code></td></tr></table>\n",
    "created_at": "2020-01-22T03:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537725",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479">b3c7900</a></td><td><code>double colons after TEST</code></td></tr></table>




---

archive/issue_comments_537726.json:
```json
{
    "body": "**Changing commit** from \"[ee545279bc385f49de0520aed348401fb83d4660](https://github.com/sagemath/sagetrac-mirror/commit/ee545279bc385f49de0520aed348401fb83d4660)\" to \"[b3c79005b3a51d9649408bf265a00584d8c76479](https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479)\".",
    "created_at": "2020-01-22T03:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ee545279bc385f49de0520aed348401fb83d4660](https://github.com/sagemath/sagetrac-mirror/commit/ee545279bc385f49de0520aed348401fb83d4660)" to "[b3c79005b3a51d9649408bf265a00584d8c76479](https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479)".



---

archive/issue_comments_537727.json:
```json
{
    "body": "<a id='comment:16'></a>\nSorry, I didn't know that (obviously). I think it is correct now.",
    "created_at": "2020-01-22T03:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537727",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:16'></a>
Sorry, I didn't know that (obviously). I think it is correct now.



---

archive/issue_comments_537728.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-01-22T03:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537728",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_537729.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2020-01-22T03:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537729",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_537730.json:
```json
{
    "body": "<a id='comment:17'></a>\nThank you.",
    "created_at": "2020-01-22T03:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537730",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Thank you.



---

archive/issue_comments_537731.json:
```json
{
    "body": "**Changing branch** from \"[public/28989](https://github.com/sagemath/sagetrac-mirror/tree/public/28989)\" to \"[b3c79005b3a51d9649408bf265a00584d8c76479](https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479)\".",
    "created_at": "2020-01-25T17:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28989#issuecomment-537731",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/28989](https://github.com/sagemath/sagetrac-mirror/tree/public/28989)" to "[b3c79005b3a51d9649408bf265a00584d8c76479](https://github.com/sagemath/sagetrac-mirror/commit/b3c79005b3a51d9649408bf265a00584d8c76479)".



---

archive/issue_events_083223.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-25T17:27:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28989",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28989#event-83223"
}
```
