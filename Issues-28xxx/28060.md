# Issue 28060: Extensions of finite fields embeddings: we have inverse image but `inverse_image` throws `NotImplemented`

archive/issues_027823.json:
```json
{
    "body": "The following gives me a map from GF(5<sup>2</sup>) to GF(5<sup>6</sup>) but the following leads users to believe that we can't invert it:\n\n```\n    sage: k.<a> = GF(5^2)\n    sage: K, f = k.extension(3, map=True)\n    sage: f(a) in K\n    True\n    sage: f.inverse_image(f(a))\n    AttributeError:\n    ...\n    NotImplementedError\n```\n\nHowever, the method `f.section()` provides the (partial) inverse map, and so the user should just have written `f.section()(a)`. I'm sure many users do not know that \"section\" means \"the partial inverse map\".\n\nThis ticket implements the trivial body `f.inverse_image()` so the user does not need to know this.\n\nCC:  @xcaruso @tscrim\n\nKeywords: finitefield, rings\n\nBranch/Commit: a2ae7def18a8854d720618e5c60ea960a2e841ec\n\nReviewer: Bruno Grenet\n\nAuthor: Johan Rosenkilde\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28060\n\n",
    "closed_at": "2019-08-26T22:14:56Z",
    "created_at": "2019-06-26T08:06:22Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Extensions of finite fields embeddings: we have inverse image but `inverse_image` throws `NotImplemented`",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28060",
    "user": "https://github.com/johanrosenkilde"
}
```
The following gives me a map from GF(5<sup>2</sup>) to GF(5<sup>6</sup>) but the following leads users to believe that we can't invert it:

```
    sage: k.<a> = GF(5^2)
    sage: K, f = k.extension(3, map=True)
    sage: f(a) in K
    True
    sage: f.inverse_image(f(a))
    AttributeError:
    ...
    NotImplementedError
```

However, the method `f.section()` provides the (partial) inverse map, and so the user should just have written `f.section()(a)`. I'm sure many users do not know that "section" means "the partial inverse map".

This ticket implements the trivial body `f.inverse_image()` so the user does not need to know this.

CC:  @xcaruso @tscrim

Keywords: finitefield, rings

Branch/Commit: a2ae7def18a8854d720618e5c60ea960a2e841ec

Reviewer: Bruno Grenet

Author: Johan Rosenkilde

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28060





---

archive/issue_comments_418376.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The following gives me a map from GF(5^2) to GF(5^6), but there's neither \"inverse\" or \"section\":\n+The following gives me a map from GF(5<sup>2</sup>) to GF(5<sup>6</sup>), but there's neither \"inverse\" or \"section\":\n \n ```\n     sage: k.<a> = GF(5^2)\n@@ -36,7 +36,7 @@\n     a\n ```\n \n-On a related note, a redundant implementation of seemingly exactly this map is also available in `sage/coding/relative_finite_field_extension.py`. That implementation should probably be removed and its few uses in `sage/coding` be changed to use the one in `sage/rings/finite_rings/hom_finite_field.pyx`.\n+On a related note, a redundant implementation of seemingly exactly this map is also available in `sage/coding/relative_finite_field_extension.py`. That implementation should probably be removed and its few uses in `sage/coding` be changed to use the one in `sage/rings/finite_rings/hom_finite_field.pyx`. \n \n Comment: 1\n \n```\n",
    "created_at": "2019-06-26T10:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418376",
    "user": "https://github.com/dimpase"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The following gives me a map from GF(5^2) to GF(5^6), but there's neither "inverse" or "section":
+The following gives me a map from GF(5<sup>2</sup>) to GF(5<sup>6</sup>), but there's neither "inverse" or "section":
 
 ```
     sage: k.<a> = GF(5^2)
@@ -36,7 +36,7 @@
     a
 ```
 
-On a related note, a redundant implementation of seemingly exactly this map is also available in `sage/coding/relative_finite_field_extension.py`. That implementation should probably be removed and its few uses in `sage/coding` be changed to use the one in `sage/rings/finite_rings/hom_finite_field.pyx`.
+On a related note, a redundant implementation of seemingly exactly this map is also available in `sage/coding/relative_finite_field_extension.py`. That implementation should probably be removed and its few uses in `sage/coding` be changed to use the one in `sage/rings/finite_rings/hom_finite_field.pyx`. 
 
 Comment: 1
 
```




---

archive/issue_comments_418377.json:
```json
{
    "body": "<a id='comment:3'></a>Oops, I should have updated my ancient Sage before posting this ticket: the `f.section()` method now works fine and gives a partial map from K to k which inverts `f`. Sorry for the noise!\n\nFor usability, I find it very strange that `f.inverse_image(f(a))` does not return `a`, but rather throws a `NotImplementedException`. I'm posting a patch that makes `inverse_image` behave like this.\n\n---\nNew commits:",
    "created_at": "2019-06-26T12:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418377",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:3'></a>Oops, I should have updated my ancient Sage before posting this ticket: the `f.section()` method now works fine and gives a partial map from K to k which inverts `f`. Sorry for the noise!

For usability, I find it very strange that `f.inverse_image(f(a))` does not return `a`, but rather throws a `NotImplementedException`. I'm posting a patch that makes `inverse_image` behave like this.

---
New commits:



---

archive/issue_comments_418378.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,19 @@\n+The following gives me a map from GF(5<sup>2</sup>) to GF(5<sup>6</sup>) but the following leads users to believe that we can't invert it:\n \n+```\n+    sage: k.<a> = GF(5^2)\n+    sage: K, f = k.extension(3, map=True)\n+    sage: f(a) in K\n+    True\n+    sage: f.inverse_image(f(a))\n+    AttributeError:\n+    ...\n+    NotImplementedError\n+```\n+\n+However, the method `f.section()` provides the (partial) inverse map, and so the user should just have written `f.section()(a)`. I'm sure many users do not know that \"section\" means \"the partial inverse map\".\n+\n+This ticket implements the trivial body `f.inverse_image()` so the user does not need to know this.\n \n Comment: 1\n \n```\n",
    "created_at": "2019-06-26T12:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418378",
    "user": "https://github.com/johanrosenkilde"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,19 @@
+The following gives me a map from GF(5<sup>2</sup>) to GF(5<sup>6</sup>) but the following leads users to believe that we can't invert it:
 
+```
+    sage: k.<a> = GF(5^2)
+    sage: K, f = k.extension(3, map=True)
+    sage: f(a) in K
+    True
+    sage: f.inverse_image(f(a))
+    AttributeError:
+    ...
+    NotImplementedError
+```
+
+However, the method `f.section()` provides the (partial) inverse map, and so the user should just have written `f.section()(a)`. I'm sure many users do not know that "section" means "the partial inverse map".
+
+This ticket implements the trivial body `f.inverse_image()` so the user does not need to know this.
 
 Comment: 1
 
```




---

archive/issue_comments_418379.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-26T12:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418379",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_418380.json:
```json
{
    "body": "<a id='comment:5'></a>Hi Johan, I have two very minor comments: \n\n1. There is a typo `methid` instead of `method` in the documentation.\n2. ``self.section()`` and ``b`` should have double backticks.\n\nOtherwise, LGTM.",
    "created_at": "2019-08-22T09:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418380",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:5'></a>Hi Johan, I have two very minor comments: 

1. There is a typo `methid` instead of `method` in the documentation.
2. ``self.section()`` and ``b`` should have double backticks.

Otherwise, LGTM.



---

archive/issue_comments_418381.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-22T10:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418382.json:
```json
{
    "body": "<a id='comment:7'></a>Cool, thanks Bruno!",
    "created_at": "2019-08-22T10:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418382",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:7'></a>Cool, thanks Bruno!



---

archive/issue_comments_418383.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-22T10:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418383",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_418384.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-26T22:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28060#issuecomment-418384",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069538.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-26T22:14:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28060",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28060#event-69538"
}
```
