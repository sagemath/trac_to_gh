# Issue 28320: Further fixes for sage-env-less installs

archive/issues_028083.json:
```json
{
    "body": "Follow-up for #28225\n\n- Set SAGE_DOC as fallback for SAGE_DOC_SRC when sage-env is not available\n- Fix sage-cython on python3\n\nCC:  @kiwifb @jhpalmieri\n\nBranch/Commit: 638a33b7f1bf871f7706dbde59734be744134f16\n\nReviewer: John Palmieri\n\nAuthor: Antonio Rojas, Fran\u00e7ois Bissey\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28320\n\n",
    "closed_at": "2019-08-11T16:44:00Z",
    "created_at": "2019-08-04T08:50:43Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Further fixes for sage-env-less installs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28320",
    "user": "https://github.com/antonio-rojas"
}
```
Follow-up for #28225

- Set SAGE_DOC as fallback for SAGE_DOC_SRC when sage-env is not available
- Fix sage-cython on python3

CC:  @kiwifb @jhpalmieri

Branch/Commit: 638a33b7f1bf871f7706dbde59734be744134f16

Reviewer: John Palmieri

Author: Antonio Rojas, François Bissey

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28320





---

archive/issue_comments_422391.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n+Follow-up for FS#28225\n \n+- Set SAGE_DOC as fallback for SAGE_DOC_SRC when sage-env is not available\n+- Fix sage-cython on python3\n \n Comment: 1\n \n```\n",
    "created_at": "2019-08-04T08:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422391",
    "user": "https://github.com/antonio-rojas"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,7 @@
+Follow-up for FS#28225
 
+- Set SAGE_DOC as fallback for SAGE_DOC_SRC when sage-env is not available
+- Fix sage-cython on python3
 
 Comment: 1
 
```




---

archive/issue_comments_422392.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-08-04T08:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422392",
    "user": "https://github.com/antonio-rojas"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_422393.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to distribution.",
    "created_at": "2019-08-04T08:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422393",
    "user": "https://github.com/antonio-rojas"
}
```

Changing component from PLEASE CHANGE to distribution.



---

archive/issue_comments_422394.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-04T08:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422394",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422395.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-04T08:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422396.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n+Follow-up for #28225\n \n+- Set SAGE_DOC as fallback for SAGE_DOC_SRC when sage-env is not available\n+- Fix sage-cython on python3\n \n Comment: 1\n \n```\n",
    "created_at": "2019-08-04T09:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422396",
    "user": "https://github.com/antonio-rojas"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,7 @@
+Follow-up for #28225
 
+- Set SAGE_DOC as fallback for SAGE_DOC_SRC when sage-env is not available
+- Fix sage-cython on python3
 
 Comment: 1
 
```




---

archive/issue_comments_422397.json:
```json
{
    "body": "<a id='comment:5'></a>Fran\u00e7ois, feel free to take over the branch and add any further fixes. I'll be on vacation with no computer access for the next 3 weeks.",
    "created_at": "2019-08-04T09:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422397",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:5'></a>François, feel free to take over the branch and add any further fixes. I'll be on vacation with no computer access for the next 3 weeks.



---

archive/issue_comments_422398.json:
```json
{
    "body": "<a id='comment:6'></a>Have a nice one then!",
    "created_at": "2019-08-04T09:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422398",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>Have a nice one then!



---

archive/issue_comments_422399.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-04T21:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422399",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_422400.json:
```json
{
    "body": "<a id='comment:7'></a>While it may be overkill, does that fix your python3 problem, John? If not I move to one of the fix you suggested. Lastly, since it is deprecated, there is the option of just removing `sage-cython`.\n\n---\nNew commits:",
    "created_at": "2019-08-04T21:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422400",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>While it may be overkill, does that fix your python3 problem, John? If not I move to one of the fix you suggested. Lastly, since it is deprecated, there is the option of just removing `sage-cython`.

---
New commits:



---

archive/issue_comments_422401.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 fbissey]:\n> While it may be overkill, does that fix your python3 problem, John? If not I move to one of the fix you suggested. Lastly, since it is deprecated, there is the option of just removing `sage-cython`.\n\n\nThis does fix it. While it's deprecated, I'm not sure what the plans are: maybe to make `sage --cython` just call `cython` directly? Better to ask the people involved with the deprecation (#27041). I don't think we can just delete it, since `sage --cython` uses it right now.",
    "created_at": "2019-08-05T00:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422401",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>Replying to [comment:7 fbissey]:
> While it may be overkill, does that fix your python3 problem, John? If not I move to one of the fix you suggested. Lastly, since it is deprecated, there is the option of just removing `sage-cython`.


This does fix it. While it's deprecated, I'm not sure what the plans are: maybe to make `sage --cython` just call `cython` directly? Better to ask the people involved with the deprecation (#27041). I don't think we can just delete it, since `sage --cython` uses it right now.



---

archive/issue_comments_422402.json:
```json
{
    "body": "<a id='comment:9'></a>Merged 6 months ago, so it is probably too early for removal anyway. I think getting it to run with whichever python sage has been built with, is the right thing to do.\n\nIf you don't have any objections or problem with the rest of the branch, could I ask for a review :)",
    "created_at": "2019-08-05T00:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422402",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>Merged 6 months ago, so it is probably too early for removal anyway. I think getting it to run with whichever python sage has been built with, is the right thing to do.

If you don't have any objections or problem with the rest of the branch, could I ask for a review :)



---

archive/issue_comments_422403.json:
```json
{
    "body": "<a id='comment:10'></a>My general feeling is that we should use `python` rather than `sage-python23` whenever possible, so I'm not delighted with this change. It is possible that someone could use the  `sage-cython` script before Sage has been completely installed, but not with this change.\n\nHowever, since the whole thing is deprecated, I'm not going to worry too much about it. Sage builds with this change, so it doesn't break anything in the build process. The other changes look safe enough. Let me run a few more tests, but it's probably ready to go.",
    "created_at": "2019-08-05T20:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422403",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>My general feeling is that we should use `python` rather than `sage-python23` whenever possible, so I'm not delighted with this change. It is possible that someone could use the  `sage-cython` script before Sage has been completely installed, but not with this change.

However, since the whole thing is deprecated, I'm not going to worry too much about it. Sage builds with this change, so it doesn't break anything in the build process. The other changes look safe enough. Let me run a few more tests, but it's probably ready to go.



---

archive/issue_comments_422404.json:
```json
{
    "body": "<a id='comment:11'></a>Okay, it builds from scratch with Python 2 and Python 3, with only the expected failures with Python 3.",
    "created_at": "2019-08-05T23:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422404",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>Okay, it builds from scratch with Python 2 and Python 3, with only the expected failures with Python 3.



---

archive/issue_comments_422405.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-05T23:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422405",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_422406.json:
```json
{
    "body": "<a id='comment:12'></a>Author is missing",
    "created_at": "2019-08-08T22:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422406",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>Author is missing



---

archive/issue_comments_422407.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-08-08T22:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422407",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_422408.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-08-08T22:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422408",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_422409.json:
```json
{
    "body": "<a id='comment:13'></a>Fixed.",
    "created_at": "2019-08-08T22:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422409",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>Fixed.



---

archive/issue_events_070701.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-11T16:44:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28320#event-70701"
}
```



---

archive/issue_comments_422410.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-11T16:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28320#issuecomment-422410",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
