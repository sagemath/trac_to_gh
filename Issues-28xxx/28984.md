# Issue 28984: gfan - clash of log2 macro with standard library

archive/issues_028747.json:
```json
{
    "body": "CC:  @rwst @kiwifb @dimpase @vbraun @isuruf\n\ngfan build fails with an error when `CXXFLAGS` includes `-std=c++14` (observed in a conda environment - #27699) -- log for `conda-forge-minimal` see https://github.com/mkoeppe/sage/runs/542501523\n\nSame error as reported and fixed here:\n\n241194 \u2013 math/gfan: fix build on 13.0-CURRENT: https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=241194\n\nPatch: \nhttps://bz-attachments.freebsd.org/attachment.cgi?id=208243\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28984\n\n",
    "closed_at": "2020-04-09T22:45:11Z",
    "created_at": "2020-01-11T01:35:45Z",
    "labels": [
        "component: packages: standard",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "gfan - clash of log2 macro with standard library",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28984",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @rwst @kiwifb @dimpase @vbraun @isuruf

gfan build fails with an error when `CXXFLAGS` includes `-std=c++14` (observed in a conda environment - #27699) -- log for `conda-forge-minimal` see https://github.com/mkoeppe/sage/runs/542501523

Same error as reported and fixed here:

241194 â€“ math/gfan: fix build on 13.0-CURRENT: https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=241194

Patch: 
https://bz-attachments.freebsd.org/attachment.cgi?id=208243


Issue created by migration from https://trac.sagemath.org/ticket/28984





---

archive/issue_comments_405558.json:
```json
{
    "body": "Attachment [gfan-0.6.2.p1.log](tarball://root/attachments/some-uuid/ticket28984/gfan-0.6.2.p1.log) by @mkoeppe created at 2020-01-11 02:24:35",
    "created_at": "2020-01-11T02:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405558",
    "user": "https://github.com/mkoeppe"
}
```

Attachment [gfan-0.6.2.p1.log](tarball://root/attachments/some-uuid/ticket28984/gfan-0.6.2.p1.log) by @mkoeppe created at 2020-01-11 02:24:35



---

archive/issue_comments_405559.json:
```json
{
    "body": "Currently sage's and sage's dependency C++ code is compiled with -std=c++11 unless overridden. This is autoconf macro's fault. So it won't be visible inside vanilla sage for the time being. But it is very important on distros. Also we should note that singular has a copy of \"libgfan\" based on the same code. There is probably an enforcement of c++11 in singular at the present time but the offending code may be there as well.\n\nHas upstream been contacted?",
    "created_at": "2020-01-11T02:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405559",
    "user": "https://github.com/kiwifb"
}
```

Currently sage's and sage's dependency C++ code is compiled with -std=c++11 unless overridden. This is autoconf macro's fault. So it won't be visible inside vanilla sage for the time being. But it is very important on distros. Also we should note that singular has a copy of "libgfan" based on the same code. There is probably an enforcement of c++11 in singular at the present time but the offending code may be there as well.

Has upstream been contacted?



---

archive/issue_comments_405560.json:
```json
{
    "body": "Replying to [comment:2 fbissey]:\n> Has upstream been contacted?\n\nI haven't contacted upstream.",
    "created_at": "2020-01-11T02:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405560",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:2 fbissey]:
> Has upstream been contacted?

I haven't contacted upstream.



---

archive/issue_comments_405561.json:
```json
{
    "body": "I'm using the following hack in conda-forge. https://github.com/conda-forge/gfan-feedstock/blob/master/recipe/build.sh#L9",
    "created_at": "2020-03-29T04:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405561",
    "user": "https://github.com/isuruf"
}
```

I'm using the following hack in conda-forge. https://github.com/conda-forge/gfan-feedstock/blob/master/recipe/build.sh#L9



---

archive/issue_comments_405562.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2020-03-29T14:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405562",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_405563.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-03-30T01:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405563",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_405564.json:
```json
{
    "body": "That works.\n\n---\nNew commits:",
    "created_at": "2020-03-30T01:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405564",
    "user": "https://github.com/mkoeppe"
}
```

That works.

---
New commits:



---

archive/issue_comments_405565.json:
```json
{
    "body": "LGTM",
    "created_at": "2020-03-30T02:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405565",
    "user": "https://github.com/isuruf"
}
```

LGTM



---

archive/issue_comments_405566.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-30T02:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405566",
    "user": "https://github.com/isuruf"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_405567.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-03-30T04:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405567",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_events_073406.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-09T22:45:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28984#event-73406"
}
```



---

archive/issue_comments_405568.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-09T22:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28984#issuecomment-405568",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
