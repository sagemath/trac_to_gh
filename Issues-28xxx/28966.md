# Issue 28966: character art: line wrapping for matrices

archive/issues_028966.json:
```json
{
    "body": "Keywords: ascii_art, unicode_art\n\nThis ticket adds breakpoints to the ASCII and unicode art representations of matrices, so that wide matrices are wrapped in a readable way:\n\n```\nsage: %display unicode_art 80\nsage: set_random_seed(0)\nsage: matrix.random(RDF, 3, 8)\n\u239b -0.27440062056807446    0.5031965950979831 -0.001975438590219314\n\u239c -0.35104242112828943    0.5084492941557279   0.19906256610645512\n\u239d -0.20282268041839324    0.0728476884470246   -0.9938082549986424\n\n   -0.9467802263760512    0.5056889961514748  -0.05461130074681608\n    0.3242250183948632    0.6026443545751128   -0.9541798283979341\n  0.004239223023573491   -0.6670085876677831    -0.635743483594841\n\n -0.033673314214051286   -0.9401270875197381\u239e\n   -0.8948790563276592   -0.5763034867990717\u239f\n    0.5778937006648461   -0.9007365327499568\u23a0\n```\n\nPreviously, the output was completely scrambled if the matrix was wider than the window size:\n\n```\n\u239b -0.27440062056807446    0.5031965950979831 -0.001975438590219314   -0.94678022\n63760512    0.5056889961514748  -0.05461130074681608 -0.033673314214051286   -0.\n9401270875197381\u239e\n\u239c -0.35104242112828943    0.5084492941557279   0.19906256610645512    0.32422501\n83948632    0.6026443545751128   -0.9541798283979341   -0.8948790563276592   -0.\n5763034867990717\u239f\n\u239d -0.20282268041839324    0.0728476884470246   -0.9938082549986424  0.0042392230\n23573491   -0.6670085876677831    -0.635743483594841    0.5778937006648461   -0.\n9007365327499568\u23a0\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29203\n\n",
    "closed_at": "2020-02-19T23:26:44Z",
    "created_at": "2020-02-15T12:58:01Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "character art: line wrapping for matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28966",
    "user": "https://github.com/mwageringel"
}
```
Keywords: ascii_art, unicode_art

This ticket adds breakpoints to the ASCII and unicode art representations of matrices, so that wide matrices are wrapped in a readable way:

```
sage: %display unicode_art 80
sage: set_random_seed(0)
sage: matrix.random(RDF, 3, 8)
⎛ -0.27440062056807446    0.5031965950979831 -0.001975438590219314
⎜ -0.35104242112828943    0.5084492941557279   0.19906256610645512
⎝ -0.20282268041839324    0.0728476884470246   -0.9938082549986424

   -0.9467802263760512    0.5056889961514748  -0.05461130074681608
    0.3242250183948632    0.6026443545751128   -0.9541798283979341
  0.004239223023573491   -0.6670085876677831    -0.635743483594841

 -0.033673314214051286   -0.9401270875197381⎞
   -0.8948790563276592   -0.5763034867990717⎟
    0.5778937006648461   -0.9007365327499568⎠
```

Previously, the output was completely scrambled if the matrix was wider than the window size:

```
⎛ -0.27440062056807446    0.5031965950979831 -0.001975438590219314   -0.94678022
63760512    0.5056889961514748  -0.05461130074681608 -0.033673314214051286   -0.
9401270875197381⎞
⎜ -0.35104242112828943    0.5084492941557279   0.19906256610645512    0.32422501
83948632    0.6026443545751128   -0.9541798283979341   -0.8948790563276592   -0.
5763034867990717⎟
⎝ -0.20282268041839324    0.0728476884470246   -0.9938082549986424  0.0042392230
23573491   -0.6670085876677831    -0.635743483594841    0.5778937006648461   -0.
9007365327499568⎠
```


Issue created by migration from https://trac.sagemath.org/ticket/29203





---

archive/issue_comments_409579.json:
```json
{
    "body": "There is one small caveat: In the case of lists of matrices that do not exceed the window width, it can happen that now the output is wrapped\n\n```\nsage: %display unicode_art 80\nsage: set_random_seed(0)\nsage: [matrix.random(RDF, 3, 2), matrix.random(RDF, 3, 3)]\n\u23a1 \u239b -0.27440062056807446    0.5031965950979831\u239e  \u239b-0.033673314214051286\n\u23a2 \u239c-0.001975438590219314   -0.9467802263760512\u239f  \u239c   0.5084492941557279\n\u23a3 \u239d   0.5056889961514748  -0.05461130074681608\u23a0, \u239d   0.6026443545751128\n\n   -0.9401270875197381  -0.35104242112828943\u239e \u23a4\n   0.19906256610645512    0.3242250183948632\u239f \u23a5\n   -0.9541798283979341   -0.8948790563276592\u23a0 \u23a6\n```\nwhile previously the matrices were displayed in one piece:\n\n```\n\u23a1 \u239b -0.27440062056807446    0.5031965950979831\u239e\n\u23a2 \u239c-0.001975438590219314   -0.9467802263760512\u239f\n\u23a3 \u239d   0.5056889961514748  -0.05461130074681608\u23a0,\n\n \u239b-0.033673314214051286   -0.9401270875197381  -0.35104242112828943\u239e \u23a4\n \u239c   0.5084492941557279   0.19906256610645512    0.3242250183948632\u239f \u23a5\n \u239d   0.6026443545751128   -0.9541798283979341   -0.8948790563276592\u23a0 \u23a6\n```\nThis is fixed by #29204, but \u2013 even without that ticket as a dependency \u2013 it would make sense to merge this ticket because the output of wide matrices is so vastly improved in all other cases.",
    "created_at": "2020-02-15T13:01:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409579",
    "user": "https://github.com/mwageringel"
}
```

There is one small caveat: In the case of lists of matrices that do not exceed the window width, it can happen that now the output is wrapped

```
sage: %display unicode_art 80
sage: set_random_seed(0)
sage: [matrix.random(RDF, 3, 2), matrix.random(RDF, 3, 3)]
⎡ ⎛ -0.27440062056807446    0.5031965950979831⎞  ⎛-0.033673314214051286
⎢ ⎜-0.001975438590219314   -0.9467802263760512⎟  ⎜   0.5084492941557279
⎣ ⎝   0.5056889961514748  -0.05461130074681608⎠, ⎝   0.6026443545751128

   -0.9401270875197381  -0.35104242112828943⎞ ⎤
   0.19906256610645512    0.3242250183948632⎟ ⎥
   -0.9541798283979341   -0.8948790563276592⎠ ⎦
```
while previously the matrices were displayed in one piece:

```
⎡ ⎛ -0.27440062056807446    0.5031965950979831⎞
⎢ ⎜-0.001975438590219314   -0.9467802263760512⎟
⎣ ⎝   0.5056889961514748  -0.05461130074681608⎠,

 ⎛-0.033673314214051286   -0.9401270875197381  -0.35104242112828943⎞ ⎤
 ⎜   0.5084492941557279   0.19906256610645512    0.3242250183948632⎟ ⎥
 ⎝   0.6026443545751128   -0.9541798283979341   -0.8948790563276592⎠ ⎦
```
This is fixed by #29204, but – even without that ticket as a dependency – it would make sense to merge this ticket because the output of wide matrices is so vastly improved in all other cases.



---

archive/issue_comments_409580.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-15T13:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409580",
    "user": "https://github.com/mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_409581.json:
```json
{
    "body": "Changing keywords from \"\" to \"ascii_art, unicode_art\".",
    "created_at": "2020-02-15T13:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409581",
    "user": "https://github.com/mwageringel"
}
```

Changing keywords from "" to "ascii_art, unicode_art".



---

archive/issue_comments_409582.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-02-15T13:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409582",
    "user": "https://github.com/mwageringel"
}
```

New commits:



---

archive/issue_comments_409583.json:
```json
{
    "body": "What is the rationale for the globally defined `max_rows = 20` and `max_cols = 50` (that are used in `_ascii_art_`)?",
    "created_at": "2020-02-15T15:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409583",
    "user": "https://github.com/videlec"
}
```

What is the rationale for the globally defined `max_rows = 20` and `max_cols = 50` (that are used in `_ascii_art_`)?



---

archive/issue_comments_409584.json:
```json
{
    "body": "In plain text mode, matrices larger than that do not show their entries by default, but print a summary instead:\n\n```\nsage: %display plain\nsage: matrix.identity(20)\n20 x 20 dense matrix over Integer Ring (use the '.str()' method to see the entries)\n```\nThis behavior is copied by `ascii_art` and `unicode_art`.\n\n```\nsage: %display ascii_art\nsage: matrix.identity(20)\n20 x 20 dense matrix over Integer Ring\n```\n\nBeing global variables, one can set different default values for these variables in `init.sage` to customize this behavior.\n\nNote that the message `(use the '.str()' method to see the entries)` is not part of the repr, but is added by the display manager using `LargeMatrixHelpRepr`, which is not used in `ascii_art` display mode.",
    "created_at": "2020-02-16T08:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409584",
    "user": "https://github.com/mwageringel"
}
```

In plain text mode, matrices larger than that do not show their entries by default, but print a summary instead:

```
sage: %display plain
sage: matrix.identity(20)
20 x 20 dense matrix over Integer Ring (use the '.str()' method to see the entries)
```
This behavior is copied by `ascii_art` and `unicode_art`.

```
sage: %display ascii_art
sage: matrix.identity(20)
20 x 20 dense matrix over Integer Ring
```

Being global variables, one can set different default values for these variables in `init.sage` to customize this behavior.

Note that the message `(use the '.str()' method to see the entries)` is not part of the repr, but is added by the display manager using `LargeMatrixHelpRepr`, which is not used in `ascii_art` display mode.



---

archive/issue_comments_409585.json:
```json
{
    "body": "I see. However, I doubt that among developers 20% know about the `max_rows`/`max_cols` customization... Note that integer partitions introduced `Partitions.options.display` to deal with printing details.\n\nAnyway, this is not the purpose of the ticket! I am running the doctests on my machine (since the patchbots seem to be on strike).",
    "created_at": "2020-02-16T10:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409585",
    "user": "https://github.com/videlec"
}
```

I see. However, I doubt that among developers 20% know about the `max_rows`/`max_cols` customization... Note that integer partitions introduced `Partitions.options.display` to deal with printing details.

Anyway, this is not the purpose of the ticket! I am running the doctests on my machine (since the patchbots seem to be on strike).



---

archive/issue_comments_409586.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-16T10:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409586",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_409587.json:
```json
{
    "body": "Thank you for the reviews.",
    "created_at": "2020-02-16T17:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409587",
    "user": "https://github.com/mwageringel"
}
```

Thank you for the reviews.



---

archive/issue_events_074172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-19T23:26:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28966#event-74172"
}
```



---

archive/issue_comments_409588.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-19T23:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28966#issuecomment-409588",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
