# Issue 28142: Girth of directed graphs

archive/issues_027905.json:
```json
{
    "body": "This ticket adds a BFS-based computation of girth of directed graphs (i.e., length of shortest directed cycle). The existing algorithm, which did not work properly for directed graphs of girth larger than 2, is now moved to a hidden method in `graph.py`, and the same method in `digraph.py` now works properly for the directed case. The appropriate method is then called in `generic_graph.py` after checking some border cases.\n\nBoth methods also accept a parameter `odd`, which, when set to `True`, will make the methods compute the odd girth of a graph (length of shortest odd cycle). This was not previously available for directed graphs, while for undirected graphs, a method based on the characteristic polynomial was used. This is still available (in both the directed and undirected case) by setting the appropriate `algorithm` parameter - however, the default is now to use the above BFS-based algorithm. I have run some examples and the characteristic polynomial based method was almost always slower (it was only faster for bipartite graphs, which can be quickly checked), so I decided to set the `\"bfs\"` algorithm as default, with the other options available in case there is some class of graphs where it would be advantageous to use them.\n\nCC:  @dcoudert\n\nKeywords: fpsac2019\n\nBranch/Commit: 41a135a7bef75e259303731e8869073711fdf00c\n\nReviewer: David Coudert\n\nAuthor: Jano\u0161 Vidali\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28142\n\n",
    "closed_at": "2019-07-20T09:10:50Z",
    "created_at": "2019-07-09T12:32:08Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Girth of directed graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28142",
    "user": "https://github.com/jaanos"
}
```
This ticket adds a BFS-based computation of girth of directed graphs (i.e., length of shortest directed cycle). The existing algorithm, which did not work properly for directed graphs of girth larger than 2, is now moved to a hidden method in `graph.py`, and the same method in `digraph.py` now works properly for the directed case. The appropriate method is then called in `generic_graph.py` after checking some border cases.

Both methods also accept a parameter `odd`, which, when set to `True`, will make the methods compute the odd girth of a graph (length of shortest odd cycle). This was not previously available for directed graphs, while for undirected graphs, a method based on the characteristic polynomial was used. This is still available (in both the directed and undirected case) by setting the appropriate `algorithm` parameter - however, the default is now to use the above BFS-based algorithm. I have run some examples and the characteristic polynomial based method was almost always slower (it was only faster for bipartite graphs, which can be quickly checked), so I decided to set the `"bfs"` algorithm as default, with the other options available in case there is some class of graphs where it would be advantageous to use them.

CC:  @dcoudert

Keywords: fpsac2019

Branch/Commit: 41a135a7bef75e259303731e8869073711fdf00c

Reviewer: David Coudert

Author: Jano≈° Vidali

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28142





---

archive/issue_comments_419470.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+This ticket adds a BFS-based computation of girth of directed graphs (i.e., length of shortest directed cycle). The existing algorithm, which did not work properly for directed graphs of girth larger than 2, is now moved to a hidden method in `graph.py`, and the same method in `digraph.py` now works properly for the directed case. The appropriate method is then called in `generic_graph.py` after checking some border cases.\n \n+Both methods also accept a parameter `odd`, which, when set to `True`, will make the methods compute the odd girth of a graph (length of shortest odd cycle). This was not previously available for directed graphs, while for undirected graphs, a method based on the characteristic polynomial was used. This is still available (in both the directed and undirected case) by setting the appropriate `algorithm` parameter - however, the default is now to use the above BFS-based algorithm. I have run some examples and the characteristic polynomial based method was almost always slower (it was only faster for bipartite graphs, which can be quickly checked), so I decided to set the `\"bfs\"` algorithm as default, with the other options available in case there is some class of graphs where it would be advantageous to use them.\n \n Comment: 1\n \n``````\n",
    "created_at": "2019-07-09T12:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419470",
    "user": "https://github.com/jaanos"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+This ticket adds a BFS-based computation of girth of directed graphs (i.e., length of shortest directed cycle). The existing algorithm, which did not work properly for directed graphs of girth larger than 2, is now moved to a hidden method in `graph.py`, and the same method in `digraph.py` now works properly for the directed case. The appropriate method is then called in `generic_graph.py` after checking some border cases.
 
+Both methods also accept a parameter `odd`, which, when set to `True`, will make the methods compute the odd girth of a graph (length of shortest odd cycle). This was not previously available for directed graphs, while for undirected graphs, a method based on the characteristic polynomial was used. This is still available (in both the directed and undirected case) by setting the appropriate `algorithm` parameter - however, the default is now to use the above BFS-based algorithm. I have run some examples and the characteristic polynomial based method was almost always slower (it was only faster for bipartite graphs, which can be quickly checked), so I decided to set the `"bfs"` algorithm as default, with the other options available in case there is some class of graphs where it would be advantageous to use them.
 
 Comment: 1
 
``````




---

archive/issue_comments_419471.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-07-09T12:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419471",
    "user": "https://github.com/jaanos"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_419472.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2019-07-09T12:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419472",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_419473.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to graph theory.",
    "created_at": "2019-07-09T12:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419473",
    "user": "https://github.com/jaanos"
}
```

Changing component from PLEASE CHANGE to graph theory.



---

archive/issue_comments_419474.json:
```json
{
    "body": "<a id='comment:3'></a>I will add the doctests in the next commit. Should I also add a `_girth_bfs` method in `generic_graphs.py` (which would raise `NotImplementedError`)?",
    "created_at": "2019-07-09T12:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419474",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:3'></a>I will add the doctests in the next commit. Should I also add a `_girth_bfs` method in `generic_graphs.py` (which would raise `NotImplementedError`)?



---

archive/issue_comments_419475.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2019-07-09T12:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419475",
    "user": "https://github.com/jaanos"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_419476.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T09:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419476",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419477.json:
```json
{
    "body": "<a id='comment:5'></a>Some quick comments:\n\n- references must be put in file `src/doc/en/reference/references/index.rst`. Then you can cite them in the documentation of the methods using `[Har62]_` and `[Biggs93]_`.\n\n- in input blocks, the correct format is:\n\n```diff\n-        - ``odd`` -- whether to compute the odd girth (default: ``False``).\n+        - ``odd`` -- boolean (default: ``False``); whether to compute the odd girth\n```\n\n- in `generic_graph.py`, why not extending method `girth` by adding it parameter `odd` and then call the appropriate method for graph or digraph or bipartite graph or ... \n\n- Is it possible to add parameter `certificate` in these methods to return the cycle, if any ?",
    "created_at": "2019-07-10T09:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419477",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>Some quick comments:

- references must be put in file `src/doc/en/reference/references/index.rst`. Then you can cite them in the documentation of the methods using `[Har62]_` and `[Biggs93]_`.

- in input blocks, the correct format is:

```diff
-        - ``odd`` -- whether to compute the odd girth (default: ``False``).
+        - ``odd`` -- boolean (default: ``False``); whether to compute the odd girth
```

- in `generic_graph.py`, why not extending method `girth` by adding it parameter `odd` and then call the appropriate method for graph or digraph or bipartite graph or ... 

- Is it possible to add parameter `certificate` in these methods to return the cycle, if any ?



---

archive/issue_comments_419478.json:
```json
{
    "body": "<a id='comment:6'></a>Thanks for the feedback! Will fix the references and input.\n\nRegarding the parameter: I was thinking about that, actually. I forgot about `BipartiteGraph` - I guess the way to go would be to have the algorithm for undirected graphs in `generic_graph.py`, so it would also work for bipartite graphs.\n\nRegarding the certificate, a cycle would only show that the (odd) girth is at most its length. Would that be OK?",
    "created_at": "2019-07-10T10:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419478",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:6'></a>Thanks for the feedback! Will fix the references and input.

Regarding the parameter: I was thinking about that, actually. I forgot about `BipartiteGraph` - I guess the way to go would be to have the algorithm for undirected graphs in `generic_graph.py`, so it would also work for bipartite graphs.

Regarding the certificate, a cycle would only show that the (odd) girth is at most its length. Would that be OK?



---

archive/issue_comments_419479.json:
```json
{
    "body": "<a id='comment:7'></a>> Regarding the parameter: I was thinking about that, actually. I forgot about `BipartiteGraph` - I guess the way to go would be to have the algorithm for undirected graphs in `generic_graph.py`, so it would also work for bipartite graphs.\n\n\nThat would be nice.\nIn case, we also have a specific class for bipartite graphs in `bipartitie_graph.py`\n \n> Regarding the certificate, a cycle would only show that the (odd) girth is at most its length. Would that be OK?\n\n\nIf the method only returns an upper bound, then yes, as long as it is clearly documented. Otherwise, you can simply add a todo block letting this task for future work.",
    "created_at": "2019-07-10T10:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419479",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>> Regarding the parameter: I was thinking about that, actually. I forgot about `BipartiteGraph` - I guess the way to go would be to have the algorithm for undirected graphs in `generic_graph.py`, so it would also work for bipartite graphs.


That would be nice.
In case, we also have a specific class for bipartite graphs in `bipartitie_graph.py`
 
> Regarding the certificate, a cycle would only show that the (odd) girth is at most its length. Would that be OK?


If the method only returns an upper bound, then yes, as long as it is clearly documented. Otherwise, you can simply add a todo block letting this task for future work.



---

archive/issue_comments_419480.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T15:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419481.json:
```json
{
    "body": "<a id='comment:9'></a>OK, I've moved the main algorithm to `generic_graph.py`, fixed the references, and added certificates. I'm not sure any more that having a parameter `odd` on the `girth` method would be good - it is there for `_girth_bfs` since the method is used for both, but as concepts (and therefore public methods) I think it's best to keep them separate.",
    "created_at": "2019-07-10T15:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419481",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:9'></a>OK, I've moved the main algorithm to `generic_graph.py`, fixed the references, and added certificates. I'm not sure any more that having a parameter `odd` on the `girth` method would be good - it is there for `_girth_bfs` since the method is used for both, but as concepts (and therefore public methods) I think it's best to keep them separate.



---

archive/issue_comments_419482.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-07-10T15:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419482",
    "user": "https://github.com/jaanos"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_419483.json:
```json
{
    "body": "Changing keywords from \"\" to \"fpsac2019\".",
    "created_at": "2019-07-11T08:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419483",
    "user": "https://github.com/jaanos"
}
```

Changing keywords from "" to "fpsac2019".



---

archive/issue_comments_419484.json:
```json
{
    "body": "<a id='comment:11'></a>I took the liberty to edit your code and push it in a new branch (in `public/` so that you can modify it as well).\n\nI did various small corrections and added several doctests (for instance for small cases).\n\nPlease check that every think is fine and that the documentation builds properly and displays nicely.\n\n---\nNew commits:",
    "created_at": "2019-07-14T19:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419484",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>I took the liberty to edit your code and push it in a new branch (in `public/` so that you can modify it as well).

I did various small corrections and added several doctests (for instance for small cases).

Please check that every think is fine and that the documentation builds properly and displays nicely.

---
New commits:



---

archive/issue_comments_419485.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-15T09:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419485",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419486.json:
```json
{
    "body": "<a id='comment:13'></a>Thanks, everything looks fine to me! I have just changed two words in the `Graph` method index.",
    "created_at": "2019-07-15T09:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419486",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:13'></a>Thanks, everything looks fine to me! I have just changed two words in the `Graph` method index.



---

archive/issue_comments_419487.json:
```json
{
    "body": "<a id='comment:14'></a>There is a failing doctest reported by the patchbot\n\n```\nsage -t --long src/sage/categories/category.py\n**********************************************************************\nFile \"src/sage/categories/category.py\", line 806, in sage.categories.category.Category.is_abelian.category_graph\nFailed example:\n    G.girth()\nExpected:\n    4\nGot:\n    +Infinity\n```",
    "created_at": "2019-07-15T12:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419487",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:14'></a>There is a failing doctest reported by the patchbot

```
sage -t --long src/sage/categories/category.py
**********************************************************************
File "src/sage/categories/category.py", line 806, in sage.categories.category.Category.is_abelian.category_graph
Failed example:
    G.girth()
Expected:
    4
Got:
    +Infinity
```



---

archive/issue_comments_419488.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-07-15T12:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419488",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_419489.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-15T13:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419489",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419490.json:
```json
{
    "body": "<a id='comment:16'></a>The doctest generated a directed acyclic graph, so its girth is now correctly reported as infinite. I have changed the doctest to compute the girth of its underlying undirected graph.",
    "created_at": "2019-07-15T13:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419490",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:16'></a>The doctest generated a directed acyclic graph, so its girth is now correctly reported as infinite. I have changed the doctest to compute the girth of its underlying undirected graph.



---

archive/issue_comments_419491.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-15T13:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419491",
    "user": "https://github.com/jaanos"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_419492.json:
```json
{
    "body": "<a id='comment:17'></a>You should add a comment explaining that the girth of a DAG is infinite, and that the girth of the underlying undirected graph is 4 in this case.",
    "created_at": "2019-07-15T13:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419492",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:17'></a>You should add a comment explaining that the girth of a DAG is infinite, and that the girth of the underlying undirected graph is 4 in this case.



---

archive/issue_comments_419493.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-16T11:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419494.json:
```json
{
    "body": "<a id='comment:19'></a>OK, done. I have also fixed the indenting of the `category_graph` method.",
    "created_at": "2019-07-16T11:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419494",
    "user": "https://github.com/jaanos"
}
```

<a id='comment:19'></a>OK, done. I have also fixed the indenting of the `category_graph` method.



---

archive/issue_comments_419495.json:
```json
{
    "body": "<a id='comment:20'></a>LGTM. Thanks.",
    "created_at": "2019-07-16T14:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419495",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:20'></a>LGTM. Thanks.



---

archive/issue_comments_419496.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-16T14:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419496",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_069855.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-20T09:10:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28142#event-69855"
}
```



---

archive/issue_comments_419497.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-20T09:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28142#issuecomment-419497",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
