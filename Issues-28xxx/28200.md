# Issue 28200: reduce base field for scheme morphisms

archive/issues_027963.json:
```json
{
    "body": "It is possible that the field defined by the coefficients is strictly contained in base field of the morphism. This can be happen in a number of situations, especially from conjugations or computing normal forms. There should be a general function to reduce to the field of definition of the coefficients.\n\nKeywords: SI2019\n\nBranch/Commit: [a0e7824d1b09faa5b59f55833b3ba51fef2d6456](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)\n\nReviewer: Meghan Grip, Emily Rachfal, Henry Talbott\n\nAuthor: Ben Hutz\n\nDependencies: #28161, #28174\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28200\n\n",
    "closed_at": "2019-08-01T22:54:56Z",
    "created_at": "2019-07-15T17:23:55Z",
    "labels": [
        "component: algebraic geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "reduce base field for scheme morphisms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28200",
    "user": "https://github.com/bhutz"
}
```
It is possible that the field defined by the coefficients is strictly contained in base field of the morphism. This can be happen in a number of situations, especially from conjugations or computing normal forms. There should be a general function to reduce to the field of definition of the coefficients.

Keywords: SI2019

Branch/Commit: [a0e7824d1b09faa5b59f55833b3ba51fef2d6456](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)

Reviewer: Meghan Grip, Emily Rachfal, Henry Talbott

Author: Ben Hutz

Dependencies: #28161, #28174

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28200





---

archive/issue_comments_548137.json:
```json
{
    "body": "Branch: [u/bhutz/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/28200_reduce_base_field)",
    "created_at": "2019-07-15T17:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548137",
    "user": "https://github.com/bhutz"
}
```

Branch: [u/bhutz/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/28200_reduce_base_field)



---

archive/issue_comments_548138.json:
```json
{
    "body": "<a id='comment:1'></a>\nHere is an initial implementation that could use some more testing.\n\nThis just implements the function and does not have any of the 'client' functions utilize this; like conjugate or normal form. I'm not sure those additional modifications should be part of this ticket.\n\n---\nNew commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[6c9c01f](https://github.com/sagemath/sagetrac-mirror/commit/6c9c01f05475b4f4dd986fbf926e7a76e5440396)|`28161: from_algebraics return ds`|\n|[b33de77](https://github.com/sagemath/sagetrac-mirror/commit/b33de7796207deae774310a0d727a84184ee44c9)|`28161 returns ds`|\n|[5a75f00](https://github.com/sagemath/sagetrac-mirror/commit/5a75f001222d06ed9ddf39c7d3531c62be1d9a4f)|`Merge branch 8.9.beta2 into t/28161/master`|\n|[f9db110](https://github.com/sagemath/sagetrac-mirror/commit/f9db110823490b2fda8217f4a2cf1a37fb10e0f4)|`28161: update docs`|\n|[c7b03d7](https://github.com/sagemath/sagetrac-mirror/commit/c7b03d7ef4652b4dd4fe55c548cf51d39696594f)|`28200: implement reduce_base_field for schememorphisms`|\n|[4f462a0](https://github.com/sagemath/sagetrac-mirror/commit/4f462a0255fef1590a6979d4b95fee204f55b432)|`28174: Fix dehomogenization error for non-endomorphisms`|\n|[222c9aa](https://github.com/sagemath/sagetrac-mirror/commit/222c9aa779e787ccee188349e87b653e2ab54758)|`Merge commit '4f462a0255fef1590a6979d4b95fee204f55b432' of git://trac.sagemath.org/sage into reduce_base`|",
    "created_at": "2019-07-15T17:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548138",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:1'></a>
Here is an initial implementation that could use some more testing.

This just implements the function and does not have any of the 'client' functions utilize this; like conjugate or normal form. I'm not sure those additional modifications should be part of this ticket.

---
New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[6c9c01f](https://github.com/sagemath/sagetrac-mirror/commit/6c9c01f05475b4f4dd986fbf926e7a76e5440396)|`28161: from_algebraics return ds`|
|[b33de77](https://github.com/sagemath/sagetrac-mirror/commit/b33de7796207deae774310a0d727a84184ee44c9)|`28161 returns ds`|
|[5a75f00](https://github.com/sagemath/sagetrac-mirror/commit/5a75f001222d06ed9ddf39c7d3531c62be1d9a4f)|`Merge branch 8.9.beta2 into t/28161/master`|
|[f9db110](https://github.com/sagemath/sagetrac-mirror/commit/f9db110823490b2fda8217f4a2cf1a37fb10e0f4)|`28161: update docs`|
|[c7b03d7](https://github.com/sagemath/sagetrac-mirror/commit/c7b03d7ef4652b4dd4fe55c548cf51d39696594f)|`28200: implement reduce_base_field for schememorphisms`|
|[4f462a0](https://github.com/sagemath/sagetrac-mirror/commit/4f462a0255fef1590a6979d4b95fee204f55b432)|`28174: Fix dehomogenization error for non-endomorphisms`|
|[222c9aa](https://github.com/sagemath/sagetrac-mirror/commit/222c9aa779e787ccee188349e87b653e2ab54758)|`Merge commit '4f462a0255fef1590a6979d4b95fee204f55b432' of git://trac.sagemath.org/sage into reduce_base`|



---

archive/issue_comments_548139.json:
```json
{
    "body": "Commit: [222c9aa779e787ccee188349e87b653e2ab54758](https://github.com/sagemath/sagetrac-mirror/commit/222c9aa779e787ccee188349e87b653e2ab54758)",
    "created_at": "2019-07-15T17:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548139",
    "user": "https://github.com/bhutz"
}
```

Commit: [222c9aa779e787ccee188349e87b653e2ab54758](https://github.com/sagemath/sagetrac-mirror/commit/222c9aa779e787ccee188349e87b653e2ab54758)



---

archive/issue_comments_548140.json:
```json
{
    "body": "Changing dependencies from \"28161, 28174\" to \"#28161, #28174\"",
    "created_at": "2019-07-15T17:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548140",
    "user": "https://github.com/bhutz"
}
```

Changing dependencies from "28161, 28174" to "#28161, #28174"



---

archive/issue_comments_548141.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-07-25T15:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548141",
    "user": "https://github.com/bhutz"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_548142.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-07-25T15:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548142",
    "user": "https://github.com/HTalbott"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_548143.json:
```json
{
    "body": "<a id='comment:4'></a>\nOn line 1684 of src/sage/schemes/projective/projective_morphism.py, the method finds the max of the the degrees of the coefficients. This should find the LCM rather than the max. For instance, the following code currently gives the minimal field as GF(5 to 3), when it should give GF(5 to 6), as below:\n\n```\nsage: K.<t>=GF(5^6)\nsage: A.<x>=AffineSpace(K,1)\nsage: H=End(A)\nsage: f=H([x^2+x*(t^3 + 2*t^2 + 4*t)+(t^5 + 3*t^4 + t^2 + 4*t)])\nsage: f.reduce_base_field()\nScheme endomorphism of Affine Space of dimension 1 over Finite Field in t of size 5^6\n  Defn: Defined on coordinates by sending (x) to\n        (x^2 + (t^3 + 2*t^2 - t)*x + (t^5 - 2*t^4 + t^2 - t))\n```",
    "created_at": "2019-07-25T15:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548143",
    "user": "https://github.com/HTalbott"
}
```

<a id='comment:4'></a>
On line 1684 of src/sage/schemes/projective/projective_morphism.py, the method finds the max of the the degrees of the coefficients. This should find the LCM rather than the max. For instance, the following code currently gives the minimal field as GF(5 to 3), when it should give GF(5 to 6), as below:

```
sage: K.<t>=GF(5^6)
sage: A.<x>=AffineSpace(K,1)
sage: H=End(A)
sage: f=H([x^2+x*(t^3 + 2*t^2 + 4*t)+(t^5 + 3*t^4 + t^2 + 4*t)])
sage: f.reduce_base_field()
Scheme endomorphism of Affine Space of dimension 1 over Finite Field in t of size 5^6
  Defn: Defined on coordinates by sending (x) to
        (x^2 + (t^3 + 2*t^2 - t)*x + (t^5 - 2*t^4 + t^2 - t))
```



---

archive/issue_comments_548144.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[1ad13ae](https://github.com/sagemath/sagetrac-mirror/commit/1ad13ae5d35db5d9b8e68bfd5d72a57b64b95f5d)|`Merge branch 8.9.beta4 into t/28200/28200_reduce_base_field`|\n|[e9fc3fa](https://github.com/sagemath/sagetrac-mirror/commit/e9fc3faa1c8acef91cfc1d03f987352bfedab7df)|`28200: fix to lcm and add example`|",
    "created_at": "2019-07-25T18:27:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548144",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[1ad13ae](https://github.com/sagemath/sagetrac-mirror/commit/1ad13ae5d35db5d9b8e68bfd5d72a57b64b95f5d)|`Merge branch 8.9.beta4 into t/28200/28200_reduce_base_field`|
|[e9fc3fa](https://github.com/sagemath/sagetrac-mirror/commit/e9fc3faa1c8acef91cfc1d03f987352bfedab7df)|`28200: fix to lcm and add example`|



---

archive/issue_comments_548145.json:
```json
{
    "body": "Changing commit from \"[222c9aa779e787ccee188349e87b653e2ab54758](https://github.com/sagemath/sagetrac-mirror/commit/222c9aa779e787ccee188349e87b653e2ab54758)\" to \"[e9fc3faa1c8acef91cfc1d03f987352bfedab7df](https://github.com/sagemath/sagetrac-mirror/commit/e9fc3faa1c8acef91cfc1d03f987352bfedab7df)\"",
    "created_at": "2019-07-25T18:27:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548145",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[222c9aa779e787ccee188349e87b653e2ab54758](https://github.com/sagemath/sagetrac-mirror/commit/222c9aa779e787ccee188349e87b653e2ab54758)" to "[e9fc3faa1c8acef91cfc1d03f987352bfedab7df](https://github.com/sagemath/sagetrac-mirror/commit/e9fc3faa1c8acef91cfc1d03f987352bfedab7df)"



---

archive/issue_comments_548146.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-25T18:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548146",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_548147.json:
```json
{
    "body": "Reviewer: Meghan Grip, Emily Rachfal, Henry Talbott",
    "created_at": "2019-07-30T13:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548147",
    "user": "https://github.com/meggrip"
}
```

Reviewer: Meghan Grip, Emily Rachfal, Henry Talbott



---

archive/issue_comments_548148.json:
```json
{
    "body": "Changing branch from \"[u/bhutz/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/28200_reduce_base_field)\" to \"[u/gh-HTalbott/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-HTalbott/28200_reduce_base_field)\"",
    "created_at": "2019-07-30T13:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548148",
    "user": "https://github.com/HTalbott"
}
```

Changing branch from "[u/bhutz/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/28200_reduce_base_field)" to "[u/gh-HTalbott/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-HTalbott/28200_reduce_base_field)"



---

archive/issue_comments_548149.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[a0e7824](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)|`28200: fixed example formatting`|",
    "created_at": "2019-07-30T13:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548149",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[a0e7824](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)|`28200: fixed example formatting`|



---

archive/issue_comments_548150.json:
```json
{
    "body": "Changing commit from \"[e9fc3faa1c8acef91cfc1d03f987352bfedab7df](https://github.com/sagemath/sagetrac-mirror/commit/e9fc3faa1c8acef91cfc1d03f987352bfedab7df)\" to \"[a0e7824d1b09faa5b59f55833b3ba51fef2d6456](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)\"",
    "created_at": "2019-07-30T13:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548150",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[e9fc3faa1c8acef91cfc1d03f987352bfedab7df](https://github.com/sagemath/sagetrac-mirror/commit/e9fc3faa1c8acef91cfc1d03f987352bfedab7df)" to "[a0e7824d1b09faa5b59f55833b3ba51fef2d6456](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)"



---

archive/issue_comments_548151.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-30T14:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548151",
    "user": "https://github.com/HTalbott"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_548152.json:
```json
{
    "body": "<a id='comment:10'></a>\nFixed small documentations errors. Everything else looks good!\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|\n|[482ed83](https://github.com/sagemath/sagetrac-mirror/commit/482ed83020356240873409cc901ca3b9dbe9f0d7)|`Merge branch 'u/bhutz/28200_reduce_base_field' of git://trac.sagemath.org/sage into test`|\n|[a0e7824](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)|`28200: fixed example formatting`|",
    "created_at": "2019-07-30T14:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548152",
    "user": "https://github.com/HTalbott"
}
```

<a id='comment:10'></a>
Fixed small documentations errors. Everything else looks good!

---
New commits:
|                                                                                                                                          |                                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
|[482ed83](https://github.com/sagemath/sagetrac-mirror/commit/482ed83020356240873409cc901ca3b9dbe9f0d7)|`Merge branch 'u/bhutz/28200_reduce_base_field' of git://trac.sagemath.org/sage into test`|
|[a0e7824](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)|`28200: fixed example formatting`|



---

archive/issue_comments_548153.json:
```json
{
    "body": "Changing branch from \"[u/gh-HTalbott/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-HTalbott/28200_reduce_base_field)\" to \"[a0e7824d1b09faa5b59f55833b3ba51fef2d6456](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)\"",
    "created_at": "2019-08-01T22:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548153",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/gh-HTalbott/28200_reduce_base_field](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-HTalbott/28200_reduce_base_field)" to "[a0e7824d1b09faa5b59f55833b3ba51fef2d6456](https://github.com/sagemath/sagetrac-mirror/commit/a0e7824d1b09faa5b59f55833b3ba51fef2d6456)"



---

archive/issue_events_079397.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-01T22:54:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28200#event-79397"
}
```



---

archive/issue_comments_548154.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-01T22:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28200",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28200#issuecomment-548154",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
