# Issue 28774: Coercion between quadratic fields fails

archive/issues_028537.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\n\n```\nsage: K.<sqrt2> = QuadraticField(2)\nsage: K.<sqrt3> = QuadraticField(3)\nsage: sqrt2 + sqrt3\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-5ef32d62030c> in <module>()\n----> 1 sqrt2 + sqrt3\n\n/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__add__ (build/cythonized/sage/structure/element.c:10816)()\n   1234         # Left and right are Sage elements => use coercion model\n   1235         if BOTH_ARE_ELEMENT(cl):\n-> 1236             return coercion_model.bin_op(left, right, add)\n   1237 \n   1238         cdef long value\n\n/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:10895)()\n   1205         # We should really include the underlying error.\n   1206         # This causes so much headache.\n-> 1207         raise bin_op_exception(op, x, y)\n   1208 \n   1209     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: 'Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?' and 'Number Field in sqrt3 with defining polynomial x^2 - 3 with sqrt3 = 1.732050807568878?'\n```\n\nThis is by design, as it is hard to guess the users intentions:\n- Exact computations should only be done in `AA` for exploratory work, as it is precise but possibly very slow. Exact conversion to `AA` works:\n\n```\nsage: K.<sqrt2> = QuadraticField(2)\nsage: AA(sqrt2)\n1.414213562373095?\nsage: AA(sqrt2) == AA(2).sqrt()\nTrue\n```\n- Otherwise, exact computations should be done in a good common number field, e.g. using `composite_fields`:\n\n```\nsage: K2.<sqrt2> = QuadraticField(2)\nsage: K3.<sqrt3> = QuadraticField(3)\nsage: K = K2.composite_fields(K3)[0]\nsage: K(sqrt2)\n-1/2*sqrt2sqrt3^3 + 9/2*sqrt2sqrt3\nsage: K(sqrt3)\n-1/2*sqrt2sqrt3^3 + 11/2*sqrt2sqrt3\nsage: K\nNumber Field in sqrt2sqrt3 with defining polynomial x^4 - 10*x^2 + 1 with sqrt2sqrt3 = 0.3178372451957823?\n```\n  However, there is a choice involved in picking the common number field, which is up to the user.\n- Also there is reliable fast but imprecise float calculations. Number fields can be coerced into the reals, but this wouldn't be a good choice for a canonical common parent of two number fields.\n\nDepends on #28778\n\nComponent: **number fields**\n\nKeywords: **quadratic field, embeddings**\n\nReviewer: **S\u00e9bastien Labb\u00e9**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28774_\n\n",
    "closed_at": "2020-10-11T16:49:10Z",
    "created_at": "2019-11-20T08:33:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20coercion",
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Coercion between quadratic fields fails",
    "type": "issue",
    "updated_at": "2020-10-11T16:49:10Z",
    "url": "https://github.com/sagemath/sage/issues/28774",
    "user": "https://github.com/kliem"
}
```
<div id="comment:0"></div>


```
sage: K.<sqrt2> = QuadraticField(2)
sage: K.<sqrt3> = QuadraticField(3)
sage: sqrt2 + sqrt3
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-5ef32d62030c> in <module>()
----> 1 sqrt2 + sqrt3

/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__add__ (build/cythonized/sage/structure/element.c:10816)()
   1234         # Left and right are Sage elements => use coercion model
   1235         if BOTH_ARE_ELEMENT(cl):
-> 1236             return coercion_model.bin_op(left, right, add)
   1237 
   1238         cdef long value

/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:10895)()
   1205         # We should really include the underlying error.
   1206         # This causes so much headache.
-> 1207         raise bin_op_exception(op, x, y)
   1208 
   1209     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: 'Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?' and 'Number Field in sqrt3 with defining polynomial x^2 - 3 with sqrt3 = 1.732050807568878?'
```

This is by design, as it is hard to guess the users intentions:
- Exact computations should only be done in `AA` for exploratory work, as it is precise but possibly very slow. Exact conversion to `AA` works:

```
sage: K.<sqrt2> = QuadraticField(2)
sage: AA(sqrt2)
1.414213562373095?
sage: AA(sqrt2) == AA(2).sqrt()
True
```
- Otherwise, exact computations should be done in a good common number field, e.g. using `composite_fields`:

```
sage: K2.<sqrt2> = QuadraticField(2)
sage: K3.<sqrt3> = QuadraticField(3)
sage: K = K2.composite_fields(K3)[0]
sage: K(sqrt2)
-1/2*sqrt2sqrt3^3 + 9/2*sqrt2sqrt3
sage: K(sqrt3)
-1/2*sqrt2sqrt3^3 + 11/2*sqrt2sqrt3
sage: K
Number Field in sqrt2sqrt3 with defining polynomial x^4 - 10*x^2 + 1 with sqrt2sqrt3 = 0.3178372451957823?
```
  However, there is a choice involved in picking the common number field, which is up to the user.
- Also there is reliable fast but imprecise float calculations. Number fields can be coerced into the reals, but this wouldn't be a good choice for a canonical common parent of two number fields.

Depends on #28778

Component: **number fields**

Keywords: **quadratic field, embeddings**

Reviewer: **Sébastien Labbé**

_Issue created by migration from https://trac.sagemath.org/ticket/28774_





---

archive/issue_events_392216.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-20T08:33:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392216"
}
```



---

archive/issue_events_392217.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-20T08:33:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "c: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392217"
}
```



---

archive/issue_events_392218.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-20T08:33:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392218"
}
```



---

archive/issue_events_392219.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-20T08:33:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392219"
}
```



---

archive/issue_events_392220.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-20T08:33:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20coercion",
    "label_color": "0000ff",
    "label_name": "c: coercion",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392220"
}
```



---

archive/issue_comments_448691.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af2d160c09ada2503ac39dca015908afa98bb7ec\"><code>af2d160</code></a></td><td><code>embed quadratic field into algebraic (real) numbers</code></td></tr></table>\n",
    "created_at": "2019-11-20T08:40:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448691",
    "user": "https://github.com/kliem"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af2d160c09ada2503ac39dca015908afa98bb7ec"><code>af2d160</code></a></td><td><code>embed quadratic field into algebraic (real) numbers</code></td></tr></table>




---

archive/issue_comments_448692.json:
```json
{
    "body": "Commit: **[`af2d160`](https://github.com/sagemath/sagetrac-mirror/commit/af2d160c09ada2503ac39dca015908afa98bb7ec)**",
    "created_at": "2019-11-20T08:40:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448692",
    "user": "https://github.com/kliem"
}
```

Commit: **[`af2d160`](https://github.com/sagemath/sagetrac-mirror/commit/af2d160c09ada2503ac39dca015908afa98bb7ec)**



---

archive/issue_comments_448693.json:
```json
{
    "body": "Branch: **[public/28774](https://github.com/sagemath/sagetrac-mirror/tree/public/28774)**",
    "created_at": "2019-11-20T08:40:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448693",
    "user": "https://github.com/kliem"
}
```

Branch: **[public/28774](https://github.com/sagemath/sagetrac-mirror/tree/public/28774)**



---

archive/issue_events_392221.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-20T08:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392221"
}
```



---

archive/issue_events_392222.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-23T14:32:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392222"
}
```



---

archive/issue_events_392223.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-23T14:32:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392223"
}
```



---

archive/issue_comments_448694.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nMany failing tests and various places.",
    "created_at": "2019-11-23T14:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448694",
    "user": "https://github.com/kliem"
}
```

<div id="comment:3" align="right">comment:3</div>

Many failing tests and various places.



---

archive/issue_comments_448695.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d20ed43b6ca85a79c32232e19c6b9427dcb4987c\"><code>d20ed43</code></a></td><td><code>fixed some failing tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4a7348c66cf5838878641729ce3f768f1a47282\"><code>a4a7348</code></a></td><td><code>fixing some tests</code></td></tr></table>\n",
    "created_at": "2019-11-25T08:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448695",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d20ed43b6ca85a79c32232e19c6b9427dcb4987c"><code>d20ed43</code></a></td><td><code>fixed some failing tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4a7348c66cf5838878641729ce3f768f1a47282"><code>a4a7348</code></a></td><td><code>fixing some tests</code></td></tr></table>




---

archive/issue_comments_448696.json:
```json
{
    "body": "Changed commit from **[`af2d160`](https://github.com/sagemath/sagetrac-mirror/commit/af2d160c09ada2503ac39dca015908afa98bb7ec)** to **[`a4a7348`](https://github.com/sagemath/sagetrac-mirror/commit/a4a7348c66cf5838878641729ce3f768f1a47282)**",
    "created_at": "2019-11-25T08:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448696",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`af2d160`](https://github.com/sagemath/sagetrac-mirror/commit/af2d160c09ada2503ac39dca015908afa98bb7ec)** to **[`a4a7348`](https://github.com/sagemath/sagetrac-mirror/commit/a4a7348c66cf5838878641729ce3f768f1a47282)**



---

archive/issue_events_392224.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-25T09:05:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392224"
}
```



---

archive/issue_events_392225.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-25T09:05:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392225"
}
```



---

archive/issue_comments_448697.json:
```json
{
    "body": "Changed author from **Jonathan Kliem** to none",
    "created_at": "2019-11-25T09:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448697",
    "user": "https://github.com/kliem"
}
```

Changed author from **Jonathan Kliem** to none



---

archive/issue_comments_448698.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,15 +1,41 @@\n-Currently, quadratic fields are embedded into the reals or complex numbers by default.\n-\n-Number fields in turn, allow pushouts only, when fields are embedded into `AA`. Therefore, the following results in a `TypeError`:\n \n ```\n-sage: f1 = QuadraticField(2)\n-sage: f2 = QuadraticField(3)\n-sage: f1.gen() + f2.gen()\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: K.<sqrt3> = QuadraticField(3)\n+sage: sqrt2 + sqrt3\n+---------------------------------------------------------------------------\n+TypeError                                 Traceback (most recent call last)\n+<ipython-input-4-5ef32d62030c> in <module>()\n+----> 1 sqrt2 + sqrt3\n+\n+/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__add__ (build/cythonized/sage/structure/element.c:10816)()\n+   1234         # Left and right are Sage elements => use coercion model\n+   1235         if BOTH_ARE_ELEMENT(cl):\n+-> 1236             return coercion_model.bin_op(left, right, add)\n+   1237 \n+   1238         cdef long value\n+\n+/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:10895)()\n+   1205         # We should really include the underlying error.\n+   1206         # This causes so much headache.\n+-> 1207         raise bin_op_exception(op, x, y)\n+   1208 \n+   1209     cpdef canonical_coercion(self, x, y):\n+\n+TypeError: unsupported operand parent(s) for +: 'Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?' and 'Number Field in sqrt3 with defining polynomial x^2 - 3 with sqrt3 = 1.732050807568878?'\n ```\n \n-We embed the `QuadraticField` into `AA` or `QQbar` by default and therefore fix this for the real algebraic case.\n+This can be fixed by hand, when embedding both fields into `AA` (instead of default `RLF`):\n \n-Possible follow ups:\n-- It still does not work in the non-real case, but this should be taken care of in `NumberField` instead.\n-- Also, one could argue, whether the coercion should really go all the way to `AA`, but this is also not an issue of `QuadraticField`.\n+```\n+sage: K.<sqrt2> = QuadraticField(2, embedding=AA(2).sqrt())\n+sage: K.<sqrt3> = QuadraticField(3, embedding=AA(3).sqrt())\n+sage: sqrt2 + sqrt3\n+3.146264369941973?\n+```\n+\n+So I think, quadratic fields should by default be embedded into `AA`/`QQbar`. However, this causes a lot of tests to fail mainly for two reasons:\n+- numerical approximation for `AA` works differently than in `RLF`,\n+- coercion of cyclotomic fields and quadratic fields seems to rely on a common embedding (either one has to embed cyclotomic fields into `QQbar` by default or one needs to manually fix the coercion)\n+\n+There is a branch attached with several failing tests, mostly because of the above two issues.\n``````\n",
    "created_at": "2019-11-25T09:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448698",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,15 +1,41 @@
-Currently, quadratic fields are embedded into the reals or complex numbers by default.
-
-Number fields in turn, allow pushouts only, when fields are embedded into `AA`. Therefore, the following results in a `TypeError`:
 
 ```
-sage: f1 = QuadraticField(2)
-sage: f2 = QuadraticField(3)
-sage: f1.gen() + f2.gen()
+sage: K.<sqrt2> = QuadraticField(2)
+sage: K.<sqrt3> = QuadraticField(3)
+sage: sqrt2 + sqrt3
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
+<ipython-input-4-5ef32d62030c> in <module>()
+----> 1 sqrt2 + sqrt3
+
+/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__add__ (build/cythonized/sage/structure/element.c:10816)()
+   1234         # Left and right are Sage elements => use coercion model
+   1235         if BOTH_ARE_ELEMENT(cl):
+-> 1236             return coercion_model.bin_op(left, right, add)
+   1237 
+   1238         cdef long value
+
+/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:10895)()
+   1205         # We should really include the underlying error.
+   1206         # This causes so much headache.
+-> 1207         raise bin_op_exception(op, x, y)
+   1208 
+   1209     cpdef canonical_coercion(self, x, y):
+
+TypeError: unsupported operand parent(s) for +: 'Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?' and 'Number Field in sqrt3 with defining polynomial x^2 - 3 with sqrt3 = 1.732050807568878?'
 ```
 
-We embed the `QuadraticField` into `AA` or `QQbar` by default and therefore fix this for the real algebraic case.
+This can be fixed by hand, when embedding both fields into `AA` (instead of default `RLF`):
 
-Possible follow ups:
-- It still does not work in the non-real case, but this should be taken care of in `NumberField` instead.
-- Also, one could argue, whether the coercion should really go all the way to `AA`, but this is also not an issue of `QuadraticField`.
+```
+sage: K.<sqrt2> = QuadraticField(2, embedding=AA(2).sqrt())
+sage: K.<sqrt3> = QuadraticField(3, embedding=AA(3).sqrt())
+sage: sqrt2 + sqrt3
+3.146264369941973?
+```
+
+So I think, quadratic fields should by default be embedded into `AA`/`QQbar`. However, this causes a lot of tests to fail mainly for two reasons:
+- numerical approximation for `AA` works differently than in `RLF`,
+- coercion of cyclotomic fields and quadratic fields seems to rely on a common embedding (either one has to embed cyclotomic fields into `QQbar` by default or one needs to manually fix the coercion)
+
+There is a branch attached with several failing tests, mostly because of the above two issues.
``````




---

archive/issue_events_392226.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-25T09:05:01Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "title_is": "Coercion between quadratic fields fails",
    "title_was": "Embed QuadraticField into algebraic numbers by default",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392226"
}
```



---

archive/issue_events_392227.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-25T09:05:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392227"
}
```



---

archive/issue_events_392228.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-11-25T09:05:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392228"
}
```



---

archive/issue_comments_448699.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThis seems like it would be a good idea to post to sage-devel if only just to understand the rationale of the current state.",
    "created_at": "2019-11-29T00:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448699",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

This seems like it would be a good idea to post to sage-devel if only just to understand the rationale of the current state.



---

archive/issue_events_392229.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-05T14:30:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392229"
}
```



---

archive/issue_events_392230.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-05T14:30:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392230"
}
```



---

archive/issue_events_392231.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-05T14:30:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392231"
}
```



---

archive/issue_comments_448700.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,17 +25,28 @@\n TypeError: unsupported operand parent(s) for +: 'Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?' and 'Number Field in sqrt3 with defining polynomial x^2 - 3 with sqrt3 = 1.732050807568878?'\n ```\n \n-This can be fixed by hand, when embedding both fields into `AA` (instead of default `RLF`):\n+This is by design, as it is hard to guess the users intentions:\n+- Exact computations should only be done in `AA` for exploratory work, as it is precise but possibly very slow. Exact conversion to `AA` works:\n \n ```\n-sage: K.<sqrt2> = QuadraticField(2, embedding=AA(2).sqrt())\n-sage: K.<sqrt3> = QuadraticField(3, embedding=AA(3).sqrt())\n-sage: sqrt2 + sqrt3\n-3.146264369941973?\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: AA(sqrt2)\n+1.414213562373095?\n+sage: AA(sqrt2) == AA(2).sqrt()\n+True\n ```\n+- Otherwise, exact computations should be done in a good common number field, e.g. using `composite_fields`:\n \n-So I think, quadratic fields should by default be embedded into `AA`/`QQbar`. However, this causes a lot of tests to fail mainly for two reasons:\n-- numerical approximation for `AA` works differently than in `RLF`,\n-- coercion of cyclotomic fields and quadratic fields seems to rely on a common embedding (either one has to embed cyclotomic fields into `QQbar` by default or one needs to manually fix the coercion)\n-\n-There is a branch attached with several failing tests, mostly because of the above two issues.\n+```\n+sage: K2.<sqrt2> = QuadraticField(2)\n+sage: K3.<sqrt3> = QuadraticField(3)\n+sage: K = K2.composite_fields(K3)[0]\n+sage: K(sqrt2)\n+-1/2*sqrt2sqrt3^3 + 9/2*sqrt2sqrt3\n+sage: K(sqrt3)\n+-1/2*sqrt2sqrt3^3 + 11/2*sqrt2sqrt3\n+sage: K\n+Number Field in sqrt2sqrt3 with defining polynomial x^4 - 10*x^2 + 1 with sqrt2sqrt3 = 0.3178372451957823?\n+```\n+  However, there is a choice involved in picking the common number field, which is up to the user.\n+- Also there is reliable fast but imprecise float calculations. Number fields can be coerced into the reals, but this wouldn't be a good choice for a canonical common parent of two number fields.\n``````\n",
    "created_at": "2019-12-05T14:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448700",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,17 +25,28 @@
 TypeError: unsupported operand parent(s) for +: 'Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?' and 'Number Field in sqrt3 with defining polynomial x^2 - 3 with sqrt3 = 1.732050807568878?'
 ```
 
-This can be fixed by hand, when embedding both fields into `AA` (instead of default `RLF`):
+This is by design, as it is hard to guess the users intentions:
+- Exact computations should only be done in `AA` for exploratory work, as it is precise but possibly very slow. Exact conversion to `AA` works:
 
 ```
-sage: K.<sqrt2> = QuadraticField(2, embedding=AA(2).sqrt())
-sage: K.<sqrt3> = QuadraticField(3, embedding=AA(3).sqrt())
-sage: sqrt2 + sqrt3
-3.146264369941973?
+sage: K.<sqrt2> = QuadraticField(2)
+sage: AA(sqrt2)
+1.414213562373095?
+sage: AA(sqrt2) == AA(2).sqrt()
+True
 ```
+- Otherwise, exact computations should be done in a good common number field, e.g. using `composite_fields`:
 
-So I think, quadratic fields should by default be embedded into `AA`/`QQbar`. However, this causes a lot of tests to fail mainly for two reasons:
-- numerical approximation for `AA` works differently than in `RLF`,
-- coercion of cyclotomic fields and quadratic fields seems to rely on a common embedding (either one has to embed cyclotomic fields into `QQbar` by default or one needs to manually fix the coercion)
-
-There is a branch attached with several failing tests, mostly because of the above two issues.
+```
+sage: K2.<sqrt2> = QuadraticField(2)
+sage: K3.<sqrt3> = QuadraticField(3)
+sage: K = K2.composite_fields(K3)[0]
+sage: K(sqrt2)
+-1/2*sqrt2sqrt3^3 + 9/2*sqrt2sqrt3
+sage: K(sqrt3)
+-1/2*sqrt2sqrt3^3 + 11/2*sqrt2sqrt3
+sage: K
+Number Field in sqrt2sqrt3 with defining polynomial x^4 - 10*x^2 + 1 with sqrt2sqrt3 = 0.3178372451957823?
+```
+  However, there is a choice involved in picking the common number field, which is up to the user.
+- Also there is reliable fast but imprecise float calculations. Number fields can be coerced into the reals, but this wouldn't be a good choice for a canonical common parent of two number fields.
``````




---

archive/issue_comments_448701.json:
```json
{
    "body": "Changed branch from **[public/28774](https://github.com/sagemath/sagetrac-mirror/tree/public/28774)** to none",
    "created_at": "2019-12-05T14:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448701",
    "user": "https://github.com/kliem"
}
```

Changed branch from **[public/28774](https://github.com/sagemath/sagetrac-mirror/tree/public/28774)** to none



---

archive/issue_comments_448702.json:
```json
{
    "body": "Changed commit from **[`a4a7348`](https://github.com/sagemath/sagetrac-mirror/commit/a4a7348c66cf5838878641729ce3f768f1a47282)** to none",
    "created_at": "2019-12-05T14:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448702",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[`a4a7348`](https://github.com/sagemath/sagetrac-mirror/commit/a4a7348c66cf5838878641729ce3f768f1a47282)** to none



---

archive/issue_comments_448703.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nPerhaps a more useful error message could be given here?  The hint about using composite fields seems especially helpful.",
    "created_at": "2019-12-06T13:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448703",
    "user": "https://github.com/embray"
}
```

<div id="comment:8" align="right">comment:8</div>

Perhaps a more useful error message could be given here?  The hint about using composite fields seems especially helpful.



---

archive/issue_comments_448704.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYes, I was thinking about this as well. Wasn't sure where to put this.\n\nI could give such a message in the `_pushout_` method of number fields. This method will be called for sure and I think its also the last hope for coercion to work in case of number fields.",
    "created_at": "2019-12-06T13:45:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448704",
    "user": "https://github.com/kliem"
}
```

<div id="comment:9" align="right">comment:9</div>

Yes, I was thinking about this as well. Wasn't sure where to put this.

I could give such a message in the `_pushout_` method of number fields. This method will be called for sure and I think its also the last hope for coercion to work in case of number fields.



---

archive/issue_events_392232.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-06T14:24:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392232"
}
```



---

archive/issue_events_392233.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-06T14:24:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392233"
}
```



---

archive/issue_comments_448705.json:
```json
{
    "body": "Dependencies: **#28778**",
    "created_at": "2019-12-06T20:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448705",
    "user": "https://github.com/kliem"
}
```

Dependencies: **#28778**



---

archive/issue_events_392234.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-06T20:35:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392234"
}
```



---

archive/issue_events_392235.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-06T20:35:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392235"
}
```



---

archive/issue_comments_448706.json:
```json
{
    "body": "Branch: **[public/28774-new](https://github.com/sagemath/sagetrac-mirror/tree/public/28774-new)**",
    "created_at": "2019-12-06T20:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448706",
    "user": "https://github.com/kliem"
}
```

Branch: **[public/28774-new](https://github.com/sagemath/sagetrac-mirror/tree/public/28774-new)**



---

archive/issue_events_392236.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-06T20:35:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392236"
}
```



---

archive/issue_comments_448707.json:
```json
{
    "body": "Commit: **[`ad8d632`](https://github.com/sagemath/sagetrac-mirror/commit/ad8d63235dc488da8a0a38e55e07ce434f763734)**",
    "created_at": "2019-12-06T20:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448707",
    "user": "https://github.com/kliem"
}
```

Commit: **[`ad8d632`](https://github.com/sagemath/sagetrac-mirror/commit/ad8d63235dc488da8a0a38e55e07ce434f763734)**



---

archive/issue_comments_448708.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThis is the best I can come up with.\n\nTo my understanding coercion of two number fields is only possible, if they are both embedded into `AA` (or `QQbar` with #28778) or if there is an embedding (discovered by `_internal_coerce_map_from`).\n\nRaising an error or a warning does not work, as it is being suppressed.\n\nThis depends on #28778 now, as this fixes an error (along the way), where the pushout of two number fields embedded into `RLF` is `AA`. This ticket relies on the method `_pushout_` to return `None` in this case.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4b2cf10f5e5ad6b88825ad7ab7ba82a3400a854\"><code>b4b2cf1</code></a></td><td><code>pushout for number fields with compatible embeddings</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d46d6bbbe80fdbf6bd367e2f0793b9482f644bd4\"><code>d46d6bb</code></a></td><td><code>remove unneeded test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a1bce35034c4292eee9ecb8a56a19ce8bc75f94\"><code>9a1bce3</code></a></td><td><code>small mistake in docstests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e7025115e4d2d203d67779d559ad3072c06073d\"><code>8e70251</code></a></td><td><code>defining the pushout for number fields just for AA and QQbar</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d1fc2dcf4ee746f385a20231478b6c9a71068fd\"><code>0d1fc2d</code></a></td><td><code>Merge branch 'public/28778-bis' of git://trac.sagemath.org/sage into public/28774-new</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad8d63235dc488da8a0a38e55e07ce434f763734\"><code>ad8d632</code></a></td><td><code>printed a message pointing towards composite fields</code></td></tr></table>\n",
    "created_at": "2019-12-06T20:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448708",
    "user": "https://github.com/kliem"
}
```

<div id="comment:11" align="right">comment:11</div>

This is the best I can come up with.

To my understanding coercion of two number fields is only possible, if they are both embedded into `AA` (or `QQbar` with #28778) or if there is an embedding (discovered by `_internal_coerce_map_from`).

Raising an error or a warning does not work, as it is being suppressed.

This depends on #28778 now, as this fixes an error (along the way), where the pushout of two number fields embedded into `RLF` is `AA`. This ticket relies on the method `_pushout_` to return `None` in this case.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4b2cf10f5e5ad6b88825ad7ab7ba82a3400a854"><code>b4b2cf1</code></a></td><td><code>pushout for number fields with compatible embeddings</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d46d6bbbe80fdbf6bd367e2f0793b9482f644bd4"><code>d46d6bb</code></a></td><td><code>remove unneeded test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a1bce35034c4292eee9ecb8a56a19ce8bc75f94"><code>9a1bce3</code></a></td><td><code>small mistake in docstests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e7025115e4d2d203d67779d559ad3072c06073d"><code>8e70251</code></a></td><td><code>defining the pushout for number fields just for AA and QQbar</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d1fc2dcf4ee746f385a20231478b6c9a71068fd"><code>0d1fc2d</code></a></td><td><code>Merge branch 'public/28778-bis' of git://trac.sagemath.org/sage into public/28774-new</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad8d63235dc488da8a0a38e55e07ce434f763734"><code>ad8d632</code></a></td><td><code>printed a message pointing towards composite fields</code></td></tr></table>




---

archive/issue_events_392237.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392237"
}
```



---

archive/issue_events_392238.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392238"
}
```



---

archive/issue_comments_448709.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448709",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

Ticket retargeted after milestone closed



---

archive/issue_events_392239.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-16T23:21:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392239"
}
```



---

archive/issue_events_392240.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-16T23:21:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392240"
}
```



---

archive/issue_comments_448710.json:
```json
{
    "body": "Author: **Jonathan Kliem**",
    "created_at": "2020-06-14T20:33:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448710",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Jonathan Kliem**



---

archive/issue_comments_448711.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nPatchbot says:\n\n```\n----------------------------------------------------------------------\nsage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/ell_number_field.py  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/gal_reps_number_field.py  # 4 doctests failed\nsage -t --long --random-seed=0 src/sage/categories/pushout.py  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/libs/flint/nmod_poly_linkage.pxi  # Timed out (and interrupt failed)\n----------------------------------------------------------------------\n```\nin particular:\n\n```\nsage -t --long --random-seed=0 src/sage/categories/pushout.py\n**********************************************************************\nFile \"src/sage/categories/pushout.py\", line 3164, in sage.categories.pushout.AlgebraicExtensionFunctor.merge\nFailed example:\n    c1+c2; parent(c1+c2)    #indirect doctest\nExpected:\n    -b^6 + b^4 - 1\n    Number Field in b with defining polynomial x^8 - x^4 + 1 with b = -0.2588190451025208? + 0.9659258262890683?*I\nGot:\n    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields\n    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields\n    -b^6 + b^4 - 1\n    Number Field in b with defining polynomial x^8 - x^4 + 1 with b = -0.2588190451025208? + 0.9659258262890683?*I\n**********************************************************************\n1 item had failures:\n   1 of  24 in sage.categories.pushout.AlgebraicExtensionFunctor.merge\n    [876 tests, 1 failure, 12.84 s]\n```\nand\n\n```\nsage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/ell_number_field.py\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/ell_number_field.py\", line 3303, in sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.?\nFailed example:\n    rho.reducible_primes()\nExpected:\n    [2, 3]\nGot:\n    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields\n    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields\n    [2, 3]\n**********************************************************************\n1 item had failures:\n   1 of  84 in sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.?\n    [814 tests, 1 failure, 176.43 s]\n```\nand the patchbot also says pyflakes warnings:\n\n```\n========== pyflakes ==========\ngit checkout patchbot/ticket_merged\nAlready on 'patchbot/ticket_merged'\nsrc/sage/rings/number_field/number_field.py:9708:42 '...' % ... has 1 placeholder(s) but 2 substitution(s)\n\nfound 1 pyflakes errors in the modified files\nTraceback (most recent call last):\n  File \"/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/patchbot.py\", line 1109, in test_a_ticket\n    baseline=baseline, **kwds)\n  File \"/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/plugins.py\", line 281, in pyflakes\n    raise ValueError(full_msg)\nValueError: found 1 pyflakes errors in the modified files\npyflakes -- 0 seconds\n========== end pyflakes ==========\n```\nand `pycodestyle` warnings:\n\n```\n========== pycodestyle ==========\ngit checkout patchbot/ticket_merged\nAlready on 'patchbot/ticket_merged'\nsrc/sage/rings/number_field/number_field.py:5038:34: E702 multiple statements on one line (semicolon)\nsrc/sage/rings/number_field/number_field.py:5061:25: E702 multiple statements on one line (semicolon)\nsrc/sage/rings/number_field/number_field.py:5062:25: E702 multiple statements on one line (semicolon)\nfound 3 invalid escape sequences in the modified files\nTraceback (most recent call last):\n  File \"/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/patchbot.py\", line 1109, in test_a_ticket\n    baseline=baseline, **kwds)\n  File \"/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/plugins.py\", line 344, in pycodestyle\n    raise ValueError(full_msg)\nValueError: found 3 invalid escape sequences in the modified files\npycodestyle -- 0 seconds\n========== end pycodestyle ==========\n```",
    "created_at": "2020-08-15T14:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448711",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:15" align="right">comment:15</div>

Patchbot says:

```
----------------------------------------------------------------------
sage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/ell_number_field.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/gal_reps_number_field.py  # 4 doctests failed
sage -t --long --random-seed=0 src/sage/categories/pushout.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/libs/flint/nmod_poly_linkage.pxi  # Timed out (and interrupt failed)
----------------------------------------------------------------------
```
in particular:

```
sage -t --long --random-seed=0 src/sage/categories/pushout.py
**********************************************************************
File "src/sage/categories/pushout.py", line 3164, in sage.categories.pushout.AlgebraicExtensionFunctor.merge
Failed example:
    c1+c2; parent(c1+c2)    #indirect doctest
Expected:
    -b^6 + b^4 - 1
    Number Field in b with defining polynomial x^8 - x^4 + 1 with b = -0.2588190451025208? + 0.9659258262890683?*I
Got:
    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields
    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields
    -b^6 + b^4 - 1
    Number Field in b with defining polynomial x^8 - x^4 + 1 with b = -0.2588190451025208? + 0.9659258262890683?*I
**********************************************************************
1 item had failures:
   1 of  24 in sage.categories.pushout.AlgebraicExtensionFunctor.merge
    [876 tests, 1 failure, 12.84 s]
```
and

```
sage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/ell_number_field.py
**********************************************************************
File "src/sage/schemes/elliptic_curves/ell_number_field.py", line 3303, in sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.?
Failed example:
    rho.reducible_primes()
Expected:
    [2, 3]
Got:
    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields
    common parent not found; the method ``composite_fields`` might be useful to find a common parent for number fields
    [2, 3]
**********************************************************************
1 item had failures:
   1 of  84 in sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.?
    [814 tests, 1 failure, 176.43 s]
```
and the patchbot also says pyflakes warnings:

```
========== pyflakes ==========
git checkout patchbot/ticket_merged
Already on 'patchbot/ticket_merged'
src/sage/rings/number_field/number_field.py:9708:42 '...' % ... has 1 placeholder(s) but 2 substitution(s)

found 1 pyflakes errors in the modified files
Traceback (most recent call last):
  File "/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/patchbot.py", line 1109, in test_a_ticket
    baseline=baseline, **kwds)
  File "/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/plugins.py", line 281, in pyflakes
    raise ValueError(full_msg)
ValueError: found 1 pyflakes errors in the modified files
pyflakes -- 0 seconds
========== end pyflakes ==========
```
and `pycodestyle` warnings:

```
========== pycodestyle ==========
git checkout patchbot/ticket_merged
Already on 'patchbot/ticket_merged'
src/sage/rings/number_field/number_field.py:5038:34: E702 multiple statements on one line (semicolon)
src/sage/rings/number_field/number_field.py:5061:25: E702 multiple statements on one line (semicolon)
src/sage/rings/number_field/number_field.py:5062:25: E702 multiple statements on one line (semicolon)
found 3 invalid escape sequences in the modified files
Traceback (most recent call last):
  File "/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/patchbot.py", line 1109, in test_a_ticket
    baseline=baseline, **kwds)
  File "/home/sagemath/.local/lib/python3.7/site-packages/sage_patchbot/plugins.py", line 344, in pycodestyle
    raise ValueError(full_msg)
ValueError: found 3 invalid escape sequences in the modified files
pycodestyle -- 0 seconds
========== end pycodestyle ==========
```



---

archive/issue_events_392241.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-08-15T14:46:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392241"
}
```



---

archive/issue_events_392242.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-08-15T14:46:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392242"
}
```



---

archive/issue_comments_448712.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI posted about this on sage-devel https://groups.google.com/d/msg/sage-devel/oSFceE75pWU/K-akRxS6BAAJ.\n\nAt the moment it looks like there isn't much interest. I'll wait a day and if nothing shows up, we can just close this here as invalid.",
    "created_at": "2020-08-16T05:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448712",
    "user": "https://github.com/kliem"
}
```

<div id="comment:16" align="right">comment:16</div>

I posted about this on sage-devel https://groups.google.com/d/msg/sage-devel/oSFceE75pWU/K-akRxS6BAAJ.

At the moment it looks like there isn't much interest. I'll wait a day and if nothing shows up, we can just close this here as invalid.



---

archive/issue_events_392243.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-08-17T05:24:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392243"
}
```



---

archive/issue_comments_448713.json:
```json
{
    "body": "Changed author from **Jonathan Kliem** to none",
    "created_at": "2020-08-17T05:24:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448713",
    "user": "https://github.com/kliem"
}
```

Changed author from **Jonathan Kliem** to none



---

archive/issue_comments_448714.json:
```json
{
    "body": "Changed commit from **[`ad8d632`](https://github.com/sagemath/sagetrac-mirror/commit/ad8d63235dc488da8a0a38e55e07ce434f763734)** to none",
    "created_at": "2020-08-17T05:24:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448714",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[`ad8d632`](https://github.com/sagemath/sagetrac-mirror/commit/ad8d63235dc488da8a0a38e55e07ce434f763734)** to none



---

archive/issue_events_392244.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-08-17T05:24:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392244"
}
```



---

archive/issue_events_392245.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-08-17T05:24:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392245"
}
```



---

archive/issue_comments_448715.json:
```json
{
    "body": "Changed branch from **[public/28774-new](https://github.com/sagemath/sagetrac-mirror/tree/public/28774-new)** to none",
    "created_at": "2020-08-17T05:24:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448715",
    "user": "https://github.com/kliem"
}
```

Changed branch from **[public/28774-new](https://github.com/sagemath/sagetrac-mirror/tree/public/28774-new)** to none



---

archive/issue_events_392246.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-08-18T12:36:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392246"
}
```



---

archive/issue_events_392247.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-08-18T12:36:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392247"
}
```



---

archive/issue_comments_448716.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nok",
    "created_at": "2020-08-18T12:36:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448716",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:18" align="right">comment:18</div>

ok



---

archive/issue_comments_448717.json:
```json
{
    "body": "Reviewer: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2020-08-19T20:33:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28774#issuecomment-448717",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Sébastien Labbé**



---

archive/issue_events_392248.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-10-11T16:49:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392248"
}
```



---

archive/issue_events_392249.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-10-11T16:49:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28774",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28774#event-392249"
}
```
