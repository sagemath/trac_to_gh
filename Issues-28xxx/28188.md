# Issue 28188: MeatAxe arithmetic tables

archive/issues_027951.json:
```json
{
    "assignees": [],
    "body": "Currently, the finite fields arithmetic tables for Meataxe are generated on the fly and stored in `$HOME/.sage/`.\n\nIt was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.\n\nThis ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork, but in fact the solution proposed in this ticket doesn't change the upstream tarball.\n\nNamely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk **once**, rather than up to 9Mb per user.\n\nUpstream: **None of the above - read trac for reasoning.**\n\nCC:  @antonio-rojas @williamstein @haraldschilly @DrXyzzy\n\nComponent: **packages: optional**\n\nKeywords: **meataxe days100**\n\nAuthor: **Simon King**\n\nBranch/Commit: **[`46ee8be`](https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67)**\n\nReviewer: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28188_\n\n",
    "closed_at": "2019-07-29T21:54:54Z",
    "created_at": "2019-07-13T13:15:20Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "MeatAxe arithmetic tables",
    "type": "issue",
    "updated_at": "2019-08-03T13:33:35Z",
    "url": "https://github.com/sagemath/sage/issues/28188",
    "user": "https://github.com/simon-king-jena"
}
```
Currently, the finite fields arithmetic tables for Meataxe are generated on the fly and stored in `$HOME/.sage/`.

It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.

This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork, but in fact the solution proposed in this ticket doesn't change the upstream tarball.

Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk **once**, rather than up to 9Mb per user.

Upstream: **None of the above - read trac for reasoning.**

CC:  @antonio-rojas @williamstein @haraldschilly @DrXyzzy

Component: **packages: optional**

Keywords: **meataxe days100**

Author: **Simon King**

Branch/Commit: **[`46ee8be`](https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67)**

Reviewer: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/28188_





---

archive/issue_events_383646.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-13T13:15:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383646"
}
```



---

archive/issue_events_383647.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-13T13:15:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383647"
}
```



---

archive/issue_events_383648.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-13T13:15:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383648"
}
```



---

archive/issue_events_383649.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-13T13:15:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383649"
}
```



---

archive/issue_comments_438755.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nIn the original report, the problem was on CoCalC. From the description, it didn't become clear to me if the users do not have write permission on `DOT_SAGE` (which would explain the problem) or if `DOT_SAGE` is a symbolic link (which perhaps can be troublesome, too).\n\nCurrently, the arithmetic tables of (Shared)MeatAxe are sought in `$DOT_SAGE/meataxe`, and are created there when they aren't present. I see the following potential solutions:\n1. Instead of using `DOT_SAGE`, use `SAGE_EXT`: The user may not have write permissions, but since MeatAxe can only deal with field sizes less than 255, it would be easy to just create *all* arithmetic tables during package installation (hence, in a situation where write permission is granted and from where all users can read).\n2. It is a design choice of upstream MeatAxe to use arithmetic tables on disk, and load them when the current field is changed. But in our fork SharedMeatAxe, we could of course differ. Hence, whenever the current field is changed, we could compute the arithmetic table on the spot. Of course, when during a session different fields are used, it would avoid some overhead to keep all arithmetic tables in memory, and reuse them.\n3. In case that symbolic links are to blame (I don't know if they are), just address that problem, but keep the design as it is.",
    "created_at": "2019-07-13T13:27:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438755",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:1" align="right">comment:1</div>

In the original report, the problem was on CoCalC. From the description, it didn't become clear to me if the users do not have write permission on `DOT_SAGE` (which would explain the problem) or if `DOT_SAGE` is a symbolic link (which perhaps can be troublesome, too).

Currently, the arithmetic tables of (Shared)MeatAxe are sought in `$DOT_SAGE/meataxe`, and are created there when they aren't present. I see the following potential solutions:
1. Instead of using `DOT_SAGE`, use `SAGE_EXT`: The user may not have write permissions, but since MeatAxe can only deal with field sizes less than 255, it would be easy to just create *all* arithmetic tables during package installation (hence, in a situation where write permission is granted and from where all users can read).
2. It is a design choice of upstream MeatAxe to use arithmetic tables on disk, and load them when the current field is changed. But in our fork SharedMeatAxe, we could of course differ. Hence, whenever the current field is changed, we could compute the arithmetic table on the spot. Of course, when during a session different fields are used, it would avoid some overhead to keep all arithmetic tables in memory, and reuse them.
3. In case that symbolic links are to blame (I don't know if they are), just address that problem, but keep the design as it is.



---

archive/issue_comments_438756.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI'd say that the communication with meataxe library can be done via sscanf/sprintf functions\nrather than fscanf/fprintf, then nothing gets written to/read from the disk, problem solved via a relatively small change of the code.",
    "created_at": "2019-07-13T14:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438756",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

I'd say that the communication with meataxe library can be done via sscanf/sprintf functions
rather than fscanf/fprintf, then nothing gets written to/read from the disk, problem solved via a relatively small change of the code.



---

archive/issue_comments_438757.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@dimpase](#comment%3A2):\n> I'd say that the commincation with meataxe library can be done via sscanf/sprintf functions\n> rather than fscanf/fprintf, then nothing gets written to/read from the disk, problem solved via a relatively small change of the code.\n\nThe routine writing/reading the table doesn't invoke fscanf/fprintf, if I understand correctly (at least not directly). It uses fread/fwrite.\n\nIn any case, I think the first question to be addressed is whether we do want to keep the tables in memory (and potentially lose time for table creation), or want them permanently stored in a file (and potentially lose time because of a slow disk, and have the trouble with write permission).",
    "created_at": "2019-07-13T14:19:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438757",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@dimpase](#comment%3A2):
> I'd say that the commincation with meataxe library can be done via sscanf/sprintf functions
> rather than fscanf/fprintf, then nothing gets written to/read from the disk, problem solved via a relatively small change of the code.

The routine writing/reading the table doesn't invoke fscanf/fprintf, if I understand correctly (at least not directly). It uses fread/fwrite.

In any case, I think the first question to be addressed is whether we do want to keep the tables in memory (and potentially lose time for table creation), or want them permanently stored in a file (and potentially lose time because of a slow disk, and have the trouble with write permission).



---

archive/issue_comments_438758.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis could also help with the troubles with the data dir creation. Currently, meataxe crashes if MTXLIB(=~/.sage/meataxe) doesn't exist. This doesn't affect sage-the-distro, since the dir is created in meataxe's spkg-install. It does affect distros though, where the package manager is not allowed to touch /home. My current workaround is to create the dir in sage-env, but it would be nice if meataxe itself took care of this.",
    "created_at": "2019-07-13T14:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438758",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:4" align="right">comment:4</div>

This could also help with the troubles with the data dir creation. Currently, meataxe crashes if MTXLIB(=~/.sage/meataxe) doesn't exist. This doesn't affect sage-the-distro, since the dir is created in meataxe's spkg-install. It does affect distros though, where the package manager is not allowed to touch /home. My current workaround is to create the dir in sage-env, but it would be nice if meataxe itself took care of this.



---

archive/issue_comments_438759.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIf it's fread/fwrite, why can't one just copy the data directly (with memcpy() or whatever)?\n(If one actually does need to copy them, rather than just to access them directly)",
    "created_at": "2019-07-13T15:09:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438759",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

If it's fread/fwrite, why can't one just copy the data directly (with memcpy() or whatever)?
(If one actually does need to copy them, rather than just to access them directly)



---

archive/issue_comments_438760.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIt looks weird to me to have these files generated along the way. If generating the tables is time consuming (is it?) then the data would better be shipped with the MeatAxe library itself (in some convenient binary format). The data should not take a lot of memory\n\n```\nsage: sum(i*i for i in range(256) if is_prime_power(i) and not is_prime(i)) / 10.**3\n150.113000000000\n```\n(the above are supposed to be Ko)",
    "created_at": "2019-07-13T18:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438760",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

It looks weird to me to have these files generated along the way. If generating the tables is time consuming (is it?) then the data would better be shipped with the MeatAxe library itself (in some convenient binary format). The data should not take a lot of memory

```
sage: sum(i*i for i in range(256) if is_prime_power(i) and not is_prime(i)) / 10.**3
150.113000000000
```
(the above are supposed to be Ko)



---

archive/issue_comments_438761.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nthese files may be generated during the installation of meataxe, as well.",
    "created_at": "2019-07-13T18:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438761",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

these files may be generated during the installation of meataxe, as well.



---

archive/issue_comments_438762.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBTW, have you tried using LinBox? givaro is supposed to support finite fields and the linear algebra in linbox is highly optimized (when it works :-).",
    "created_at": "2019-07-13T18:26:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438762",
    "user": "https://github.com/videlec"
}
```

<div id="comment:8" align="right">comment:8</div>

BTW, have you tried using LinBox? givaro is supposed to support finite fields and the linear algebra in linbox is highly optimized (when it works :-).



---

archive/issue_comments_438763.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nmeataxe does representation theory stuff, that's its main purpose; that it can be used just for fast matrix operations is an extra.",
    "created_at": "2019-07-13T18:28:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438763",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

meataxe does representation theory stuff, that's its main purpose; that it can be used just for fast matrix operations is an extra.



---

archive/issue_comments_438764.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@dimpase](#comment%3A5):\n> If it's fread/fwrite, why can't one just copy the data directly (with memcpy() or whatever)?\n> (If one actually does need to copy them, rather than just to access them directly)\n\nI think the idea really is to avoid re-creation of the tables. Compute them once, store them, reload them another day.",
    "created_at": "2019-07-13T20:21:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438764",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@dimpase](#comment%3A5):
> If it's fread/fwrite, why can't one just copy the data directly (with memcpy() or whatever)?
> (If one actually does need to copy them, rather than just to access them directly)

I think the idea really is to avoid re-creation of the tables. Compute them once, store them, reload them another day.



---

archive/issue_comments_438765.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@dimpase](#comment%3A7):\n> these files may be generated during the installation of meataxe, as well.\n\nThat is one of the potential ways out asmentioned in [comment:1](#comment%3A1).",
    "created_at": "2019-07-13T20:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438765",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@dimpase](#comment%3A7):
> these files may be generated during the installation of meataxe, as well.

That is one of the potential ways out asmentioned in [comment:1](#comment%3A1).



---

archive/issue_comments_438766.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI created tables for all field sizes that meataxe can deal with (i.e., less than 255).\n\n- It was very quick and could thus be done during package installation.\n- The total size of the tables is 9.5MB",
    "created_at": "2019-07-13T20:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438766",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

I created tables for all field sizes that meataxe can deal with (i.e., less than 255).

- It was very quick and could thus be done during package installation.
- The total size of the tables is 9.5MB



---

archive/issue_comments_438767.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nFYI: If nobody stops me, I will change `spkg-install` so that the tables will henceforth be ALL installed in `%SAGE_SHARE/meataxe`during package installation.\n\nRationale: Creation of the tables takes at most a few seconds. Moreover, I will not need to change the existing SharedMeatAxe tarball, as the path to the tables is defined by code in the Sage library.",
    "created_at": "2019-07-15T10:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438767",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

FYI: If nobody stops me, I will change `spkg-install` so that the tables will henceforth be ALL installed in `%SAGE_SHARE/meataxe`during package installation.

Rationale: Creation of the tables takes at most a few seconds. Moreover, I will not need to change the existing SharedMeatAxe tarball, as the path to the tables is defined by code in the Sage library.



---

archive/issue_comments_438768.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYes please, go ahead, I'll be happy to approve this.",
    "created_at": "2019-07-15T10:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438768",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

Yes please, go ahead, I'll be happy to approve this.



---

archive/issue_comments_438769.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIt is (I think) required that the tables are created, BEFORE the optional `matrix_gfpn_dense` Cython module is available.\n\nTherefore, I want to trigger creation of the tables using one of the MeatAxe executables. I find `zcv` convenient --- to some extent:\n- Let `input` be a file consisting of the single line `matrix field=25 rows=0 cols=0`.\n- Then, the command `zcv input output` will create a file called `output` describing an empty matrix in binary format, and will, as a side-effect, create `p025.zzz` in the current directory. Of course I am only interested in the side-effect; the file `output` can safely be deleted.\n\nThe question is how to do the above in a loop, where `field=...` runs over all available field sizes. According to [MeatAxe documentation](https://www.mankier.com/1/zcv), `zcv - output` should read the input from stdin, but apparently it doesn't.\n\nIs there a way to pretend that a program such as `zcv` reads input from a file? If not: How do I create the input file using a shell script and apply `zcv` to it without risking to be affected by race conditions?",
    "created_at": "2019-07-15T11:33:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438769",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

It is (I think) required that the tables are created, BEFORE the optional `matrix_gfpn_dense` Cython module is available.

Therefore, I want to trigger creation of the tables using one of the MeatAxe executables. I find `zcv` convenient --- to some extent:
- Let `input` be a file consisting of the single line `matrix field=25 rows=0 cols=0`.
- Then, the command `zcv input output` will create a file called `output` describing an empty matrix in binary format, and will, as a side-effect, create `p025.zzz` in the current directory. Of course I am only interested in the side-effect; the file `output` can safely be deleted.

The question is how to do the above in a loop, where `field=...` runs over all available field sizes. According to [MeatAxe documentation](https://www.mankier.com/1/zcv), `zcv - output` should read the input from stdin, but apparently it doesn't.

Is there a way to pretend that a program such as `zcv` reads input from a file? If not: How do I create the input file using a shell script and apply `zcv` to it without risking to be affected by race conditions?



---

archive/issue_comments_438770.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nWould the following be safe against race conditions?\n\n```\nfor i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251\ndo\n  echo \"matrix field=$i rows=0 cols=0\">test | zcv test outtest\ndone\n```\nPS: The above takes about 1 second on my laptop.",
    "created_at": "2019-07-15T11:58:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438770",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Would the following be safe against race conditions?

```
for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251
do
  echo "matrix field=$i rows=0 cols=0">test | zcv test outtest
done
```
PS: The above takes about 1 second on my laptop.



---

archive/issue_comments_438771.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nNo need to create a file, just do\n\n```\n$ for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251\ndo\n   zcv <(echo \"matrix field=$i rows=0 cols=0\") /dev/null\ndone\n```",
    "created_at": "2019-07-15T12:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438771",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

No need to create a file, just do

```
$ for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251
do
   zcv <(echo "matrix field=$i rows=0 cols=0") /dev/null
done
```



---

archive/issue_comments_438772.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@dimpase](#comment%3A17):\n> No need to create a file, just do\n> \n> ```\n> $ for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251\n> do\n>    zcv <(echo \"matrix field=$i rows=0 cols=0\") /dev/null\n> done\n> ```\n\nThank you! That was exactly what I was looking for.\n\nBefore I create a branch: The upstream tarball will not change. But shall the Sage package version be bumped from `1.0` to `1.0.p0`?",
    "created_at": "2019-07-15T20:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438772",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@dimpase](#comment%3A17):
> No need to create a file, just do
> 
> ```
> $ for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251
> do
>    zcv <(echo "matrix field=$i rows=0 cols=0") /dev/null
> done
> ```

Thank you! That was exactly what I was looking for.

Before I create a branch: The upstream tarball will not change. But shall the Sage package version be bumped from `1.0` to `1.0.p0`?



---

archive/issue_comments_438773.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nyes, do bump up the version, to cause the reinstallation of the package.",
    "created_at": "2019-07-15T20:33:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438773",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

yes, do bump up the version, to cause the reinstallation of the package.



---

archive/issue_comments_438774.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nIdeally, when `zcv` fails in one iteration of the loop, the install script should abort. How to achieve this?\n\n```\n$ for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251\ndo\n   zcv <(echo \"matrix field=$i rows=0 cols=0\") /dev/null  ||  sdh_die\ndone\n```\n?",
    "created_at": "2019-07-15T22:25:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438774",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:20" align="right">comment:20</div>

Ideally, when `zcv` fails in one iteration of the loop, the install script should abort. How to achieve this?

```
$ for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251
do
   zcv <(echo "matrix field=$i rows=0 cols=0") /dev/null  ||  sdh_die
done
```
?



---

archive/issue_comments_438775.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nwell, if `zcv` produces an error code, indeed, then something like this ought to work.\nYou may try to see if this works by passing it `i=6`, say...",
    "created_at": "2019-07-15T22:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438775",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

well, if `zcv` produces an error code, indeed, then something like this ought to work.
You may try to see if this works by passing it `i=6`, say...



---

archive/issue_comments_438776.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nCan someone please explain what is going wrong here?\n\n```\n# Delete old (Shared)MeatAxe libraries. This ensures a sane state if\n# installation of this package fails: the mtx library should exist if\n# and only if meataxe is installed. In detail: the build-time check in\n# src/module_list.py checks whether or not the \"meataxe\" package is\n# marked as installed but the run-time check for the matrix_gfpn_dense\n# module checks whether it can be imported. We need to ensure that these\n# two conditions are equivalent, otherwise strange things can happen.\n# See also ticket:24359#comment:154\n#\n# This also deletes the static library left behind from the installation\n# of MeatAxe (as opposed to SharedMeatAxe).\nrm -f \"$SAGE_LOCAL\"/lib/libmtx.*\n\n# This is the place where arithmetic tables and some other input files\n# are searched by default.\nexport MTXLIB=\"$SAGE_SHARE\"/meataxe\n\n# Directory where executables are installed.\nexport MTXBIN=\"$SAGE_LOCAL\"/bin\n\n# Field size up to GF(256)\nexport ZZZ=0\n\n# We create a directory for the multiplication tables\nmkdir -p $MTXLIB || \\\n    sdh_die \"Error creating directory for multiplication tables\"\n\ncd src\nsdh_configure\nsdh_make\nsdh_make_install\n\nif [ \"$SAGE_SPKG_INSTALL_DOCS\" = yes ] ; then\n    $MAKE doc || sdh_die \"Error documenting SharedMeatAxe\"\nfi\n\ncd $MTXLIB\nfor i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251\ndo\n   zcv <(echo \"matrix field=$i rows=0 cols=0\") /dev/null  ||  sdh_die \"Error creating multiplication table for field of size $i\"\ndone\n```\nThe above spkg-install script is supposed to install the MeatAxe executables (including zcv) in `$SAGE_LOCAL/bin`. It DOES install it when the spkg-install script ends before `cd $MTXLIB`.\n\nHowever, according to the error message, zcv is in fact not installed when it is needed. Why?\n\nOn the bright side, `... || sdh_die` works as expected.",
    "created_at": "2019-07-15T22:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438776",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

Can someone please explain what is going wrong here?

```
# Delete old (Shared)MeatAxe libraries. This ensures a sane state if
# installation of this package fails: the mtx library should exist if
# and only if meataxe is installed. In detail: the build-time check in
# src/module_list.py checks whether or not the "meataxe" package is
# marked as installed but the run-time check for the matrix_gfpn_dense
# module checks whether it can be imported. We need to ensure that these
# two conditions are equivalent, otherwise strange things can happen.
# See also ticket:24359#comment:154
#
# This also deletes the static library left behind from the installation
# of MeatAxe (as opposed to SharedMeatAxe).
rm -f "$SAGE_LOCAL"/lib/libmtx.*

# This is the place where arithmetic tables and some other input files
# are searched by default.
export MTXLIB="$SAGE_SHARE"/meataxe

# Directory where executables are installed.
export MTXBIN="$SAGE_LOCAL"/bin

# Field size up to GF(256)
export ZZZ=0

# We create a directory for the multiplication tables
mkdir -p $MTXLIB || \
    sdh_die "Error creating directory for multiplication tables"

cd src
sdh_configure
sdh_make
sdh_make_install

if [ "$SAGE_SPKG_INSTALL_DOCS" = yes ] ; then
    $MAKE doc || sdh_die "Error documenting SharedMeatAxe"
fi

cd $MTXLIB
for i in 2 3 4 5 7 8 9 11 13 16 17 19 23 25 27 29 31 32 37 41 43 47 49 53 59 61 64 67 71 73 79 81 83 89 97 101 103 107 109 113 121 125 127 128 131 137 139 149 151 157 163 167 169 173 179 181 191 193 197 199 211 223 227 229 233 239 241 243 251
do
   zcv <(echo "matrix field=$i rows=0 cols=0") /dev/null  ||  sdh_die "Error creating multiplication table for field of size $i"
done
```
The above spkg-install script is supposed to install the MeatAxe executables (including zcv) in `$SAGE_LOCAL/bin`. It DOES install it when the spkg-install script ends before `cd $MTXLIB`.

However, according to the error message, zcv is in fact not installed when it is needed. Why?

On the bright side, `... || sdh_die` works as expected.



---

archive/issue_comments_438777.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI guess that loop that calls `zcv` should be moved to `spkg-postinst` script; \nprobably due to the fact that before `spkg-install` terminates, the access to its result is not assured.",
    "created_at": "2019-07-15T22:48:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438777",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:23" align="right">comment:23</div>

I guess that loop that calls `zcv` should be moved to `spkg-postinst` script; 
probably due to the fact that before `spkg-install` terminates, the access to its result is not assured.



---

archive/issue_comments_438778.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@dimpase](#comment%3A23):\n> I guess that loop that calls `zcv` should be moved to `spkg-postinst` script; \n> probably due to the fact that before `spkg-install` terminates, the access to its result is not assured.\n\nYes, this seems to work!\n\nShall I move building the documentation to `spkg-postinst` as well? Probably not, as building the docs doesn't depend on the presence of the meataxe executables.",
    "created_at": "2019-07-15T22:55:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438778",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@dimpase](#comment%3A23):
> I guess that loop that calls `zcv` should be moved to `spkg-postinst` script; 
> probably due to the fact that before `spkg-install` terminates, the access to its result is not assured.

Yes, this seems to work!

Shall I move building the documentation to `spkg-postinst` as well? Probably not, as building the docs doesn't depend on the presence of the meataxe executables.



---

archive/issue_comments_438779.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@simon-king-jena](#comment%3A24):\n\n> Shall I move building the documentation to `spkg-postinst` as well? Probably not, as building the docs doesn't depend on the presence of the meataxe executables.\n\nif it works then there is no need to fiddle around more with it, IMHO.",
    "created_at": "2019-07-15T23:05:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438779",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@simon-king-jena](#comment%3A24):

> Shall I move building the documentation to `spkg-postinst` as well? Probably not, as building the docs doesn't depend on the presence of the meataxe executables.

if it works then there is no need to fiddle around more with it, IMHO.



---

archive/issue_comments_438780.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nGood news: The rather minimal change (which doesn't affect the upstream tarball) works. Bad news: I will need to change `p_group_cohomology', as apparently the old location of the meataxe tables is hard-coded in `p_group_cohomology`.\n\nDo you see a way out?\n\nEDIT: The group cohomology package fails because I explicitly deleted `$DOT_SAGE/meataxe`. A user who does not manually delete `$DOT_SAGE/meataxe` will not be affected: `p_group_cohomology` will simply create new tables in `$DOT_SAGE/meataxe`.",
    "created_at": "2019-07-15T23:12:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438780",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:26" align="right">comment:26</div>

Good news: The rather minimal change (which doesn't affect the upstream tarball) works. Bad news: I will need to change `p_group_cohomology', as apparently the old location of the meataxe tables is hard-coded in `p_group_cohomology`.

Do you see a way out?

EDIT: The group cohomology package fails because I explicitly deleted `$DOT_SAGE/meataxe`. A user who does not manually delete `$DOT_SAGE/meataxe` will not be affected: `p_group_cohomology` will simply create new tables in `$DOT_SAGE/meataxe`.



---

archive/issue_comments_438781.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nwell, it's a minimal change, just go ahead and do it. Then `p_group_cohomology` might work on cocalc again...",
    "created_at": "2019-07-15T23:52:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438781",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

well, it's a minimal change, just go ahead and do it. Then `p_group_cohomology` might work on cocalc again...



---

archive/issue_comments_438782.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@dimpase](#comment%3A27):\n> well, it's a minimal change, just go ahead and do it. Then `p_group_cohomology` might work on cocalc again...\n\nProbably not. As mentioned in [comment:26](#comment%3A26), `p_group_cohomology` expects the location of the tables in `$DOT_SAGE/meataxe`. Really the location should be exposed in `sage/libs/meataxe` and imported from there. So, there must be a follow-up ticket for `p_group_cohomology`",
    "created_at": "2019-07-15T23:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438782",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@dimpase](#comment%3A27):
> well, it's a minimal change, just go ahead and do it. Then `p_group_cohomology` might work on cocalc again...

Probably not. As mentioned in [comment:26](#comment%3A26), `p_group_cohomology` expects the location of the tables in `$DOT_SAGE/meataxe`. Really the location should be exposed in `sage/libs/meataxe` and imported from there. So, there must be a follow-up ticket for `p_group_cohomology`



---

archive/issue_comments_438783.json:
```json
{
    "body": "Branch: **[u/SimonKing/meataxe_arithmetic_tables](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/meataxe_arithmetic_tables)**",
    "created_at": "2019-07-16T00:01:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438783",
    "user": "https://github.com/simon-king-jena"
}
```

Branch: **[u/SimonKing/meataxe_arithmetic_tables](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/meataxe_arithmetic_tables)**



---

archive/issue_comments_438784.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64edd02051f8dfe36de4b0949a619b6177f6cfc5\"><code>64edd02</code></a></td><td><code>Change default location for the multiplication table of the MeatAxe spkg</code></td></tr></table>\n",
    "created_at": "2019-07-16T00:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438784",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:30"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64edd02051f8dfe36de4b0949a619b6177f6cfc5"><code>64edd02</code></a></td><td><code>Change default location for the multiplication table of the MeatAxe spkg</code></td></tr></table>




---

archive/issue_comments_438785.json:
```json
{
    "body": "Author: **Simon King**",
    "created_at": "2019-07-16T00:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438785",
    "user": "https://github.com/simon-king-jena"
}
```

Author: **Simon King**



---

archive/issue_events_383650.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-16T00:01:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383650"
}
```



---

archive/issue_comments_438786.json:
```json
{
    "body": "Commit: **[`64edd02`](https://github.com/sagemath/sagetrac-mirror/commit/64edd02051f8dfe36de4b0949a619b6177f6cfc5)**",
    "created_at": "2019-07-16T00:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438786",
    "user": "https://github.com/simon-king-jena"
}
```

Commit: **[`64edd02`](https://github.com/sagemath/sagetrac-mirror/commit/64edd02051f8dfe36de4b0949a619b6177f6cfc5)**



---

archive/issue_comments_438787.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe follow-up ticket is #28204",
    "created_at": "2019-07-16T00:11:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438787",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:31" align="right">comment:31</div>

The follow-up ticket is #28204



---

archive/issue_comments_438788.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nConcerning #28204: `p_group_cohomology` uses some MeatAxe \"applications\", which learn the location of the multiplication tables from an environment variable. Would you think that **here** we should add the corresponding environment variable to `sage_env`?\n\nEDIT: Shall `MTXLIB` be exported even if `meataxe` is not installed?",
    "created_at": "2019-07-16T00:23:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438788",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:32" align="right">comment:32</div>

Concerning #28204: `p_group_cohomology` uses some MeatAxe "applications", which learn the location of the multiplication tables from an environment variable. Would you think that **here** we should add the corresponding environment variable to `sage_env`?

EDIT: Shall `MTXLIB` be exported even if `meataxe` is not installed?



---

archive/issue_events_383651.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-16T00:25:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383651"
}
```



---

archive/issue_events_383652.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-16T00:25:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383652"
}
```



---

archive/issue_comments_438789.json:
```json
{
    "body": "Work Issues: **add MTXLIB to sage_env**",
    "created_at": "2019-07-16T00:25:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438789",
    "user": "https://github.com/simon-king-jena"
}
```

Work Issues: **add MTXLIB to sage_env**



---

archive/issue_comments_438790.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a04117b6b8ab1a2251287b7ea08fa4ecb1b35b18\"><code>a04117b</code></a></td><td><code>Define MTXLIB in sage.env</code></td></tr></table>\n",
    "created_at": "2019-07-16T07:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438790",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a04117b6b8ab1a2251287b7ea08fa4ecb1b35b18"><code>a04117b</code></a></td><td><code>Define MTXLIB in sage.env</code></td></tr></table>




---

archive/issue_comments_438791.json:
```json
{
    "body": "Changed commit from **[`64edd02`](https://github.com/sagemath/sagetrac-mirror/commit/64edd02051f8dfe36de4b0949a619b6177f6cfc5)** to **[`a04117b`](https://github.com/sagemath/sagetrac-mirror/commit/a04117b6b8ab1a2251287b7ea08fa4ecb1b35b18)**",
    "created_at": "2019-07-16T07:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438791",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`64edd02`](https://github.com/sagemath/sagetrac-mirror/commit/64edd02051f8dfe36de4b0949a619b6177f6cfc5)** to **[`a04117b`](https://github.com/sagemath/sagetrac-mirror/commit/a04117b6b8ab1a2251287b7ea08fa4ecb1b35b18)**



---

archive/issue_comments_438792.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nQuestions: How can I achieve that `MTXLIB` (which is defined in `sage.env` by the new commit) will be exported into the sage shell? Would it be OK to automatically export it?\n\nMeatAxe \"applications\" (i.e., stand-alone programs) need that environment variable to properly work (otherwise, they don't know where to find multiplication tables and will thus create new tables in the current directory).",
    "created_at": "2019-07-16T07:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438792",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:35" align="right">comment:35</div>

Questions: How can I achieve that `MTXLIB` (which is defined in `sage.env` by the new commit) will be exported into the sage shell? Would it be OK to automatically export it?

MeatAxe "applications" (i.e., stand-alone programs) need that environment variable to properly work (otherwise, they don't know where to find multiplication tables and will thus create new tables in the current directory).



---

archive/issue_comments_438793.json:
```json
{
    "body": "Changed work issues from **add MTXLIB to sage_env** to none",
    "created_at": "2019-07-16T07:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438793",
    "user": "https://github.com/simon-king-jena"
}
```

Changed work issues from **add MTXLIB to sage_env** to none



---

archive/issue_comments_438794.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAFAIK, `src/sage/env.py` is for !Python/Cython related tasks. For the shell, you need to modify `src/bin/sage-env`.",
    "created_at": "2019-07-16T08:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438794",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

AFAIK, `src/sage/env.py` is for !Python/Cython related tasks. For the shell, you need to modify `src/bin/sage-env`.



---

archive/issue_comments_438795.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@dimpase](#comment%3A36):\n> AFAIK, `src/sage/env.py` is for !Python/Cython related tasks. For the shell, you need to modify `src/bin/sage-env`.\n\nI see. Perhaps I could do both? After all, we are dealing with the MeatAxe library on the one hand (for this, some `cdef extern` variable is set) and MeatAxe applications on the other hand (for this, we need an environment variable.",
    "created_at": "2019-07-16T08:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438795",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@dimpase](#comment%3A36):
> AFAIK, `src/sage/env.py` is for !Python/Cython related tasks. For the shell, you need to modify `src/bin/sage-env`.

I see. Perhaps I could do both? After all, we are dealing with the MeatAxe library on the one hand (for this, some `cdef extern` variable is set) and MeatAxe applications on the other hand (for this, we need an environment variable.



---

archive/issue_comments_438796.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nYou certainly can do both, why not?",
    "created_at": "2019-07-16T08:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438796",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:38" align="right">comment:38</div>

You certainly can do both, why not?



---

archive/issue_comments_438797.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@dimpase](#comment%3A38):\n> You certainly can do both, why not?\n\nEnvironmental pollution...\n\nBut it would slightly simplify the install script, too.",
    "created_at": "2019-07-16T08:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438797",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@dimpase](#comment%3A38):
> You certainly can do both, why not?

Environmental pollution...

But it would slightly simplify the install script, too.



---

archive/issue_comments_438798.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI don't know much about Cython, except that in some cases one puts in the pxd file\nsomething like\n\n```\n# distutils: libraries = gmp flint arb\n```\n(this is from `src/sage/libs/arb/arb.pxd`)\nto tell the linker, in this case, to link with `-lgmp -lflint -larb`\n\nI have no idea how Cython handles linking without these sorts of directives.\n(More precisly, I know this can be done within `setup.py`, but often there is no `setup.py` for a particular Cython extension...)",
    "created_at": "2019-07-16T08:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438798",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

I don't know much about Cython, except that in some cases one puts in the pxd file
something like

```
# distutils: libraries = gmp flint arb
```
(this is from `src/sage/libs/arb/arb.pxd`)
to tell the linker, in this case, to link with `-lgmp -lflint -larb`

I have no idea how Cython handles linking without these sorts of directives.
(More precisly, I know this can be done within `setup.py`, but often there is no `setup.py` for a particular Cython extension...)



---

archive/issue_comments_438799.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@dimpase](#comment%3A40):\n> I don't know much about Cython, except that in some cases one puts in the pxd file\n> something like\n> \n> ```\n> # distutils: libraries = gmp flint arb\n> ```\n> (this is from `src/sage/libs/arb/arb.pxd`)\n> to tell the linker, in this case, to link with `-lgmp -lflint -larb`\n> \n> I have no idea how Cython handles linking without these sorts of directives.\n\nIt is totally unrelated with linking. It is an `extern char*` variable that is supposed to be defined at runtime.",
    "created_at": "2019-07-16T08:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438799",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@dimpase](#comment%3A40):
> I don't know much about Cython, except that in some cases one puts in the pxd file
> something like
> 
> ```
> # distutils: libraries = gmp flint arb
> ```
> (this is from `src/sage/libs/arb/arb.pxd`)
> to tell the linker, in this case, to link with `-lgmp -lflint -larb`
> 
> I have no idea how Cython handles linking without these sorts of directives.

It is totally unrelated with linking. It is an `extern char*` variable that is supposed to be defined at runtime.



---

archive/issue_comments_438800.json:
```json
{
    "body": "Changed commit from **[`a04117b`](https://github.com/sagemath/sagetrac-mirror/commit/a04117b6b8ab1a2251287b7ea08fa4ecb1b35b18)** to **[`67d2fbd`](https://github.com/sagemath/sagetrac-mirror/commit/67d2fbd9088a2672178fa313d7537b37c949076a)**",
    "created_at": "2019-07-16T08:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438800",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a04117b`](https://github.com/sagemath/sagetrac-mirror/commit/a04117b6b8ab1a2251287b7ea08fa4ecb1b35b18)** to **[`67d2fbd`](https://github.com/sagemath/sagetrac-mirror/commit/67d2fbd9088a2672178fa313d7537b37c949076a)**



---

archive/issue_comments_438801.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67d2fbd9088a2672178fa313d7537b37c949076a\"><code>67d2fbd</code></a></td><td><code>MTXLIB environment variable</code></td></tr></table>\n",
    "created_at": "2019-07-16T08:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438801",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67d2fbd9088a2672178fa313d7537b37c949076a"><code>67d2fbd</code></a></td><td><code>MTXLIB environment variable</code></td></tr></table>




---

archive/issue_comments_438802.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI think the current proposition is a clean approach: Define `MTXLIB` in `sage-env` as an environment variable, and derive all other usage of the table locations from there. In that way, there will never be an inconsistency. And in #28204, I can simplify the `p_group_cohomology` package.",
    "created_at": "2019-07-16T08:50:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438802",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:43" align="right">comment:43</div>

I think the current proposition is a clean approach: Define `MTXLIB` in `sage-env` as an environment variable, and derive all other usage of the table locations from there. In that way, there will never be an inconsistency. And in #28204, I can simplify the `p_group_cohomology` package.



---

archive/issue_events_383653.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-16T08:50:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383653"
}
```



---

archive/issue_events_383654.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2019-07-16T08:50:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383654"
}
```



---

archive/issue_comments_438803.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nAny reason you're using var('MTXLIB', os.environ['MTXLIB']) instead of var('MTXLIB', join(SAGE_SHARE, 'meataxe')) like it's done for all other variables? This will not make any difference in practice for sage-the-distro (since var uses the env variable if it is defined), and will allow to not rely on the presence of sage-env on distros (I'm aiming to remove it completely in the near future on Arch)",
    "created_at": "2019-07-16T10:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438803",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:44" align="right">comment:44</div>

Any reason you're using var('MTXLIB', os.environ['MTXLIB']) instead of var('MTXLIB', join(SAGE_SHARE, 'meataxe')) like it's done for all other variables? This will not make any difference in practice for sage-the-distro (since var uses the env variable if it is defined), and will allow to not rely on the presence of sage-env on distros (I'm aiming to remove it completely in the near future on Arch)



---

archive/issue_comments_438804.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@antonio-rojas](#comment%3A44):\n> Any reason you're using var('MTXLIB', os.environ['MTXLIB']) instead of var('MTXLIB', join(SAGE_SHARE, 'meataxe')) like it's done for all other variables?\n\nYes. There shall be a **single** location where the value of `MTXLIB` is defined, so that there cannot be an inconsistency.\n\n> This will not make any difference in practice for sage-the-distro (since var uses the env variable if it is defined), and will allow to not rely on the presence of sage-env on distros (I'm aiming to remove it completely in the near future on Arch)\n\nI don't understand that. Are you saying that on some platforms it will NOT be possible to let `MTXLIB` be defined by Sage as an environment variable? In any case, I was not aware that var uses the env variable when possible.",
    "created_at": "2019-07-16T10:45:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438804",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@antonio-rojas](#comment%3A44):
> Any reason you're using var('MTXLIB', os.environ['MTXLIB']) instead of var('MTXLIB', join(SAGE_SHARE, 'meataxe')) like it's done for all other variables?

Yes. There shall be a **single** location where the value of `MTXLIB` is defined, so that there cannot be an inconsistency.

> This will not make any difference in practice for sage-the-distro (since var uses the env variable if it is defined), and will allow to not rely on the presence of sage-env on distros (I'm aiming to remove it completely in the near future on Arch)

I don't understand that. Are you saying that on some platforms it will NOT be possible to let `MTXLIB` be defined by Sage as an environment variable? In any case, I was not aware that var uses the env variable when possible.



---

archive/issue_comments_438805.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nIn practice (at the moment, it's more in theory, of course :-)), Meataxe might be externally installed, and then there is no reason for `MTXLIB` to be under `SAGE_SHARE`.",
    "created_at": "2019-07-16T10:50:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438805",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">comment:46</div>

In practice (at the moment, it's more in theory, of course :-)), Meataxe might be externally installed, and then there is no reason for `MTXLIB` to be under `SAGE_SHARE`.



---

archive/issue_comments_438806.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@simon-king-jena](#comment%3A45):\n> Replying to [@antonio-rojas](#comment%3A44):\n> > Any reason you're using var('MTXLIB', os.environ['MTXLIB']) instead of var('MTXLIB', join(SAGE_SHARE, 'meataxe')) like it's done for all other variables?\n\n> \n> Yes. There shall be a **single** location where the value of `MTXLIB` is defined, so that there cannot be an inconsistency.\n\nEvery env variable defined in sage-env has the same path set as fallback in env.py, I don't see why this one should be different - the env.py one is just a fallback, if the env variable is defined it will be used.\n\nThis is not only useful for distros that don't provide sage-env, but also for using sage as a python library - 'from sage.all import *' does not import the env variables defined in sage-env",
    "created_at": "2019-07-16T11:01:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438806",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@simon-king-jena](#comment%3A45):
> Replying to [@antonio-rojas](#comment%3A44):
> > Any reason you're using var('MTXLIB', os.environ['MTXLIB']) instead of var('MTXLIB', join(SAGE_SHARE, 'meataxe')) like it's done for all other variables?

> 
> Yes. There shall be a **single** location where the value of `MTXLIB` is defined, so that there cannot be an inconsistency.

Every env variable defined in sage-env has the same path set as fallback in env.py, I don't see why this one should be different - the env.py one is just a fallback, if the env variable is defined it will be used.

This is not only useful for distros that don't provide sage-env, but also for using sage as a python library - 'from sage.all import *' does not import the env variables defined in sage-env



---

archive/issue_comments_438807.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@antonio-rojas](#comment%3A47):\n> Replying to [@simon-king-jena](#comment%3A45):\n> > Yes. There shall be a **single** location where the value of `MTXLIB` is defined, so that there cannot be an inconsistency.\n\n> \n> Every env variable defined in sage-env has the same path set as fallback in env.py,\n\nI was simply unaware about it. So, are you saying that I shouldn't change env.py at all, or that I should define `MTXLIB` in env.py with an empty default?",
    "created_at": "2019-07-16T12:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438807",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@antonio-rojas](#comment%3A47):
> Replying to [@simon-king-jena](#comment%3A45):
> > Yes. There shall be a **single** location where the value of `MTXLIB` is defined, so that there cannot be an inconsistency.

> 
> Every env variable defined in sage-env has the same path set as fallback in env.py,

I was simply unaware about it. So, are you saying that I shouldn't change env.py at all, or that I should define `MTXLIB` in env.py with an empty default?



---

archive/issue_comments_438808.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@dimpase](#comment%3A46):\n> In practice (at the moment, it's more in theory, of course :-)), Meataxe might be externally installed, and then there is no reason for `MTXLIB` to be under `SAGE_SHARE`.\n\nI think it doesn't matter whether a system-wide meataxe or the meataxe spkg is used (except that the original `MeatAxe` is clearly inferior to its fork `SharedMeatAxe` and that the Sage wrapper uses some functions that only exist in the fork).\n\nIn any case, when a meataxe application or any program using meataxe library functions is executed, it will be needed to use arithmetic tables. When they cannot be found, they will be created.\n\nSo, the following implications hold regardless whether spkg-meataxe or system-meataxe is used:\n- If the environment variable `MTXLIB` is undefined, meataxe applications will search and potentially write tables to the current directory. If the `extern char*` variable `MtxLibDir` is undefined, meataxe library functions will search and potentially write tables to the current directory.\n\n  => Since we do not want to pollute the user's current directory, we **have to** define both environment and cdef extern variables.\n- If the tables already exist at the location pointed at by the variables, we need that the user has read permission. Otherwise, there will be an error.\n- If the tables do not already exist, the folder pointed at by the variables needs to exist and the user needs to have write permission. Otherwise. there will be an error.\n\nSo, our requirements, regardless what source we take meataxe from, are as follows:\n- Sage needs to define one environment and one extern C variable. The former should be in sage-env, the latter in sage.libs.meataxe, I suppose.\n- It is not a strict requirement that both variables are equal, but of course it would be nice. In any case, we have to make sure that either\n  * the arithmetic tables are present at the given folder (and the user can read them), or\n  * the user has write permission at the given folder.\n  \n  A system wide meataxe wouldn't mind that the folder is inside of the Sage tree.\n\n**Question:** What should we do?",
    "created_at": "2019-07-16T13:12:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438808",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@dimpase](#comment%3A46):
> In practice (at the moment, it's more in theory, of course :-)), Meataxe might be externally installed, and then there is no reason for `MTXLIB` to be under `SAGE_SHARE`.

I think it doesn't matter whether a system-wide meataxe or the meataxe spkg is used (except that the original `MeatAxe` is clearly inferior to its fork `SharedMeatAxe` and that the Sage wrapper uses some functions that only exist in the fork).

In any case, when a meataxe application or any program using meataxe library functions is executed, it will be needed to use arithmetic tables. When they cannot be found, they will be created.

So, the following implications hold regardless whether spkg-meataxe or system-meataxe is used:
- If the environment variable `MTXLIB` is undefined, meataxe applications will search and potentially write tables to the current directory. If the `extern char*` variable `MtxLibDir` is undefined, meataxe library functions will search and potentially write tables to the current directory.

  => Since we do not want to pollute the user's current directory, we **have to** define both environment and cdef extern variables.
- If the tables already exist at the location pointed at by the variables, we need that the user has read permission. Otherwise, there will be an error.
- If the tables do not already exist, the folder pointed at by the variables needs to exist and the user needs to have write permission. Otherwise. there will be an error.

So, our requirements, regardless what source we take meataxe from, are as follows:
- Sage needs to define one environment and one extern C variable. The former should be in sage-env, the latter in sage.libs.meataxe, I suppose.
- It is not a strict requirement that both variables are equal, but of course it would be nice. In any case, we have to make sure that either
  * the arithmetic tables are present at the given folder (and the user can read them), or
  * the user has write permission at the given folder.
  
  A system wide meataxe wouldn't mind that the folder is inside of the Sage tree.

**Question:** What should we do?



---

archive/issue_comments_438809.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@simon-king-jena](#comment%3A48):\n> I was simply unaware about it. So, are you saying that I shouldn't change env.py at all, or that I should define `MTXLIB` in env.py with an empty default?\n\nApparently it is the latter.",
    "created_at": "2019-07-16T13:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438809",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@simon-king-jena](#comment%3A48):
> I was simply unaware about it. So, are you saying that I shouldn't change env.py at all, or that I should define `MTXLIB` in env.py with an empty default?

Apparently it is the latter.



---

archive/issue_comments_438810.json:
```json
{
    "body": "<div id=\"comment:51\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4348553c679b24771e49b1ea8f2d2cbeedcdb9d\"><code>a434855</code></a></td><td><code>Simplify definition of MTXLIB in sage.env</code></td></tr></table>\n",
    "created_at": "2019-07-16T13:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438810",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4348553c679b24771e49b1ea8f2d2cbeedcdb9d"><code>a434855</code></a></td><td><code>Simplify definition of MTXLIB in sage.env</code></td></tr></table>




---

archive/issue_comments_438811.json:
```json
{
    "body": "Changed commit from **[`67d2fbd`](https://github.com/sagemath/sagetrac-mirror/commit/67d2fbd9088a2672178fa313d7537b37c949076a)** to **[`a434855`](https://github.com/sagemath/sagetrac-mirror/commit/a4348553c679b24771e49b1ea8f2d2cbeedcdb9d)**",
    "created_at": "2019-07-16T13:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438811",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`67d2fbd`](https://github.com/sagemath/sagetrac-mirror/commit/67d2fbd9088a2672178fa313d7537b37c949076a)** to **[`a434855`](https://github.com/sagemath/sagetrac-mirror/commit/a4348553c679b24771e49b1ea8f2d2cbeedcdb9d)**



---

archive/issue_comments_438812.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@simon-king-jena](#comment%3A50):\n> Replying to [@simon-king-jena](#comment%3A48):\n> > I was simply unaware about it. So, are you saying that I shouldn't change env.py at all, or that I should define `MTXLIB` in env.py with an empty default?\n\n> \n> Apparently it is the latter.\n\nNo, I mean define join(SAGE_SHARE, 'meataxe') as fallback, similar to all other variables in env.py. Defining an empty fallback would not make any difference - the variable would be undefined if sage-env is not being imported.",
    "created_at": "2019-07-16T13:32:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438812",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@simon-king-jena](#comment%3A50):
> Replying to [@simon-king-jena](#comment%3A48):
> > I was simply unaware about it. So, are you saying that I shouldn't change env.py at all, or that I should define `MTXLIB` in env.py with an empty default?

> 
> Apparently it is the latter.

No, I mean define join(SAGE_SHARE, 'meataxe') as fallback, similar to all other variables in env.py. Defining an empty fallback would not make any difference - the variable would be undefined if sage-env is not being imported.



---

archive/issue_comments_438813.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@antonio-rojas](#comment%3A52):\n> No, I mean define join(SAGE_SHARE, 'meataxe') as fallback, similar to all other variables in env.py. Defining an empty fallback would not make any difference - the variable would be undefined if sage-env is not being imported.\n\nMy rationale was: As stated in [comment:49](#comment%3A49), if FooBar uses meataxe, then FooBar has to take care that it defines `MTXLIB` (the environment variable). Otherwise it is a bug in FooBar that results in a pollution of the current directory.\n\nSo, if FooBar uses meataxe via Sage, then the environment variable should be present.\n\nHm. I just think that one can see it the other way around: If FooBar uses meataxe only via Sage, then we cannot assume that FooBar is an expert in the internals of meataxe. So, it is Sage's responsibility to provide the environment variable, after all.\n\nHow can one define an environment variable in Python code? Would it be `os.environ['MTXLIB']=\"...\"`?",
    "created_at": "2019-07-16T13:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438813",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@antonio-rojas](#comment%3A52):
> No, I mean define join(SAGE_SHARE, 'meataxe') as fallback, similar to all other variables in env.py. Defining an empty fallback would not make any difference - the variable would be undefined if sage-env is not being imported.

My rationale was: As stated in [comment:49](#comment%3A49), if FooBar uses meataxe, then FooBar has to take care that it defines `MTXLIB` (the environment variable). Otherwise it is a bug in FooBar that results in a pollution of the current directory.

So, if FooBar uses meataxe via Sage, then the environment variable should be present.

Hm. I just think that one can see it the other way around: If FooBar uses meataxe only via Sage, then we cannot assume that FooBar is an expert in the internals of meataxe. So, it is Sage's responsibility to provide the environment variable, after all.

How can one define an environment variable in Python code? Would it be `os.environ['MTXLIB']="..."`?



---

archive/issue_comments_438814.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nthe var function from env.py already injects the variable in SAGE_ENV. I take it this not enough, and using meataxe from sage actually requires the variable to be defined in the user's global env?",
    "created_at": "2019-07-16T13:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438814",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:54" align="right">comment:54</div>

the var function from env.py already injects the variable in SAGE_ENV. I take it this not enough, and using meataxe from sage actually requires the variable to be defined in the user's global env?



---

archive/issue_comments_438815.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@antonio-rojas](#comment%3A54):\n> the var function from env.py already injects the variable in SAGE_ENV. I take it this not enough, and using meataxe from sage actually requires the variable to be defined in the user's global env?\n\nI don't know what you mean by \"user's global env\". It needs to be present when you call an executable in a sage shell.",
    "created_at": "2019-07-16T13:50:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438815",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@antonio-rojas](#comment%3A54):
> the var function from env.py already injects the variable in SAGE_ENV. I take it this not enough, and using meataxe from sage actually requires the variable to be defined in the user's global env?

I don't know what you mean by "user's global env". It needs to be present when you call an executable in a sage shell.



---

archive/issue_comments_438816.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@simon-king-jena](#comment%3A55):\n> I don't know what you mean by \"user's global env\". It needs to be present when you call an executable in a sage shell.\n\nPS: You do not need it when you just use meataxe as a backend for matrices over finite fields. You do need it when you call a meataxe application, though, which is the case for `p_group_cohomology` (see #28204)",
    "created_at": "2019-07-16T13:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438816",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@simon-king-jena](#comment%3A55):
> I don't know what you mean by "user's global env". It needs to be present when you call an executable in a sage shell.

PS: You do not need it when you just use meataxe as a backend for matrices over finite fields. You do need it when you call a meataxe application, though, which is the case for `p_group_cohomology` (see #28204)



---

archive/issue_comments_438817.json:
```json
{
    "body": "Changed commit from **[`a434855`](https://github.com/sagemath/sagetrac-mirror/commit/a4348553c679b24771e49b1ea8f2d2cbeedcdb9d)** to **[`05c06e2`](https://github.com/sagemath/sagetrac-mirror/commit/05c06e24e3acb0b187cd541026ff2abf38d86064)**",
    "created_at": "2019-07-16T13:57:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438817",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a434855`](https://github.com/sagemath/sagetrac-mirror/commit/a4348553c679b24771e49b1ea8f2d2cbeedcdb9d)** to **[`05c06e2`](https://github.com/sagemath/sagetrac-mirror/commit/05c06e24e3acb0b187cd541026ff2abf38d86064)**



---

archive/issue_comments_438818.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05c06e24e3acb0b187cd541026ff2abf38d86064\"><code>05c06e2</code></a></td><td><code>Do use a fallback for the MTXLIB environment variable, and export it when needed</code></td></tr></table>\n",
    "created_at": "2019-07-16T13:57:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438818",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:57"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05c06e24e3acb0b187cd541026ff2abf38d86064"><code>05c06e2</code></a></td><td><code>Do use a fallback for the MTXLIB environment variable, and export it when needed</code></td></tr></table>




---

archive/issue_comments_438819.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nIn the latest commit, I use a fallback in sage.env, in the case that sage-env is not executed. And in addition, when sage.libs.meataxe is imported, the value `sage.env.MTXLIB` is put into os.environ. I hope that's good enough to make the presence of the environment variable MTXLIB very likely, even when sage-env isn't called.",
    "created_at": "2019-07-16T14:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438819",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:58" align="right">comment:58</div>

In the latest commit, I use a fallback in sage.env, in the case that sage-env is not executed. And in addition, when sage.libs.meataxe is imported, the value `sage.env.MTXLIB` is put into os.environ. I hope that's good enough to make the presence of the environment variable MTXLIB very likely, even when sage-env isn't called.



---

archive/issue_comments_438820.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nAnother thought: In the Sage library, meataxe applications aren't called (sage.matrix.matrix_gfpn_dense entirely relies on calling meataxe library functions). Hence, Sage's only responsibility is to define `extern char* MtxLibDir`. If someone wants to call meataxe applications via Sage (this is what the p_group_cohomology spkg does), then it is not Sage's responsibility to define the environment variable MTXLIB. This gives rise to the following:\n\n- sage-env should not define MTXLIB, because that's only used in meataxe applications that Sage isn't calling.\n- sage.env should provide a default for MTXLIB that is overridden if some user defines MTXLIB him/herself.\n- Sage uses sage.env.MTXLIB to define `MtxLibDir`, but it is entirely the user's responsibility to export MTXLIB to the shell, in case (s)he needs it.\n\nDo you like the above better than what is in the current commits?",
    "created_at": "2019-07-16T15:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438820",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:59" align="right">comment:59</div>

Another thought: In the Sage library, meataxe applications aren't called (sage.matrix.matrix_gfpn_dense entirely relies on calling meataxe library functions). Hence, Sage's only responsibility is to define `extern char* MtxLibDir`. If someone wants to call meataxe applications via Sage (this is what the p_group_cohomology spkg does), then it is not Sage's responsibility to define the environment variable MTXLIB. This gives rise to the following:

- sage-env should not define MTXLIB, because that's only used in meataxe applications that Sage isn't calling.
- sage.env should provide a default for MTXLIB that is overridden if some user defines MTXLIB him/herself.
- Sage uses sage.env.MTXLIB to define `MtxLibDir`, but it is entirely the user's responsibility to export MTXLIB to the shell, in case (s)he needs it.

Do you like the above better than what is in the current commits?



---

archive/issue_comments_438821.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@simon-king-jena](#comment%3A59):\n> Another thought: In the Sage library, meataxe applications aren't called (sage.matrix.matrix_gfpn_dense entirely relies on calling meataxe library functions). Hence, Sage's only responsibility is to define `extern char* MtxLibDir`. If someone wants to call meataxe applications via Sage (this is what the p_group_cohomology spkg does), then it is not Sage's responsibility to define the environment variable MTXLIB. This gives rise to the following:\n> \n> - sage-env should not define MTXLIB, because that's only used in meataxe applications that Sage isn't calling.\n> - sage.env should provide a default for MTXLIB that is overridden if some user defines MTXLIB him/herself.\n> - Sage uses sage.env.MTXLIB to define `MtxLibDir`, but it is entirely the user's responsibility to export MTXLIB to the shell, in case (s)he needs it.\n> \n> Do you like the above better than what is in the current commits?\n\nIIUC the difference between this and the current state of the branch is whether MTXLIB is defined or not in sage-env, right? In that case, either way is fine for me - I'm only worried about what happens when sage-env is not imported, and the latest commit in env.py takes care of this.",
    "created_at": "2019-07-16T16:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438821",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@simon-king-jena](#comment%3A59):
> Another thought: In the Sage library, meataxe applications aren't called (sage.matrix.matrix_gfpn_dense entirely relies on calling meataxe library functions). Hence, Sage's only responsibility is to define `extern char* MtxLibDir`. If someone wants to call meataxe applications via Sage (this is what the p_group_cohomology spkg does), then it is not Sage's responsibility to define the environment variable MTXLIB. This gives rise to the following:
> 
> - sage-env should not define MTXLIB, because that's only used in meataxe applications that Sage isn't calling.
> - sage.env should provide a default for MTXLIB that is overridden if some user defines MTXLIB him/herself.
> - Sage uses sage.env.MTXLIB to define `MtxLibDir`, but it is entirely the user's responsibility to export MTXLIB to the shell, in case (s)he needs it.
> 
> Do you like the above better than what is in the current commits?

IIUC the difference between this and the current state of the branch is whether MTXLIB is defined or not in sage-env, right? In that case, either way is fine for me - I'm only worried about what happens when sage-env is not imported, and the latest commit in env.py takes care of this.



---

archive/issue_comments_438822.json:
```json
{
    "body": "<div id=\"comment:61\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67\"><code>46ee8be</code></a></td><td><code>Sage doesn't use the MTXLIB environment variable and thus we don't export it</code></td></tr></table>\n",
    "created_at": "2019-07-16T17:28:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438822",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:61"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67"><code>46ee8be</code></a></td><td><code>Sage doesn't use the MTXLIB environment variable and thus we don't export it</code></td></tr></table>




---

archive/issue_comments_438823.json:
```json
{
    "body": "Changed commit from **[`05c06e2`](https://github.com/sagemath/sagetrac-mirror/commit/05c06e24e3acb0b187cd541026ff2abf38d86064)** to **[`46ee8be`](https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67)**",
    "created_at": "2019-07-16T17:28:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438823",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`05c06e2`](https://github.com/sagemath/sagetrac-mirror/commit/05c06e24e3acb0b187cd541026ff2abf38d86064)** to **[`46ee8be`](https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67)**



---

archive/issue_comments_438824.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nWith the latest commit, we have this:\n- If the user exports `MTXLIB` and then installs `meataxe`, then the folder `$MTXLIB` will be created; otherwise a default location is chosen and the folder created.\n- If the user exports `MTXLIB` and then starts Sage, then sage.env.MTXLIB will be set accordingly; otherwise, a default location is used.\n- Sage will define the `extern char*` variable `MtxLibDir` to comply with sage.env.MTXLIB when sage.meataxe is first imported. That variable is all what we need in sage.matrix.matrix_gfpn_dense.\n- If someone wants to use meataxe applications, then it is not Sage's responsibility to export MTXLIB.\n\nI tested that `sage -f -c meataxe` works and `sage -t src/sage/matrix/matrix_gfpn_dense.pyx` works without error. So, needs review! And I guess it should be verified that meataxe now works in CoCalC.",
    "created_at": "2019-07-16T17:38:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438824",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:62" align="right">comment:62</div>

With the latest commit, we have this:
- If the user exports `MTXLIB` and then installs `meataxe`, then the folder `$MTXLIB` will be created; otherwise a default location is chosen and the folder created.
- If the user exports `MTXLIB` and then starts Sage, then sage.env.MTXLIB will be set accordingly; otherwise, a default location is used.
- Sage will define the `extern char*` variable `MtxLibDir` to comply with sage.env.MTXLIB when sage.meataxe is first imported. That variable is all what we need in sage.matrix.matrix_gfpn_dense.
- If someone wants to use meataxe applications, then it is not Sage's responsibility to export MTXLIB.

I tested that `sage -f -c meataxe` works and `sage -t src/sage/matrix/matrix_gfpn_dense.pyx` works without error. So, needs review! And I guess it should be verified that meataxe now works in CoCalC.



---

archive/issue_comments_438825.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nFirst of all, it would be good to update the ticket description with the problem that this ticket is trying to solve (I didn't follow all comments in this ticket). After all, it's difficult to review a solution when you don't know what problem it is meant to solve.\n\nSecond, why are you not defining `MTXLIB` in `src/bin/sage-env` like other similar environment variables? Then you can just refer to `$MTXLIB` unconditionally in your scripts.",
    "created_at": "2019-07-17T09:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438825",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">comment:63</div>

First of all, it would be good to update the ticket description with the problem that this ticket is trying to solve (I didn't follow all comments in this ticket). After all, it's difficult to review a solution when you don't know what problem it is meant to solve.

Second, why are you not defining `MTXLIB` in `src/bin/sage-env` like other similar environment variables? Then you can just refer to `$MTXLIB` unconditionally in your scripts.



---

archive/issue_comments_438826.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n+Currently, the finite fields arithmetic tables for Meataxe are generated on the fly and stored in `$HOME/.sage/`.\n+\n It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables cannot be found.\n \n This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork.\n+\n+Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory, rather than per user. This adds 9Mb to the space taken on the disk.\n``````\n",
    "created_at": "2019-07-17T10:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438826",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
+Currently, the finite fields arithmetic tables for Meataxe are generated on the fly and stored in `$HOME/.sage/`.
+
 It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables cannot be found.
 
 This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork.
+
+Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory, rather than per user. This adds 9Mb to the space taken on the disk.
``````




---

archive/issue_comments_438827.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork.\n \n-Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory, rather than per user. This adds 9Mb to the space taken on the disk.\n+Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk.\n``````\n",
    "created_at": "2019-07-17T10:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438827",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork.
 
-Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory, rather than per user. This adds 9Mb to the space taken on the disk.
+Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk.
``````




---

archive/issue_comments_438828.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n Currently, the finite fields arithmetic tables for Meataxe are generated on the fly and stored in `$HOME/.sage/`.\n \n-It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables cannot be found.\n+It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.\n \n-This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork.\n+This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork, but in fact the solution proposed in this ticket doesn't change the upstream tarball.\n \n-Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk.\n+Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk **once**, rather than up to 9Mb per user.\n``````\n",
    "created_at": "2019-07-17T10:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438828",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 Currently, the finite fields arithmetic tables for Meataxe are generated on the fly and stored in `$HOME/.sage/`.
 
-It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables cannot be found.
+It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.
 
-This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork.
+This ticket is to solve that problem. Sage uses a fork of MeatAxe anyway (called SharedMeatAxe) maintained by Simon King, and so one potential solution is to fix it in the fork, but in fact the solution proposed in this ticket doesn't change the upstream tarball.
 
-Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk.
+Namely, with this branch, the tables in question are generated at installation time and stored in the Sage ext directory (`$SAGE_SHARE/meataxe` to be precise), rather than per user. This adds 9Mb to the space taken on the disk **once**, rather than up to 9Mb per user.
``````




---

archive/issue_comments_438829.json:
```json
{
    "body": "Replying to [ticket:28188 SimonKing]:\n> It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.\n\nDo we know what these \"some situations\" are? I'm asking because, while I agree with the patch, I disagree with the patch *as fix for this problem*. Are we sure that whatever issue caused problems with `$DOT_SAGE` won't cause problems with `$MTXLIB` after this patch?",
    "created_at": "2019-07-17T10:18:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438829",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:28188 SimonKing]:
> It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.

Do we know what these "some situations" are? I'm asking because, while I agree with the patch, I disagree with the patch *as fix for this problem*. Are we sure that whatever issue caused problems with `$DOT_SAGE` won't cause problems with `$MTXLIB` after this patch?



---

archive/issue_comments_438830.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@jdemeyer](#comment%3A67):\n> Replying to [ticket:28188 SimonKing]:\n> > It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.\n\n> \n> Do we know what these \"some situations\" are? I'm asking because, while I agree with the patch, I disagree with the patch *as fix for this problem*. Are we sure that whatever issue caused problems with `$DOT_SAGE` won't cause problems with `$MTXLIB` after this patch?\n\n\"some situations\" arise on CoCalc. In general, the less stuff goes to `$DOT_SAGE`, the better, so this is an overall improvement.",
    "created_at": "2019-07-17T10:22:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438830",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@jdemeyer](#comment%3A67):
> Replying to [ticket:28188 SimonKing]:
> > It was [reported](https://groups.google.com/forum/#!topic/sage-support/zWOWtjha-H0) that in some situations using the MeatAxe backend for matrices over finite fields won't work because the arithmetic tables can neither be found nor created.

> 
> Do we know what these "some situations" are? I'm asking because, while I agree with the patch, I disagree with the patch *as fix for this problem*. Are we sure that whatever issue caused problems with `$DOT_SAGE` won't cause problems with `$MTXLIB` after this patch?

"some situations" arise on CoCalc. In general, the less stuff goes to `$DOT_SAGE`, the better, so this is an overall improvement.



---

archive/issue_comments_438831.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nI'd keep `export MTXLIB=\"$SAGE_SHARE/meataxe\"` in `src/bin/sage-env`, as I gather it's needed for running `meataxe` at Sage's shell prompt. No need to break (or not to introduce) this capability with this patch.",
    "created_at": "2019-07-17T10:30:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438831",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:69" align="right">comment:69</div>

I'd keep `export MTXLIB="$SAGE_SHARE/meataxe"` in `src/bin/sage-env`, as I gather it's needed for running `meataxe` at Sage's shell prompt. No need to break (or not to introduce) this capability with this patch.



---

archive/issue_comments_438832.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@dimpase](#comment%3A69):\n> I'd keep `export MTXLIB=\"$SAGE_SHARE/meataxe\"` in `src/bin/sage-env`\n\nWhat do you mean with \"keep\"? It's not there and this branch doesn't add it.",
    "created_at": "2019-07-17T10:36:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438832",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@dimpase](#comment%3A69):
> I'd keep `export MTXLIB="$SAGE_SHARE/meataxe"` in `src/bin/sage-env`

What do you mean with "keep"? It's not there and this branch doesn't add it.



---

archive/issue_comments_438833.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@dimpase](#comment%3A68):\n> In general, the less stuff goes to `$DOT_SAGE`, the better, so this is an overall improvement.\n\nSure, I'm not denying that. Like I said, I agree with the patch itself, but not as fix for this issue.",
    "created_at": "2019-07-17T10:38:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438833",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@dimpase](#comment%3A68):
> In general, the less stuff goes to `$DOT_SAGE`, the better, so this is an overall improvement.

Sure, I'm not denying that. Like I said, I agree with the patch itself, but not as fix for this issue.



---

archive/issue_comments_438834.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@jdemeyer](#comment%3A71):\n> Replying to [@dimpase](#comment%3A68):\n> > In general, the less stuff goes to `$DOT_SAGE`, the better, so this is an overall improvement.\n\n> \n> Sure, I'm not denying that. Like I said, I agree with the patch itself, but not as fix for this issue.\n\nAs mentioned in the ticket description, this ticket is motivated by a report on sage-support, stating that on CoCalc matrices with meataxe as backend don't work. So, certainly it would be good if someone could test on CoCalc (whatever that is).",
    "created_at": "2019-07-17T10:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438834",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@jdemeyer](#comment%3A71):
> Replying to [@dimpase](#comment%3A68):
> > In general, the less stuff goes to `$DOT_SAGE`, the better, so this is an overall improvement.

> 
> Sure, I'm not denying that. Like I said, I agree with the patch itself, but not as fix for this issue.

As mentioned in the ticket description, this ticket is motivated by a report on sage-support, stating that on CoCalc matrices with meataxe as backend don't work. So, certainly it would be good if someone could test on CoCalc (whatever that is).



---

archive/issue_comments_438835.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nThe \"issue\" is CoCalc-specific. It has to to with accessing `$DOTSAGE`. Removing this access, as this patch does, should fix it.\n\nThe only way to test that the latter is indeed the case is on CoCalc, by someone who can modify their default Sage. (Perhaps there are other ways, on a local/sanboxed installation of CoCalc, no idea.) I cc William, Hal, and Harald, in case.",
    "created_at": "2019-07-17T10:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438835",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:73" align="right">comment:73</div>

The "issue" is CoCalc-specific. It has to to with accessing `$DOTSAGE`. Removing this access, as this patch does, should fix it.

The only way to test that the latter is indeed the case is on CoCalc, by someone who can modify their default Sage. (Perhaps there are other ways, on a local/sanboxed installation of CoCalc, no idea.) I cc William, Hal, and Harald, in case.



---

archive/issue_comments_438836.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@jdemeyer](#comment%3A70):\n> Replying to [@dimpase](#comment%3A69):\n> > I'd keep `export MTXLIB=\"$SAGE_SHARE/meataxe\"` in `src/bin/sage-env`\n\n> \n> What do you mean with \"keep\"? It's not there and this branch doesn't add it.\n\nThis very line is deleted in one of commits.",
    "created_at": "2019-07-17T10:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438836",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@jdemeyer](#comment%3A70):
> Replying to [@dimpase](#comment%3A69):
> > I'd keep `export MTXLIB="$SAGE_SHARE/meataxe"` in `src/bin/sage-env`

> 
> What do you mean with "keep"? It's not there and this branch doesn't add it.

This very line is deleted in one of commits.



---

archive/issue_comments_438837.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@jdemeyer](#comment%3A70):\n> Replying to [@dimpase](#comment%3A69):\n> > I'd keep `export MTXLIB=\"$SAGE_SHARE/meataxe\"` in `src/bin/sage-env`\n\n> \n> What do you mean with \"keep\"? It's not there and this branch doesn't add it.\n\nI guess it is \"keep\" in the sense of \"one early commit adds it, so, why did a later commit remove it?\".\n\nMy rationale for not adding \"environmental pollution\" (i.e., adding the `MTXLIB` environment variable) is as follows: Even with the optional meataxe spkg installed, Sage will not call any meataxe standalone programs. But perhaps a user wants to use the meataxe standalone programs? So, we should allow the user to specify `MTXLIB` in a way that is convenient to her. The current proposition is: If the user specifies `MTXLIB` then Sage will use this specification.",
    "created_at": "2019-07-17T10:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438837",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@jdemeyer](#comment%3A70):
> Replying to [@dimpase](#comment%3A69):
> > I'd keep `export MTXLIB="$SAGE_SHARE/meataxe"` in `src/bin/sage-env`

> 
> What do you mean with "keep"? It's not there and this branch doesn't add it.

I guess it is "keep" in the sense of "one early commit adds it, so, why did a later commit remove it?".

My rationale for not adding "environmental pollution" (i.e., adding the `MTXLIB` environment variable) is as follows: Even with the optional meataxe spkg installed, Sage will not call any meataxe standalone programs. But perhaps a user wants to use the meataxe standalone programs? So, we should allow the user to specify `MTXLIB` in a way that is convenient to her. The current proposition is: If the user specifies `MTXLIB` then Sage will use this specification.



---

archive/issue_comments_438838.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nFor whatever reason, the people added in Cc by Dima got removed by my previous comment. Sorry.",
    "created_at": "2019-07-17T10:53:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438838",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:76" align="right">comment:76</div>

For whatever reason, the people added in Cc by Dima got removed by my previous comment. Sorry.



---

archive/issue_comments_438839.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nthat's cause we try to modify the ticket more or less at the same time, this leads to such deletions etc often (there are apparently ways around it, I don't quite know).",
    "created_at": "2019-07-17T10:54:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438839",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:77" align="right">comment:77</div>

that's cause we try to modify the ticket more or less at the same time, this leads to such deletions etc often (there are apparently ways around it, I don't quite know).



---

archive/issue_comments_438840.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\n(I don't think it matters: I think that once you cc someone, they are forever cc'ed on the ticket, and I don't think there is any way for them to be removed.)",
    "created_at": "2019-07-17T17:32:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438840",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:78" align="right">comment:78</div>

(I don't think it matters: I think that once you cc someone, they are forever cc'ed on the ticket, and I don't think there is any way for them to be removed.)



---

archive/issue_comments_438841.json:
```json
{
    "body": "Changed keywords from **meataxe** to **meataxe days100**",
    "created_at": "2019-07-19T21:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438841",
    "user": "https://github.com/simon-king-jena"
}
```

Changed keywords from **meataxe** to **meataxe days100**



---

archive/issue_comments_438842.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nNot even started and we have already 4 tickets :-) These are great Sage days!\n\nEDIT: five",
    "created_at": "2019-07-19T21:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438842",
    "user": "https://github.com/videlec"
}
```

<div id="comment:80" align="right">comment:80</div>

Not even started and we have already 4 tickets :-) These are great Sage days!

EDIT: five



---

archive/issue_comments_438843.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nI just tested what was happening in cocalc.\n\nApparently the DOT_SAGE folder does not contain a sub-folder `meataxe`. When MeatAxe tries to write tables into the non-existing folder, it just crashes instead of creating it. After I created `$DOT_SAGE/meataxe` manually, things worked.\n\nThe stupid thing was that during package installation I created `$DOT_SAGE/meataxe`, which of course doesn't work as soon as one has more than a single user for one Sage installation. Very stupid. VERY.\n\nSo, the potential fixes are:\n1. Change the upstream SharedMeatAxe tarball so that it creates the folder `$MTX_LIB` when needed.\n2. Change sage.libs.meataxe so that `import sage.libs.meataxe` creates the folder when needed.\n3. Install all tables in a folder that exists during package installation and can be read by all users. That's what I suggest in the current branch.\n\nWhich of these solutions do you prefer?\n\nI prefer 3., because it installs all tables once (spending a well-defined amount of disk space), rather than letting each user created his or her own tables (spending a potentially unlimited amount of disk space)",
    "created_at": "2019-07-24T15:08:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438843",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:81" align="right">comment:81</div>

I just tested what was happening in cocalc.

Apparently the DOT_SAGE folder does not contain a sub-folder `meataxe`. When MeatAxe tries to write tables into the non-existing folder, it just crashes instead of creating it. After I created `$DOT_SAGE/meataxe` manually, things worked.

The stupid thing was that during package installation I created `$DOT_SAGE/meataxe`, which of course doesn't work as soon as one has more than a single user for one Sage installation. Very stupid. VERY.

So, the potential fixes are:
1. Change the upstream SharedMeatAxe tarball so that it creates the folder `$MTX_LIB` when needed.
2. Change sage.libs.meataxe so that `import sage.libs.meataxe` creates the folder when needed.
3. Install all tables in a folder that exists during package installation and can be read by all users. That's what I suggest in the current branch.

Which of these solutions do you prefer?

I prefer 3., because it installs all tables once (spending a well-defined amount of disk space), rather than letting each user created his or her own tables (spending a potentially unlimited amount of disk space)



---

archive/issue_comments_438844.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nI am very much in favour of 3., as well.",
    "created_at": "2019-07-24T15:15:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438844",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:82" align="right">comment:82</div>

I am very much in favour of 3., as well.



---

archive/issue_events_383655.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-07-24T15:17:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383655"
}
```



---

archive/issue_events_383656.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-07-24T15:17:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383656"
}
```



---

archive/issue_comments_438845.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2019-07-24T15:17:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438845",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_383657.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-29T21:54:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383657"
}
```



---

archive/issue_events_383658.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "034d7f8beccc371839eeae9497976f44f3f38f28",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-07-29T21:54:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28188#event-383658"
}
```



---

archive/issue_comments_438846.json:
```json
{
    "body": "Changed branch from **[u/SimonKing/meataxe_arithmetic_tables](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/meataxe_arithmetic_tables)** to **[`46ee8be`](https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67)**",
    "created_at": "2019-07-29T21:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28188#issuecomment-438846",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/SimonKing/meataxe_arithmetic_tables](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/meataxe_arithmetic_tables)** to **[`46ee8be`](https://github.com/sagemath/sagetrac-mirror/commit/46ee8be53006ce890a846a9d84df5a72bb47fa67)**
