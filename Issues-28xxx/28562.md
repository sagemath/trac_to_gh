# Issue 28562: Tensor Fields: Better Zero Treatment

archive/issues_028325.json:
```json
{
    "assignees": [],
    "body": "The zero element is always a special element. Therefore it should be treated as such. It should shorten computations and certainly be immutable. This ticket is devoted to that topic. (Similarly for the one element in the scalar field and mixed form algebra).\n\nThis ticket is part of the metaticket #28519.\n\n**Features**\n\n- an assertion error arises when altering the fixed elements zero or one\n- a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)\n- computations with involved zero or one are shortened by using a simple check\n- due to immutability of algebra elements, no copies are returned anymore for scalar field operations with zero or one\n- `_is_zero` attribute is applied for copies\n\nCC:  @tscrim @egourgoulhon\n\nKeywords: **manifolds, tensor fields, scalar fields, mixed forms**\n\nBranch/Commit: **[f2928f8](https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d)**\n\nReviewer: **Eric Gourgoulhon, Travis Scrimshaw**\n\nAuthor: **Michael Jung**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28562_\n\n",
    "closed_at": "2019-10-26T22:20:26Z",
    "created_at": "2019-10-06T09:59:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Tensor Fields: Better Zero Treatment",
    "type": "issue",
    "updated_at": "2019-10-26T22:20:26Z",
    "url": "https://github.com/sagemath/sage/issues/28562",
    "user": "https://github.com/DeRhamSource"
}
```
The zero element is always a special element. Therefore it should be treated as such. It should shorten computations and certainly be immutable. This ticket is devoted to that topic. (Similarly for the one element in the scalar field and mixed form algebra).

This ticket is part of the metaticket #28519.

**Features**

- an assertion error arises when altering the fixed elements zero or one
- a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)
- computations with involved zero or one are shortened by using a simple check
- due to immutability of algebra elements, no copies are returned anymore for scalar field operations with zero or one
- `_is_zero` attribute is applied for copies

CC:  @tscrim @egourgoulhon

Keywords: **manifolds, tensor fields, scalar fields, mixed forms**

Branch/Commit: **[f2928f8](https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d)**

Reviewer: **Eric Gourgoulhon, Travis Scrimshaw**

Author: **Michael Jung**

_Issue created by migration from https://trac.sagemath.org/ticket/28562_





---

archive/issue_events_360747.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-06T09:59:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360747"
}
```



---

archive/issue_events_360748.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-06T09:59:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360748"
}
```



---

archive/issue_events_360749.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-06T09:59:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360749"
}
```



---

archive/issue_comments_448208.json:
```json
{
    "body": "Branch: **[u/gh-DeRhamSource/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment)**",
    "created_at": "2019-10-06T10:00:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448208",
    "user": "https://github.com/DeRhamSource"
}
```

Branch: **[u/gh-DeRhamSource/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment)**



---

archive/issue_comments_448209.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n The zero element is always a special element. Therefore it should be treated as such. It should shorten computations and certainly be immutable. This ticket is devoted to that topic. (Similarly for the one element in the scalar field and mixed form algebra).\n \n This ticket is part of the metaticket #28519.\n+\n+**Features**\n+\n+- an assertion error arises when altering the fixed elements zero or one\n+- a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)\n+- computations with involved zero or one are shortened by using a simple check\n``````\n",
    "created_at": "2019-10-06T10:02:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448209",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
 The zero element is always a special element. Therefore it should be treated as such. It should shorten computations and certainly be immutable. This ticket is devoted to that topic. (Similarly for the one element in the scalar field and mixed form algebra).
 
 This ticket is part of the metaticket #28519.
+
+**Features**
+
+- an assertion error arises when altering the fixed elements zero or one
+- a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)
+- computations with involved zero or one are shortened by using a simple check
``````




---

archive/issue_comments_448210.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d\">9f91503</a></td><td><code>'_is_zero' attribute added and modified</code></td></tr></table>\n",
    "created_at": "2019-10-06T10:02:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448210",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:2'>Comment 2:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d">9f91503</a></td><td><code>'_is_zero' attribute added and modified</code></td></tr></table>




---

archive/issue_comments_448211.json:
```json
{
    "body": "Commit: **[9f91503](https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d)**",
    "created_at": "2019-10-06T10:02:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448211",
    "user": "https://github.com/DeRhamSource"
}
```

Commit: **[9f91503](https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d)**



---

archive/issue_comments_448212.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8\">5094a3e</a></td><td><code>Return no copies for scalar field operations</code></td></tr></table>\n",
    "created_at": "2019-10-06T12:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448212",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>Comment 3:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8">5094a3e</a></td><td><code>Return no copies for scalar field operations</code></td></tr></table>




---

archive/issue_comments_448213.json:
```json
{
    "body": "Changed commit from **[9f91503](https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d)** to **[5094a3e](https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8)**",
    "created_at": "2019-10-06T12:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448213",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9f91503](https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d)** to **[5094a3e](https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8)**



---

archive/issue_comments_448214.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,4 @@\n - an assertion error arises when altering the fixed elements zero or one\n - a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)\n - computations with involved zero or one are shortened by using a simple check\n+- due to immutability of algebra elements, no copies are returned anymore for scalar field operations\n``````\n",
    "created_at": "2019-10-06T12:04:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448214",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,4 @@
 - an assertion error arises when altering the fixed elements zero or one
 - a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)
 - computations with involved zero or one are shortened by using a simple check
+- due to immutability of algebra elements, no copies are returned anymore for scalar field operations
``````




---

archive/issue_comments_448215.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,3 +8,4 @@\n - a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)\n - computations with involved zero or one are shortened by using a simple check\n - due to immutability of algebra elements, no copies are returned anymore for scalar field operations\n+- `_is_zero` attribute is applied for copies\n``````\n",
    "created_at": "2019-10-06T12:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448215",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,3 +8,4 @@
 - a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)
 - computations with involved zero or one are shortened by using a simple check
 - due to immutability of algebra elements, no copies are returned anymore for scalar field operations
+- `_is_zero` attribute is applied for copies
``````




---

archive/issue_comments_448216.json:
```json
{
    "body": "Changed commit from **[5094a3e](https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8)** to **[94cf06a](https://github.com/sagemath/sagetrac-mirror/commit/94cf06ab1ab5d87fbc8efc73d2688ea1c8c91267)**",
    "created_at": "2019-10-07T19:10:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448216",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5094a3e](https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8)** to **[94cf06a](https://github.com/sagemath/sagetrac-mirror/commit/94cf06ab1ab5d87fbc8efc73d2688ea1c8c91267)**



---

archive/issue_comments_448217.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca8dd881ee670e5be137bcf59af046097ffee677\">ca8dd88</a></td><td><code>Modules modified</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/892050ec841202b0348565d142ce485e237a38bc\">892050e</a></td><td><code>FreeModuleLinearGroup: one treatment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b965873b42681feac09569dba3305534f7939c9\">1b96587</a></td><td><code>Zero treatment for FreeModules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9c82876013b968e37b258bb089982351a261194\">b9c8287</a></td><td><code>AutomorphismField: zero treatment + MixedForm: set_restriction and add_comp_by_continuation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94cf06ab1ab5d87fbc8efc73d2688ea1c8c91267\">94cf06a</a></td><td><code>Mixed forms adapted to zero treatment + zero treatment for scalar fields</code></td></tr></table>\n",
    "created_at": "2019-10-07T19:10:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448217",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca8dd881ee670e5be137bcf59af046097ffee677">ca8dd88</a></td><td><code>Modules modified</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/892050ec841202b0348565d142ce485e237a38bc">892050e</a></td><td><code>FreeModuleLinearGroup: one treatment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b965873b42681feac09569dba3305534f7939c9">1b96587</a></td><td><code>Zero treatment for FreeModules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9c82876013b968e37b258bb089982351a261194">b9c8287</a></td><td><code>AutomorphismField: zero treatment + MixedForm: set_restriction and add_comp_by_continuation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94cf06ab1ab5d87fbc8efc73d2688ea1c8c91267">94cf06a</a></td><td><code>Mixed forms adapted to zero treatment + zero treatment for scalar fields</code></td></tr></table>




---

archive/issue_events_360750.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-07T19:12:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360750"
}
```



---

archive/issue_events_360751.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-07T19:12:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360751"
}
```



---

archive/issue_comments_448218.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nIn `MixedForm`, the zero (and one element for scalar fields) is treated separately. The code in there is not very beautiful, but it works for now. However, I plan to reorganize the code of mixed forms anyway (see #28519).",
    "created_at": "2019-10-07T19:16:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448218",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:8'>Comment 8:</a>
In `MixedForm`, the zero (and one element for scalar fields) is treated separately. The code in there is not very beautiful, but it works for now. However, I plan to reorganize the code of mixed forms anyway (see #28519).



---

archive/issue_comments_448219.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nAlso, I removed the `_zero_element` attribute in the free modules and replaced it by a cached `zero()` method. This is a better solution, I guess.",
    "created_at": "2019-10-07T19:18:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448219",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:9'>Comment 9:</a>
Also, I removed the `_zero_element` attribute in the free modules and replaced it by a cached `zero()` method. This is a better solution, I guess.



---

archive/issue_comments_448220.json:
```json
{
    "body": "Changed commit from **[94cf06a](https://github.com/sagemath/sagetrac-mirror/commit/94cf06ab1ab5d87fbc8efc73d2688ea1c8c91267)** to **[d949a13](https://github.com/sagemath/sagetrac-mirror/commit/d949a13db29334e193ec9ff05fd7fe53deb65422)**",
    "created_at": "2019-10-07T20:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448220",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[94cf06a](https://github.com/sagemath/sagetrac-mirror/commit/94cf06ab1ab5d87fbc8efc73d2688ea1c8c91267)** to **[d949a13](https://github.com/sagemath/sagetrac-mirror/commit/d949a13db29334e193ec9ff05fd7fe53deb65422)**



---

archive/issue_comments_448221.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d949a13db29334e193ec9ff05fd7fe53deb65422\">d949a13</a></td><td><code>Minor code reduction</code></td></tr></table>\n",
    "created_at": "2019-10-07T20:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448221",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d949a13db29334e193ec9ff05fd7fe53deb65422">d949a13</a></td><td><code>Minor code reduction</code></td></tr></table>




---

archive/issue_comments_448222.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d30100a5f1e4f809867dc5b564000cd2eddc9db\">5d30100</a></td><td><code>More code reduction</code></td></tr></table>\n",
    "created_at": "2019-10-07T20:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448222",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d30100a5f1e4f809867dc5b564000cd2eddc9db">5d30100</a></td><td><code>More code reduction</code></td></tr></table>




---

archive/issue_comments_448223.json:
```json
{
    "body": "Changed commit from **[d949a13](https://github.com/sagemath/sagetrac-mirror/commit/d949a13db29334e193ec9ff05fd7fe53deb65422)** to **[5d30100](https://github.com/sagemath/sagetrac-mirror/commit/5d30100a5f1e4f809867dc5b564000cd2eddc9db)**",
    "created_at": "2019-10-07T20:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448223",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d949a13](https://github.com/sagemath/sagetrac-mirror/commit/d949a13db29334e193ec9ff05fd7fe53deb65422)** to **[5d30100](https://github.com/sagemath/sagetrac-mirror/commit/5d30100a5f1e4f809867dc5b564000cd2eddc9db)**



---

archive/issue_comments_448224.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nThe code snippet (see commits 5d30100 and \u200bd949a13) was quite messy. Well, it still is. At least it is readable and works for now. It gets a little bit better after merging (see #28519).\n\nI will think about a better solution. But I guess, this requires a complete reorganization of the mixed form code.",
    "created_at": "2019-10-07T20:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448224",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:12'>Comment 12:</a>
The code snippet (see commits 5d30100 and â€‹d949a13) was quite messy. Well, it still is. At least it is readable and works for now. It gets a little bit better after merging (see #28519).

I will think about a better solution. But I guess, this requires a complete reorganization of the mixed form code.



---

archive/issue_comments_448225.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nAfter a bit of thinking, I came to the conclusion that the code snippet should be obsolete. (As a mathematician, I feel the urge to solve or fix a problem/error as soon as it occurs. Here: Doctest errors.) The thing is, due to our little discussion in #28519, the doctest must be flawed since mixed forms defined via preconstructed forms get altered.\n\nSo, I 'm going to delete this snippet again and modify the affected doctests.\n\nDo you agree with my conclusion and procedure?\n\nA further doctest change is devoted to #28578.",
    "created_at": "2019-10-08T23:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448225",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:13'>Comment 13:</a>
After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. (As a mathematician, I feel the urge to solve or fix a problem/error as soon as it occurs. Here: Doctest errors.) The thing is, due to our little discussion in #28519, the doctest must be flawed since mixed forms defined via preconstructed forms get altered.

So, I 'm going to delete this snippet again and modify the affected doctests.

Do you agree with my conclusion and procedure?

A further doctest change is devoted to #28578.



---

archive/issue_events_360752.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-08T23:11:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360752"
}
```



---

archive/issue_events_360753.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-08T23:11:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360753"
}
```



---

archive/issue_comments_448226.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n - an assertion error arises when altering the fixed elements zero or one\n - a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)\n - computations with involved zero or one are shortened by using a simple check\n-- due to immutability of algebra elements, no copies are returned anymore for scalar field operations\n+- due to immutability of algebra elements, no copies are returned anymore for scalar field operations with zero or one\n - `_is_zero` attribute is applied for copies\n``````\n",
    "created_at": "2019-10-09T07:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448226",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 - an assertion error arises when altering the fixed elements zero or one
 - a new attribute `_is_zero` is added to tensor fields and mixed form (similar to scalar fields)
 - computations with involved zero or one are shortened by using a simple check
-- due to immutability of algebra elements, no copies are returned anymore for scalar field operations
+- due to immutability of algebra elements, no copies are returned anymore for scalar field operations with zero or one
 - `_is_zero` attribute is applied for copies
``````




---

archive/issue_comments_448227.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@DeRhamSource](#comment%3A13):\n> After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. \n\nWhich code snippet are you talking about? All the code in this ticket branch?",
    "created_at": "2019-10-09T08:45:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448227",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@DeRhamSource](#comment%3A13):
> After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. 

Which code snippet are you talking about? All the code in this ticket branch?



---

archive/issue_comments_448228.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@egourgoulhon](#comment%3A15):\n> Replying to [@DeRhamSource](#comment%3A13):\n> > After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. \n\n> \n> Which code snippet are you talking about? All the code in this ticket branch?\n> \n\nNo, only the last two/three commits. Namely the changes in `set_restriction` of `mixed_form.py`.",
    "created_at": "2019-10-09T08:53:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448228",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@egourgoulhon](#comment%3A15):
> Replying to [@DeRhamSource](#comment%3A13):
> > After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. 

> 
> Which code snippet are you talking about? All the code in this ticket branch?
> 

No, only the last two/three commits. Namely the changes in `set_restriction` of `mixed_form.py`.



---

archive/issue_comments_448229.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [@DeRhamSource](#comment%3A13):\n> After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. (As a mathematician, I feel the urge to solve or fix a problem/error as soon as it occurs. Here: Doctest errors.) The thing is, due to our little discussion in #28519, the doctest must be flawed since mixed forms defined via preconstructed forms get altered.\n> \n> So, I 'm going to delete this snippet again and modify the affected doctests.\n> \n> Do you agree with my conclusion and procedure?\n\nI am not sure to understand what you have in mind; I would say please go on and implement what you think is the best solution.",
    "created_at": "2019-10-09T13:13:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448229",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [@DeRhamSource](#comment%3A13):
> After a bit of thinking, I came to the conclusion that the code snippet should be obsolete. (As a mathematician, I feel the urge to solve or fix a problem/error as soon as it occurs. Here: Doctest errors.) The thing is, due to our little discussion in #28519, the doctest must be flawed since mixed forms defined via preconstructed forms get altered.
> 
> So, I 'm going to delete this snippet again and modify the affected doctests.
> 
> Do you agree with my conclusion and procedure?

I am not sure to understand what you have in mind; I would say please go on and implement what you think is the best solution.



---

archive/issue_comments_448230.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\n\n```\nsage: M = Manifold(2, 'M') # the 2-dimensional sphere S^2\nsage: U = M.open_subset('U') # complement of the North pole\nsage: c_xy.<x,y> = U.chart() # stereographic coordinates from the North pole\nsage: V = M.open_subset('V') # complement of the South pole\nsage: c_uv.<u,v> = V.chart() # stereographic coordinates from the South pole\nsage: M.declare_union(U,V)   # S^2 is the union of U and V\nsage: xy_to_uv = c_xy.transition_map(c_uv, (x/(x^2+y^2), y/(x^2+y^2)),\n....:                intersection_name='W', restrictions1= x^2+y^2!=0,\n....:                restrictions2= u^2+v^2!=0)\nsage: uv_to_xy = xy_to_uv.inverse()\nsage: e_xy = c_xy.frame(); e_uv = c_uv.frame()\nsage: f = M.scalar_field(x, name='f')\nsage: omega = M.diff_form(1, name='omega')\nsage: omega[e_xy,0] = x\nsage: F = M.mixed_form(name='F', comp=[f, omega, 0])\nsage: F.add_comp_by_continuation(e_xy, U.intersection(V), c_xy)\nsage: F.add_comp_by_continuation(e_uv, U.intersection(V), c_uv)\n```\n\nThis is an example of how I used `add_comp_by_continuation` in the doctest. Obviously, this is a *bad* example. To ensure the \"immutability\" of mixed forms, the `comp` attribute should be used for already fully defined differential forms only. Whenever a incremental definition is explicitly wanted, `F[1][e_xy,0] = x` or `F[1] = M.one_form({e_xy: [x,0]}, name='omega')` should be used instead, and **then** `add_comp_by_continuation` is reasonable to use.\n\nAt least, that is my suggestion of how to use mixed forms.\n\nTravis? Would you agree?",
    "created_at": "2019-10-10T14:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448230",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:18'>Comment 18:</a>

```
sage: M = Manifold(2, 'M') # the 2-dimensional sphere S^2
sage: U = M.open_subset('U') # complement of the North pole
sage: c_xy.<x,y> = U.chart() # stereographic coordinates from the North pole
sage: V = M.open_subset('V') # complement of the South pole
sage: c_uv.<u,v> = V.chart() # stereographic coordinates from the South pole
sage: M.declare_union(U,V)   # S^2 is the union of U and V
sage: xy_to_uv = c_xy.transition_map(c_uv, (x/(x^2+y^2), y/(x^2+y^2)),
....:                intersection_name='W', restrictions1= x^2+y^2!=0,
....:                restrictions2= u^2+v^2!=0)
sage: uv_to_xy = xy_to_uv.inverse()
sage: e_xy = c_xy.frame(); e_uv = c_uv.frame()
sage: f = M.scalar_field(x, name='f')
sage: omega = M.diff_form(1, name='omega')
sage: omega[e_xy,0] = x
sage: F = M.mixed_form(name='F', comp=[f, omega, 0])
sage: F.add_comp_by_continuation(e_xy, U.intersection(V), c_xy)
sage: F.add_comp_by_continuation(e_uv, U.intersection(V), c_uv)
```

This is an example of how I used `add_comp_by_continuation` in the doctest. Obviously, this is a *bad* example. To ensure the "immutability" of mixed forms, the `comp` attribute should be used for already fully defined differential forms only. Whenever a incremental definition is explicitly wanted, `F[1][e_xy,0] = x` or `F[1] = M.one_form({e_xy: [x,0]}, name='omega')` should be used instead, and **then** `add_comp_by_continuation` is reasonable to use.

At least, that is my suggestion of how to use mixed forms.

Travis? Would you agree?



---

archive/issue_comments_448231.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nI am not sure I completely understand the question, or the subtleties in the use case. So I don't think I can make a reasonable comment here.",
    "created_at": "2019-10-10T14:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448231",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'>Comment 19:</a>
I am not sure I completely understand the question, or the subtleties in the use case. So I don't think I can make a reasonable comment here.



---

archive/issue_comments_448232.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nMh. Sorry for that. I try again: The thing in the example above is that the zero element gets manipulated via `add_comp_by_continuation`, or `set_restriction` respectively. This indicates, the whole example (even if there is no zero element involved) is a bad use of this methods.\n\nBetter would be:\n\n\n```\nsage: M = Manifold(2, 'M') # the 2-dimensional sphere S^2\nsage: U = M.open_subset('U') # complement of the North pole\nsage: c_xy.<x,y> = U.chart() # stereographic coordinates from the North pole\nsage: V = M.open_subset('V') # complement of the South pole\nsage: c_uv.<u,v> = V.chart() # stereographic coordinates from the South pole\nsage: M.declare_union(U,V)   # S^2 is the union of U and V\nsage: xy_to_uv = c_xy.transition_map(c_uv, (x/(x^2+y^2), y/(x^2+y^2)),\n....:                intersection_name='W', restrictions1= x^2+y^2!=0,\n....:                restrictions2= u^2+v^2!=0)\nsage: uv_to_xy = xy_to_uv.inverse()\nsage: e_xy = c_xy.frame(); e_uv = c_uv.frame()\nsage: f = M.scalar_field(x, name='f')\nsage: f.add_expr_by_continuation(c_uv, U.intersection(V))\nsage: omega = M.diff_form(1, name='omega')\nsage: omega[e_xy,0] = x\nsage: omega.add_comp_by_continuation(e_uv, U.intersection(V), c_uv)\nsage: F = M.mixed_form(name='F', comp=[f, omega, 0])\n```\n\nYet, I noticed that `add_comp_by_continuation` seems not being convenient at all. It runs into problems as soon as there is a homogeneous component defined which should not be altered or has no tensor component in the corresponding intersection domain. Therefore, if one single homogeneous component shall be zero, and all other components shall be continued, which is a reasonable use, this methods fails to fulfill its purpose.\n\nSorry, I'm not that much into that kind of thinking, especially the immutability of sage objects, and may confuse all around me including myself. :D",
    "created_at": "2019-10-10T15:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448232",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:20'>Comment 20:</a>
Mh. Sorry for that. I try again: The thing in the example above is that the zero element gets manipulated via `add_comp_by_continuation`, or `set_restriction` respectively. This indicates, the whole example (even if there is no zero element involved) is a bad use of this methods.

Better would be:


```
sage: M = Manifold(2, 'M') # the 2-dimensional sphere S^2
sage: U = M.open_subset('U') # complement of the North pole
sage: c_xy.<x,y> = U.chart() # stereographic coordinates from the North pole
sage: V = M.open_subset('V') # complement of the South pole
sage: c_uv.<u,v> = V.chart() # stereographic coordinates from the South pole
sage: M.declare_union(U,V)   # S^2 is the union of U and V
sage: xy_to_uv = c_xy.transition_map(c_uv, (x/(x^2+y^2), y/(x^2+y^2)),
....:                intersection_name='W', restrictions1= x^2+y^2!=0,
....:                restrictions2= u^2+v^2!=0)
sage: uv_to_xy = xy_to_uv.inverse()
sage: e_xy = c_xy.frame(); e_uv = c_uv.frame()
sage: f = M.scalar_field(x, name='f')
sage: f.add_expr_by_continuation(c_uv, U.intersection(V))
sage: omega = M.diff_form(1, name='omega')
sage: omega[e_xy,0] = x
sage: omega.add_comp_by_continuation(e_uv, U.intersection(V), c_uv)
sage: F = M.mixed_form(name='F', comp=[f, omega, 0])
```

Yet, I noticed that `add_comp_by_continuation` seems not being convenient at all. It runs into problems as soon as there is a homogeneous component defined which should not be altered or has no tensor component in the corresponding intersection domain. Therefore, if one single homogeneous component shall be zero, and all other components shall be continued, which is a reasonable use, this methods fails to fulfill its purpose.

Sorry, I'm not that much into that kind of thinking, especially the immutability of sage objects, and may confuse all around me including myself. :D



---

archive/issue_comments_448233.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f1169874af7db4200bb91544854bb9f90afc9fc\">3f11698</a></td><td><code>Continuations of zero and one untouched</code></td></tr></table>\n",
    "created_at": "2019-10-10T21:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448233",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'>Comment 21:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f1169874af7db4200bb91544854bb9f90afc9fc">3f11698</a></td><td><code>Continuations of zero and one untouched</code></td></tr></table>




---

archive/issue_comments_448234.json:
```json
{
    "body": "Changed commit from **[5d30100](https://github.com/sagemath/sagetrac-mirror/commit/5d30100a5f1e4f809867dc5b564000cd2eddc9db)** to **[3f11698](https://github.com/sagemath/sagetrac-mirror/commit/3f1169874af7db4200bb91544854bb9f90afc9fc)**",
    "created_at": "2019-10-10T21:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448234",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5d30100](https://github.com/sagemath/sagetrac-mirror/commit/5d30100a5f1e4f809867dc5b564000cd2eddc9db)** to **[3f11698](https://github.com/sagemath/sagetrac-mirror/commit/3f1169874af7db4200bb91544854bb9f90afc9fc)**



---

archive/issue_events_360754.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-10T21:23:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360754"
}
```



---

archive/issue_events_360755.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-10T21:23:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360755"
}
```



---

archive/issue_comments_448235.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nWhat about this?",
    "created_at": "2019-10-10T21:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448235",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:22'>Comment 22:</a>
What about this?



---

archive/issue_comments_448236.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nI guess it depends on how you define zero. Although if I think of this like a graded module, `0` exists in all graded parts simultaneously, so by analogy, the `add_comp_by_continuation` does work correctly. Although as a computer implementation that requires some more precision, this might not be feasible.",
    "created_at": "2019-10-11T01:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448236",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'>Comment 23:</a>
I guess it depends on how you define zero. Although if I think of this like a graded module, `0` exists in all graded parts simultaneously, so by analogy, the `add_comp_by_continuation` does work correctly. Although as a computer implementation that requires some more precision, this might not be feasible.



---

archive/issue_events_360756.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-11T07:15:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360756"
}
```



---

archive/issue_events_360757.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-11T07:15:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360757"
}
```



---

archive/issue_comments_448237.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nYes, you're absolutely right. So, seeing things more from the mathematical point of view is always the way to go, right?\n\nThe problem here is that `add_comp_by_continuation` invokes the `add_comp` method for tensor fields which raises an error when it is used by the zero element. To make it usable in this case, a separate treatment of zero must be implemented.",
    "created_at": "2019-10-11T07:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448237",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:24'>Comment 24:</a>
Yes, you're absolutely right. So, seeing things more from the mathematical point of view is always the way to go, right?

The problem here is that `add_comp_by_continuation` invokes the `add_comp` method for tensor fields which raises an error when it is used by the zero element. To make it usable in this case, a separate treatment of zero must be implemented.



---

archive/issue_comments_448238.json:
```json
{
    "body": "Changed commit from **[3f11698](https://github.com/sagemath/sagetrac-mirror/commit/3f1169874af7db4200bb91544854bb9f90afc9fc)** to none",
    "created_at": "2019-10-12T12:36:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448238",
    "user": "https://github.com/DeRhamSource"
}
```

Changed commit from **[3f11698](https://github.com/sagemath/sagetrac-mirror/commit/3f1169874af7db4200bb91544854bb9f90afc9fc)** to none



---

archive/issue_comments_448239.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nI started the whole thing again from scratch since `add_comp_by_continuation` did not work properly in a mathematical manner.\n\nMoreover, I (hopefully) improved the preexisting code.\n\nIn the commits, there are two alternatives presented: One using a flag `check_elements` and one using a separate method without security check. I'd prefer the second solution. It is completely hidden for the user and may become convenient when more checks are established in the future.",
    "created_at": "2019-10-12T12:36:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448239",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:25'>Comment 25:</a>
I started the whole thing again from scratch since `add_comp_by_continuation` did not work properly in a mathematical manner.

Moreover, I (hopefully) improved the preexisting code.

In the commits, there are two alternatives presented: One using a flag `check_elements` and one using a separate method without security check. I'd prefer the second solution. It is completely hidden for the user and may become convenient when more checks are established in the future.



---

archive/issue_events_360758.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-12T12:36:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360758"
}
```



---

archive/issue_events_360759.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2019-10-12T12:36:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360759"
}
```



---

archive/issue_comments_448240.json:
```json
{
    "body": "Changed branch from **[u/gh-DeRhamSource/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment)** to **[u/gh-DeRhamSource/better_zero_treatment_alternative](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment_alternative)**",
    "created_at": "2019-10-12T12:36:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448240",
    "user": "https://github.com/DeRhamSource"
}
```

Changed branch from **[u/gh-DeRhamSource/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment)** to **[u/gh-DeRhamSource/better_zero_treatment_alternative](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment_alternative)**



---

archive/issue_comments_448241.json:
```json
{
    "body": "Commit: **[2865535](https://github.com/sagemath/sagetrac-mirror/commit/286553516abfc2895b4136fda99ce7fff653ff4c)**",
    "created_at": "2019-10-12T12:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448241",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[2865535](https://github.com/sagemath/sagetrac-mirror/commit/286553516abfc2895b4136fda99ce7fff653ff4c)**



---

archive/issue_comments_448242.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d\">9f91503</a></td><td><code>'_is_zero' attribute added and modified</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8\">5094a3e</a></td><td><code>Return no copies for scalar field operations</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e016b21306e3e53c8eb4436d13c7e17a620ae033\">e016b21</a></td><td><code>Zero and one treatment for free tensor modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/371a25532a5501ef65dcbcef3f97d52fe3fa1fea\">371a255</a></td><td><code>Zero treatment for wedge product of free alt forms</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b1ee7f03982cdd3a9879ba5100d9e0e9c410a65\">1b1ee7f</a></td><td><code>Zero/One check added</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bcc7affe9924fc5fd1c10ff4363e6d05e025de5\">5bcc7af</a></td><td><code>Alternative solution via unsafe method</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/286553516abfc2895b4136fda99ce7fff653ff4c\">2865535</a></td><td><code>Obsolete '**kwargs' removed</code></td></tr></table>\n",
    "created_at": "2019-10-12T12:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448242",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>Comment 26:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f91503dce5cbe14f52a6a77a34ae5a18f722f7d">9f91503</a></td><td><code>'_is_zero' attribute added and modified</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5094a3e802034be5916879a0225e5db2ccf9f0f8">5094a3e</a></td><td><code>Return no copies for scalar field operations</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e016b21306e3e53c8eb4436d13c7e17a620ae033">e016b21</a></td><td><code>Zero and one treatment for free tensor modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/371a25532a5501ef65dcbcef3f97d52fe3fa1fea">371a255</a></td><td><code>Zero treatment for wedge product of free alt forms</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b1ee7f03982cdd3a9879ba5100d9e0e9c410a65">1b1ee7f</a></td><td><code>Zero/One check added</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bcc7affe9924fc5fd1c10ff4363e6d05e025de5">5bcc7af</a></td><td><code>Alternative solution via unsafe method</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/286553516abfc2895b4136fda99ce7fff653ff4c">2865535</a></td><td><code>Obsolete '**kwargs' removed</code></td></tr></table>




---

archive/issue_comments_448243.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nWhat I wanted to say with my previous message: I am not a professional programmer, however I had quite a few difficulties in modifying the code and perform a proper debugging. There are some code redundancies and hidden dependencies which could be susceptible for further modifications (like: a modification of `add_comp` in `tensorfield.py` caused severe troubles in `automorphismfield.py`). Perhaps, some code delegations and/or reusabilities are useful in the farther future?",
    "created_at": "2019-10-12T17:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448243",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:27'>Comment 27:</a>
What I wanted to say with my previous message: I am not a professional programmer, however I had quite a few difficulties in modifying the code and perform a proper debugging. There are some code redundancies and hidden dependencies which could be susceptible for further modifications (like: a modification of `add_comp` in `tensorfield.py` caused severe troubles in `automorphismfield.py`). Perhaps, some code delegations and/or reusabilities are useful in the farther future?



---

archive/issue_comments_448244.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c104fc844d8cd50446944d0cd1b177c369366653\">c104fc8</a></td><td><code>Scalar field zero treatment</code></td></tr></table>\n",
    "created_at": "2019-10-12T18:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448244",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>Comment 28:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c104fc844d8cd50446944d0cd1b177c369366653">c104fc8</a></td><td><code>Scalar field zero treatment</code></td></tr></table>




---

archive/issue_comments_448245.json:
```json
{
    "body": "Changed commit from **[2865535](https://github.com/sagemath/sagetrac-mirror/commit/286553516abfc2895b4136fda99ce7fff653ff4c)** to **[c104fc8](https://github.com/sagemath/sagetrac-mirror/commit/c104fc844d8cd50446944d0cd1b177c369366653)**",
    "created_at": "2019-10-12T18:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448245",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2865535](https://github.com/sagemath/sagetrac-mirror/commit/286553516abfc2895b4136fda99ce7fff653ff4c)** to **[c104fc8](https://github.com/sagemath/sagetrac-mirror/commit/c104fc844d8cd50446944d0cd1b177c369366653)**



---

archive/issue_comments_448246.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efd8e0390aa99ee7d8c667e3120df43ee624e59a\">efd8e03</a></td><td><code>Mixed form zero treatment</code></td></tr></table>\n",
    "created_at": "2019-10-12T19:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448246",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'>Comment 29:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efd8e0390aa99ee7d8c667e3120df43ee624e59a">efd8e03</a></td><td><code>Mixed form zero treatment</code></td></tr></table>




---

archive/issue_comments_448247.json:
```json
{
    "body": "Changed commit from **[c104fc8](https://github.com/sagemath/sagetrac-mirror/commit/c104fc844d8cd50446944d0cd1b177c369366653)** to **[efd8e03](https://github.com/sagemath/sagetrac-mirror/commit/efd8e0390aa99ee7d8c667e3120df43ee624e59a)**",
    "created_at": "2019-10-12T19:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448247",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c104fc8](https://github.com/sagemath/sagetrac-mirror/commit/c104fc844d8cd50446944d0cd1b177c369366653)** to **[efd8e03](https://github.com/sagemath/sagetrac-mirror/commit/efd8e0390aa99ee7d8c667e3120df43ee624e59a)**



---

archive/issue_comments_448248.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nI just gave a quick look at the latest version. Looks good. I'll have a deeper look tomorrow.",
    "created_at": "2019-10-13T21:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448248",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:30'>Comment 30:</a>
I just gave a quick look at the latest version. Looks good. I'll have a deeper look tomorrow.



---

archive/issue_comments_448249.json:
```json
{
    "body": "Changed commit from **[efd8e03](https://github.com/sagemath/sagetrac-mirror/commit/efd8e0390aa99ee7d8c667e3120df43ee624e59a)** to **[a91dba0](https://github.com/sagemath/sagetrac-mirror/commit/a91dba0f83f5bd003f339a834735ea99cd5a510d)**",
    "created_at": "2019-10-17T09:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448249",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[efd8e03](https://github.com/sagemath/sagetrac-mirror/commit/efd8e0390aa99ee7d8c667e3120df43ee624e59a)** to **[a91dba0](https://github.com/sagemath/sagetrac-mirror/commit/a91dba0f83f5bd003f339a834735ea99cd5a510d)**



---

archive/issue_comments_448250.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17e6ff6f7568408374fabcc99fa95e6831242e75\">17e6ff6</a></td><td><code>Merge branch 'develop' into t/28562/better_zero_treatment_alternative</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a91dba0f83f5bd003f339a834735ea99cd5a510d\">a91dba0</a></td><td><code>Zero if wedge result degree > dim</code></td></tr></table>\n",
    "created_at": "2019-10-17T09:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448250",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>Comment 31:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17e6ff6f7568408374fabcc99fa95e6831242e75">17e6ff6</a></td><td><code>Merge branch 'develop' into t/28562/better_zero_treatment_alternative</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a91dba0f83f5bd003f339a834735ea99cd5a510d">a91dba0</a></td><td><code>Zero if wedge result degree > dim</code></td></tr></table>




---

archive/issue_comments_448251.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nI've finally gone through the ticket. The impression stated in [comment:30](#comment%3A30) is confirmed: this is a nice improvement of the code! Thank you. I have made minor modifications, which have been pushed in the above branch. In particular \n- the pyflake error reported by the patchbot is corrected\n- `t(0)` has been changed to `t.zero()` and `gl(1)` to `gl.one()` (to skip one function call)\n- some `add/set_comp(basis)` have been changed to `add/set_comp(basis=basis)`\n- the treatment of zero has been added in `FreeModuleTensor._sub_()`\n\nDo you agree with these changes?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2783253621fa561b0b465ec8fccc30a799b72d88\">2783253</a></td><td><code>Minor changes in the zero and one treatment of tensor fields</code></td></tr></table>\n",
    "created_at": "2019-10-22T10:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448251",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:32'>Comment 32:</a>
I've finally gone through the ticket. The impression stated in [comment:30](#comment%3A30) is confirmed: this is a nice improvement of the code! Thank you. I have made minor modifications, which have been pushed in the above branch. In particular 
- the pyflake error reported by the patchbot is corrected
- `t(0)` has been changed to `t.zero()` and `gl(1)` to `gl.one()` (to skip one function call)
- some `add/set_comp(basis)` have been changed to `add/set_comp(basis=basis)`
- the treatment of zero has been added in `FreeModuleTensor._sub_()`

Do you agree with these changes?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2783253621fa561b0b465ec8fccc30a799b72d88">2783253</a></td><td><code>Minor changes in the zero and one treatment of tensor fields</code></td></tr></table>




---

archive/issue_comments_448252.json:
```json
{
    "body": "Changed commit from **[a91dba0](https://github.com/sagemath/sagetrac-mirror/commit/a91dba0f83f5bd003f339a834735ea99cd5a510d)** to **[2783253](https://github.com/sagemath/sagetrac-mirror/commit/2783253621fa561b0b465ec8fccc30a799b72d88)**",
    "created_at": "2019-10-22T10:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448252",
    "user": "https://github.com/egourgoulhon"
}
```

Changed commit from **[a91dba0](https://github.com/sagemath/sagetrac-mirror/commit/a91dba0f83f5bd003f339a834735ea99cd5a510d)** to **[2783253](https://github.com/sagemath/sagetrac-mirror/commit/2783253621fa561b0b465ec8fccc30a799b72d88)**



---

archive/issue_comments_448253.json:
```json
{
    "body": "Changed branch from **[u/gh-DeRhamSource/better_zero_treatment_alternative](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment_alternative)** to **[public/manifolds/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/better_zero_treatment)**",
    "created_at": "2019-10-22T10:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448253",
    "user": "https://github.com/egourgoulhon"
}
```

Changed branch from **[u/gh-DeRhamSource/better_zero_treatment_alternative](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-DeRhamSource/better_zero_treatment_alternative)** to **[public/manifolds/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/better_zero_treatment)**



---

archive/issue_comments_448254.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nYes, looks good! :)",
    "created_at": "2019-10-22T10:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448254",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:33'>Comment 33:</a>
Yes, looks good! :)



---

archive/issue_comments_448255.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nI just have two trivial changes:\n\n```diff\n-The components w.r.t. basis e have been kept::\n+The components with respect to basis ``e`` have been kept::\n```\nand in `automorphismfield.py`:\n\n```\n    def add_comp(self, basis=None):\n        r\"\"\"\n\n        Return the components of ``self`` w.r.t. a given module basis for\n        assignment, keeping the components w.r.t. other bases.\n\n        To delete the components w.r.t. other bases, use the method\n        :meth:`set_comp` instead.\n```\nremove the blank line after `r\"\"\"` and same thing of spelling out `w.r.t.` (although I suspect this is done elsewhere, I think it is better to avoid abbreviations like this as this is a more \"formal\" document, but I don't care too much).",
    "created_at": "2019-10-22T14:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448255",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'>Comment 34:</a>
I just have two trivial changes:

```diff
-The components w.r.t. basis e have been kept::
+The components with respect to basis ``e`` have been kept::
```
and in `automorphismfield.py`:

```
    def add_comp(self, basis=None):
        r"""

        Return the components of ``self`` w.r.t. a given module basis for
        assignment, keeping the components w.r.t. other bases.

        To delete the components w.r.t. other bases, use the method
        :meth:`set_comp` instead.
```
remove the blank line after `r"""` and same thing of spelling out `w.r.t.` (although I suspect this is done elsewhere, I think it is better to avoid abbreviations like this as this is a more "formal" document, but I don't care too much).



---

archive/issue_comments_448256.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nOn my side, one last remark: the names of the methods `_add_comp_unsafe()` and `_set_comp_unsafe()` give the impression that they are really dangerous methods that should be avoided, while they are key methods, doing most of the work of `add_comp()` and `set_comp()`. \nSince they are *private* methods, I don't think it is necessary to insist too much on their \"unsafe\" aspect, which is truly unsafe only when invoked on the special elements zero and one. Wouldn't something like `_add_comp_nocheck()` and `_set_comp_nocheck()` be better names? Travis, do you have an opinion on that?",
    "created_at": "2019-10-22T14:31:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448256",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:35'>Comment 35:</a>
On my side, one last remark: the names of the methods `_add_comp_unsafe()` and `_set_comp_unsafe()` give the impression that they are really dangerous methods that should be avoided, while they are key methods, doing most of the work of `add_comp()` and `set_comp()`. 
Since they are *private* methods, I don't think it is necessary to insist too much on their "unsafe" aspect, which is truly unsafe only when invoked on the special elements zero and one. Wouldn't something like `_add_comp_nocheck()` and `_set_comp_nocheck()` be better names? Travis, do you have an opinion on that?



---

archive/issue_comments_448257.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nThis naming convention matches what is done for vectors (and maybe matrices?) in Sage. Although in that case, if you mess with things in the wrong way, you will crash Sage. However, given the nomenclature of other methods, I think `*_unsafe` is the way to go.",
    "created_at": "2019-10-22T14:33:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448257",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'>Comment 36:</a>
This naming convention matches what is done for vectors (and maybe matrices?) in Sage. Although in that case, if you mess with things in the wrong way, you will crash Sage. However, given the nomenclature of other methods, I think `*_unsafe` is the way to go.



---

archive/issue_comments_448258.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nReplying to [@tscrim](#comment%3A36):\n> This naming convention matches what is done for vectors (and maybe matrices?) in Sage. \n\nAh yes! (`grep -r \"_unsafe\"` in `src/sage` returns 872 entries; I was not aware of that). So OK for `*_unsafe` then...",
    "created_at": "2019-10-22T14:39:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448258",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:37'>Comment 37:</a>
Replying to [@tscrim](#comment%3A36):
> This naming convention matches what is done for vectors (and maybe matrices?) in Sage. 

Ah yes! (`grep -r "_unsafe"` in `src/sage` returns 872 entries; I was not aware of that). So OK for `*_unsafe` then...



---

archive/issue_comments_448259.json:
```json
{
    "body": "Changed commit from **[2783253](https://github.com/sagemath/sagetrac-mirror/commit/2783253621fa561b0b465ec8fccc30a799b72d88)** to **[f2928f8](https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d)**",
    "created_at": "2019-10-22T15:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448259",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2783253](https://github.com/sagemath/sagetrac-mirror/commit/2783253621fa561b0b465ec8fccc30a799b72d88)** to **[f2928f8](https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d)**



---

archive/issue_comments_448260.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d\">f2928f8</a></td><td><code>Blankline removed</code></td></tr></table>\n",
    "created_at": "2019-10-22T15:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448260",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:38'>Comment 38:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d">f2928f8</a></td><td><code>Blankline removed</code></td></tr></table>




---

archive/issue_comments_448261.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nReplying to [@tscrim](#comment%3A34):\n> I just have two trivial changes:\n> \n> ```diff\n> -The components w.r.t. basis e have been kept::\n> +The components with respect to basis ``e`` have been kept::\n> ```\n\nSince this issue is not just devoted to this ticket, I vote for a new ticket on that.\n\n> and in `automorphismfield.py`:\n> \n> ```\n>     def add_comp(self, basis=None):\n>         r\"\"\"\n> \n>         Return the components of ``self`` w.r.t. a given module basis for\n>         assignment, keeping the components w.r.t. other bases.\n> \n>         To delete the components w.r.t. other bases, use the method\n>         :meth:`set_comp` instead.\n> ```\n> remove the blank line after `r\"\"\"` and same thing of spelling out `w.r.t.` (although I suspect this is done elsewhere, I think it is better to avoid abbreviations like this as this is a more \"formal\" document, but I don't care too much).\n\nDone.",
    "created_at": "2019-10-22T15:11:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448261",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:39'>Comment 39:</a>
Replying to [@tscrim](#comment%3A34):
> I just have two trivial changes:
> 
> ```diff
> -The components w.r.t. basis e have been kept::
> +The components with respect to basis ``e`` have been kept::
> ```

Since this issue is not just devoted to this ticket, I vote for a new ticket on that.

> and in `automorphismfield.py`:
> 
> ```
>     def add_comp(self, basis=None):
>         r"""
> 
>         Return the components of ``self`` w.r.t. a given module basis for
>         assignment, keeping the components w.r.t. other bases.
> 
>         To delete the components w.r.t. other bases, use the method
>         :meth:`set_comp` instead.
> ```
> remove the blank line after `r"""` and same thing of spelling out `w.r.t.` (although I suspect this is done elsewhere, I think it is better to avoid abbreviations like this as this is a more "formal" document, but I don't care too much).

Done.



---

archive/issue_comments_448262.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nReplying to [@DeRhamSource](#comment%3A39):\n> Replying to [@tscrim](#comment%3A34):\n> > I just have two trivial changes:\n> > \n> > ```diff\n> > -The components w.r.t. basis e have been kept::\n> > +The components with respect to basis ``e`` have been kept::\n> > ```\n\n> \n> Since this issue is not just devoted to this ticket, I vote for a new ticket on that.\n> \n\nIndeed. I am afraid I am responsible for most of these `w.r.t.` ;-)",
    "created_at": "2019-10-22T18:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448262",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:40'>Comment 40:</a>
Replying to [@DeRhamSource](#comment%3A39):
> Replying to [@tscrim](#comment%3A34):
> > I just have two trivial changes:
> > 
> > ```diff
> > -The components w.r.t. basis e have been kept::
> > +The components with respect to basis ``e`` have been kept::
> > ```

> 
> Since this issue is not just devoted to this ticket, I vote for a new ticket on that.
> 

Indeed. I am afraid I am responsible for most of these `w.r.t.` ;-)



---

archive/issue_events_360760.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-22T18:54:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360760"
}
```



---

archive/issue_events_360761.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-22T18:54:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360761"
}
```



---

archive/issue_comments_448263.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nThanks for your work on this!",
    "created_at": "2019-10-22T18:54:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448263",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:41'>Comment 41:</a>
Thanks for your work on this!



---

archive/issue_comments_448264.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon, Travis Scrimshaw**",
    "created_at": "2019-10-22T18:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448264",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon, Travis Scrimshaw**



---

archive/issue_comments_448265.json:
```json
{
    "body": "Changed branch from **[public/manifolds/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/better_zero_treatment)** to **[f2928f8](https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d)**",
    "created_at": "2019-10-26T22:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28562#issuecomment-448265",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/manifolds/better_zero_treatment](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/better_zero_treatment)** to **[f2928f8](https://github.com/sagemath/sagetrac-mirror/commit/f2928f882a5a8eb345dd11c308e895d615f9de9d)**



---

archive/issue_events_360762.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-26T22:20:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360762"
}
```



---

archive/issue_events_360763.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4e12d998bc1a54d1cafa4a072b28fd7a417c112d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-10-26T22:20:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28562",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28562#event-360763"
}
```
