# Issue 28487: Morphisms from p-adic rings and fields

archive/issues_028250.json:
```json
{
    "body": "The following should work:\n\n```\nsage: R.<x> = ZZ[]\nsage: K.<a> = Qq(25,modulus=x^2-2)\nsage: L.<b> = Qq(625,modulus=x^4-2)\nsage: K.hom([b^2])\n```\n\n**Keywords:** padicBordeaux\n\n**Branch/Commit:** [69ecb8176838817f9ad23ea92918d546d0c71234](https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234)\n\n**Reviewer:** Xavier Caruso\n\n**Author:** David Roe\n\n**Dependencies:** #26105\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28487\n\n",
    "closed_at": "2019-10-13T09:31:23Z",
    "created_at": "2019-09-13T14:03:51Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Morphisms from p-adic rings and fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28487",
    "user": "https://github.com/roed314"
}
```
The following should work:

```
sage: R.<x> = ZZ[]
sage: K.<a> = Qq(25,modulus=x^2-2)
sage: L.<b> = Qq(625,modulus=x^4-2)
sage: K.hom([b^2])
```

**Keywords:** padicBordeaux

**Branch/Commit:** [69ecb8176838817f9ad23ea92918d546d0c71234](https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234)

**Reviewer:** Xavier Caruso

**Author:** David Roe

**Dependencies:** #26105

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/28487





---

archive/issue_comments_553928.json:
```json
{
    "body": "**Branch:** [u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)",
    "created_at": "2019-09-13T15:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553928",
    "user": "https://github.com/roed314"
}
```

**Branch:** [u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)



---

archive/issue_comments_553929.json:
```json
{
    "body": "**Commit:** [45da59b9208891a94ff4869bce85dc22fce37912](https://github.com/sagemath/sagetrac-mirror/commit/45da59b9208891a94ff4869bce85dc22fce37912)",
    "created_at": "2019-09-13T15:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553929",
    "user": "https://github.com/roed314"
}
```

**Commit:** [45da59b9208891a94ff4869bce85dc22fce37912](https://github.com/sagemath/sagetrac-mirror/commit/45da59b9208891a94ff4869bce85dc22fce37912)



---

archive/issue_comments_553930.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2019-09-13T15:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553930",
    "user": "https://github.com/roed314"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_553931.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4a35ac1da3360df7a92d02fc0e7c898c3e0676a\">d4a35ac</a></td><td><code>Add base_map to homomorphisms defined by images of generators</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f78dd4c51b965187c3004eb5b743b41efe4e347\">1f78dd4</a></td><td><code>Fix some doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84704ba5472818a3efe97f6ef0784f4e383c512f\">84704ba</a></td><td><code>Fix doctests and py3, incorporate small reviewer suggestion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4f2a3f5b17eec98f88d2228a086baa1c53459c1\">c4f2a3f</a></td><td><code>Fix _is_valid_homomorphism_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac1c05a2120c44a8bc4310dc1237559bda618b5f\">ac1c05a</a></td><td><code>Documenting category and base_map options</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1738aa9010a4362b26bd76a015747dcee4731ad8\">1738aa9</a></td><td><code>Fix some doctests, remove category keywords from doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45da59b9208891a94ff4869bce85dc22fce37912\">45da59b</a></td><td><code>Implement _im_gens_ and _is_valid_homomorphism_</code></td></tr></table>\n",
    "created_at": "2019-09-13T15:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553931",
    "user": "https://github.com/roed314"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4a35ac1da3360df7a92d02fc0e7c898c3e0676a">d4a35ac</a></td><td><code>Add base_map to homomorphisms defined by images of generators</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f78dd4c51b965187c3004eb5b743b41efe4e347">1f78dd4</a></td><td><code>Fix some doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84704ba5472818a3efe97f6ef0784f4e383c512f">84704ba</a></td><td><code>Fix doctests and py3, incorporate small reviewer suggestion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4f2a3f5b17eec98f88d2228a086baa1c53459c1">c4f2a3f</a></td><td><code>Fix _is_valid_homomorphism_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac1c05a2120c44a8bc4310dc1237559bda618b5f">ac1c05a</a></td><td><code>Documenting category and base_map options</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1738aa9010a4362b26bd76a015747dcee4731ad8">1738aa9</a></td><td><code>Fix some doctests, remove category keywords from doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45da59b9208891a94ff4869bce85dc22fce37912">45da59b</a></td><td><code>Implement _im_gens_ and _is_valid_homomorphism_</code></td></tr></table>




---

archive/issue_comments_553932.json:
```json
{
    "body": "**Dependencies:** #26105",
    "created_at": "2019-09-13T15:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553932",
    "user": "https://github.com/roed314"
}
```

**Dependencies:** #26105



---

archive/issue_comments_553933.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"padicBordeaux\".",
    "created_at": "2019-09-13T15:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553933",
    "user": "https://github.com/roed314"
}
```

**Changing keywords** from "" to "padicBordeaux".



---

archive/issue_comments_553934.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0e095381e58f26786a979298291b3ced85500a5\">d0e0953</a></td><td><code>Add base_map to finite_field homsets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16feb8dfa1caf7aebd9e31f75397ebc6d084643e\">16feb8d</a></td><td><code>Fix some errors with positional check arguments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c48e14259ba645a8a377a1b4aebed240dc553666\">c48e142</a></td><td><code>Fix pyflakes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa84741e43d429d05348ec8d1a2629e2f09a41b8\">aa84741</a></td><td><code>Fix some doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e95aadb3118e3d19a0abd62fd2941ed4595ab393\">e95aadb</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>\n",
    "created_at": "2019-09-13T23:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553934",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0e095381e58f26786a979298291b3ced85500a5">d0e0953</a></td><td><code>Add base_map to finite_field homsets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16feb8dfa1caf7aebd9e31f75397ebc6d084643e">16feb8d</a></td><td><code>Fix some errors with positional check arguments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c48e14259ba645a8a377a1b4aebed240dc553666">c48e142</a></td><td><code>Fix pyflakes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa84741e43d429d05348ec8d1a2629e2f09a41b8">aa84741</a></td><td><code>Fix some doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e95aadb3118e3d19a0abd62fd2941ed4595ab393">e95aadb</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>




---

archive/issue_comments_553935.json:
```json
{
    "body": "**Changing commit** from \"[45da59b9208891a94ff4869bce85dc22fce37912](https://github.com/sagemath/sagetrac-mirror/commit/45da59b9208891a94ff4869bce85dc22fce37912)\" to \"[e95aadb3118e3d19a0abd62fd2941ed4595ab393](https://github.com/sagemath/sagetrac-mirror/commit/e95aadb3118e3d19a0abd62fd2941ed4595ab393)\".",
    "created_at": "2019-09-13T23:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553935",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[45da59b9208891a94ff4869bce85dc22fce37912](https://github.com/sagemath/sagetrac-mirror/commit/45da59b9208891a94ff4869bce85dc22fce37912)" to "[e95aadb3118e3d19a0abd62fd2941ed4595ab393](https://github.com/sagemath/sagetrac-mirror/commit/e95aadb3118e3d19a0abd62fd2941ed4595ab393)".



---

archive/issue_comments_553936.json:
```json
{
    "body": "<a id='comment:5'></a>\nCouldn't we allow the construction `K.hom([x,y])` as a shortcut of `K.hom([x], base_map=K.base_ring().hom([y]))` for a two step extension?",
    "created_at": "2019-09-16T10:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553936",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:5'></a>
Couldn't we allow the construction `K.hom([x,y])` as a shortcut of `K.hom([x], base_map=K.base_ring().hom([y]))` for a two step extension?



---

archive/issue_comments_553937.json:
```json
{
    "body": "**Changing commit** from \"[e95aadb3118e3d19a0abd62fd2941ed4595ab393](https://github.com/sagemath/sagetrac-mirror/commit/e95aadb3118e3d19a0abd62fd2941ed4595ab393)\" to \"[cbe5960f333dea41b77ee488c6d447f19ca84aa0](https://github.com/sagemath/sagetrac-mirror/commit/cbe5960f333dea41b77ee488c6d447f19ca84aa0)\".",
    "created_at": "2019-10-03T20:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e95aadb3118e3d19a0abd62fd2941ed4595ab393](https://github.com/sagemath/sagetrac-mirror/commit/e95aadb3118e3d19a0abd62fd2941ed4595ab393)" to "[cbe5960f333dea41b77ee488c6d447f19ca84aa0](https://github.com/sagemath/sagetrac-mirror/commit/cbe5960f333dea41b77ee488c6d447f19ca84aa0)".



---

archive/issue_comments_553938.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d7377618234d5fd125b4803d30c72d909363e7a\">3d73776</a></td><td><code>Fixing Lie algebra morphisms</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829\">72b677c</a></td><td><code>change_ring -> map_coefficients and fix composition of morphisms defined by images of generators</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbe5960f333dea41b77ee488c6d447f19ca84aa0\">cbe5960</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>\n",
    "created_at": "2019-10-03T20:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553938",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d7377618234d5fd125b4803d30c72d909363e7a">3d73776</a></td><td><code>Fixing Lie algebra morphisms</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829">72b677c</a></td><td><code>change_ring -> map_coefficients and fix composition of morphisms defined by images of generators</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbe5960f333dea41b77ee488c6d447f19ca84aa0">cbe5960</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>




---

archive/issue_comments_553939.json:
```json
{
    "body": "**Changing commit** from \"[cbe5960f333dea41b77ee488c6d447f19ca84aa0](https://github.com/sagemath/sagetrac-mirror/commit/cbe5960f333dea41b77ee488c6d447f19ca84aa0)\" to \"[a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6](https://github.com/sagemath/sagetrac-mirror/commit/a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6)\".",
    "created_at": "2019-10-03T21:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553939",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[cbe5960f333dea41b77ee488c6d447f19ca84aa0](https://github.com/sagemath/sagetrac-mirror/commit/cbe5960f333dea41b77ee488c6d447f19ca84aa0)" to "[a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6](https://github.com/sagemath/sagetrac-mirror/commit/a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6)".



---

archive/issue_comments_553940.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d780c6fdf4a793e833d091bb1de98198f3d89ae2\">d780c6f</a></td><td><code>Change base_map so that the codomain is always the codomain of the map</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6\">a70c04b</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>\n",
    "created_at": "2019-10-03T21:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d780c6fdf4a793e833d091bb1de98198f3d89ae2">d780c6f</a></td><td><code>Change base_map so that the codomain is always the codomain of the map</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6">a70c04b</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>




---

archive/issue_comments_553941.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfcbebefa46b2e5f4845a73b848c3771fad1fcd5\">bfcbebe</a></td><td><code>Fix bug in composition</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80fa8444450e7716ea70d9bd4ce93d9d9d1acade\">80fa844</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>\n",
    "created_at": "2019-10-03T21:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfcbebefa46b2e5f4845a73b848c3771fad1fcd5">bfcbebe</a></td><td><code>Fix bug in composition</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80fa8444450e7716ea70d9bd4ce93d9d9d1acade">80fa844</a></td><td><code>Merge branch '26105_base_hom' into 28487_padic_morphisms</code></td></tr></table>




---

archive/issue_comments_553942.json:
```json
{
    "body": "**Changing commit** from \"[a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6](https://github.com/sagemath/sagetrac-mirror/commit/a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6)\" to \"[80fa8444450e7716ea70d9bd4ce93d9d9d1acade](https://github.com/sagemath/sagetrac-mirror/commit/80fa8444450e7716ea70d9bd4ce93d9d9d1acade)\".",
    "created_at": "2019-10-03T21:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6](https://github.com/sagemath/sagetrac-mirror/commit/a70c04bf6888409ff1b9c21f98f3f10fd6d6dad6)" to "[80fa8444450e7716ea70d9bd4ce93d9d9d1acade](https://github.com/sagemath/sagetrac-mirror/commit/80fa8444450e7716ea70d9bd4ce93d9d9d1acade)".



---

archive/issue_comments_553943.json:
```json
{
    "body": "**Changing commit** from \"[80fa8444450e7716ea70d9bd4ce93d9d9d1acade](https://github.com/sagemath/sagetrac-mirror/commit/80fa8444450e7716ea70d9bd4ce93d9d9d1acade)\" to \"[69ecb8176838817f9ad23ea92918d546d0c71234](https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234)\".",
    "created_at": "2019-10-10T19:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553943",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[80fa8444450e7716ea70d9bd4ce93d9d9d1acade](https://github.com/sagemath/sagetrac-mirror/commit/80fa8444450e7716ea70d9bd4ce93d9d9d1acade)" to "[69ecb8176838817f9ad23ea92918d546d0c71234](https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234)".



---

archive/issue_comments_553944.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a62a47caf0630aa46f2a832f77276392cbb61633\">a62a47c</a></td><td><code>Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5324a83022777dc347e6ac529c052760c6627e4f\">5324a83</a></td><td><code>Merge branch 'develop' into base_hom</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f526f8ee20b2a5182b8e86169dcace69f3575c1\">2f526f8</a></td><td><code>Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37051638b7117dbac7cdf23d8351638eaa008abf\">3705163</a></td><td><code>Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/243e72ada852ff1d95b4b7d4f6ee62809fe2c18d\">243e72a</a></td><td><code>Merge branch 'develop' into base_hom</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/626f4ca244b2f87ce0838cba554244cc7ac037f0\">626f4ca</a></td><td><code>fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234\">69ecb81</a></td><td><code>Merge branch 'u/caruso/26105_base_hom' of git://trac.sagemath.org/sage into 28487_padic_morphisms</code></td></tr></table>\n",
    "created_at": "2019-10-10T19:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553944",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a62a47caf0630aa46f2a832f77276392cbb61633">a62a47c</a></td><td><code>Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5324a83022777dc347e6ac529c052760c6627e4f">5324a83</a></td><td><code>Merge branch 'develop' into base_hom</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f526f8ee20b2a5182b8e86169dcace69f3575c1">2f526f8</a></td><td><code>Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37051638b7117dbac7cdf23d8351638eaa008abf">3705163</a></td><td><code>Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/243e72ada852ff1d95b4b7d4f6ee62809fe2c18d">243e72a</a></td><td><code>Merge branch 'develop' into base_hom</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/626f4ca244b2f87ce0838cba554244cc7ac037f0">626f4ca</a></td><td><code>fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234">69ecb81</a></td><td><code>Merge branch 'u/caruso/26105_base_hom' of git://trac.sagemath.org/sage into 28487_padic_morphisms</code></td></tr></table>




---

archive/issue_comments_553945.json:
```json
{
    "body": "<a id='comment:10'></a>\nHere's the diff against #26105:\n\n```\ndiff --git a/src/sage/rings/padics/padic_generic.py b/src/sage/rings/padics/padic_generic.py\nindex ea88eeb0d2..d80e48b1a0 100644\n--- a/src/sage/rings/padics/padic_generic.py\n+++ b/src/sage/rings/padics/padic_generic.py\n@@ -690,6 +690,50 @@ class pAdicGeneric(PrincipalIdealDomain, LocalGeneric):\n                         print_mode[option] = self._printer.dict()[option]\n         return ExtensionFactory(base=self, modulus=modulus, prec=prec, names=names, check = True, implementation=implementation, **print_mode)\n \n+    def _is_valid_homomorphism_(self, codomain, im_gens, base_map=None):\n+        \"\"\"\n+        Check whether the given images and map on the base ring determine a\n+        valid homomorphism to the codomain.\n+\n+        EXAMPLES::\n+\n+            sage: R.<x> = ZZ[]\n+            sage: K.<a> = Qq(25, modulus=x^2-2)\n+            sage: L.<b> = Qq(625, modulus=x^4-2)\n+            sage: K._is_valid_homomorphism_(L, [b^2])\n+            True\n+            sage: L._is_valid_homomorphism_(L, [b^3])\n+            False\n+            sage: z = L(-1).sqrt()\n+            sage: L._is_valid_homomorphism_(L, [z*b])\n+            True\n+            sage: L._is_valid_homomorphism_(L, [-b])\n+            True\n+\n+            sage: W.<w> = K.extension(x^2 - 5)\n+            sage: cc = K.hom([-a])\n+            sage: W._is_valid_homomorphism_(W, [w], base_map=cc)\n+            True\n+            sage: W._is_valid_homomorphism_(W, [-w], base_map=cc)\n+            True\n+            sage: W._is_valid_homomorphism_(W, [w+1])\n+            False\n+        \"\"\"\n+        K = self.base_ring()\n+        if base_map is None and not codomain.has_coerce_map_from(K):\n+            return False\n+        if len(im_gens) != 1:\n+            raise ValueError(\"Wrong number of generators\")\n+        if self is K:\n+            # Qp or Zp, so either base_map is not None or there's a coercion to the codomain\n+            # We check that the im_gens has the right length and value\n+            return im_gens[0] == codomain(self.prime())\n+        # Now we're an extension.  We check that the defining polynomial maps to zero\n+        f = self.modulus()\n+        if base_map is not None:\n+            f = f.change_ring(base_map)\n+        return f(im_gens[0]) == 0\n+\n     def _test_add(self, **options):\n         \"\"\"\n         Test addition of elements of this ring.\ndiff --git a/src/sage/rings/padics/padic_generic_element.pyx b/src/sage/rings/padics/padic_generic_element.pyx\nindex 4ff53800ce..efc040f0ed 100644\n--- a/src/sage/rings/padics/padic_generic_element.pyx\n+++ b/src/sage/rings/padics/padic_generic_element.pyx\n@@ -2277,6 +2277,50 @@ cdef class pAdicGenericElement(LocalGenericElement):\n             L += [Kbase(0)] * (K.relative_degree() - len(L))\n         return K(L)\n \n+    def _im_gens_(self, codomain, im_gens, base_map=None):\n+        \"\"\"\n+        Return the image of this element under the morphism defined by\n+        ``im_gens`` in ``codomain``, where elements of the\n+        base ring are mapped by ``base_map``.\n+\n+        EXAMPLES::\n+\n+            sage: R.<x> = ZZ[]\n+            sage: K.<a> = Qq(25, modulus=x^2-2)\n+            sage: L.<b> = Qq(625, modulus=x^4-2)\n+            sage: phi = K.hom([b^2]); phi(a+1)\n+            (b^2 + 1) + O(5^20)\n+            sage: z = L(-1).sqrt()\n+            sage: psi = L.hom([z*b]); psi(phi(a) + 5*b) == psi(phi(a)) + 5*psi(b)\n+            True\n+            sage: z = (1+5*b).log()\n+            sage: w = (5 - 5*b).exp()\n+            sage: psi(z*w) == psi(z) * psi(w)\n+            True\n+\n+            sage: P.<pi> = K.extension(x^2 - 5)\n+            sage: cc = K.hom([-a])\n+            sage: alpha = P.hom([pi], base_map=cc); alpha(a) + a\n+            O(pi^40)\n+            sage: zz = (1 + a*pi).log()\n+            sage: ww = pi.exp()\n+            sage: beta = P.hom([-pi], base_map=cc)\n+            sage: beta(ww*zz) == beta(ww)*beta(zz)\n+            True\n+        \"\"\"\n+        L = self.parent()\n+        K = L.base_ring()\n+        if L is K:\n+            # Qp or Zp, so there is a unique map\n+            if base_map is None:\n+                return codomain.coerce(self)\n+            else:\n+                return base_map(self)\n+        f = self.polynomial()\n+        if base_map is not None:\n+            f = f.change_ring(base_map)\n+        return f(im_gens[0])\n+\n     def _log_generic(self, aprec, mina=0):\n         r\"\"\"\n         Return ``\\log(self)`` for ``self`` equal to 1 in the residue field\n```",
    "created_at": "2019-10-10T19:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553945",
    "user": "https://github.com/roed314"
}
```

<a id='comment:10'></a>
Here's the diff against #26105:

```
diff --git a/src/sage/rings/padics/padic_generic.py b/src/sage/rings/padics/padic_generic.py
index ea88eeb0d2..d80e48b1a0 100644
--- a/src/sage/rings/padics/padic_generic.py
+++ b/src/sage/rings/padics/padic_generic.py
@@ -690,6 +690,50 @@ class pAdicGeneric(PrincipalIdealDomain, LocalGeneric):
                         print_mode[option] = self._printer.dict()[option]
         return ExtensionFactory(base=self, modulus=modulus, prec=prec, names=names, check = True, implementation=implementation, **print_mode)
 
+    def _is_valid_homomorphism_(self, codomain, im_gens, base_map=None):
+        """
+        Check whether the given images and map on the base ring determine a
+        valid homomorphism to the codomain.
+
+        EXAMPLES::
+
+            sage: R.<x> = ZZ[]
+            sage: K.<a> = Qq(25, modulus=x^2-2)
+            sage: L.<b> = Qq(625, modulus=x^4-2)
+            sage: K._is_valid_homomorphism_(L, [b^2])
+            True
+            sage: L._is_valid_homomorphism_(L, [b^3])
+            False
+            sage: z = L(-1).sqrt()
+            sage: L._is_valid_homomorphism_(L, [z*b])
+            True
+            sage: L._is_valid_homomorphism_(L, [-b])
+            True
+
+            sage: W.<w> = K.extension(x^2 - 5)
+            sage: cc = K.hom([-a])
+            sage: W._is_valid_homomorphism_(W, [w], base_map=cc)
+            True
+            sage: W._is_valid_homomorphism_(W, [-w], base_map=cc)
+            True
+            sage: W._is_valid_homomorphism_(W, [w+1])
+            False
+        """
+        K = self.base_ring()
+        if base_map is None and not codomain.has_coerce_map_from(K):
+            return False
+        if len(im_gens) != 1:
+            raise ValueError("Wrong number of generators")
+        if self is K:
+            # Qp or Zp, so either base_map is not None or there's a coercion to the codomain
+            # We check that the im_gens has the right length and value
+            return im_gens[0] == codomain(self.prime())
+        # Now we're an extension.  We check that the defining polynomial maps to zero
+        f = self.modulus()
+        if base_map is not None:
+            f = f.change_ring(base_map)
+        return f(im_gens[0]) == 0
+
     def _test_add(self, **options):
         """
         Test addition of elements of this ring.
diff --git a/src/sage/rings/padics/padic_generic_element.pyx b/src/sage/rings/padics/padic_generic_element.pyx
index 4ff53800ce..efc040f0ed 100644
--- a/src/sage/rings/padics/padic_generic_element.pyx
+++ b/src/sage/rings/padics/padic_generic_element.pyx
@@ -2277,6 +2277,50 @@ cdef class pAdicGenericElement(LocalGenericElement):
             L += [Kbase(0)] * (K.relative_degree() - len(L))
         return K(L)
 
+    def _im_gens_(self, codomain, im_gens, base_map=None):
+        """
+        Return the image of this element under the morphism defined by
+        ``im_gens`` in ``codomain``, where elements of the
+        base ring are mapped by ``base_map``.
+
+        EXAMPLES::
+
+            sage: R.<x> = ZZ[]
+            sage: K.<a> = Qq(25, modulus=x^2-2)
+            sage: L.<b> = Qq(625, modulus=x^4-2)
+            sage: phi = K.hom([b^2]); phi(a+1)
+            (b^2 + 1) + O(5^20)
+            sage: z = L(-1).sqrt()
+            sage: psi = L.hom([z*b]); psi(phi(a) + 5*b) == psi(phi(a)) + 5*psi(b)
+            True
+            sage: z = (1+5*b).log()
+            sage: w = (5 - 5*b).exp()
+            sage: psi(z*w) == psi(z) * psi(w)
+            True
+
+            sage: P.<pi> = K.extension(x^2 - 5)
+            sage: cc = K.hom([-a])
+            sage: alpha = P.hom([pi], base_map=cc); alpha(a) + a
+            O(pi^40)
+            sage: zz = (1 + a*pi).log()
+            sage: ww = pi.exp()
+            sage: beta = P.hom([-pi], base_map=cc)
+            sage: beta(ww*zz) == beta(ww)*beta(zz)
+            True
+        """
+        L = self.parent()
+        K = L.base_ring()
+        if L is K:
+            # Qp or Zp, so there is a unique map
+            if base_map is None:
+                return codomain.coerce(self)
+            else:
+                return base_map(self)
+        f = self.polynomial()
+        if base_map is not None:
+            f = f.change_ring(base_map)
+        return f(im_gens[0])
+
     def _log_generic(self, aprec, mina=0):
         r"""
         Return ``\log(self)`` for ``self`` equal to 1 in the residue field
```



---

archive/issue_comments_553946.json:
```json
{
    "body": "**Changing branch** from \"[u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)\" to \"[u/caruso/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/28487_padic_morphisms)\".",
    "created_at": "2019-10-10T20:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553946",
    "user": "https://github.com/xcaruso"
}
```

**Changing branch** from "[u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)" to "[u/caruso/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/28487_padic_morphisms)".



---

archive/issue_comments_553947.json:
```json
{
    "body": "<a id='comment:12'></a>\nSorry, I pushed on the wrong ticket.",
    "created_at": "2019-10-10T20:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553947",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:12'></a>
Sorry, I pushed on the wrong ticket.



---

archive/issue_comments_553948.json:
```json
{
    "body": "**Changing branch** from \"[u/caruso/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/28487_padic_morphisms)\" to \"[u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)\".",
    "created_at": "2019-10-10T20:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553948",
    "user": "https://github.com/xcaruso"
}
```

**Changing branch** from "[u/caruso/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/28487_padic_morphisms)" to "[u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)".



---

archive/issue_comments_553949.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2019-10-11T05:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553949",
    "user": "https://github.com/xcaruso"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_553950.json:
```json
{
    "body": "<a id='comment:13'></a>\nLooks good to me.\n\nThe patchbot reported some failures and they seem unrelated to this ticket.",
    "created_at": "2019-10-11T05:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553950",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:13'></a>
Looks good to me.

The patchbot reported some failures and they seem unrelated to this ticket.



---

archive/issue_comments_553951.json:
```json
{
    "body": "**Reviewer:** Xavier Caruso",
    "created_at": "2019-10-11T05:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553951",
    "user": "https://github.com/xcaruso"
}
```

**Reviewer:** Xavier Caruso



---

archive/issue_events_080803.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-11T12:08:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28487#event-80803"
}
```



---

archive/issue_events_080804.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-13T09:31:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28487#event-80804"
}
```



---

archive/issue_comments_553952.json:
```json
{
    "body": "**Changing branch** from \"[u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)\" to \"[69ecb8176838817f9ad23ea92918d546d0c71234](https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234)\".",
    "created_at": "2019-10-13T09:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553952",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/roed/28487_padic_morphisms](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/28487_padic_morphisms)" to "[69ecb8176838817f9ad23ea92918d546d0c71234](https://github.com/sagemath/sagetrac-mirror/commit/69ecb8176838817f9ad23ea92918d546d0c71234)".



---

archive/issue_comments_553953.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2019-10-13T09:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28487#issuecomment-553953",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed
