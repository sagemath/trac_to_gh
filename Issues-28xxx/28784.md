# Issue 28784: Adding multiple symmetries and multiple contractions to tensors

archive/issues_028547.json:
```json
{
    "assignees": [
        "https://github.com/LBrunswic"
    ],
    "body": "As of sage-9.0.beta6, applying multiple contractions or multiple symmetries to tensors in indices notation raises a NotImplementedError. \n\nThis tickets aims at removing this error by implementing the adequate behavior as well as adding a convention check on the index notation.\n\nThe index notation should allow : \n\\\\*  Multiple contraction \n\\\\*  Multiple symmetries\n\\\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card \".\"\n\\\\*  covariant indices first notation as well as contravariant indices first\n\\\\*  Latex notations '{' and '}'\n\\\\*  if indices do not begin by `^` nor `_` then contravariant indices first is assumed \n\\\\The index notation should not allow :\n\\\\*  Repeated indices of the same type\n\\\\*  indices denoted by any other caracter\n\\\\*  nested symmetries\n\\\\*  unbalanced parentheses/brackets\n\n\nNB : Usual index notations allows greek indices but their implementation seems more difficult and is not the goal of the ticket.\n\n\n\nCC:  @egourgoulhon\n\nKeywords: **tensor, contraction, symmetries, manifolds**\n\nBranch/Commit: **[3013354](https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df)**\n\nReviewer: **Eric Gourgoulhon**\n\nAuthor: **L\u00e9o Brunswic**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28784_\n\n",
    "closed_at": "2019-11-30T13:36:10Z",
    "created_at": "2019-11-21T21:01:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Adding multiple symmetries and multiple contractions to tensors",
    "type": "issue",
    "updated_at": "2019-11-30T13:36:10Z",
    "url": "https://github.com/sagemath/sage/issues/28784",
    "user": "https://github.com/LBrunswic"
}
```
As of sage-9.0.beta6, applying multiple contractions or multiple symmetries to tensors in indices notation raises a NotImplementedError. 

This tickets aims at removing this error by implementing the adequate behavior as well as adding a convention check on the index notation.

The index notation should allow : 
\\*  Multiple contraction 
\\*  Multiple symmetries
\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card "."
\\*  covariant indices first notation as well as contravariant indices first
\\*  Latex notations '{' and '}'
\\*  if indices do not begin by `^` nor `_` then contravariant indices first is assumed 
\\The index notation should not allow :
\\*  Repeated indices of the same type
\\*  indices denoted by any other caracter
\\*  nested symmetries
\\*  unbalanced parentheses/brackets


NB : Usual index notations allows greek indices but their implementation seems more difficult and is not the goal of the ticket.



CC:  @egourgoulhon

Keywords: **tensor, contraction, symmetries, manifolds**

Branch/Commit: **[3013354](https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df)**

Reviewer: **Eric Gourgoulhon**

Author: **Léo Brunswic**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/28784_





---

archive/issue_events_395393.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-21T21:01:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395393"
}
```



---

archive/issue_events_395394.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-21T21:01:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395394"
}
```



---

archive/issue_events_395395.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-21T21:05:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395395"
}
```



---

archive/issue_comments_449066.json:
```json
{
    "body": "Changed keywords from none to **tensor, contraction, symmetries, manifolds**",
    "created_at": "2019-11-21T21:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449066",
    "user": "https://github.com/LBrunswic"
}
```

Changed keywords from none to **tensor, contraction, symmetries, manifolds**



---

archive/issue_comments_449067.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,20 @@\n+As of sage-9.0.beta6, applying multiple contractions or multiple symmetries to tensors in indices notation raises a NotImplementedError. \n \n+This tickets aims at removing this error by implementing the adequate behavior as well as adding a convention check on the index notation.\n+\n+The index notation should allow : \n+\\\\*  Multiple contraction \n+\\\\*  Multiple symmetries\n+\\\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z}\n+\\\\*  covariant indices first notation as well as contravariant indices first\n+\\\\*  Latex notations '{' and '}'\n+\\\\The index notation should not allow :\n+\\\\*  Repeated indices of the same type\n+\\\\*  indices denoted by any other caracter\n+\\\\*  nested symmetries\n+\\\\*  unbalanced parentheses/brackets\n+\n+\n+NB : Usual index notations allows greek indices but their implementation seems more difficult and is not the goal of the ticket.\n+\n+\n``````\n",
    "created_at": "2019-11-21T21:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449067",
    "user": "https://github.com/LBrunswic"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,20 @@
+As of sage-9.0.beta6, applying multiple contractions or multiple symmetries to tensors in indices notation raises a NotImplementedError. 
 
+This tickets aims at removing this error by implementing the adequate behavior as well as adding a convention check on the index notation.
+
+The index notation should allow : 
+\\*  Multiple contraction 
+\\*  Multiple symmetries
+\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z}
+\\*  covariant indices first notation as well as contravariant indices first
+\\*  Latex notations '{' and '}'
+\\The index notation should not allow :
+\\*  Repeated indices of the same type
+\\*  indices denoted by any other caracter
+\\*  nested symmetries
+\\*  unbalanced parentheses/brackets
+
+
+NB : Usual index notations allows greek indices but their implementation seems more difficult and is not the goal of the ticket.
+
+
``````




---

archive/issue_comments_449068.json:
```json
{
    "body": "Author: **L\u00e9o Brunswic**",
    "created_at": "2019-11-21T21:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449068",
    "user": "https://github.com/LBrunswic"
}
```

Author: **Léo Brunswic**



---

archive/issue_events_395396.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-21T21:05:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395396"
}
```



---

archive/issue_comments_449069.json:
```json
{
    "body": "Branch: **[u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors)**",
    "created_at": "2019-11-21T21:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449069",
    "user": "https://github.com/LBrunswic"
}
```

Branch: **[u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors)**



---

archive/issue_comments_449070.json:
```json
{
    "body": "Commit: **[1d1e4ea](https://github.com/sagemath/sagetrac-mirror/commit/1d1e4eaee5ee42864bed95a9ce10f38f2a7a95d3)**",
    "created_at": "2019-11-21T21:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449070",
    "user": "https://github.com/LBrunswic"
}
```

Commit: **[1d1e4ea](https://github.com/sagemath/sagetrac-mirror/commit/1d1e4eaee5ee42864bed95a9ce10f38f2a7a95d3)**



---

archive/issue_events_395397.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-21T21:08:52Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "subject": "https://github.com/LBrunswic",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395397"
}
```



---

archive/issue_comments_449071.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n The index notation should allow : \n \\\\*  Multiple contraction \n \\\\*  Multiple symmetries\n-\\\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z}\n+\\\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card \".\"\n \\\\*  covariant indices first notation as well as contravariant indices first\n \\\\*  Latex notations '{' and '}'\n \\\\The index notation should not allow :\n``````\n",
    "created_at": "2019-11-21T21:20:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449071",
    "user": "https://github.com/LBrunswic"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 The index notation should allow : 
 \\*  Multiple contraction 
 \\*  Multiple symmetries
-\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z}
+\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card "."
 \\*  covariant indices first notation as well as contravariant indices first
 \\*  Latex notations '{' and '}'
 \\The index notation should not allow :
``````




---

archive/issue_comments_449072.json:
```json
{
    "body": "Changed commit from **[1d1e4ea](https://github.com/sagemath/sagetrac-mirror/commit/1d1e4eaee5ee42864bed95a9ce10f38f2a7a95d3)** to **[59c86e3](https://github.com/sagemath/sagetrac-mirror/commit/59c86e3ed784136ff1b9026a6b89b5625ec14052)**",
    "created_at": "2019-11-21T21:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449072",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1d1e4ea](https://github.com/sagemath/sagetrac-mirror/commit/1d1e4eaee5ee42864bed95a9ce10f38f2a7a95d3)** to **[59c86e3](https://github.com/sagemath/sagetrac-mirror/commit/59c86e3ed784136ff1b9026a6b89b5625ec14052)**



---

archive/issue_comments_449073.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59c86e3ed784136ff1b9026a6b89b5625ec14052\">59c86e3</a></td><td><code>Adding check to raise exception on repeated indices of same type. Implementation of multiple contractions</code></td></tr></table>\n",
    "created_at": "2019-11-21T21:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449073",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59c86e3ed784136ff1b9026a6b89b5625ec14052">59c86e3</a></td><td><code>Adding check to raise exception on repeated indices of same type. Implementation of multiple contractions</code></td></tr></table>




---

archive/issue_events_395398.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-21T21:53:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395398"
}
```



---

archive/issue_events_395399.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-11-22T09:12:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395399"
}
```



---

archive/issue_events_395400.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-11-22T09:12:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395400"
}
```



---

archive/issue_comments_449074.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThanks for this useful enhancement!\n\nThe patchbot reports some failures:\n\n```\nsage -t --long src/sage/manifolds/differentiable/tensorfield.py  # 2 doctests failed\nsage -t --long src/sage/tensor/modules/free_module_tensor.py  # 19 doctests failed\nsage -t --long src/sage/tensor/modules/tensor_with_indices.py  # 39 doctests failed\n```\nBesides, could you add a few doctests to illustrate the new functionalities?",
    "created_at": "2019-11-22T09:12:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449074",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:7" align="right">comment:7</div>

Thanks for this useful enhancement!

The patchbot reports some failures:

```
sage -t --long src/sage/manifolds/differentiable/tensorfield.py  # 2 doctests failed
sage -t --long src/sage/tensor/modules/free_module_tensor.py  # 19 doctests failed
sage -t --long src/sage/tensor/modules/tensor_with_indices.py  # 39 doctests failed
```
Besides, could you add a few doctests to illustrate the new functionalities?



---

archive/issue_comments_449075.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b9a565daccfb8312b00efa9a86a9c47080ffe41\">4b9a565</a></td><td><code>The convention without leading '^' for contravariant indices is now accepted as is used to. A regex corrected. doctest added to illustrate new functionalities.</code></td></tr></table>\n",
    "created_at": "2019-11-22T11:37:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449075",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b9a565daccfb8312b00efa9a86a9c47080ffe41">4b9a565</a></td><td><code>The convention without leading '^' for contravariant indices is now accepted as is used to. A regex corrected. doctest added to illustrate new functionalities.</code></td></tr></table>




---

archive/issue_comments_449076.json:
```json
{
    "body": "Changed commit from **[59c86e3](https://github.com/sagemath/sagetrac-mirror/commit/59c86e3ed784136ff1b9026a6b89b5625ec14052)** to **[4b9a565](https://github.com/sagemath/sagetrac-mirror/commit/4b9a565daccfb8312b00efa9a86a9c47080ffe41)**",
    "created_at": "2019-11-22T11:37:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449076",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[59c86e3](https://github.com/sagemath/sagetrac-mirror/commit/59c86e3ed784136ff1b9026a6b89b5625ec14052)** to **[4b9a565](https://github.com/sagemath/sagetrac-mirror/commit/4b9a565daccfb8312b00efa9a86a9c47080ffe41)**



---

archive/issue_comments_449077.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n@egourgoulhon \n I needed it :)\n \n I'm sorry I forgot to do a doctest :$...I corrected the features that are tested and added new doctest.",
    "created_at": "2019-11-22T11:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449077",
    "user": "https://github.com/LBrunswic"
}
```

<div id="comment:9" align="right">comment:9</div>

@egourgoulhon 
 I needed it :)
 
 I'm sorry I forgot to do a doctest :$...I corrected the features that are tested and added new doctest.



---

archive/issue_comments_449078.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,7 @@\n \\\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card \".\"\n \\\\*  covariant indices first notation as well as contravariant indices first\n \\\\*  Latex notations '{' and '}'\n+\\\\*  if indices do not begin by '^' or '_' then contravariant indices first is assumed \n \\\\The index notation should not allow :\n \\\\*  Repeated indices of the same type\n \\\\*  indices denoted by any other caracter\n``````\n",
    "created_at": "2019-11-22T11:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449078",
    "user": "https://github.com/LBrunswic"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,7 @@
 \\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card "."
 \\*  covariant indices first notation as well as contravariant indices first
 \\*  Latex notations '{' and '}'
+\\*  if indices do not begin by '^' or '_' then contravariant indices first is assumed 
 \\The index notation should not allow :
 \\*  Repeated indices of the same type
 \\*  indices denoted by any other caracter
``````




---

archive/issue_events_395401.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-22T11:46:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395401"
}
```



---

archive/issue_events_395402.json:
```json
{
    "actor": "https://github.com/LBrunswic",
    "created_at": "2019-11-22T11:46:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395402"
}
```



---

archive/issue_comments_449079.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \\\\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card \".\"\n \\\\*  covariant indices first notation as well as contravariant indices first\n \\\\*  Latex notations '{' and '}'\n-\\\\*  if indices do not begin by '^' or '_' then contravariant indices first is assumed \n+\\\\*  if indices do not begin by `^` nor `_` then contravariant indices first is assumed \n \\\\The index notation should not allow :\n \\\\*  Repeated indices of the same type\n \\\\*  indices denoted by any other caracter\n``````\n",
    "created_at": "2019-11-22T11:49:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449079",
    "user": "https://github.com/LBrunswic"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 \\*  indices denoted by a non-accentuated latin caracter  {a,...,z,A,...,Z} and wild card "."
 \\*  covariant indices first notation as well as contravariant indices first
 \\*  Latex notations '{' and '}'
-\\*  if indices do not begin by '^' or '_' then contravariant indices first is assumed 
+\\*  if indices do not begin by `^` nor `_` then contravariant indices first is assumed 
 \\The index notation should not allow :
 \\*  Repeated indices of the same type
 \\*  indices denoted by any other caracter
``````




---

archive/issue_comments_449080.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76\">0823e29</a></td><td><code>Minor corrections for #28784</code></td></tr></table>\n",
    "created_at": "2019-11-23T21:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449080",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:12"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76">0823e29</a></td><td><code>Minor corrections for #28784</code></td></tr></table>




---

archive/issue_comments_449081.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2019-11-23T21:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449081",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_comments_449082.json:
```json
{
    "body": "Changed branch from **[u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors)** to **[public/manifolds/tensor_multiple_symmetries_contractions-28784](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/tensor_multiple_symmetries_contractions-28784)**",
    "created_at": "2019-11-23T21:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449082",
    "user": "https://github.com/egourgoulhon"
}
```

Changed branch from **[u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-LBrunswic/adding_multiple_symmetries_and_multiple_contractions_to_tensors)** to **[public/manifolds/tensor_multiple_symmetries_contractions-28784](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/tensor_multiple_symmetries_contractions-28784)**



---

archive/issue_comments_449083.json:
```json
{
    "body": "Changed commit from **[4b9a565](https://github.com/sagemath/sagetrac-mirror/commit/4b9a565daccfb8312b00efa9a86a9c47080ffe41)** to **[0823e29](https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76)**",
    "created_at": "2019-11-23T21:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449083",
    "user": "https://github.com/egourgoulhon"
}
```

Changed commit from **[4b9a565](https://github.com/sagemath/sagetrac-mirror/commit/4b9a565daccfb8312b00efa9a86a9c47080ffe41)** to **[0823e29](https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76)**



---

archive/issue_comments_449084.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThanks for making all doctest passed.\nI gave a more in-depth look at the code and it looks very good.\nI've just performed some reviewer tweaks, which I pushed in the new branch. You can see the (minor) changes [here](https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76).\nIn particular\n- a doctest block has been corrected by adding a missing `::`\n- some PEP 8 enforcement has been performed\n- doctests raising an exception have been rewritten via `Traceback...` instead of a `try` block\n- the header  `# -*- coding: utf-8 -*-` has been added to the file `tensor_with_indices.py`, in order to get rid of the non-ascii error revealed by the patchbot.\n\nDo you agree with the above changes?",
    "created_at": "2019-11-23T21:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449084",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:13" align="right">comment:13</div>

Thanks for making all doctest passed.
I gave a more in-depth look at the code and it looks very good.
I've just performed some reviewer tweaks, which I pushed in the new branch. You can see the (minor) changes [here](https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76).
In particular
- a doctest block has been corrected by adding a missing `::`
- some PEP 8 enforcement has been performed
- doctests raising an exception have been rewritten via `Traceback...` instead of a `try` block
- the header  `# -*- coding: utf-8 -*-` has been added to the file `tensor_with_indices.py`, in order to get rid of the non-ascii error revealed by the patchbot.

Do you agree with the above changes?



---

archive/issue_comments_449085.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df\">3013354</a></td><td><code>Marginal modifications</code></td></tr></table>\n",
    "created_at": "2019-11-24T00:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449085",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df">3013354</a></td><td><code>Marginal modifications</code></td></tr></table>




---

archive/issue_comments_449086.json:
```json
{
    "body": "Changed commit from **[0823e29](https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76)** to **[3013354](https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df)**",
    "created_at": "2019-11-24T00:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449086",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0823e29](https://github.com/sagemath/sagetrac-mirror/commit/0823e29c5fa02815c71a23f770f8ee226eec7c76)** to **[3013354](https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df)**



---

archive/issue_comments_449087.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks for the PEP8 enforcement and the correction of the doctest. \n\nOf course, I agree with the changes and merged. \nI quickly reviewed them and checked the doctest. \n\nAlso, I corrected a typo and clarified two lines.",
    "created_at": "2019-11-24T00:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449087",
    "user": "https://github.com/LBrunswic"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks for the PEP8 enforcement and the correction of the doctest. 

Of course, I agree with the changes and merged. 
I quickly reviewed them and checked the doctest. 

Also, I corrected a typo and clarified two lines.



---

archive/issue_comments_449088.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI would give a positive review but since I modified the code (even marginally) I think I shouldn't do it.",
    "created_at": "2019-11-24T19:11:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449088",
    "user": "https://github.com/LBrunswic"
}
```

<div id="comment:16" align="right">comment:16</div>

I would give a positive review but since I modified the code (even marginally) I think I shouldn't do it.



---

archive/issue_events_395403.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-11-24T19:54:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395403"
}
```



---

archive/issue_events_395404.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-11-24T19:54:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395404"
}
```



---

archive/issue_comments_449089.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI've just checked your latest changes. Everything is OK. \nThanks for this work.",
    "created_at": "2019-11-24T19:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449089",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:17" align="right">comment:17</div>

I've just checked your latest changes. Everything is OK. 
Thanks for this work.



---

archive/issue_comments_449090.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIt would be nice to add this functionality for multiple symmetrizations to the method `symmetrize()` as well because symmetrization is not necessarily done over neighboring indices which cannot be handled by the string syntax. I assume it is more efficient to do all symmetrizations and antisymmetrizations in a single function call, rather than computing several intermediate results.",
    "created_at": "2019-11-27T18:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449090",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:18" align="right">comment:18</div>

It would be nice to add this functionality for multiple symmetrizations to the method `symmetrize()` as well because symmetrization is not necessarily done over neighboring indices which cannot be handled by the string syntax. I assume it is more efficient to do all symmetrizations and antisymmetrizations in a single function call, rather than computing several intermediate results.



---

archive/issue_comments_449091.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@mwageringel](#comment:18):\n> It would be nice to add this functionality for multiple symmetrizations to the method `symmetrize()` as well because symmetrization is not necessarily done over neighboring indices which cannot be handled by the string syntax. I assume it is more efficient to do all symmetrizations and antisymmetrizations in a single function call, rather than computing several intermediate results.\n\nHi! \n\n I completely agree! We should open another ticket or a discussion of devel to discuss this (I would at the very least ask Eric Gourgoulhon for validation). \n\n To begin the discussion, I see other issues with the current implementation and methods.\nFor instance, it's not possible to define the symmetries of the riemann tensor. This is related to the fact that (anti)symmetrize ony takes a set of indices as argument and then consider the action of the natural action of the symmetric group this set.\nIt would be appreciable to define the symmetrization via an action of some group on the set indices. Antisymmetrization would need also a 'signature' morphism G-->{1,-1}. More generally, one could consider linear group action symmetries.",
    "created_at": "2019-11-27T19:23:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449091",
    "user": "https://github.com/LBrunswic"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@mwageringel](#comment:18):
> It would be nice to add this functionality for multiple symmetrizations to the method `symmetrize()` as well because symmetrization is not necessarily done over neighboring indices which cannot be handled by the string syntax. I assume it is more efficient to do all symmetrizations and antisymmetrizations in a single function call, rather than computing several intermediate results.

Hi! 

 I completely agree! We should open another ticket or a discussion of devel to discuss this (I would at the very least ask Eric Gourgoulhon for validation). 

 To begin the discussion, I see other issues with the current implementation and methods.
For instance, it's not possible to define the symmetries of the riemann tensor. This is related to the fact that (anti)symmetrize ony takes a set of indices as argument and then consider the action of the natural action of the symmetric group this set.
It would be appreciable to define the symmetrization via an action of some group on the set indices. Antisymmetrization would need also a 'signature' morphism G-->{1,-1}. More generally, one could consider linear group action symmetries.



---

archive/issue_comments_449092.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@LBrunswic](#comment:19):\n> Replying to [@mwageringel](#comment:18):\n> > It would be nice to add this functionality for multiple symmetrizations to the method `symmetrize()` as well because symmetrization is not necessarily done over neighboring indices which cannot be handled by the string syntax. I assume it is more efficient to do all symmetrizations and antisymmetrizations in a single function call, rather than computing several intermediate results.\n\n> \n> Hi! \n> \n>  I completely agree! We should open another ticket or a discussion of devel to discuss this (I would at the very least ask Eric Gourgoulhon for validation). \n> \n\nYes please open a ticket for this! (and continue the discussion there).\n \n>  To begin the discussion, I see other issues with the current implementation and methods.\n> For instance, it's not possible to define the symmetries of the riemann tensor. This is related to the fact that (anti)symmetrize ony takes a set of indices as argument and then consider the action of the natural action of the symmetric group this set.\n> It would be appreciable to define the symmetrization via an action of some group on the set indices. Antisymmetrization would need also a 'signature' morphism G-->{1,-1}. More generally, one could consider linear group action symmetries.  \n\nIndeed, this would be nice.",
    "created_at": "2019-11-28T09:52:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449092",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@LBrunswic](#comment:19):
> Replying to [@mwageringel](#comment:18):
> > It would be nice to add this functionality for multiple symmetrizations to the method `symmetrize()` as well because symmetrization is not necessarily done over neighboring indices which cannot be handled by the string syntax. I assume it is more efficient to do all symmetrizations and antisymmetrizations in a single function call, rather than computing several intermediate results.

> 
> Hi! 
> 
>  I completely agree! We should open another ticket or a discussion of devel to discuss this (I would at the very least ask Eric Gourgoulhon for validation). 
> 

Yes please open a ticket for this! (and continue the discussion there).
 
>  To begin the discussion, I see other issues with the current implementation and methods.
> For instance, it's not possible to define the symmetries of the riemann tensor. This is related to the fact that (anti)symmetrize ony takes a set of indices as argument and then consider the action of the natural action of the symmetric group this set.
> It would be appreciable to define the symmetrization via an action of some group on the set indices. Antisymmetrization would need also a 'signature' morphism G-->{1,-1}. More generally, one could consider linear group action symmetries.  

Indeed, this would be nice.



---

archive/issue_comments_449093.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThe new ticket is #28813.",
    "created_at": "2019-11-28T20:43:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449093",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:21" align="right">comment:21</div>

The new ticket is #28813.



---

archive/issue_comments_449094.json:
```json
{
    "body": "Changed branch from **[public/manifolds/tensor_multiple_symmetries_contractions-28784](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/tensor_multiple_symmetries_contractions-28784)** to **[3013354](https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df)**",
    "created_at": "2019-11-30T13:36:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28784#issuecomment-449094",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/manifolds/tensor_multiple_symmetries_contractions-28784](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/tensor_multiple_symmetries_contractions-28784)** to **[3013354](https://github.com/sagemath/sagetrac-mirror/commit/3013354903be7147e51c9dd7957428a281c801df)**



---

archive/issue_events_395405.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-11-30T13:36:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395405"
}
```



---

archive/issue_events_395406.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9afb930099851e321a5242de7bd27c6739115af1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-11-30T13:36:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28784",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28784#event-395406"
}
```
