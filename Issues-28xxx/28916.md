# Issue 28916: MixedFormAlgebra - More Flexible Coercions

archive/issues_028679.json:
```json
{
    "body": "This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.\n\nAt this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbolic ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.\n\nIn particular we have:\n\n```\nsage: M = Manifold(2, 'M')\nsage: Omega = M.mixed_form_algebra()\nsage: Omega1 = M.diff_form_module(1)\nsage: T01 = M.tensor_field_module((0,1))\nsage: Omega1.has_coerce_map_from(T01)\nTrue\n```\nBut at this stage:\n\n```\nsage: Omega.has_coerce_map_from(T01)\nFalse\n```\n**With this ticket:**\n\n```\nsage: Omega.has_coerce_map_from(T01)\nTrue\n```\n\nCC:  @egourgoulhon @tscrim\n\nKeywords: manifolds, mixed-forms\n\nReviewer: Travis Scrimshaw\n\nAuthor: Michael Jung\n\nBranch: 37863dffe422080bacb83e930ad22b7c92f92749\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28916\n\n",
    "closed_at": "2020-01-11T17:45:21Z",
    "created_at": "2019-12-27T15:36:23Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "MixedFormAlgebra - More Flexible Coercions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28916",
    "user": "https://github.com/DeRhamSource"
}
```
This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.

At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbolic ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.

In particular we have:

```
sage: M = Manifold(2, 'M')
sage: Omega = M.mixed_form_algebra()
sage: Omega1 = M.diff_form_module(1)
sage: T01 = M.tensor_field_module((0,1))
sage: Omega1.has_coerce_map_from(T01)
True
```
But at this stage:

```
sage: Omega.has_coerce_map_from(T01)
False
```
**With this ticket:**

```
sage: Omega.has_coerce_map_from(T01)
True
```

CC:  @egourgoulhon @tscrim

Keywords: manifolds, mixed-forms

Reviewer: Travis Scrimshaw

Author: Michael Jung

Branch: 37863dffe422080bacb83e930ad22b7c92f92749

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28916





---

archive/issue_comments_431174.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-12-27T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431174",
    "user": "https://github.com/DeRhamSource"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_431175.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-12-27T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431175",
    "user": "https://github.com/DeRhamSource"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_431176.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to geometry.",
    "created_at": "2019-12-27T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431176",
    "user": "https://github.com/DeRhamSource"
}
```

Changing component from PLEASE CHANGE to geometry.



---

archive/issue_comments_431177.json:
```json
{
    "body": "Changing keywords from \"\" to \"manifolds, mixed-forms\".",
    "created_at": "2019-12-27T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431177",
    "user": "https://github.com/DeRhamSource"
}
```

Changing keywords from "" to "manifolds, mixed-forms".



---

archive/issue_comments_431178.json:
```json
{
    "body": "<a id='comment:2'></a>This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as differential forms of *every* degree have coerce maps, the mixed form has one too.\n\n---\nNew commits:",
    "created_at": "2019-12-27T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431178",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:2'></a>This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as differential forms of *every* degree have coerce maps, the mixed form has one too.

---
New commits:



---

archive/issue_comments_431179.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.\n \n Comment: 1\n \n```\n",
    "created_at": "2019-12-27T19:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431179",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.
 
 Comment: 1
 
```




---

archive/issue_comments_431180.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-27T20:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431181.json:
```json
{
    "body": "<a id='comment:4'></a>I spared the `try...except` block now completely. I think this is a negligible loss of computation time. Also this is more robust and works everytime.",
    "created_at": "2019-12-27T20:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431181",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:4'></a>I spared the `try...except` block now completely. I think this is a negligible loss of computation time. Also this is more robust and works everytime.



---

archive/issue_comments_431182.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-27T20:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431183.json:
```json
{
    "body": "<a id='comment:7'></a>Do you have some examples that demonstrates that this change now covers something that it didn't (correctly) do before? If so, please add them to the documentation, but if not, can you give a more detailed explanation as to why you think this is better?",
    "created_at": "2019-12-28T05:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431183",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Do you have some examples that demonstrates that this change now covers something that it didn't (correctly) do before? If so, please add them to the documentation, but if not, can you give a more detailed explanation as to why you think this is better?



---

archive/issue_comments_431184.json:
```json
{
    "body": "<a id='comment:8'></a>Fair enough. I'm not sure this change covers even more at this stage.\n\nThe only improvement so far: There might be objects with a method `degree` which are not coercible into differential forms. Or conversely there are coercible objects without having a degree method (like elements of the symbolic ring). So I avoid invoking `degree` completely.\n\nAssume in a future version there come more objects not having a `degree` method but are coercible into differential forms (I admit, I have no idea what else it could be). Nevertheless, these cases have to be handled separately now. But with this changes, all potential coercions are covered.\n\nWas that clearer? What do you think about it? And how could I improve my description?\n\nBy the way: Merry christmas retrospectively. :)",
    "created_at": "2019-12-28T11:15:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431184",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:8'></a>Fair enough. I'm not sure this change covers even more at this stage.

The only improvement so far: There might be objects with a method `degree` which are not coercible into differential forms. Or conversely there are coercible objects without having a degree method (like elements of the symbolic ring). So I avoid invoking `degree` completely.

Assume in a future version there come more objects not having a `degree` method but are coercible into differential forms (I admit, I have no idea what else it could be). Nevertheless, these cases have to be handled separately now. But with this changes, all potential coercions are covered.

Was that clearer? What do you think about it? And how could I improve my description?

By the way: Merry christmas retrospectively. :)



---

archive/issue_comments_431185.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.\n \n+At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbold ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.\n \n Comment: 1\n \n```\n",
    "created_at": "2019-12-28T11:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431185",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.
 
+At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbold ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.
 
 Comment: 1
 
```




---

archive/issue_comments_431186.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.\n \n+At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbolic ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-04T23:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431186",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.
 
+At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbolic ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.
 
 Comment: 1
 
```




---

archive/issue_events_073181.json:
```json
{
    "actor": "https://github.com/DeRhamSource",
    "created_at": "2020-01-04T23:20:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28916#event-73181"
}
```



---

archive/issue_comments_431187.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-04T23:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431188.json:
```json
{
    "body": "<a id='comment:12'></a>Yes, that is more clear, thank you. So can you please add such an example that now coerces that previously did not?",
    "created_at": "2020-01-05T16:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431188",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>Yes, that is more clear, thank you. So can you please add such an example that now coerces that previously did not?



---

archive/issue_comments_431189.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,29 @@\n+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.\n \n+At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbolic ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.\n+\n+In particular we have:\n+\n+```\n+sage: M = Manifold(2, 'M')\n+sage: Omega = M.mixed_form_algebra()\n+sage: Omega1 = M.diff_form_module(1)\n+sage: T01 = M.tensor_field_module((0,1))\n+sage: Omega1.has_coerce_map_from(T01)\n+True\n+```\n+But at this stage:\n+\n+```\n+sage: Omega.has_coerce_map_from(T01)\n+False\n+```\n+**With this ticket:**\n+\n+```\n+sage: Omega.has_coerce_map_from(T01)\n+True\n+```\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-06T00:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431189",
    "user": "https://github.com/DeRhamSource"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,29 @@
+This makes the coercion model of mixed forms more robust against modifications regarding differential forms. For instance: As soon as all differential forms of another mixed form have a coerce map, the mixed form has one too. The same now holds for any algebraic element which is coercible into a single differential form.
 
+At this stage, the method `degree` is used and special cases are handled separately. But notice that not all coercible objects provide this method (symbolic ring). Or conversely, having this method doesn't mean being coercible into a differential form. Hence this invocation is now entirely avoided.
+
+In particular we have:
+
+```
+sage: M = Manifold(2, 'M')
+sage: Omega = M.mixed_form_algebra()
+sage: Omega1 = M.diff_form_module(1)
+sage: T01 = M.tensor_field_module((0,1))
+sage: Omega1.has_coerce_map_from(T01)
+True
+```
+But at this stage:
+
+```
+sage: Omega.has_coerce_map_from(T01)
+False
+```
+**With this ticket:**
+
+```
+sage: Omega.has_coerce_map_from(T01)
+True
+```
 
 Comment: 1
 
```




---

archive/issue_comments_431190.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-06T12:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431191.json:
```json
{
    "body": "<a id='comment:15'></a>Thank you, but can you add that example as a doctest?",
    "created_at": "2020-01-06T16:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431191",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>Thank you, but can you add that example as a doctest?



---

archive/issue_comments_431192.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-08T23:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431192",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431193.json:
```json
{
    "body": "<a id='comment:17'></a>Like this or something in more detail?\n\n---\nNew commits:",
    "created_at": "2020-01-08T23:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431193",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:17'></a>Like this or something in more detail?

---
New commits:



---

archive/issue_comments_431194.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-08T23:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431194",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_431195.json:
```json
{
    "body": "<a id='comment:18'></a>Yep, exactly. Thank you.",
    "created_at": "2020-01-08T23:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431195",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>Yep, exactly. Thank you.



---

archive/issue_comments_431196.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-11T17:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431196",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_073182.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-11T17:45:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28916#event-73182"
}
```



---

archive/issue_comments_431197.json:
```json
{
    "body": "<a id='comment:21'></a>Damn it. I thought the tickets are still open...\n\n---\nNew commits:",
    "created_at": "2020-01-12T16:20:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431197",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:21'></a>Damn it. I thought the tickets are still open...

---
New commits:



---

archive/issue_comments_431198.json:
```json
{
    "body": "<a id='comment:23'></a>I hope that is it. Sorry!",
    "created_at": "2020-01-12T16:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28916#issuecomment-431198",
    "user": "https://github.com/DeRhamSource"
}
```

<a id='comment:23'></a>I hope that is it. Sorry!
