# Issue 28041: py3: Docker images for python3-based Sage

archive/issues_027804.json:
```json
{
    "assignees": [],
    "body": "Docker images for python3-based Sage are useful in general,\nand in particular for continuous integration or other testing\nworkflows for packages that depend on Sage.\n\nThe infrastructure introduced by #24655 automatically produces\nDocker images for python2-based Sage. In order to extend it to\nalso produce python3-based ones,\n\n- we update the `micro_release` target for `make` in `Makefile`\n  to not remove the `config` directory\n\n- we adapt `.gitlab-ci.yml` and `docker/Dockerfile`,\n  duplicating all the docker targets for py3, creating\n  a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`\n  environment variables, and using them in the shell\n  scripts `docker/*.sh`.\n\nTo play with the generated Python 2/3 docker images, you can go to https://gitlab-hooks-flau3jeaza-ew.a.run.app/status/trac/branch/u%2Fsaraedum%2F28041\n\n**CC:**  @saraedum zerline @roed314\n\n**Keywords:** docker, py3, gitlab-ci, days101\n\n**Branch/Commit:** [ca243324e4d9706a0c189193beebec09eed33a2b](https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b)\n\n**Reviewer:** David Roe\n\n**Author:** Samuel Leli\u00e8vre, Julian R\u00fcth\n\nIssue created by migration from https://trac.sagemath.org/ticket/28041\n\n",
    "closed_at": "2019-10-03T17:58:09Z",
    "created_at": "2019-06-21T15:35:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20distribution",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: Docker images for python3-based Sage",
    "type": "issue",
    "updated_at": "2019-10-03T17:58:09Z",
    "url": "https://github.com/sagemath/sage/issues/28041",
    "user": "https://github.com/sagetrac-galois"
}
```
Docker images for python3-based Sage are useful in general,
and in particular for continuous integration or other testing
workflows for packages that depend on Sage.

The infrastructure introduced by #24655 automatically produces
Docker images for python2-based Sage. In order to extend it to
also produce python3-based ones,

- we update the `micro_release` target for `make` in `Makefile`
  to not remove the `config` directory

- we adapt `.gitlab-ci.yml` and `docker/Dockerfile`,
  duplicating all the docker targets for py3, creating
  a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`
  environment variables, and using them in the shell
  scripts `docker/*.sh`.

To play with the generated Python 2/3 docker images, you can go to https://gitlab-hooks-flau3jeaza-ew.a.run.app/status/trac/branch/u%2Fsaraedum%2F28041

**CC:**  @saraedum zerline @roed314

**Keywords:** docker, py3, gitlab-ci, days101

**Branch/Commit:** [ca243324e4d9706a0c189193beebec09eed33a2b](https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b)

**Reviewer:** David Roe

**Author:** Samuel Lelièvre, Julian Rüth

Issue created by migration from https://trac.sagemath.org/ticket/28041





---

archive/issue_comments_438975.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,13 +1,21 @@\n-Samuel Leli\u00e8vre ([@slel](https://gitlab.com/slel)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/22:\n+Docker images for python3-based Sage are useful in general,\n+and in particular for continuous integration or other testing\n+workflows for packages that depend on Sage.\n \n----\n+The infrastructure introduced by #24655 automatically produces\n+Docker images for python2-based Sage. In order to extend it to\n+also produce python3-based ones,\n \n-```markdown\n-Update .gitlab-ci.yml, Makefile, docker/Dockerfile, docker/build-docker.sh for Python 3.\n-```\n+- we update the `micro_release` target for `make` in `Makefile`\n+  to not remove the `config` directory\n \n+- we adapt `.gitlab-ci.yml` and `docker/Dockerfile`,\n+  duplicating all the docker targets for py3, creating\n+  a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`\n+  environment variables, and using them in the shell\n+  scripts `docker/*.sh`.\n \n+This ticket was created from a merge request opened by\n+Samuel Leli\u00e8vre ([@slel](https://gitlab.com/slel)) on GitLab\n+at https://gitlab.com/sagemath/sage/merge_requests/22.\n \n-\n-\n-\n``````\n",
    "created_at": "2019-06-21T16:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438975",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,13 +1,21 @@
-Samuel Lelièvre ([@slel](https://gitlab.com/slel)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/22:
+Docker images for python3-based Sage are useful in general,
+and in particular for continuous integration or other testing
+workflows for packages that depend on Sage.
 
----
+The infrastructure introduced by #24655 automatically produces
+Docker images for python2-based Sage. In order to extend it to
+also produce python3-based ones,
 
-```markdown
-Update .gitlab-ci.yml, Makefile, docker/Dockerfile, docker/build-docker.sh for Python 3.
-```
+- we update the `micro_release` target for `make` in `Makefile`
+  to not remove the `config` directory
 
+- we adapt `.gitlab-ci.yml` and `docker/Dockerfile`,
+  duplicating all the docker targets for py3, creating
+  a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`
+  environment variables, and using them in the shell
+  scripts `docker/*.sh`.
 
+This ticket was created from a merge request opened by
+Samuel Lelièvre ([@slel](https://gitlab.com/slel)) on GitLab
+at https://gitlab.com/sagemath/sage/merge_requests/22.
 
-
-
-
``````




---

archive/issue_events_247494.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-21T16:37:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20distribution",
    "label_color": "08517b",
    "label_name": "component: distribution",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247494"
}
```



---

archive/issue_events_247495.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-21T16:37:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247495"
}
```



---

archive/issue_comments_438976.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"docker, py3, gitlab-ci\".",
    "created_at": "2019-06-21T16:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438976",
    "user": "https://github.com/slel"
}
```

**Changing keywords** from "" to "docker, py3, gitlab-ci".



---

archive/issue_events_247496.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-21T16:37:37Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "rename": {
        "from": "MR22: Docker python3",
        "to": "py3: Docker images for python3-based Sage"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247496"
}
```



---

archive/issue_comments_438977.json:
```json
{
    "body": "<a id='comment:2'></a>\nStill need to make the changes to the `docker/*.sh` shell scripts.",
    "created_at": "2019-06-21T16:38:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438977",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'></a>
Still need to make the changes to the `docker/*.sh` shell scripts.



---

archive/issue_events_247497.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-21T17:51:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247497"
}
```



---

archive/issue_events_247498.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-21T17:51:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247498"
}
```



---

archive/issue_comments_438978.json:
```json
{
    "body": "**Changing keywords** from \"docker, py3, gitlab-ci\" to \"docker, py3, gitlab-ci, days101\".",
    "created_at": "2019-06-21T17:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438978",
    "user": "https://github.com/slel"
}
```

**Changing keywords** from "docker, py3, gitlab-ci" to "docker, py3, gitlab-ci, days101".



---

archive/issue_comments_438979.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm trying to get this working, but the build is stalling out at:\n\n```\nStep 61/80 : RUN sudo $SAGE_ROOT/sage --nodotsage -c \"install_scripts('/usr/bin')\"\n ---> Running in d4ce02ca02d6\nForcing sage-location, probably because a new package was installed.\nCleaning up, do not interrupt this.\nDone cleaning.\nTraceback (most recent call last):\n  File \"/home/sage/sage/src/bin/sage-eval\", line 4, in <module>\n    from sage.all import *\nImportError: No module named sage.all\nThe command '/bin/sh -c sudo $SAGE_ROOT/sage --nodotsage -c \"install_scripts('/usr/bin')\"' returned a non-zero code: 1\n```\n\nThe problem is that `SAGE_PYTHON_VERSION` is not being set properly when running `$SAGE_ROOT/sage`.\n\nThis is because there are *two* copies of `sage-env-config`, where `SAGE_PYTHON_VERSION` is defined:  One under `$SAGE_ROOT/src/bin` and one other `$SAGE_ROOT/local/bin`.  This is normal when doing Sage development, and I believe, if it exists, it's the one under `src/bin` that will be used by default when developing/building.\n\nThe problem in this case is that although the one in `local/bin` correctly has `SAGE_PYTHON_VERSION=3`, the one in `src/bin` still has `SAGE_PYTHON_VERSION=2` for some reason.\n\nI wonder if this is a remnant from an earlier build stage that was cached, but not properly updated for some reason (I thought that different `--build-arg` flags would avoid use incompatible cached images built with different `--build-arg`s, but it's possible that that arg isn't being included in the build early enough.",
    "created_at": "2019-07-03T13:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438979",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
I'm trying to get this working, but the build is stalling out at:

```
Step 61/80 : RUN sudo $SAGE_ROOT/sage --nodotsage -c "install_scripts('/usr/bin')"
 ---> Running in d4ce02ca02d6
Forcing sage-location, probably because a new package was installed.
Cleaning up, do not interrupt this.
Done cleaning.
Traceback (most recent call last):
  File "/home/sage/sage/src/bin/sage-eval", line 4, in <module>
    from sage.all import *
ImportError: No module named sage.all
The command '/bin/sh -c sudo $SAGE_ROOT/sage --nodotsage -c "install_scripts('/usr/bin')"' returned a non-zero code: 1
```

The problem is that `SAGE_PYTHON_VERSION` is not being set properly when running `$SAGE_ROOT/sage`.

This is because there are *two* copies of `sage-env-config`, where `SAGE_PYTHON_VERSION` is defined:  One under `$SAGE_ROOT/src/bin` and one other `$SAGE_ROOT/local/bin`.  This is normal when doing Sage development, and I believe, if it exists, it's the one under `src/bin` that will be used by default when developing/building.

The problem in this case is that although the one in `local/bin` correctly has `SAGE_PYTHON_VERSION=3`, the one in `src/bin` still has `SAGE_PYTHON_VERSION=2` for some reason.

I wonder if this is a remnant from an earlier build stage that was cached, but not properly updated for some reason (I thought that different `--build-arg` flags would avoid use incompatible cached images built with different `--build-arg`s, but it's possible that that arg isn't being included in the build early enough.



---

archive/issue_comments_438980.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe problem seems to start here:\n\n```\nStep 56/80 : RUN make micro_release\n ---> Using cache\n ---> 2fc1a353e2ac\n```\n\nWhen running `make micro_release`, `./configure` gets re-run, but without any flags we passed it previously.  So it doesn't preserve our `--with-python=3` from earlier.",
    "created_at": "2019-07-03T13:29:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438980",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
The problem seems to start here:

```
Step 56/80 : RUN make micro_release
 ---> Using cache
 ---> 2fc1a353e2ac
```

When running `make micro_release`, `./configure` gets re-run, but without any flags we passed it previously.  So it doesn't preserve our `--with-python=3` from earlier.



---

archive/issue_comments_438981.json:
```json
{
    "body": "<a id='comment:6'></a>\n(CC Odile who was interested in having a working Python 3 Docker image)",
    "created_at": "2019-07-03T13:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438981",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>
(CC Odile who was interested in having a working Python 3 Docker image)



---

archive/issue_comments_438982.json:
```json
{
    "body": "<a id='comment:7'></a>\nSorry for this. We had already figured the broken `./configure` when `micro_release` is run. I thought that Samuel had pushed a fix for this here already.",
    "created_at": "2019-07-03T13:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438982",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:7'></a>
Sorry for this. We had already figured the broken `./configure` when `micro_release` is run. I thought that Samuel had pushed a fix for this here already.



---

archive/issue_comments_438983.json:
```json
{
    "body": "<a id='comment:8'></a>\nIsn't the preservation of `config` good enough for this? (See the changeset here.)",
    "created_at": "2019-07-03T13:35:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438983",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:8'></a>
Isn't the preservation of `config` good enough for this? (See the changeset here.)



---

archive/issue_comments_438984.json:
```json
{
    "body": "<a id='comment:9'></a>\nI was just about to say: I think the preservation of `config.status` is good enough in fact.",
    "created_at": "2019-07-03T13:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438984",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
I was just about to say: I think the preservation of `config.status` is good enough in fact.



---

archive/issue_comments_438985.json:
```json
{
    "body": "<a id='comment:10'></a>\nSpecifically, one of the prereqs of `micro_release` is the `bdist-clean` target, which in turn calls `$(MAKE) misc-clean` which deletes `config.status`, forcing `configure` to be re-run.",
    "created_at": "2019-07-03T13:38:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438985",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>
Specifically, one of the prereqs of `micro_release` is the `bdist-clean` target, which in turn calls `$(MAKE) misc-clean` which deletes `config.status`, forcing `configure` to be re-run.



---

archive/issue_comments_438986.json:
```json
{
    "body": "<a id='comment:11'></a>\nWhat the `bdist-clean`? Is this a automake target? Otherwise is it reasonable that the build system's config is visible after running it?",
    "created_at": "2019-07-03T13:45:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438986",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:11'></a>
What the `bdist-clean`? Is this a automake target? Otherwise is it reasonable that the build system's config is visible after running it?



---

archive/issue_comments_438987.json:
```json
{
    "body": "<a id='comment:12'></a>\nNot sure, but I think just swapping `sagelib-clean` and `bdist-clean` in the prereqs for `micro_release` should suffice.  It's fragile, but I think it will work.  Testing now.",
    "created_at": "2019-07-03T13:47:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438987",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
Not sure, but I think just swapping `sagelib-clean` and `bdist-clean` in the prereqs for `micro_release` should suffice.  It's fragile, but I think it will work.  Testing now.



---

archive/issue_comments_438988.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [@saraedum](#comment%3A11):\n> What the `bdist-clean`? Is this a automake target? Otherwise is it reasonable that the build system's config is visible after running it?\n\nNo, this is just a pseudo-target in Sage's top-level Makefile.  I have no idea why specifically it's named that.  It's also used by the `fast-rebuild-clean` target.  It just calls `clean` (which is in `build/make/Makefile` for some reason), and then `misc-clean`.\n\nAll `clean` does apparently is:\n\n```\nclean:\n    @echo \"Deleting package build directories...\"\n    rm -rf \"$(SAGE_LOCAL)/var/tmp/sage/build\"\n```\n\nwhich is certainly worth doing.  But maybe this needs to be detangled a bit...",
    "created_at": "2019-07-03T13:51:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438988",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>
Replying to [@saraedum](#comment%3A11):
> What the `bdist-clean`? Is this a automake target? Otherwise is it reasonable that the build system's config is visible after running it?

No, this is just a pseudo-target in Sage's top-level Makefile.  I have no idea why specifically it's named that.  It's also used by the `fast-rebuild-clean` target.  It just calls `clean` (which is in `build/make/Makefile` for some reason), and then `misc-clean`.

All `clean` does apparently is:

```
clean:
    @echo "Deleting package build directories..."
    rm -rf "$(SAGE_LOCAL)/var/tmp/sage/build"
```

which is certainly worth doing.  But maybe this needs to be detangled a bit...



---

archive/issue_comments_438989.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe following files in `docker/` probably still need changes:\n\n- `build-docker.sh`\n- `pull-gitlab.sh`\n- `push-dockerhub.sh`\n- `push-gitlab.sh`\n- `setup-make-parallelity.sh`\n- `test-dev.sh`\n- `update-env.sh`",
    "created_at": "2019-07-03T14:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438989",
    "user": "https://github.com/slel"
}
```

<a id='comment:14'></a>
The following files in `docker/` probably still need changes:

- `build-docker.sh`
- `pull-gitlab.sh`
- `push-dockerhub.sh`
- `push-gitlab.sh`
- `setup-make-parallelity.sh`
- `test-dev.sh`
- `update-env.sh`



---

archive/issue_comments_438990.json:
```json
{
    "body": "<a id='comment:15'></a>\nYes, most likely.  One I just get the docker build working locally I will try adding all the other relevant updates.\n\nIt would be nice for starters to get *a* Python 3 image on Docker Hub, even if I have to push it manually, then get future ones building automatically.",
    "created_at": "2019-07-04T12:40:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438990",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Yes, most likely.  One I just get the docker build working locally I will try adding all the other relevant updates.

It would be nice for starters to get *a* Python 3 image on Docker Hub, even if I have to push it manually, then get future ones building automatically.



---

archive/issue_comments_438991.json:
```json
{
    "body": "<a id='comment:16'></a>\nI think that once your Dockerfile goes through, you just need to add your branch to `build-from-clean`, pull your image from the [GitLab](../wiki/GitLab) registry and push it to Docker Hub.",
    "created_at": "2019-07-04T16:45:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438991",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:16'></a>
I think that once your Dockerfile goes through, you just need to add your branch to `build-from-clean`, pull your image from the [GitLab](../wiki/GitLab) registry and push it to Docker Hub.



---

archive/issue_comments_438992.json:
```json
{
    "body": "<a id='comment:17'></a>\nFor Odile's use I went ahead and pushed a prototype of this up to Dockerhub: sagemath/sagemath-dev-py3:alpha\n\nUnfortunately it still has a bug.  The `sage-entrypoint` still tries to run `make build` (understandably) which results in re-configuring (needlessly) and breaking things.\n\nA workaround for now is to set the PREREQ_OPTIONS variable which is used by Sage's top-level Makefile when it runs configure.  So you can set this when running the container like:\n\n```\ndocker run -ti --rm -e PREREQ_OPTIONS='--with-python=3' sagemath/sagemath-dev-py3:alpha\n```\n\nNext up, I think we should modify the Docker build to at least keep config.status so that this doesn't keep happening.",
    "created_at": "2019-07-09T16:21:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438992",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
For Odile's use I went ahead and pushed a prototype of this up to Dockerhub: sagemath/sagemath-dev-py3:alpha

Unfortunately it still has a bug.  The `sage-entrypoint` still tries to run `make build` (understandably) which results in re-configuring (needlessly) and breaking things.

A workaround for now is to set the PREREQ_OPTIONS variable which is used by Sage's top-level Makefile when it runs configure.  So you can set this when running the container like:

```
docker run -ti --rm -e PREREQ_OPTIONS='--with-python=3' sagemath/sagemath-dev-py3:alpha
```

Next up, I think we should modify the Docker build to at least keep config.status so that this doesn't keep happening.



---

archive/issue_comments_438993.json:
```json
{
    "body": "<a id='comment:18'></a>\nApparently I was not able to successfully upload the Docker image to hub.docker.com because (AFAICT) of [this issue](https://github.com/moby/moby/issues/33558#issuecomment-510479853).\n\nBut I was able to upload it to our image registry on gitlab.com.   So try:\n\n```\ndocker run -ti --rm -e PREREQ_OPTIONS='--with-python=3' registry.gitlab.com/sagemath/dev/sage/sagemath-dev-py3:alpha\n```\n\nYou can also use this image as a base for another Docker image by doing something like:\n\n```\nFROM registry.gitlab.com/sagemath/dev/sage/sagemath-dev-py3:alpha\nENV PREREQ_OPTIONS='--with-python=3'\n...\n```\n\nThat is, you would ensure `PREREQ_OPTIONS` is set as an environment variable in the new image, by default.\n\nThis is not ideal and should be fixed, but it's a start anyways...",
    "created_at": "2019-07-11T14:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438993",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'></a>
Apparently I was not able to successfully upload the Docker image to hub.docker.com because (AFAICT) of [this issue](https://github.com/moby/moby/issues/33558#issuecomment-510479853).

But I was able to upload it to our image registry on gitlab.com.   So try:

```
docker run -ti --rm -e PREREQ_OPTIONS='--with-python=3' registry.gitlab.com/sagemath/dev/sage/sagemath-dev-py3:alpha
```

You can also use this image as a base for another Docker image by doing something like:

```
FROM registry.gitlab.com/sagemath/dev/sage/sagemath-dev-py3:alpha
ENV PREREQ_OPTIONS='--with-python=3'
...
```

That is, you would ensure `PREREQ_OPTIONS` is set as an environment variable in the new image, by default.

This is not ideal and should be fixed, but it's a start anyways...



---

archive/issue_comments_438994.json:
```json
{
    "body": "**Changing author** from \"Samuel Leli\u00e8vre\" to \"Samuel Leli\u00e8vre, Julian R\u00fcth\".",
    "created_at": "2019-08-19T18:08:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438994",
    "user": "https://github.com/saraedum"
}
```

**Changing author** from "Samuel Lelièvre" to "Samuel Lelièvre, Julian Rüth".



---

archive/issue_comments_438995.json:
```json
{
    "body": "**Changing branch** from \"[u/galois/mrs/22/docker-python3](https://github.com/sagemath/sagetrac-mirror/tree/u/galois/mrs/22/docker-python3)\" to \"[u/saraedum/mrs/22/docker-python3](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/mrs/22/docker-python3)\".",
    "created_at": "2019-08-19T18:44:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438995",
    "user": "https://github.com/saraedum"
}
```

**Changing branch** from "[u/galois/mrs/22/docker-python3](https://github.com/sagemath/sagetrac-mirror/tree/u/galois/mrs/22/docker-python3)" to "[u/saraedum/mrs/22/docker-python3](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/mrs/22/docker-python3)".



---

archive/issue_comments_438996.json:
```json
{
    "body": "**Changing commit** from \"[7c23b4287435e9df1b7ac03c113d861f2ca3a7bd](https://github.com/sagemath/sagetrac-mirror/commit/7c23b4287435e9df1b7ac03c113d861f2ca3a7bd)\" to \"[2f108acfd0c41e736d327772a6e144a10337a028](https://github.com/sagemath/sagetrac-mirror/commit/2f108acfd0c41e736d327772a6e144a10337a028)\".",
    "created_at": "2019-08-19T19:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438996",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[7c23b4287435e9df1b7ac03c113d861f2ca3a7bd](https://github.com/sagemath/sagetrac-mirror/commit/7c23b4287435e9df1b7ac03c113d861f2ca3a7bd)" to "[2f108acfd0c41e736d327772a6e144a10337a028](https://github.com/sagemath/sagetrac-mirror/commit/2f108acfd0c41e736d327772a6e144a10337a028)".



---

archive/issue_comments_438997.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f108acfd0c41e736d327772a6e144a10337a028\">2f108ac</a></td><td><code>Build py3 from clean</code></td></tr></table>\n",
    "created_at": "2019-08-19T19:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438997",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f108acfd0c41e736d327772a6e144a10337a028">2f108ac</a></td><td><code>Build py3 from clean</code></td></tr></table>




---

archive/issue_comments_438998.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed\">f5ba6d3</a></td><td><code>Fix VARIABLES of Python3 builds</code></td></tr></table>\n",
    "created_at": "2019-08-19T19:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438998",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed">f5ba6d3</a></td><td><code>Fix VARIABLES of Python3 builds</code></td></tr></table>




---

archive/issue_comments_438999.json:
```json
{
    "body": "**Changing commit** from \"[2f108acfd0c41e736d327772a6e144a10337a028](https://github.com/sagemath/sagetrac-mirror/commit/2f108acfd0c41e736d327772a6e144a10337a028)\" to \"[f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed](https://github.com/sagemath/sagetrac-mirror/commit/f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed)\".",
    "created_at": "2019-08-19T19:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-438999",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[2f108acfd0c41e736d327772a6e144a10337a028](https://github.com/sagemath/sagetrac-mirror/commit/2f108acfd0c41e736d327772a6e144a10337a028)" to "[f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed](https://github.com/sagemath/sagetrac-mirror/commit/f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed)".



---

archive/issue_comments_439000.json:
```json
{
    "body": "**Changing commit** from \"[f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed](https://github.com/sagemath/sagetrac-mirror/commit/f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed)\" to \"[a21467a28fe44b32f66ed9b669ddebd90fb8fff0](https://github.com/sagemath/sagetrac-mirror/commit/a21467a28fe44b32f66ed9b669ddebd90fb8fff0)\".",
    "created_at": "2019-08-19T20:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439000",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed](https://github.com/sagemath/sagetrac-mirror/commit/f5ba6d3c54fbb4e68e7a9ae891e3bd3d8eb581ed)" to "[a21467a28fe44b32f66ed9b669ddebd90fb8fff0](https://github.com/sagemath/sagetrac-mirror/commit/a21467a28fe44b32f66ed9b669ddebd90fb8fff0)".



---

archive/issue_comments_439001.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a21467a28fe44b32f66ed9b669ddebd90fb8fff0\">a21467a</a></td><td><code>Limit docker build output</code></td></tr></table>\n",
    "created_at": "2019-08-19T20:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439001",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a21467a28fe44b32f66ed9b669ddebd90fb8fff0">a21467a</a></td><td><code>Limit docker build output</code></td></tr></table>




---

archive/issue_comments_439002.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6619e3171933f97c4cda24823d055def2ff4c86f\">6619e31</a></td><td><code>Limit docker build output</code></td></tr></table>\n",
    "created_at": "2019-08-19T20:43:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439002",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6619e3171933f97c4cda24823d055def2ff4c86f">6619e31</a></td><td><code>Limit docker build output</code></td></tr></table>




---

archive/issue_comments_439003.json:
```json
{
    "body": "**Changing commit** from \"[a21467a28fe44b32f66ed9b669ddebd90fb8fff0](https://github.com/sagemath/sagetrac-mirror/commit/a21467a28fe44b32f66ed9b669ddebd90fb8fff0)\" to \"[6619e3171933f97c4cda24823d055def2ff4c86f](https://github.com/sagemath/sagetrac-mirror/commit/6619e3171933f97c4cda24823d055def2ff4c86f)\".",
    "created_at": "2019-08-19T20:43:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439003",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[a21467a28fe44b32f66ed9b669ddebd90fb8fff0](https://github.com/sagemath/sagetrac-mirror/commit/a21467a28fe44b32f66ed9b669ddebd90fb8fff0)" to "[6619e3171933f97c4cda24823d055def2ff4c86f](https://github.com/sagemath/sagetrac-mirror/commit/6619e3171933f97c4cda24823d055def2ff4c86f)".



---

archive/issue_comments_439004.json:
```json
{
    "body": "**Changing commit** from \"[6619e3171933f97c4cda24823d055def2ff4c86f](https://github.com/sagemath/sagetrac-mirror/commit/6619e3171933f97c4cda24823d055def2ff4c86f)\" to \"[497077d29f3ad5d1cea4d6edc13fce442d1858c6](https://github.com/sagemath/sagetrac-mirror/commit/497077d29f3ad5d1cea4d6edc13fce442d1858c6)\".",
    "created_at": "2019-08-20T01:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439004",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[6619e3171933f97c4cda24823d055def2ff4c86f](https://github.com/sagemath/sagetrac-mirror/commit/6619e3171933f97c4cda24823d055def2ff4c86f)" to "[497077d29f3ad5d1cea4d6edc13fce442d1858c6](https://github.com/sagemath/sagetrac-mirror/commit/497077d29f3ad5d1cea4d6edc13fce442d1858c6)".



---

archive/issue_comments_439005.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/497077d29f3ad5d1cea4d6edc13fce442d1858c6\">497077d</a></td><td><code>Merge latest beta into docker-py3</code></td></tr></table>\n",
    "created_at": "2019-08-20T01:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439005",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/497077d29f3ad5d1cea4d6edc13fce442d1858c6">497077d</a></td><td><code>Merge latest beta into docker-py3</code></td></tr></table>




---

archive/issue_comments_439006.json:
```json
{
    "body": "**Changing commit** from \"[497077d29f3ad5d1cea4d6edc13fce442d1858c6](https://github.com/sagemath/sagetrac-mirror/commit/497077d29f3ad5d1cea4d6edc13fce442d1858c6)\" to \"[155e3ac26de16a7808287d618c2b8ca23891e617](https://github.com/sagemath/sagetrac-mirror/commit/155e3ac26de16a7808287d618c2b8ca23891e617)\".",
    "created_at": "2019-08-20T01:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439006",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[497077d29f3ad5d1cea4d6edc13fce442d1858c6](https://github.com/sagemath/sagetrac-mirror/commit/497077d29f3ad5d1cea4d6edc13fce442d1858c6)" to "[155e3ac26de16a7808287d618c2b8ca23891e617](https://github.com/sagemath/sagetrac-mirror/commit/155e3ac26de16a7808287d618c2b8ca23891e617)".



---

archive/issue_comments_439007.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/155e3ac26de16a7808287d618c2b8ca23891e617\">155e3ac</a></td><td><code>Build docker in parallel</code></td></tr></table>\n",
    "created_at": "2019-08-20T01:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439007",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/155e3ac26de16a7808287d618c2b8ca23891e617">155e3ac</a></td><td><code>Build docker in parallel</code></td></tr></table>




---

archive/issue_comments_439008.json:
```json
{
    "body": "**Changing commit** from \"[155e3ac26de16a7808287d618c2b8ca23891e617](https://github.com/sagemath/sagetrac-mirror/commit/155e3ac26de16a7808287d618c2b8ca23891e617)\" to \"[7c9ea5510b96a9ca0887c80a389e59101f159fb7](https://github.com/sagemath/sagetrac-mirror/commit/7c9ea5510b96a9ca0887c80a389e59101f159fb7)\".",
    "created_at": "2019-08-20T01:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439008",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[155e3ac26de16a7808287d618c2b8ca23891e617](https://github.com/sagemath/sagetrac-mirror/commit/155e3ac26de16a7808287d618c2b8ca23891e617)" to "[7c9ea5510b96a9ca0887c80a389e59101f159fb7](https://github.com/sagemath/sagetrac-mirror/commit/7c9ea5510b96a9ca0887c80a389e59101f159fb7)".



---

archive/issue_comments_439009.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c9ea5510b96a9ca0887c80a389e59101f159fb7\">7c9ea55</a></td><td><code>Build docker in parallel</code></td></tr></table>\n",
    "created_at": "2019-08-20T01:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439009",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c9ea5510b96a9ca0887c80a389e59101f159fb7">7c9ea55</a></td><td><code>Build docker in parallel</code></td></tr></table>




---

archive/issue_comments_439010.json:
```json
{
    "body": "<a id='comment:28'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d36ffe11333b5fc3181de80a547c331da4b14b81\">d36ffe1</a></td><td><code>Push Python 3 docker images to *-py3</code></td></tr></table>\n",
    "created_at": "2019-08-20T02:05:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439010",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d36ffe11333b5fc3181de80a547c331da4b14b81">d36ffe1</a></td><td><code>Push Python 3 docker images to *-py3</code></td></tr></table>




---

archive/issue_comments_439011.json:
```json
{
    "body": "**Changing commit** from \"[7c9ea5510b96a9ca0887c80a389e59101f159fb7](https://github.com/sagemath/sagetrac-mirror/commit/7c9ea5510b96a9ca0887c80a389e59101f159fb7)\" to \"[d36ffe11333b5fc3181de80a547c331da4b14b81](https://github.com/sagemath/sagetrac-mirror/commit/d36ffe11333b5fc3181de80a547c331da4b14b81)\".",
    "created_at": "2019-08-20T02:05:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439011",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[7c9ea5510b96a9ca0887c80a389e59101f159fb7](https://github.com/sagemath/sagetrac-mirror/commit/7c9ea5510b96a9ca0887c80a389e59101f159fb7)" to "[d36ffe11333b5fc3181de80a547c331da4b14b81](https://github.com/sagemath/sagetrac-mirror/commit/d36ffe11333b5fc3181de80a547c331da4b14b81)".



---

archive/issue_comments_439012.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a229ffcedaf9d27fb7389d6612a65e58ead938e3\">a229ffc</a></td><td><code>Undo docker changes</code></td></tr></table>\n",
    "created_at": "2019-08-20T03:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439012",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a229ffcedaf9d27fb7389d6612a65e58ead938e3">a229ffc</a></td><td><code>Undo docker changes</code></td></tr></table>




---

archive/issue_comments_439013.json:
```json
{
    "body": "**Changing commit** from \"[d36ffe11333b5fc3181de80a547c331da4b14b81](https://github.com/sagemath/sagetrac-mirror/commit/d36ffe11333b5fc3181de80a547c331da4b14b81)\" to \"[a229ffcedaf9d27fb7389d6612a65e58ead938e3](https://github.com/sagemath/sagetrac-mirror/commit/a229ffcedaf9d27fb7389d6612a65e58ead938e3)\".",
    "created_at": "2019-08-20T03:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439013",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d36ffe11333b5fc3181de80a547c331da4b14b81](https://github.com/sagemath/sagetrac-mirror/commit/d36ffe11333b5fc3181de80a547c331da4b14b81)" to "[a229ffcedaf9d27fb7389d6612a65e58ead938e3](https://github.com/sagemath/sagetrac-mirror/commit/a229ffcedaf9d27fb7389d6612a65e58ead938e3)".



---

archive/issue_events_247499.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-08-20T03:22:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247499"
}
```



---

archive/issue_events_247500.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-08-20T03:22:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247500"
}
```



---

archive/issue_comments_439014.json:
```json
{
    "body": "<a id='comment:31'></a>\nSee #28367 for the related README update.",
    "created_at": "2019-08-20T03:23:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439014",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:31'></a>
See #28367 for the related README update.



---

archive/issue_comments_439015.json:
```json
{
    "body": "<a id='comment:32'></a>\nWe pushed initial docker `-py3` images to the Docker Hub.",
    "created_at": "2019-08-20T04:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439015",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:32'></a>
We pushed initial docker `-py3` images to the Docker Hub.



---

archive/issue_comments_439016.json:
```json
{
    "body": "**Changing commit** from \"[a229ffcedaf9d27fb7389d6612a65e58ead938e3](https://github.com/sagemath/sagetrac-mirror/commit/a229ffcedaf9d27fb7389d6612a65e58ead938e3)\" to \"[22da0878d4de129b13b4847c4090808601d9b27a](https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a)\".",
    "created_at": "2019-08-20T04:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439016",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[a229ffcedaf9d27fb7389d6612a65e58ead938e3](https://github.com/sagemath/sagetrac-mirror/commit/a229ffcedaf9d27fb7389d6612a65e58ead938e3)" to "[22da0878d4de129b13b4847c4090808601d9b27a](https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a)".



---

archive/issue_comments_439017.json:
```json
{
    "body": "<a id='comment:33'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a\">22da087</a></td><td><code>do not remove config.status from dev image</code></td></tr></table>\n",
    "created_at": "2019-08-20T04:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439017",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:33'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a">22da087</a></td><td><code>do not remove config.status from dev image</code></td></tr></table>




---

archive/issue_comments_439018.json:
```json
{
    "body": "<a id='comment:34'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a\">22da087</a></td><td><code>do not remove config.status from dev image</code></td></tr></table>\n",
    "created_at": "2019-08-20T04:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439018",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:34'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a">22da087</a></td><td><code>do not remove config.status from dev image</code></td></tr></table>




---

archive/issue_comments_439019.json:
```json
{
    "body": "**Work Issues:** check that the sagemath-dev image actually works",
    "created_at": "2019-08-20T04:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439019",
    "user": "https://github.com/saraedum"
}
```

**Work Issues:** check that the sagemath-dev image actually works



---

archive/issue_events_247501.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-08-20T04:15:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247501"
}
```



---

archive/issue_events_247502.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-08-20T04:15:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247502"
}
```



---

archive/issue_comments_439020.json:
```json
{
    "body": "**Changing work issues** from \"check that the sagemath-dev image actually works\" to \"\".",
    "created_at": "2019-08-20T23:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439020",
    "user": "https://github.com/saraedum"
}
```

**Changing work issues** from "check that the sagemath-dev image actually works" to "".



---

archive/issue_events_247503.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-08-20T23:58:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247503"
}
```



---

archive/issue_events_247504.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-08-20T23:58:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247504"
}
```



---

archive/issue_comments_439021.json:
```json
{
    "body": "<a id='comment:36'></a>\nWhen this is for sure ready can we squash some of these commits?",
    "created_at": "2019-08-21T10:50:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439021",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>
When this is for sure ready can we squash some of these commits?



---

archive/issue_comments_439022.json:
```json
{
    "body": "<a id='comment:37'></a>\nJust out of curiosity, is there a specific meaning to having a section in `.gitlab-ci.yml` that begins with a `.`, as in `.py3`?  Does that just emphasize that it's not a real build stage (rather a \"mix-in\" for multiple build stages)?  Or is that a syntax specifically recognized by the file format?\n\nIf I understand correctly, this is now keeping `config.status` in the image.  But what if someone runs `sage -i <some_optional_package>` in one of these py3 images?  In other words, if a user (or dockerfile author) does something that still results in `./configure` being re-run, will this keep the `--with-python=3` setting?\n\nI fear not, since we still haven't fully resolved #27373 (which related to system package settings specifically, but more broadly to retaining the values of flags passed to `./configure`).  The larger problem of course being that we have \"runtime\" features like `sage -i` that depend on running `./configure` at all...",
    "created_at": "2019-08-21T11:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439022",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'></a>
Just out of curiosity, is there a specific meaning to having a section in `.gitlab-ci.yml` that begins with a `.`, as in `.py3`?  Does that just emphasize that it's not a real build stage (rather a "mix-in" for multiple build stages)?  Or is that a syntax specifically recognized by the file format?

If I understand correctly, this is now keeping `config.status` in the image.  But what if someone runs `sage -i <some_optional_package>` in one of these py3 images?  In other words, if a user (or dockerfile author) does something that still results in `./configure` being re-run, will this keep the `--with-python=3` setting?

I fear not, since we still haven't fully resolved #27373 (which related to system package settings specifically, but more broadly to retaining the values of flags passed to `./configure`).  The larger problem of course being that we have "runtime" features like `sage -i` that depend on running `./configure` at all...



---

archive/issue_comments_439023.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [@embray](#comment%3A36):\n> When this is for sure ready can we squash some of these commits?\n\nFeel free to squash.",
    "created_at": "2019-08-21T14:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439023",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:38'></a>
Replying to [@embray](#comment%3A36):
> When this is for sure ready can we squash some of these commits?

Feel free to squash.



---

archive/issue_comments_439024.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [@embray](#comment%3A37):\n> Just out of curiosity, is there a specific meaning to having a section in `.gitlab-ci.yml` that begins with a `.`, as in `.py3`?  Does that just emphasize that it's not a real build stage (rather a \"mix-in\" for multiple build stages)?  Or is that a syntax specifically recognized by the file format?\n\nWithout out the `.` it would be a build job. As a default as port of the `test` stage I believe.\n\n> If I understand correctly, this is now keeping `config.status` in the image.  But what if someone runs `sage -i <some_optional_package>` in one of these py3 images?  In other words, if a user (or dockerfile author) does something that still results in `./configure` being re-run, will this keep the `--with-python=3` setting?\n\nDoes `sage -i` run `configure` when `config.status` is present?\n\n> I fear not, since we still haven't fully resolved #27373 (which related to system package settings specifically, but more broadly to retaining the values of flags passed to `./configure`).  The larger problem of course being that we have \"runtime\" features like `sage -i` that depend on running `./configure` at all...\n\nI don't think making `--with-python=3` persistent is within the scope of this ticket. But it's certainly a problem that we should be aware of.",
    "created_at": "2019-08-21T14:33:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439024",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:39'></a>
Replying to [@embray](#comment%3A37):
> Just out of curiosity, is there a specific meaning to having a section in `.gitlab-ci.yml` that begins with a `.`, as in `.py3`?  Does that just emphasize that it's not a real build stage (rather a "mix-in" for multiple build stages)?  Or is that a syntax specifically recognized by the file format?

Without out the `.` it would be a build job. As a default as port of the `test` stage I believe.

> If I understand correctly, this is now keeping `config.status` in the image.  But what if someone runs `sage -i <some_optional_package>` in one of these py3 images?  In other words, if a user (or dockerfile author) does something that still results in `./configure` being re-run, will this keep the `--with-python=3` setting?

Does `sage -i` run `configure` when `config.status` is present?

> I fear not, since we still haven't fully resolved #27373 (which related to system package settings specifically, but more broadly to retaining the values of flags passed to `./configure`).  The larger problem of course being that we have "runtime" features like `sage -i` that depend on running `./configure` at all...

I don't think making `--with-python=3` persistent is within the scope of this ticket. But it's certainly a problem that we should be aware of.



---

archive/issue_comments_439025.json:
```json
{
    "body": "**Changing commit** from \"[22da0878d4de129b13b4847c4090808601d9b27a](https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a)\" to \"[c3d9c146ae520ed9198835bc3c100428f9a9b26a](https://github.com/sagemath/sagetrac-mirror/commit/c3d9c146ae520ed9198835bc3c100428f9a9b26a)\".",
    "created_at": "2019-09-06T02:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439025",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[22da0878d4de129b13b4847c4090808601d9b27a](https://github.com/sagemath/sagetrac-mirror/commit/22da0878d4de129b13b4847c4090808601d9b27a)" to "[c3d9c146ae520ed9198835bc3c100428f9a9b26a](https://github.com/sagemath/sagetrac-mirror/commit/c3d9c146ae520ed9198835bc3c100428f9a9b26a)".



---

archive/issue_comments_439026.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3d9c146ae520ed9198835bc3c100428f9a9b26a\">c3d9c14</a></td><td><code>Keep misc-clean around longer in Makefile</code></td></tr></table>\n",
    "created_at": "2019-09-06T02:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439026",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3d9c146ae520ed9198835bc3c100428f9a9b26a">c3d9c14</a></td><td><code>Keep misc-clean around longer in Makefile</code></td></tr></table>




---

archive/issue_comments_439027.json:
```json
{
    "body": "<a id='comment:41'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54319874059f41512b6e812f020aed93eb7d0c0e\">5431987</a></td><td><code>Merge remote-tracking branch 'trac/develop' into 28041</code></td></tr></table>\n",
    "created_at": "2019-09-06T03:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439027",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:41'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54319874059f41512b6e812f020aed93eb7d0c0e">5431987</a></td><td><code>Merge remote-tracking branch 'trac/develop' into 28041</code></td></tr></table>




---

archive/issue_comments_439028.json:
```json
{
    "body": "**Changing commit** from \"[c3d9c146ae520ed9198835bc3c100428f9a9b26a](https://github.com/sagemath/sagetrac-mirror/commit/c3d9c146ae520ed9198835bc3c100428f9a9b26a)\" to \"[54319874059f41512b6e812f020aed93eb7d0c0e](https://github.com/sagemath/sagetrac-mirror/commit/54319874059f41512b6e812f020aed93eb7d0c0e)\".",
    "created_at": "2019-09-06T03:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439028",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c3d9c146ae520ed9198835bc3c100428f9a9b26a](https://github.com/sagemath/sagetrac-mirror/commit/c3d9c146ae520ed9198835bc3c100428f9a9b26a)" to "[54319874059f41512b6e812f020aed93eb7d0c0e](https://github.com/sagemath/sagetrac-mirror/commit/54319874059f41512b6e812f020aed93eb7d0c0e)".



---

archive/issue_comments_439029.json:
```json
{
    "body": "<a id='comment:42'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45268e7aef055f0c180d45235f636b1683091532\">45268e7</a></td><td><code>fix grammar</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e2895410b78715824ae0c1484baa20c8e317ab6\">6e28954</a></td><td><code>Cleanup py-3 script</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb61f30d371a69c7b0385b5b300c447774b8caa8\">cb61f30</a></td><td><code>Merge remote-tracking branch 'trac/develop' into 28041</code></td></tr></table>\n",
    "created_at": "2019-09-13T08:48:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439029",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:42'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45268e7aef055f0c180d45235f636b1683091532">45268e7</a></td><td><code>fix grammar</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e2895410b78715824ae0c1484baa20c8e317ab6">6e28954</a></td><td><code>Cleanup py-3 script</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb61f30d371a69c7b0385b5b300c447774b8caa8">cb61f30</a></td><td><code>Merge remote-tracking branch 'trac/develop' into 28041</code></td></tr></table>




---

archive/issue_comments_439030.json:
```json
{
    "body": "**Changing commit** from \"[54319874059f41512b6e812f020aed93eb7d0c0e](https://github.com/sagemath/sagetrac-mirror/commit/54319874059f41512b6e812f020aed93eb7d0c0e)\" to \"[cb61f30d371a69c7b0385b5b300c447774b8caa8](https://github.com/sagemath/sagetrac-mirror/commit/cb61f30d371a69c7b0385b5b300c447774b8caa8)\".",
    "created_at": "2019-09-13T08:48:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439030",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[54319874059f41512b6e812f020aed93eb7d0c0e](https://github.com/sagemath/sagetrac-mirror/commit/54319874059f41512b6e812f020aed93eb7d0c0e)" to "[cb61f30d371a69c7b0385b5b300c447774b8caa8](https://github.com/sagemath/sagetrac-mirror/commit/cb61f30d371a69c7b0385b5b300c447774b8caa8)".



---

archive/issue_comments_439031.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a9dd58910e1b04f1e21ae23673022592513b3b8\">9a9dd58</a></td><td><code>Merge remote-tracking branch 'trac/develop' into 28041</code></td></tr></table>\n",
    "created_at": "2019-09-13T08:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439031",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a9dd58910e1b04f1e21ae23673022592513b3b8">9a9dd58</a></td><td><code>Merge remote-tracking branch 'trac/develop' into 28041</code></td></tr></table>




---

archive/issue_comments_439032.json:
```json
{
    "body": "**Changing commit** from \"[cb61f30d371a69c7b0385b5b300c447774b8caa8](https://github.com/sagemath/sagetrac-mirror/commit/cb61f30d371a69c7b0385b5b300c447774b8caa8)\" to \"[9a9dd58910e1b04f1e21ae23673022592513b3b8](https://github.com/sagemath/sagetrac-mirror/commit/9a9dd58910e1b04f1e21ae23673022592513b3b8)\".",
    "created_at": "2019-09-13T08:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439032",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[cb61f30d371a69c7b0385b5b300c447774b8caa8](https://github.com/sagemath/sagetrac-mirror/commit/cb61f30d371a69c7b0385b5b300c447774b8caa8)" to "[9a9dd58910e1b04f1e21ae23673022592513b3b8](https://github.com/sagemath/sagetrac-mirror/commit/9a9dd58910e1b04f1e21ae23673022592513b3b8)".



---

archive/issue_comments_439033.json:
```json
{
    "body": "**Changing branch** from \"[u/saraedum/mrs/22/docker-python3](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/mrs/22/docker-python3)\" to \"\".",
    "created_at": "2019-09-13T09:01:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439033",
    "user": "https://github.com/saraedum"
}
```

**Changing branch** from "[u/saraedum/mrs/22/docker-python3](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/mrs/22/docker-python3)" to "".



---

archive/issue_comments_439034.json:
```json
{
    "body": "**Changing commit** from \"[9a9dd58910e1b04f1e21ae23673022592513b3b8](https://github.com/sagemath/sagetrac-mirror/commit/9a9dd58910e1b04f1e21ae23673022592513b3b8)\" to \"\".",
    "created_at": "2019-09-13T09:01:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439034",
    "user": "https://github.com/saraedum"
}
```

**Changing commit** from "[9a9dd58910e1b04f1e21ae23673022592513b3b8](https://github.com/sagemath/sagetrac-mirror/commit/9a9dd58910e1b04f1e21ae23673022592513b3b8)" to "".



---

archive/issue_comments_439035.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,8 +14,3 @@\n   a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`\n   environment variables, and using them in the shell\n   scripts `docker/*.sh`.\n-\n-This ticket was created from a merge request opened by\n-Samuel Leli\u00e8vre ([@slel](https://gitlab.com/slel)) on GitLab\n-at https://gitlab.com/sagemath/sage/merge_requests/22.\n-\n``````\n",
    "created_at": "2019-09-13T09:01:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439035",
    "user": "https://github.com/saraedum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,8 +14,3 @@
   a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`
   environment variables, and using them in the shell
   scripts `docker/*.sh`.
-
-This ticket was created from a merge request opened by
-Samuel Lelièvre ([@slel](https://gitlab.com/slel)) on GitLab
-at https://gitlab.com/sagemath/sage/merge_requests/22.
-
``````




---

archive/issue_comments_439036.json:
```json
{
    "body": "**Branch:** [u/saraedum/28041](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/28041)",
    "created_at": "2019-09-13T09:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439036",
    "user": "https://github.com/saraedum"
}
```

**Branch:** [u/saraedum/28041](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/28041)



---

archive/issue_comments_439037.json:
```json
{
    "body": "**Commit:** [89c78f8b903f225a5f2b18cc41adc245c9326964](https://github.com/sagemath/sagetrac-mirror/commit/89c78f8b903f225a5f2b18cc41adc245c9326964)",
    "created_at": "2019-09-13T09:02:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439037",
    "user": "https://github.com/sagetrac-git"
}
```

**Commit:** [89c78f8b903f225a5f2b18cc41adc245c9326964](https://github.com/sagemath/sagetrac-mirror/commit/89c78f8b903f225a5f2b18cc41adc245c9326964)



---

archive/issue_comments_439038.json:
```json
{
    "body": "<a id='comment:46'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89c78f8b903f225a5f2b18cc41adc245c9326964\">89c78f8</a></td><td><code>Cleanup py-3 script</code></td></tr></table>\n",
    "created_at": "2019-09-13T09:02:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439038",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:46'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89c78f8b903f225a5f2b18cc41adc245c9326964">89c78f8</a></td><td><code>Cleanup py-3 script</code></td></tr></table>




---

archive/issue_comments_439039.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,3 +14,5 @@\n   a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`\n   environment variables, and using them in the shell\n   scripts `docker/*.sh`.\n+\n+To play with the generated Python 2/3 docker images, you can go to https://gitlab-hooks-flau3jeaza-ew.a.run.app/status/trac/branch/u%2Fsaraedum%2F28041\n``````\n",
    "created_at": "2019-09-13T09:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439039",
    "user": "https://github.com/saraedum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,3 +14,5 @@
   a `WITH_PYTHON` and a `DOCKER_TAG_SUFFIX`
   environment variables, and using them in the shell
   scripts `docker/*.sh`.
+
+To play with the generated Python 2/3 docker images, you can go to https://gitlab-hooks-flau3jeaza-ew.a.run.app/status/trac/branch/u%2Fsaraedum%2F28041
``````




---

archive/issue_comments_439040.json:
```json
{
    "body": "<a id='comment:47'></a>\nthe docker images should be available on binder shortly: https://gitlab.com/sagemath/dev/trac/pipelines/81996545",
    "created_at": "2019-09-13T09:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439040",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:47'></a>
the docker images should be available on binder shortly: https://gitlab.com/sagemath/dev/trac/pipelines/81996545



---

archive/issue_comments_439041.json:
```json
{
    "body": "<a id='comment:49'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d02785aa8dca73ba9d19f9fc486d5bed8c6200a\">1d02785</a></td><td><code>Add a test-hook for build-from-clean</code></td></tr></table>\n",
    "created_at": "2019-09-13T09:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439041",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:49'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d02785aa8dca73ba9d19f9fc486d5bed8c6200a">1d02785</a></td><td><code>Add a test-hook for build-from-clean</code></td></tr></table>




---

archive/issue_comments_439042.json:
```json
{
    "body": "**Changing commit** from \"[89c78f8b903f225a5f2b18cc41adc245c9326964](https://github.com/sagemath/sagetrac-mirror/commit/89c78f8b903f225a5f2b18cc41adc245c9326964)\" to \"[1d02785aa8dca73ba9d19f9fc486d5bed8c6200a](https://github.com/sagemath/sagetrac-mirror/commit/1d02785aa8dca73ba9d19f9fc486d5bed8c6200a)\".",
    "created_at": "2019-09-13T09:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439042",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[89c78f8b903f225a5f2b18cc41adc245c9326964](https://github.com/sagemath/sagetrac-mirror/commit/89c78f8b903f225a5f2b18cc41adc245c9326964)" to "[1d02785aa8dca73ba9d19f9fc486d5bed8c6200a](https://github.com/sagemath/sagetrac-mirror/commit/1d02785aa8dca73ba9d19f9fc486d5bed8c6200a)".



---

archive/issue_comments_439043.json:
```json
{
    "body": "<a id='comment:50'></a>\nI started a full `build-from-clean` here: https://gitlab.com/sagemath/dev/trac/pipelines/82005383",
    "created_at": "2019-09-13T09:38:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439043",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:50'></a>
I started a full `build-from-clean` here: https://gitlab.com/sagemath/dev/trac/pipelines/82005383



---

archive/issue_comments_439044.json:
```json
{
    "body": "**Changing commit** from \"[1d02785aa8dca73ba9d19f9fc486d5bed8c6200a](https://github.com/sagemath/sagetrac-mirror/commit/1d02785aa8dca73ba9d19f9fc486d5bed8c6200a)\" to \"[ca243324e4d9706a0c189193beebec09eed33a2b](https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b)\".",
    "created_at": "2019-09-13T09:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439044",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[1d02785aa8dca73ba9d19f9fc486d5bed8c6200a](https://github.com/sagemath/sagetrac-mirror/commit/1d02785aa8dca73ba9d19f9fc486d5bed8c6200a)" to "[ca243324e4d9706a0c189193beebec09eed33a2b](https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b)".



---

archive/issue_comments_439045.json:
```json
{
    "body": "<a id='comment:51'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b\">ca24332</a></td><td><code>Do not run build-from-latest for explicit builds</code></td></tr></table>\n",
    "created_at": "2019-09-13T09:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439045",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:51'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b">ca24332</a></td><td><code>Do not run build-from-latest for explicit builds</code></td></tr></table>




---

archive/issue_comments_439046.json:
```json
{
    "body": "<a id='comment:52'></a>\nThe Python 2 and Python 3 images seem to be functional. (At least they work in Binder.)",
    "created_at": "2019-09-13T15:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439046",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:52'></a>
The Python 2 and Python 3 images seem to be functional. (At least they work in Binder.)



---

archive/issue_comments_439047.json:
```json
{
    "body": "**Reviewer:** David Roe",
    "created_at": "2019-09-13T22:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439047",
    "user": "https://github.com/roed314"
}
```

**Reviewer:** David Roe



---

archive/issue_comments_439048.json:
```json
{
    "body": "<a id='comment:53'></a>\nLooks good to me.  Both Python 2 and Python 3 built fine.",
    "created_at": "2019-09-13T22:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439048",
    "user": "https://github.com/roed314"
}
```

<a id='comment:53'></a>
Looks good to me.  Both Python 2 and Python 3 built fine.



---

archive/issue_events_247505.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-09-13T22:36:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247505"
}
```



---

archive/issue_events_247506.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-09-13T22:36:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247506"
}
```



---

archive/issue_events_247507.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-09-16T08:54:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247507"
}
```



---

archive/issue_events_247508.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-09-16T08:54:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247508"
}
```



---

archive/issue_comments_439049.json:
```json
{
    "body": "<a id='comment:54'></a>\nNot sure if this comes from the changes here, but there's a `MAKEFLAGS=w -j -l7.8 --jobserver-fds=3,4 V=1` in the output. Let me try to see who put the `w` there.",
    "created_at": "2019-09-16T08:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439049",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:54'></a>
Not sure if this comes from the changes here, but there's a `MAKEFLAGS=w -j -l7.8 --jobserver-fds=3,4 V=1` in the output. Let me try to see who put the `w` there.



---

archive/issue_comments_439050.json:
```json
{
    "body": "<a id='comment:55'></a>\nOk. That's how it's supposed to work https://lists.gnu.org/archive/html/help-make/2016-03/msg00009.html.",
    "created_at": "2019-09-16T08:58:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439050",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:55'></a>
Ok. That's how it's supposed to work https://lists.gnu.org/archive/html/help-make/2016-03/msg00009.html.



---

archive/issue_events_247509.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-09-16T08:58:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247509"
}
```



---

archive/issue_events_247510.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-09-16T08:58:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247510"
}
```



---

archive/issue_events_247511.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247511"
}
```



---

archive/issue_events_247512.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247512"
}
```



---

archive/issue_comments_439051.json:
```json
{
    "body": "<a id='comment:56'></a>\nmoving milestone to 9.0 (after release of 8.9)",
    "created_at": "2019-09-30T08:12:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439051",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:56'></a>
moving milestone to 9.0 (after release of 8.9)



---

archive/issue_events_247513.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-03T17:58:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247513"
}
```



---

archive/issue_events_247514.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8c7dd9e2532a308e3fc1fd9907803ecd0806b3c1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-10-03T17:58:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28041#event-247514"
}
```



---

archive/issue_comments_439052.json:
```json
{
    "body": "**Changing branch** from \"[u/saraedum/28041](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/28041)\" to \"[ca243324e4d9706a0c189193beebec09eed33a2b](https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b)\".",
    "created_at": "2019-10-03T17:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28041#issuecomment-439052",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/saraedum/28041](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/28041)" to "[ca243324e4d9706a0c189193beebec09eed33a2b](https://github.com/sagemath/sagetrac-mirror/commit/ca243324e4d9706a0c189193beebec09eed33a2b)".
