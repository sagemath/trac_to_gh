# Issue 28000: For Sage 9.2: Remove python 2 support from sagelib

archive/issues_027763.json:
```json
{
    "body": "Python 3 support (#15530) was completed for Sage 9.0 (thanks in particular to the leadership of Fr\u00e9d\u00e9ric Chapoton). Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.\n\nTo enable major package upgrades and other changes that require Python 3.x (#29141), \nthis ticket removes Python 2 support in Sage for Sage 9.2.\n\n\nCC:  @timokau @fchapoton @dimpase\n\nKeywords: days101\n\nReviewer: Dima Pasechnik\n\nAuthor: Erik Bray\n\nBranch: f368e3288aa51a7cb0eac7b28145986eb4baaa8a\n\nDependencies: #26403, #28660\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28000\n\n",
    "closed_at": "2020-05-26T21:49:45Z",
    "created_at": "2019-06-16T17:04:46Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "For Sage 9.2: Remove python 2 support from sagelib",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28000",
    "user": "https://github.com/embray"
}
```
Python 3 support (#15530) was completed for Sage 9.0 (thanks in particular to the leadership of Frédéric Chapoton). Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.

To enable major package upgrades and other changes that require Python 3.x (#29141), 
this ticket removes Python 2 support in Sage for Sage 9.2.


CC:  @timokau @fchapoton @dimpase

Keywords: days101

Reviewer: Dima Pasechnik

Author: Erik Bray

Branch: f368e3288aa51a7cb0eac7b28145986eb4baaa8a

Dependencies: #26403, #28660

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28000





---

archive/issue_comments_542379.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n+Python 3 support (#15530) is nearly complete (thanks in particular to the dogged efforts of Fr\u00e9d\u00e9ric Chapoton).\n \n+Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.\n+\n+Because Sage's Python 3 support is likely to make it in just under the wire, there will still be some time while Sage continues to support Python 2; we probably will not want to drop it as soon as Python 3 support is complete.  But the sooner the better.\n+\n+This task is to remind us to do that.\n``````\n",
    "created_at": "2019-06-16T17:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542379",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,7 @@
+Python 3 support (#15530) is nearly complete (thanks in particular to the dogged efforts of Frédéric Chapoton).
 
+Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.
+
+Because Sage's Python 3 support is likely to make it in just under the wire, there will still be some time while Sage continues to support Python 2; we probably will not want to drop it as soon as Python 3 support is complete.  But the sooner the better.
+
+This task is to remind us to do that.
``````




---

archive/issue_comments_542380.json:
```json
{
    "body": "<a id='comment:3'></a>\nWhat needs to be done for this ticket?",
    "created_at": "2019-06-17T20:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542380",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
What needs to be done for this ticket?



---

archive/issue_comments_542381.json:
```json
{
    "body": "<a id='comment:4'></a>\nGo through and remove all hacks related to supporting Python 2.  It will be interesting to see how big a change it takes even now.  It's rather early to go through and do that in earnest, but it would be fun to just try and see what it takes.",
    "created_at": "2019-06-17T21:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542381",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
Go through and remove all hacks related to supporting Python 2.  It will be interesting to see how big a change it takes even now.  It's rather early to go through and do that in earnest, but it would be fun to just try and see what it takes.



---

archive/issue_comments_542382.json:
```json
{
    "body": "Changing keywords from \"\" to \"days101\".",
    "created_at": "2019-06-19T23:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542382",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "days101".



---

archive/issue_comments_542383.json:
```json
{
    "body": "<a id='comment:6'></a>\nOne example: #27696 (remove the doctesting hack for \"long\", which just converts it to \"int\" when using Python 3.",
    "created_at": "2019-06-27T21:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542383",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
One example: #27696 (remove the doctesting hack for "long", which just converts it to "int" when using Python 3.



---

archive/issue_comments_542384.json:
```json
{
    "body": "<a id='comment:7'></a>\nAlso, this ticket can be set as a dependency for other tickets that depend on the\nremoval of Python 2 support. Many dependency upgrades will depend on that.\n\nMight it make sense to migrate the whole Jupyter part to Python3-only versions\nbefore completely removing Python 3 support? Even when building Sage for\nPython 2, we ship Python 3 too anyway.",
    "created_at": "2019-06-28T08:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542384",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>
Also, this ticket can be set as a dependency for other tickets that depend on the
removal of Python 2 support. Many dependency upgrades will depend on that.

Might it make sense to migrate the whole Jupyter part to Python3-only versions
before completely removing Python 3 support? Even when building Sage for
Python 2, we ship Python 3 too anyway.



---

archive/issue_comments_542385.json:
```json
{
    "body": "<a id='comment:8'></a>\nI made some progress at days101 removing all dependency on the `six` module for Python 2/3 support and that alone was a HUGE change (and not even quite finished yet).  Will post a branch once I'm done with that.",
    "created_at": "2019-07-01T12:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542385",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
I made some progress at days101 removing all dependency on the `six` module for Python 2/3 support and that alone was a HUGE change (and not even quite finished yet).  Will post a branch once I'm done with that.



---

archive/issue_comments_542386.json:
```json
{
    "body": "<a id='comment:9'></a>\nHere's some of my progress on this so far: Probably one of the biggest, most pervasive steps, being complete removal of dependency on `six`.\n\nOf course, this step is optional--we can keep using `six` while otherwise dropping support for Python 2.  But this makes it quite explicit.\n\nIt's pretty hard to avoid making a patch bomb of this.  It's not all bad though--I started this months ago, and then once I got it finished I rebased on current develop and only had about a dozen minor merge conflicts.",
    "created_at": "2019-08-18T10:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542386",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
Here's some of my progress on this so far: Probably one of the biggest, most pervasive steps, being complete removal of dependency on `six`.

Of course, this step is optional--we can keep using `six` while otherwise dropping support for Python 2.  But this makes it quite explicit.

It's pretty hard to avoid making a patch bomb of this.  It's not all bad though--I started this months ago, and then once I got it finished I rebased on current develop and only had about a dozen minor merge conflicts.



---

archive/issue_comments_542387.json:
```json
{
    "body": "Changing branch from \"\" to \"u/embray/python3/ticket-28000\"",
    "created_at": "2019-08-18T10:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542387",
    "user": "https://github.com/embray"
}
```

Changing branch from "" to "u/embray/python3/ticket-28000"



---

archive/issue_comments_542388.json:
```json
{
    "body": "Changing author from \"\" to \"Erik Bray\"",
    "created_at": "2019-08-18T10:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542388",
    "user": "https://github.com/embray"
}
```

Changing author from "" to "Erik Bray"



---

archive/issue_comments_542389.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[8f3cacb](https://git.sagemath.org/sage.git/commit/?id=8f3cacb0c658f7fa5eb66fdf799b33096292cd1f)|`Trac #28000: Remove sagelib dependency on six`|",
    "created_at": "2019-08-18T10:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542389",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[8f3cacb](https://git.sagemath.org/sage.git/commit/?id=8f3cacb0c658f7fa5eb66fdf799b33096292cd1f)|`Trac #28000: Remove sagelib dependency on six`|



---

archive/issue_comments_542390.json:
```json
{
    "body": "Changing commit from \"\" to \"8f3cacb0c658f7fa5eb66fdf799b33096292cd1f\"",
    "created_at": "2019-08-18T10:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "8f3cacb0c658f7fa5eb66fdf799b33096292cd1f"



---

archive/issue_comments_542391.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[736c7a2](https://git.sagemath.org/sage.git/commit/?id=736c7a288a18fec38a76d51b1982caf747b34fa0)|`One Python 2-specific block that did not use six.PY2.`|",
    "created_at": "2019-08-18T11:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[736c7a2](https://git.sagemath.org/sage.git/commit/?id=736c7a288a18fec38a76d51b1982caf747b34fa0)|`One Python 2-specific block that did not use six.PY2.`|



---

archive/issue_comments_542392.json:
```json
{
    "body": "Changing commit from \"8f3cacb0c658f7fa5eb66fdf799b33096292cd1f\" to \"736c7a288a18fec38a76d51b1982caf747b34fa0\"",
    "created_at": "2019-08-18T11:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8f3cacb0c658f7fa5eb66fdf799b33096292cd1f" to "736c7a288a18fec38a76d51b1982caf747b34fa0"



---

archive/issue_comments_542393.json:
```json
{
    "body": "<a id='comment:12'></a>\nOther tasks:\n\n- remove or revise the doctests labeled `# py2`. Ideally, all such tests should be evaluated on a case-by-case basis, some should just be removed, but perhaps some should be modified to work with Python 3.\n- #28426: with a Python 3 build, do not build Python 2.\n- remove some packages which are only necessary with Python 2: `typing` (#28499) is the only one I know of currently, but I wouldn't be surprised if there were others.\n- remove the legacy Sage notebook \u2014 at least, I don't think it works with Python 3 now, and I don't think anyone is working on it. This means we should deprecate it ASAP. (#25837)",
    "created_at": "2019-09-16T22:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542393",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
Other tasks:

- remove or revise the doctests labeled `# py2`. Ideally, all such tests should be evaluated on a case-by-case basis, some should just be removed, but perhaps some should be modified to work with Python 3.
- #28426: with a Python 3 build, do not build Python 2.
- remove some packages which are only necessary with Python 2: `typing` (#28499) is the only one I know of currently, but I wouldn't be surprised if there were others.
- remove the legacy Sage notebook — at least, I don't think it works with Python 3 now, and I don't think anyone is working on it. This means we should deprecate it ASAP. (#25837)



---

archive/issue_comments_542394.json:
```json
{
    "body": "<a id='comment:13'></a>\nMy branch for this has some other in-progress changes that it seems I haven't pushed yet.  I'll do so next time I rebase this branch.",
    "created_at": "2019-09-18T10:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542394",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>
My branch for this has some other in-progress changes that it seems I haven't pushed yet.  I'll do so next time I rebase this branch.



---

archive/issue_comments_542395.json:
```json
{
    "body": "<a id='comment:14'></a>\nOh right, one of the changes I started was to remove unnecessary `from __future__` imports, but it seems until we have #26403, to my slight surprise, some of them are still needed in Cython modules, e.g. to have the `print()` function by default.",
    "created_at": "2019-09-18T10:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542395",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
Oh right, one of the changes I started was to remove unnecessary `from __future__` imports, but it seems until we have #26403, to my slight surprise, some of them are still needed in Cython modules, e.g. to have the `print()` function by default.



---

archive/issue_comments_542396.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#26403\"",
    "created_at": "2019-09-18T10:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542396",
    "user": "https://github.com/embray"
}
```

Changing dependencies from "" to "#26403"



---

archive/issue_comments_542397.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[d2c4427](https://git.sagemath.org/sage.git/commit/?id=d2c4427da13d2db785f81f506849b5e5bd7a17ba)|`Trac #28000: Remove sagelib dependency on six`|\n|[aab5d3b](https://git.sagemath.org/sage.git/commit/?id=aab5d3bd214aac6b56d7c511f6493df72fb777f5)|`One Python 2-specific block that did not use six.PY2.`|\n|[50b8951](https://git.sagemath.org/sage.git/commit/?id=50b8951838bccf334eb1bbcc6175c97f72e3ad84)|`Trac #28000: Get rid of most __nonzero__ references and/or replace them with __bool__`|",
    "created_at": "2019-09-18T10:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542397",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[d2c4427](https://git.sagemath.org/sage.git/commit/?id=d2c4427da13d2db785f81f506849b5e5bd7a17ba)|`Trac #28000: Remove sagelib dependency on six`|
|[aab5d3b](https://git.sagemath.org/sage.git/commit/?id=aab5d3bd214aac6b56d7c511f6493df72fb777f5)|`One Python 2-specific block that did not use six.PY2.`|
|[50b8951](https://git.sagemath.org/sage.git/commit/?id=50b8951838bccf334eb1bbcc6175c97f72e3ad84)|`Trac #28000: Get rid of most __nonzero__ references and/or replace them with __bool__`|



---

archive/issue_comments_542398.json:
```json
{
    "body": "Changing commit from \"736c7a288a18fec38a76d51b1982caf747b34fa0\" to \"50b8951838bccf334eb1bbcc6175c97f72e3ad84\"",
    "created_at": "2019-09-18T10:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "736c7a288a18fec38a76d51b1982caf747b34fa0" to "50b8951838bccf334eb1bbcc6175c97f72e3ad84"



---

archive/issue_comments_542399.json:
```json
{
    "body": "<a id='comment:17'></a>\nRebased, but no guarantee there are no new bugs or new uses of `six` I didn't miss.  I didn't check yet.",
    "created_at": "2019-09-18T10:38:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542399",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
Rebased, but no guarantee there are no new bugs or new uses of `six` I didn't miss.  I didn't check yet.



---

archive/issue_comments_542400.json:
```json
{
    "body": "Changing commit from \"50b8951838bccf334eb1bbcc6175c97f72e3ad84\" to \"1f6a41d6ef8ea07cf35c94bef5439d31f9f22943\"",
    "created_at": "2019-09-18T11:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542400",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "50b8951838bccf334eb1bbcc6175c97f72e3ad84" to "1f6a41d6ef8ea07cf35c94bef5439d31f9f22943"



---

archive/issue_comments_542401.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[972f431](https://git.sagemath.org/sage.git/commit/?id=972f43192a73014f44ea463858dcad149ee763ba)|`Trac #28000: Remove sagelib dependency on six`|\n|[4c35164](https://git.sagemath.org/sage.git/commit/?id=4c351646f83fe0cd63839a5cd2e8956429418257)|`One Python 2-specific block that did not use six.PY2.`|\n|[1f6a41d](https://git.sagemath.org/sage.git/commit/?id=1f6a41d6ef8ea07cf35c94bef5439d31f9f22943)|`Trac #28000: Get rid of most __nonzero__ references and/or replace them with __bool__`|",
    "created_at": "2019-09-18T11:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542401",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[972f431](https://git.sagemath.org/sage.git/commit/?id=972f43192a73014f44ea463858dcad149ee763ba)|`Trac #28000: Remove sagelib dependency on six`|
|[4c35164](https://git.sagemath.org/sage.git/commit/?id=4c351646f83fe0cd63839a5cd2e8956429418257)|`One Python 2-specific block that did not use six.PY2.`|
|[1f6a41d](https://git.sagemath.org/sage.git/commit/?id=1f6a41d6ef8ea07cf35c94bef5439d31f9f22943)|`Trac #28000: Get rid of most __nonzero__ references and/or replace them with __bool__`|



---

archive/issue_comments_542402.json:
```json
{
    "body": "<a id='comment:19'></a>\nUpdated again after removing two new uses of `six` that have since appeared.",
    "created_at": "2019-09-18T11:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542402",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>
Updated again after removing two new uses of `six` that have since appeared.



---

archive/issue_comments_542403.json:
```json
{
    "body": "Changing dependencies from \"#26403\" to \"#26403, #28660\"",
    "created_at": "2019-10-27T15:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542403",
    "user": "https://github.com/slel"
}
```

Changing dependencies from "#26403" to "#26403, #28660"



---

archive/issue_comments_542404.json:
```json
{
    "body": "<a id='comment:21'></a>\nDo we remove all doctests tagged `# py2` here or on a separate ticket?",
    "created_at": "2019-11-18T22:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542404",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>
Do we remove all doctests tagged `# py2` here or on a separate ticket?



---

archive/issue_comments_542405.json:
```json
{
    "body": "<a id='comment:22'></a>\nYou could do it here, or a separate ticket (and make it a dependency of this ticket).  It's going to be a patch bomb no matter what, but I don't see the harm in trying to split it up wehre possible.",
    "created_at": "2019-11-19T14:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542405",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'></a>
You could do it here, or a separate ticket (and make it a dependency of this ticket).  It's going to be a patch bomb no matter what, but I don't see the harm in trying to split it up wehre possible.



---

archive/issue_comments_542406.json:
```json
{
    "body": "Changing commit from \"1f6a41d6ef8ea07cf35c94bef5439d31f9f22943\" to \"0e37a950824f824f06c184c50552888984e68f07\"",
    "created_at": "2020-01-06T16:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1f6a41d6ef8ea07cf35c94bef5439d31f9f22943" to "0e37a950824f824f06c184c50552888984e68f07"



---

archive/issue_comments_542407.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[b4fa8db](https://git.sagemath.org/sage.git/commit/?id=b4fa8db33b808fa90ebf40f8b3a9b768ee7f35eb)|`Trac #28000: Remove sagelib dependency on six`|\n|[0ff5ac8](https://git.sagemath.org/sage.git/commit/?id=0ff5ac815af38efc88f5a83c501e053ef66e5082)|`Trac #28000: One Python 2-specific block that did not use six.PY2.`|\n|[0e37a95](https://git.sagemath.org/sage.git/commit/?id=0e37a950824f824f06c184c50552888984e68f07)|`Trac #28000: Get rid of most __nonzero__ references and/or replace them with __bool__`|",
    "created_at": "2020-01-06T16:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542407",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[b4fa8db](https://git.sagemath.org/sage.git/commit/?id=b4fa8db33b808fa90ebf40f8b3a9b768ee7f35eb)|`Trac #28000: Remove sagelib dependency on six`|
|[0ff5ac8](https://git.sagemath.org/sage.git/commit/?id=0ff5ac815af38efc88f5a83c501e053ef66e5082)|`Trac #28000: One Python 2-specific block that did not use six.PY2.`|
|[0e37a95](https://git.sagemath.org/sage.git/commit/?id=0e37a950824f824f06c184c50552888984e68f07)|`Trac #28000: Get rid of most __nonzero__ references and/or replace them with __bool__`|



---

archive/issue_comments_542408.json:
```json
{
    "body": "<a id='comment:24'></a>\nRebased on 9.0",
    "created_at": "2020-01-06T16:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542408",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>
Rebased on 9.0



---

archive/issue_comments_542409.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,6 @@\n Because Sage's Python 3 support is likely to make it in just under the wire, there will still be some time while Sage continues to support Python 2; we probably will not want to drop it as soon as Python 3 support is complete.  But the sooner the better.\n \n This task is to remind us to do that.\n+\n+See also:\n+- #29141: Meta-ticket: Upgrades and other changes that require dropping py2 support or separate package versions for py2/py3\n``````\n",
    "created_at": "2020-02-10T00:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542409",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,6 @@
 Because Sage's Python 3 support is likely to make it in just under the wire, there will still be some time while Sage continues to support Python 2; we probably will not want to drop it as soon as Python 3 support is complete.  But the sooner the better.
 
 This task is to remind us to do that.
+
+See also:
+- #29141: Meta-ticket: Upgrades and other changes that require dropping py2 support or separate package versions for py2/py3
``````




---

archive/issue_comments_542410.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,5 @@\n-Python 3 support (#15530) is nearly complete (thanks in particular to the dogged efforts of Fr\u00e9d\u00e9ric Chapoton).\n+Python 3 support (#15530) was completed for Sage 9.0 (thanks in particular to the leadership of Fr\u00e9d\u00e9ric Chapoton). Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.\n \n-Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.\n+To enable major package upgrades and other changes that require Python 3.x (#29141), \n+this ticket removes Python 2 support in Sage for Sage 9.2.\n \n-Because Sage's Python 3 support is likely to make it in just under the wire, there will still be some time while Sage continues to support Python 2; we probably will not want to drop it as soon as Python 3 support is complete.  But the sooner the better.\n-\n-This task is to remind us to do that.\n-\n-See also:\n-- #29141: Meta-ticket: Upgrades and other changes that require dropping py2 support or separate package versions for py2/py3\n``````\n",
    "created_at": "2020-05-09T18:59:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542410",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,5 @@
-Python 3 support (#15530) is nearly complete (thanks in particular to the dogged efforts of Frédéric Chapoton).
+Python 3 support (#15530) was completed for Sage 9.0 (thanks in particular to the leadership of Frédéric Chapoton). Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.
 
-Official support for Python 2.7 by the CPython core developers is ending January 1, 2020.
+To enable major package upgrades and other changes that require Python 3.x (#29141), 
+this ticket removes Python 2 support in Sage for Sage 9.2.
 
-Because Sage's Python 3 support is likely to make it in just under the wire, there will still be some time while Sage continues to support Python 2; we probably will not want to drop it as soon as Python 3 support is complete.  But the sooner the better.
-
-This task is to remind us to do that.
-
-See also:
-- #29141: Meta-ticket: Upgrades and other changes that require dropping py2 support or separate package versions for py2/py3
``````




---

archive/issue_events_069396.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-09T18:59:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28000#event-69396"
}
```



---

archive/issue_comments_542411.json:
```json
{
    "body": "<a id='comment:27'></a>\nNeeds rebasing!",
    "created_at": "2020-05-09T19:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542411",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Needs rebasing!



---

archive/issue_comments_542412.json:
```json
{
    "body": "<a id='comment:29'></a>\nRelated: #27826",
    "created_at": "2020-05-11T17:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542412",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:29'></a>
Related: #27826



---

archive/issue_comments_542413.json:
```json
{
    "body": "Changing branch from \"u/embray/python3/ticket-28000\" to \"u/jhpalmieri/python3/ticket-28000\"",
    "created_at": "2020-05-13T03:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542413",
    "user": "https://github.com/jhpalmieri"
}
```

Changing branch from "u/embray/python3/ticket-28000" to "u/jhpalmieri/python3/ticket-28000"



---

archive/issue_comments_542414.json:
```json
{
    "body": "<a id='comment:31'></a>\nRebased. I haven't seen activity from embray for a while. Perhaps this is ready for review?\n  \n---\nNew commits:\n|                                                                                                                                          |                                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|\n|[f368e32](https://git.sagemath.org/sage.git/commit?id=f368e3288aa51a7cb0eac7b28145986eb4baaa8a)|`trac 28000: rebase commits from Erik M. Bray <erik.bray`@`lri.fr>:`|",
    "created_at": "2020-05-13T03:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542414",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'></a>
Rebased. I haven't seen activity from embray for a while. Perhaps this is ready for review?
  
---
New commits:
|                                                                                                                                          |                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
|[f368e32](https://git.sagemath.org/sage.git/commit?id=f368e3288aa51a7cb0eac7b28145986eb4baaa8a)|`trac 28000: rebase commits from Erik M. Bray <erik.bray`@`lri.fr>:`|



---

archive/issue_comments_542415.json:
```json
{
    "body": "Changing commit from \"0e37a950824f824f06c184c50552888984e68f07\" to \"f368e3288aa51a7cb0eac7b28145986eb4baaa8a\"",
    "created_at": "2020-05-13T03:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542415",
    "user": "https://github.com/jhpalmieri"
}
```

Changing commit from "0e37a950824f824f06c184c50552888984e68f07" to "f368e3288aa51a7cb0eac7b28145986eb4baaa8a"



---

archive/issue_comments_542416.json:
```json
{
    "body": "<a id='comment:32'></a>\nLet's see if this finds a reviewer",
    "created_at": "2020-05-19T03:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542416",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
Let's see if this finds a reviewer



---

archive/issue_comments_542417.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-19T03:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542417",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_542418.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2020-05-19T11:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542418",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_542419.json:
```json
{
    "body": "<a id='comment:33'></a>\ntesting.",
    "created_at": "2020-05-19T11:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542419",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>
testing.



---

archive/issue_comments_542420.json:
```json
{
    "body": "<a id='comment:34'></a>\nOK, this makes sense and appears to work. A long, but straightforward patch, also touching quite a bit of whitespace (which probably could have waited for another place, but OK).\n\nShould removing Python2 spkg be done elsewhere?",
    "created_at": "2020-05-20T08:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542420",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>
OK, this makes sense and appears to work. A long, but straightforward patch, also touching quite a bit of whitespace (which probably could have waited for another place, but OK).

Should removing Python2 spkg be done elsewhere?



---

archive/issue_comments_542421.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-20T08:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542421",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_542422.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [dimpase](#comment%3A34):\n> Should removing Python2 spkg be done elsewhere?\n\n\nYes, see #29141 (Meta-ticket: Remove Python 2 support for Sage 9.2; upgrades enabled by the removal)",
    "created_at": "2020-05-20T15:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542422",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Replying to [dimpase](#comment%3A34):
> Should removing Python2 spkg be done elsewhere?


Yes, see #29141 (Meta-ticket: Remove Python 2 support for Sage 9.2; upgrades enabled by the removal)



---

archive/issue_comments_542423.json:
```json
{
    "body": "Changing branch from \"u/jhpalmieri/python3/ticket-28000\" to \"f368e3288aa51a7cb0eac7b28145986eb4baaa8a\"",
    "created_at": "2020-05-26T21:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542423",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jhpalmieri/python3/ticket-28000" to "f368e3288aa51a7cb0eac7b28145986eb4baaa8a"



---

archive/issue_comments_542424.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-05-26T21:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542424",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069397.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-05-26T21:49:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28000#event-69397"
}
```



---

archive/issue_comments_542425.json:
```json
{
    "body": "Changing commit from \"f368e3288aa51a7cb0eac7b28145986eb4baaa8a\" to \"\"",
    "created_at": "2020-05-27T15:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542425",
    "user": "https://github.com/timokau"
}
```

Changing commit from "f368e3288aa51a7cb0eac7b28145986eb4baaa8a" to ""



---

archive/issue_comments_542426.json:
```json
{
    "body": "<a id='comment:37'></a>\n\uff3c(\uff3eO\uff3e)\uff0f\n\nHopefully the divergence between sage-the-distribution and sage-on-distro will decrease now and packaging will become simpler again.",
    "created_at": "2020-05-27T15:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542426",
    "user": "https://github.com/timokau"
}
```

<a id='comment:37'></a>
＼(＾O＾)／

Hopefully the divergence between sage-the-distribution and sage-on-distro will decrease now and packaging will become simpler again.



---

archive/issue_comments_542427.json:
```json
{
    "body": "<a id='comment:38'></a>\nThanks for finally getting this ticket merged!  Sorry I haven't had much time to work on it.  As others have noted this does not take care of all tasks related to dropping Python 2 support--it was just me doing as much as I could in one place.  Took hours!",
    "created_at": "2020-05-28T14:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542427",
    "user": "https://github.com/embray"
}
```

<a id='comment:38'></a>
Thanks for finally getting this ticket merged!  Sorry I haven't had much time to work on it.  As others have noted this does not take care of all tasks related to dropping Python 2 support--it was just me doing as much as I could in one place.  Took hours!



---

archive/issue_comments_542428.json:
```json
{
    "body": "<a id='comment:39'></a>\nThis breaks on Python 3.5, I've created #29753 for that",
    "created_at": "2020-05-28T19:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542428",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:39'></a>
This breaks on Python 3.5, I've created #29753 for that



---

archive/issue_comments_542429.json:
```json
{
    "body": "<a id='comment:40'></a>\nDoes anyone know of any docker setups from tox.ini that have Python 3.5?",
    "created_at": "2020-05-28T19:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542429",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:40'></a>
Does anyone know of any docker setups from tox.ini that have Python 3.5?



---

archive/issue_comments_542430.json:
```json
{
    "body": "<a id='comment:41'></a>\nPython 3.5 will be gone in Sept, why would wr spend time trying to support it?",
    "created_at": "2020-05-28T20:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542430",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
Python 3.5 will be gone in Sept, why would wr spend time trying to support it?



---

archive/issue_comments_542431.json:
```json
{
    "body": "<a id='comment:42'></a>\nThis accidentally broke the Macaulay2 interface. Follow up at #29759 with a trivial fix.",
    "created_at": "2020-05-29T19:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28000#issuecomment-542431",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:42'></a>
This accidentally broke the Macaulay2 interface. Follow up at #29759 with a trivial fix.
