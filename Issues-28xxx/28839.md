# Issue 28839: adding a minimal lgtm.yml file

archive/issues_028602.json:
```json
{
    "body": "This will tell LGTM to use Python3 during its code analysis.\n\nas suggested here:\n\nhttps://lgtm.com/help/lgtm/analysis-faqs#how-python-version-identified\n\nCC:  @tscrim @kiwifb @embray @vbraun\n\nBranch/Commit: f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7\n\nReviewer: Erik Bray\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28839\n\n",
    "closed_at": "2019-12-08T21:19:24Z",
    "created_at": "2019-12-04T09:25:03Z",
    "labels": [
        "component: scripts",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "adding a minimal lgtm.yml file",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28839",
    "user": "https://github.com/fchapoton"
}
```
This will tell LGTM to use Python3 during its code analysis.

as suggested here:

https://lgtm.com/help/lgtm/analysis-faqs#how-python-version-identified

CC:  @tscrim @kiwifb @embray @vbraun

Branch/Commit: f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7

Reviewer: Erik Bray

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28839





---

archive/issue_comments_559835.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/28839\"",
    "created_at": "2019-12-04T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559835",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/28839"



---

archive/issue_comments_559836.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[d6728ff](https://git.sagemath.org/sage.git/commit?id=d6728ff3c4512a30e14238e831325ab383a5413e)|`adding a .lgtm.yml file to specify the python version`|",
    "created_at": "2019-12-04T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559836",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[d6728ff](https://git.sagemath.org/sage.git/commit?id=d6728ff3c4512a30e14238e831325ab383a5413e)|`adding a .lgtm.yml file to specify the python version`|



---

archive/issue_comments_559837.json:
```json
{
    "body": "Changing commit from \"\" to \"d6728ff3c4512a30e14238e831325ab383a5413e\"",
    "created_at": "2019-12-04T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559837",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "d6728ff3c4512a30e14238e831325ab383a5413e"



---

archive/issue_comments_559838.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-12-04T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559838",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_559839.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n This will tell LGTM to use Python3 during its code analysis.\n \n+as suggested here:\n \n+https://lgtm.com/help/lgtm/analysis-faqs#how-python-version-identified\n``````\n",
    "created_at": "2019-12-04T09:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559839",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 This will tell LGTM to use Python3 during its code analysis.
 
+as suggested here:
 
+https://lgtm.com/help/lgtm/analysis-faqs#how-python-version-identified
``````




---

archive/issue_comments_559840.json:
```json
{
    "body": "<a id='comment:3'></a>\nThat looks interesting.",
    "created_at": "2019-12-04T09:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559840",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
That looks interesting.



---

archive/issue_comments_559841.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe reports can be found here:\n\nhttps://lgtm.com/projects/g/sagemath/sage/?mode=list\n\nbut the problem is that it only runs when \"master\" branch is updated..",
    "created_at": "2019-12-04T09:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559841",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
The reports can be found here:

https://lgtm.com/projects/g/sagemath/sage/?mode=list

but the problem is that it only runs when "master" branch is updated..



---

archive/issue_comments_559842.json:
```json
{
    "body": "<a id='comment:5'></a>\nI wonder if there is a setting to change the branch to track.",
    "created_at": "2019-12-04T14:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559842",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
I wonder if there is a setting to change the branch to track.



---

archive/issue_comments_559843.json:
```json
{
    "body": "<a id='comment:6'></a>\nthe only way seems to be : change our main branch on github to be \"develop\"",
    "created_at": "2019-12-04T14:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559843",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
the only way seems to be : change our main branch on github to be "develop"



---

archive/issue_comments_559844.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [embray](#comment%3A5):\n> I wonder if there is a setting to change the branch to track.\n\n\nISTM that LGTM is reading from the [GitHub](GitHub) mirror of our repo, so I just need to change its default branch to the develop branch.  I don't *think* there will be any consequences to doing so, so I'll go ahead and do that.",
    "created_at": "2019-12-04T14:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559844",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
Replying to [embray](#comment%3A5):
> I wonder if there is a setting to change the branch to track.


ISTM that LGTM is reading from the [GitHub](GitHub) mirror of our repo, so I just need to change its default branch to the develop branch.  I don't *think* there will be any consequences to doing so, so I'll go ahead and do that.



---

archive/issue_comments_559845.json:
```json
{
    "body": "<a id='comment:8'></a>\nI'm looking at this site, and while many of the alerts look useful, a great many of the \"errors\" reported are due to supposedly incorrect arguments to a class's `__init__`, except their analysis is not clever enough to consider classes which have a metaclass with a custom `__call__` (e.g. our `ClasscallMetaclass` which is used all over the place).\n\nSo perhaps while we're adding this file it might be helpful to globally exclude this and related errors as explained [here](https://help.semmle.com/lgtm-enterprise/user/help/showing-hiding-query-results.html).  For example, from what I'm seeing in the errors, we want at least:\n\n```\nqueries:\n    - exclude: py/call/wrong-named-class-argument\n    - exclude: py/call/wrong-number-class-arguments\n```\n\nOf course, we can also suppress alerts on individual lines, but these two are so pervasive it would not be practical.  Suppressing them globally unfortunately could hide legitimate errors, though these errors are likely to be caught by tests in most cases.",
    "created_at": "2019-12-04T14:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559845",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
I'm looking at this site, and while many of the alerts look useful, a great many of the "errors" reported are due to supposedly incorrect arguments to a class's `__init__`, except their analysis is not clever enough to consider classes which have a metaclass with a custom `__call__` (e.g. our `ClasscallMetaclass` which is used all over the place).

So perhaps while we're adding this file it might be helpful to globally exclude this and related errors as explained [here](https://help.semmle.com/lgtm-enterprise/user/help/showing-hiding-query-results.html).  For example, from what I'm seeing in the errors, we want at least:

```
queries:
    - exclude: py/call/wrong-named-class-argument
    - exclude: py/call/wrong-number-class-arguments
```

Of course, we can also suppress alerts on individual lines, but these two are so pervasive it would not be practical.  Suppressing them globally unfortunately could hide legitimate errors, though these errors are likely to be caught by tests in most cases.



---

archive/issue_comments_559846.json:
```json
{
    "body": "Changing commit from \"d6728ff3c4512a30e14238e831325ab383a5413e\" to \"84f4cd3417d6ae6d94afcc99606309b32cb4ddfc\"",
    "created_at": "2019-12-04T14:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559846",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d6728ff3c4512a30e14238e831325ab383a5413e" to "84f4cd3417d6ae6d94afcc99606309b32cb4ddfc"



---

archive/issue_comments_559847.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[84f4cd3](https://git.sagemath.org/sage.git/commit/?id=84f4cd3417d6ae6d94afcc99606309b32cb4ddfc)|`more stuff in lgtm.yml`|",
    "created_at": "2019-12-04T14:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559847",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[84f4cd3](https://git.sagemath.org/sage.git/commit/?id=84f4cd3417d6ae6d94afcc99606309b32cb4ddfc)|`more stuff in lgtm.yml`|



---

archive/issue_comments_559848.json:
```json
{
    "body": "<a id='comment:10'></a>\nindeed. Done",
    "created_at": "2019-12-04T14:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559848",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
indeed. Done



---

archive/issue_comments_559849.json:
```json
{
    "body": "<a id='comment:11'></a>\nHeh, actually it turns out the *actual* majority of errors are of the class [py/unsafe-cyclic-import](https://lgtm.com/rules/3970092/).  We should probably globally disable that one as well :)",
    "created_at": "2019-12-04T14:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559849",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
Heh, actually it turns out the *actual* majority of errors are of the class [py/unsafe-cyclic-import](https://lgtm.com/rules/3970092/).  We should probably globally disable that one as well :)



---

archive/issue_comments_559850.json:
```json
{
    "body": "<a id='comment:12'></a>\nIf you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.",
    "created_at": "2019-12-04T14:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559850",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.



---

archive/issue_comments_559851.json:
```json
{
    "body": "Changing commit from \"84f4cd3417d6ae6d94afcc99606309b32cb4ddfc\" to \"7b76a05abf7f38575dfb0a13097370051b14610f\"",
    "created_at": "2019-12-04T14:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559851",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "84f4cd3417d6ae6d94afcc99606309b32cb4ddfc" to "7b76a05abf7f38575dfb0a13097370051b14610f"



---

archive/issue_comments_559852.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[7b76a05](https://git.sagemath.org/sage.git/commit/?id=7b76a05abf7f38575dfb0a13097370051b14610f)|`more stuff in lgtm.yml`|",
    "created_at": "2019-12-04T14:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559852",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[7b76a05](https://git.sagemath.org/sage.git/commit/?id=7b76a05abf7f38575dfb0a13097370051b14610f)|`more stuff in lgtm.yml`|



---

archive/issue_comments_559853.json:
```json
{
    "body": "<a id='comment:14'></a>\nTurns out there was already a recent [issue](https://github.com/Semmle/ql/issues/2445#issuecomment-561678026) for false positives due to custom metaclass `__call__`s.  I added some examples to it.\n\n---\nNew commits:\n|                                                                                                                                          |                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[7b76a05](https://git.sagemath.org/sage.git/commit?id=7b76a05abf7f38575dfb0a13097370051b14610f)|`more stuff in lgtm.yml`|",
    "created_at": "2019-12-04T14:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559853",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
Turns out there was already a recent [issue](https://github.com/Semmle/ql/issues/2445#issuecomment-561678026) for false positives due to custom metaclass `__call__`s.  I added some examples to it.

---
New commits:
|                                                                                                                                          |                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[7b76a05](https://git.sagemath.org/sage.git/commit?id=7b76a05abf7f38575dfb0a13097370051b14610f)|`more stuff in lgtm.yml`|



---

archive/issue_comments_559854.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [embray](#comment%3A12):\n> If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.\n\n\nLGTM :)\n\nThough please consider either squashing your commits and/or adding some more details or link to this ticket.  \"adding stuff to this file for no apparent reason\"-type commit messages are not helpful :(",
    "created_at": "2019-12-04T14:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559854",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Replying to [embray](#comment%3A12):
> If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.


LGTM :)

Though please consider either squashing your commits and/or adding some more details or link to this ticket.  "adding stuff to this file for no apparent reason"-type commit messages are not helpful :(



---

archive/issue_comments_559855.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Erik Bray\"",
    "created_at": "2019-12-04T14:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559855",
    "user": "https://github.com/embray"
}
```

Changing reviewer from "" to "Erik Bray"



---

archive/issue_comments_559856.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-04T14:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559856",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_559857.json:
```json
{
    "body": "Changing commit from \"7b76a05abf7f38575dfb0a13097370051b14610f\" to \"f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7\"",
    "created_at": "2019-12-04T14:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559857",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7b76a05abf7f38575dfb0a13097370051b14610f" to "f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7"



---

archive/issue_comments_559858.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:\n|                                                                                                                                           |                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[f3640c2](https://git.sagemath.org/sage.git/commit/?id=f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7)|`adding a minimal .lgtm.yml file`|",
    "created_at": "2019-12-04T14:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:
|                                                                                                                                           |                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[f3640c2](https://git.sagemath.org/sage.git/commit/?id=f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7)|`adding a minimal .lgtm.yml file`|



---

archive/issue_comments_559859.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-12-04T14:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559859",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_559860.json:
```json
{
    "body": "<a id='comment:17'></a>\nok, better like that ?",
    "created_at": "2019-12-04T15:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559860",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
ok, better like that ?



---

archive/issue_comments_559861.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-04T15:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559861",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_559862.json:
```json
{
    "body": "<a id='comment:19'></a>\nThank you!",
    "created_at": "2019-12-05T12:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559862",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>
Thank you!



---

archive/issue_events_072933.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-08T21:19:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28839#event-72933"
}
```



---

archive/issue_comments_559863.json:
```json
{
    "body": "Changing branch from \"u/chapoton/28839\" to \"f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7\"",
    "created_at": "2019-12-08T21:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559863",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/28839" to "f3640c29b6adcbeed6a5e6c0ac5e89a2705966d7"



---

archive/issue_comments_559864.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-08T21:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28839#issuecomment-559864",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
