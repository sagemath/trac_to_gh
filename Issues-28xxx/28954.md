# Issue 28954: polynomial degree is broken for weighted block orders

archive/issues_028717.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: T = TermOrder('wdegrevlex', (1,2,3,4))\nsage: R = PolynomialRing(QQ, 'x', 12, order=T+T+T)\nsage: [x.degree() for x in R.gens()]    # wrong\n[1, 2, 3, 4, 1, 1, 1, 1, 1, 1, 1, 1]\n\nsage: from sage.libs.singular.function_factory import ff\nsage: [ff.deg(x, ring=R) for x in R.gens()]    # correct\n[1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4]\n```\n\n\nCC:  @kwankyu @jpflori\n\nKeywords: **singular**\n\nBranch/Commit: **[`0100ac0`](https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d)**\n\nReviewer: **Markus Wageringel**\n\nAuthor: **Kwankyu Lee**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28954_\n\n",
    "closed_at": "2020-01-20T21:18:30Z",
    "created_at": "2020-01-05T18:38:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "polynomial degree is broken for weighted block orders",
    "type": "issue",
    "updated_at": "2020-01-20T21:18:30Z",
    "url": "https://github.com/sagemath/sage/issues/28954",
    "user": "https://github.com/mwageringel"
}
```

```
sage: T = TermOrder('wdegrevlex', (1,2,3,4))
sage: R = PolynomialRing(QQ, 'x', 12, order=T+T+T)
sage: [x.degree() for x in R.gens()]    # wrong
[1, 2, 3, 4, 1, 1, 1, 1, 1, 1, 1, 1]

sage: from sage.libs.singular.function_factory import ff
sage: [ff.deg(x, ring=R) for x in R.gens()]    # correct
[1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4]
```


CC:  @kwankyu @jpflori

Keywords: **singular**

Branch/Commit: **[`0100ac0`](https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d)**

Reviewer: **Markus Wageringel**

Author: **Kwankyu Lee**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/28954_





---

archive/issue_events_394830.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-01-05T18:38:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394830"
}
```



---

archive/issue_events_394831.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-01-05T18:38:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394831"
}
```



---

archive/issue_events_394832.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-01-05T18:38:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394832"
}
```



---

archive/issue_events_394833.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-01-05T18:38:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394833"
}
```



---

archive/issue_comments_452102.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nA related changed is \n\n[#21631 comment:23](https://github.com/sagemath/sage/issues/21631#comment:23)\n\nAt least I checked reverting to `p_WTotaldegree` solves the present problem. But there must have been some reason to have used `p_WDegree`.",
    "created_at": "2020-01-06T04:14:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452102",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:1" align="right">comment:1</div>

A related changed is 

[#21631 comment:23](https://github.com/sagemath/sage/issues/21631#comment:23)

At least I checked reverting to `p_WTotaldegree` solves the present problem. But there must have been some reason to have used `p_WDegree`.



---

archive/issue_comments_452103.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe reason for that change seems to be to fix the example in [[#17254 comment:199](https://github.com/sagemath/sage/issues/17254#comment:199)] where a matrix ordering is used. Interestingly though, with current versions of Singular, the degree with a matrix ordering is not based on the first row of the matrix anymore:\n\n```\nsage: R.<x,y,z> = PolynomialRing(QQ, 3, order=TermOrder(matrix([3,0,1,1,1,0,1,0,0])))\nsage: [a.degree() for a in R.gens()]\n[3, 0, 1]\nsage: [a._singular_().deg() for a in R.gens()]\n[3, 0, 1]   # singular 3.1.7p1\n[1, 1, 1]   # singular 4.1.1p2\n```\n\nTherefore, I think the degree function in Sage should be changed to return results consistent with Singular in case of matrix orderings. Based on [this document](https://github.com/Singular/Sources/blob/ed085278a0d1c84d197cb3b6dea54a2e5cbabdc0/libpolys/polys/monomials/degree.txt), I replaced `p_WDegree` by `p_FDeg`, which fixes both examples here \u2013 though I am not completely certain this is the correct function to call.\n\nI guess such a behavior change would need a deprecation period. How would one implement this in practice?",
    "created_at": "2020-01-06T18:39:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452103",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:3" align="right">comment:3</div>

The reason for that change seems to be to fix the example in [[#17254 comment:199](https://github.com/sagemath/sage/issues/17254#comment:199)] where a matrix ordering is used. Interestingly though, with current versions of Singular, the degree with a matrix ordering is not based on the first row of the matrix anymore:

```
sage: R.<x,y,z> = PolynomialRing(QQ, 3, order=TermOrder(matrix([3,0,1,1,1,0,1,0,0])))
sage: [a.degree() for a in R.gens()]
[3, 0, 1]
sage: [a._singular_().deg() for a in R.gens()]
[3, 0, 1]   # singular 3.1.7p1
[1, 1, 1]   # singular 4.1.1p2
```

Therefore, I think the degree function in Sage should be changed to return results consistent with Singular in case of matrix orderings. Based on [this document](https://github.com/Singular/Sources/blob/ed085278a0d1c84d197cb3b6dea54a2e5cbabdc0/libpolys/polys/monomials/degree.txt), I replaced `p_WDegree` by `p_FDeg`, which fixes both examples here â€“ though I am not completely certain this is the correct function to call.

I guess such a behavior change would need a deprecation period. How would one implement this in practice?



---

archive/issue_comments_452104.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSingular's deg function calls `p_LDeg` [(source)](https://github.com/Singular/Sources/blob/Release-4-1-2/Singular/iparith.cc#L3866), so we should use that instead. This eliminates the need to explicitly loop over the monomials.",
    "created_at": "2020-01-06T19:00:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452104",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:4" align="right">comment:4</div>

Singular's deg function calls `p_LDeg` [(source)](https://github.com/Singular/Sources/blob/Release-4-1-2/Singular/iparith.cc#L3866), so we should use that instead. This eliminates the need to explicitly loop over the monomials.



---

archive/issue_comments_452105.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI am quite certain that the best thing to do is to patch `polynomial.pyx` such that\n\n```\ncdef long singular_polynomial_deg(poly *p, poly *x, ring *r):\n    ...\n    if x == NULL:\n        return p_WTotaldegree(p,r)\n\n    cdef int i = 0\n    ...\n```\nNote that the \"loop\" thing is not necessary. So this will speed up things.\n\nBut then we get \n\n```\nsage: R.<x,y,z> = PolynomialRing(QQ, 3, order=TermOrder(matrix([3,0,1,1,1,0,1,0,0])))\nsage: [a.degree() for a in R.gens()]\n[-3, 0, -1]\nsage: [a._singular_().deg() for a in R.gens()]\n[1, 1, 1]\n```\nI don't care the Singular degrees. They are  `p_Totaldegree` (via `p_FDeg` via `p_LDeg`), as expected since Singular' deg function calls `p_LDeg`.\n\nBut the negative values above look strange. They are negative because the value `OrdSgn` is -1 for the ring. It means that the monomial ordering of R is not well-ordering. This is wrong! It is well-ordering since the first nonzero values of each column of the matrix is positive. So `OrdSgn` should be 1. I suspect that there is a bug somewhere in Sage or possibly in Singular. But I could not look deep into the Singular code to find the bug...",
    "created_at": "2020-01-07T08:43:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452105",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:5" align="right">comment:5</div>

I am quite certain that the best thing to do is to patch `polynomial.pyx` such that

```
cdef long singular_polynomial_deg(poly *p, poly *x, ring *r):
    ...
    if x == NULL:
        return p_WTotaldegree(p,r)

    cdef int i = 0
    ...
```
Note that the "loop" thing is not necessary. So this will speed up things.

But then we get 

```
sage: R.<x,y,z> = PolynomialRing(QQ, 3, order=TermOrder(matrix([3,0,1,1,1,0,1,0,0])))
sage: [a.degree() for a in R.gens()]
[-3, 0, -1]
sage: [a._singular_().deg() for a in R.gens()]
[1, 1, 1]
```
I don't care the Singular degrees. They are  `p_Totaldegree` (via `p_FDeg` via `p_LDeg`), as expected since Singular' deg function calls `p_LDeg`.

But the negative values above look strange. They are negative because the value `OrdSgn` is -1 for the ring. It means that the monomial ordering of R is not well-ordering. This is wrong! It is well-ordering since the first nonzero values of each column of the matrix is positive. So `OrdSgn` should be 1. I suspect that there is a bug somewhere in Sage or possibly in Singular. But I could not look deep into the Singular code to find the bug...



---

archive/issue_comments_452106.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n> Note that the \"loop\" thing is not necessary. So this will speed up things.\n\nThis is wrong. I forgot that the monomial ordering might be incompatible with degrees. Anyway, this part needs to be optimized as this would affect the overall performance of polynomial arithmetic of Sage...",
    "created_at": "2020-01-07T11:22:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452106",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:6" align="right">comment:6</div>

> Note that the "loop" thing is not necessary. So this will speed up things.

This is wrong. I forgot that the monomial ordering might be incompatible with degrees. Anyway, this part needs to be optimized as this would affect the overall performance of polynomial arithmetic of Sage...



---

archive/issue_comments_452107.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe bug in Singular about the wrong `OrdSgn` value was reported in \n\nhttps://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=2899",
    "created_at": "2020-01-08T02:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452107",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">comment:7</div>

The bug in Singular about the wrong `OrdSgn` value was reported in 

https://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=2899



---

archive/issue_comments_452108.json:
```json
{
    "body": "Author: **Kwankyu Lee**",
    "created_at": "2020-01-13T04:03:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452108",
    "user": "https://github.com/kwankyu"
}
```

Author: **Kwankyu Lee**



---

archive/issue_comments_452109.json:
```json
{
    "body": "Branch: **[u/klee/28954](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28954)**",
    "created_at": "2020-01-13T04:03:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452109",
    "user": "https://github.com/kwankyu"
}
```

Branch: **[u/klee/28954](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28954)**



---

archive/issue_comments_452110.json:
```json
{
    "body": "Commit: **[`b8f53f7`](https://github.com/sagemath/sagetrac-mirror/commit/b8f53f72e817e78722ad1b40d70aa9071426700b)**",
    "created_at": "2020-01-13T04:03:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452110",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`b8f53f7`](https://github.com/sagemath/sagetrac-mirror/commit/b8f53f72e817e78722ad1b40d70aa9071426700b)**



---

archive/issue_comments_452111.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-13T04:03:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452111",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_452112.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ccd0d206c574b696481f161e364b46b67fd2ef9\"><code>7ccd0d2</code></a></td><td><code>Use p_WTotalDegree for Sage degree</code></td></tr></table>\n",
    "created_at": "2020-01-13T04:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452112",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ccd0d206c574b696481f161e364b46b67fd2ef9"><code>7ccd0d2</code></a></td><td><code>Use p_WTotalDegree for Sage degree</code></td></tr></table>




---

archive/issue_comments_452113.json:
```json
{
    "body": "Changed commit from **[`b8f53f7`](https://github.com/sagemath/sagetrac-mirror/commit/b8f53f72e817e78722ad1b40d70aa9071426700b)** to **[`7ccd0d2`](https://github.com/sagemath/sagetrac-mirror/commit/7ccd0d206c574b696481f161e364b46b67fd2ef9)**",
    "created_at": "2020-01-13T04:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452113",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b8f53f7`](https://github.com/sagemath/sagetrac-mirror/commit/b8f53f72e817e78722ad1b40d70aa9071426700b)** to **[`7ccd0d2`](https://github.com/sagemath/sagetrac-mirror/commit/7ccd0d206c574b696481f161e364b46b67fd2ef9)**



---

archive/issue_comments_452114.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThe branch modulo the fix in Singular part fixes the bug of this ticket.\n\nI wish to remove the loop thing for the cases when the monomial ordering is compatible with the degrees, to speed up Sage polynomial arithmetic. But I don't know how to detect these cases, and this issue is for another ticket.\n\nPerhaps we need to delay this ticket until the fix in Singular is available in Sage...",
    "created_at": "2020-01-13T04:15:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452114",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:11" align="right">comment:11</div>

The branch modulo the fix in Singular part fixes the bug of this ticket.

I wish to remove the loop thing for the cases when the monomial ordering is compatible with the degrees, to speed up Sage polynomial arithmetic. But I don't know how to detect these cases, and this issue is for another ticket.

Perhaps we need to delay this ticket until the fix in Singular is available in Sage...



---

archive/issue_comments_452115.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n@mwageringel:\n\nI don't object to using `p_LDeg` if this is practically (that is, ignoring not-so-useful matrix orderings) consistent with the rest of Sage, as this has advantage in performance.",
    "created_at": "2020-01-13T04:33:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452115",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:12" align="right">comment:12</div>

@mwageringel:

I don't object to using `p_LDeg` if this is practically (that is, ignoring not-so-useful matrix orderings) consistent with the rest of Sage, as this has advantage in performance.



---

archive/issue_comments_452116.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nShould we not add the upstream fix as a patch here? The regular upgrade of Singular might still take quite a while.\n\n\nReplying to [@kwankyu](#comment%3A12):\n> I don't object to using `p_LDeg` if this is practically (that is, ignoring not-so-useful matrix orderings) consistent with the rest of Sage, as this has advantage in performance.\n\n\nThis would be a practical thing to do, as it leaves it to Singular to provide an efficient implementation. Note that this only affects matrix orderings with zeros in the first row \u2013 if the entries in the first row are positive, these are returned as degrees as before.\n\n(A potential downside of this is that it forces Singular's notion of degree upon Sage, whereas, if one ignores the Singular backend, Sage could have its own notion. In Macaulay2 for example, the notions of degree and weight are independent. For now, this seems fine though, as much of polynomial arithmetics in Sage is dictated by the Singular backend anyway.)",
    "created_at": "2020-01-14T20:14:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452116",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:13" align="right">comment:13</div>

Should we not add the upstream fix as a patch here? The regular upgrade of Singular might still take quite a while.


Replying to [@kwankyu](#comment%3A12):
> I don't object to using `p_LDeg` if this is practically (that is, ignoring not-so-useful matrix orderings) consistent with the rest of Sage, as this has advantage in performance.


This would be a practical thing to do, as it leaves it to Singular to provide an efficient implementation. Note that this only affects matrix orderings with zeros in the first row â€“ if the entries in the first row are positive, these are returned as degrees as before.

(A potential downside of this is that it forces Singular's notion of degree upon Sage, whereas, if one ignores the Singular backend, Sage could have its own notion. In Macaulay2 for example, the notions of degree and weight are independent. For now, this seems fine though, as much of polynomial arithmetics in Sage is dictated by the Singular backend anyway.)



---

archive/issue_comments_452117.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@mwageringel](#comment%3A13):\n> Should we not add the upstream fix as a patch here? The regular upgrade of Singular might still take quite a while.\n\nIf we do not wait the regular upgrade of Singular, the upstream fix should go to the Singular package of Sage, as a patch (and be removed when the regular upgrade arrives). I guess this is not a good thing to do.\n\n> > I don't object to using `p_LDeg` if this is practically (that is, ignoring not-so-useful matrix orderings) consistent with the rest of Sage, as this has advantage in performance.\n\n> \n> This would be a practical thing to do, as it leaves it to Singular to provide an efficient implementation. Note that this only affects matrix orderings with zeros in the first row \u2013 if the entries in the first row are positive, these are returned as degrees as before.\n\nAfter looking into the implementation of `p_LDeg` in Singular and some experiments, it seems that `p_LDeg` is not that faster than the loop thing with `p_WTotaldegree` as I expected initially. \n\nThen I don't see any advantage of using `p_LDeg` while introducing a backward incompatible change in regard to matrix orderings.\n\nI would prefer the present branch and bear with the bug until Singular gets the regular upgrade.",
    "created_at": "2020-01-15T10:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452117",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@mwageringel](#comment%3A13):
> Should we not add the upstream fix as a patch here? The regular upgrade of Singular might still take quite a while.

If we do not wait the regular upgrade of Singular, the upstream fix should go to the Singular package of Sage, as a patch (and be removed when the regular upgrade arrives). I guess this is not a good thing to do.

> > I don't object to using `p_LDeg` if this is practically (that is, ignoring not-so-useful matrix orderings) consistent with the rest of Sage, as this has advantage in performance.

> 
> This would be a practical thing to do, as it leaves it to Singular to provide an efficient implementation. Note that this only affects matrix orderings with zeros in the first row â€“ if the entries in the first row are positive, these are returned as degrees as before.

After looking into the implementation of `p_LDeg` in Singular and some experiments, it seems that `p_LDeg` is not that faster than the loop thing with `p_WTotaldegree` as I expected initially. 

Then I don't see any advantage of using `p_LDeg` while introducing a backward incompatible change in regard to matrix orderings.

I would prefer the present branch and bear with the bug until Singular gets the regular upgrade.



---

archive/issue_comments_452118.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n> After looking into the implementation of `p_LDeg` in Singular and some experiments, it seems that `p_LDeg` is not that faster than the loop thing with `p_WTotaldegree` as I expected initially. \n\nThis is wrong. I did more experiments. \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('degrevlex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.18 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('degrevlex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.47 ms per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('lex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.25 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('lex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n625 loops, best of 3: 777 \u03bcs per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('wdeglex',(1,2,3,4)))\nsage: [a.degree() for a in R.gens()]\n[1, 2, 3, 4]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n500\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.88 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('wdeglex',(1,2,3,4)))\nsage: [a.degree() for a in R.gens()]\n[1, 2, 3, 4]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n500\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.54 ms per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('deglex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.81 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('deglex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.75 ms per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: m = matrix(4,[4,3,2,1,1,0,0,0,0,1,0,0,0,0,1,0])\nsage: m\n[4 3 2 1]\n[1 0 0 0]\n[0 1 0 0]\n[0 0 1 0]\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))\nsage: [a.degree() for a in R.gens()]\n[4, 3, 2, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n500\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.84 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: m = matrix(4,[4,3,2,1,1,0,0,0,0,1,0,0,0,0,1,0])\nsage: m\n[4 3 2 1]\n[1 0 0 0]\n[0 1 0 0]\n[0 0 1 0]\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))\nsage: [a.degree() for a in R.gens()]\n[4, 3, 2, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n500\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.84 ms per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: m = matrix(2,[3,2,1,0])\nsage: m\n[3 2]\n[1 0]\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m)+TermOrder(m))\nsage: [a.degree() for a in R.gens()]\n[3, 2, 3, 2]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n500\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.17 ms per loop\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.18 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: m = matrix(2,[3,2,1,0])\nsage: m\n[3 2]\n[1 0]\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m)+TermOrder(m))\nsage: [a.degree() for a in R.gens()]\n[3, 2, 3, 2]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n500\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.26 ms per loop\nsage: timeit('f.degree()')\n125 loops, best of 3: 3.28 ms per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('neglex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.18 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('neglex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n625 loops, best of 3: 750 \u03bcs per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: m = matrix(4,[4,0,2,1,1,0,0,0,0,1,0,0,0,0,1,0])\nsage: m\n[4 0 2 1]\n[1 0 0 0]\n[0 1 0 0]\n[0 0 1 0]\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))\nsage: [a.degree() for a in R.gens()]\n[4, 0, 2, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n400\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.82 ms per loop\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.78 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: m = matrix(4,[4,0,2,1,1,0,0,0,0,1,0,0,0,0,1,0])\nsage: m\n[4 0 2 1]\n[1 0 0 0]\n[0 1 0 0]\n[0 0 1 0]\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n625 loops, best of 3: 1.33 ms per loop\nsage: timeit('f.degree()')\n625 loops, best of 3: 1.37 ms per loop\n```\nwith `p_LDeg`\n\n---\n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('invlex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n125 loops, best of 3: 2.21 ms per loop\n```\nwith `p_WTotaldegree` vs \n\n```\nsage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('invlex'))\nsage: [a.degree() for a in R.gens()]\n[1, 1, 1, 1]\nsage: f = (x - y*z - 2*z + w)^100\nsage: f.degree()\n200\nsage: timeit('f.degree()')\n625 loops, best of 3: 766 \u03bcs per loop\n```\nwith `p_LDeg`",
    "created_at": "2020-01-15T15:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452118",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:15" align="right">comment:15</div>

> After looking into the implementation of `p_LDeg` in Singular and some experiments, it seems that `p_LDeg` is not that faster than the loop thing with `p_WTotaldegree` as I expected initially. 

This is wrong. I did more experiments. 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('degrevlex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 3.18 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('degrevlex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 2.47 ms per loop
```
with `p_LDeg`

---

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('lex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 2.25 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('lex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
625 loops, best of 3: 777 Î¼s per loop
```
with `p_LDeg`

---

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('wdeglex',(1,2,3,4)))
sage: [a.degree() for a in R.gens()]
[1, 2, 3, 4]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
500
sage: timeit('f.degree()')
125 loops, best of 3: 3.88 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('wdeglex',(1,2,3,4)))
sage: [a.degree() for a in R.gens()]
[1, 2, 3, 4]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
500
sage: timeit('f.degree()')
125 loops, best of 3: 2.54 ms per loop
```
with `p_LDeg`

---

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('deglex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 3.81 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('deglex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 2.75 ms per loop
```
with `p_LDeg`

---

```
sage: m = matrix(4,[4,3,2,1,1,0,0,0,0,1,0,0,0,0,1,0])
sage: m
[4 3 2 1]
[1 0 0 0]
[0 1 0 0]
[0 0 1 0]
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))
sage: [a.degree() for a in R.gens()]
[4, 3, 2, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
500
sage: timeit('f.degree()')
125 loops, best of 3: 2.84 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: m = matrix(4,[4,3,2,1,1,0,0,0,0,1,0,0,0,0,1,0])
sage: m
[4 3 2 1]
[1 0 0 0]
[0 1 0 0]
[0 0 1 0]
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))
sage: [a.degree() for a in R.gens()]
[4, 3, 2, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
500
sage: timeit('f.degree()')
125 loops, best of 3: 2.84 ms per loop
```
with `p_LDeg`

---

```
sage: m = matrix(2,[3,2,1,0])
sage: m
[3 2]
[1 0]
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m)+TermOrder(m))
sage: [a.degree() for a in R.gens()]
[3, 2, 3, 2]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
500
sage: timeit('f.degree()')
125 loops, best of 3: 3.17 ms per loop
sage: timeit('f.degree()')
125 loops, best of 3: 3.18 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: m = matrix(2,[3,2,1,0])
sage: m
[3 2]
[1 0]
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m)+TermOrder(m))
sage: [a.degree() for a in R.gens()]
[3, 2, 3, 2]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
500
sage: timeit('f.degree()')
125 loops, best of 3: 3.26 ms per loop
sage: timeit('f.degree()')
125 loops, best of 3: 3.28 ms per loop
```
with `p_LDeg`

---

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('neglex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 2.18 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('neglex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
625 loops, best of 3: 750 Î¼s per loop
```
with `p_LDeg`

---

```
sage: m = matrix(4,[4,0,2,1,1,0,0,0,0,1,0,0,0,0,1,0])
sage: m
[4 0 2 1]
[1 0 0 0]
[0 1 0 0]
[0 0 1 0]
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))
sage: [a.degree() for a in R.gens()]
[4, 0, 2, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
400
sage: timeit('f.degree()')
125 loops, best of 3: 2.82 ms per loop
sage: timeit('f.degree()')
125 loops, best of 3: 2.78 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: m = matrix(4,[4,0,2,1,1,0,0,0,0,1,0,0,0,0,1,0])
sage: m
[4 0 2 1]
[1 0 0 0]
[0 1 0 0]
[0 0 1 0]
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder(m))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
625 loops, best of 3: 1.33 ms per loop
sage: timeit('f.degree()')
625 loops, best of 3: 1.37 ms per loop
```
with `p_LDeg`

---

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('invlex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
125 loops, best of 3: 2.21 ms per loop
```
with `p_WTotaldegree` vs 

```
sage: R.<x,y,z,w>=PolynomialRing(QQ,order=TermOrder('invlex'))
sage: [a.degree() for a in R.gens()]
[1, 1, 1, 1]
sage: f = (x - y*z - 2*z + w)^100
sage: f.degree()
200
sage: timeit('f.degree()')
625 loops, best of 3: 766 Î¼s per loop
```
with `p_LDeg`



---

archive/issue_comments_452119.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n> I would prefer the present branch and bear with the bug until Singular gets the regular upgrade. \n\nNow I prefer using `p_LDeg'!",
    "created_at": "2020-01-15T15:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452119",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:16" align="right">comment:16</div>

> I would prefer the present branch and bear with the bug until Singular gets the regular upgrade. 

Now I prefer using `p_LDeg'!



---

archive/issue_comments_452120.json:
```json
{
    "body": "Changed commit from **[`7ccd0d2`](https://github.com/sagemath/sagetrac-mirror/commit/7ccd0d206c574b696481f161e364b46b67fd2ef9)** to **[`896d628`](https://github.com/sagemath/sagetrac-mirror/commit/896d628d5e3de70e01afac79f484c2fc22687b0e)**",
    "created_at": "2020-01-16T02:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452120",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7ccd0d2`](https://github.com/sagemath/sagetrac-mirror/commit/7ccd0d206c574b696481f161e364b46b67fd2ef9)** to **[`896d628`](https://github.com/sagemath/sagetrac-mirror/commit/896d628d5e3de70e01afac79f484c2fc22687b0e)**



---

archive/issue_comments_452121.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/896d628d5e3de70e01afac79f484c2fc22687b0e\"><code>896d628</code></a></td><td><code>Use p_LDeg for degree</code></td></tr></table>\n",
    "created_at": "2020-01-16T02:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452121",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/896d628d5e3de70e01afac79f484c2fc22687b0e"><code>896d628</code></a></td><td><code>Use p_LDeg for degree</code></td></tr></table>




---

archive/issue_events_394834.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2020-01-16T03:05:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394834"
}
```



---

archive/issue_comments_452122.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06c2c54e251d6dc69dbb01f36c18990881e8c808\"><code>06c2c54</code></a></td><td><code>Doctest fixes</code></td></tr></table>\n",
    "created_at": "2020-01-16T03:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452122",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06c2c54e251d6dc69dbb01f36c18990881e8c808"><code>06c2c54</code></a></td><td><code>Doctest fixes</code></td></tr></table>




---

archive/issue_comments_452123.json:
```json
{
    "body": "Changed commit from **[`896d628`](https://github.com/sagemath/sagetrac-mirror/commit/896d628d5e3de70e01afac79f484c2fc22687b0e)** to **[`06c2c54`](https://github.com/sagemath/sagetrac-mirror/commit/06c2c54e251d6dc69dbb01f36c18990881e8c808)**",
    "created_at": "2020-01-16T03:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452123",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`896d628`](https://github.com/sagemath/sagetrac-mirror/commit/896d628d5e3de70e01afac79f484c2fc22687b0e)** to **[`06c2c54`](https://github.com/sagemath/sagetrac-mirror/commit/06c2c54e251d6dc69dbb01f36c18990881e8c808)**



---

archive/issue_comments_452124.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kwankyu](#comment%3A14):\n> If we do not wait the regular upgrade of Singular, the upstream fix should go to the Singular package of Sage, as a patch (and be removed when the regular upgrade arrives). I guess this is not a good thing to do.\n\nOk, if we use `p_LDeg`, we do not actually need the upstream fix.\n\nCould you add a doctest for the example in the ticket description, please? Also, I think we should keep one example of a matrix ordering with zeros in the first row, in order to document the fact that standard grading is now used in that case.\n\nFinally, the imports `p_Deg, p_Totaldegree, p_WTotaldegree, p_WDegree` are not used anymore and could be removed.\n\nOtherwise, this looks good to me. Thanks a lot for the comparisons and the fix.",
    "created_at": "2020-01-16T21:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452124",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kwankyu](#comment%3A14):
> If we do not wait the regular upgrade of Singular, the upstream fix should go to the Singular package of Sage, as a patch (and be removed when the regular upgrade arrives). I guess this is not a good thing to do.

Ok, if we use `p_LDeg`, we do not actually need the upstream fix.

Could you add a doctest for the example in the ticket description, please? Also, I think we should keep one example of a matrix ordering with zeros in the first row, in order to document the fact that standard grading is now used in that case.

Finally, the imports `p_Deg, p_Totaldegree, p_WTotaldegree, p_WDegree` are not used anymore and could be removed.

Otherwise, this looks good to me. Thanks a lot for the comparisons and the fix.



---

archive/issue_comments_452125.json:
```json
{
    "body": "Reviewer: **Markus Wageringel**",
    "created_at": "2020-01-16T21:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452125",
    "user": "https://github.com/mwageringel"
}
```

Reviewer: **Markus Wageringel**



---

archive/issue_comments_452126.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d\"><code>0100ac0</code></a></td><td><code>Fixes for reviewer comments</code></td></tr></table>\n",
    "created_at": "2020-01-17T02:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452126",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d"><code>0100ac0</code></a></td><td><code>Fixes for reviewer comments</code></td></tr></table>




---

archive/issue_comments_452127.json:
```json
{
    "body": "Changed commit from **[`06c2c54`](https://github.com/sagemath/sagetrac-mirror/commit/06c2c54e251d6dc69dbb01f36c18990881e8c808)** to **[`0100ac0`](https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d)**",
    "created_at": "2020-01-17T02:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452127",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`06c2c54`](https://github.com/sagemath/sagetrac-mirror/commit/06c2c54e251d6dc69dbb01f36c18990881e8c808)** to **[`0100ac0`](https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d)**



---

archive/issue_comments_452128.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@mwageringel](#comment%3A20):\n> Replying to [@kwankyu](#comment%3A14):\n> > If we do not wait the regular upgrade of Singular, the upstream fix should go to the Singular package of Sage, as a patch (and be removed when the regular upgrade arrives). I guess this is not a good thing to do.\n\n> \n> Ok, if we use `p_LDeg`, we do not actually need the upstream fix.\n\nRight.\n \n> Could you add a doctest for the example in the ticket description, please? Also, I think we should keep one example of a matrix ordering with zeros in the first row, in order to document the fact that standard grading is now used in that case.\n\nDone.\n\n> Finally, the imports `p_Deg, p_Totaldegree, p_WTotaldegree, p_WDegree` are not used anymore and could be removed.\n\nDone.",
    "created_at": "2020-01-17T02:54:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452128",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@mwageringel](#comment%3A20):
> Replying to [@kwankyu](#comment%3A14):
> > If we do not wait the regular upgrade of Singular, the upstream fix should go to the Singular package of Sage, as a patch (and be removed when the regular upgrade arrives). I guess this is not a good thing to do.

> 
> Ok, if we use `p_LDeg`, we do not actually need the upstream fix.

Right.
 
> Could you add a doctest for the example in the ticket description, please? Also, I think we should keep one example of a matrix ordering with zeros in the first row, in order to document the fact that standard grading is now used in that case.

Done.

> Finally, the imports `p_Deg, p_Totaldegree, p_WTotaldegree, p_WDegree` are not used anymore and could be removed.

Done.



---

archive/issue_comments_452129.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThank you.",
    "created_at": "2020-01-17T08:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452129",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:23" align="right">comment:23</div>

Thank you.



---

archive/issue_events_394835.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-01-17T08:21:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394835"
}
```



---

archive/issue_events_394836.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-01-17T08:21:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394836"
}
```



---

archive/issue_comments_452130.json:
```json
{
    "body": "Changed branch from **[u/klee/28954](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28954)** to **[`0100ac0`](https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d)**",
    "created_at": "2020-01-20T21:18:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28954#issuecomment-452130",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/klee/28954](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28954)** to **[`0100ac0`](https://github.com/sagemath/sagetrac-mirror/commit/0100ac05053ca466fadabc168577971d11e2e97d)**



---

archive/issue_events_394837.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-20T21:18:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394837"
}
```



---

archive/issue_events_394838.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f0b2140404744866ba0e985a52d0dbef8e31706c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-01-20T21:18:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28954",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28954#event-394838"
}
```
