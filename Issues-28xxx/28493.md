# Issue 28493: Update to primecount 5.1

archive/issues_028256.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThe C++ API no longer exposes the different methods, see https://github.com/kimwalisch/primecount/releases/tag/v5.1\n\nTarball: https://codeload.github.com/kimwalisch/primecount/tar.gz/v5.1\n\n\nCC:  @videlec @timokau @kiwifb @isuruf @saraedum\n\nComponent: **packages: optional**\n\nAuthor: **Antonio Rojas**\n\nBranch/Commit: **[`d3170a4`](https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a)**\n\nReviewer: **Vincent Delecroix**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28493_\n\n",
    "closed_at": "2019-10-05T07:58:02Z",
    "created_at": "2019-09-14T15:54:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update to primecount 5.1",
    "type": "issue",
    "updated_at": "2019-10-05T07:58:02Z",
    "url": "https://github.com/sagemath/sage/issues/28493",
    "user": "https://github.com/antonio-rojas"
}
```
<div id="comment:0"></div>

The C++ API no longer exposes the different methods, see https://github.com/kimwalisch/primecount/releases/tag/v5.1

Tarball: https://codeload.github.com/kimwalisch/primecount/tar.gz/v5.1


CC:  @videlec @timokau @kiwifb @isuruf @saraedum

Component: **packages: optional**

Author: **Antonio Rojas**

Branch/Commit: **[`d3170a4`](https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a)**

Reviewer: **Vincent Delecroix**

_Issue created by migration from https://trac.sagemath.org/ticket/28493_





---

archive/issue_events_388136.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2019-09-14T15:54:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388136"
}
```



---

archive/issue_events_388137.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2019-09-14T15:54:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388137"
}
```



---

archive/issue_comments_444096.json:
```json
{
    "body": "Branch: **[u/arojas/update_to_primecount_5_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/update_to_primecount_5_1)**",
    "created_at": "2019-09-14T16:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444096",
    "user": "https://github.com/antonio-rojas"
}
```

Branch: **[u/arojas/update_to_primecount_5_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/update_to_primecount_5_1)**



---

archive/issue_comments_444097.json:
```json
{
    "body": "Commit: **[`23a6eaa`](https://github.com/sagemath/sagetrac-mirror/commit/23a6eaa5e2983f71c7cef0d4beb30defb83351be)**",
    "created_at": "2019-09-14T16:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444097",
    "user": "https://github.com/antonio-rojas"
}
```

Commit: **[`23a6eaa`](https://github.com/sagemath/sagetrac-mirror/commit/23a6eaa5e2983f71c7cef0d4beb30defb83351be)**



---

archive/issue_events_388138.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2019-09-14T16:11:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388138"
}
```



---

archive/issue_comments_444098.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23a6eaa5e2983f71c7cef0d4beb30defb83351be\"><code>23a6eaa</code></a></td><td><code>Update primecount to 5.1</code></td></tr></table>\n",
    "created_at": "2019-09-14T16:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444098",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:2" align="right">comment:2</div>

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23a6eaa5e2983f71c7cef0d4beb30defb83351be"><code>23a6eaa</code></a></td><td><code>Update primecount to 5.1</code></td></tr></table>




---

archive/issue_events_388139.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2019-09-14T16:11:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388139"
}
```



---

archive/issue_comments_444099.json:
```json
{
    "body": "Author: **Antonio Rojas**",
    "created_at": "2019-09-14T16:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444099",
    "user": "https://github.com/antonio-rojas"
}
```

Author: **Antonio Rojas**



---

archive/issue_comments_444100.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI can't get it to show the deprecation message - does it not work in cython?",
    "created_at": "2019-09-14T16:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444100",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:3" align="right">comment:3</div>

I can't get it to show the deprecation message - does it not work in cython?



---

archive/issue_comments_444101.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n+The C++ API no longer exposes the different methods, see https://github.com/kimwalisch/primecount/releases/tag/v5.1\n \n+Tarball: https://codeload.github.com/kimwalisch/primecount/tar.gz/v5.1\n+\n``````\n",
    "created_at": "2019-09-14T16:12:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444101",
    "user": "https://github.com/antonio-rojas"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,4 @@
+The C++ API no longer exposes the different methods, see https://github.com/kimwalisch/primecount/releases/tag/v5.1
 
+Tarball: https://codeload.github.com/kimwalisch/primecount/tar.gz/v5.1
+
``````




---

archive/issue_comments_444102.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt should work but I also don't see the deprecation message.\n\nThe message shows in the doctest environment since with the following modification the tests pass\n\n```diff\ndiff --git a/src/sage/interfaces/primecount.pyx b/src/sage/interfaces/primecount.pyx\nindex fe69d26748..623240d39f 100644\n--- a/src/sage/interfaces/primecount.pyx\n+++ b/src/sage/interfaces/primecount.pyx\n@@ -38,6 +38,13 @@ cpdef int64_t prime_pi(int64_t n, method=None) except -1:\n \n         sage: prime_pi(1000) == 168                     # optional - primecount\n         True\n+\n+        sage: prime_pi(1000, method='deleglise_rivat') == 168\n+        doctest:warning\n+        ...\n+        DeprecationWarning: primecount 5.x no longer supports the 'method' parameter\n+        See https://trac.sagemath.org/28493 for details.\n+        True\n     \"\"\"\n     cdef int64_t ans\n     if method is not None:\n```",
    "created_at": "2019-09-14T18:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444102",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

It should work but I also don't see the deprecation message.

The message shows in the doctest environment since with the following modification the tests pass

```diff
diff --git a/src/sage/interfaces/primecount.pyx b/src/sage/interfaces/primecount.pyx
index fe69d26748..623240d39f 100644
--- a/src/sage/interfaces/primecount.pyx
+++ b/src/sage/interfaces/primecount.pyx
@@ -38,6 +38,13 @@ cpdef int64_t prime_pi(int64_t n, method=None) except -1:
 
         sage: prime_pi(1000) == 168                     # optional - primecount
         True
+
+        sage: prime_pi(1000, method='deleglise_rivat') == 168
+        doctest:warning
+        ...
+        DeprecationWarning: primecount 5.x no longer supports the 'method' parameter
+        See https://trac.sagemath.org/28493 for details.
+        True
     """
     cdef int64_t ans
     if method is not None:
```



---

archive/issue_comments_444103.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou are right. It seems that all `DeprecationWarning` from Cython code are turned off. Two other examples from `matroids/matroid.pyx` and `matrix/matrix_integer_dense.pyx`.\n\n```\nsage: matroids.Uniform(2, 3).is_3connected(separation=True)\n(True, None)\nsage: matrix(2, [2,1,1,1])._invert_unit()\n[ 1 -1]\n[-1  2]\n```",
    "created_at": "2019-09-14T18:44:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444103",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

You are right. It seems that all `DeprecationWarning` from Cython code are turned off. Two other examples from `matroids/matroid.pyx` and `matrix/matrix_integer_dense.pyx`.

```
sage: matroids.Uniform(2, 3).is_3connected(separation=True)
(True, None)
sage: matrix(2, [2,1,1,1])._invert_unit()
[ 1 -1]
[-1  2]
```



---

archive/issue_events_388140.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2019-09-14T18:51:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388140"
}
```



---

archive/issue_comments_444104.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSetting to needs_review then, since the problem is not in this patch",
    "created_at": "2019-09-14T18:51:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444104",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:7" align="right">comment:7</div>

Setting to needs_review then, since the problem is not in this patch



---

archive/issue_comments_444105.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nCC'ing other packagers, in case they also package this",
    "created_at": "2019-09-14T18:54:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444105",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:8" align="right">comment:8</div>

CC'ing other packagers, in case they also package this



---

archive/issue_comments_444106.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nStill, the deprecation would better be doctested... see my patch [comment:5].",
    "created_at": "2019-09-15T13:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444106",
    "user": "https://github.com/videlec"
}
```

<div id="comment:9" align="right">comment:9</div>

Still, the deprecation would better be doctested... see my patch [comment:5].



---

archive/issue_comments_444107.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nSee #28500 for the problem with deprecation not showing up.",
    "created_at": "2019-09-15T13:51:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444107",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>

See #28500 for the problem with deprecation not showing up.



---

archive/issue_comments_444108.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a\"><code>d3170a4</code></a></td><td><code>Test deprecation warning</code></td></tr></table>\n",
    "created_at": "2019-09-15T13:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444108",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a"><code>d3170a4</code></a></td><td><code>Test deprecation warning</code></td></tr></table>




---

archive/issue_comments_444109.json:
```json
{
    "body": "Changed commit from **[`23a6eaa`](https://github.com/sagemath/sagetrac-mirror/commit/23a6eaa5e2983f71c7cef0d4beb30defb83351be)** to **[`d3170a4`](https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a)**",
    "created_at": "2019-09-15T13:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444109",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`23a6eaa`](https://github.com/sagemath/sagetrac-mirror/commit/23a6eaa5e2983f71c7cef0d4beb30defb83351be)** to **[`d3170a4`](https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a)**



---

archive/issue_comments_444110.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2019-09-15T14:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444110",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_388141.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-09-15T14:01:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388141"
}
```



---

archive/issue_events_388142.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-09-15T14:01:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388142"
}
```



---

archive/issue_comments_444111.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nthanks",
    "created_at": "2019-09-15T14:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444111",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

thanks



---

archive/issue_events_388143.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388143"
}
```



---

archive/issue_events_388144.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388144"
}
```



---

archive/issue_comments_444112.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nmoving milestone to 9.0 (after release of 8.9)",
    "created_at": "2019-09-30T08:12:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444112",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

moving milestone to 9.0 (after release of 8.9)



---

archive/issue_events_388145.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-05T07:58:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388145"
}
```



---

archive/issue_events_388146.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8604f536530a182f33897a65576cc887d405700a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-10-05T07:58:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28493#event-388146"
}
```



---

archive/issue_comments_444113.json:
```json
{
    "body": "Changed branch from **[u/arojas/update_to_primecount_5_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/update_to_primecount_5_1)** to **[`d3170a4`](https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a)**",
    "created_at": "2019-10-05T07:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28493#issuecomment-444113",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/arojas/update_to_primecount_5_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/update_to_primecount_5_1)** to **[`d3170a4`](https://github.com/sagemath/sagetrac-mirror/commit/d3170a4395f46556f476d1a829b2a6b1d26e850a)**
