# Issue 28617: Comparison of Frobenius endomorphism is broken

archive/issues_028380.json:
```json
{
    "body": "Over NTL finite fields, comparisons between Frobenius endomorphisms raise an error:\n\n```\nsage: FF = GF(2^20)\nsage: f = FF.frobenius_endomorphism()\nsage: f == FF.frobenius_endomorphism()\nTraceback (most recent call last):\n...\nTypeError: None fails to convert into the map's domain Finite Field in z20 of size 2^20, but a `pushforward` method is not properly implemented\n```\n\n**CC:**  @xcaruso @johanrosenkilde @mbombar @williamstein @tscrim @pjbruin\n\n**Branch/Commit:** [37c186e3eac777e52eaa429b136439ade5b8e589](https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589)\n\n**Reviewer:** Xavier Caruso, Travis Scrimshaw\n\n**Author:** Kwankyu Lee\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28617\n\n",
    "closed_at": "2021-05-27T20:29:21Z",
    "created_at": "2019-10-16T13:02:40Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Comparison of Frobenius endomorphism is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28617",
    "user": "https://github.com/jlavauzelle"
}
```
Over NTL finite fields, comparisons between Frobenius endomorphisms raise an error:

```
sage: FF = GF(2^20)
sage: f = FF.frobenius_endomorphism()
sage: f == FF.frobenius_endomorphism()
Traceback (most recent call last):
...
TypeError: None fails to convert into the map's domain Finite Field in z20 of size 2^20, but a `pushforward` method is not properly implemented
```

**CC:**  @xcaruso @johanrosenkilde @mbombar @williamstein @tscrim @pjbruin

**Branch/Commit:** [37c186e3eac777e52eaa429b136439ade5b8e589](https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589)

**Reviewer:** Xavier Caruso, Travis Scrimshaw

**Author:** Kwankyu Lee

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/28617





---

archive/issue_comments_556535.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe problem comes from comparison between Frobenius endomorphisms:\n\n```\nsage: FF = GF(2^20)\nsage: f = FF.frobenius_endomorphism()\nsage: f == FF.frobenius_endomorphism()\nTraceback (most recent call last):\n...\nTypeError: None fails to convert into the map's domain Finite Field in z20 of size 2^20, but a `pushforward` method is not properly implemented\n```",
    "created_at": "2019-10-16T13:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556535",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:1'></a>
The problem comes from comparison between Frobenius endomorphisms:

```
sage: FF = GF(2^20)
sage: f = FF.frobenius_endomorphism()
sage: f == FF.frobenius_endomorphism()
Traceback (most recent call last):
...
TypeError: None fails to convert into the map's domain Finite Field in z20 of size 2^20, but a `pushforward` method is not properly implemented
```



---

archive/issue_comments_556536.json:
```json
{
    "body": "<a id='comment:2'></a>\nHello Xavier,\n\nThanks for your quick answer. So I guess the problem lies in the fact that no specific `FrobeniusEndomorphism` class/method has been implemented for the `ntl_gf2e` finite field case.\n\nI had a look on what has been done for \"givaro\" finite fields, and this seems to be a quite long work... I'm not sure I have time to write everything properly for the moment.\n\nThanks again,\n\nJulien",
    "created_at": "2019-10-17T08:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556536",
    "user": "https://github.com/jlavauzelle"
}
```

<a id='comment:2'></a>
Hello Xavier,

Thanks for your quick answer. So I guess the problem lies in the fact that no specific `FrobeniusEndomorphism` class/method has been implemented for the `ntl_gf2e` finite field case.

I had a look on what has been done for "givaro" finite fields, and this seems to be a quite long work... I'm not sure I have time to write everything properly for the moment.

Thanks again,

Julien



---

archive/issue_comments_556537.json:
```json
{
    "body": "<a id='comment:3'></a>\nTicket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556537",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>
Ticket retargeted after milestone closed



---

archive/issue_events_081372.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81372"
}
```



---

archive/issue_comments_556538.json:
```json
{
    "body": "<a id='comment:4'></a>\nMoving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556538",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_events_081373.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81373"
}
```



---

archive/issue_events_081374.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81374"
}
```



---

archive/issue_comments_556539.json:
```json
{
    "body": "**Branch:** [u/caruso/richcmp_morphism](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/richcmp_morphism)",
    "created_at": "2020-07-03T19:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556539",
    "user": "https://github.com/xcaruso"
}
```

**Branch:** [u/caruso/richcmp_morphism](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/richcmp_morphism)



---

archive/issue_comments_556540.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2020-07-03T19:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556540",
    "user": "https://github.com/xcaruso"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_556541.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe problem comes from the combination of two facts:\n- the method `_lmul_` is not implemented for NTL finite fields, so it inherits from the abstract class `Element` and just returns `None`\n- in the generic implementation of comparison of morphisms, `_lmul_` is called without further precaution\n\nActually, I do not see why calling `_lmul_` is needed, so I removed this call... which fixes the problem.\n\nPS: Maybe, we should also implement `_lmul_` for NTL finite fields; I don't know if it's required.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c310df6513e4845b074ebd0e650c685247cecd0\">0c310df</a></td><td><code>simplify generic comparison of morphisms</code></td></tr></table>\n",
    "created_at": "2020-07-03T19:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556541",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:7'></a>
The problem comes from the combination of two facts:
- the method `_lmul_` is not implemented for NTL finite fields, so it inherits from the abstract class `Element` and just returns `None`
- in the generic implementation of comparison of morphisms, `_lmul_` is called without further precaution

Actually, I do not see why calling `_lmul_` is needed, so I removed this call... which fixes the problem.

PS: Maybe, we should also implement `_lmul_` for NTL finite fields; I don't know if it's required.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c310df6513e4845b074ebd0e650c685247cecd0">0c310df</a></td><td><code>simplify generic comparison of morphisms</code></td></tr></table>




---

archive/issue_comments_556542.json:
```json
{
    "body": "**Commit:** [0c310df6513e4845b074ebd0e650c685247cecd0](https://github.com/sagemath/sagetrac-mirror/commit/0c310df6513e4845b074ebd0e650c685247cecd0)",
    "created_at": "2020-07-03T19:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556542",
    "user": "https://github.com/xcaruso"
}
```

**Commit:** [0c310df6513e4845b074ebd0e650c685247cecd0](https://github.com/sagemath/sagetrac-mirror/commit/0c310df6513e4845b074ebd0e650c685247cecd0)



---

archive/issue_comments_556543.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0362e48e5e99267be0715fdabf440235fe8be4dd\">0362e48</a></td><td><code>add doctest</code></td></tr></table>\n",
    "created_at": "2020-07-03T19:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0362e48e5e99267be0715fdabf440235fe8be4dd">0362e48</a></td><td><code>add doctest</code></td></tr></table>




---

archive/issue_comments_556544.json:
```json
{
    "body": "**Changing commit** from \"[0c310df6513e4845b074ebd0e650c685247cecd0](https://github.com/sagemath/sagetrac-mirror/commit/0c310df6513e4845b074ebd0e650c685247cecd0)\" to \"[0362e48e5e99267be0715fdabf440235fe8be4dd](https://github.com/sagemath/sagetrac-mirror/commit/0362e48e5e99267be0715fdabf440235fe8be4dd)\".",
    "created_at": "2020-07-03T19:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556544",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0c310df6513e4845b074ebd0e650c685247cecd0](https://github.com/sagemath/sagetrac-mirror/commit/0c310df6513e4845b074ebd0e650c685247cecd0)" to "[0362e48e5e99267be0715fdabf440235fe8be4dd](https://github.com/sagemath/sagetrac-mirror/commit/0362e48e5e99267be0715fdabf440235fe8be4dd)".



---

archive/issue_comments_556545.json:
```json
{
    "body": "**Author:** Xavier Caruso",
    "created_at": "2020-07-04T12:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556545",
    "user": "https://github.com/xcaruso"
}
```

**Author:** Xavier Caruso



---

archive/issue_events_081375.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "rename": {
        "from": "Instantiating SkewPolynomialRing twice fails",
        "to": "Comparison of Frobenius endomorphism is broken"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81375"
}
```



---

archive/issue_comments_556546.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,27 +1,10 @@\n-I would like to report a problem concerning skew polynomial rings.\n-\n-Consider the following function:\n+Over NTL finite fields, comparisons between Frobenius endomorphisms raise an error:\n \n ```\n-def foo(n):\n-    FF = GF(2**n)\n-    f = FF.frobenius_endomorphism()\n-    return SkewPolynomialRing(FF, f, \"X\")\n+sage: FF = GF(2^20)\n+sage: f = FF.frobenius_endomorphism()\n+sage: f == FF.frobenius_endomorphism()\n+Traceback (most recent call last):\n+...\n+TypeError: None fails to convert into the map's domain Finite Field in z20 of size 2^20, but a `pushforward` method is not properly implemented\n ```\n-\n-Then, calling `foo` **twice**, with the same large input (ie., extension degree `n` > 15), raises an error, probably due to some cache problem:\n-\n-```\n-sage: foo(96)\n-Skew Polynomial Ring in X over Finite Field in z96 of size 2^96 twisted by z96 |--> z96^2\n-sage: foo(96)\n-(...)\n-TypeError: None fails to convert into the map's domain Finite Field in z96 of size 2^96, but a `pushforward` method is not properly implemented\n-```\n-\n-Quite surprisingly, the error does not appear when:\n-* the extension degree is less than 15, or\n-* the instantiation of the `SkewPolynomialRing` is not embedded in a function, or\n-* we use classical `PolynomialRing` instead of `SkewPolynomialRing`.\n-\n-Any idea?\n``````\n",
    "created_at": "2020-07-04T12:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556546",
    "user": "https://github.com/xcaruso"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,27 +1,10 @@
-I would like to report a problem concerning skew polynomial rings.
-
-Consider the following function:
+Over NTL finite fields, comparisons between Frobenius endomorphisms raise an error:
 
 ```
-def foo(n):
-    FF = GF(2**n)
-    f = FF.frobenius_endomorphism()
-    return SkewPolynomialRing(FF, f, "X")
+sage: FF = GF(2^20)
+sage: f = FF.frobenius_endomorphism()
+sage: f == FF.frobenius_endomorphism()
+Traceback (most recent call last):
+...
+TypeError: None fails to convert into the map's domain Finite Field in z20 of size 2^20, but a `pushforward` method is not properly implemented
 ```
-
-Then, calling `foo` **twice**, with the same large input (ie., extension degree `n` > 15), raises an error, probably due to some cache problem:
-
-```
-sage: foo(96)
-Skew Polynomial Ring in X over Finite Field in z96 of size 2^96 twisted by z96 |--> z96^2
-sage: foo(96)
-(...)
-TypeError: None fails to convert into the map's domain Finite Field in z96 of size 2^96, but a `pushforward` method is not properly implemented
-```
-
-Quite surprisingly, the error does not appear when:
-* the extension degree is less than 15, or
-* the instantiation of the `SkewPolynomialRing` is not embedded in a function, or
-* we use classical `PolynomialRing` instead of `SkewPolynomialRing`.
-
-Any idea?
``````




---

archive/issue_comments_556547.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [caruso](#comment%3A7):\n> The problem comes from the combination of two facts:\n> - the method `_lmul_` is not implemented for NTL finite fields, so it inherits from the abstract class `Element` and just returns `None`\n> - in the generic implementation of comparison of morphisms, `_lmul_` is called without further precaution\n> \n> Actually, I do not see why calling `_lmul_` is needed, so I removed this call... which fixes the problem.\n> \n> PS: Maybe, we should also implement `_lmul_` for NTL finite fields; I don't know if it's required.\n\n\nI think we need to hear from the initial implementer.",
    "created_at": "2020-07-05T01:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556547",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:10'></a>
Replying to [caruso](#comment%3A7):
> The problem comes from the combination of two facts:
> - the method `_lmul_` is not implemented for NTL finite fields, so it inherits from the abstract class `Element` and just returns `None`
> - in the generic implementation of comparison of morphisms, `_lmul_` is called without further precaution
> 
> Actually, I do not see why calling `_lmul_` is needed, so I removed this call... which fixes the problem.
> 
> PS: Maybe, we should also implement `_lmul_` for NTL finite fields; I don't know if it's required.


I think we need to hear from the initial implementer.



---

archive/issue_comments_556548.json:
```json
{
    "body": "<a id='comment:11'></a>\nWith the patchbot report, I think I see now why using `_lmul_` is appropriate: it's because this code is supposed to work not only for ring homomorphisms but also for module homomorphisms.\n\nSo, I've switched back to the original version but added one test in order to avoid the call to `_lmul_` when a coercion map is defined. I believe it would make things faster.",
    "created_at": "2020-07-05T10:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556548",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:11'></a>
With the patchbot report, I think I see now why using `_lmul_` is appropriate: it's because this code is supposed to work not only for ring homomorphisms but also for module homomorphisms.

So, I've switched back to the original version but added one test in order to avoid the call to `_lmul_` when a coercion map is defined. I believe it would make things faster.



---

archive/issue_comments_556549.json:
```json
{
    "body": "**Changing commit** from \"[0362e48e5e99267be0715fdabf440235fe8be4dd](https://github.com/sagemath/sagetrac-mirror/commit/0362e48e5e99267be0715fdabf440235fe8be4dd)\" to \"[9b4d57ea0733469796b67c4ca3af158f521e4f15](https://github.com/sagemath/sagetrac-mirror/commit/9b4d57ea0733469796b67c4ca3af158f521e4f15)\".",
    "created_at": "2020-07-05T10:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556549",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0362e48e5e99267be0715fdabf440235fe8be4dd](https://github.com/sagemath/sagetrac-mirror/commit/0362e48e5e99267be0715fdabf440235fe8be4dd)" to "[9b4d57ea0733469796b67c4ca3af158f521e4f15](https://github.com/sagemath/sagetrac-mirror/commit/9b4d57ea0733469796b67c4ca3af158f521e4f15)".



---

archive/issue_comments_556550.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b4d57ea0733469796b67c4ca3af158f521e4f15\">9b4d57e</a></td><td><code>use coercion maps when available</code></td></tr></table>\n",
    "created_at": "2020-07-05T10:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556550",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b4d57ea0733469796b67c4ca3af158f521e4f15">9b4d57e</a></td><td><code>use coercion maps when available</code></td></tr></table>




---

archive/issue_comments_556551.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [caruso](#comment%3A11):\n> With the patchbot report, I think I see now why using `_lmul_` is appropriate: it's because this code is supposed to work not only for ring homomorphisms but also for module homomorphisms.\n\n\nI guessed so, but I still do not see it clearly. Would you give an example where `_lmul_` and `_base` things are in work?",
    "created_at": "2020-07-06T10:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556551",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:13'></a>
Replying to [caruso](#comment%3A11):
> With the patchbot report, I think I see now why using `_lmul_` is appropriate: it's because this code is supposed to work not only for ring homomorphisms but also for module homomorphisms.


I guessed so, but I still do not see it clearly. Would you give an example where `_lmul_` and `_base` things are in work?



---

archive/issue_comments_556552.json:
```json
{
    "body": "<a id='comment:14'></a>\nLet us first look at the case of ring homomorphisms. Consider the following:\n\n```\nsage: k.<a> = GF(9)\nsage: Frob = k.frobenius_endomorphism()\nsage: R.<x> = k[] \nsage: phi = R.hom([x^2])\nsage: psi = R.hom([x^2], base_map=Frob)\n```\n\nThen `phi` is definitely different from `psi` because they act differently of `k`:\n\n```\nsage: phi(a)\na\nsage: psi(a)\n2*a + 1\n```\n\nHowever, `R.gens()` consists only of `x` and `phi(x) = psi(x) = x^3`. Therefore, in order to guarantee that two morphisms coincide, we need to check that they take the same values on the generators of the domain, but also recursively on the generators of the base of the domain, the generators of the base of the base of the domain, etc.\n\nNow, the same occurs with modules. If `A` and `B` and two `K`-modules, it's certainly possible to imagine a mapping `A -> B` which is not `K`-linear (for instance, it could be semi-linear)... though I'm not sure it would be easy/possible to define in Sage. Hence, in order to check that two such mappings coincide, we need to check that they agree on the generators but also on the product of generators by (iterated) generators of the ring of scalars. Actually, it is not exactly what the current code does (both before and after my patch): the current code only checks products with the *last* generator of the module. It looks like a bug but I'm not sure about this (because I don't know precisely what `ModuleMorphism` means in Sage).",
    "created_at": "2020-07-06T12:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556552",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:14'></a>
Let us first look at the case of ring homomorphisms. Consider the following:

```
sage: k.<a> = GF(9)
sage: Frob = k.frobenius_endomorphism()
sage: R.<x> = k[] 
sage: phi = R.hom([x^2])
sage: psi = R.hom([x^2], base_map=Frob)
```

Then `phi` is definitely different from `psi` because they act differently of `k`:

```
sage: phi(a)
a
sage: psi(a)
2*a + 1
```

However, `R.gens()` consists only of `x` and `phi(x) = psi(x) = x^3`. Therefore, in order to guarantee that two morphisms coincide, we need to check that they take the same values on the generators of the domain, but also recursively on the generators of the base of the domain, the generators of the base of the base of the domain, etc.

Now, the same occurs with modules. If `A` and `B` and two `K`-modules, it's certainly possible to imagine a mapping `A -> B` which is not `K`-linear (for instance, it could be semi-linear)... though I'm not sure it would be easy/possible to define in Sage. Hence, in order to check that two such mappings coincide, we need to check that they agree on the generators but also on the product of generators by (iterated) generators of the ring of scalars. Actually, it is not exactly what the current code does (both before and after my patch): the current code only checks products with the *last* generator of the module. It looks like a bug but I'm not sure about this (because I don't know precisely what `ModuleMorphism` means in Sage).



---

archive/issue_comments_556553.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [caruso](#comment%3A14):\n> Let us first look at the case of ring homomorphisms. Consider the following:\n> \n> ```\n> sage: k.<a> = GF(9)\n> sage: Frob = k.frobenius_endomorphism()\n> sage: R.<x> = k[] \n> sage: phi = R.hom([x^2])\n> sage: psi = R.hom([x^2], base_map=Frob)\n> ```\n> \n> Then `phi` is definitely different from `psi` because they act differently of `k`:\n> \n> ```\n> sage: phi(a)\n> a\n> sage: psi(a)\n> 2*a + 1\n> ```\n> \n> However, `R.gens()` consists only of `x` and `phi(x) = psi(x) = x^3`. Therefore, in order to guarantee that two morphisms coincide, we need to check that they take the same values on the generators of the domain, but also recursively on the generators of the base of the domain, the generators of the base of the base of the domain, etc.\n\n\nRight.. But this is not a relevant example to the current issue. `_lmul_` and `_base` are not involved here.\n\nPutting the math behind `_richcmp_` aside, the direct cause of the failure is that `g._lmul_(h)` does not work (returns `None`) for g in the finite field k and h in the prime base field of k. \n\n```diff\ndiff --git a/src/sage/categories/morphism.pyx b/src/sage/categories/morphism.pyx\nindex dec8b00b74..b41f5e7e2a 100644\n--- a/src/sage/categories/morphism.pyx\n+++ b/src/sage/categories/morphism.pyx\n@@ -362,7 +362,7 @@ cdef class Morphism(Map):\n             # gens by picking an element of the initial domain (e) and\n             # multiplying it with the gens of the scalar ring.\n             if e is not None and isinstance(e, ModuleElement):\n-                gens = [(<ModuleElement>e)._lmul_(x) for x in gens]\n+                gens = [e._lmul_(x) for x in gens]\n             for e in gens:\n                 x = self(e)\n                 y = other(e)\ndiff --git a/src/sage/rings/finite_rings/element_base.pyx b/src/sage/rings/finite_rings/element_base.pyx\nindex 97d4260a18..e81155b316 100755\n--- a/src/sage/rings/finite_rings/element_base.pyx\n+++ b/src/sage/rings/finite_rings/element_base.pyx\n@@ -30,6 +30,10 @@ def is_FiniteFieldElement(x):\n \n \n cdef class FiniteRingElement(CommutativeRingElement):\n+    def _lmul_(self, other):\n+        return self * other\n+\n```\n\nThis fixes the problem.",
    "created_at": "2020-07-07T03:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556553",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:15'></a>
Replying to [caruso](#comment%3A14):
> Let us first look at the case of ring homomorphisms. Consider the following:
> 
> ```
> sage: k.<a> = GF(9)
> sage: Frob = k.frobenius_endomorphism()
> sage: R.<x> = k[] 
> sage: phi = R.hom([x^2])
> sage: psi = R.hom([x^2], base_map=Frob)
> ```
> 
> Then `phi` is definitely different from `psi` because they act differently of `k`:
> 
> ```
> sage: phi(a)
> a
> sage: psi(a)
> 2*a + 1
> ```
> 
> However, `R.gens()` consists only of `x` and `phi(x) = psi(x) = x^3`. Therefore, in order to guarantee that two morphisms coincide, we need to check that they take the same values on the generators of the domain, but also recursively on the generators of the base of the domain, the generators of the base of the base of the domain, etc.


Right.. But this is not a relevant example to the current issue. `_lmul_` and `_base` are not involved here.

Putting the math behind `_richcmp_` aside, the direct cause of the failure is that `g._lmul_(h)` does not work (returns `None`) for g in the finite field k and h in the prime base field of k. 

```diff
diff --git a/src/sage/categories/morphism.pyx b/src/sage/categories/morphism.pyx
index dec8b00b74..b41f5e7e2a 100644
--- a/src/sage/categories/morphism.pyx
+++ b/src/sage/categories/morphism.pyx
@@ -362,7 +362,7 @@ cdef class Morphism(Map):
             # gens by picking an element of the initial domain (e) and
             # multiplying it with the gens of the scalar ring.
             if e is not None and isinstance(e, ModuleElement):
-                gens = [(<ModuleElement>e)._lmul_(x) for x in gens]
+                gens = [e._lmul_(x) for x in gens]
             for e in gens:
                 x = self(e)
                 y = other(e)
diff --git a/src/sage/rings/finite_rings/element_base.pyx b/src/sage/rings/finite_rings/element_base.pyx
index 97d4260a18..e81155b316 100755
--- a/src/sage/rings/finite_rings/element_base.pyx
+++ b/src/sage/rings/finite_rings/element_base.pyx
@@ -30,6 +30,10 @@ def is_FiniteFieldElement(x):
 
 
 cdef class FiniteRingElement(CommutativeRingElement):
+    def _lmul_(self, other):
+        return self * other
+
```

This fixes the problem.



---

archive/issue_comments_556554.json:
```json
{
    "body": "<a id='comment:16'></a>\nHi,\nI'm quite new to Sage, but why exactly `e` would be different from `<ModuleElement>e` when `e` is the generator of the finite field ?\n\nIf we get into that, \n\n```\n    if e is not None and isinstance(e, ModuleElement):\n       gens = [(<ModuleElement>e)._lmul_(x) for x in gens]\n```\n\n`e` should be an instance of `ModuleElement`, isn't it ? Therefore, I don't get why there is this coercion in the first place, which is removed in [klee](#comment%3A15)'s proposal.\n\nObviously, they are different : If we keep this coercion, we still have the failure, even when `_lmul_` is defined for `FiniteRingElement`. However, `e == <ModuleElement>e` evaluates to `True`. Can someone explain to me the difference please ?\n\n\nMy question here brings another one: By removing the coercion, aren't we breaking anything else ?\n\n\n\nAnyway, this issue led me to trac ticket #24281. The example mentioned in the description is interesting, because `f` and `g` are both defined on `None` and evaluate to `0`, hence the result. Otherwise I guess there would have been the same exception. Is this a side effect of anything else ? Or is it normal to define a morphism on `None` ? And if so, wouldn't it solve the problem to define the Frobenius map on `None` either ? In fact, the Frobenius map is well defined on `None` for other fields :\n\n\n```\nsage: k = GF(9)\nsage: frob = k.frobenius_endomorphism()\nsage: frob(None)\n0\nsage: frob == k.frobenius_endomorphism()\nTrue\nsage: k = GF(2^15)  # Givaro                                                                          \nsage: frob = k.frobenius_endomorphism()\nsage: frob(None)\n0\nsage: frob == k.frobenius_endomorphism()\nTrue\nsage: k = GF(2^16)\nsage: frob = k.frobenius_endomorphism()                                                                        \nsage: frob(None) \n...\nTypeError: None fails to convert into the map's domain Finite Field in z16 of size 2^16, but a `pushforward` method is not properly implemented\n```",
    "created_at": "2020-08-29T20:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556554",
    "user": "https://github.com/mbombar"
}
```

<a id='comment:16'></a>
Hi,
I'm quite new to Sage, but why exactly `e` would be different from `<ModuleElement>e` when `e` is the generator of the finite field ?

If we get into that, 

```
    if e is not None and isinstance(e, ModuleElement):
       gens = [(<ModuleElement>e)._lmul_(x) for x in gens]
```

`e` should be an instance of `ModuleElement`, isn't it ? Therefore, I don't get why there is this coercion in the first place, which is removed in [klee](#comment%3A15)'s proposal.

Obviously, they are different : If we keep this coercion, we still have the failure, even when `_lmul_` is defined for `FiniteRingElement`. However, `e == <ModuleElement>e` evaluates to `True`. Can someone explain to me the difference please ?


My question here brings another one: By removing the coercion, aren't we breaking anything else ?



Anyway, this issue led me to trac ticket #24281. The example mentioned in the description is interesting, because `f` and `g` are both defined on `None` and evaluate to `0`, hence the result. Otherwise I guess there would have been the same exception. Is this a side effect of anything else ? Or is it normal to define a morphism on `None` ? And if so, wouldn't it solve the problem to define the Frobenius map on `None` either ? In fact, the Frobenius map is well defined on `None` for other fields :


```
sage: k = GF(9)
sage: frob = k.frobenius_endomorphism()
sage: frob(None)
0
sage: frob == k.frobenius_endomorphism()
True
sage: k = GF(2^15)  # Givaro                                                                          
sage: frob = k.frobenius_endomorphism()
sage: frob(None)
0
sage: frob == k.frobenius_endomorphism()
True
sage: k = GF(2^16)
sage: frob = k.frobenius_endomorphism()                                                                        
sage: frob(None) 
...
TypeError: None fails to convert into the map's domain Finite Field in z16 of size 2^16, but a `pushforward` method is not properly implemented
```



---

archive/issue_comments_556555.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [gh-mbombar](#comment%3A16):\n> Hi,\n> I'm quite new to Sage, but why exactly `e` would be different from `<ModuleElement>e` when `e` is the generator of the finite field ?\n> \n> If we get into that, \n> \n> ```\n>     if e is not None and isinstance(e, ModuleElement):\n>        gens = [(<ModuleElement>e)._lmul_(x) for x in gens]\n> ```\n> \n> `e` should be an instance of `ModuleElement`, isn't it ? Therefore, I don't get why there is this coercion in the first place, which is removed in [klee](#comment%3A15)'s proposal.\n\n\nI had the same question. My guess is what follows. With the coercion, `_lmul_` defined on `ModuleElement` class is invoked, and somehow leads to the failure. Without the coercion, `_lmul_` defined on `FiniteRingElement` is invoked, and I provided an implementation of that method.\n\n> \n> However, `e == <ModuleElement>e` evaluates to `True`. \n\n\nEquality test is on a different level, and complicated. This being `True` is not relevant with the behavior of the above code in issue. \n\n> My question here brings another one: By removing the coercion, aren't we breaking anything else ?\n\n\nI guess not. I hope not.\n\n> Anyway, this issue led me to trac ticket #24281. The example mentioned in the description is interesting, because `f` and `g` are both defined on `None` and evaluate to `0`, hence the result. Otherwise I guess there would have been the same exception. Is this a side effect of anything else ? Or is it normal to define a morphism on `None` ? And if so, wouldn't it solve the problem to define the Frobenius map on `None` either ? In fact, the Frobenius map is well defined on `None` for other fields :\n> \n> \n> ```\n> sage: k = GF(9)\n> sage: frob = k.frobenius_endomorphism()\n> sage: frob(None)\n> 0\n> sage: frob == k.frobenius_endomorphism()\n> True\n> sage: k = GF(2^15)  # Givaro                                                                          \n> sage: frob = k.frobenius_endomorphism()\n> sage: frob(None)\n> 0\n> sage: frob == k.frobenius_endomorphism()\n> True\n> sage: k = GF(2^16)\n> sage: frob = k.frobenius_endomorphism()                                                                        \n> sage: frob(None) \n> ...\n> TypeError: None fails to convert into the map's domain Finite Field in z16 of size 2^16, but a `pushforward` method is not properly implemented\n> ```\n\n\nFrobenius maps are not defined on `None`, mathematically. The above are just consequences of Sage coercion (different concept from the Cython coercion above) of `None` to `0` element.",
    "created_at": "2020-08-30T02:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556555",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:17'></a>
Replying to [gh-mbombar](#comment%3A16):
> Hi,
> I'm quite new to Sage, but why exactly `e` would be different from `<ModuleElement>e` when `e` is the generator of the finite field ?
> 
> If we get into that, 
> 
> ```
>     if e is not None and isinstance(e, ModuleElement):
>        gens = [(<ModuleElement>e)._lmul_(x) for x in gens]
> ```
> 
> `e` should be an instance of `ModuleElement`, isn't it ? Therefore, I don't get why there is this coercion in the first place, which is removed in [klee](#comment%3A15)'s proposal.


I had the same question. My guess is what follows. With the coercion, `_lmul_` defined on `ModuleElement` class is invoked, and somehow leads to the failure. Without the coercion, `_lmul_` defined on `FiniteRingElement` is invoked, and I provided an implementation of that method.

> 
> However, `e == <ModuleElement>e` evaluates to `True`. 


Equality test is on a different level, and complicated. This being `True` is not relevant with the behavior of the above code in issue. 

> My question here brings another one: By removing the coercion, aren't we breaking anything else ?


I guess not. I hope not.

> Anyway, this issue led me to trac ticket #24281. The example mentioned in the description is interesting, because `f` and `g` are both defined on `None` and evaluate to `0`, hence the result. Otherwise I guess there would have been the same exception. Is this a side effect of anything else ? Or is it normal to define a morphism on `None` ? And if so, wouldn't it solve the problem to define the Frobenius map on `None` either ? In fact, the Frobenius map is well defined on `None` for other fields :
> 
> 
> ```
> sage: k = GF(9)
> sage: frob = k.frobenius_endomorphism()
> sage: frob(None)
> 0
> sage: frob == k.frobenius_endomorphism()
> True
> sage: k = GF(2^15)  # Givaro                                                                          
> sage: frob = k.frobenius_endomorphism()
> sage: frob(None)
> 0
> sage: frob == k.frobenius_endomorphism()
> True
> sage: k = GF(2^16)
> sage: frob = k.frobenius_endomorphism()                                                                        
> sage: frob(None) 
> ...
> TypeError: None fails to convert into the map's domain Finite Field in z16 of size 2^16, but a `pushforward` method is not properly implemented
> ```


Frobenius maps are not defined on `None`, mathematically. The above are just consequences of Sage coercion (different concept from the Cython coercion above) of `None` to `0` element.



---

archive/issue_comments_556556.json:
```json
{
    "body": "<a id='comment:18'></a>\nI am willing to upload a patch implementing the simple fix in[comment:15](#comment%3A15), if no one objects.",
    "created_at": "2020-09-08T05:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556556",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:18'></a>
I am willing to upload a patch implementing the simple fix in[comment:15](#comment%3A15), if no one objects.



---

archive/issue_comments_556557.json:
```json
{
    "body": "**Changing commit** from \"[9b4d57ea0733469796b67c4ca3af158f521e4f15](https://github.com/sagemath/sagetrac-mirror/commit/9b4d57ea0733469796b67c4ca3af158f521e4f15)\" to \"\".",
    "created_at": "2020-09-09T06:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556557",
    "user": "https://github.com/kwankyu"
}
```

**Changing commit** from "[9b4d57ea0733469796b67c4ca3af158f521e4f15](https://github.com/sagemath/sagetrac-mirror/commit/9b4d57ea0733469796b67c4ca3af158f521e4f15)" to "".



---

archive/issue_comments_556558.json:
```json
{
    "body": "**Changing branch** from \"[u/caruso/richcmp_morphism](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/richcmp_morphism)\" to \"[u/klee/28617](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28617)\".",
    "created_at": "2020-09-09T06:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556558",
    "user": "https://github.com/kwankyu"
}
```

**Changing branch** from "[u/caruso/richcmp_morphism](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/richcmp_morphism)" to "[u/klee/28617](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28617)".



---

archive/issue_comments_556559.json:
```json
{
    "body": "**Commit:** [ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24](https://github.com/sagemath/sagetrac-mirror/commit/ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24)",
    "created_at": "2020-09-09T06:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24](https://github.com/sagemath/sagetrac-mirror/commit/ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24)



---

archive/issue_comments_556560.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24\">ac32ca9</a></td><td><code>Provide _lmul_ for finite ring elements</code></td></tr></table>\n",
    "created_at": "2020-09-09T06:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24">ac32ca9</a></td><td><code>Provide _lmul_ for finite ring elements</code></td></tr></table>




---

archive/issue_comments_556561.json:
```json
{
    "body": "**Changing author** from \"Xavier Caruso\" to \"Xavier Caruso, Kwankyu Lee\".",
    "created_at": "2020-09-09T06:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556561",
    "user": "https://github.com/kwankyu"
}
```

**Changing author** from "Xavier Caruso" to "Xavier Caruso, Kwankyu Lee".



---

archive/issue_events_081376.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81376"
}
```



---

archive/issue_events_081377.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81377"
}
```



---

archive/issue_comments_556562.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8300a98e92053a7202ad0d7125022209edc157c1\">8300a98</a></td><td><code>Provide _lmul_ for finite ring elements</code></td></tr></table>\n",
    "created_at": "2020-12-16T08:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8300a98e92053a7202ad0d7125022209edc157c1">8300a98</a></td><td><code>Provide _lmul_ for finite ring elements</code></td></tr></table>




---

archive/issue_comments_556563.json:
```json
{
    "body": "**Changing commit** from \"[ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24](https://github.com/sagemath/sagetrac-mirror/commit/ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24)\" to \"[8300a98e92053a7202ad0d7125022209edc157c1](https://github.com/sagemath/sagetrac-mirror/commit/8300a98e92053a7202ad0d7125022209edc157c1)\".",
    "created_at": "2020-12-16T08:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24](https://github.com/sagemath/sagetrac-mirror/commit/ac32ca9b8e2b0efed040f9abeddd30b1b5f2fc24)" to "[8300a98e92053a7202ad0d7125022209edc157c1](https://github.com/sagemath/sagetrac-mirror/commit/8300a98e92053a7202ad0d7125022209edc157c1)".



---

archive/issue_events_081378.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81378"
}
```



---

archive/issue_events_081379.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81379"
}
```



---

archive/issue_comments_556564.json:
```json
{
    "body": "<a id='comment:24'></a>\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556564",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_556565.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2021-04-28T05:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556565",
    "user": "https://github.com/roed314"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_556566.json:
```json
{
    "body": "<a id='comment:25'></a>\nThis branch no longer merges, and there's quite a bit of discussion after Xavier marked it as needs review.",
    "created_at": "2021-04-28T05:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556566",
    "user": "https://github.com/roed314"
}
```

<a id='comment:25'></a>
This branch no longer merges, and there's quite a bit of discussion after Xavier marked it as needs review.



---

archive/issue_comments_556567.json:
```json
{
    "body": "**Changing commit** from \"[8300a98e92053a7202ad0d7125022209edc157c1](https://github.com/sagemath/sagetrac-mirror/commit/8300a98e92053a7202ad0d7125022209edc157c1)\" to \"[ad1a0b0d4adf2f92d006a2f953461845cfecb678](https://github.com/sagemath/sagetrac-mirror/commit/ad1a0b0d4adf2f92d006a2f953461845cfecb678)\".",
    "created_at": "2021-04-28T07:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556567",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8300a98e92053a7202ad0d7125022209edc157c1](https://github.com/sagemath/sagetrac-mirror/commit/8300a98e92053a7202ad0d7125022209edc157c1)" to "[ad1a0b0d4adf2f92d006a2f953461845cfecb678](https://github.com/sagemath/sagetrac-mirror/commit/ad1a0b0d4adf2f92d006a2f953461845cfecb678)".



---

archive/issue_comments_556568.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad1a0b0d4adf2f92d006a2f953461845cfecb678\">ad1a0b0</a></td><td><code>Provide _lmul_ for finite ring elements</code></td></tr></table>\n",
    "created_at": "2021-04-28T07:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556568",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad1a0b0d4adf2f92d006a2f953461845cfecb678">ad1a0b0</a></td><td><code>Provide _lmul_ for finite ring elements</code></td></tr></table>




---

archive/issue_comments_556569.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2021-04-28T08:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556569",
    "user": "https://github.com/kwankyu"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_556570.json:
```json
{
    "body": "<a id='comment:28'></a>\nThe patch fixes the problem. But I do not understand the logic of the code in `_richcmp_` well. In particular, the business of the base gens stuff... Hence someone who does should look at it.",
    "created_at": "2021-04-28T09:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556570",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:28'></a>
The patch fixes the problem. But I do not understand the logic of the code in `_richcmp_` well. In particular, the business of the base gens stuff... Hence someone who does should look at it.



---

archive/issue_comments_556571.json:
```json
{
    "body": "**Reviewer:** Xavier Caruso",
    "created_at": "2021-04-28T13:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556571",
    "user": "https://github.com/xcaruso"
}
```

**Reviewer:** Xavier Caruso



---

archive/issue_comments_556572.json:
```json
{
    "body": "**Changing author** from \"Xavier Caruso, Kwankyu Lee\" to \"Kwankyu Lee\".",
    "created_at": "2021-04-28T13:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556572",
    "user": "https://github.com/xcaruso"
}
```

**Changing author** from "Xavier Caruso, Kwankyu Lee" to "Kwankyu Lee".



---

archive/issue_comments_556573.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-04-28T13:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556573",
    "user": "https://github.com/xcaruso"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_556574.json:
```json
{
    "body": "<a id='comment:29'></a>\nI don't know if it's correct but I tried to explain what I've understood on[comment:14](#comment%3A14).\n\nOK for fixing the issue as you propose for this ticket (so I'm giving a positive review). However, I think that thinking again at the best way to check equalities between general morphims would be a good idea for another ticket.",
    "created_at": "2021-04-28T13:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556574",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:29'></a>
I don't know if it's correct but I tried to explain what I've understood on[comment:14](#comment%3A14).

OK for fixing the issue as you propose for this ticket (so I'm giving a positive review). However, I think that thinking again at the best way to check equalities between general morphims would be a good idea for another ticket.



---

archive/issue_comments_556575.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [caruso](#comment%3A29):\n> OK for fixing the issue as you propose for this ticket (so I'm giving a positive review). \n\n\nThank you.\n\n>However, I think that thinking again at the best way to check equalities between general morphims would be a good idea for another ticket.\n\n\nand the code needs more documentation and examples.",
    "created_at": "2021-04-29T00:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556575",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:30'></a>
Replying to [caruso](#comment%3A29):
> OK for fixing the issue as you propose for this ticket (so I'm giving a positive review). 


Thank you.

>However, I think that thinking again at the best way to check equalities between general morphims would be a good idea for another ticket.


and the code needs more documentation and examples.



---

archive/issue_comments_556576.json:
```json
{
    "body": "<a id='comment:31'></a>\nFor[comment:28](#comment%3A28): Yes, what is in[comment:15](#comment%3A15) is correct. Here is another way of explaining it. The base check just means it goes down recursively, which is necessary to check that we get the same map. For example, consider two cyclic R-modules M = <x>, N = <y> and morphisms f<sub>1</sub>, f<sub>2</sub>: M -> N such that f<sub>1</sub>(r*x) = r*y and f<sub>2</sub>(r*x) = g(r)*y, where g: R -> R is some non-trivial automorphism. On basis vectors (i.e., the generators), both f<sub>1</sub> and f<sub>2</sub> map x -> y. However, they are not the same morphism when you map the generators of R.\n\nI am not completely sure about this fix. It seems like it could lead to an infinite loop because `*` could call the `_lmul_`, which then calls `*`. It feels like there should be a bit better of a solution, but I don't know offhand what that is.",
    "created_at": "2021-04-29T11:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556576",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:31'></a>
For[comment:28](#comment%3A28): Yes, what is in[comment:15](#comment%3A15) is correct. Here is another way of explaining it. The base check just means it goes down recursively, which is necessary to check that we get the same map. For example, consider two cyclic R-modules M = <x>, N = <y> and morphisms f<sub>1</sub>, f<sub>2</sub>: M -> N such that f<sub>1</sub>(r*x) = r*y and f<sub>2</sub>(r*x) = g(r)*y, where g: R -> R is some non-trivial automorphism. On basis vectors (i.e., the generators), both f<sub>1</sub> and f<sub>2</sub> map x -> y. However, they are not the same morphism when you map the generators of R.

I am not completely sure about this fix. It seems like it could lead to an infinite loop because `*` could call the `_lmul_`, which then calls `*`. It feels like there should be a bit better of a solution, but I don't know offhand what that is.



---

archive/issue_comments_556577.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [tscrim](#comment%3A31):\n\nIs this part also correct?\n\n... the current code only checks products with the *last* generator of the module. It \n    looks like a bug ...\n\nIs it a bug?",
    "created_at": "2021-04-29T12:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556577",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:32'></a>
Replying to [tscrim](#comment%3A31):

Is this part also correct?

... the current code only checks products with the *last* generator of the module. It 
    looks like a bug ...

Is it a bug?



---

archive/issue_comments_556578.json:
```json
{
    "body": "<a id='comment:33'></a>\nI don't think so. It is enough to recurse down on the last generator because everything before and including that must have compared equal. All you are doing is comparing stuff in the base ring at that point.",
    "created_at": "2021-04-29T13:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556578",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'></a>
I don't think so. It is enough to recurse down on the last generator because everything before and including that must have compared equal. All you are doing is comparing stuff in the base ring at that point.



---

archive/issue_comments_556579.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62785e0709d0d8c6ad873f3fc083b928a2228dbb\">62785e0</a></td><td><code>Make cpdef _lmul_</code></td></tr></table>\n",
    "created_at": "2021-04-30T03:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556579",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62785e0709d0d8c6ad873f3fc083b928a2228dbb">62785e0</a></td><td><code>Make cpdef _lmul_</code></td></tr></table>




---

archive/issue_comments_556580.json:
```json
{
    "body": "**Changing commit** from \"[ad1a0b0d4adf2f92d006a2f953461845cfecb678](https://github.com/sagemath/sagetrac-mirror/commit/ad1a0b0d4adf2f92d006a2f953461845cfecb678)\" to \"[62785e0709d0d8c6ad873f3fc083b928a2228dbb](https://github.com/sagemath/sagetrac-mirror/commit/62785e0709d0d8c6ad873f3fc083b928a2228dbb)\".",
    "created_at": "2021-04-30T03:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ad1a0b0d4adf2f92d006a2f953461845cfecb678](https://github.com/sagemath/sagetrac-mirror/commit/ad1a0b0d4adf2f92d006a2f953461845cfecb678)" to "[62785e0709d0d8c6ad873f3fc083b928a2228dbb](https://github.com/sagemath/sagetrac-mirror/commit/62785e0709d0d8c6ad873f3fc083b928a2228dbb)".



---

archive/issue_comments_556581.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2021-04-30T03:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556581",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_556582.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [tscrim](#comment%3A33):\n> I don't think so. It is enough to recurse down on the last generator because everything before and including that must have compared equal. All you are doing is comparing stuff in the base ring at that point.\n\n\nOkay. I now understand the code better. The last generator is just picked up to compare the images of scalar multiplications with the base ring generators. Thanks.",
    "created_at": "2021-04-30T03:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556582",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:35'></a>
Replying to [tscrim](#comment%3A33):
> I don't think so. It is enough to recurse down on the last generator because everything before and including that must have compared equal. All you are doing is comparing stuff in the base ring at that point.


Okay. I now understand the code better. The last generator is just picked up to compare the images of scalar multiplications with the base ring generators. Thanks.



---

archive/issue_comments_556583.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [tscrim](#comment%3A31):\n\n> I am not completely sure about this fix. It seems like it could lead to an infinite loop because `*` could call the `_lmul_`, which then calls `*`. It feels like there should be a bit better of a solution, but I don't know offhand what that is.\n\n\nIn the last commit, I made `_lmul_` `cpdef`ed and use `_mul_` instead of `*`. This is simpler and seems safer.",
    "created_at": "2021-04-30T03:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556583",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:36'></a>
Replying to [tscrim](#comment%3A31):

> I am not completely sure about this fix. It seems like it could lead to an infinite loop because `*` could call the `_lmul_`, which then calls `*`. It feels like there should be a bit better of a solution, but I don't know offhand what that is.


In the last commit, I made `_lmul_` `cpdef`ed and use `_mul_` instead of `*`. This is simpler and seems safer.



---

archive/issue_comments_556584.json:
```json
{
    "body": "**Changing commit** from \"[62785e0709d0d8c6ad873f3fc083b928a2228dbb](https://github.com/sagemath/sagetrac-mirror/commit/62785e0709d0d8c6ad873f3fc083b928a2228dbb)\" to \"[0d2dd5dce40364f27ab47ccef761d1610a4f4edd](https://github.com/sagemath/sagetrac-mirror/commit/0d2dd5dce40364f27ab47ccef761d1610a4f4edd)\".",
    "created_at": "2021-04-30T04:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556584",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[62785e0709d0d8c6ad873f3fc083b928a2228dbb](https://github.com/sagemath/sagetrac-mirror/commit/62785e0709d0d8c6ad873f3fc083b928a2228dbb)" to "[0d2dd5dce40364f27ab47ccef761d1610a4f4edd](https://github.com/sagemath/sagetrac-mirror/commit/0d2dd5dce40364f27ab47ccef761d1610a4f4edd)".



---

archive/issue_comments_556585.json:
```json
{
    "body": "<a id='comment:37'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d2dd5dce40364f27ab47ccef761d1610a4f4edd\">0d2dd5d</a></td><td><code>Fix a typo</code></td></tr></table>\n",
    "created_at": "2021-04-30T04:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556585",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d2dd5dce40364f27ab47ccef761d1610a4f4edd">0d2dd5d</a></td><td><code>Fix a typo</code></td></tr></table>




---

archive/issue_comments_556586.json:
```json
{
    "body": "<a id='comment:38'></a>\nI think you should wrap the `_mul_` with a `try-except` block and return `None` if an error is raised from trying to do the coercion. Now it will likely fail later on in the same way, but by returning `None`, the remaining coercion framework for `*` gets invoked. This then tries to find a larger common parent (which might succeed) rather than just simply trying to force it into the same parent as `self`. This also allows us to say that there is no (left) action of `other` on `self`. I doubt I could think of a doctest for this specific case (although perhaps over two suitably chosen base rings) though...",
    "created_at": "2021-04-30T06:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556586",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:38'></a>
I think you should wrap the `_mul_` with a `try-except` block and return `None` if an error is raised from trying to do the coercion. Now it will likely fail later on in the same way, but by returning `None`, the remaining coercion framework for `*` gets invoked. This then tries to find a larger common parent (which might succeed) rather than just simply trying to force it into the same parent as `self`. This also allows us to say that there is no (left) action of `other` on `self`. I doubt I could think of a doctest for this specific case (although perhaps over two suitably chosen base rings) though...



---

archive/issue_comments_556587.json:
```json
{
    "body": "**Changing commit** from \"[0d2dd5dce40364f27ab47ccef761d1610a4f4edd](https://github.com/sagemath/sagetrac-mirror/commit/0d2dd5dce40364f27ab47ccef761d1610a4f4edd)\" to \"[967f8483e3fbb30f99ab861f9970d6b6bea199ff](https://github.com/sagemath/sagetrac-mirror/commit/967f8483e3fbb30f99ab861f9970d6b6bea199ff)\".",
    "created_at": "2021-04-30T08:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556587",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0d2dd5dce40364f27ab47ccef761d1610a4f4edd](https://github.com/sagemath/sagetrac-mirror/commit/0d2dd5dce40364f27ab47ccef761d1610a4f4edd)" to "[967f8483e3fbb30f99ab861f9970d6b6bea199ff](https://github.com/sagemath/sagetrac-mirror/commit/967f8483e3fbb30f99ab861f9970d6b6bea199ff)".



---

archive/issue_comments_556588.json:
```json
{
    "body": "<a id='comment:39'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/967f8483e3fbb30f99ab861f9970d6b6bea199ff\">967f848</a></td><td><code>Try coercion first</code></td></tr></table>\n",
    "created_at": "2021-04-30T08:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/967f8483e3fbb30f99ab861f9970d6b6bea199ff">967f848</a></td><td><code>Try coercion first</code></td></tr></table>




---

archive/issue_comments_556589.json:
```json
{
    "body": "<a id='comment:40'></a>\nNow I wonder whether `FiniteRingElement` class is the right place to put `_lmul_` method. The scalar multiplication is naturally defined for all rings. So `RingElement` class might be a better place. I experimented on this idea, but I got lots of doctest failures. So I would not attempt this on this ticket.",
    "created_at": "2021-04-30T08:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556589",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:40'></a>
Now I wonder whether `FiniteRingElement` class is the right place to put `_lmul_` method. The scalar multiplication is naturally defined for all rings. So `RingElement` class might be a better place. I experimented on this idea, but I got lots of doctest failures. So I would not attempt this on this ticket.



---

archive/issue_comments_556590.json:
```json
{
    "body": "<a id='comment:41'></a>\nActually \n\n```\n----------------------------------------------------------------------\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/complex_arb.pyx  # 1 doctest failed\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/qqbar.py  # 1 doctest failed\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/infinite_polynomial_element.py  # 6 doctests failed\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/skew_polynomial_ring.py  # 2 doctests failed\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/polynomial_element.pyx  # 1 doctest failed\nsage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/ore_function_element.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\nSo not so many...",
    "created_at": "2021-04-30T08:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556590",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:41'></a>
Actually 

```
----------------------------------------------------------------------
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/complex_arb.pyx  # 1 doctest failed
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/qqbar.py  # 1 doctest failed
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/infinite_polynomial_element.py  # 6 doctests failed
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/skew_polynomial_ring.py  # 2 doctests failed
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/polynomial_element.pyx  # 1 doctest failed
sage -t --warn-long 65.6 --random-seed=0 src/sage/rings/polynomial/ore_function_element.py  # 1 doctest failed
----------------------------------------------------------------------
```
So not so many...



---

archive/issue_comments_556591.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [klee](#comment%3A32):\n>     ... the current code only checks products with the *last* generator of the module. It \n>     looks like a bug ...\n\n> \n> Is it a bug?\n\n\nI think that at least the code needs to make sure that the last generator is non-zero. For example, this fails in this case:\n\n```\nsage: K.<a> = QuadraticField(-1)\nsage: R.<x,y> = K['x,y'].quotient('y')\nsage: id = R.Hom(R).identity()\nsage: f = R.hom(R.gens(), R, base_map=K.hom([-a], K))\nsage: f == id  # should be False\nTrue\n```\n(Currently, this fails because `_lmul_` returns `None`, though.)\n\nThis example is from ticket [ticket:30938#comment:3], where we were also confused about this `_richcmp_` implementation.",
    "created_at": "2021-05-03T18:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556591",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:42'></a>
Replying to [klee](#comment%3A32):
>     ... the current code only checks products with the *last* generator of the module. It 
>     looks like a bug ...

> 
> Is it a bug?


I think that at least the code needs to make sure that the last generator is non-zero. For example, this fails in this case:

```
sage: K.<a> = QuadraticField(-1)
sage: R.<x,y> = K['x,y'].quotient('y')
sage: id = R.Hom(R).identity()
sage: f = R.hom(R.gens(), R, base_map=K.hom([-a], K))
sage: f == id  # should be False
True
```
(Currently, this fails because `_lmul_` returns `None`, though.)

This example is from ticket [ticket:30938#comment:3], where we were also confused about this `_richcmp_` implementation.



---

archive/issue_comments_556592.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c3582094e430f3c21e569f2a289b9eb013c3c78\">7c35820</a></td><td><code>Merge branch 'develop' into frobenius-trac28617</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e7b7845b3958301a419166382b789e80b969477f\">e7b7845</a></td><td><code>Use nonzero gen for base elements comparison</code></td></tr></table>\n",
    "created_at": "2021-05-04T02:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556592",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c3582094e430f3c21e569f2a289b9eb013c3c78">7c35820</a></td><td><code>Merge branch 'develop' into frobenius-trac28617</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e7b7845b3958301a419166382b789e80b969477f">e7b7845</a></td><td><code>Use nonzero gen for base elements comparison</code></td></tr></table>




---

archive/issue_comments_556593.json:
```json
{
    "body": "**Changing commit** from \"[967f8483e3fbb30f99ab861f9970d6b6bea199ff](https://github.com/sagemath/sagetrac-mirror/commit/967f8483e3fbb30f99ab861f9970d6b6bea199ff)\" to \"[e7b7845b3958301a419166382b789e80b969477f](https://github.com/sagemath/sagetrac-mirror/commit/e7b7845b3958301a419166382b789e80b969477f)\".",
    "created_at": "2021-05-04T02:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556593",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[967f8483e3fbb30f99ab861f9970d6b6bea199ff](https://github.com/sagemath/sagetrac-mirror/commit/967f8483e3fbb30f99ab861f9970d6b6bea199ff)" to "[e7b7845b3958301a419166382b789e80b969477f](https://github.com/sagemath/sagetrac-mirror/commit/e7b7845b3958301a419166382b789e80b969477f)".



---

archive/issue_comments_556594.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [gh-mwageringel](#comment%3A42):\n> I think that at least the code needs to make sure that the last generator is non-zero. For example, this fails in this case:\n> \n> ```\n> sage: K.<a> = QuadraticField(-1)\n> sage: R.<x,y> = K['x,y'].quotient('y')\n> sage: id = R.Hom(R).identity()\n> sage: f = R.hom(R.gens(), R, base_map=K.hom([-a], K))\n> sage: f == id  # should be False\n> True\n> ```\n> Currently, this fails because `_lmul_` returns `None`, though.\n\n\nDone. But the example still fails as you said.",
    "created_at": "2021-05-04T02:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556594",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:44'></a>
Replying to [gh-mwageringel](#comment%3A42):
> I think that at least the code needs to make sure that the last generator is non-zero. For example, this fails in this case:
> 
> ```
> sage: K.<a> = QuadraticField(-1)
> sage: R.<x,y> = K['x,y'].quotient('y')
> sage: id = R.Hom(R).identity()
> sage: f = R.hom(R.gens(), R, base_map=K.hom([-a], K))
> sage: f == id  # should be False
> True
> ```
> Currently, this fails because `_lmul_` returns `None`, though.


Done. But the example still fails as you said.



---

archive/issue_comments_556595.json:
```json
{
    "body": "<a id='comment:45'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a895363d55dfdf8a610251e80ca963afcba9bb8f\">a895363</a></td><td><code>Use coercion model to get scalar multiplication</code></td></tr></table>\n",
    "created_at": "2021-05-04T04:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556595",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a895363d55dfdf8a610251e80ca963afcba9bb8f">a895363</a></td><td><code>Use coercion model to get scalar multiplication</code></td></tr></table>




---

archive/issue_comments_556596.json:
```json
{
    "body": "**Changing commit** from \"[e7b7845b3958301a419166382b789e80b969477f](https://github.com/sagemath/sagetrac-mirror/commit/e7b7845b3958301a419166382b789e80b969477f)\" to \"[a895363d55dfdf8a610251e80ca963afcba9bb8f](https://github.com/sagemath/sagetrac-mirror/commit/a895363d55dfdf8a610251e80ca963afcba9bb8f)\".",
    "created_at": "2021-05-04T04:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556596",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e7b7845b3958301a419166382b789e80b969477f](https://github.com/sagemath/sagetrac-mirror/commit/e7b7845b3958301a419166382b789e80b969477f)" to "[a895363d55dfdf8a610251e80ca963afcba9bb8f](https://github.com/sagemath/sagetrac-mirror/commit/a895363d55dfdf8a610251e80ca963afcba9bb8f)".



---

archive/issue_comments_556597.json:
```json
{
    "body": "<a id='comment:46'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb1835d32398f5772072244302b622cde3ebbbbe\">bb1835d</a></td><td><code>Remove _lmul_ not unnecessary</code></td></tr></table>\n",
    "created_at": "2021-05-04T04:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556597",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb1835d32398f5772072244302b622cde3ebbbbe">bb1835d</a></td><td><code>Remove _lmul_ not unnecessary</code></td></tr></table>




---

archive/issue_comments_556598.json:
```json
{
    "body": "**Changing commit** from \"[a895363d55dfdf8a610251e80ca963afcba9bb8f](https://github.com/sagemath/sagetrac-mirror/commit/a895363d55dfdf8a610251e80ca963afcba9bb8f)\" to \"[bb1835d32398f5772072244302b622cde3ebbbbe](https://github.com/sagemath/sagetrac-mirror/commit/bb1835d32398f5772072244302b622cde3ebbbbe)\".",
    "created_at": "2021-05-04T04:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556598",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a895363d55dfdf8a610251e80ca963afcba9bb8f](https://github.com/sagemath/sagetrac-mirror/commit/a895363d55dfdf8a610251e80ca963afcba9bb8f)" to "[bb1835d32398f5772072244302b622cde3ebbbbe](https://github.com/sagemath/sagetrac-mirror/commit/bb1835d32398f5772072244302b622cde3ebbbbe)".



---

archive/issue_comments_556599.json:
```json
{
    "body": "<a id='comment:47'></a>\nLooking at #30938, requiring each ring to implement `_lmul_` to avoid this morphism comparison problem seems not a good solution. It seems to me that the `_richcmp_` method of a generic morphism should try to get the necessary scalar multiplication in a general way, that is, via the coercion model. It will be a little bit slower but will work well generally.",
    "created_at": "2021-05-04T04:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556599",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:47'></a>
Looking at #30938, requiring each ring to implement `_lmul_` to avoid this morphism comparison problem seems not a good solution. It seems to me that the `_richcmp_` method of a generic morphism should try to get the necessary scalar multiplication in a general way, that is, via the coercion model. It will be a little bit slower but will work well generally.



---

archive/issue_comments_556600.json:
```json
{
    "body": "<a id='comment:48'></a>\nYeah, I agree that avoiding a direct call to `_lmul_` is best, since multiplication by the base ring is allowed to be implemented using other methods.",
    "created_at": "2021-05-04T13:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556600",
    "user": "https://github.com/roed314"
}
```

<a id='comment:48'></a>
Yeah, I agree that avoiding a direct call to `_lmul_` is best, since multiplication by the base ring is allowed to be implemented using other methods.



---

archive/issue_comments_556601.json:
```json
{
    "body": "<a id='comment:49'></a>\nIf I am not mistaken, there is still a problem with the theory behind this. For example:\n\n```\nsage: S.<a,b> = QQ['a,b'].quotient(['a*b'])\nsage: R.<x> = S['x']\nsage: f = R.hom([b], R, base_map=S.hom([-a, b], S))\nsage: g = R.hom([b], R)\nsage: f == g  # False is correct\nFalse\n```\nThe above only gives the correct answer because `f` and `g` have the same type, so a different comparison function is used. With the generic implementation, this gives the wrong answer:\n\n```\nsage: from sage.structure.richcmp import op_EQ\nsage: from sage.rings.morphism import RingMap\nsage: RingMap._richcmp_(f, g, op_EQ)  # should be False\nTrue\n```\nHere, `f(x)==g(x)` and `f(a*x)==g(a*x)` does not imply `f(a)==g(a)`, so the implementation relies on a cancellation property that does not hold in general.\n\nAs a module, `x` does not generate `R`, but `R` is generated by all monomials in `x`. In this case, the monomial `x^0` is the only generator for which the images of `a*x^0`, `b*x^0` allow to distinguish `f` and `g`.\n\nIt may be necessary to separate the implementations for rings and modules. For rings, it is enough to check that `f` and `g` agree on the generators of the ring and, recursively, on the generators of the base ring. For modules, I am not so sure \u2013 maybe we need to restrict to the case of module *homomorphisms* and raise a `NotImplementedError` otherwise.",
    "created_at": "2021-05-04T22:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556601",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:49'></a>
If I am not mistaken, there is still a problem with the theory behind this. For example:

```
sage: S.<a,b> = QQ['a,b'].quotient(['a*b'])
sage: R.<x> = S['x']
sage: f = R.hom([b], R, base_map=S.hom([-a, b], S))
sage: g = R.hom([b], R)
sage: f == g  # False is correct
False
```
The above only gives the correct answer because `f` and `g` have the same type, so a different comparison function is used. With the generic implementation, this gives the wrong answer:

```
sage: from sage.structure.richcmp import op_EQ
sage: from sage.rings.morphism import RingMap
sage: RingMap._richcmp_(f, g, op_EQ)  # should be False
True
```
Here, `f(x)==g(x)` and `f(a*x)==g(a*x)` does not imply `f(a)==g(a)`, so the implementation relies on a cancellation property that does not hold in general.

As a module, `x` does not generate `R`, but `R` is generated by all monomials in `x`. In this case, the monomial `x^0` is the only generator for which the images of `a*x^0`, `b*x^0` allow to distinguish `f` and `g`.

It may be necessary to separate the implementations for rings and modules. For rings, it is enough to check that `f` and `g` agree on the generators of the ring and, recursively, on the generators of the base ring. For modules, I am not so sure  maybe we need to restrict to the case of module *homomorphisms* and raise a `NotImplementedError` otherwise.



---

archive/issue_comments_556602.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [gh-mwageringel](#comment%3A49):\n> so the implementation relies on a cancellation property that does not hold in general.\n\n\nGood point. \n\n> It may be necessary to separate the implementations for rings and modules. \n\n\nAssuming cancellation property is reasonable for most ring and modules in Sage. So I think the implementation is okay for generic morphisms. You just showed that it is not adequate for general rings. Fortunately Sage seems to provide a different implementation for the exceptional rings as you explained. \n\nI would document that the implementation for generic morphisms is assuming cancellation property so that future developers be warned for the trap.",
    "created_at": "2021-05-04T23:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556602",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:50'></a>
Replying to [gh-mwageringel](#comment%3A49):
> so the implementation relies on a cancellation property that does not hold in general.


Good point. 

> It may be necessary to separate the implementations for rings and modules. 


Assuming cancellation property is reasonable for most ring and modules in Sage. So I think the implementation is okay for generic morphisms. You just showed that it is not adequate for general rings. Fortunately Sage seems to provide a different implementation for the exceptional rings as you explained. 

I would document that the implementation for generic morphisms is assuming cancellation property so that future developers be warned for the trap.



---

archive/issue_comments_556603.json:
```json
{
    "body": "<a id='comment:51'></a>\nWhy not just do\n\n```diff\n-coercion_model.bin_op(e, B.coerce(x), operator.mul)\n+e * B.coerce(x)\n```\nI find it easier to understand and it could use some optimizations that are present in `__mul__` (such as with integers and rationals).",
    "created_at": "2021-05-05T02:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556603",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:51'></a>
Why not just do

```diff
-coercion_model.bin_op(e, B.coerce(x), operator.mul)
+e * B.coerce(x)
```
I find it easier to understand and it could use some optimizations that are present in `__mul__` (such as with integers and rationals).



---

archive/issue_comments_556604.json:
```json
{
    "body": "<a id='comment:52'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c750280d3e6ed7f831397477e1f2a55fb341a4fc\">c750280</a></td><td><code>Use * instead of bin_op</code></td></tr></table>\n",
    "created_at": "2021-05-05T05:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556604",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c750280d3e6ed7f831397477e1f2a55fb341a4fc">c750280</a></td><td><code>Use * instead of bin_op</code></td></tr></table>




---

archive/issue_comments_556605.json:
```json
{
    "body": "**Changing commit** from \"[bb1835d32398f5772072244302b622cde3ebbbbe](https://github.com/sagemath/sagetrac-mirror/commit/bb1835d32398f5772072244302b622cde3ebbbbe)\" to \"[c750280d3e6ed7f831397477e1f2a55fb341a4fc](https://github.com/sagemath/sagetrac-mirror/commit/c750280d3e6ed7f831397477e1f2a55fb341a4fc)\".",
    "created_at": "2021-05-05T05:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556605",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bb1835d32398f5772072244302b622cde3ebbbbe](https://github.com/sagemath/sagetrac-mirror/commit/bb1835d32398f5772072244302b622cde3ebbbbe)" to "[c750280d3e6ed7f831397477e1f2a55fb341a4fc](https://github.com/sagemath/sagetrac-mirror/commit/c750280d3e6ed7f831397477e1f2a55fb341a4fc)".



---

archive/issue_comments_556606.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [klee](#comment%3A50):\n> Assuming cancellation property is reasonable for most ring and modules in Sage. So I think the implementation is okay for generic morphisms. You just showed that it is not adequate for general rings. Fortunately Sage seems to provide a different implementation for the exceptional rings as you explained. \n\n\nThere are ways to construct the same maps but with different Python types, which seems to be the original motivation for #24281. Here are two examples, where the generic implementation is used:\n\n```\nsage: S.<a,b> = QQ['a,b'].quotient('a*b')\nsage: R.<x> = S[]\nsage: f = R.hom([b], R)\nsage: g = R.hom([b], R) * R.hom(S.hom([-a, b], S), R)\nsage: f == g  # should be False\nTrue\n```\n\n```\nsage: from sage.rings.polynomial.flatten import SpecializationMorphism\nsage: f2 = SpecializationMorphism(R, {x:b})\nsage: g2 = R.hom([b], S, base_map=S.hom([-a, b], S))\nsage: f2 == g2  # should be False\nTrue\n```\nSo making assumptions in the generic implementation which do not hold in general opens the door to mathematically wrong answers.",
    "created_at": "2021-05-05T07:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556606",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:53'></a>
Replying to [klee](#comment%3A50):
> Assuming cancellation property is reasonable for most ring and modules in Sage. So I think the implementation is okay for generic morphisms. You just showed that it is not adequate for general rings. Fortunately Sage seems to provide a different implementation for the exceptional rings as you explained. 


There are ways to construct the same maps but with different Python types, which seems to be the original motivation for #24281. Here are two examples, where the generic implementation is used:

```
sage: S.<a,b> = QQ['a,b'].quotient('a*b')
sage: R.<x> = S[]
sage: f = R.hom([b], R)
sage: g = R.hom([b], R) * R.hom(S.hom([-a, b], S), R)
sage: f == g  # should be False
True
```

```
sage: from sage.rings.polynomial.flatten import SpecializationMorphism
sage: f2 = SpecializationMorphism(R, {x:b})
sage: g2 = R.hom([b], S, base_map=S.hom([-a, b], S))
sage: f2 == g2  # should be False
True
```
So making assumptions in the generic implementation which do not hold in general opens the door to mathematically wrong answers.



---

archive/issue_comments_556607.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [gh-mwageringel](#comment%3A53):\n> So making assumptions in the generic implementation which do not hold in general opens the door to mathematically wrong answers.\n\n\nI agree that the generic implementation is not perfect, and it needs to be replaced if someone comes up with a better one. On the other hand, the current patch solves the problem of this ticket by improving the implementation. \n\nIf a perfect solution is not around now, I suggest to open another ticket for it later.",
    "created_at": "2021-05-05T13:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556607",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:54'></a>
Replying to [gh-mwageringel](#comment%3A53):
> So making assumptions in the generic implementation which do not hold in general opens the door to mathematically wrong answers.


I agree that the generic implementation is not perfect, and it needs to be replaced if someone comes up with a better one. On the other hand, the current patch solves the problem of this ticket by improving the implementation. 

If a perfect solution is not around now, I suggest to open another ticket for it later.



---

archive/issue_comments_556608.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [klee](#comment%3A54):\n> On the other hand, the current patch solves the problem of this ticket by improving the implementation. \n\n\nYes, I agree the current branch is better than what we had. I am ok with these changes.\n\nJust one small comment:\n\n```diff\n+from sage.structure.coerce cimport coercion_model\n```\nThis import does not seem to be needed anymore.",
    "created_at": "2021-05-05T19:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556608",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:55'></a>
Replying to [klee](#comment%3A54):
> On the other hand, the current patch solves the problem of this ticket by improving the implementation. 


Yes, I agree the current branch is better than what we had. I am ok with these changes.

Just one small comment:

```diff
+from sage.structure.coerce cimport coercion_model
```
This import does not seem to be needed anymore.



---

archive/issue_comments_556609.json:
```json
{
    "body": "<a id='comment:56'></a>\nI'm fine with closing this ticket as it is.\n\nHowever, I need to mention that while working on #21413 about two years ago, I already noticed that comparison of ring morphisms was not really reliable and I implemented my own equality checking in `sage.rings.ring_extension_morphism` (function `are_equal_morphisms`). Probably, this code should be merged in the class `RingHomomorphism` at some point.",
    "created_at": "2021-05-05T19:42:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556609",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:56'></a>
I'm fine with closing this ticket as it is.

However, I need to mention that while working on #21413 about two years ago, I already noticed that comparison of ring morphisms was not really reliable and I implemented my own equality checking in `sage.rings.ring_extension_morphism` (function `are_equal_morphisms`). Probably, this code should be merged in the class `RingHomomorphism` at some point.



---

archive/issue_comments_556610.json:
```json
{
    "body": "**Changing commit** from \"[c750280d3e6ed7f831397477e1f2a55fb341a4fc](https://github.com/sagemath/sagetrac-mirror/commit/c750280d3e6ed7f831397477e1f2a55fb341a4fc)\" to \"[5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae](https://github.com/sagemath/sagetrac-mirror/commit/5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae)\".",
    "created_at": "2021-05-06T00:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556610",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c750280d3e6ed7f831397477e1f2a55fb341a4fc](https://github.com/sagemath/sagetrac-mirror/commit/c750280d3e6ed7f831397477e1f2a55fb341a4fc)" to "[5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae](https://github.com/sagemath/sagetrac-mirror/commit/5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae)".



---

archive/issue_comments_556611.json:
```json
{
    "body": "<a id='comment:57'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae\">5415bd7</a></td><td><code>Remove unnecessary import</code></td></tr></table>\n",
    "created_at": "2021-05-06T00:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556611",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae">5415bd7</a></td><td><code>Remove unnecessary import</code></td></tr></table>




---

archive/issue_comments_556612.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [gh-mwageringel](#comment%3A55):\n> \n> ```diff\n> +from sage.structure.coerce cimport coercion_model\n> ```\n> This import does not seem to be needed anymore.\n\n\nFixed. Thanks.",
    "created_at": "2021-05-06T00:14:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556612",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:58'></a>
Replying to [gh-mwageringel](#comment%3A55):
> 
> ```diff
> +from sage.structure.coerce cimport coercion_model
> ```
> This import does not seem to be needed anymore.


Fixed. Thanks.



---

archive/issue_comments_556613.json:
```json
{
    "body": "**Changing commit** from \"[5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae](https://github.com/sagemath/sagetrac-mirror/commit/5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae)\" to \"[fc019e23ab54eadcc258d9da14a72d45630b0610](https://github.com/sagemath/sagetrac-mirror/commit/fc019e23ab54eadcc258d9da14a72d45630b0610)\".",
    "created_at": "2021-05-06T00:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556613",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae](https://github.com/sagemath/sagetrac-mirror/commit/5415bd761a2f5f6f31cdff5b0bb5a2182f9fc2ae)" to "[fc019e23ab54eadcc258d9da14a72d45630b0610](https://github.com/sagemath/sagetrac-mirror/commit/fc019e23ab54eadcc258d9da14a72d45630b0610)".



---

archive/issue_comments_556614.json:
```json
{
    "body": "<a id='comment:59'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc019e23ab54eadcc258d9da14a72d45630b0610\">fc019e2</a></td><td><code>Add reference to #31783</code></td></tr></table>\n",
    "created_at": "2021-05-06T00:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556614",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc019e23ab54eadcc258d9da14a72d45630b0610">fc019e2</a></td><td><code>Add reference to #31783</code></td></tr></table>




---

archive/issue_comments_556615.json:
```json
{
    "body": "<a id='comment:60'></a>\nReplying to [caruso](#comment%3A56):\n> I need to mention that while working on #21413 about two years ago, I already noticed that comparison of ring morphisms was not really reliable and I implemented my own equality checking in `sage.rings.ring_extension_morphism` (function `are_equal_morphisms`). Probably, this code should be merged in the class `RingHomomorphism` at some point.\n\n\nGood. You may provide the code to #31783.",
    "created_at": "2021-05-06T00:18:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556615",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:60'></a>
Replying to [caruso](#comment%3A56):
> I need to mention that while working on #21413 about two years ago, I already noticed that comparison of ring morphisms was not really reliable and I implemented my own equality checking in `sage.rings.ring_extension_morphism` (function `are_equal_morphisms`). Probably, this code should be merged in the class `RingHomomorphism` at some point.


Good. You may provide the code to #31783.



---

archive/issue_comments_556616.json:
```json
{
    "body": "**Changing commit** from \"[fc019e23ab54eadcc258d9da14a72d45630b0610](https://github.com/sagemath/sagetrac-mirror/commit/fc019e23ab54eadcc258d9da14a72d45630b0610)\" to \"[37c186e3eac777e52eaa429b136439ade5b8e589](https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589)\".",
    "created_at": "2021-05-06T09:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fc019e23ab54eadcc258d9da14a72d45630b0610](https://github.com/sagemath/sagetrac-mirror/commit/fc019e23ab54eadcc258d9da14a72d45630b0610)" to "[37c186e3eac777e52eaa429b136439ade5b8e589](https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589)".



---

archive/issue_comments_556617.json:
```json
{
    "body": "<a id='comment:61'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589\">37c186e</a></td><td><code>Rewrite the added comment</code></td></tr></table>\n",
    "created_at": "2021-05-06T09:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:61'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589">37c186e</a></td><td><code>Rewrite the added comment</code></td></tr></table>




---

archive/issue_comments_556618.json:
```json
{
    "body": "<a id='comment:62'></a>\nAfter some thought, I became not sure of the added comment that the problem of the comparison method is only the assumption of the cancellation property. So I rewrote it only about a fact.\n\nThere is no change in the code. As it was a green light, we may still assume green light.\n\nFurther discussion on the problem should continue in #31783.",
    "created_at": "2021-05-06T09:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556618",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:62'></a>
After some thought, I became not sure of the added comment that the problem of the comparison method is only the assumption of the cancellation property. So I rewrote it only about a fact.

There is no change in the code. As it was a green light, we may still assume green light.

Further discussion on the problem should continue in #31783.



---

archive/issue_comments_556619.json:
```json
{
    "body": "<a id='comment:63'></a>\nShouldn't we reset:\n\n```diff\n             if e is not None and isinstance(e, ModuleElement):\n                 B = (<ModuleElement>e)._parent._base\n                 gens = [e * B.coerce(x) for x in gens]\n+                e = None\n```\nOtherwise we wouldn't set `e` to be an element of `gens` on subsequent calls. This would only show up if we have to go more than twice down, which we may not have a doctest for.",
    "created_at": "2021-05-07T05:55:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556619",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:63'></a>
Shouldn't we reset:

```diff
             if e is not None and isinstance(e, ModuleElement):
                 B = (<ModuleElement>e)._parent._base
                 gens = [e * B.coerce(x) for x in gens]
+                e = None
```
Otherwise we wouldn't set `e` to be an element of `gens` on subsequent calls. This would only show up if we have to go more than twice down, which we may not have a doctest for.



---

archive/issue_comments_556620.json:
```json
{
    "body": "<a id='comment:64'></a>\nReplying to [tscrim](#comment%3A63):\n> Shouldn't we reset:\n> \n> ```diff\n>              if e is not None and isinstance(e, ModuleElement):\n>                  B = (<ModuleElement>e)._parent._base\n>                  gens = [e * B.coerce(x) for x in gens]\n> +                e = None\n> ```\n> Otherwise we wouldn't set `e` to be an element of `gens` on subsequent calls. This would only show up if we have to go more than twice down, which we may not have a doctest for.\n\n\ne should remain as an element of the module. All base elements are coerced to the scalar ring of the module.",
    "created_at": "2021-05-07T06:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556620",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:64'></a>
Replying to [tscrim](#comment%3A63):
> Shouldn't we reset:
> 
> ```diff
>              if e is not None and isinstance(e, ModuleElement):
>                  B = (<ModuleElement>e)._parent._base
>                  gens = [e * B.coerce(x) for x in gens]
> +                e = None
> ```
> Otherwise we wouldn't set `e` to be an element of `gens` on subsequent calls. This would only show up if we have to go more than twice down, which we may not have a doctest for.


e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.



---

archive/issue_comments_556621.json:
```json
{
    "body": "<a id='comment:65'></a>\nReplying to [klee](#comment%3A64):\n> Replying to [tscrim](#comment%3A63):\n> > Shouldn't we reset:\n> > [snip]\n> > Otherwise we wouldn't set `e` to be an element of `gens` on subsequent calls. This would only show up if we have to go more than twice down, which we may not have a doctest for.\n\n> \n> e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.\n\n\nI thought we wanted a recursion going a level deeper each time. Perhaps we can add a doctest for this behavior?",
    "created_at": "2021-05-07T06:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556621",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:65'></a>
Replying to [klee](#comment%3A64):
> Replying to [tscrim](#comment%3A63):
> > Shouldn't we reset:
> > [snip]
> > Otherwise we wouldn't set `e` to be an element of `gens` on subsequent calls. This would only show up if we have to go more than twice down, which we may not have a doctest for.

> 
> e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.


I thought we wanted a recursion going a level deeper each time. Perhaps we can add a doctest for this behavior?



---

archive/issue_comments_556622.json:
```json
{
    "body": "<a id='comment:66'></a>\nReplying to [tscrim](#comment%3A65):\n> Replying to [klee](#comment%3A64):\n> > e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.\n\n> \n> I thought we wanted a recursion going a level deeper each time. Perhaps we can add a doctest for this behavior?\n\n\nI think the recursion should limit to the base ring of the base ring for module morphisms. For ring morphisms, the implementation seems inherently flawed as Markus showed.\n\nAnyway, the patch fixes the problem of the ticket but do not alter the logic or algorithm of the implementation. The flaw of the algorithm should now be dealt with in #31783. I hope that someone with a proved algorithm propose a patch to completely fix the morphism comparison problem in Sage.",
    "created_at": "2021-05-09T10:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556622",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:66'></a>
Replying to [tscrim](#comment%3A65):
> Replying to [klee](#comment%3A64):
> > e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.

> 
> I thought we wanted a recursion going a level deeper each time. Perhaps we can add a doctest for this behavior?


I think the recursion should limit to the base ring of the base ring for module morphisms. For ring morphisms, the implementation seems inherently flawed as Markus showed.

Anyway, the patch fixes the problem of the ticket but do not alter the logic or algorithm of the implementation. The flaw of the algorithm should now be dealt with in #31783. I hope that someone with a proved algorithm propose a patch to completely fix the morphism comparison problem in Sage.



---

archive/issue_comments_556623.json:
```json
{
    "body": "<a id='comment:67'></a>\nReplying to [klee](#comment%3A66):\n> Replying to [tscrim](#comment%3A65):\n> > Replying to [klee](#comment%3A64):\n> > > e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.\n\n> > \n> > I thought we wanted a recursion going a level deeper each time. Perhaps we can add a doctest for this behavior?\n\n> \n> I think the recursion should limit to the base ring of the base ring for module morphisms. For ring morphisms, the implementation seems inherently flawed as Markus showed.\n\n\nI think it needs to go down as deep as possible. This is what the code currently does.\n\n> Anyway, the patch fixes the problem of the ticket but do not alter the logic or algorithm of the implementation. The flaw of the algorithm should now be dealt with in #31783. I hope that someone with a proved algorithm propose a patch to completely fix the morphism comparison problem in Sage. \n\n\nI am not fully convinced the logic has not changed. However, I am convinced enough that it works to let it in. I still would like a doctest doing the comparison with functions that are at least 2 deep in the recursion instead of just once to make sure it works. For example\n\n```\nZ[x] -> Z[x][y] -> Z[x][y][z]\n```\nwhere at each step we twist the generator `a -> -a`. I can write the doctest explicitly tomorrow.",
    "created_at": "2021-05-11T07:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556623",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:67'></a>
Replying to [klee](#comment%3A66):
> Replying to [tscrim](#comment%3A65):
> > Replying to [klee](#comment%3A64):
> > > e should remain as an element of the module. All base elements are coerced to the scalar ring of the module.

> > 
> > I thought we wanted a recursion going a level deeper each time. Perhaps we can add a doctest for this behavior?

> 
> I think the recursion should limit to the base ring of the base ring for module morphisms. For ring morphisms, the implementation seems inherently flawed as Markus showed.


I think it needs to go down as deep as possible. This is what the code currently does.

> Anyway, the patch fixes the problem of the ticket but do not alter the logic or algorithm of the implementation. The flaw of the algorithm should now be dealt with in #31783. I hope that someone with a proved algorithm propose a patch to completely fix the morphism comparison problem in Sage. 


I am not fully convinced the logic has not changed. However, I am convinced enough that it works to let it in. I still would like a doctest doing the comparison with functions that are at least 2 deep in the recursion instead of just once to make sure it works. For example

```
Z[x] -> Z[x][y] -> Z[x][y][z]
```
where at each step we twist the generator `a -> -a`. I can write the doctest explicitly tomorrow.



---

archive/issue_comments_556624.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [tscrim](#comment%3A67):\n> I think the recursion should limit to the base ring of the base ring for module morphisms. For ring morphisms, the implementation seems inherently flawed as Markus showed.\n> \n> I think it needs to go down as deep as possible. This is what the code currently does.\n\n\nI tried to mean the recursion happens only within the base ring (not the module). My sentence was not clear. Sorry.\n\n> I still would like a doctest doing the comparison with functions that are at least 2 deep in the recursion instead of just once to make sure it works. For example\n> \n> ```\n> Z[x] -> Z[x][y] -> Z[x][y][z]\n> ```\n> where at each step we twist the generator `a -> -a`. I can write the doctest explicitly tomorrow.\n\n\nComparison of ring homomorphisms will be dealt with the code in #31783. It would be better that your doctest for the present ticket is about module homomorphisms.",
    "created_at": "2021-05-11T08:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556624",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:68'></a>
Replying to [tscrim](#comment%3A67):
> I think the recursion should limit to the base ring of the base ring for module morphisms. For ring morphisms, the implementation seems inherently flawed as Markus showed.
> 
> I think it needs to go down as deep as possible. This is what the code currently does.


I tried to mean the recursion happens only within the base ring (not the module). My sentence was not clear. Sorry.

> I still would like a doctest doing the comparison with functions that are at least 2 deep in the recursion instead of just once to make sure it works. For example
> 
> ```
> Z[x] -> Z[x][y] -> Z[x][y][z]
> ```
> where at each step we twist the generator `a -> -a`. I can write the doctest explicitly tomorrow.


Comparison of ring homomorphisms will be dealt with the code in #31783. It would be better that your doctest for the present ticket is about module homomorphisms.



---

archive/issue_comments_556625.json:
```json
{
    "body": "<a id='comment:69'></a>\nAs suggested by Kwankyu, I think that we should close this ticket now (in order to fix the issue as soon as possible) and continue the discussion (which could take some time) in #31783.\n\nThat's why I'm giving again a positive review to this ticket. Feel free to revert this decision if you strongly disagree.",
    "created_at": "2021-05-11T13:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556625",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:69'></a>
As suggested by Kwankyu, I think that we should close this ticket now (in order to fix the issue as soon as possible) and continue the discussion (which could take some time) in #31783.

That's why I'm giving again a positive review to this ticket. Feel free to revert this decision if you strongly disagree.



---

archive/issue_comments_556626.json:
```json
{
    "body": "**Changing author** from \"Kwankyu Lee\" to \"Kwankyu Lee, Travis Scrimshaw\".",
    "created_at": "2021-05-11T13:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556626",
    "user": "https://github.com/xcaruso"
}
```

**Changing author** from "Kwankyu Lee" to "Kwankyu Lee, Travis Scrimshaw".



---

archive/issue_comments_556627.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-05-11T13:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556627",
    "user": "https://github.com/xcaruso"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_556628.json:
```json
{
    "body": "**Changing reviewer** from \"Xavier Caruso\" to \"Xavier Caruso, , Travis Scrimshaw\".",
    "created_at": "2021-05-11T13:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556628",
    "user": "https://github.com/xcaruso"
}
```

**Changing reviewer** from "Xavier Caruso" to "Xavier Caruso, , Travis Scrimshaw".



---

archive/issue_comments_556629.json:
```json
{
    "body": "**Changing author** from \"Kwankyu Lee, Travis Scrimshaw\" to \"Kwankyu Lee\".",
    "created_at": "2021-05-11T13:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556629",
    "user": "https://github.com/xcaruso"
}
```

**Changing author** from "Kwankyu Lee, Travis Scrimshaw" to "Kwankyu Lee".



---

archive/issue_comments_556630.json:
```json
{
    "body": "<a id='comment:71'></a>\n(Hope it's correct this time. Sorry for the inconvenience.)",
    "created_at": "2021-05-11T13:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556630",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:71'></a>
(Hope it's correct this time. Sorry for the inconvenience.)



---

archive/issue_comments_556631.json:
```json
{
    "body": "**Changing reviewer** from \"Xavier Caruso, , Travis Scrimshaw\" to \"Xavier Caruso, Travis Scrimshaw\".",
    "created_at": "2021-05-11T13:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556631",
    "user": "https://github.com/xcaruso"
}
```

**Changing reviewer** from "Xavier Caruso, , Travis Scrimshaw" to "Xavier Caruso, Travis Scrimshaw".



---

archive/issue_comments_556632.json:
```json
{
    "body": "<a id='comment:72'></a>\nI don't know of a good test for this, so okay, let it be.",
    "created_at": "2021-05-12T06:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556632",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:72'></a>
I don't know of a good test for this, so okay, let it be.



---

archive/issue_events_081380.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-27T20:29:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28617#event-81380"
}
```



---

archive/issue_comments_556633.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2021-05-27T20:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556633",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_556634.json:
```json
{
    "body": "**Changing branch** from \"[u/klee/28617](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28617)\" to \"[37c186e3eac777e52eaa429b136439ade5b8e589](https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589)\".",
    "created_at": "2021-05-27T20:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28617",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28617#issuecomment-556634",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/klee/28617](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/28617)" to "[37c186e3eac777e52eaa429b136439ade5b8e589](https://github.com/sagemath/sagetrac-mirror/commit/37c186e3eac777e52eaa429b136439ade5b8e589)".
