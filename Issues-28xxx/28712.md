# Issue 28712: clarify acceptable input to prime_range

archive/issues_028475.json:
```json
{
    "body": "The function `prime_range` has two algorithms, and they do not accept the same types of input. The  \"pari_isprime\" algorithm accepts any input that can be coerced to an integer, because the `primes` function executes `start = ZZ(start)` and `stop = ZZ(stop)`. In contrast, the \"pari_primes\" algorithm simply executes the cython code `c_start = start` and `c_stop = stop` (where `c_start` and `c_stop`  are `cdef long`), without any coercion. But \"pari_primes\" does accept non-integer real numbers as input, which the \"pari_isprime\" algorithm does not. (Actually, this description of \"pari_primes\" is not completely accurate after ticket:28467, but the behavior is still similar to this.)\n\nThis ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file functions/prime_pi.pyx would cause a doctest error if the \"pari_primes\" algorithm were changed to reject non-integer real input.)\n\nThe proposed patch may also provide error messages that are more helpful when code runs into trouble by passing bad input to `prime_range`, because an exception will be thrown up front, during the attempt to coerce or round.\n\nThe issue in this ticket was split off from ticket:28467.\n\nBranch/Commit: e8633a2fa556ad5b7cc855bc2ff62ce6a3cdff48\n\nReviewer: Kiran Kedlaya\n\nAuthor: Dave Morris\n\nDependencies: #28467\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/28712\n\n",
    "closed_at": "2020-12-13T20:31:10Z",
    "created_at": "2019-11-09T07:19:46Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "clarify acceptable input to prime_range",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28712",
    "user": "https://github.com/DaveWitteMorris"
}
```
The function `prime_range` has two algorithms, and they do not accept the same types of input. The  "pari_isprime" algorithm accepts any input that can be coerced to an integer, because the `primes` function executes `start = ZZ(start)` and `stop = ZZ(stop)`. In contrast, the "pari_primes" algorithm simply executes the cython code `c_start = start` and `c_stop = stop` (where `c_start` and `c_stop`  are `cdef long`), without any coercion. But "pari_primes" does accept non-integer real numbers as input, which the "pari_isprime" algorithm does not. (Actually, this description of "pari_primes" is not completely accurate after ticket:28467, but the behavior is still similar to this.)

This ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file functions/prime_pi.pyx would cause a doctest error if the "pari_primes" algorithm were changed to reject non-integer real input.)

The proposed patch may also provide error messages that are more helpful when code runs into trouble by passing bad input to `prime_range`, because an exception will be thrown up front, during the attempt to coerce or round.

The issue in this ticket was split off from ticket:28467.

Branch/Commit: e8633a2fa556ad5b7cc855bc2ff62ce6a3cdff48

Reviewer: Kiran Kedlaya

Author: Dave Morris

Dependencies: #28467

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/28712





---

archive/issue_comments_428076.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n The function `prime_range` has two algorithms, and they do not accept the same types of input. The  \"pari_isprime\" algorithm accepts any input that can be coerced to an integer, because the `primes` function executes `start = ZZ(start)` and `stop = ZZ(stop)`. In contrast, the \"pari_primes\" algorithm simply executes the cython code `c_start = start` and `c_stop = stop` (where `c_start` and `c_stop`  are `cdef long`), without any coercion. But \"pari_primes\" does accept non-integer real numbers as input, which the \"pari_isprime\" algorithm does not. (Actually, this description of \"pari_primes\" is not completely accurate after ticket:28467, but the behavior is still similar to this.)\n \n-This ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file ??? would cause a doctest error if the \"pari_primes\" algorithm were changed to reject non-integer real input.)\n+This ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file functions/prime_pi.pyx would cause a doctest error if the \"pari_primes\" algorithm were changed to reject non-integer real input.)\n \n The proposed patch may also provide error messages that are more helpful when code runs into trouble by passing bad input to `prime_range`, because an exception will be thrown up front, during the attempt to coerce or round.\n \n``````\n",
    "created_at": "2019-11-09T07:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428076",
    "user": "https://github.com/DaveWitteMorris"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 The function `prime_range` has two algorithms, and they do not accept the same types of input. The  "pari_isprime" algorithm accepts any input that can be coerced to an integer, because the `primes` function executes `start = ZZ(start)` and `stop = ZZ(stop)`. In contrast, the "pari_primes" algorithm simply executes the cython code `c_start = start` and `c_stop = stop` (where `c_start` and `c_stop`  are `cdef long`), without any coercion. But "pari_primes" does accept non-integer real numbers as input, which the "pari_isprime" algorithm does not. (Actually, this description of "pari_primes" is not completely accurate after ticket:28467, but the behavior is still similar to this.)
 
-This ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file ??? would cause a doctest error if the "pari_primes" algorithm were changed to reject non-integer real input.)
+This ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file functions/prime_pi.pyx would cause a doctest error if the "pari_primes" algorithm were changed to reject non-integer real input.)
 
 The proposed patch may also provide error messages that are more helpful when code runs into trouble by passing bad input to `prime_range`, because an exception will be thrown up front, during the attempt to coerce or round.
 
``````




---

archive/issue_comments_428077.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-11-09T07:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428077",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_428078.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-11-09T07:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428078",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_428079.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-29T04:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428079",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_428080.json:
```json
{
    "body": "<a id='comment:4'></a>Doctest failures with Python 3.",
    "created_at": "2019-12-29T04:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428080",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:4'></a>Doctest failures with Python 3.



---

archive/issue_comments_428081.json:
```json
{
    "body": "<a id='comment:5'></a>Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428081",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>Ticket retargeted after milestone closed



---

archive/issue_events_072380.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28712#event-72380"
}
```



---

archive/issue_comments_428082.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-19T07:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_428083.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-19T07:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428083",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_428084.json:
```json
{
    "body": "<a id='comment:7'></a>I merged the latest version of ticket #28467, and then fixed the bug that was causing doctest failures with Python 3.",
    "created_at": "2020-01-19T07:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428084",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:7'></a>I merged the latest version of ticket #28467, and then fixed the bug that was causing doctest failures with Python 3.



---

archive/issue_comments_428085.json:
```json
{
    "body": "<a id='comment:9'></a>Rebased on #28467 and 9.1b9.\n\n---\nLast 10 new commits:",
    "created_at": "2020-04-07T02:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428085",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:9'></a>Rebased on #28467 and 9.1b9.

---
Last 10 new commits:



---

archive/issue_comments_428086.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2020-04-12T22:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428086",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_428087.json:
```json
{
    "body": "<a id='comment:11'></a>This ticket had a conflict with the latest changes to #28467, so I merged them. I also moved a few doctests (and deleted duplicates).",
    "created_at": "2020-04-12T22:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428087",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:11'></a>This ticket had a conflict with the latest changes to #28467, so I merged them. I also moved a few doctests (and deleted duplicates).



---

archive/issue_comments_428088.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-15T08:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428088",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_072381.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-07T02:29:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28712#event-72381"
}
```



---

archive/issue_events_072382.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-07T02:29:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28712#event-72382"
}
```



---

archive/issue_comments_428089.json:
```json
{
    "body": "<a id='comment:14'></a>Patchbot is morally green, and this otherwise looks fine to me.",
    "created_at": "2020-09-20T03:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428089",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:14'></a>Patchbot is morally green, and this otherwise looks fine to me.



---

archive/issue_comments_428090.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-20T03:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428090",
    "user": "https://github.com/kedlaya"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_428091.json:
```json
{
    "body": "<a id='comment:15'></a>Thanks for the review!",
    "created_at": "2020-09-20T04:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428091",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:15'></a>Thanks for the review!



---

archive/issue_events_072383.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28712#event-72383"
}
```



---

archive/issue_events_072384.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28712#event-72384"
}
```



---

archive/issue_comments_428092.json:
```json
{
    "body": "<a id='comment:19'></a>Resolved minor merge conflict (\"algorithm == None\" ==> \"algorithm is None\").\n\nI cannot run full doctests, because my sage installation has some problems, but I don't expect any complaints from the patchbots.\n\n---\nNew commits:",
    "created_at": "2020-11-26T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428092",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:19'></a>Resolved minor merge conflict ("algorithm == None" ==> "algorithm is None").

I cannot run full doctests, because my sage installation has some problems, but I don't expect any complaints from the patchbots.

---
New commits:



---

archive/issue_comments_428093.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-11-26T22:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428093",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_428094.json:
```json
{
    "body": "<a id='comment:21'></a>Patchbot looks good!",
    "created_at": "2020-11-27T01:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428094",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:21'></a>Patchbot looks good!



---

archive/issue_comments_428095.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-27T01:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428095",
    "user": "https://github.com/kedlaya"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_428096.json:
```json
{
    "body": "<a id='comment:22'></a>Thanks for reviewing it again!",
    "created_at": "2020-11-27T01:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428096",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:22'></a>Thanks for reviewing it again!



---

archive/issue_comments_428097.json:
```json
{
    "body": "<a id='comment:23'></a>the format for dependencies is comma-separate ticket numbers",
    "created_at": "2020-12-06T22:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428097",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>the format for dependencies is comma-separate ticket numbers



---

archive/issue_comments_428098.json:
```json
{
    "body": "<a id='comment:24'></a>Sorry for the mis-formatted dependency. Thanks for fixing it.\n\nThe doctest failures (on the steenrod patchbot) are not from this ticket.  They are ticket:30764 and ticket:29528.",
    "created_at": "2020-12-07T00:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428098",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:24'></a>Sorry for the mis-formatted dependency. Thanks for fixing it.

The doctest failures (on the steenrod patchbot) are not from this ticket.  They are ticket:30764 and ticket:29528.



---

archive/issue_comments_428099.json:
```json
{
    "body": "<a id='comment:25'></a>Actually we need comma separated ticket numbers with `#`\nin the \"dependencies\" field.",
    "created_at": "2020-12-07T03:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428099",
    "user": "https://github.com/slel"
}
```

<a id='comment:25'></a>Actually we need comma separated ticket numbers with `#`
in the "dependencies" field.



---

archive/issue_comments_428100.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-13T20:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28712#issuecomment-428100",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_072385.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-13T20:31:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28712",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28712#event-72385"
}
```
