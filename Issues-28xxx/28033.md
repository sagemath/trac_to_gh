# Issue 28033: MR20: Add zlib as a gap dependency

archive/issues_027796.json:
```json
{
    "assignees": [],
    "body": "Isuru Fernando ([@isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20.\n\nThis ticket lists zlib as a dependency of gap,\nsince libgap.so links to zlib.\n\nCC:  @slel\n\nKeywords: **days101, gap, zlib**\n\nBranch/Commit: **[e0f8543](https://github.com/sagemath/sagetrac-mirror/commit/e0f8543ce8f29878055022e7cd27f96e951ee821)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Isuru Fernando**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28033_\n\n",
    "closed_at": "2019-06-28T04:29:32Z",
    "created_at": "2019-06-20T21:46:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "MR20: Add zlib as a gap dependency",
    "type": "issue",
    "updated_at": "2019-06-28T04:29:32Z",
    "url": "https://github.com/sagemath/sage/issues/28033",
    "user": "https://github.com/sagetrac-galois"
}
```
Isuru Fernando ([@isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20.

This ticket lists zlib as a dependency of gap,
since libgap.so links to zlib.

CC:  @slel

Keywords: **days101, gap, zlib**

Branch/Commit: **[e0f8543](https://github.com/sagemath/sagetrac-mirror/commit/e0f8543ce8f29878055022e7cd27f96e951ee821)**

Reviewer: **Dima Pasechnik**

Author: **Isuru Fernando**

_Issue created by migration from https://trac.sagemath.org/ticket/28033_





---

archive/issue_events_366204.json:
```json
{
    "actor": "https://github.com/sagetrac-galois",
    "created_at": "2019-06-20T21:46:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366204"
}
```



---

archive/issue_events_366205.json:
```json
{
    "actor": "https://github.com/sagetrac-galois",
    "created_at": "2019-06-20T21:46:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366205"
}
```



---

archive/issue_events_366206.json:
```json
{
    "actor": "https://github.com/sagetrac-galois",
    "created_at": "2019-06-20T21:46:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366206"
}
```



---

archive/issue_events_366207.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2019-06-20T21:47:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366207"
}
```



---

archive/issue_events_366208.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2019-06-20T21:47:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366208"
}
```



---

archive/issue_comments_439067.json:
```json
{
    "body": "Description changed:\n``````diff\n\n``````\n",
    "created_at": "2019-06-20T21:47:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439067",
    "user": "https://github.com/isuruf"
}
```

Description changed:
``````diff

``````




---

archive/issue_comments_439068.json:
```json
{
    "body": "Changed keywords from **** to **days101, gap, zlib**",
    "created_at": "2019-06-20T21:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439068",
    "user": "https://github.com/slel"
}
```

Changed keywords from **** to **days101, gap, zlib**



---

archive/issue_comments_439069.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,4 @@\n-Isuru Fernando ([@isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20:\n+Isuru Fernando ([@isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20.\n \n----\n-\n-\n-\n-\n-\n-\n-\n+This ticket lists zlib as a dependency of gap,\n+since libgap.so links to zlib.\n``````\n",
    "created_at": "2019-06-20T21:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439069",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,4 @@
-Isuru Fernando ([@isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20:
+Isuru Fernando ([@isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20.
 
----
-
-
-
-
-
-
-
+This ticket lists zlib as a dependency of gap,
+since libgap.so links to zlib.
``````




---

archive/issue_events_366209.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-20T21:55:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366209"
}
```



---

archive/issue_events_366210.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-20T21:55:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366210"
}
```



---

archive/issue_comments_439070.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nChecked that libgap indeed links to zlib.\n\nOn macOS:\n\n```\n$ sw_vers\nProductName:    Mac OS X\nProductVersion: 10.10.5\nBuildVersion:   14F2511\n\n$ ./sage --version\nSageMath version 8.8.rc2, Release Date: 2019-06-19\n\n$ otool -L local/lib/libgap.dylib\nlocal/lib/libgap.dylib:\n    /opt/s/sage/local/lib/libgap.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n    /opt/s/sage/local/lib/libgmp.23.dylib (compatibility version 24.0.0, current version 24.3.0)\n    /opt/s/sage/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)\n    /opt/s/sage/local/lib/libreadline.6.dylib (compatibility version 6.0.0, current version 6.3.0)\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1213.0.0)\n```\n\nOn Debian:\n\n```\n$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Debian\nDescription:    Debian GNU/Linux 9.9 (stretch)\nRelease:    9.9\nCodename:   stretch\n\n$ ./sage --version\nSageMath version 8.8.rc2, Release Date: 2019-06-19\n\n$ readelf -d local/lib/libgap.so\n\nDynamic section at offset 0x1dd360 contains 32 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.23]\n 0x0000000000000001 (NEEDED)             Shared library: [libz.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libreadline.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]\n 0x0000000000000001 (NEEDED)             Shared library: [libutil.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000e (SONAME)             Library soname: [libgap.so.0]\n 0x000000000000001d (RUNPATH)            Library runpath: [/home/lelievre/s/sage/local/lib]\n 0x000000000000000c (INIT)               0x536a0\n 0x000000000000000d (FINI)               0x18253c\n 0x0000000000000019 (INIT_ARRAY)         0x3db008\n 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes)\n 0x000000000000001a (FINI_ARRAY)         0x3db010\n 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)\n 0x000000006ffffef5 (GNU_HASH)           0x1f0\n 0x0000000000000005 (STRTAB)             0x1b450\n 0x0000000000000006 (SYMTAB)             0x66c0\n 0x000000000000000a (STRSZ)              53655 (bytes)\n 0x000000000000000b (SYMENT)             24 (bytes)\n 0x0000000000000003 (PLTGOT)             0x3e0000\n 0x0000000000000002 (PLTRELSZ)           28608 (bytes)\n 0x0000000000000014 (PLTREL)             RELA\n 0x0000000000000017 (JMPREL)             0x4c6e0\n 0x0000000000000007 (RELA)               0x2a258\n 0x0000000000000008 (RELASZ)             140424 (bytes)\n 0x0000000000000009 (RELAENT)            24 (bytes)\n 0x000000006ffffffe (VERNEED)            0x2a1b8\n 0x000000006fffffff (VERNEEDNUM)         4\n 0x000000006ffffff0 (VERSYM)             0x285e8\n 0x000000006ffffff9 (RELACOUNT)          3443\n 0x0000000000000000 (NULL)               0x0\n```",
    "created_at": "2019-06-20T21:55:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439070",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'>Comment 3:</a>
Checked that libgap indeed links to zlib.

On macOS:

```
$ sw_vers
ProductName:    Mac OS X
ProductVersion: 10.10.5
BuildVersion:   14F2511

$ ./sage --version
SageMath version 8.8.rc2, Release Date: 2019-06-19

$ otool -L local/lib/libgap.dylib
local/lib/libgap.dylib:
    /opt/s/sage/local/lib/libgap.0.dylib (compatibility version 1.0.0, current version 1.0.0)
    /opt/s/sage/local/lib/libgmp.23.dylib (compatibility version 24.0.0, current version 24.3.0)
    /opt/s/sage/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)
    /opt/s/sage/local/lib/libreadline.6.dylib (compatibility version 6.0.0, current version 6.3.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1213.0.0)
```

On Debian:

```
$ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 9.9 (stretch)
Release:    9.9
Codename:   stretch

$ ./sage --version
SageMath version 8.8.rc2, Release Date: 2019-06-19

$ readelf -d local/lib/libgap.so

Dynamic section at offset 0x1dd360 contains 32 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.23]
 0x0000000000000001 (NEEDED)             Shared library: [libz.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libreadline.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libutil.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000e (SONAME)             Library soname: [libgap.so.0]
 0x000000000000001d (RUNPATH)            Library runpath: [/home/lelievre/s/sage/local/lib]
 0x000000000000000c (INIT)               0x536a0
 0x000000000000000d (FINI)               0x18253c
 0x0000000000000019 (INIT_ARRAY)         0x3db008
 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes)
 0x000000000000001a (FINI_ARRAY)         0x3db010
 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)
 0x000000006ffffef5 (GNU_HASH)           0x1f0
 0x0000000000000005 (STRTAB)             0x1b450
 0x0000000000000006 (SYMTAB)             0x66c0
 0x000000000000000a (STRSZ)              53655 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000003 (PLTGOT)             0x3e0000
 0x0000000000000002 (PLTRELSZ)           28608 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4c6e0
 0x0000000000000007 (RELA)               0x2a258
 0x0000000000000008 (RELASZ)             140424 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x2a1b8
 0x000000006fffffff (VERNEEDNUM)         4
 0x000000006ffffff0 (VERSYM)             0x285e8
 0x000000006ffffff9 (RELACOUNT)          3443
 0x0000000000000000 (NULL)               0x0
```



---

archive/issue_comments_439071.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nOK, indeed, zlib usage is a recent change in GAP, a year ago it was merged in their master.\nhttps://github.com/gap-system/gap/pull/2509\n\nas everybody nowdays builds with zlib available from the system (and Sage builds zlib early on otherwise), we didn't notice the need.",
    "created_at": "2019-06-21T00:00:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439071",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'>Comment 4:</a>
OK, indeed, zlib usage is a recent change in GAP, a year ago it was merged in their master.
https://github.com/gap-system/gap/pull/2509

as everybody nowdays builds with zlib available from the system (and Sage builds zlib early on otherwise), we didn't notice the need.



---

archive/issue_comments_439072.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nreviewer name is missing",
    "created_at": "2019-06-21T11:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439072",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'>Comment 5:</a>
reviewer name is missing



---

archive/issue_comments_439073.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2019-06-21T11:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439073",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_439074.json:
```json
{
    "body": "Changed branch from **[u/galois/mrs/20/patch-1](https://github.com/sagemath/sagetrac-mirror/tree/u/galois/mrs/20/patch-1)** to **[e0f8543](https://github.com/sagemath/sagetrac-mirror/commit/e0f8543ce8f29878055022e7cd27f96e951ee821)**",
    "created_at": "2019-06-28T04:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28033#issuecomment-439074",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/galois/mrs/20/patch-1](https://github.com/sagemath/sagetrac-mirror/tree/u/galois/mrs/20/patch-1)** to **[e0f8543](https://github.com/sagemath/sagetrac-mirror/commit/e0f8543ce8f29878055022e7cd27f96e951ee821)**



---

archive/issue_events_366211.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-28T04:29:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366211"
}
```



---

archive/issue_events_366212.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b6abe47a950d86e7515f59a32403c7110cd01d54",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-06-28T04:29:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28033",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28033#event-366212"
}
```
