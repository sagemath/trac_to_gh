# Issue 28882: Provide diagonal_matrix as a method of matrix spaces

archive/issues_028645.json:
```json
{
    "body": "Sage provides two functions `identity_matrix`\nand `diagonal_matrix` in the global namespace.\n\nBy contrast, matrix spaces have an `identity_matrix`\nmethod but no `diagonal_matrix` method.\n\nGlobal namespace functions:\n\n```\nsage: identity_matrix(ZZ, 2)\n[1 0]\n[0 1]\nsage: diagonal_matrix(ZZ, [3, 2])\n[3 0]\n[0 2]\n```\n\nMatrix space methods:\n\n```\nsage: M = MatrixSpace(ZZ, 2)\nsage: M.identity_matrix()\n[1 0]\n[0 1]\n```\n\nBefore this ticket:\n\n```\nsage: M = MatrixSpace(ZZ, 2)\nsage: M.diagonal_matrix([3, 2])\nTraceback (most recent call last)\n...\nAttributeError: 'MatrixSpace_with_category' object has no attribute 'diagonal_matrix'\n```\n\nAfter this ticket:\n\n```\nsage: M = MatrixSpace(ZZ, 2)\nsage: M.diagonal_matrix([3, 2])\n[3 0]\n[0 2]\n```\n\n\n**Keywords:** diagonal matrix\n\n**Branch/Commit:** [f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41](https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41)\n\n**Reviewer:** John Palmieri\n\n**Author:** Sagnik Dey\n\nIssue created by migration from https://trac.sagemath.org/ticket/28882\n\n",
    "closed_at": "2020-03-03T23:21:31Z",
    "created_at": "2019-12-14T00:18:43Z",
    "labels": [
        "component: linear algebra",
        "enhancement",
        "good first issue"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Provide diagonal_matrix as a method of matrix spaces",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28882",
    "user": "https://github.com/slel"
}
```
Sage provides two functions `identity_matrix`
and `diagonal_matrix` in the global namespace.

By contrast, matrix spaces have an `identity_matrix`
method but no `diagonal_matrix` method.

Global namespace functions:

```
sage: identity_matrix(ZZ, 2)
[1 0]
[0 1]
sage: diagonal_matrix(ZZ, [3, 2])
[3 0]
[0 2]
```

Matrix space methods:

```
sage: M = MatrixSpace(ZZ, 2)
sage: M.identity_matrix()
[1 0]
[0 1]
```

Before this ticket:

```
sage: M = MatrixSpace(ZZ, 2)
sage: M.diagonal_matrix([3, 2])
Traceback (most recent call last)
...
AttributeError: 'MatrixSpace_with_category' object has no attribute 'diagonal_matrix'
```

After this ticket:

```
sage: M = MatrixSpace(ZZ, 2)
sage: M.diagonal_matrix([3, 2])
[3 0]
[0 2]
```


**Keywords:** diagonal matrix

**Branch/Commit:** [f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41](https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41)

**Reviewer:** John Palmieri

**Author:** Sagnik Dey

Issue created by migration from https://trac.sagemath.org/ticket/28882





---

archive/issue_events_256331.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256331"
}
```



---

archive/issue_events_256332.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256332"
}
```



---

archive/issue_comments_453455.json:
```json
{
    "body": "<a id='comment:1'></a>\nTicket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453455",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>
Ticket retargeted after milestone closed



---

archive/issue_comments_453456.json:
```json
{
    "body": "**Branch:** [u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces)",
    "created_at": "2020-02-11T13:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453456",
    "user": "https://github.com/Tinkidinki"
}
```

**Branch:** [u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces)



---

archive/issue_comments_453457.json:
```json
{
    "body": "<a id='comment:3'></a>\nI added a `diagonal_matrix` method in `matrix_space.py` pointing it to the original `diagonal_matrix` method in `special.py`.\n\nSo, I tried to think of reasons why we would be using `matrix_space` methods instead of the regular `matrix()` methods (crosspost: https://math.stackexchange.com/q/3537612/287775) but couldn't find any.\n\nAre there practical reasons, so that I can write better code for this file now/ in the future?\n\nAlso would like a review on this patch. \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9d128b92016af38445d2faea55ff0df8e1c50c3\">b9d128b</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2913be19228a4944cb4116a9f3ca5f7b3dfcd7f1\">2913be1</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/744d8f2eae5ace821bf674998d74023045bc34f6\">744d8f2</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr></table>\n",
    "created_at": "2020-02-11T13:19:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453457",
    "user": "https://github.com/Tinkidinki"
}
```

<a id='comment:3'></a>
I added a `diagonal_matrix` method in `matrix_space.py` pointing it to the original `diagonal_matrix` method in `special.py`.

So, I tried to think of reasons why we would be using `matrix_space` methods instead of the regular `matrix()` methods (crosspost: https://math.stackexchange.com/q/3537612/287775) but couldn't find any.

Are there practical reasons, so that I can write better code for this file now/ in the future?

Also would like a review on this patch. 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9d128b92016af38445d2faea55ff0df8e1c50c3">b9d128b</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2913be19228a4944cb4116a9f3ca5f7b3dfcd7f1">2913be1</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/744d8f2eae5ace821bf674998d74023045bc34f6">744d8f2</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr></table>




---

archive/issue_comments_453458.json:
```json
{
    "body": "**Commit:** [744d8f2eae5ace821bf674998d74023045bc34f6](https://github.com/sagemath/sagetrac-mirror/commit/744d8f2eae5ace821bf674998d74023045bc34f6)",
    "created_at": "2020-02-11T13:19:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453458",
    "user": "https://github.com/Tinkidinki"
}
```

**Commit:** [744d8f2eae5ace821bf674998d74023045bc34f6](https://github.com/sagemath/sagetrac-mirror/commit/744d8f2eae5ace821bf674998d74023045bc34f6)



---

archive/issue_events_256333.json:
```json
{
    "actor": "https://github.com/Tinkidinki",
    "created_at": "2020-02-11T13:20:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256333"
}
```



---

archive/issue_comments_453459.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt would be better to model this on the `identity_matrix` method. In particular: it should raise an error if the matrix space is for non-square matrices, and there should be doctests. And it should raise an error if `entries` doesn't have the right length.",
    "created_at": "2020-02-11T22:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453459",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
It would be better to model this on the `identity_matrix` method. In particular: it should raise an error if the matrix space is for non-square matrices, and there should be doctests. And it should raise an error if `entries` doesn't have the right length.



---

archive/issue_comments_453460.json:
```json
{
    "body": "<a id='comment:6'></a>\nYes, this needs to be fixed for non-square matrices and requires doc-tests. However, ensuring the length of `entries` is correct is taken care of by the diagonal_matrix() method in special.py.",
    "created_at": "2020-02-14T05:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453460",
    "user": "https://github.com/Tinkidinki"
}
```

<a id='comment:6'></a>
Yes, this needs to be fixed for non-square matrices and requires doc-tests. However, ensuring the length of `entries` is correct is taken care of by the diagonal_matrix() method in special.py.



---

archive/issue_events_256334.json:
```json
{
    "actor": "https://github.com/Tinkidinki",
    "created_at": "2020-02-14T05:55:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "good first issue",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256334"
}
```



---

archive/issue_events_256335.json:
```json
{
    "actor": "https://github.com/Tinkidinki",
    "created_at": "2020-02-14T05:55:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256335"
}
```



---

archive/issue_events_256336.json:
```json
{
    "actor": "https://github.com/Tinkidinki",
    "created_at": "2020-02-14T05:55:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256336"
}
```



---

archive/issue_comments_453461.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\" to \"[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\".",
    "created_at": "2020-02-26T09:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453461",
    "user": "https://github.com/SagnikDey92"
}
```

**Changing branch** from "[u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Tinkidinki/provide_diagonal_matrix_as_a_method_of_matrix_spaces)" to "[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)".



---

archive/issue_comments_453462.json:
```json
{
    "body": "<a id='comment:10'></a>\nPlease review. Currently, this doesn't work:\n\nsage: M1 = MatrixSpace(ZZ, 2, implementation='flint')\n\nsage: M2 = MatrixSpace(ZZ, 2, implementation='generic')\n\nsage: type(M1.diagonal_matrix([1, 2]))\n\n      <type 'sage.matrix.matrix_integer_dense.Matrix_integer_dense'>\n\nsage: type(M2.diagonal_matrix([1, 2]))\n\n      <type 'sage.matrix.matrix_generic_dense.Matrix_generic_dense'>\n\nBoth the types are currently: \n\n<class 'sage.matrix.matrix_integer_sparse.Matrix_integer_sparse'>\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bccdee385da0a05a708890989c504d180fbbe562\">bccdee3</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr></table>\n",
    "created_at": "2020-02-26T09:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453462",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:10'></a>
Please review. Currently, this doesn't work:

sage: M1 = MatrixSpace(ZZ, 2, implementation='flint')

sage: M2 = MatrixSpace(ZZ, 2, implementation='generic')

sage: type(M1.diagonal_matrix([1, 2]))

      <type 'sage.matrix.matrix_integer_dense.Matrix_integer_dense'>

sage: type(M2.diagonal_matrix([1, 2]))

      <type 'sage.matrix.matrix_generic_dense.Matrix_generic_dense'>

Both the types are currently: 

<class 'sage.matrix.matrix_integer_sparse.Matrix_integer_sparse'>

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bccdee385da0a05a708890989c504d180fbbe562">bccdee3</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr></table>




---

archive/issue_events_256337.json:
```json
{
    "actor": "https://github.com/SagnikDey92",
    "created_at": "2020-02-26T09:45:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256337"
}
```



---

archive/issue_events_256338.json:
```json
{
    "actor": "https://github.com/SagnikDey92",
    "created_at": "2020-02-26T09:45:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256338"
}
```



---

archive/issue_comments_453463.json:
```json
{
    "body": "**Changing commit** from \"[744d8f2eae5ace821bf674998d74023045bc34f6](https://github.com/sagemath/sagetrac-mirror/commit/744d8f2eae5ace821bf674998d74023045bc34f6)\" to \"[bccdee385da0a05a708890989c504d180fbbe562](https://github.com/sagemath/sagetrac-mirror/commit/bccdee385da0a05a708890989c504d180fbbe562)\".",
    "created_at": "2020-02-26T09:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453463",
    "user": "https://github.com/SagnikDey92"
}
```

**Changing commit** from "[744d8f2eae5ace821bf674998d74023045bc34f6](https://github.com/sagemath/sagetrac-mirror/commit/744d8f2eae5ace821bf674998d74023045bc34f6)" to "[bccdee385da0a05a708890989c504d180fbbe562](https://github.com/sagemath/sagetrac-mirror/commit/bccdee385da0a05a708890989c504d180fbbe562)".



---

archive/issue_comments_453464.json:
```json
{
    "body": "<a id='comment:11'></a>\nMatrix spaces can be created using the keyword `sparse`, with `False` the default, and you can recover this value using `M.is_sparse()`. So you should call `diagonal_matrix` with the argument `sparse=self.is_sparse()`:\n\n```diff\ndiff --git a/src/sage/matrix/matrix_space.py b/src/sage/matrix/matrix_space.py\nindex b4cb724e3b..3712806364 100644\n--- a/src/sage/matrix/matrix_space.py\n+++ b/src/sage/matrix/matrix_space.py\n@@ -1600,7 +1600,7 @@ class MatrixSpace(UniqueRepresentation, Parent):\n         \"\"\"\n         if self.__nrows != self.__ncols:\n             raise TypeError(\"diagonal matrix must be square\")\n-        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries)\n+        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries, sparse=self.is_sparse())\n         A.set_immutable()\n         return A\n\n```\n\nWhy make it immutable by default?",
    "created_at": "2020-02-26T21:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453464",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
Matrix spaces can be created using the keyword `sparse`, with `False` the default, and you can recover this value using `M.is_sparse()`. So you should call `diagonal_matrix` with the argument `sparse=self.is_sparse()`:

```diff
diff --git a/src/sage/matrix/matrix_space.py b/src/sage/matrix/matrix_space.py
index b4cb724e3b..3712806364 100644
--- a/src/sage/matrix/matrix_space.py
+++ b/src/sage/matrix/matrix_space.py
@@ -1600,7 +1600,7 @@ class MatrixSpace(UniqueRepresentation, Parent):
         """
         if self.__nrows != self.__ncols:
             raise TypeError("diagonal matrix must be square")
-        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries)
+        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries, sparse=self.is_sparse())
         A.set_immutable()
         return A

```

Why make it immutable by default?



---

archive/issue_comments_453465.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12eca57a2fc73f795a053d836559b12216074cbe\">12eca57</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr></table>\n",
    "created_at": "2020-02-27T09:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453465",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12eca57a2fc73f795a053d836559b12216074cbe">12eca57</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr></table>




---

archive/issue_comments_453466.json:
```json
{
    "body": "**Changing commit** from \"[bccdee385da0a05a708890989c504d180fbbe562](https://github.com/sagemath/sagetrac-mirror/commit/bccdee385da0a05a708890989c504d180fbbe562)\" to \"[12eca57a2fc73f795a053d836559b12216074cbe](https://github.com/sagemath/sagetrac-mirror/commit/12eca57a2fc73f795a053d836559b12216074cbe)\".",
    "created_at": "2020-02-27T09:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453466",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bccdee385da0a05a708890989c504d180fbbe562](https://github.com/sagemath/sagetrac-mirror/commit/bccdee385da0a05a708890989c504d180fbbe562)" to "[12eca57a2fc73f795a053d836559b12216074cbe](https://github.com/sagemath/sagetrac-mirror/commit/12eca57a2fc73f795a053d836559b12216074cbe)".



---

archive/issue_comments_453467.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jhpalmieri](#comment%3A11):\n> Matrix spaces can be created using the keyword `sparse`, with `False` the default, and you can recover this value using `M.is_sparse()`. So you should call `diagonal_matrix` with the argument `sparse=self.is_sparse()`:\n> \n> ```diff\n> diff --git a/src/sage/matrix/matrix_space.py b/src/sage/matrix/matrix_space.py\n> index b4cb724e3b..3712806364 100644\n> --- a/src/sage/matrix/matrix_space.py\n> +++ b/src/sage/matrix/matrix_space.py\n> @@ -1600,7 +1600,7 @@ class MatrixSpace(UniqueRepresentation, Parent):\n>          \"\"\"\n>          if self.__nrows != self.__ncols:\n>              raise TypeError(\"diagonal matrix must be square\")\n> -        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries)\n> +        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries, sparse=self.is_sparse())\n>          A.set_immutable()\n>          return A\n> \n> ```\n> \n> Why make it immutable by default?\n\n\nThe above discussion thread suggested to model diagonal_matrix on the identity_matrix function. Since that was immutable by default, I made it so in diagonal_matrix as well. I'll remove it if required. I've now made a change that keeps the implementation method the same in the diagonal matrix. Please review.",
    "created_at": "2020-02-27T09:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453467",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:13'></a>
Replying to [jhpalmieri](#comment%3A11):
> Matrix spaces can be created using the keyword `sparse`, with `False` the default, and you can recover this value using `M.is_sparse()`. So you should call `diagonal_matrix` with the argument `sparse=self.is_sparse()`:
> 
> ```diff
> diff --git a/src/sage/matrix/matrix_space.py b/src/sage/matrix/matrix_space.py
> index b4cb724e3b..3712806364 100644
> --- a/src/sage/matrix/matrix_space.py
> +++ b/src/sage/matrix/matrix_space.py
> @@ -1600,7 +1600,7 @@ class MatrixSpace(UniqueRepresentation, Parent):
>          """
>          if self.__nrows != self.__ncols:
>              raise TypeError("diagonal matrix must be square")
> -        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries)
> +        A = sage.matrix.special.diagonal_matrix(self.base_ring(), self.dims()[0], entries, sparse=self.is_sparse())
>          A.set_immutable()
>          return A
> 
> ```
> 
> Why make it immutable by default?


The above discussion thread suggested to model diagonal_matrix on the identity_matrix function. Since that was immutable by default, I made it so in diagonal_matrix as well. I'll remove it if required. I've now made a change that keeps the implementation method the same in the diagonal matrix. Please review.



---

archive/issue_comments_453468.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe `identity_matrix` is immutable because it is cached. If it were not immutable, this could happen:\n\n```\nsage: M = MatrixSpace(ZZ, 2)\nsage: a = M.identity_matrix()\nsage: a[0,0] = 2\nsage: M.identity_matrix()\n[2 0]\n[0 1]\n```\nThis is not an issue with `diagonal_matrix`, and I don't see a good reason for it to be immutable.",
    "created_at": "2020-02-27T17:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453468",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
The `identity_matrix` is immutable because it is cached. If it were not immutable, this could happen:

```
sage: M = MatrixSpace(ZZ, 2)
sage: a = M.identity_matrix()
sage: a[0,0] = 2
sage: M.identity_matrix()
[2 0]
[0 1]
```
This is not an issue with `diagonal_matrix`, and I don't see a good reason for it to be immutable.



---

archive/issue_comments_453469.json:
```json
{
    "body": "<a id='comment:15'></a>\nOk. Thank you for the clarification. I'm new to this library. I'll remove the immutability part and send the PR again.",
    "created_at": "2020-02-27T18:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453469",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:15'></a>
Ok. Thank you for the clarification. I'm new to this library. I'll remove the immutability part and send the PR again.



---

archive/issue_comments_453470.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3\">f48d915</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr></table>\n",
    "created_at": "2020-02-28T05:33:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3">f48d915</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr></table>




---

archive/issue_comments_453471.json:
```json
{
    "body": "**Changing commit** from \"[12eca57a2fc73f795a053d836559b12216074cbe](https://github.com/sagemath/sagetrac-mirror/commit/12eca57a2fc73f795a053d836559b12216074cbe)\" to \"[f48d91551e994a81dbe7e6edd639d35b994608d3](https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3)\".",
    "created_at": "2020-02-28T05:33:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453471",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[12eca57a2fc73f795a053d836559b12216074cbe](https://github.com/sagemath/sagetrac-mirror/commit/12eca57a2fc73f795a053d836559b12216074cbe)" to "[f48d91551e994a81dbe7e6edd639d35b994608d3](https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3)".



---

archive/issue_comments_453472.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [git](#comment%3A16):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3\">f48d915</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr></table>\n\n\nPlease review",
    "created_at": "2020-02-28T05:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453472",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:17'></a>
Replying to [git](#comment%3A16):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3">f48d915</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr></table>


Please review



---

archive/issue_comments_453473.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\" to \"[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\".",
    "created_at": "2020-02-28T20:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453473",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing branch** from "[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)" to "[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)".



---

archive/issue_comments_453474.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2020-02-28T21:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453474",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_comments_453475.json:
```json
{
    "body": "**Changing commit** from \"[f48d91551e994a81dbe7e6edd639d35b994608d3](https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3)\" to \"[a214fd2c452bb5e168afb78eb6babf78b1052417](https://github.com/sagemath/sagetrac-mirror/commit/a214fd2c452bb5e168afb78eb6babf78b1052417)\".",
    "created_at": "2020-02-28T21:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453475",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing commit** from "[f48d91551e994a81dbe7e6edd639d35b994608d3](https://github.com/sagemath/sagetrac-mirror/commit/f48d91551e994a81dbe7e6edd639d35b994608d3)" to "[a214fd2c452bb5e168afb78eb6babf78b1052417](https://github.com/sagemath/sagetrac-mirror/commit/a214fd2c452bb5e168afb78eb6babf78b1052417)".



---

archive/issue_comments_453476.json:
```json
{
    "body": "<a id='comment:19'></a>\nI made a few changes:\n\n- edited the docstring so that there is an \"INPUTS\" block and so that the lines are under 80 characters.\n- added a doctest showing what happens if you try to create a diagonal matrix with entries from the wrong ring\n- removed the alias `diag`: I think `diagonal_matrix` is completely clear, whereas `diag` is ambiguous. People can easily get `diagonal_matrix` using tab-completion, so I'm not concerned about the extra characters.\n\nIf you are happy with these changes, feel free to set to positive review. Make sure to add your real name to the \"Authors\" field.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86e5d337e26779f0a2ab939a15dbccc3f6254a9f\">86e5d33</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68ce495ce2f145655c02c4a78af59b6a2a49bf49\">68ce495</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/242a5d72e3ae0d85cf263342a9c6bbf9b75a5d4a\">242a5d7</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42a4810009cb8c6ac059b9ba9a2ae46441ee5bf4\">42a4810</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb656f34182aa49c437fba2bd2e7b222b5500926\">cb656f3</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29f38054ab835c278a91df6d0262998f144ceb5a\">29f3805</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a214fd2c452bb5e168afb78eb6babf78b1052417\">a214fd2</a></td><td><code>trac 28882: reviewer changes</code></td></tr></table>\n",
    "created_at": "2020-02-28T21:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453476",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
I made a few changes:

- edited the docstring so that there is an "INPUTS" block and so that the lines are under 80 characters.
- added a doctest showing what happens if you try to create a diagonal matrix with entries from the wrong ring
- removed the alias `diag`: I think `diagonal_matrix` is completely clear, whereas `diag` is ambiguous. People can easily get `diagonal_matrix` using tab-completion, so I'm not concerned about the extra characters.

If you are happy with these changes, feel free to set to positive review. Make sure to add your real name to the "Authors" field.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86e5d337e26779f0a2ab939a15dbccc3f6254a9f">86e5d33</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68ce495ce2f145655c02c4a78af59b6a2a49bf49">68ce495</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/242a5d72e3ae0d85cf263342a9c6bbf9b75a5d4a">242a5d7</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42a4810009cb8c6ac059b9ba9a2ae46441ee5bf4">42a4810</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb656f34182aa49c437fba2bd2e7b222b5500926">cb656f3</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29f38054ab835c278a91df6d0262998f144ceb5a">29f3805</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a214fd2c452bb5e168afb78eb6babf78b1052417">a214fd2</a></td><td><code>trac 28882: reviewer changes</code></td></tr></table>




---

archive/issue_comments_453477.json:
```json
{
    "body": "<a id='comment:20'></a>\nThank you for the corrections u/jhpalmieri. Setting status to 'positive review'.",
    "created_at": "2020-02-29T06:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453477",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:20'></a>
Thank you for the corrections u/jhpalmieri. Setting status to 'positive review'.



---

archive/issue_comments_453478.json:
```json
{
    "body": "**Author:** Sagnik Dey",
    "created_at": "2020-02-29T06:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453478",
    "user": "https://github.com/SagnikDey92"
}
```

**Author:** Sagnik Dey



---

archive/issue_events_256339.json:
```json
{
    "actor": "https://github.com/SagnikDey92",
    "created_at": "2020-02-29T06:34:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256339"
}
```



---

archive/issue_events_256340.json:
```json
{
    "actor": "https://github.com/SagnikDey92",
    "created_at": "2020-02-29T06:34:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256340"
}
```



---

archive/issue_comments_453479.json:
```json
{
    "body": "<a id='comment:21'></a>\n\n```\nsage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/coercion_and_categories.rst\", line 450, in doc.en.thematic_tutorials.coercion_and_categories\nFailed example:\n    len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\nExpected:\n    81\nGot:\n    82\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/coercion_and_categories.rst\", line 452, in doc.en.thematic_tutorials.coercion_and_categories\nFailed example:\n    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\nExpected:\n    121\nGot:\n    122\n**********************************************************************\n1 item had failures:\n   2 of 192 in doc.en.thematic_tutorials.coercion_and_categories\n    [191 tests, 2 failures, 0.28 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2020-02-29T21:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453479",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'></a>

```
sage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 450, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
Expected:
    81
Got:
    82
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 452, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
Expected:
    121
Got:
    122
**********************************************************************
1 item had failures:
   2 of 192 in doc.en.thematic_tutorials.coercion_and_categories
    [191 tests, 2 failures, 0.28 s]
----------------------------------------------------------------------
sage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_256341.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-29T21:44:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256341"
}
```



---

archive/issue_events_256342.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-29T21:44:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256342"
}
```



---

archive/issue_comments_453480.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [vbraun](#comment%3A21):\n> \n> ```\n> sage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst\n> **********************************************************************\n> File \"src/doc/en/thematic_tutorials/coercion_and_categories.rst\", line 450, in doc.en.thematic_tutorials.coercion_and_categories\n> Failed example:\n>     len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\n> Expected:\n>     81\n> Got:\n>     82\n> **********************************************************************\n> File \"src/doc/en/thematic_tutorials/coercion_and_categories.rst\", line 452, in doc.en.thematic_tutorials.coercion_and_categories\n> Failed example:\n>     len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\n> Expected:\n>     121\n> Got:\n>     122\n> **********************************************************************\n> 1 item had failures:\n>    2 of 192 in doc.en.thematic_tutorials.coercion_and_categories\n>     [191 tests, 2 failures, 0.28 s]\n> ----------------------------------------------------------------------\n> sage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed\n> ----------------------------------------------------------------------\n> ```\n\n\nHey @vbraun, thanks for the pointer. I'm new to contributing to sage and this makes me realise I should run all the doctests before sending PRs. Just a clarification, should I also run the \"long\" tests?\n\nAlso, regarding this change, clearly, the error is because I added a new function so the number of expected functions should increase by one. I can make the change in the test file and send it if that's what is required. However, I tried rebasing with current develop branch and then running the doc test and this gives expected and got values different:\n\n```\nFailed example:\n    len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\nExpected:\n    81\nGot:\n    83\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/coercion_and_categories.rst\", line 452, in doc.en.thematic_tutorials.coercion_and_categories\nFailed example:\n    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\nExpected:\n    120\nGot:\n    122\n```\nShould I change the doctest before or after rebase?",
    "created_at": "2020-03-02T18:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453480",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:22'></a>
Replying to [vbraun](#comment%3A21):
> 
> ```
> sage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst
> **********************************************************************
> File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 450, in doc.en.thematic_tutorials.coercion_and_categories
> Failed example:
>     len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
> Expected:
>     81
> Got:
>     82
> **********************************************************************
> File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 452, in doc.en.thematic_tutorials.coercion_and_categories
> Failed example:
>     len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
> Expected:
>     121
> Got:
>     122
> **********************************************************************
> 1 item had failures:
>    2 of 192 in doc.en.thematic_tutorials.coercion_and_categories
>     [191 tests, 2 failures, 0.28 s]
> ----------------------------------------------------------------------
> sage -t --long --warn-long 35.4 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed
> ----------------------------------------------------------------------
> ```


Hey @vbraun, thanks for the pointer. I'm new to contributing to sage and this makes me realise I should run all the doctests before sending PRs. Just a clarification, should I also run the "long" tests?

Also, regarding this change, clearly, the error is because I added a new function so the number of expected functions should increase by one. I can make the change in the test file and send it if that's what is required. However, I tried rebasing with current develop branch and then running the doc test and this gives expected and got values different:

```
Failed example:
    len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
Expected:
    81
Got:
    83
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 452, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
Expected:
    120
Got:
    122
```
Should I change the doctest before or after rebase?



---

archive/issue_comments_453481.json:
```json
{
    "body": "<a id='comment:23'></a>\nI would propose this change:\n\n```diff\ndiff --git a/src/doc/en/thematic_tutorials/coercion_and_categories.rst b/src/doc/en/thematic_tutorials/coercion_and_categories.rst\nindex bd76813e9c..b58c9c59de 100644\n--- a/src/doc/en/thematic_tutorials/coercion_and_categories.rst\n+++ b/src/doc/en/thematic_tutorials/coercion_and_categories.rst\n@@ -447,10 +447,10 @@ Sage's category framework can differentiate the two cases::\n And indeed, ``MS2`` has *more* methods than ``MS1``::\n \n     sage: import inspect\n-    sage: len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\n-    81\n-    sage: len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\n-    121\n+    sage: L1 = len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\n+    sage: L2 = len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\n+    sage: L1 < L2\n+    True\n \n This is because the class of ``MS2`` also inherits from the parent\n class for algebras::\n```\nThe doctest in question is supposed to demonstrate that there are more methods for square matrices than non-square matrices, but I don't see why the actual numbers should be important. And as we see here, the actual numbers are sensitive to changes in the Sage library; testing `L1 < L2` is more robust.",
    "created_at": "2020-03-02T19:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453481",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
I would propose this change:

```diff
diff --git a/src/doc/en/thematic_tutorials/coercion_and_categories.rst b/src/doc/en/thematic_tutorials/coercion_and_categories.rst
index bd76813e9c..b58c9c59de 100644
--- a/src/doc/en/thematic_tutorials/coercion_and_categories.rst
+++ b/src/doc/en/thematic_tutorials/coercion_and_categories.rst
@@ -447,10 +447,10 @@ Sage's category framework can differentiate the two cases::
 And indeed, ``MS2`` has *more* methods than ``MS1``::
 
     sage: import inspect
-    sage: len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
-    81
-    sage: len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
-    121
+    sage: L1 = len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
+    sage: L2 = len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
+    sage: L1 < L2
+    True
 
 This is because the class of ``MS2`` also inherits from the parent
 class for algebras::
```
The doctest in question is supposed to demonstrate that there are more methods for square matrices than non-square matrices, but I don't see why the actual numbers should be important. And as we see here, the actual numbers are sensitive to changes in the Sage library; testing `L1 < L2` is more robust.



---

archive/issue_comments_453482.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jhpalmieri](#comment%3A23):\n> I would propose this change:\n> \n> ```diff\n> diff --git a/src/doc/en/thematic_tutorials/coercion_and_categories.rst b/src/doc/en/thematic_tutorials/coercion_and_categories.rst\n> index bd76813e9c..b58c9c59de 100644\n> --- a/src/doc/en/thematic_tutorials/coercion_and_categories.rst\n> +++ b/src/doc/en/thematic_tutorials/coercion_and_categories.rst\n> @@ -447,10 +447,10 @@ Sage's category framework can differentiate the two cases::\n>  And indeed, ``MS2`` has *more* methods than ``MS1``::\n>  \n>      sage: import inspect\n> -    sage: len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\n> -    81\n> -    sage: len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\n> -    121\n> +    sage: L1 = len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])\n> +    sage: L2 = len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])\n> +    sage: L1 < L2\n> +    True\n>  \n>  This is because the class of ``MS2`` also inherits from the parent\n>  class for algebras::\n> ```\n> The doctest in question is supposed to demonstrate that there are more methods for square matrices than non-square matrices, but I don't see why the actual numbers should be important. And as we see here, the actual numbers are sensitive to changes in the Sage library; testing `L1 < L2` is more robust.\n\n\nOk thank you, I'll make this change. Also, you recently changed the status of #27636 from positive_review to needs work. Can you please make a note there as to what change is required?",
    "created_at": "2020-03-02T19:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453482",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:24'></a>
Replying to [jhpalmieri](#comment%3A23):
> I would propose this change:
> 
> ```diff
> diff --git a/src/doc/en/thematic_tutorials/coercion_and_categories.rst b/src/doc/en/thematic_tutorials/coercion_and_categories.rst
> index bd76813e9c..b58c9c59de 100644
> --- a/src/doc/en/thematic_tutorials/coercion_and_categories.rst
> +++ b/src/doc/en/thematic_tutorials/coercion_and_categories.rst
> @@ -447,10 +447,10 @@ Sage's category framework can differentiate the two cases::
>  And indeed, ``MS2`` has *more* methods than ``MS1``::
>  
>      sage: import inspect
> -    sage: len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
> -    81
> -    sage: len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
> -    121
> +    sage: L1 = len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
> +    sage: L2 = len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
> +    sage: L1 < L2
> +    True
>  
>  This is because the class of ``MS2`` also inherits from the parent
>  class for algebras::
> ```
> The doctest in question is supposed to demonstrate that there are more methods for square matrices than non-square matrices, but I don't see why the actual numbers should be important. And as we see here, the actual numbers are sensitive to changes in the Sage library; testing `L1 < L2` is more robust.


Ok thank you, I'll make this change. Also, you recently changed the status of #27636 from positive_review to needs work. Can you please make a note there as to what change is required?



---

archive/issue_comments_453483.json:
```json
{
    "body": "<a id='comment:25'></a>\nThat was vbraun, not me.",
    "created_at": "2020-03-02T19:30:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453483",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>
That was vbraun, not me.



---

archive/issue_comments_453484.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\" to \"[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\".",
    "created_at": "2020-03-02T19:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453484",
    "user": "https://github.com/SagnikDey92"
}
```

**Changing branch** from "[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)" to "[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)".



---

archive/issue_comments_453485.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jhpalmieri](#comment%3A25):\n> That was vbraun, not me.\n\nI'm so sorry I got mixed up...\nI've made the change now. Also, can you confirm if running all the doctests is necessary while sending the PRs? Since it takes some time on my local machine. Clearly only running it in the project folder I made changes to is not enough because this error was completely outside it?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bc5ef52667e20515a60b65fc3152f87f7ba243a\">9bc5ef5</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c20ffce4fc15496061cdd79d9ac8bf583a1c1702\">c20ffce</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/546351268dc8263b5d590e9363687b5ec81433fe\">5463512</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9308bf1adc84d8d8067003b5b03fa8d2eb0817a\">a9308bf</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4fa5373c7cef5604272ea7643151ce453a6e1826\">4fa5373</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/091cd1d5af441fae029ac3cb52287fdbd4256c07\">091cd1d</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd627626b7deefaa2e547bb79f1930613cbfaa69\">cd62762</a></td><td><code>Modified a doctest that replaces checking for exact number of methods for Matrix spaces with a comparison test.</code></td></tr></table>\n",
    "created_at": "2020-03-02T19:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453485",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:27'></a>
Replying to [jhpalmieri](#comment%3A25):
> That was vbraun, not me.

I'm so sorry I got mixed up...
I've made the change now. Also, can you confirm if running all the doctests is necessary while sending the PRs? Since it takes some time on my local machine. Clearly only running it in the project folder I made changes to is not enough because this error was completely outside it?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bc5ef52667e20515a60b65fc3152f87f7ba243a">9bc5ef5</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c20ffce4fc15496061cdd79d9ac8bf583a1c1702">c20ffce</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/546351268dc8263b5d590e9363687b5ec81433fe">5463512</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9308bf1adc84d8d8067003b5b03fa8d2eb0817a">a9308bf</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4fa5373c7cef5604272ea7643151ce453a6e1826">4fa5373</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/091cd1d5af441fae029ac3cb52287fdbd4256c07">091cd1d</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd627626b7deefaa2e547bb79f1930613cbfaa69">cd62762</a></td><td><code>Modified a doctest that replaces checking for exact number of methods for Matrix spaces with a comparison test.</code></td></tr></table>




---

archive/issue_comments_453486.json:
```json
{
    "body": "**Changing commit** from \"[a214fd2c452bb5e168afb78eb6babf78b1052417](https://github.com/sagemath/sagetrac-mirror/commit/a214fd2c452bb5e168afb78eb6babf78b1052417)\" to \"[cd627626b7deefaa2e547bb79f1930613cbfaa69](https://github.com/sagemath/sagetrac-mirror/commit/cd627626b7deefaa2e547bb79f1930613cbfaa69)\".",
    "created_at": "2020-03-02T19:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453486",
    "user": "https://github.com/SagnikDey92"
}
```

**Changing commit** from "[a214fd2c452bb5e168afb78eb6babf78b1052417](https://github.com/sagemath/sagetrac-mirror/commit/a214fd2c452bb5e168afb78eb6babf78b1052417)" to "[cd627626b7deefaa2e547bb79f1930613cbfaa69](https://github.com/sagemath/sagetrac-mirror/commit/cd627626b7deefaa2e547bb79f1930613cbfaa69)".



---

archive/issue_comments_453487.json:
```json
{
    "body": "<a id='comment:28'></a>\nFirst, the current branch fails to merge.\n\nSecond, it is always best if you run all doctests (`make ptestlong`), but there are bots that run tests as well. You can see their reports by clicking on the circles at the top right of the ticket description box; for this ticket, they take you to the page https://patchbot.sagemath.org/ticket/28882.",
    "created_at": "2020-03-02T19:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453487",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
First, the current branch fails to merge.

Second, it is always best if you run all doctests (`make ptestlong`), but there are bots that run tests as well. You can see their reports by clicking on the circles at the top right of the ticket description box; for this ticket, they take you to the page https://patchbot.sagemath.org/ticket/28882.



---

archive/issue_comments_453488.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\" to \"[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\".",
    "created_at": "2020-03-02T19:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453488",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing branch** from "[u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-SagnikDey92/provide_diagonal_matrix_as_a_method_of_matrix_spaces)" to "[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)".



---

archive/issue_comments_453489.json:
```json
{
    "body": "<a id='comment:30'></a>\nHere's a branch including that change.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c279781c97029997ccaa71e932a51c806088de02\">c279781</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b132688132636c8804bc6130ceaf94d2874e0f14\">b132688</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f56aee3656b3eb92e10a972b7690a1e0bedb36d8\">f56aee3</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54620b2083ef8f03638af156ff309f7802b687d7\">54620b2</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c2a5b2840bc04eb5d59a09c72eec5c5d6826493\">5c2a5b2</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14c422a92d7a7d0b49ce0fa6e32c9875c72e26f1\">14c422a</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/758e943e041ec7e9887eafe55c33cd156c55bf8f\">758e943</a></td><td><code>trac 28882: reviewer changes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41\">f2d8ea9</a></td><td><code>trac 28882: fix doctest in thematic_tutorials</code></td></tr></table>\n",
    "created_at": "2020-03-02T19:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453489",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>
Here's a branch including that change.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c279781c97029997ccaa71e932a51c806088de02">c279781</a></td><td><code>Diagonal matrix function done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b132688132636c8804bc6130ceaf94d2874e0f14">b132688</a></td><td><code>Documentation for diagonal matrix done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f56aee3656b3eb92e10a972b7690a1e0bedb36d8">f56aee3</a></td><td><code>Pointed ms.diagonal_matrix() to the diagonal_matrix() implementation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54620b2083ef8f03638af156ff309f7802b687d7">54620b2</a></td><td><code>Added non square matrix error and some documentation. Made diagonal matrix returned immutable</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c2a5b2840bc04eb5d59a09c72eec5c5d6826493">5c2a5b2</a></td><td><code>Modeled diagonal_matrix on identity_matrix. Changed the documentation accordingly. No longer uses the function in special.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14c422a92d7a7d0b49ce0fa6e32c9875c72e26f1">14c422a</a></td><td><code>Removed immutability of diagonal matrix and edited documentation appropriately</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/758e943e041ec7e9887eafe55c33cd156c55bf8f">758e943</a></td><td><code>trac 28882: reviewer changes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41">f2d8ea9</a></td><td><code>trac 28882: fix doctest in thematic_tutorials</code></td></tr></table>




---

archive/issue_events_256343.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-03-02T19:50:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256343"
}
```



---

archive/issue_events_256344.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-03-02T19:50:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256344"
}
```



---

archive/issue_comments_453490.json:
```json
{
    "body": "**Changing commit** from \"[cd627626b7deefaa2e547bb79f1930613cbfaa69](https://github.com/sagemath/sagetrac-mirror/commit/cd627626b7deefaa2e547bb79f1930613cbfaa69)\" to \"[f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41](https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41)\".",
    "created_at": "2020-03-02T19:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453490",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing commit** from "[cd627626b7deefaa2e547bb79f1930613cbfaa69](https://github.com/sagemath/sagetrac-mirror/commit/cd627626b7deefaa2e547bb79f1930613cbfaa69)" to "[f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41](https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41)".



---

archive/issue_comments_453491.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [jhpalmieri](#comment%3A28):\n> First, the current branch fails to merge.\n\nOh sorry about that. Thank you for correcting it. I'll pull and rebase with current develop on my other branches as well.\n> \n> Second, it is always best if you run all doctests (`make ptestlong`), but there are bots that run tests as well. You can see their reports by clicking on the circles at the top right of the ticket description box; for this ticket, they take you to the page https://patchbot.sagemath.org/ticket/28882.\n\nThank you!",
    "created_at": "2020-03-02T19:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453491",
    "user": "https://github.com/SagnikDey92"
}
```

<a id='comment:31'></a>
Replying to [jhpalmieri](#comment%3A28):
> First, the current branch fails to merge.

Oh sorry about that. Thank you for correcting it. I'll pull and rebase with current develop on my other branches as well.
> 
> Second, it is always best if you run all doctests (`make ptestlong`), but there are bots that run tests as well. You can see their reports by clicking on the circles at the top right of the ticket description box; for this ticket, they take you to the page https://patchbot.sagemath.org/ticket/28882.

Thank you!



---

archive/issue_events_256345.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-03T23:21:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256345"
}
```



---

archive/issue_events_256346.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-03T23:21:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28882#event-256346"
}
```



---

archive/issue_comments_453492.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)\" to \"[f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41](https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41)\".",
    "created_at": "2020-03-03T23:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28882#issuecomment-453492",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/provide_diagonal_matrix_as_a_method_of_matrix_spaces)" to "[f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41](https://github.com/sagemath/sagetrac-mirror/commit/f2d8ea9acfe88a25856e2f844f66f84d1ebfcc41)".
