# Issue 28197: upgrade to ipython 7

archive/issues_027960.json:
```json
{
    "assignees": [
        "https://github.com/jdemeyer",
        "https://github.com/embray"
    ],
    "body": "Upgrade ipython and related packages: \n* https://pypi.org/project/ipython/ 7.13.0 (current as of 2020-06-05: 7.15.0)\n* https://pypi.org/project/ipykernel/ 5.2.1 (current as of 2020-06-05: 5.3.0)\n* https://pypi.org/project/backcall/ 0.1.0 (current as of 2020-06-05)\n* https://pypi.org/project/jedi/ 0.17.0 (current as of 2020-06-05)\n* https://pypi.org/project/prompt-toolkit/ 3.0.5 (current as of 2020-06-05)\n\nAll of these package versions support python >= 3.6 (note #29033).\n\nTarballs: see `checksums.ini` [`upstream_url`]. (To configure Sage to download from the upstream URLs, use `./configure --enable-download-from-upstream-url`)\n\n\nCC:  @embray @jdemeyer @slel @kiwifb @timokau @antonio-rojas\n\nKeywords: **upgrade**\n\nBranch: **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)**\n\nReviewer: **John Palmieri, Matthias Koeppe**\n\nAuthor: **Jonathan Kliem, John Palmieri, Antonio Rojas**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/28197_\n\n",
    "closed_at": "2020-08-09T08:47:34Z",
    "created_at": "2019-07-14T15:37:44Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "upgrade to ipython 7",
    "type": "issue",
    "updated_at": "2020-11-17T08:08:07Z",
    "url": "https://github.com/sagemath/sage/issues/28197",
    "user": "https://github.com/fchapoton"
}
```
Upgrade ipython and related packages: 
* https://pypi.org/project/ipython/ 7.13.0 (current as of 2020-06-05: 7.15.0)
* https://pypi.org/project/ipykernel/ 5.2.1 (current as of 2020-06-05: 5.3.0)
* https://pypi.org/project/backcall/ 0.1.0 (current as of 2020-06-05)
* https://pypi.org/project/jedi/ 0.17.0 (current as of 2020-06-05)
* https://pypi.org/project/prompt-toolkit/ 3.0.5 (current as of 2020-06-05)

All of these package versions support python >= 3.6 (note #29033).

Tarballs: see `checksums.ini` [`upstream_url`]. (To configure Sage to download from the upstream URLs, use `./configure --enable-download-from-upstream-url`)


CC:  @embray @jdemeyer @slel @kiwifb @timokau @antonio-rojas

Keywords: **upgrade**

Branch: **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)**

Reviewer: **John Palmieri, Matthias Koeppe**

Author: **Jonathan Kliem, John Palmieri, Antonio Rojas**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/28197_





---

archive/issue_events_386733.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-14T15:37:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386733"
}
```



---

archive/issue_events_386734.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-14T15:37:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386734"
}
```



---

archive/issue_events_386735.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-14T15:37:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386735"
}
```



---

archive/issue_comments_439143.json:
```json
{
    "body": "Branch: **[public/ticket/28197](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197)**",
    "created_at": "2019-07-14T15:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439143",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[public/ticket/28197](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197)**



---

archive/issue_comments_439144.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n WARNING: this is python3-only\n+\n+* upgraded prompt-toolkit-2.0.9.tar.gz\n+\n+* pip-install backcall\n``````\n",
    "created_at": "2019-07-14T15:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439144",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 WARNING: this is python3-only
+
+* upgraded prompt-toolkit-2.0.9.tar.gz
+
+* pip-install backcall
``````




---

archive/issue_comments_439145.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis is basically working, but maybe without preparsing..\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d4f0c76fe01226a70ba77652833e04f6823dd19\">0d4f0c7</a></td><td><code>adaptation to ipython 7 : first tentative</code></td></tr></table>\n",
    "created_at": "2019-07-14T15:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439145",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">comment:1</div>

This is basically working, but maybe without preparsing..

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d4f0c76fe01226a70ba77652833e04f6823dd19">0d4f0c7</a></td><td><code>adaptation to ipython 7 : first tentative</code></td></tr></table>




---

archive/issue_comments_439146.json:
```json
{
    "body": "Commit: **[`0d4f0c7`](https://github.com/sagemath/sagetrac-mirror/commit/0d4f0c76fe01226a70ba77652833e04f6823dd19)**",
    "created_at": "2019-07-14T15:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439146",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`0d4f0c7`](https://github.com/sagemath/sagetrac-mirror/commit/0d4f0c76fe01226a70ba77652833e04f6823dd19)**



---

archive/issue_comments_439147.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nShould this depend on #28190?",
    "created_at": "2019-07-14T17:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439147",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

Should this depend on #28190?



---

archive/issue_comments_439148.json:
```json
{
    "body": "Dependencies: **#28190**",
    "created_at": "2019-07-14T18:02:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439148",
    "user": "https://github.com/fchapoton"
}
```

Dependencies: **#28190**



---

archive/issue_comments_439149.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,19 @@\n WARNING: this is python3-only\n+\n+* Upgrade ipython to 7.6.1\n+\n+```\n+$ wget -P upstream https://github.com/ipython/ipython/releases/download/7.6.1/ipython-7.6.1.tar.gz\n+```\n \n * upgraded prompt-toolkit-2.0.9.tar.gz\n \n+To download the tarball:\n+\n+```\n+$ wget -P upstream --output-document=prompt-toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz\n+```\n+\n * pip-install backcall\n+\n+\n``````\n",
    "created_at": "2019-07-22T13:20:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439149",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,19 @@
 WARNING: this is python3-only
+
+* Upgrade ipython to 7.6.1
+
+```
+$ wget -P upstream https://github.com/ipython/ipython/releases/download/7.6.1/ipython-7.6.1.tar.gz
+```
 
 * upgraded prompt-toolkit-2.0.9.tar.gz
 
+To download the tarball:
+
+```
+$ wget -P upstream --output-document=prompt-toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz
+```
+
 * pip-install backcall
+
+
``````




---

archive/issue_comments_439150.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,19 @@\n \n * pip-install backcall\n \n+Current issues (8.9.beta3):\n \n+```\n+sage: installed_packages()['ipython']                                                                                                                                                                              \n+'7.6.1'\n+sage: 2^3                                                                                                                                                                                                          \n+1\n+sage: 2**3                                                                                                                                                                                                         \n+8\n+sage: n=4                                                                                                                                                                                                          \n+sage: type(n)                                                                                                                                                                                                      \n+<class 'int'>\n+```\n+\n+The preparsing is not working.\n+\n``````\n",
    "created_at": "2019-07-22T13:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439150",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,19 @@
 
 * pip-install backcall
 
+Current issues (8.9.beta3):
 
+```
+sage: installed_packages()['ipython']                                                                                                                                                                              
+'7.6.1'
+sage: 2^3                                                                                                                                                                                                          
+1
+sage: 2**3                                                                                                                                                                                                         
+8
+sage: n=4                                                                                                                                                                                                          
+sage: type(n)                                                                                                                                                                                                      
+<class 'int'>
+```
+
+The preparsing is not working.
+
``````




---

archive/issue_comments_439151.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,19 +16,3 @@\n \n * pip-install backcall\n \n-Current issues (8.9.beta3):\n-\n-```\n-sage: installed_packages()['ipython']                                                                                                                                                                              \n-'7.6.1'\n-sage: 2^3                                                                                                                                                                                                          \n-1\n-sage: 2**3                                                                                                                                                                                                         \n-8\n-sage: n=4                                                                                                                                                                                                          \n-sage: type(n)                                                                                                                                                                                                      \n-<class 'int'>\n-```\n-\n-The preparsing is not working.\n-\n``````\n",
    "created_at": "2019-07-22T13:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439151",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,19 +16,3 @@
 
 * pip-install backcall
 
-Current issues (8.9.beta3):
-
-```
-sage: installed_packages()['ipython']                                                                                                                                                                              
-'7.6.1'
-sage: 2^3                                                                                                                                                                                                          
-1
-sage: 2**3                                                                                                                                                                                                         
-8
-sage: n=4                                                                                                                                                                                                          
-sage: type(n)                                                                                                                                                                                                      
-<class 'int'>
-```
-
-The preparsing is not working.
-
``````




---

archive/issue_comments_439152.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nCurrent issues (8.9.beta3):\n\n```\nsage: installed_packages()['ipython']                                                                                                                                                                              \n'7.6.1'\nsage: 2^3                                                                                                                                                                                                          \n1\nsage: 2**3                                                                                                                                                                                                         \n8\nsage: n=4                                                                                                                                                                                                          \nsage: type(n)                                                                                                                                                                                                      \n<class 'int'>\n```\n\nThe preparsing is not working since it has been commented out.",
    "created_at": "2019-07-22T13:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439152",
    "user": "https://github.com/jplab"
}
```

<div id="comment:7" align="right">comment:7</div>

Current issues (8.9.beta3):

```
sage: installed_packages()['ipython']                                                                                                                                                                              
'7.6.1'
sage: 2^3                                                                                                                                                                                                          
1
sage: 2**3                                                                                                                                                                                                         
8
sage: n=4                                                                                                                                                                                                          
sage: type(n)                                                                                                                                                                                                      
<class 'int'>
```

The preparsing is not working since it has been commented out.



---

archive/issue_comments_439153.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nTrying to launch ipython one get:\n\n```\njplabbe@blackbomb:~/sage$ sage -ipython\nTraceback (most recent call last):\n...\npkg_resources.DistributionNotFound: The 'jedi>=0.10' distribution was not found and is required by ipython\n```\n\nSo one has to install the `jedi` module as well.",
    "created_at": "2019-07-22T13:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439153",
    "user": "https://github.com/jplab"
}
```

<div id="comment:8" align="right">comment:8</div>

Trying to launch ipython one get:

```
jplabbe@blackbomb:~/sage$ sage -ipython
Traceback (most recent call last):
...
pkg_resources.DistributionNotFound: The 'jedi>=0.10' distribution was not found and is required by ipython
```

So one has to install the `jedi` module as well.



---

archive/issue_comments_439154.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,3 +16,5 @@\n \n * pip-install backcall\n \n+* pip-install jedi\n+\n``````\n",
    "created_at": "2019-09-01T06:28:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439154",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,3 +16,5 @@
 
 * pip-install backcall
 
+* pip-install jedi
+
``````




---

archive/issue_comments_439155.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nA patch that makes sage work with ipython 7, including the preparser, is available at [1]. I haven't bothered to make it backwards compatible with older ipython, and it probably needs some polishing, feel free to take it from there.\n\n[1] https://aur.archlinux.org/cgit/aur.git/tree/sagemath-ipython7.patch?h=sagemath-python3-git",
    "created_at": "2019-09-01T14:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439155",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:11" align="right">comment:11</div>

A patch that makes sage work with ipython 7, including the preparser, is available at [1]. I haven't bothered to make it backwards compatible with older ipython, and it probably needs some polishing, feel free to take it from there.

[1] https://aur.archlinux.org/cgit/aur.git/tree/sagemath-ipython7.patch?h=sagemath-python3-git



---

archive/issue_comments_439156.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n(For lack of a better component; perhaps we should add a \"REPL\" component...?)",
    "created_at": "2019-09-18T12:31:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439156",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

(For lack of a better component; perhaps we should add a "REPL" component...?)



---

archive/issue_events_386736.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-09-18T12:31:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386736"
}
```



---

archive/issue_events_386737.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-11-18T22:21:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386737"
}
```



---

archive/issue_events_386738.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-11-18T22:21:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386738"
}
```



---

archive/issue_events_386739.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-11-18T22:21:49Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "subject": "https://github.com/jhpalmieri",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386739"
}
```



---

archive/issue_events_386740.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-11-18T22:21:49Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "subject": "https://github.com/jhpalmieri",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386740"
}
```



---

archive/issue_comments_439157.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThis is Python 3 only. Are there specific plans for when we drop Python 2 support from Sage? Version 9.1?",
    "created_at": "2019-11-18T22:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439157",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

This is Python 3 only. Are there specific plans for when we drop Python 2 support from Sage? Version 9.1?



---

archive/issue_comments_439158.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nipython 7.10 breaks many more tests due to it no longer sorting dicts. Some tests output is actually random now. Updated patch at https://aur.archlinux.org/cgit/aur.git/tree/sagemath-ipython7.patch?h=sagemath-git",
    "created_at": "2019-12-05T07:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439158",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:16" align="right">comment:16</div>

ipython 7.10 breaks many more tests due to it no longer sorting dicts. Some tests output is actually random now. Updated patch at https://aur.archlinux.org/cgit/aur.git/tree/sagemath-ipython7.patch?h=sagemath-git



---

archive/issue_comments_439159.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439159",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

Ticket retargeted after milestone closed



---

archive/issue_events_386741.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386741"
}
```



---

archive/issue_events_386742.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386742"
}
```



---

archive/issue_comments_439160.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe new jedi completion engine seems to have some problems. For example with IPython 7.6.1, invoking tab completion like\n\n```\nsage: 1 + <TAB>\n```\ncauses the interpreter to freeze for about 1.5 minutes (apparently, a largish cache is created at `~/.cache/jedi/`). After that, several deprecated functions are imported into global scope causing deprecation warnings to be printed, such as:\n\n```\nImporting absolute_igusa_invariants_kohel from here is deprecated. If you need to use it, please import it directly from sage.schemes.hyperelliptic_curves.invariants\nSee https://trac.sagemath.org/28064 for details.\n  return getattr(handle.access, attribute)(*args, **kwargs)\n```\nThis also seems to slow down exiting Sage.\n\n---\n\nAs for the display of dictionaries during doctests, I suggest to open a separate ticket to remove the sorting. This can be done independently from the IPython upgrade, once Python 2 support is dropped by Sage (in 9.1 I assume).",
    "created_at": "2020-01-01T22:17:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439160",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:18" align="right">comment:18</div>

The new jedi completion engine seems to have some problems. For example with IPython 7.6.1, invoking tab completion like

```
sage: 1 + <TAB>
```
causes the interpreter to freeze for about 1.5 minutes (apparently, a largish cache is created at `~/.cache/jedi/`). After that, several deprecated functions are imported into global scope causing deprecation warnings to be printed, such as:

```
Importing absolute_igusa_invariants_kohel from here is deprecated. If you need to use it, please import it directly from sage.schemes.hyperelliptic_curves.invariants
See https://trac.sagemath.org/28064 for details.
  return getattr(handle.access, attribute)(*args, **kwargs)
```
This also seems to slow down exiting Sage.

---

As for the display of dictionaries during doctests, I suggest to open a separate ticket to remove the sorting. This can be done independently from the IPython upgrade, once Python 2 support is dropped by Sage (in 9.1 I assume).



---

archive/issue_comments_439161.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,7 @@\n To download the tarball:\n \n ```\n-$ wget -P upstream --output-document=prompt-toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz\n+$ wget --output-document=upstream/prompt_toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz\n ```\n \n * pip-install backcall\n``````\n",
    "created_at": "2020-01-01T22:17:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439161",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,7 @@
 To download the tarball:
 
 ```
-$ wget -P upstream --output-document=prompt-toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz
+$ wget --output-document=upstream/prompt_toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz
 ```
 
 * pip-install backcall
``````




---

archive/issue_comments_439162.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\na preparation step at #28948",
    "created_at": "2020-01-03T09:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439162",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:19" align="right">comment:19</div>

a preparation step at #28948



---

archive/issue_comments_439163.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI've opened #29042 for the dict sorting changes",
    "created_at": "2020-01-18T23:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439163",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:20" align="right">comment:20</div>

I've opened #29042 for the dict sorting changes



---

archive/issue_comments_439164.json:
```json
{
    "body": "Changed dependencies from **#28190** to **#28190 #29042**",
    "created_at": "2020-01-18T23:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439164",
    "user": "https://github.com/antonio-rojas"
}
```

Changed dependencies from **#28190** to **#28190 #29042**



---

archive/issue_comments_439165.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI have the following that I don't really know what to do with\n\n```\nsage -t --long /usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\", line 352, in sage.repl.ipython_extension.SageMagics.cython\nFailed example:\n    shell.run_cell('''\n    %%cython\n    def f():\n        print('test')\n    ''')\nExpected nothing\nGot:\n    UsageError: Line magic function `%%cython` not found.\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\", line 357, in sage.repl.ipython_extension.SageMagics.cython\nFailed example:\n    f()\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.ipython_extension.SageMagics.cython[3]>\", line 1, in <module>\n        f()\n    NameError: name 'f' is not defined\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\", line 385, in sage.repl.ipython_extension.SageMagics.fortran\nFailed example:\n    shell.run_cell('''\n    %%fortran\n    C FILE: FIB1.F\n          SUBROUTINE FIB(A,N)\n    C\n    C     CALCULATE FIRST N FIBONACCI NUMBERS\n    C\n          INTEGER N\n          REAL*8 A(N)\n          DO I=1,N\n             IF (I.EQ.1) THEN\n                A(I) = 0.0D0\n             ELSEIF (I.EQ.2) THEN\n                A(I) = 1.0D0\n             ELSE\n                A(I) = A(I-1) + A(I-2)\n             ENDIF\n          ENDDO\n          END\n    C END FILE FIB1.F\n    ''')\nExpected nothing\nGot:\n      File \"<ipython-input-1-ab346d8f879f>\", line 3\n        C FILE: FIB1.F\n             ^\n    SyntaxError: invalid syntax\n    <BLANKLINE>\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\", line 406, in sage.repl.ipython_extension.SageMagics.fortran\nFailed example:\n    fib\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.ipython_extension.SageMagics.fortran[3]>\", line 1, in <module>\n        fib\n    NameError: name 'fib' is not defined\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\", line 410, in sage.repl.ipython_extension.SageMagics.fortran\nFailed example:\n    fib(a, 10)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.ipython_extension.SageMagics.fortran[6]>\", line 1, in <module>\n        fib(a, Integer(10))\n    NameError: name 'fib' is not defined\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py\", line 411, in sage.repl.ipython_extension.SageMagics.fortran\nFailed example:\n    a\nExpected:\n    array([  0.,   1.,   1.,   2.,   3.,   5.,   8.,  13.,  21.,  34.])\nGot:\n    array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])\n**********************************************************************\n2 items had failures:\n   2 of   5 in sage.repl.ipython_extension.SageMagics.cython\n   4 of   9 in sage.repl.ipython_extension.SageMagics.fortran\n    [80 tests, 6 failures, 2.14 s]\n----------------------------------------------------------------------\nsage -t --long /usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py  # 6 doctests failed\n```\nIt all comes down from the first test failing because of the `%%cython` magic function not being found. Any clue as to what to do to fix that?",
    "created_at": "2020-03-29T07:45:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439165",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">comment:21</div>

I have the following that I don't really know what to do with

```
sage -t --long /usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py", line 352, in sage.repl.ipython_extension.SageMagics.cython
Failed example:
    shell.run_cell('''
    %%cython
    def f():
        print('test')
    ''')
Expected nothing
Got:
    UsageError: Line magic function `%%cython` not found.
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py", line 357, in sage.repl.ipython_extension.SageMagics.cython
Failed example:
    f()
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_extension.SageMagics.cython[3]>", line 1, in <module>
        f()
    NameError: name 'f' is not defined
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py", line 385, in sage.repl.ipython_extension.SageMagics.fortran
Failed example:
    shell.run_cell('''
    %%fortran
    C FILE: FIB1.F
          SUBROUTINE FIB(A,N)
    C
    C     CALCULATE FIRST N FIBONACCI NUMBERS
    C
          INTEGER N
          REAL*8 A(N)
          DO I=1,N
             IF (I.EQ.1) THEN
                A(I) = 0.0D0
             ELSEIF (I.EQ.2) THEN
                A(I) = 1.0D0
             ELSE
                A(I) = A(I-1) + A(I-2)
             ENDIF
          ENDDO
          END
    C END FILE FIB1.F
    ''')
Expected nothing
Got:
      File "<ipython-input-1-ab346d8f879f>", line 3
        C FILE: FIB1.F
             ^
    SyntaxError: invalid syntax
    <BLANKLINE>
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py", line 406, in sage.repl.ipython_extension.SageMagics.fortran
Failed example:
    fib
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_extension.SageMagics.fortran[3]>", line 1, in <module>
        fib
    NameError: name 'fib' is not defined
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py", line 410, in sage.repl.ipython_extension.SageMagics.fortran
Failed example:
    fib(a, 10)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_extension.SageMagics.fortran[6]>", line 1, in <module>
        fib(a, Integer(10))
    NameError: name 'fib' is not defined
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py", line 411, in sage.repl.ipython_extension.SageMagics.fortran
Failed example:
    a
Expected:
    array([  0.,   1.,   1.,   2.,   3.,   5.,   8.,  13.,  21.,  34.])
Got:
    array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])
**********************************************************************
2 items had failures:
   2 of   5 in sage.repl.ipython_extension.SageMagics.cython
   4 of   9 in sage.repl.ipython_extension.SageMagics.fortran
    [80 tests, 6 failures, 2.14 s]
----------------------------------------------------------------------
sage -t --long /usr/lib/python3.7/site-packages/sage/repl/ipython_extension.py  # 6 doctests failed
```
It all comes down from the first test failing because of the `%%cython` magic function not being found. Any clue as to what to do to fix that?



---

archive/issue_comments_439166.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@kiwifb](#comment:21):\n\n> It all comes down from the first test failing because of the `%%cython` magic function not being found. Any clue as to what to do to fix that?\n\nBroken preparsing? it works fine here with the patch at [comment:16](#comment:16)",
    "created_at": "2020-03-29T08:00:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439166",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@kiwifb](#comment:21):

> It all comes down from the first test failing because of the `%%cython` magic function not being found. Any clue as to what to do to fix that?

Broken preparsing? it works fine here with the patch at [comment:16](#comment:16)



---

archive/issue_comments_439167.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nBecause I was using ipython-7.5 so far I was using the patch at [comment:11](#comment:11) (with small variations between sage-9.0 and 9.1.beta). I'll check the preparsing in [comment:16](#comment:16).",
    "created_at": "2020-03-29T08:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439167",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Because I was using ipython-7.5 so far I was using the patch at [comment:11](#comment:11) (with small variations between sage-9.0 and 9.1.beta). I'll check the preparsing in [comment:16](#comment:16).



---

archive/issue_comments_439168.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI should have asked. When you said it is fine, is it sage-9.0 or 9.1.betaX? I am working on 9.1.beta9 right now.",
    "created_at": "2020-03-29T08:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439168",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

I should have asked. When you said it is fine, is it sage-9.0 or 9.1.betaX? I am working on 9.1.beta9 right now.



---

archive/issue_comments_439169.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@kiwifb](#comment:24):\n> I should have asked. When you said it is fine, is it sage-9.0 or 9.1.betaX? I am working on 9.1.beta9 right now.\n\nBoth. The patch for 9.0 is at https://git.archlinux.org/svntogit/community.git/tree/trunk/sagemath-ipython7.patch?h=packages/sagemath",
    "created_at": "2020-03-29T08:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439169",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@kiwifb](#comment:24):
> I should have asked. When you said it is fine, is it sage-9.0 or 9.1.betaX? I am working on 9.1.beta9 right now.

Both. The patch for 9.0 is at https://git.archlinux.org/svntogit/community.git/tree/trunk/sagemath-ipython7.patch?h=packages/sagemath



---

archive/issue_comments_439170.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nNope. I must be missing something subtle or something in my stack has a bug.",
    "created_at": "2020-03-29T08:31:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439170",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:26" align="right">comment:26</div>

Nope. I must be missing something subtle or something in my stack has a bug.



---

archive/issue_events_386743.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-31T14:36:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386743"
}
```



---

archive/issue_events_386744.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-31T14:36:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386744"
}
```



---

archive/issue_comments_439171.json:
```json
{
    "body": "Changed dependencies from **#28190 #29042** to **#28190 #29042 #29428**",
    "created_at": "2020-04-08T08:16:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439171",
    "user": "https://github.com/antonio-rojas"
}
```

Changed dependencies from **#28190 #29042** to **#28190 #29042 #29428**



---

archive/issue_comments_439172.json:
```json
{
    "body": "Changed commit from **[`0d4f0c7`](https://github.com/sagemath/sagetrac-mirror/commit/0d4f0c76fe01226a70ba77652833e04f6823dd19)** to **[`289e603`](https://github.com/sagemath/sagetrac-mirror/commit/289e60359f76a1cf804b71e16eaa89fa29dc8029)**",
    "created_at": "2020-04-25T17:11:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439172",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0d4f0c7`](https://github.com/sagemath/sagetrac-mirror/commit/0d4f0c76fe01226a70ba77652833e04f6823dd19)** to **[`289e603`](https://github.com/sagemath/sagetrac-mirror/commit/289e60359f76a1cf804b71e16eaa89fa29dc8029)**



---

archive/issue_comments_439173.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/289e60359f76a1cf804b71e16eaa89fa29dc8029\">289e603</a></td><td><code>trac 28197: IPython 7.13.0, with new required packages jedi, backcall</code></td></tr></table>\n",
    "created_at": "2020-04-25T17:11:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439173",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/289e60359f76a1cf804b71e16eaa89fa29dc8029">289e603</a></td><td><code>trac 28197: IPython 7.13.0, with new required packages jedi, backcall</code></td></tr></table>




---

archive/issue_comments_439174.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nHere is a branch for IPython 7.13, which requires new packages jedi and backcall, to give people something new to play with, especially since we're getting close to starting the 9.2 release cycle.\n\nI don't see the problem reported at #29428, or at least the small example there doesn't cause problems for me. The preparser doesn't work, though. I'm about to try the patch in [comment:16](#comment:16), after which I'll add it to the branch. (Is there a missing or an extra single quote on line 47 of that patch?)",
    "created_at": "2020-04-25T17:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439174",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

Here is a branch for IPython 7.13, which requires new packages jedi and backcall, to give people something new to play with, especially since we're getting close to starting the 9.2 release cycle.

I don't see the problem reported at #29428, or at least the small example there doesn't cause problems for me. The preparser doesn't work, though. I'm about to try the patch in [comment:16](#comment:16), after which I'll add it to the branch. (Is there a missing or an extra single quote on line 47 of that patch?)



---

archive/issue_comments_439175.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,20 +1,13 @@\n WARNING: this is python3-only\n \n-* Upgrade ipython to 7.6.1\n+Upgrade ipython to 7.13.0 and related packages\n \n-```\n-$ wget -P upstream https://github.com/ipython/ipython/releases/download/7.6.1/ipython-7.6.1.tar.gz\n-```\n \n-* upgraded prompt-toolkit-2.0.9.tar.gz\n+Files:\n \n-To download the tarball:\n+* https://pypi.io/packages/source/i/ipython/ipython-7.13.0.tar.gz\n+* https://pypi.io/packages/source/i/ipykernel/ipykernel-5.2.1.tar.gz\n+* https://pypi.io/packages/source/b/backcall/backcall-0.1.0.tar.gz\n+* https://pypi.io/packages/source/j/jedi/jedi-0.17.0.tar.gz\n+* https://pypi.io/packages/source/p/prompt_toolkit/prompt_toolkit-3.0.5.tar.gz\n \n-```\n-$ wget --output-document=upstream/prompt_toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz\n-```\n-\n-* pip-install backcall\n-\n-* pip-install jedi\n-\n``````\n",
    "created_at": "2020-04-25T17:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439175",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,20 +1,13 @@
 WARNING: this is python3-only
 
-* Upgrade ipython to 7.6.1
+Upgrade ipython to 7.13.0 and related packages
 
-```
-$ wget -P upstream https://github.com/ipython/ipython/releases/download/7.6.1/ipython-7.6.1.tar.gz
-```
 
-* upgraded prompt-toolkit-2.0.9.tar.gz
+Files:
 
-To download the tarball:
+* https://pypi.io/packages/source/i/ipython/ipython-7.13.0.tar.gz
+* https://pypi.io/packages/source/i/ipykernel/ipykernel-5.2.1.tar.gz
+* https://pypi.io/packages/source/b/backcall/backcall-0.1.0.tar.gz
+* https://pypi.io/packages/source/j/jedi/jedi-0.17.0.tar.gz
+* https://pypi.io/packages/source/p/prompt_toolkit/prompt_toolkit-3.0.5.tar.gz
 
-```
-$ wget --output-document=upstream/prompt_toolkit-2.0.9.tar.gz https://github.com/prompt-toolkit/python-prompt-toolkit/archive/2.0.9.tar.gz
-```
-
-* pip-install backcall
-
-* pip-install jedi
-
``````




---

archive/issue_comments_439176.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31bb55c0494c0538624c37dfb842f74f079da198\">31bb55c</a></td><td><code>trac 28197: fix preparser for new IPython: patch taken from</code></td></tr></table>\n",
    "created_at": "2020-04-25T18:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439176",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31bb55c0494c0538624c37dfb842f74f079da198">31bb55c</a></td><td><code>trac 28197: fix preparser for new IPython: patch taken from</code></td></tr></table>




---

archive/issue_comments_439177.json:
```json
{
    "body": "Changed commit from **[`289e603`](https://github.com/sagemath/sagetrac-mirror/commit/289e60359f76a1cf804b71e16eaa89fa29dc8029)** to **[`31bb55c`](https://github.com/sagemath/sagetrac-mirror/commit/31bb55c0494c0538624c37dfb842f74f079da198)**",
    "created_at": "2020-04-25T18:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439177",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`289e603`](https://github.com/sagemath/sagetrac-mirror/commit/289e60359f76a1cf804b71e16eaa89fa29dc8029)** to **[`31bb55c`](https://github.com/sagemath/sagetrac-mirror/commit/31bb55c0494c0538624c37dfb842f74f079da198)**



---

archive/issue_comments_439178.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nHere is the preparser patch from [comment:16](#comment:16) (although without the lines changing `sys.getrecursionlimit()`). When merged with #29042, I see these doctest failures:\n\n```\nsage -t --long src/sage/tests/cmdline.py  # 3 doctests failed\nsage -t --long src/sage/crypto/mq/sr.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # 1 doctest failed\nsage -t --long src/sage/misc/package.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/pbori.pyx  # 1 doctest failed\nsage -t --long src/sage/sat/solvers/dimacs.py  # 1 doctest failed\nsage -t --long src/doc/en/reference/sat/index.rst  # 1 doctest failed\nsage -t --long src/sage/sat/converters/polybori.py  # 1 doctest failed\nsage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed\n```\n- Almost all of these come from brial:\n\n```\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/IPYTHON/sage-9.1.rc1/local/lib/python3.7/site-packages/brial/gbrefs.py\", line 9, in <module>\n        import imp\n    ...\n    DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses\n```\n- It seems that `jedi` needs `parso` as a prerequisite, and that causes the failure in `cmdline.py`.\n- The error in `misc/package.py` looks like another one from sorting dictionaries, and so it should be dealt with at #29042:\n\n```\nFailed example:\n    installed_packages()  # optional - build\nExpected:\n    {...'alabaster': ...'pynac': ...}\n```\npynac appeared before alabaster in the actual output, unfortunately.",
    "created_at": "2020-04-25T18:25:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439178",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:33" align="right">comment:33</div>

Here is the preparser patch from [comment:16](#comment:16) (although without the lines changing `sys.getrecursionlimit()`). When merged with #29042, I see these doctest failures:

```
sage -t --long src/sage/tests/cmdline.py  # 3 doctests failed
sage -t --long src/sage/crypto/mq/sr.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # 1 doctest failed
sage -t --long src/sage/misc/package.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/pbori.pyx  # 1 doctest failed
sage -t --long src/sage/sat/solvers/dimacs.py  # 1 doctest failed
sage -t --long src/doc/en/reference/sat/index.rst  # 1 doctest failed
sage -t --long src/sage/sat/converters/polybori.py  # 1 doctest failed
sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed
```
- Almost all of these come from brial:

```
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/IPYTHON/sage-9.1.rc1/local/lib/python3.7/site-packages/brial/gbrefs.py", line 9, in <module>
        import imp
    ...
    DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
```
- It seems that `jedi` needs `parso` as a prerequisite, and that causes the failure in `cmdline.py`.
- The error in `misc/package.py` looks like another one from sorting dictionaries, and so it should be dealt with at #29042:

```
Failed example:
    installed_packages()  # optional - build
Expected:
    {...'alabaster': ...'pynac': ...}
```
pynac appeared before alabaster in the actual output, unfortunately.



---

archive/issue_comments_439179.json:
```json
{
    "body": "Changed commit from **[`31bb55c`](https://github.com/sagemath/sagetrac-mirror/commit/31bb55c0494c0538624c37dfb842f74f079da198)** to **[`cd347e1`](https://github.com/sagemath/sagetrac-mirror/commit/cd347e1e37e9c8aadc2d46af83ba7caa0d8e755e)**",
    "created_at": "2020-04-25T18:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439179",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`31bb55c`](https://github.com/sagemath/sagetrac-mirror/commit/31bb55c0494c0538624c37dfb842f74f079da198)** to **[`cd347e1`](https://github.com/sagemath/sagetrac-mirror/commit/cd347e1e37e9c8aadc2d46af83ba7caa0d8e755e)**



---

archive/issue_comments_439180.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd347e1e37e9c8aadc2d46af83ba7caa0d8e755e\">cd347e1</a></td><td><code>trac 28197: add new package parso</code></td></tr></table>\n",
    "created_at": "2020-04-25T18:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439180",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd347e1e37e9c8aadc2d46af83ba7caa0d8e755e">cd347e1</a></td><td><code>trac 28197: add new package parso</code></td></tr></table>




---

archive/issue_comments_439181.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@jhpalmieri](#comment:33):\n> Here is the preparser patch from [comment:16](#comment:16) (although without the lines changing `sys.getrecursionlimit()`). When merged with #29042, I see these doctest failures:\n\nUhm, for some reason I haven't been getting emails from this ticket (and many others). The brial issues are fixed in 1.2.6, sage's package seems to be quite outdated (latest version is 1.2.8)\n\nWhen I ported the preparser, I removed quite a few tests from `SagePromptTransformer()`, those should probably be brought back somewhere.",
    "created_at": "2020-05-06T18:30:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439181",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@jhpalmieri](#comment:33):
> Here is the preparser patch from [comment:16](#comment:16) (although without the lines changing `sys.getrecursionlimit()`). When merged with #29042, I see these doctest failures:

Uhm, for some reason I haven't been getting emails from this ticket (and many others). The brial issues are fixed in 1.2.6, sage's package seems to be quite outdated (latest version is 1.2.8)

When I ported the preparser, I removed quite a few tests from `SagePromptTransformer()`, those should probably be brought back somewhere.



---

archive/issue_comments_439182.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nBRiAl update at #29658",
    "created_at": "2020-05-07T01:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439182",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:36" align="right">comment:36</div>

BRiAl update at #29658



---

archive/issue_comments_439183.json:
```json
{
    "body": "Changed dependencies from **#28190 #29042 #29428** to **#28190 #29042 #29428 #29658**",
    "created_at": "2020-05-07T01:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439183",
    "user": "https://github.com/jhpalmieri"
}
```

Changed dependencies from **#28190 #29042 #29428** to **#28190 #29042 #29428 #29658**



---

archive/issue_comments_439184.json:
```json
{
    "body": "Changed dependencies from **#28190 #29042 #29428 #29658** to **#28190 #29042 #29428 #29658 #29774**",
    "created_at": "2020-06-01T09:08:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439184",
    "user": "https://github.com/antonio-rojas"
}
```

Changed dependencies from **#28190 #29042 #29428 #29658** to **#28190 #29042 #29428 #29658 #29774**



---

archive/issue_comments_439185.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nOpened #29774 to deal with the multiple deprecation warnings thrown by ipython with jedi>=0.16",
    "created_at": "2020-06-01T09:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439185",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:38" align="right">comment:38</div>

Opened #29774 to deal with the multiple deprecation warnings thrown by ipython with jedi>=0.16



---

archive/issue_comments_439186.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThis seems to basically work now. I'm testing it on top of #29042 now and for example with ubuntu eoan I'm getting only one new failure:\n\nhttps://github.com/kliem/sage-test-27122/runs/742530683\n\n```\nFile \"src/sage/rings/qqbar.py\", line 8096, in sage.rings.qqbar.ANBinaryExpr.exactify\nFailed example:\n    import sys; sys.getrecursionlimit()\nExpected:\n    1000\nGot:\n    3000\n**********************************************************************\nFile \"src/sage/rings/qqbar.py\", line 8102, in sage.rings.qqbar.ANBinaryExpr.exactify\nFailed example:\n    sys.getrecursionlimit()\nExpected:\n    1000\nGot:\n    3000\n```\n\nI will report further results, once the tests are done.",
    "created_at": "2020-06-05T19:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439186",
    "user": "https://github.com/kliem"
}
```

<div id="comment:39" align="right">comment:39</div>

This seems to basically work now. I'm testing it on top of #29042 now and for example with ubuntu eoan I'm getting only one new failure:

https://github.com/kliem/sage-test-27122/runs/742530683

```
File "src/sage/rings/qqbar.py", line 8096, in sage.rings.qqbar.ANBinaryExpr.exactify
Failed example:
    import sys; sys.getrecursionlimit()
Expected:
    1000
Got:
    3000
**********************************************************************
File "src/sage/rings/qqbar.py", line 8102, in sage.rings.qqbar.ANBinaryExpr.exactify
Failed example:
    sys.getrecursionlimit()
Expected:
    1000
Got:
    3000
```

I will report further results, once the tests are done.



---

archive/issue_comments_439187.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,6 @@\n WARNING: this is python3-only\n \n-Upgrade ipython to 7.13.0 and related packages\n+Upgrade ipython to 7.13.0 and related packages: ipython-7.13.0, ipykernel-5.2.1, backcall-0.1.0, jedi-0.17.0, prompt_toolkit-3.0.5\n \n+Tarballs: see `checksums.ini` [`upstream_url`]. (To configure Sage to download from the upstream URLs, use `./configure --enable-download-from-upstream-url`)\n \n-Files:\n-\n-* https://pypi.io/packages/source/i/ipython/ipython-7.13.0.tar.gz\n-* https://pypi.io/packages/source/i/ipykernel/ipykernel-5.2.1.tar.gz\n-* https://pypi.io/packages/source/b/backcall/backcall-0.1.0.tar.gz\n-* https://pypi.io/packages/source/j/jedi/jedi-0.17.0.tar.gz\n-* https://pypi.io/packages/source/p/prompt_toolkit/prompt_toolkit-3.0.5.tar.gz\n-\n``````\n",
    "created_at": "2020-06-05T19:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439187",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,6 @@
 WARNING: this is python3-only
 
-Upgrade ipython to 7.13.0 and related packages
+Upgrade ipython to 7.13.0 and related packages: ipython-7.13.0, ipykernel-5.2.1, backcall-0.1.0, jedi-0.17.0, prompt_toolkit-3.0.5
 
+Tarballs: see `checksums.ini` [`upstream_url`]. (To configure Sage to download from the upstream URLs, use `./configure --enable-download-from-upstream-url`)
 
-Files:
-
-* https://pypi.io/packages/source/i/ipython/ipython-7.13.0.tar.gz
-* https://pypi.io/packages/source/i/ipykernel/ipykernel-5.2.1.tar.gz
-* https://pypi.io/packages/source/b/backcall/backcall-0.1.0.tar.gz
-* https://pypi.io/packages/source/j/jedi/jedi-0.17.0.tar.gz
-* https://pypi.io/packages/source/p/prompt_toolkit/prompt_toolkit-3.0.5.tar.gz
-
``````




---

archive/issue_comments_439188.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,11 @@\n-WARNING: this is python3-only\n+Upgrade ipython and related packages: \n+* https://pypi.org/project/ipython/ 7.13.0 (current as of 2020-06-05: 7.15.0)\n+* https://pypi.org/project/ipykernel/ 5.2.1 (current as of 2020-06-05: 5.3.0)\n+* https://pypi.org/project/backcall/ 0.1.0 (current as of 2020-06-05)\n+* https://pypi.org/project/jedi/ 0.17.0 (current as of 2020-06-05)\n+* https://pypi.org/project/prompt-toolkit/ 3.0.5 (current as of 2020-06-05)\n \n-Upgrade ipython to 7.13.0 and related packages: ipython-7.13.0, ipykernel-5.2.1, backcall-0.1.0, jedi-0.17.0, prompt_toolkit-3.0.5\n+All of these package versions support python >= 3.6 (note #29033).\n \n Tarballs: see `checksums.ini` [`upstream_url`]. (To configure Sage to download from the upstream URLs, use `./configure --enable-download-from-upstream-url`)\n \n``````\n",
    "created_at": "2020-06-05T20:04:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439188",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,11 @@
-WARNING: this is python3-only
+Upgrade ipython and related packages: 
+* https://pypi.org/project/ipython/ 7.13.0 (current as of 2020-06-05: 7.15.0)
+* https://pypi.org/project/ipykernel/ 5.2.1 (current as of 2020-06-05: 5.3.0)
+* https://pypi.org/project/backcall/ 0.1.0 (current as of 2020-06-05)
+* https://pypi.org/project/jedi/ 0.17.0 (current as of 2020-06-05)
+* https://pypi.org/project/prompt-toolkit/ 3.0.5 (current as of 2020-06-05)
 
-Upgrade ipython to 7.13.0 and related packages: ipython-7.13.0, ipykernel-5.2.1, backcall-0.1.0, jedi-0.17.0, prompt_toolkit-3.0.5
+All of these package versions support python >= 3.6 (note #29033).
 
 Tarballs: see `checksums.ini` [`upstream_url`]. (To configure Sage to download from the upstream URLs, use `./configure --enable-download-from-upstream-url`)
 
``````




---

archive/issue_comments_439189.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nExcept for this qqbar test, all tests pass on my ubuntu bionic (testing this ticket on top of #29042).\n\nAs noted already tab completion is broken and #29774 fixes this.",
    "created_at": "2020-06-05T20:28:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439189",
    "user": "https://github.com/kliem"
}
```

<div id="comment:42" align="right">comment:42</div>

Except for this qqbar test, all tests pass on my ubuntu bionic (testing this ticket on top of #29042).

As noted already tab completion is broken and #29774 fixes this.



---

archive/issue_comments_439190.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nIs this coming from `jedi/app/__init__.py`, the line\n\n```\nsys.setrecursionlimit(3000)\n```\n?\n\nI don't think the actual limit is important, just that it doesn't change, so I propose the following:\n\n```diff\ndiff --git a/src/sage/rings/qqbar.py b/src/sage/rings/qqbar.py\nindex 7fc0cb9917..f38195cdcc 100644\n--- a/src/sage/rings/qqbar.py\n+++ b/src/sage/rings/qqbar.py\n@@ -8093,14 +8093,14 @@ class ANBinaryExpr(ANDescr):\n         do this by increasing the recursion level at each step and\n         decrease it before we return::\n \n-            sage: import sys; sys.getrecursionlimit()\n-            1000\n+            sage: import sys\n+            sage: old_limit = sys.getrecursionlimit()\n             sage: s = SymmetricFunctions(QQ).schur()\n             sage: a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))\n             sage: a.exactify(); a # long time\n             0\n-            sage: sys.getrecursionlimit()\n-            1000\n+            sage: sys.getrecursionlimit() == old_limit\n+            True\n \n         \"\"\"\n         import sys\n```",
    "created_at": "2020-06-05T23:13:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439190",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:43" align="right">comment:43</div>

Is this coming from `jedi/app/__init__.py`, the line

```
sys.setrecursionlimit(3000)
```
?

I don't think the actual limit is important, just that it doesn't change, so I propose the following:

```diff
diff --git a/src/sage/rings/qqbar.py b/src/sage/rings/qqbar.py
index 7fc0cb9917..f38195cdcc 100644
--- a/src/sage/rings/qqbar.py
+++ b/src/sage/rings/qqbar.py
@@ -8093,14 +8093,14 @@ class ANBinaryExpr(ANDescr):
         do this by increasing the recursion level at each step and
         decrease it before we return::
 
-            sage: import sys; sys.getrecursionlimit()
-            1000
+            sage: import sys
+            sage: old_limit = sys.getrecursionlimit()
             sage: s = SymmetricFunctions(QQ).schur()
             sage: a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))
             sage: a.exactify(); a # long time
             0
-            sage: sys.getrecursionlimit()
-            1000
+            sage: sys.getrecursionlimit() == old_limit
+            True
 
         """
         import sys
```



---

archive/issue_comments_439191.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI ran into a problem building Sage because it tried to build `backcall` before `pip` was installed. So here is a new branch. (It doesn't include the proposed change from [comment:43](#comment:43)).",
    "created_at": "2020-06-05T23:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439191",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>

I ran into a problem building Sage because it tried to build `backcall` before `pip` was installed. So here is a new branch. (It doesn't include the proposed change from [comment:43](#comment:43)).



---

archive/issue_comments_439192.json:
```json
{
    "body": "Changed commit from **[`cd347e1`](https://github.com/sagemath/sagetrac-mirror/commit/cd347e1e37e9c8aadc2d46af83ba7caa0d8e755e)** to **[`a9594b5`](https://github.com/sagemath/sagetrac-mirror/commit/a9594b5951a0244d526da156eb461f0cd82a753c)**",
    "created_at": "2020-06-05T23:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439192",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cd347e1`](https://github.com/sagemath/sagetrac-mirror/commit/cd347e1e37e9c8aadc2d46af83ba7caa0d8e755e)** to **[`a9594b5`](https://github.com/sagemath/sagetrac-mirror/commit/a9594b5951a0244d526da156eb461f0cd82a753c)**



---

archive/issue_comments_439193.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb86032bc598a6d187a2fd42cc4d36bd6d8642a2\">cb86032</a></td><td><code>trac 28197: IPython 7.13.0, with new required packages jedi, backcall</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbfbc4f7c8571fd4eaee11b9ac27294efbd2ad93\">bbfbc4f</a></td><td><code>trac 28197: fix preparser for new IPython: patch taken from</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61157b8ff20be257f84696ece782395cc8a58acd\">61157b8</a></td><td><code>trac 28197: add new package parso</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9594b5951a0244d526da156eb461f0cd82a753c\">a9594b5</a></td><td><code>trac 28197: add pip as dependency for backcall, jedi, parso</code></td></tr></table>\n",
    "created_at": "2020-06-05T23:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439193",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb86032bc598a6d187a2fd42cc4d36bd6d8642a2">cb86032</a></td><td><code>trac 28197: IPython 7.13.0, with new required packages jedi, backcall</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbfbc4f7c8571fd4eaee11b9ac27294efbd2ad93">bbfbc4f</a></td><td><code>trac 28197: fix preparser for new IPython: patch taken from</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61157b8ff20be257f84696ece782395cc8a58acd">61157b8</a></td><td><code>trac 28197: add new package parso</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9594b5951a0244d526da156eb461f0cd82a753c">a9594b5</a></td><td><code>trac 28197: add pip as dependency for backcall, jedi, parso</code></td></tr></table>




---

archive/issue_comments_439194.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOn OS X, with this + #29042, the `qqbar` test is the only one that fails for me.",
    "created_at": "2020-06-05T23:17:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439194",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:46" align="right">comment:46</div>

On OS X, with this + #29042, the `qqbar` test is the only one that fails for me.



---

archive/issue_comments_439195.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nPYTHON_TOOLKIT should probably be PYTHON_TOOLCHAIN",
    "created_at": "2020-06-10T20:53:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439195",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:48" align="right">comment:48</div>

PYTHON_TOOLKIT should probably be PYTHON_TOOLCHAIN



---

archive/issue_comments_439196.json:
```json
{
    "body": "Changed commit from **[`a9594b5`](https://github.com/sagemath/sagetrac-mirror/commit/a9594b5951a0244d526da156eb461f0cd82a753c)** to **[`7f73577`](https://github.com/sagemath/sagetrac-mirror/commit/7f735773199643862f29238aee5790404e570630)**",
    "created_at": "2020-06-10T21:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439196",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a9594b5`](https://github.com/sagemath/sagetrac-mirror/commit/a9594b5951a0244d526da156eb461f0cd82a753c)** to **[`7f73577`](https://github.com/sagemath/sagetrac-mirror/commit/7f735773199643862f29238aee5790404e570630)**



---

archive/issue_comments_439197.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f735773199643862f29238aee5790404e570630\">7f73577</a></td><td><code>trac 28197: add pip as dependency for backcall, jedi, parso</code></td></tr></table>\n",
    "created_at": "2020-06-10T21:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439197",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f735773199643862f29238aee5790404e570630">7f73577</a></td><td><code>trac 28197: add pip as dependency for backcall, jedi, parso</code></td></tr></table>




---

archive/issue_comments_439198.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nThanks, fixed.",
    "created_at": "2020-06-10T21:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439198",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:50" align="right">comment:50</div>

Thanks, fixed.



---

archive/issue_comments_439199.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nWhat is missing on this ticket?",
    "created_at": "2020-06-14T19:08:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439199",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">comment:51</div>

What is missing on this ticket?



---

archive/issue_events_386745.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-14T19:12:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386745"
}
```



---

archive/issue_events_386746.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-14T19:12:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386746"
}
```



---

archive/issue_comments_439200.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nIn my opinion, the only thing missing is how to resolve the qqbar doctest failure. I proposed a solution in [comment:43](#comment:43), but I would like some feedback before adding it to the branch. Maybe I'm missing something, or maybe there is a better solution.",
    "created_at": "2020-06-14T20:04:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439200",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:53" align="right">comment:53</div>

In my opinion, the only thing missing is how to resolve the qqbar doctest failure. I proposed a solution in [comment:43](#comment:43), but I would like some feedback before adding it to the branch. Maybe I'm missing something, or maybe there is a better solution.



---

archive/issue_comments_439201.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nThe test tests two things, if I see this correctly:\n- Changing the recursion limit in the method allows for\n\n```\na=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))\n```\n  to be exactified.\n- Also the recursion limit should be the same after the method was called.\n\nIf the initial recursion limit is already 3000, the test doesn't work anymore. As `a` can be exactified without modifying the recursion limit in the method `exactify` (I checked). So the test passes with the solution in [comment:43](#comment:43), but it is almost meaningless.\n\nI see two solutions for this:\n\n- Replace `a` by\n\n```\na=s([3,2]).expand(10)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(7)^d for d in range(7)]]))\n```\n  This value cannot be exactified with recursion limit 3000, but it works fine once the method increases the recursion limit.\n  However the doctest takes a bit longer.\n- We could modify the recursion limit before and after the doctest. This is faster. However, we rely on the same machinery as the method.\n\n  The advantage is that this really is a long time solution. If with some new update the default recursion limit is increased again, we can still see that the method works correctly.",
    "created_at": "2020-06-15T06:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439201",
    "user": "https://github.com/kliem"
}
```

<div id="comment:54" align="right">comment:54</div>

The test tests two things, if I see this correctly:
- Changing the recursion limit in the method allows for

```
a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))
```
  to be exactified.
- Also the recursion limit should be the same after the method was called.

If the initial recursion limit is already 3000, the test doesn't work anymore. As `a` can be exactified without modifying the recursion limit in the method `exactify` (I checked). So the test passes with the solution in [comment:43](#comment:43), but it is almost meaningless.

I see two solutions for this:

- Replace `a` by

```
a=s([3,2]).expand(10)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(7)^d for d in range(7)]]))
```
  This value cannot be exactified with recursion limit 3000, but it works fine once the method increases the recursion limit.
  However the doctest takes a bit longer.
- We could modify the recursion limit before and after the doctest. This is faster. However, we rely on the same machinery as the method.

  The advantage is that this really is a long time solution. If with some new update the default recursion limit is increased again, we can still see that the method works correctly.



---

archive/issue_comments_439202.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nWith the longer version (your first proposal), `a.exactify()` takes over 10 seconds on my computer, which is longer than we usually aim for with tests. So I would prefer your second proposal.",
    "created_at": "2020-06-15T16:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439202",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:55" align="right">comment:55</div>

With the longer version (your first proposal), `a.exactify()` takes over 10 seconds on my computer, which is longer than we usually aim for with tests. So I would prefer your second proposal.



---

archive/issue_comments_439203.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@mkoeppe](#comment:51):\n> What is missing on this ticket?\n\nThe removed tests from the old SagePromptTransformer() need to be restored",
    "created_at": "2020-06-15T17:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439203",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@mkoeppe](#comment:51):
> What is missing on this ticket?

The removed tests from the old SagePromptTransformer() need to be restored



---

archive/issue_comments_439204.json:
```json
{
    "body": "Changed branch from **[public/ticket/28197](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197)** to **[public/ticket/28197-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197-reb)**",
    "created_at": "2020-06-15T18:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439204",
    "user": "https://github.com/kliem"
}
```

Changed branch from **[public/ticket/28197](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197)** to **[public/ticket/28197-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197-reb)**



---

archive/issue_comments_439205.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f832bbe51f6a93929cc9e2b9fe3d6149b22e7443\">f832bbe</a></td><td><code>trac 28197: IPython 7.13.0, with new required packages jedi, backcall</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3ebfc1a38f1094a56b02435376b0ac142c4dac5\">e3ebfc1</a></td><td><code>trac 28197: fix preparser for new IPython: patch taken from</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc6e1d8bed221fb6b3bd65821b58ae9247d768af\">dc6e1d8</a></td><td><code>trac 28197: add new package parso</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ee3f3d01ed068ac32837402e39931511ae117e5\">7ee3f3d</a></td><td><code>trac 28197: add pip as dependency for backcall, jedi, parso</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41e63557a26f754714950bff11c546606d2f76ef\">41e6355</a></td><td><code>lower the recursion limit for exactification test</code></td></tr></table>\n",
    "created_at": "2020-06-15T18:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439205",
    "user": "https://github.com/kliem"
}
```

<div id="comment:57"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f832bbe51f6a93929cc9e2b9fe3d6149b22e7443">f832bbe</a></td><td><code>trac 28197: IPython 7.13.0, with new required packages jedi, backcall</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3ebfc1a38f1094a56b02435376b0ac142c4dac5">e3ebfc1</a></td><td><code>trac 28197: fix preparser for new IPython: patch taken from</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc6e1d8bed221fb6b3bd65821b58ae9247d768af">dc6e1d8</a></td><td><code>trac 28197: add new package parso</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ee3f3d01ed068ac32837402e39931511ae117e5">7ee3f3d</a></td><td><code>trac 28197: add pip as dependency for backcall, jedi, parso</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41e63557a26f754714950bff11c546606d2f76ef">41e6355</a></td><td><code>lower the recursion limit for exactification test</code></td></tr></table>




---

archive/issue_comments_439206.json:
```json
{
    "body": "Changed commit from **[`7f73577`](https://github.com/sagemath/sagetrac-mirror/commit/7f735773199643862f29238aee5790404e570630)** to **[`41e6355`](https://github.com/sagemath/sagetrac-mirror/commit/41e63557a26f754714950bff11c546606d2f76ef)**",
    "created_at": "2020-06-15T18:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439206",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[`7f73577`](https://github.com/sagemath/sagetrac-mirror/commit/7f735773199643862f29238aee5790404e570630)** to **[`41e6355`](https://github.com/sagemath/sagetrac-mirror/commit/41e63557a26f754714950bff11c546606d2f76ef)**



---

archive/issue_comments_439207.json:
```json
{
    "body": "<div id=\"comment:58\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/114d322aed47382852f186e6d60eb98264118be5\">114d322</a></td><td><code>readd prompt transformer doc tests</code></td></tr></table>\n",
    "created_at": "2020-06-15T19:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439207",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:58"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/114d322aed47382852f186e6d60eb98264118be5">114d322</a></td><td><code>readd prompt transformer doc tests</code></td></tr></table>




---

archive/issue_comments_439208.json:
```json
{
    "body": "Changed commit from **[`41e6355`](https://github.com/sagemath/sagetrac-mirror/commit/41e63557a26f754714950bff11c546606d2f76ef)** to **[`114d322`](https://github.com/sagemath/sagetrac-mirror/commit/114d322aed47382852f186e6d60eb98264118be5)**",
    "created_at": "2020-06-15T19:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439208",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`41e6355`](https://github.com/sagemath/sagetrac-mirror/commit/41e63557a26f754714950bff11c546606d2f76ef)** to **[`114d322`](https://github.com/sagemath/sagetrac-mirror/commit/114d322aed47382852f186e6d60eb98264118be5)**



---

archive/issue_comments_439209.json:
```json
{
    "body": "Author: **Jonathan Kliem, \u200bJohn H. Palmieri, Antonio Rojas**",
    "created_at": "2020-06-15T19:44:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439209",
    "user": "https://github.com/kliem"
}
```

Author: **Jonathan Kliem, John H. Palmieri, Antonio Rojas**



---

archive/issue_events_386747.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-06-15T19:44:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386747"
}
```



---

archive/issue_comments_439210.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nAs for the authors, I kind of guessed. Is this correct? Am I missing something?\n\nAlso I don't really know how we do it with order of authors. I went alphabetically. However, I just fixed doctests.",
    "created_at": "2020-06-15T19:44:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439210",
    "user": "https://github.com/kliem"
}
```

<div id="comment:59" align="right">comment:59</div>

As for the authors, I kind of guessed. Is this correct? Am I missing something?

Also I don't really know how we do it with order of authors. I went alphabetically. However, I just fixed doctests.



---

archive/issue_comments_439211.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\n\n```\ndiff --git a/src/sage/rings/qqbar.py b/src/sage/rings/qqbar.py\nindex 7fa7f8d..fd4b3bf 100644\n--- a/src/sage/rings/qqbar.py\n+++ b/src/sage/rings/qqbar.py\n@@ -8091,9 +8091,16 @@ class ANBinaryExpr(ANDescr):\n \n         We check to make sure that this method still works even. We\n         do this by increasing the recursion level at each step and\n-        decrease it before we return::\n+        decrease it before we return.\n+        We lower the recursion limit for this test to allow\n+        a test in reasonable time::\n \n-            sage: import sys; sys.getrecursionlimit()\n+            sage: import sys\n+            sage: old_recursion_limit = sys.getrecursionlimit()\n+            sage: sys.setrecursionlimit(1000)\n+\n+            sage: old_recursion_limit = sys.getrecursionlimit()\n+            sage: sys.getrecursionlimit()\n             1000\n             sage: s = SymmetricFunctions(QQ).schur()\n             sage: a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))\n```\n\nThe second `old_recursion_limit = sys.getrecursionlimit()` here doesn't look right. This will always set the recursion limit to 1000 at the end regardless of the original value",
    "created_at": "2020-06-15T20:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439211",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:60" align="right">comment:60</div>


```
diff --git a/src/sage/rings/qqbar.py b/src/sage/rings/qqbar.py
index 7fa7f8d..fd4b3bf 100644
--- a/src/sage/rings/qqbar.py
+++ b/src/sage/rings/qqbar.py
@@ -8091,9 +8091,16 @@ class ANBinaryExpr(ANDescr):
 
         We check to make sure that this method still works even. We
         do this by increasing the recursion level at each step and
-        decrease it before we return::
+        decrease it before we return.
+        We lower the recursion limit for this test to allow
+        a test in reasonable time::
 
-            sage: import sys; sys.getrecursionlimit()
+            sage: import sys
+            sage: old_recursion_limit = sys.getrecursionlimit()
+            sage: sys.setrecursionlimit(1000)
+
+            sage: old_recursion_limit = sys.getrecursionlimit()
+            sage: sys.getrecursionlimit()
             1000
             sage: s = SymmetricFunctions(QQ).schur()
             sage: a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))
```

The second `old_recursion_limit = sys.getrecursionlimit()` here doesn't look right. This will always set the recursion limit to 1000 at the end regardless of the original value



---

archive/issue_comments_439212.json:
```json
{
    "body": "Changed commit from **[`114d322`](https://github.com/sagemath/sagetrac-mirror/commit/114d322aed47382852f186e6d60eb98264118be5)** to **[`751864b`](https://github.com/sagemath/sagetrac-mirror/commit/751864be3ff6a170ae7a9071b3bd586211697bd9)**",
    "created_at": "2020-06-15T20:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439212",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`114d322`](https://github.com/sagemath/sagetrac-mirror/commit/114d322aed47382852f186e6d60eb98264118be5)** to **[`751864b`](https://github.com/sagemath/sagetrac-mirror/commit/751864be3ff6a170ae7a9071b3bd586211697bd9)**



---

archive/issue_comments_439213.json:
```json
{
    "body": "<div id=\"comment:61\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/751864be3ff6a170ae7a9071b3bd586211697bd9\">751864b</a></td><td><code>fixed mistake</code></td></tr></table>\n",
    "created_at": "2020-06-15T20:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439213",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:61"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/751864be3ff6a170ae7a9071b3bd586211697bd9">751864b</a></td><td><code>fixed mistake</code></td></tr></table>




---

archive/issue_comments_439214.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nThanks for catching this.\n\nReplying to [@antonio-rojas](#comment:60):\n> \n> ```\n> diff --git a/src/sage/rings/qqbar.py b/src/sage/rings/qqbar.py\n> index 7fa7f8d..fd4b3bf 100644\n> --- a/src/sage/rings/qqbar.py\n> +++ b/src/sage/rings/qqbar.py\n> @@ -8091,9 +8091,16 @@ class ANBinaryExpr(ANDescr):\n>  \n>          We check to make sure that this method still works even. We\n>          do this by increasing the recursion level at each step and\n> -        decrease it before we return::\n> +        decrease it before we return.\n> +        We lower the recursion limit for this test to allow\n> +        a test in reasonable time::\n>  \n> -            sage: import sys; sys.getrecursionlimit()\n> +            sage: import sys\n> +            sage: old_recursion_limit = sys.getrecursionlimit()\n> +            sage: sys.setrecursionlimit(1000)\n> +\n> +            sage: old_recursion_limit = sys.getrecursionlimit()\n> +            sage: sys.getrecursionlimit()\n>              1000\n>              sage: s = SymmetricFunctions(QQ).schur()\n>              sage: a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))\n> ```\n> \n> The second `old_recursion_limit = sys.getrecursionlimit()` here doesn't look right. This will always set the recursion limit to 1000 at the end regardless of the original value",
    "created_at": "2020-06-15T20:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439214",
    "user": "https://github.com/kliem"
}
```

<div id="comment:62" align="right">comment:62</div>

Thanks for catching this.

Replying to [@antonio-rojas](#comment:60):
> 
> ```
> diff --git a/src/sage/rings/qqbar.py b/src/sage/rings/qqbar.py
> index 7fa7f8d..fd4b3bf 100644
> --- a/src/sage/rings/qqbar.py
> +++ b/src/sage/rings/qqbar.py
> @@ -8091,9 +8091,16 @@ class ANBinaryExpr(ANDescr):
>  
>          We check to make sure that this method still works even. We
>          do this by increasing the recursion level at each step and
> -        decrease it before we return::
> +        decrease it before we return.
> +        We lower the recursion limit for this test to allow
> +        a test in reasonable time::
>  
> -            sage: import sys; sys.getrecursionlimit()
> +            sage: import sys
> +            sage: old_recursion_limit = sys.getrecursionlimit()
> +            sage: sys.setrecursionlimit(1000)
> +
> +            sage: old_recursion_limit = sys.getrecursionlimit()
> +            sage: sys.getrecursionlimit()
>              1000
>              sage: s = SymmetricFunctions(QQ).schur()
>              sage: a=s([3,2]).expand(8)(flatten([[QQbar.zeta(3)^d for d in range(3)], [QQbar.zeta(5)^d for d in range(5)]]))
> ```
> 
> The second `old_recursion_limit = sys.getrecursionlimit()` here doesn't look right. This will always set the recursion limit to 1000 at the end regardless of the original value



---

archive/issue_comments_439215.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nAre all of the issues taken care of? Tests pass for me on OS X (after merging #29042).",
    "created_at": "2020-06-16T20:09:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439215",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:63" align="right">comment:63</div>

Are all of the issues taken care of? Tests pass for me on OS X (after merging #29042).



---

archive/issue_comments_439216.json:
```json
{
    "body": "Changed keywords from none to **upgrade**",
    "created_at": "2020-06-17T21:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439216",
    "user": "https://github.com/slel"
}
```

Changed keywords from none to **upgrade**



---

archive/issue_comments_439217.json:
```json
{
    "body": "Changed author from **Jonathan Kliem, \u200bJohn H. Palmieri, Antonio Rojas** to **Jonathan Kliem, \u200bJohn Palmieri, Antonio Rojas**",
    "created_at": "2020-06-17T21:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439217",
    "user": "https://github.com/slel"
}
```

Changed author from **Jonathan Kliem, John H. Palmieri, Antonio Rojas** to **Jonathan Kliem, John Palmieri, Antonio Rojas**



---

archive/issue_comments_439218.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\n(Fixing John Palmieri's name in \"Authors\" field to match its spelling in other tickets.)",
    "created_at": "2020-06-17T21:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439218",
    "user": "https://github.com/slel"
}
```

<div id="comment:64" align="right">comment:64</div>

(Fixing John Palmieri's name in "Authors" field to match its spelling in other tickets.)



---

archive/issue_comments_439219.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nSo, can we move on here ? Patchbots are helpless to check that nothing is broken. Does the gitlab CI help in this case ?",
    "created_at": "2020-06-27T17:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439219",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:65" align="right">comment:65</div>

So, can we move on here ? Patchbots are helpless to check that nothing is broken. Does the gitlab CI help in this case ?



---

archive/issue_comments_439220.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nI started a test run pulling this ticket and #29851 in the newest develop (#29851 fixes the workflow for debian bullseye and debian sid, so this seems reasonable for a good testing experience, it just allows reinstalling python for them, so really nothing to do with our ticket).\n\nResults will be available here https://github.com/kliem/sage/pull/16/checks.",
    "created_at": "2020-06-27T17:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439220",
    "user": "https://github.com/kliem"
}
```

<div id="comment:66" align="right">comment:66</div>

I started a test run pulling this ticket and #29851 in the newest develop (#29851 fixes the workflow for debian bullseye and debian sid, so this seems reasonable for a good testing experience, it just allows reinstalling python for them, so really nothing to do with our ticket).

Results will be available here https://github.com/kliem/sage/pull/16/checks.



---

archive/issue_comments_439221.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nThis still works for me on OS X, after merging with the latest `develop` branch. I'll switch to positive review in a few days, naming some collection of reviewers unless (a) someone objects or (b) someone beats me to it.",
    "created_at": "2020-06-27T21:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439221",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:67" align="right">comment:67</div>

This still works for me on OS X, after merging with the latest `develop` branch. I'll switch to positive review in a few days, naming some collection of reviewers unless (a) someone objects or (b) someone beats me to it.



---

archive/issue_comments_439222.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nI have also tested an earlier version successfully as part of #29864 (namespace packages). Let's get this into the next beta for wider testing.",
    "created_at": "2020-06-27T21:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439222",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">comment:68</div>

I have also tested an earlier version successfully as part of #29864 (namespace packages). Let's get this into the next beta for wider testing.



---

archive/issue_comments_439223.json:
```json
{
    "body": "Reviewer: **John Palmieri, Matthias Koeppe**",
    "created_at": "2020-06-27T21:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439223",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **John Palmieri, Matthias Koeppe**



---

archive/issue_comments_439224.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nAs for the tests, there is no obvious failure. So at least installing seems to work everywhere. I didn't test any generated docker images to see how it actually looks though.",
    "created_at": "2020-06-29T07:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439224",
    "user": "https://github.com/kliem"
}
```

<div id="comment:69" align="right">comment:69</div>

As for the tests, there is no obvious failure. So at least installing seems to work everywhere. I didn't test any generated docker images to see how it actually looks though.



---

archive/issue_comments_439225.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nI'm carrying out my threat to set a positive review ;)\n\nDear all: feel free to add yourself as a reviewer or an author (or both), as you see fit.",
    "created_at": "2020-06-30T22:45:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439225",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:70" align="right">comment:70</div>

I'm carrying out my threat to set a positive review ;)

Dear all: feel free to add yourself as a reviewer or an author (or both), as you see fit.



---

archive/issue_events_386748.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-06-30T22:45:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386748"
}
```



---

archive/issue_events_386749.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-06-30T22:45:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386749"
}
```



---

archive/issue_comments_439226.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nFor a future ticket, we could also upgrade to 7.16.1. I just tried, and it builds and passes tests on my OS X box. I want to get this ticket in as it stands, though.",
    "created_at": "2020-07-02T02:57:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439226",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:71" align="right">comment:71</div>

For a future ticket, we could also upgrade to 7.16.1. I just tried, and it builds and passes tests on my OS X box. I want to get this ticket in as it stands, though.



---

archive/issue_comments_439227.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@jhpalmieri](#comment:71):\n> For a future ticket, we could also upgrade to 7.16.1. I just tried, and it builds and passes tests on my OS X box. I want to get this ticket in as it stands, though.\n\nFor the record, I am at 7.16.1 in sage-on-gentoo as well. Merging as it it now is the most important bit.",
    "created_at": "2020-07-02T03:33:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439227",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@jhpalmieri](#comment:71):
> For a future ticket, we could also upgrade to 7.16.1. I just tried, and it builds and passes tests on my OS X box. I want to get this ticket in as it stands, though.

For the record, I am at 7.16.1 in sage-on-gentoo as well. Merging as it it now is the most important bit.



---

archive/issue_comments_439228.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nLooks like merge failed",
    "created_at": "2020-07-12T20:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439228",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:73" align="right">comment:73</div>

Looks like merge failed



---

archive/issue_comments_439229.json:
```json
{
    "body": "Changed commit from **[`751864b`](https://github.com/sagemath/sagetrac-mirror/commit/751864be3ff6a170ae7a9071b3bd586211697bd9)** to **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)**",
    "created_at": "2020-07-12T20:52:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439229",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`751864b`](https://github.com/sagemath/sagetrac-mirror/commit/751864be3ff6a170ae7a9071b3bd586211697bd9)** to **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)**



---

archive/issue_events_386750.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-07-12T20:52:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386750"
}
```



---

archive/issue_events_386751.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-07-12T20:52:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386751"
}
```



---

archive/issue_comments_439230.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8\">e21a7b0</a></td><td><code>Merge tag '9.2.beta5' into t/28197/public/ticket/28197-reb</code></td></tr></table>\n",
    "created_at": "2020-07-12T20:52:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439230",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8">e21a7b0</a></td><td><code>Merge tag '9.2.beta5' into t/28197/public/ticket/28197-reb</code></td></tr></table>




---

archive/issue_events_386752.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-12T20:52:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386752"
}
```



---

archive/issue_events_386753.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-12T20:52:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386753"
}
```



---

archive/issue_comments_439231.json:
```json
{
    "body": "Changed dependencies from **#28190 #29042 #29428 #29658 #29774** to none",
    "created_at": "2020-08-03T00:38:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439231",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#28190 #29042 #29428 #29658 #29774** to none



---

archive/issue_comments_439232.json:
```json
{
    "body": "Changed branch from **[public/ticket/28197-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197-reb)** to **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)**",
    "created_at": "2020-08-09T08:47:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439232",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/28197-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/28197-reb)** to **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)**



---

archive/issue_events_386754.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-09T08:47:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386754"
}
```



---

archive/issue_events_386755.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f55701e735b9cad2a04370b48f1148984477046a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-09T08:47:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/28197#event-386755"
}
```



---

archive/issue_comments_439233.json:
```json
{
    "body": "Changed commit from **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)** to none",
    "created_at": "2020-08-11T16:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439233",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changed commit from **[`e21a7b0`](https://github.com/sagemath/sagetrac-mirror/commit/e21a7b0eec15aac948ff62e0379207471cdc7de8)** to none



---

archive/issue_comments_439234.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nThis update [broke](https://groups.google.com/d/msg/sage-release/spalYgXKr-4/khvt2dRMBwAJ) `sage-shell-mode` support for Sage session in emacs.",
    "created_at": "2020-08-11T16:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439234",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:78" align="right">comment:78</div>

This update [broke](https://groups.google.com/d/msg/sage-release/spalYgXKr-4/khvt2dRMBwAJ) `sage-shell-mode` support for Sage session in emacs.



---

archive/issue_comments_439235.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nPreparsing multi-line strings also seems to be broken by this upgrade. See #30417.",
    "created_at": "2020-08-21T20:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439235",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:79" align="right">comment:79</div>

Preparsing multi-line strings also seems to be broken by this upgrade. See #30417.



---

archive/issue_comments_439236.json:
```json
{
    "body": "Changed author from **Jonathan Kliem, \u200bJohn Palmieri, Antonio Rojas** to **Jonathan Kliem, John Palmieri, Antonio Rojas**",
    "created_at": "2020-10-24T20:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439236",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Jonathan Kliem, John Palmieri, Antonio Rojas** to **Jonathan Kliem, John Palmieri, Antonio Rojas**



---

archive/issue_comments_439237.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nSee #30928 for a possible follow-up.",
    "created_at": "2020-11-17T08:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/28197",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/28197#issuecomment-439237",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:81" align="right">comment:81</div>

See #30928 for a possible follow-up.
