# Issue 28011: Add .boundary_complex() method for simplicial polytopes

Issue created by migration from https://trac.sagemath.org/ticket/28248

Original creator: jipilab

Original creation time: 2019-07-24 14:01:14

CC:  @laisrast @kliem tscrim jpalmieri

Keywords: polytopes, simplicial complex, days100

The boundary of polytopes are nice and relatively well-behaved cell complexes.

When the polytope is simplicial, its boundary is a simplicial complex. This ticket implements a method to return that simplicial complex.


---

Comment by jipilab created at 2019-07-24 15:38:14

Changing status from new to needs_review.


---

Comment by git created at 2019-07-24 16:15:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @LaisRast created at 2019-07-26 09:02:51

Changing status from needs_review to needs_work.


---

Comment by @LaisRast created at 2019-07-26 09:02:51

Since you only need the combinatorial data of the polytope, it would be much faster to use the `.incidence_matrix()` instead of the `.faces()` (or `facets()` here).
(You can see the difference, for instance, clearly if you take the dual of the 7-permutahedron)


---

Comment by @kliem created at 2019-07-26 09:30:00

Replying to [comment:5 gh-LaisRast]:
> Since you only need the combinatorial data of the polytope, it would be much faster to use the `.incidence_matrix()` instead of the `.faces()` (or `facets()` here).
> (You can see the difference, for instance, clearly if you take the dual of the 7-

The difference will only be minor, once #27063 is done.
It's still going to be faster to just take the incidence matrix, but not by much.

Try it out `tuple(CombinatorialPolyhedron(P).face_iter(P.dimension()-1))` vs `P.incidence_matrix()`.

Be aware that the incidence matrix is cashed.


---

Comment by @LaisRast created at 2019-07-26 12:04:03

Replying to [comment:6 gh-kliem]:
> Replying to [comment:5 gh-LaisRast]:
> > Since you only need the combinatorial data of the polytope, it would be much faster to use the `.incidence_matrix()` instead of the `.faces()` (or `facets()` here).
> > (You can see the difference, for instance, clearly if you take the dual of the 7-
> 
> The difference will only be minor, once #27063 is done.
> It's still going to be faster to just take the incidence matrix, but not by much.
> 
> Try it out `tuple(CombinatorialPolyhedron(P).face_iter(P.dimension()-1))` vs `P.incidence_matrix()`.
> 
> Be aware that the incidence matrix is cashed.

Actually no. Running `CombinatorialPolyhedron(P)` will compute the incidence matrix of `P` to initialize the `CombinatorialPolyhedron`.
`P.incidence_matrix()` is still far faster.


---

Comment by @kliem created at 2019-07-26 12:19:22

I know that it will compute the incidence matrix anyway.
However, I disagree that it is far faster.
Almost all the time initializing `CombinatorialPolyhedron` is spent on the incidence matrix.
To obtain all the facets (in `CombinatorialPolyhedron`) is really quick, because there is nothing to compute anymore.

Overall, I don't think your suggested change is going to make a big difference (yes it will be slightly faster).


---

Comment by @LaisRast created at 2019-07-26 13:15:43

Replying to [comment:8 gh-kliem]:
> I know that it will compute the incidence matrix anyway.
> However, I disagree that it is far faster.
> Almost all the time initializing `CombinatorialPolyhedron` is spent on the incidence matrix.
> To obtain all the facets (in `CombinatorialPolyhedron`) is really quick, because there is nothing to compute anymore.
> 
> Overall, I don't think your suggested change is going to make a big difference (yes it will be slightly faster).


For the `Polyhedron` class (which this method is implemented for), you can see that there is a big difference.

For your suggested method:

```
sage: P = polytopes.permutahedron(7)
sage: %time I = P.incidence_matrix()
CPU times: user 2.85 s, sys: 72.4 ms, total: 2.92 s
Wall time: 2.83 s
```



```
sage: Q = polytopes.permutahedron(7)
sage: %time I = tuple(CombinatorialPolyhedron(Q).face_iter(Q.dimension()-1))
CPU times: user 3.99 s, sys: 287 ms, total: 4.28 s
Wall time: 3.98 s
```

My suggested change is still faster since it computes less.

Anyway, since #27063 is not yet done, and since the class is `Polyhedron`, there **is** a big difference in using the `incidence_matrix` instead of `faces`.


---

Comment by jipilab created at 2019-07-28 11:04:19

Replying to [comment:9 gh-LaisRast]:
> Replying to [comment:8 gh-kliem]:
> > I know that it will compute the incidence matrix anyway.
> > However, I disagree that it is far faster.
> > Almost all the time initializing `CombinatorialPolyhedron` is spent on the incidence matrix.
> > To obtain all the facets (in `CombinatorialPolyhedron`) is really quick, because there is nothing to compute anymore.
> > 
> > Overall, I don't think your suggested change is going to make a big difference (yes it will be slightly faster).
> 
> 
> For the `Polyhedron` class (which this method is implemented for), you can see that there is a big difference.
> 
> For your suggested method:
> {{{
> sage: P = polytopes.permutahedron(7)
> sage: %time I = P.incidence_matrix()
> CPU times: user 2.85 s, sys: 72.4 ms, total: 2.92 s
> Wall time: 2.83 s
> }}}
> 
> {{{
> sage: Q = polytopes.permutahedron(7)
> sage: %time I = tuple(CombinatorialPolyhedron(Q).face_iter(Q.dimension()-1))
> CPU times: user 3.99 s, sys: 287 ms, total: 4.28 s
> Wall time: 3.98 s
> }}}
> My suggested change is still faster since it computes less.
> 
> Anyway, since #27063 is not yet done, and since the class is `Polyhedron`, there **is** a big difference in using the `incidence_matrix` instead of `faces`.
+1

I will replace to incidence_matrix. Once #27063 is done, the discussion may resume and check what is best, for now, `incidence_matrix` does the job.


---

Comment by git created at 2019-07-28 11:26:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2019-07-28 11:26:56

Changing status from needs_work to needs_review.


---

Comment by @LaisRast created at 2019-07-28 20:29:24

Changing status from needs_review to positive_review.


---

Comment by @LaisRast created at 2019-07-28 20:29:24

Beside the implementaion of `facets` method, which is going to be taken care of in #27974, the code looks good to me. The tests seem to pass on my machine and on the patchbot. Thus, I will consider this as a positive review.


---

Comment by jipilab created at 2019-09-11 07:04:49

There's a small conflict due to the facets methods. I'll fix it.


---

Comment by jipilab created at 2019-09-11 07:04:56

Changing status from positive_review to needs_work.


---

Comment by jipilab created at 2019-09-12 06:36:55

Changing status from needs_work to needs_review.


---

Comment by jipilab created at 2019-09-12 06:36:55

New commits:


---

Comment by jipilab created at 2019-09-12 06:37:26

Rebased on sage8.9.rc0 and fixed conflict.


---

Comment by @LaisRast created at 2019-09-12 09:34:34

Since the conflict is now resolved, I will put the ticket on positive review again.


---

Comment by @LaisRast created at 2019-09-12 09:34:34

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-09-30 08:12:27

moving milestone to 9.0 (after release of 8.9)


---

Comment by vbraun created at 2019-10-03 17:58:02

Resolution: fixed
