# Issue 30030: Coercion via restriction of chart functions

Issue created by migration from https://trac.sagemath.org/ticket/30267

Original creator: @mjungmath

Original creation time: 2020-08-01 21:20:42

CC:  egourgoulhon tscrim

At this stage, scalar fields (and tensor fields) support coercions via restrictions:


```
sage: M = Manifold(2, 'M')
sage: c.<x,y> = M.chart()
sage: D = M.open_subset('D')
sage: A = M.scalar_field_algebra(); A_D = D.scalar_field_algebra()
sage: A_D.has_coerce_map_from(A)
True
```


But the chart function ring does not support that coercion, even for derived charts:


```
sage: c_D = c.restrict(D, x^2+y^2<1)
sage: R = c.function_ring(); R_D = c_D.function_ring()
sage: R_D.has_coerce_map_from(R)
False
```


Consequently, this should be treated the same way as scalar fields since chart functions are the very foundation of scalar fields.

I suggest we add that coercion in case one chart (here `c_D`) is the restriction of the other (here `c`).


---

Comment by @mjungmath created at 2020-08-01 22:09:34

Changing status from new to needs_review.


---

Comment by git created at 2020-08-01 22:23:27

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2020-08-02 05:59:49

LGTM.


---

Comment by tscrim created at 2020-08-02 05:59:49

Changing status from needs_review to positive_review.


---

Comment by @mjungmath created at 2020-08-02 07:13:09

Thanks.


---

Comment by egourgoulhon created at 2020-08-02 08:10:16

Thanks for this ticket.
May I suggest to correct a typo:

```diff
-    The ring of all chart function w.r.t. to a chart::
+    The ring of all chart functions w.r.t. to a chart::
```



---

Comment by git created at 2020-08-02 09:29:54

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-08-02 09:29:54

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @mjungmath created at 2020-08-02 09:30:14

Replying to [comment:6 egourgoulhon]:
> Thanks for this ticket.
> May I suggest to correct a typo:
> {{{#!diff
> -    The ring of all chart function w.r.t. to a chart::
> +    The ring of all chart functions w.r.t. to a chart::
> }}}

Done. Thank you.


---

Comment by tscrim created at 2020-08-02 09:48:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-08-07 19:05:40

Resolution: fixed
