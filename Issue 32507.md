# Issue 32507: composite elliptic-curve isogenies

Issue created by migration from https://trac.sagemath.org/ticket/32744

Original creator: lorenz

Original creation time: 2021-10-23 05:29:46

CC:  defeo cremona davidloeffler

(placeholder)


---

Comment by lorenz created at 2021-10-23 05:54:28

Changing status from new to needs_review.


---

Comment by git created at 2021-10-29 05:38:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-10-30 03:25:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-10-30 03:44:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2021-12-17 07:37:17

I've been using this code privately for a while now and it's very useful to me. I'm sure it would also be useful to others who work on similar things, so I think it would be really nice to get this into the 9.5 release. Can I convince anyone to review?

(To reemphasize, the code in this ticket is marked experimental and explicitly opt-in. The changes in the dependency #32502 should be strictly backwards compatible as well. Therefore, applying this shouldn't cause any real harm even if things are terribly broken.)


---

Comment by cremona created at 2021-12-17 10:30:15

I am looking at it right now.  If I do have suggestions, I'll try hard to make it so that they can be implemented in a later ticket.  Thanks for doing this.


---

Comment by cremona created at 2021-12-17 10:50:57

In the richcmp method, the code for curves over number fields does not do what the docstring says, and as written returns True/False if for just one point of infinite order (defined over the base field or a quadratic extension) the maps have the same image.  I don't think this is what is intended.

How about: test a whole lot of random points, return False if they disagree on any, otherwise (if all the points pass this) do the harder work of comparing rational maps.  I think the number of points to test should depend on the degree, 100 is rather overkill since over number fields it is very unlikely to see large degrees (the record in the LMFDB now is 147, see http://www.lmfdb.org/EllipticCurve/6.6.453789.1/1.1/a/).  I should 10 would be plenty (before reverting to the exact test).

Task for the future: in computing the isogeny class C of an elliptic curve E over QQ, or over a number field, I only use prime degree isogenies, so while C.matrix() shows the full matrix of all pairwise degrees, C.isogenies() has a 0 (just a placeholder) in position (i,j) when the isogeny from the i'th to the j'th curve is not of prime degree.  Using this new functionality we'll be able to fill those in too.  But not on this ticket.


---

Comment by lorenz created at 2021-12-17 12:26:43

Thank you, John!

Replying to [comment:9 cremona]:
> In the richcmp method, the code for curves over number fields does not do what the docstring says, and as written returns True/False if for just one point of infinite order (defined over the base field or a quadratic extension) the maps have the same image.  I don't think this is what is intended.

My reasoning was that the isogenies `f,g` to be compared are both group homomorphisms, hence if they agree on a single point `P` of infinite order, this extends to the entire subgroup generated by that point. Therefore, the difference `f-g` has infinite kernel (containing `<P>`), which implies `f-g = 0` since (non-zero) isogenies have finite kernel by definition. Is this incorrect?


---

Comment by cremona created at 2021-12-17 14:04:34

Your are certainly right, apologies for not seeing that. I had thought that you were avoiding points of finite order just to stay away from the kernel.  It would have been nice to have had a comment to the effect that "if two isogenies agree on a point of infinite order then they must be equal", just as you explained, but never mind.


---

Comment by cremona created at 2021-12-17 14:04:34

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2021-12-17 14:04:34

Changing keywords from "" to "elliptic curve isogenies".


---

Comment by lorenz created at 2021-12-18 03:44:38

Thanks a lot for your time!

One question: Did you look at the entire diff including #32502, or just the changes made on top of #32502? In the first case, I think you can also set #32502 to "positive review".


---

Comment by cremona created at 2021-12-18 12:35:47

I only looked at the diffs for this ticket.  So I will go and look at the dependent ticket #32502 as well (probably not today though).


---

Comment by vbraun created at 2022-01-12 17:17:36

Resolution: fixed
