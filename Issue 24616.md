# Issue 24616: substitution into polynomials over SR broken

archive/issues_024616.json:
```json
{
    "body": "CC:  @rwst @mezzarobba\n\n\n```\nsage: R.<r>=SR[]\nsage: R\nUnivariate Polynomial Ring in r over Symbolic Ring\nsage: p=r^2-1\nsage: p(1)\nException RuntimeError: 'maximum recursion depth exceeded while calling a Python object' in <type 'exceptions.RuntimeError'> ignored\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-44-4c09f14dea4d> in <module>()\n----> 1 p(Integer(1))\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_element.pyx in sage.rings.polynomial.polynomial_element.Polynomial.__call__ (build/cythonized/sage/rings/polynomial/polynomial_element.c:9535)()\n    787         elif hasattr(a, \"_evaluate_polynomial\"):\n    788             try:\n--> 789                 return a._evaluate_polynomial(pol)\n    790             except NotImplementedError:\n    791                 pass\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._evaluate_polynomial (build/cythonized/sage/symbolic/expression.cpp:45786)()\n   7458         cdef Expression zero\n   7459         try:\n-> 7460             return new_Expression_from_pyobject(self._parent, pol(self.pyobject()))\n   7461         except TypeError:\n   7462             zero = self._parent.zero()\n\n... last 2 frames repeated, from the frame below ...\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_element.pyx in sage.rings.polynomial.polynomial_element.Polynomial.__call__ (build/cythonized/sage/rings/polynomial/polynomial_element.c:9535)()\n    787         elif hasattr(a, \"_evaluate_polynomial\"):\n    788             try:\n--> 789                 return a._evaluate_polynomial(pol)\n    790             except NotImplementedError:\n    791                 pass\n\nRuntimeError: maximum recursion depth exceeded while calling a Python object\n```\n\n\nsee also sage-support [here](https://groups.google.com/d/msg/sage-support/pcp_Mh65Fvk/U6Qhy_dpAgAJ)\n\nIssue created by migration from https://trac.sagemath.org/ticket/24853\n\n",
    "created_at": "2018-02-27T09:58:07Z",
    "labels": [
        "symbolics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "substitution into polynomials over SR broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24616",
    "user": "@dimpase"
}
```
CC:  @rwst @mezzarobba


```
sage: R.<r>=SR[]
sage: R
Univariate Polynomial Ring in r over Symbolic Ring
sage: p=r^2-1
sage: p(1)
Exception RuntimeError: 'maximum recursion depth exceeded while calling a Python object' in <type 'exceptions.RuntimeError'> ignored
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-44-4c09f14dea4d> in <module>()
----> 1 p(Integer(1))

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_element.pyx in sage.rings.polynomial.polynomial_element.Polynomial.__call__ (build/cythonized/sage/rings/polynomial/polynomial_element.c:9535)()
    787         elif hasattr(a, "_evaluate_polynomial"):
    788             try:
--> 789                 return a._evaluate_polynomial(pol)
    790             except NotImplementedError:
    791                 pass

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._evaluate_polynomial (build/cythonized/sage/symbolic/expression.cpp:45786)()
   7458         cdef Expression zero
   7459         try:
-> 7460             return new_Expression_from_pyobject(self._parent, pol(self.pyobject()))
   7461         except TypeError:
   7462             zero = self._parent.zero()

... last 2 frames repeated, from the frame below ...

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_element.pyx in sage.rings.polynomial.polynomial_element.Polynomial.__call__ (build/cythonized/sage/rings/polynomial/polynomial_element.c:9535)()
    787         elif hasattr(a, "_evaluate_polynomial"):
    788             try:
--> 789                 return a._evaluate_polynomial(pol)
    790             except NotImplementedError:
    791                 pass

RuntimeError: maximum recursion depth exceeded while calling a Python object
```


see also sage-support [here](https://groups.google.com/d/msg/sage-support/pcp_Mh65Fvk/U6Qhy_dpAgAJ)

Issue created by migration from https://trac.sagemath.org/ticket/24853





---

archive/issue_comments_345325.json:
```json
{
    "body": "`p.__call__` calls `SR(1)._evaluate_polynomial`:\n\n```\n        /* \"sage/rings/polynomial/polynomial_element.pyx\":790\n *         elif hasattr(a, \"_evaluate_polynomial\"):\n *             try:\n *                 return a._evaluate_polynomial(pol)             # <<<<<<<<<<<<<<\n *             except NotImplementedError:\n *                 pass\n */\n```\n\nand `SR(1)._evaluate_polynomial` calls `p(SR(1))`:\n\n```\n  /* \"sage/symbolic/expression.pyx\":7459\n *         \"\"\"\n *         cdef Expression zero\n *         try:             # <<<<<<<<<<<<<<\n *             return new_Expression_from_pyobject(self._parent, pol(self.pyobject()))\n *         except TypeError:\n */\n```\n",
    "created_at": "2018-02-27T15:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345325",
    "user": "@rwst"
}
```

`p.__call__` calls `SR(1)._evaluate_polynomial`:

```
        /* "sage/rings/polynomial/polynomial_element.pyx":790
 *         elif hasattr(a, "_evaluate_polynomial"):
 *             try:
 *                 return a._evaluate_polynomial(pol)             # <<<<<<<<<<<<<<
 *             except NotImplementedError:
 *                 pass
 */
```

and `SR(1)._evaluate_polynomial` calls `p(SR(1))`:

```
  /* "sage/symbolic/expression.pyx":7459
 *         """
 *         cdef Expression zero
 *         try:             # <<<<<<<<<<<<<<
 *             return new_Expression_from_pyobject(self._parent, pol(self.pyobject()))
 *         except TypeError:
 */
```




---

archive/issue_comments_345326.json:
```json
{
    "body": "The changes came here:\n\n```\ncommit 03e86910b66e18bc652b918a1ad8e2892ac04004\nAuthor: Marc Mezzarobba <marc@mezzarobba.net>\nDate:   Wed Jan 11 12:18:50 2017 +0100\n\n    speed up generic Polynomial.__call__()\n```\n",
    "created_at": "2018-02-27T15:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345326",
    "user": "@rwst"
}
```

The changes came here:

```
commit 03e86910b66e18bc652b918a1ad8e2892ac04004
Author: Marc Mezzarobba <marc@mezzarobba.net>
Date:   Wed Jan 11 12:18:50 2017 +0100

    speed up generic Polynomial.__call__()
```




---

archive/issue_comments_345327.json:
```json
{
    "body": "Changing component from symbolics to commutative algebra.",
    "created_at": "2018-02-27T15:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345327",
    "user": "@rwst"
}
```

Changing component from symbolics to commutative algebra.



---

archive/issue_comments_345328.json:
```json
{
    "body": "Maybe instead of `pol(self.pyobject())` `parent(pol)(self.pyobject())` was meant?",
    "created_at": "2018-02-27T15:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345328",
    "user": "@rwst"
}
```

Maybe instead of `pol(self.pyobject())` `parent(pol)(self.pyobject())` was meant?



---

archive/issue_comments_345329.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-27T16:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345329",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_345330.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-27T16:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345330",
    "user": "@rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_345331.json:
```json
{
    "body": "This also fixes doctests that were wrong IMHO.\n\nFinally, I still see a half-second delay when doing the first `R.<r>=SR[]; (r^2-1)(1)`.",
    "created_at": "2018-02-27T16:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345331",
    "user": "@rwst"
}
```

This also fixes doctests that were wrong IMHO.

Finally, I still see a half-second delay when doing the first `R.<r>=SR[]; (r^2-1)(1)`.



---

archive/issue_comments_345332.json:
```json
{
    "body": "Replying to [comment:7 rws]:\n\n> Finally, I still see a half-second delay when doing the first `R.<r>=SR[]; (r^2-1)(1)`.\nSomething big is getting loaded, perhaps Maxima?",
    "created_at": "2018-02-27T18:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345332",
    "user": "@dimpase"
}
```

Replying to [comment:7 rws]:

> Finally, I still see a half-second delay when doing the first `R.<r>=SR[]; (r^2-1)(1)`.
Something big is getting loaded, perhaps Maxima?



---

archive/issue_comments_345333.json:
```json
{
    "body": "Polynomials over `SR` really make no sense in the first place.",
    "created_at": "2018-02-27T19:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345333",
    "user": "@jdemeyer"
}
```

Polynomials over `SR` really make no sense in the first place.



---

archive/issue_comments_345334.json:
```json
{
    "body": "Replying to [comment:9 jdemeyer]:\n> Polynomials over `SR` really make no sense in the first place.\n\n`charpoly` of a symbolic matrix should return a symbolic polynomial?",
    "created_at": "2018-02-28T07:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345334",
    "user": "@rwst"
}
```

Replying to [comment:9 jdemeyer]:
> Polynomials over `SR` really make no sense in the first place.

`charpoly` of a symbolic matrix should return a symbolic polynomial?



---

archive/issue_comments_345335.json:
```json
{
    "body": "Replying to [comment:2 rws]:\n> The changes came here:\n> {{{\n> commit 03e86910b66e18bc652b918a1ad8e2892ac04004\n> Author: Marc Mezzarobba <marc`@`mezzarobba.net>\n> Date:   Wed Jan 11 12:18:50 2017 +0100\n> \n>     speed up generic Polynomial.__call__()\n> }}}\n\nYes and no: this commit (and, perhaps more importantly, 84d6a1b874c) mainly reorganize the code, without changing its semantics much...\n\nReplying to [comment:4 rws]:\n> Maybe instead of `pol(self.pyobject())` `parent(pol)(self.pyobject())` was meant?\n\n...But I doubt that. Wouldn't something like (not tested)\n\n\n```\nif pol.parent() is not SR:\n    try:\n        return new_Expression_from_pyobject(self._parent, pol(self.pyobject()))\n    except TypeError:\n        pass\nzero = self._parent.zero()\nreturn zero.add(*(pol[i]*self**i for i in xrange(pol.degree() + 1)))\n```\n\n\nmake more sense?\n\nReplying to [comment:7 rws]:\n> This also fixes doctests that were wrong IMHO.\n\nWhile I have no strong opinion about\n\n```\n             sage: f(pi)\n-            1.00000000000000*pi^2 - 2.00000000000000\n-\n+            7.86960440108936\n```\n\nI really don't see why you would want this:\n\n```\n             sage: SR(0.1)._evaluate_polynomial(pol)\n-            0.123400000000000\n+            617/5000\n```\n",
    "created_at": "2018-02-28T09:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345335",
    "user": "@mezzarobba"
}
```

Replying to [comment:2 rws]:
> The changes came here:
> {{{
> commit 03e86910b66e18bc652b918a1ad8e2892ac04004
> Author: Marc Mezzarobba <marc`@`mezzarobba.net>
> Date:   Wed Jan 11 12:18:50 2017 +0100
> 
>     speed up generic Polynomial.__call__()
> }}}

Yes and no: this commit (and, perhaps more importantly, 84d6a1b874c) mainly reorganize the code, without changing its semantics much...

Replying to [comment:4 rws]:
> Maybe instead of `pol(self.pyobject())` `parent(pol)(self.pyobject())` was meant?

...But I doubt that. Wouldn't something like (not tested)


```
if pol.parent() is not SR:
    try:
        return new_Expression_from_pyobject(self._parent, pol(self.pyobject()))
    except TypeError:
        pass
zero = self._parent.zero()
return zero.add(*(pol[i]*self**i for i in xrange(pol.degree() + 1)))
```


make more sense?

Replying to [comment:7 rws]:
> This also fixes doctests that were wrong IMHO.

While I have no strong opinion about

```
             sage: f(pi)
-            1.00000000000000*pi^2 - 2.00000000000000
-
+            7.86960440108936
```

I really don't see why you would want this:

```
             sage: SR(0.1)._evaluate_polynomial(pol)
-            0.123400000000000
+            617/5000
```




---

archive/issue_comments_345336.json:
```json
{
    "body": "Replying to [comment:9 jdemeyer]:\n> Polynomials over `SR` really make no sense in the first place.\n\nWhy? I agree with Ralf here, characteristic polynomials of symbolic matrices are a good example.",
    "created_at": "2018-02-28T09:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345336",
    "user": "@mezzarobba"
}
```

Replying to [comment:9 jdemeyer]:
> Polynomials over `SR` really make no sense in the first place.

Why? I agree with Ralf here, characteristic polynomials of symbolic matrices are a good example.



---

archive/issue_comments_345337.json:
```json
{
    "body": "Replying to [comment:11 mmezzarobba]:\n> I really don't see why you would want this:\n> {{{\n>              sage: SR(0.1)._evaluate_polynomial(pol)\n> -            0.123400000000000\n> +            617/5000\n> }}}\n\nBecause `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.\n\nReplying to [comment:12 mmezzarobba]:\n> Replying to [comment:9 jdemeyer]:\n> > Polynomials over `SR` really make no sense in the first place.\n> \n> Why? I agree with Ralf here, characteristic polynomials of symbolic matrices are a good example.\n\nDon't misunderstand me, my comment was not a rethorical question. I'm ready to change what's returned from charpoly() to an expression.",
    "created_at": "2018-02-28T09:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345337",
    "user": "@rwst"
}
```

Replying to [comment:11 mmezzarobba]:
> I really don't see why you would want this:
> {{{
>              sage: SR(0.1)._evaluate_polynomial(pol)
> -            0.123400000000000
> +            617/5000
> }}}

Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.

Replying to [comment:12 mmezzarobba]:
> Replying to [comment:9 jdemeyer]:
> > Polynomials over `SR` really make no sense in the first place.
> 
> Why? I agree with Ralf here, characteristic polynomials of symbolic matrices are a good example.

Don't misunderstand me, my comment was not a rethorical question. I'm ready to change what's returned from charpoly() to an expression.



---

archive/issue_comments_345338.json:
```json
{
    "body": "Replying to [comment:11 mmezzarobba]:\n> make more sense?\n\nPlease go ahead.",
    "created_at": "2018-02-28T09:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345338",
    "user": "@rwst"
}
```

Replying to [comment:11 mmezzarobba]:
> make more sense?

Please go ahead.



---

archive/issue_comments_345339.json:
```json
{
    "body": "Replying to [comment:13 rws]:\n> Replying to [comment:11 mmezzarobba]:\n> > I really don't see why you would want this:\n> > {{{\n> >              sage: SR(0.1)._evaluate_polynomial(pol)\n> > -            0.123400000000000\n> > +            617/5000\n> > }}}\n> \n> Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.\n> \n> Replying to [comment:12 mmezzarobba]:\n> > Replying to [comment:9 jdemeyer]:\n> > > Polynomials over `SR` really make no sense in the first place.\n> > \n> > Why? I agree with Ralf here, characteristic polynomials of symbolic matrices are a good example.\n> \n> Don't misunderstand me, my comment was not a rethorical question. I'm ready to change what's returned from charpoly() to an expression.\n\nI would not try to force this onto the user - this conversion is easy.\n\nI also do not understand why having polynomials over `SR` makes no sense; well, it might be so in an ideal world where `SR` can seamlessly discover polynomial structures in expressions and operate accordingly, but this is not the case I think.",
    "created_at": "2018-02-28T10:41:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345339",
    "user": "@dimpase"
}
```

Replying to [comment:13 rws]:
> Replying to [comment:11 mmezzarobba]:
> > I really don't see why you would want this:
> > {{{
> >              sage: SR(0.1)._evaluate_polynomial(pol)
> > -            0.123400000000000
> > +            617/5000
> > }}}
> 
> Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.
> 
> Replying to [comment:12 mmezzarobba]:
> > Replying to [comment:9 jdemeyer]:
> > > Polynomials over `SR` really make no sense in the first place.
> > 
> > Why? I agree with Ralf here, characteristic polynomials of symbolic matrices are a good example.
> 
> Don't misunderstand me, my comment was not a rethorical question. I'm ready to change what's returned from charpoly() to an expression.

I would not try to force this onto the user - this conversion is easy.

I also do not understand why having polynomials over `SR` makes no sense; well, it might be so in an ideal world where `SR` can seamlessly discover polynomial structures in expressions and operate accordingly, but this is not the case I think.



---

archive/issue_comments_345340.json:
```json
{
    "body": "Replying to [comment:13 rws]:\n> Replying to [comment:11 mmezzarobba]:\n> > I really don't see why you would want this:\n> > {{{\n> >              sage: SR(0.1)._evaluate_polynomial(pol)\n> > -            0.123400000000000\n> > +            617/5000\n> > }}}\n> \n> Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.\n\nI think I don't understand what you mean, sorry. First, `QQ(0.1)` is 1/10, but there is no coercion from `RR` to `QQ` so this doesn't mean anything, and `(0.1).exact_rational()` is `3602879701896397/36028797018963968`. Second, even 0.1 \u201cwas\u201d 1/10 in some stronger sense, I don't see why polynomial evaluation would want to convert the argument to the polynomial's base ring (outside symbolics, `Polynomial.__call__()` returns an element of the pushout of the base ring and the evaluation point, which does the right thing in every(?) case).",
    "created_at": "2018-03-06T16:29:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345340",
    "user": "@mezzarobba"
}
```

Replying to [comment:13 rws]:
> Replying to [comment:11 mmezzarobba]:
> > I really don't see why you would want this:
> > {{{
> >              sage: SR(0.1)._evaluate_polynomial(pol)
> > -            0.123400000000000
> > +            617/5000
> > }}}
> 
> Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.

I think I don't understand what you mean, sorry. First, `QQ(0.1)` is 1/10, but there is no coercion from `RR` to `QQ` so this doesn't mean anything, and `(0.1).exact_rational()` is `3602879701896397/36028797018963968`. Second, even 0.1 “was” 1/10 in some stronger sense, I don't see why polynomial evaluation would want to convert the argument to the polynomial's base ring (outside symbolics, `Polynomial.__call__()` returns an element of the pushout of the base ring and the evaluation point, which does the right thing in every(?) case).



---

archive/issue_comments_345341.json:
```json
{
    "body": "Replying to [comment:16 mmezzarobba]:\n> Replying to [comment:13 rws]:\n> > Replying to [comment:11 mmezzarobba]:\n> > > I really don't see why you would want this:\n> > > {{{\n> > >              sage: SR(0.1)._evaluate_polynomial(pol)\n> > > -            0.123400000000000\n> > > +            617/5000\n> > > }}}\n> > \n> > Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.\n> \n> I think I don't understand what you mean, sorry. First, `QQ(0.1)` is 1/10, but there is no coercion from `RR` to `QQ` so this doesn't mean anything, and `(0.1).exact_rational()` is `3602879701896397/36028797018963968`. Second, even 0.1 \u201cwas\u201d 1/10 in some stronger sense, I don't see why polynomial evaluation would want to convert the argument to the polynomial's base ring (outside symbolics, `Polynomial.__call__()` returns an element of the pushout of the base ring and the evaluation point, which does the right thing in every(?) case).\n\nI fully agree with Marc here (see laso the related discussion at #24939). If there is **any** floating point number in the polynomial, then the output can never be an exact number (including elements of QQ, AA, QQbar as well as exact constants such as pi, e, etc, arctan(2)).",
    "created_at": "2018-03-10T15:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345341",
    "user": "@videlec"
}
```

Replying to [comment:16 mmezzarobba]:
> Replying to [comment:13 rws]:
> > Replying to [comment:11 mmezzarobba]:
> > > I really don't see why you would want this:
> > > {{{
> > >              sage: SR(0.1)._evaluate_polynomial(pol)
> > > -            0.123400000000000
> > > +            617/5000
> > > }}}
> > 
> > Because `pol` is a `QQ[]` and `QQ(0.1)` is `1/10` of course.
> 
> I think I don't understand what you mean, sorry. First, `QQ(0.1)` is 1/10, but there is no coercion from `RR` to `QQ` so this doesn't mean anything, and `(0.1).exact_rational()` is `3602879701896397/36028797018963968`. Second, even 0.1 “was” 1/10 in some stronger sense, I don't see why polynomial evaluation would want to convert the argument to the polynomial's base ring (outside symbolics, `Polynomial.__call__()` returns an element of the pushout of the base ring and the evaluation point, which does the right thing in every(?) case).

I fully agree with Marc here (see laso the related discussion at #24939). If there is **any** floating point number in the polynomial, then the output can never be an exact number (including elements of QQ, AA, QQbar as well as exact constants such as pi, e, etc, arctan(2)).



---

archive/issue_comments_345342.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-10T15:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345342",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_345343.json:
```json
{
    "body": "I think who introduced the bug should also fix it.",
    "created_at": "2018-03-10T15:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345343",
    "user": "@rwst"
}
```

I think who introduced the bug should also fix it.



---

archive/issue_comments_345344.json:
```json
{
    "body": "I have no idea who introduced the bug, but here is a possible fix that makes sense to me.",
    "created_at": "2018-03-10T16:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345344",
    "user": "@mezzarobba"
}
```

I have no idea who introduced the bug, but here is a possible fix that makes sense to me.



---

archive/issue_comments_345345.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-10T16:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345345",
    "user": "@mezzarobba"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_345346.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-10T16:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345346",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_345347.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-10T17:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345347",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_345348.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-19T14:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345348",
    "user": "@rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_345349.json:
```json
{
    "body": "Thanks. It's looking fine and patchbot has only the test_jupyter fail.",
    "created_at": "2018-03-19T14:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345349",
    "user": "@rwst"
}
```

Thanks. It's looking fine and patchbot has only the test_jupyter fail.



---

archive/issue_comments_345350.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-21T06:18:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24616#issuecomment-345350",
    "user": "@vbraun"
}
```

Resolution: fixed
