# Issue 23835: Segfault when multiplication between symbolic expr. and non-monic poly over finite field

archive/issues_023835.json:
```json
{
    "body": "Keywords: polynomial\n\nAs reported on [Ask](https://ask.sagemath.org/question/39204/segmentation-fault-when-multiplying-by-variable/), the following provokes a segmentation fault:\n\n\n```python\nsage: P.<x> = GF(3)[]\nsage: a = var('a')\nsage: sigma = 2*x + 1\nsage: a * sigma\nsegmentation fault\n```\n\n\nMy investigation gives the following conditions for the segfault:\n* Multiplication between an element of `SR` and `GF(p)['x']` ;\n* The polynomial is non monic, and has at least two nonzero terms.\n\nNote that converting the polynomial to `SR` beforehand yields the same error.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24072\n\n",
    "created_at": "2017-10-20T07:09:04Z",
    "labels": [
        "commutative algebra",
        "critical",
        "bug"
    ],
    "title": "Segfault when multiplication between symbolic expr. and non-monic poly over finite field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23835",
    "user": "bruno"
}
```
Keywords: polynomial

As reported on [Ask](https://ask.sagemath.org/question/39204/segmentation-fault-when-multiplying-by-variable/), the following provokes a segmentation fault:


```python
sage: P.<x> = GF(3)[]
sage: a = var('a')
sage: sigma = 2*x + 1
sage: a * sigma
segmentation fault
```


My investigation gives the following conditions for the segfault:
* Multiplication between an element of `SR` and `GF(p)['x']` ;
* The polynomial is non monic, and has at least two nonzero terms.

Note that converting the polynomial to `SR` beforehand yields the same error.

Issue created by migration from https://trac.sagemath.org/ticket/24072





---

archive/issue_comments_333863.json:
```json
{
    "body": "The real bug is that `SR(sigma)` succeeds (and returns something broken).\nIt should just fail, and then `*` will fail too, as it should.",
    "created_at": "2017-10-20T08:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333863",
    "user": "dimpase"
}
```

The real bug is that `SR(sigma)` succeeds (and returns something broken).
It should just fail, and then `*` will fail too, as it should.



---

archive/issue_comments_333864.json:
```json
{
    "body": "Changing keywords from \"polynomial\" to \"polynomial, symbolics\".",
    "created_at": "2017-10-20T19:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333864",
    "user": "vdelecroix"
}
```

Changing keywords from "polynomial" to "polynomial, symbolics".



---

archive/issue_comments_333865.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-21T09:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333865",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_333866.json:
```json
{
    "body": "A branch where SR does not accept anymore positive characteristic... let see what the patchbot has to say.\n----\nNew commits:",
    "created_at": "2017-10-21T09:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333866",
    "user": "vdelecroix"
}
```

A branch where SR does not accept anymore positive characteristic... let see what the patchbot has to say.
----
New commits:



---

archive/issue_comments_333867.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-21T11:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333867",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333868.json:
```json
{
    "body": "I think I fixed all doctests!",
    "created_at": "2017-10-21T11:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333868",
    "user": "vdelecroix"
}
```

I think I fixed all doctests!



---

archive/issue_comments_333869.json:
```json
{
    "body": "What a relief, thanks for your work.",
    "created_at": "2017-10-21T13:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333869",
    "user": "rws"
}
```

What a relief, thanks for your work.



---

archive/issue_comments_333870.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-21T13:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333870",
    "user": "rws"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333871.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-10-21T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333871",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_333872.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-10-21T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333872",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_333873.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-21T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333873",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333874.json:
```json
{
    "body": "A tiny change for py3 syntax (patchbot complaint). Setting back to positive review...",
    "created_at": "2017-10-21T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333874",
    "user": "vdelecroix"
}
```

A tiny change for py3 syntax (patchbot complaint). Setting back to positive review...



---

archive/issue_comments_333875.json:
```json
{
    "body": "Does this mean that #21391 can now be closed as duplicate?",
    "created_at": "2017-10-21T17:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333875",
    "user": "dimpase"
}
```

Does this mean that #21391 can now be closed as duplicate?



---

archive/issue_comments_333876.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-21T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333876",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_333877.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2017-10-21T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333877",
    "user": "vbraun"
}
```

Merge conflict



---

archive/issue_comments_333878.json:
```json
{
    "body": "Volker, can you provide more information?",
    "created_at": "2017-10-21T20:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333878",
    "user": "vdelecroix"
}
```

Volker, can you provide more information?



---

archive/issue_comments_333879.json:
```json
{
    "body": "Hmm, I guess, look at https://github.com/vbraun/sage/tree/develop ?",
    "created_at": "2017-10-21T20:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333879",
    "user": "dimpase"
}
```

Hmm, I guess, look at https://github.com/vbraun/sage/tree/develop ?



---

archive/issue_comments_333880.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-22T18:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333880",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_333881.json:
```json
{
    "body": "rebased on 8.1.beta9",
    "created_at": "2017-10-22T18:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333881",
    "user": "vdelecroix"
}
```

rebased on 8.1.beta9



---

archive/issue_comments_333882.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-22T18:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333882",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_333883.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-22T18:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333883",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_333884.json:
```json
{
    "body": "ping?",
    "created_at": "2017-10-23T19:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333884",
    "user": "vdelecroix"
}
```

ping?



---

archive/issue_comments_333885.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-23T22:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333885",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333886.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-29T10:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333886",
    "user": "vbraun"
}
```

Resolution: fixed
