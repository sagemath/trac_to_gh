# Issue 23835: Segfault when multiplication between symbolic expr. and non-monic poly over finite field

archive/issues_023835.json:
```json
{
    "body": "Keywords: polynomial\n\nAs reported on [Ask](https://ask.sagemath.org/question/39204/segmentation-fault-when-multiplying-by-variable/), the following provokes a segmentation fault:\n\n```python\nsage: P.<x> = GF(3)[]\nsage: a = var('a')\nsage: sigma = 2*x + 1\nsage: a * sigma\nsegmentation fault\n```\n\nMy investigation gives the following conditions for the segfault:\n* Multiplication between an element of `SR` and `GF(p)['x']` ;\n* The polynomial is non monic, and has at least two nonzero terms.\n\nNote that converting the polynomial to `SR` beforehand yields the same error.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24072\n\n",
    "created_at": "2017-10-20T07:09:04Z",
    "labels": [
        "component: commutative algebra",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Segfault when multiplication between symbolic expr. and non-monic poly over finite field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23835",
    "user": "https://github.com/bgrenet"
}
```
Keywords: polynomial

As reported on [Ask](https://ask.sagemath.org/question/39204/segmentation-fault-when-multiplying-by-variable/), the following provokes a segmentation fault:

```python
sage: P.<x> = GF(3)[]
sage: a = var('a')
sage: sigma = 2*x + 1
sage: a * sigma
segmentation fault
```

My investigation gives the following conditions for the segfault:
* Multiplication between an element of `SR` and `GF(p)['x']` ;
* The polynomial is non monic, and has at least two nonzero terms.

Note that converting the polynomial to `SR` beforehand yields the same error.

Issue created by migration from https://trac.sagemath.org/ticket/24072





---

archive/issue_comments_333488.json:
```json
{
    "body": "The real bug is that `SR(sigma)` succeeds (and returns something broken).\nIt should just fail, and then `*` will fail too, as it should.",
    "created_at": "2017-10-20T08:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333488",
    "user": "https://github.com/dimpase"
}
```

The real bug is that `SR(sigma)` succeeds (and returns something broken).
It should just fail, and then `*` will fail too, as it should.



---

archive/issue_comments_333489.json:
```json
{
    "body": "Changing keywords from \"polynomial\" to \"polynomial, symbolics\".",
    "created_at": "2017-10-20T19:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333489",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "polynomial" to "polynomial, symbolics".



---

archive/issue_comments_333490.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-21T09:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333490",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_333491.json:
```json
{
    "body": "A branch where SR does not accept anymore positive characteristic... let see what the patchbot has to say.\n\n---\nNew commits:",
    "created_at": "2017-10-21T09:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333491",
    "user": "https://github.com/videlec"
}
```

A branch where SR does not accept anymore positive characteristic... let see what the patchbot has to say.

---
New commits:



---

archive/issue_comments_333492.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-21T11:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333493.json:
```json
{
    "body": "I think I fixed all doctests!",
    "created_at": "2017-10-21T11:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333493",
    "user": "https://github.com/videlec"
}
```

I think I fixed all doctests!



---

archive/issue_comments_333494.json:
```json
{
    "body": "What a relief, thanks for your work.",
    "created_at": "2017-10-21T13:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333494",
    "user": "https://github.com/rwst"
}
```

What a relief, thanks for your work.



---

archive/issue_comments_333495.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-21T13:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333495",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333496.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-10-21T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333496",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_333497.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-10-21T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_333498.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-21T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333498",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333499.json:
```json
{
    "body": "A tiny change for py3 syntax (patchbot complaint). Setting back to positive review...",
    "created_at": "2017-10-21T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333499",
    "user": "https://github.com/videlec"
}
```

A tiny change for py3 syntax (patchbot complaint). Setting back to positive review...



---

archive/issue_comments_333500.json:
```json
{
    "body": "Does this mean that #21391 can now be closed as duplicate?",
    "created_at": "2017-10-21T17:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333500",
    "user": "https://github.com/dimpase"
}
```

Does this mean that #21391 can now be closed as duplicate?



---

archive/issue_comments_333501.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-21T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333501",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_333502.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2017-10-21T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333502",
    "user": "https://github.com/vbraun"
}
```

Merge conflict



---

archive/issue_comments_333503.json:
```json
{
    "body": "Volker, can you provide more information?",
    "created_at": "2017-10-21T20:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333503",
    "user": "https://github.com/videlec"
}
```

Volker, can you provide more information?



---

archive/issue_comments_333504.json:
```json
{
    "body": "Hmm, I guess, look at https://github.com/vbraun/sage/tree/develop ?",
    "created_at": "2017-10-21T20:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333504",
    "user": "https://github.com/dimpase"
}
```

Hmm, I guess, look at https://github.com/vbraun/sage/tree/develop ?



---

archive/issue_comments_333505.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-22T18:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_333506.json:
```json
{
    "body": "rebased on 8.1.beta9",
    "created_at": "2017-10-22T18:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333506",
    "user": "https://github.com/videlec"
}
```

rebased on 8.1.beta9



---

archive/issue_comments_333507.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-22T18:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333507",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_333508.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-22T18:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333508",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_333509.json:
```json
{
    "body": "ping?",
    "created_at": "2017-10-23T19:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333509",
    "user": "https://github.com/videlec"
}
```

ping?



---

archive/issue_comments_333510.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-23T22:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333510",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333511.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-29T10:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23835#issuecomment-333511",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_061145.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-29T10:32:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23835",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23835#event-61145"
}
```
