# Issue 25943: expose FriCAS as differential equation solver

Issue created by migration from https://trac.sagemath.org/ticket/26180

Original creator: mantepse

Original creation time: 2018-09-02 19:39:25

CC:  rws




---

Comment by mantepse created at 2018-09-02 19:42:16

Changing status from new to needs_review.


---

Comment by mantepse created at 2018-09-02 19:42:16

Changing component from PLEASE CHANGE to interfaces: optional.


---

Comment by mantepse created at 2018-09-02 19:42:16

New commits:


---

Comment by mantepse created at 2018-09-02 19:42:16

Changing keywords from "" to "FriCAS".


---

Comment by mantepse created at 2018-09-02 19:42:16

Changing type from PLEASE CHANGE to enhancement.


---

Comment by tscrim created at 2018-09-03 02:28:57

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2018-09-03 02:28:57

You should add the `algorithm` parameter to the `INPUT:` of `desolve` along with one or two examples using the FriCAS algorithm (remember that `desolve` is the main entry point). Also, I would change `TESTS:` to `EXAMPLES:` in `fricas_desolve` with a `TESTS:` block that direct calls `fricas_desolve`. LGTM other than those things.


---

Comment by git created at 2018-09-03 08:08:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2018-09-03 08:11:43

Mostly done.  I also exposed the system solver, however, I'm not sure whether I have to convert the output to what maxima returns.  Compare


```
        sage: t = var('t')
        sage: x = function('x')(t)
        sage: y = function('y')(t)
        sage: de1 = diff(x,t) + y - 1 == 0
        sage: de2 = diff(y,t) - x + 1 == 0
        sage: desolve_system([de1, de2], [x,y])
        [x(t) == (x(0) - 1)*cos(t) - (y(0) - 1)*sin(t) + 1,
         y(t) == (y(0) - 1)*cos(t) + (x(0) - 1)*sin(t) + 1]

    The same system solved using FriCAS::

        sage: desolve_system([de1, de2], [x,y], algorithm='fricas')             # optional - fricas
        {'basis': [(cos(t), sin(t)), (sin(t), -cos(t))],
         'particular': (cos(t)^2 + sin(t)^2, 1)}
```


(that `cos(t)^2 + sin(t)^2` is not simplified to 1 is a peculiarity of FriCAS)


---

Comment by mantepse created at 2018-09-03 08:13:16

Changing status from needs_work to needs_info.


---

Comment by tscrim created at 2018-09-03 11:23:36

A large part of me says yes because it is good to have consistent output and formatting. Another part says it is okay because you explicitly passed `algorithm='fricas'`, so it is okay to have different output. IMO, the FriCAS output is better conceptually, but it is not a direct function that you can immediately manipulate. I would probably err towards making it have a usual symbolic answer for the consistency.


---

Comment by git created at 2018-09-03 20:20:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2018-09-03 20:21:10

Changing status from needs_info to needs_review.


---

Comment by git created at 2018-09-03 20:27:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-09-03 20:30:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-09-08 11:25:30

I also made a few trivial documentation tweaks to bring it closer to the Sage conventions. If my changes are good, then positive review.
----
New commits:


---

Comment by mantepse created at 2018-09-08 16:57:57

Thanks!


---

Comment by mantepse created at 2018-09-08 16:57:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-09-08 21:12:10

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2018-09-08 21:12:10

I'm getting various errors of the form 

```
sage -t --long src/sage/calculus/desolvers.py
**********************************************************************
File "src/sage/calculus/desolvers.py", line 865, in sage.calculus.desolvers.desolve_system
Failed example:
    desolve_system([de1, de2], [x,y])
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 650, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1061, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.desolvers.desolve_system[5]>", line 1, in <module>
        desolve_system([de1, de2], [x,y])
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/calculus/desolvers.py", line 962, in desolve_system
        raise ValueError("unknown algorithm %s" % algorithm)
    ValueError: unknown algorithm None
**********************************************************************
```



---

Comment by git created at 2018-09-08 21:16:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-09-08 21:17:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-09-08 21:19:16

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2018-09-08 21:19:16

Mea culpa; I forgot to explicitly set the default `algorithm='maxima'` (and apparently forgot to test the file). Trivial fix and tests now pass, so I am allowing myself to set back to positive review.


---

Comment by vbraun created at 2018-09-10 19:15:08

Resolution: fixed
