# Issue 10778: Implemented discriminant for multivariate polynomials

Issue created by migration from https://trac.sagemath.org/ticket/10844

Original creator: mmarco

Original creation time: 2011-02-24 14:55:12

Assignee: AlexGhitza

Keywords: Polynomials Discriminant

This patch implements the .discriminant() method for polynomials which are handled by libsingular.


---

Attachment


---

Comment by dsm created at 2011-02-24 16:51:33

In docstring: The variable with respect we compute the discriminant -> "with respect to which"?

Error message when given the zero polynomial:


```
sage: R.<x,y> = QQ[]
sage: f = 0*x
sage: type(f)
<type 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular'>
sage: f.discriminant(x)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Applications/sage_devel/devel/sage-main/<ipython console> in <module>()

/Applications/sage_devel/local/lib/python2.6/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.discriminant (sage/rings/polynomial/multi_polynomial_libsingular.cpp:27499)()

/Applications/sage_devel/local/lib/python2.6/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.coefficient (sage/rings/polynomial/multi_polynomial_libsingular.cpp:16283)()

TypeError: The input degrees must be a dictionary of variables to exponents.
```



---

Attachment


---

Comment by mmarco created at 2011-02-25 11:07:04

Added a new patch (to be aplied over the first one). Solves the problems in the documentation and the zero element. It also solves the problem with the zero element for the univariate case.


---

Comment by spice created at 2011-03-25 00:28:09

I tried testing this patch (and its addendum) on sage 4.6.2, and this doctest failed:

```
sage: R.<x,y>=QQ[]                                                                                    
sage: f=x^5*y+3*x^2*y^2-2*x+y-1                                                                       
sage: f.discriminant(y)
x^10 + 2*x^5 + 24*x^3 + 12*x^2 + 1
sage: sage: f.polynomial(y).discriminant()
---------------------------------------------------------------------------
PariError                                 Traceback (most recent call last)

/Users/simonspicer/sage/devel/sage-Kimberly/<ipython console> in <module>()

/Users/simonspicer/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.discriminant (sage/rings/polynomial/polynomial_element.c:28533)()

/Users/simonspicer/sage/local/lib/python2.6/site-packages/sage/structure/element.so in sage.structure.element.NamedBinopMethod.__call__ (sage/structure/element.c:19623)()

/Users/simonspicer/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.resultant (sage/rings/polynomial/polynomial_element.c:28214)()

/Users/simonspicer/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial._pari_ (sage/rings/polynomial/polynomial_element.c:27630)()

/Users/simonspicer/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial._pari_with_name (sage/rings/polynomial/polynomial_element.c:27755)()

/Users/simonspicer/sage/local/lib/python2.6/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen._pari_trap (sage/libs/pari/gen.c:46023)()

PariError:  (5)
```


However, after applying patch #10799, which fixes `.resultant()` and `.discriminant()` for univariate polynomials over polynomial rings, the doctest passes. So I think that is more the PARI polynomial issue addressed in #10799.

I therefore suggest mentioning that #10844 is dependent on #10799. Also, you might need to recenter the patch, since both affect sage/polynomial/polynomial_element.pyx.

Contingent on applying the above patch first, the code checks out and passes all tests I threw at it. Once you've recentered it I can give it a positive review.

Simon


---

Comment by spice created at 2011-03-25 00:28:09

Changing status from new to needs_work.


---

Comment by mmarco created at 2011-03-25 11:17:05

Ok, i see what happened. I worked on both patches simultaneously, and that's why assumed that patch 10799 was aplied.

What do you mean by "recenter"?


---

Comment by spice created at 2011-03-25 17:17:37

Mercurial needed to do a bit of searching to apply the patch correctly, as due to #10799 the line numbers of sage/rings/polynomial/polynomial_element.pyx had all shifted by 2. By recenter I mean change trac_10844_solved_doc_and_zero.patch so that it applies cleanly without Mercurial having to do any extra work.

However, this could just be an issue on my machine (I was having one or two odd Mercurial issues that day, so it's possible). Do both patches apply cleanly for you?


---

Comment by mmarco created at 2011-03-31 14:51:13

Sorry for the delay in the answer. I have checked the patches on a clean sage branch, and didn't give any problem. I applied first the patch of #10799 and then the two ones of this ticket in the order they are listed.


---

Comment by spice created at 2011-03-31 15:39:23

Okay, I've retested and everything applies correctly. Clearly my PC was just having a bad hair day that day. Positive review :-)


---

Comment by spice created at 2011-03-31 15:39:23

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2011-04-13 19:44:59

Resolution: fixed
