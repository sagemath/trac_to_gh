# Issue 32106: Serre derivative for modular forms

Issue created by migration from https://trac.sagemath.org/ticket/32343

Original creator: @DavidAyotte

Original creation time: 2021-08-06 20:07:31

CC:  vdelecroix

Keywords: gsoc2021 modular forms serre derivative

This ticket implements the Serre derivative for modular forms. This derivative is defined by:

_theta(f) = (q * d/dq - (k/12) * E_2)(f) = (q * df/dq - (k/12) f E_2)_

where f is a modular form of weight _k_ (see also: https://hal.inria.fr/hal-01883058/document page 29, section 3.10), _q_ is the classical parameter at infinity and _E_2_ is the weight 2 Eisenstein series. This derivative is known to preserve the modularity and simply raise the weight of _f_ by 2.

Note that this feature is implemented in PARI/GP under the name _mfderivE2_.


---

Comment by @DavidAyotte created at 2021-08-06 20:08:36

Set assignee to @DavidAyotte.


---

Comment by git created at 2021-08-06 20:14:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @DavidAyotte created at 2021-08-06 20:15:20

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2021-08-07 10:39:04

In the examples it would be helpful for the reader to check the Ramanujan identities (about derivatives of `E4` and `E6`).

To implement the Serre derivative, you don't need the base ring to be a field. You just need to be able to invert the weight `12`. For that purpose, you can use `base_ring(12).inverse_of_unit()` (that would raise the appropriate error if it is not invertible). In the same veine, never write `(self.weight()/12)` which creates a rational number unless you are performing multiplication over `QQ`.


---

Comment by vdelecroix created at 2021-08-07 10:39:04

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-08-09 13:10:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-08-09 13:13:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @DavidAyotte created at 2021-08-09 13:14:26

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2021-09-09 09:52:34

looks good.

I would break the start of the doc into separate lines.

Vincent, any other suggestion ?


---

Comment by vdelecroix created at 2021-09-09 10:40:55

looks good


---

Comment by git created at 2021-09-09 12:44:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-09-09 14:20:22

Hmm.. Thanks. You can keep that, but this is not what I wanted. In methods, the very first line must be a single sentence describing the method, like "Return a potato." 

Here you have two sentences : separate the second one "If bla bla" from the first one by an empty line.

https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings


---

Comment by git created at 2021-09-09 14:29:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @DavidAyotte created at 2021-09-09 14:35:38

Replying to [comment:13 chapoton]:
> Hmm.. Thanks. You can keep that, but this is not what I wanted. In methods, the very first line must be a single sentence describing the method, like "Return a potato." 
> 
> Here you have two sentences : separate the second one "If bla bla" from the first one by an empty line.
> 
> https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings

Thank you very much for reminding me this rule. I have to admit that I took this "faux pli" by looking at some already written code and I have done it in some of my other ticket. I will fix them.


---

Comment by chapoton created at 2021-09-09 16:54:00

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2021-09-09 16:54:00

ok, green bot. Good to go.


---

Comment by vbraun created at 2021-09-15 22:06:02

Resolution: fixed
