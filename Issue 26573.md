# Issue 26573: Permutations(avoiding=[[1,3,2]]) returns all permutations

archive/issues_026573.json:
```json
{
    "body": "\n```\nsage: Permutations(avoiding=[[1,3,2]])\nStandard permutations\n```\n\nWe should at least raise an error - or implement an appropriate class, but this may be overkill.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26810\n\n",
    "created_at": "2018-12-03T21:11:08Z",
    "labels": [
        "combinatorics",
        "major",
        "bug"
    ],
    "title": "Permutations(avoiding=[[1,3,2]]) returns all permutations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26573",
    "user": "mantepse"
}
```

```
sage: Permutations(avoiding=[[1,3,2]])
Standard permutations
```

We should at least raise an error - or implement an appropriate class, but this may be overkill.

Issue created by migration from https://trac.sagemath.org/ticket/26810





---

archive/issue_comments_373582.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-12-04T11:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373582",
    "user": "mantepse"
}
```

New commits:



---

archive/issue_comments_373583.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-04T11:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373583",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373584.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-04T11:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373584",
    "user": "mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_373585.json:
```json
{
    "body": "LGTM modulo the comments in #26809.",
    "created_at": "2019-01-06T17:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373585",
    "user": "dkrenn"
}
```

LGTM modulo the comments in #26809.



---

archive/issue_comments_373586.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-06T20:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373586",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373587.json:
```json
{
    "body": "done!",
    "created_at": "2019-01-06T20:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373587",
    "user": "mantepse"
}
```

done!



---

archive/issue_comments_373588.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-07T13:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373588",
    "user": "dkrenn"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_373589.json:
```json
{
    "body": "LGTM, thanks.",
    "created_at": "2019-01-07T13:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373589",
    "user": "dkrenn"
}
```

LGTM, thanks.



---

archive/issue_comments_373590.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-01-07T17:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373590",
    "user": "tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_373591.json:
```json
{
    "body": "This is an ugly `__contains__` check:\n\n```\nreturn x in StandardPermutations_avoiding_generic(len(x), self._a)\n```\n\nI would just copy the code since it is 2 lines.\n\nYou also need to deprecate `self.a`.",
    "created_at": "2019-01-07T17:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373591",
    "user": "tscrim"
}
```

This is an ugly `__contains__` check:

```
return x in StandardPermutations_avoiding_generic(len(x), self._a)
```

I would just copy the code since it is 2 lines.

You also need to deprecate `self.a`.



---

archive/issue_comments_373592.json:
```json
{
    "body": "Replying to [comment:10 tscrim]:\n> This is an ugly `__contains__` check:\n> {{{\n> return x in StandardPermutations_avoiding_generic(len(x), self._a)\n> }}}\n> I would just copy the code since it is 2 lines.\n\nThere is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.\n\nDo you insist?\n\n> You also need to deprecate `self.a`.\n\n`self.a` was not documented.  Do you insist?",
    "created_at": "2019-01-07T18:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373592",
    "user": "mantepse"
}
```

Replying to [comment:10 tscrim]:
> This is an ugly `__contains__` check:
> {{{
> return x in StandardPermutations_avoiding_generic(len(x), self._a)
> }}}
> I would just copy the code since it is 2 lines.

There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.

Do you insist?

> You also need to deprecate `self.a`.

`self.a` was not documented.  Do you insist?



---

archive/issue_comments_373593.json:
```json
{
    "body": "Replying to [comment:11 mantepse]:\n> Replying to [comment:10 tscrim]:\n> > This is an ugly `__contains__` check:\n> > {{{\n> > return x in StandardPermutations_avoiding_generic(len(x), self._a)\n> > }}}\n> > I would just copy the code since it is 2 lines.\n> \n> There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.\n> \n> Do you insist?\n\nYes. If that code improves, then you should migrate to a common base class.\n\n> > You also need to deprecate `self.a`.\n> \n> `self.a` was not documented.  Do you insist?\n\nVery much. It was public, so it *must* be deprecated.",
    "created_at": "2019-01-07T18:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373593",
    "user": "tscrim"
}
```

Replying to [comment:11 mantepse]:
> Replying to [comment:10 tscrim]:
> > This is an ugly `__contains__` check:
> > {{{
> > return x in StandardPermutations_avoiding_generic(len(x), self._a)
> > }}}
> > I would just copy the code since it is 2 lines.
> 
> There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.
> 
> Do you insist?

Yes. If that code improves, then you should migrate to a common base class.

> > You also need to deprecate `self.a`.
> 
> `self.a` was not documented.  Do you insist?

Very much. It was public, so it *must* be deprecated.



---

archive/issue_comments_373594.json:
```json
{
    "body": "> > There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.\n> > \n> > Do you insist?\n> \n> Yes. If that code improves, then you should migrate to a common base class.\n\n??? `StandardPermutations_avoiding_generic` **is** the common base class ???",
    "created_at": "2019-01-07T18:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373594",
    "user": "mantepse"
}
```

> > There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.
> > 
> > Do you insist?
> 
> Yes. If that code improves, then you should migrate to a common base class.

??? `StandardPermutations_avoiding_generic` **is** the common base class ???



---

archive/issue_comments_373595.json:
```json
{
    "body": "Replying to [comment:13 mantepse]:\n> > > There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.\n> > > \n> > > Do you insist?\n> > \n> > Yes. If that code improves, then you should migrate to a common base class.\n> \n> ??? `StandardPermutations_avoiding_generic` **is** the common base class ???\n\nNo it is not. `StandardPermutations_all_avoiding` and `StandardPermutations_avoiding_generic` are only relatives in the class hierarchy and have no inheritance relationship.",
    "created_at": "2019-01-07T18:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373595",
    "user": "tscrim"
}
```

Replying to [comment:13 mantepse]:
> > > There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.
> > > 
> > > Do you insist?
> > 
> > Yes. If that code improves, then you should migrate to a common base class.
> 
> ??? `StandardPermutations_avoiding_generic` **is** the common base class ???

No it is not. `StandardPermutations_all_avoiding` and `StandardPermutations_avoiding_generic` are only relatives in the class hierarchy and have no inheritance relationship.



---

archive/issue_comments_373596.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-07T18:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373596",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373597.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-07T18:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373597",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373598.json:
```json
{
    "body": "done, and yes, you were right about the inhertance.  Sorry about that.\n----\nNew commits:",
    "created_at": "2019-01-07T18:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373598",
    "user": "mantepse"
}
```

done, and yes, you were right about the inhertance.  Sorry about that.
----
New commits:



---

archive/issue_comments_373599.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-07T18:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373599",
    "user": "mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_373600.json:
```json
{
    "body": "Thank you.",
    "created_at": "2019-01-07T18:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373600",
    "user": "tscrim"
}
```

Thank you.



---

archive/issue_comments_373601.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-07T18:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373601",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_373602.json:
```json
{
    "body": "Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373602",
    "user": "embray"
}
```

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_373603.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-23T14:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26573#issuecomment-373603",
    "user": "vbraun"
}
```

Resolution: fixed
