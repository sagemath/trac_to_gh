# Issue 26573: Permutations(avoiding=[[1,3,2]]) returns all permutations

Issue created by migration from https://trac.sagemath.org/ticket/26810

Original creator: mantepse

Original creation time: 2018-12-03 21:11:08


```
sage: Permutations(avoiding=[[1,3,2]])
Standard permutations
```

We should at least raise an error - or implement an appropriate class, but this may be overkill.


---

Comment by mantepse created at 2018-12-04 11:27:41

New commits:


---

Comment by git created at 2018-12-04 11:28:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2018-12-04 11:31:06

Changing status from new to needs_review.


---

Comment by dkrenn created at 2019-01-06 17:38:03

LGTM modulo the comments in #26809.


---

Comment by git created at 2019-01-06 20:27:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2019-01-06 20:28:07

done!


---

Comment by dkrenn created at 2019-01-07 13:20:09

Changing status from needs_review to positive_review.


---

Comment by dkrenn created at 2019-01-07 13:20:09

LGTM, thanks.


---

Comment by tscrim created at 2019-01-07 17:43:00

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2019-01-07 17:43:00

This is an ugly `__contains__` check:

```
return x in StandardPermutations_avoiding_generic(len(x), self._a)
```

I would just copy the code since it is 2 lines.

You also need to deprecate `self.a`.


---

Comment by mantepse created at 2019-01-07 18:01:48

Replying to [comment:10 tscrim]:
> This is an ugly `__contains__` check:
> {{{
> return x in StandardPermutations_avoiding_generic(len(x), self._a)
> }}}
> I would just copy the code since it is 2 lines.

There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.

Do you insist?

> You also need to deprecate `self.a`.

`self.a` was not documented.  Do you insist?


---

Comment by tscrim created at 2019-01-07 18:17:14

Replying to [comment:11 mantepse]:
> Replying to [comment:10 tscrim]:
> > This is an ugly `__contains__` check:
> > {{{
> > return x in StandardPermutations_avoiding_generic(len(x), self._a)
> > }}}
> > I would just copy the code since it is 2 lines.
> 
> There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.
> 
> Do you insist?

Yes. If that code improves, then you should migrate to a common base class.

> > You also need to deprecate `self.a`.
> 
> `self.a` was not documented.  Do you insist?

Very much. It was public, so it *must* be deprecated.


---

Comment by mantepse created at 2019-01-07 18:20:33

> > There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.
> > 
> > Do you insist?
> 
> Yes. If that code improves, then you should migrate to a common base class.

??? `StandardPermutations_avoiding_generic` **is** the common base class ???


---

Comment by tscrim created at 2019-01-07 18:32:23

Replying to [comment:13 mantepse]:
> > > There is a reason to this: The code in `StandardPermutations_avoiding_generic` is currently stupid, and it is quite possible that it could be improved (although I am by no means an expert in permutation patterns).  If I copy the stupid implementation, there will be two places to take care of.
> > > 
> > > Do you insist?
> > 
> > Yes. If that code improves, then you should migrate to a common base class.
> 
> ??? `StandardPermutations_avoiding_generic` **is** the common base class ???

No it is not. `StandardPermutations_all_avoiding` and `StandardPermutations_avoiding_generic` are only relatives in the class hierarchy and have no inheritance relationship.


---

Comment by git created at 2019-01-07 18:46:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-01-07 18:49:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2019-01-07 18:50:32

done, and yes, you were right about the inhertance.  Sorry about that.
----
New commits:


---

Comment by mantepse created at 2019-01-07 18:50:47

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2019-01-07 18:53:04

Thank you.


---

Comment by tscrim created at 2019-01-07 18:53:04

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-01-15 18:16:10

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.


---

Comment by vbraun created at 2019-01-23 14:17:55

Resolution: fixed
