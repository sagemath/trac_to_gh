# Issue 21245: disabling the MAPLE interface to linbox

archive/issues_021245.json:
```json
{
    "body": "CC:  @dcoudert\n\nthis is to address an issue [mentioned](https://trac.sagemath.org/ticket/17635#comment:215) on #17635. \n\nIssue created by migration from https://trac.sagemath.org/ticket/21482\n\n",
    "created_at": "2016-09-13T11:09:45Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "disabling the MAPLE interface to linbox",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21245",
    "user": "https://github.com/dimpase"
}
```
CC:  @dcoudert

this is to address an issue [mentioned](https://trac.sagemath.org/ticket/17635#comment:215) on #17635. 

Issue created by migration from https://trac.sagemath.org/ticket/21482





---

archive/issue_comments_294530.json:
```json
{
    "body": "Ok, I'll create a branch, but I've also commented on #17635 on how my patch there could be tested until then...",
    "created_at": "2016-09-13T14:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294530",
    "user": "https://github.com/nexttime"
}
```

Ok, I'll create a branch, but I've also commented on #17635 on how my patch there could be tested until then...



---

archive/issue_comments_294531.json:
```json
{
    "body": "Random comment:  It seems we should disable the use of \"external\" packages when building  bdists anyway, as these might not be present on target machines even with the same distro.",
    "created_at": "2016-09-13T14:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294531",
    "user": "https://github.com/nexttime"
}
```

Random comment:  It seems we should disable the use of "external" packages when building  bdists anyway, as these might not be present on target machines even with the same distro.



---

archive/issue_comments_294532.json:
```json
{
    "body": "Replying to [comment:2 leif]:\n> Ok, I'll create a branch, but I've also commented on #17635 on how my patch there could be tested until then...\n\nP.S.:  TBH, I didn't create one yesterday also because I didn't recall into which beta #17635 finally got merged... ;-)  (Again, `sudo fill merged_field`.)",
    "created_at": "2016-09-13T14:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294532",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:2 leif]:
> Ok, I'll create a branch, but I've also commented on #17635 on how my patch there could be tested until then...

P.S.:  TBH, I didn't create one yesterday also because I didn't recall into which beta #17635 finally got merged... ;-)  (Again, `sudo fill merged_field`.)



---

archive/issue_comments_294533.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-13T14:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294533",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_294534.json:
```json
{
    "body": "here is the patch.\nplease test.\n----\nNew commits:",
    "created_at": "2016-09-13T14:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294534",
    "user": "https://github.com/dimpase"
}
```

here is the patch.
please test.
----
New commits:



---

archive/issue_comments_294535.json:
```json
{
    "body": "P.P.S.:  There are IMHO a couple of issues related to this we should report and fix upstream, but on another ticket, as this is just for working around the current brokenness *in Sage*.\n\nAfter all, I'm not patching `configure.ac`, just `configure`, which is also much easier to maintain.",
    "created_at": "2016-09-13T14:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294535",
    "user": "https://github.com/nexttime"
}
```

P.P.S.:  There are IMHO a couple of issues related to this we should report and fix upstream, but on another ticket, as this is just for working around the current brokenness *in Sage*.

After all, I'm not patching `configure.ac`, just `configure`, which is also much easier to maintain.



---

archive/issue_comments_294536.json:
```json
{
    "body": "somehow I managed to clear CC field while changing the ticket, sorry. Restored. Ready for review.",
    "created_at": "2016-09-13T14:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294536",
    "user": "https://github.com/dimpase"
}
```

somehow I managed to clear CC field while changing the ticket, sorry. Restored. Ready for review.



---

archive/issue_comments_294537.json:
```json
{
    "body": "Replying to [comment:5 dimpase]:\n> here is the patch.\n> please test.\n> ----\n> New commits:\n> ||[02bcc52](https://git.sagemath.org/sage.git/commit?id=02bcc52d7eacb53fa209261e6dc9092b39345240)||`patch from comment 231 of #17635`||\n\nWell, that's a slightly different patch (to `configure`), also \"disabling\" `--with-default=yes` (to not say *break* the latter...).",
    "created_at": "2016-09-13T14:26:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294537",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:5 dimpase]:
> here is the patch.
> please test.
> ----
> New commits:
> ||[02bcc52](https://git.sagemath.org/sage.git/commit?id=02bcc52d7eacb53fa209261e6dc9092b39345240)||`patch from comment 231 of #17635`||

Well, that's a slightly different patch (to `configure`), also "disabling" `--with-default=yes` (to not say *break* the latter...).



---

archive/issue_comments_294538.json:
```json
{
    "body": "Replying to [comment:9 leif]:\n> Replying to [comment:5 dimpase]:\n> > here is the patch.\n> > please test.\n> > ----\n> > New commits:\n> > ||[02bcc52](https://git.sagemath.org/sage.git/commit?id=02bcc52d7eacb53fa209261e6dc9092b39345240)||`patch from comment 231 of #17635`||\n> \n> Well, that's a slightly different patch (to `configure`), also \"disabling\" `--with-default=yes` (to not say *break* the latter...).\n\nit should do the same thing - I got lost in nested robot-written ifs there...",
    "created_at": "2016-09-13T14:32:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294538",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:9 leif]:
> Replying to [comment:5 dimpase]:
> > here is the patch.
> > please test.
> > ----
> > New commits:
> > ||[02bcc52](https://git.sagemath.org/sage.git/commit?id=02bcc52d7eacb53fa209261e6dc9092b39345240)||`patch from comment 231 of #17635`||
> 
> Well, that's a slightly different patch (to `configure`), also "disabling" `--with-default=yes` (to not say *break* the latter...).

it should do the same thing - I got lost in nested robot-written ifs there...



---

archive/issue_comments_294539.json:
```json
{
    "body": "Replying to [comment:10 dimpase]:\n> Replying to [comment:9 leif]:\n> > Replying to [comment:5 dimpase]:\n> > > here is the patch.\n> > > please test.\n> > > ----\n> > > New commits:\n> > > ||[02bcc52](https://git.sagemath.org/sage.git/commit?id=02bcc52d7eacb53fa209261e6dc9092b39345240)||`patch from comment 231 of #17635`||\n> > \n> > Well, that's a slightly different patch (to `configure`), also \"disabling\" `--with-default=yes` (to not say *break* the latter...).\n> \n> it should do the same thing - I got lost in nested robot-written ifs there...\n\nWell, what was the reason to change the patch to `configure` at all?\n\nIf someone now changes `spkg-install`, it's again broken.",
    "created_at": "2016-09-13T14:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294539",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:10 dimpase]:
> Replying to [comment:9 leif]:
> > Replying to [comment:5 dimpase]:
> > > here is the patch.
> > > please test.
> > > ----
> > > New commits:
> > > ||[02bcc52](https://git.sagemath.org/sage.git/commit?id=02bcc52d7eacb53fa209261e6dc9092b39345240)||`patch from comment 231 of #17635`||
> > 
> > Well, that's a slightly different patch (to `configure`), also "disabling" `--with-default=yes` (to not say *break* the latter...).
> 
> it should do the same thing - I got lost in nested robot-written ifs there...

Well, what was the reason to change the patch to `configure` at all?

If someone now changes `spkg-install`, it's again broken.



---

archive/issue_comments_294540.json:
```json
{
    "body": "By the way, `--with-maple=no` doesn't work as expected because we also pass `--with-all=...`, but I think I already mentioned that on #17635.",
    "created_at": "2016-09-13T14:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294540",
    "user": "https://github.com/nexttime"
}
```

By the way, `--with-maple=no` doesn't work as expected because we also pass `--with-all=...`, but I think I already mentioned that on #17635.



---

archive/issue_comments_294541.json:
```json
{
    "body": "seems to work for me",
    "created_at": "2016-09-13T15:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294541",
    "user": "https://github.com/fchapoton"
}
```

seems to work for me



---

archive/issue_comments_294542.json:
```json
{
    "body": "The --with-all forces all --with-XXX to yes, therefore --with-maple was not working.\n\nI suggest to simply change the `--with-all=\"$SAGE_LOCAL\"` with `--with-default=\"$SAGE_LOCAL\"`.\n\nThis seems to be a simpler/smaller fix and works on my box.\nLet me know how it works on yours before I mess up with Dima's patch.\n\nCl\u00e9ment",
    "created_at": "2016-09-13T15:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294542",
    "user": "https://github.com/ClementPernet"
}
```

The --with-all forces all --with-XXX to yes, therefore --with-maple was not working.

I suggest to simply change the `--with-all="$SAGE_LOCAL"` with `--with-default="$SAGE_LOCAL"`.

This seems to be a simpler/smaller fix and works on my box.
Let me know how it works on yours before I mess up with Dima's patch.

Clément



---

archive/issue_comments_294543.json:
```json
{
    "body": "Replying to [comment:14 cpernet]:\n> The --with-all forces all --with-XXX to yes, therefore --with-maple was not working.\n> \n> I suggest to simply change the `--with-all=\"$SAGE_LOCAL\"` with `--with-default=\"$SAGE_LOCAL\"`.\n> \n> This seems to be a simpler/smaller fix and works on my box.\n> Let me know how it works on yours before I mess up with Dima's patch.\n> \n> Cl\u00e9ment\n\nSee my previous comments; IMHO there are things to get fixed *in other ways* upstream (besides the compiler errors themselves), I'll probably post on a further ticket, since here we just want to fix the Sage build.",
    "created_at": "2016-09-13T15:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294543",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:14 cpernet]:
> The --with-all forces all --with-XXX to yes, therefore --with-maple was not working.
> 
> I suggest to simply change the `--with-all="$SAGE_LOCAL"` with `--with-default="$SAGE_LOCAL"`.
> 
> This seems to be a simpler/smaller fix and works on my box.
> Let me know how it works on yours before I mess up with Dima's patch.
> 
> Clément

See my previous comments; IMHO there are things to get fixed *in other ways* upstream (besides the compiler errors themselves), I'll probably post on a further ticket, since here we just want to fix the Sage build.



---

archive/issue_comments_294544.json:
```json
{
    "body": "Replying to [comment:15 leif]:\n> \n> IMHO there are things to get fixed *in other ways* upstream\n\nOf course. This is now [https://github.com/linbox-team/linbox/issues/38](https://github.com/linbox-team/linbox/issues/38)\n\n> (besides the compiler errors themselves),\n\nI'm not sure to have found which one you're referring to.\n\nFor me, the option `--with-all` is the bug here, as we definitely do not need/want LinBox to look for all of its possible dependencies.\nThe `--with-default` is the one we want, to specify the common folder where to find the dependencies that are turned on when found (namely fflas-ffpack, NTL, IML).\n\nI see no point in adding a patch to the configure file.",
    "created_at": "2016-09-13T15:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294544",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:15 leif]:
> 
> IMHO there are things to get fixed *in other ways* upstream

Of course. This is now [https://github.com/linbox-team/linbox/issues/38](https://github.com/linbox-team/linbox/issues/38)

> (besides the compiler errors themselves),

I'm not sure to have found which one you're referring to.

For me, the option `--with-all` is the bug here, as we definitely do not need/want LinBox to look for all of its possible dependencies.
The `--with-default` is the one we want, to specify the common folder where to find the dependencies that are turned on when found (namely fflas-ffpack, NTL, IML).

I see no point in adding a patch to the configure file.



---

archive/issue_comments_294545.json:
```json
{
    "body": "With this patch, I'm now able to compile 7.4-beta4. Thank you !\n\nShould I set this ticket to positive review or you want to improve it first?",
    "created_at": "2016-09-14T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294545",
    "user": "https://github.com/dcoudert"
}
```

With this patch, I'm now able to compile 7.4-beta4. Thank you !

Should I set this ticket to positive review or you want to improve it first?



---

archive/issue_comments_294546.json:
```json
{
    "body": "Attachment [linbox-sage-21482.patch](tarball://root/attachments/some-uuid/ticket21482/linbox-sage-21482.patch) by @ClementPernet created at 2016-09-14 10:48:34\n\nAlternative fix",
    "created_at": "2016-09-14T10:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294546",
    "user": "https://github.com/ClementPernet"
}
```

Attachment [linbox-sage-21482.patch](tarball://root/attachments/some-uuid/ticket21482/linbox-sage-21482.patch) by @ClementPernet created at 2016-09-14 10:48:34

Alternative fix



---

archive/issue_comments_294547.json:
```json
{
    "body": "OK, Clement, why won't you take over and produce a git branch and a link to the updated linbox tarball?",
    "created_at": "2016-09-14T10:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294547",
    "user": "https://github.com/dimpase"
}
```

OK, Clement, why won't you take over and produce a git branch and a link to the updated linbox tarball?



---

archive/issue_comments_294548.json:
```json
{
    "body": "Replying to [comment:18 dimpase]:\n> OK, Clement, why won't you take over and produce a git branch and a link to the updated linbox tarball?\n\nSure, I'll do it. I just didn't want to step on your toes, since you already posted a branch.\n\nNo need to update the linbox tarball.",
    "created_at": "2016-09-14T11:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294548",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:18 dimpase]:
> OK, Clement, why won't you take over and produce a git branch and a link to the updated linbox tarball?

Sure, I'll do it. I just didn't want to step on your toes, since you already posted a branch.

No need to update the linbox tarball.



---

archive/issue_comments_294549.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-09-14T11:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294549",
    "user": "https://github.com/ClementPernet"
}
```

New commits:



---

archive/issue_comments_294550.json:
```json
{
    "body": "`@`dcoudert can you confirm this new branch fixes your compilation error?",
    "created_at": "2016-09-14T11:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294550",
    "user": "https://github.com/ClementPernet"
}
```

`@`dcoudert can you confirm this new branch fixes your compilation error?



---

archive/issue_comments_294551.json:
```json
{
    "body": "I made a distclean before trying this patch and it's working !\nCool :)",
    "created_at": "2016-09-14T13:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294551",
    "user": "https://github.com/dcoudert"
}
```

I made a distclean before trying this patch and it's working !
Cool :)



---

archive/issue_comments_294552.json:
```json
{
    "body": "Can I set this ticket to positive review? or is it better to wait for feedback from others?",
    "created_at": "2016-09-15T08:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294552",
    "user": "https://github.com/dcoudert"
}
```

Can I set this ticket to positive review? or is it better to wait for feedback from others?



---

archive/issue_comments_294553.json:
```json
{
    "body": "You can, as you could initially reproduce the bug and now say that it's fixed with this branch.",
    "created_at": "2016-09-15T08:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294553",
    "user": "https://github.com/ClementPernet"
}
```

You can, as you could initially reproduce the bug and now say that it's fixed with this branch.



---

archive/issue_comments_294554.json:
```json
{
    "body": "This patch solves my compilation error with 7.4-beta4.\nThank you.\nDavid.",
    "created_at": "2016-09-16T06:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294554",
    "user": "https://github.com/dcoudert"
}
```

This patch solves my compilation error with 7.4-beta4.
Thank you.
David.



---

archive/issue_comments_294555.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-09-16T06:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294555",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294556.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-09-17T15:25:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21245#issuecomment-294556",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
