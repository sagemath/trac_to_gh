# Issue 33144: Remove some py2 tags in explain_pickle

archive/issues_032907.json:
```json
{
    "assignees": [],
    "body": "We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n\nCC:  @embray @mjungmath @tscrim\n\nBranch/Commit: **[131841f](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**\n\nReviewer: **Travis Scrimshaw, Kwankyu Lee**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33144_\n\n",
    "closed_at": "2022-07-09T22:31:18Z",
    "created_at": "2022-01-10T18:06:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove some py2 tags in explain_pickle",
    "type": "issue",
    "updated_at": "2022-07-09T22:31:18Z",
    "url": "https://github.com/sagemath/sage/issues/33144",
    "user": "https://github.com/fchapoton"
}
```
We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).

CC:  @embray @mjungmath @tscrim

Branch/Commit: **[131841f](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**

Reviewer: **Travis Scrimshaw, Kwankyu Lee**

Author: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/33144_





---

archive/issue_events_423371.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423371"
}
```



---

archive/issue_events_423372.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423372"
}
```



---

archive/issue_events_423373.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423373"
}
```



---

archive/issue_events_423374.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423374"
}
```



---

archive/issue_comments_538653.json:
```json
{
    "body": "Branch: **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)**",
    "created_at": "2022-01-10T18:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538653",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)**



---

archive/issue_comments_538654.json:
```json
{
    "body": "Commit: **[9d0b7a1](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)**",
    "created_at": "2022-01-10T18:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538654",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[9d0b7a1](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)**



---

archive/issue_events_423375.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:07:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423375"
}
```



---

archive/issue_comments_538655.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nboring and painful update..\n\nany expert on pickles aboard ?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169\">9d0b7a1</a></td><td><code>removal of py2 tag in doctests of explain pickle (first wave)</code></td></tr></table>\n",
    "created_at": "2022-01-10T18:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538655",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'>Comment 1:</a>
boring and painful update..

any expert on pickles aboard ?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169">9d0b7a1</a></td><td><code>removal of py2 tag in doctests of explain pickle (first wave)</code></td></tr></table>




---

archive/issue_events_423376.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T19:54:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423376"
}
```



---

archive/issue_events_423377.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T19:54:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423377"
}
```



---

archive/issue_events_423378.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T08:33:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423378"
}
```



---

archive/issue_events_423379.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T08:33:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423379"
}
```



---

archive/issue_comments_538656.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nok, let's do that in several steps. Please review this first step.",
    "created_at": "2022-03-20T08:33:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538656",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'>Comment 3:</a>
ok, let's do that in several steps. Please review this first step.



---

archive/issue_events_423380.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423380"
}
```



---

archive/issue_events_423381.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423381"
}
```



---

archive/issue_comments_538657.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nplease somebody have a look\n\nThis is the last file containing `#py2` tags. Here I remove only the simple ones, and the changes should rather be uncontroversial. The remaining cases are out of my capacity, and require an expert of pickle, that we may no longer have anywhere in sight..\n\nOne alternative would be #27350 (externalize) or just drop the file completely.",
    "created_at": "2022-06-11T07:10:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538657",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'>Comment 6:</a>
please somebody have a look

This is the last file containing `#py2` tags. Here I remove only the simple ones, and the changes should rather be uncontroversial. The remaining cases are out of my capacity, and require an expert of pickle, that we may no longer have anywhere in sight..

One alternative would be #27350 (externalize) or just drop the file completely.



---

archive/issue_comments_538658.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nIt would be wonderful for Erik Bray to work on #27350 and close this ticket as `invalid/wontfix`. \n\nIf that would not happen, then I think we should fix `explain_pickle` for python3 before we remove the py2 tag, instead of \"fixing\" doctests for the broken `explain_pickle`.",
    "created_at": "2022-06-14T06:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538658",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'>Comment 7:</a>
It would be wonderful for Erik Bray to work on #27350 and close this ticket as `invalid/wontfix`. 

If that would not happen, then I think we should fix `explain_pickle` for python3 before we remove the py2 tag, instead of "fixing" doctests for the broken `explain_pickle`.



---

archive/issue_comments_538659.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nAs far as I understand, Erik is no longer available.",
    "created_at": "2022-06-14T06:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538659",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'>Comment 8:</a>
As far as I understand, Erik is no longer available.



---

archive/issue_comments_538660.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-06-14T07:07:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538660",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_538661.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nIn principle, I agree with #27350, but I am slightly worried about the practice of it since I find this tool to be very useful at times and would be saddened if it bitrotted. I, unfortunately, would not be able to maintain such a package as I don't understand how `explain_pickle()` works. Since these doctests seem to just be updating the output, I think we should merge these in now. Likewise, I don't think I could help with any of the further marked tests.\n\nKwankyu, any objections to me setting a positive review?",
    "created_at": "2022-06-14T07:07:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538661",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'>Comment 9:</a>
In principle, I agree with #27350, but I am slightly worried about the practice of it since I find this tool to be very useful at times and would be saddened if it bitrotted. I, unfortunately, would not be able to maintain such a package as I don't understand how `explain_pickle()` works. Since these doctests seem to just be updating the output, I think we should merge these in now. Likewise, I don't think I could help with any of the further marked tests.

Kwankyu, any objections to me setting a positive review?



---

archive/issue_comments_538662.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReplying to [@tscrim](#comment%3A9):\n> Since these doctests seem to just be updating the output, \n\nSome outputs from `explain_pickle` (via `test_pickle`), for instance,\n\n```diff\n             sage: from sage.misc.explain_pickle import *\n-            sage: test_pickle(dumps(100000r, compress=False))  # py2\n-                0: \\x80 PROTO      2\n-                2: J    BININT     100000\n-                7: .    STOP\n-            highest protocol among opcodes = 2\n-            explain_pickle in_current_sage=True/False:\n-            100000\n-            result: 100000\n+            sage: test_pickle(dumps(100000r, compress=False))\n+                    0: \\x80 PROTO      2\n+                    2: c    GLOBAL     '_codecs encode'\n+                   18: q    BINPUT     0\n+                   20: X    BINUNICODE '\\x80\\x02J\\xa0\\x86\\x01\\x00.'\n+                   36: q    BINPUT     1\n+                   38: X    BINUNICODE 'latin1'\n+                   49: q    BINPUT     2\n+                   51: \\x86 TUPLE2\n+                   52: q    BINPUT     3\n+                   54: R    REDUCE\n+                   55: q    BINPUT     4\n+                   57: .    STOP\n+                highest protocol among opcodes = 2\n+                explain_pickle in_current_sage=True:\n+                from _codecs import encode\n+                encode('\\x80\\x02J\\xa0\\x86\\x01\\x00.', 'latin1')\n+                explain_pickle in_current_sage=False:\n+                pg_encode = unpickle_global('_codecs', 'encode')\n+                pg_encode('\\x80\\x02J\\xa0\\x86\\x01\\x00.', 'latin1')\n+                result: b'\\x80\\x02J\\xa0\\x86\\x01\\x00.'\n```\n\n\nseem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\nIndentations of outputs are wrong.",
    "created_at": "2022-06-14T07:29:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538662",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:10'>Comment 10:</a>
Replying to [@tscrim](#comment%3A9):
> Since these doctests seem to just be updating the output, 

Some outputs from `explain_pickle` (via `test_pickle`), for instance,

```diff
             sage: from sage.misc.explain_pickle import *
-            sage: test_pickle(dumps(100000r, compress=False))  # py2
-                0: \x80 PROTO      2
-                2: J    BININT     100000
-                7: .    STOP
-            highest protocol among opcodes = 2
-            explain_pickle in_current_sage=True/False:
-            100000
-            result: 100000
+            sage: test_pickle(dumps(100000r, compress=False))
+                    0: \x80 PROTO      2
+                    2: c    GLOBAL     '_codecs encode'
+                   18: q    BINPUT     0
+                   20: X    BINUNICODE '\x80\x02J\xa0\x86\x01\x00.'
+                   36: q    BINPUT     1
+                   38: X    BINUNICODE 'latin1'
+                   49: q    BINPUT     2
+                   51: \x86 TUPLE2
+                   52: q    BINPUT     3
+                   54: R    REDUCE
+                   55: q    BINPUT     4
+                   57: .    STOP
+                highest protocol among opcodes = 2
+                explain_pickle in_current_sage=True:
+                from _codecs import encode
+                encode('\x80\x02J\xa0\x86\x01\x00.', 'latin1')
+                explain_pickle in_current_sage=False:
+                pg_encode = unpickle_global('_codecs', 'encode')
+                pg_encode('\x80\x02J\xa0\x86\x01\x00.', 'latin1')
+                result: b'\x80\x02J\xa0\x86\x01\x00.'
```


seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

Indentations of outputs are wrong.



---

archive/issue_comments_538663.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@kwankyu](#comment%3A10):\n> Replying to [@tscrim](#comment%3A9):\n> > Since these doctests seem to just be updating the output, \n\n> seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\nThe pickle itself has changed. If you run `loads(dumps(100000r))`, it returns the correct object without error. In this case, it is likely because `int` has changed from Python2 to Python3.\n\n> Indentations of outputs are wrong. \n\nIndeed; although I found the extra indentation level helped make clear what the doctest outputs were since they are so long with their own indentation. I don't hold a strong opinion on changing this or not.",
    "created_at": "2022-06-14T07:37:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538663",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@kwankyu](#comment%3A10):
> Replying to [@tscrim](#comment%3A9):
> > Since these doctests seem to just be updating the output, 

> seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

The pickle itself has changed. If you run `loads(dumps(100000r))`, it returns the correct object without error. In this case, it is likely because `int` has changed from Python2 to Python3.

> Indentations of outputs are wrong. 

Indeed; although I found the extra indentation level helped make clear what the doctest outputs were since they are so long with their own indentation. I don't hold a strong opinion on changing this or not.



---

archive/issue_comments_538664.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@tscrim](#comment%3A11):\n> Replying to [@kwankyu](#comment%3A10):\n> > Replying to [@tscrim](#comment%3A9):\n> > > Since these doctests seem to just be updating the output, \n\n> \n> > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\n> \n> The pickle itself has changed. \n\nI meant the `result`. Shouldn't it be `100000`?",
    "created_at": "2022-06-14T07:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538664",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@tscrim](#comment%3A11):
> Replying to [@kwankyu](#comment%3A10):
> > Replying to [@tscrim](#comment%3A9):
> > > Since these doctests seem to just be updating the output, 

> 
> > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

> 
> The pickle itself has changed. 

I meant the `result`. Shouldn't it be `100000`?



---

archive/issue_comments_538665.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@kwankyu](#comment%3A12):\n> Replying to [@tscrim](#comment%3A11):\n> > Replying to [@kwankyu](#comment%3A10):\n> > > Replying to [@tscrim](#comment%3A9):\n> > > > Since these doctests seem to just be updating the output, \n\n> > \n> > > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\n> > \n> > The pickle itself has changed. \n\n> \n> I meant the `result`. Shouldn't it be `100000`?\n\nI believe it is the right result but represented or interpreted in the wrong format. Mainly the bytes returned are not converted to a string correctly or something similar.",
    "created_at": "2022-06-14T08:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538665",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@kwankyu](#comment%3A12):
> Replying to [@tscrim](#comment%3A11):
> > Replying to [@kwankyu](#comment%3A10):
> > > Replying to [@tscrim](#comment%3A9):
> > > > Since these doctests seem to just be updating the output, 

> > 
> > > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

> > 
> > The pickle itself has changed. 

> 
> I meant the `result`. Shouldn't it be `100000`?

I believe it is the right result but represented or interpreted in the wrong format. Mainly the bytes returned are not converted to a string correctly or something similar.



---

archive/issue_comments_538666.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nPerhaps we just don't remove the tag in the cases when the result is (at least superficially) different?",
    "created_at": "2022-06-14T08:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538666",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'>Comment 14:</a>
Perhaps we just don't remove the tag in the cases when the result is (at least superficially) different?



---

archive/issue_comments_538667.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@tscrim](#comment%3A14):\n> Perhaps we just don't remove the tag in the cases when the result is (at least superficially) different?\n\n+1",
    "created_at": "2022-06-14T08:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538667",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@tscrim](#comment%3A14):
> Perhaps we just don't remove the tag in the cases when the result is (at least superficially) different?

+1



---

archive/issue_comments_538668.json:
```json
{
    "body": "Changed branch from **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)** to **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)**",
    "created_at": "2022-06-14T12:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538668",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)** to **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)**



---

archive/issue_comments_538669.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nhere is a new branch, where I have dropped the changes that did no look right\n\nI may have missed some\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed\">cf9a6d9</a></td><td><code>remove only some simple #py2 tags in explain_pickle</code></td></tr></table>\n",
    "created_at": "2022-06-14T12:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538669",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'>Comment 16:</a>
here is a new branch, where I have dropped the changes that did no look right

I may have missed some

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed">cf9a6d9</a></td><td><code>remove only some simple #py2 tags in explain_pickle</code></td></tr></table>




---

archive/issue_comments_538670.json:
```json
{
    "body": "Changed commit from **[9d0b7a1](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)** to **[cf9a6d9](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)**",
    "created_at": "2022-06-14T12:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538670",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[9d0b7a1](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)** to **[cf9a6d9](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)**



---

archive/issue_comments_538671.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nHow about indentations? Did you indent more spaces intentionally?",
    "created_at": "2022-06-14T12:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538671",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:17'>Comment 17:</a>
How about indentations? Did you indent more spaces intentionally?



---

archive/issue_comments_538672.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI think outputs should look as they do on the command line, modulo wrappings.",
    "created_at": "2022-06-14T12:24:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538672",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:18'>Comment 18:</a>
I think outputs should look as they do on the command line, modulo wrappings.



---

archive/issue_comments_538673.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0\">3c82b13</a></td><td><code>remove some #py2 tags in explain_pickle</code></td></tr></table>\n",
    "created_at": "2022-06-15T08:16:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538673",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0">3c82b13</a></td><td><code>remove some #py2 tags in explain_pickle</code></td></tr></table>




---

archive/issue_comments_538674.json:
```json
{
    "body": "Changed commit from **[cf9a6d9](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)** to **[3c82b13](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)**",
    "created_at": "2022-06-15T08:16:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538674",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cf9a6d9](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)** to **[3c82b13](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)**



---

archive/issue_comments_538675.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nnow the same as previous one, only with less indentations",
    "created_at": "2022-06-15T08:16:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538675",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'>Comment 20:</a>
now the same as previous one, only with less indentations



---

archive/issue_comments_538676.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nThanks. But some cases with different `result` are still in.",
    "created_at": "2022-06-15T08:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538676",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:21'>Comment 21:</a>
Thanks. But some cases with different `result` are still in.



---

archive/issue_comments_538677.json:
```json
{
    "body": "patch for removing some #py2 tags",
    "created_at": "2022-06-26T07:30:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538677",
    "user": "https://github.com/fchapoton"
}
```

patch for removing some #py2 tags



---

archive/issue_comments_538678.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nAttachment: **[0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz](https://github.com/sagemath/sage/files/ticket33144/0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz)**\n\nThen maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.",
    "created_at": "2022-06-26T07:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538678",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'>Comment 22:</a>
Attachment: **[0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz](https://github.com/sagemath/sage/files/ticket33144/0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz)**

Then maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.



---

archive/issue_comments_538679.json:
```json
{
    "body": "Changed commit from **[3c82b13](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)** to **[131841f](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**",
    "created_at": "2022-06-26T11:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538679",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3c82b13](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)** to **[131841f](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**



---

archive/issue_comments_538680.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b47176e2a4efebc865e2bca2fdef7ffd3823ec23\">b47176e</a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75\">131841f</a></td><td><code>Restore py2 tag for cases with different result</code></td></tr></table>\n",
    "created_at": "2022-06-26T11:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538680",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b47176e2a4efebc865e2bca2fdef7ffd3823ec23">b47176e</a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75">131841f</a></td><td><code>Restore py2 tag for cases with different result</code></td></tr></table>




---

archive/issue_comments_538681.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [@fchapoton](#comment%3A22):\n> Then maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.\n\nThat is done over your last commit.",
    "created_at": "2022-06-26T11:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538681",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [@fchapoton](#comment%3A22):
> Then maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.

That is done over your last commit.



---

archive/issue_comments_538682.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Kwankyu Lee**",
    "created_at": "2022-06-26T11:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538682",
    "user": "https://github.com/kwankyu"
}
```

Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Kwankyu Lee**



---

archive/issue_comments_538683.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n``````\n",
    "created_at": "2022-06-26T11:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538683",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).
``````




---

archive/issue_comments_538684.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nI am positive now.",
    "created_at": "2022-06-26T11:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538684",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:25'>Comment 25:</a>
I am positive now.



---

archive/issue_events_423382.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-26T11:09:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "title_is": "Remove py2 tags in explain_pickle",
    "title_was": "remove py2 tags in explain_pickle",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423382"
}
```



---

archive/issue_events_423383.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-06-26T17:00:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "title_is": "Remove some py2 tags in explain_pickle",
    "title_was": "Remove py2 tags in explain_pickle",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423383"
}
```



---

archive/issue_comments_538685.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n+We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n``````\n",
    "created_at": "2022-06-26T17:00:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538685",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).
+We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).
``````




---

archive/issue_comments_538686.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nthanks, you can set to positive if you wish",
    "created_at": "2022-06-26T17:00:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538686",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'>Comment 26:</a>
thanks, you can set to positive if you wish



---

archive/issue_comments_538687.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nThanks.",
    "created_at": "2022-06-27T00:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538687",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:27'>Comment 27:</a>
Thanks.



---

archive/issue_events_423384.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423384"
}
```



---

archive/issue_events_423385.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423385"
}
```



---

archive/issue_events_423386.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423386"
}
```



---

archive/issue_events_423387.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423387"
}
```



---

archive/issue_events_423388.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:31:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423388"
}
```



---

archive/issue_events_423389.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "64e29cf9d907deb878854764070019d1eb2506b7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-07-09T22:31:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-423389"
}
```



---

archive/issue_comments_538688.json:
```json
{
    "body": "Changed branch from **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)** to **[131841f](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**",
    "created_at": "2022-07-09T22:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-538688",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)** to **[131841f](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**
