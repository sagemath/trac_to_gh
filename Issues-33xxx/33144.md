# Issue 33144: Remove some py2 tags in explain_pickle

archive/issues_032907.json:
```json
{
    "assignees": [],
    "body": "We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n\nCC:  @embray @mjungmath @tscrim\n\nBranch/Commit: **[`131841f`](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**\n\nReviewer: **Travis Scrimshaw, Kwankyu Lee**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33144_\n\n",
    "closed_at": "2022-07-09T22:31:18Z",
    "created_at": "2022-01-10T18:06:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove some py2 tags in explain_pickle",
    "type": "issue",
    "updated_at": "2022-07-09T22:31:18Z",
    "url": "https://github.com/sagemath/sage/issues/33144",
    "user": "https://github.com/fchapoton"
}
```
We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).

CC:  @embray @mjungmath @tscrim

Branch/Commit: **[`131841f`](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**

Reviewer: **Travis Scrimshaw, Kwankyu Lee**

Author: **Frédéric Chapoton**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/33144_





---

archive/issue_events_452768.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452768"
}
```



---

archive/issue_events_452769.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452769"
}
```



---

archive/issue_events_452770.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452770"
}
```



---

archive/issue_events_452771.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452771"
}
```



---

archive/issue_comments_535528.json:
```json
{
    "body": "Branch: **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)**",
    "created_at": "2022-01-10T18:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535528",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)**



---

archive/issue_comments_535529.json:
```json
{
    "body": "Commit: **[`9d0b7a1`](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)**",
    "created_at": "2022-01-10T18:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535529",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`9d0b7a1`](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)**



---

archive/issue_events_452772.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T18:07:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452772"
}
```



---

archive/issue_comments_535530.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nboring and painful update..\n\nany expert on pickles aboard ?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169\"><code>9d0b7a1</code></a></td><td><code>removal of py2 tag in doctests of explain pickle (first wave)</code></td></tr></table>\n",
    "created_at": "2022-01-10T18:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535530",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">comment:1</div>

boring and painful update..

any expert on pickles aboard ?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169"><code>9d0b7a1</code></a></td><td><code>removal of py2 tag in doctests of explain pickle (first wave)</code></td></tr></table>




---

archive/issue_events_452773.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T19:54:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452773"
}
```



---

archive/issue_events_452774.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-10T19:54:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452774"
}
```



---

archive/issue_events_452775.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T08:33:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452775"
}
```



---

archive/issue_events_452776.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T08:33:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452776"
}
```



---

archive/issue_comments_535531.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nok, let's do that in several steps. Please review this first step.",
    "created_at": "2022-03-20T08:33:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535531",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

ok, let's do that in several steps. Please review this first step.



---

archive/issue_events_452777.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452777"
}
```



---

archive/issue_events_452778.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452778"
}
```



---

archive/issue_comments_535532.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nplease somebody have a look\n\nThis is the last file containing `#py2` tags. Here I remove only the simple ones, and the changes should rather be uncontroversial. The remaining cases are out of my capacity, and require an expert of pickle, that we may no longer have anywhere in sight..\n\nOne alternative would be #27350 (externalize) or just drop the file completely.",
    "created_at": "2022-06-11T07:10:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535532",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

please somebody have a look

This is the last file containing `#py2` tags. Here I remove only the simple ones, and the changes should rather be uncontroversial. The remaining cases are out of my capacity, and require an expert of pickle, that we may no longer have anywhere in sight..

One alternative would be #27350 (externalize) or just drop the file completely.



---

archive/issue_comments_535533.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt would be wonderful for Erik Bray to work on #27350 and close this ticket as `invalid/wontfix`. \n\nIf that would not happen, then I think we should fix `explain_pickle` for python3 before we remove the py2 tag, instead of \"fixing\" doctests for the broken `explain_pickle`.",
    "created_at": "2022-06-14T06:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535533",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">comment:7</div>

It would be wonderful for Erik Bray to work on #27350 and close this ticket as `invalid/wontfix`. 

If that would not happen, then I think we should fix `explain_pickle` for python3 before we remove the py2 tag, instead of "fixing" doctests for the broken `explain_pickle`.



---

archive/issue_comments_535534.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAs far as I understand, Erik is no longer available.",
    "created_at": "2022-06-14T06:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535534",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

As far as I understand, Erik is no longer available.



---

archive/issue_comments_535535.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-06-14T07:07:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535535",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_535536.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nIn principle, I agree with #27350, but I am slightly worried about the practice of it since I find this tool to be very useful at times and would be saddened if it bitrotted. I, unfortunately, would not be able to maintain such a package as I don't understand how `explain_pickle()` works. Since these doctests seem to just be updating the output, I think we should merge these in now. Likewise, I don't think I could help with any of the further marked tests.\n\nKwankyu, any objections to me setting a positive review?",
    "created_at": "2022-06-14T07:07:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535536",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

In principle, I agree with #27350, but I am slightly worried about the practice of it since I find this tool to be very useful at times and would be saddened if it bitrotted. I, unfortunately, would not be able to maintain such a package as I don't understand how `explain_pickle()` works. Since these doctests seem to just be updating the output, I think we should merge these in now. Likewise, I don't think I could help with any of the further marked tests.

Kwankyu, any objections to me setting a positive review?



---

archive/issue_comments_535537.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@tscrim](#comment:9):\n> Since these doctests seem to just be updating the output, \n\nSome outputs from `explain_pickle` (via `test_pickle`), for instance,\n\n```diff\n             sage: from sage.misc.explain_pickle import *\n-            sage: test_pickle(dumps(100000r, compress=False))  # py2\n-                0: \\x80 PROTO      2\n-                2: J    BININT     100000\n-                7: .    STOP\n-            highest protocol among opcodes = 2\n-            explain_pickle in_current_sage=True/False:\n-            100000\n-            result: 100000\n+            sage: test_pickle(dumps(100000r, compress=False))\n+                    0: \\x80 PROTO      2\n+                    2: c    GLOBAL     '_codecs encode'\n+                   18: q    BINPUT     0\n+                   20: X    BINUNICODE '\\x80\\x02J\\xa0\\x86\\x01\\x00.'\n+                   36: q    BINPUT     1\n+                   38: X    BINUNICODE 'latin1'\n+                   49: q    BINPUT     2\n+                   51: \\x86 TUPLE2\n+                   52: q    BINPUT     3\n+                   54: R    REDUCE\n+                   55: q    BINPUT     4\n+                   57: .    STOP\n+                highest protocol among opcodes = 2\n+                explain_pickle in_current_sage=True:\n+                from _codecs import encode\n+                encode('\\x80\\x02J\\xa0\\x86\\x01\\x00.', 'latin1')\n+                explain_pickle in_current_sage=False:\n+                pg_encode = unpickle_global('_codecs', 'encode')\n+                pg_encode('\\x80\\x02J\\xa0\\x86\\x01\\x00.', 'latin1')\n+                result: b'\\x80\\x02J\\xa0\\x86\\x01\\x00.'\n```\n\n\nseem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\nIndentations of outputs are wrong.",
    "created_at": "2022-06-14T07:29:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535537",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@tscrim](#comment:9):
> Since these doctests seem to just be updating the output, 

Some outputs from `explain_pickle` (via `test_pickle`), for instance,

```diff
             sage: from sage.misc.explain_pickle import *
-            sage: test_pickle(dumps(100000r, compress=False))  # py2
-                0: \x80 PROTO      2
-                2: J    BININT     100000
-                7: .    STOP
-            highest protocol among opcodes = 2
-            explain_pickle in_current_sage=True/False:
-            100000
-            result: 100000
+            sage: test_pickle(dumps(100000r, compress=False))
+                    0: \x80 PROTO      2
+                    2: c    GLOBAL     '_codecs encode'
+                   18: q    BINPUT     0
+                   20: X    BINUNICODE '\x80\x02J\xa0\x86\x01\x00.'
+                   36: q    BINPUT     1
+                   38: X    BINUNICODE 'latin1'
+                   49: q    BINPUT     2
+                   51: \x86 TUPLE2
+                   52: q    BINPUT     3
+                   54: R    REDUCE
+                   55: q    BINPUT     4
+                   57: .    STOP
+                highest protocol among opcodes = 2
+                explain_pickle in_current_sage=True:
+                from _codecs import encode
+                encode('\x80\x02J\xa0\x86\x01\x00.', 'latin1')
+                explain_pickle in_current_sage=False:
+                pg_encode = unpickle_global('_codecs', 'encode')
+                pg_encode('\x80\x02J\xa0\x86\x01\x00.', 'latin1')
+                result: b'\x80\x02J\xa0\x86\x01\x00.'
```


seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

Indentations of outputs are wrong.



---

archive/issue_comments_535538.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@kwankyu](#comment:10):\n> Replying to [@tscrim](#comment:9):\n> > Since these doctests seem to just be updating the output, \n\n> seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\nThe pickle itself has changed. If you run `loads(dumps(100000r))`, it returns the correct object without error. In this case, it is likely because `int` has changed from Python2 to Python3.\n\n> Indentations of outputs are wrong. \n\nIndeed; although I found the extra indentation level helped make clear what the doctest outputs were since they are so long with their own indentation. I don't hold a strong opinion on changing this or not.",
    "created_at": "2022-06-14T07:37:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535538",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@kwankyu](#comment:10):
> Replying to [@tscrim](#comment:9):
> > Since these doctests seem to just be updating the output, 

> seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

The pickle itself has changed. If you run `loads(dumps(100000r))`, it returns the correct object without error. In this case, it is likely because `int` has changed from Python2 to Python3.

> Indentations of outputs are wrong. 

Indeed; although I found the extra indentation level helped make clear what the doctest outputs were since they are so long with their own indentation. I don't hold a strong opinion on changing this or not.



---

archive/issue_comments_535539.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@tscrim](#comment:11):\n> Replying to [@kwankyu](#comment:10):\n> > Replying to [@tscrim](#comment:9):\n> > > Since these doctests seem to just be updating the output, \n\n> \n> > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\n> \n> The pickle itself has changed. \n\nI meant the `result`. Shouldn't it be `100000`?",
    "created_at": "2022-06-14T07:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535539",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@tscrim](#comment:11):
> Replying to [@kwankyu](#comment:10):
> > Replying to [@tscrim](#comment:9):
> > > Since these doctests seem to just be updating the output, 

> 
> > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

> 
> The pickle itself has changed. 

I meant the `result`. Shouldn't it be `100000`?



---

archive/issue_comments_535540.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kwankyu](#comment:12):\n> Replying to [@tscrim](#comment:11):\n> > Replying to [@kwankyu](#comment:10):\n> > > Replying to [@tscrim](#comment:9):\n> > > > Since these doctests seem to just be updating the output, \n\n> > \n> > > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.\n\n> > \n> > The pickle itself has changed. \n\n> \n> I meant the `result`. Shouldn't it be `100000`?\n\nI believe it is the right result but represented or interpreted in the wrong format. Mainly the bytes returned are not converted to a string correctly or something similar.",
    "created_at": "2022-06-14T08:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535540",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kwankyu](#comment:12):
> Replying to [@tscrim](#comment:11):
> > Replying to [@kwankyu](#comment:10):
> > > Replying to [@tscrim](#comment:9):
> > > > Since these doctests seem to just be updating the output, 

> > 
> > > seem wrong, which indicates it worked fine with py2 but is now broken with py3. Do we ever correct doctests for wrong output? I think leaving them with py2 tag is right if we do not fix the broken `explain_pickle`.

> > 
> > The pickle itself has changed. 

> 
> I meant the `result`. Shouldn't it be `100000`?

I believe it is the right result but represented or interpreted in the wrong format. Mainly the bytes returned are not converted to a string correctly or something similar.



---

archive/issue_comments_535541.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nPerhaps we just don't remove the tag in the cases when the result is (at least superficially) different?",
    "created_at": "2022-06-14T08:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535541",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Perhaps we just don't remove the tag in the cases when the result is (at least superficially) different?



---

archive/issue_comments_535542.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@tscrim](#comment:14):\n> Perhaps we just don't remove the tag in the cases when the result is (at least superficially) different?\n\n+1",
    "created_at": "2022-06-14T08:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535542",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@tscrim](#comment:14):
> Perhaps we just don't remove the tag in the cases when the result is (at least superficially) different?

+1



---

archive/issue_comments_535543.json:
```json
{
    "body": "Changed branch from **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)** to **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)**",
    "created_at": "2022-06-14T12:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535543",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/chapoton/33144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33144)** to **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)**



---

archive/issue_comments_535544.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nhere is a new branch, where I have dropped the changes that did no look right\n\nI may have missed some\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed\"><code>cf9a6d9</code></a></td><td><code>remove only some simple #py2 tags in explain_pickle</code></td></tr></table>\n",
    "created_at": "2022-06-14T12:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535544",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

here is a new branch, where I have dropped the changes that did no look right

I may have missed some

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed"><code>cf9a6d9</code></a></td><td><code>remove only some simple #py2 tags in explain_pickle</code></td></tr></table>




---

archive/issue_comments_535545.json:
```json
{
    "body": "Changed commit from **[`9d0b7a1`](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)** to **[`cf9a6d9`](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)**",
    "created_at": "2022-06-14T12:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535545",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`9d0b7a1`](https://github.com/sagemath/sagetrac-mirror/commit/9d0b7a16dce0b3adeeaf7da35a11ad2188498169)** to **[`cf9a6d9`](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)**



---

archive/issue_comments_535546.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHow about indentations? Did you indent more spaces intentionally?",
    "created_at": "2022-06-14T12:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535546",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:17" align="right">comment:17</div>

How about indentations? Did you indent more spaces intentionally?



---

archive/issue_comments_535547.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI think outputs should look as they do on the command line, modulo wrappings.",
    "created_at": "2022-06-14T12:24:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535547",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:18" align="right">comment:18</div>

I think outputs should look as they do on the command line, modulo wrappings.



---

archive/issue_comments_535548.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0\"><code>3c82b13</code></a></td><td><code>remove some #py2 tags in explain_pickle</code></td></tr></table>\n",
    "created_at": "2022-06-15T08:16:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535548",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0"><code>3c82b13</code></a></td><td><code>remove some #py2 tags in explain_pickle</code></td></tr></table>




---

archive/issue_comments_535549.json:
```json
{
    "body": "Changed commit from **[`cf9a6d9`](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)** to **[`3c82b13`](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)**",
    "created_at": "2022-06-15T08:16:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535549",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cf9a6d9`](https://github.com/sagemath/sagetrac-mirror/commit/cf9a6d92b3a5a0823adfd07cabb120a8fdeb64ed)** to **[`3c82b13`](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)**



---

archive/issue_comments_535550.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nnow the same as previous one, only with less indentations",
    "created_at": "2022-06-15T08:16:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535550",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

now the same as previous one, only with less indentations



---

archive/issue_comments_535551.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThanks. But some cases with different `result` are still in.",
    "created_at": "2022-06-15T08:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535551",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:21" align="right">comment:21</div>

Thanks. But some cases with different `result` are still in.



---

archive/issue_comments_535552.json:
```json
{
    "body": "patch for removing some #py2 tags",
    "created_at": "2022-06-26T07:30:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535552",
    "user": "https://github.com/fchapoton"
}
```

patch for removing some #py2 tags



---

archive/issue_comments_535553.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAttachment: **[0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz](https://github.com/sagemath/sage/files/ticket33144/0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz)**\n\nThen maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.",
    "created_at": "2022-06-26T07:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535553",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

Attachment: **[0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz](https://github.com/sagemath/sage/files/ticket33144/0001-removal-of-py2-tag-in-doctests-of-explain-pickle-fir.patch.gz)**

Then maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.



---

archive/issue_comments_535554.json:
```json
{
    "body": "Changed commit from **[`3c82b13`](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)** to **[`131841f`](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**",
    "created_at": "2022-06-26T11:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535554",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3c82b13`](https://github.com/sagemath/sagetrac-mirror/commit/3c82b13c6393dee104fc91fca80cc745b38f57c0)** to **[`131841f`](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**



---

archive/issue_comments_535555.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b47176e2a4efebc865e2bca2fdef7ffd3823ec23\"><code>b47176e</code></a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75\"><code>131841f</code></a></td><td><code>Restore py2 tag for cases with different result</code></td></tr></table>\n",
    "created_at": "2022-06-26T11:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535555",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b47176e2a4efebc865e2bca2fdef7ffd3823ec23"><code>b47176e</code></a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75"><code>131841f</code></a></td><td><code>Restore py2 tag for cases with different result</code></td></tr></table>




---

archive/issue_comments_535556.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@fchapoton](#comment:22):\n> Then maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.\n\nThat is done over your last commit.",
    "created_at": "2022-06-26T11:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535556",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@fchapoton](#comment:22):
> Then maybe the simplest way would be if you could please edit the attached patch file : keep only the changes that you find appropriate and make a branch from that modified patch.

That is done over your last commit.



---

archive/issue_comments_535557.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Kwankyu Lee**",
    "created_at": "2022-06-26T11:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535557",
    "user": "https://github.com/kwankyu"
}
```

Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Kwankyu Lee**



---

archive/issue_comments_535558.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n``````\n",
    "created_at": "2022-06-26T11:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535558",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).
``````




---

archive/issue_comments_535559.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI am positive now.",
    "created_at": "2022-06-26T11:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535559",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:25" align="right">comment:25</div>

I am positive now.



---

archive/issue_events_452779.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-26T11:09:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "title_is": "Remove py2 tags in explain_pickle",
    "title_was": "remove py2 tags in explain_pickle",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452779"
}
```



---

archive/issue_events_452780.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-06-26T17:00:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "title_is": "Remove some py2 tags in explain_pickle",
    "title_was": "Remove py2 tags in explain_pickle",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452780"
}
```



---

archive/issue_comments_535560.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n+We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).\n``````\n",
    "created_at": "2022-06-26T17:00:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535560",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-We remove py2 tags from `explain_pickle` doctests which we still get correct results (with python3).
+We remove some py2 tags from `explain_pickle` doctests which we still get correct results (with python3).
``````




---

archive/issue_comments_535561.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nthanks, you can set to positive if you wish",
    "created_at": "2022-06-26T17:00:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535561",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:26" align="right">comment:26</div>

thanks, you can set to positive if you wish



---

archive/issue_comments_535562.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThanks.",
    "created_at": "2022-06-27T00:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535562",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:27" align="right">comment:27</div>

Thanks.



---

archive/issue_events_452781.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452781"
}
```



---

archive/issue_events_452782.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452782"
}
```



---

archive/issue_events_452783.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452783"
}
```



---

archive/issue_events_452784.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-06-27T00:09:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452784"
}
```



---

archive/issue_events_452785.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:31:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452785"
}
```



---

archive/issue_events_452786.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "64e29cf9d907deb878854764070019d1eb2506b7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-07-09T22:31:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33144#event-452786"
}
```



---

archive/issue_comments_535563.json:
```json
{
    "body": "Changed branch from **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)** to **[`131841f`](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**",
    "created_at": "2022-07-09T22:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33144#issuecomment-535563",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/33144-short](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33144-short)** to **[`131841f`](https://github.com/sagemath/sagetrac-mirror/commit/131841fbde0a3bc9bc62bac4381082d49251fb75)**
