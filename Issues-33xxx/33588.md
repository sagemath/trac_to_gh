# Issue 33588: warnings to ignore are not ignored when a doctest is tagged with # tol

archive/issues_033351.json:
```json
{
    "assignees": [],
    "body": "## The symptom\n\nOn Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, with the GLPK available on the system `$ glpsol -v` returning `GLPSOL: GLPK LP/MIP Solver, v4.65`, we observe doctest failures of the following kind:\n\n```\nFailed example:\n    lp.solve() # tol 1e-8   # optional - sage.rings.number_field\nExpected:\n    1.3090169943749475\nGot:\n    Long-step dual simplex will be used\n    1.3090169943749472\n```\n\nFailures always consists of doctests tagged with some numerical tolerence `# tol`. It seems the fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.\n\n\nThe complete list of failures consist of the following 4 files:\n\n```\nsage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py\n```\ngives\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/geometry/polyhedron/base.py  # 1 doctest failed\nsage -t --long src/sage/numerical/backends/glpk_backend.pyx  # 4 doctests failed\nsage -t --long src/sage/numerical/mip.pyx  # 8 doctests failed\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\n\n## Isolation of the problem\n\nThe problem was understood in [comment:7](#comment%3A7). The warnings are not ignored by `check_output` method when tolerance tags are given. The following example illustrate the issue, the last line should be True:\n\n```\nsage: from sage.doctest.parsing import SageOutputChecker, SageDocTestParser\nsage: import doctest\nsage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS\nsage: DTP = SageDocTestParser(('sage','magma','guava'))\nsage: OC = SageOutputChecker()\nsage: example = \"sage: 1.3090169943749475 # tol 1e-8\\n1.3090169943749475\"\nsage: ex = DTP.parse(example)[1]\nsage: ex.sage_source\n'1.3090169943749475 # tol 1e-8\\n'\nsage: ex.want\n'1.3090169943749475\\n'\nsage: OC.check_output(ex.want, '1.3090169943749475', optflag)\nTrue\nsage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)\nFalse\nsage: OC.check_output(ex.want, 'Long-step dual simplex will be used\\n1.3090169943749475', optflag)\nFalse\n```\n\n## The problem with the current code\n\nIt can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.\n\nMore precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.\n\n## The solution\n\nThe solution is not to return False at line 934 when the non-float part is not equal. In fact it is better to first check that all floats intervals intersect (currently done at line 942) and return False if not all intervals intersect.\n\nThen, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given instead of returning False.\n\n## Further improvements\n\nWe create a independent method `do_fixup` which does the removal of eventual warnings as a last resort solution before returning False.\n\nTo ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for the follow-up ticket #33680.\n\nCC:  @kiwifb\n\nBranch/Commit: **[2afb472](https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa)**\n\nReviewer: **John Palmieri**\n\nAuthor: **S\u00e9bastien Labb\u00e9**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33588_\n\n",
    "closed_at": "2022-04-24T06:31:07Z",
    "created_at": "2022-03-29T12:54:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20numerical",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "warnings to ignore are not ignored when a doctest is tagged with # tol",
    "type": "issue",
    "updated_at": "2022-04-24T06:31:07Z",
    "url": "https://github.com/sagemath/sage/issues/33588",
    "user": "https://github.com/seblabbe"
}
```
## The symptom

On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, with the GLPK available on the system `$ glpsol -v` returning `GLPSOL: GLPK LP/MIP Solver, v4.65`, we observe doctest failures of the following kind:

```
Failed example:
    lp.solve() # tol 1e-8   # optional - sage.rings.number_field
Expected:
    1.3090169943749475
Got:
    Long-step dual simplex will be used
    1.3090169943749472
```

Failures always consists of doctests tagged with some numerical tolerence `# tol`. It seems the fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.


The complete list of failures consist of the following 4 files:

```
sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py
```
gives

```
----------------------------------------------------------------------
sage -t --long src/sage/geometry/polyhedron/base.py  # 1 doctest failed
sage -t --long src/sage/numerical/backends/glpk_backend.pyx  # 4 doctests failed
sage -t --long src/sage/numerical/mip.pyx  # 8 doctests failed
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py  # 2 doctests failed
----------------------------------------------------------------------
```

## Isolation of the problem

The problem was understood in [comment:7](#comment%3A7). The warnings are not ignored by `check_output` method when tolerance tags are given. The following example illustrate the issue, the last line should be True:

```
sage: from sage.doctest.parsing import SageOutputChecker, SageDocTestParser
sage: import doctest
sage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS
sage: DTP = SageDocTestParser(('sage','magma','guava'))
sage: OC = SageOutputChecker()
sage: example = "sage: 1.3090169943749475 # tol 1e-8\n1.3090169943749475"
sage: ex = DTP.parse(example)[1]
sage: ex.sage_source
'1.3090169943749475 # tol 1e-8\n'
sage: ex.want
'1.3090169943749475\n'
sage: OC.check_output(ex.want, '1.3090169943749475', optflag)
True
sage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)
False
sage: OC.check_output(ex.want, 'Long-step dual simplex will be used\n1.3090169943749475', optflag)
False
```

## The problem with the current code

It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.

More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.

## The solution

The solution is not to return False at line 934 when the non-float part is not equal. In fact it is better to first check that all floats intervals intersect (currently done at line 942) and return False if not all intervals intersect.

Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given instead of returning False.

## Further improvements

We create a independent method `do_fixup` which does the removal of eventual warnings as a last resort solution before returning False.

To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for the follow-up ticket #33680.

CC:  @kiwifb

Branch/Commit: **[2afb472](https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa)**

Reviewer: **John Palmieri**

Author: **Sébastien Labbé**

_Issue created by migration from https://trac.sagemath.org/ticket/33588_





---

archive/issue_events_442905.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-03-29T12:54:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442905"
}
```



---

archive/issue_events_442906.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-03-29T12:54:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20numerical",
    "label_color": "0000ff",
    "label_name": "component: numerical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442906"
}
```



---

archive/issue_events_442907.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-03-29T12:54:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442907"
}
```



---

archive/issue_events_442908.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-03-29T12:54:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442908"
}
```



---

archive/issue_comments_545678.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The command\n+With `SageMath version 9.6.beta6, Release Date: 2022-03-27`, the command\n \n ```\n sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py\n``````\n",
    "created_at": "2022-03-29T12:56:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545678",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The command
+With `SageMath version 9.6.beta6, Release Date: 2022-03-27`, the command
 
 ```
 sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py
``````




---

archive/issue_comments_545679.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\n\n```\nDoctesting 4 files.\nsage -t --long --random-seed=19 geometry/polyhedron/base.py\n    28 latte_int tests not run\n    0 tests not run because we ran out of time\n    [320 tests, 31.72 s]\nsage -t --long --random-seed=19 numerical/backends/glpk_backend.pyx\n    0 tests not run because we ran out of time\n    [592 tests, 4.18 s]\nsage -t --long --random-seed=19 numerical/mip.pyx\n    8 cplex tests not run\n    3 gurobi tests not run\n    7 not tested tests not run\n    0 tests not run because we ran out of time\n    [713 tests, 1.60 s]\nsage -t --long --random-seed=19 tests/books/computational-mathematics-with-sagemath/lp_doctest.py\n    0 tests not run because we ran out of time\n    [68 tests, 0.04 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 39.3 seconds\n    cpu time: 20.1 seconds\n    cumulative wall time: 37.5 seconds\n```\nbut that is `9.6.beta6` + #31962",
    "created_at": "2022-03-29T17:14:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545679",
    "user": "https://github.com/sheerluck"
}
```

<a id='comment:2'>Comment 2:</a>

```
Doctesting 4 files.
sage -t --long --random-seed=19 geometry/polyhedron/base.py
    28 latte_int tests not run
    0 tests not run because we ran out of time
    [320 tests, 31.72 s]
sage -t --long --random-seed=19 numerical/backends/glpk_backend.pyx
    0 tests not run because we ran out of time
    [592 tests, 4.18 s]
sage -t --long --random-seed=19 numerical/mip.pyx
    8 cplex tests not run
    3 gurobi tests not run
    7 not tested tests not run
    0 tests not run because we ran out of time
    [713 tests, 1.60 s]
sage -t --long --random-seed=19 tests/books/computational-mathematics-with-sagemath/lp_doctest.py
    0 tests not run because we ran out of time
    [68 tests, 0.04 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 39.3 seconds
    cpu time: 20.1 seconds
    cumulative wall time: 37.5 seconds
```
but that is `9.6.beta6` + #31962



---

archive/issue_comments_545680.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nSee also #29317, where we solved this problem once before. Is this with a system version of GLPK? I'm not sure why the fix at #29317 is not catching this, in fact.",
    "created_at": "2022-03-29T22:39:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545680",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'>Comment 3:</a>
See also #29317, where we solved this problem once before. Is this with a system version of GLPK? I'm not sure why the fix at #29317 is not catching this, in fact.



---

archive/issue_comments_545681.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -69,3 +69,18 @@\n     cumulative wall time: 16.7 seconds\n Features detected for doctesting: sage.combinat,sage.graphs,sage.rings.number_field\n ```\n+\n+This is with:\n+\n+```\n+$ glpsol -v\n+GLPSOL: GLPK LP/MIP Solver, v4.65\n+Copyright (C) 2000-2017 Andrew Makhorin, Department for Applied\n+Informatics, Moscow Aviation Institute, Moscow, Russia. All rights\n+reserved. E-mail: <mao@gnu.org>.\n+\n+This program has ABSOLUTELY NO WARRANTY.\n+\n+This program is free software; you may re-distribute it under the terms\n+of the GNU General Public License version 3 or later.\n+```\n``````\n",
    "created_at": "2022-03-31T09:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545681",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -69,3 +69,18 @@
     cumulative wall time: 16.7 seconds
 Features detected for doctesting: sage.combinat,sage.graphs,sage.rings.number_field
 ```
+
+This is with:
+
+```
+$ glpsol -v
+GLPSOL: GLPK LP/MIP Solver, v4.65
+Copyright (C) 2000-2017 Andrew Makhorin, Department for Applied
+Informatics, Moscow Aviation Institute, Moscow, Russia. All rights
+reserved. E-mail: <mao@gnu.org>.
+
+This program has ABSOLUTELY NO WARRANTY.
+
+This program is free software; you may re-distribute it under the terms
+of the GNU General Public License version 3 or later.
+```
``````




---

archive/issue_comments_545682.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [@jhpalmieri](#comment%3A3):\n> See also #29317, where we solved this problem once before. Is this with a system version of GLPK? I'm not sure why the fix at #29317 is not catching this, in fact.\n\nYes, it is the glpk from the system:\n\n```\n$ grep glpk config.log\n## Checking whether SageMath should install SPKG glpk... ##\nconfigure:12313: checking glpk.h usability\nconfigure:12313: checking glpk.h presence\nconfigure:12313: checking for glpk.h\nconfigure:12352: g++ -std=gnu++11 -o conftest    conftest.cpp -lglpk  -lgmp -lm  >&5\nconfigure:12369: result: -lglpk\nconfigure:12374: result: yes. Use system's glpk\nconfigure:12395: will use system package and not install SPKG glpk\nconfigure:12434: result: using glpk from the system\n```\n\nThis one:\n\n```\n$ glpsol -v\nGLPSOL: GLPK LP/MIP Solver, v4.65\n```",
    "created_at": "2022-03-31T09:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545682",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [@jhpalmieri](#comment%3A3):
> See also #29317, where we solved this problem once before. Is this with a system version of GLPK? I'm not sure why the fix at #29317 is not catching this, in fact.

Yes, it is the glpk from the system:

```
$ grep glpk config.log
## Checking whether SageMath should install SPKG glpk... ##
configure:12313: checking glpk.h usability
configure:12313: checking glpk.h presence
configure:12313: checking for glpk.h
configure:12352: g++ -std=gnu++11 -o conftest    conftest.cpp -lglpk  -lgmp -lm  >&5
configure:12369: result: -lglpk
configure:12374: result: yes. Use system's glpk
configure:12395: will use system package and not install SPKG glpk
configure:12434: result: using glpk from the system
```

This one:

```
$ glpsol -v
GLPSOL: GLPK LP/MIP Solver, v4.65
```



---

archive/issue_comments_545683.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAs I said, I wonder why the fix from #29317 is not catching this. From `sage.doctest.parsing`:\n\n```\n# Version 4.65 of glpk prints the warning \"Long-step dual simplex will\n# be used\" frequently. When Sage uses a system installation of glpk\n# which has not been patched, we need to ignore that message.\n# See :trac:`29317`.\nglpk_simplex_warning_regex = re.compile(r'(Long-step dual simplex will be used)')\n```\nand then later on, that regular expression should be filtered out.",
    "created_at": "2022-03-31T16:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545683",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'>Comment 6:</a>
As I said, I wonder why the fix from #29317 is not catching this. From `sage.doctest.parsing`:

```
# Version 4.65 of glpk prints the warning "Long-step dual simplex will
# be used" frequently. When Sage uses a system installation of glpk
# which has not been patched, we need to ignore that message.
# See :trac:`29317`.
glpk_simplex_warning_regex = re.compile(r'(Long-step dual simplex will be used)')
```
and then later on, that regular expression should be filtered out.



---

archive/issue_comments_545684.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@jhpalmieri](#comment%3A6):\n> As I said, I wonder why the fix from #29317 is not catching this.\n\nI got it. It is because the `# tol 1e-8` is dealt in the `check_output` method before the glpk regex get replaced.\n\nThe following behavior is fine:\n\n```\nsage: import doctest\nsage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS\nsage: from sage.doctest.parsing import SageOutputChecker\nsage: OC = SageOutputChecker()\nsage: OC.check_output('1.3090169943749475','1.3090169943749475',optflag)\nTrue\nsage: OC.check_output('1.3090169943749475','ANYTHING1.3090169943749475',optflag)\nFalse\nsage: OC.check_output('1.3090169943749475','Long-step dual simplex will be used\\n1.3090169943749475',optflag)\nTrue\n```\n\nThe following is ok as well:\n\n```\nsage: from sage.doctest.parsing import SageOutputChecker, SageDocTestParser\nsage: import doctest\nsage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS\nsage: DTP = SageDocTestParser(('sage','magma','guava'))\nsage: OC = SageOutputChecker()\nsage: example = \"sage: 1.3090169943749475\\n1.3090169943749475\"\nsage: ex = DTP.parse(example)[1]\nsage: ex.want\n'1.3090169943749475\\n'\nsage: OC.check_output(ex.want, '1.3090169943749475', optflag)\nTrue\nsage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)\nFalse\nsage: OC.check_output(ex.want, 'Long-step dual simplex will be used\\n1.3090169943749475', optflag)\nTrue\n```\n\nThe following illustrates the bug (the last line should be True):\n\n```\nsage: example = \"sage: 1.3090169943749475 # tol 1e-8\\n1.3090169943749475\"\nsage: ex = DTP.parse(example)[1]\nsage: ex.sage_source\n'1.3090169943749475 # tol 1e-8\\n'\nsage: ex.want\n'1.3090169943749475\\n'\nsage: OC.check_output(ex.want, '1.3090169943749475', optflag)\nTrue\nsage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)\nFalse\nsage: OC.check_output(ex.want, 'Long-step dual simplex will be used\\n1.3090169943749475', optflag)\nFalse\n```\n\nObserve that turning `ex.want` back to a string fixes it because I think the return is made in the `if isinstance(want, MarkedOutput):` block within the `check_output` method:\n\n```\nsage: type(ex.want)\n<class 'sage.doctest.parsing.MarkedOutput'>\nsage: sage: OC.check_output(str(ex.want), 'Long-step dual simplex will be used\\n1.3090169943749475', optflag)\nTrue\n```",
    "created_at": "2022-04-01T15:28:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545684",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@jhpalmieri](#comment%3A6):
> As I said, I wonder why the fix from #29317 is not catching this.

I got it. It is because the `# tol 1e-8` is dealt in the `check_output` method before the glpk regex get replaced.

The following behavior is fine:

```
sage: import doctest
sage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS
sage: from sage.doctest.parsing import SageOutputChecker
sage: OC = SageOutputChecker()
sage: OC.check_output('1.3090169943749475','1.3090169943749475',optflag)
True
sage: OC.check_output('1.3090169943749475','ANYTHING1.3090169943749475',optflag)
False
sage: OC.check_output('1.3090169943749475','Long-step dual simplex will be used\n1.3090169943749475',optflag)
True
```

The following is ok as well:

```
sage: from sage.doctest.parsing import SageOutputChecker, SageDocTestParser
sage: import doctest
sage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS
sage: DTP = SageDocTestParser(('sage','magma','guava'))
sage: OC = SageOutputChecker()
sage: example = "sage: 1.3090169943749475\n1.3090169943749475"
sage: ex = DTP.parse(example)[1]
sage: ex.want
'1.3090169943749475\n'
sage: OC.check_output(ex.want, '1.3090169943749475', optflag)
True
sage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)
False
sage: OC.check_output(ex.want, 'Long-step dual simplex will be used\n1.3090169943749475', optflag)
True
```

The following illustrates the bug (the last line should be True):

```
sage: example = "sage: 1.3090169943749475 # tol 1e-8\n1.3090169943749475"
sage: ex = DTP.parse(example)[1]
sage: ex.sage_source
'1.3090169943749475 # tol 1e-8\n'
sage: ex.want
'1.3090169943749475\n'
sage: OC.check_output(ex.want, '1.3090169943749475', optflag)
True
sage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)
False
sage: OC.check_output(ex.want, 'Long-step dual simplex will be used\n1.3090169943749475', optflag)
False
```

Observe that turning `ex.want` back to a string fixes it because I think the return is made in the `if isinstance(want, MarkedOutput):` block within the `check_output` method:

```
sage: type(ex.want)
<class 'sage.doctest.parsing.MarkedOutput'>
sage: sage: OC.check_output(str(ex.want), 'Long-step dual simplex will be used\n1.3090169943749475', optflag)
True
```



---

archive/issue_events_442909.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-03T18:57:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442909"
}
```



---

archive/issue_events_442910.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-03T18:57:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442910"
}
```



---

archive/issue_events_442911.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-07T15:15:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442911"
}
```



---

archive/issue_comments_545685.json:
```json
{
    "body": "Branch: **[u/slabbe/33588](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33588)**",
    "created_at": "2022-04-07T15:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545685",
    "user": "https://github.com/seblabbe"
}
```

Branch: **[u/slabbe/33588](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33588)**



---

archive/issue_comments_545686.json:
```json
{
    "body": "Author: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2022-04-07T15:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545686",
    "user": "https://github.com/seblabbe"
}
```

Author: **Sébastien Labbé**



---

archive/issue_comments_545687.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nI found a way to fix the issue.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d175231f0d22d5dd5b0255ed07f72aa47833f938\">d175231</a></td><td><code>33588: adding try_fixup method in the SageOutputChecker</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a67986cbc03474f19a3b699d3a44c1d5f36d6139\">a67986c</a></td><td><code>33588: continue to compare the non-floats part of doctests when tolerance is given</code></td></tr></table>\n",
    "created_at": "2022-04-07T15:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545687",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:9'>Comment 9:</a>
I found a way to fix the issue.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d175231f0d22d5dd5b0255ed07f72aa47833f938">d175231</a></td><td><code>33588: adding try_fixup method in the SageOutputChecker</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a67986cbc03474f19a3b699d3a44c1d5f36d6139">a67986c</a></td><td><code>33588: continue to compare the non-floats part of doctests when tolerance is given</code></td></tr></table>




---

archive/issue_comments_545688.json:
```json
{
    "body": "Commit: **[a67986c](https://github.com/sagemath/sagetrac-mirror/commit/a67986cbc03474f19a3b699d3a44c1d5f36d6139)**",
    "created_at": "2022-04-07T15:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545688",
    "user": "https://github.com/seblabbe"
}
```

Commit: **[a67986c](https://github.com/sagemath/sagetrac-mirror/commit/a67986cbc03474f19a3b699d3a44c1d5f36d6139)**



---

archive/issue_comments_545689.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nThe code as it is now works and fixes the issue in the description of this ticket. Doing so, I added a new method `try_fixup` which helps understand what is happening. The way it is written follows how the code was written before. But here are few things that I dislike and that could be improved if reviewers agree:\n\n- parameter `want` is not changed by `try_fixup`, only `got`, so why should `fixup` take `want` as input?\n- the list `_repr_fixups` is defined in the header of the module but it is used only in the `try_fixup` method. I think it would make sense to remove it from the header and move it down inside the `try_fixup` method. It would make the `try_fixup` method more usable. More precisely, when somethings goes wrong for instance while debugging #33588, it is practical to add few `print` statements to see what is happening but it is quite painful to add a print statement inside of the lambda functions defined in the `_repr_fixups` at the top of the module.\n- Since `_repr_fixups` is defined completely out of context in the top module it comes with 8 lines of documentation painfully explaining what it is. These lines would just disappear by defining them in context inside of the `try_fixup` method.\n\n```python\n# Collection of fixups applied in the SageOutputChecker.  Each element in this\n# this list a pair of functions applied to the actual test output ('g' for\n# \"got\") and the expected test output ('w' for \"wanted\").  The first function\n# should be a simple fast test on the expected and/or actual output to                 \n# determine if a fixup should be applied.  The second function is the actual\n# fixup, which is applied if the test function passes.  In most fixups only one\n# of the expected or received outputs are normalized, depending on the\n# application.                            \n_repr_fixups = [                                                          \n    (lambda g, w: \"Long-step\" in g,         \n     lambda g, w: (glpk_simplex_warning_regex.sub('', g), w)),\n                                  \n    (lambda g, w: \"dylib\" in g,                             \n     lambda g, w: (ld_warning_regex.sub('', g), w)),             \n                                                                    \n    (lambda g, w: \"pie being ignored\" in g,                              \n     lambda g, w: (ld_pie_warning_regex.sub('', g), w))                                          \n]    \n```\n\nIf reviewers agree with me, I will do one more commit improving that.",
    "created_at": "2022-04-07T15:27:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545689",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:10'>Comment 10:</a>
The code as it is now works and fixes the issue in the description of this ticket. Doing so, I added a new method `try_fixup` which helps understand what is happening. The way it is written follows how the code was written before. But here are few things that I dislike and that could be improved if reviewers agree:

- parameter `want` is not changed by `try_fixup`, only `got`, so why should `fixup` take `want` as input?
- the list `_repr_fixups` is defined in the header of the module but it is used only in the `try_fixup` method. I think it would make sense to remove it from the header and move it down inside the `try_fixup` method. It would make the `try_fixup` method more usable. More precisely, when somethings goes wrong for instance while debugging #33588, it is practical to add few `print` statements to see what is happening but it is quite painful to add a print statement inside of the lambda functions defined in the `_repr_fixups` at the top of the module.
- Since `_repr_fixups` is defined completely out of context in the top module it comes with 8 lines of documentation painfully explaining what it is. These lines would just disappear by defining them in context inside of the `try_fixup` method.

```python
# Collection of fixups applied in the SageOutputChecker.  Each element in this
# this list a pair of functions applied to the actual test output ('g' for
# "got") and the expected test output ('w' for "wanted").  The first function
# should be a simple fast test on the expected and/or actual output to                 
# determine if a fixup should be applied.  The second function is the actual
# fixup, which is applied if the test function passes.  In most fixups only one
# of the expected or received outputs are normalized, depending on the
# application.                            
_repr_fixups = [                                                          
    (lambda g, w: "Long-step" in g,         
     lambda g, w: (glpk_simplex_warning_regex.sub('', g), w)),
                                  
    (lambda g, w: "dylib" in g,                             
     lambda g, w: (ld_warning_regex.sub('', g), w)),             
                                                                    
    (lambda g, w: "pie being ignored" in g,                              
     lambda g, w: (ld_pie_warning_regex.sub('', g), w))                                          
]    
```

If reviewers agree with me, I will do one more commit improving that.



---

archive/issue_events_442912.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-07T15:27:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442912"
}
```



---

archive/issue_events_442913.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-07T15:27:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442913"
}
```



---

archive/issue_comments_545690.json:
```json
{
    "body": "Changed commit from **[a67986c](https://github.com/sagemath/sagetrac-mirror/commit/a67986cbc03474f19a3b699d3a44c1d5f36d6139)** to **[0274a6a](https://github.com/sagemath/sagetrac-mirror/commit/0274a6afcaa42b00241ab492fcfa17229e2bdaa5)**",
    "created_at": "2022-04-07T15:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545690",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a67986c](https://github.com/sagemath/sagetrac-mirror/commit/a67986cbc03474f19a3b699d3a44c1d5f36d6139)** to **[0274a6a](https://github.com/sagemath/sagetrac-mirror/commit/0274a6afcaa42b00241ab492fcfa17229e2bdaa5)**



---

archive/issue_comments_545691.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0274a6afcaa42b00241ab492fcfa17229e2bdaa5\">0274a6a</a></td><td><code>33588: using if-else is better at showing the logic structure of the cases</code></td></tr></table>\n",
    "created_at": "2022-04-07T15:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545691",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:12'>Comment 12:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0274a6afcaa42b00241ab492fcfa17229e2bdaa5">0274a6a</a></td><td><code>33588: using if-else is better at showing the logic structure of the cases</code></td></tr></table>




---

archive/issue_comments_545692.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI just added a commit which is unrelated to the question asked in [comment:10](#comment%3A10).",
    "created_at": "2022-04-07T15:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545692",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:13'>Comment 13:</a>
I just added a commit which is unrelated to the question asked in [comment:10](#comment%3A10).



---

archive/issue_comments_545693.json:
```json
{
    "body": "Changed commit from **[0274a6a](https://github.com/sagemath/sagetrac-mirror/commit/0274a6afcaa42b00241ab492fcfa17229e2bdaa5)** to **[1dcf549](https://github.com/sagemath/sagetrac-mirror/commit/1dcf54978ef9bfa6410f2e6d0db582c65cc73d8a)**",
    "created_at": "2022-04-07T16:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545693",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0274a6a](https://github.com/sagemath/sagetrac-mirror/commit/0274a6afcaa42b00241ab492fcfa17229e2bdaa5)** to **[1dcf549](https://github.com/sagemath/sagetrac-mirror/commit/1dcf54978ef9bfa6410f2e6d0db582c65cc73d8a)**



---

archive/issue_comments_545694.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1dcf54978ef9bfa6410f2e6d0db582c65cc73d8a\">1dcf549</a></td><td><code>33588: moving _repr_fixups from module header to method try_fixup</code></td></tr></table>\n",
    "created_at": "2022-04-07T16:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545694",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>Comment 14:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1dcf54978ef9bfa6410f2e6d0db582c65cc73d8a">1dcf549</a></td><td><code>33588: moving _repr_fixups from module header to method try_fixup</code></td></tr></table>




---

archive/issue_events_442914.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-07T16:05:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442914"
}
```



---

archive/issue_events_442915.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-07T16:05:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442915"
}
```



---

archive/issue_comments_545695.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nWhile having my head on this part of the code, I decide to answer my [comment:10](#comment%3A10) by YES and I did the latest commit.\n\nNeeds review!",
    "created_at": "2022-04-07T16:05:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545695",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:15'>Comment 15:</a>
While having my head on this part of the code, I decide to answer my [comment:10](#comment%3A10) by YES and I did the latest commit.

Needs review!



---

archive/issue_comments_545696.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cfac413ef73169d0b887fa8d3fcf72efecf221db\">cfac413</a></td><td><code>33588: moving _repr_fixups from module header to method try_fixup</code></td></tr></table>\n",
    "created_at": "2022-04-07T16:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545696",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'>Comment 16:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cfac413ef73169d0b887fa8d3fcf72efecf221db">cfac413</a></td><td><code>33588: moving _repr_fixups from module header to method try_fixup</code></td></tr></table>




---

archive/issue_comments_545697.json:
```json
{
    "body": "Changed commit from **[1dcf549](https://github.com/sagemath/sagetrac-mirror/commit/1dcf54978ef9bfa6410f2e6d0db582c65cc73d8a)** to **[cfac413](https://github.com/sagemath/sagetrac-mirror/commit/cfac413ef73169d0b887fa8d3fcf72efecf221db)**",
    "created_at": "2022-04-07T16:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545697",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1dcf549](https://github.com/sagemath/sagetrac-mirror/commit/1dcf54978ef9bfa6410f2e6d0db582c65cc73d8a)** to **[cfac413](https://github.com/sagemath/sagetrac-mirror/commit/cfac413ef73169d0b887fa8d3fcf72efecf221db)**



---

archive/issue_comments_545698.json:
```json
{
    "body": "Changed commit from **[cfac413](https://github.com/sagemath/sagetrac-mirror/commit/cfac413ef73169d0b887fa8d3fcf72efecf221db)** to **[10dee4e](https://github.com/sagemath/sagetrac-mirror/commit/10dee4e8a1505d491f3963f5216c122c516e4de9)**",
    "created_at": "2022-04-07T16:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545698",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cfac413](https://github.com/sagemath/sagetrac-mirror/commit/cfac413ef73169d0b887fa8d3fcf72efecf221db)** to **[10dee4e](https://github.com/sagemath/sagetrac-mirror/commit/10dee4e8a1505d491f3963f5216c122c516e4de9)**



---

archive/issue_comments_545699.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10dee4e8a1505d491f3963f5216c122c516e4de9\">10dee4e</a></td><td><code>33588: moving _repr_fixups from module header to method try_fixup</code></td></tr></table>\n",
    "created_at": "2022-04-07T16:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545699",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10dee4e8a1505d491f3963f5216c122c516e4de9">10dee4e</a></td><td><code>33588: moving _repr_fixups from module header to method try_fixup</code></td></tr></table>




---

archive/issue_comments_545700.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nDid 2 small changes on the last commit. Now done. Needs review.",
    "created_at": "2022-04-07T16:12:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545700",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:18'>Comment 18:</a>
Did 2 small changes on the last commit. Now done. Needs review.



---

archive/issue_comments_545701.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nI don't have time to review this right now, but I agree with your decisions regarding [comment:10](#comment%3A10).",
    "created_at": "2022-04-07T17:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545701",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'>Comment 19:</a>
I don't have time to review this right now, but I agree with your decisions regarding [comment:10](#comment%3A10).



---

archive/issue_comments_545702.json:
```json
{
    "body": "Changed commit from **[10dee4e](https://github.com/sagemath/sagetrac-mirror/commit/10dee4e8a1505d491f3963f5216c122c516e4de9)** to **[d7d40c7](https://github.com/sagemath/sagetrac-mirror/commit/d7d40c770179177f1d3dfd857fbdc107aee4d29e)**",
    "created_at": "2022-04-08T08:23:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545702",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[10dee4e](https://github.com/sagemath/sagetrac-mirror/commit/10dee4e8a1505d491f3963f5216c122c516e4de9)** to **[d7d40c7](https://github.com/sagemath/sagetrac-mirror/commit/d7d40c770179177f1d3dfd857fbdc107aee4d29e)**



---

archive/issue_comments_545703.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7d40c770179177f1d3dfd857fbdc107aee4d29e\">d7d40c7</a></td><td><code>33588: renamed try_fixup -> do_fixup because looks better like this</code></td></tr></table>\n",
    "created_at": "2022-04-08T08:23:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545703",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'>Comment 21:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7d40c770179177f1d3dfd857fbdc107aee4d29e">d7d40c7</a></td><td><code>33588: renamed try_fixup -> do_fixup because looks better like this</code></td></tr></table>




---

archive/issue_comments_545704.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI renamed `try_fixup` to `do_fixup` because the following line looks better like this, the same verb is used:\n\n```\ndid_fixup, want, got = self.do_fixup(want, got)\n```",
    "created_at": "2022-04-08T08:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545704",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:22'>Comment 22:</a>
I renamed `try_fixup` to `do_fixup` because the following line looks better like this, the same verb is used:

```
did_fixup, want, got = self.do_fixup(want, got)
```



---

archive/issue_comments_545705.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -84,3 +84,5 @@\n This program is free software; you may re-distribute it under the terms\n of the GNU General Public License version 3 or later.\n ```\n+\n+The problem was understood in [comment:7](#comment%3A7): the warnings are not ignored by `check_output` method when tolerance tags are given.\n``````\n",
    "created_at": "2022-04-11T07:47:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545705",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -84,3 +84,5 @@
 This program is free software; you may re-distribute it under the terms
 of the GNU General Public License version 3 or later.
 ```
+
+The problem was understood in [comment:7](#comment%3A7): the warnings are not ignored by `check_output` method when tolerance tags are given.
``````




---

archive/issue_comments_545706.json:
```json
{
    "body": "Changed commit from **[d7d40c7](https://github.com/sagemath/sagetrac-mirror/commit/d7d40c770179177f1d3dfd857fbdc107aee4d29e)** to **[6f20618](https://github.com/sagemath/sagetrac-mirror/commit/6f206182e8545081bfeb67958cd8472b04f5f5c9)**",
    "created_at": "2022-04-11T07:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545706",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d7d40c7](https://github.com/sagemath/sagetrac-mirror/commit/d7d40c770179177f1d3dfd857fbdc107aee4d29e)** to **[6f20618](https://github.com/sagemath/sagetrac-mirror/commit/6f206182e8545081bfeb67958cd8472b04f5f5c9)**



---

archive/issue_comments_545707.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f206182e8545081bfeb67958cd8472b04f5f5c9\">6f20618</a></td><td><code>33588:OUTPUT -> OUTPUT:</code></td></tr></table>\n",
    "created_at": "2022-04-11T07:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545707",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f206182e8545081bfeb67958cd8472b04f5f5c9">6f20618</a></td><td><code>33588:OUTPUT -> OUTPUT:</code></td></tr></table>




---

archive/issue_comments_545708.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nI added a commit to fix one patchbot warning:\n\n```\n========== blocks ==========\ngit checkout patchbot/ticket_merged\ninside file:  b/src/sage/doctest/parsing.py\n@@ -923,41 +919,111 @@ class SageOutputChecker(doctest.OutputChecker):\n+        OUTPUT\nwrong syntax for blocks (INPUT, OUTPUT, EXAMPLES, NOTE, etc) inserted on 1 non-empty lines\nblocks -- 0 seconds\n========== end blocks ==========\n```",
    "created_at": "2022-04-11T07:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545708",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:25'>Comment 25:</a>
I added a commit to fix one patchbot warning:

```
========== blocks ==========
git checkout patchbot/ticket_merged
inside file:  b/src/sage/doctest/parsing.py
@@ -923,41 +919,111 @@ class SageOutputChecker(doctest.OutputChecker):
+        OUTPUT
wrong syntax for blocks (INPUT, OUTPUT, EXAMPLES, NOTE, etc) inserted on 1 non-empty lines
blocks -- 0 seconds
========== end blocks ==========
```



---

archive/issue_comments_545709.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nPlease do not remove `_repr_fixups` and the comments before.\n\nEDIT: Just make that an empty list\n\nSomebody else may need that again at some point.",
    "created_at": "2022-04-11T09:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545709",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'>Comment 26:</a>
Please do not remove `_repr_fixups` and the comments before.

EDIT: Just make that an empty list

Somebody else may need that again at some point.



---

archive/issue_comments_545710.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nah, I see, this is more complicated than what I thought. No time to look at that now.",
    "created_at": "2022-04-11T09:15:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545710",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'>Comment 27:</a>
ah, I see, this is more complicated than what I thought. No time to look at that now.



---

archive/issue_comments_545711.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nIt is not so complicated in the end, but it is true that it may look complicated.\n\nLet me update the description of the ticket to better explain the problem and the solution.",
    "created_at": "2022-04-11T10:20:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545711",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:28'>Comment 28:</a>
It is not so complicated in the end, but it is true that it may look complicated.

Let me update the description of the ticket to better explain the problem and the solution.



---

archive/issue_comments_545712.json:
```json
{
    "body": "Changed commit from **[6f20618](https://github.com/sagemath/sagetrac-mirror/commit/6f206182e8545081bfeb67958cd8472b04f5f5c9)** to **[4a4cd4b](https://github.com/sagemath/sagetrac-mirror/commit/4a4cd4bf7e1a36970e6662b1372f58aea2968939)**",
    "created_at": "2022-04-11T12:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545712",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6f20618](https://github.com/sagemath/sagetrac-mirror/commit/6f206182e8545081bfeb67958cd8472b04f5f5c9)** to **[4a4cd4b](https://github.com/sagemath/sagetrac-mirror/commit/4a4cd4bf7e1a36970e6662b1372f58aea2968939)**



---

archive/issue_comments_545713.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bcca553d18f53be6fba2405348011c14d777a26c\">bcca553</a></td><td><code>33588: renamed try_fixup -> do_fixup because looks better like this</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a4cd4bf7e1a36970e6662b1372f58aea2968939\">4a4cd4b</a></td><td><code>33588:OUTPUT -> OUTPUT:</code></td></tr></table>\n",
    "created_at": "2022-04-11T12:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545713",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'>Comment 29:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bcca553d18f53be6fba2405348011c14d777a26c">bcca553</a></td><td><code>33588: renamed try_fixup -> do_fixup because looks better like this</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a4cd4bf7e1a36970e6662b1372f58aea2968939">4a4cd4b</a></td><td><code>33588:OUTPUT -> OUTPUT:</code></td></tr></table>




---

archive/issue_comments_545714.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nI removed the commit deleting the `_repr_fixups` as it can be done in a later ticket which will simplify the review of the current ticket.",
    "created_at": "2022-04-11T12:39:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545714",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:30'>Comment 30:</a>
I removed the commit deleting the `_repr_fixups` as it can be done in a later ticket which will simplify the review of the current ticket.



---

archive/issue_comments_545715.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,88 +1,78 @@\n-With `SageMath version 9.6.beta6, Release Date: 2022-03-27`, the command\n+## The symptom\n+\n+On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, we observe doctest failures of the following kind:\n \n ```\n-sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py\n-```\n-\n-gives\n-\n-```\n-Doctesting 4 files.\n-sage -t --long --random-seed=35631835319362689698338084947465382717 src/sage/geometry/polyhedron/base.py\n-**********************************************************************\n-File \"src/sage/geometry/polyhedron/base.py\", line 389, in sage.geometry.polyhedron.base.Polyhedron_base.to_linear_program\n Failed example:\n-    lp.solve()                                               # tol 1e-8   # optional - sage.rings.number_field\n+    lp.solve() # tol 1e-8   # optional - sage.rings.number_field\n Expected:\n     1.3090169943749475\n Got:\n     Long-step dual simplex will be used\n     1.3090169943749472\n-**********************************************************************\n-1 item had failures:\n-   1 of  32 in sage.geometry.polyhedron.base.Polyhedron_base.to_linear_program\n-    [324 tests, 1 failure, 11.62 s]\n-sage -t --long --random-seed=35631835319362689698338084947465382717 src/sage/numerical/backends/glpk_backend.pyx\n-**********************************************************************\n-File \"src/sage/numerical/backends/glpk_backend.pyx\", line 1104, in sage.numerical.backends.glpk_backend.GLPKBackend.solve\n-Failed example:\n-    p.solve() # rel tol 100\n-Expected:\n-    1\n-Got:\n-    Long-step dual simplex will be used\n-    2.0\n-**********************************************************************\n-File \"src/sage/numerical/backends/glpk_backend.pyx\", line 1111, in sage.numerical.backends.glpk_backend.GLPKBackend.solve\n-Failed example:\n-    p.solve() # rel tol 100\n-Expected:\n-    1\n-Got:\n-    Long-step dual simplex will be used\n-    24.0\n-**********************************************************************\n+```\n \n-[...]\n+with the GLPK available on the system:\n \n-**********************************************************************\n-File \"src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py\", line 127, in sage.tests.books.computational-mathematics-with-sagemath.lp_doctest\n-Failed example:\n-    p.solve() # abs tol 1e-10\n-Expected:\n-    1.4199999999999999\n-Got:\n-    Long-step dual simplex will be used\n-    1.42\n-**********************************************************************\n-1 item had failures:\n-   2 of  69 in sage.tests.books.computational-mathematics-with-sagemath.lp_doctest\n-    [68 tests, 2 failures, 0.05 s]\n+```\n+$ glpsol -v\n+GLPSOL: GLPK LP/MIP Solver, v4.65\n+...\n+```\n+\n+This means that the fix proposed in #29317 to ignore that same sentence printed by GLPK does not completely work.\n+\n+In particular, all failures always consists of doctests tagged with some numerical tolerence `# tol`.\n+\n+The complete list of failures consist of the following 4 files:\n+\n+```\n+sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py\n+```\n+gives\n+\n+```\n ----------------------------------------------------------------------\n sage -t --long src/sage/geometry/polyhedron/base.py  # 1 doctest failed\n sage -t --long src/sage/numerical/backends/glpk_backend.pyx  # 4 doctests failed\n sage -t --long src/sage/numerical/mip.pyx  # 8 doctests failed\n sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py  # 2 doctests failed\n ----------------------------------------------------------------------\n-Total time for all tests: 17.1 seconds\n-    cpu time: 15.8 seconds\n-    cumulative wall time: 16.7 seconds\n-Features detected for doctesting: sage.combinat,sage.graphs,sage.rings.number_field\n ```\n \n-This is with:\n+## Isolation of the problem\n+\n+The problem was understood in [comment:7](#comment%3A7). The warnings are not ignored by `check_output` method when tolerance tags are given. The following example illustrate the issue, the last line should be True:\n \n ```\n-$ glpsol -v\n-GLPSOL: GLPK LP/MIP Solver, v4.65\n-Copyright (C) 2000-2017 Andrew Makhorin, Department for Applied\n-Informatics, Moscow Aviation Institute, Moscow, Russia. All rights\n-reserved. E-mail: <mao@gnu.org>.\n-\n-This program has ABSOLUTELY NO WARRANTY.\n-\n-This program is free software; you may re-distribute it under the terms\n-of the GNU General Public License version 3 or later.\n+sage: example = \"sage: 1.3090169943749475 # tol 1e-8\\n1.3090169943749475\"\n+sage: ex = DTP.parse(example)[1]\n+sage: ex.sage_source\n+'1.3090169943749475 # tol 1e-8\\n'\n+sage: ex.want\n+'1.3090169943749475\\n'\n+sage: OC.check_output(ex.want, '1.3090169943749475', optflag)\n+True\n+sage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)\n+False\n+sage: OC.check_output(ex.want, 'Long-step dual simplex will be used\\n1.3090169943749475', optflag)\n+False\n ```\n \n-The problem was understood in [comment:7](#comment%3A7): the warnings are not ignored by `check_output` method when tolerance tags are given.\n+## The problem with the current code\n+\n+It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.\n+\n+More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.\n+\n+## The solution\n+\n+The solution is not to return False at line 934. In fact it is better to first check that all intervals intersect (currently done at line 942) and return False if not all intervals intersect.\n+\n+Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given.\n+\n+## Further improvements\n+\n+We create a independent method `do_fixup` which does the removal of eventual warnings as a last resort solution before returning False.\n+\n+To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for a later ticket.\n``````\n",
    "created_at": "2022-04-11T13:03:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545715",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,88 +1,78 @@
-With `SageMath version 9.6.beta6, Release Date: 2022-03-27`, the command
+## The symptom
+
+On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, we observe doctest failures of the following kind:
 
 ```
-sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py
-```
-
-gives
-
-```
-Doctesting 4 files.
-sage -t --long --random-seed=35631835319362689698338084947465382717 src/sage/geometry/polyhedron/base.py
-**********************************************************************
-File "src/sage/geometry/polyhedron/base.py", line 389, in sage.geometry.polyhedron.base.Polyhedron_base.to_linear_program
 Failed example:
-    lp.solve()                                               # tol 1e-8   # optional - sage.rings.number_field
+    lp.solve() # tol 1e-8   # optional - sage.rings.number_field
 Expected:
     1.3090169943749475
 Got:
     Long-step dual simplex will be used
     1.3090169943749472
-**********************************************************************
-1 item had failures:
-   1 of  32 in sage.geometry.polyhedron.base.Polyhedron_base.to_linear_program
-    [324 tests, 1 failure, 11.62 s]
-sage -t --long --random-seed=35631835319362689698338084947465382717 src/sage/numerical/backends/glpk_backend.pyx
-**********************************************************************
-File "src/sage/numerical/backends/glpk_backend.pyx", line 1104, in sage.numerical.backends.glpk_backend.GLPKBackend.solve
-Failed example:
-    p.solve() # rel tol 100
-Expected:
-    1
-Got:
-    Long-step dual simplex will be used
-    2.0
-**********************************************************************
-File "src/sage/numerical/backends/glpk_backend.pyx", line 1111, in sage.numerical.backends.glpk_backend.GLPKBackend.solve
-Failed example:
-    p.solve() # rel tol 100
-Expected:
-    1
-Got:
-    Long-step dual simplex will be used
-    24.0
-**********************************************************************
+```
 
-[...]
+with the GLPK available on the system:
 
-**********************************************************************
-File "src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py", line 127, in sage.tests.books.computational-mathematics-with-sagemath.lp_doctest
-Failed example:
-    p.solve() # abs tol 1e-10
-Expected:
-    1.4199999999999999
-Got:
-    Long-step dual simplex will be used
-    1.42
-**********************************************************************
-1 item had failures:
-   2 of  69 in sage.tests.books.computational-mathematics-with-sagemath.lp_doctest
-    [68 tests, 2 failures, 0.05 s]
+```
+$ glpsol -v
+GLPSOL: GLPK LP/MIP Solver, v4.65
+...
+```
+
+This means that the fix proposed in #29317 to ignore that same sentence printed by GLPK does not completely work.
+
+In particular, all failures always consists of doctests tagged with some numerical tolerence `# tol`.
+
+The complete list of failures consist of the following 4 files:
+
+```
+sage -tp --long src/sage/geometry/polyhedron/base.py src/sage/numerical/backends/glpk_backend.pyx src/sage/numerical/mip.pyx src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py
+```
+gives
+
+```
 ----------------------------------------------------------------------
 sage -t --long src/sage/geometry/polyhedron/base.py  # 1 doctest failed
 sage -t --long src/sage/numerical/backends/glpk_backend.pyx  # 4 doctests failed
 sage -t --long src/sage/numerical/mip.pyx  # 8 doctests failed
 sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/lp_doctest.py  # 2 doctests failed
 ----------------------------------------------------------------------
-Total time for all tests: 17.1 seconds
-    cpu time: 15.8 seconds
-    cumulative wall time: 16.7 seconds
-Features detected for doctesting: sage.combinat,sage.graphs,sage.rings.number_field
 ```
 
-This is with:
+## Isolation of the problem
+
+The problem was understood in [comment:7](#comment%3A7). The warnings are not ignored by `check_output` method when tolerance tags are given. The following example illustrate the issue, the last line should be True:
 
 ```
-$ glpsol -v
-GLPSOL: GLPK LP/MIP Solver, v4.65
-Copyright (C) 2000-2017 Andrew Makhorin, Department for Applied
-Informatics, Moscow Aviation Institute, Moscow, Russia. All rights
-reserved. E-mail: <mao@gnu.org>.
-
-This program has ABSOLUTELY NO WARRANTY.
-
-This program is free software; you may re-distribute it under the terms
-of the GNU General Public License version 3 or later.
+sage: example = "sage: 1.3090169943749475 # tol 1e-8\n1.3090169943749475"
+sage: ex = DTP.parse(example)[1]
+sage: ex.sage_source
+'1.3090169943749475 # tol 1e-8\n'
+sage: ex.want
+'1.3090169943749475\n'
+sage: OC.check_output(ex.want, '1.3090169943749475', optflag)
+True
+sage: OC.check_output(ex.want, 'ANYTHING1.3090169943749475', optflag)
+False
+sage: OC.check_output(ex.want, 'Long-step dual simplex will be used\n1.3090169943749475', optflag)
+False
 ```
 
-The problem was understood in [comment:7](#comment%3A7): the warnings are not ignored by `check_output` method when tolerance tags are given.
+## The problem with the current code
+
+It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.
+
+More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.
+
+## The solution
+
+The solution is not to return False at line 934. In fact it is better to first check that all intervals intersect (currently done at line 942) and return False if not all intervals intersect.
+
+Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given.
+
+## Further improvements
+
+We create a independent method `do_fixup` which does the removal of eventual warnings as a last resort solution before returning False.
+
+To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for a later ticket.
``````




---

archive/issue_comments_545716.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nUpdated description.",
    "created_at": "2022-04-11T13:03:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545716",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:31'>Comment 31:</a>
Updated description.



---

archive/issue_comments_545717.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nFurther description improvements.",
    "created_at": "2022-04-11T13:09:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545717",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:32'>Comment 32:</a>
Further description improvements.



---

archive/issue_comments_545718.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n ## The symptom\n \n-On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, we observe doctest failures of the following kind:\n+On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, with the GLPK available on the system `$ glpsol -v` returning `GLPSOL: GLPK LP/MIP Solver, v4.65`, we observe doctest failures of the following kind:\n \n ```\n Failed example:\n@@ -12,17 +12,7 @@\n     1.3090169943749472\n ```\n \n-with the GLPK available on the system:\n-\n-```\n-$ glpsol -v\n-GLPSOL: GLPK LP/MIP Solver, v4.65\n-...\n-```\n-\n-This means that the fix proposed in #29317 to ignore that same sentence printed by GLPK does not completely work.\n-\n-In particular, all failures always consists of doctests tagged with some numerical tolerence `# tol`.\n+Failures always consists of doctests tagged with some numerical tolerence `# tol`.\n \n The complete list of failures consist of the following 4 files:\n \n@@ -61,15 +51,17 @@\n \n ## The problem with the current code\n \n+The fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.\n+\n It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.\n \n More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.\n \n ## The solution\n \n-The solution is not to return False at line 934. In fact it is better to first check that all intervals intersect (currently done at line 942) and return False if not all intervals intersect.\n+The solution is not to return False at line 934 when the non-float part is not equal. In fact it is better to first check that all floats intervals intersect (currently done at line 942) and return False if not all intervals intersect.\n \n-Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given.\n+Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given instead of returning False.\n \n ## Further improvements\n \n``````\n",
    "created_at": "2022-04-11T13:09:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545718",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 ## The symptom
 
-On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, we observe doctest failures of the following kind:
+On Ubuntu 18.04, with `SageMath version 9.6.beta6, Release Date: 2022-03-27`, with the GLPK available on the system `$ glpsol -v` returning `GLPSOL: GLPK LP/MIP Solver, v4.65`, we observe doctest failures of the following kind:
 
 ```
 Failed example:
@@ -12,17 +12,7 @@
     1.3090169943749472
 ```
 
-with the GLPK available on the system:
-
-```
-$ glpsol -v
-GLPSOL: GLPK LP/MIP Solver, v4.65
-...
-```
-
-This means that the fix proposed in #29317 to ignore that same sentence printed by GLPK does not completely work.
-
-In particular, all failures always consists of doctests tagged with some numerical tolerence `# tol`.
+Failures always consists of doctests tagged with some numerical tolerence `# tol`.
 
 The complete list of failures consist of the following 4 files:
 
@@ -61,15 +51,17 @@
 
 ## The problem with the current code
 
+The fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.
+
 It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.
 
 More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.
 
 ## The solution
 
-The solution is not to return False at line 934. In fact it is better to first check that all intervals intersect (currently done at line 942) and return False if not all intervals intersect.
+The solution is not to return False at line 934 when the non-float part is not equal. In fact it is better to first check that all floats intervals intersect (currently done at line 942) and return False if not all intervals intersect.
 
-Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given.
+Then, we can continue with checking the remaining non-floats parts as it is done by default when no tolerance is given instead of returning False.
 
 ## Further improvements
 
``````




---

archive/issue_comments_545719.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nNeeds review.",
    "created_at": "2022-04-11T13:13:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545719",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:33'>Comment 33:</a>
Needs review.



---

archive/issue_comments_545720.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,8 @@\n     1.3090169943749472\n ```\n \n-Failures always consists of doctests tagged with some numerical tolerence `# tol`.\n+Failures always consists of doctests tagged with some numerical tolerence `# tol`. It seems the fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.\n+\n \n The complete list of failures consist of the following 4 files:\n \n@@ -51,8 +52,6 @@\n \n ## The problem with the current code\n \n-The fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.\n-\n It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.\n \n More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.\n``````\n",
    "created_at": "2022-04-11T13:15:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545720",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,8 @@
     1.3090169943749472
 ```
 
-Failures always consists of doctests tagged with some numerical tolerence `# tol`.
+Failures always consists of doctests tagged with some numerical tolerence `# tol`. It seems the fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.
+
 
 The complete list of failures consist of the following 4 files:
 
@@ -51,8 +52,6 @@
 
 ## The problem with the current code
 
-The fix proposed in #29317 to ignore sentence `Long-step dual simplex will be used` printed by GLPK does not work for doctests tagged with `# tol`.
-
 It can be checked inside of the `check_output` method at [line 925 and below](https://gitlab.com/sagemath/sage/-/blob/develop/src/sage/doctest/parsing.py#L925) that when a tolerance is given a result True or False is returned before any fixup is performed to remove eventual `Long-step dual simplex will be used` to the output.
 
 More precisely, at line 934, we return False because everything other than float numbers are not equal. This `return False` is done too early. Because we want to do eventual fix ups before returning False.
``````




---

archive/issue_events_442916.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-11T13:18:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "title_is": "\"Long-step dual simplex will be used\" sentence is not ignored when doctest is tagged with # tol",
    "title_was": "15 GLPK doctests failing because \"Long-step dual simplex will be used\" gets printed",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442916"
}
```



---

archive/issue_events_442917.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-11T13:19:30Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "title_is": "\"Long-step dual simplex will be used\" warning is not ignored when doctest is tagged with # tol",
    "title_was": "\"Long-step dual simplex will be used\" sentence is not ignored when doctest is tagged with # tol",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442917"
}
```



---

archive/issue_comments_545721.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -66,4 +66,4 @@\n \n We create a independent method `do_fixup` which does the removal of eventual warnings as a last resort solution before returning False.\n \n-To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for a later ticket.\n+To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for the follow-up ticket #33680.\n``````\n",
    "created_at": "2022-04-11T13:33:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545721",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -66,4 +66,4 @@
 
 We create a independent method `do_fixup` which does the removal of eventual warnings as a last resort solution before returning False.
 
-To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for a later ticket.
+To ease the review, we keep the list `_repr_fixups` for now in the header of the module and leave its integration within `do_fixup` method for the follow-up ticket #33680.
``````




---

archive/issue_comments_545722.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nTouching the `_repr_fixups` list is now in a follow-up ticket #33680.",
    "created_at": "2022-04-11T13:33:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545722",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:37'>Comment 37:</a>
Touching the `_repr_fixups` list is now in a follow-up ticket #33680.



---

archive/issue_events_442918.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-11T14:26:49Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "title_is": "warnings to ignore are not ignored when a doctest is tagged with # tol",
    "title_was": "\"Long-step dual simplex will be used\" warning is not ignored when doctest is tagged with # tol",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442918"
}
```



---

archive/issue_comments_545723.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -36,6 +36,11 @@\n The problem was understood in [comment:7](#comment%3A7). The warnings are not ignored by `check_output` method when tolerance tags are given. The following example illustrate the issue, the last line should be True:\n \n ```\n+sage: from sage.doctest.parsing import SageOutputChecker, SageDocTestParser\n+sage: import doctest\n+sage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS\n+sage: DTP = SageDocTestParser(('sage','magma','guava'))\n+sage: OC = SageOutputChecker()\n sage: example = \"sage: 1.3090169943749475 # tol 1e-8\\n1.3090169943749475\"\n sage: ex = DTP.parse(example)[1]\n sage: ex.sage_source\n``````\n",
    "created_at": "2022-04-11T15:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545723",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -36,6 +36,11 @@
 The problem was understood in [comment:7](#comment%3A7). The warnings are not ignored by `check_output` method when tolerance tags are given. The following example illustrate the issue, the last line should be True:
 
 ```
+sage: from sage.doctest.parsing import SageOutputChecker, SageDocTestParser
+sage: import doctest
+sage: optflag = doctest.NORMALIZE_WHITESPACE|doctest.ELLIPSIS
+sage: DTP = SageDocTestParser(('sage','magma','guava'))
+sage: OC = SageOutputChecker()
 sage: example = "sage: 1.3090169943749475 # tol 1e-8\n1.3090169943749475"
 sage: ex = DTP.parse(example)[1]
 sage: ex.sage_source
``````




---

archive/issue_events_442919.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-18T10:04:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442919"
}
```



---

archive/issue_events_442920.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-18T10:04:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442920"
}
```



---

archive/issue_comments_545724.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\none patchbot currently says:\n\n```\n[sagemath_doc_html-none] Error building the documentation.\n[sagemath_doc_html-none] Traceback (most recent call last):\n...\n[sagemath_doc_html-none] OSError: /home/debian/sage/local/var/lib/sage/\nvenv-python3.9/lib/python3.9/site-packages/sage/doctest/parsing.py:\ndocstring of sage.doctest.parsing.SageOutputChecker.check_output:118: \nWARNING: Block quote ends without a blank line; unexpected unindent.\n[sagemath_doc_html-none]\n```",
    "created_at": "2022-04-18T10:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545724",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:40'>Comment 40:</a>
one patchbot currently says:

```
[sagemath_doc_html-none] Error building the documentation.
[sagemath_doc_html-none] Traceback (most recent call last):
...
[sagemath_doc_html-none] OSError: /home/debian/sage/local/var/lib/sage/
venv-python3.9/lib/python3.9/site-packages/sage/doctest/parsing.py:
docstring of sage.doctest.parsing.SageOutputChecker.check_output:118: 
WARNING: Block quote ends without a blank line; unexpected unindent.
[sagemath_doc_html-none]
```



---

archive/issue_comments_545725.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/11f7a34ba66dc5c3407b45c360aea1cad97ef975\">11f7a34</a></td><td><code>33588: adding do_fixup method in the SageOutputChecker</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d337e4ef96af446735eff7ffd52576f2d4cb24c\">1d337e4</a></td><td><code>33588: continue to compare the non-floats part of doctests when tolerance is given</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79071f527e440ecda24feb7d0ec303d204d8b6ae\">79071f5</a></td><td><code>33588: using if-else is better at showing the logic structure of the cases</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa\">2afb472</a></td><td><code>33588: raw-string for documentation of check_output</code></td></tr></table>\n",
    "created_at": "2022-04-18T11:01:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545725",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:41'>Comment 41:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/11f7a34ba66dc5c3407b45c360aea1cad97ef975">11f7a34</a></td><td><code>33588: adding do_fixup method in the SageOutputChecker</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d337e4ef96af446735eff7ffd52576f2d4cb24c">1d337e4</a></td><td><code>33588: continue to compare the non-floats part of doctests when tolerance is given</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79071f527e440ecda24feb7d0ec303d204d8b6ae">79071f5</a></td><td><code>33588: using if-else is better at showing the logic structure of the cases</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa">2afb472</a></td><td><code>33588: raw-string for documentation of check_output</code></td></tr></table>




---

archive/issue_comments_545726.json:
```json
{
    "body": "Changed commit from **[4a4cd4b](https://github.com/sagemath/sagetrac-mirror/commit/4a4cd4bf7e1a36970e6662b1372f58aea2968939)** to **[2afb472](https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa)**",
    "created_at": "2022-04-18T11:01:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545726",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4a4cd4b](https://github.com/sagemath/sagetrac-mirror/commit/4a4cd4bf7e1a36970e6662b1372f58aea2968939)** to **[2afb472](https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa)**



---

archive/issue_comments_545727.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nThe documentation failure was due to a docstring defined with `\"\"\"...\"\"\"` as opposed to `r\"\"\"...\"\"\"`. I added a commit to fix that.\n\nNow rebased on 9.6.rc0.\n\nAlso squashed the commit changing name `try_fixup` to `do_fixup` to simplify the review.",
    "created_at": "2022-04-18T11:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545727",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:42'>Comment 42:</a>
The documentation failure was due to a docstring defined with `"""..."""` as opposed to `r"""..."""`. I added a commit to fix that.

Now rebased on 9.6.rc0.

Also squashed the commit changing name `try_fixup` to `do_fixup` to simplify the review.



---

archive/issue_events_442921.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-18T11:14:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442921"
}
```



---

archive/issue_events_442922.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-04-18T11:14:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442922"
}
```



---

archive/issue_comments_545728.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2022-04-20T17:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545728",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_442923.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2022-04-20T17:54:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442923"
}
```



---

archive/issue_events_442924.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2022-04-20T17:54:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442924"
}
```



---

archive/issue_comments_545729.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nThis looks good to me.",
    "created_at": "2022-04-20T17:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545729",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'>Comment 44:</a>
This looks good to me.



---

archive/issue_comments_545730.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nThank you John!",
    "created_at": "2022-04-20T18:23:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545730",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:45'>Comment 45:</a>
Thank you John!



---

archive/issue_events_442925.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-21T07:06:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442925"
}
```



---

archive/issue_events_442926.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-21T07:06:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442926"
}
```



---

archive/issue_comments_545731.json:
```json
{
    "body": "Changed branch from **[u/slabbe/33588](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33588)** to **[2afb472](https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa)**",
    "created_at": "2022-04-24T06:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33588#issuecomment-545731",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/slabbe/33588](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33588)** to **[2afb472](https://github.com/sagemath/sagetrac-mirror/commit/2afb47293d0fb63f017d3e9acb6035166dfc92aa)**



---

archive/issue_events_442927.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-24T06:31:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442927"
}
```



---

archive/issue_events_442928.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "7950f93e7c2bc05e7e117b31fab8fbc518607534",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-04-24T06:31:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33588",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33588#event-442928"
}
```
