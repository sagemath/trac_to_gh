# Issue 33338: Meta-ticket: CI workflows for upstream projects using Sage reusable workflows

archive/issues_033101.json:
```json
{
    "body": "CC:  @tobiasdiez @dimpase @saraedum\n\nThe Sage portability CI workflows, both within the Sage repository and in upstream deployments, contain a lot of copy-pasting.\n- https://github.com/sagemath/sage/tree/develop/.github/workflows\n- https://github.com/pypa/setuptools/blob/main/.github/workflows/ci-sage.yml\n- https://github.com/sympy/sympy/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/Singular/Singular/blob/spielwiese/.github/workflows/ci-sage.yml\n- https://github.com/sagemath/cysignals/tree/main/.github/workflows\n- https://github.com/4ti2/4ti2/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/wbhart/flint2/blob/flint-2.8/.github/workflows/ci-sage.yml\n- https://github.com/fredrik-johansson/arb/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/linbox-team/fflas-ffpack/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/kimwalisch/primesieve/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/kimwalisch/primecount/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/dimpase/primecountpy/tree/master/.github/workflows\n- https://github.com/latte-int/latte/blob/master/.github/workflows/ci-sage.yml\n- https://github.com/FFY00/meson-python/blob/main/.github/workflows/ci-sage.yml\n- ...\n\nPRs:\n- https://github.com/fricas/fricas/pull/102\n- https://github.com/fredrik-johansson/arb/pull/434\n- https://github.com/wbhart/flint2/pull/1166\n- https://github.com/scipopt/PySCIPOpt/pull/630\n- https://github.com/scipopt/SCIP-SDP/pull/4\n\nWe refactor them using a combination of \n- scripts in `SAGE_ROOT/.ci/`; \n- new top-level `SAGE_ROOT/Makefile` targets; \n- reusable workflows in the main Sage repo - https://docs.github.com/en/actions/learn-github-actions/reusing-workflows\n- reusable workflows in a different repo.\n- problem matchers:\n  - https://github.com/actions/toolkit/blob/main/docs/problem-matchers.md\n  - https://github.com/actions/toolkit/blob/main/docs/commands.md#problem-matchers\n  - Example: https://github.com/actions/setup-python/blob/main/.github/python.json\n  - More examples: https://github.com/juftin/lunchable/tree/main/.github/matchers, https://github.com/python/cpython/tree/main/.github/problem-matchers\n\nTickets:\n- #29919 Restore \"huge\" package type\n- #33791 ci-cygwin: Refactor using reusable workflows\n- #34115 tox.yml: Refactor using reusable workflows\n\nPart of:\n- #29146 Meta-ticket: Refactor and improve system package related scripts, `tox.ini`, `build/bin/write_dockerfile.sh`\n- #29060 Meta-ticket: Add `Dockerfile`s and CI scripts for integration testing of source and binary distributions and of downstream packages\n\nReferences:\n-  https://github.com/pypa/setuptools/pull/2923#discussion_r795977169\n\nIssue created by migration from https://trac.sagemath.org/ticket/33338\n\n",
    "created_at": "2022-02-13T19:20:37Z",
    "labels": [
        "component: porting"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Meta-ticket: CI workflows for upstream projects using Sage reusable workflows",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33338",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @tobiasdiez @dimpase @saraedum

The Sage portability CI workflows, both within the Sage repository and in upstream deployments, contain a lot of copy-pasting.
- https://github.com/sagemath/sage/tree/develop/.github/workflows
- https://github.com/pypa/setuptools/blob/main/.github/workflows/ci-sage.yml
- https://github.com/sympy/sympy/blob/master/.github/workflows/ci-sage.yml
- https://github.com/Singular/Singular/blob/spielwiese/.github/workflows/ci-sage.yml
- https://github.com/sagemath/cysignals/tree/main/.github/workflows
- https://github.com/4ti2/4ti2/blob/master/.github/workflows/ci-sage.yml
- https://github.com/wbhart/flint2/blob/flint-2.8/.github/workflows/ci-sage.yml
- https://github.com/fredrik-johansson/arb/blob/master/.github/workflows/ci-sage.yml
- https://github.com/linbox-team/fflas-ffpack/blob/master/.github/workflows/ci-sage.yml
- https://github.com/kimwalisch/primesieve/blob/master/.github/workflows/ci-sage.yml
- https://github.com/kimwalisch/primecount/blob/master/.github/workflows/ci-sage.yml
- https://github.com/dimpase/primecountpy/tree/master/.github/workflows
- https://github.com/latte-int/latte/blob/master/.github/workflows/ci-sage.yml
- https://github.com/FFY00/meson-python/blob/main/.github/workflows/ci-sage.yml
- ...

PRs:
- https://github.com/fricas/fricas/pull/102
- https://github.com/fredrik-johansson/arb/pull/434
- https://github.com/wbhart/flint2/pull/1166
- https://github.com/scipopt/PySCIPOpt/pull/630
- https://github.com/scipopt/SCIP-SDP/pull/4

We refactor them using a combination of 
- scripts in `SAGE_ROOT/.ci/`; 
- new top-level `SAGE_ROOT/Makefile` targets; 
- reusable workflows in the main Sage repo - https://docs.github.com/en/actions/learn-github-actions/reusing-workflows
- reusable workflows in a different repo.
- problem matchers:
  - https://github.com/actions/toolkit/blob/main/docs/problem-matchers.md
  - https://github.com/actions/toolkit/blob/main/docs/commands.md#problem-matchers
  - Example: https://github.com/actions/setup-python/blob/main/.github/python.json
  - More examples: https://github.com/juftin/lunchable/tree/main/.github/matchers, https://github.com/python/cpython/tree/main/.github/problem-matchers

Tickets:
- #29919 Restore "huge" package type
- #33791 ci-cygwin: Refactor using reusable workflows
- #34115 tox.yml: Refactor using reusable workflows

Part of:
- #29146 Meta-ticket: Refactor and improve system package related scripts, `tox.ini`, `build/bin/write_dockerfile.sh`
- #29060 Meta-ticket: Add `Dockerfile`s and CI scripts for integration testing of source and binary distributions and of downstream packages

References:
-  https://github.com/pypa/setuptools/pull/2923#discussion_r795977169

Issue created by migration from https://trac.sagemath.org/ticket/33338





---

archive/issue_events_087968.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T01:55:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33338",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33338#event-87968"
}
```



---

archive/issue_comments_471272.json:
```json
{
    "body": "#33791 does this for cygwin",
    "created_at": "2022-05-03T16:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33338#issuecomment-471272",
    "user": "https://github.com/mkoeppe"
}
```

#33791 does this for cygwin



---

archive/issue_events_087969.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33338",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33338#event-87969"
}
```



---

archive/issue_events_087970.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33338",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33338#event-87970"
}
```
