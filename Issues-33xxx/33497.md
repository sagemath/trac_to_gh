# Issue 33497: coerce vs _coerce_ vs _coerce_c

archive/issues_033260.json:
```json
{
    "assignees": [],
    "body": "Even though the `_coerce_` and `_coerce_c` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.\n\nWe replace all usage of `_coerce_`/`_coerce_c` by `coerce` and deprecate the formers.\n\nDepends on #33525\nDepends on #33576\nDepends on #33558\n\nCC:  @mezzarobba\n\nBranch/Commit: **[4ed53f8](https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw, Vincent Delecroix**\n\nAuthor: **Vincent Delecroix, Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33497_\n\n",
    "closed_at": "2022-05-20T22:27:15Z",
    "created_at": "2022-03-13T20:56:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "coerce vs _coerce_ vs _coerce_c",
    "type": "issue",
    "updated_at": "2022-05-20T22:27:15Z",
    "url": "https://github.com/sagemath/sage/issues/33497",
    "user": "https://github.com/videlec"
}
```
Even though the `_coerce_` and `_coerce_c` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.

We replace all usage of `_coerce_`/`_coerce_c` by `coerce` and deprecate the formers.

Depends on #33525
Depends on #33576
Depends on #33558

CC:  @mezzarobba

Branch/Commit: **[4ed53f8](https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38)**

Reviewer: **Frédéric Chapoton, Travis Scrimshaw, Vincent Delecroix**

Author: **Vincent Delecroix, Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/33497_





---

archive/issue_events_441790.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-13T20:56:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441790"
}
```



---

archive/issue_events_441791.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-13T20:56:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441791"
}
```



---

archive/issue_events_441792.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-13T20:56:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441792"
}
```



---

archive/issue_events_441793.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-13T20:56:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441793"
}
```



---

archive/issue_events_441794.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-13T21:19:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "title_is": "coerce vs _coerce_ vs _coerce_c",
    "title_was": "coerce vs _coerce_",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441794"
}
```



---

archive/issue_comments_544078.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Even though the `_coerce_` method is only implemented in the deprecated sage.structure.parent_old.Parent it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.\n+Even though the `_coerce_` and `_coerce_c_` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.\n \n We replace all usage of `_coerce_` by `coerce` and deprecate the former.\n``````\n",
    "created_at": "2022-03-13T21:19:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544078",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Even though the `_coerce_` method is only implemented in the deprecated sage.structure.parent_old.Parent it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.
+Even though the `_coerce_` and `_coerce_c_` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.
 
 We replace all usage of `_coerce_` by `coerce` and deprecate the former.
``````




---

archive/issue_comments_544079.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Even though the `_coerce_` and `_coerce_c_` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.\n+Even though the `_coerce_` and `_coerce_c` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.\n \n-We replace all usage of `_coerce_` by `coerce` and deprecate the former.\n+We replace all usage of `_coerce_`/`_coerce_c` by `coerce` and deprecate the formers.\n``````\n",
    "created_at": "2022-03-13T21:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544079",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Even though the `_coerce_` and `_coerce_c_` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.
+Even though the `_coerce_` and `_coerce_c` methods are only implemented in the soon to be deprecated `sage.structure.parent_old.Parent` it is still used in some places. The current situation prevents to build a ring that inherits from Parent and use it as a base ring for the multivariate polynomial ring.
 
-We replace all usage of `_coerce_` by `coerce` and deprecate the former.
+We replace all usage of `_coerce_`/`_coerce_c` by `coerce` and deprecate the formers.
``````




---

archive/issue_events_441795.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-13T22:25:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441795"
}
```



---

archive/issue_comments_544080.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd7e895748ea157b06a36c3d640fa05e11fb485e\">cd7e895</a></td><td><code>33497: _coerce_/_coerce_c -> coerce</code></td></tr></table>\n",
    "created_at": "2022-03-13T22:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544080",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'>Comment 3:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd7e895748ea157b06a36c3d640fa05e11fb485e">cd7e895</a></td><td><code>33497: _coerce_/_coerce_c -> coerce</code></td></tr></table>




---

archive/issue_comments_544081.json:
```json
{
    "body": "Commit: **[cd7e895](https://github.com/sagemath/sagetrac-mirror/commit/cd7e895748ea157b06a36c3d640fa05e11fb485e)**",
    "created_at": "2022-03-13T22:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544081",
    "user": "https://github.com/videlec"
}
```

Commit: **[cd7e895](https://github.com/sagemath/sagetrac-mirror/commit/cd7e895748ea157b06a36c3d640fa05e11fb485e)**



---

archive/issue_comments_544082.json:
```json
{
    "body": "Branch: **[u/vdelecroix/33497](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/33497)**",
    "created_at": "2022-03-13T22:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544082",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/33497](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/33497)**



---

archive/issue_comments_544083.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThis is definitely a step in the right direction. So +1 on this ticket. Definitely in the documentation it would be good to use `coerce()`. I am a little worried in the code that it might be slower in core code (integers (mod ring), rationals, and polynomial rings specifically). This might be something we just have to swallow when we finish the transition, but I am worried this might hide slightly potential optimizations. I know there are a lot of 'if's in that, so it is not a strong argument. I would probably feel better if there were some timings. What are your thoughts on this?",
    "created_at": "2022-03-14T07:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544083",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'>Comment 4:</a>
This is definitely a step in the right direction. So +1 on this ticket. Definitely in the documentation it would be good to use `coerce()`. I am a little worried in the code that it might be slower in core code (integers (mod ring), rationals, and polynomial rings specifically). This might be something we just have to swallow when we finish the transition, but I am worried this might hide slightly potential optimizations. I know there are a lot of 'if's in that, so it is not a strong argument. I would probably feel better if there were some timings. What are your thoughts on this?



---

archive/issue_comments_544084.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nCurrently there is an indirection : `_coerce_`/`_coerce_c` calls `coerce`. So what I wrote should make everything faster. With the branch, you can see the indirection\n\n```\nsage: QQ._coerce_(3)\nDeprecationWarning: _coerce_ is deprecated, use coerce instead\nSee https://trac.sagemath.org/33497 for details.\n3\n```",
    "created_at": "2022-03-14T07:42:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544084",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'>Comment 5:</a>
Currently there is an indirection : `_coerce_`/`_coerce_c` calls `coerce`. So what I wrote should make everything faster. With the branch, you can see the indirection

```
sage: QQ._coerce_(3)
DeprecationWarning: _coerce_ is deprecated, use coerce instead
See https://trac.sagemath.org/33497 for details.
3
```



---

archive/issue_comments_544085.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nI see. Thanks. So every parent that you changed already has an `element_constructor` then (and hence making that an indirection)?",
    "created_at": "2022-03-14T08:36:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544085",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'>Comment 6:</a>
I see. Thanks. So every parent that you changed already has an `element_constructor` then (and hence making that an indirection)?



---

archive/issue_comments_544086.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nI did not modify any parent. If tests pass, then all parents that are tested have an element constructor...",
    "created_at": "2022-03-14T09:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544086",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'>Comment 7:</a>
I did not modify any parent. If tests pass, then all parents that are tested have an element constructor...



---

archive/issue_comments_544087.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nI wasn\u2019t be precise enough, but for the parents that you call `coerce()` instead of `_coerce_()`. Test passing is not an indication because you did these changes. It would need to be tested with the deprecation but *without* the aforementioned change.\n\nI am not sure that is a good thing that there is the element constructor and using the old coercion system as it means it is half way between the two, but that is not so relevant.",
    "created_at": "2022-03-14T09:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544087",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'>Comment 8:</a>
I wasn’t be precise enough, but for the parents that you call `coerce()` instead of `_coerce_()`. Test passing is not an indication because you did these changes. It would need to be tested with the deprecation but *without* the aforementioned change.

I am not sure that is a good thing that there is the element constructor and using the old coercion system as it means it is half way between the two, but that is not so relevant.



---

archive/issue_comments_544088.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nShould I add a warning when the element constructor is not implemented? ie\n\n```diff\ndiff --git a/src/sage/structure/parent_old.pyx b/src/sage/structure/parent_old.pyx\nindex 630f0ca861..02c3423a0b 100644\n--- a/src/sage/structure/parent_old.pyx\n+++ b/src/sage/structure/parent_old.pyx\n@@ -39,7 +39,8 @@ from cpython.bool cimport *\n cdef inline check_old_coerce(Parent p):\n     if p._element_constructor is not None:\n         raise RuntimeError(\"%s still using old coercion framework\" % p)\n-\n+    from warnings import warn\n+    warn(\"{} does not implement element_constructor\".format(p), RuntimeWarning)\n \n cdef class Parent(parent.Parent):\n     \"\"\"\n```",
    "created_at": "2022-03-14T10:25:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544088",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'>Comment 9:</a>
Should I add a warning when the element constructor is not implemented? ie

```diff
diff --git a/src/sage/structure/parent_old.pyx b/src/sage/structure/parent_old.pyx
index 630f0ca861..02c3423a0b 100644
--- a/src/sage/structure/parent_old.pyx
+++ b/src/sage/structure/parent_old.pyx
@@ -39,7 +39,8 @@ from cpython.bool cimport *
 cdef inline check_old_coerce(Parent p):
     if p._element_constructor is not None:
         raise RuntimeError("%s still using old coercion framework" % p)
-
+    from warnings import warn
+    warn("{} does not implement element_constructor".format(p), RuntimeWarning)
 
 cdef class Parent(parent.Parent):
     """
```



---

archive/issue_comments_544089.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nThat is a good idea for a way to check. My guess is there are still parents that use that. However, I suspect there are parents that do not implement it since it is something that comes from using the new style `Parent`. So I would be a little curious as to what would prevent them from moving to the new coercion framework. There also wouldn\u2019t be any way to reach the `_coerce_c()` or _coerce_impl()`, right?\n\nThe change `_coerce_c()` -> `coerce()` is not removing an indirection though.",
    "created_at": "2022-03-14T11:29:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544089",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>Comment 10:</a>
That is a good idea for a way to check. My guess is there are still parents that use that. However, I suspect there are parents that do not implement it since it is something that comes from using the new style `Parent`. So I would be a little curious as to what would prevent them from moving to the new coercion framework. There also wouldn’t be any way to reach the `_coerce_c()` or _coerce_impl()`, right?

The change `_coerce_c()` -> `coerce()` is not removing an indirection though.



---

archive/issue_comments_544090.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nIt seems to me that only multivariate polynomial rings are going through the old coercion framework\n\n```\n$ git grep -l '_coerce_c_impl('\nrings/polynomial/multi_polynomial_ring_base.pxd\nrings/polynomial/multi_polynomial_ring_base.pyx\nstructure/parent_base.pyx\nstructure/parent_old.pxd\n```",
    "created_at": "2022-03-14T12:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544090",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'>Comment 11:</a>
It seems to me that only multivariate polynomial rings are going through the old coercion framework

```
$ git grep -l '_coerce_c_impl('
rings/polynomial/multi_polynomial_ring_base.pxd
rings/polynomial/multi_polynomial_ring_base.pyx
structure/parent_base.pyx
structure/parent_old.pxd
```



---

archive/issue_comments_544091.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nThen perhaps we can just leave those calls to `_coerce_c` and fully deprecate `_coerce_()`?\n\nAlso, the patchbot seems to report an infinite loop in `schemes/hyperelliptic_curves/monsky_washnitzer.py`:\n\n```\n      File \"/amd/compute/sagebot/sage/local/var/lib/sage/venv-python3.10.2/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 313, in __call__\n        return self.coerce(value)\n      File \"sage/structure/parent.pyx\", line 1183, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11113)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1215, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11059)\n        return (<map.Map>mor)._call_(x)\n      File \"sage/categories/morphism.pyx\", line 457, in sage.categories.morphism.CallMorphism._call_ (build/cythonized/sage/categories/morphism.c:6817)\n        return self._codomain(x)\n      File \"/amd/compute/sagebot/sage/local/var/lib/sage/venv-python3.10.2/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 313, in __call__\n        return self.coerce(value)\n```",
    "created_at": "2022-03-14T23:57:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544091",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'>Comment 12:</a>
Then perhaps we can just leave those calls to `_coerce_c` and fully deprecate `_coerce_()`?

Also, the patchbot seems to report an infinite loop in `schemes/hyperelliptic_curves/monsky_washnitzer.py`:

```
      File "/amd/compute/sagebot/sage/local/var/lib/sage/venv-python3.10.2/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 313, in __call__
        return self.coerce(value)
      File "sage/structure/parent.pyx", line 1183, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11113)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1215, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11059)
        return (<map.Map>mor)._call_(x)
      File "sage/categories/morphism.pyx", line 457, in sage.categories.morphism.CallMorphism._call_ (build/cythonized/sage/categories/morphism.c:6817)
        return self._codomain(x)
      File "/amd/compute/sagebot/sage/local/var/lib/sage/venv-python3.10.2/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 313, in __call__
        return self.coerce(value)
```



---

archive/issue_events_441796.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-03-14T23:57:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441796"
}
```



---

archive/issue_events_441797.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-03-14T23:57:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441797"
}
```



---

archive/issue_comments_544092.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nYes, there is something going wrong in \"monsky_washnitzer\", probably (at least) in the class\n\n`SpecialCubicQuotientRing`\n\nwhich has no element constructor. Maybe it would also help to add a method \"one\" to this ring ?\n\n*EDIT*: adding \"one\" does not fix the infinite recursion",
    "created_at": "2022-03-15T07:41:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544092",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'>Comment 13:</a>
Yes, there is something going wrong in "monsky_washnitzer", probably (at least) in the class

`SpecialCubicQuotientRing`

which has no element constructor. Maybe it would also help to add a method "one" to this ring ?

*EDIT*: adding "one" does not fix the infinite recursion



---

archive/issue_comments_544093.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI pushed to trac a rough branch (public/monsky_coercion) where I tried to convert the Monsky-Washnitser file to the current coercion system. Not yet working, but possibly close to. Maybe Travis would know better what to do.",
    "created_at": "2022-03-15T21:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544093",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'>Comment 14:</a>
I pushed to trac a rough branch (public/monsky_coercion) where I tried to convert the Monsky-Washnitser file to the current coercion system. Not yet working, but possibly close to. Maybe Travis would know better what to do.



---

archive/issue_comments_544094.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI have made #33525 for the Monsky problem.",
    "created_at": "2022-03-18T15:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544094",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'>Comment 15:</a>
I have made #33525 for the Monsky problem.



---

archive/issue_comments_544095.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nI would suggest not to touch the file `schemes/hyperelliptic_curves/monsky_washnitzer.py` here at all.",
    "created_at": "2022-03-18T15:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544095",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'>Comment 16:</a>
I would suggest not to touch the file `schemes/hyperelliptic_curves/monsky_washnitzer.py` here at all.



---

archive/issue_comments_544096.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nso here is a branch just the same but with no changes in monsky\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/238a482eae419ed7ed1872fc48ab7f97f44be084\">238a482</a></td><td><code>33497: _coerce_/_coerce_c -> coerce</code></td></tr></table>\n",
    "created_at": "2022-03-18T20:47:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544096",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'>Comment 17:</a>
so here is a branch just the same but with no changes in monsky

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/238a482eae419ed7ed1872fc48ab7f97f44be084">238a482</a></td><td><code>33497: _coerce_/_coerce_c -> coerce</code></td></tr></table>




---

archive/issue_comments_544097.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/33497](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/33497)** to **[public/ticket/33497](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33497)**",
    "created_at": "2022-03-18T20:47:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544097",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/vdelecroix/33497](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/33497)** to **[public/ticket/33497](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33497)**



---

archive/issue_comments_544098.json:
```json
{
    "body": "Changed commit from **[cd7e895](https://github.com/sagemath/sagetrac-mirror/commit/cd7e895748ea157b06a36c3d640fa05e11fb485e)** to **[238a482](https://github.com/sagemath/sagetrac-mirror/commit/238a482eae419ed7ed1872fc48ab7f97f44be084)**",
    "created_at": "2022-03-18T20:47:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544098",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[cd7e895](https://github.com/sagemath/sagetrac-mirror/commit/cd7e895748ea157b06a36c3d640fa05e11fb485e)** to **[238a482](https://github.com/sagemath/sagetrac-mirror/commit/238a482eae419ed7ed1872fc48ab7f97f44be084)**



---

archive/issue_comments_544099.json:
```json
{
    "body": "Dependencies: **#33525**",
    "created_at": "2022-03-18T20:47:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544099",
    "user": "https://github.com/fchapoton"
}
```

Dependencies: **#33525**



---

archive/issue_comments_544100.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nit seems that the pathcbot ran the doctests without merging the dependency..",
    "created_at": "2022-03-19T08:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544100",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'>Comment 18:</a>
it seems that the pathcbot ran the doctests without merging the dependency..



---

archive/issue_comments_544101.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nI think it needs to be manually merged in each ticket for testing.",
    "created_at": "2022-03-19T08:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544101",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'>Comment 19:</a>
I think it needs to be manually merged in each ticket for testing.



---

archive/issue_comments_544102.json:
```json
{
    "body": "Changed commit from **[238a482](https://github.com/sagemath/sagetrac-mirror/commit/238a482eae419ed7ed1872fc48ab7f97f44be084)** to **[6cd65aa](https://github.com/sagemath/sagetrac-mirror/commit/6cd65aabe85aaef17512c61ff6c58d6bc0c55d75)**",
    "created_at": "2022-03-24T23:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544102",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[238a482](https://github.com/sagemath/sagetrac-mirror/commit/238a482eae419ed7ed1872fc48ab7f97f44be084)** to **[6cd65aa](https://github.com/sagemath/sagetrac-mirror/commit/6cd65aabe85aaef17512c61ff6c58d6bc0c55d75)**



---

archive/issue_comments_544103.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d32b91446a5676a6038f8e05faf37b34dc4da243\">d32b914</a></td><td><code>tentative to convert monsky to coercion system</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c808d4786b0d46135300c41c59973355b33649a8\">c808d47</a></td><td><code>monsky : modern coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5abbdf230cefa8242c7b129fc4e5c7fba0bdcab6\">5abbdf2</a></td><td><code>adding doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2c5114d4d588ea00c9f0ff75f823e2f7b7913ce\">c2c5114</a></td><td><code>various changes in monsky after reviewer's suggestions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbf7db677c0d4b244422d1664c00d6fe29d4674a\">cbf7db6</a></td><td><code>one little detail</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cae3dafa7746c3647e70c65658bac3438a864cb\">6cae3da</a></td><td><code>fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70362ae12de4ef74cd44f89c0863e2fecc804997\">70362ae</a></td><td><code>details in doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cd65aabe85aaef17512c61ff6c58d6bc0c55d75\">6cd65aa</a></td><td><code>Merge branch 'public/ticket/33497' of https://github.com/sagemath/sagetrac-mirror into public/ticket/33497</code></td></tr></table>\n",
    "created_at": "2022-03-24T23:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544103",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'>Comment 21:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d32b91446a5676a6038f8e05faf37b34dc4da243">d32b914</a></td><td><code>tentative to convert monsky to coercion system</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c808d4786b0d46135300c41c59973355b33649a8">c808d47</a></td><td><code>monsky : modern coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5abbdf230cefa8242c7b129fc4e5c7fba0bdcab6">5abbdf2</a></td><td><code>adding doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2c5114d4d588ea00c9f0ff75f823e2f7b7913ce">c2c5114</a></td><td><code>various changes in monsky after reviewer's suggestions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbf7db677c0d4b244422d1664c00d6fe29d4674a">cbf7db6</a></td><td><code>one little detail</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cae3dafa7746c3647e70c65658bac3438a864cb">6cae3da</a></td><td><code>fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70362ae12de4ef74cd44f89c0863e2fecc804997">70362ae</a></td><td><code>details in doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cd65aabe85aaef17512c61ff6c58d6bc0c55d75">6cd65aa</a></td><td><code>Merge branch 'public/ticket/33497' of https://github.com/sagemath/sagetrac-mirror into public/ticket/33497</code></td></tr></table>




---

archive/issue_comments_544104.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI just pushed the merge. Running the tests that failed before, I get the following deprecation warnings:\n\n```\nsage -t --warn-long 36.7 --random-seed=61225901820605168759510913146636968794 src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 2457, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement._rmul_\nFailed example:\n    x._rmul_(y)\nExpected:\n    y*1*x\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 3103, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential._add_\nFailed example:\n    x*w + w\nExpected:\n    (1 + x) dx/2y\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 3279, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.extract_pow_y\nFailed example:\n    (A * C.invariant_differential()).extract_pow_y(5)\nExpected:\n    [1, 0, 0, 0, 0]\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 3489, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y\nFailed example:\n    (y^2).diff().reduce_pos_y()\nExpected:\n    (y^2*1, 0 dx/2y)\n\nsage -t --warn-long 36.7 --random-seed=61225901820605168759510913146636968794 src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py\", line 735, in sage.schemes.hyperelliptic_curves.hyperelliptic_padic_field.coleman_integral\nFailed example:\n    C.coleman_integral(x*w, P, Q)\nExpected:\n    O(11^6)\n```\nand one proper failure:\n\n```\nsage -t --warn-long 36.7 --random-seed=61225901820605168759510913146636968794 src/sage/rings/finite_rings/element_pari_ffelt.pyx\n**********************************************************************\nFile \"src/sage/rings/finite_rings/element_pari_ffelt.pyx\", line 1285, in sage.rings.finite_rings.element_pari_ffelt.FiniteFieldElement_pari_ffelt._gap_init_\nFailed example:\n    gap.coerce(a)\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: order must be at most 65536\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/home/travis/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/travis/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.finite_rings.element_pari_ffelt.FiniteFieldElement_pari_ffelt._gap_init_[13]>\", line 1, in <module>\n        gap.coerce(a)\n      File \"sage/structure/parent.pyx\", line 1183, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11113)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1213, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11039)\n        raise TypeError(_LazyString(\"no canonical coercion from %s to %s\", (parent(x), self), {}))\n    TypeError: no canonical coercion from Finite Field in a of size 1009^2 to Gap\n```",
    "created_at": "2022-03-24T23:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544104",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'>Comment 22:</a>
I just pushed the merge. Running the tests that failed before, I get the following deprecation warnings:

```
sage -t --warn-long 36.7 --random-seed=61225901820605168759510913146636968794 src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 2457, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement._rmul_
Failed example:
    x._rmul_(y)
Expected:
    y*1*x
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 3103, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential._add_
Failed example:
    x*w + w
Expected:
    (1 + x) dx/2y
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 3279, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.extract_pow_y
Failed example:
    (A * C.invariant_differential()).extract_pow_y(5)
Expected:
    [1, 0, 0, 0, 0]
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 3489, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y
Failed example:
    (y^2).diff().reduce_pos_y()
Expected:
    (y^2*1, 0 dx/2y)

sage -t --warn-long 36.7 --random-seed=61225901820605168759510913146636968794 src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py", line 735, in sage.schemes.hyperelliptic_curves.hyperelliptic_padic_field.coleman_integral
Failed example:
    C.coleman_integral(x*w, P, Q)
Expected:
    O(11^6)
```
and one proper failure:

```
sage -t --warn-long 36.7 --random-seed=61225901820605168759510913146636968794 src/sage/rings/finite_rings/element_pari_ffelt.pyx
**********************************************************************
File "src/sage/rings/finite_rings/element_pari_ffelt.pyx", line 1285, in sage.rings.finite_rings.element_pari_ffelt.FiniteFieldElement_pari_ffelt._gap_init_
Failed example:
    gap.coerce(a)
Expected:
    Traceback (most recent call last):
    ...
    TypeError: order must be at most 65536
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/home/travis/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/travis/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.finite_rings.element_pari_ffelt.FiniteFieldElement_pari_ffelt._gap_init_[13]>", line 1, in <module>
        gap.coerce(a)
      File "sage/structure/parent.pyx", line 1183, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11113)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1213, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:11039)
        raise TypeError(_LazyString("no canonical coercion from %s to %s", (parent(x), self), {}))
    TypeError: no canonical coercion from Finite Field in a of size 1009^2 to Gap
```



---

archive/issue_comments_544105.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nany idea where these deprecations comes from ?\nthe traceback is not very helpful:\n\n```\n      File \"<doctest sage.schemes.hyperelliptic_curves.hyperelliptic_padic_field.coleman_integral[8]>\", line 1, in <module>\n        C.coleman_integral(x*w, P, Q)\n      File \"/home/debian/sage/local/lib/python3.9/site-packages/sage/categories/pushout.py\", line 4112, in pushout\n        elif S.has_coerce_map_from(Rs[-1]):\n      File \"/home/debian/sage/local/lib/python3.9/site-packages/sage/misc/superseded.py\", line 99, in deprecation\n        warning(trac_number, message, DeprecationWarning, stacklevel)\n```\n\nEDIT: This may hint that monsky_washnitser is not yet in perfect shape..",
    "created_at": "2022-03-25T07:53:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544105",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'>Comment 23:</a>
any idea where these deprecations comes from ?
the traceback is not very helpful:

```
      File "<doctest sage.schemes.hyperelliptic_curves.hyperelliptic_padic_field.coleman_integral[8]>", line 1, in <module>
        C.coleman_integral(x*w, P, Q)
      File "/home/debian/sage/local/lib/python3.9/site-packages/sage/categories/pushout.py", line 4112, in pushout
        elif S.has_coerce_map_from(Rs[-1]):
      File "/home/debian/sage/local/lib/python3.9/site-packages/sage/misc/superseded.py", line 99, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
```

EDIT: This may hint that monsky_washnitser is not yet in perfect shape..



---

archive/issue_comments_544106.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nWhat is happening is this:\n\n```\nparent_old.Parent._coerce_impl() -> ParentWithBase._coerce_c_impl() -> _coerce_()\n```\n(I have also deprecated the second method locally and will push once I figure out how to fix things fully since it either calls `_coerce_` or errors out.) So my guess it is coming from one of these calls:\n\n```\ntravis@tscrim:~/sage/src/sage/combinat$ grep -R \"\\._coerce_impl(\" ../*\n../algebras/commutative_dga.py:            return self._coerce_impl(im_gens)\n../categories/crystals.py:            return self._coerce_impl(on_gens)\n../interfaces/r.py:        return super(R, self)._coerce_impl(x, use_special=use_special)\n../interfaces/polymake.py:        return super(PolymakeAbstract, self)._coerce_impl(x, use_special=use_special)\n../interfaces/interface.py:            result = self._coerce_impl(x, use_special=False)\n../modular/abvar/homspace.py:            sage: J = J0(37) ; J.Hom(J)._coerce_impl(matrix(ZZ,4,[5..20]))\n../modular/abvar/homspace.py:            sage: K = J0(11) * J0(11) ; J.Hom(K)._coerce_impl(matrix(ZZ,4,[5..20]))\n../modular/abvar/homspace.py:            return HomsetWithBase._coerce_impl(self, x)\n../rings/finite_rings/homset.py:            return self._coerce_impl(im_gens)\n../rings/finite_rings/homset.py:                return self._coerce_impl(im_gens)\n../rings/multi_power_series_ring.py:            sage: g1 = R._coerce_impl(f1)\n../rings/polynomial/pbori/pbori.pyx:            return self._coerce_impl(other)\n```\nReducing it down to removing the obvious non-related calls:\n\n```\n../algebras/commutative_dga.py:            return self._coerce_impl(im_gens)\n../rings/finite_rings/homset.py:            return self._coerce_impl(im_gens)\n../rings/finite_rings/homset.py:                return self._coerce_impl(im_gens)\n../rings/polynomial/pbori/pbori.pyx:            return self._coerce_impl(other)\n```\nIt is one of these is what is starting the process to yield the error.\n\nHowever, I don't think that is the root issue. Putting a `print(type(self))` in `parent_old.Parent._coerce_impl` yields\n\n```\n <class 'sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing_with_category'>\n```\nIndeed, that is the problem as that is still using the old coercion framework, which I tested by changing it to inherit from `Parent` instead. I have created #33576 for this.",
    "created_at": "2022-03-27T06:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544106",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:24'>Comment 24:</a>
What is happening is this:

```
parent_old.Parent._coerce_impl() -> ParentWithBase._coerce_c_impl() -> _coerce_()
```
(I have also deprecated the second method locally and will push once I figure out how to fix things fully since it either calls `_coerce_` or errors out.) So my guess it is coming from one of these calls:

```
travis@tscrim:~/sage/src/sage/combinat$ grep -R "\._coerce_impl(" ../*
../algebras/commutative_dga.py:            return self._coerce_impl(im_gens)
../categories/crystals.py:            return self._coerce_impl(on_gens)
../interfaces/r.py:        return super(R, self)._coerce_impl(x, use_special=use_special)
../interfaces/polymake.py:        return super(PolymakeAbstract, self)._coerce_impl(x, use_special=use_special)
../interfaces/interface.py:            result = self._coerce_impl(x, use_special=False)
../modular/abvar/homspace.py:            sage: J = J0(37) ; J.Hom(J)._coerce_impl(matrix(ZZ,4,[5..20]))
../modular/abvar/homspace.py:            sage: K = J0(11) * J0(11) ; J.Hom(K)._coerce_impl(matrix(ZZ,4,[5..20]))
../modular/abvar/homspace.py:            return HomsetWithBase._coerce_impl(self, x)
../rings/finite_rings/homset.py:            return self._coerce_impl(im_gens)
../rings/finite_rings/homset.py:                return self._coerce_impl(im_gens)
../rings/multi_power_series_ring.py:            sage: g1 = R._coerce_impl(f1)
../rings/polynomial/pbori/pbori.pyx:            return self._coerce_impl(other)
```
Reducing it down to removing the obvious non-related calls:

```
../algebras/commutative_dga.py:            return self._coerce_impl(im_gens)
../rings/finite_rings/homset.py:            return self._coerce_impl(im_gens)
../rings/finite_rings/homset.py:                return self._coerce_impl(im_gens)
../rings/polynomial/pbori/pbori.pyx:            return self._coerce_impl(other)
```
It is one of these is what is starting the process to yield the error.

However, I don't think that is the root issue. Putting a `print(type(self))` in `parent_old.Parent._coerce_impl` yields

```
 <class 'sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing_with_category'>
```
Indeed, that is the problem as that is still using the old coercion framework, which I tested by changing it to inherit from `Parent` instead. I have created #33576 for this.



---

archive/issue_comments_544107.json:
```json
{
    "body": "Changed dependencies from **#33525** to **#33525, #33576**",
    "created_at": "2022-03-27T06:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544107",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#33525** to **#33525, #33576**



---

archive/issue_comments_544108.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nWith the changes on #33576, the only failure left I am getting is on `rings/finite_rings/element_pari_ffelt.pyx`, which I believe is essentially a trivial failure because of a different error message because of the coercion change (it is reporting the same error IMO). So I propose changing the doctest output, and then all tests should pass.",
    "created_at": "2022-03-27T22:46:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544108",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'>Comment 25:</a>
With the changes on #33576, the only failure left I am getting is on `rings/finite_rings/element_pari_ffelt.pyx`, which I believe is essentially a trivial failure because of a different error message because of the coercion change (it is reporting the same error IMO). So I propose changing the doctest output, and then all tests should pass.



---

archive/issue_comments_544109.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d08f96804ea3c7f44564026ec71ca979daafc071\">d08f968</a></td><td><code>Convert MonskyWashnitzerDifferential to use the new coercion model.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbcb1508a7c366d0b34ae6881d8f297c3c03c7d5\">dbcb150</a></td><td><code>Modernization of special hyperelliptic quotient and other fixes.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/276d9d20d3f2483244ad41f97b5d1a5a0741a8a7\">276d9d2</a></td><td><code>partially repairing monsky</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/98d0709e7a2953475936ba09d85f79779ae6105d\">98d0709</a></td><td><code>Fixing bug with not normalizing input.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea8e66a8bfad0ff5f770295bb39063e037d108cf\">ea8e66a</a></td><td><code>Merge branch 'public/coercion/special_hyperelliptic_quotient_ring-33576' into public/ticket/33497</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/74ca9d0a88d0e105470f97cff935d8933ad7aabd\">74ca9d0</a></td><td><code>Merge branch 'develop' into public/ticket/33497</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25ba447290b41296662d8c66b21bae3b5f7431c9\">25ba447</a></td><td><code>Merge branch 'develop' into public/coercion/special_hyperelliptic_quotient_ring-33576</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c47495bd1058b6c4b8c0be83b88776d631005b6\">7c47495</a></td><td><code>Fixing pyflakes issues in monsky_washnitzer.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10ba3689a7e023dbe72e58df73896580abc4ffb4\">10ba368</a></td><td><code>Merge branch 'public/coercion/special_hyperelliptic_quotient_ring-33576' into public/ticket/33497</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/251cbc3fcb47c45eff2e909533ea859e9c6a8db3\">251cbc3</a></td><td><code>Fixing last doctest failure.</code></td></tr></table>\n",
    "created_at": "2022-03-29T03:42:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544109",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>Comment 26:</a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d08f96804ea3c7f44564026ec71ca979daafc071">d08f968</a></td><td><code>Convert MonskyWashnitzerDifferential to use the new coercion model.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbcb1508a7c366d0b34ae6881d8f297c3c03c7d5">dbcb150</a></td><td><code>Modernization of special hyperelliptic quotient and other fixes.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/276d9d20d3f2483244ad41f97b5d1a5a0741a8a7">276d9d2</a></td><td><code>partially repairing monsky</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/98d0709e7a2953475936ba09d85f79779ae6105d">98d0709</a></td><td><code>Fixing bug with not normalizing input.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea8e66a8bfad0ff5f770295bb39063e037d108cf">ea8e66a</a></td><td><code>Merge branch 'public/coercion/special_hyperelliptic_quotient_ring-33576' into public/ticket/33497</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/74ca9d0a88d0e105470f97cff935d8933ad7aabd">74ca9d0</a></td><td><code>Merge branch 'develop' into public/ticket/33497</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25ba447290b41296662d8c66b21bae3b5f7431c9">25ba447</a></td><td><code>Merge branch 'develop' into public/coercion/special_hyperelliptic_quotient_ring-33576</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c47495bd1058b6c4b8c0be83b88776d631005b6">7c47495</a></td><td><code>Fixing pyflakes issues in monsky_washnitzer.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10ba3689a7e023dbe72e58df73896580abc4ffb4">10ba368</a></td><td><code>Merge branch 'public/coercion/special_hyperelliptic_quotient_ring-33576' into public/ticket/33497</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/251cbc3fcb47c45eff2e909533ea859e9c6a8db3">251cbc3</a></td><td><code>Fixing last doctest failure.</code></td></tr></table>




---

archive/issue_comments_544110.json:
```json
{
    "body": "Changed commit from **[6cd65aa](https://github.com/sagemath/sagetrac-mirror/commit/6cd65aabe85aaef17512c61ff6c58d6bc0c55d75)** to **[251cbc3](https://github.com/sagemath/sagetrac-mirror/commit/251cbc3fcb47c45eff2e909533ea859e9c6a8db3)**",
    "created_at": "2022-03-29T03:42:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544110",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6cd65aa](https://github.com/sagemath/sagetrac-mirror/commit/6cd65aabe85aaef17512c61ff6c58d6bc0c55d75)** to **[251cbc3](https://github.com/sagemath/sagetrac-mirror/commit/251cbc3fcb47c45eff2e909533ea859e9c6a8db3)**



---

archive/issue_comments_544111.json:
```json
{
    "body": "Changed commit from **[251cbc3](https://github.com/sagemath/sagetrac-mirror/commit/251cbc3fcb47c45eff2e909533ea859e9c6a8db3)** to **[9635e1e](https://github.com/sagemath/sagetrac-mirror/commit/9635e1e48b90538e919cf30001b24f8439f88e78)**",
    "created_at": "2022-03-29T03:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544111",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[251cbc3](https://github.com/sagemath/sagetrac-mirror/commit/251cbc3fcb47c45eff2e909533ea859e9c6a8db3)** to **[9635e1e](https://github.com/sagemath/sagetrac-mirror/commit/9635e1e48b90538e919cf30001b24f8439f88e78)**



---

archive/issue_comments_544112.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc660bb07d6b52cecaf3463a3f4d70c4d445bac8\">fc660bb</a></td><td><code>get rid of `__nonzero__` aliases for __bool__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82dffdfe8b7d11f0ea52a983b5ae232a645c75cb\">82dffdf</a></td><td><code>convert `__nonzero__` to __bool__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/969cbcd35fdcd7c233146cfaee5120382969dd87\">969cbcd</a></td><td><code>even less __nonzero__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b16bc4adff3eaf28862ab696ea92da18376db747\">b16bc4a</a></td><td><code>manual fixes for __nonzero__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf98130a90cbb635bc9eb6c7ac4e1c7c3b382c18\">cf98130</a></td><td><code>fine tuning : full removal of __nonzero__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b24ef8377d002b182756456cc9af5e79fedaa5e7\">b24ef83</a></td><td><code>Merge branch 'u/chapoton/33558' in 9.6.B6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9635e1e48b90538e919cf30001b24f8439f88e78\">9635e1e</a></td><td><code>Merge branch 'u/chapoton/33558' of https://github.com/sagemath/sagetrac-mirror into public/ticket/33497</code></td></tr></table>\n",
    "created_at": "2022-03-29T03:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544112",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>Comment 27:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc660bb07d6b52cecaf3463a3f4d70c4d445bac8">fc660bb</a></td><td><code>get rid of `__nonzero__` aliases for __bool__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82dffdfe8b7d11f0ea52a983b5ae232a645c75cb">82dffdf</a></td><td><code>convert `__nonzero__` to __bool__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/969cbcd35fdcd7c233146cfaee5120382969dd87">969cbcd</a></td><td><code>even less __nonzero__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b16bc4adff3eaf28862ab696ea92da18376db747">b16bc4a</a></td><td><code>manual fixes for __nonzero__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf98130a90cbb635bc9eb6c7ac4e1c7c3b382c18">cf98130</a></td><td><code>fine tuning : full removal of __nonzero__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b24ef8377d002b182756456cc9af5e79fedaa5e7">b24ef83</a></td><td><code>Merge branch 'u/chapoton/33558' in 9.6.B6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9635e1e48b90538e919cf30001b24f8439f88e78">9635e1e</a></td><td><code>Merge branch 'u/chapoton/33558' of https://github.com/sagemath/sagetrac-mirror into public/ticket/33497</code></td></tr></table>




---

archive/issue_events_441798.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-03-29T03:44:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441798"
}
```



---

archive/issue_events_441799.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-03-29T03:44:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441799"
}
```



---

archive/issue_comments_544113.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nHere is with fixing the last doctest and the other deprecation I mentioned. I also merged in #33558 to resolve a trivial conflict.",
    "created_at": "2022-03-29T03:44:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544113",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'>Comment 28:</a>
Here is with fixing the last doctest and the other deprecation I mentioned. I also merged in #33558 to resolve a trivial conflict.



---

archive/issue_comments_544114.json:
```json
{
    "body": "Changed dependencies from **#33525, #33576** to **#33525, #33576, #33558**",
    "created_at": "2022-03-29T03:44:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544114",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#33525, #33576** to **#33525, #33576, #33558**



---

archive/issue_comments_544115.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nMorally green bot (pyflakes warnings are not introduced on this ticket).",
    "created_at": "2022-04-01T06:58:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544115",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:29'>Comment 29:</a>
Morally green bot (pyflakes warnings are not introduced on this ticket).



---

archive/issue_comments_544116.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nPing. Should we try to get this into the next Sage release or wait for the next beta0?",
    "created_at": "2022-04-05T08:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544116",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:30'>Comment 30:</a>
Ping. Should we try to get this into the next Sage release or wait for the next beta0?



---

archive/issue_comments_544117.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nWould be great to have it in the next release! It is a major step forward in using `Parent`.",
    "created_at": "2022-04-05T17:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544117",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'>Comment 31:</a>
Would be great to have it in the next release! It is a major step forward in using `Parent`.



---

archive/issue_comments_544118.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nOnly my latest changes need to be reviewed as I have reviewed Fr\u00e9d\u00e9ric's and (re-)reviewed yours (as Fr\u00e9d\u00e9ric likely already reviewed yours). If mine are good, then it is a positive review.",
    "created_at": "2022-04-06T00:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544118",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'>Comment 32:</a>
Only my latest changes need to be reviewed as I have reviewed Frédéric's and (re-)reviewed yours (as Frédéric likely already reviewed yours). If mine are good, then it is a positive review.



---

archive/issue_comments_544119.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw**",
    "created_at": "2022-04-06T00:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544119",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Frédéric Chapoton, Travis Scrimshaw**



---

archive/issue_comments_544120.json:
```json
{
    "body": "Changed reviewer from **Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw** to **Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw, Vincent Delecroix**",
    "created_at": "2022-04-07T16:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544120",
    "user": "https://github.com/videlec"
}
```

Changed reviewer from **Frédéric Chapoton, Travis Scrimshaw** to **Frédéric Chapoton, Travis Scrimshaw, Vincent Delecroix**



---

archive/issue_comments_544121.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nLooks good to me.",
    "created_at": "2022-04-07T16:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544121",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'>Comment 33:</a>
Looks good to me.



---

archive/issue_comments_544122.json:
```json
{
    "body": "Changed author from **Vincent Delecroix** to **Vincent Delecroix, Travis Scrimshaw,**",
    "created_at": "2022-04-07T16:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544122",
    "user": "https://github.com/videlec"
}
```

Changed author from **Vincent Delecroix** to **Vincent Delecroix, Travis Scrimshaw,**



---

archive/issue_events_441800.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-04-07T16:57:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441800"
}
```



---

archive/issue_events_441801.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-04-07T16:57:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441801"
}
```



---

archive/issue_comments_544123.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nThank you.",
    "created_at": "2022-04-08T00:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544123",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:35'>Comment 35:</a>
Thank you.



---

archive/issue_events_441802.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-09T21:01:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441802"
}
```



---

archive/issue_events_441803.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-09T21:01:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441803"
}
```



---

archive/issue_comments_544124.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nMerge failure on top of:\n\n5a999eb9e1 Trac #33468: Feature for gfan\n\nb389f97a3a Trac #33466: sage.features.lrs: Make it a JoinFeature of Lrs, LrsNash; use Executable.absolute_filename\n\n204cbf0584 Trac #33017: LazyImport.__instancecheck__, __subclasscheck__: Return False on ImportError\n\nae06fa42e0 Trac #31802: Bug in plotting 3d polyhedron with rays, add option polygon='rainbow'\n\n0553c9b0b9 Trac #30749: Characteristic polynomial of central Hyperplane arrangement returns wrong result?\n\n2317d5d7fc Trac #30411: src/tox.ini: Add environment pyright\n\ncf219d6eb2 Trac #33661: Don't test files created by jupyter-sphinx\n\n770a894d6c Trac #33642: Update build/pkgs/matplotlib/install-requires.txt and distros/conda.txt\n\na4429624dc Trac #33638: GH Actions: Fix cygwin\n\n0a5029cfbe Trac #33430: GH Actions: Fix homebrew-maximal, remove opensuse-15.2.1\n\n7ee048cefb Trac #33426: add more details on conda-based installations of Sage\n\n7acdc3d662 Trac #33246: canonical_label returns incorrect partite sets\n\n6df7b36536 Trac #33063: notebook: update to 6.4.10 to fix deprecation warning\n\n365d2b1957 Trac #33650: Set JUPYTER_DATA_DIR etc. during docbuild\n\nb2ddb07d71 Trac #33635: fixing the broken linter, again\n\nc489291a97 Trac #33632: fix indentation (E111) in pyx files in numerical/\n\na837fee19e Trac #33626: sageinspect.sage_getfile(x) incorrect when using an alternate suffix for extension modules\n\n216d60bb1b Trac #33633: fix indentation (E111) in pyx files in graphs, libs, proba\n\n39d402cb75 Trac #33629: add negative for continued fractions\n\n4955762701 Trac #33565: Add CODE_OF_CONDUCT.md to the repo\n\n00bc51075d Trac #33560: pytest: ignore cython files\n\na02eec36bf Trac #33582: clean up docstring formatting in schemes/elliptic_curves/\n\n31995b748a Trac #33618: docbuild: typo in arguments check leads to confusing error\n\n94a131cc20 Trac #33612: sage.matrix.matrix_space: Rename a test_... function to _test_... (with deprecation)\n\n823194cfff Trac #33605: cbc: Add system package information for gentoo, nix\n\n6eb1f67d62 Trac #33593: fix W391 in groups/ and algebras/\n\n5ec6108788 Trac #33571: Correct wrong paths in the developer's guide\n\nb886d89536 Trac #33628: Fig bug in graphs.RandomToleranceGraph\n\n5ee8a50e85 Trac #33616: Simplify inventory builder\n\n0a7c8f485c Trac #33615: full cleanup of modules/fp_graded/\n\n97533a71f9 Trac #33589: Gitpod: track remote trac branch\n\nb8d5371aae Trac #33576: Modernize coercion for SpecialHyperellipticQuotientRing\n\n55da3e109e Trac #33572: sage -pytest\n\n2f104e6454 Trac #33533: Update nbconvert to 6.4.x, add optional package pyppeteer\n\n7a5714ac65 Trac #33366: BipartiteGraph() fails to create graph from graph6 string\n\ndfd98a710e Trac #31006: Add more typing information to manifold package\n\n360ee4c168 Trac #30540: Add package phitigra: Graph editor that works with Jupyter\n\n3f93cd0a9c Trac #29640: Create an AUTHORS.md file with links\n\nd8f76fb1bd Trac #33624: doctest unnecessarily assumes SAGE_VENV/bin contains `sage` binary\n\nb438a78918 Trac #33608: Building documentation is broken in Sage 9.6.beta6\n\n88e25dd77b Trac #33631: Github workflow: Fix pyright\n\n78bfb6c7ad Updated [SageMath](../wiki/SageMath) version to 9.6.beta7\n\n\n\nauthor 'Vincent Delecroix, Travis Scrimshaw,' does not look right",
    "created_at": "2022-04-09T21:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544124",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'>Comment 36:</a>
Merge failure on top of:

5a999eb9e1 Trac #33468: Feature for gfan

b389f97a3a Trac #33466: sage.features.lrs: Make it a JoinFeature of Lrs, LrsNash; use Executable.absolute_filename

204cbf0584 Trac #33017: LazyImport.__instancecheck__, __subclasscheck__: Return False on ImportError

ae06fa42e0 Trac #31802: Bug in plotting 3d polyhedron with rays, add option polygon='rainbow'

0553c9b0b9 Trac #30749: Characteristic polynomial of central Hyperplane arrangement returns wrong result?

2317d5d7fc Trac #30411: src/tox.ini: Add environment pyright

cf219d6eb2 Trac #33661: Don't test files created by jupyter-sphinx

770a894d6c Trac #33642: Update build/pkgs/matplotlib/install-requires.txt and distros/conda.txt

a4429624dc Trac #33638: GH Actions: Fix cygwin

0a5029cfbe Trac #33430: GH Actions: Fix homebrew-maximal, remove opensuse-15.2.1

7ee048cefb Trac #33426: add more details on conda-based installations of Sage

7acdc3d662 Trac #33246: canonical_label returns incorrect partite sets

6df7b36536 Trac #33063: notebook: update to 6.4.10 to fix deprecation warning

365d2b1957 Trac #33650: Set JUPYTER_DATA_DIR etc. during docbuild

b2ddb07d71 Trac #33635: fixing the broken linter, again

c489291a97 Trac #33632: fix indentation (E111) in pyx files in numerical/

a837fee19e Trac #33626: sageinspect.sage_getfile(x) incorrect when using an alternate suffix for extension modules

216d60bb1b Trac #33633: fix indentation (E111) in pyx files in graphs, libs, proba

39d402cb75 Trac #33629: add negative for continued fractions

4955762701 Trac #33565: Add CODE_OF_CONDUCT.md to the repo

00bc51075d Trac #33560: pytest: ignore cython files

a02eec36bf Trac #33582: clean up docstring formatting in schemes/elliptic_curves/

31995b748a Trac #33618: docbuild: typo in arguments check leads to confusing error

94a131cc20 Trac #33612: sage.matrix.matrix_space: Rename a test_... function to _test_... (with deprecation)

823194cfff Trac #33605: cbc: Add system package information for gentoo, nix

6eb1f67d62 Trac #33593: fix W391 in groups/ and algebras/

5ec6108788 Trac #33571: Correct wrong paths in the developer's guide

b886d89536 Trac #33628: Fig bug in graphs.RandomToleranceGraph

5ee8a50e85 Trac #33616: Simplify inventory builder

0a7c8f485c Trac #33615: full cleanup of modules/fp_graded/

97533a71f9 Trac #33589: Gitpod: track remote trac branch

b8d5371aae Trac #33576: Modernize coercion for SpecialHyperellipticQuotientRing

55da3e109e Trac #33572: sage -pytest

2f104e6454 Trac #33533: Update nbconvert to 6.4.x, add optional package pyppeteer

7a5714ac65 Trac #33366: BipartiteGraph() fails to create graph from graph6 string

dfd98a710e Trac #31006: Add more typing information to manifold package

360ee4c168 Trac #30540: Add package phitigra: Graph editor that works with Jupyter

3f93cd0a9c Trac #29640: Create an AUTHORS.md file with links

d8f76fb1bd Trac #33624: doctest unnecessarily assumes SAGE_VENV/bin contains `sage` binary

b438a78918 Trac #33608: Building documentation is broken in Sage 9.6.beta6

88e25dd77b Trac #33631: Github workflow: Fix pyright

78bfb6c7ad Updated [SageMath](../wiki/SageMath) version to 9.6.beta7



author 'Vincent Delecroix, Travis Scrimshaw,' does not look right



---

archive/issue_events_441804.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441804"
}
```



---

archive/issue_events_441805.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441805"
}
```



---

archive/issue_comments_544125.json:
```json
{
    "body": "Changed commit from **[9635e1e](https://github.com/sagemath/sagetrac-mirror/commit/9635e1e48b90538e919cf30001b24f8439f88e78)** to **[4ed53f8](https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38)**",
    "created_at": "2022-04-25T00:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544125",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9635e1e](https://github.com/sagemath/sagetrac-mirror/commit/9635e1e48b90538e919cf30001b24f8439f88e78)** to **[4ed53f8](https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38)**



---

archive/issue_comments_544126.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38\">4ed53f8</a></td><td><code>Merge branch 'public/ticket/33497' of https://github.com/sagemath/sagetrac-mirror into public/ticket/33497</code></td></tr></table>\n",
    "created_at": "2022-04-25T00:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544126",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:38'>Comment 38:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38">4ed53f8</a></td><td><code>Merge branch 'public/ticket/33497' of https://github.com/sagemath/sagetrac-mirror into public/ticket/33497</code></td></tr></table>




---

archive/issue_comments_544127.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nI am not getting any merge failure on 9.6.rc1. Although I guess this is probably too late to be merged into 9.6, so I guess we just have to wait for 9.7.beta0...",
    "created_at": "2022-04-25T00:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544127",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'>Comment 39:</a>
I am not getting any merge failure on 9.6.rc1. Although I guess this is probably too late to be merged into 9.6, so I guess we just have to wait for 9.7.beta0...



---

archive/issue_comments_544128.json:
```json
{
    "body": "Changed author from **Vincent Delecroix, Travis Scrimshaw,** to **Vincent Delecroix, Travis Scrimshaw**",
    "created_at": "2022-04-25T00:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544128",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Vincent Delecroix, Travis Scrimshaw,** to **Vincent Delecroix, Travis Scrimshaw**



---

archive/issue_events_441806.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-04-25T00:24:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441806"
}
```



---

archive/issue_events_441807.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-04-25T00:24:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441807"
}
```



---

archive/issue_comments_544129.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nThe failure was actually just \"author 'Vincent Delecroix, Travis Scrimshaw,' does not look right\". You just fixed that.",
    "created_at": "2022-04-25T00:27:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544129",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'>Comment 40:</a>
The failure was actually just "author 'Vincent Delecroix, Travis Scrimshaw,' does not look right". You just fixed that.



---

archive/issue_events_441808.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-05-20T22:27:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441808"
}
```



---

archive/issue_events_441809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9398d92474137e8bdbe6d633e1074d48b2fe0b4b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-05-20T22:27:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33497#event-441809"
}
```



---

archive/issue_comments_544130.json:
```json
{
    "body": "Changed branch from **[public/ticket/33497](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33497)** to **[4ed53f8](https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38)**",
    "created_at": "2022-05-20T22:27:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33497",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33497#issuecomment-544130",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/33497](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/33497)** to **[4ed53f8](https://github.com/sagemath/sagetrac-mirror/commit/4ed53f85c11bd1721c1a005040fba34527af5e38)**
