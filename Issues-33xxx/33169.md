# Issue 33169: Update awali to v2.1.1-220111

archive/issues_032932.json:
```json
{
    "assignees": [],
    "body": "It was released on January 11, 2022: http://files.vaucanson-project.org/2.1/tarballs/awali-all-v2.1.1-220111.tgz\n\nBranch/Commit: **[u/slabbe/33169](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33169) @ [`725afa7`](https://github.com/sagemath/sagetrac-mirror/commit/725afa7ca05139c7de4816ee91484f698512db97)**\n\nAuthor: **S\u00e9bastien Labb\u00e9**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33169_\n\n",
    "created_at": "2022-01-14T15:07:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update awali to v2.1.1-220111",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/33169",
    "user": "https://github.com/seblabbe"
}
```
It was released on January 11, 2022: http://files.vaucanson-project.org/2.1/tarballs/awali-all-v2.1.1-220111.tgz

Branch/Commit: **[u/slabbe/33169](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33169) @ [`725afa7`](https://github.com/sagemath/sagetrac-mirror/commit/725afa7ca05139c7de4816ee91484f698512db97)**

Author: **Sébastien Labbé**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/33169_





---

archive/issue_events_456418.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T15:07:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456418"
}
```



---

archive/issue_events_456419.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T15:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456419"
}
```



---

archive/issue_events_456420.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T15:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456420"
}
```



---

archive/issue_events_456421.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T15:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456421"
}
```



---

archive/issue_comments_536268.json:
```json
{
    "body": "Commit: **[`9db7fb1`](https://github.com/sagemath/sagetrac-mirror/commit/9db7fb1cada1d75c98bc5b9792bf0a0459ab67b2)**",
    "created_at": "2022-01-14T15:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536268",
    "user": "https://github.com/seblabbe"
}
```

Commit: **[`9db7fb1`](https://github.com/sagemath/sagetrac-mirror/commit/9db7fb1cada1d75c98bc5b9792bf0a0459ab67b2)**



---

archive/issue_events_456422.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T15:19:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456422"
}
```



---

archive/issue_comments_536269.json:
```json
{
    "body": "Branch: **[u/slabbe/33169](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33169)**",
    "created_at": "2022-01-14T15:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536269",
    "user": "https://github.com/seblabbe"
}
```

Branch: **[u/slabbe/33169](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33169)**



---

archive/issue_comments_536270.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9db7fb1cada1d75c98bc5b9792bf0a0459ab67b2\">9db7fb1</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr></table>\n",
    "created_at": "2022-01-14T15:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536270",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9db7fb1cada1d75c98bc5b9792bf0a0459ab67b2">9db7fb1</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr></table>




---

archive/issue_comments_536271.json:
```json
{
    "body": "Author: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2022-01-14T15:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536271",
    "user": "https://github.com/seblabbe"
}
```

Author: **Sébastien Labbé**



---

archive/issue_comments_536272.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNeeds `upstream_url` in `checksums.ini`",
    "created_at": "2022-01-14T15:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536272",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Needs `upstream_url` in `checksums.ini`



---

archive/issue_events_456423.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-14T15:59:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456423"
}
```



---

archive/issue_events_456424.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-14T15:59:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456424"
}
```



---

archive/issue_comments_536273.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI first put it, and then removed it before the commit because the url \n\n```\nupstream_url=http://files.vaucanson-project.org/2.1/tarballs/awali-all-vVERSION.tgz\n```\ncontains a `2.1` which is kind of not so generic. Do I still put it?",
    "created_at": "2022-01-14T16:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536273",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:3" align="right">comment:3</div>

I first put it, and then removed it before the commit because the url 

```
upstream_url=http://files.vaucanson-project.org/2.1/tarballs/awali-all-vVERSION.tgz
```
contains a `2.1` which is kind of not so generic. Do I still put it?



---

archive/issue_comments_536274.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYes",
    "created_at": "2022-01-14T16:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536274",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Yes



---

archive/issue_comments_536275.json:
```json
{
    "body": "Changed commit from **[`9db7fb1`](https://github.com/sagemath/sagetrac-mirror/commit/9db7fb1cada1d75c98bc5b9792bf0a0459ab67b2)** to **[`e44d4d9`](https://github.com/sagemath/sagetrac-mirror/commit/e44d4d9b21b04eb7ef6f7fea7b6a66e9506d9a00)**",
    "created_at": "2022-01-14T17:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536275",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9db7fb1`](https://github.com/sagemath/sagetrac-mirror/commit/9db7fb1cada1d75c98bc5b9792bf0a0459ab67b2)** to **[`e44d4d9`](https://github.com/sagemath/sagetrac-mirror/commit/e44d4d9b21b04eb7ef6f7fea7b6a66e9506d9a00)**



---

archive/issue_comments_536276.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e44d4d9b21b04eb7ef6f7fea7b6a66e9506d9a00\">e44d4d9</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr></table>\n",
    "created_at": "2022-01-14T17:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536276",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e44d4d9b21b04eb7ef6f7fea7b6a66e9506d9a00">e44d4d9</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr></table>




---

archive/issue_events_456425.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T17:06:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456425"
}
```



---

archive/issue_events_456426.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T17:06:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456426"
}
```



---

archive/issue_comments_536277.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nand rebased on top of 9.5.rc1",
    "created_at": "2022-01-14T17:06:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536277",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:6" align="right">comment:6</div>

and rebased on top of 9.5.rc1



---

archive/issue_comments_536278.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\noups, spkg-install needs to be updated:\n\n```\n[awali-2.1.1-220111] make[3]: *** No rule to make target 'b'.  Stop.\n[awali-2.1.1-220111] ***************************************************\n[awali-2.1.1-220111] Error building awali-2.1.1-220111\n```",
    "created_at": "2022-01-14T17:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536278",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:7" align="right">comment:7</div>

oups, spkg-install needs to be updated:

```
[awali-2.1.1-220111] make[3]: *** No rule to make target 'b'.  Stop.
[awali-2.1.1-220111] ***************************************************
[awali-2.1.1-220111] Error building awali-2.1.1-220111
```



---

archive/issue_events_456427.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T17:10:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456427"
}
```



---

archive/issue_events_456428.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T17:10:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456428"
}
```



---

archive/issue_comments_536279.json:
```json
{
    "body": "Changed commit from **[`e44d4d9`](https://github.com/sagemath/sagetrac-mirror/commit/e44d4d9b21b04eb7ef6f7fea7b6a66e9506d9a00)** to **[`88308ff`](https://github.com/sagemath/sagetrac-mirror/commit/88308ff0f2a1c55f9050c3e5d70c72094e99d0dc)**",
    "created_at": "2022-01-14T17:13:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536279",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e44d4d9`](https://github.com/sagemath/sagetrac-mirror/commit/e44d4d9b21b04eb7ef6f7fea7b6a66e9506d9a00)** to **[`88308ff`](https://github.com/sagemath/sagetrac-mirror/commit/88308ff0f2a1c55f9050c3e5d70c72094e99d0dc)**



---

archive/issue_comments_536280.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88308ff0f2a1c55f9050c3e5d70c72094e99d0dc\">88308ff</a></td><td><code>33169: remove 'make b'</code></td></tr></table>\n",
    "created_at": "2022-01-14T17:13:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536280",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88308ff0f2a1c55f9050c3e5d70c72094e99d0dc">88308ff</a></td><td><code>33169: remove 'make b'</code></td></tr></table>




---

archive/issue_comments_536281.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe change is not sufficient. I now get\n\n```\n[awali-2.1.1-220111] -- Installing: /usr/local/lib/libawalidyn.so\n[awali-2.1.1-220111] CMake Error at awali/cmake_install.cmake:55 (file):\n[awali-2.1.1-220111]   file INSTALL cannot copy file\n[awali-2.1.1-220111]   \"/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-2.1.1-220111/src/_build/awali/libawalidyn.so\"\n[awali-2.1.1-220111]   to \"/usr/local/lib/libawalidyn.so\": Permission denied.\n[awali-2.1.1-220111] Call Stack (most recent call first):\n[awali-2.1.1-220111]   cmake_install.cmake:46 (include)\n[awali-2.1.1-220111] \n[awali-2.1.1-220111] \n[awali-2.1.1-220111] make[3]: *** [Makefile:74: install] Error 1\n[awali-2.1.1-220111] ****************************************************************************************************************************************************************\n[awali-2.1.1-220111] Error building awali-2.1.1-220111\n```\n\nIndeed, http://vaucanson-project.org/Awali/2.1/download.html and their readme says to use `sudo`:\n\n```\n$ cd _build\n\n### Configuration\n$ cmake ..\n\n### Compilation\n$ make\n\n### Installation\n$ sudo make install\n```\nbut I think we don't want to use sudo.",
    "created_at": "2022-01-14T17:14:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536281",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:9" align="right">comment:9</div>

The change is not sufficient. I now get

```
[awali-2.1.1-220111] -- Installing: /usr/local/lib/libawalidyn.so
[awali-2.1.1-220111] CMake Error at awali/cmake_install.cmake:55 (file):
[awali-2.1.1-220111]   file INSTALL cannot copy file
[awali-2.1.1-220111]   "/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-2.1.1-220111/src/_build/awali/libawalidyn.so"
[awali-2.1.1-220111]   to "/usr/local/lib/libawalidyn.so": Permission denied.
[awali-2.1.1-220111] Call Stack (most recent call first):
[awali-2.1.1-220111]   cmake_install.cmake:46 (include)
[awali-2.1.1-220111] 
[awali-2.1.1-220111] 
[awali-2.1.1-220111] make[3]: *** [Makefile:74: install] Error 1
[awali-2.1.1-220111] ****************************************************************************************************************************************************************
[awali-2.1.1-220111] Error building awali-2.1.1-220111
```

Indeed, http://vaucanson-project.org/Awali/2.1/download.html and their readme says to use `sudo`:

```
$ cd _build

### Configuration
$ cmake ..

### Compilation
$ make

### Installation
$ sudo make install
```
but I think we don't want to use sudo.



---

archive/issue_comments_536282.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nWe need to specify environment variables, but I am not an expert on this. They speak about a dozen of such variables and I don't know which we need to set and how.\n\nI tried\n\n```diff\ndiff --git a/build/pkgs/awali/spkg-install.in b/build/pkgs/awali/spkg-install.in\nindex 6ad2f054b5..e0e52f93dd 100644\n--- a/build/pkgs/awali/spkg-install.in\n+++ b/build/pkgs/awali/spkg-install.in\n@@ -4,7 +4,8 @@ mkdir _build\n cd _build\n cmake ..  -DINSTALL_DIR=\"${SAGE_LOCAL}\" \\\n           -DPYTHON=python3 \\\n-          -DCORA=False\n+          -DCORA=False \\\n+          -AWALICPP_DYNLIB_INSTALL_DIR=\"${SAGE_LOCAL}/lib/\"\n \n sdh_make\n sdh_make install\n```\nbut it is not sufficient as it creates the error\n\n```\n[awali-2.1.1-220111] CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage\n[awali-2.1.1-220111] -- Configuring incomplete, errors occurred!\n```\n`CMAKE_CXX_COMPILER` is not mentionned in their readme. I take a break on this now.",
    "created_at": "2022-01-14T17:28:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536282",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:10" align="right">comment:10</div>

We need to specify environment variables, but I am not an expert on this. They speak about a dozen of such variables and I don't know which we need to set and how.

I tried

```diff
diff --git a/build/pkgs/awali/spkg-install.in b/build/pkgs/awali/spkg-install.in
index 6ad2f054b5..e0e52f93dd 100644
--- a/build/pkgs/awali/spkg-install.in
+++ b/build/pkgs/awali/spkg-install.in
@@ -4,7 +4,8 @@ mkdir _build
 cd _build
 cmake ..  -DINSTALL_DIR="${SAGE_LOCAL}" \
           -DPYTHON=python3 \
-          -DCORA=False
+          -DCORA=False \
+          -AWALICPP_DYNLIB_INSTALL_DIR="${SAGE_LOCAL}/lib/"
 
 sdh_make
 sdh_make install
```
but it is not sufficient as it creates the error

```
[awali-2.1.1-220111] CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage
[awali-2.1.1-220111] -- Configuring incomplete, errors occurred!
```
`CMAKE_CXX_COMPILER` is not mentionned in their readme. I take a break on this now.



---

archive/issue_comments_536283.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHi,\n\nI'm one of the developer of awali and I managed to have awali compiling and installing boxed into sage.\n\nI tweaked `spkg-install.in` as:\n\n```bash\ncd src/\n\nmkdir _build\ncd _build\ncmake ..  -DCMAKE_INSTALL_PREFIX=\"${SAGE_LOCAL}\" \\\n          -DCOMPILE_MODULE_IN_INSTALL_DIR=TRUE \\\n          -DFORCE_INSTALL_IN_PREFIX=TRUE \\\n          -DPYTHON_BIN=python3 \\\n          -DCYTHON_BIN=cython \\\n          -DCORA=FALSE \\\n          -DDOCUMENTATION=FALSE\n\nsdh_make\nsdh_make recommended\nsdh_make install\n```\nand `dependencies` as:\n\n```\n$(PYTHON) cmake cython graphviz\n```\n\nHowever I did not solve the error *CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage * mentioned above.   I simply did not encounter it.  This error apparently indicates that CMake does not find the C++ compiler.\n\nI managed to obtain it by uninstalling g++ from my system.  In that case, it seemed that CMake was failing to infer the compiler path from environment variable `${CXX}`.  The value of `${CXX}` was set by sage as `g++ -std=gnu++11`, and according to a Google search, it seems it is because CMake does not like the space in it.\n\nPrecisely:\n\n```\n[awali-2.1.2-220122] CMake Error at /usr/share/cmake-3.18/Modules/CMakeDetermineCXXCompiler.cmake:48 (message):\n[awali-2.1.2-220122]   Could not find compiler set in environment variable CXX:\n[awali-2.1.2-220122]\n[awali-2.1.2-220122]   g++ -std=gnu++11.\n[awali-2.1.2-220122]\n[awali-2.1.2-220122] Call Stack (most recent call first):\n[awali-2.1.2-220122]   CMakeLists.txt:22 (project)\n[awali-2.1.2-220122]\n[awali-2.1.2-220122]\n[awali-2.1.2-220122] CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage\n[awali-2.1.2-220122] -- Configuring incomplete, errors occurred!\n```\n\nSince having a C++ compiler is a general prerequisite for sage, it seems this error should not happen.  I don't how to solve it.\n\n(I did not try adding `-DCMAKE_CXX_COMPILER=${CXX}` to the `cmake` line.  It could work but seems wrong: awali uses a different C++ standard, `--std=c++11`, and probably `--std=c++17` in future versions.)",
    "created_at": "2022-01-26T07:44:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536283",
    "user": "https://github.com/marsault"
}
```

<div id="comment:11" align="right">comment:11</div>

Hi,

I'm one of the developer of awali and I managed to have awali compiling and installing boxed into sage.

I tweaked `spkg-install.in` as:

```bash
cd src/

mkdir _build
cd _build
cmake ..  -DCMAKE_INSTALL_PREFIX="${SAGE_LOCAL}" \
          -DCOMPILE_MODULE_IN_INSTALL_DIR=TRUE \
          -DFORCE_INSTALL_IN_PREFIX=TRUE \
          -DPYTHON_BIN=python3 \
          -DCYTHON_BIN=cython \
          -DCORA=FALSE \
          -DDOCUMENTATION=FALSE

sdh_make
sdh_make recommended
sdh_make install
```
and `dependencies` as:

```
$(PYTHON) cmake cython graphviz
```

However I did not solve the error *CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage * mentioned above.   I simply did not encounter it.  This error apparently indicates that CMake does not find the C++ compiler.

I managed to obtain it by uninstalling g++ from my system.  In that case, it seemed that CMake was failing to infer the compiler path from environment variable `${CXX}`.  The value of `${CXX}` was set by sage as `g++ -std=gnu++11`, and according to a Google search, it seems it is because CMake does not like the space in it.

Precisely:

```
[awali-2.1.2-220122] CMake Error at /usr/share/cmake-3.18/Modules/CMakeDetermineCXXCompiler.cmake:48 (message):
[awali-2.1.2-220122]   Could not find compiler set in environment variable CXX:
[awali-2.1.2-220122]
[awali-2.1.2-220122]   g++ -std=gnu++11.
[awali-2.1.2-220122]
[awali-2.1.2-220122] Call Stack (most recent call first):
[awali-2.1.2-220122]   CMakeLists.txt:22 (project)
[awali-2.1.2-220122]
[awali-2.1.2-220122]
[awali-2.1.2-220122] CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage
[awali-2.1.2-220122] -- Configuring incomplete, errors occurred!
```

Since having a C++ compiler is a general prerequisite for sage, it seems this error should not happen.  I don't how to solve it.

(I did not try adding `-DCMAKE_CXX_COMPILER=${CXX}` to the `cmake` line.  It could work but seems wrong: awali uses a different C++ standard, `--std=c++11`, and probably `--std=c++17` in future versions.)



---

archive/issue_comments_536284.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/798238c1906479c3c3e705bd6c98c4fdacbe00a7\">798238c</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4a43b0cd64a5a76e859fe0b4bf7615709230357\">a4a43b0</a></td><td><code>33169: remove 'make b'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c9510bc634bb5040f9b4c86e6c391dca39d3b68\">9c9510b</a></td><td><code>33169: changes as suggested in [comment:11](#comment:11)</code></td></tr></table>\n",
    "created_at": "2022-01-26T20:00:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536284",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/798238c1906479c3c3e705bd6c98c4fdacbe00a7">798238c</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4a43b0cd64a5a76e859fe0b4bf7615709230357">a4a43b0</a></td><td><code>33169: remove 'make b'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c9510bc634bb5040f9b4c86e6c391dca39d3b68">9c9510b</a></td><td><code>33169: changes as suggested in [comment:11](#comment:11)</code></td></tr></table>




---

archive/issue_comments_536285.json:
```json
{
    "body": "Changed commit from **[`88308ff`](https://github.com/sagemath/sagetrac-mirror/commit/88308ff0f2a1c55f9050c3e5d70c72094e99d0dc)** to **[`9c9510b`](https://github.com/sagemath/sagetrac-mirror/commit/9c9510bc634bb5040f9b4c86e6c391dca39d3b68)**",
    "created_at": "2022-01-26T20:00:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536285",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`88308ff`](https://github.com/sagemath/sagetrac-mirror/commit/88308ff0f2a1c55f9050c3e5d70c72094e99d0dc)** to **[`9c9510b`](https://github.com/sagemath/sagetrac-mirror/commit/9c9510bc634bb5040f9b4c86e6c391dca39d3b68)**



---

archive/issue_comments_536286.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nMerci Victor, I made the changes you suggested in [comment:11](#comment:11).",
    "created_at": "2022-01-26T20:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536286",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:13" align="right">comment:13</div>

Merci Victor, I made the changes you suggested in [comment:11](#comment:11).



---

archive/issue_comments_536287.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nNow, I get this:\n\n```\n[awali-2.1.1-220111] Attempting to download from http://files.vaucanson-project.org/2.1/tarballs/awali-all-v2.1.1-220111.tgz\n[awali-2.1.1-220111] [......................................................................]\n[awali-2.1.1-220111] awali-2.1.1-220111\n[awali-2.1.1-220111] ====================================================\n[awali-2.1.1-220111] Setting up build directory for awali-2.1.1-220111\n[awali-2.1.1-220111] Finished extraction\n[awali-2.1.1-220111] No patch files found in ../patches\n[awali-2.1.1-220111] ****************************************************\n[awali-2.1.1-220111] Host system:\n[awali-2.1.1-220111] Linux miami 4.15.0-162-generic #170-Ubuntu SMP Mon Oct 18 11:38:05 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\n[awali-2.1.1-220111] ****************************************************\n[awali-2.1.1-220111] C compiler: gcc\n[awali-2.1.1-220111] C compiler version:\n[awali-2.1.1-220111] Using built-in specs.\n[awali-2.1.1-220111] COLLECT_GCC=/usr/bin/gcc\n[awali-2.1.1-220111] COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/7/lto-wrapper\n[awali-2.1.1-220111] OFFLOAD_TARGET_NAMES=nvptx-none\n[awali-2.1.1-220111] OFFLOAD_TARGET_DEFAULT=1\n[awali-2.1.1-220111] Target: x86_64-linux-gnu\n[awali-2.1.1-220111] Configured with: ../src/configure -v --with-pkgversion='Ubuntu 7.5.0-3ubuntu1~18.04' --with-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --enable-bootstrap --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\n[awali-2.1.1-220111] Thread model: posix\n[awali-2.1.1-220111] gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04) \n[awali-2.1.1-220111] ****************************************************\n[awali-2.1.1-220111] Warning: No files to uninstall for 'awali'\n[awali-2.1.1-220111] Uninstalling existing 'awali'\n[awali-2.1.1-220111] Removing stamp file '/home/slabbe/GitBox/sage/local/var/lib/sage/installed/awali-1.0.2-190218'\n[awali-2.1.1-220111] -- The CXX compiler identification is GNU 7.5.0\n[awali-2.1.1-220111] -- Check for working CXX compiler: /home/slabbe/GitBox/sage/local/libexec/ccache/g++\n[awali-2.1.1-220111] -- Check for working CXX compiler: /home/slabbe/GitBox/sage/local/libexec/ccache/g++ -- works\n[awali-2.1.1-220111] -- Detecting CXX compiler ABI info\n[awali-2.1.1-220111] -- Detecting CXX compiler ABI info - done\n[awali-2.1.1-220111] -- Detecting CXX compile features\n[awali-2.1.1-220111] -- Detecting CXX compile features - done\n[awali-2.1.1-220111] -- CMake configuration for Awali, version 2.1.1\n[awali-2.1.1-220111] -- Performing Test COMPILER_SUPPORTS_CXX11\n[awali-2.1.1-220111] -- Performing Test COMPILER_SUPPORTS_CXX11 - Success\n[awali-2.1.1-220111] -- Found PkgConfig: /usr/bin/pkg-config (found version \"0.29.1\") \n[awali-2.1.1-220111] CMake Warning at awali/CMakeLists.txt:45 (MESSAGE):\n[awali-2.1.1-220111]   A directory was specified for on-the-fly compilation of module.  Any\n[awali-2.1.1-220111]   program linked to awalidyn might attempt to write in that directory; it\n[awali-2.1.1-220111]   thus must be writable by any user that might use the program.\n[awali-2.1.1-220111] \n[awali-2.1.1-220111] \n[awali-2.1.1-220111] CMake Error at awali/sttc/tests/CMakeLists.txt:44 (add_compile_definitions):\n[awali-2.1.1-220111]   Unknown CMake command \"add_compile_definitions\".\n[awali-2.1.1-220111] \n[awali-2.1.1-220111] \n[awali-2.1.1-220111] -- Configuring incomplete, errors occurred!\n[awali-2.1.1-220111] See also \"/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-2.1.1-220111/src/_build/CMakeFiles/CMakeOutput.log\".\n[awali-2.1.1-220111] Building awali-2.1.1-220111\n[awali-2.1.1-220111] make[3]: *** No targets specified and no makefile found.  Stop.\n[awali-2.1.1-220111] *****************************************************************************************************\n[awali-2.1.1-220111] Error building awali-2.1.1-220111\n[awali-2.1.1-220111] *****************************************************************************************************\n```",
    "created_at": "2022-01-26T20:02:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536287",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:14" align="right">comment:14</div>

Now, I get this:

```
[awali-2.1.1-220111] Attempting to download from http://files.vaucanson-project.org/2.1/tarballs/awali-all-v2.1.1-220111.tgz
[awali-2.1.1-220111] [......................................................................]
[awali-2.1.1-220111] awali-2.1.1-220111
[awali-2.1.1-220111] ====================================================
[awali-2.1.1-220111] Setting up build directory for awali-2.1.1-220111
[awali-2.1.1-220111] Finished extraction
[awali-2.1.1-220111] No patch files found in ../patches
[awali-2.1.1-220111] ****************************************************
[awali-2.1.1-220111] Host system:
[awali-2.1.1-220111] Linux miami 4.15.0-162-generic #170-Ubuntu SMP Mon Oct 18 11:38:05 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
[awali-2.1.1-220111] ****************************************************
[awali-2.1.1-220111] C compiler: gcc
[awali-2.1.1-220111] C compiler version:
[awali-2.1.1-220111] Using built-in specs.
[awali-2.1.1-220111] COLLECT_GCC=/usr/bin/gcc
[awali-2.1.1-220111] COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/7/lto-wrapper
[awali-2.1.1-220111] OFFLOAD_TARGET_NAMES=nvptx-none
[awali-2.1.1-220111] OFFLOAD_TARGET_DEFAULT=1
[awali-2.1.1-220111] Target: x86_64-linux-gnu
[awali-2.1.1-220111] Configured with: ../src/configure -v --with-pkgversion='Ubuntu 7.5.0-3ubuntu1~18.04' --with-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --enable-bootstrap --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
[awali-2.1.1-220111] Thread model: posix
[awali-2.1.1-220111] gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04) 
[awali-2.1.1-220111] ****************************************************
[awali-2.1.1-220111] Warning: No files to uninstall for 'awali'
[awali-2.1.1-220111] Uninstalling existing 'awali'
[awali-2.1.1-220111] Removing stamp file '/home/slabbe/GitBox/sage/local/var/lib/sage/installed/awali-1.0.2-190218'
[awali-2.1.1-220111] -- The CXX compiler identification is GNU 7.5.0
[awali-2.1.1-220111] -- Check for working CXX compiler: /home/slabbe/GitBox/sage/local/libexec/ccache/g++
[awali-2.1.1-220111] -- Check for working CXX compiler: /home/slabbe/GitBox/sage/local/libexec/ccache/g++ -- works
[awali-2.1.1-220111] -- Detecting CXX compiler ABI info
[awali-2.1.1-220111] -- Detecting CXX compiler ABI info - done
[awali-2.1.1-220111] -- Detecting CXX compile features
[awali-2.1.1-220111] -- Detecting CXX compile features - done
[awali-2.1.1-220111] -- CMake configuration for Awali, version 2.1.1
[awali-2.1.1-220111] -- Performing Test COMPILER_SUPPORTS_CXX11
[awali-2.1.1-220111] -- Performing Test COMPILER_SUPPORTS_CXX11 - Success
[awali-2.1.1-220111] -- Found PkgConfig: /usr/bin/pkg-config (found version "0.29.1") 
[awali-2.1.1-220111] CMake Warning at awali/CMakeLists.txt:45 (MESSAGE):
[awali-2.1.1-220111]   A directory was specified for on-the-fly compilation of module.  Any
[awali-2.1.1-220111]   program linked to awalidyn might attempt to write in that directory; it
[awali-2.1.1-220111]   thus must be writable by any user that might use the program.
[awali-2.1.1-220111] 
[awali-2.1.1-220111] 
[awali-2.1.1-220111] CMake Error at awali/sttc/tests/CMakeLists.txt:44 (add_compile_definitions):
[awali-2.1.1-220111]   Unknown CMake command "add_compile_definitions".
[awali-2.1.1-220111] 
[awali-2.1.1-220111] 
[awali-2.1.1-220111] -- Configuring incomplete, errors occurred!
[awali-2.1.1-220111] See also "/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-2.1.1-220111/src/_build/CMakeFiles/CMakeOutput.log".
[awali-2.1.1-220111] Building awali-2.1.1-220111
[awali-2.1.1-220111] make[3]: *** No targets specified and no makefile found.  Stop.
[awali-2.1.1-220111] *****************************************************************************************************
[awali-2.1.1-220111] Error building awali-2.1.1-220111
[awali-2.1.1-220111] *****************************************************************************************************
```



---

archive/issue_comments_536288.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nFunction `add_compile_definitions` was added to CMake 3.12, you probably have a prior version.\n\nWe generally require a much lesser version of CMake (3.0) hence the cryptic error message.  We will use a substitute for `add_compile_definitions` for the next release of awali (2.1.3) to enforce compatibility with CMake 3.0.  It should be out by the end of the week.\n\nOn another topic, I created a generic address for tarballs download: http://files.vaucanson-project.org/tarballs/",
    "created_at": "2022-01-27T09:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536288",
    "user": "https://github.com/marsault"
}
```

<div id="comment:15" align="right">comment:15</div>

Function `add_compile_definitions` was added to CMake 3.12, you probably have a prior version.

We generally require a much lesser version of CMake (3.0) hence the cryptic error message.  We will use a substitute for `add_compile_definitions` for the next release of awali (2.1.3) to enforce compatibility with CMake 3.0.  It should be out by the end of the week.

On another topic, I created a generic address for tarballs download: http://files.vaucanson-project.org/tarballs/



---

archive/issue_comments_536289.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nMy config.log says that my system cmake was accepted by sagemath:\n\n```\n## ------------------------------------------------------ ##\n## Checking whether SageMath should install SPKG cmake... ##\n## ------------------------------------------------------ ##\nconfigure:18367: checking for cmake >= 3.4\nconfigure:18445: result: /usr/bin/cmake\nconfigure:18454: will use system package and not install SPKG cmake\n```\n\nThe version of cmake on my machine is:\n\n```\n$ /usr/bin/cmake --version\ncmake version 3.10.2\n\nCMake suite maintained and supported by Kitware (kitware.com/cmake).\n```\nIndeed, it is older than 3.12.\n\nI think it is better if awali is compatible with the cmake that is currently accepted by sage, i.e., >=3.4.",
    "created_at": "2022-01-27T14:01:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536289",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:16" align="right">comment:16</div>

My config.log says that my system cmake was accepted by sagemath:

```
## ------------------------------------------------------ ##
## Checking whether SageMath should install SPKG cmake... ##
## ------------------------------------------------------ ##
configure:18367: checking for cmake >= 3.4
configure:18445: result: /usr/bin/cmake
configure:18454: will use system package and not install SPKG cmake
```

The version of cmake on my machine is:

```
$ /usr/bin/cmake --version
cmake version 3.10.2

CMake suite maintained and supported by Kitware (kitware.com/cmake).
```
Indeed, it is older than 3.12.

I think it is better if awali is compatible with the cmake that is currently accepted by sage, i.e., >=3.4.



---

archive/issue_comments_536290.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI agree; `cmake` older than 3.12 is still widespread on many of our supported platforms (see https://repology.org/project/cmake/versions). We could probably increase the lower bound 3.4 a bit, but not by much unless well motivated",
    "created_at": "2022-01-27T20:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536290",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

I agree; `cmake` older than 3.12 is still widespread on many of our supported platforms (see https://repology.org/project/cmake/versions). We could probably increase the lower bound 3.4 a bit, but not by much unless well motivated



---

archive/issue_comments_536291.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nVersion 2.1.3 of awali was released earlier today: http://files.vaucanson-project.org/tarballs/awali-all-v2.1.3-220128.tgz\n\nIt is compatible with CMake 3.1.0 so the above problem should no longer happen.",
    "created_at": "2022-01-28T19:29:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536291",
    "user": "https://github.com/marsault"
}
```

<div id="comment:18" align="right">comment:18</div>

Version 2.1.3 of awali was released earlier today: http://files.vaucanson-project.org/tarballs/awali-all-v2.1.3-220128.tgz

It is compatible with CMake 3.1.0 so the above problem should no longer happen.



---

archive/issue_events_456429.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456429"
}
```



---

archive/issue_events_456430.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456430"
}
```



---

archive/issue_comments_536292.json:
```json
{
    "body": "Changed commit from **[`9c9510b`](https://github.com/sagemath/sagetrac-mirror/commit/9c9510bc634bb5040f9b4c86e6c391dca39d3b68)** to **[`725afa7`](https://github.com/sagemath/sagetrac-mirror/commit/725afa7ca05139c7de4816ee91484f698512db97)**",
    "created_at": "2022-05-05T09:34:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536292",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9c9510b`](https://github.com/sagemath/sagetrac-mirror/commit/9c9510bc634bb5040f9b4c86e6c391dca39d3b68)** to **[`725afa7`](https://github.com/sagemath/sagetrac-mirror/commit/725afa7ca05139c7de4816ee91484f698512db97)**



---

archive/issue_comments_536293.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8102592b5091764b4365cb0652f8f35243c6e6cb\">8102592</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6a1e333011a6b2a6349a517b9126c857480b340\">b6a1e33</a></td><td><code>33169: remove 'make b'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7abd422cada3499b0b1ac7d3c73adafa7e6a2bcc\">7abd422</a></td><td><code>33169: changes as suggested in [comment:11](#comment:11)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/725afa7ca05139c7de4816ee91484f698512db97\">725afa7</a></td><td><code>33169: updated awali to 2.1.3-220128</code></td></tr></table>\n",
    "created_at": "2022-05-05T09:34:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536293",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8102592b5091764b4365cb0652f8f35243c6e6cb">8102592</a></td><td><code>33169: updated awali to 2.1.1-220111</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6a1e333011a6b2a6349a517b9126c857480b340">b6a1e33</a></td><td><code>33169: remove 'make b'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7abd422cada3499b0b1ac7d3c73adafa7e6a2bcc">7abd422</a></td><td><code>33169: changes as suggested in [comment:11](#comment:11)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/725afa7ca05139c7de4816ee91484f698512db97">725afa7</a></td><td><code>33169: updated awali to 2.1.3-220128</code></td></tr></table>




---

archive/issue_comments_536294.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI rebased the branch and updated the url and version and checksums to the 2.1.3 version.",
    "created_at": "2022-05-05T09:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536294",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:21" align="right">comment:21</div>

I rebased the branch and updated the url and version and checksums to the 2.1.3 version.



---

archive/issue_comments_536295.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nUnfortunately, I can still not build it on my machine. The main error seems to be `g++: fatal error: no input files` :\n\n```\n[awali-2.1.3-220128] [100%] Building Awalipy\n[awali-2.1.3-220128] -- Awalipy (1/3) - Start\n[awali-2.1.3-220128] -- Awalipy (2/3) - Defering to Python module 'distutils'\n[awali-2.1.3-220128] -- Awalipy (3/3) - Done\n[awali-2.1.3-220128] Building awali-2.1.3-220128\n[awali-2.1.3-220128] Scanning dependencies of target touch_module_directories\n[awali-2.1.3-220128] Scanning dependencies of target awali_module_compiler\n[awali-2.1.3-220128] [  0%] Building CXX object awali/extras/CMakeFiles/awali_module_compiler.dir/module-compiler.cc.o\n[awali-2.1.3-220128] [  2%] Linking CXX executable awali_module_compiler\n[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lal_char-_b_lat-lan-lal_char-_lal_char-_b-compose\n[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lan-lal_char--_b-transducer\n[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lan-lal_char--_b-output\n[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lan-lal_char--_b-context\n[awali-2.1.3-220128] Scanning dependencies of target lan-lal_char-_b-output\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-ratexp\n[awali-2.1.3-220128] Scanning dependencies of target lan-lal_char-_b-context\n[awali-2.1.3-220128] Compiling module \"compose\" for a new automaton context (lat<lan<lal_char>,lal_char>_b_lat<lan<lal_char>,lal_char>_b)\n[awali-2.1.3-220128] Compiling module \"transducer\" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)\n[awali-2.1.3-220128] Compiling module \"ratexp\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Compiling module \"context\" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)\n[awali-2.1.3-220128] Compiling module \"output\" for a new automaton context (lan<lal_char>_b)\n[awali-2.1.3-220128] Compiling module \"output\" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)\n[awali-2.1.3-220128] Compiling module \"context\" for a new automaton context (lan<lal_char>_b)\n[awali-2.1.3-220128] Linking module \"output\" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)\n[awali-2.1.3-220128] Scanning dependencies of target lan-lal_char-_b-ratexp\n[awali-2.1.3-220128] Compiling module \"ratexp\" for a new automaton context (lan<lal_char>_b)\n[awali-2.1.3-220128] Linking module \"output\" for a new automaton context (lan<lal_char>_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b_lal_char_b-product\n[awali-2.1.3-220128] Compiling module \"product\" for a new automaton context (lal_char_b_lal_char_b)\n[awali-2.1.3-220128] Linking module \"compose\" for a new automaton context (lat<lan<lal_char>,lal_char>_b_lat<lan<lal_char>,lal_char>_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-determinize\n[awali-2.1.3-220128] Compiling module \"determinize\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"context\" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-context\n[awali-2.1.3-220128] Compiling module \"context\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"ratexp\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"context\" for a new automaton context (lan<lal_char>_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-automaton\n[awali-2.1.3-220128] Compiling module \"automaton\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-quotient\n[awali-2.1.3-220128] Compiling module \"quotient\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"product\" for a new automaton context (lal_char_b_lal_char_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-derivation\n[awali-2.1.3-220128] Compiling module \"derivation\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"determinize\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-partial_id\n[awali-2.1.3-220128] Compiling module \"partial_id\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] g++: fatal error: no input files\n[awali-2.1.3-220128] compilation terminated.\n[awali-2.1.3-220128] terminate called after throwing an instance of 'std::runtime_error'\n[awali-2.1.3-220128]   what():  Compilation of module partial_id for lal_char_b failed, command was: /home/slabbe/GitBox/sage/local/libexec/ccache/g++ -g -O2 -std=c++11 -I. -Wall -Wextra -Wsign-conversion -g -rdynamic -w -O3 -fpic -I/home/slabbe/.awali/tmp/liblal_char_b-partial_id -I/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-1.0.2-190218/src -I/home/slabbe/GitBox/sage/local/include -I/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-1.0.2-190218/src/_build -I/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-1.0.2-190218/src -I/home/slabbe/GitBox/sage/local/share -c  -o /home/slabbe/.awali/tmp/liblal_char_b-partial_id/liblal_char_b-partial_id.o -MMD -MF /home/slabbe/.awali/tmp/liblal_char_b-partial_id/Makefile -MT /home/slabbe/.awali/otf/liblal_char_b-partial_id.so\n[awali-2.1.3-220128] Aborted\n[awali-2.1.3-220128] awali/extras/CMakeFiles/lal_char_b-partial_id.dir/build.make:58: recipe for target 'awali/extras/CMakeFiles/lal_char_b-partial_id' failed\n[awali-2.1.3-220128] make[6]: *** [awali/extras/CMakeFiles/lal_char_b-partial_id] Error 134\n[awali-2.1.3-220128] CMakeFiles/Makefile2:99588: recipe for target 'awali/extras/CMakeFiles/lal_char_b-partial_id.dir/all' failed\n[awali-2.1.3-220128] make[5]: *** [awali/extras/CMakeFiles/lal_char_b-partial_id.dir/all] Error 2\n[awali-2.1.3-220128] make[5]: *** Waiting for unfinished jobs....\n[awali-2.1.3-220128] Linking module \"context\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"ratexp\" for a new automaton context (lan<lal_char>_b)\n[awali-2.1.3-220128] Linking module \"automaton\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"quotient\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"derivation\" for a new automaton context (lal_char_b)\n[awali-2.1.3-220128] Linking module \"transducer\" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)\n[awali-2.1.3-220128] CMakeFiles/Makefile2:378: recipe for target 'CMakeFiles/recommended.dir/rule' failed\n[awali-2.1.3-220128] make[4]: *** [CMakeFiles/recommended.dir/rule] Error 2\n[awali-2.1.3-220128] Makefile:253: recipe for target 'recommended' failed\n[awali-2.1.3-220128] make[3]: *** [recommended] Error 2\n[awali-2.1.3-220128] *****************************************************************************************************\n[awali-2.1.3-220128] Error building awali-2.1.3-220128\n[awali-2.1.3-220128] *****************************************************************************************************\n```",
    "created_at": "2022-05-05T09:36:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33169#issuecomment-536295",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:22" align="right">comment:22</div>

Unfortunately, I can still not build it on my machine. The main error seems to be `g++: fatal error: no input files` :

```
[awali-2.1.3-220128] [100%] Building Awalipy
[awali-2.1.3-220128] -- Awalipy (1/3) - Start
[awali-2.1.3-220128] -- Awalipy (2/3) - Defering to Python module 'distutils'
[awali-2.1.3-220128] -- Awalipy (3/3) - Done
[awali-2.1.3-220128] Building awali-2.1.3-220128
[awali-2.1.3-220128] Scanning dependencies of target touch_module_directories
[awali-2.1.3-220128] Scanning dependencies of target awali_module_compiler
[awali-2.1.3-220128] [  0%] Building CXX object awali/extras/CMakeFiles/awali_module_compiler.dir/module-compiler.cc.o
[awali-2.1.3-220128] [  2%] Linking CXX executable awali_module_compiler
[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lal_char-_b_lat-lan-lal_char-_lal_char-_b-compose
[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lan-lal_char--_b-transducer
[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lan-lal_char--_b-output
[awali-2.1.3-220128] Scanning dependencies of target lat-lan-lal_char-_lan-lal_char--_b-context
[awali-2.1.3-220128] Scanning dependencies of target lan-lal_char-_b-output
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-ratexp
[awali-2.1.3-220128] Scanning dependencies of target lan-lal_char-_b-context
[awali-2.1.3-220128] Compiling module "compose" for a new automaton context (lat<lan<lal_char>,lal_char>_b_lat<lan<lal_char>,lal_char>_b)
[awali-2.1.3-220128] Compiling module "transducer" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)
[awali-2.1.3-220128] Compiling module "ratexp" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Compiling module "context" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)
[awali-2.1.3-220128] Compiling module "output" for a new automaton context (lan<lal_char>_b)
[awali-2.1.3-220128] Compiling module "output" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)
[awali-2.1.3-220128] Compiling module "context" for a new automaton context (lan<lal_char>_b)
[awali-2.1.3-220128] Linking module "output" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)
[awali-2.1.3-220128] Scanning dependencies of target lan-lal_char-_b-ratexp
[awali-2.1.3-220128] Compiling module "ratexp" for a new automaton context (lan<lal_char>_b)
[awali-2.1.3-220128] Linking module "output" for a new automaton context (lan<lal_char>_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b_lal_char_b-product
[awali-2.1.3-220128] Compiling module "product" for a new automaton context (lal_char_b_lal_char_b)
[awali-2.1.3-220128] Linking module "compose" for a new automaton context (lat<lan<lal_char>,lal_char>_b_lat<lan<lal_char>,lal_char>_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-determinize
[awali-2.1.3-220128] Compiling module "determinize" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "context" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-context
[awali-2.1.3-220128] Compiling module "context" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "ratexp" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "context" for a new automaton context (lan<lal_char>_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-automaton
[awali-2.1.3-220128] Compiling module "automaton" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-quotient
[awali-2.1.3-220128] Compiling module "quotient" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "product" for a new automaton context (lal_char_b_lal_char_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-derivation
[awali-2.1.3-220128] Compiling module "derivation" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "determinize" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Scanning dependencies of target lal_char_b-partial_id
[awali-2.1.3-220128] Compiling module "partial_id" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] g++: fatal error: no input files
[awali-2.1.3-220128] compilation terminated.
[awali-2.1.3-220128] terminate called after throwing an instance of 'std::runtime_error'
[awali-2.1.3-220128]   what():  Compilation of module partial_id for lal_char_b failed, command was: /home/slabbe/GitBox/sage/local/libexec/ccache/g++ -g -O2 -std=c++11 -I. -Wall -Wextra -Wsign-conversion -g -rdynamic -w -O3 -fpic -I/home/slabbe/.awali/tmp/liblal_char_b-partial_id -I/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-1.0.2-190218/src -I/home/slabbe/GitBox/sage/local/include -I/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-1.0.2-190218/src/_build -I/home/slabbe/GitBox/sage/local/var/tmp/sage/build/awali-1.0.2-190218/src -I/home/slabbe/GitBox/sage/local/share -c  -o /home/slabbe/.awali/tmp/liblal_char_b-partial_id/liblal_char_b-partial_id.o -MMD -MF /home/slabbe/.awali/tmp/liblal_char_b-partial_id/Makefile -MT /home/slabbe/.awali/otf/liblal_char_b-partial_id.so
[awali-2.1.3-220128] Aborted
[awali-2.1.3-220128] awali/extras/CMakeFiles/lal_char_b-partial_id.dir/build.make:58: recipe for target 'awali/extras/CMakeFiles/lal_char_b-partial_id' failed
[awali-2.1.3-220128] make[6]: *** [awali/extras/CMakeFiles/lal_char_b-partial_id] Error 134
[awali-2.1.3-220128] CMakeFiles/Makefile2:99588: recipe for target 'awali/extras/CMakeFiles/lal_char_b-partial_id.dir/all' failed
[awali-2.1.3-220128] make[5]: *** [awali/extras/CMakeFiles/lal_char_b-partial_id.dir/all] Error 2
[awali-2.1.3-220128] make[5]: *** Waiting for unfinished jobs....
[awali-2.1.3-220128] Linking module "context" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "ratexp" for a new automaton context (lan<lal_char>_b)
[awali-2.1.3-220128] Linking module "automaton" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "quotient" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "derivation" for a new automaton context (lal_char_b)
[awali-2.1.3-220128] Linking module "transducer" for a new automaton context (lat<lan<lal_char>,lan<lal_char>>_b)
[awali-2.1.3-220128] CMakeFiles/Makefile2:378: recipe for target 'CMakeFiles/recommended.dir/rule' failed
[awali-2.1.3-220128] make[4]: *** [CMakeFiles/recommended.dir/rule] Error 2
[awali-2.1.3-220128] Makefile:253: recipe for target 'recommended' failed
[awali-2.1.3-220128] make[3]: *** [recommended] Error 2
[awali-2.1.3-220128] *****************************************************************************************************
[awali-2.1.3-220128] Error building awali-2.1.3-220128
[awali-2.1.3-220128] *****************************************************************************************************
```



---

archive/issue_events_456431.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456431"
}
```



---

archive/issue_events_456432.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33169",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33169#event-456432"
}
```
