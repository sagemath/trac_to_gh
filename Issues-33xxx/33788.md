# Issue 33788: GH Actions: Split ci-macos.yml out from tox.yml

archive/issues_033551.json:
```json
{
    "body": "When preparing a portability report such as https://groups.google.com/g/sage-release/c/GOGWk66zaCQ/m/dBQww8WNAAAJ, I have found that the output of `tox.yml` has gotten too big to be comfortably inspected in one go. \nSo we split out everything macOS into a separate workflow.\n\nPreparation for #33062 and #32570\n\n\nCC:  @dimpase @kliem\n\nBranch/Commit: aa2540546ee092c89768052a7f7ea8990f701b64\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nDependencies: #34017\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33788\n\n",
    "closed_at": "2022-07-09T22:31:12Z",
    "created_at": "2022-05-03T00:35:17Z",
    "labels": [
        "component: porting",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "GH Actions: Split ci-macos.yml out from tox.yml",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33788",
    "user": "https://github.com/mkoeppe"
}
```
When preparing a portability report such as https://groups.google.com/g/sage-release/c/GOGWk66zaCQ/m/dBQww8WNAAAJ, I have found that the output of `tox.yml` has gotten too big to be comfortably inspected in one go. 
So we split out everything macOS into a separate workflow.

Preparation for #33062 and #32570


CC:  @dimpase @kliem

Branch/Commit: aa2540546ee092c89768052a7f7ea8990f701b64

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Dependencies: #34017

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33788





---

archive/issue_comments_510156.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-05-03T00:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510156",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_510157.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2022-05-03T00:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510157",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_510158.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+When preparing a portability report such as https://groups.google.com/g/sage-release/c/GOGWk66zaCQ/m/dBQww8WNAAAJ, I have found that the output of \\`tox.yml\\` has gotten too big to be comfortably inspected in one go. \n+So we split out everything macOS into a separate workflow.\n+\n Preparation for #33062\n+\n \n Dependencies: #33755\n \n```\n",
    "created_at": "2022-05-03T00:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510158",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+When preparing a portability report such as https://groups.google.com/g/sage-release/c/GOGWk66zaCQ/m/dBQww8WNAAAJ, I have found that the output of \`tox.yml\` has gotten too big to be comfortably inspected in one go. 
+So we split out everything macOS into a separate workflow.
+
 Preparation for #33062
+
 
 Dependencies: #33755
 
```




---

archive/issue_events_088764.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33788#event-88764"
}
```



---

archive/issue_comments_510159.json:
```json
{
    "body": "<a id='comment:5'></a>I think it makes sense to have all them all together in one workflow. Especially with your idea to use stages, it makes sense to have all everything in one workflow since then you can easily wait on previous stages before running stages that run os-unspecific things (like running tests) on the artifacts of the previous stage. In principle, there are also github actions that enable one to wait on other workflows, but they are pretty unreliable in my experience.\n\nIf its only for the overview, I would suggest to use the recently introduced feature to generate job summaries to automatically generate the portability report: https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/",
    "created_at": "2022-05-10T08:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510159",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:5'></a>I think it makes sense to have all them all together in one workflow. Especially with your idea to use stages, it makes sense to have all everything in one workflow since then you can easily wait on previous stages before running stages that run os-unspecific things (like running tests) on the artifacts of the previous stage. In principle, there are also github actions that enable one to wait on other workflows, but they are pretty unreliable in my experience.

If its only for the overview, I would suggest to use the recently introduced feature to generate job summaries to automatically generate the portability report: https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/



---

archive/issue_comments_510160.json:
```json
{
    "body": "<a id='comment:6'></a>The runs for different OSes do not need to wait for each other for anything",
    "created_at": "2022-05-10T18:31:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510160",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>The runs for different OSes do not need to wait for each other for anything



---

archive/issue_comments_510161.json:
```json
{
    "body": "<a id='comment:7'></a>The `dist` workflow for example even runs on ubuntu.\nMoreover, with a bit of refactoring there doesn't seem to general obstacles why you cannot have the same matrix running across different os.\n\nI feel like it would be helpful to have a general big picture for how to structure the workflows instead of moving them back and forth in the coming months.",
    "created_at": "2022-05-11T20:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510161",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:7'></a>The `dist` workflow for example even runs on ubuntu.
Moreover, with a bit of refactoring there doesn't seem to general obstacles why you cannot have the same matrix running across different os.

I feel like it would be helpful to have a general big picture for how to structure the workflows instead of moving them back and forth in the coming months.



---

archive/issue_comments_510162.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-05-11T20:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510162",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_510163.json:
```json
{
    "body": "<a id='comment:8'></a>I'm the one who monitors these workflow runs when releases are made, so organizing it for my convenience should be a good enough reason.",
    "created_at": "2022-05-11T20:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510163",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>I'm the one who monitors these workflow runs when releases are made, so organizing it for my convenience should be a good enough reason.



---

archive/issue_comments_510164.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-05-11T20:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510164",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_510165.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:5 gh-tobiasdiez]:\n> If its only for the overview, I would suggest to use the recently introduced feature to generate job summaries to automatically generate the portability report: https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/\n\n\nCounting green checkmarks is not what takes the time. It's looking at the logs",
    "created_at": "2022-05-11T20:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510165",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Replying to [comment:5 gh-tobiasdiez]:
> If its only for the overview, I would suggest to use the recently introduced feature to generate job summaries to automatically generate the portability report: https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/


Counting green checkmarks is not what takes the time. It's looking at the logs



---

archive/issue_comments_510166.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 mkoeppe]:\n> Replying to [comment:5 gh-tobiasdiez]:\n> > If its only for the overview, I would suggest to use the recently introduced feature to generate job summaries to automatically generate the portability report: https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/\n\n> \n> Counting green checkmarks is not what takes the time. It's looking at the logs\n\n\nYou can put in the markdown overview whatever you want, for example the summary of what test failed or at what stage the tests failed etc.",
    "created_at": "2022-05-12T20:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510166",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:10'></a>Replying to [comment:9 mkoeppe]:
> Replying to [comment:5 gh-tobiasdiez]:
> > If its only for the overview, I would suggest to use the recently introduced feature to generate job summaries to automatically generate the portability report: https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/

> 
> Counting green checkmarks is not what takes the time. It's looking at the logs


You can put in the markdown overview whatever you want, for example the summary of what test failed or at what stage the tests failed etc.



---

archive/issue_comments_510167.json:
```json
{
    "body": "<a id='comment:11'></a>It does look like a nice feature, but I don't plan to work on creating such a report.",
    "created_at": "2022-05-13T18:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510167",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>It does look like a nice feature, but I don't plan to work on creating such a report.



---

archive/issue_comments_510168.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-07-02T19:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_510169.json:
```json
{
    "body": "<a id='comment:14'></a>Let's get this in please.",
    "created_at": "2022-07-02T19:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510169",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Let's get this in please.



---

archive/issue_comments_510170.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n+When preparing a portability report such as https://groups.google.com/g/sage-release/c/GOGWk66zaCQ/m/dBQww8WNAAAJ, I have found that the output of \\`tox.yml\\` has gotten too big to be comfortably inspected in one go. \n+So we split out everything macOS into a separate workflow.\n+\n+Preparation for #33062 and #32570\n \n \n Dependencies: #33755\n```\n",
    "created_at": "2022-07-02T19:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510170",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,7 @@
+When preparing a portability report such as https://groups.google.com/g/sage-release/c/GOGWk66zaCQ/m/dBQww8WNAAAJ, I have found that the output of \`tox.yml\` has gotten too big to be comfortably inspected in one go. 
+So we split out everything macOS into a separate workflow.
+
+Preparation for #33062 and #32570
 
 
 Dependencies: #33755
```




---

archive/issue_comments_510171.json:
```json
{
    "body": "<a id='comment:16'></a>I presume it was tested on GH Actions. A link?",
    "created_at": "2022-07-04T11:07:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510171",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>I presume it was tested on GH Actions. A link?



---

archive/issue_comments_510172.json:
```json
{
    "body": "<a id='comment:17'></a>Testing in a branch with #34110",
    "created_at": "2022-07-04T16:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510172",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Testing in a branch with #34110



---

archive/issue_comments_510173.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-08T12:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510173",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_510174.json:
```json
{
    "body": "<a id='comment:18'></a>lgtm",
    "created_at": "2022-07-08T12:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510174",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>lgtm



---

archive/issue_comments_510175.json:
```json
{
    "body": "<a id='comment:19'></a>Thank you!",
    "created_at": "2022-07-08T17:45:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510175",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>Thank you!



---

archive/issue_events_088765.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:31:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33788#event-88765"
}
```



---

archive/issue_comments_510176.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-09T22:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33788#issuecomment-510176",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
