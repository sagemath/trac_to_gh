# Issue 33101: lrslib: fix doctest in game_theory/parser.py

archive/issues_032864.json:
```json
{
    "body": "Apparently, the number of list elements has changed in these tests, but the parsing functionality seems to be unaffected:\n\n```\nsage -t --long --warn-long 86.7 --random-seed=66133510998005725882865822426008192085 src/sage/game_theory/parser.py\n**********************************************************************\nFile \"src/sage/game_theory/parser.py\", line 75, in sage.game_theory.parser.Parser.format_lrs\nFailed example:\n    lrs_output[:-2]                                                    # optional - lrslib\nExpected:\n    [...,\n     '2  0  1  2 \\n',\n     '1  1/2  1/2 -2 \\n',\n     '\\n',\n     '2  0  1  2 \\n',\n     '1  0  1 -2 \\n',\n     '\\n',\n     '*Number of equilibria found: 2\\n',\n     '*Player 1: vertices=3 bases=3 pivots=5\\n',\n     '*Player 2: vertices=2 bases=1 pivots=6\\n',\n     '\\n']\nGot:\n    ['*lrsnash:lrslib v.7.0 2018.7.1(64bit,lrsgmp.h,hybrid arithmetic) gmp v.6.1\\n',\n     '2  0  1  2 \\n',\n     '1  1/2  1/2 -2 \\n',\n     '\\n',\n     '2  0  1  2 \\n',\n     '1  0  1 -2 \\n',\n     '\\n',\n     '*Number of equilibria found: 2\\n',\n     '*Player 1: vertices=3 bases=3 pivots=5\\n',\n     '*Player 2: vertices=2 bases=1 pivots=6\\n',\n     '\\n',\n     '*lrsnash:lrslib v.7.0 2018.7.1(64bit,lrsgmp.h,hybrid arithmetic)\\n']\n```\n\n\n**CC:**  @kwankyu @seblabbe\n\n**Keywords:** lrslib\n\n**Branch/Commit:** [9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Markus Wageringel\n\nIssue created by migration from https://trac.sagemath.org/ticket/33101\n\n",
    "closed_at": "2022-01-31T23:32:02Z",
    "created_at": "2021-12-31T16:23:15Z",
    "labels": [
        "component: packages: optional",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "title": "lrslib: fix doctest in game_theory/parser.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/33101",
    "user": "https://github.com/mwageringel"
}
```
Apparently, the number of list elements has changed in these tests, but the parsing functionality seems to be unaffected:

```
sage -t --long --warn-long 86.7 --random-seed=66133510998005725882865822426008192085 src/sage/game_theory/parser.py
**********************************************************************
File "src/sage/game_theory/parser.py", line 75, in sage.game_theory.parser.Parser.format_lrs
Failed example:
    lrs_output[:-2]                                                    # optional - lrslib
Expected:
    [...,
     '2  0  1  2 \n',
     '1  1/2  1/2 -2 \n',
     '\n',
     '2  0  1  2 \n',
     '1  0  1 -2 \n',
     '\n',
     '*Number of equilibria found: 2\n',
     '*Player 1: vertices=3 bases=3 pivots=5\n',
     '*Player 2: vertices=2 bases=1 pivots=6\n',
     '\n']
Got:
    ['*lrsnash:lrslib v.7.0 2018.7.1(64bit,lrsgmp.h,hybrid arithmetic) gmp v.6.1\n',
     '2  0  1  2 \n',
     '1  1/2  1/2 -2 \n',
     '\n',
     '2  0  1  2 \n',
     '1  0  1 -2 \n',
     '\n',
     '*Number of equilibria found: 2\n',
     '*Player 1: vertices=3 bases=3 pivots=5\n',
     '*Player 2: vertices=2 bases=1 pivots=6\n',
     '\n',
     '*lrsnash:lrslib v.7.0 2018.7.1(64bit,lrsgmp.h,hybrid arithmetic)\n']
```


**CC:**  @kwankyu @seblabbe

**Keywords:** lrslib

**Branch/Commit:** [9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)

**Reviewer:** Dima Pasechnik

**Author:** Markus Wageringel

Issue created by migration from https://trac.sagemath.org/ticket/33101





---

archive/issue_comments_537346.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490\">9e7357e</a></td><td><code>33101: lrslib: fix doctest in game_theory/parser.py</code></td></tr></table>\n",
    "created_at": "2021-12-31T16:42:08Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537346",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490">9e7357e</a></td><td><code>33101: lrslib: fix doctest in game_theory/parser.py</code></td></tr></table>




---

archive/issue_events_296832.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2021-12-31T16:42:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296832"
}
```



---

archive/issue_comments_537347.json:
```json
{
    "body": "**Branch:** [u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)",
    "created_at": "2021-12-31T16:42:08Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537347",
    "user": "https://github.com/mwageringel"
}
```

**Branch:** [u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)



---

archive/issue_comments_537348.json:
```json
{
    "body": "**Author:** Markus Wageringel",
    "created_at": "2021-12-31T16:42:08Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537348",
    "user": "https://github.com/mwageringel"
}
```

**Author:** Markus Wageringel



---

archive/issue_comments_537349.json:
```json
{
    "body": "**Commit:** [9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)",
    "created_at": "2021-12-31T16:42:08Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537349",
    "user": "https://github.com/mwageringel"
}
```

**Commit:** [9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)



---

archive/issue_comments_537350.json:
```json
{
    "body": "<a id='comment:2'></a>\nYour lrslib is older than what is in our distribution",
    "created_at": "2021-12-31T18:47:41Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537350",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Your lrslib is older than what is in our distribution



---

archive/issue_comments_537351.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis was after a distclean. I had not explicitly installed lrslib, it was on the system. If I understand the config.log correctly, the system lrslib was not accepted by Sage. Yet, ptestlong runs the optional lrslib tests.\n\n```\n## ------------------------------------------------------- ##\n## Checking whether SageMath should install SPKG lrslib... ##\n## ------------------------------------------------------- ##\nconfigure:30190: checking whether any of gmp flint is installed as or will be installed as SPKG\nconfigure:30194: result: yes; install lrslib as well\nconfigure:30296: no suitable system package found for SPKG lrslib\n```",
    "created_at": "2022-01-01T09:52:00Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537351",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:3'></a>
This was after a distclean. I had not explicitly installed lrslib, it was on the system. If I understand the config.log correctly, the system lrslib was not accepted by Sage. Yet, ptestlong runs the optional lrslib tests.

```
## ------------------------------------------------------- ##
## Checking whether SageMath should install SPKG lrslib... ##
## ------------------------------------------------------- ##
configure:30190: checking whether any of gmp flint is installed as or will be installed as SPKG
configure:30194: result: yes; install lrslib as well
configure:30296: no suitable system package found for SPKG lrslib
```



---

archive/issue_events_296833.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-01T17:05:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296833"
}
```



---

archive/issue_events_296834.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-01T17:05:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296834"
}
```



---

archive/attachments_021576.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "config.log",
    "asset_url": "tarball://root/attachments/ticket33101/config.log",
    "created_at": "2022-01-01T17:05:09Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket33101/config.log",
    "user": "https://github.com/mkoeppe"
}
```



---

archive/issue_comments_537352.json:
```json
{
    "body": "<a id='comment:4'></a>\nAttachment [config.log](https://github.com/sagemath/sage/files/ticket33101/config.log) by @mkoeppe created at 2022-01-01 17:05:09\n\n`lrslib` is optional, so it will not be installed unless you use `configure --enable-lrslib` (or install the package explicitly using `sage -i lrslib`).\n\nThat the doctest is tested anyway is an interesting new behavior introduced by #32174. It finds system `lrslib` at runtime via `sage.features.lrs`",
    "created_at": "2022-01-01T17:05:09Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537352",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Attachment [config.log](https://github.com/sagemath/sage/files/ticket33101/config.log) by @mkoeppe created at 2022-01-01 17:05:09

`lrslib` is optional, so it will not be installed unless you use `configure --enable-lrslib` (or install the package explicitly using `sage -i lrslib`).

That the doctest is tested anyway is an interesting new behavior introduced by #32174. It finds system `lrslib` at runtime via `sage.features.lrs`



---

archive/issue_comments_537353.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mkoeppe](#comment%3A4):\n> That the doctest is tested anyway is an interesting new behavior introduced by #32174. It finds system `lrslib` at runtime via `sage.features.lrs`\n\n\nIs it a good thing or a bad thing?\n\nAlso, I notice that lrslib appears both as an optional package and as a feature to be detected:\n\n```\nUsing --optional=4ti2,bliss,build,cbc,ccache,cryptominisat,database_symbolic_data,debian,debugpy,dochtml,dot2tex,e_antic,fricas,glucose,latte_int,lidia,lrslib,normaliz,notedown,pandoc_attributes,pip,pycosat,pynormaliz,rst2ipynb,rubiks,sage,sage_numerical_backends_coin,sage_spkg\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,ffmpeg,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,pandoc,pdf2svg,plantri,pynormaliz,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.plot,sage.rings.number_field,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,tdlib\n```\n\nBut at the end, lrslib does not appear:\n\n```\nFeatures detected for doctesting: \n```\nTherefore, in my case, lrslib tests are run because it is an optional package that I haved installed:\n\n```\n$ sage -optional | grep lrs\nlrslib..................................071b+autotools-2021-07-13 (071b+autotools-2021-07-13)\n```\n\nIn my case, tests passed with and without the branch. Why needs work?",
    "created_at": "2022-01-04T11:22:29Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537353",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'></a>
Replying to [mkoeppe](#comment%3A4):
> That the doctest is tested anyway is an interesting new behavior introduced by #32174. It finds system `lrslib` at runtime via `sage.features.lrs`


Is it a good thing or a bad thing?

Also, I notice that lrslib appears both as an optional package and as a feature to be detected:

```
Using --optional=4ti2,bliss,build,cbc,ccache,cryptominisat,database_symbolic_data,debian,debugpy,dochtml,dot2tex,e_antic,fricas,glucose,latte_int,lidia,lrslib,normaliz,notedown,pandoc_attributes,pip,pycosat,pynormaliz,rst2ipynb,rubiks,sage,sage_numerical_backends_coin,sage_spkg
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,ffmpeg,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,pandoc,pdf2svg,plantri,pynormaliz,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.plot,sage.rings.number_field,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,tdlib
```

But at the end, lrslib does not appear:

```
Features detected for doctesting: 
```
Therefore, in my case, lrslib tests are run because it is an optional package that I haved installed:

```
$ sage -optional | grep lrs
lrslib..................................071b+autotools-2021-07-13 (071b+autotools-2021-07-13)
```

In my case, tests passed with and without the branch. Why needs work?



---

archive/issue_comments_537354.json:
```json
{
    "body": "**Changing author** from \"Markus Wageringel\" to \"\".",
    "created_at": "2022-01-04T11:46:11Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537354",
    "user": "https://github.com/mwageringel"
}
```

**Changing author** from "Markus Wageringel" to "".



---

archive/issue_comments_537355.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [slabbe](#comment%3A5):\n> Replying to [mkoeppe](#comment%3A4):\n> > That the doctest is tested anyway is an interesting new behavior introduced by #32174. It finds system `lrslib` at runtime via `sage.features.lrs`\n\n> \n> Is it a good thing or a bad thing?\n\n\nIt should not happen. Sage knows that my system lrslib is not compatible with my Sage installation, so the optional tests should not be run with an incompatible lrslib version (note that I have not installed the optional package). I do not know how to solve this, though.\n\n> In my case, tests passed with and without the branch. Why needs work?\n\n\nThe branch makes the tests pass, but actually does not solve the underlying problem.",
    "created_at": "2022-01-04T11:46:11Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537355",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:6'></a>
Replying to [slabbe](#comment%3A5):
> Replying to [mkoeppe](#comment%3A4):
> > That the doctest is tested anyway is an interesting new behavior introduced by #32174. It finds system `lrslib` at runtime via `sage.features.lrs`

> 
> Is it a good thing or a bad thing?


It should not happen. Sage knows that my system lrslib is not compatible with my Sage installation, so the optional tests should not be run with an incompatible lrslib version (note that I have not installed the optional package). I do not know how to solve this, though.

> In my case, tests passed with and without the branch. Why needs work?


The branch makes the tests pass, but actually does not solve the underlying problem.



---

archive/issue_comments_537356.json:
```json
{
    "body": "<a id='comment:7'></a>\nWhat is the output of this on your machine?\n\n```\nsage: from sage.features.lrs import Lrs\nsage: Lrs().is_present()\nsage: Lrs().is_functional()\n```",
    "created_at": "2022-01-04T11:58:29Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537356",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:7'></a>
What is the output of this on your machine?

```
sage: from sage.features.lrs import Lrs
sage: Lrs().is_present()
sage: Lrs().is_functional()
```



---

archive/issue_comments_537357.json:
```json
{
    "body": "<a id='comment:8'></a>\n\n```\nsage: from sage.features.lrs import Lrs\nsage: Lrs().is_present()\nFeatureTestResult('lrslib', True)\nsage: Lrs().is_functional()\nFeatureTestResult('lrslib', True)\n```",
    "created_at": "2022-01-04T13:30:47Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537357",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:8'></a>

```
sage: from sage.features.lrs import Lrs
sage: Lrs().is_present()
FeatureTestResult('lrslib', True)
sage: Lrs().is_functional()
FeatureTestResult('lrslib', True)
```



---

archive/issue_comments_537358.json:
```json
{
    "body": "<a id='comment:9'></a>\nIf the `lrslib` that is available on your machine is not functional, you should be able to find an example where it does not behave correctly and you can add this example to the list of examples checked in the method `is_functional` so that `is_functional()` returns `False`. This will imply that the doctests marked with tag `lrslib` will not be run on your machine.",
    "created_at": "2022-01-04T14:18:32Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537358",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:9'></a>
If the `lrslib` that is available on your machine is not functional, you should be able to find an example where it does not behave correctly and you can add this example to the list of examples checked in the method `is_functional` so that `is_functional()` returns `False`. This will imply that the doctests marked with tag `lrslib` will not be run on your machine.



---

archive/issue_comments_537359.json:
```json
{
    "body": "<a id='comment:10'></a>\nSuch an example illustrating the new input format is provided in `build/pkgs/lrslib/spkg-configure.m4`. I don't know if there is a way for features to use the stuff from the m4 files without copy-pasting the example?",
    "created_at": "2022-01-04T14:24:18Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537359",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:10'></a>
Such an example illustrating the new input format is provided in `build/pkgs/lrslib/spkg-configure.m4`. I don't know if there is a way for features to use the stuff from the m4 files without copy-pasting the example?



---

archive/issue_comments_537360.json:
```json
{
    "body": "<a id='comment:11'></a>\nIndependently of the doctesting behavior \u2013 if I use lrslib functionality at runtime, why does Sage not raise an error telling me to install the optional package first? Is it safe to just use it without checking? I know nothing about lrslib, to be honest. For some interfaces such as Macaulay2, it is usually not necessary to check the concrete version that is installed, but I am not sure about optional packages. Especially due to the gmp/flint dependency, as seen in [comment:3](#comment%3A3).",
    "created_at": "2022-01-04T16:36:12Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537360",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:11'></a>
Independently of the doctesting behavior – if I use lrslib functionality at runtime, why does Sage not raise an error telling me to install the optional package first? Is it safe to just use it without checking? I know nothing about lrslib, to be honest. For some interfaces such as Macaulay2, it is usually not necessary to check the concrete version that is installed, but I am not sure about optional packages. Especially due to the gmp/flint dependency, as seen in [comment:3](#comment%3A3).



---

archive/issue_comments_537361.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [gh-mwageringel](#comment%3A11):\n> Independently of the doctesting behavior \u2013 if I use lrslib functionality at runtime, why does Sage not raise an error telling me to install the optional package first? \n\n\nI think it is because it checks whether `lrs` command exists in the `sage -sh` environment which is a union of command from sage and from your system. Since the feature `lrs` is found there, it does not tell you to install it.\n\n> Is it safe to just use it without checking? \n\n\nA check *is* done in the `is_functional` method. (Maybe the goal of this ticket is to update this method.)\n\n> I know nothing about lrslib, to be honest. \n\n\nMe neither.\n\n> For some interfaces such as Macaulay2, it is usually not necessary to check the concrete version that is installed, but I am not sure about optional packages. Especially due to the gmp/flint dependency, as seen in [comment:3](#comment%3A3).\n\n\nOne option is to change the feature `lrs` which is currently written as an executable `class Lrs(Executable)` and modify it into just feature that checks the presence of the optional package. I let someone else more knowledgeable on lrs than me decides here.",
    "created_at": "2022-01-04T20:38:10Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537361",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:12'></a>
Replying to [gh-mwageringel](#comment%3A11):
> Independently of the doctesting behavior – if I use lrslib functionality at runtime, why does Sage not raise an error telling me to install the optional package first? 


I think it is because it checks whether `lrs` command exists in the `sage -sh` environment which is a union of command from sage and from your system. Since the feature `lrs` is found there, it does not tell you to install it.

> Is it safe to just use it without checking? 


A check *is* done in the `is_functional` method. (Maybe the goal of this ticket is to update this method.)

> I know nothing about lrslib, to be honest. 


Me neither.

> For some interfaces such as Macaulay2, it is usually not necessary to check the concrete version that is installed, but I am not sure about optional packages. Especially due to the gmp/flint dependency, as seen in [comment:3](#comment%3A3).


One option is to change the feature `lrs` which is currently written as an executable `class Lrs(Executable)` and modify it into just feature that checks the presence of the optional package. I let someone else more knowledgeable on lrs than me decides here.



---

archive/issue_comments_537362.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [slabbe](#comment%3A12):\n> One option is to change the feature `lrs` which is currently written as an executable `class Lrs(Executable)` and modify it into just feature that checks the presence of the optional package.\n\n\nNo, this is not a step in a good direction. Note that our build system does not record at all whether an optional system package is available. The point of going through `Feature`s is that it also works on both system packages and SPKGs.\n\nI would suggest to:\n- check whether lrslib 070 works correctly (perhaps in one of our previous tickets this is already commented on, I don't recall) and if so, relax the tests in `build/pkgs/lrslib/spkg-configure.m4` so that they accept this version\n- run equivalents of the tests made by `spkg-configure.m4` in the `lrs` Feature (comment:9, [comment:10](#comment%3A10)).",
    "created_at": "2022-01-04T21:04:03Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537362",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Replying to [slabbe](#comment%3A12):
> One option is to change the feature `lrs` which is currently written as an executable `class Lrs(Executable)` and modify it into just feature that checks the presence of the optional package.


No, this is not a step in a good direction. Note that our build system does not record at all whether an optional system package is available. The point of going through `Feature`s is that it also works on both system packages and SPKGs.

I would suggest to:
- check whether lrslib 070 works correctly (perhaps in one of our previous tickets this is already commented on, I don't recall) and if so, relax the tests in `build/pkgs/lrslib/spkg-configure.m4` so that they accept this version
- run equivalents of the tests made by `spkg-configure.m4` in the `lrs` Feature (comment:9, [comment:10](#comment%3A10)).



---

archive/issue_events_296835.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296835"
}
```



---

archive/issue_events_296836.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296836"
}
```



---

archive/issue_comments_537363.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2022-01-14T11:17:31Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537363",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_comments_537364.json:
```json
{
    "body": "**Author:** Markus Wageringel",
    "created_at": "2022-01-14T11:17:31Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537364",
    "user": "https://github.com/dimpase"
}
```

**Author:** Markus Wageringel



---

archive/issue_events_296837.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-01-14T11:17:31Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296837"
}
```



---

archive/issue_events_296838.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-01-14T11:17:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296838"
}
```



---

archive/issue_comments_537365.json:
```json
{
    "body": "<a id='comment:15'></a>\nI think the branch here is a reasonable compromise. Rejecting a library just because it outputs something in a slightly different way seems to be an overkill.",
    "created_at": "2022-01-14T11:17:31Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537365",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>
I think the branch here is a reasonable compromise. Rejecting a library just because it outputs something in a slightly different way seems to be an overkill.



---

archive/issue_events_296839.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-01-14T11:17:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296839"
}
```



---

archive/issue_events_296840.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-01-14T11:17:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296840"
}
```



---

archive/issue_events_296841.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T11:41:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296841"
}
```



---

archive/issue_events_296842.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T11:41:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296842"
}
```



---

archive/issue_comments_537366.json:
```json
{
    "body": "<a id='comment:17'></a>\nPlease, wait a second, I was actually working on a branch adressing the comment 13.",
    "created_at": "2022-01-14T11:42:08Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537366",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:17'></a>
Please, wait a second, I was actually working on a branch adressing the comment 13.



---

archive/issue_comments_537367.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)\" to \"[u/slabbe/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33101)\".",
    "created_at": "2022-01-14T11:45:02Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537367",
    "user": "https://github.com/seblabbe"
}
```

**Changing branch** from "[u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)" to "[u/slabbe/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33101)".



---

archive/issue_comments_537368.json:
```json
{
    "body": "<a id='comment:18'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0342538db47e2171ae536ed25f74531f0dd34b81\">0342538</a></td><td><code>33101: adding a second check in lrs feature is_functional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ecec1dcee59f8e4e2dbac98a78926d9603b518e\">5ecec1d</a></td><td><code>33101: simplification of check #1 in is_functional method of lrs feature</code></td></tr></table>\n",
    "created_at": "2022-01-14T11:45:02Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537368",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:18'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0342538db47e2171ae536ed25f74531f0dd34b81">0342538</a></td><td><code>33101: adding a second check in lrs feature is_functional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ecec1dcee59f8e4e2dbac98a78926d9603b518e">5ecec1d</a></td><td><code>33101: simplification of check #1 in is_functional method of lrs feature</code></td></tr></table>




---

archive/issue_comments_537369.json:
```json
{
    "body": "**Changing commit** from \"[9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)\" to \"[5ecec1dcee59f8e4e2dbac98a78926d9603b518e](https://github.com/sagemath/sagetrac-mirror/commit/5ecec1dcee59f8e4e2dbac98a78926d9603b518e)\".",
    "created_at": "2022-01-14T11:45:02Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537369",
    "user": "https://github.com/seblabbe"
}
```

**Changing commit** from "[9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)" to "[5ecec1dcee59f8e4e2dbac98a78926d9603b518e](https://github.com/sagemath/sagetrac-mirror/commit/5ecec1dcee59f8e4e2dbac98a78926d9603b518e)".



---

archive/issue_events_296843.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T11:45:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296843"
}
```



---

archive/issue_events_296844.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T11:45:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296844"
}
```



---

archive/issue_comments_537370.json:
```json
{
    "body": "<a id='comment:19'></a>\n*This comment was moved to [#33167 comment:5](https://github.com/sagemath/sage/issues/33167#comment:5) *",
    "created_at": "2022-01-14T11:47:23Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537370",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:19'></a>
*This comment was moved to [#33167 comment:5](https://github.com/sagemath/sage/issues/33167#comment:5) *



---

archive/issue_comments_537371.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [slabbe](#comment%3A17):\n> Please, wait a second, I was actually working on a branch adressing the comment 13.\n\n\nI don't agree that [comment:13](#comment%3A13) is totally right. It's a slightly different output (cause this doctest does parse output!), just as is the case for e.g. numerical noise.",
    "created_at": "2022-01-14T12:20:03Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537371",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
Replying to [slabbe](#comment%3A17):
> Please, wait a second, I was actually working on a branch adressing the comment 13.


I don't agree that [comment:13](#comment%3A13) is totally right. It's a slightly different output (cause this doctest does parse output!), just as is the case for e.g. numerical noise.



---

archive/issue_events_296845.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T14:06:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296845"
}
```



---

archive/issue_events_296846.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-01-14T14:06:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296846"
}
```



---

archive/issue_comments_537372.json:
```json
{
    "body": "**Changing branch** from \"[u/slabbe/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33101)\" to \"[u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)\".",
    "created_at": "2022-01-14T14:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537372",
    "user": "https://github.com/seblabbe"
}
```

**Changing branch** from "[u/slabbe/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/33101)" to "[u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)".



---

archive/issue_comments_537373.json:
```json
{
    "body": "<a id='comment:21'></a>\nOk, I agree, my branch is more to address comment 3 of this ticket than to address the problem described in the description of this ticket.\n\nLet me put back the previous branch. And I will post my branch on another ticket.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490\">9e7357e</a></td><td><code>33101: lrslib: fix doctest in game_theory/parser.py</code></td></tr></table>\n",
    "created_at": "2022-01-14T14:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537373",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:21'></a>
Ok, I agree, my branch is more to address comment 3 of this ticket than to address the problem described in the description of this ticket.

Let me put back the previous branch. And I will post my branch on another ticket.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490">9e7357e</a></td><td><code>33101: lrslib: fix doctest in game_theory/parser.py</code></td></tr></table>




---

archive/issue_comments_537374.json:
```json
{
    "body": "**Changing commit** from \"[5ecec1dcee59f8e4e2dbac98a78926d9603b518e](https://github.com/sagemath/sagetrac-mirror/commit/5ecec1dcee59f8e4e2dbac98a78926d9603b518e)\" to \"[9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)\".",
    "created_at": "2022-01-14T14:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537374",
    "user": "https://github.com/seblabbe"
}
```

**Changing commit** from "[5ecec1dcee59f8e4e2dbac98a78926d9603b518e](https://github.com/sagemath/sagetrac-mirror/commit/5ecec1dcee59f8e4e2dbac98a78926d9603b518e)" to "[9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)".



---

archive/issue_comments_537375.json:
```json
{
    "body": "<a id='comment:22'></a>\nAnd I created #33167 to address [comment:3](#comment%3A3)",
    "created_at": "2022-01-14T14:12:34Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537375",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:22'></a>
And I created #33167 to address [comment:3](#comment%3A3)



---

archive/issue_events_296847.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-22T12:54:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296847"
}
```



---

archive/issue_events_296848.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-25T07:34:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296848"
}
```



---

archive/issue_events_296849.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-25T07:34:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296849"
}
```



---

archive/issue_comments_537376.json:
```json
{
    "body": "<a id='comment:24'></a>\nNeeded to resume patchbot operation.",
    "created_at": "2022-01-25T07:34:21Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537376",
    "user": "https://github.com/slel"
}
```

<a id='comment:24'></a>
Needed to resume patchbot operation.



---

archive/issue_events_296850.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-01-25T08:16:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296850"
}
```



---

archive/issue_events_296851.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-01-25T08:16:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296851"
}
```



---

archive/issue_comments_537377.json:
```json
{
    "body": "<a id='comment:25'></a>\nThis is not a blocker, in my opinion, as it does not change any functionality at all, but only touches a flaky doctest. Patchbot owners could enable the optional package, as a workaround.",
    "created_at": "2022-01-25T08:16:19Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537377",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:25'></a>
This is not a blocker, in my opinion, as it does not change any functionality at all, but only touches a flaky doctest. Patchbot owners could enable the optional package, as a workaround.



---

archive/issue_comments_537378.json:
```json
{
    "body": "<a id='comment:26'></a>\nSetting milestone to 9.6 now that 9.5 is out.",
    "created_at": "2022-01-30T15:39:13Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537378",
    "user": "https://github.com/slel"
}
```

<a id='comment:26'></a>
Setting milestone to 9.6 now that 9.5 is out.



---

archive/issue_events_296852.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:39:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296852"
}
```



---

archive/issue_events_296853.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:39:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296853"
}
```



---

archive/issue_comments_537379.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)\" to \"[9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)\".",
    "created_at": "2022-01-31T23:32:02Z",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33101#issuecomment-537379",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/gh-mwageringel/33101](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33101)" to "[9e7357e49d4c588b6c614d84cc6f53085dd58490](https://github.com/sagemath/sagetrac-mirror/commit/9e7357e49d4c588b6c614d84cc6f53085dd58490)".



---

archive/issue_events_296854.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-31T23:32:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296854"
}
```



---

archive/issue_events_296855.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6f5f31e10e6068089801afe0d57ad27137abf8eb",
    "created_at": "2022-01-31T23:32:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33101",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33101#event-296855"
}
```
