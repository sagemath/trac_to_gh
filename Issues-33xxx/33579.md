# Issue 33579: Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1

archive/issues_033579.json:
```json
{
    "body": "CC:  @culler @jhpalmieri @kliem\n\nWe would use 12.2.0 plus the feature patch for Apple Silicon support that the homebrew folks use:\nhttps://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L12\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33816\n\n",
    "closed_at": "2022-10-17T22:44:06Z",
    "created_at": "2022-05-06T15:49:38Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33579",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @culler @jhpalmieri @kliem

We would use 12.2.0 plus the feature patch for Apple Silicon support that the homebrew folks use:
https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L12


Issue created by migration from https://trac.sagemath.org/ticket/33816





---

archive/issue_comments_477274.json:
```json
{
    "body": "Looks like homebrew is able to use upstream gcc 12 on M1 - https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc`@`12.rb",
    "created_at": "2022-05-20T02:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477274",
    "user": "https://github.com/mkoeppe"
}
```

Looks like homebrew is able to use upstream gcc 12 on M1 - https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc`@`12.rb



---

archive/issue_comments_477275.json:
```json
{
    "body": "... with one big patch: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc`@`12.rb#L43",
    "created_at": "2022-06-30T23:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477275",
    "user": "https://github.com/mkoeppe"
}
```

... with one big patch: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc`@`12.rb#L43



---

archive/issue_events_088800.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33579#event-88800"
}
```



---

archive/issue_comments_477276.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-09-20T20:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477276",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_477277.json:
```json
{
    "body": "I don't know if this is ready yet but I tried it anyway on my new M2 laptop. It failed; the end of the log file reads\n\n```\n0  0x1010cc1a0  __assert_rtn + 140\n1  0x100f53a8c  mach_o::relocatable::Parser<arm64>::parse(mach_o::relocatable::ParserOptions const&) + 4536\n2  0x100f25d38  mach_o::relocatable::Parser<arm64>::parse(unsigned char const*, unsigned long long, char const*, long, ld::File::Ordinal, mach_o::relocatable::ParserOptions const&) + 148\n3  0x100f8e4ac  ld::tool::InputFiles::makeFile(Options::FileInfo const&, bool) + 1468\n4  0x100f91360  ___ZN2ld4tool10InputFilesC2ER7Options_block_invoke + 56\n5  0x188a041f4  _dispatch_client_callout2 + 20\n6  0x188a17954  _dispatch_apply_invoke + 224\n7  0x188a041b4  _dispatch_client_callout + 20\n8  0x188a15a04  _dispatch_root_queue_drain + 680\n9  0x188a16104  _dispatch_worker_thread2 + 164\n10  0x188bc4324  _pthread_wqthread + 228\nA linker snapshot was created at:\n\t/tmp/libstdc++.6.dylib-2022-09-20-133305.ld-snapshot\nld: Assertion failed: (_file->_atomsArrayCount == computedAtomCount && \"more atoms allocated than expected\"), function parse, file macho_relocatable_file.cpp, line 2061.\n```\nI can post the full log file if you want.",
    "created_at": "2022-09-20T20:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477277",
    "user": "https://github.com/jhpalmieri"
}
```

I don't know if this is ready yet but I tried it anyway on my new M2 laptop. It failed; the end of the log file reads

```
0  0x1010cc1a0  __assert_rtn + 140
1  0x100f53a8c  mach_o::relocatable::Parser<arm64>::parse(mach_o::relocatable::ParserOptions const&) + 4536
2  0x100f25d38  mach_o::relocatable::Parser<arm64>::parse(unsigned char const*, unsigned long long, char const*, long, ld::File::Ordinal, mach_o::relocatable::ParserOptions const&) + 148
3  0x100f8e4ac  ld::tool::InputFiles::makeFile(Options::FileInfo const&, bool) + 1468
4  0x100f91360  ___ZN2ld4tool10InputFilesC2ER7Options_block_invoke + 56
5  0x188a041f4  _dispatch_client_callout2 + 20
6  0x188a17954  _dispatch_apply_invoke + 224
7  0x188a041b4  _dispatch_client_callout + 20
8  0x188a15a04  _dispatch_root_queue_drain + 680
9  0x188a16104  _dispatch_worker_thread2 + 164
10  0x188bc4324  _pthread_wqthread + 228
A linker snapshot was created at:
	/tmp/libstdc++.6.dylib-2022-09-20-133305.ld-snapshot
ld: Assertion failed: (_file->_atomsArrayCount == computedAtomCount && "more atoms allocated than expected"), function parse, file macho_relocatable_file.cpp, line 2061.
```
I can post the full log file if you want.



---

archive/issue_comments_477278.json:
```json
{
    "body": "Thanks for testing. Also on Intel I ran into a build error. This will need more work.",
    "created_at": "2022-09-20T20:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477278",
    "user": "https://github.com/mkoeppe"
}
```

Thanks for testing. Also on Intel I ran into a build error. This will need more work.



---

archive/issue_comments_477279.json:
```json
{
    "body": "I'm happy to test. It's just a MacBook Air, but it builds Sage faster than my iMac Pro, and I like giving it tasks.",
    "created_at": "2022-09-20T20:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477279",
    "user": "https://github.com/jhpalmieri"
}
```

I'm happy to test. It's just a MacBook Air, but it builds Sage faster than my iMac Pro, and I like giving it tasks.



---

archive/issue_comments_477280.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T00:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477280",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477281.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T01:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477281",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477282.json:
```json
{
    "body": "On Intel, this still fails `tox -e local-macos-nohomebrew -- gfortran`, but it passes with the full bootstrapped build `tox -e local-macos-nohomebrew -- gcc`.\n\nThe failure when trying to build `gfortran` using Apple's gcc (clang) is introduced by the patch - passing the argument `-nodefaultrpaths` to the compiler.",
    "created_at": "2022-09-21T02:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477282",
    "user": "https://github.com/mkoeppe"
}
```

On Intel, this still fails `tox -e local-macos-nohomebrew -- gfortran`, but it passes with the full bootstrapped build `tox -e local-macos-nohomebrew -- gcc`.

The failure when trying to build `gfortran` using Apple's gcc (clang) is introduced by the patch - passing the argument `-nodefaultrpaths` to the compiler.



---

archive/issue_comments_477283.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T02:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477283",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477284.json:
```json
{
    "body": "This builds for me now on Intel. Haven't tested anything else yet",
    "created_at": "2022-09-21T02:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477284",
    "user": "https://github.com/mkoeppe"
}
```

This builds for me now on Intel. Haven't tested anything else yet



---

archive/issue_comments_477285.json:
```json
{
    "body": "Still fails for me on m2.",
    "created_at": "2022-09-21T02:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477285",
    "user": "https://github.com/jhpalmieri"
}
```

Still fails for me on m2.



---

archive/issue_comments_477286.json:
```json
{
    "body": "full log please",
    "created_at": "2022-09-21T02:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477286",
    "user": "https://github.com/mkoeppe"
}
```

full log please



---

archive/issue_comments_477287.json:
```json
{
    "body": "Hold on, I tried `make gcc`. I'm going to try `make gfortran` and see how that goes.",
    "created_at": "2022-09-21T02:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477287",
    "user": "https://github.com/jhpalmieri"
}
```

Hold on, I tried `make gcc`. I'm going to try `make gfortran` and see how that goes.



---

archive/issue_comments_477288.json:
```json
{
    "body": "`gfortran` built successfully.",
    "created_at": "2022-09-21T02:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477288",
    "user": "https://github.com/jhpalmieri"
}
```

`gfortran` built successfully.



---

archive/issue_comments_477289.json:
```json
{
    "body": "Great! I think we can ignore the failure to build gcc. We haven't been testing those in quite a while",
    "created_at": "2022-09-21T02:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477289",
    "user": "https://github.com/mkoeppe"
}
```

Great! I think we can ignore the failure to build gcc. We haven't been testing those in quite a while



---

archive/issue_comments_477290.json:
```json
{
    "body": "I'll run this for the Linux platforms on CI, just to be sure that this big patch doesn't break anything for those",
    "created_at": "2022-09-21T02:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477290",
    "user": "https://github.com/mkoeppe"
}
```

I'll run this for the Linux platforms on CI, just to be sure that this big patch doesn't break anything for those



---

archive/issue_comments_477291.json:
```json
{
    "body": "I assume that it works, but I can't test it properly since `openblas` won't build on this machine, and Sage insists on trying to build its own `openblas` if it builds its own `gfortran`.",
    "created_at": "2022-09-21T02:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477291",
    "user": "https://github.com/jhpalmieri"
}
```

I assume that it works, but I can't test it properly since `openblas` won't build on this machine, and Sage insists on trying to build its own `openblas` if it builds its own `gfortran`.



---

archive/issue_comments_477292.json:
```json
{
    "body": "Maybe worth trying if an openblas upgrade fixes the problem?",
    "created_at": "2022-09-21T03:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477292",
    "user": "https://github.com/mkoeppe"
}
```

Maybe worth trying if an openblas upgrade fixes the problem?



---

archive/issue_comments_477293.json:
```json
{
    "body": "homebrew uses 0.3.21, we are still at 0.3.20\nhttps://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/openblas.rb",
    "created_at": "2022-09-21T03:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477293",
    "user": "https://github.com/mkoeppe"
}
```

homebrew uses 0.3.21, we are still at 0.3.20
https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/openblas.rb



---

archive/issue_comments_477294.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T03:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477294",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477295.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-09-21T03:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477295",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_477296.json:
```json
{
    "body": "This works for me on m2 and Intel.",
    "created_at": "2022-09-21T17:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477296",
    "user": "https://github.com/jhpalmieri"
}
```

This works for me on m2 and Intel.



---

archive/issue_comments_477297.json:
```json
{
    "body": "Great, thanks for testing! The GH Actions will still need a bit of time to test on Linux, but I'm setting it to \"needs_review\" already",
    "created_at": "2022-09-21T17:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477297",
    "user": "https://github.com/mkoeppe"
}
```

Great, thanks for testing! The GH Actions will still need a bit of time to test on Linux, but I'm setting it to "needs_review" already



---

archive/issue_comments_477298.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-21T17:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477298",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_477299.json:
```json
{
    "body": "On the Intel machine I see some doctest failures involving numerical issues, for example\n\n```\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py\", line 402, in sage.tests.books.computational-mathematics-with-sagemath.float_doctest\nFailed example:\n    NearlySingularMatrix(RDF,n).det() == 0.0\nExpected:\n    True\nGot:\n    False\n```\nand\n\n```\nFile \"src/sage/geometry/polyhedron/base7.py\", line 569, in sage.geometry.polyhedron.base7.Polyhedron_base7.volume\nFailed example:\n    w = Dinexact.faces(2)[2].as_polyhedron().volume(measure='induced', engine='internal'); RDF(w) # abs tol 1e-9\nExpected:\n    1.5340627082974878\nGot:\n    8.032456584010367\nTolerance exceeded:\n    1.5340627082974878 vs 8.032456584010367, tolerance 7e0 > 1e-9\n```",
    "created_at": "2022-09-21T19:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477299",
    "user": "https://github.com/jhpalmieri"
}
```

On the Intel machine I see some doctest failures involving numerical issues, for example

```
File "src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py", line 402, in sage.tests.books.computational-mathematics-with-sagemath.float_doctest
Failed example:
    NearlySingularMatrix(RDF,n).det() == 0.0
Expected:
    True
Got:
    False
```
and

```
File "src/sage/geometry/polyhedron/base7.py", line 569, in sage.geometry.polyhedron.base7.Polyhedron_base7.volume
Failed example:
    w = Dinexact.faces(2)[2].as_polyhedron().volume(measure='induced', engine='internal'); RDF(w) # abs tol 1e-9
Expected:
    1.5340627082974878
Got:
    8.032456584010367
Tolerance exceeded:
    1.5340627082974878 vs 8.032456584010367, tolerance 7e0 > 1e-9
```



---

archive/issue_comments_477300.json:
```json
{
    "body": "Maybe related to #31621?",
    "created_at": "2022-09-21T19:21:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477300",
    "user": "https://github.com/jhpalmieri"
}
```

Maybe related to #31621?



---

archive/issue_comments_477301.json:
```json
{
    "body": "I think many of our RDF doctests are frivolous. \n\nThe RDF determinant goes through `scipy.linalg.det` as far I can see, and that is also what goes into the volume computation",
    "created_at": "2022-09-21T19:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477301",
    "user": "https://github.com/mkoeppe"
}
```

I think many of our RDF doctests are frivolous. 

The RDF determinant goes through `scipy.linalg.det` as far I can see, and that is also what goes into the volume computation



---

archive/issue_comments_477302.json:
```json
{
    "body": "That said, the result for the dodecahedron volume is quite concerning.",
    "created_at": "2022-09-21T19:41:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477302",
    "user": "https://github.com/mkoeppe"
}
```

That said, the result for the dodecahedron volume is quite concerning.



---

archive/issue_comments_477303.json:
```json
{
    "body": "I'm attaching a file showing all of the failures.",
    "created_at": "2022-09-21T19:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477303",
    "user": "https://github.com/jhpalmieri"
}
```

I'm attaching a file showing all of the failures.



---

archive/issue_comments_477304.json:
```json
{
    "body": "Attachment [test.log](tarball://root/attachments/some-uuid/ticket33816/test.log) by git created at 2022-09-21 19:51:51\n\nBranch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T19:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477304",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Attachment [test.log](tarball://root/attachments/some-uuid/ticket33816/test.log) by git created at 2022-09-21 19:51:51

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477305.json:
```json
{
    "body": "And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.\n\n---\nNew commits:",
    "created_at": "2022-09-21T19:52:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477305",
    "user": "https://github.com/jhpalmieri"
}
```

And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.

---
New commits:



---

archive/issue_comments_477306.json:
```json
{
    "body": "Throwing in a GSL upgrade just so we're up to date on everything that implements RDF stuff",
    "created_at": "2022-09-21T19:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477306",
    "user": "https://github.com/mkoeppe"
}
```

Throwing in a GSL upgrade just so we're up to date on everything that implements RDF stuff



---

archive/issue_comments_477307.json:
```json
{
    "body": "Replying to [comment:38 John Palmieri]:\n> And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.\n\n\nI guess I'll have to re-read #31621 more carefully.",
    "created_at": "2022-09-21T19:54:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477307",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:38 John Palmieri]:
> And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.


I guess I'll have to re-read #31621 more carefully.



---

archive/issue_comments_477308.json:
```json
{
    "body": "One hypothesis in #31621 was the flag `-march=native` was causing problems somewhere: `openblas`, `gsl`, somewhere else?\n\nFor this ticket, it is certainly possible that these errors are not caused by building our own `gfortran` but by other packages which are built as a result of building our own `gfortran`.",
    "created_at": "2022-09-21T20:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477308",
    "user": "https://github.com/jhpalmieri"
}
```

One hypothesis in #31621 was the flag `-march=native` was causing problems somewhere: `openblas`, `gsl`, somewhere else?

For this ticket, it is certainly possible that these errors are not caused by building our own `gfortran` but by other packages which are built as a result of building our own `gfortran`.



---

archive/issue_comments_477309.json:
```json
{
    "body": "Regarding `gsl`, `gfortran`, and `openblas`: with the branch here, on two different machines, I see\n\n- If I do `./configure --with-system-gfortran=no`, everything builds, although I get numerical failures on one of the machines (Intel).\n- If I instead do `./configure --with-system-openblas=no`, then `gsl` fails to build: the error says `ld: file not found: `@`rpath/libquadmath.0.dylib for architecture x86_64` (Intel) and similar on M2 (but with `arm64` at the end). On the Intel machine at least, I see the same with the previous version of `gsl`: the upgrade had no effect.\n- If I instead do `./configure --with-system-gsl=no`, then everything builds and I do not see the same numerical failures.\n\nSo it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.",
    "created_at": "2022-09-21T21:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477309",
    "user": "https://github.com/jhpalmieri"
}
```

Regarding `gsl`, `gfortran`, and `openblas`: with the branch here, on two different machines, I see

- If I do `./configure --with-system-gfortran=no`, everything builds, although I get numerical failures on one of the machines (Intel).
- If I instead do `./configure --with-system-openblas=no`, then `gsl` fails to build: the error says `ld: file not found: `@`rpath/libquadmath.0.dylib for architecture x86_64` (Intel) and similar on M2 (but with `arm64` at the end). On the Intel machine at least, I see the same with the previous version of `gsl`: the upgrade had no effect.
- If I instead do `./configure --with-system-gsl=no`, then everything builds and I do not see the same numerical failures.

So it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.



---

archive/issue_comments_477310.json:
```json
{
    "body": "Replying to [comment:42 John Palmieri]:\n> So it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.\n\n\nConfirmed: I get the same errors with the `develop` branch plus `--with-system-gfortran=no`.",
    "created_at": "2022-09-21T22:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477310",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:42 John Palmieri]:
> So it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.


Confirmed: I get the same errors with the `develop` branch plus `--with-system-gfortran=no`.



---

archive/issue_comments_477311.json:
```json
{
    "body": "Now I would like to track down two issues, perhaps neither of which are related to this ticket: \n\n1. the numerical failures on this machine\n2. the failure of `gsl` to build with homebrew's `gfortran` and Sage's `openblas`\n\nCould 2 be related to this message in the `openblas` log (`./configure --with-system-openblas=no`):\n\n```\nld: warning: dylib (/usr/local/Cellar/gcc/12.2.0/lib/gcc/current/libgfortran.dylib) was built for newer macOS version (12.0) than being linked (10.8)\n```",
    "created_at": "2022-09-21T22:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477311",
    "user": "https://github.com/jhpalmieri"
}
```

Now I would like to track down two issues, perhaps neither of which are related to this ticket: 

1. the numerical failures on this machine
2. the failure of `gsl` to build with homebrew's `gfortran` and Sage's `openblas`

Could 2 be related to this message in the `openblas` log (`./configure --with-system-openblas=no`):

```
ld: warning: dylib (/usr/local/Cellar/gcc/12.2.0/lib/gcc/current/libgfortran.dylib) was built for newer macOS version (12.0) than being linked (10.8)
```



---

archive/issue_comments_477312.json:
```json
{
    "body": "Could you post the failing gsl build log?",
    "created_at": "2022-09-22T00:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477312",
    "user": "https://github.com/mkoeppe"
}
```

Could you post the failing gsl build log?



---

archive/issue_comments_477313.json:
```json
{
    "body": "Attachment [gsl-2.7.1.log](tarball://root/attachments/some-uuid/ticket33816/gsl-2.7.1.log) by @jhpalmieri created at 2022-09-22 00:32:57",
    "created_at": "2022-09-22T00:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477313",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [gsl-2.7.1.log](tarball://root/attachments/some-uuid/ticket33816/gsl-2.7.1.log) by @jhpalmieri created at 2022-09-22 00:32:57



---

archive/issue_comments_477314.json:
```json
{
    "body": "Here it is.",
    "created_at": "2022-09-22T00:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477314",
    "user": "https://github.com/jhpalmieri"
}
```

Here it is.



---

archive/issue_comments_477315.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-22T00:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477315",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477316.json:
```json
{
    "body": "Try with this please",
    "created_at": "2022-09-22T00:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477316",
    "user": "https://github.com/mkoeppe"
}
```

Try with this please



---

archive/issue_comments_477317.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-22T01:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477317",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477318.json:
```json
{
    "body": "This works, thank you.",
    "created_at": "2022-09-22T03:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477318",
    "user": "https://github.com/jhpalmieri"
}
```

This works, thank you.



---

archive/issue_comments_477319.json:
```json
{
    "body": "Works well: with each of: `--with-system-gfortran=no`, `--with-system-openblas=no`, `--with-system-gsl=no`, `gsl` builds and passes its test suite on an Intel machine and on an m2 machine. With at least one of those options I also did `make ptestlong` and everything passed.",
    "created_at": "2022-09-22T04:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477319",
    "user": "https://github.com/jhpalmieri"
}
```

Works well: with each of: `--with-system-gfortran=no`, `--with-system-openblas=no`, `--with-system-gsl=no`, `gsl` builds and passes its test suite on an Intel machine and on an m2 machine. With at least one of those options I also did `make ptestlong` and everything passed.



---

archive/issue_comments_477320.json:
```json
{
    "body": "Matthias, what's your assessment of the testing via GH Actions?",
    "created_at": "2022-09-22T18:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477320",
    "user": "https://github.com/jhpalmieri"
}
```

Matthias, what's your assessment of the testing via GH Actions?



---

archive/issue_comments_477321.json:
```json
{
    "body": "The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named \"minimal-pre\", which builds all non-Python packages. They have succeeded for all supported platforms.\n(Commit 07d2dcb fixes a mistake I made in #34266 - I had forgotten to remove one outdated 32-bit platform and forgot to update another to use GCC 8. These two show up as failing in the GH Actions run.)\n\nUnfortunately, the 2nd build stage (\"minimal\"), which builds the Python packages and the documentation, and runs \"make ptest\", has not started to run yet (I think because of general GH Actions flakiness).\n\nI'll test the 2nd stage either manually or on a separate GH Actions run later today.",
    "created_at": "2022-09-22T19:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477321",
    "user": "https://github.com/mkoeppe"
}
```

The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named "minimal-pre", which builds all non-Python packages. They have succeeded for all supported platforms.
(Commit 07d2dcb fixes a mistake I made in #34266 - I had forgotten to remove one outdated 32-bit platform and forgot to update another to use GCC 8. These two show up as failing in the GH Actions run.)

Unfortunately, the 2nd build stage ("minimal"), which builds the Python packages and the documentation, and runs "make ptest", has not started to run yet (I think because of general GH Actions flakiness).

I'll test the 2nd stage either manually or on a separate GH Actions run later today.



---

archive/issue_comments_477322.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-22T19:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477322",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477323.json:
```json
{
    "body": "Replying to [comment:53 Matthias K\u00f6ppe]:\n> Unfortunately, the 2nd build stage (\"minimal\") [...] has not started to run yet (I think because of general GH Actions flakiness).\n\n\nActually, a typo was the cause. Fixed now",
    "created_at": "2022-09-22T19:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477323",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:53 Matthias Köppe]:
> Unfortunately, the 2nd build stage ("minimal") [...] has not started to run yet (I think because of general GH Actions flakiness).


Actually, a typo was the cause. Fixed now



---

archive/issue_comments_477324.json:
```json
{
    "body": "2nd stage running now at https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542",
    "created_at": "2022-09-22T19:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477324",
    "user": "https://github.com/mkoeppe"
}
```

2nd stage running now at https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542



---

archive/issue_comments_477325.json:
```json
{
    "body": "Replying to [comment:53 Matthias K\u00f6ppe]:\n> The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named \"minimal-pre\", which builds all non-Python packages. They have succeeded for all supported platforms.\n\n\n(although 4 timed out)",
    "created_at": "2022-09-22T19:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477325",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:53 Matthias Köppe]:
> The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named "minimal-pre", which builds all non-Python packages. They have succeeded for all supported platforms.


(although 4 timed out)



---

archive/issue_comments_477326.json:
```json
{
    "body": "There are some failures, I'll have to investigate what's going on there.",
    "created_at": "2022-09-22T22:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477326",
    "user": "https://github.com/mkoeppe"
}
```

There are some failures, I'll have to investigate what's going on there.



---

archive/issue_comments_477327.json:
```json
{
    "body": "Looks like the failures are only due to a flaw in my new 2-stage workflow, related to the use of `-arch=native`. For example, looking into the config.log of the failing `fflas_ffpack` package on `fedora-35-minimal` https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036948018, one sees:\n\n```\nconfigure:18251: checking for use of MKL\nconfigure:18268: result: no \nconfigure:18288: checking for BLAS\nconfigure:18304: g++ -std=gnu++11 -o conftest -g -O2   -I. -I.. -I. -I./fflas-ffpack -fabi-version=6   -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib  conftest.cpp  -lopenblas  >&5\nconfigure:18304: $? = 0\nconfigure:18304: ./conftest\n./configure: line 1735: 100961 Illegal instruction     (core dumped) ./conftest$ac_exeext\n```",
    "created_at": "2022-09-23T00:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477327",
    "user": "https://github.com/mkoeppe"
}
```

Looks like the failures are only due to a flaw in my new 2-stage workflow, related to the use of `-arch=native`. For example, looking into the config.log of the failing `fflas_ffpack` package on `fedora-35-minimal` https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036948018, one sees:

```
configure:18251: checking for use of MKL
configure:18268: result: no 
configure:18288: checking for BLAS
configure:18304: g++ -std=gnu++11 -o conftest -g -O2   -I. -I.. -I. -I./fflas-ffpack -fabi-version=6   -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib  conftest.cpp  -lopenblas  >&5
configure:18304: $? = 0
configure:18304: ./conftest
./configure: line 1735: 100961 Illegal instruction     (core dumped) ./conftest$ac_exeext
```



---

archive/issue_comments_477328.json:
```json
{
    "body": "I've opened #34572 to improve this.",
    "created_at": "2022-09-23T00:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477328",
    "user": "https://github.com/mkoeppe"
}
```

I've opened #34572 to improve this.



---

archive/issue_comments_477329.json:
```json
{
    "body": "Do we need to test on OS X pre-Monterey? Otherwise, I'm ready to give this a positive review, at least from the OS X point of view.",
    "created_at": "2022-09-23T02:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477329",
    "user": "https://github.com/jhpalmieri"
}
```

Do we need to test on OS X pre-Monterey? Otherwise, I'm ready to give this a positive review, at least from the OS X point of view.



---

archive/issue_comments_477330.json:
```json
{
    "body": "A test on Catalina (10.15) ran at https://github.com/mkoeppe/sage/actions/runs/3094982845/jobs/5008934048, looks OK",
    "created_at": "2022-09-23T05:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477330",
    "user": "https://github.com/mkoeppe"
}
```

A test on Catalina (10.15) ran at https://github.com/mkoeppe/sage/actions/runs/3094982845/jobs/5008934048, looks OK



---

archive/issue_comments_477331.json:
```json
{
    "body": "I've manually tested `tox -e docker-fedora-35-minimal` (also ran `make ptest`), also fine. \n\nI've also tested `EXTRA_CONFIGURE_ARGS=--without-system-gfortran tox -e docker-ubuntu-trusty-toolchain-gcc_9-minimal`, a bit of an usual configuration, which has a failure in `src/sage/misc/inline_fortran.py`, but I don't think this is important enough to investigate more",
    "created_at": "2022-09-23T05:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477331",
    "user": "https://github.com/mkoeppe"
}
```

I've manually tested `tox -e docker-fedora-35-minimal` (also ran `make ptest`), also fine. 

I've also tested `EXTRA_CONFIGURE_ARGS=--without-system-gfortran tox -e docker-ubuntu-trusty-toolchain-gcc_9-minimal`, a bit of an usual configuration, which has a failure in `src/sage/misc/inline_fortran.py`, but I don't think this is important enough to investigate more



---

archive/issue_comments_477332.json:
```json
{
    "body": "So I think this is ready to go",
    "created_at": "2022-09-23T05:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477332",
    "user": "https://github.com/mkoeppe"
}
```

So I think this is ready to go



---

archive/issue_comments_477333.json:
```json
{
    "body": "Okay, let's merge it early in this release cycle, not that too many people are building our `gfortran` anyway...",
    "created_at": "2022-09-23T05:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477333",
    "user": "https://github.com/jhpalmieri"
}
```

Okay, let's merge it early in this release cycle, not that too many people are building our `gfortran` anyway...



---

archive/issue_comments_477334.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-23T05:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477334",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_477335.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-09-23T05:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477335",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_comments_477336.json:
```json
{
    "body": "Full run: http://build.sagemath.org/#/builders/15/builds/5\n\nFlint testsuite dies on the kucalc buildbot (Ubuntu 16.04.5 LTS)\n\n```\ngcc -g -O2 -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src/build -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include test_helpers.o test/t-sdiv_qrnnd.c -o build/test/t-sdiv_qrnnd -L/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -lflint -lmpfr -lgmp -lm -lntl -lpthread  -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib  -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src\n(WANTDEPS=1; export WANTDEPS; BUILD_DIR=build; export BUILD_DIR; make -f Makefile.subdirs -C . check || exit $?;)\nsub_dddmmmsss....invert_limb....udiv_qrnnd....add_ssssaaaaaaaa....byte_swap....umul_ppmm....add_ssaaaa....add_sssaaaaaa....udiv_qrnnd_preinv....PASS\nsmul_ppmm....count_leading_zeros....count_trailing_zeros....PASS\nsub_ddmmss....PASS\nsdiv_qrnnd....PASS\nPASS\nPASS\nMakefile.subdirs:107: recipe for target 'build/test/t-sdiv_qrnnd_RUN' failed\nmake[6]: *** [build/test/t-sdiv_qrnnd_RUN] Floating point exception (core dumped)\nPASS\nPASS\nPASS\nPASS\nPASS\nPASS\nPASS\nmake[6]: Target 'check' not remade because of errors.\nMakefile:219: recipe for target 'check' failed\nmake[5]: *** [check] Error 2\n```",
    "created_at": "2022-09-26T22:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477336",
    "user": "https://github.com/vbraun"
}
```

Full run: http://build.sagemath.org/#/builders/15/builds/5

Flint testsuite dies on the kucalc buildbot (Ubuntu 16.04.5 LTS)

```
gcc -g -O2 -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src/build -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include test_helpers.o test/t-sdiv_qrnnd.c -o build/test/t-sdiv_qrnnd -L/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -lflint -lmpfr -lgmp -lm -lntl -lpthread  -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib  -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src
(WANTDEPS=1; export WANTDEPS; BUILD_DIR=build; export BUILD_DIR; make -f Makefile.subdirs -C . check || exit $?;)
sub_dddmmmsss....invert_limb....udiv_qrnnd....add_ssssaaaaaaaa....byte_swap....umul_ppmm....add_ssaaaa....add_sssaaaaaa....udiv_qrnnd_preinv....PASS
smul_ppmm....count_leading_zeros....count_trailing_zeros....PASS
sub_ddmmss....PASS
sdiv_qrnnd....PASS
PASS
PASS
Makefile.subdirs:107: recipe for target 'build/test/t-sdiv_qrnnd_RUN' failed
make[6]: *** [build/test/t-sdiv_qrnnd_RUN] Floating point exception (core dumped)
PASS
PASS
PASS
PASS
PASS
PASS
PASS
make[6]: Target 'check' not remade because of errors.
Makefile:219: recipe for target 'check' failed
make[5]: *** [check] Error 2
```



---

archive/issue_comments_477337.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-09-26T22:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477337",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_477338.json:
```json
{
    "body": "Our web page https://trac.sagemath.org/wiki/ReleaseTours/sage-9.8#Configurationchanges says \"Users of older Linux distributions (in particular, ubuntu-xenial or older, debian-stretch or older, linuxmint-18 or older) should upgrade their systems before attempting to install Sage from source.\" So does a test failure on Ubuntu 16.04 matter?",
    "created_at": "2022-09-26T22:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477338",
    "user": "https://github.com/jhpalmieri"
}
```

Our web page https://trac.sagemath.org/wiki/ReleaseTours/sage-9.8#Configurationchanges says "Users of older Linux distributions (in particular, ubuntu-xenial or older, debian-stretch or older, linuxmint-18 or older) should upgrade their systems before attempting to install Sage from source." So does a test failure on Ubuntu 16.04 matter?



---

archive/issue_comments_477339.json:
```json
{
    "body": "Yes, I think this buildbot should be updated to a supported configuration, for example using https://askubuntu.com/questions/1140183/install-gcc-9-on-ubuntu-18-04/1149383#1149383",
    "created_at": "2022-09-27T00:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477339",
    "user": "https://github.com/mkoeppe"
}
```

Yes, I think this buildbot should be updated to a supported configuration, for example using https://askubuntu.com/questions/1140183/install-gcc-9-on-ubuntu-18-04/1149383#1149383



---

archive/issue_comments_477340.json:
```json
{
    "body": "So do we just set this back to positive, or does someone have to do something with the buildbot first?",
    "created_at": "2022-10-12T18:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477340",
    "user": "https://github.com/jhpalmieri"
}
```

So do we just set this back to positive, or does someone have to do something with the buildbot first?



---

archive/issue_comments_477341.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-10-13T02:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477341",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_477342.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-10-17T22:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33579#issuecomment-477342",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_088801.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-17T22:44:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33579",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33579#event-88801"
}
```
