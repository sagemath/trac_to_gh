# Issue 33100: is_positive_definite returns wrong results

archive/issues_032863.json:
```json
{
    "assignees": [],
    "body": "For some double dense matrices that are not positive definite, Sage incorrectly claims that they are:\n\n    ```\n    sage: A = matrix(CDF, [[1+I]])\n    sage: A.is_positive_definite()  # should be False\n    True\n    sage: A.is_positive_semidefinite()  # correct\n    False\n    ```\n\nClearly, `A` is not even Hermitian. The implementation relies on testing whether a Cholesky decomposition exists or not, but `.cholesky()` gives an incorrect result for this matrix\n\n    ```\n    sage: A.cholesky()\n    [1.0]\n    ```\n\nwhile for most other matrices this would raise an error.\n\nThe [SciPy documentation](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html) is not entirely clear about this, but it seems that SciPy assumes that the matrix is already Hermitian positive-definite and thus only considers half the matrix (see [SciPy issues 2116](https://github.com/scipy/scipy/issues/2116#issuecomment-990487066) and [15012](https://github.com/scipy/scipy/issues/15012)).\n\nThis ticket adds a check whether the matrix is Hermitian before computing the Cholesky decomposition, which resolves the problem. The default algorithm for `is_hermitian` is changed from \"orthonormal\" to \"naive\".\n\nDepends on #33107\n\nCC:  @orlitzky\n\nBranch/Commit: **[`1d6bae6`](https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44)**\n\nReviewer: **Markus Wageringel**\n\nAuthor: **Michael Orlitzky**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33100_\n\n",
    "closed_at": "2022-02-21T21:56:25Z",
    "created_at": "2021-12-31T16:05:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "is_positive_definite returns wrong results",
    "type": "issue",
    "updated_at": "2022-02-21T21:56:25Z",
    "url": "https://github.com/sagemath/sage/issues/33100",
    "user": "https://github.com/mwageringel"
}
```
For some double dense matrices that are not positive definite, Sage incorrectly claims that they are:

    ```
    sage: A = matrix(CDF, [[1+I]])
    sage: A.is_positive_definite()  # should be False
    True
    sage: A.is_positive_semidefinite()  # correct
    False
    ```

Clearly, `A` is not even Hermitian. The implementation relies on testing whether a Cholesky decomposition exists or not, but `.cholesky()` gives an incorrect result for this matrix

    ```
    sage: A.cholesky()
    [1.0]
    ```

while for most other matrices this would raise an error.

The [SciPy documentation](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html) is not entirely clear about this, but it seems that SciPy assumes that the matrix is already Hermitian positive-definite and thus only considers half the matrix (see [SciPy issues 2116](https://github.com/scipy/scipy/issues/2116#issuecomment-990487066) and [15012](https://github.com/scipy/scipy/issues/15012)).

This ticket adds a check whether the matrix is Hermitian before computing the Cholesky decomposition, which resolves the problem. The default algorithm for `is_hermitian` is changed from "orthonormal" to "naive".

Depends on #33107

CC:  @orlitzky

Branch/Commit: **[`1d6bae6`](https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44)**

Reviewer: **Markus Wageringel**

Author: **Michael Orlitzky**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/33100_





---

archive/issue_events_455452.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2021-12-31T16:05:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455452"
}
```



---

archive/issue_events_455453.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2021-12-31T16:05:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455453"
}
```



---

archive/issue_events_455454.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2021-12-31T16:05:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455454"
}
```



---

archive/issue_events_455455.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2021-12-31T16:05:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455455"
}
```



---

archive/issue_comments_534730.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis also fails for larger matrices, such as these linear combinations of positive definite matrices (for many seeds):\n\n```\nsage: set_random_seed(0)\nsage: random_pd_matrix = lambda n: (B := matrix.random(CDF, n)) * B.H\nsage: r = 2  # 2 or larger\nsage: n = 3  # 1 or larger\nsage: As = [random_pd_matrix(n) for j in range(r)]\nsage: C = random_pd_matrix(r)\nsage: A = sum(sum(C[i,j] for i in range(r)) * As[j] for j in range(r))\nsage: A.is_positive_definite()  # should usually be False\nTrue\nsage: A.is_positive_semidefinite()  # correct, but pd would imply psd\nFalse\nsage: A.is_hermitian(tol=1e-6)  # correct, but pd would imply Hermitian\nFalse\n```",
    "created_at": "2021-12-31T16:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534730",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:1" align="right">comment:1</div>

This also fails for larger matrices, such as these linear combinations of positive definite matrices (for many seeds):

```
sage: set_random_seed(0)
sage: random_pd_matrix = lambda n: (B := matrix.random(CDF, n)) * B.H
sage: r = 2  # 2 or larger
sage: n = 3  # 1 or larger
sage: As = [random_pd_matrix(n) for j in range(r)]
sage: C = random_pd_matrix(r)
sage: A = sum(sum(C[i,j] for i in range(r)) * As[j] for j in range(r))
sage: A.is_positive_definite()  # should usually be False
True
sage: A.is_positive_semidefinite()  # correct, but pd would imply psd
False
sage: A.is_hermitian(tol=1e-6)  # correct, but pd would imply Hermitian
False
```



---

archive/issue_comments_534731.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nMy first thought was that we should be able to delete `cholesky()` and `is_positive_definite()` in the subclass to obtain something possibly slower, but that actually works. There are two small problems though.\n\nFirst, the generic `cholesky()` doesn't work on the trivial matrix, breaking one doctest (#33107). This is an easy fix.\n\nSecond, the subclass implementation of `is_hermitian()` used by the superclass's `is_cholesky()` doesn't work out-of-the box. For example,\n\n```\nsage: M = matrix(RDF,[[ 1,  1,    1,     1,     1],                 \n....:                 [ 1,  5,   31,   121,   341],                 \n....:                 [ 1, 31,  341,  1555,  4681],                 \n....:                 [ 1,121, 1555,  7381, 22621],                 \n....:                 [ 1,341, 4681, 22621, 69905]])\nM.is_hermitian(algorithm='orthonormal') # the default\nFalse\n```\n\nwhile\n\n```\nsage: M.is_hermitian(algorithm='orthonormal', tol=1e-10)\nTrue\n```\n\nor\n\n```\nsage: M.is_hermitian(algorithm='naive')\nTrue\n```\n\nWe'd have to either tweak the default tolerance there, or again maybe just delete the subclass method. The \"naive\" algorithm now defers to a superclass implementation where the default tolerance works.",
    "created_at": "2022-01-02T15:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534731",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:2" align="right">comment:2</div>

My first thought was that we should be able to delete `cholesky()` and `is_positive_definite()` in the subclass to obtain something possibly slower, but that actually works. There are two small problems though.

First, the generic `cholesky()` doesn't work on the trivial matrix, breaking one doctest (#33107). This is an easy fix.

Second, the subclass implementation of `is_hermitian()` used by the superclass's `is_cholesky()` doesn't work out-of-the box. For example,

```
sage: M = matrix(RDF,[[ 1,  1,    1,     1,     1],                 
....:                 [ 1,  5,   31,   121,   341],                 
....:                 [ 1, 31,  341,  1555,  4681],                 
....:                 [ 1,121, 1555,  7381, 22621],                 
....:                 [ 1,341, 4681, 22621, 69905]])
M.is_hermitian(algorithm='orthonormal') # the default
False
```

while

```
sage: M.is_hermitian(algorithm='orthonormal', tol=1e-10)
True
```

or

```
sage: M.is_hermitian(algorithm='naive')
True
```

We'd have to either tweak the default tolerance there, or again maybe just delete the subclass method. The "naive" algorithm now defers to a superclass implementation where the default tolerance works.



---

archive/issue_comments_534732.json:
```json
{
    "body": "Dependencies: **#33107**",
    "created_at": "2022-01-03T16:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534732",
    "user": "https://github.com/orlitzky"
}
```

Dependencies: **#33107**



---

archive/issue_comments_534733.json:
```json
{
    "body": "Commit: **[`c70330b`](https://github.com/sagemath/sagetrac-mirror/commit/c70330b82b1e38dc4ee8a1c9e1f62045810afeb6)**",
    "created_at": "2022-01-03T16:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534733",
    "user": "https://github.com/orlitzky"
}
```

Commit: **[`c70330b`](https://github.com/sagemath/sagetrac-mirror/commit/c70330b82b1e38dc4ee8a1c9e1f62045810afeb6)**



---

archive/issue_comments_534734.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nRather than remove the subclass `is_hermitian()`, I've only switched its default to the \"naive\" algorithm. (But note that I don't think it's any more naive than \"orthonormal\"). Afterwards, eliminating `cholesky()` and `is_positive_definite()` from the subclass allows the superclass methods to return the correct result.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89c46c64dce40c074c45a29f6def75c43e819c5e\"><code>89c46c6</code></a></td><td><code>Trac #33107: cholesky() for trivial matrices.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38c86e5907b365436a7926437bdaefee84dffd2f\"><code>38c86e5</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to \"naive\".</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f6e4b64b9e951cc25deb1eebeac1db29b1dbdabb\"><code>f6e4b64</code></a></td><td><code>Trac #33100: drop special RDF/CDF cholesky() and is_positive_definite().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c70330b82b1e38dc4ee8a1c9e1f62045810afeb6\"><code>c70330b</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr></table>\n",
    "created_at": "2022-01-03T16:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534734",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:3" align="right">comment:3</div>

Rather than remove the subclass `is_hermitian()`, I've only switched its default to the "naive" algorithm. (But note that I don't think it's any more naive than "orthonormal"). Afterwards, eliminating `cholesky()` and `is_positive_definite()` from the subclass allows the superclass methods to return the correct result.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89c46c64dce40c074c45a29f6def75c43e819c5e"><code>89c46c6</code></a></td><td><code>Trac #33107: cholesky() for trivial matrices.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38c86e5907b365436a7926437bdaefee84dffd2f"><code>38c86e5</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to "naive".</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f6e4b64b9e951cc25deb1eebeac1db29b1dbdabb"><code>f6e4b64</code></a></td><td><code>Trac #33100: drop special RDF/CDF cholesky() and is_positive_definite().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c70330b82b1e38dc4ee8a1c9e1f62045810afeb6"><code>c70330b</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr></table>




---

archive/issue_events_455456.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2022-01-03T16:24:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455456"
}
```



---

archive/issue_comments_534735.json:
```json
{
    "body": "Author: **Michael Orlitzky**",
    "created_at": "2022-01-03T16:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534735",
    "user": "https://github.com/orlitzky"
}
```

Author: **Michael Orlitzky**



---

archive/issue_comments_534736.json:
```json
{
    "body": "Branch: **[u/mjo/ticket/33100](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/33100)**",
    "created_at": "2022-01-03T16:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534736",
    "user": "https://github.com/orlitzky"
}
```

Branch: **[u/mjo/ticket/33100](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/33100)**



---

archive/issue_comments_534737.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI agree with using the \"naive\" algorithm here and do not see why it would be more naive/less appropriate than the \"orthonormal\" one. For the orthonormal algorithm, no tolerance would be large enough to work for all such matrices that are Hermitian in an exact sense, when considered entrywise. Scipy 1.8.0 will also have a function [scipy.linalg.ishermitian](https://scipy.github.io/devdocs/reference/generated/scipy.linalg.ishermitian.html) which works like the naive algorithm, i.e. entrywise.\n\nReplying to [@orlitzky](#comment:2):\n> My first thought was that we should be able to delete `cholesky()` and `is_positive_definite()` in the subclass to obtain something possibly slower, but that actually works.\n\nI am a bit hesitant to replace a Scipy implementation by a pure Sage implementation. Upstream has confirmed [here](https://github.com/scipy/scipy/issues/2116#issuecomment-1003690573) that `scipy.linalg.cholesky` essentially first constructs a Hermitian matrix by only considering the given triangular information of the matrix, ignoring the other half. So if we first check whether the matrix is Hermitian in `.cholesky()`, we will obtain a valid Cholesky decomposition.\n\nThis would make `is_positive_definite` work as intended by the implementation. Though, it would in most cases produce the same result as `is_positive_semidefinite`, as a Cholesky decomposition can exist for semidefinite matrices, but for matrices that are actually singular this can easily fail. Is there an intended difference between these methods? Perhaps debatable, but from a usage point of view I would expect something like\n- `is_positive_definite` = all eigenvalues strictly positive (or `> tolerance`)\n- `is_positive_semidefinite` = all eigenvalues `> -tolerance`\n(implemented in a numerically sane way).",
    "created_at": "2022-01-03T16:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534737",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:4" align="right">comment:4</div>

I agree with using the "naive" algorithm here and do not see why it would be more naive/less appropriate than the "orthonormal" one. For the orthonormal algorithm, no tolerance would be large enough to work for all such matrices that are Hermitian in an exact sense, when considered entrywise. Scipy 1.8.0 will also have a function [scipy.linalg.ishermitian](https://scipy.github.io/devdocs/reference/generated/scipy.linalg.ishermitian.html) which works like the naive algorithm, i.e. entrywise.

Replying to [@orlitzky](#comment:2):
> My first thought was that we should be able to delete `cholesky()` and `is_positive_definite()` in the subclass to obtain something possibly slower, but that actually works.

I am a bit hesitant to replace a Scipy implementation by a pure Sage implementation. Upstream has confirmed [here](https://github.com/scipy/scipy/issues/2116#issuecomment-1003690573) that `scipy.linalg.cholesky` essentially first constructs a Hermitian matrix by only considering the given triangular information of the matrix, ignoring the other half. So if we first check whether the matrix is Hermitian in `.cholesky()`, we will obtain a valid Cholesky decomposition.

This would make `is_positive_definite` work as intended by the implementation. Though, it would in most cases produce the same result as `is_positive_semidefinite`, as a Cholesky decomposition can exist for semidefinite matrices, but for matrices that are actually singular this can easily fail. Is there an intended difference between these methods? Perhaps debatable, but from a usage point of view I would expect something like
- `is_positive_definite` = all eigenvalues strictly positive (or `> tolerance`)
- `is_positive_semidefinite` = all eigenvalues `> -tolerance`
(implemented in a numerically sane way).



---

archive/issue_comments_534738.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@mwageringel](#comment:4):\n> I agree with using the \"naive\" algorithm here and do not see why it would be more naive/less appropriate than the \"orthonormal\" one. For the orthonormal algorithm, no tolerance would be large enough to work for all such matrices that are Hermitian in an exact sense, when considered entrywise. Scipy 1.8.0 will also have a function [scipy.linalg.ishermitian](https://scipy.github.io/devdocs/reference/generated/scipy.linalg.ishermitian.html) which works like the naive algorithm, i.e. entrywise.\n> \n> Replying to [@orlitzky](#comment:2):\n> > My first thought was that we should be able to delete `cholesky()` and `is_positive_definite()` in the subclass to obtain something possibly slower, but that actually works.\n\n> \n> I am a bit hesitant to replace a Scipy implementation by a pure Sage implementation. Upstream has confirmed [here](https://github.com/scipy/scipy/issues/2116#issuecomment-1003690573) that `scipy.linalg.cholesky` essentially first constructs a Hermitian matrix by only considering the given triangular information of the matrix, ignoring the other half. So if we first check whether the matrix is Hermitian in `.cholesky()`, we will obtain a valid Cholesky decomposition.\n\nYeah, the subclass should be doing that anyway, since the superclass does it. (Users shouldn't see different qualitative behaviors from a method when you change the underlying representation of the matrix's entries.) I haven't checked but scipy is almost certainly faster even though I did my best to make it fast in sage. On the other hand, it's nice not to have copy & pasted the entire method's documentation.\n\n> This would make `is_positive_definite` work as intended by the implementation. Though, it would in most cases produce the same result as `is_positive_semidefinite`, as a Cholesky decomposition can exist for semidefinite matrices, but for matrices that are actually singular this can easily fail. Is there an intended difference between these methods? Perhaps debatable, but from a usage point of view I would expect something like\n> - `is_positive_definite` = all eigenvalues strictly positive (or `> tolerance`)\n> - `is_positive_semidefinite` = all eigenvalues `> -tolerance`\n> (implemented in a numerically sane way).\n\nThe superclass `cholesky()` and `is_*definite()` methods support both exact and inexact rings in a numerically stable way (caveat: `is_hermitian()` itself is not yet reliable, that's #33053) via `block_ldlt()`. For inexact rings, positive-definite and positive-semidefinite are indeed basically the same up to machine precision, but the tests use `> 0` and `>= 0`.",
    "created_at": "2022-01-03T17:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534738",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@mwageringel](#comment:4):
> I agree with using the "naive" algorithm here and do not see why it would be more naive/less appropriate than the "orthonormal" one. For the orthonormal algorithm, no tolerance would be large enough to work for all such matrices that are Hermitian in an exact sense, when considered entrywise. Scipy 1.8.0 will also have a function [scipy.linalg.ishermitian](https://scipy.github.io/devdocs/reference/generated/scipy.linalg.ishermitian.html) which works like the naive algorithm, i.e. entrywise.
> 
> Replying to [@orlitzky](#comment:2):
> > My first thought was that we should be able to delete `cholesky()` and `is_positive_definite()` in the subclass to obtain something possibly slower, but that actually works.

> 
> I am a bit hesitant to replace a Scipy implementation by a pure Sage implementation. Upstream has confirmed [here](https://github.com/scipy/scipy/issues/2116#issuecomment-1003690573) that `scipy.linalg.cholesky` essentially first constructs a Hermitian matrix by only considering the given triangular information of the matrix, ignoring the other half. So if we first check whether the matrix is Hermitian in `.cholesky()`, we will obtain a valid Cholesky decomposition.

Yeah, the subclass should be doing that anyway, since the superclass does it. (Users shouldn't see different qualitative behaviors from a method when you change the underlying representation of the matrix's entries.) I haven't checked but scipy is almost certainly faster even though I did my best to make it fast in sage. On the other hand, it's nice not to have copy & pasted the entire method's documentation.

> This would make `is_positive_definite` work as intended by the implementation. Though, it would in most cases produce the same result as `is_positive_semidefinite`, as a Cholesky decomposition can exist for semidefinite matrices, but for matrices that are actually singular this can easily fail. Is there an intended difference between these methods? Perhaps debatable, but from a usage point of view I would expect something like
> - `is_positive_definite` = all eigenvalues strictly positive (or `> tolerance`)
> - `is_positive_semidefinite` = all eigenvalues `> -tolerance`
> (implemented in a numerically sane way).

The superclass `cholesky()` and `is_*definite()` methods support both exact and inexact rings in a numerically stable way (caveat: `is_hermitian()` itself is not yet reliable, that's #33053) via `block_ldlt()`. For inexact rings, positive-definite and positive-semidefinite are indeed basically the same up to machine precision, but the tests use `> 0` and `>= 0`.



---

archive/issue_comments_534739.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@orlitzky](#comment:5):\n> I haven't checked but scipy is almost certainly faster even though I did my best to make it fast in sage. On the other hand, it's nice not to have copy & pasted the entire method's documentation.\n\nUnless you strongly prefer otherwise, I tend towards staying with using Scipy for the Cholesky decomposition.\n\n> The superclass `cholesky()` and `is_*definite()` methods support both exact and inexact rings in a numerically stable way (caveat: `is_hermitian()` itself is not yet reliable, that's #33053) via `block_ldlt()`. For inexact rings, positive-definite and positive-semidefinite are indeed basically the same up to machine precision, but the tests use `> 0` and `>= 0`.\n\nOk, dropping `is_positive_definite` from the subclass sounds good to me then, as then the `is_*definite` methods are at least based on the same implementation (as numerically the distinction between these methods is not so relevant).",
    "created_at": "2022-01-03T18:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534739",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@orlitzky](#comment:5):
> I haven't checked but scipy is almost certainly faster even though I did my best to make it fast in sage. On the other hand, it's nice not to have copy & pasted the entire method's documentation.

Unless you strongly prefer otherwise, I tend towards staying with using Scipy for the Cholesky decomposition.

> The superclass `cholesky()` and `is_*definite()` methods support both exact and inexact rings in a numerically stable way (caveat: `is_hermitian()` itself is not yet reliable, that's #33053) via `block_ldlt()`. For inexact rings, positive-definite and positive-semidefinite are indeed basically the same up to machine precision, but the tests use `> 0` and `>= 0`.

Ok, dropping `is_positive_definite` from the subclass sounds good to me then, as then the `is_*definite` methods are at least based on the same implementation (as numerically the distinction between these methods is not so relevant).



---

archive/issue_comments_534740.json:
```json
{
    "body": "Changed commit from **[`c70330b`](https://github.com/sagemath/sagetrac-mirror/commit/c70330b82b1e38dc4ee8a1c9e1f62045810afeb6)** to **[`2bf92ff`](https://github.com/sagemath/sagetrac-mirror/commit/2bf92ffa0f3d580f3a71ff9f82599c2bf86bd268)**",
    "created_at": "2022-01-03T19:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534740",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c70330b`](https://github.com/sagemath/sagetrac-mirror/commit/c70330b82b1e38dc4ee8a1c9e1f62045810afeb6)** to **[`2bf92ff`](https://github.com/sagemath/sagetrac-mirror/commit/2bf92ffa0f3d580f3a71ff9f82599c2bf86bd268)**



---

archive/issue_comments_534741.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64d90284660e19f486fd7b6d44f2dcf528b778fc\"><code>64d9028</code></a></td><td><code>Trac #33107: return immutable trivial Cholesky factors.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f8abd61f836c1008f4b066f72f3c5edcd798fdec\"><code>f8abd61</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to \"naive\".</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5b681ae359a317406740cd98e439583c832c4cd\"><code>e5b681a</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2bf92ffa0f3d580f3a71ff9f82599c2bf86bd268\"><code>2bf92ff</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr></table>\n",
    "created_at": "2022-01-03T19:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534741",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64d90284660e19f486fd7b6d44f2dcf528b778fc"><code>64d9028</code></a></td><td><code>Trac #33107: return immutable trivial Cholesky factors.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f8abd61f836c1008f4b066f72f3c5edcd798fdec"><code>f8abd61</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to "naive".</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5b681ae359a317406740cd98e439583c832c4cd"><code>e5b681a</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2bf92ffa0f3d580f3a71ff9f82599c2bf86bd268"><code>2bf92ff</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr></table>




---

archive/issue_comments_534742.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI left `is_positive_definite()` alone because `cholesky()` and `is_positive_definite()` cache one another in the subclass. Using the superclass for `is_positive_definite()` would cache a `block_ldlt()` factorization, but then it would not be used for `cholesky()`.",
    "created_at": "2022-01-03T19:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534742",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:8" align="right">comment:8</div>

I left `is_positive_definite()` alone because `cholesky()` and `is_positive_definite()` cache one another in the subclass. Using the superclass for `is_positive_definite()` would cache a `block_ldlt()` factorization, but then it would not be used for `cholesky()`.



---

archive/issue_events_455457.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-01-04T11:35:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455457"
}
```



---

archive/issue_events_455458.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-01-04T11:35:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455458"
}
```



---

archive/issue_comments_534743.json:
```json
{
    "body": "Reviewer: **Markus Wageringel**",
    "created_at": "2022-01-04T11:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534743",
    "user": "https://github.com/mwageringel"
}
```

Reviewer: **Markus Wageringel**



---

archive/issue_comments_534744.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOk, this looks good to me then. Thank you for implementing this.",
    "created_at": "2022-01-04T11:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534744",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:9" align="right">comment:9</div>

Ok, this looks good to me then. Thank you for implementing this.



---

archive/issue_comments_534745.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,5 +17,6 @@\n \n while for most other matrices this would raise an error.\n \n-The [SciPy documentation](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html) is not entirely clear about this, but it seems that SciPy assumes that the matrix is already Hermitian positive-definite and thus only considers half the matrix (see [SciPy issues 2116](https://github.com/scipy/scipy/issues/2116#issuecomment-990487066) and [15012](https://github.com/scipy/scipy/issues/15012)). Therefore, Sage needs to check at least whether the matrix is Hermitian before calling `scipy.linalg.cholesky`, but it is not clear from the Scipy documentation whether that is enough to determine positive-definiteness.\n+The [SciPy documentation](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html) is not entirely clear about this, but it seems that SciPy assumes that the matrix is already Hermitian positive-definite and thus only considers half the matrix (see [SciPy issues 2116](https://github.com/scipy/scipy/issues/2116#issuecomment-990487066) and [15012](https://github.com/scipy/scipy/issues/15012)).\n \n+This ticket adds a check whether the matrix is Hermitian before computing the Cholesky decomposition, which resolves the problem. The default algorithm for `is_hermitian` is changed from \"orthonormal\" to \"naive\".\n``````\n",
    "created_at": "2022-01-04T11:39:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534745",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,5 +17,6 @@
 
 while for most other matrices this would raise an error.
 
-The [SciPy documentation](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html) is not entirely clear about this, but it seems that SciPy assumes that the matrix is already Hermitian positive-definite and thus only considers half the matrix (see [SciPy issues 2116](https://github.com/scipy/scipy/issues/2116#issuecomment-990487066) and [15012](https://github.com/scipy/scipy/issues/15012)). Therefore, Sage needs to check at least whether the matrix is Hermitian before calling `scipy.linalg.cholesky`, but it is not clear from the Scipy documentation whether that is enough to determine positive-definiteness.
+The [SciPy documentation](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html) is not entirely clear about this, but it seems that SciPy assumes that the matrix is already Hermitian positive-definite and thus only considers half the matrix (see [SciPy issues 2116](https://github.com/scipy/scipy/issues/2116#issuecomment-990487066) and [15012](https://github.com/scipy/scipy/issues/15012)).
 
+This ticket adds a check whether the matrix is Hermitian before computing the Cholesky decomposition, which resolves the problem. The default algorithm for `is_hermitian` is changed from "orthonormal" to "naive".
``````




---

archive/issue_comments_534746.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nMerge failure on top of:\n\n429528ecd0 Trac #20343: Adding sage/plot/tikzpicture.py\n\nd3f74f63be Trac #33085: adjust dochtml label so doctests pass when html doc is not built/installed\n\nd70747d13f Trac #33094: update URLs in SPKG.rst for ECL\n\n03f57e6ad1 Trac #32922: Change parameter name\n\n1057236215 Trac #30999: expose method hyperbolicity in graphs\n\n9b4a9198e2 Trac #33035: random doctest failure in src/sage/tests/book_stein_ent.py\n\nfee8e65057 Trac #32264: Convenience syntax for quaternion ideals\n\nc2bcc90ea8 Trac #31005: Add traceback information to exceptions during docbuild\n\n3f697607e8 Trac #33159: wrong result solving equation system with symbolic matrix\n\nbf9673f1a5 Trac #33158: kRegularSequence: minimization wrong\n\n01ff471e9f Trac #33157: Issue with SR \u2192 [RC]BF conversion\n\n379c88d769 Trac #33154: random doctest failure in sage.plot.matrix_plot\n\n9fa34b02a7 Trac #33151: sage-conf_pypi does not build wheelhouse\n\nffe0b98c81 Trac #33148: fix doctest in quantum_group_gap\n\n0bf6a86003 Trac #33107: Generic cholesky() fails on the trivial matrix\n\n3b02b82340 Trac #33103: gitpod integration using Docker images from portability testing workflow\n\naf5c4c48ad Trac #33098: Add more void packages to distros/void.txt\n\n9b61187847 Trac #33096: src/tox.ini (relint): Exclude editor temp files etc.\n\n217156c781 Trac #33064: sage_docbuild: fails when cache cannot be saved\n\nc2097f4654 Trac #33039: Random doctest failure in continued_fraction_gosper\n\n53781ca1e5 Trac #33015: Random failure in number_field_element.pyx\n\n0ecfd27027 Trac #33005: Add feature for pdftocairo\n\n961f91527a Trac #32970: fix parent of 0th Bernoulli polynomial\n\n527fbc473d Trac #32877: Remove superfluous set_random_seed() calls\n\nd3aec55fe5 Trac #32873: sage.features, sage_setup: Replace use of distutils.errors by setuptools\n\n3154d1d97d Trac #32856: Get rid of \"# optional - build\"\n\nd87eeb3e7f Trac #30362: Add symplectic structures\n\n030af8db7e Trac #29865: Modularization of sagelib: Break out separate packages sagemath-objects, sagemath-categories\n\n1fed3d635c Trac #33189: Make tests pass with arb 2.22\n\n1ea6801ffb Trac #33131: Installation manual: Add decision tree, remove mention of Sage-mirror-hosted binary distributions\n\n209b71330d Trac #33101: lrslib: fix doctest in game_theory/parser.py\n\n73aa4f3e4d Trac #33077: pari-jupyter: Reinstate\n\n180b9ee2fb Trac #30933: GH Actions: Repair upload of docker images to docker.pkg.github.com\n\ne67e1ee810 Trac #8450: intermediate complex expression in real functions make many plot functions fail\n\nd03870b5f2 Trac #33206: PDF documentation links in Documentation from Jupyter notebook are broken\n\n8ea92d580a Updated [SageMath](../wiki/SageMath) version to 9.5.rc3\n\n\n\nmerge was not clean: conflicts in src/sage/matrix/matrix_double_dense.pyx",
    "created_at": "2022-01-23T23:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534746",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Merge failure on top of:

429528ecd0 Trac #20343: Adding sage/plot/tikzpicture.py

d3f74f63be Trac #33085: adjust dochtml label so doctests pass when html doc is not built/installed

d70747d13f Trac #33094: update URLs in SPKG.rst for ECL

03f57e6ad1 Trac #32922: Change parameter name

1057236215 Trac #30999: expose method hyperbolicity in graphs

9b4a9198e2 Trac #33035: random doctest failure in src/sage/tests/book_stein_ent.py

fee8e65057 Trac #32264: Convenience syntax for quaternion ideals

c2bcc90ea8 Trac #31005: Add traceback information to exceptions during docbuild

3f697607e8 Trac #33159: wrong result solving equation system with symbolic matrix

bf9673f1a5 Trac #33158: kRegularSequence: minimization wrong

01ff471e9f Trac #33157: Issue with SR → [RC]BF conversion

379c88d769 Trac #33154: random doctest failure in sage.plot.matrix_plot

9fa34b02a7 Trac #33151: sage-conf_pypi does not build wheelhouse

ffe0b98c81 Trac #33148: fix doctest in quantum_group_gap

0bf6a86003 Trac #33107: Generic cholesky() fails on the trivial matrix

3b02b82340 Trac #33103: gitpod integration using Docker images from portability testing workflow

af5c4c48ad Trac #33098: Add more void packages to distros/void.txt

9b61187847 Trac #33096: src/tox.ini (relint): Exclude editor temp files etc.

217156c781 Trac #33064: sage_docbuild: fails when cache cannot be saved

c2097f4654 Trac #33039: Random doctest failure in continued_fraction_gosper

53781ca1e5 Trac #33015: Random failure in number_field_element.pyx

0ecfd27027 Trac #33005: Add feature for pdftocairo

961f91527a Trac #32970: fix parent of 0th Bernoulli polynomial

527fbc473d Trac #32877: Remove superfluous set_random_seed() calls

d3aec55fe5 Trac #32873: sage.features, sage_setup: Replace use of distutils.errors by setuptools

3154d1d97d Trac #32856: Get rid of "# optional - build"

d87eeb3e7f Trac #30362: Add symplectic structures

030af8db7e Trac #29865: Modularization of sagelib: Break out separate packages sagemath-objects, sagemath-categories

1fed3d635c Trac #33189: Make tests pass with arb 2.22

1ea6801ffb Trac #33131: Installation manual: Add decision tree, remove mention of Sage-mirror-hosted binary distributions

209b71330d Trac #33101: lrslib: fix doctest in game_theory/parser.py

73aa4f3e4d Trac #33077: pari-jupyter: Reinstate

180b9ee2fb Trac #30933: GH Actions: Repair upload of docker images to docker.pkg.github.com

e67e1ee810 Trac #8450: intermediate complex expression in real functions make many plot functions fail

d03870b5f2 Trac #33206: PDF documentation links in Documentation from Jupyter notebook are broken

8ea92d580a Updated [SageMath](../wiki/SageMath) version to 9.5.rc3



merge was not clean: conflicts in src/sage/matrix/matrix_double_dense.pyx



---

archive/issue_events_455459.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-23T23:18:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455459"
}
```



---

archive/issue_events_455460.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-23T23:18:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455460"
}
```



---

archive/issue_comments_534747.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n(brought to you by https://github.com/sagemath/git-trac-command/pull/57)",
    "created_at": "2022-01-23T23:27:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534747",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

(brought to you by https://github.com/sagemath/git-trac-command/pull/57)



---

archive/issue_comments_534748.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nFor some reason, I did not receive an email notification for comment 11. Also, this does not seem so useful without knowing which of the three dozen tickets causes a merge conflict, so I have to wait for the new beta anyway. It would be more helpful if the CI identifies merge conflicts between positively reviewed tickets, so that one can resolve conflicts before it even gets any attention by the release manager.",
    "created_at": "2022-01-24T18:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534748",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:13" align="right">comment:13</div>

For some reason, I did not receive an email notification for comment 11. Also, this does not seem so useful without knowing which of the three dozen tickets causes a merge conflict, so I have to wait for the new beta anyway. It would be more helpful if the CI identifies merge conflicts between positively reviewed tickets, so that one can resolve conflicts before it even gets any attention by the release manager.



---

archive/issue_comments_534749.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThanks for the input! Yes, this can certainly be refined.",
    "created_at": "2022-01-24T18:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534749",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Thanks for the input! Yes, this can certainly be refined.



---

archive/issue_events_455461.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455461"
}
```



---

archive/issue_events_455462.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455462"
}
```



---

archive/issue_comments_534750.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nSet milestone to sage-9.6 after Sage 9.5 release.",
    "created_at": "2022-01-30T15:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534750",
    "user": "https://github.com/slel"
}
```

<div id="comment:15" align="right">comment:15</div>

Set milestone to sage-9.6 after Sage 9.5 release.



---

archive/issue_comments_534751.json:
```json
{
    "body": "Changed commit from **[`2bf92ff`](https://github.com/sagemath/sagetrac-mirror/commit/2bf92ffa0f3d580f3a71ff9f82599c2bf86bd268)** to **[`137da8a`](https://github.com/sagemath/sagetrac-mirror/commit/137da8ac49fe5740ba20e74687bfcb0fccff89e2)**",
    "created_at": "2022-01-31T13:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534751",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2bf92ff`](https://github.com/sagemath/sagetrac-mirror/commit/2bf92ffa0f3d580f3a71ff9f82599c2bf86bd268)** to **[`137da8a`](https://github.com/sagemath/sagetrac-mirror/commit/137da8ac49fe5740ba20e74687bfcb0fccff89e2)**



---

archive/issue_comments_534752.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1bc2c9859b22b36603e55bb7ca429a66f7ea99d\"><code>a1bc2c9</code></a></td><td><code>Trac #33107: cholesky() for trivial matrices.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab8ba9b99e7381d1c9c9e96fbcb87006eddbc24d\"><code>ab8ba9b</code></a></td><td><code>Trac #33107: return immutable trivial Cholesky factors.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7756167c249d88bc792c24efee4c09d0c8a21e65\"><code>7756167</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to \"naive\".</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2150ef7c2ef0bb28ff1f0d9f8503bb431f8a7e0\"><code>b2150ef</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d32ee083b6acb7a61101bc8a7651d18846c4646b\"><code>d32ee08</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30c5ce91102b5ab274a93d8bb393b622bf80afa0\"><code>30c5ce9</code></a></td><td><code>Trac #33100: use a more reliable abs() replacement in is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/137da8ac49fe5740ba20e74687bfcb0fccff89e2\"><code>137da8a</code></a></td><td><code>Trac #33100: allow nonpositive tolerance for RDF/CDF is_hermitian().</code></td></tr></table>\n",
    "created_at": "2022-01-31T13:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534752",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1bc2c9859b22b36603e55bb7ca429a66f7ea99d"><code>a1bc2c9</code></a></td><td><code>Trac #33107: cholesky() for trivial matrices.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab8ba9b99e7381d1c9c9e96fbcb87006eddbc24d"><code>ab8ba9b</code></a></td><td><code>Trac #33107: return immutable trivial Cholesky factors.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7756167c249d88bc792c24efee4c09d0c8a21e65"><code>7756167</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to "naive".</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2150ef7c2ef0bb28ff1f0d9f8503bb431f8a7e0"><code>b2150ef</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d32ee083b6acb7a61101bc8a7651d18846c4646b"><code>d32ee08</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30c5ce91102b5ab274a93d8bb393b622bf80afa0"><code>30c5ce9</code></a></td><td><code>Trac #33100: use a more reliable abs() replacement in is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/137da8ac49fe5740ba20e74687bfcb0fccff89e2"><code>137da8a</code></a></td><td><code>Trac #33100: allow nonpositive tolerance for RDF/CDF is_hermitian().</code></td></tr></table>




---

archive/issue_comments_534753.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n\n```diff\n-                # avoid abs() which is missing for finite fields.\n-                if d > tolerance or -d > tolerance:\n+                # abs() support is spotty\n+                if (d*d.conjugate()).sqrt() > tolerance:\n```\nI am not completely sure about theses changes. Square roots do not always exist in the same field, such as cyclotomic fields for which `sqrt` returns a result in `SR`. Granted, this probably did not work before either, as comparisons are broken in number fields (#20028).\n\nFor finite fields, the [documentation](https://github.com/sagemath/sage/blob/226937dfa9b8b335e873c3c65a796ae1b0924ff2/src/sage/rings/finite_rings/element_givaro.pyx#L1314-L1316) advises against relying on comparisons as well. Though, technically they should work in our case, i.e. if the integer representation of a finite field element is compared to a tolerance of 0.\n\nIt might be better to explicitly check whether `d` is equal to zero when the tolerance is zero.",
    "created_at": "2022-02-06T19:32:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534753",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:17" align="right">comment:17</div>


```diff
-                # avoid abs() which is missing for finite fields.
-                if d > tolerance or -d > tolerance:
+                # abs() support is spotty
+                if (d*d.conjugate()).sqrt() > tolerance:
```
I am not completely sure about theses changes. Square roots do not always exist in the same field, such as cyclotomic fields for which `sqrt` returns a result in `SR`. Granted, this probably did not work before either, as comparisons are broken in number fields (#20028).

For finite fields, the [documentation](https://github.com/sagemath/sage/blob/226937dfa9b8b335e873c3c65a796ae1b0924ff2/src/sage/rings/finite_rings/element_givaro.pyx#L1314-L1316) advises against relying on comparisons as well. Though, technically they should work in our case, i.e. if the integer representation of a finite field element is compared to a tolerance of 0.

It might be better to explicitly check whether `d` is equal to zero when the tolerance is zero.



---

archive/issue_comments_534754.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mwageringel](#comment:17):\n> I am not completely sure about theses changes. Square roots do not always exist in the same field, such as cyclotomic fields for which `sqrt` returns a result in `SR`. Granted, this probably did not work before either, as comparisons are broken in number fields (#20028).\n\nThis lurking doubt is what kept me from setting it back to needs_review right away. A priori we could square both sides to avoid roots, but I still have some questions. For the moment, a lot of this stuff is broken in corner cases anyway, so I don't feel too bad about making incremental but imperfect improvements so long as they don't hurt any existing use cases.\n\nBut for finite fields I think you're right, and I vaguely remember coming to the same conclusion. If the fields are exact, the tolerance should be zero unless you override it, and it's only by accident that the comparison works but it does work. If a tolerance is given, though, I'm not even sure what the user could expect to happen.",
    "created_at": "2022-02-06T21:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534754",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mwageringel](#comment:17):
> I am not completely sure about theses changes. Square roots do not always exist in the same field, such as cyclotomic fields for which `sqrt` returns a result in `SR`. Granted, this probably did not work before either, as comparisons are broken in number fields (#20028).

This lurking doubt is what kept me from setting it back to needs_review right away. A priori we could square both sides to avoid roots, but I still have some questions. For the moment, a lot of this stuff is broken in corner cases anyway, so I don't feel too bad about making incremental but imperfect improvements so long as they don't hurt any existing use cases.

But for finite fields I think you're right, and I vaguely remember coming to the same conclusion. If the fields are exact, the tolerance should be zero unless you override it, and it's only by accident that the comparison works but it does work. If a tolerance is given, though, I'm not even sure what the user could expect to happen.



---

archive/issue_comments_534755.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9dc1cb29f8846262fe59fa5abc2d563ada340abb\"><code>9dc1cb2</code></a></td><td><code>Trac #33107: cholesky() for trivial matrices.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cef1c9bd821d17ac4366719bd96c29ef482cb52\"><code>9cef1c9</code></a></td><td><code>Trac #33107: return immutable trivial Cholesky factors.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d36b63169b91ed98a221b4edecb1e87cbe6c429\"><code>5d36b63</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to \"naive\".</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64398303f76f1f90d59bda6e6762a3b1edc32218\"><code>6439830</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b553988225577c98f8504eb14b949f3ab831f318\"><code>b553988</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4977c4a5f4d919448c63f6778d26cd0c5a3bca9\"><code>c4977c4</code></a></td><td><code>Trac #33100: use a more reliable abs() replacement in is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5e8a0fb50611cb759fca860784e4d6d4498cea1\"><code>e5e8a0f</code></a></td><td><code>Trac #33100: allow nonpositive tolerance for RDF/CDF is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3056eea6d4e22a1e3cb342d1a78e56de5c74490a\"><code>3056eea</code></a></td><td><code>Trac #33100: more reliable tolerance tests in _is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7cac4e434eae5de489a02cf8bf1e09373773bb2d\"><code>7cac4e4</code></a></td><td><code>Trac #33100: combine sparse and dense _is_hermitian() branches.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b166f0b7f5c62f389a8ca2e0871f0390b5141470\"><code>b166f0b</code></a></td><td><code>Trac #33100: access sparse nonzero entries direcly in _is_hermitian().</code></td></tr></table>\n",
    "created_at": "2022-02-12T13:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534755",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9dc1cb29f8846262fe59fa5abc2d563ada340abb"><code>9dc1cb2</code></a></td><td><code>Trac #33107: cholesky() for trivial matrices.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cef1c9bd821d17ac4366719bd96c29ef482cb52"><code>9cef1c9</code></a></td><td><code>Trac #33107: return immutable trivial Cholesky factors.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d36b63169b91ed98a221b4edecb1e87cbe6c429"><code>5d36b63</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to "naive".</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64398303f76f1f90d59bda6e6762a3b1edc32218"><code>6439830</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b553988225577c98f8504eb14b949f3ab831f318"><code>b553988</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4977c4a5f4d919448c63f6778d26cd0c5a3bca9"><code>c4977c4</code></a></td><td><code>Trac #33100: use a more reliable abs() replacement in is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5e8a0fb50611cb759fca860784e4d6d4498cea1"><code>e5e8a0f</code></a></td><td><code>Trac #33100: allow nonpositive tolerance for RDF/CDF is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3056eea6d4e22a1e3cb342d1a78e56de5c74490a"><code>3056eea</code></a></td><td><code>Trac #33100: more reliable tolerance tests in _is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7cac4e434eae5de489a02cf8bf1e09373773bb2d"><code>7cac4e4</code></a></td><td><code>Trac #33100: combine sparse and dense _is_hermitian() branches.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b166f0b7f5c62f389a8ca2e0871f0390b5141470"><code>b166f0b</code></a></td><td><code>Trac #33100: access sparse nonzero entries direcly in _is_hermitian().</code></td></tr></table>




---

archive/issue_comments_534756.json:
```json
{
    "body": "Changed commit from **[`137da8a`](https://github.com/sagemath/sagetrac-mirror/commit/137da8ac49fe5740ba20e74687bfcb0fccff89e2)** to **[`b166f0b`](https://github.com/sagemath/sagetrac-mirror/commit/b166f0b7f5c62f389a8ca2e0871f0390b5141470)**",
    "created_at": "2022-02-12T13:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534756",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`137da8a`](https://github.com/sagemath/sagetrac-mirror/commit/137da8ac49fe5740ba20e74687bfcb0fccff89e2)** to **[`b166f0b`](https://github.com/sagemath/sagetrac-mirror/commit/b166f0b7f5c62f389a8ca2e0871f0390b5141470)**



---

archive/issue_comments_534757.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nLet's see what patchbot says about this one...",
    "created_at": "2022-02-12T13:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534757",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:20" align="right">comment:20</div>

Let's see what patchbot says about this one...



---

archive/issue_events_455463.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2022-02-12T13:02:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455463"
}
```



---

archive/issue_events_455464.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2022-02-12T13:02:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455464"
}
```



---

archive/issue_events_455465.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-02-14T21:02:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455465"
}
```



---

archive/issue_events_455466.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-02-14T21:02:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455466"
}
```



---

archive/issue_comments_534758.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThere is a merge failure, but otherwise this looks good to me, as long as the tests pass.",
    "created_at": "2022-02-14T21:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534758",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:21" align="right">comment:21</div>

There is a merge failure, but otherwise this looks good to me, as long as the tests pass.



---

archive/issue_comments_534759.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94ab5f17acbeb312811630ca8833ef2509aa5df1\"><code>94ab5f1</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to \"naive\".</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e77b84672a7ed83561c6a840949a2da467f3035\"><code>9e77b84</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1817400dd0c386c431f18929813eaf26faf3b5cb\"><code>1817400</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f9547e2b80084e9d1eaa730addafb1bf4e9292f4\"><code>f9547e2</code></a></td><td><code>Trac #33100: use a more reliable abs() replacement in is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b31a254d0f7e570fb55f12804f7ce164ae8aec1\"><code>4b31a25</code></a></td><td><code>Trac #33100: allow nonpositive tolerance for RDF/CDF is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61fb01c94baa94bc56441bf3898b43d6f3e7a5a4\"><code>61fb01c</code></a></td><td><code>Trac #33100: more reliable tolerance tests in _is_hermitian().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32d9a91fe6206dd4187acff0506e3b1b1fa932ef\"><code>32d9a91</code></a></td><td><code>Trac #33100: combine sparse and dense _is_hermitian() branches.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44\"><code>1d6bae6</code></a></td><td><code>Trac #33100: access sparse nonzero entries direcly in _is_hermitian().</code></td></tr></table>\n",
    "created_at": "2022-02-15T23:19:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534759",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94ab5f17acbeb312811630ca8833ef2509aa5df1"><code>94ab5f1</code></a></td><td><code>Trac #33100: switch default RDF/CDF is_hermitian algorithm to "naive".</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e77b84672a7ed83561c6a840949a2da467f3035"><code>9e77b84</code></a></td><td><code>Trac #33100: check is_hermitian() within cholesky() over RDF/CDF.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1817400dd0c386c431f18929813eaf26faf3b5cb"><code>1817400</code></a></td><td><code>Trac #33100: add doctests for the example on the ticket.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f9547e2b80084e9d1eaa730addafb1bf4e9292f4"><code>f9547e2</code></a></td><td><code>Trac #33100: use a more reliable abs() replacement in is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b31a254d0f7e570fb55f12804f7ce164ae8aec1"><code>4b31a25</code></a></td><td><code>Trac #33100: allow nonpositive tolerance for RDF/CDF is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61fb01c94baa94bc56441bf3898b43d6f3e7a5a4"><code>61fb01c</code></a></td><td><code>Trac #33100: more reliable tolerance tests in _is_hermitian().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32d9a91fe6206dd4187acff0506e3b1b1fa932ef"><code>32d9a91</code></a></td><td><code>Trac #33100: combine sparse and dense _is_hermitian() branches.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44"><code>1d6bae6</code></a></td><td><code>Trac #33100: access sparse nonzero entries direcly in _is_hermitian().</code></td></tr></table>




---

archive/issue_comments_534760.json:
```json
{
    "body": "Changed commit from **[`b166f0b`](https://github.com/sagemath/sagetrac-mirror/commit/b166f0b7f5c62f389a8ca2e0871f0390b5141470)** to **[`1d6bae6`](https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44)**",
    "created_at": "2022-02-15T23:19:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534760",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b166f0b`](https://github.com/sagemath/sagetrac-mirror/commit/b166f0b7f5c62f389a8ca2e0871f0390b5141470)** to **[`1d6bae6`](https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44)**



---

archive/issue_comments_534761.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIt rebased cleanly, I think I maybe it wanted me to drop the commits from #33107.",
    "created_at": "2022-02-15T23:25:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534761",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:23" align="right">comment:23</div>

It rebased cleanly, I think I maybe it wanted me to drop the commits from #33107.



---

archive/issue_events_455467.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2022-02-15T23:25:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455467"
}
```



---

archive/issue_events_455468.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2022-02-15T23:25:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455468"
}
```



---

archive/issue_events_455469.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-02-17T09:02:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455469"
}
```



---

archive/issue_events_455470.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2022-02-17T09:02:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455470"
}
```



---

archive/issue_comments_534762.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThanks.",
    "created_at": "2022-02-17T09:02:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534762",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:24" align="right">comment:24</div>

Thanks.



---

archive/issue_events_455471.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-21T21:56:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455471"
}
```



---

archive/issue_events_455472.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f456256a0aaad60cd5b93c23999eda0ab78ff7fa",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-02-21T21:56:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33100#event-455472"
}
```



---

archive/issue_comments_534763.json:
```json
{
    "body": "Changed branch from **[u/mjo/ticket/33100](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/33100)** to **[`1d6bae6`](https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44)**",
    "created_at": "2022-02-21T21:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33100",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33100#issuecomment-534763",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mjo/ticket/33100](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/33100)** to **[`1d6bae6`](https://github.com/sagemath/sagetrac-mirror/commit/1d6bae6b40af337135eb508b54744b4b177cdd44)**
