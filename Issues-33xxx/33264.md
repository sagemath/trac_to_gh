# Issue 33264: Define `x` as symbolic variable in many `animate` examples

archive/issues_033027.json:
```json
{
    "body": "The animated plots examples in the documentation at\n\n- https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html\n\ninclude an example where `x = lambda t: cos(t)`\nand `y = ...` are used for a parametric plot.\n\nMany subsequent examples fail with a type error\nif run without resetting `x` to its default value,\neither with `reset('x')` or with `x = SR.var('x')`.\n\n```\nsage: a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-...-...> in <module>\n----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)\n\n<ipython-input-...-...> in <listcomp>(.0)\n----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)\n\n.../site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:14496)()\n   2153             return coercion_model.bin_op(left, right, operator.pow)\n   2154         # left is a non-Element: do the powering with a Python int\n-> 2155         return left ** int(right)\n   2156\n   2157     cpdef _pow_(self, other):\n\nTypeError: unsupported operand type(s) for ** or pow(): 'function' and 'int'\n```\n\n```\nsage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],\n....:             xmin=0, xmax=2*pi, ymin=-1, ymax=1, figsize=[2,1])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-...> in <module>\n----> 1 a = animate([sin(x + float(k)) for ...],\n      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)\n\n<ipython-input-...> in <listcomp>(.0)\n----> 1 a = animate([sin(x + float(k)) for ...],\n      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)\n\nTypeError: unsupported operand type(s) for +: 'function' and 'float'\n```\n\n```\nsage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],\n....:                xmin=0, xmax=2*pi, figsize=[2,1])\n....:\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-...> in <module>\n----> 1 a = animate([sin(x + float(k)) for ...],\n      2                xmin=..., xmax=..., figsize=...)\n\n<ipython-input-...> in <listcomp>(.0)\n----> 1 a = animate([sin(x + float(k)) for ...],\n      2                xmin=..., xmax=..., figsize=...)\n\nTypeError: unsupported operand type(s) for +: 'function' and 'float'\n```\n\nCC:  @slel @mkoeppe\n\nKeywords: SR.var('x')\n\nBranch/Commit: e73cd12435a21f22f440bd21fff270361a1ac890\n\nReviewer: Samuel Leli\u00e8vre\n\nAuthor: Michael Orlitzky\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33264\n\n",
    "closed_at": "2022-02-16T23:57:14Z",
    "created_at": "2022-01-31T21:55:31Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Define `x` as symbolic variable in many `animate` examples",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33264",
    "user": "https://github.com/umedoblock"
}
```
The animated plots examples in the documentation at

- https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html

include an example where `x = lambda t: cos(t)`
and `y = ...` are used for a parametric plot.

Many subsequent examples fail with a type error
if run without resetting `x` to its default value,
either with `reset('x')` or with `x = SR.var('x')`.

```
sage: a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-...-...> in <module>
----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)

<ipython-input-...-...> in <listcomp>(.0)
----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)

.../site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:14496)()
   2153             return coercion_model.bin_op(left, right, operator.pow)
   2154         # left is a non-Element: do the powering with a Python int
-> 2155         return left ** int(right)
   2156
   2157     cpdef _pow_(self, other):

TypeError: unsupported operand type(s) for ** or pow(): 'function' and 'int'
```

```
sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],
....:             xmin=0, xmax=2*pi, ymin=-1, ymax=1, figsize=[2,1])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-...> in <module>
----> 1 a = animate([sin(x + float(k)) for ...],
      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)

<ipython-input-...> in <listcomp>(.0)
----> 1 a = animate([sin(x + float(k)) for ...],
      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)

TypeError: unsupported operand type(s) for +: 'function' and 'float'
```

```
sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],
....:                xmin=0, xmax=2*pi, figsize=[2,1])
....:
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-...> in <module>
----> 1 a = animate([sin(x + float(k)) for ...],
      2                xmin=..., xmax=..., figsize=...)

<ipython-input-...> in <listcomp>(.0)
----> 1 a = animate([sin(x + float(k)) for ...],
      2                xmin=..., xmax=..., figsize=...)

TypeError: unsupported operand type(s) for +: 'function' and 'float'
```

CC:  @slel @mkoeppe

Keywords: SR.var('x')

Branch/Commit: e73cd12435a21f22f440bd21fff270361a1ac890

Reviewer: Samuel Lelièvre

Author: Michael Orlitzky

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33264





---

archive/issue_comments_663642.json:
```json
{
    "body": "<a id='comment:1'></a>Did you redefine `x` before that?\n\nTry running `reset('x')` and running the examples again.",
    "created_at": "2022-02-01T12:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663642",
    "user": "https://github.com/slel"
}
```

<a id='comment:1'></a>Did you redefine `x` before that?

Try running `reset('x')` and running the examples again.



---

archive/issue_comments_663643.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2022-02-01T12:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663643",
    "user": "https://github.com/slel"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_663644.json:
```json
{
    "body": "<a id='comment:2'></a>All the examples work fine for me in a fresh Sage session\n\n- using the Sage-macOS 9.5 prerelease\n- or using Sage 9.5 final, built from source\n\nIf I first redefine `x` as a function, e.g.\n\n```\nsage: x = lambda t: t + 1\n```\nthen the failures in the ticket description arise.\n\nResetting `x` to its starting value with\n\n```\nsage: reset('x')\n```\nsolves the issues, and the examples work fine again.",
    "created_at": "2022-02-01T12:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663644",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'></a>All the examples work fine for me in a fresh Sage session

- using the Sage-macOS 9.5 prerelease
- or using Sage 9.5 final, built from source

If I first redefine `x` as a function, e.g.

```
sage: x = lambda t: t + 1
```
then the failures in the ticket description arise.

Resetting `x` to its starting value with

```
sage: reset('x')
```
solves the issues, and the examples work fine again.



---

archive/issue_comments_663645.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to graphics.",
    "created_at": "2022-02-01T12:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663645",
    "user": "https://github.com/slel"
}
```

Changing component from PLEASE CHANGE to graphics.



---

archive/issue_comments_663646.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2022-02-01T12:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663646",
    "user": "https://github.com/slel"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_663647.json:
```json
{
    "body": "<a id='comment:3'></a>This seems like user error rather than a defect in Sage.\n\nPropose to close as invalid.",
    "created_at": "2022-02-01T12:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663647",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'></a>This seems like user error rather than a defect in Sage.

Propose to close as invalid.



---

archive/issue_comments_663648.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-02-01T12:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663648",
    "user": "https://github.com/slel"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_events_087833.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-02-01T12:42:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33264#event-87833"
}
```



---

archive/issue_comments_663649.json:
```json
{
    "body": "<a id='comment:4'></a>Hello slelievre.\n\nYou said \"redefine x\" means below sentence ?\n\n```\nx = lambda t: cos(t)\n```\n\nIf it's correct, I redefined.\n\nI tried running reset('x') and running the examples again.\n\nThen TypeError disappeared.\n\nThanks slelievre.\n\nI'm a beginner of sagemath, so I have no idea how to recovery from TypeError.\n\nAnd I couldn't run below sentence.\n\n```\nreset('x')\n```\n\nI believe that all of the sagemath beginner cannot recovery from TypeError.\n\nPlease change document of \"make_image(frame, filename, **kwds)\" in [Animated plots](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html).\n\nEXAMPLES:\n\n```\nfrom sage.plot.animate import Animation\nclass MyAnimation(Animation):\n   def make_image(self, frame, filename, **kwds):\n       P = parametric_plot(frame[0], frame[1], **frame[2])\n       P.save_image(filename,**kwds)\n\nt = var('t')\n\nvvvvvvvvvvvvvvvvvvvv\nx = lambda t: cos(t)\n^^^^^^^^^^^^^^^^^^^^\n\ny = lambda n,t: sin(t)/n\nB = MyAnimation([([x(t), y(i+1,t)],(t,0,1), {'color':Color((1,0,i/4)), 'aspect_ratio':1, 'ymax':1}) for i in range(4)])\n\nd = B.png(); v = os.listdir(d); v.sort(); v  # long time\n['00000000.png', '00000001.png', '00000002.png', '00000003.png']\nB.show()  # not tested\n\nclass MyAnimation(Animation):\n   def make_image(self, frame, filename, **kwds):\n       G = frame.plot()\n\nG.set_axes_range(floor(G.xmin()),ceil(G.xmax()),floor(G.ymin()),ceil(G.ymax()))\n       G.save_image(filename, **kwds)\n\nB = MyAnimation([graphs.CompleteGraph(n) for n in range(7,11)], figsize=5)\nd = B.png()\nv = os.listdir(d); v.sort(); v\n['00000000.png', '00000001.png', '00000002.png', '00000003.png']\nB.show()  # not tested\n```",
    "created_at": "2022-02-01T16:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663649",
    "user": "https://github.com/umedoblock"
}
```

<a id='comment:4'></a>Hello slelievre.

You said "redefine x" means below sentence ?

```
x = lambda t: cos(t)
```

If it's correct, I redefined.

I tried running reset('x') and running the examples again.

Then TypeError disappeared.

Thanks slelievre.

I'm a beginner of sagemath, so I have no idea how to recovery from TypeError.

And I couldn't run below sentence.

```
reset('x')
```

I believe that all of the sagemath beginner cannot recovery from TypeError.

Please change document of "make_image(frame, filename, **kwds)" in [Animated plots](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html).

EXAMPLES:

```
from sage.plot.animate import Animation
class MyAnimation(Animation):
   def make_image(self, frame, filename, **kwds):
       P = parametric_plot(frame[0], frame[1], **frame[2])
       P.save_image(filename,**kwds)

t = var('t')

vvvvvvvvvvvvvvvvvvvv
x = lambda t: cos(t)
^^^^^^^^^^^^^^^^^^^^

y = lambda n,t: sin(t)/n
B = MyAnimation([([x(t), y(i+1,t)],(t,0,1), {'color':Color((1,0,i/4)), 'aspect_ratio':1, 'ymax':1}) for i in range(4)])

d = B.png(); v = os.listdir(d); v.sort(); v  # long time
['00000000.png', '00000001.png', '00000002.png', '00000003.png']
B.show()  # not tested

class MyAnimation(Animation):
   def make_image(self, frame, filename, **kwds):
       G = frame.plot()

G.set_axes_range(floor(G.xmin()),ceil(G.xmax()),floor(G.ymin()),ceil(G.ymax()))
       G.save_image(filename, **kwds)

B = MyAnimation([graphs.CompleteGraph(n) for n in range(7,11)], figsize=5)
d = B.png()
v = os.listdir(d); v.sort(); v
['00000000.png', '00000001.png', '00000002.png', '00000003.png']
B.show()  # not tested
```



---

archive/issue_comments_663650.json:
```json
{
    "body": "<a id='comment:5'></a>In gh-umedoblock's defense, our examples *do* rely on some implicit magic, the symbolic variable `x` being automatically defined whenever sage starts or the doctest environment resets. I would much rather see us begin them all with `x = SR.var(\"x\")` so that they're truly copy/paste-able, but I expect I'd be pelted with tomatoes if I proposed it.",
    "created_at": "2022-02-02T19:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663650",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:5'></a>In gh-umedoblock's defense, our examples *do* rely on some implicit magic, the symbolic variable `x` being automatically defined whenever sage starts or the doctest environment resets. I would much rather see us begin them all with `x = SR.var("x")` so that they're truly copy/paste-able, but I expect I'd be pelted with tomatoes if I proposed it.



---

archive/issue_comments_663651.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [mjo](#comment%3A5):\n> In gh-umedoblock's defense, our examples *do* rely on some implicit magic, the symbolic variable `x` being automatically defined whenever sage starts or the doctest environment resets. I would much rather see us begin them all with `x = SR.var(\"x\")` so that they're truly copy/paste-able [...]\n\n\nHuge +1 from me.",
    "created_at": "2022-02-02T19:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663651",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>Replying to [mjo](#comment%3A5):
> In gh-umedoblock's defense, our examples *do* rely on some implicit magic, the symbolic variable `x` being automatically defined whenever sage starts or the doctest environment resets. I would much rather see us begin them all with `x = SR.var("x")` so that they're truly copy/paste-able [...]


Huge +1 from me.



---

archive/issue_comments_663652.json:
```json
{
    "body": "<a id='comment:7'></a>It looks like maybe there's a reason to propose this that won't make me look like a busybody: #32721",
    "created_at": "2022-02-02T19:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663652",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:7'></a>It looks like maybe there's a reason to propose this that won't make me look like a busybody: #32721



---

archive/issue_comments_663653.json:
```json
{
    "body": "<a id='comment:8'></a>Do you irritate me ?\n\nSorry.\n\nI insert `reset('x')` under `MyAnimation()`\n\nAnd `animate()` doesn't raise `TypeError`.\n\nSo please insert `reset('x')` under `MyAnimation()`.\n\n```\nfrom sage.plot.animate import Animation\nclass MyAnimation(Animation):\n    def make_image(self, frame, filename, **kwds):\n        P = parametric_plot(frame[0], frame[1], **frame[2])\n        P.save_image(filename,**kwds)\n\nt = var('t')\nx = lambda t: cos(t)\ny = lambda n,t: sin(t)/n\nB = MyAnimation([([x(t), y(i+1,t)],(t,0,1), {'color':Color((1,0,i/4)), 'aspect_ratio':1, 'ymax':1}) for i in range(4)])\n\nvvvvvvvvvv\nreset('x')\n^^^^^^^^^^\n\nd = B.png(); v = os.listdir(d); v.sort(); v  # long time\nB.show()  # not tested\n\na = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)\nd = a.png(); v = os.listdir(d); v.sort(); v  # long time\n```",
    "created_at": "2022-02-02T20:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663653",
    "user": "https://github.com/umedoblock"
}
```

<a id='comment:8'></a>Do you irritate me ?

Sorry.

I insert `reset('x')` under `MyAnimation()`

And `animate()` doesn't raise `TypeError`.

So please insert `reset('x')` under `MyAnimation()`.

```
from sage.plot.animate import Animation
class MyAnimation(Animation):
    def make_image(self, frame, filename, **kwds):
        P = parametric_plot(frame[0], frame[1], **frame[2])
        P.save_image(filename,**kwds)

t = var('t')
x = lambda t: cos(t)
y = lambda n,t: sin(t)/n
B = MyAnimation([([x(t), y(i+1,t)],(t,0,1), {'color':Color((1,0,i/4)), 'aspect_ratio':1, 'ymax':1}) for i in range(4)])

vvvvvvvvvv
reset('x')
^^^^^^^^^^

d = B.png(); v = os.listdir(d); v.sort(); v  # long time
B.show()  # not tested

a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)
d = a.png(); v = os.listdir(d); v.sort(); v  # long time
```



---

archive/issue_comments_663654.json:
```json
{
    "body": "<a id='comment:9'></a>Instead of `reset('x')`, you can also use `x = SR.var('x')`.\n\nI agree many documentation examples would be improved\nif they started with that.",
    "created_at": "2022-02-02T21:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663654",
    "user": "https://github.com/slel"
}
```

<a id='comment:9'></a>Instead of `reset('x')`, you can also use `x = SR.var('x')`.

I agree many documentation examples would be improved
if they started with that.



---

archive/issue_comments_663655.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-02-02T21:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663655",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_087834.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-02-02T21:51:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33264#event-87834"
}
```



---

archive/issue_events_087835.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-02-02T21:51:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33264#event-87835"
}
```



---

archive/issue_comments_663656.json:
```json
{
    "body": "<a id='comment:10'></a>Improved.\n\nAnd works it.\n\nThanks slelieve and mjo.\n\n```\nfrom sage.plot.animate import Animation\nclass MyAnimation(Animation):\n    def make_image(self, frame, filename, **kwds):\n        P = parametric_plot(frame[0], frame[1], **frame[2])\n        P.save_image(filename,**kwds)\n\nt = var('t')\nx = lambda t: cos(t)\ny = lambda n,t: sin(t)/n\nB = MyAnimation([([x(t), y(i+1,t)],(t,0,1), {'color':Color((1,0,i/4)), 'aspect_ratio':1, 'ymax':1}) for i in range(4)])\n\nvvvvvvvvvvvvvvv\nx = SR.var('x')\n^^^^^^^^^^^^^^^\n\nd = B.png(); v = os.listdir(d); v.sort(); v  # long time\nB.show()  # not tested\n\na = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)\nd = a.png(); v = os.listdir(d); v.sort(); v  # long time\n```",
    "created_at": "2022-02-03T04:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663656",
    "user": "https://github.com/umedoblock"
}
```

<a id='comment:10'></a>Improved.

And works it.

Thanks slelieve and mjo.

```
from sage.plot.animate import Animation
class MyAnimation(Animation):
    def make_image(self, frame, filename, **kwds):
        P = parametric_plot(frame[0], frame[1], **frame[2])
        P.save_image(filename,**kwds)

t = var('t')
x = lambda t: cos(t)
y = lambda n,t: sin(t)/n
B = MyAnimation([([x(t), y(i+1,t)],(t,0,1), {'color':Color((1,0,i/4)), 'aspect_ratio':1, 'ymax':1}) for i in range(4)])

vvvvvvvvvvvvvvv
x = SR.var('x')
^^^^^^^^^^^^^^^

d = B.png(); v = os.listdir(d); v.sort(); v  # long time
B.show()  # not tested

a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)
d = a.png(); v = os.listdir(d); v.sort(); v  # long time
```



---

archive/issue_comments_663657.json:
```json
{
    "body": "Changing commit from \"\" to \"e73cd12435a21f22f440bd21fff270361a1ac890\"",
    "created_at": "2022-02-03T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663657",
    "user": "https://github.com/orlitzky"
}
```

Changing commit from "" to "e73cd12435a21f22f440bd21fff270361a1ac890"



---

archive/issue_comments_663658.json:
```json
{
    "body": "<a id='comment:11'></a>One down, a million to go.\n\n---\nNew commits:",
    "created_at": "2022-02-03T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663658",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:11'></a>One down, a million to go.

---
New commits:



---

archive/issue_comments_663659.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mjo/ticket/33264\"",
    "created_at": "2022-02-03T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663659",
    "user": "https://github.com/orlitzky"
}
```

Changing branch from "" to "u/mjo/ticket/33264"



---

archive/issue_comments_663660.json:
```json
{
    "body": "Changing author from \"\" to \"Michael Orlitzky\"",
    "created_at": "2022-02-03T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663660",
    "user": "https://github.com/orlitzky"
}
```

Changing author from "" to "Michael Orlitzky"



---

archive/issue_comments_663661.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-02-03T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663661",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_663662.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,80 +1,63 @@\n-# I tried to run all of the EXAMPLE in [Animated plots](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html)\n+The animated plots examples in the documentation at\n \n-## environment\n+- https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html\n+\n+include an example where `x = lambda t: cos(t)`\n+and `y = ...` are used for a parametric plot.\n+\n+Subsequent examples fail with a type error\n+if run without resetting `x` to its default value,\n+either with `reset('x')` or with `x = SR.var('x')`.\n \n ```\n-macOS Monterey\n-Version 12.1\n-```\n-\n-```\n-\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n-\u2502 SageMath version 9.5.rc2, Release Date: 2022-01-16                 \u2502\n-\u2502 Using Python 3.9.9. Type \"help()\" for help.                        \u2502\n-\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n-\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n-\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n-\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n-```\n-\n-# Some TypeError occurred after run below EXAMPLES:\n-\n-## TypeError1\n-\n-```\n-sage: sage: sage: a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)\n-....:   \n-....:                                                                           \n+sage: a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)\n ---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n-<ipython-input-46-05cc8220246d> in <module>\n-----> 1 a = animate([plot(x**Integer(2) + n) for n in range(Integer(4))], ymin=Integer(0), ymax=Integer(4))\n+<ipython-input-...-...> in <module>\n+----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)\n \n-<ipython-input-46-05cc8220246d> in <listcomp>(.0)\n-----> 1 a = animate([plot(x**Integer(2) + n) for n in range(Integer(4))], ymin=Integer(0), ymax=Integer(4))\n+<ipython-input-...-...> in <listcomp>(.0)\n+----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)\n \n-/private/var/tmp/sage-9.5-current/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:14496)()\n+.../site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:14496)()\n    2153             return coercion_model.bin_op(left, right, operator.pow)\n    2154         # left is a non-Element: do the powering with a Python int\n -> 2155         return left ** int(right)\n-   2156 \n+   2156\n    2157     cpdef _pow_(self, other):\n \n TypeError: unsupported operand type(s) for ** or pow(): 'function' and 'int'\n ```\n \n-## TypeError2\n-\n ```\n-sage: sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)], \n-....: ....:             xmin=0, xmax=2*pi, ymin=-1, ymax=1, figsize=[2,1])      \n+sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],\n+....:             xmin=0, xmax=2*pi, ymin=-1, ymax=1, figsize=[2,1])\n ---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n-<ipython-input-41-d043bfa4db4e> in <module>\n-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],\n-      2             xmin=Integer(0), xmax=Integer(2)*pi, ymin=-Integer(1), ymax=Integer(1), figsize=[Integer(2),Integer(1)])\n+<ipython-input-...> in <module>\n+----> 1 a = animate([sin(x + float(k)) for ...],\n+      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)\n \n-<ipython-input-41-d043bfa4db4e> in <listcomp>(.0)\n-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],\n-      2             xmin=Integer(0), xmax=Integer(2)*pi, ymin=-Integer(1), ymax=Integer(1), figsize=[Integer(2),Integer(1)])\n+<ipython-input-...> in <listcomp>(.0)\n+----> 1 a = animate([sin(x + float(k)) for ...],\n+      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)\n \n TypeError: unsupported operand type(s) for +: 'function' and 'float'\n ```\n \n-## TypeError3\n-\n ```\n-sage: sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)], \n-....: ....:                xmin=0, xmax=2*pi, figsize=[2,1])                    \n+sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],\n+....:                xmin=0, xmax=2*pi, figsize=[2,1])\n+....:\n ---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n-<ipython-input-44-65f74ffcfd6c> in <module>\n-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],\n-      2                xmin=Integer(0), xmax=Integer(2)*pi, figsize=[Integer(2),Integer(1)])\n+<ipython-input-...> in <module>\n+----> 1 a = animate([sin(x + float(k)) for ...],\n+      2                xmin=..., xmax=..., figsize=...)\n \n-<ipython-input-44-65f74ffcfd6c> in <listcomp>(.0)\n-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],\n-      2                xmin=Integer(0), xmax=Integer(2)*pi, figsize=[Integer(2),Integer(1)])\n+<ipython-input-...> in <listcomp>(.0)\n+----> 1 a = animate([sin(x + float(k)) for ...],\n+      2                xmin=..., xmax=..., figsize=...)\n \n TypeError: unsupported operand type(s) for +: 'function' and 'float'\n ```\n``````\n",
    "created_at": "2022-02-04T00:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663662",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,80 +1,63 @@
-# I tried to run all of the EXAMPLE in [Animated plots](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html)
+The animated plots examples in the documentation at
 
-## environment
+- https://doc.sagemath.org/html/en/reference/plotting/sage/plot/animate.html
+
+include an example where `x = lambda t: cos(t)`
+and `y = ...` are used for a parametric plot.
+
+Subsequent examples fail with a type error
+if run without resetting `x` to its default value,
+either with `reset('x')` or with `x = SR.var('x')`.
 
 ```
-macOS Monterey
-Version 12.1
-```
-
-```
-┌────────────────────────────────────────────────────────────────────┐
-│ SageMath version 9.5.rc2, Release Date: 2022-01-16                 │
-│ Using Python 3.9.9. Type "help()" for help.                        │
-└────────────────────────────────────────────────────────────────────┘
-┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
-┃ Warning: this is a prerelease version, and it may be unstable.     ┃
-┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
-```
-
-# Some TypeError occurred after run below EXAMPLES:
-
-## TypeError1
-
-```
-sage: sage: sage: a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)
-....:   
-....:                                                                           
+sage: a = animate([plot(x^2 + n) for n in range(4)], ymin=0, ymax=4)
 ---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
-<ipython-input-46-05cc8220246d> in <module>
-----> 1 a = animate([plot(x**Integer(2) + n) for n in range(Integer(4))], ymin=Integer(0), ymax=Integer(4))
+<ipython-input-...-...> in <module>
+----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)
 
-<ipython-input-46-05cc8220246d> in <listcomp>(.0)
-----> 1 a = animate([plot(x**Integer(2) + n) for n in range(Integer(4))], ymin=Integer(0), ymax=Integer(4))
+<ipython-input-...-...> in <listcomp>(.0)
+----> 1 a = animate([plot(x**Integer(2) + n) for n in ...], ymin=..., ymax=...)
 
-/private/var/tmp/sage-9.5-current/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:14496)()
+.../site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:14496)()
    2153             return coercion_model.bin_op(left, right, operator.pow)
    2154         # left is a non-Element: do the powering with a Python int
 -> 2155         return left ** int(right)
-   2156 
+   2156
    2157     cpdef _pow_(self, other):
 
 TypeError: unsupported operand type(s) for ** or pow(): 'function' and 'int'
 ```
 
-## TypeError2
-
 ```
-sage: sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)], 
-....: ....:             xmin=0, xmax=2*pi, ymin=-1, ymax=1, figsize=[2,1])      
+sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],
+....:             xmin=0, xmax=2*pi, ymin=-1, ymax=1, figsize=[2,1])
 ---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
-<ipython-input-41-d043bfa4db4e> in <module>
-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],
-      2             xmin=Integer(0), xmax=Integer(2)*pi, ymin=-Integer(1), ymax=Integer(1), figsize=[Integer(2),Integer(1)])
+<ipython-input-...> in <module>
+----> 1 a = animate([sin(x + float(k)) for ...],
+      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)
 
-<ipython-input-41-d043bfa4db4e> in <listcomp>(.0)
-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],
-      2             xmin=Integer(0), xmax=Integer(2)*pi, ymin=-Integer(1), ymax=Integer(1), figsize=[Integer(2),Integer(1)])
+<ipython-input-...> in <listcomp>(.0)
+----> 1 a = animate([sin(x + float(k)) for ...],
+      2             xmin=..., xmax=..., ymin=..., ymax=..., figsize=...)
 
 TypeError: unsupported operand type(s) for +: 'function' and 'float'
 ```
 
-## TypeError3
-
 ```
-sage: sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)], 
-....: ....:                xmin=0, xmax=2*pi, figsize=[2,1])                    
+sage: a = animate([sin(x + float(k)) for k in srange(0,2*pi,0.7)],
+....:                xmin=0, xmax=2*pi, figsize=[2,1])
+....:
 ---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
-<ipython-input-44-65f74ffcfd6c> in <module>
-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],
-      2                xmin=Integer(0), xmax=Integer(2)*pi, figsize=[Integer(2),Integer(1)])
+<ipython-input-...> in <module>
+----> 1 a = animate([sin(x + float(k)) for ...],
+      2                xmin=..., xmax=..., figsize=...)
 
-<ipython-input-44-65f74ffcfd6c> in <listcomp>(.0)
-----> 1 a = animate([sin(x + float(k)) for k in srange(Integer(0),Integer(2)*pi,RealNumber('0.7'))],
-      2                xmin=Integer(0), xmax=Integer(2)*pi, figsize=[Integer(2),Integer(1)])
+<ipython-input-...> in <listcomp>(.0)
+----> 1 a = animate([sin(x + float(k)) for ...],
+      2                xmin=..., xmax=..., figsize=...)
 
 TypeError: unsupported operand type(s) for +: 'function' and 'float'
 ```
``````




---

archive/issue_comments_663663.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-04T00:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663663",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_663664.json:
```json
{
    "body": "<a id='comment:13'></a>That will help!",
    "created_at": "2022-02-04T00:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663664",
    "user": "https://github.com/slel"
}
```

<a id='comment:13'></a>That will help!



---

archive/issue_comments_663665.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Samuel Leli\u00e8vre\"",
    "created_at": "2022-02-04T00:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663665",
    "user": "https://github.com/slel"
}
```

Changing reviewer from "" to "Samuel Lelièvre"



---

archive/issue_comments_663666.json:
```json
{
    "body": "Changing keywords from \"\" to \"SR.var('x')\".",
    "created_at": "2022-02-04T00:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663666",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "SR.var('x')".



---

archive/issue_comments_663667.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n include an example where `x = lambda t: cos(t)`\n and `y = ...` are used for a parametric plot.\n \n-Subsequent examples fail with a type error\n+Many subsequent examples fail with a type error\n if run without resetting `x` to its default value,\n either with `reset('x')` or with `x = SR.var('x')`.\n \n``````\n",
    "created_at": "2022-02-04T00:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663667",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 include an example where `x = lambda t: cos(t)`
 and `y = ...` are used for a parametric plot.
 
-Subsequent examples fail with a type error
+Many subsequent examples fail with a type error
 if run without resetting `x` to its default value,
 either with `reset('x')` or with `x = SR.var('x')`.
 
``````




---

archive/issue_events_087836.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-16T23:57:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33264#event-87836"
}
```



---

archive/issue_comments_663668.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-16T23:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663668",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_663669.json:
```json
{
    "body": "Changing branch from \"u/mjo/ticket/33264\" to \"e73cd12435a21f22f440bd21fff270361a1ac890\"",
    "created_at": "2022-02-16T23:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33264#issuecomment-663669",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mjo/ticket/33264" to "e73cd12435a21f22f440bd21fff270361a1ac890"
