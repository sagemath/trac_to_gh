# Issue 33947: Crystals: "view" command doesn't work

archive/issues_033710.json:
```json
{
    "body": "If `dot2tex` is not installed, then the command `view(crystals.Tableaux(\"A3\",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) The issue seems to be that the digraph LaTeX code cannot handle the complicated vertex labels that often arise with crystals. A secondary issue is that, even in cases where `view(crystals....)` works without `dot2tex`, the version with `dot2tex` looks *much* better.\n\nCC:  @tscrim\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/33947\n\n",
    "created_at": "2022-06-02T23:05:26Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Crystals: \"view\" command doesn't work",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33947",
    "user": "https://github.com/jhpalmieri"
}
```
If `dot2tex` is not installed, then the command `view(crystals.Tableaux("A3",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) The issue seems to be that the digraph LaTeX code cannot handle the complicated vertex labels that often arise with crystals. A secondary issue is that, even in cases where `view(crystals....)` works without `dot2tex`, the version with `dot2tex` looks *much* better.

CC:  @tscrim

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/33947





---

archive/issue_comments_676934.json:
```json
{
    "body": "Attachment [crystals.tex](tarball://root/attachments/some-uuid/ticket33947/crystals.tex) by @jhpalmieri created at 2022-06-02 23:05:37",
    "created_at": "2022-06-02T23:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676934",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [crystals.tex](tarball://root/attachments/some-uuid/ticket33947/crystals.tex) by @jhpalmieri created at 2022-06-02 23:05:37



---

archive/issue_comments_676935.json:
```json
{
    "body": "<a id='comment:1'></a>For me, on Ubuntu 20.04 and `SageMath version 9.7.beta1, Release Date: 2022-05-26`, the command`view(crystals.Tableaux(\"A3\",shape=[2,1]))` works ok and opens the pdf which looks nice.\n\nSo I can't reproduce the problem.",
    "created_at": "2022-06-03T07:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676935",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:1'></a>For me, on Ubuntu 20.04 and `SageMath version 9.7.beta1, Release Date: 2022-05-26`, the command`view(crystals.Tableaux("A3",shape=[2,1]))` works ok and opens the pdf which looks nice.

So I can't reproduce the problem.



---

archive/issue_comments_676936.json:
```json
{
    "body": "<a id='comment:2'></a>Can you successfully run `latex` or `pdflatex` on the attached file? Maybe it's a difference in the version of LaTeX/TeX-Live/etc. that's installed.",
    "created_at": "2022-06-03T17:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676936",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>Can you successfully run `latex` or `pdflatex` on the attached file? Maybe it's a difference in the version of LaTeX/TeX-Live/etc. that's installed.



---

archive/issue_comments_676937.json:
```json
{
    "body": "<a id='comment:3'></a>I can't compile it:\n\n```\n$ wget https://trac.sagemath.org/raw-attachment/ticket/33947/crystals.tex\n$ pdflatex crystals.tex\nThis is pdfTeX, Version 3.14159265-2.6-1.40.20 (TeX Live 2019/Debian) \n(preloaded format=pdflatex 2020.9.1)  3 JUN 2022 22:02\n\n...\n\nFile: ursfs.fd 1998/03/24 rsfs font definition file (jk)\n)\n! Illegal parameter number in definition of \\cmdGR@vertex@L.\n<to be read again> \n                   1\nl.137 }$},x=4.8995cm,y=2.7442cm]{v0}\n                                    \n? \n! Illegal parameter number in definition of \\cmdGR@vertex@L.\n<to be read again> \n                   1\nl.137 }$},x=4.8995cm,y=2.7442cm]{v0}\n                                    \n? \n! Undefined control sequence.\n\\cmdGR@vertex@L ->\\hbox {${\\def \\lr \n                                    ##1{\\multicolumn {1}{|@{\\hspace {.6ex}}c...\nl.137 }$},x=4.8995cm,y=2.7442cm]{v0}\n                                    \n? \n! Illegal parameter number in definition of \\@gtempa.\n<to be read again> \n                   1\nl.137 }$},x=4.8995cm,y=2.7442cm]{v0}\n                                    \n? \n! Undefined control sequence.\nl.138 ...=circle},LabelOut=false,L=\\hbox{${\\def\\lr\n                                                  #1{\\multicolumn{1}{|@{\\hsp...\n\n? \n! Illegal parameter number in definition of \\@gtempa.\n<to be read again> \n                   1\nl.138 ...ircle},LabelOut=false,L=\\hbox{${\\def\\lr#1\n                                                  {\\multicolumn{1}{|@{\\hspac...\n\n? \n)\n! Incomplete \\iffalse; all text was ignored after line 138.\n<inserted text> \n                \\fi \n<*> crystals.tex\n\n```\n\nSame error with `latex crystals.tex`.",
    "created_at": "2022-06-03T20:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676937",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:3'></a>I can't compile it:

```
$ wget https://trac.sagemath.org/raw-attachment/ticket/33947/crystals.tex
$ pdflatex crystals.tex
This is pdfTeX, Version 3.14159265-2.6-1.40.20 (TeX Live 2019/Debian) 
(preloaded format=pdflatex 2020.9.1)  3 JUN 2022 22:02

...

File: ursfs.fd 1998/03/24 rsfs font definition file (jk)
)
! Illegal parameter number in definition of \cmdGR@vertex@L.
<to be read again> 
                   1
l.137 }$},x=4.8995cm,y=2.7442cm]{v0}
                                    
? 
! Illegal parameter number in definition of \cmdGR@vertex@L.
<to be read again> 
                   1
l.137 }$},x=4.8995cm,y=2.7442cm]{v0}
                                    
? 
! Undefined control sequence.
\cmdGR@vertex@L ->\hbox {${\def \lr 
                                    ##1{\multicolumn {1}{|@{\hspace {.6ex}}c...
l.137 }$},x=4.8995cm,y=2.7442cm]{v0}
                                    
? 
! Illegal parameter number in definition of \@gtempa.
<to be read again> 
                   1
l.137 }$},x=4.8995cm,y=2.7442cm]{v0}
                                    
? 
! Undefined control sequence.
l.138 ...=circle},LabelOut=false,L=\hbox{${\def\lr
                                                  #1{\multicolumn{1}{|@{\hsp...

? 
! Illegal parameter number in definition of \@gtempa.
<to be read again> 
                   1
l.138 ...ircle},LabelOut=false,L=\hbox{${\def\lr#1
                                                  {\multicolumn{1}{|@{\hspac...

? 
)
! Incomplete \iffalse; all text was ignored after line 138.
<inserted text> 
                \fi 
<*> crystals.tex

```

Same error with `latex crystals.tex`.



---

archive/issue_comments_676938.json:
```json
{
    "body": "<a id='comment:4'></a>Thank you for checking that. Can you run `view(crystals.Tableaux(\"A3\",shape=[2,1]), debug=True)`? This should print a LaTeX file which apparently works on your machine. Can you see the differences between the one you get and the one I posted?",
    "created_at": "2022-06-03T21:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676938",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>Thank you for checking that. Can you run `view(crystals.Tableaux("A3",shape=[2,1]), debug=True)`? This should print a LaTeX file which apparently works on your machine. Can you see the differences between the one you get and the one I posted?



---

archive/issue_comments_676939.json:
```json
{
    "body": "<a id='comment:5'></a>Maybe it produces different LaTeX depending on what packages are available on your system?",
    "created_at": "2022-06-03T21:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676939",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>Maybe it produces different LaTeX depending on what packages are available on your system?



---

archive/issue_comments_676940.json:
```json
{
    "body": "<a id='comment:6'></a>Now I'm guessing that you have `dot2tex` installed. If I install that, then a different LaTeX file is produced, one that works. Without `dot2tex`, it relies on apparently bad `tkz-graph` code.",
    "created_at": "2022-06-05T01:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676940",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>Now I'm guessing that you have `dot2tex` installed. If I install that, then a different LaTeX file is produced, one that works. Without `dot2tex`, it relies on apparently bad `tkz-graph` code.



---

archive/issue_comments_676941.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-The command `view(crystals.Tableaux(\"A3\",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) Replacing each argument `L={\\hbox...}` with something simpler produces a LaTeX document which compiles, so that seems to be where the problem lies.\n+If `dot2tex` is not installed, then the command `view(crystals.Tableaux(\"A3\",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) Replacing each argument `L={\\hbox...}` with something simpler produces a LaTeX document which compiles, so that seems to be where the problem lies.\n``````\n",
    "created_at": "2022-06-05T20:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676941",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-The command `view(crystals.Tableaux("A3",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) Replacing each argument `L={\hbox...}` with something simpler produces a LaTeX document which compiles, so that seems to be where the problem lies.
+If `dot2tex` is not installed, then the command `view(crystals.Tableaux("A3",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) Replacing each argument `L={\hbox...}` with something simpler produces a LaTeX document which compiles, so that seems to be where the problem lies.
``````




---

archive/issue_comments_676942.json:
```json
{
    "body": "<a id='comment:8'></a>FYI: This is not a new bug.  It was discussed 5 years previously on [tex.stackexchange.com](https://tex.stackexchange.com/questions/342983/on-drawing-a-crystal-graph-i-have-a-trouble-illegal-parameter-number-in-defi) and [sage-support](https://groups.google.com/g/sage-support/c/BOlqVpkJzAQ/m/vQEgCbmwBwAJ), but no ticket seems to have been opened.",
    "created_at": "2022-06-05T20:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676942",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:8'></a>FYI: This is not a new bug.  It was discussed 5 years previously on [tex.stackexchange.com](https://tex.stackexchange.com/questions/342983/on-drawing-a-crystal-graph-i-have-a-trouble-illegal-parameter-number-in-defi) and [sage-support](https://groups.google.com/g/sage-support/c/BOlqVpkJzAQ/m/vQEgCbmwBwAJ), but no ticket seems to have been opened.



---

archive/issue_comments_676943.json:
```json
{
    "body": "<a id='comment:9'></a>This looks like a real mess to fix. The issue is the file `sage/combinat/output.py`, which is used to typeset the vertex labels here: the LaTeX code is too complicated for a vertex label in `tkz-graph`. (See https://tex.stackexchange.com/questions/646826/complicated-vertex-labels-with-tkz-graph/646834#646834.) We could remove the `\\lr` macro and just include the corresponding code in the LaTeX: change\n\n```\n\\hbox{${\\def\\lr#1{\\multicolumn{1}{|@{\\hspace{.6ex}}c@{\\hspace{.6ex}}|}{\\raisebox{-.3ex}{$#1$}}}\\raisebox{-.6ex}\n{$\\begin{array}[b]{*{2}c}\\cline{1-2}\\lr{1}&\\lr{1}\\\\\\cline{1-2}\\lr{2}\\\\\\cline{1-1}\\end{array}$}}$}\n```\nto (option 1)\n\n```\n\\hbox{$\\begin{array}[b]{*{2}{c}}\\cline{1-2}\n\\multicolumn{1}{|@{\\hspace{.6ex}}c@{\\hspace{.6ex}}|}{\\raisebox{-.3ex}1}&\\multicolumn{1}{|@{\\hspace{.6ex}}c@{\\hspace{.6ex}}|}{\\raisebox{-.3ex}1}\\\\\n\\cline{1-2}\\multicolumn{1}{|@{\\hspace{.6ex}}c@{\\hspace{.6ex}}|}{\\raisebox{-.3ex}2}\n\\\\\\cline{1-1}\\end{array}$}\n```\nIf we want simpler LaTeX code but less tight output, we can also just do (option 2)\n\n```\n$\\begin{array}{*2{|c}|}\\cline{1-2}\n2&4\\\\\\cline{1-2}\n3\\\\\\cline{1-1}\n\\end{array}$\n```\n(See the attachment for a picture with the original version and the \"less tight\" version.)\n\nThe annoying thing is that this code is used in many places in `sage.combinat`, and I don't know how important the esthetics are if we went with option 2, and I don't think I would be able to check each of the instances where it is used. If we went with option 1, then many doctests would have to be fixed.",
    "created_at": "2022-06-06T21:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676943",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>This looks like a real mess to fix. The issue is the file `sage/combinat/output.py`, which is used to typeset the vertex labels here: the LaTeX code is too complicated for a vertex label in `tkz-graph`. (See https://tex.stackexchange.com/questions/646826/complicated-vertex-labels-with-tkz-graph/646834#646834.) We could remove the `\lr` macro and just include the corresponding code in the LaTeX: change

```
\hbox{${\def\lr#1{\multicolumn{1}{|@{\hspace{.6ex}}c@{\hspace{.6ex}}|}{\raisebox{-.3ex}{$#1$}}}\raisebox{-.6ex}
{$\begin{array}[b]{*{2}c}\cline{1-2}\lr{1}&\lr{1}\\\cline{1-2}\lr{2}\\\cline{1-1}\end{array}$}}$}
```
to (option 1)

```
\hbox{$\begin{array}[b]{*{2}{c}}\cline{1-2}
\multicolumn{1}{|@{\hspace{.6ex}}c@{\hspace{.6ex}}|}{\raisebox{-.3ex}1}&\multicolumn{1}{|@{\hspace{.6ex}}c@{\hspace{.6ex}}|}{\raisebox{-.3ex}1}\\
\cline{1-2}\multicolumn{1}{|@{\hspace{.6ex}}c@{\hspace{.6ex}}|}{\raisebox{-.3ex}2}
\\\cline{1-1}\end{array}$}
```
If we want simpler LaTeX code but less tight output, we can also just do (option 2)

```
$\begin{array}{*2{|c}|}\cline{1-2}
2&4\\\cline{1-2}
3\\\cline{1-1}
\end{array}$
```
(See the attachment for a picture with the original version and the "less tight" version.)

The annoying thing is that this code is used in many places in `sage.combinat`, and I don't know how important the esthetics are if we went with option 2, and I don't think I would be able to check each of the instances where it is used. If we went with option 1, then many doctests would have to be fixed.



---

archive/issue_comments_676944.json:
```json
{
    "body": "<a id='comment:10'></a>Attachment [tight and less tight.png](tarball://root/attachments/some-uuid/ticket33947/tight and less tight.png) by @jhpalmieri created at 2022-06-06 22:06:51\n\nIn principle, something like this should work for option 1, but it's not quite right:\n\n```diff\ndiff --git a/src/sage/combinat/output.py b/src/sage/combinat/output.py\nindex 95b5cd0c04..09271aec3b 100644\n--- a/src/sage/combinat/output.py\n+++ b/src/sage/combinat/output.py\n@@ -20,7 +20,8 @@ from sage.combinat.tableau import Tableaux\n \n # The tex macro used to latex individual cells in an array (as a template).\n # When using bar should be replaced by '|' or ''.\n-lr_macro = Template(r'\\def\\lr#1{\\multicolumn{1}{$bar@{\\hspace{.6ex}}c@{\\hspace{.6ex}}$bar}{\\raisebox{-.3ex}{$$#1$$}}}')\n+# lr_macro = Template(r'\\def\\lr#1{\\multicolumn{1}{$bar@{\\hspace{.6ex}}c@{\\hspace{.6ex}}$bar}{\\raisebox{-.3ex}{$$#1$$}}}')\n+lr_macro = Template(r'{\\multicolumn{1}{$bar@{\\hspace{.6ex}}c@{\\hspace{.6ex}}$bar}{\\raisebox{-.3ex}{$$ $elt $$}}}')\n \n def tex_from_array(array, with_lines=True):\n     r\"\"\"\n@@ -170,11 +171,10 @@ def tex_from_array(array, with_lines=True):\n         }\n         sage: Tableaux.options._reset()\n     \"\"\"\n-    lr=lr_macro.substitute(bar='|' if with_lines else '')\n     if Tableaux.options.convention == \"English\":\n-        return '{%s\\n%s\\n}' % (lr, tex_from_skew_array(array, with_lines))\n+        return '{%s\\n}' % (tex_from_skew_array(array, with_lines))\n     else:\n-        return '{%s\\n%s\\n}' % (lr, tex_from_skew_array(array[::-1], with_lines, align='t'))\n+        return '{%s\\n}' % (tex_from_skew_array(array[::-1], with_lines, align='t'))\n \n \n def tex_from_array_tuple(a_tuple, with_lines=True):\n@@ -240,12 +240,11 @@ def tex_from_array_tuple(a_tuple, with_lines=True):\n         }\n         sage: Tableaux.options._reset()\n     \"\"\"\n-    lr=lr_macro.substitute(bar='|' if with_lines else '')\n     if Tableaux.options.convention == \"English\":\n-        return '{%s\\n%s\\n}' % (lr, ','.join(\n+        return '{%s\\n%s\\n}' % ('', ','.join(\n             r'\\emptyset' if comp==[] else tex_from_skew_array(comp, with_lines) for comp in a_tuple))\n     else:\n-        return '{%s\\n%s\\n}' % (lr, ','.join(\n+        return '{%s\\n%s\\n}' % ('', ','.join(\n             r'\\emptyset' if comp==[] else tex_from_skew_array(comp[::-1], with_lines, align='t') for comp in a_tuple))\n \n \n@@ -302,14 +301,17 @@ def tex_from_skew_array(array, with_lines=False, align='b'):\n                 start=min(nones[r], nones[r-1])\n                 finish=max(len(array[r]), len(array[r-1]))\n             return r'\\\\' if start>finish else r'\\\\\\cline{%s-%s}'%(start, finish)\n+        bar = '|'\n     else:\n         end_line=lambda r: r'\\\\'\n+        bar = ''\n \n     # now we draw the array\n     tex=r'\\raisebox{-.6ex}{$\\begin{array}[%s]{*{%s}c}'%(align,max(map(len,array)))\n     tex+=end_line(0)+'\\n'\n     for r in range(len(array)):\n-        tex+='&'.join('' if c is None else r'\\lr{%s}'%(c,) for c in array[r])\n+        tex+='&'.join('' if c is None else lr_macro.substitute({'bar': bar, 'elt': c})\n+                      for c in array[r])\n         tex+=end_line(r+1)+'\\n'\n     return tex+r'\\end{array}$}'\n \n```",
    "created_at": "2022-06-06T22:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676944",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>Attachment [tight and less tight.png](tarball://root/attachments/some-uuid/ticket33947/tight and less tight.png) by @jhpalmieri created at 2022-06-06 22:06:51

In principle, something like this should work for option 1, but it's not quite right:

```diff
diff --git a/src/sage/combinat/output.py b/src/sage/combinat/output.py
index 95b5cd0c04..09271aec3b 100644
--- a/src/sage/combinat/output.py
+++ b/src/sage/combinat/output.py
@@ -20,7 +20,8 @@ from sage.combinat.tableau import Tableaux
 
 # The tex macro used to latex individual cells in an array (as a template).
 # When using bar should be replaced by '|' or ''.
-lr_macro = Template(r'\def\lr#1{\multicolumn{1}{$bar@{\hspace{.6ex}}c@{\hspace{.6ex}}$bar}{\raisebox{-.3ex}{$$#1$$}}}')
+# lr_macro = Template(r'\def\lr#1{\multicolumn{1}{$bar@{\hspace{.6ex}}c@{\hspace{.6ex}}$bar}{\raisebox{-.3ex}{$$#1$$}}}')
+lr_macro = Template(r'{\multicolumn{1}{$bar@{\hspace{.6ex}}c@{\hspace{.6ex}}$bar}{\raisebox{-.3ex}{$$ $elt $$}}}')
 
 def tex_from_array(array, with_lines=True):
     r"""
@@ -170,11 +171,10 @@ def tex_from_array(array, with_lines=True):
         }
         sage: Tableaux.options._reset()
     """
-    lr=lr_macro.substitute(bar='|' if with_lines else '')
     if Tableaux.options.convention == "English":
-        return '{%s\n%s\n}' % (lr, tex_from_skew_array(array, with_lines))
+        return '{%s\n}' % (tex_from_skew_array(array, with_lines))
     else:
-        return '{%s\n%s\n}' % (lr, tex_from_skew_array(array[::-1], with_lines, align='t'))
+        return '{%s\n}' % (tex_from_skew_array(array[::-1], with_lines, align='t'))
 
 
 def tex_from_array_tuple(a_tuple, with_lines=True):
@@ -240,12 +240,11 @@ def tex_from_array_tuple(a_tuple, with_lines=True):
         }
         sage: Tableaux.options._reset()
     """
-    lr=lr_macro.substitute(bar='|' if with_lines else '')
     if Tableaux.options.convention == "English":
-        return '{%s\n%s\n}' % (lr, ','.join(
+        return '{%s\n%s\n}' % ('', ','.join(
             r'\emptyset' if comp==[] else tex_from_skew_array(comp, with_lines) for comp in a_tuple))
     else:
-        return '{%s\n%s\n}' % (lr, ','.join(
+        return '{%s\n%s\n}' % ('', ','.join(
             r'\emptyset' if comp==[] else tex_from_skew_array(comp[::-1], with_lines, align='t') for comp in a_tuple))
 
 
@@ -302,14 +301,17 @@ def tex_from_skew_array(array, with_lines=False, align='b'):
                 start=min(nones[r], nones[r-1])
                 finish=max(len(array[r]), len(array[r-1]))
             return r'\\' if start>finish else r'\\\cline{%s-%s}'%(start, finish)
+        bar = '|'
     else:
         end_line=lambda r: r'\\'
+        bar = ''
 
     # now we draw the array
     tex=r'\raisebox{-.6ex}{$\begin{array}[%s]{*{%s}c}'%(align,max(map(len,array)))
     tex+=end_line(0)+'\n'
     for r in range(len(array)):
-        tex+='&'.join('' if c is None else r'\lr{%s}'%(c,) for c in array[r])
+        tex+='&'.join('' if c is None else lr_macro.substitute({'bar': bar, 'elt': c})
+                      for c in array[r])
         tex+=end_line(r+1)+'\n'
     return tex+r'\end{array}$}'
 
```



---

archive/issue_comments_676945.json:
```json
{
    "body": "<a id='comment:11'></a>Some quick comments:\n\n- You need to be careful about skew cases versus straight cases for tableaux. IIRC, the current code was written to work for both simultaneously as skew tableaux contain regular tableaux. Option 2 would split the two and result in some code redundancy.\n- The `lr` makes a subtle but noticeable change to where the letters are placed within the box; it does make it look better in my opinion. I would prefer to leave it in, but this is not too strong of an opinion.\n- Implicit in your discussion is the fact that it is the (di)graph code with tableaux that contains the underlying problem, not anything specific to the crystals code.\n- IMO, the `tkz-graph` should be able to take this more arbitrary latex code and compile it correctly. I would argue it is an upstream bug. Plus the output really looks quite bad compared to the `dot2tex` version (compare with Nakajima monomials). What about if other combinatorial objects that get used as vertices of a graph (say, the Hasse diagram of a poset)? I don\u2019t think the right approach is for us to find Tex code that `tkz-graph` will accept (especially when the \u201cdot2tex\u201c and any latex compiler is fine with it).",
    "created_at": "2022-06-07T00:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676945",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>Some quick comments:

- You need to be careful about skew cases versus straight cases for tableaux. IIRC, the current code was written to work for both simultaneously as skew tableaux contain regular tableaux. Option 2 would split the two and result in some code redundancy.
- The `lr` makes a subtle but noticeable change to where the letters are placed within the box; it does make it look better in my opinion. I would prefer to leave it in, but this is not too strong of an opinion.
- Implicit in your discussion is the fact that it is the (di)graph code with tableaux that contains the underlying problem, not anything specific to the crystals code.
- IMO, the `tkz-graph` should be able to take this more arbitrary latex code and compile it correctly. I would argue it is an upstream bug. Plus the output really looks quite bad compared to the `dot2tex` version (compare with Nakajima monomials). What about if other combinatorial objects that get used as vertices of a graph (say, the Hasse diagram of a poset)? I don’t think the right approach is for us to find Tex code that `tkz-graph` will accept (especially when the “dot2tex“ and any latex compiler is fine with it).



---

archive/issue_comments_676946.json:
```json
{
    "body": "<a id='comment:12'></a>The last point is certainly an issue. Why bother working on the `tkz-graph` version when the `dot2tex` version is so much nicer? Can we just recommend or require `dot2tex` for some situations? `view(crystals.KacModule(...)` seems to require this currently. How do we detect the relevant situations?",
    "created_at": "2022-06-07T02:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676946",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>The last point is certainly an issue. Why bother working on the `tkz-graph` version when the `dot2tex` version is so much nicer? Can we just recommend or require `dot2tex` for some situations? `view(crystals.KacModule(...)` seems to require this currently. How do we detect the relevant situations?



---

archive/issue_comments_676947.json:
```json
{
    "body": "<a id='comment:13'></a>I just tried examples of many of the crystals in the crystal catalog, and the default (non-`dot2tex`) LaTeX output looks bad or fails for most of them. Should we just require `dot2tex` for these? I don't think we need to do this for all graphs or all digraphs: I think the issue is the combination of the graph plotting with complicated vertex labels.\n\nAn example:\n\n```\nsage: R = RootSystem(['C',3,1])\nsage: La = R.weight_space().basis()\nsage: LS = crystals.ProjectedLevelZeroLSPaths(La[1]+La[3])\nsage: view(LS)\n```\nThis one is a little better, but not much, if you do\n\n```\nsage: D = LS.digraph()\nsage: D.set_latex_options(vertex_labels=False)\nsage: view(D)\n```\nEither case looks much better if `dot2tex` is installed. See the attachments for the output from `view(LS)` with and without `dot2tex`.",
    "created_at": "2022-06-07T16:53:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676947",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>I just tried examples of many of the crystals in the crystal catalog, and the default (non-`dot2tex`) LaTeX output looks bad or fails for most of them. Should we just require `dot2tex` for these? I don't think we need to do this for all graphs or all digraphs: I think the issue is the combination of the graph plotting with complicated vertex labels.

An example:

```
sage: R = RootSystem(['C',3,1])
sage: La = R.weight_space().basis()
sage: LS = crystals.ProjectedLevelZeroLSPaths(La[1]+La[3])
sage: view(LS)
```
This one is a little better, but not much, if you do

```
sage: D = LS.digraph()
sage: D.set_latex_options(vertex_labels=False)
sage: view(D)
```
Either case looks much better if `dot2tex` is installed. See the attachments for the output from `view(LS)` with and without `dot2tex`.



---

archive/issue_comments_676948.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-If `dot2tex` is not installed, then the command `view(crystals.Tableaux(\"A3\",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) Replacing each argument `L={\\hbox...}` with something simpler produces a LaTeX document which compiles, so that seems to be where the problem lies.\n+If `dot2tex` is not installed, then the command `view(crystals.Tableaux(\"A3\",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) The issue seems to be that the digraph LaTeX code cannot handle the complicated vertex labels that often arise with crystals. A secondary issue is that, even in cases where `view(crystals....)` works without `dot2tex`, the version with `dot2tex` looks *much* better.\n``````\n",
    "created_at": "2022-06-07T16:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676948",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-If `dot2tex` is not installed, then the command `view(crystals.Tableaux("A3",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) Replacing each argument `L={\hbox...}` with something simpler produces a LaTeX document which compiles, so that seems to be where the problem lies.
+If `dot2tex` is not installed, then the command `view(crystals.Tableaux("A3",shape=[2,1]))` produces broken LaTeX and hence fails. (The attachment is the file as printed by `view(..., debug=True)`.) The issue seems to be that the digraph LaTeX code cannot handle the complicated vertex labels that often arise with crystals. A secondary issue is that, even in cases where `view(crystals....)` works without `dot2tex`, the version with `dot2tex` looks *much* better.
``````




---

archive/issue_comments_676949.json:
```json
{
    "body": "Attachment [LS-with-dot2tex.pdf](tarball://root/attachments/some-uuid/ticket33947/LS-with-dot2tex.pdf) by @jhpalmieri created at 2022-06-07 16:58:27",
    "created_at": "2022-06-07T16:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676949",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [LS-with-dot2tex.pdf](tarball://root/attachments/some-uuid/ticket33947/LS-with-dot2tex.pdf) by @jhpalmieri created at 2022-06-07 16:58:27



---

archive/issue_comments_676950.json:
```json
{
    "body": "<a id='comment:15'></a>If I remember well, Nicolas Thi\u00e9ry and Anne Schilling were definitely using `dot2tex` when working with this code.\n\nOne way of making sure that dot2tex is installed is to first do this in the code (taken from `sage/misc/latex_standalone.py`):\n\n```python\n        from sage.features.graphviz import Graphviz\n        Graphviz().require()\n        from sage.features import PythonModule\n        PythonModule(\"dot2tex\").require()\n```",
    "created_at": "2022-06-07T21:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676950",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:15'></a>If I remember well, Nicolas Thiéry and Anne Schilling were definitely using `dot2tex` when working with this code.

One way of making sure that dot2tex is installed is to first do this in the code (taken from `sage/misc/latex_standalone.py`):

```python
        from sage.features.graphviz import Graphviz
        Graphviz().require()
        from sage.features import PythonModule
        PythonModule("dot2tex").require()
```



---

archive/issue_comments_676951.json:
```json
{
    "body": "<a id='comment:16'></a>So we could add this snippet, for example, to the `_latex_` method for crystals in `sage.categories.crystals`?",
    "created_at": "2022-06-07T22:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676951",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>So we could add this snippet, for example, to the `_latex_` method for crystals in `sage.categories.crystals`?



---

archive/issue_comments_676952.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [jhpalmieri](#comment%3A16):\n> So we could add this snippet, for example, to the `_latex_` method for crystals in `sage.categories.crystals`?\n\n\nI am a strong -1 on doing this. Not only does it \"work\" for some crystals, you can reproduce the same failure by creating a digraph with tableaux (maybe even partitions; I would have to check) as the vertices. We could have a warning for crystals where we suggest that the user installs `dot2tex`, but this currently is not possible on prebuilt binaries (we cannot include `dot2tex` because of incompatible licenses IIRC). I feel like errorring out just for crystals is just shooting the messenger.\n\nSide note: I think improving detecting and using a system install of `dot2tex` will go a fair ways to mollifying me here. We also require a user to have a system install of `graphviz`.",
    "created_at": "2022-06-08T02:34:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676952",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>Replying to [jhpalmieri](#comment%3A16):
> So we could add this snippet, for example, to the `_latex_` method for crystals in `sage.categories.crystals`?


I am a strong -1 on doing this. Not only does it "work" for some crystals, you can reproduce the same failure by creating a digraph with tableaux (maybe even partitions; I would have to check) as the vertices. We could have a warning for crystals where we suggest that the user installs `dot2tex`, but this currently is not possible on prebuilt binaries (we cannot include `dot2tex` because of incompatible licenses IIRC). I feel like errorring out just for crystals is just shooting the messenger.

Side note: I think improving detecting and using a system install of `dot2tex` will go a fair ways to mollifying me here. We also require a user to have a system install of `graphviz`.



---

archive/issue_comments_676953.json:
```json
{
    "body": "<a id='comment:18'></a>So do you suggest doing nothing?\n\nNote the status quo in this example, by the way:\n\n```\nsage: view(crystals.KacModule(['A', [1,1]], [2], [1]))\n\nAn error occurred when importing dot2tex.\n\nPlease see :meth:`sage.graphs.generic_graph.GenericGraph.layout_graphviz`\nfor installation instructions.\n\n...\n\nModuleNotFoundError: No module named 'dot2tex'\n```",
    "created_at": "2022-06-08T02:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676953",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>So do you suggest doing nothing?

Note the status quo in this example, by the way:

```
sage: view(crystals.KacModule(['A', [1,1]], [2], [1]))

An error occurred when importing dot2tex.

Please see :meth:`sage.graphs.generic_graph.GenericGraph.layout_graphviz`
for installation instructions.

...

ModuleNotFoundError: No module named 'dot2tex'
```



---

archive/issue_comments_676954.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [jhpalmieri](#comment%3A18):\n> So do you suggest doing nothing?\n\n\nI think we need to fix `tkz-graph` and allow it to handle more general latex code. Although that is probably easier said than done.\n\n> Note the status quo in this example, by the way:\n> \n> ```\n> sage: view(crystals.KacModule(['A', [1,1]], [2], [1]))\n> \n> An error occurred when importing dot2tex.\n> \n> Please see :meth:`sage.graphs.generic_graph.GenericGraph.layout_graphviz`\n> for installation instructions.\n> \n> ...\n> \n> ModuleNotFoundError: No module named 'dot2tex'\n> ```\n\n\nIMO (and IIRC) that is a bug on our part for supercrystals with not checking for `dot2tex` first.\n\nNow we could do the same thing and have any crystal graph return a digraph with `format=\"dot2tex\"` so the failure hints at what the user can do to get nice pictures. Yet, I see that as curing the symptoms rather than the disease.",
    "created_at": "2022-06-08T03:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676954",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>Replying to [jhpalmieri](#comment%3A18):
> So do you suggest doing nothing?


I think we need to fix `tkz-graph` and allow it to handle more general latex code. Although that is probably easier said than done.

> Note the status quo in this example, by the way:
> 
> ```
> sage: view(crystals.KacModule(['A', [1,1]], [2], [1]))
> 
> An error occurred when importing dot2tex.
> 
> Please see :meth:`sage.graphs.generic_graph.GenericGraph.layout_graphviz`
> for installation instructions.
> 
> ...
> 
> ModuleNotFoundError: No module named 'dot2tex'
> ```


IMO (and IIRC) that is a bug on our part for supercrystals with not checking for `dot2tex` first.

Now we could do the same thing and have any crystal graph return a digraph with `format="dot2tex"` so the failure hints at what the user can do to get nice pictures. Yet, I see that as curing the symptoms rather than the disease.



---

archive/issue_comments_676955.json:
```json
{
    "body": "<a id='comment:20'></a>I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. \n\nI don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.",
    "created_at": "2022-06-08T04:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676955",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:20'></a>I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. 

I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.



---

archive/issue_comments_676956.json:
```json
{
    "body": "<a id='comment:21'></a>There is the approach in[comment:9](#comment%3A9) and[comment:10](#comment%3A10). I can't help with fixing `tkz-graph`. Given the terrible output when not using `dot2tex`, it seems that at least we should advocate its installation somewhere, if we don't actually require it. To be honest, though, this ticket is very low on my list of priorities. I don't actually care about plotting crystals, and if I did, I now know to install `dot2tex` first.",
    "created_at": "2022-06-08T04:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676956",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>There is the approach in[comment:9](#comment%3A9) and[comment:10](#comment%3A10). I can't help with fixing `tkz-graph`. Given the terrible output when not using `dot2tex`, it seems that at least we should advocate its installation somewhere, if we don't actually require it. To be honest, though, this ticket is very low on my list of priorities. I don't actually care about plotting crystals, and if I did, I now know to install `dot2tex` first.



---

archive/issue_comments_676957.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [gh-DaveWitteMorris](#comment%3A20):\n> I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. \n> \n> I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.\n\nMaybe the issue is instead the `graphviz` license, since `graphviz` is a dependency for `dot2tex`.",
    "created_at": "2022-06-08T04:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676957",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>Replying to [gh-DaveWitteMorris](#comment%3A20):
> I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. 
> 
> I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.

Maybe the issue is instead the `graphviz` license, since `graphviz` is a dependency for `dot2tex`.



---

archive/issue_comments_676958.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [jhpalmieri](#comment%3A22):\n> Replying to [gh-DaveWitteMorris](#comment%3A20):\n> > I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. \n> > \n> > I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.\n\n> Maybe the issue is instead the `graphviz` license, since `graphviz` is a dependency for `dot2tex`.\n\nOh, that is indeed a problem.  Graphviz is [licensed under Common Public License Version 1.0](https://graphviz.org/license/), which is [not GPL-compatible](https://www.gnu.org/licenses/license-list.en.html#CommonPublicLicense10).",
    "created_at": "2022-06-08T04:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676958",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:23'></a>Replying to [jhpalmieri](#comment%3A22):
> Replying to [gh-DaveWitteMorris](#comment%3A20):
> > I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. 
> > 
> > I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.

> Maybe the issue is instead the `graphviz` license, since `graphviz` is a dependency for `dot2tex`.

Oh, that is indeed a problem.  Graphviz is [licensed under Common Public License Version 1.0](https://graphviz.org/license/), which is [not GPL-compatible](https://www.gnu.org/licenses/license-list.en.html#CommonPublicLicense10).



---

archive/issue_comments_676959.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [gh-DaveWitteMorris](#comment%3A23):\n> Replying to [jhpalmieri](#comment%3A22):\n> > Replying to [gh-DaveWitteMorris](#comment%3A20):\n> > > I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. \n> > > \n> > > I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.\n\n> > Maybe the issue is instead the `graphviz` license, since `graphviz` is a dependency for `dot2tex`.\n> \n> Oh, that is indeed a problem.  Graphviz is [licensed under Common Public License Version 1.0](https://graphviz.org/license/), which is [not GPL-compatible](https://www.gnu.org/licenses/license-list.en.html#CommonPublicLicense10).\n\n\nWhich subsequently means we cannot include `dot2tex` OOTB as I understand it. Although it would be useful if a user can just install it on their system and Sage automatically uses that without having to do anything to Sage.",
    "created_at": "2022-06-08T05:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33947#issuecomment-676959",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:24'></a>Replying to [gh-DaveWitteMorris](#comment%3A23):
> Replying to [jhpalmieri](#comment%3A22):
> > Replying to [gh-DaveWitteMorris](#comment%3A20):
> > > I think dot2tex is [licensed under the MIT licence](https://dot2tex.readthedocs.io/en/latest/license.html), and I think that is [compatible with GPL](https://www.gnu.org/licenses/license-list.en.html#Expat). So distributing dot2tex does seem to be an option. 
> > > 
> > > I don't understand the details of the discussion, but if dot2tex solves the problem, then my uninformed opinion is that it would be best not to reinvent the wheel.

> > Maybe the issue is instead the `graphviz` license, since `graphviz` is a dependency for `dot2tex`.
> 
> Oh, that is indeed a problem.  Graphviz is [licensed under Common Public License Version 1.0](https://graphviz.org/license/), which is [not GPL-compatible](https://www.gnu.org/licenses/license-list.en.html#CommonPublicLicense10).


Which subsequently means we cannot include `dot2tex` OOTB as I understand it. Although it would be useful if a user can just install it on their system and Sage automatically uses that without having to do anything to Sage.



---

archive/issue_events_088955.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33947",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33947#event-88955"
}
```
