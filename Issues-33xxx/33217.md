# Issue 33217: reduce in quotient rings is broken

archive/issues_032980.json:
```json
{
    "body": "Reduction modulo ideals in quotient rings does not return unique minimal representatives.\n\nIn this example, the ideal `J` in the quotient ring `Q = R/I` contains the element `t^2 - z^2`, so `reduce` should return `0`.\n\n```\nsage: R.<T,U,V,W,X,Y,Z> = PolynomialRing(QQ, order='lex')\nsage: I = R.ideal([T^2+U^2-1, V^2+W^2-1, X^2+Y^2+Z^2-1])\nsage: Q.<t,u,v,w,x,y,z> = R.quotient(I)\nsage: J = Q.ideal([u*v-x, u*w-y, t-z])\nsage: J.reduce(t^2 - z^2)  # should be 0\nw^2*z^2 - w^2 + y^2\nsage: J.reduce(t^2 - z^2).lift() in I  # reduction is not unique mod I, i.e. result is not even mathematically unique in Q\nFalse\n```\nThese results do not agree with the documentation:\n\n```\nsage: J.reduce?\n   ...\n   Reduce an element modulo the reduced Groebner basis for this ideal.\n   This returns 0 if and only if the element is in this ideal. In any\n   case, this reduction is unique up to monomial orders.\n   ...\n```\n\nThe expected behavior would be the same as lifting the ideal `J` to the cover ring `R`, perform reduction there (in terms of the ideal generated by `I` and the lifted generators of `J`) and map the result back to `Q` (by e.g. Thm. 9.19 in [https://doc.sagemath.org/html/en/reference/references/index.html#bw1993 [BW1993]]):\n\n```\nsage: Q(Q.cover().inverse_image(J).reduce((t^2 - z^2).lift()))  # correct\n0\n```\n\nPossibly related: #27508, #32291\n\n\n**CC:**  @mjungmath @tscrim\n\n**Branch/Commit:** [0cc8b67568c8df6111dfac37f4c122457da96740](https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Markus Wageringel\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33217\n\n",
    "closed_at": "2022-02-13T10:16:47Z",
    "created_at": "2022-01-22T15:41:20Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "reduce in quotient rings is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33217",
    "user": "https://github.com/mwageringel"
}
```
Reduction modulo ideals in quotient rings does not return unique minimal representatives.

In this example, the ideal `J` in the quotient ring `Q = R/I` contains the element `t^2 - z^2`, so `reduce` should return `0`.

```
sage: R.<T,U,V,W,X,Y,Z> = PolynomialRing(QQ, order='lex')
sage: I = R.ideal([T^2+U^2-1, V^2+W^2-1, X^2+Y^2+Z^2-1])
sage: Q.<t,u,v,w,x,y,z> = R.quotient(I)
sage: J = Q.ideal([u*v-x, u*w-y, t-z])
sage: J.reduce(t^2 - z^2)  # should be 0
w^2*z^2 - w^2 + y^2
sage: J.reduce(t^2 - z^2).lift() in I  # reduction is not unique mod I, i.e. result is not even mathematically unique in Q
False
```
These results do not agree with the documentation:

```
sage: J.reduce?
   ...
   Reduce an element modulo the reduced Groebner basis for this ideal.
   This returns 0 if and only if the element is in this ideal. In any
   case, this reduction is unique up to monomial orders.
   ...
```

The expected behavior would be the same as lifting the ideal `J` to the cover ring `R`, perform reduction there (in terms of the ideal generated by `I` and the lifted generators of `J`) and map the result back to `Q` (by e.g. Thm. 9.19 in [https://doc.sagemath.org/html/en/reference/references/index.html#bw1993 [BW1993]]):

```
sage: Q(Q.cover().inverse_image(J).reduce((t^2 - z^2).lift()))  # correct
0
```

Possibly related: #27508, #32291


**CC:**  @mjungmath @tscrim

**Branch/Commit:** [0cc8b67568c8df6111dfac37f4c122457da96740](https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740)

**Reviewer:** Travis Scrimshaw

**Author:** Markus Wageringel

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/33217





---

archive/issue_comments_662642.json:
```json
{
    "body": "<a id='comment:1'></a>\nCurrently, the implementation first computes `J.groebner_basis()` which seems to compute the Gr\u00f6bner basis in the cover ring `R` and maps the result to `Q`, discarding elements that are `0`. Then it performs reduction with respect to this sequence of quotient ring elements (which does not appear meaningful \u2013 are Gr\u00f6bner bases even defined for quotient rings?). This has likely never worked.",
    "created_at": "2022-01-22T15:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662642",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:1'></a>
Currently, the implementation first computes `J.groebner_basis()` which seems to compute the Gröbner basis in the cover ring `R` and maps the result to `Q`, discarding elements that are `0`. Then it performs reduction with respect to this sequence of quotient ring elements (which does not appear meaningful – are Gröbner bases even defined for quotient rings?). This has likely never worked.



---

archive/issue_comments_662643.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe example in the description comes from this computation which depends on the correct behavior of `reduce`:\n\n```\nsage: A.<x,y,z> = QQ['X,Y,Z'].quotient('X^2+Y^2+Z^2-1')\nsage: B.<t,u,v,w> = QQ['T,U,V,W'].quotient(['T^2+U^2-1', 'V^2+W^2-1'])\nsage: psi = A.hom([v*u, w*u, t], B)\nsage: psi(z^2) == t^2  # z^2 is a preimage\nTrue\nsage: psi.inverse_image(t^2)  # but z^2 is a preimage\n...\nValueError: element -u^2 + 1 does not have preimage\n```",
    "created_at": "2022-01-22T15:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662643",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:2'></a>
The example in the description comes from this computation which depends on the correct behavior of `reduce`:

```
sage: A.<x,y,z> = QQ['X,Y,Z'].quotient('X^2+Y^2+Z^2-1')
sage: B.<t,u,v,w> = QQ['T,U,V,W'].quotient(['T^2+U^2-1', 'V^2+W^2-1'])
sage: psi = A.hom([v*u, w*u, t], B)
sage: psi(z^2) == t^2  # z^2 is a preimage
True
sage: psi.inverse_image(t^2)  # but z^2 is a preimage
...
ValueError: element -u^2 + 1 does not have preimage
```



---

archive/issue_comments_662644.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe equivalent computation in Singular works correctly:\n\n```\n> ring R = 0, (t,u,v,w,x,y,z), lp;\n> ideal I = t^2+u^2-1, v^2+w^2-1, x^2+y^2+z^2-1;\n> qring Q = std(I);\n> ideal J = u*v-x, u*w-y, t-z;\n> reduce(t^2 - z^2, std(J));\n0\n```\n\nAlso, Singular returns the same Gr\u00f6bner basis for `J` as Sage does:\n\n```\n> std(J);\n_[1]=w2z2-w2+y2\n_[2]=vy-wx\n_[3]=vwz2-vw+xy\n_[4]=vwx+w2y-y\n_[5]=u-vx-wy\n_[6]=t-z\n```\n\n```\nsage: J.groebner_basis()\n[t - z, u - v*x - w*y, v*w*x + w^2*y - y, v*w*z^2 - v*w + x*y, v*y - w*x, w^2*z^2 - w^2 + y^2]\n```\nSo perhaps Gr\u00f6bner bases in quotient rings can be meaningful, but the implementation of `reduce` in Sage does not handle this case correctly.",
    "created_at": "2022-01-22T17:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662644",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:3'></a>
The equivalent computation in Singular works correctly:

```
> ring R = 0, (t,u,v,w,x,y,z), lp;
> ideal I = t^2+u^2-1, v^2+w^2-1, x^2+y^2+z^2-1;
> qring Q = std(I);
> ideal J = u*v-x, u*w-y, t-z;
> reduce(t^2 - z^2, std(J));
0
```

Also, Singular returns the same Gröbner basis for `J` as Sage does:

```
> std(J);
_[1]=w2z2-w2+y2
_[2]=vy-wx
_[3]=vwz2-vw+xy
_[4]=vwx+w2y-y
_[5]=u-vx-wy
_[6]=t-z
```

```
sage: J.groebner_basis()
[t - z, u - v*x - w*y, v*w*x + w^2*y - y, v*w*z^2 - v*w + x*y, v*y - w*x, w^2*z^2 - w^2 + y^2]
```
So perhaps Gröbner bases in quotient rings can be meaningful, but the implementation of `reduce` in Sage does not handle this case correctly.



---

archive/issue_comments_662645.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n    ...\n ```\n \n-The expected behavior would be the same as lifting the ideal `J` to the cover ring `R`, perform reduction there (in terms of the ideal generated by `I` and the lifted generators of `J`) and map the result back to `Q`:\n+The expected behavior would be the same as lifting the ideal `J` to the cover ring `R`, perform reduction there (in terms of the ideal generated by `I` and the lifted generators of `J`) and map the result back to `Q` (by e.g. Thm. 9.19 in [https://doc.sagemath.org/html/en/reference/references/index.html#bw1993 [BW1993]]):\n \n ```\n sage: Q(Q.cover().inverse_image(J).reduce((t^2 - z^2).lift()))  # correct\n``````\n",
    "created_at": "2022-01-22T19:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662645",
    "user": "https://github.com/mwageringel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
    ...
 ```
 
-The expected behavior would be the same as lifting the ideal `J` to the cover ring `R`, perform reduction there (in terms of the ideal generated by `I` and the lifted generators of `J`) and map the result back to `Q`:
+The expected behavior would be the same as lifting the ideal `J` to the cover ring `R`, perform reduction there (in terms of the ideal generated by `I` and the lifted generators of `J`) and map the result back to `Q` (by e.g. Thm. 9.19 in [https://doc.sagemath.org/html/en/reference/references/index.html#bw1993 [BW1993]]):
 
 ```
 sage: Q(Q.cover().inverse_image(J).reduce((t^2 - z^2).lift()))  # correct
``````




---

archive/issue_comments_662646.json:
```json
{
    "body": "**Author:** Markus Wageringel",
    "created_at": "2022-01-23T11:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662646",
    "user": "https://github.com/mwageringel"
}
```

**Author:** Markus Wageringel



---

archive/issue_comments_662647.json:
```json
{
    "body": "**Branch:** [u/gh-mwageringel/33217](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33217)",
    "created_at": "2022-01-23T11:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662647",
    "user": "https://github.com/mwageringel"
}
```

**Branch:** [u/gh-mwageringel/33217](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33217)



---

archive/issue_comments_662648.json:
```json
{
    "body": "**Commit:** [927f3acc224b2c343094eca177d28eea4024397e](https://github.com/sagemath/sagetrac-mirror/commit/927f3acc224b2c343094eca177d28eea4024397e)",
    "created_at": "2022-01-23T11:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662648",
    "user": "https://github.com/mwageringel"
}
```

**Commit:** [927f3acc224b2c343094eca177d28eea4024397e](https://github.com/sagemath/sagetrac-mirror/commit/927f3acc224b2c343094eca177d28eea4024397e)



---

archive/issue_comments_662649.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe result of `J.groebner_basis()` in the quotient ring is indeed meaningful in the sense that, *when combined with `I.groebner_basis()`* (and only then) one obtains a Gr\u00f6bner basis of `J` lifted to the cover ring `R`.\n\nMore precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gr\u00f6bner bases of `J0+I`, `I`, then in particular the union `G0 \u222a H` is a Gr\u00f6bner basis of `J0+I`. Therefore, also the union `G \u222a H` is a (possibly non-reduced) Gr\u00f6bner basis of `J0+I`, where `G` is defined as the reduction of `G0` modulo `I` (as returned by `J.groebner_basis()`).\n\nThis is also what Singular does via `kNF` > [kNF2](https://github.com/Singular/Singular/blob/572022cd0bd2d93d436a2d2ed8c5b2c7e3f4f4f1/kernel/GBEngine/kstd2.cc#L3738) > [initS](https://github.com/Singular/Singular/blob/7be1d21a7379ce28be9574c8b6e13800001a7653/kernel/GBEngine/kutil.cc#L7908).\n\nI have fixed this for the `reduce` method of multivariate polynomial ideals in quotient rings. For the `reduce` method of generic quotient ring elements (which does not claim to return minimal results), I have just added a warning about this to the documentation.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/927f3acc224b2c343094eca177d28eea4024397e\">927f3ac</a></td><td><code>33217: fix reduction for ideals in quotient polynomial rings</code></td></tr></table>\n",
    "created_at": "2022-01-23T11:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662649",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:5'></a>
The result of `J.groebner_basis()` in the quotient ring is indeed meaningful in the sense that, *when combined with `I.groebner_basis()`* (and only then) one obtains a Gröbner basis of `J` lifted to the cover ring `R`.

More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gröbner bases of `J0+I`, `I`, then in particular the union `G0 ∪ H` is a Gröbner basis of `J0+I`. Therefore, also the union `G ∪ H` is a (possibly non-reduced) Gröbner basis of `J0+I`, where `G` is defined as the reduction of `G0` modulo `I` (as returned by `J.groebner_basis()`).

This is also what Singular does via `kNF` > [kNF2](https://github.com/Singular/Singular/blob/572022cd0bd2d93d436a2d2ed8c5b2c7e3f4f4f1/kernel/GBEngine/kstd2.cc#L3738) > [initS](https://github.com/Singular/Singular/blob/7be1d21a7379ce28be9574c8b6e13800001a7653/kernel/GBEngine/kutil.cc#L7908).

I have fixed this for the `reduce` method of multivariate polynomial ideals in quotient rings. For the `reduce` method of generic quotient ring elements (which does not claim to return minimal results), I have just added a warning about this to the documentation.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/927f3acc224b2c343094eca177d28eea4024397e">927f3ac</a></td><td><code>33217: fix reduction for ideals in quotient polynomial rings</code></td></tr></table>




---

archive/issue_comments_662650.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2022-01-23T11:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662650",
    "user": "https://github.com/mwageringel"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_662651.json:
```json
{
    "body": "<a id='comment:7'></a>\nI am not sure how I feel about testing if the ring is a quotient ring versus doing a proper subclass of the ideal for quotient rings. Granted, it is not too much technical debt as it is easy to separate later.\n\nAre there any other methods that will need similar changes (such as `groebner_basis()`)? I don't think so from a quick look, but perhaps you know better.",
    "created_at": "2022-01-28T00:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662651",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
I am not sure how I feel about testing if the ring is a quotient ring versus doing a proper subclass of the ideal for quotient rings. Granted, it is not too much technical debt as it is easy to separate later.

Are there any other methods that will need similar changes (such as `groebner_basis()`)? I don't think so from a quick look, but perhaps you know better.



---

archive/issue_comments_662652.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [gh-mwageringel](#comment%3A5):\n\n> More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gr\u00f6bner bases of `J0+I`, `I`, \n\n\nYou mean `J0` here, not `J0+I`. Right?\n\n>then in particular the union `G0 \u222a H` is a Gr\u00f6bner basis of `J0+I`. \n\n\nThen you say `G0 \u222a H` is a Groebner basis of `J0 + I`? This is not generally true.",
    "created_at": "2022-01-28T02:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662652",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:8'></a>
Replying to [gh-mwageringel](#comment%3A5):

> More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gröbner bases of `J0+I`, `I`, 


You mean `J0` here, not `J0+I`. Right?

>then in particular the union `G0 ∪ H` is a Gröbner basis of `J0+I`. 


Then you say `G0 ∪ H` is a Groebner basis of `J0 + I`? This is not generally true.



---

archive/issue_comments_662653.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [tscrim](#comment%3A7):\n> I am not sure how I feel about testing if the ring is a quotient ring versus doing a proper subclass of the ideal for quotient rings. Granted, it is not too much technical debt as it is easy to separate later.\n\n\nYou are right. It is better to move this to a subclass. I will try to implement it. Something similar is done in #33237 right now, but probably there is no overlap with multivariate polynomial rings.\n\n> Are there any other methods that will need similar changes (such as `groebner_basis()`)? I don't think so from a quick look, but perhaps you know better.\n\n\nThe `groebner_basis` method works for rings backed by Singular. The more obscure cases like rings over large finite fields or the polydict implementation result in an error:\n\n```\nsage: R.<T,U,V,W,X,Y,Z> = PolynomialRing(GF(2147483659), order='lex')\nsage: Q.<t,u,v,w,x,y,z> = R.quotient(R.ideal([T^2+U^2-1, V^2+W^2-1, X^2+Y^2+Z^2-1]))\nverbose 0 (3837: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.\nsage: J = Q.ideal([u*v-x, u*w-y, t-z])\nsage: J.groebner_basis()\n...\nAttributeError: 'QuotientRing_generic_with_category' object has no attribute 'monomial_pairwise_prime'\n```\nThough, this might be a problem of the quotient ring class rather than the ideal.\n\n\n\nReplying to [klee](#comment%3A8):\n> Replying to [gh-mwageringel](#comment%3A5):\n> \n> > More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gr\u00f6bner bases of `J0+I`, `I`, \n\n> \n> You mean `J0` here, not `J0+I`. Right?\n\n\nNo, `J0+I` is actually what I meant, since it is the preimage of `J`, when `J0` is defined as the ideal generated by representatives of generators of `J`. Then `G0 \u222a H` is a Gr\u00f6bner basis as it is a super set of the Gr\u00f6bner basis `G0` of `J0+I`.\n\n`J.groebner_basis()` computes the Gr\u00f6bner basis in terms of `J0+I`, not just `J0` \u2013 otherwise it would indeed be a problem.",
    "created_at": "2022-01-28T09:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662653",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:9'></a>
Replying to [tscrim](#comment%3A7):
> I am not sure how I feel about testing if the ring is a quotient ring versus doing a proper subclass of the ideal for quotient rings. Granted, it is not too much technical debt as it is easy to separate later.


You are right. It is better to move this to a subclass. I will try to implement it. Something similar is done in #33237 right now, but probably there is no overlap with multivariate polynomial rings.

> Are there any other methods that will need similar changes (such as `groebner_basis()`)? I don't think so from a quick look, but perhaps you know better.


The `groebner_basis` method works for rings backed by Singular. The more obscure cases like rings over large finite fields or the polydict implementation result in an error:

```
sage: R.<T,U,V,W,X,Y,Z> = PolynomialRing(GF(2147483659), order='lex')
sage: Q.<t,u,v,w,x,y,z> = R.quotient(R.ideal([T^2+U^2-1, V^2+W^2-1, X^2+Y^2+Z^2-1]))
verbose 0 (3837: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.
sage: J = Q.ideal([u*v-x, u*w-y, t-z])
sage: J.groebner_basis()
...
AttributeError: 'QuotientRing_generic_with_category' object has no attribute 'monomial_pairwise_prime'
```
Though, this might be a problem of the quotient ring class rather than the ideal.



Replying to [klee](#comment%3A8):
> Replying to [gh-mwageringel](#comment%3A5):
> 
> > More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gröbner bases of `J0+I`, `I`, 

> 
> You mean `J0` here, not `J0+I`. Right?


No, `J0+I` is actually what I meant, since it is the preimage of `J`, when `J0` is defined as the ideal generated by representatives of generators of `J`. Then `G0 ∪ H` is a Gröbner basis as it is a super set of the Gröbner basis `G0` of `J0+I`.

`J.groebner_basis()` computes the Gröbner basis in terms of `J0+I`, not just `J0` – otherwise it would indeed be a problem.



---

archive/issue_comments_662654.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2022-01-28T09:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662654",
    "user": "https://github.com/mwageringel"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_662655.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [gh-mwageringel](#comment%3A9):\n> > > More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gr\u00f6bner bases of `J0+I`, `I`, \n\n> > \n> > You mean `J0` here, not `J0+I`. Right?\n\n> \n> No, `J0+I` is actually what I meant, since it is the preimage of `J`, when `J0` is defined as the ideal generated by representatives of generators of `J`. Then `G0 \u222a H` is a Gr\u00f6bner basis as it is a super set of the Gr\u00f6bner basis `G0` of `J0+I`.\n\n\nOkay. Now I understand. Thanks.",
    "created_at": "2022-01-28T11:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662655",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:11'></a>
Replying to [gh-mwageringel](#comment%3A9):
> > > More precisely: If `J0`, `I` are ideals in `R` (such that `J = (J0+I)/I`) and if `G0`, `H` are Gröbner bases of `J0+I`, `I`, 

> > 
> > You mean `J0` here, not `J0+I`. Right?

> 
> No, `J0+I` is actually what I meant, since it is the preimage of `J`, when `J0` is defined as the ideal generated by representatives of generators of `J`. Then `G0 ∪ H` is a Gröbner basis as it is a super set of the Gröbner basis `G0` of `J0+I`.


Okay. Now I understand. Thanks.



---

archive/issue_comments_662656.json:
```json
{
    "body": "**Changing commit** from \"[927f3acc224b2c343094eca177d28eea4024397e](https://github.com/sagemath/sagetrac-mirror/commit/927f3acc224b2c343094eca177d28eea4024397e)\" to \"[e0d5533de4b5e4747c2848348779dee0410868aa](https://github.com/sagemath/sagetrac-mirror/commit/e0d5533de4b5e4747c2848348779dee0410868aa)\".",
    "created_at": "2022-01-29T17:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662656",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[927f3acc224b2c343094eca177d28eea4024397e](https://github.com/sagemath/sagetrac-mirror/commit/927f3acc224b2c343094eca177d28eea4024397e)" to "[e0d5533de4b5e4747c2848348779dee0410868aa](https://github.com/sagemath/sagetrac-mirror/commit/e0d5533de4b5e4747c2848348779dee0410868aa)".



---

archive/issue_comments_662657.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96c242edefed598e2747d9603e84d11ee5be6045\">96c242e</a></td><td><code>33217: fix reduction for ideals in quotient polynomial rings</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0d5533de4b5e4747c2848348779dee0410868aa\">e0d5533</a></td><td><code>33217: implement richcmp for ideals in polynomial quotient rings</code></td></tr></table>\n",
    "created_at": "2022-01-29T17:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96c242edefed598e2747d9603e84d11ee5be6045">96c242e</a></td><td><code>33217: fix reduction for ideals in quotient polynomial rings</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0d5533de4b5e4747c2848348779dee0410868aa">e0d5533</a></td><td><code>33217: implement richcmp for ideals in polynomial quotient rings</code></td></tr></table>




---

archive/issue_comments_662658.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2022-01-29T17:12:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662658",
    "user": "https://github.com/mwageringel"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_662659.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [tscrim](#comment%3A7):\n> Are there any other methods that will need similar changes (such as `groebner_basis()`)? I don't think so from a quick look, but perhaps you know better.\n\n\nI have now moved the implementation to a new subclass. I have also fixed the implementations of `_contains_` and `__richcmp__` which could otherwise return wrong results. These are the only methods I could find that can silently return incorrect results. Many other methods will raise an error though.",
    "created_at": "2022-01-29T17:12:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662659",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:13'></a>
Replying to [tscrim](#comment%3A7):
> Are there any other methods that will need similar changes (such as `groebner_basis()`)? I don't think so from a quick look, but perhaps you know better.


I have now moved the implementation to a new subclass. I have also fixed the implementations of `_contains_` and `__richcmp__` which could otherwise return wrong results. These are the only methods I could find that can silently return incorrect results. Many other methods will raise an error though.



---

archive/issue_comments_662660.json:
```json
{
    "body": "<a id='comment:14'></a>\nThank you. I think you are correct in your assessment that the issue you bring up is with the quotient ring implementation.\n\nOne thing that should be reverted is the change to `quotient_ring.py` in the latest commits. That is needed for the modularization IIRC.",
    "created_at": "2022-01-30T00:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662660",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Thank you. I think you are correct in your assessment that the issue you bring up is with the quotient ring implementation.

One thing that should be reverted is the change to `quotient_ring.py` in the latest commits. That is needed for the modularization IIRC.



---

archive/issue_comments_662661.json:
```json
{
    "body": "**Changing commit** from \"[e0d5533de4b5e4747c2848348779dee0410868aa](https://github.com/sagemath/sagetrac-mirror/commit/e0d5533de4b5e4747c2848348779dee0410868aa)\" to \"[0cc8b67568c8df6111dfac37f4c122457da96740](https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740)\".",
    "created_at": "2022-01-30T09:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e0d5533de4b5e4747c2848348779dee0410868aa](https://github.com/sagemath/sagetrac-mirror/commit/e0d5533de4b5e4747c2848348779dee0410868aa)" to "[0cc8b67568c8df6111dfac37f4c122457da96740](https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740)".



---

archive/issue_comments_662662.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740\">0cc8b67</a></td><td><code>33217: revert import for modularization</code></td></tr></table>\n",
    "created_at": "2022-01-30T09:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662662",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740">0cc8b67</a></td><td><code>33217: revert import for modularization</code></td></tr></table>




---

archive/issue_comments_662663.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [tscrim](#comment%3A14):\n> One thing that should be reverted is the change to `quotient_ring.py` in the latest commits. That is needed for the modularization IIRC.\n\n\nThanks for catching that. I have reverted the import to its previous format. Though, I have to admit I do not fully understand the reasoning behind it yet.",
    "created_at": "2022-01-30T09:39:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662663",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:16'></a>
Replying to [tscrim](#comment%3A14):
> One thing that should be reverted is the change to `quotient_ring.py` in the latest commits. That is needed for the modularization IIRC.


Thanks for catching that. I have reverted the import to its previous format. Though, I have to admit I do not fully understand the reasoning behind it yet.



---

archive/issue_comments_662664.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [gh-mwageringel](#comment%3A16):\n> Replying to [tscrim](#comment%3A14):\n> > One thing that should be reverted is the change to `quotient_ring.py` in the latest commits. That is needed for the modularization IIRC.\n\n> \n> Thanks for catching that. I have reverted the import to its previous format. Though, I have to admit I do not fully understand the reasoning behind it yet.\n\n\nMy understanding is it is because someone (in the future I think, not yet) could have loaded/installed the quotient rings but not the polynomial rings. This removes it as a compile-time dependency IIRC.\n\nDoes anyone else have any other comments? I am ready to set this to a positive review (once the patchbot gets around to it).",
    "created_at": "2022-01-31T02:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662664",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Replying to [gh-mwageringel](#comment%3A16):
> Replying to [tscrim](#comment%3A14):
> > One thing that should be reverted is the change to `quotient_ring.py` in the latest commits. That is needed for the modularization IIRC.

> 
> Thanks for catching that. I have reverted the import to its previous format. Though, I have to admit I do not fully understand the reasoning behind it yet.


My understanding is it is because someone (in the future I think, not yet) could have loaded/installed the quotient rings but not the polynomial rings. This removes it as a compile-time dependency IIRC.

Does anyone else have any other comments? I am ready to set this to a positive review (once the patchbot gets around to it).



---

archive/issue_comments_662665.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2022-01-31T02:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662665",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_662666.json:
```json
{
    "body": "<a id='comment:18'></a>\nThe patchbot is green. If there are any other comments, feel free to revert the positive review.",
    "created_at": "2022-02-01T01:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662666",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
The patchbot is green. If there are any other comments, feel free to revert the positive review.



---

archive/issue_comments_662667.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-02-01T01:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662667",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_662668.json:
```json
{
    "body": "<a id='comment:19'></a>\nThank you both for your comments.",
    "created_at": "2022-02-01T18:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662668",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:19'></a>
Thank you both for your comments.



---

archive/issue_comments_662669.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2022-02-13T10:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662669",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_098713.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-13T10:16:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33217#event-98713"
}
```



---

archive/issue_comments_662670.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-mwageringel/33217](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33217)\" to \"[0cc8b67568c8df6111dfac37f4c122457da96740](https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740)\".",
    "created_at": "2022-02-13T10:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33217",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33217#issuecomment-662670",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/gh-mwageringel/33217](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/33217)" to "[0cc8b67568c8df6111dfac37f4c122457da96740](https://github.com/sagemath/sagetrac-mirror/commit/0cc8b67568c8df6111dfac37f4c122457da96740)".
