# Issue 33320: Rework on live sage documentation

archive/issues_033083.json:
```json
{
    "body": "As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n\nAs we move to the new tool, the ticket\n\n- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n\nwas closed.\n\nBased on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n\nThis ticket patches `jupyter-sphinx` with \n- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n\n## Preparation before build\nSuppress warnings by\n\n```\nsage -i debugpy \nsage -pip install soupsieve \n```\n\nInstall jupyterlab (for live doc with a local server) \n\n```\nsage -i jupyterlab_widgets\n```\n\n## Build\n\n- Default static doc: \n\n```\nmake\n```\n\n- Live doc with binder server:\n\n```\nexport SAGE_LIVE_DOC=yes\nmake\n```\n\n- Live doc with local server:\n  {{{\n  export SAGE_LIVE_DOC=yes\n  export SAGE_JUPYTER_SERVER=http://localhost:8889\n  export SAGE_JUPYTER_SERVER_TOKEN=secret  # default \n  make\n  }}}\n  Run\n  {{{\n  sage --notebook=jupyterlab \\\n    --ServerApp.token='secret' \\\n    --ServerApp.allow_origin='null' \\\n    --ServerApp.disable_check_xsrf=true \\\n    --ServerApp.port=8889 \\\n    --ServerApp.open_browser=false \n  }}}\n  before browsing the documentation.\n\nIf things do not work as expected, removing the existing documentation by\n\n```\nmake doc-clean doc-uninstall\n```\nmay be necessary before `make`. If this is burdensome, try first\n\n```\nsage --docbuild reference_top html\n```\nwhich updates static files (javascripts) directory.\n\n## Selective Build\n\nBuild static doc\n\n```\nmake\n```\nand then build live doc selectively either by\n\n```\nsage --docbuild --live-doc prep html\n```\nor by\n\n```\nexport SAGE_JUPYTER_SERVER=http://localhost:8889\nexport SAGE_JUPYTER_SERVER_TOKEN=secret  # default \nsage --docbuild --live-doc prep html\n```\n\n## Direct use of `.. JUPYTER-EXECUTE::` is deprecated\n\nAs #33507 added jupyter-sphinx extension to Sphinx conf, it provided `.. JUPYTER-EXECUTE::` directive to documentation authors to add executable code blocks. As the present ticket allows to build the live documentation in which all code blocks are executable, direct use of the directive by documentation authors is deprecated. Along with this change, an issue of heavy javascript injections, which slows down documentation pages loading time, is fixed in this ticket.\n\n\n\n\n\n\n\nCC:  @jhpalmieri\n\nAuthor: Kwankyu Lee\n\nBranch: public/33320\n\nStatus: needs_work\n\nDependencies: #33763\n\nCommit: f5dff4392a2551e9ae7634ecadccd53ec2158ac7\n\nIssue created by migration from https://trac.sagemath.org/ticket/33320\n\n",
    "created_at": "2022-02-10T12:20:51Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Rework on live sage documentation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33320",
    "user": "https://github.com/kwankyu"
}
```
As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.

As we move to the new tool, the ticket

- #24593 "Provide live documentation support in Jupyter using Thebe"

was closed.

Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.

This ticket patches `jupyter-sphinx` with 
- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1

## Preparation before build
Suppress warnings by

```
sage -i debugpy 
sage -pip install soupsieve 
```

Install jupyterlab (for live doc with a local server) 

```
sage -i jupyterlab_widgets
```

## Build

- Default static doc: 

```
make
```

- Live doc with binder server:

```
export SAGE_LIVE_DOC=yes
make
```

- Live doc with local server:
  {{{
  export SAGE_LIVE_DOC=yes
  export SAGE_JUPYTER_SERVER=http://localhost:8889
  export SAGE_JUPYTER_SERVER_TOKEN=secret  # default 
  make
  }}}
  Run
  {{{
  sage --notebook=jupyterlab \
    --ServerApp.token='secret' \
    --ServerApp.allow_origin='null' \
    --ServerApp.disable_check_xsrf=true \
    --ServerApp.port=8889 \
    --ServerApp.open_browser=false 
  }}}
  before browsing the documentation.

If things do not work as expected, removing the existing documentation by

```
make doc-clean doc-uninstall
```
may be necessary before `make`. If this is burdensome, try first

```
sage --docbuild reference_top html
```
which updates static files (javascripts) directory.

## Selective Build

Build static doc

```
make
```
and then build live doc selectively either by

```
sage --docbuild --live-doc prep html
```
or by

```
export SAGE_JUPYTER_SERVER=http://localhost:8889
export SAGE_JUPYTER_SERVER_TOKEN=secret  # default 
sage --docbuild --live-doc prep html
```

## Direct use of `.. JUPYTER-EXECUTE::` is deprecated

As #33507 added jupyter-sphinx extension to Sphinx conf, it provided `.. JUPYTER-EXECUTE::` directive to documentation authors to add executable code blocks. As the present ticket allows to build the live documentation in which all code blocks are executable, direct use of the directive by documentation authors is deprecated. Along with this change, an issue of heavy javascript injections, which slows down documentation pages loading time, is fixed in this ticket.







CC:  @jhpalmieri

Author: Kwankyu Lee

Branch: public/33320

Status: needs_work

Dependencies: #33763

Commit: f5dff4392a2551e9ae7634ecadccd53ec2158ac7

Issue created by migration from https://trac.sagemath.org/ticket/33320





---

archive/issue_comments_503645.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -2,9 +2,23 @@\n \n This ticket is to revive Thebe as a long term goal.\n \n+Latest documentation of Thebe:\n+\n+- https://thebe.readthedocs.io/en/latest/\n+\n+Code at [GitHub](GitHub):\n+\n+- https://github.com/executablebooks/thebe\n+\n+Demo page (working!):\n+\n+- https://sage-package.readthedocs.io/en/latest/sage_package/sphinx-demo.html\n+\n Related tickets:\n \n-- #24593\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2022-02-10T12:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503645",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -2,9 +2,23 @@
 
 This ticket is to revive Thebe as a long term goal.
 
+Latest documentation of Thebe:
+
+- https://thebe.readthedocs.io/en/latest/
+
+Code at [GitHub](GitHub):
+
+- https://github.com/executablebooks/thebe
+
+Demo page (working!):
+
+- https://sage-package.readthedocs.io/en/latest/sage_package/sphinx-demo.html
+
 Related tickets:
 
-- #24593
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+
 
 Comment: 1
 
```




---

archive/issue_comments_503646.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,23 @@\n+As Thebe is not working in our Sage documentation, we turned it off. See #33309.\n+\n+This ticket is to revive Thebe as a long term goal.\n+\n+Latest documentation of Thebe:\n+\n+- https://thebe.readthedocs.io/en/latest/\n+\n+Code at [GitHub](GitHub):\n+\n+- https://github.com/executablebooks/thebe\n+\n+Demo page (working!):\n+\n+- https://sage-package.readthedocs.io/en/latest/sage_package/sphinx-demo.html\n+\n+Related tickets:\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-02-10T12:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503646",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,23 @@
+As Thebe is not working in our Sage documentation, we turned it off. See #33309.
+
+This ticket is to revive Thebe as a long term goal.
+
+Latest documentation of Thebe:
+
+- https://thebe.readthedocs.io/en/latest/
+
+Code at [GitHub](GitHub):
+
+- https://github.com/executablebooks/thebe
+
+Demo page (working!):
+
+- https://sage-package.readthedocs.io/en/latest/sage_package/sphinx-demo.html
+
+Related tickets:
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
 
 
 Comment: 1
```




---

archive/issue_comments_503647.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to documentation.",
    "created_at": "2022-03-22T02:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503647",
    "user": "https://github.com/mkoeppe"
}
```

Changing component from PLEASE CHANGE to documentation.



---

archive/issue_events_087929.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-22T08:21:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87929"
}
```



---

archive/issue_comments_503648.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-22T08:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503648",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_503649.json:
```json
{
    "body": "<a id='comment:4'></a>Achieved by #33507.",
    "created_at": "2022-03-22T08:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503649",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:4'></a>Achieved by #33507.



---

archive/issue_comments_503650.json:
```json
{
    "body": "<a id='comment:5'></a>Isn't the goal that every cell on every documentation page can be activated?",
    "created_at": "2022-03-22T16:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503650",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Isn't the goal that every cell on every documentation page can be activated?



---

archive/issue_comments_503651.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,27 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+Latest documentation of Thebe:\n+\n+- https://thebe.readthedocs.io/en/latest/\n+\n+Code at [GitHub](GitHub):\n+\n+- https://github.com/executablebooks/thebe\n+\n+Demo page (working!):\n+\n+- https://sage-package.readthedocs.io/en/latest/sage_package/sphinx-demo.html\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-23T00:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503651",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,27 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+Latest documentation of Thebe:
+
+- https://thebe.readthedocs.io/en/latest/
+
+Code at [GitHub](GitHub):
+
+- https://github.com/executablebooks/thebe
+
+Demo page (working!):
+
+- https://sage-package.readthedocs.io/en/latest/sage_package/sphinx-demo.html
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503652.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2022-03-23T00:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503652",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_events_087930.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-23T00:20:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87930"
}
```



---

archive/issue_events_087931.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-23T00:20:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87931"
}
```



---

archive/issue_comments_503653.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:5 mkoeppe]:\n> Isn't the goal that every cell on every documentation page can be activated?\n\n\nOkay. I felt I was missing something.",
    "created_at": "2022-03-23T00:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503653",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'></a>Replying to [comment:5 mkoeppe]:
> Isn't the goal that every cell on every documentation page can be activated?


Okay. I felt I was missing something.



---

archive/issue_comments_503654.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-03-24T12:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503654",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_events_087932.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-24T12:40:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87932"
}
```



---

archive/issue_events_087933.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-24T12:40:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87933"
}
```



---

archive/issue_comments_503655.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-03-25T02:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503655",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_503656.json:
```json
{
    "body": "<a id='comment:13'></a>To use a local jupyter server for live doc: in `src/sage/docs/conf.py`,\n\n```\n# comment out if local jupyter server is running\njupyter_sphinx_thebelab_config.update({\n    'binderOptions': {\n        'repo': \"sagemath/sage-binder-env\",\n    },\n})\n```\nand rebuild the doc.\n\n\n\nTo view the live doc, run\n\n```\nsage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n```\nand open the doc.",
    "created_at": "2022-03-25T02:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503656",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:13'></a>To use a local jupyter server for live doc: in `src/sage/docs/conf.py`,

```
# comment out if local jupyter server is running
jupyter_sphinx_thebelab_config.update({
    'binderOptions': {
        'repo': "sagemath/sage-binder-env",
    },
})
```
and rebuild the doc.



To view the live doc, run

```
sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
```
and open the doc.



---

archive/issue_comments_503657.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-25T05:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503658.json:
```json
{
    "body": "<a id='comment:15'></a>Now the procedure to use a local server is \n\n```\nexport JUPYTER_SERVER='http://localhost:8888'\nexport JUPYTER_SERVER_TOKEN='secret'\n```\nand rebuild the doc. No need to touch `conf.py`.",
    "created_at": "2022-03-25T05:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503658",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:15'></a>Now the procedure to use a local server is 

```
export JUPYTER_SERVER='http://localhost:8888'
export JUPYTER_SERVER_TOKEN='secret'
```
and rebuild the doc. No need to touch `conf.py`.



---

archive/issue_comments_503659.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2022-03-26T13:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503659",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_503660.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,50 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+---\n+\n+Preparation (more than necessary):\n+\n+```\n+sage -i jupyterlab_widgets\n+sage -i debugpy  \n+sage -pip install --upgrade nbconvert\n+```\n+\n+Fix a bug and suppress a warning:\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.\n+\n+\n+---\n+Latest documentation of Thebe:\n+\n+- https://thebe.readthedocs.io/en/latest/\n+\n+Code at [GitHub](GitHub):\n+\n+- https://github.com/executablebooks/thebe\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-26T13:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503660",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,50 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+---
+
+Preparation (more than necessary):
+
+```
+sage -i jupyterlab_widgets
+sage -i debugpy  
+sage -pip install --upgrade nbconvert
+```
+
+Fix a bug and suppress a warning:
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.
+
+
+---
+Latest documentation of Thebe:
+
+- https://thebe.readthedocs.io/en/latest/
+
+Code at [GitHub](GitHub):
+
+- https://github.com/executablebooks/thebe
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503661.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-26T13:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503662.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-26T22:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503662",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503663.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,80 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+---\n+\n+Install j:\n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+Suppress warnings:\n+\n+```\n+sage -i debugpy  \n+sage -pip install --upgrade nbconvert\n+```\n+Fix a bug and suppress a warning:\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.\n+\n+---\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+---\n+Latest documentation of Thebe:\n+\n+- https://thebe.readthedocs.io/en/latest/\n+\n+Code at [GitHub](GitHub):\n+\n+- https://github.com/executablebooks/thebe\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T08:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503663",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,80 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+---
+
+Install j:
+
+```
+sage -i jupyterlab_widgets
+```
+Suppress warnings:
+
+```
+sage -i debugpy  
+sage -pip install --upgrade nbconvert
+```
+Fix a bug and suppress a warning:
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.
+
+---
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+---
+Latest documentation of Thebe:
+
+- https://thebe.readthedocs.io/en/latest/
+
+Code at [GitHub](GitHub):
+
+- https://github.com/executablebooks/thebe
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503664.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-27T08:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503665.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,65 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+---\n+\n+Suppress warnings:\n+\n+```\n+sage -i debugpy  \n+sage -pip install --upgrade nbconvert\n+```\n+Fix a bug and suppress a warning:\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.\n+\n+---\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T08:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503665",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,65 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+---
+
+Suppress warnings:
+
+```
+sage -i debugpy  
+sage -pip install --upgrade nbconvert
+```
+Fix a bug and suppress a warning:
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.
+
+---
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503666.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-27T10:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503666",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503667.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,73 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+---\n+\n+Suppress warnings:\n+\n+```\n+sage -i debugpy  \n+```\n+Fix a bug and suppress a warning, by replacing\n+\n+```python\n+notebook = execute_cells(                                          \n+    kernel_name,                                                   \n+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  \n+    self.config.jupyter_execute_kwargs,                            \n+)                                                                  \n+```\n+with\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.\n+\n+---\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T11:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503667",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,73 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+---
+
+Suppress warnings:
+
+```
+sage -i debugpy  
+```
+Fix a bug and suppress a warning, by replacing
+
+```python
+notebook = execute_cells(                                          
+    kernel_name,                                                   
+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  
+    self.config.jupyter_execute_kwargs,                            
+)                                                                  
+```
+with
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.
+
+---
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503668.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,72 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+Fix a bug and suppress a warning, by replacing\n+\n+```python\n+notebook = execute_cells(                                          \n+    kernel_name,                                                   \n+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  \n+    self.config.jupyter_execute_kwargs,                            \n+)                                                                  \n+```\n+with\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T11:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503668",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,72 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+Fix a bug and suppress a warning, by replacing
+
+```python
+notebook = execute_cells(                                          
+    kernel_name,                                                   
+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  
+    self.config.jupyter_execute_kwargs,                            
+)                                                                  
+```
+with
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503669.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,82 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+Fix a bug and suppress a warning, by replacing\n+\n+```python\n+notebook = execute_cells(                                          \n+    kernel_name,                                                   \n+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  \n+    self.config.jupyter_execute_kwargs,                            \n+)                                                                  \n+```\n+with\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.\n+\n+Install jupyterlab \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+Currently this introduces an error while building. Fix this by\n+\n+```\n+sage -pip install --upgrade nbconvert\n+```\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T11:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503669",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,82 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+Fix a bug and suppress a warning, by replacing
+
+```python
+notebook = execute_cells(                                          
+    kernel_name,                                                   
+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  
+    self.config.jupyter_execute_kwargs,                            
+)                                                                  
+```
+with
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`.
+
+Install jupyterlab 
+
+```
+sage -i jupyterlab_widgets
+```
+Currently this introduces an error while building. Fix this by
+
+```
+sage -pip install --upgrade nbconvert
+```
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503670.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,84 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+Fix a bug and suppress a warning, by replacing\n+\n+```python\n+notebook = execute_cells(                                          \n+    kernel_name,                                                   \n+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  \n+    self.config.jupyter_execute_kwargs,                            \n+)                                                                  \n+```\n+with\n+\n+```python\n+import warnings                                                                                 \n+with warnings.catch_warnings():                                                                 \n+    warnings.simplefilter(\"ignore\")                                                             \n+    notebook = execute_cells(                                                                   \n+        kernel_name,                                                                            \n+        [nbformat.v4.new_code_cell(node.astext() if node[\"execute\"] else \"\") for node in nodes],\n+        self.config.jupyter_execute_kwargs,                                                     \n+    )                                                                                           \n+```\n+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`. This is filed: \n+\n+https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+Install jupyterlab \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+Currently this introduces an error while building. Fix this by\n+\n+```\n+sage -pip install --upgrade nbconvert\n+```\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T12:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503670",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,84 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+Fix a bug and suppress a warning, by replacing
+
+```python
+notebook = execute_cells(                                          
+    kernel_name,                                                   
+    [nbformat.v4.new_code_cell(node.astext()) for node in nodes],  
+    self.config.jupyter_execute_kwargs,                            
+)                                                                  
+```
+with
+
+```python
+import warnings                                                                                 
+with warnings.catch_warnings():                                                                 
+    warnings.simplefilter("ignore")                                                             
+    notebook = execute_cells(                                                                   
+        kernel_name,                                                                            
+        [nbformat.v4.new_code_cell(node.astext() if node["execute"] else "") for node in nodes],
+        self.config.jupyter_execute_kwargs,                                                     
+    )                                                                                           
+```
+around line 152 in `local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_sphinx/execute.py`. This is filed: 
+
+https://github.com/jupyter/jupyter-sphinx/issues/198
+
+Install jupyterlab 
+
+```
+sage -i jupyterlab_widgets
+```
+Currently this introduces an error while building. Fix this by
+
+```
+sage -pip install --upgrade nbconvert
+```
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503671.json:
```json
{
    "body": "<a id='comment:26'></a>This is now ready to play with.",
    "created_at": "2022-03-27T12:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503671",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:26'></a>This is now ready to play with.



---

archive/issue_comments_503672.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-27T20:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503673.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-27T20:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503673",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every cell on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503674.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-28T01:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503674",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503675.json:
```json
{
    "body": "<a id='comment:31'></a>Just uploaded a late commit. Building live doc takes triple times more time. So `LIVE_DOC=no` is the default.",
    "created_at": "2022-03-28T01:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503675",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:31'></a>Just uploaded a late commit. Building live doc takes triple times more time. So `LIVE_DOC=no` is the default.



---

archive/issue_comments_503676.json:
```json
{
    "body": "<a id='comment:32'></a>Matthias, the lines 150-154 of `execute.py` should be removed.",
    "created_at": "2022-03-28T05:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503676",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:32'></a>Matthias, the lines 150-154 of `execute.py` should be removed.



---

archive/issue_comments_503677.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-28T08:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503677",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503678.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-28T13:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503678",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503679.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:32 klee]:\n> Matthias, the lines 150-154 of `execute.py` should be removed.\n\n\nI fixed the patch.",
    "created_at": "2022-03-28T13:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503679",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:35'></a>Replying to [comment:32 klee]:
> Matthias, the lines 150-154 of `execute.py` should be removed.


I fixed the patch.



---

archive/issue_comments_503680.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-29T00:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503680",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503681.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-29T05:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503681",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503682.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-29T06:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503682",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503683.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true NotebookApp.open_browser=false\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-29T06:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503683",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true NotebookApp.open_browser=false
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503684.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export LIVE_DOC=yes\n+export JUPYTER_SERVER='http://localhost:8888'\n+export JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-29T06:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503684",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export LIVE_DOC=yes
+export JUPYTER_SERVER='http://localhost:8888'
+export JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503685.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-30T02:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503685",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503686.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-30T02:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_503687.json:
```json
{
    "body": "<a id='comment:43'></a>I thought about reducing live doc building time. But it seems that this should be done on jupyter-sphinx side, or rather by forking it to make our own tailored for sage. In short, this belongs to a wishlist.\n\nAs the live doc is optional, it is safe to merge this branch now.",
    "created_at": "2022-03-30T02:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503687",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:43'></a>I thought about reducing live doc building time. But it seems that this should be done on jupyter-sphinx side, or rather by forking it to make our own tailored for sage. In short, this belongs to a wishlist.

As the live doc is optional, it is safe to merge this branch now.



---

archive/issue_comments_503688.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-30T02:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503688",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_503689.json:
```json
{
    "body": "<a id='comment:44'></a>I think the new environment variables should use a prefix `SAGE_` and it would be good if they could be set by `src/sage_docbuild/__init__.py` like it sets environment variables `SAGE_SKIP_PLOT_DIRECTIVE` etc.  I don't think they should go through `sage.env`.",
    "created_at": "2022-03-30T02:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503689",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>I think the new environment variables should use a prefix `SAGE_` and it would be good if they could be set by `src/sage_docbuild/__init__.py` like it sets environment variables `SAGE_SKIP_PLOT_DIRECTIVE` etc.  I don't think they should go through `sage.env`.



---

archive/issue_comments_503690.json:
```json
{
    "body": "<a id='comment:46'></a>Some questions:\n\n- Should the live docs be built in a different location (for example \"html_live\") so that it can coexist with the static documentation? Then it would play a role more like the PDF documentation.\n\n- Should building the live docs be an option for `./configure`, and/or a `make` target, like the PDF docs? (Separately, I wonder if options like `SAGE_SKIP_PLOT_DIRECTIVE` should also be controlled by `./configure` arguments.)",
    "created_at": "2022-03-30T03:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503690",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:46'></a>Some questions:

- Should the live docs be built in a different location (for example "html_live") so that it can coexist with the static documentation? Then it would play a role more like the PDF documentation.

- Should building the live docs be an option for `./configure`, and/or a `make` target, like the PDF docs? (Separately, I wonder if options like `SAGE_SKIP_PLOT_DIRECTIVE` should also be controlled by `./configure` arguments.)



---

archive/issue_comments_503691.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:46 jhpalmieri]:\n> Some questions:\n> \n> - Should the live docs be built in a different location (for example \"html_live\") so that it can coexist with the static documentation? Then it would play a role more like the PDF documentation.\n\n\nLive html docs are exactly like the normal html docs with additional \"make live\" capability. You may see the live docs as an upgrade version. So it makes not much sense to have both.",
    "created_at": "2022-03-30T09:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503691",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:47'></a>Replying to [comment:46 jhpalmieri]:
> Some questions:
> 
> - Should the live docs be built in a different location (for example "html_live") so that it can coexist with the static documentation? Then it would play a role more like the PDF documentation.


Live html docs are exactly like the normal html docs with additional "make live" capability. You may see the live docs as an upgrade version. So it makes not much sense to have both.



---

archive/issue_comments_503692.json:
```json
{
    "body": "<a id='comment:48'></a>Replying to [comment:46 jhpalmieri]:\n> - Should building the live docs be an option for `./configure`, and/or a `make` target, like the PDF docs? \n\n\nI think it's possible to choose live or static by `./configure`, but Matthias will know it better.",
    "created_at": "2022-03-30T09:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503692",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:48'></a>Replying to [comment:46 jhpalmieri]:
> - Should building the live docs be an option for `./configure`, and/or a `make` target, like the PDF docs? 


I think it's possible to choose live or static by `./configure`, but Matthias will know it better.



---

archive/issue_comments_503693.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-30T09:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503693",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_503694.json:
```json
{
    "body": "<a id='comment:49'></a>Replying to [comment:44 mkoeppe]:\n> I think the new environment variables should use a prefix `SAGE_` and it would be good if they could be set by `src/sage_docbuild/__init__.py` like it sets environment variables `SAGE_SKIP_PLOT_DIRECTIVE` etc.  I don't think they should go through `sage.env`.\n\n\nOkay. I am working on it.",
    "created_at": "2022-03-30T09:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503694",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:49'></a>Replying to [comment:44 mkoeppe]:
> I think the new environment variables should use a prefix `SAGE_` and it would be good if they could be set by `src/sage_docbuild/__init__.py` like it sets environment variables `SAGE_SKIP_PLOT_DIRECTIVE` etc.  I don't think they should go through `sage.env`.


Okay. I am working on it.



---

archive/issue_comments_503695.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-30T09:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503695",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503696.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+export SAGE_JUPYTER_SERVER='http://localhost:8888'\n+export SAGE_JUPYTER_SERVER_TOKEN='secret'\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-30T09:29:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503696",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export SAGE_LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export SAGE_LIVE_DOC=yes
+export SAGE_JUPYTER_SERVER='http://localhost:8888'
+export SAGE_JUPYTER_SERVER_TOKEN='secret'
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503697.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,63 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false\n+```\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-30T09:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503697",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,63 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export SAGE_LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export SAGE_LIVE_DOC=yes
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false
+```
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503698.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,79 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false\n+```\n+\n+## Selective Build\n+\n+Build static doc fast\n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+and then build live doc selectively, \n+\n+```\n+sage --docbuild --live-doc reference/plot3d html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-03-30T14:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503698",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,79 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export SAGE_LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export SAGE_LIVE_DOC=yes
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false
+```
+
+## Selective Build
+
+Build static doc fast
+
+```
+make doc-clean; make doc-uninstall; make
+```
+and then build live doc selectively, 
+
+```
+sage --docbuild --live-doc reference/plot3d html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503699.json:
```json
{
    "body": "<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-30T14:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503700.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-30T14:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503700",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_503701.json:
```json
{
    "body": "<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-01T05:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503702.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-03T12:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503703.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-04-03T13:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_503704.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-04-03T13:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_503705.json:
```json
{
    "body": "<a id='comment:60'></a>So if I understand correctly, both (1) during the documentation build and (2) when viewing the documentation, either (a) binder is used or (b) a local Jupyter is used.\n\nIs it possible to do 1(b) and 2(a)?",
    "created_at": "2022-04-03T16:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503705",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>So if I understand correctly, both (1) during the documentation build and (2) when viewing the documentation, either (a) binder is used or (b) a local Jupyter is used.

Is it possible to do 1(b) and 2(a)?



---

archive/issue_comments_503706.json:
```json
{
    "body": "<a id='comment:61'></a>Replying to [comment:60 mkoeppe]:\n> So if I understand correctly, both (1) during the documentation build and (2) when viewing the documentation, either (a) binder is used or (b) a local Jupyter is used.\n> \n> Is it possible to do 1(b) and 2(a)?\n\n\nWhen you do 1(b), thebe configuration is baked into the htmls, so you cannot do 2(a).\n\nIf you want to do 1(a) for the whole documentation, and do 2(b) for a specific documentation, for instance 'prep', then \n\n```\nexport SAGE_JUPYTER_SERVER=http://localhost:8888\nexport SAGE_JUPYTER_SERVER_TOKEN=secret\nsage --docbuild --live-doc prep html\n```\nshould work, but does not. I don't understand why. Instead you should do\n\n```\nsage --docbuild prep html\nexport SAGE_JUPYTER_SERVER=http://localhost:8888\nexport SAGE_JUPYTER_SERVER_TOKEN=secret\nsage --docbuild --live-doc prep html\n```\nThis is because sphinx recognizes the changes of the config variable `jupyter_execute_default_kernel` but not of `jupyter_sphinx_thebelab_config`. Any idea why?",
    "created_at": "2022-04-04T01:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503706",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:61'></a>Replying to [comment:60 mkoeppe]:
> So if I understand correctly, both (1) during the documentation build and (2) when viewing the documentation, either (a) binder is used or (b) a local Jupyter is used.
> 
> Is it possible to do 1(b) and 2(a)?


When you do 1(b), thebe configuration is baked into the htmls, so you cannot do 2(a).

If you want to do 1(a) for the whole documentation, and do 2(b) for a specific documentation, for instance 'prep', then 

```
export SAGE_JUPYTER_SERVER=http://localhost:8888
export SAGE_JUPYTER_SERVER_TOKEN=secret
sage --docbuild --live-doc prep html
```
should work, but does not. I don't understand why. Instead you should do

```
sage --docbuild prep html
export SAGE_JUPYTER_SERVER=http://localhost:8888
export SAGE_JUPYTER_SERVER_TOKEN=secret
sage --docbuild --live-doc prep html
```
This is because sphinx recognizes the changes of the config variable `jupyter_execute_default_kernel` but not of `jupyter_sphinx_thebelab_config`. Any idea why?



---

archive/issue_comments_503707.json:
```json
{
    "body": "<a id='comment:62'></a>Replying to [comment:61 klee]:\n> This is because sphinx recognizes the changes of the config variable `jupyter_execute_default_kernel` but not of `jupyter_sphinx_thebelab_config`. Any idea why?\n\n\nIt is because jupyter-sphinx enrolls `jupyter_execute_default_kernel` as a config value of type `env` and `jupyter_sphinx_thebelab_config` as a config value of type `html`.",
    "created_at": "2022-04-04T05:52:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503707",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:62'></a>Replying to [comment:61 klee]:
> This is because sphinx recognizes the changes of the config variable `jupyter_execute_default_kernel` but not of `jupyter_sphinx_thebelab_config`. Any idea why?


It is because jupyter-sphinx enrolls `jupyter_execute_default_kernel` as a config value of type `env` and `jupyter_sphinx_thebelab_config` as a config value of type `html`.



---

archive/issue_comments_503708.json:
```json
{
    "body": "<a id='comment:63'></a>I just tried the full docbuild from scratch with the local Jupyter. The build first failed with\n\n```\n[sagemath_doc_html-none] [reference] preparing documents... skipping loading of indexes... done\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:34: WARNING: unknown document: categories/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:41: WARNING: unknown document: polynomial_rings/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:43: WARNING: unknown document: finite_rings/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:58: WARNING: unknown document: calculus/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:84: WARNING: unknown document: combinat/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:85: WARNING: unknown document: graphs/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:89: WARNING: unknown document: coding/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:90: WARNING: unknown document: cryptography/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:99: WARNING: unknown document: discrete_geometry/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:102: WARNING: unknown document: manifolds/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:133: WARNING: unknown document: curves/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:134: WARNING: unknown document: arithmetic_curves/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:139: WARNING: unknown document: databases/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:149: WARNING: unknown document: misc/index\n[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:150: WARNING: unknown document: doctest/index\n[sagemath_doc_html-none] [reference] The inventory files are in local/share/doc/sage/inventory/en/reference.\n[sagemath_doc_html-none] Error building the documentation.\n```\nbut re-running it, it succeeded. \n\nThen, running the command from the ticket description, I got:\n\n```\n$ sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.6.beta7, Release Date: 2022-04-02               \u2502\n\u2502 Using Python 3.10.2. Type \"help()\" for help.                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nPlease wait while the Jupyterlab server starts...\n[I 2022-04-04 00:50:38.225 ServerApp] jupyterlab | extension was successfully linked.\n[W 2022-04-04 00:50:38.230 NotebookApp] 'disable_check_xsrf' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.\n[I 2022-04-04 00:50:38.239 ServerApp] nbclassic | extension was successfully linked.\n[I 2022-04-04 00:50:38.489 ServerApp] notebook_shim | extension was successfully linked.\n[I 2022-04-04 00:50:38.588 ServerApp] notebook_shim | extension was successfully loaded.\n[I 2022-04-04 00:50:38.590 LabApp] JupyterLab extension loaded from /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/jupyterlab\n[I 2022-04-04 00:50:38.590 LabApp] JupyterLab application directory is /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.10/share/jupyter/lab\n[I 2022-04-04 00:50:38.594 ServerApp] jupyterlab | extension was successfully loaded.\n[I 2022-04-04 00:50:38.601 ServerApp] nbclassic | extension was successfully loaded.\n[I 2022-04-04 00:50:38.602 ServerApp] The port 8888 is already in use, trying another port.\n[I 2022-04-04 00:50:38.603 ServerApp] Serving notebooks from local directory: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11\n[I 2022-04-04 00:50:38.603 ServerApp] Jupyter Server 1.15.6 is running at:\n[I 2022-04-04 00:50:38.603 ServerApp] http://localhost:8889/lab?token=...\n[I 2022-04-04 00:50:38.603 ServerApp]  or http://127.0.0.1:8889/lab?token=...\n[I 2022-04-04 00:50:38.603 ServerApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\n```\nProbably, if possible, the instructions should be refined so that the server app does not fall back to another port but rather gives a hard error.",
    "created_at": "2022-04-04T08:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503708",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>I just tried the full docbuild from scratch with the local Jupyter. The build first failed with

```
[sagemath_doc_html-none] [reference] preparing documents... skipping loading of indexes... done
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:34: WARNING: unknown document: categories/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:41: WARNING: unknown document: polynomial_rings/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:43: WARNING: unknown document: finite_rings/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:58: WARNING: unknown document: calculus/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:84: WARNING: unknown document: combinat/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:85: WARNING: unknown document: graphs/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:89: WARNING: unknown document: coding/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:90: WARNING: unknown document: cryptography/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:99: WARNING: unknown document: discrete_geometry/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:102: WARNING: unknown document: manifolds/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:133: WARNING: unknown document: curves/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:134: WARNING: unknown document: arithmetic_curves/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:139: WARNING: unknown document: databases/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:149: WARNING: unknown document: misc/index
[sagemath_doc_html-none] [reference] /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/doc/en/reference/index.rst:150: WARNING: unknown document: doctest/index
[sagemath_doc_html-none] [reference] The inventory files are in local/share/doc/sage/inventory/en/reference.
[sagemath_doc_html-none] Error building the documentation.
```
but re-running it, it succeeded. 

Then, running the command from the ticket description, I got:

```
$ sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.open_browser=false

 SageMath version 9.6.beta7, Release Date: 2022-04-02               
 Using Python 3.10.2. Type "help()" for help.                       


 Warning: this is a prerelease version, and it may be unstable.     

Please wait while the Jupyterlab server starts...
[I 2022-04-04 00:50:38.225 ServerApp] jupyterlab | extension was successfully linked.
[W 2022-04-04 00:50:38.230 NotebookApp] 'disable_check_xsrf' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[I 2022-04-04 00:50:38.239 ServerApp] nbclassic | extension was successfully linked.
[I 2022-04-04 00:50:38.489 ServerApp] notebook_shim | extension was successfully linked.
[I 2022-04-04 00:50:38.588 ServerApp] notebook_shim | extension was successfully loaded.
[I 2022-04-04 00:50:38.590 LabApp] JupyterLab extension loaded from /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/jupyterlab
[I 2022-04-04 00:50:38.590 LabApp] JupyterLab application directory is /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.10/share/jupyter/lab
[I 2022-04-04 00:50:38.594 ServerApp] jupyterlab | extension was successfully loaded.
[I 2022-04-04 00:50:38.601 ServerApp] nbclassic | extension was successfully loaded.
[I 2022-04-04 00:50:38.602 ServerApp] The port 8888 is already in use, trying another port.
[I 2022-04-04 00:50:38.603 ServerApp] Serving notebooks from local directory: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11
[I 2022-04-04 00:50:38.603 ServerApp] Jupyter Server 1.15.6 is running at:
[I 2022-04-04 00:50:38.603 ServerApp] http://localhost:8889/lab?token=...
[I 2022-04-04 00:50:38.603 ServerApp]  or http://127.0.0.1:8889/lab?token=...
[I 2022-04-04 00:50:38.603 ServerApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
```
Probably, if possible, the instructions should be refined so that the server app does not fall back to another port but rather gives a hard error.



---

archive/issue_comments_503709.json:
```json
{
    "body": "<a id='comment:64'></a>Overall, this looks quite promising, but I think there are still a few things that need to be improved to make it ready for the public. One thing is that the interaction is very limited - one cannot edit the inputs, so all one can do is reproduce the result that the doctest is already showing. (Also, in doctest blocks with more than one command, it only shows the last result or the first error.)",
    "created_at": "2022-04-04T08:15:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503709",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'></a>Overall, this looks quite promising, but I think there are still a few things that need to be improved to make it ready for the public. One thing is that the interaction is very limited - one cannot edit the inputs, so all one can do is reproduce the result that the doctest is already showing. (Also, in doctest blocks with more than one command, it only shows the last result or the first error.)



---

archive/issue_comments_503710.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,79 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+Default static doc \n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with binder server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make doc-clean; make doc-uninstall; make\n+```\n+Live doc with local server\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+make doc-clean; make doc-uninstall; make\n+```\n+View the documentation with running\n+\n+```\n+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.port=8888 --ServerApp.open_browser=false \n+```\n+\n+## Selective Build\n+\n+Build static doc fast\n+\n+```\n+make doc-clean; make doc-uninstall; make\n+```\n+and then build live doc selectively, \n+\n+```\n+sage --docbuild --live-doc reference/plot3d html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-04T08:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503710",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,79 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+Default static doc 
+
+```
+make doc-clean; make doc-uninstall; make
+```
+Live doc with binder server
+
+```
+export SAGE_LIVE_DOC=yes
+make doc-clean; make doc-uninstall; make
+```
+Live doc with local server
+
+```
+export SAGE_LIVE_DOC=yes
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+make doc-clean; make doc-uninstall; make
+```
+View the documentation with running
+
+```
+sage --notebook=jupyterlab --ServerApp.token='secret' --ServerApp.allow_origin='null' --ServerApp.disable_check_xsrf=true --ServerApp.port=8888 --ServerApp.open_browser=false 
+```
+
+## Selective Build
+
+Build static doc fast
+
+```
+make doc-clean; make doc-uninstall; make
+```
+and then build live doc selectively, 
+
+```
+sage --docbuild --live-doc reference/plot3d html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503711.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:63 mkoeppe]:\n> I just tried the full docbuild from scratch with the local Jupyter. The build first failed with ... but re-running it, it succeeded. \n\n\nYou mean `make doc-clean; make doc-uninstall; make`? \n\nThe first failure seems not related with this ticket...\n\n> Probably, if possible, the instructions should be refined so that the server app does not fall back to another port but rather gives a hard error.\n\n\nDone.",
    "created_at": "2022-04-04T08:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503711",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:66'></a>Replying to [comment:63 mkoeppe]:
> I just tried the full docbuild from scratch with the local Jupyter. The build first failed with ... but re-running it, it succeeded. 


You mean `make doc-clean; make doc-uninstall; make`? 

The first failure seems not related with this ticket...

> Probably, if possible, the instructions should be refined so that the server app does not fall back to another port but rather gives a hard error.


Done.



---

archive/issue_comments_503712.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:64 mkoeppe]:\n> Overall, this looks quite promising, but I think there are still a few things that need to be improved to make it ready for the public. One thing is that the interaction is very limited - one cannot edit the inputs, so all one can do is reproduce the result that the doctest is already showing.\n\n\nI think this is the primary purpose of the documentation -- running the examples as they are. If they want to do variations, they should go to jupyter and copy-paste.\n\nOf course, it is easy to allow user modifications. A couple of configuration changes. But first we have to decide what behavior we want.\n\n> (Also, in doctest blocks with more than one command, it only shows the last result or the first error.)\n\n\nThis is to be done by editing the documentation. We cannot make jupyter-sphinx an AI.",
    "created_at": "2022-04-04T08:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503712",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:67'></a>Replying to [comment:64 mkoeppe]:
> Overall, this looks quite promising, but I think there are still a few things that need to be improved to make it ready for the public. One thing is that the interaction is very limited - one cannot edit the inputs, so all one can do is reproduce the result that the doctest is already showing.


I think this is the primary purpose of the documentation -- running the examples as they are. If they want to do variations, they should go to jupyter and copy-paste.

Of course, it is easy to allow user modifications. A couple of configuration changes. But first we have to decide what behavior we want.

> (Also, in doctest blocks with more than one command, it only shows the last result or the first error.)


This is to be done by editing the documentation. We cannot make jupyter-sphinx an AI.



---

archive/issue_comments_503713.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [comment:67 klee]:\n> > (Also, in doctest blocks with more than one command, it only shows the last result or the first error.)\n\n> \n> This is to be done by editing the documentation. We cannot make jupyter-sphinx an AI.\n\n\nWe can get output from each input line. Then we will have \"Run\" button for each line. Do we want that?",
    "created_at": "2022-04-04T08:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503713",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:68'></a>Replying to [comment:67 klee]:
> > (Also, in doctest blocks with more than one command, it only shows the last result or the first error.)

> 
> This is to be done by editing the documentation. We cannot make jupyter-sphinx an AI.


We can get output from each input line. Then we will have "Run" button for each line. Do we want that?



---

archive/issue_comments_503714.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,99 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1\n+to fix a bug and suppress a warning. The bugfix is also in the master branch\n+- https://github.com/jupyter/jupyter-sphinx/issues/198\n+\n+## Preparation before build\n+Suppress a warning by\n+\n+```\n+sage -i debugpy  \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+For all below, removing the prebuilt documentation by\n+\n+```\n+make doc-clean; make doc-uninstall\n+```\n+may be necessary before `make`.\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+## Selective Build\n+\n+Build static doc fast\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc reference/plot3d html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc reference/plot3d html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-04T14:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503714",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,99 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/mkoeppe/jupyter-sphinx/commit/5067473640eca1b4d43fbacb643d9af47cc767d1
+to fix a bug and suppress a warning. The bugfix is also in the master branch
+- https://github.com/jupyter/jupyter-sphinx/issues/198
+
+## Preparation before build
+Suppress a warning by
+
+```
+sage -i debugpy  
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+For all below, removing the prebuilt documentation by
+
+```
+make doc-clean; make doc-uninstall
+```
+may be necessary before `make`.
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+## Selective Build
+
+Build static doc fast
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc reference/plot3d html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc reference/plot3d html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503715.json:
```json
{
    "body": "<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-05T09:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503715",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503716.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,97 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+For all above, removing the prebuilt documentation by\n+\n+```\n+make doc-clean; make doc-uninstall\n+```\n+may be necessary before `make`.\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc reference/plot3d html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc reference/plot3d html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-05T09:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503716",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,97 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+For all above, removing the prebuilt documentation by
+
+```
+make doc-clean; make doc-uninstall
+```
+may be necessary before `make`.
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc reference/plot3d html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc reference/plot3d html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503717.json:
```json
{
    "body": "<a id='comment:72'></a>With the latest commit, live doc building is almost as fast as building the static doc.",
    "created_at": "2022-04-05T09:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503717",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:72'></a>With the latest commit, live doc building is almost as fast as building the static doc.



---

archive/issue_comments_503718.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,97 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+For all above, removing the prebuilt documentation by\n+\n+```\n+make doc-clean; make doc-uninstall\n+```\n+may be necessary before `make`.\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-05T09:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503718",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,97 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket depends on #33533 for an upgrade of `nbconvert`; otherwise an error appears while building.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+For all above, removing the prebuilt documentation by
+
+```
+make doc-clean; make doc-uninstall
+```
+may be necessary before `make`.
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503719.json:
```json
{
    "body": "<a id='comment:74'></a>Selective build works now well. You can quickly switch between binder server and local server.",
    "created_at": "2022-04-05T09:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503719",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:74'></a>Selective build works now well. You can quickly switch between binder server and local server.



---

archive/issue_comments_503720.json:
```json
{
    "body": "<a id='comment:75'></a>As live doc building is as fast as building static doc, it makes sense to switch to the live doc (with binder server) as default. Binder servers seem slow though (at least to me).",
    "created_at": "2022-04-05T09:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503720",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:75'></a>As live doc building is as fast as building static doc, it makes sense to switch to the live doc (with binder server) as default. Binder servers seem slow though (at least to me).



---

archive/issue_comments_503721.json:
```json
{
    "body": "<a id='comment:76'></a>I think the branch is good enough (frankly, very nice!) to make it into sage 9.6, as this ticket supersedes #33507: `sagemath_doc_html: Use jupyter-sphinx for 3D graphics`.",
    "created_at": "2022-04-05T09:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503721",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:76'></a>I think the branch is good enough (frankly, very nice!) to make it into sage 9.6, as this ticket supersedes #33507: `sagemath_doc_html: Use jupyter-sphinx for 3D graphics`.



---

archive/issue_comments_503722.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,95 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+For all above, removing the prebuilt documentation by\n+\n+```\n+make doc-clean; make doc-uninstall\n+```\n+may be necessary before `make`.\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-05T14:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503722",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,95 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+For all above, removing the prebuilt documentation by
+
+```
+make doc-clean; make doc-uninstall
+```
+may be necessary before `make`.
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503723.json:
```json
{
    "body": "<a id='comment:78'></a>I just found this project:\n\nhttps://sphinx-thebe.readthedocs.io/en/latest/index.html\n\nIt may be more suitable for us.",
    "created_at": "2022-04-11T08:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503723",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:78'></a>I just found this project:

https://sphinx-thebe.readthedocs.io/en/latest/index.html

It may be more suitable for us.



---

archive/issue_comments_503724.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-04-11T08:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503724",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_087934.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87934"
}
```



---

archive/issue_events_087935.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87935"
}
```



---

archive/issue_comments_503725.json:
```json
{
    "body": "<a id='comment:80'></a>Replying to [comment:78 klee]:\n> https://sphinx-thebe.readthedocs.io/en/latest/index.html\n> \n> It may be more suitable for us.\n\n\nsphinx-thebe translates nodes\n\n```\n.. container::\n   :class: thebe\n   \n   1 + 1\n```\nto html elements that can be activated by thebe.\n\njupyter-sphinx executes nodes\n\n```\n.. jupyter_execute::\n\n   1 + 1\n```\nby jupyter and insert the output to the built htmls and can also insert html elements that can be activated by thebe.\n\nPresently we are using jupyter-sphinx but suppressing jupyter execution part (somewhat clumsily), which we don't need currently.\n\nThere is also a discussion (https://github.com/jupyter/jupyter-sphinx/issues/137) about using sphinx-thebe for jupyter-sphinx's thebe part. It is unclear how much this progressed.\n\nSo I think that from where we stand, there is no clear benefit of switching to sphinx-thebe.",
    "created_at": "2022-04-12T06:43:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503725",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:80'></a>Replying to [comment:78 klee]:
> https://sphinx-thebe.readthedocs.io/en/latest/index.html
> 
> It may be more suitable for us.


sphinx-thebe translates nodes

```
.. container::
   :class: thebe
   
   1 + 1
```
to html elements that can be activated by thebe.

jupyter-sphinx executes nodes

```
.. jupyter_execute::

   1 + 1
```
by jupyter and insert the output to the built htmls and can also insert html elements that can be activated by thebe.

Presently we are using jupyter-sphinx but suppressing jupyter execution part (somewhat clumsily), which we don't need currently.

There is also a discussion (https://github.com/jupyter/jupyter-sphinx/issues/137) about using sphinx-thebe for jupyter-sphinx's thebe part. It is unclear how much this progressed.

So I think that from where we stand, there is no clear benefit of switching to sphinx-thebe.



---

archive/issue_comments_503726.json:
```json
{
    "body": "<a id='comment:81'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-12T06:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:81'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503727.json:
```json
{
    "body": "<a id='comment:82'></a>#33507 introduced a performance regression in sage html documentation by inserting \n\n```\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js\"></script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js\"></script>\n```  \nwhich loads rather big javascripts to every page and incurs a slow page loading. You may notice this if compared with the previous sage documentation.\n\nThe last commit contains a patch to fix this.",
    "created_at": "2022-04-12T07:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503727",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:82'></a>#33507 introduced a performance regression in sage html documentation by inserting 

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
```  
which loads rather big javascripts to every page and incurs a slow page loading. You may notice this if compared with the previous sage documentation.

The last commit contains a patch to fix this.



---

archive/issue_comments_503728.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-04-12T07:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503728",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_503729.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,95 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+For all above, removing the prebuilt documentation by\n+\n+```\n+make doc-clean doc-uninstall\n+```\n+may be necessary before `make`.\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-12T07:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503729",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,95 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+For all above, removing the prebuilt documentation by
+
+```
+make doc-clean doc-uninstall
+```
+may be necessary before `make`.
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503730.json:
```json
{
    "body": "<a id='comment:84'></a>Is there a way to fix this with a patch that could be accepted upstream? \n\n(See #31543)",
    "created_at": "2022-04-12T16:44:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503730",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:84'></a>Is there a way to fix this with a patch that could be accepted upstream? 

(See #31543)



---

archive/issue_comments_503731.json:
```json
{
    "body": "<a id='comment:85'></a>Replying to [comment:84 mkoeppe]:\n> Is there a way to fix this with a patch that could be accepted upstream? \n> \n> (See #31543)\n\n\nThere would be no simple patch. Even if there is a (big) patch, they may not accept it because it is not fixing a bug. \n\nIf we don't like patched source, then perhaps we should switch to sphinx-thebe.",
    "created_at": "2022-04-13T00:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503731",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:85'></a>Replying to [comment:84 mkoeppe]:
> Is there a way to fix this with a patch that could be accepted upstream? 
> 
> (See #31543)


There would be no simple patch. Even if there is a (big) patch, they may not accept it because it is not fixing a bug. 

If we don't like patched source, then perhaps we should switch to sphinx-thebe.



---

archive/issue_comments_503732.json:
```json
{
    "body": "<a id='comment:86'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-13T04:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503732",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:86'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503733.json:
```json
{
    "body": "<a id='comment:87'></a>Replying to [comment:67 klee]:\n> Replying to [comment:64 mkoeppe]:\n> > One thing is that the interaction is very limited - one cannot edit the inputs, so all one can do is reproduce the result that the doctest is already showing.\n\n> \n> I think this is the primary purpose of the documentation -- running the examples as they are. If they want to do variations, they should go to jupyter and copy-paste.\n> \n> Of course, it is easy to allow user modifications. A couple of configuration changes. But first we have to decide what behavior we want.\n\n\nUsing live docs, I realized that many example code blocks in sage documentation are not ready for live run, and frequently needs user's editing before run. Hence I changed my mind, and the last commit makes code blocks editable.",
    "created_at": "2022-04-13T04:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503733",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:87'></a>Replying to [comment:67 klee]:
> Replying to [comment:64 mkoeppe]:
> > One thing is that the interaction is very limited - one cannot edit the inputs, so all one can do is reproduce the result that the doctest is already showing.

> 
> I think this is the primary purpose of the documentation -- running the examples as they are. If they want to do variations, they should go to jupyter and copy-paste.
> 
> Of course, it is easy to allow user modifications. A couple of configuration changes. But first we have to decide what behavior we want.


Using live docs, I realized that many example code blocks in sage documentation are not ready for live run, and frequently needs user's editing before run. Hence I changed my mind, and the last commit makes code blocks editable.



---

archive/issue_comments_503734.json:
```json
{
    "body": "<a id='comment:88'></a>Note that code-mirror configuration doesn't work. It seems an issue of the current thebe.",
    "created_at": "2022-04-13T04:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503734",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:88'></a>Note that code-mirror configuration doesn't work. It seems an issue of the current thebe.



---

archive/issue_comments_503735.json:
```json
{
    "body": "<a id='comment:89'></a>Note also that it is now a lot easy to copy-paste code blocks into jupyter :)",
    "created_at": "2022-04-13T04:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503735",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:89'></a>Note also that it is now a lot easy to copy-paste code blocks into jupyter :)



---

archive/issue_comments_503736.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,101 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+If things does not work as expected, removing the existing documentation by\n+\n+```\n+make doc-clean doc-uninstall\n+```\n+may be necessary before `make`. If this is burdensome, try first\n+\n+```\n+sage --docbuild reference_top html\n+```\n+which updates static files (javascripts) directory.\n+\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-15T02:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503736",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,101 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+If things does not work as expected, removing the existing documentation by
+
+```
+make doc-clean doc-uninstall
+```
+may be necessary before `make`. If this is burdensome, try first
+
+```
+sage --docbuild reference_top html
+```
+which updates static files (javascripts) directory.
+
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503737.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,101 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8888\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8888 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+If things do not work as expected, removing the existing documentation by\n+\n+```\n+make doc-clean doc-uninstall\n+```\n+may be necessary before `make`. If this is burdensome, try first\n+\n+```\n+sage --docbuild reference_top html\n+```\n+which updates static files (javascripts) directory.\n+\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8888\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-15T02:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503737",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,101 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8888
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8888 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+If things do not work as expected, removing the existing documentation by
+
+```
+make doc-clean doc-uninstall
+```
+may be necessary before `make`. If this is burdensome, try first
+
+```
+sage --docbuild reference_top html
+```
+which updates static files (javascripts) directory.
+
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8888
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503738.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,101 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8889\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret\n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8889 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+If things do not work as expected, removing the existing documentation by\n+\n+```\n+make doc-clean doc-uninstall\n+```\n+may be necessary before `make`. If this is burdensome, try first\n+\n+```\n+sage --docbuild reference_top html\n+```\n+which updates static files (javascripts) directory.\n+\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8889\n+export SAGE_JUPYTER_SERVER_TOKEN=secret\n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-15T04:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503738",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,101 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8889
+  export SAGE_JUPYTER_SERVER_TOKEN=secret
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8889 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+If things do not work as expected, removing the existing documentation by
+
+```
+make doc-clean doc-uninstall
+```
+may be necessary before `make`. If this is burdensome, try first
+
+```
+sage --docbuild reference_top html
+```
+which updates static files (javascripts) directory.
+
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8889
+export SAGE_JUPYTER_SERVER_TOKEN=secret
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503739.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,101 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8889\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret  # default \n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8889 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+If things do not work as expected, removing the existing documentation by\n+\n+```\n+make doc-clean doc-uninstall\n+```\n+may be necessary before `make`. If this is burdensome, try first\n+\n+```\n+sage --docbuild reference_top html\n+```\n+which updates static files (javascripts) directory.\n+\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8889\n+export SAGE_JUPYTER_SERVER_TOKEN=secret  # default \n+sage --docbuild --live-doc prep html\n+```\n+\n+\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-15T04:30:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503739",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,101 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8889
+  export SAGE_JUPYTER_SERVER_TOKEN=secret  # default 
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8889 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+If things do not work as expected, removing the existing documentation by
+
+```
+make doc-clean doc-uninstall
+```
+may be necessary before `make`. If this is burdensome, try first
+
+```
+sage --docbuild reference_top html
+```
+which updates static files (javascripts) directory.
+
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8889
+export SAGE_JUPYTER_SERVER_TOKEN=secret  # default 
+sage --docbuild --live-doc prep html
+```
+
+
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503740.json:
```json
{
    "body": "<a id='comment:94'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-24T07:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503740",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:94'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503741.json:
```json
{
    "body": "<a id='comment:95'></a>The last commit fixes a bug that causes a failure when `.. JUPYTER_EXECUTE::` is directly used without `execute` tag.",
    "created_at": "2022-04-24T08:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503741",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:95'></a>The last commit fixes a bug that causes a failure when `.. JUPYTER_EXECUTE::` is directly used without `execute` tag.



---

archive/issue_comments_503742.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,103 @@\n+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.\n+\n+As we move to the new tool, the ticket\n+\n+- #24593 \"Provide live documentation support in Jupyter using Thebe\"\n+\n+was closed.\n+\n+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.\n+\n+This ticket patches `jupyter-sphinx` with \n+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1\n+\n+## Preparation before build\n+Suppress warnings by\n+\n+```\n+sage -i debugpy \n+sage -pip install soupsieve \n+```\n+\n+Install jupyterlab (for live doc with a local server) \n+\n+```\n+sage -i jupyterlab_widgets\n+```\n+\n+## Build\n+\n+- Default static doc: \n+\n+```\n+make\n+```\n+\n+- Live doc with binder server:\n+\n+```\n+export SAGE_LIVE_DOC=yes\n+make\n+```\n+\n+- Live doc with local server:\n+  {{{\n+  export SAGE_LIVE_DOC=yes\n+  export SAGE_JUPYTER_SERVER=http://localhost:8889\n+  export SAGE_JUPYTER_SERVER_TOKEN=secret  # default \n+  make\n+  }}}\n+  Run\n+  {{{\n+  sage --notebook=jupyterlab \\\n+    --ServerApp.token='secret' \\\n+    --ServerApp.allow_origin='null' \\\n+    --ServerApp.disable_check_xsrf=true \\\n+    --ServerApp.port=8889 \\\n+    --ServerApp.open_browser=false \n+  }}}\n+  before browsing the documentation.\n+\n+If things do not work as expected, removing the existing documentation by\n+\n+```\n+make doc-clean doc-uninstall\n+```\n+may be necessary before `make`. If this is burdensome, try first\n+\n+```\n+sage --docbuild reference_top html\n+```\n+which updates static files (javascripts) directory.\n+\n+## Selective Build\n+\n+Build static doc\n+\n+```\n+make\n+```\n+and then build live doc selectively either by\n+\n+```\n+sage --docbuild --live-doc prep html\n+```\n+or by\n+\n+```\n+export SAGE_JUPYTER_SERVER=http://localhost:8889\n+export SAGE_JUPYTER_SERVER_TOKEN=secret  # default \n+sage --docbuild --live-doc prep html\n+```\n+\n+## Direct use of `.. JUPYTER-EXECUTE::` is deprecated\n+\n+As #33507 added jupyter-sphinx extension to Sphinx conf, it provided `.. JUPYTER-EXECUTE::` directive to documentation authors to add executable code blocks. As the present ticket allows to build the live documentation in which all code blocks are executable, direct use of the directive by documentation authors is deprecated. Along with this change, an issue of heavy javascript injections, which slows down documentation pages loading time, is fixed in this ticket.\n+\n+\n+\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2022-04-25T07:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503742",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,103 @@
+As Thebe was not working in our sage documentation, we removed it from sage (see #33309, #33529) and introduced a new tool jupyter-sphinx in #33507.
+
+As we move to the new tool, the ticket
+
+- #24593 "Provide live documentation support in Jupyter using Thebe"
+
+was closed.
+
+Based on the efforts of #24593, the goal of this ticket is to deliver the live documentation using jupyter-sphinx so that every code blocks on every documentation page can be activated.
+
+This ticket patches `jupyter-sphinx` with 
+- https://github.com/kwankyu/jupyter-sphinx/compare/upstream...v0.3.2-sage-trac-33320?expand=1
+
+## Preparation before build
+Suppress warnings by
+
+```
+sage -i debugpy 
+sage -pip install soupsieve 
+```
+
+Install jupyterlab (for live doc with a local server) 
+
+```
+sage -i jupyterlab_widgets
+```
+
+## Build
+
+- Default static doc: 
+
+```
+make
+```
+
+- Live doc with binder server:
+
+```
+export SAGE_LIVE_DOC=yes
+make
+```
+
+- Live doc with local server:
+  {{{
+  export SAGE_LIVE_DOC=yes
+  export SAGE_JUPYTER_SERVER=http://localhost:8889
+  export SAGE_JUPYTER_SERVER_TOKEN=secret  # default 
+  make
+  }}}
+  Run
+  {{{
+  sage --notebook=jupyterlab \
+    --ServerApp.token='secret' \
+    --ServerApp.allow_origin='null' \
+    --ServerApp.disable_check_xsrf=true \
+    --ServerApp.port=8889 \
+    --ServerApp.open_browser=false 
+  }}}
+  before browsing the documentation.
+
+If things do not work as expected, removing the existing documentation by
+
+```
+make doc-clean doc-uninstall
+```
+may be necessary before `make`. If this is burdensome, try first
+
+```
+sage --docbuild reference_top html
+```
+which updates static files (javascripts) directory.
+
+## Selective Build
+
+Build static doc
+
+```
+make
+```
+and then build live doc selectively either by
+
+```
+sage --docbuild --live-doc prep html
+```
+or by
+
+```
+export SAGE_JUPYTER_SERVER=http://localhost:8889
+export SAGE_JUPYTER_SERVER_TOKEN=secret  # default 
+sage --docbuild --live-doc prep html
+```
+
+## Direct use of `.. JUPYTER-EXECUTE::` is deprecated
+
+As #33507 added jupyter-sphinx extension to Sphinx conf, it provided `.. JUPYTER-EXECUTE::` directive to documentation authors to add executable code blocks. As the present ticket allows to build the live documentation in which all code blocks are executable, direct use of the directive by documentation authors is deprecated. Along with this change, an issue of heavy javascript injections, which slows down documentation pages loading time, is fixed in this ticket.
+
+
+
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_503743.json:
```json
{
    "body": "<a id='comment:97'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-25T07:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503743",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:97'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_503744.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-04-29T19:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33320#issuecomment-503744",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_087936.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87936"
}
```



---

archive/issue_events_087937.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33320",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33320#event-87937"
}
```
