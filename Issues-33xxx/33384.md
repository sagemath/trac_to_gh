# Issue 33384: fix "if"

archive/issues_033384.json:
```json
{
    "body": "Sage's mathematical audience has long been plagued by the terrifying ambiguity of the recklessly named `if` keyword we've inherited from Python in an unfortunate series of events.\n\nHere's an example of what I mean:\n\n```python\nif 0 == 1:\n    set_computer_on_fire()\n```\n\nApparently, there exist plenty of programmers who foolishly assume this code snippet to be completely harmless, arguing that the `if` branch will never be taken.\n\nBut can we be so sure? Nothing about this syntax even *suggests* that the `set_computer_on_fire()` call cannot occur *despite* the premise of the `if` being false; after all, `A \u21d2 B` is widely known not to imply `\u00acA \u21d2 \u00acB`.\n\nThe good news is that we can easily fix this shortcoming and finally clarify the exact semantics of conditional branching in Sage by making use of the existing preparsing infrastructure.\n\nThus, without further ado, here's the same example as above, but after my patch:\n\n```python\nif and only if 0 == 1:\n    set_computer_on_fire()\n```\n\nFor users who prefer something less verbose, the shorthand `iff` is also supported:\n\n```python\niff 0 == 1:\n    set_computer_on_fire()\n```\n\nMoreover, we deprecate the support of `if` to prevent any further confusion caused by this design flaw.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33621\n\n",
    "closed_at": "2022-04-05T22:26:50Z",
    "created_at": "2022-04-01T08:45:36Z",
    "labels": [
        "component: user interface",
        "trivial"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "fix \"if\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33384",
    "user": "https://github.com/yyyyx4"
}
```
Sage's mathematical audience has long been plagued by the terrifying ambiguity of the recklessly named `if` keyword we've inherited from Python in an unfortunate series of events.

Here's an example of what I mean:

```python
if 0 == 1:
    set_computer_on_fire()
```

Apparently, there exist plenty of programmers who foolishly assume this code snippet to be completely harmless, arguing that the `if` branch will never be taken.

But can we be so sure? Nothing about this syntax even *suggests* that the `set_computer_on_fire()` call cannot occur *despite* the premise of the `if` being false; after all, `A ⇒ B` is widely known not to imply `¬A ⇒ ¬B`.

The good news is that we can easily fix this shortcoming and finally clarify the exact semantics of conditional branching in Sage by making use of the existing preparsing infrastructure.

Thus, without further ado, here's the same example as above, but after my patch:

```python
if and only if 0 == 1:
    set_computer_on_fire()
```

For users who prefer something less verbose, the shorthand `iff` is also supported:

```python
iff 0 == 1:
    set_computer_on_fire()
```

Moreover, we deprecate the support of `if` to prevent any further confusion caused by this design flaw.

Issue created by migration from https://trac.sagemath.org/ticket/33621





---

archive/issue_comments_474765.json:
```json
{
    "body": "This should be a no-brainer; I guess the only drawback is that some documentation will need updating...",
    "created_at": "2022-04-01T08:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474765",
    "user": "https://github.com/yyyyx4"
}
```

This should be a no-brainer; I guess the only drawback is that some documentation will need updating...



---

archive/issue_comments_474766.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-04-01T08:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474766",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_474767.json:
```json
{
    "body": "please, please, report this upstream! the whole Python universe might be crashing anytime without your fix...",
    "created_at": "2022-04-01T09:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474767",
    "user": "https://github.com/dimpase"
}
```

please, please, report this upstream! the whole Python universe might be crashing anytime without your fix...



---

archive/issue_comments_474768.json:
```json
{
    "body": "Let me update its priority to critical.",
    "created_at": "2022-04-01T09:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474768",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Let me update its priority to critical.



---

archive/issue_comments_474769.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-04-01T09:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474769",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing priority from major to critical.



---

archive/issue_comments_474770.json:
```json
{
    "body": "I am not sure this covers all the cases.\n\nWhat if just before one has `assume(1 == 0)`?",
    "created_at": "2022-04-01T09:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474770",
    "user": "https://github.com/GMS103"
}
```

I am not sure this covers all the cases.

What if just before one has `assume(1 == 0)`?



---

archive/issue_comments_474771.json:
```json
{
    "body": "Has no-one else noticed today's date?",
    "created_at": "2022-04-01T10:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474771",
    "user": "https://github.com/JohnCremona"
}
```

Has no-one else noticed today's date?



---

archive/issue_comments_474772.json:
```json
{
    "body": "Which year was it when William announced that he was about to start converting all Sage code into Lisp?",
    "created_at": "2022-04-01T10:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474772",
    "user": "https://github.com/JohnCremona"
}
```

Which year was it when William announced that he was about to start converting all Sage code into Lisp?



---

archive/issue_comments_474773.json:
```json
{
    "body": "We would need to take care of Python's conditional expression as well. Perhaps\n\n```\na = 4a+1 only when a%1 !=0 and a//2 otherwise\n```\nPython has recently acquired a more powerful parser that can probably handle this. We'd have to carefully balance the binding affinity of the `otherwise` postfix part with the precedence of the `and` infix operator, though.",
    "created_at": "2022-04-01T14:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474773",
    "user": "https://github.com/nbruin"
}
```

We would need to take care of Python's conditional expression as well. Perhaps

```
a = 4a+1 only when a%1 !=0 and a//2 otherwise
```
Python has recently acquired a more powerful parser that can probably handle this. We'd have to carefully balance the binding affinity of the `otherwise` postfix part with the precedence of the `and` infix operator, though.



---

archive/issue_comments_474774.json:
```json
{
    "body": "As there might be no confusion with tuples, and since some PEP8-addict reviewers are typographically pretty picky, we could accept the use of `if, and only if,`, which would allow:\n\n```\nif, and only if, 0 == 1:\n    set_computer_on_fire()\notherwise:\n    set_computer_on_ice()\n```\n\nSuch an enhancement could be part of a follow-up ticket.",
    "created_at": "2022-04-01T15:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474774",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

As there might be no confusion with tuples, and since some PEP8-addict reviewers are typographically pretty picky, we could accept the use of `if, and only if,`, which would allow:

```
if, and only if, 0 == 1:
    set_computer_on_fire()
otherwise:
    set_computer_on_ice()
```

Such an enhancement could be part of a follow-up ticket.



---

archive/issue_comments_474775.json:
```json
{
    "body": "Replying to [comment:6 cremona]:\n> Which year was it when William announced that he was about to start converting all Sage code into Lisp?\n\n\nThat was 2009-04-01:\n\n- https://groups.google.com/g/sage-devel/c/cBDQKchTP6g/m/ZmTbqdqxt1QJ",
    "created_at": "2022-04-02T09:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474775",
    "user": "https://github.com/slel"
}
```

Replying to [comment:6 cremona]:
> Which year was it when William announced that he was about to start converting all Sage code into Lisp?


That was 2009-04-01:

- https://groups.google.com/g/sage-devel/c/cBDQKchTP6g/m/ZmTbqdqxt1QJ



---

archive/issue_comments_474776.json:
```json
{
    "body": "Hmmmm...\n\nWhat would happen if we implemented (at least !) Maxima's thee-valued logic `true`, `false`, `unknown`), shouldn't `iff` treat `unknown` in a way different from `if`'s ?\n\nIf so, which ?",
    "created_at": "2022-04-02T11:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474776",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Hmmmm...

What would happen if we implemented (at least !) Maxima's thee-valued logic `true`, `false`, `unknown`), shouldn't `iff` treat `unknown` in a way different from `if`'s ?

If so, which ?



---

archive/issue_events_088439.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2022-04-02T15:47:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33384#event-88439"
}
```



---

archive/issue_comments_474777.json:
```json
{
    "body": "Changing priority from critical to trivial.",
    "created_at": "2022-04-02T15:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474777",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing priority from critical to trivial.



---

archive/issue_comments_474778.json:
```json
{
    "body": "I believe this was a joke for [April Fools' Day](https://en.wikipedia.org/wiki/April_Fools'_Day). Since the date is no longer April 1, I think we can close it as invalid.",
    "created_at": "2022-04-02T15:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474778",
    "user": "https://github.com/DaveWitteMorris"
}
```

I believe this was a joke for [April Fools' Day](https://en.wikipedia.org/wiki/April_Fools'_Day). Since the date is no longer April 1, I think we can close it as invalid.



---

archive/issue_comments_474779.json:
```json
{
    "body": "Yes. It served its purpose. I read more than half of the ticket description seriously with increasing perplexity, just to realize that this is another \"Lisp\" :)",
    "created_at": "2022-04-05T00:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474779",
    "user": "https://github.com/kwankyu"
}
```

Yes. It served its purpose. I read more than half of the ticket description seriously with increasing perplexity, just to realize that this is another "Lisp" :)



---

archive/issue_comments_474780.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-04-05T00:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474780",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_474781.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2022-04-05T22:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33384#issuecomment-474781",
    "user": "https://github.com/slel"
}
```

Resolution: wontfix



---

archive/issue_events_088440.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-04-05T22:26:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33384#event-88440"
}
```
