# Issue 33707: Montgomery model for elliptic curves

archive/issues_033470.json:
```json
{
    "assignees": [],
    "body": "Sage implements all its elliptic-curve functionality on long Weierstrass curves. This makes sense, but sometimes we'd like to interface with (or debug) other software, most commonly in cryptography, where other curve models are much more popular.\n\nThis patch adds the method `EllipticCurve_generic.montgomery_model()`, which computes a Montgomery model\n\n    `BY^2 = X^3 + AX^2 + X`\n\nfor a given elliptic curve. Both \"untwisted\" Montgomery curves with `B=1` and \"twisted\" Montgomery curves with arbitrary `B` are supported. The latter cannot be represented as an `EllipticCurve_generic`, so we return a `ProjectivePlaneCurve` instead. Arithmetic on that curve can be emulated by transfering back and forth to the Weierstrass form; a suitable morphism to do so can optionally be returned by the new method.\n\n(In the future, we should also add Edwards curves, but this raises more questions with non-obvious answers: Edwards curves are singular and the correspondence with Weierstrass curves is only a birational equivalence, not an isomorphism.)\n\nCC:  @defeo @JohnCremona @categorie\n\nBranch/Commit: **[4e380e2](https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8)**\n\nReviewer: **Kwankyu Lee**\n\nAuthor: **Lorenz Panny**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33707_\n\n",
    "closed_at": "2022-05-22T09:57:27Z",
    "created_at": "2022-04-14T06:15:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Montgomery model for elliptic curves",
    "type": "issue",
    "updated_at": "2022-05-22T09:57:27Z",
    "url": "https://github.com/sagemath/sage/issues/33707",
    "user": "https://github.com/yyyyx4"
}
```
Sage implements all its elliptic-curve functionality on long Weierstrass curves. This makes sense, but sometimes we'd like to interface with (or debug) other software, most commonly in cryptography, where other curve models are much more popular.

This patch adds the method `EllipticCurve_generic.montgomery_model()`, which computes a Montgomery model

    `BY^2 = X^3 + AX^2 + X`

for a given elliptic curve. Both "untwisted" Montgomery curves with `B=1` and "twisted" Montgomery curves with arbitrary `B` are supported. The latter cannot be represented as an `EllipticCurve_generic`, so we return a `ProjectivePlaneCurve` instead. Arithmetic on that curve can be emulated by transfering back and forth to the Weierstrass form; a suitable morphism to do so can optionally be returned by the new method.

(In the future, we should also add Edwards curves, but this raises more questions with non-obvious answers: Edwards curves are singular and the correspondence with Weierstrass curves is only a birational equivalence, not an isomorphism.)

CC:  @defeo @JohnCremona @categorie

Branch/Commit: **[4e380e2](https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8)**

Reviewer: **Kwankyu Lee**

Author: **Lorenz Panny**

_Issue created by migration from https://trac.sagemath.org/ticket/33707_





---

archive/issue_events_429807.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-04-14T06:15:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429807"
}
```



---

archive/issue_events_429808.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-04-14T06:15:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "component: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429808"
}
```



---

archive/issue_events_429809.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-04-14T06:15:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429809"
}
```



---

archive/issue_events_429810.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-04-14T06:15:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429810"
}
```



---

archive/issue_events_429811.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-04-14T07:08:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429811"
}
```



---

archive/issue_events_429812.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429812"
}
```



---

archive/issue_events_429813.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429813"
}
```



---

archive/issue_comments_547836.json:
```json
{
    "body": "Changed commit from **[3347fb1](https://github.com/sagemath/sagetrac-mirror/commit/3347fb1ea5ca5c1d2d05c9c44776b8db0fc501c8)** to **[c093464](https://github.com/sagemath/sagetrac-mirror/commit/c093464cfb4514bbb14ba1e56cb9111ee9185afd)**",
    "created_at": "2022-05-04T02:17:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547836",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3347fb1](https://github.com/sagemath/sagetrac-mirror/commit/3347fb1ea5ca5c1d2d05c9c44776b8db0fc501c8)** to **[c093464](https://github.com/sagemath/sagetrac-mirror/commit/c093464cfb4514bbb14ba1e56cb9111ee9185afd)**



---

archive/issue_comments_547837.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/240cf8040e0bc04148cdc0aa72ee6404eb47a6e3\">240cf80</a></td><td><code>Merge branch 'develop' into t/33707/public/montgomerize_elliptic_curves-test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c093464cfb4514bbb14ba1e56cb9111ee9185afd\">c093464</a></td><td><code>Some edits mostly improving readibility of code</code></td></tr></table>\n",
    "created_at": "2022-05-04T02:17:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547837",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>Comment 3:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/240cf8040e0bc04148cdc0aa72ee6404eb47a6e3">240cf80</a></td><td><code>Merge branch 'develop' into t/33707/public/montgomerize_elliptic_curves-test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c093464cfb4514bbb14ba1e56cb9111ee9185afd">c093464</a></td><td><code>Some edits mostly improving readibility of code</code></td></tr></table>




---

archive/issue_comments_547838.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee**",
    "created_at": "2022-05-04T02:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547838",
    "user": "https://github.com/kwankyu"
}
```

Reviewer: **Kwankyu Lee**



---

archive/issue_comments_547839.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI did some edits mostly improving readability of the code. I also wanted to change the added line in AUTHORS section to `...: added montgomery_model()`, but did not, to respect your taste. But the added line still looks difficult to read in the file. My taste is such that the AUTHORS section should contain plain text. But you may object.\n\nOtherwise, all looks good to me. You can set positive review if you agree with my edits.",
    "created_at": "2022-05-04T02:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547839",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:4'>Comment 4:</a>
I did some edits mostly improving readability of the code. I also wanted to change the added line in AUTHORS section to `...: added montgomery_model()`, but did not, to respect your taste. But the added line still looks difficult to read in the file. My taste is such that the AUTHORS section should contain plain text. But you may object.

Otherwise, all looks good to me. You can set positive review if you agree with my edits.



---

archive/issue_comments_547840.json:
```json
{
    "body": "Changed commit from **[c093464](https://github.com/sagemath/sagetrac-mirror/commit/c093464cfb4514bbb14ba1e56cb9111ee9185afd)** to **[ff391f9](https://github.com/sagemath/sagetrac-mirror/commit/ff391f9f4997deaad567984f1319c44a572786b8)**",
    "created_at": "2022-05-04T03:53:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547840",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c093464](https://github.com/sagemath/sagetrac-mirror/commit/c093464cfb4514bbb14ba1e56cb9111ee9185afd)** to **[ff391f9](https://github.com/sagemath/sagetrac-mirror/commit/ff391f9f4997deaad567984f1319c44a572786b8)**



---

archive/issue_comments_547841.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff391f9f4997deaad567984f1319c44a572786b8\">ff391f9</a></td><td><code>One more edit</code></td></tr></table>\n",
    "created_at": "2022-05-04T03:53:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547841",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff391f9f4997deaad567984f1319c44a572786b8">ff391f9</a></td><td><code>One more edit</code></td></tr></table>




---

archive/issue_comments_547842.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af5081aa55582ae38e88f5c852349768929f470f\">af5081a</a></td><td><code>Merge tag '9.6.rc3' into public/montgomerize_elliptic_curves</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8\">4e380e2</a></td><td><code>some more style tweaks</code></td></tr></table>\n",
    "created_at": "2022-05-04T11:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547842",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af5081aa55582ae38e88f5c852349768929f470f">af5081a</a></td><td><code>Merge tag '9.6.rc3' into public/montgomerize_elliptic_curves</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8">4e380e2</a></td><td><code>some more style tweaks</code></td></tr></table>




---

archive/issue_comments_547843.json:
```json
{
    "body": "Changed commit from **[ff391f9](https://github.com/sagemath/sagetrac-mirror/commit/ff391f9f4997deaad567984f1319c44a572786b8)** to **[4e380e2](https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8)**",
    "created_at": "2022-05-04T11:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547843",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ff391f9](https://github.com/sagemath/sagetrac-mirror/commit/ff391f9f4997deaad567984f1319c44a572786b8)** to **[4e380e2](https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8)**



---

archive/issue_comments_547844.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThank you! I just applied a few more small stylistic tweaks (including the one you suggested above).",
    "created_at": "2022-05-04T11:46:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547844",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:7'>Comment 7:</a>
Thank you! I just applied a few more small stylistic tweaks (including the one you suggested above).



---

archive/issue_events_429814.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-05-04T21:33:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429814"
}
```



---

archive/issue_events_429815.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-05-04T21:33:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429815"
}
```



---

archive/issue_comments_547845.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nThanks.",
    "created_at": "2022-05-04T21:33:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547845",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:8'>Comment 8:</a>
Thanks.



---

archive/issue_comments_547846.json:
```json
{
    "body": "Changed branch from **[public/montgomerize_elliptic_curves](https://github.com/sagemath/sagetrac-mirror/tree/public/montgomerize_elliptic_curves)** to **[4e380e2](https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8)**",
    "created_at": "2022-05-22T09:57:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33707#issuecomment-547846",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/montgomerize_elliptic_curves](https://github.com/sagemath/sagetrac-mirror/tree/public/montgomerize_elliptic_curves)** to **[4e380e2](https://github.com/sagemath/sagetrac-mirror/commit/4e380e20ddf74d370ff7a67ef294b0fc021e7ec8)**



---

archive/issue_events_429816.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-05-22T09:57:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429816"
}
```



---

archive/issue_events_429817.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ace4475237504c91afb38f639d6377be3f2086d5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-05-22T09:57:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33707",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33707#event-429817"
}
```
