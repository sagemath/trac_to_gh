# Issue 33816: Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1

archive/issues_033579.json:
```json
{
    "body": "We would use 12.2.0 plus the feature patch for Apple Silicon support that the homebrew folks use:\nhttps://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L12\n\n\n**CC:**  @culler @jhpalmieri @kliem\n\n**Branch/Commit:** [e89ba553fa43eea1539f39cc423fd0174d371b64](https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64)\n\n**Reviewer:** John Palmieri\n\n**Author:** Matthias Koeppe\n\n**Dependencies:** #34266, #34228\n\nIssue created by migration from https://trac.sagemath.org/ticket/33816\n\n",
    "closed_at": "2022-10-17T22:44:06Z",
    "created_at": "2022-05-06T15:49:38Z",
    "labels": [
        "component: packages: standard",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33816",
    "user": "https://github.com/mkoeppe"
}
```
We would use 12.2.0 plus the feature patch for Apple Silicon support that the homebrew folks use:
https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L12


**CC:**  @culler @jhpalmieri @kliem

**Branch/Commit:** [e89ba553fa43eea1539f39cc423fd0174d371b64](https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64)

**Reviewer:** John Palmieri

**Author:** Matthias Koeppe

**Dependencies:** #34266, #34228

Issue created by migration from https://trac.sagemath.org/ticket/33816





---

archive/issue_comments_549154.json:
```json
{
    "body": "<a id='comment:1'></a>\nLooks like homebrew is able to use upstream gcc 12 on M1 - https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc@12.rb",
    "created_at": "2022-05-20T02:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549154",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
Looks like homebrew is able to use upstream gcc 12 on M1 - https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc@12.rb



---

archive/issue_comments_549155.json:
```json
{
    "body": "<a id='comment:2'></a>\n... with one big patch: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc@12.rb#L43",
    "created_at": "2022-06-30T23:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549155",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
... with one big patch: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc@12.rb#L43



---

archive/issue_events_302170.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302170"
}
```



---

archive/issue_events_302171.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302171"
}
```



---

archive/issue_events_302172.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-20T19:59:32Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "rename": {
        "from": "Update gcc/gfortran to 12.1",
        "to": "Update gcc/gfortran to 12.x + Apple Silicon support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302172"
}
```



---

archive/issue_comments_549156.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-just released\n+We would use 12.2.0 plus the feature patch for Apple Silicon support that the homebrew folks use:\n+https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L12\n+\n``````\n",
    "created_at": "2022-09-20T19:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549156",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-just released
+We would use 12.2.0 plus the feature patch for Apple Silicon support that the homebrew folks use:
+https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L12
+
``````




---

archive/issue_comments_549157.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support)",
    "created_at": "2022-09-20T20:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549157",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support)



---

archive/issue_comments_549158.json:
```json
{
    "body": "**Commit:** [9ae559bbe825b1d400e636637c2df8f48809729b](https://github.com/sagemath/sagetrac-mirror/commit/9ae559bbe825b1d400e636637c2df8f48809729b)",
    "created_at": "2022-09-20T20:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549158",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [9ae559bbe825b1d400e636637c2df8f48809729b](https://github.com/sagemath/sagetrac-mirror/commit/9ae559bbe825b1d400e636637c2df8f48809729b)



---

archive/issue_comments_549159.json:
```json
{
    "body": "<a id='comment:6'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1dfeb141d5f661ea4ea3812f92472da2304a2ad5\">1dfeb14</a></td><td><code>build/pkgs/gcc: Update to 12.2.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ae559bbe825b1d400e636637c2df8f48809729b\">9ae559b</a></td><td><code>build/pkgs/gcc/patches/gcc-12.2.0-arm.patch: Import from https://raw.githubusercontent.com/Homebrew/formula-patches/1d184289/gcc/gcc-12.2.0-arm.diff</code></td></tr></table>\n",
    "created_at": "2022-09-20T20:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549159",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1dfeb141d5f661ea4ea3812f92472da2304a2ad5">1dfeb14</a></td><td><code>build/pkgs/gcc: Update to 12.2.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ae559bbe825b1d400e636637c2df8f48809729b">9ae559b</a></td><td><code>build/pkgs/gcc/patches/gcc-12.2.0-arm.patch: Import from https://raw.githubusercontent.com/Homebrew/formula-patches/1d184289/gcc/gcc-12.2.0-arm.diff</code></td></tr></table>




---

archive/issue_comments_549160.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2022-09-20T20:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549160",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_549161.json:
```json
{
    "body": "<a id='comment:7'></a>\nI don't know if this is ready yet but I tried it anyway on my new M2 laptop. It failed; the end of the log file reads\n\n```\n0  0x1010cc1a0  __assert_rtn + 140\n1  0x100f53a8c  mach_o::relocatable::Parser<arm64>::parse(mach_o::relocatable::ParserOptions const&) + 4536\n2  0x100f25d38  mach_o::relocatable::Parser<arm64>::parse(unsigned char const*, unsigned long long, char const*, long, ld::File::Ordinal, mach_o::relocatable::ParserOptions const&) + 148\n3  0x100f8e4ac  ld::tool::InputFiles::makeFile(Options::FileInfo const&, bool) + 1468\n4  0x100f91360  ___ZN2ld4tool10InputFilesC2ER7Options_block_invoke + 56\n5  0x188a041f4  _dispatch_client_callout2 + 20\n6  0x188a17954  _dispatch_apply_invoke + 224\n7  0x188a041b4  _dispatch_client_callout + 20\n8  0x188a15a04  _dispatch_root_queue_drain + 680\n9  0x188a16104  _dispatch_worker_thread2 + 164\n10  0x188bc4324  _pthread_wqthread + 228\nA linker snapshot was created at:\n\t/tmp/libstdc++.6.dylib-2022-09-20-133305.ld-snapshot\nld: Assertion failed: (_file->_atomsArrayCount == computedAtomCount && \"more atoms allocated than expected\"), function parse, file macho_relocatable_file.cpp, line 2061.\n```\nI can post the full log file if you want.",
    "created_at": "2022-09-20T20:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549161",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
I don't know if this is ready yet but I tried it anyway on my new M2 laptop. It failed; the end of the log file reads

```
0  0x1010cc1a0  __assert_rtn + 140
1  0x100f53a8c  mach_o::relocatable::Parser<arm64>::parse(mach_o::relocatable::ParserOptions const&) + 4536
2  0x100f25d38  mach_o::relocatable::Parser<arm64>::parse(unsigned char const*, unsigned long long, char const*, long, ld::File::Ordinal, mach_o::relocatable::ParserOptions const&) + 148
3  0x100f8e4ac  ld::tool::InputFiles::makeFile(Options::FileInfo const&, bool) + 1468
4  0x100f91360  ___ZN2ld4tool10InputFilesC2ER7Options_block_invoke + 56
5  0x188a041f4  _dispatch_client_callout2 + 20
6  0x188a17954  _dispatch_apply_invoke + 224
7  0x188a041b4  _dispatch_client_callout + 20
8  0x188a15a04  _dispatch_root_queue_drain + 680
9  0x188a16104  _dispatch_worker_thread2 + 164
10  0x188bc4324  _pthread_wqthread + 228
A linker snapshot was created at:
	/tmp/libstdc++.6.dylib-2022-09-20-133305.ld-snapshot
ld: Assertion failed: (_file->_atomsArrayCount == computedAtomCount && "more atoms allocated than expected"), function parse, file macho_relocatable_file.cpp, line 2061.
```
I can post the full log file if you want.



---

archive/issue_comments_549162.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks for testing. Also on Intel I ran into a build error. This will need more work.",
    "created_at": "2022-09-20T20:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549162",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Thanks for testing. Also on Intel I ran into a build error. This will need more work.



---

archive/issue_comments_549163.json:
```json
{
    "body": "<a id='comment:9'></a>\nI'm happy to test. It's just a MacBook Air, but it builds Sage faster than my iMac Pro, and I like giving it tasks.",
    "created_at": "2022-09-20T20:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549163",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
I'm happy to test. It's just a MacBook Air, but it builds Sage faster than my iMac Pro, and I like giving it tasks.



---

archive/issue_comments_549164.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49c407b9a63bbf42650eb72c07af2e4c5389207f\">49c407b</a></td><td><code>build/pkgs/gcc/spkg-build.in: Remove workarounds for ancient OS X</code></td></tr></table>\n",
    "created_at": "2022-09-21T00:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549164",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49c407b9a63bbf42650eb72c07af2e4c5389207f">49c407b</a></td><td><code>build/pkgs/gcc/spkg-build.in: Remove workarounds for ancient OS X</code></td></tr></table>




---

archive/issue_comments_549165.json:
```json
{
    "body": "**Changing commit** from \"[9ae559bbe825b1d400e636637c2df8f48809729b](https://github.com/sagemath/sagetrac-mirror/commit/9ae559bbe825b1d400e636637c2df8f48809729b)\" to \"[49c407b9a63bbf42650eb72c07af2e4c5389207f](https://github.com/sagemath/sagetrac-mirror/commit/49c407b9a63bbf42650eb72c07af2e4c5389207f)\".",
    "created_at": "2022-09-21T00:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549165",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9ae559bbe825b1d400e636637c2df8f48809729b](https://github.com/sagemath/sagetrac-mirror/commit/9ae559bbe825b1d400e636637c2df8f48809729b)" to "[49c407b9a63bbf42650eb72c07af2e4c5389207f](https://github.com/sagemath/sagetrac-mirror/commit/49c407b9a63bbf42650eb72c07af2e4c5389207f)".



---

archive/issue_comments_549166.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6de8339036d621352d9baacc0efb4591f52fe3\">ba6de83</a></td><td><code>build/pkgs/gcc/build-gcc: Unset AS, LD</code></td></tr></table>\n",
    "created_at": "2022-09-21T01:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549166",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6de8339036d621352d9baacc0efb4591f52fe3">ba6de83</a></td><td><code>build/pkgs/gcc/build-gcc: Unset AS, LD</code></td></tr></table>




---

archive/issue_comments_549167.json:
```json
{
    "body": "**Changing commit** from \"[49c407b9a63bbf42650eb72c07af2e4c5389207f](https://github.com/sagemath/sagetrac-mirror/commit/49c407b9a63bbf42650eb72c07af2e4c5389207f)\" to \"[ba6de8339036d621352d9baacc0efb4591f52fe3](https://github.com/sagemath/sagetrac-mirror/commit/ba6de8339036d621352d9baacc0efb4591f52fe3)\".",
    "created_at": "2022-09-21T01:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549167",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[49c407b9a63bbf42650eb72c07af2e4c5389207f](https://github.com/sagemath/sagetrac-mirror/commit/49c407b9a63bbf42650eb72c07af2e4c5389207f)" to "[ba6de8339036d621352d9baacc0efb4591f52fe3](https://github.com/sagemath/sagetrac-mirror/commit/ba6de8339036d621352d9baacc0efb4591f52fe3)".



---

archive/issue_comments_549168.json:
```json
{
    "body": "<a id='comment:12'></a>\nOn Intel, this still fails `tox -e local-macos-nohomebrew -- gfortran`, but it passes with the full bootstrapped build `tox -e local-macos-nohomebrew -- gcc`.\n\nThe failure when trying to build `gfortran` using Apple's gcc (clang) is introduced by the patch - passing the argument `-nodefaultrpaths` to the compiler.",
    "created_at": "2022-09-21T02:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549168",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
On Intel, this still fails `tox -e local-macos-nohomebrew -- gfortran`, but it passes with the full bootstrapped build `tox -e local-macos-nohomebrew -- gcc`.

The failure when trying to build `gfortran` using Apple's gcc (clang) is introduced by the patch - passing the argument `-nodefaultrpaths` to the compiler.



---

archive/issue_comments_549169.json:
```json
{
    "body": "**Changing commit** from \"[ba6de8339036d621352d9baacc0efb4591f52fe3](https://github.com/sagemath/sagetrac-mirror/commit/ba6de8339036d621352d9baacc0efb4591f52fe3)\" to \"[5d9563be5c4853d61e4127b19c9c3bd1e1468f7a](https://github.com/sagemath/sagetrac-mirror/commit/5d9563be5c4853d61e4127b19c9c3bd1e1468f7a)\".",
    "created_at": "2022-09-21T02:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ba6de8339036d621352d9baacc0efb4591f52fe3](https://github.com/sagemath/sagetrac-mirror/commit/ba6de8339036d621352d9baacc0efb4591f52fe3)" to "[5d9563be5c4853d61e4127b19c9c3bd1e1468f7a](https://github.com/sagemath/sagetrac-mirror/commit/5d9563be5c4853d61e4127b19c9c3bd1e1468f7a)".



---

archive/issue_comments_549170.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d9563be5c4853d61e4127b19c9c3bd1e1468f7a\">5d9563b</a></td><td><code>build/pkgs/gfortran/spkg-build.in: Work around build failure with Apple gcc (clang)</code></td></tr></table>\n",
    "created_at": "2022-09-21T02:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d9563be5c4853d61e4127b19c9c3bd1e1468f7a">5d9563b</a></td><td><code>build/pkgs/gfortran/spkg-build.in: Work around build failure with Apple gcc (clang)</code></td></tr></table>




---

archive/issue_comments_549171.json:
```json
{
    "body": "<a id='comment:14'></a>\nThis builds for me now on Intel. Haven't tested anything else yet",
    "created_at": "2022-09-21T02:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549171",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
This builds for me now on Intel. Haven't tested anything else yet



---

archive/issue_comments_549172.json:
```json
{
    "body": "<a id='comment:15'></a>\nStill fails for me on m2.",
    "created_at": "2022-09-21T02:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549172",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Still fails for me on m2.



---

archive/issue_comments_549173.json:
```json
{
    "body": "<a id='comment:16'></a>\nfull log please",
    "created_at": "2022-09-21T02:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549173",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
full log please



---

archive/issue_comments_549174.json:
```json
{
    "body": "<a id='comment:17'></a>\nHold on, I tried `make gcc`. I'm going to try `make gfortran` and see how that goes.",
    "created_at": "2022-09-21T02:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549174",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>
Hold on, I tried `make gcc`. I'm going to try `make gfortran` and see how that goes.



---

archive/issue_comments_549175.json:
```json
{
    "body": "<a id='comment:18'></a>\n`gfortran` built successfully.",
    "created_at": "2022-09-21T02:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549175",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
`gfortran` built successfully.



---

archive/issue_comments_549176.json:
```json
{
    "body": "<a id='comment:19'></a>\nGreat! I think we can ignore the failure to build gcc. We haven't been testing those in quite a while",
    "created_at": "2022-09-21T02:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549176",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Great! I think we can ignore the failure to build gcc. We haven't been testing those in quite a while



---

archive/issue_comments_549177.json:
```json
{
    "body": "<a id='comment:20'></a>\nI'll run this for the Linux platforms on CI, just to be sure that this big patch doesn't break anything for those",
    "created_at": "2022-09-21T02:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549177",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
I'll run this for the Linux platforms on CI, just to be sure that this big patch doesn't break anything for those



---

archive/issue_comments_549178.json:
```json
{
    "body": "<a id='comment:21'></a>\nI assume that it works, but I can't test it properly since `openblas` won't build on this machine, and Sage insists on trying to build its own `openblas` if it builds its own `gfortran`.",
    "created_at": "2022-09-21T02:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549178",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>
I assume that it works, but I can't test it properly since `openblas` won't build on this machine, and Sage insists on trying to build its own `openblas` if it builds its own `gfortran`.



---

archive/issue_comments_549179.json:
```json
{
    "body": "<a id='comment:22'></a>\nMaybe worth trying if an openblas upgrade fixes the problem?",
    "created_at": "2022-09-21T03:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549179",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Maybe worth trying if an openblas upgrade fixes the problem?



---

archive/issue_comments_549180.json:
```json
{
    "body": "<a id='comment:23'></a>\nhomebrew uses 0.3.21, we are still at 0.3.20\nhttps://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/openblas.rb",
    "created_at": "2022-09-21T03:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549180",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>
homebrew uses 0.3.21, we are still at 0.3.20
https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/openblas.rb



---

archive/issue_comments_549181.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e6af03773b262fd791c8dd5aeaf2256bdc84adc\">6e6af03</a></td><td><code>build/pkgs/openblas: Update to 0.3.21</code></td></tr></table>\n",
    "created_at": "2022-09-21T03:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549181",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e6af03773b262fd791c8dd5aeaf2256bdc84adc">6e6af03</a></td><td><code>build/pkgs/openblas: Update to 0.3.21</code></td></tr></table>




---

archive/issue_comments_549182.json:
```json
{
    "body": "**Changing commit** from \"[5d9563be5c4853d61e4127b19c9c3bd1e1468f7a](https://github.com/sagemath/sagetrac-mirror/commit/5d9563be5c4853d61e4127b19c9c3bd1e1468f7a)\" to \"[6e6af03773b262fd791c8dd5aeaf2256bdc84adc](https://github.com/sagemath/sagetrac-mirror/commit/6e6af03773b262fd791c8dd5aeaf2256bdc84adc)\".",
    "created_at": "2022-09-21T03:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5d9563be5c4853d61e4127b19c9c3bd1e1468f7a](https://github.com/sagemath/sagetrac-mirror/commit/5d9563be5c4853d61e4127b19c9c3bd1e1468f7a)" to "[6e6af03773b262fd791c8dd5aeaf2256bdc84adc](https://github.com/sagemath/sagetrac-mirror/commit/6e6af03773b262fd791c8dd5aeaf2256bdc84adc)".



---

archive/issue_events_302173.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-21T03:24:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "rename": {
        "from": "Update gcc/gfortran to 12.x + Apple Silicon support",
        "to": "Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302173"
}
```



---

archive/issue_comments_549183.json:
```json
{
    "body": "**Dependencies:** #34266",
    "created_at": "2022-09-21T03:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549183",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #34266



---

archive/issue_comments_549184.json:
```json
{
    "body": "**Changing commit** from \"[6e6af03773b262fd791c8dd5aeaf2256bdc84adc](https://github.com/sagemath/sagetrac-mirror/commit/6e6af03773b262fd791c8dd5aeaf2256bdc84adc)\" to \"[33668cbf857be6033e2f176913a41cb6281478ff](https://github.com/sagemath/sagetrac-mirror/commit/33668cbf857be6033e2f176913a41cb6281478ff)\".",
    "created_at": "2022-09-21T03:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549184",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6e6af03773b262fd791c8dd5aeaf2256bdc84adc](https://github.com/sagemath/sagetrac-mirror/commit/6e6af03773b262fd791c8dd5aeaf2256bdc84adc)" to "[33668cbf857be6033e2f176913a41cb6281478ff](https://github.com/sagemath/sagetrac-mirror/commit/33668cbf857be6033e2f176913a41cb6281478ff)".



---

archive/issue_comments_549185.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100\">ca6d163</a></td><td><code>.github/workflows/ci-linux.yml: Rename stages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8\">5713937</a></td><td><code>sage -package list --has-file, --no-file: Handle disjunctions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c7e0c4c03432e356f4d3f04e61978947a0fc171\">8c7e0c4</a></td><td><code>Merge #33062</code></td></tr><tr><td>[4e8ec60](https://github.com/sagemath/sagetrac-mirror/commit/4e8ec602ed0653b6dbc0b19f45e48f943555e7c4)</td><td><code>`.github/workflows/docker.yml: Remove debian-stretch, fedora-{26,27,27`}</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9f4b154cfe44116bd0aa0dc6c86d9993aaaeab7\">a9f4b15</a></td><td><code>tox.ini (gcc_8), build/pkgs/_gcc8: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/120ab057065a70a24c515e1a8788c96141f9db5f\">120ab05</a></td><td><code>tox.ini (envlist): Replace docker-ubuntu-trusty-minimal with docker-ubuntu-trusty-toolchain-gcc_9-minimal</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b38bad852a3d10712f7cbcad6dfbca158f623d1\">9b38bad</a></td><td><code>build/pkgs/_gcc{9,10,11}/distros/opensuse.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccce5b1e5fb7b8ac15512b079aa3ee98d7753dab\">ccce5b1</a></td><td><code>.github/workflows/docker.yml: Use gcc_8 with ubuntu-bionic, linuxmint-19.x</code></td></tr><tr><td>[27a0882](https://github.com/sagemath/sagetrac-mirror/commit/27a0882bc43a231ebecb439f80026a3cf9c526fc)</td><td><code>`.github/workflows/docker.yml: Use gcc_11 with opensuse-15.{3,4`}</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33668cbf857be6033e2f176913a41cb6281478ff\">33668cb</a></td><td><code>Merge #34266</code></td></tr></table>\n",
    "created_at": "2022-09-21T03:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100">ca6d163</a></td><td><code>.github/workflows/ci-linux.yml: Rename stages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8">5713937</a></td><td><code>sage -package list --has-file, --no-file: Handle disjunctions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c7e0c4c03432e356f4d3f04e61978947a0fc171">8c7e0c4</a></td><td><code>Merge #33062</code></td></tr><tr><td>[4e8ec60](https://github.com/sagemath/sagetrac-mirror/commit/4e8ec602ed0653b6dbc0b19f45e48f943555e7c4)</td><td><code>`.github/workflows/docker.yml: Remove debian-stretch, fedora-{26,27,27`}</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9f4b154cfe44116bd0aa0dc6c86d9993aaaeab7">a9f4b15</a></td><td><code>tox.ini (gcc_8), build/pkgs/_gcc8: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/120ab057065a70a24c515e1a8788c96141f9db5f">120ab05</a></td><td><code>tox.ini (envlist): Replace docker-ubuntu-trusty-minimal with docker-ubuntu-trusty-toolchain-gcc_9-minimal</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b38bad852a3d10712f7cbcad6dfbca158f623d1">9b38bad</a></td><td><code>build/pkgs/_gcc{9,10,11}/distros/opensuse.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccce5b1e5fb7b8ac15512b079aa3ee98d7753dab">ccce5b1</a></td><td><code>.github/workflows/docker.yml: Use gcc_8 with ubuntu-bionic, linuxmint-19.x</code></td></tr><tr><td>[27a0882](https://github.com/sagemath/sagetrac-mirror/commit/27a0882bc43a231ebecb439f80026a3cf9c526fc)</td><td><code>`.github/workflows/docker.yml: Use gcc_11 with opensuse-15.{3,4`}</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33668cbf857be6033e2f176913a41cb6281478ff">33668cb</a></td><td><code>Merge #34266</code></td></tr></table>




---

archive/issue_comments_549186.json:
```json
{
    "body": "**Reviewer:** https://github.com/mkoeppe/sage/actions/runs/3094982876",
    "created_at": "2022-09-21T03:29:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549186",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** https://github.com/mkoeppe/sage/actions/runs/3094982876



---

archive/issue_comments_549187.json:
```json
{
    "body": "<a id='comment:29'></a>\nThis works for me on m2 and Intel.",
    "created_at": "2022-09-21T17:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549187",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:29'></a>
This works for me on m2 and Intel.



---

archive/issue_comments_549188.json:
```json
{
    "body": "<a id='comment:30'></a>\nGreat, thanks for testing! The GH Actions will still need a bit of time to test on Linux, but I'm setting it to \"needs_review\" already",
    "created_at": "2022-09-21T17:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549188",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>
Great, thanks for testing! The GH Actions will still need a bit of time to test on Linux, but I'm setting it to "needs_review" already



---

archive/issue_events_302174.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-21T17:27:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302174"
}
```



---

archive/issue_comments_549189.json:
```json
{
    "body": "<a id='comment:31'></a>\nOn the Intel machine I see some doctest failures involving numerical issues, for example\n\n```\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py\", line 402, in sage.tests.books.computational-mathematics-with-sagemath.float_doctest\nFailed example:\n    NearlySingularMatrix(RDF,n).det() == 0.0\nExpected:\n    True\nGot:\n    False\n```\nand\n\n```\nFile \"src/sage/geometry/polyhedron/base7.py\", line 569, in sage.geometry.polyhedron.base7.Polyhedron_base7.volume\nFailed example:\n    w = Dinexact.faces(2)[2].as_polyhedron().volume(measure='induced', engine='internal'); RDF(w) # abs tol 1e-9\nExpected:\n    1.5340627082974878\nGot:\n    8.032456584010367\nTolerance exceeded:\n    1.5340627082974878 vs 8.032456584010367, tolerance 7e0 > 1e-9\n```",
    "created_at": "2022-09-21T19:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549189",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'></a>
On the Intel machine I see some doctest failures involving numerical issues, for example

```
File "src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py", line 402, in sage.tests.books.computational-mathematics-with-sagemath.float_doctest
Failed example:
    NearlySingularMatrix(RDF,n).det() == 0.0
Expected:
    True
Got:
    False
```
and

```
File "src/sage/geometry/polyhedron/base7.py", line 569, in sage.geometry.polyhedron.base7.Polyhedron_base7.volume
Failed example:
    w = Dinexact.faces(2)[2].as_polyhedron().volume(measure='induced', engine='internal'); RDF(w) # abs tol 1e-9
Expected:
    1.5340627082974878
Got:
    8.032456584010367
Tolerance exceeded:
    1.5340627082974878 vs 8.032456584010367, tolerance 7e0 > 1e-9
```



---

archive/issue_comments_549190.json:
```json
{
    "body": "<a id='comment:32'></a>\nMaybe related to #31621?",
    "created_at": "2022-09-21T19:21:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549190",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>
Maybe related to #31621?



---

archive/issue_comments_549191.json:
```json
{
    "body": "<a id='comment:33'></a>\nI think many of our RDF doctests are frivolous. \n\nThe RDF determinant goes through `scipy.linalg.det` as far I can see, and that is also what goes into the volume computation",
    "created_at": "2022-09-21T19:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549191",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
I think many of our RDF doctests are frivolous. 

The RDF determinant goes through `scipy.linalg.det` as far I can see, and that is also what goes into the volume computation



---

archive/issue_comments_549192.json:
```json
{
    "body": "<a id='comment:34'></a>\nThat said, the result for the dodecahedron volume is quite concerning.",
    "created_at": "2022-09-21T19:41:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549192",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
That said, the result for the dodecahedron volume is quite concerning.



---

archive/issue_comments_549193.json:
```json
{
    "body": "<a id='comment:36'></a>\nI'm attaching a file showing all of the failures.",
    "created_at": "2022-09-21T19:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549193",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'></a>
I'm attaching a file showing all of the failures.



---

archive/attachments_021610.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "test.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket33816/test.log",
    "created_at": "2022-09-21T19:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```



---

archive/issue_comments_549194.json:
```json
{
    "body": "<a id='comment:37'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204\">3ad48d0</a></td><td><code>build/pkgs/gsl: Update to 2.7.1</code></td></tr></table>\n",
    "created_at": "2022-09-21T19:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204">3ad48d0</a></td><td><code>build/pkgs/gsl: Update to 2.7.1</code></td></tr></table>




---

archive/issue_comments_549195.json:
```json
{
    "body": "**Changing commit** from \"[33668cbf857be6033e2f176913a41cb6281478ff](https://github.com/sagemath/sagetrac-mirror/commit/33668cbf857be6033e2f176913a41cb6281478ff)\" to \"[3ad48d0f3428b5263bf831e23f6d6fd7ece09204](https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204)\".",
    "created_at": "2022-09-21T19:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549195",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[33668cbf857be6033e2f176913a41cb6281478ff](https://github.com/sagemath/sagetrac-mirror/commit/33668cbf857be6033e2f176913a41cb6281478ff)" to "[3ad48d0f3428b5263bf831e23f6d6fd7ece09204](https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204)".



---

archive/issue_comments_549196.json:
```json
{
    "body": "<a id='comment:38'></a>\nAnd again, this is on a machine where I have seen numerical issues before, as discussed in #31621.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204\">3ad48d0</a></td><td><code>build/pkgs/gsl: Update to 2.7.1</code></td></tr></table>\n",
    "created_at": "2022-09-21T19:52:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549196",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'></a>
And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204">3ad48d0</a></td><td><code>build/pkgs/gsl: Update to 2.7.1</code></td></tr></table>




---

archive/issue_comments_549197.json:
```json
{
    "body": "<a id='comment:39'></a>\nThrowing in a GSL upgrade just so we're up to date on everything that implements RDF stuff",
    "created_at": "2022-09-21T19:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549197",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
Throwing in a GSL upgrade just so we're up to date on everything that implements RDF stuff



---

archive/issue_events_302175.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-21T19:53:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "rename": {
        "from": "Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21",
        "to": "Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302175"
}
```



---

archive/issue_comments_549198.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [John Palmieri](#comment%3A38):\n> And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.\n\n\nI guess I'll have to re-read #31621 more carefully.",
    "created_at": "2022-09-21T19:54:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549198",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
Replying to [John Palmieri](#comment%3A38):
> And again, this is on a machine where I have seen numerical issues before, as discussed in #31621.


I guess I'll have to re-read #31621 more carefully.



---

archive/issue_comments_549199.json:
```json
{
    "body": "<a id='comment:41'></a>\nOne hypothesis in #31621 was the flag `-march=native` was causing problems somewhere: `openblas`, `gsl`, somewhere else?\n\nFor this ticket, it is certainly possible that these errors are not caused by building our own `gfortran` but by other packages which are built as a result of building our own `gfortran`.",
    "created_at": "2022-09-21T20:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549199",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:41'></a>
One hypothesis in #31621 was the flag `-march=native` was causing problems somewhere: `openblas`, `gsl`, somewhere else?

For this ticket, it is certainly possible that these errors are not caused by building our own `gfortran` but by other packages which are built as a result of building our own `gfortran`.



---

archive/issue_comments_549200.json:
```json
{
    "body": "<a id='comment:42'></a>\nRegarding `gsl`, `gfortran`, and `openblas`: with the branch here, on two different machines, I see\n\n- If I do `./configure --with-system-gfortran=no`, everything builds, although I get numerical failures on one of the machines (Intel).\n- If I instead do `./configure --with-system-openblas=no`, then `gsl` fails to build: the error says `ld: file not found: `@`rpath/libquadmath.0.dylib for architecture x86_64` (Intel) and similar on M2 (but with `arm64` at the end). On the Intel machine at least, I see the same with the previous version of `gsl`: the upgrade had no effect.\n- If I instead do `./configure --with-system-gsl=no`, then everything builds and I do not see the same numerical failures.\n\nSo it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.",
    "created_at": "2022-09-21T21:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549200",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:42'></a>
Regarding `gsl`, `gfortran`, and `openblas`: with the branch here, on two different machines, I see

- If I do `./configure --with-system-gfortran=no`, everything builds, although I get numerical failures on one of the machines (Intel).
- If I instead do `./configure --with-system-openblas=no`, then `gsl` fails to build: the error says `ld: file not found: `@`rpath/libquadmath.0.dylib for architecture x86_64` (Intel) and similar on M2 (but with `arm64` at the end). On the Intel machine at least, I see the same with the previous version of `gsl`: the upgrade had no effect.
- If I instead do `./configure --with-system-gsl=no`, then everything builds and I do not see the same numerical failures.

So it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.



---

archive/issue_comments_549201.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [John Palmieri](#comment%3A42):\n> So it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.\n\n\nConfirmed: I get the same errors with the `develop` branch plus `--with-system-gfortran=no`.",
    "created_at": "2022-09-21T22:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549201",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'></a>
Replying to [John Palmieri](#comment%3A42):
> So it's hard to tell whether the error is coming from `gfortran` or `openblas` or something else. I will try with the Intel machine doing `./configure --with-system-gfortran=no` without this branch and see if the same errors arise.


Confirmed: I get the same errors with the `develop` branch plus `--with-system-gfortran=no`.



---

archive/issue_comments_549202.json:
```json
{
    "body": "<a id='comment:44'></a>\nNow I would like to track down two issues, perhaps neither of which are related to this ticket: \n\n1. the numerical failures on this machine\n2. the failure of `gsl` to build with homebrew's `gfortran` and Sage's `openblas`\n\nCould 2 be related to this message in the `openblas` log (`./configure --with-system-openblas=no`):\n\n```\nld: warning: dylib (/usr/local/Cellar/gcc/12.2.0/lib/gcc/current/libgfortran.dylib) was built for newer macOS version (12.0) than being linked (10.8)\n```",
    "created_at": "2022-09-21T22:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549202",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'></a>
Now I would like to track down two issues, perhaps neither of which are related to this ticket: 

1. the numerical failures on this machine
2. the failure of `gsl` to build with homebrew's `gfortran` and Sage's `openblas`

Could 2 be related to this message in the `openblas` log (`./configure --with-system-openblas=no`):

```
ld: warning: dylib (/usr/local/Cellar/gcc/12.2.0/lib/gcc/current/libgfortran.dylib) was built for newer macOS version (12.0) than being linked (10.8)
```



---

archive/issue_comments_549203.json:
```json
{
    "body": "<a id='comment:45'></a>\nCould you post the failing gsl build log?",
    "created_at": "2022-09-22T00:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549203",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Could you post the failing gsl build log?



---

archive/attachments_021611.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "gsl-2.7.1.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket33816/gsl-2.7.1.log",
    "created_at": "2022-09-22T00:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_549204.json:
```json
{
    "body": "",
    "created_at": "2022-09-22T00:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549204",
    "user": "https://github.com/jhpalmieri"
}
```





---

archive/issue_comments_549205.json:
```json
{
    "body": "<a id='comment:46'></a>\nHere it is.",
    "created_at": "2022-09-22T00:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549205",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:46'></a>
Here it is.



---

archive/issue_comments_549206.json:
```json
{
    "body": "**Changing commit** from \"[3ad48d0f3428b5263bf831e23f6d6fd7ece09204](https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204)\" to \"[1e24d43c0371b3285ad508cd95f2f3e31e66dd58](https://github.com/sagemath/sagetrac-mirror/commit/1e24d43c0371b3285ad508cd95f2f3e31e66dd58)\".",
    "created_at": "2022-09-22T00:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3ad48d0f3428b5263bf831e23f6d6fd7ece09204](https://github.com/sagemath/sagetrac-mirror/commit/3ad48d0f3428b5263bf831e23f6d6fd7ece09204)" to "[1e24d43c0371b3285ad508cd95f2f3e31e66dd58](https://github.com/sagemath/sagetrac-mirror/commit/1e24d43c0371b3285ad508cd95f2f3e31e66dd58)".



---

archive/issue_comments_549207.json:
```json
{
    "body": "<a id='comment:47'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e24d43c0371b3285ad508cd95f2f3e31e66dd58\">1e24d43</a></td><td><code>build/pkgs/gsl/patches: Import https://raw.githubusercontent.com/Homebrew/formula-patches/03cf8088210822aa2c1ab544ed58ea04c897d9c4/libtool/configure-big_sur.diff</code></td></tr></table>\n",
    "created_at": "2022-09-22T00:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e24d43c0371b3285ad508cd95f2f3e31e66dd58">1e24d43</a></td><td><code>build/pkgs/gsl/patches: Import https://raw.githubusercontent.com/Homebrew/formula-patches/03cf8088210822aa2c1ab544ed58ea04c897d9c4/libtool/configure-big_sur.diff</code></td></tr></table>




---

archive/issue_comments_549208.json:
```json
{
    "body": "<a id='comment:48'></a>\nTry with this please",
    "created_at": "2022-09-22T00:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549208",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:48'></a>
Try with this please



---

archive/issue_comments_549209.json:
```json
{
    "body": "**Changing commit** from \"[1e24d43c0371b3285ad508cd95f2f3e31e66dd58](https://github.com/sagemath/sagetrac-mirror/commit/1e24d43c0371b3285ad508cd95f2f3e31e66dd58)\" to \"[07d2dcbc22cb66741c8fcb69a1104c93b28e08d8](https://github.com/sagemath/sagetrac-mirror/commit/07d2dcbc22cb66741c8fcb69a1104c93b28e08d8)\".",
    "created_at": "2022-09-22T01:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549209",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1e24d43c0371b3285ad508cd95f2f3e31e66dd58](https://github.com/sagemath/sagetrac-mirror/commit/1e24d43c0371b3285ad508cd95f2f3e31e66dd58)" to "[07d2dcbc22cb66741c8fcb69a1104c93b28e08d8](https://github.com/sagemath/sagetrac-mirror/commit/07d2dcbc22cb66741c8fcb69a1104c93b28e08d8)".



---

archive/issue_comments_549210.json:
```json
{
    "body": "<a id='comment:49'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07d2dcbc22cb66741c8fcb69a1104c93b28e08d8\">07d2dcb</a></td><td><code>.github/workflows/docker.yml: Use ubuntu-bionic-i386 with gcc_8, remove manylinux-2_24-i686 (based on dropped debian-stretch)</code></td></tr></table>\n",
    "created_at": "2022-09-22T01:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07d2dcbc22cb66741c8fcb69a1104c93b28e08d8">07d2dcb</a></td><td><code>.github/workflows/docker.yml: Use ubuntu-bionic-i386 with gcc_8, remove manylinux-2_24-i686 (based on dropped debian-stretch)</code></td></tr></table>




---

archive/issue_comments_549211.json:
```json
{
    "body": "<a id='comment:50'></a>\nThis works, thank you.",
    "created_at": "2022-09-22T03:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549211",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'></a>
This works, thank you.



---

archive/issue_comments_549212.json:
```json
{
    "body": "<a id='comment:51'></a>\nWorks well: with each of: `--with-system-gfortran=no`, `--with-system-openblas=no`, `--with-system-gsl=no`, `gsl` builds and passes its test suite on an Intel machine and on an m2 machine. With at least one of those options I also did `make ptestlong` and everything passed.",
    "created_at": "2022-09-22T04:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549212",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:51'></a>
Works well: with each of: `--with-system-gfortran=no`, `--with-system-openblas=no`, `--with-system-gsl=no`, `gsl` builds and passes its test suite on an Intel machine and on an m2 machine. With at least one of those options I also did `make ptestlong` and everything passed.



---

archive/issue_comments_549213.json:
```json
{
    "body": "<a id='comment:52'></a>\nMatthias, what's your assessment of the testing via GH Actions?",
    "created_at": "2022-09-22T18:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549213",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:52'></a>
Matthias, what's your assessment of the testing via GH Actions?



---

archive/issue_comments_549214.json:
```json
{
    "body": "<a id='comment:53'></a>\nThe relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named \"minimal-pre\", which builds all non-Python packages. They have succeeded for all supported platforms.\n(Commit 07d2dcb fixes a mistake I made in #34266 - I had forgotten to remove one outdated 32-bit platform and forgot to update another to use GCC 8. These two show up as failing in the GH Actions run.)\n\nUnfortunately, the 2nd build stage (\"minimal\"), which builds the Python packages and the documentation, and runs \"make ptest\", has not started to run yet (I think because of general GH Actions flakiness).\n\nI'll test the 2nd stage either manually or on a separate GH Actions run later today.",
    "created_at": "2022-09-22T19:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549214",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'></a>
The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named "minimal-pre", which builds all non-Python packages. They have succeeded for all supported platforms.
(Commit 07d2dcb fixes a mistake I made in #34266 - I had forgotten to remove one outdated 32-bit platform and forgot to update another to use GCC 8. These two show up as failing in the GH Actions run.)

Unfortunately, the 2nd build stage ("minimal"), which builds the Python packages and the documentation, and runs "make ptest", has not started to run yet (I think because of general GH Actions flakiness).

I'll test the 2nd stage either manually or on a separate GH Actions run later today.



---

archive/issue_comments_549215.json:
```json
{
    "body": "**Changing commit** from \"[07d2dcbc22cb66741c8fcb69a1104c93b28e08d8](https://github.com/sagemath/sagetrac-mirror/commit/07d2dcbc22cb66741c8fcb69a1104c93b28e08d8)\" to \"[e89ba553fa43eea1539f39cc423fd0174d371b64](https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64)\".",
    "created_at": "2022-09-22T19:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[07d2dcbc22cb66741c8fcb69a1104c93b28e08d8](https://github.com/sagemath/sagetrac-mirror/commit/07d2dcbc22cb66741c8fcb69a1104c93b28e08d8)" to "[e89ba553fa43eea1539f39cc423fd0174d371b64](https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64)".



---

archive/issue_comments_549216.json:
```json
{
    "body": "<a id='comment:54'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adddf8ee191844bedd7e6f81d655c3607fcb823d\">adddf8e</a></td><td><code>Merge tag '9.7.beta8' into t/34228/tox__e_docker_____incremental</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a90608f7ac6cd3a63ada3ae939ec4b316a902639\">a90608f</a></td><td><code>build/bin/write-dockerfile.sh: Invoke sage-package directly, do not go through ./sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85ce9a666154ce6808bd76d60706f6a351ab269d\">85ce9a6</a></td><td><code>Merge tag '9.7.rc0' into t/34228/tox__e_docker_____incremental</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d24647a646ece6f80690c508de4028bb58e23923\">d24647a</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64\">e89ba55</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo which prevented 'minimal-*' from starting</code></td></tr></table>\n",
    "created_at": "2022-09-22T19:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adddf8ee191844bedd7e6f81d655c3607fcb823d">adddf8e</a></td><td><code>Merge tag '9.7.beta8' into t/34228/tox__e_docker_____incremental</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a90608f7ac6cd3a63ada3ae939ec4b316a902639">a90608f</a></td><td><code>build/bin/write-dockerfile.sh: Invoke sage-package directly, do not go through ./sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85ce9a666154ce6808bd76d60706f6a351ab269d">85ce9a6</a></td><td><code>Merge tag '9.7.rc0' into t/34228/tox__e_docker_____incremental</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d24647a646ece6f80690c508de4028bb58e23923">d24647a</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64">e89ba55</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo which prevented 'minimal-*' from starting</code></td></tr></table>




---

archive/issue_comments_549217.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [Matthias K\u00f6ppe](#comment%3A53):\n> Unfortunately, the 2nd build stage (\"minimal\") [...] has not started to run yet (I think because of general GH Actions flakiness).\n\n\nActually, a typo was the cause. Fixed now",
    "created_at": "2022-09-22T19:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549217",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:55'></a>
Replying to [Matthias Köppe](#comment%3A53):
> Unfortunately, the 2nd build stage ("minimal") [...] has not started to run yet (I think because of general GH Actions flakiness).


Actually, a typo was the cause. Fixed now



---

archive/issue_comments_549218.json:
```json
{
    "body": "**Changing dependencies** from \"#34266\" to \"#34266, #34228\".",
    "created_at": "2022-09-22T19:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549218",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#34266" to "#34266, #34228".



---

archive/issue_comments_549219.json:
```json
{
    "body": "<a id='comment:57'></a>\n2nd stage running now at https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542",
    "created_at": "2022-09-22T19:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549219",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'></a>
2nd stage running now at https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542



---

archive/issue_comments_549220.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/3094982876\" to \"https://github.com/mkoeppe/sage/actions/runs/3094982876, https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542\".",
    "created_at": "2022-09-22T19:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549220",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/3094982876" to "https://github.com/mkoeppe/sage/actions/runs/3094982876, https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542".



---

archive/issue_comments_549221.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [Matthias K\u00f6ppe](#comment%3A53):\n> The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named \"minimal-pre\", which builds all non-Python packages. They have succeeded for all supported platforms.\n\n\n(although 4 timed out)",
    "created_at": "2022-09-22T19:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549221",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:58'></a>
Replying to [Matthias Köppe](#comment%3A53):
> The relevant tests among the many at https://github.com/mkoeppe/sage/actions/runs/3094982876 are the ones named "minimal-pre", which builds all non-Python packages. They have succeeded for all supported platforms.


(although 4 timed out)



---

archive/issue_comments_549222.json:
```json
{
    "body": "<a id='comment:59'></a>\nThere are some failures, I'll have to investigate what's going on there.",
    "created_at": "2022-09-22T22:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549222",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:59'></a>
There are some failures, I'll have to investigate what's going on there.



---

archive/issue_comments_549223.json:
```json
{
    "body": "<a id='comment:60'></a>\nLooks like the failures are only due to a flaw in my new 2-stage workflow, related to the use of `-arch=native`. For example, looking into the config.log of the failing `fflas_ffpack` package on `fedora-35-minimal` https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036948018, one sees:\n\n```\nconfigure:18251: checking for use of MKL\nconfigure:18268: result: no \nconfigure:18288: checking for BLAS\nconfigure:18304: g++ -std=gnu++11 -o conftest -g -O2   -I. -I.. -I. -I./fflas-ffpack -fabi-version=6   -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib  conftest.cpp  -lopenblas  >&5\nconfigure:18304: $? = 0\nconfigure:18304: ./conftest\n./configure: line 1735: 100961 Illegal instruction     (core dumped) ./conftest$ac_exeext\n```",
    "created_at": "2022-09-23T00:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549223",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>
Looks like the failures are only due to a flaw in my new 2-stage workflow, related to the use of `-arch=native`. For example, looking into the config.log of the failing `fflas_ffpack` package on `fedora-35-minimal` https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036948018, one sees:

```
configure:18251: checking for use of MKL
configure:18268: result: no 
configure:18288: checking for BLAS
configure:18304: g++ -std=gnu++11 -o conftest -g -O2   -I. -I.. -I. -I./fflas-ffpack -fabi-version=6   -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib -Wl,-rpath-link,/sage/local/lib -L/sage/local/lib -Wl,-rpath,/sage/local/lib  conftest.cpp  -lopenblas  >&5
configure:18304: $? = 0
configure:18304: ./conftest
./configure: line 1735: 100961 Illegal instruction     (core dumped) ./conftest$ac_exeext
```



---

archive/issue_comments_549224.json:
```json
{
    "body": "<a id='comment:61'></a>\nI've opened #34572 to improve this.",
    "created_at": "2022-09-23T00:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549224",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:61'></a>
I've opened #34572 to improve this.



---

archive/issue_comments_549225.json:
```json
{
    "body": "<a id='comment:62'></a>\nDo we need to test on OS X pre-Monterey? Otherwise, I'm ready to give this a positive review, at least from the OS X point of view.",
    "created_at": "2022-09-23T02:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549225",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:62'></a>
Do we need to test on OS X pre-Monterey? Otherwise, I'm ready to give this a positive review, at least from the OS X point of view.



---

archive/issue_comments_549226.json:
```json
{
    "body": "<a id='comment:63'></a>\nA test on Catalina (10.15) ran at https://github.com/mkoeppe/sage/actions/runs/3094982845/jobs/5008934048, looks OK",
    "created_at": "2022-09-23T05:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549226",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>
A test on Catalina (10.15) ran at https://github.com/mkoeppe/sage/actions/runs/3094982845/jobs/5008934048, looks OK



---

archive/issue_comments_549227.json:
```json
{
    "body": "<a id='comment:64'></a>\nI've manually tested `tox -e docker-fedora-35-minimal` (also ran `make ptest`), also fine. \n\nI've also tested `EXTRA_CONFIGURE_ARGS=--without-system-gfortran tox -e docker-ubuntu-trusty-toolchain-gcc_9-minimal`, a bit of an usual configuration, which has a failure in `src/sage/misc/inline_fortran.py`, but I don't think this is important enough to investigate more",
    "created_at": "2022-09-23T05:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549227",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'></a>
I've manually tested `tox -e docker-fedora-35-minimal` (also ran `make ptest`), also fine. 

I've also tested `EXTRA_CONFIGURE_ARGS=--without-system-gfortran tox -e docker-ubuntu-trusty-toolchain-gcc_9-minimal`, a bit of an usual configuration, which has a failure in `src/sage/misc/inline_fortran.py`, but I don't think this is important enough to investigate more



---

archive/issue_comments_549228.json:
```json
{
    "body": "<a id='comment:65'></a>\nSo I think this is ready to go",
    "created_at": "2022-09-23T05:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549228",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'></a>
So I think this is ready to go



---

archive/issue_comments_549229.json:
```json
{
    "body": "<a id='comment:66'></a>\nOkay, let's merge it early in this release cycle, not that too many people are building our `gfortran` anyway...",
    "created_at": "2022-09-23T05:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549229",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:66'></a>
Okay, let's merge it early in this release cycle, not that too many people are building our `gfortran` anyway...



---

archive/issue_events_302176.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2022-09-23T05:35:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302176"
}
```



---

archive/issue_events_302177.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2022-09-23T05:35:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302177"
}
```



---

archive/issue_comments_549230.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/3094982876, https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542\" to \"John Palmieri\".",
    "created_at": "2022-09-23T05:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549230",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/3094982876, https://github.com/mkoeppe/sage/actions/runs/3108109396/jobs/5036946542" to "John Palmieri".



---

archive/issue_comments_549231.json:
```json
{
    "body": "<a id='comment:67'></a>\nThanks!",
    "created_at": "2022-09-23T05:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549231",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:67'></a>
Thanks!



---

archive/issue_comments_549232.json:
```json
{
    "body": "<a id='comment:68'></a>\nFull run: http://build.sagemath.org/#/builders/15/builds/5\n\nFlint testsuite dies on the kucalc buildbot (Ubuntu 16.04.5 LTS)\n\n```\ngcc -g -O2 -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src/build -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include test_helpers.o test/t-sdiv_qrnnd.c -o build/test/t-sdiv_qrnnd -L/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -lflint -lmpfr -lgmp -lm -lntl -lpthread  -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib  -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src\n(WANTDEPS=1; export WANTDEPS; BUILD_DIR=build; export BUILD_DIR; make -f Makefile.subdirs -C . check || exit $?;)\nsub_dddmmmsss....invert_limb....udiv_qrnnd....add_ssssaaaaaaaa....byte_swap....umul_ppmm....add_ssaaaa....add_sssaaaaaa....udiv_qrnnd_preinv....PASS\nsmul_ppmm....count_leading_zeros....count_trailing_zeros....PASS\nsub_ddmmss....PASS\nsdiv_qrnnd....PASS\nPASS\nPASS\nMakefile.subdirs:107: recipe for target 'build/test/t-sdiv_qrnnd_RUN' failed\nmake[6]: *** [build/test/t-sdiv_qrnnd_RUN] Floating point exception (core dumped)\nPASS\nPASS\nPASS\nPASS\nPASS\nPASS\nPASS\nmake[6]: Target 'check' not remade because of errors.\nMakefile:219: recipe for target 'check' failed\nmake[5]: *** [check] Error 2\n```",
    "created_at": "2022-09-26T22:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549232",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:68'></a>
Full run: http://build.sagemath.org/#/builders/15/builds/5

Flint testsuite dies on the kucalc buildbot (Ubuntu 16.04.5 LTS)

```
gcc -g -O2 -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -I/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src/build -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/local/include test_helpers.o test/t-sdiv_qrnnd.c -o build/test/t-sdiv_qrnnd -L/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -lflint -lmpfr -lgmp -lm -lntl -lpthread  -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath-link,/var/lib/buildbot/slave/sage_git/build/local/lib -L/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib  -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/lib -Wl,-rpath,/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/flint-2.8.4/src
(WANTDEPS=1; export WANTDEPS; BUILD_DIR=build; export BUILD_DIR; make -f Makefile.subdirs -C . check || exit $?;)
sub_dddmmmsss....invert_limb....udiv_qrnnd....add_ssssaaaaaaaa....byte_swap....umul_ppmm....add_ssaaaa....add_sssaaaaaa....udiv_qrnnd_preinv....PASS
smul_ppmm....count_leading_zeros....count_trailing_zeros....PASS
sub_ddmmss....PASS
sdiv_qrnnd....PASS
PASS
PASS
Makefile.subdirs:107: recipe for target 'build/test/t-sdiv_qrnnd_RUN' failed
make[6]: *** [build/test/t-sdiv_qrnnd_RUN] Floating point exception (core dumped)
PASS
PASS
PASS
PASS
PASS
PASS
PASS
make[6]: Target 'check' not remade because of errors.
Makefile:219: recipe for target 'check' failed
make[5]: *** [check] Error 2
```



---

archive/issue_events_302178.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-26T22:36:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302178"
}
```



---

archive/issue_events_302179.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-26T22:36:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302179"
}
```



---

archive/issue_comments_549233.json:
```json
{
    "body": "<a id='comment:69'></a>\nOur web page https://trac.sagemath.org/wiki/ReleaseTours/sage-9.8#Configurationchanges says \"Users of older Linux distributions (in particular, ubuntu-xenial or older, debian-stretch or older, linuxmint-18 or older) should upgrade their systems before attempting to install Sage from source.\" So does a test failure on Ubuntu 16.04 matter?",
    "created_at": "2022-09-26T22:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549233",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:69'></a>
Our web page https://trac.sagemath.org/wiki/ReleaseTours/sage-9.8#Configurationchanges says "Users of older Linux distributions (in particular, ubuntu-xenial or older, debian-stretch or older, linuxmint-18 or older) should upgrade their systems before attempting to install Sage from source." So does a test failure on Ubuntu 16.04 matter?



---

archive/issue_comments_549234.json:
```json
{
    "body": "<a id='comment:70'></a>\nYes, I think this buildbot should be updated to a supported configuration, for example using https://askubuntu.com/questions/1140183/install-gcc-9-on-ubuntu-18-04/1149383#1149383",
    "created_at": "2022-09-27T00:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549234",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:70'></a>
Yes, I think this buildbot should be updated to a supported configuration, for example using https://askubuntu.com/questions/1140183/install-gcc-9-on-ubuntu-18-04/1149383#1149383



---

archive/issue_comments_549235.json:
```json
{
    "body": "<a id='comment:71'></a>\nSo do we just set this back to positive, or does someone have to do something with the buildbot first?",
    "created_at": "2022-10-12T18:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549235",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:71'></a>
So do we just set this back to positive, or does someone have to do something with the buildbot first?



---

archive/issue_events_302180.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-10-13T02:13:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302180"
}
```



---

archive/issue_events_302181.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-10-13T02:13:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302181"
}
```



---

archive/issue_comments_549236.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support)\" to \"[e89ba553fa43eea1539f39cc423fd0174d371b64](https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64)\".",
    "created_at": "2022-10-17T22:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33816#issuecomment-549236",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_gcc_gfortran_to_12_x___apple_silicon_support)" to "[e89ba553fa43eea1539f39cc423fd0174d371b64](https://github.com/sagemath/sagetrac-mirror/commit/e89ba553fa43eea1539f39cc423fd0174d371b64)".



---

archive/issue_events_302182.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-17T22:44:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302182"
}
```



---

archive/issue_events_302183.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-17T22:44:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33816",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33816#event-302183"
}
```
