# Issue 33137: sage.env.sage_include_directories: Don't use distutils and SAGE_LIB

archive/issues_032900.json:
```json
{
    "body": "From #33135.\n\n- `src/sage/env.py` uses `distutils.sysconfig.get_python_inc()` which is deprecated, it has no replacement in sysconfig.\n\n Suggestion from fbissey: \"we could use sysconfig.get_config_var('INCLUDEPY') which should give the same value.\" ticket:33135#comment:7\n\nWe also remove the use of `SAGE_LIB` in preparation of namespace packages.\n\nThis is the last use of `distutils` in the Sage library, except for uses in `src/sage/features/__init__.py` and `src/sage/misc/cython.py`, which are merely fallbacks when `setuptools` is not present.\n\n Comment from arojas: \"I don't see any code in sagelib or cython that would emit this. Is this still needed at all?\"\n\nFollow-up: Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.\n\nPart of \n- Meta-ticket #31295: Replace imports from deprecated `distutils`\n- Meta-ticket #33037: Remove use of `SAGE_LIB` and `SAGE_EXTCODE` variables\n\n\n**CC:**  @antonio-rojas @dimpase\n\n**Branch:** [public/ticket-33137](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket-33137)\n\n**Commit:** [e2688ef47fac633e5f5a299106e807e23f942d28](https://github.com/sagemath/sagetrac-mirror/commit/e2688ef47fac633e5f5a299106e807e23f942d28)\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton, Matthias Koeppe\n\n**Dependencies:** #32873\n\nIssue created by migration from https://trac.sagemath.org/ticket/33137\n\n",
    "created_at": "2022-01-09T22:37:24Z",
    "labels": [
        "component: misc",
        "enhancement",
        "needs review"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "sage.env.sage_include_directories: Don't use distutils and SAGE_LIB",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33137",
    "user": "https://github.com/tornaria"
}
```
From #33135.

- `src/sage/env.py` uses `distutils.sysconfig.get_python_inc()` which is deprecated, it has no replacement in sysconfig.

 Suggestion from fbissey: "we could use sysconfig.get_config_var('INCLUDEPY') which should give the same value." ticket:33135#comment:7

We also remove the use of `SAGE_LIB` in preparation of namespace packages.

This is the last use of `distutils` in the Sage library, except for uses in `src/sage/features/__init__.py` and `src/sage/misc/cython.py`, which are merely fallbacks when `setuptools` is not present.

 Comment from arojas: "I don't see any code in sagelib or cython that would emit this. Is this still needed at all?"

Follow-up: Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.

Part of 
- Meta-ticket #31295: Replace imports from deprecated `distutils`
- Meta-ticket #33037: Remove use of `SAGE_LIB` and `SAGE_EXTCODE` variables


**CC:**  @antonio-rojas @dimpase

**Branch:** [public/ticket-33137](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket-33137)

**Commit:** [e2688ef47fac633e5f5a299106e807e23f942d28](https://github.com/sagemath/sagetrac-mirror/commit/e2688ef47fac633e5f5a299106e807e23f942d28)

**Author:** Frédéric Chapoton, Matthias Koeppe

**Dependencies:** #32873

Issue created by migration from https://trac.sagemath.org/ticket/33137





---

archive/issue_comments_539738.json:
```json
{
    "body": "<a id='comment:1'></a>\n`get_config_var` as the other advantage to be usable from python 3.8 and 3.9. So we could use it now.\n\n```\nfbissey@tarazed ~ $ python3.9\nPython 3.9.9 (main, Dec  1 2021, 10:05:37) \n[GCC 11.2.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import distutils.sysconfig\n>>> distutils.sysconfig.get_python_inc()\n'/usr/include/python3.9'\n>>> import sysconfig\n>>> sysconfig.get_config_var('INCLUDEPY')\n'/usr/include/python3.9'\n>>> \nfbissey@tarazed ~ $ python3.8\nPython 3.8.12 (default, Nov  4 2021, 22:08:42) \n[GCC 11.2.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import sysconfig\n>>> sysconfig.get_config_var('INCLUDEPY')\n'/usr/include/python3.8'\n>>> \n```",
    "created_at": "2022-01-09T23:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539738",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
`get_config_var` as the other advantage to be usable from python 3.8 and 3.9. So we could use it now.

```
fbissey@tarazed ~ $ python3.9
Python 3.9.9 (main, Dec  1 2021, 10:05:37) 
[GCC 11.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import distutils.sysconfig
>>> distutils.sysconfig.get_python_inc()
'/usr/include/python3.9'
>>> import sysconfig
>>> sysconfig.get_config_var('INCLUDEPY')
'/usr/include/python3.9'
>>> 
fbissey@tarazed ~ $ python3.8
Python 3.8.12 (default, Nov  4 2021, 22:08:42) 
[GCC 11.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import sysconfig
>>> sysconfig.get_config_var('INCLUDEPY')
'/usr/include/python3.8'
>>> 
```



---

archive/issue_comments_539739.json:
```json
{
    "body": "<a id='comment:2'></a>\nune tentative. \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35d230ae7636c32d3fbe217d76cc7bbb47b3c24a\">35d230a</a></td><td><code>less distutils in env.py and features</code></td></tr></table>\n",
    "created_at": "2022-01-10T20:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539739",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
une tentative. 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35d230ae7636c32d3fbe217d76cc7bbb47b3c24a">35d230a</a></td><td><code>less distutils in env.py and features</code></td></tr></table>




---

archive/issue_comments_539740.json:
```json
{
    "body": "**Commit:** [35d230ae7636c32d3fbe217d76cc7bbb47b3c24a](https://github.com/sagemath/sagetrac-mirror/commit/35d230ae7636c32d3fbe217d76cc7bbb47b3c24a)",
    "created_at": "2022-01-10T20:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539740",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [35d230ae7636c32d3fbe217d76cc7bbb47b3c24a](https://github.com/sagemath/sagetrac-mirror/commit/35d230ae7636c32d3fbe217d76cc7bbb47b3c24a)



---

archive/issue_comments_539741.json:
```json
{
    "body": "**Branch:** [public/ticket-33137](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket-33137)",
    "created_at": "2022-01-10T20:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539741",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [public/ticket-33137](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket-33137)



---

archive/issue_comments_539742.json:
```json
{
    "body": "<a id='comment:3'></a>\nI'd have done the first part last night [exactly that code] but I couldn't push to trac. Turns out my ssh key is now too old and needs replacing :)",
    "created_at": "2022-01-10T20:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539742",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
I'd have done the first part last night [exactly that code] but I couldn't push to trac. Turns out my ssh key is now too old and needs replacing :)



---

archive/issue_comments_539743.json:
```json
{
    "body": "<a id='comment:4'></a>\nSalut,\n\npour le reste, on peut aussi virer le bloc, plutot que de mettre RuntimeError",
    "created_at": "2022-01-10T21:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539743",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
Salut,

pour le reste, on peut aussi virer le bloc, plutot que de mettre RuntimeError



---

archive/issue_comments_539744.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [chapoton](#comment%3A4):\n> Salut,\n> \n> pour le reste, on peut aussi virer le bloc, plutot que de mettre RuntimeError\n\n\nToi, tu vas encore te faire taper sur les doigts parce que tu parle Fran\u00e7ais sur un syst\u00e8me o\u00f9 l'Anglais est la \"lingua Franca\" (je sais, c'est bizarre d'\u00e9crire \u00e7a).\n\nOtherwise, I am not too fussed about removing that block. I cannot see a test showing what it is supposed to catch and how. Antonio says it is a dead code path and there is clearly no proof otherwise anywhere.",
    "created_at": "2022-01-10T21:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539744",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
Replying to [chapoton](#comment%3A4):
> Salut,
> 
> pour le reste, on peut aussi virer le bloc, plutot que de mettre RuntimeError


Toi, tu vas encore te faire taper sur les doigts parce que tu parle Français sur un système où l'Anglais est la "lingua Franca" (je sais, c'est bizarre d'écrire ça).

Otherwise, I am not too fussed about removing that block. I cannot see a test showing what it is supposed to catch and how. Antonio says it is a dead code path and there is clearly no proof otherwise anywhere.



---

archive/issue_comments_539745.json:
```json
{
    "body": "**Dependencies:** #32873",
    "created_at": "2022-01-10T22:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539745",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32873



---

archive/issue_comments_539746.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,3 +9,6 @@\n  Comment from arojas: \"I don't see any code in sagelib or cython that would emit this. Is this still needed at all?\"\n \n Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.\n+\n+\n+Part of Meta-ticket #31295: Replace imports from deprecated distutils\n``````\n",
    "created_at": "2022-01-10T22:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539746",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,3 +9,6 @@
  Comment from arojas: "I don't see any code in sagelib or cython that would emit this. Is this still needed at all?"
 
 Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.
+
+
+Part of Meta-ticket #31295: Replace imports from deprecated distutils
``````




---

archive/issue_comments_539747.json:
```json
{
    "body": "<a id='comment:8'></a>\napparemment le changement dans features est en conflit avec #32873",
    "created_at": "2022-01-11T11:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539747",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
apparemment le changement dans features est en conflit avec #32873



---

archive/issue_comments_539748.json:
```json
{
    "body": "**Changing commit** from \"[35d230ae7636c32d3fbe217d76cc7bbb47b3c24a](https://github.com/sagemath/sagetrac-mirror/commit/35d230ae7636c32d3fbe217d76cc7bbb47b3c24a)\" to \"[58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2](https://github.com/sagemath/sagetrac-mirror/commit/58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2)\".",
    "created_at": "2022-01-11T11:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539748",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[35d230ae7636c32d3fbe217d76cc7bbb47b3c24a](https://github.com/sagemath/sagetrac-mirror/commit/35d230ae7636c32d3fbe217d76cc7bbb47b3c24a)" to "[58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2](https://github.com/sagemath/sagetrac-mirror/commit/58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2)".



---

archive/issue_comments_539749.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2\">58b0948</a></td><td><code>less distutils in env.py</code></td></tr></table>\n",
    "created_at": "2022-01-11T11:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539749",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2">58b0948</a></td><td><code>less distutils in env.py</code></td></tr></table>




---

archive/issue_comments_539750.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [chapoton](#comment%3A8):\n> apparemment le changement dans features est en conflit avec #32873\n\n\nYes and I positively reviewed that ticket. I thought we were dealing with something different. In another ticket of mine about doctest failures on distro, Matthias pointed me out to three tickets - one of which I reviewed, again. It seems to me there are far too many tickets of that kind not included in 9.5.rc0. It is hard to figure out what is already on trac.",
    "created_at": "2022-01-11T18:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539750",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'></a>
Replying to [chapoton](#comment%3A8):
> apparemment le changement dans features est en conflit avec #32873


Yes and I positively reviewed that ticket. I thought we were dealing with something different. In another ticket of mine about doctest failures on distro, Matthias pointed me out to three tickets - one of which I reviewed, again. It seems to me there are far too many tickets of that kind not included in 9.5.rc0. It is hard to figure out what is already on trac.



---

archive/issue_events_302018.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33137#event-302018"
}
```



---

archive/issue_events_302019.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33137#event-302019"
}
```



---

archive/issue_comments_539751.json:
```json
{
    "body": "<a id='comment:12'></a>\nFrom `tornaria` ticket:33473#comment:22:\n  indeed it seems setuptools adds the python include location to the compiler command line, in fact with the following comment in setuptools/_distutils/command/build_ext.py:\n\n  ```\n        # Put the Python \"system\" include dir at the end, so that\n        # any local include dirs take precedence.\n  ```",
    "created_at": "2022-07-02T22:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539751",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
From `tornaria` ticket:33473#comment:22:
  indeed it seems setuptools adds the python include location to the compiler command line, in fact with the following comment in setuptools/_distutils/command/build_ext.py:

  ```
        # Put the Python "system" include dir at the end, so that
        # any local include dirs take precedence.
  ```



---

archive/issue_comments_539752.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/824e9fa606ea540de20dfbd8a2987efe35aacc3d\">824e9fa</a></td><td><code>sage.env.sage_include_directories: Do not append distutils.sysconfig.get_python_inc()</code></td></tr></table>\n",
    "created_at": "2022-07-02T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539752",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/824e9fa606ea540de20dfbd8a2987efe35aacc3d">824e9fa</a></td><td><code>sage.env.sage_include_directories: Do not append distutils.sysconfig.get_python_inc()</code></td></tr></table>




---

archive/issue_comments_539753.json:
```json
{
    "body": "**Changing commit** from \"[58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2](https://github.com/sagemath/sagetrac-mirror/commit/58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2)\" to \"[824e9fa606ea540de20dfbd8a2987efe35aacc3d](https://github.com/sagemath/sagetrac-mirror/commit/824e9fa606ea540de20dfbd8a2987efe35aacc3d)\".",
    "created_at": "2022-07-02T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539753",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2](https://github.com/sagemath/sagetrac-mirror/commit/58b0948ef555ba08e8b8f9f6a5bea5b9f5685ea2)" to "[824e9fa606ea540de20dfbd8a2987efe35aacc3d](https://github.com/sagemath/sagetrac-mirror/commit/824e9fa606ea540de20dfbd8a2987efe35aacc3d)".



---

archive/issue_events_302020.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-02T22:35:20Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "rename": {
        "from": "Don't use distutils in sage",
        "to": "sage.env.sage_include_directories: Don't use distutils and SAGE_LIB"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33137#event-302020"
}
```



---

archive/issue_comments_539754.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,11 +4,13 @@\n \n  Suggestion from fbissey: \"we could use sysconfig.get_config_var('INCLUDEPY') which should give the same value.\" ticket:33135#comment:7\n \n-- `src/sage/features/__init__.py` uses `distutils.errors.CCompilerError` which is not present in `setuptools.errors`.\n+This is the last use of `distutils` in the Sage library, except for uses in `src/sage/features/__init__.py` and `src/sage/misc/cython.py`, which are merely fallbacks when `setuptools` is not present.\n \n  Comment from arojas: \"I don't see any code in sagelib or cython that would emit this. Is this still needed at all?\"\n \n-Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.\n+Follow-up: Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.\n \n+Part of \n+- Meta-ticket #31295: Replace imports from deprecated `distutils`\n+- Meta-ticket #33037: Remove use of `SAGE_LIB` and `SAGE_EXTCODE` variables\n \n-Part of Meta-ticket #31295: Replace imports from deprecated distutils\n``````\n",
    "created_at": "2022-07-02T22:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539754",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,11 +4,13 @@
 
  Suggestion from fbissey: "we could use sysconfig.get_config_var('INCLUDEPY') which should give the same value." ticket:33135#comment:7
 
-- `src/sage/features/__init__.py` uses `distutils.errors.CCompilerError` which is not present in `setuptools.errors`.
+This is the last use of `distutils` in the Sage library, except for uses in `src/sage/features/__init__.py` and `src/sage/misc/cython.py`, which are merely fallbacks when `setuptools` is not present.
 
  Comment from arojas: "I don't see any code in sagelib or cython that would emit this. Is this still needed at all?"
 
-Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.
+Follow-up: Once these uses of distutils are removed, their modules can be removed from the regex in the call to filterwarnings introduced by #33135.
 
+Part of 
+- Meta-ticket #31295: Replace imports from deprecated `distutils`
+- Meta-ticket #33037: Remove use of `SAGE_LIB` and `SAGE_EXTCODE` variables
 
-Part of Meta-ticket #31295: Replace imports from deprecated distutils
``````




---

archive/issue_comments_539755.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb965ece366c9d67cfb99354c855f258267d600b\">fb965ec</a></td><td><code>sage.env.sage_include_directories: Append sysconfig variable INCLUDEPY</code></td></tr></table>\n",
    "created_at": "2022-07-02T23:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539755",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb965ece366c9d67cfb99354c855f258267d600b">fb965ec</a></td><td><code>sage.env.sage_include_directories: Append sysconfig variable INCLUDEPY</code></td></tr></table>




---

archive/issue_comments_539756.json:
```json
{
    "body": "**Changing commit** from \"[824e9fa606ea540de20dfbd8a2987efe35aacc3d](https://github.com/sagemath/sagetrac-mirror/commit/824e9fa606ea540de20dfbd8a2987efe35aacc3d)\" to \"[fb965ece366c9d67cfb99354c855f258267d600b](https://github.com/sagemath/sagetrac-mirror/commit/fb965ece366c9d67cfb99354c855f258267d600b)\".",
    "created_at": "2022-07-02T23:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539756",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[824e9fa606ea540de20dfbd8a2987efe35aacc3d](https://github.com/sagemath/sagetrac-mirror/commit/824e9fa606ea540de20dfbd8a2987efe35aacc3d)" to "[fb965ece366c9d67cfb99354c855f258267d600b](https://github.com/sagemath/sagetrac-mirror/commit/fb965ece366c9d67cfb99354c855f258267d600b)".



---

archive/issue_comments_539757.json:
```json
{
    "body": "**Author:** Fr\u00e9d\u00e9ric Chapoton, Matthias Koeppe",
    "created_at": "2022-07-02T23:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539757",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Frédéric Chapoton, Matthias Koeppe



---

archive/issue_comments_539758.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [mkoeppe](#comment%3A12):\n> From `tornaria` ticket:33473#comment:22:\n>   indeed it seems setuptools adds the python include location to the compiler command line, in fact with the following comment in setuptools/_distutils/command/build_ext.py:\n> \n>   ```\n>         # Put the Python \"system\" include dir at the end, so that\n>         # any local include dirs take precedence.\n>   ```\n\n\nNevertheless, I have put `sysconfig.get_config_var('INCLUDEPY')` back in: `sage.misc.cython.cython` appends some directories to the result of `sage_include_directories()`, so let's not provoke some subtle changes in the order of looking up libraries when users use the runtime Cython.",
    "created_at": "2022-07-02T23:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539758",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Replying to [mkoeppe](#comment%3A12):
> From `tornaria` ticket:33473#comment:22:
>   indeed it seems setuptools adds the python include location to the compiler command line, in fact with the following comment in setuptools/_distutils/command/build_ext.py:
> 
>   ```
>         # Put the Python "system" include dir at the end, so that
>         # any local include dirs take precedence.
>   ```


Nevertheless, I have put `sysconfig.get_config_var('INCLUDEPY')` back in: `sage.misc.cython.cython` appends some directories to the result of `sage_include_directories()`, so let's not provoke some subtle changes in the order of looking up libraries when users use the runtime Cython.



---

archive/issue_events_302021.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-02T23:27:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33137#event-302021"
}
```



---

archive/issue_comments_539759.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,6 +3,8 @@\n - `src/sage/env.py` uses `distutils.sysconfig.get_python_inc()` which is deprecated, it has no replacement in sysconfig.\n \n  Suggestion from fbissey: \"we could use sysconfig.get_config_var('INCLUDEPY') which should give the same value.\" ticket:33135#comment:7\n+\n+We also remove the use of `SAGE_LIB` in preparation of namespace packages.\n \n This is the last use of `distutils` in the Sage library, except for uses in `src/sage/features/__init__.py` and `src/sage/misc/cython.py`, which are merely fallbacks when `setuptools` is not present.\n \n``````\n",
    "created_at": "2022-07-02T23:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539759",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,6 +3,8 @@
 - `src/sage/env.py` uses `distutils.sysconfig.get_python_inc()` which is deprecated, it has no replacement in sysconfig.
 
  Suggestion from fbissey: "we could use sysconfig.get_config_var('INCLUDEPY') which should give the same value." ticket:33135#comment:7
+
+We also remove the use of `SAGE_LIB` in preparation of namespace packages.
 
 This is the last use of `distutils` in the Sage library, except for uses in `src/sage/features/__init__.py` and `src/sage/misc/cython.py`, which are merely fallbacks when `setuptools` is not present.
 
``````




---

archive/issue_events_302022.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33137#event-302022"
}
```



---

archive/issue_events_302023.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33137#event-302023"
}
```



---

archive/issue_comments_539760.json:
```json
{
    "body": "**Changing commit** from \"[fb965ece366c9d67cfb99354c855f258267d600b](https://github.com/sagemath/sagetrac-mirror/commit/fb965ece366c9d67cfb99354c855f258267d600b)\" to \"[e2688ef47fac633e5f5a299106e807e23f942d28](https://github.com/sagemath/sagetrac-mirror/commit/e2688ef47fac633e5f5a299106e807e23f942d28)\".",
    "created_at": "2022-09-26T00:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539760",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fb965ece366c9d67cfb99354c855f258267d600b](https://github.com/sagemath/sagetrac-mirror/commit/fb965ece366c9d67cfb99354c855f258267d600b)" to "[e2688ef47fac633e5f5a299106e807e23f942d28](https://github.com/sagemath/sagetrac-mirror/commit/e2688ef47fac633e5f5a299106e807e23f942d28)".



---

archive/issue_comments_539761.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a77a819635a355dfee5805b5c87b7a6be219037\">9a77a81</a></td><td><code>sage.env.sage_include_directories: Do not append distutils.sysconfig.get_python_inc()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2688ef47fac633e5f5a299106e807e23f942d28\">e2688ef</a></td><td><code>sage.env.sage_include_directories: Append sysconfig variable INCLUDEPY</code></td></tr></table>\n",
    "created_at": "2022-09-26T00:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33137",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33137#issuecomment-539761",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a77a819635a355dfee5805b5c87b7a6be219037">9a77a81</a></td><td><code>sage.env.sage_include_directories: Do not append distutils.sysconfig.get_python_inc()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2688ef47fac633e5f5a299106e807e23f942d28">e2688ef</a></td><td><code>sage.env.sage_include_directories: Append sysconfig variable INCLUDEPY</code></td></tr></table>

