# Issue 33029: Feature and doctest tag for runtime cython

archive/issues_032792.json:
```json
{
    "assignees": [],
    "body": "While updating the sagemath Debian package I noticed that when running the doctests for the installed sagemath package I get many failing tests such as the one below if library development files are not installed (in the example libm4ri-dev is not installed). The sagemath packages should not depend on lib*-dev packages, but sagemath is looking for pkgconfig files which are in these packages. Could this check for pkgconfig files in the test suite be avoided?\n\n\n```\nsage -t --long --random-seed=0 sage/src/sage/arith/long.pxd\n**********************************************************************\nFile \"sage/src/sage/arith/long.pxd\", line 116, in sage.arith.long.integer_check_long\nFailed example:\n    cython('''\n    from sage.arith.long cimport *\n    from sage.rings.integer cimport smallInteger\n    def check_long(x):\n        cdef long value\n        cdef int err\n        cdef bint c = integer_check_long(x, &value, &err)\n        if c:\n            if err == 0:\n                return value\n            elif err == ERR_OVERFLOW:\n                raise OverflowError(\"integer_check_long: overflow\")\n        elif err == ERR_TYPE:\n            raise TypeError(\"integer_check_long: wrong type\")\n        elif err == ERR_INDEX:\n            raise TypeError(\"integer_check_long: bad __index__\")\n        assert False\n    from libc.limits cimport LONG_MIN, LONG_MAX\n    def long_min():\n        return smallInteger(LONG_MIN)\n    def long_max():\n        return smallInteger(LONG_MAX)\n    ''')\nException raised:\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 996, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:5970)\n        return self.cache[k]\n    KeyError: ((), ())\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"/usr/lib/python3/dist-packages/sage/doctest/forker.py\", line 718, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3/dist-packages/sage/doctest/forker.py\", line 1137, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.arith.long.integer_check_long[0]>\", line 1, in <module>\n        cython('''\n      File \"sage/misc/lazy_import.pyx\", line 362, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:4049)\n        return self.get_object()(*args, **kwds)\n      File \"/usr/lib/python3/dist-packages/sage/misc/cython.py\", line 661, in cython_compile\n        return cython_import_all(tmpfile, get_globals(), **kwds)\n      File \"/usr/lib/python3/dist-packages/sage/misc/cython.py\", line 551, in cython_import_all\n        m = cython_import(filename, **kwds)\n      File \"/usr/lib/python3/dist-packages/sage/misc/cython.py\", line 526, in cython_import\n        name, build_dir = cython(filename, **kwds)\n      File \"/usr/lib/python3/dist-packages/sage/misc/cython.py\", line 284, in cython\n        standard_libs, standard_libdirs, standard_includes, aliases = _standard_libs_libdirs_incdirs_aliases()\n      File \"sage/misc/cachefunc.pyx\", line 1001, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:6098)\n        w = self.f(*args, **kwds)\n      File \"/usr/lib/python3/dist-packages/sage/misc/cython.py\", line 50, in _standard_libs_libdirs_incdirs_aliases\n        aliases = cython_aliases()\n      File \"/usr/lib/python3/dist-packages/sage/env.py\", line 475, in cython_aliases\n        aliases[var + \"CFLAGS\"] = pkgconfig.cflags(lib).split()\n      File \"/usr/lib/python3/dist-packages/pkgconfig/pkgconfig.py\", line 144, in cflags\n        _raise_if_not_exists(package)\n      File \"/usr/lib/python3/dist-packages/pkgconfig/pkgconfig.py\", line 103, in _raise_if_not_exists\n        raise PackageNotFoundError(package)\n    pkgconfig.pkgconfig.PackageNotFoundError: m4ri not found\n```\n\n\nDepends on #33823\n\nCC:  @kiwifb @antonio-rojas @seblabbe\n\nBranch/Commit: **[1440273](https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3)**\n\nReviewer: **S\u00e9bastien Labb\u00e9**\n\nAuthor: **Matthias Koeppe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33029_\n\n",
    "closed_at": "2022-07-03T22:06:06Z",
    "created_at": "2021-12-15T22:10:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20doctest%20framework",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Feature and doctest tag for runtime cython",
    "type": "issue",
    "updated_at": "2022-07-03T22:06:06Z",
    "url": "https://github.com/sagemath/sage/issues/33029",
    "user": "https://github.com/tobihan"
}
```
While updating the sagemath Debian package I noticed that when running the doctests for the installed sagemath package I get many failing tests such as the one below if library development files are not installed (in the example libm4ri-dev is not installed). The sagemath packages should not depend on lib*-dev packages, but sagemath is looking for pkgconfig files which are in these packages. Could this check for pkgconfig files in the test suite be avoided?


```
sage -t --long --random-seed=0 sage/src/sage/arith/long.pxd
**********************************************************************
File "sage/src/sage/arith/long.pxd", line 116, in sage.arith.long.integer_check_long
Failed example:
    cython('''
    from sage.arith.long cimport *
    from sage.rings.integer cimport smallInteger
    def check_long(x):
        cdef long value
        cdef int err
        cdef bint c = integer_check_long(x, &value, &err)
        if c:
            if err == 0:
                return value
            elif err == ERR_OVERFLOW:
                raise OverflowError("integer_check_long: overflow")
        elif err == ERR_TYPE:
            raise TypeError("integer_check_long: wrong type")
        elif err == ERR_INDEX:
            raise TypeError("integer_check_long: bad __index__")
        assert False
    from libc.limits cimport LONG_MIN, LONG_MAX
    def long_min():
        return smallInteger(LONG_MIN)
    def long_max():
        return smallInteger(LONG_MAX)
    ''')
Exception raised:
    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 996, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:5970)
        return self.cache[k]
    KeyError: ((), ())

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "/usr/lib/python3/dist-packages/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3/dist-packages/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.arith.long.integer_check_long[0]>", line 1, in <module>
        cython('''
      File "sage/misc/lazy_import.pyx", line 362, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:4049)
        return self.get_object()(*args, **kwds)
      File "/usr/lib/python3/dist-packages/sage/misc/cython.py", line 661, in cython_compile
        return cython_import_all(tmpfile, get_globals(), **kwds)
      File "/usr/lib/python3/dist-packages/sage/misc/cython.py", line 551, in cython_import_all
        m = cython_import(filename, **kwds)
      File "/usr/lib/python3/dist-packages/sage/misc/cython.py", line 526, in cython_import
        name, build_dir = cython(filename, **kwds)
      File "/usr/lib/python3/dist-packages/sage/misc/cython.py", line 284, in cython
        standard_libs, standard_libdirs, standard_includes, aliases = _standard_libs_libdirs_incdirs_aliases()
      File "sage/misc/cachefunc.pyx", line 1001, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:6098)
        w = self.f(*args, **kwds)
      File "/usr/lib/python3/dist-packages/sage/misc/cython.py", line 50, in _standard_libs_libdirs_incdirs_aliases
        aliases = cython_aliases()
      File "/usr/lib/python3/dist-packages/sage/env.py", line 475, in cython_aliases
        aliases[var + "CFLAGS"] = pkgconfig.cflags(lib).split()
      File "/usr/lib/python3/dist-packages/pkgconfig/pkgconfig.py", line 144, in cflags
        _raise_if_not_exists(package)
      File "/usr/lib/python3/dist-packages/pkgconfig/pkgconfig.py", line 103, in _raise_if_not_exists
        raise PackageNotFoundError(package)
    pkgconfig.pkgconfig.PackageNotFoundError: m4ri not found
```


Depends on #33823

CC:  @kiwifb @antonio-rojas @seblabbe

Branch/Commit: **[1440273](https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3)**

Reviewer: **Sébastien Labbé**

Author: **Matthias Koeppe**

_Issue created by migration from https://trac.sagemath.org/ticket/33029_





---

archive/issue_events_421881.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2021-12-15T22:10:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421881"
}
```



---

archive/issue_events_421882.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2021-12-15T22:10:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20doctest%20framework",
    "label_color": "000080",
    "label_name": "component: doctest framework",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421882"
}
```



---

archive/issue_events_421883.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2021-12-15T22:10:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421883"
}
```



---

archive/issue_events_421884.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2021-12-15T22:10:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421884"
}
```



---

archive/issue_comments_536404.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nRun-time use of compilers is a feature of some parts of the Sage library - in this case `sage.misc.cython.cython`. These tests necessarily depend on dev headers (and the compilers!).\n\nWe should conditionalize these doctests on a `Feature`.",
    "created_at": "2021-12-15T22:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536404",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'>Comment 1:</a>
Run-time use of compilers is a feature of some parts of the Sage library - in this case `sage.misc.cython.cython`. These tests necessarily depend on dev headers (and the compilers!).

We should conditionalize these doctests on a `Feature`.



---

archive/issue_comments_536405.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThat would help. Or would you say the sagemath Debian packages should depend on the dev packages to provide this feature?",
    "created_at": "2021-12-15T22:30:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536405",
    "user": "https://github.com/tobihan"
}
```

<a id='comment:2'>Comment 2:</a>
That would help. Or would you say the sagemath Debian packages should depend on the dev packages to provide this feature?



---

archive/issue_comments_536406.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nIf currently Sage is monolithic in Debian, then you should probably add these as runtime dependencies -- because the `cython` function is part of the standard Sage library.",
    "created_at": "2021-12-15T22:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536406",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'>Comment 3:</a>
If currently Sage is monolithic in Debian, then you should probably add these as runtime dependencies -- because the `cython` function is part of the standard Sage library.



---

archive/issue_events_421885.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-15T22:50:16Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "title_is": "Feature and doctest tag for runtime cython",
    "title_was": "tests depend on library development files",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421885"
}
```



---

archive/issue_comments_536407.json:
```json
{
    "body": "Dependencies: **#32174**",
    "created_at": "2021-12-15T22:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536407",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#32174**



---

archive/issue_comments_536408.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nOne interesting question is how used is this feature of sage, that you can compile bit of code inside it? This is clearly advanced use but if it is widespread, you definitely need to install matching dev packages.\n\nIt is not unlike R packages. Debian provides quite a lot of them by default, but if you want something not provided, you may have to install dev packages.",
    "created_at": "2021-12-15T22:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536408",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'>Comment 6:</a>
One interesting question is how used is this feature of sage, that you can compile bit of code inside it? This is clearly advanced use but if it is widespread, you definitely need to install matching dev packages.

It is not unlike R packages. Debian provides quite a lot of them by default, but if you want something not provided, you may have to install dev packages.



---

archive/issue_comments_536409.json:
```json
{
    "body": "Changed dependencies from **#32174** to **#32174, #32925**",
    "created_at": "2021-12-15T22:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536409",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32174** to **#32174, #32925**



---

archive/issue_comments_536410.json:
```json
{
    "body": "Branch: **[u/mkoeppe/feature_and_doctest_tag_for_runtime_cython](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/feature_and_doctest_tag_for_runtime_cython)**",
    "created_at": "2021-12-16T05:32:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536410",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/feature_and_doctest_tag_for_runtime_cython](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/feature_and_doctest_tag_for_runtime_cython)**



---

archive/issue_comments_536411.json:
```json
{
    "body": "Commit: **[8ecc8cc](https://github.com/sagemath/sagetrac-mirror/commit/8ecc8cc5520e5b11215a20905cb929524c6c9b1a)**",
    "created_at": "2021-12-16T05:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536411",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[8ecc8cc](https://github.com/sagemath/sagetrac-mirror/commit/8ecc8cc5520e5b11215a20905cb929524c6c9b1a)**



---

archive/issue_comments_536412.json:
```json
{
    "body": "Author: **Matthias Koeppe, ...**",
    "created_at": "2021-12-16T05:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536412",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe, ...**



---

archive/issue_comments_536413.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nHere's a beginning. More doctests that use `cython` can be marked up in the same way\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b2601025078adeaaaee9a61b6b0671cabd62c47\">0b26010</a></td><td><code>src/doc/en/reference/misc/index.rst: Add sage.features.interfaces</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc954a7658f7ceda3bc659786493d21be790e765\">dc954a7</a></td><td><code>src/sage/features/__init__.py: Fix doc markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe0530941f27254a70c046c1df9d69616362b7c3\">fe05309</a></td><td><code>sage.features.pkg_systems: New, move PackageSystem and subclasses here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7cd28e0b36a40681055f4b66c4a6ccb8f0fd0e3\">b7cd28e</a></td><td><code>sage.features.sagemath: Improve docstring markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd5998040a1b9f7de1a9e976adfdc3881875b640\">bd59980</a></td><td><code>sage.features.mip_backends: Improve doc markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d36433322cf78543e1590a2937b149cf1c6459b0\">d364333</a></td><td><code>sage.features: Improve doc markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/547206c8313ac3617c6c435e2c9f4e45c00dde22\">547206c</a></td><td><code>Change \"# optional: FEATURE\" to \"# optional - FEATURE\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d1d603dfe881cca47f6d85bd1d2d9fadc936b9cb\">d1d603d</a></td><td><code>Merge #32925</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/994df69ed8cd108d4c73664b807fb446526d1d59\">994df69</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ecc8cc5520e5b11215a20905cb929524c6c9b1a\">8ecc8cc</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr></table>\n",
    "created_at": "2021-12-16T05:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536413",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'>Comment 9:</a>
Here's a beginning. More doctests that use `cython` can be marked up in the same way

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b2601025078adeaaaee9a61b6b0671cabd62c47">0b26010</a></td><td><code>src/doc/en/reference/misc/index.rst: Add sage.features.interfaces</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc954a7658f7ceda3bc659786493d21be790e765">dc954a7</a></td><td><code>src/sage/features/__init__.py: Fix doc markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe0530941f27254a70c046c1df9d69616362b7c3">fe05309</a></td><td><code>sage.features.pkg_systems: New, move PackageSystem and subclasses here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7cd28e0b36a40681055f4b66c4a6ccb8f0fd0e3">b7cd28e</a></td><td><code>sage.features.sagemath: Improve docstring markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd5998040a1b9f7de1a9e976adfdc3881875b640">bd59980</a></td><td><code>sage.features.mip_backends: Improve doc markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d36433322cf78543e1590a2937b149cf1c6459b0">d364333</a></td><td><code>sage.features: Improve doc markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/547206c8313ac3617c6c435e2c9f4e45c00dde22">547206c</a></td><td><code>Change "# optional: FEATURE" to "# optional - FEATURE"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d1d603dfe881cca47f6d85bd1d2d9fadc936b9cb">d1d603d</a></td><td><code>Merge #32925</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/994df69ed8cd108d4c73664b807fb446526d1d59">994df69</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ecc8cc5520e5b11215a20905cb929524c6c9b1a">8ecc8cc</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr></table>




---

archive/issue_comments_536414.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nHow useful is this given that tests don't run at all if cython is not present?\n\nhttps://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/doctest/sources.py#n27",
    "created_at": "2021-12-16T07:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536414",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:10'>Comment 10:</a>
How useful is this given that tests don't run at all if cython is not present?

https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/doctest/sources.py#n27



---

archive/issue_comments_536415.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nThis use of `is_package_dir` will have to be eliminated when we change packages to namespace packages in 9.6 by removing `__init__.py` files",
    "created_at": "2021-12-16T07:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536415",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'>Comment 11:</a>
This use of `is_package_dir` will have to be eliminated when we change packages to namespace packages in 9.6 by removing `__init__.py` files



---

archive/issue_comments_536416.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nAnother import from `Cython` in `sage.doctest.parsing` is being removed in #32938.",
    "created_at": "2021-12-16T07:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536416",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'>Comment 12:</a>
Another import from `Cython` in `sage.doctest.parsing` is being removed in #32938.



---

archive/issue_comments_536417.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@mkoeppe](#comment%3A11):\n> This use of `is_package_dir` will have to be eliminated when we change packages to namespace packages in 9.6 by removing `__init__.py` files\n\nI've opened #33033 for this",
    "created_at": "2021-12-16T17:16:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536417",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@mkoeppe](#comment%3A11):
> This use of `is_package_dir` will have to be eliminated when we change packages to namespace packages in 9.6 by removing `__init__.py` files

I've opened #33033 for this



---

archive/issue_comments_536418.json:
```json
{
    "body": "Changed dependencies from **#32174, #32925** to **#32174, #32925, #33033**",
    "created_at": "2021-12-16T18:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536418",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32174, #32925** to **#32174, #32925, #33033**



---

archive/issue_comments_536419.json:
```json
{
    "body": "Changed commit from **[8ecc8cc](https://github.com/sagemath/sagetrac-mirror/commit/8ecc8cc5520e5b11215a20905cb929524c6c9b1a)** to **[29962d1](https://github.com/sagemath/sagetrac-mirror/commit/29962d1b3886e3cadf388b70a54cdec18d03a8dd)**",
    "created_at": "2021-12-16T19:58:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536419",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8ecc8cc](https://github.com/sagemath/sagetrac-mirror/commit/8ecc8cc5520e5b11215a20905cb929524c6c9b1a)** to **[29962d1](https://github.com/sagemath/sagetrac-mirror/commit/29962d1b3886e3cadf388b70a54cdec18d03a8dd)**



---

archive/issue_comments_536420.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3f6bcbfbf315cfaf2f1759d1136b2dbe7204487\">c3f6bcb</a></td><td><code>src/sage/misc/namespace_package.py (is_package_or_sage_namespace_package_dir): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab23a145ba3961925f6e4b73eb45ea71f3708020\">ab23a14</a></td><td><code>src/sage/doctest/sources.py: Use is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f05856b4efadc29ae22b4d7ae2ad604413a7afe\">0f05856</a></td><td><code>src/sage/doctest/sources.py: Remove unnecessary conversion to bool</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8aa37c1998193670f894f1d54aac65663761ea4\">d8aa37c</a></td><td><code>src/sage/misc/namespace_package.py: In doctests, use 'directory' instead of the single-letter variable name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29962d1b3886e3cadf388b70a54cdec18d03a8dd\">29962d1</a></td><td><code>Merge #33033</code></td></tr></table>\n",
    "created_at": "2021-12-16T19:58:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536420",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3f6bcbfbf315cfaf2f1759d1136b2dbe7204487">c3f6bcb</a></td><td><code>src/sage/misc/namespace_package.py (is_package_or_sage_namespace_package_dir): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab23a145ba3961925f6e4b73eb45ea71f3708020">ab23a14</a></td><td><code>src/sage/doctest/sources.py: Use is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f05856b4efadc29ae22b4d7ae2ad604413a7afe">0f05856</a></td><td><code>src/sage/doctest/sources.py: Remove unnecessary conversion to bool</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8aa37c1998193670f894f1d54aac65663761ea4">d8aa37c</a></td><td><code>src/sage/misc/namespace_package.py: In doctests, use 'directory' instead of the single-letter variable name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29962d1b3886e3cadf388b70a54cdec18d03a8dd">29962d1</a></td><td><code>Merge #33033</code></td></tr></table>




---

archive/issue_comments_536421.json:
```json
{
    "body": "Changed commit from **[29962d1](https://github.com/sagemath/sagetrac-mirror/commit/29962d1b3886e3cadf388b70a54cdec18d03a8dd)** to **[22d8166](https://github.com/sagemath/sagetrac-mirror/commit/22d816689eeae6a13d8ac4de915ec69e47e20fb8)**",
    "created_at": "2021-12-17T06:16:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536421",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[29962d1](https://github.com/sagemath/sagetrac-mirror/commit/29962d1b3886e3cadf388b70a54cdec18d03a8dd)** to **[22d8166](https://github.com/sagemath/sagetrac-mirror/commit/22d816689eeae6a13d8ac4de915ec69e47e20fb8)**



---

archive/issue_comments_536422.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19e93f0f60f5d5e900d04561a187be82318921bb\">19e93f0</a></td><td><code>is_package_or_sage_namespace_package_dir: Make directories with __init__.pxd package directories</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5808f3d6b4241590adbc95925aa84c50535d9e65\">5808f3d</a></td><td><code>src/sage/misc/package_dir.py: New file for is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22d816689eeae6a13d8ac4de915ec69e47e20fb8\">22d8166</a></td><td><code>Merge #33033</code></td></tr></table>\n",
    "created_at": "2021-12-17T06:16:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536422",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'>Comment 16:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19e93f0f60f5d5e900d04561a187be82318921bb">19e93f0</a></td><td><code>is_package_or_sage_namespace_package_dir: Make directories with __init__.pxd package directories</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5808f3d6b4241590adbc95925aa84c50535d9e65">5808f3d</a></td><td><code>src/sage/misc/package_dir.py: New file for is_package_or_sage_namespace_package_dir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22d816689eeae6a13d8ac4de915ec69e47e20fb8">22d8166</a></td><td><code>Merge #33033</code></td></tr></table>




---

archive/issue_events_421886.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421886"
}
```



---

archive/issue_events_421887.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421887"
}
```



---

archive/issue_events_421888.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421888"
}
```



---

archive/issue_events_421889.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421889"
}
```



---

archive/issue_comments_536423.json:
```json
{
    "body": "Changed commit from **[22d8166](https://github.com/sagemath/sagetrac-mirror/commit/22d816689eeae6a13d8ac4de915ec69e47e20fb8)** to **[9986d50](https://github.com/sagemath/sagetrac-mirror/commit/9986d50f84ba02eb0b345a8c64b5bf8dbc41baa9)**",
    "created_at": "2022-04-28T18:28:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536423",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[22d8166](https://github.com/sagemath/sagetrac-mirror/commit/22d816689eeae6a13d8ac4de915ec69e47e20fb8)** to **[9986d50](https://github.com/sagemath/sagetrac-mirror/commit/9986d50f84ba02eb0b345a8c64b5bf8dbc41baa9)**



---

archive/issue_comments_536424.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9c196c9c479386ad7397216e02646990dbaa1e4\">c9c196c</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9986d50f84ba02eb0b345a8c64b5bf8dbc41baa9\">9986d50</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr></table>\n",
    "created_at": "2022-04-28T18:28:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536424",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9c196c9c479386ad7397216e02646990dbaa1e4">c9c196c</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9986d50f84ba02eb0b345a8c64b5bf8dbc41baa9">9986d50</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr></table>




---

archive/issue_comments_536425.json:
```json
{
    "body": "Changed dependencies from **#32174, #32925, #33033** to none",
    "created_at": "2022-04-28T18:29:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536425",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32174, #32925, #33033** to none



---

archive/issue_comments_536426.json:
```json
{
    "body": "Work Issues: **Mark more doctests # optional - sage.misc.cython**",
    "created_at": "2022-04-28T18:32:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536426",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **Mark more doctests # optional - sage.misc.cython**



---

archive/issue_comments_536427.json:
```json
{
    "body": "Dependencies: **#33823**",
    "created_at": "2022-05-09T03:44:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536427",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#33823**



---

archive/issue_comments_536428.json:
```json
{
    "body": "Changed commit from **[9986d50](https://github.com/sagemath/sagetrac-mirror/commit/9986d50f84ba02eb0b345a8c64b5bf8dbc41baa9)** to **[4764f2e](https://github.com/sagemath/sagetrac-mirror/commit/4764f2e171a82815e33580bd6d8f561e042902d2)**",
    "created_at": "2022-05-09T04:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536428",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9986d50](https://github.com/sagemath/sagetrac-mirror/commit/9986d50f84ba02eb0b345a8c64b5bf8dbc41baa9)** to **[4764f2e](https://github.com/sagemath/sagetrac-mirror/commit/4764f2e171a82815e33580bd6d8f561e042902d2)**



---

archive/issue_comments_536429.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b9dcf76e9917ebf1fb697e3e7845a4f407c22f0\">2b9dcf7</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e439ff1211e138c3f34b43ccf359f5383b1e9293\">e439ff1</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/800032050b15c7b743635b7c08892375f7f5c563\">8000320</a></td><td><code>sage -t: Handle --optional=!FEATURE</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0a52ed409ed07ae060c305f7481ab41479d3403\">d0a52ed</a></td><td><code>src/bin/sage-runtests: Update documentation of --optional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/edb6afbb8949644fbf6b1edf340154e99c010c6d\">edb6afb</a></td><td><code>Merge #33823</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4764f2e171a82815e33580bd6d8f561e042902d2\">4764f2e</a></td><td><code>Mark tests using runtime Cython # optional - sage.misc.cython</code></td></tr></table>\n",
    "created_at": "2022-05-09T04:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536429",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b9dcf76e9917ebf1fb697e3e7845a4f407c22f0">2b9dcf7</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e439ff1211e138c3f34b43ccf359f5383b1e9293">e439ff1</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/800032050b15c7b743635b7c08892375f7f5c563">8000320</a></td><td><code>sage -t: Handle --optional=!FEATURE</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0a52ed409ed07ae060c305f7481ab41479d3403">d0a52ed</a></td><td><code>src/bin/sage-runtests: Update documentation of --optional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/edb6afbb8949644fbf6b1edf340154e99c010c6d">edb6afb</a></td><td><code>Merge #33823</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4764f2e171a82815e33580bd6d8f561e042902d2">4764f2e</a></td><td><code>Mark tests using runtime Cython # optional - sage.misc.cython</code></td></tr></table>




---

archive/issue_events_421890.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-09T04:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421890"
}
```



---

archive/issue_comments_536430.json:
```json
{
    "body": "Changed work issues from **Mark more doctests # optional - sage.misc.cython** to none",
    "created_at": "2022-05-09T04:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536430",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **Mark more doctests # optional - sage.misc.cython** to none



---

archive/issue_comments_536431.json:
```json
{
    "body": "Changed author from **Matthias Koeppe, ...** to **Matthias Koeppe**",
    "created_at": "2022-05-09T04:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536431",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Matthias Koeppe, ...** to **Matthias Koeppe**



---

archive/issue_comments_536432.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nTest with `git grep -l 'sage:.*cython(' | xargs ./sage -tp --long --optional 'sage,!sage.misc.cython' `",
    "created_at": "2022-05-09T04:47:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536432",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'>Comment 25:</a>
Test with `git grep -l 'sage:.*cython(' | xargs ./sage -tp --long --optional 'sage,!sage.misc.cython' `



---

archive/issue_comments_536433.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1ce8d6cb361701b388e3c2c3be7e1c831ee85ff\">b1ce8d6</a></td><td><code>sage -t: Handle --optional=!FEATURE</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a670ae8ac34dff7c29f84744463a1c4aeb6892d4\">a670ae8</a></td><td><code>src/bin/sage-runtests: Update documentation of --optional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba86146e5a5e3308026aac49d87d2716a80c6a93\">ba86146</a></td><td><code>src/bin/sage-runtests --help: Say that ! needs to be quoted</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1154c064b60e39dfbddae0ee9c373691c91eb12\">a1154c0</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9356cb926b5593a6a53bbac2ec97acdfde75ed62\">9356cb9</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3\">1440273</a></td><td><code>Mark tests using runtime Cython # optional - sage.misc.cython</code></td></tr></table>\n",
    "created_at": "2022-06-09T20:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536433",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>Comment 27:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1ce8d6cb361701b388e3c2c3be7e1c831ee85ff">b1ce8d6</a></td><td><code>sage -t: Handle --optional=!FEATURE</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a670ae8ac34dff7c29f84744463a1c4aeb6892d4">a670ae8</a></td><td><code>src/bin/sage-runtests: Update documentation of --optional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba86146e5a5e3308026aac49d87d2716a80c6a93">ba86146</a></td><td><code>src/bin/sage-runtests --help: Say that ! needs to be quoted</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1154c064b60e39dfbddae0ee9c373691c91eb12">a1154c0</a></td><td><code>src/sage/features/cython.py: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9356cb926b5593a6a53bbac2ec97acdfde75ed62">9356cb9</a></td><td><code>src/sage/misc/inherit_comparison.pyx: Mark doctests using cython # optional - sage.misc.cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3">1440273</a></td><td><code>Mark tests using runtime Cython # optional - sage.misc.cython</code></td></tr></table>




---

archive/issue_comments_536434.json:
```json
{
    "body": "Changed commit from **[4764f2e](https://github.com/sagemath/sagetrac-mirror/commit/4764f2e171a82815e33580bd6d8f561e042902d2)** to **[1440273](https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3)**",
    "created_at": "2022-06-09T20:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536434",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4764f2e](https://github.com/sagemath/sagetrac-mirror/commit/4764f2e171a82815e33580bd6d8f561e042902d2)** to **[1440273](https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3)**



---

archive/issue_comments_536435.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nReplying to [@mkoeppe](#comment%3A25):\n> Test with `git grep -l 'sage:.*cython(' | xargs ./sage -tp --long --optional 'sage,!sage.misc.cython' `\n\nThe above command works for me:\n\n```\n...\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 70.5 seconds\n    cpu time: 158.9 seconds\n    cumulative wall time: 240.4 seconds\nFeatures detected for doctesting: sage.groups,sage.rings.padics,sagemath_doc_html,sphinx\n```",
    "created_at": "2022-06-24T08:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536435",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:28'>Comment 28:</a>
Replying to [@mkoeppe](#comment%3A25):
> Test with `git grep -l 'sage:.*cython(' | xargs ./sage -tp --long --optional 'sage,!sage.misc.cython' `

The above command works for me:

```
...
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 70.5 seconds
    cpu time: 158.9 seconds
    cumulative wall time: 240.4 seconds
Features detected for doctesting: sage.groups,sage.rings.padics,sagemath_doc_html,sphinx
```



---

archive/issue_comments_536436.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nThe only reported test failure is:\n\n```\n----------------------------------------------------------------------\nsage -t --long --random-seed=338071419821968503909259763280493589917 src/sage/modular/overconvergent/hecke_series.py  # Timed out\n----------------------------------------------------------------------\n```\nwhich is not related to this ticket.",
    "created_at": "2022-06-24T08:13:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536436",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:29'>Comment 29:</a>
The only reported test failure is:

```
----------------------------------------------------------------------
sage -t --long --random-seed=338071419821968503909259763280493589917 src/sage/modular/overconvergent/hecke_series.py  # Timed out
----------------------------------------------------------------------
```
which is not related to this ticket.



---

archive/issue_comments_536437.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nPatchbot pyflakes suggests 4 corrections:\n\n```\nsrc/sage/env.py:32:1 'sage' imported but unused\nsrc/sage/misc/cython.py:295:9 'setuptools' imported but unused\nsrc/sage/misc/sagedoc.py:791:9 'sage.all' imported but unused\nsrc/sage/misc/sagedoc.py:969:5 local variable 'html_results' is assigned to but never used\n```\nbut I suggest to fix them in another ticket : #34061.",
    "created_at": "2022-06-24T08:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536437",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:30'>Comment 30:</a>
Patchbot pyflakes suggests 4 corrections:

```
src/sage/env.py:32:1 'sage' imported but unused
src/sage/misc/cython.py:295:9 'setuptools' imported but unused
src/sage/misc/sagedoc.py:791:9 'sage.all' imported but unused
src/sage/misc/sagedoc.py:969:5 local variable 'html_results' is assigned to but never used
```
but I suggest to fix them in another ticket : #34061.



---

archive/issue_comments_536438.json:
```json
{
    "body": "Reviewer: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2022-06-24T08:16:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536438",
    "user": "https://github.com/seblabbe"
}
```

Reviewer: **Sébastien Labbé**



---

archive/issue_events_421891.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-06-24T08:16:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421891"
}
```



---

archive/issue_events_421892.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2022-06-24T08:16:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421892"
}
```



---

archive/issue_comments_536439.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/feature_and_doctest_tag_for_runtime_cython](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/feature_and_doctest_tag_for_runtime_cython)** to **[1440273](https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3)**",
    "created_at": "2022-07-03T22:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33029#issuecomment-536439",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/feature_and_doctest_tag_for_runtime_cython](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/feature_and_doctest_tag_for_runtime_cython)** to **[1440273](https://github.com/sagemath/sagetrac-mirror/commit/1440273c80c8fd6da5e97a62bc0be0af6881b4b3)**



---

archive/issue_events_421893.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-03T22:06:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421893"
}
```



---

archive/issue_events_421894.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b5d2fcaeb0c739c277ed367b03e191e41b77ecca",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-07-03T22:06:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33029",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33029#event-421894"
}
```
