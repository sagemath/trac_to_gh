# Issue 33040: Update matplotlib to 3.5

archive/issues_032803.json:
```json
{
    "body": "Previous update: #31580\n\nCC:  @dimpase @kiwifb @antonio-rojas @tornaria\n\nReviewer: Fran\u00e7ois Bissey, Eric Gourgoulhon\n\nAuthor: Matthias Koeppe\n\nBranch: 41de5febd8c2c69a0072f1d0708cf8d7a6f3553a\n\nDependencies: #31580\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33040\n\n",
    "closed_at": "2021-12-28T21:15:38Z",
    "created_at": "2021-12-17T16:56:49Z",
    "labels": [
        "component: packages: standard",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Update matplotlib to 3.5",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33040",
    "user": "https://github.com/mkoeppe"
}
```
Previous update: #31580

CC:  @dimpase @kiwifb @antonio-rojas @tornaria

Reviewer: François Bissey, Eric Gourgoulhon

Author: Matthias Koeppe

Branch: 41de5febd8c2c69a0072f1d0708cf8d7a6f3553a

Dependencies: #31580

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33040





---

archive/issue_comments_658768.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/update_matplotlib_to_3_5\"",
    "created_at": "2021-12-18T03:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658768",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/update_matplotlib_to_3_5"



---

archive/issue_comments_658769.json:
```json
{
    "body": "<a id='comment:2'></a>\nLast 10 new commits:\n|                                                                                                                                          |                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[00b677b](https://github.com/sagemath/sagetrac-mirror/commit/00b677bcc532b75faec7ee8980e25d8ddeb395ae)|`new dep of kiwisolver, cppy`|\n|[48b7ec3](https://github.com/sagemath/sagetrac-mirror/commit/48b7ec3849754abb1a526887a85f6fdd4e6a4d30)|`update matplotlib deps`|\n|[26910e6](https://github.com/sagemath/sagetrac-mirror/commit/26910e65f5357fc2f6505440fccc718a52908872)|`fix SPKG.rst's for cppy and kiwisolver`|\n|[aedaf93](https://github.com/sagemath/sagetrac-mirror/commit/aedaf93a51ee4bd69cf61b7c999940d6990b911c)|`Revert \"add gfortran to _prereq/distros/*\"`|\n|[62792d4](https://github.com/sagemath/sagetrac-mirror/commit/62792d4b191d2116774562147a5d089b88d5c1cd)|`use pypi host for cycler url`|\n|[3201af7](https://github.com/sagemath/sagetrac-mirror/commit/3201af762378b9b1a2aca1651c3097b693e33a0c)|`Merge #31580`|\n|[6d203eb](https://github.com/sagemath/sagetrac-mirror/commit/6d203eb9812b244096f597f6998655110468c6ee)|`build/pkgs/matplotlib: Update to 3.5.1`|\n|[5a68988](https://github.com/sagemath/sagetrac-mirror/commit/5a68988cfb3f32884e9d2d68f484745c34c70ee1)|`build/pkgs/matplotlib/make-setup-config.py: Write mplsetup.cfg, not setup.cfg`|\n|[767092b](https://github.com/sagemath/sagetrac-mirror/commit/767092b9dc04a4744b9e10ab4dabc0684756e038)|`build/pkgs/matplotlib/dependencies: Update dependencies`|\n|[9b5a663](https://github.com/sagemath/sagetrac-mirror/commit/9b5a66335b9cf7b46c27c35b75ed12511660f858)|`build/pkgs/setuptools_scm_git_archive: New, matplotlib dependency`|",
    "created_at": "2021-12-18T03:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658769",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Last 10 new commits:
|                                                                                                                                          |                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[00b677b](https://github.com/sagemath/sagetrac-mirror/commit/00b677bcc532b75faec7ee8980e25d8ddeb395ae)|`new dep of kiwisolver, cppy`|
|[48b7ec3](https://github.com/sagemath/sagetrac-mirror/commit/48b7ec3849754abb1a526887a85f6fdd4e6a4d30)|`update matplotlib deps`|
|[26910e6](https://github.com/sagemath/sagetrac-mirror/commit/26910e65f5357fc2f6505440fccc718a52908872)|`fix SPKG.rst's for cppy and kiwisolver`|
|[aedaf93](https://github.com/sagemath/sagetrac-mirror/commit/aedaf93a51ee4bd69cf61b7c999940d6990b911c)|`Revert "add gfortran to _prereq/distros/*"`|
|[62792d4](https://github.com/sagemath/sagetrac-mirror/commit/62792d4b191d2116774562147a5d089b88d5c1cd)|`use pypi host for cycler url`|
|[3201af7](https://github.com/sagemath/sagetrac-mirror/commit/3201af762378b9b1a2aca1651c3097b693e33a0c)|`Merge #31580`|
|[6d203eb](https://github.com/sagemath/sagetrac-mirror/commit/6d203eb9812b244096f597f6998655110468c6ee)|`build/pkgs/matplotlib: Update to 3.5.1`|
|[5a68988](https://github.com/sagemath/sagetrac-mirror/commit/5a68988cfb3f32884e9d2d68f484745c34c70ee1)|`build/pkgs/matplotlib/make-setup-config.py: Write mplsetup.cfg, not setup.cfg`|
|[767092b](https://github.com/sagemath/sagetrac-mirror/commit/767092b9dc04a4744b9e10ab4dabc0684756e038)|`build/pkgs/matplotlib/dependencies: Update dependencies`|
|[9b5a663](https://github.com/sagemath/sagetrac-mirror/commit/9b5a66335b9cf7b46c27c35b75ed12511660f858)|`build/pkgs/setuptools_scm_git_archive: New, matplotlib dependency`|



---

archive/issue_comments_658770.json:
```json
{
    "body": "Changing commit from \"\" to \"9b5a66335b9cf7b46c27c35b75ed12511660f858\"",
    "created_at": "2021-12-18T03:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658770",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "9b5a66335b9cf7b46c27c35b75ed12511660f858"



---

archive/issue_comments_658771.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-12-18T03:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658771",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_658772.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-12-18T03:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658772",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_658773.json:
```json
{
    "body": "<a id='comment:3'></a>\nAccording to the gentoo ebuild for 3.5.1 there should be another new runtime dependency https://pypi.org/project/fonttools/ although it may work without it for all I know.",
    "created_at": "2021-12-18T03:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658773",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
According to the gentoo ebuild for 3.5.1 there should be another new runtime dependency https://pypi.org/project/fonttools/ although it may work without it for all I know.



---

archive/issue_comments_658774.json:
```json
{
    "body": "Changing commit from \"9b5a66335b9cf7b46c27c35b75ed12511660f858\" to \"d865a54526829b79d5d236a40f83ddc6ce7b2696\"",
    "created_at": "2021-12-18T20:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9b5a66335b9cf7b46c27c35b75ed12511660f858" to "d865a54526829b79d5d236a40f83ddc6ce7b2696"



---

archive/issue_comments_658775.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[d865a54](https://github.com/sagemath/sagetrac-mirror/commit/d865a54526829b79d5d236a40f83ddc6ce7b2696)|`build/pkgs/fonttools: New`|",
    "created_at": "2021-12-18T20:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658775",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[d865a54](https://github.com/sagemath/sagetrac-mirror/commit/d865a54526829b79d5d236a40f83ddc6ce7b2696)|`build/pkgs/fonttools: New`|



---

archive/issue_comments_658776.json:
```json
{
    "body": "<a id='comment:5'></a>\nLooks good to me, and it solves the issue with deprecated distutils and python 3.10.",
    "created_at": "2021-12-19T21:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658776",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:5'></a>
Looks good to me, and it solves the issue with deprecated distutils and python 3.10.



---

archive/issue_comments_658777.json:
```json
{
    "body": "<a id='comment:7'></a>\nMy changes to qhull in #31580 need to be merged here.",
    "created_at": "2021-12-20T01:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658777",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
My changes to qhull in #31580 need to be merged here.



---

archive/issue_comments_658778.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[0018e34](https://github.com/sagemath/sagetrac-mirror/commit/0018e349fe56048a2eb3386671732eb47d33875b)|`Merge branch 'develop' into MPL3_4`|\n|[0e5c130](https://github.com/sagemath/sagetrac-mirror/commit/0e5c130c196c6ad849212e536fee06e808771f36)|`Specify custom variable LIB_INSTALL_DIR for qhull, it controls rpath and install_name settings on OSX`|\n|[475a26a](https://github.com/sagemath/sagetrac-mirror/commit/475a26a44e587e043c5a85cb0677546d475b403a)|`build/pkgs/cppy/install-requires.txt: New`|\n|[41de5fe](https://github.com/sagemath/sagetrac-mirror/commit/41de5febd8c2c69a0072f1d0708cf8d7a6f3553a)|`Merge #31580`|",
    "created_at": "2021-12-20T03:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658778",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[0018e34](https://github.com/sagemath/sagetrac-mirror/commit/0018e349fe56048a2eb3386671732eb47d33875b)|`Merge branch 'develop' into MPL3_4`|
|[0e5c130](https://github.com/sagemath/sagetrac-mirror/commit/0e5c130c196c6ad849212e536fee06e808771f36)|`Specify custom variable LIB_INSTALL_DIR for qhull, it controls rpath and install_name settings on OSX`|
|[475a26a](https://github.com/sagemath/sagetrac-mirror/commit/475a26a44e587e043c5a85cb0677546d475b403a)|`build/pkgs/cppy/install-requires.txt: New`|
|[41de5fe](https://github.com/sagemath/sagetrac-mirror/commit/41de5febd8c2c69a0072f1d0708cf8d7a6f3553a)|`Merge #31580`|



---

archive/issue_comments_658779.json:
```json
{
    "body": "Changing commit from \"d865a54526829b79d5d236a40f83ddc6ce7b2696\" to \"41de5febd8c2c69a0072f1d0708cf8d7a6f3553a\"",
    "created_at": "2021-12-20T03:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d865a54526829b79d5d236a40f83ddc6ce7b2696" to "41de5febd8c2c69a0072f1d0708cf8d7a6f3553a"



---

archive/issue_comments_658780.json:
```json
{
    "body": "<a id='comment:9'></a>\nLGTM",
    "created_at": "2021-12-20T20:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658780",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
LGTM



---

archive/issue_comments_658781.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-20T20:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658781",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_658782.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2021-12-20T20:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658782",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "François Bissey"



---

archive/issue_comments_658783.json:
```json
{
    "body": "<a id='comment:10'></a>\nThanks!",
    "created_at": "2021-12-20T20:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658783",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Thanks!



---

archive/issue_comments_658784.json:
```json
{
    "body": "<a id='comment:11'></a>\nJust to tell that I've tested the update on a few notebooks involving various matplotlib plots, either via Sage graphics or via direct use of matplotlib. Everything is OK. Thanks for the update!",
    "created_at": "2021-12-21T16:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658784",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:11'></a>
Just to tell that I've tested the update on a few notebooks involving various matplotlib plots, either via Sage graphics or via direct use of matplotlib. Everything is OK. Thanks for the update!



---

archive/issue_comments_658785.json:
```json
{
    "body": "<a id='comment:12'></a>\nThanks for testing!",
    "created_at": "2021-12-21T16:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658785",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
Thanks for testing!



---

archive/issue_comments_658786.json:
```json
{
    "body": "Changing reviewer from \"Fran\u00e7ois Bissey\" to \"Fran\u00e7ois Bissey, Eric Gourgoulhon\"",
    "created_at": "2021-12-21T16:28:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658786",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "François Bissey" to "François Bissey, Eric Gourgoulhon"



---

archive/issue_comments_658787.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/update_matplotlib_to_3_5\" to \"41de5febd8c2c69a0072f1d0708cf8d7a6f3553a\"",
    "created_at": "2021-12-28T21:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658787",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/update_matplotlib_to_3_5" to "41de5febd8c2c69a0072f1d0708cf8d7a6f3553a"



---

archive/issue_events_098209.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-28T21:15:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33040#event-98209"
}
```



---

archive/issue_comments_658788.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-28T21:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658788",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_658789.json:
```json
{
    "body": "<a id='comment:15'></a>\nNew warning after this upgrade (or possibly that to\u00a03.4?):\n\n```\nsage: list_plot([0], marker='x')\n/home/marc/co/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/plot/point.py:288: UserWarning: You passed a edgecolor/edgecolors ('none') for an unfilled marker ('x').  Matplotlib is ignoring the edgecolor in favor of the facecolor.  This behavior may change in the future.\n  subplot.scatter(self.xdata, self.ydata, s=s, c=c, alpha=a, zorder=z,\n```",
    "created_at": "2022-01-13T10:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658789",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:15'></a>
New warning after this upgrade (or possibly that to 3.4?):

```
sage: list_plot([0], marker='x')
/home/marc/co/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/plot/point.py:288: UserWarning: You passed a edgecolor/edgecolors ('none') for an unfilled marker ('x').  Matplotlib is ignoring the edgecolor in favor of the facecolor.  This behavior may change in the future.
  subplot.scatter(self.xdata, self.ydata, s=s, c=c, alpha=a, zorder=z,
```



---

archive/issue_comments_658790.json:
```json
{
    "body": "Changing commit from \"41de5febd8c2c69a0072f1d0708cf8d7a6f3553a\" to \"\"",
    "created_at": "2022-01-13T10:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33040#issuecomment-658790",
    "user": "https://github.com/mezzarobba"
}
```

Changing commit from "41de5febd8c2c69a0072f1d0708cf8d7a6f3553a" to ""
