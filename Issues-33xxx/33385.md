# Issue 33385: [Combinatorial] Polyhedron_base.vertex_adjacency_matrix: Accept keyword arguments for matrix constructor

archive/issues_033148.json:
```json
{
    "body": "This will also remove the compile-time dependency of `src/sage/geometry/polyhedron/combinatorial_polyhedron` on `sage.matrix.matrix_integer_dense`.\n\n\nCC:  @kliem\n\nAuthor: Matthias Koeppe, ...\n\nBranch: u/mkoeppe/_combinatorial_polyhedron_base_vertex_adjacency_matrix__accept_keyword_arguments_for_matrix_constructor\n\nStatus: new\n\nCommit: 51c7cc82e605ff8030ad8757bbb40261a7ef236b\n\nIssue created by migration from https://trac.sagemath.org/ticket/33385\n\n",
    "created_at": "2022-02-19T23:07:26Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "[Combinatorial] Polyhedron_base.vertex_adjacency_matrix: Accept keyword arguments for matrix constructor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33385",
    "user": "https://github.com/mkoeppe"
}
```
This will also remove the compile-time dependency of `src/sage/geometry/polyhedron/combinatorial_polyhedron` on `sage.matrix.matrix_integer_dense`.


CC:  @kliem

Author: Matthias Koeppe, ...

Branch: u/mkoeppe/_combinatorial_polyhedron_base_vertex_adjacency_matrix__accept_keyword_arguments_for_matrix_constructor

Status: new

Commit: 51c7cc82e605ff8030ad8757bbb40261a7ef236b

Issue created by migration from https://trac.sagemath.org/ticket/33385





---

archive/issue_comments_665635.json:
```json
{
    "body": "Changing dependencies from \"#33377\" to \"#33377, #32688\"",
    "created_at": "2022-02-19T23:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665635",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#33377" to "#33377, #32688"



---

archive/issue_comments_665636.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n+This will also remove the compile-time dependency of `src/sage/geometry/polyhedron/combinatorial_polyhedron` on `sage.matrix.matrix_integer_dense`.\n \n``````\n",
    "created_at": "2022-02-20T00:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665636",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
+This will also remove the compile-time dependency of `src/sage/geometry/polyhedron/combinatorial_polyhedron` on `sage.matrix.matrix_integer_dense`.
 
``````




---

archive/issue_comments_665637.json:
```json
{
    "body": "<a id='comment:4'></a>\nI don't know if it is a good idea to remove the compile time dependency on `sage.matrix.matrix_integer_dense`. I'm curious about the penalty of doing this. E.g. it would be nice to somewhat keep benchmarks for the following steps:\n\n```\nsage: P = polytopes.permutahedron(7, backend='field')\nsage: %time P.incidence_matrix()\nCPU times: user 78.7 ms, sys: 11.9 ms, total: 90.6 ms\nWall time: 90.5 ms\n5040 x 127 dense matrix over Integer Ring (use the '.str()' method to see the entries)\nsage: %time P.combinatorial_polyhedron()\nCPU times: user 76.4 ms, sys: 8.79 ms, total: 85.2 ms\nWall time: 109 ms\nA 6-dimensional combinatorial polyhedron with 126 facets\nsage: P = polytopes.permutahedron(8, backend='field')\nsage: %time P.incidence_matrix()\nCPU times: user 1.02 s, sys: 156 ms, total: 1.18 s\nWall time: 1.17 s\n40320 x 255 dense matrix over Integer Ring (use the '.str()' method to see the entries)\nsage: %time P.combinatorial_polyhedron()\nCPU times: user 1.32 s, sys: 164 ms, total: 1.49 s\nWall time: 1.48 s\nA 7-dimensional combinatorial polyhedron with 254 facets\n```\n\nThen again, this is done in `src/sage/geometry/polyhedron/combinatorial_polyhedron/conversions.pyx`. And maybe similar timings can be achieved by depending on a more general matrix class.",
    "created_at": "2022-02-20T16:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665637",
    "user": "https://github.com/kliem"
}
```

<a id='comment:4'></a>
I don't know if it is a good idea to remove the compile time dependency on `sage.matrix.matrix_integer_dense`. I'm curious about the penalty of doing this. E.g. it would be nice to somewhat keep benchmarks for the following steps:

```
sage: P = polytopes.permutahedron(7, backend='field')
sage: %time P.incidence_matrix()
CPU times: user 78.7 ms, sys: 11.9 ms, total: 90.6 ms
Wall time: 90.5 ms
5040 x 127 dense matrix over Integer Ring (use the '.str()' method to see the entries)
sage: %time P.combinatorial_polyhedron()
CPU times: user 76.4 ms, sys: 8.79 ms, total: 85.2 ms
Wall time: 109 ms
A 6-dimensional combinatorial polyhedron with 126 facets
sage: P = polytopes.permutahedron(8, backend='field')
sage: %time P.incidence_matrix()
CPU times: user 1.02 s, sys: 156 ms, total: 1.18 s
Wall time: 1.17 s
40320 x 255 dense matrix over Integer Ring (use the '.str()' method to see the entries)
sage: %time P.combinatorial_polyhedron()
CPU times: user 1.32 s, sys: 164 ms, total: 1.49 s
Wall time: 1.48 s
A 7-dimensional combinatorial polyhedron with 254 facets
```

Then again, this is done in `src/sage/geometry/polyhedron/combinatorial_polyhedron/conversions.pyx`. And maybe similar timings can be achieved by depending on a more general matrix class.



---

archive/issue_comments_665638.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for the benchmarks! Of course I agree performance is important.",
    "created_at": "2022-02-20T17:20:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665638",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Thanks for the benchmarks! Of course I agree performance is important.



---

archive/issue_comments_665639.json:
```json
{
    "body": "Changing dependencies from \"#33377, #32688\" to \"#33377, #32688, #33391\"",
    "created_at": "2022-02-21T06:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665639",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "#33377, #32688" to "#33377, #32688, #33391"



---

archive/issue_comments_665640.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/_combinatorial_polyhedron_base_vertex_adjacency_matrix__accept_keyword_arguments_for_matrix_constructor\"",
    "created_at": "2022-02-22T01:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665640",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/_combinatorial_polyhedron_base_vertex_adjacency_matrix__accept_keyword_arguments_for_matrix_constructor"



---

archive/issue_comments_665641.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe, ...\"",
    "created_at": "2022-02-22T01:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665641",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe, ..."



---

archive/issue_comments_665642.json:
```json
{
    "body": "Changing commit from \"\" to \"fbd17f4e062924acfb342e3fdc45c04bf0b0b0d8\"",
    "created_at": "2022-02-22T01:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665642",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "fbd17f4e062924acfb342e3fdc45c04bf0b0b0d8"



---

archive/issue_comments_665643.json:
```json
{
    "body": "<a id='comment:8'></a>\nNot sure what to do about caching when `immutable=False` is given\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|\n|[77c462e](https://github.com/sagemath/sagetrac-mirror/commit/77c462e5f54360e780a4dd20050854bc625e7dcc)|`Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb`|\n|[1ebf822](https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab)|`remove set/get_unsafe_long and mark output of set_unsafe_int as irrelevant`|\n|[c308d8f](https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0)|`leave set_unsafe_si with deprecation note`|\n|[7a4bcc6](https://github.com/sagemath/sagetrac-mirror/commit/7a4bcc62822da367529504a9e4aa77d501baf641)|`Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb`|\n|[e844732](https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c)|`remove set_unsafe_si`|\n|[aebf69d](https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275)|`fix typo`|\n|[f64fd38](https://github.com/sagemath/sagetrac-mirror/commit/f64fd384b2c77504cc26edf8707d0a066b78c80d)|`Merge #32688`|\n|[69ad1e0](https://github.com/sagemath/sagetrac-mirror/commit/69ad1e0a4be9f67f74395c37be958e3e9d629d82)|`cimport from Matrix_dense instead of Matrix_integer_dense in combinatorial_polyhedron`|\n|[1c4b29c](https://github.com/sagemath/sagetrac-mirror/commit/1c4b29cda62515bfb68bf4798dd727c690785695)|`Merge #33391`|\n|[fbd17f4](https://github.com/sagemath/sagetrac-mirror/commit/fbd17f4e062924acfb342e3fdc45c04bf0b0b0d8)|`CombinatorialPolyhedron.vertex_adjacency_matrix: Accept kwds for matrix constructor`|",
    "created_at": "2022-02-22T01:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665643",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Not sure what to do about caching when `immutable=False` is given

---
Last 10 new commits:
|                                                                                                                                          |                                                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|[77c462e](https://github.com/sagemath/sagetrac-mirror/commit/77c462e5f54360e780a4dd20050854bc625e7dcc)|`Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb`|
|[1ebf822](https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab)|`remove set/get_unsafe_long and mark output of set_unsafe_int as irrelevant`|
|[c308d8f](https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0)|`leave set_unsafe_si with deprecation note`|
|[7a4bcc6](https://github.com/sagemath/sagetrac-mirror/commit/7a4bcc62822da367529504a9e4aa77d501baf641)|`Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb`|
|[e844732](https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c)|`remove set_unsafe_si`|
|[aebf69d](https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275)|`fix typo`|
|[f64fd38](https://github.com/sagemath/sagetrac-mirror/commit/f64fd384b2c77504cc26edf8707d0a066b78c80d)|`Merge #32688`|
|[69ad1e0](https://github.com/sagemath/sagetrac-mirror/commit/69ad1e0a4be9f67f74395c37be958e3e9d629d82)|`cimport from Matrix_dense instead of Matrix_integer_dense in combinatorial_polyhedron`|
|[1c4b29c](https://github.com/sagemath/sagetrac-mirror/commit/1c4b29cda62515bfb68bf4798dd727c690785695)|`Merge #33391`|
|[fbd17f4](https://github.com/sagemath/sagetrac-mirror/commit/fbd17f4e062924acfb342e3fdc45c04bf0b0b0d8)|`CombinatorialPolyhedron.vertex_adjacency_matrix: Accept kwds for matrix constructor`|



---

archive/issue_comments_665644.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[2ea081c](https://github.com/sagemath/sagetrac-mirror/commit/2ea081c3aed06255fac1b8a65d7c990d1a0dc508)|`Polyhedron_base.vertex_adjacency_matrix: Accept kwds`|",
    "created_at": "2022-02-22T04:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665644",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[2ea081c](https://github.com/sagemath/sagetrac-mirror/commit/2ea081c3aed06255fac1b8a65d7c990d1a0dc508)|`Polyhedron_base.vertex_adjacency_matrix: Accept kwds`|



---

archive/issue_comments_665645.json:
```json
{
    "body": "Changing commit from \"fbd17f4e062924acfb342e3fdc45c04bf0b0b0d8\" to \"2ea081c3aed06255fac1b8a65d7c990d1a0dc508\"",
    "created_at": "2022-02-22T04:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fbd17f4e062924acfb342e3fdc45c04bf0b0b0d8" to "2ea081c3aed06255fac1b8a65d7c990d1a0dc508"



---

archive/issue_comments_665646.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|\n|[c55b897](https://github.com/sagemath/sagetrac-mirror/commit/c55b89779d2f974c09e03b5b90a1041164e37bf8)|`CombinatorialPolyhedron.vertex_adjacency_matrix: Accept kwds for matrix constructor`|\n|[51c7cc8](https://github.com/sagemath/sagetrac-mirror/commit/51c7cc82e605ff8030ad8757bbb40261a7ef236b)|`Polyhedron_base.vertex_adjacency_matrix: Accept kwds`|",
    "created_at": "2022-03-08T19:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665646",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
|[c55b897](https://github.com/sagemath/sagetrac-mirror/commit/c55b89779d2f974c09e03b5b90a1041164e37bf8)|`CombinatorialPolyhedron.vertex_adjacency_matrix: Accept kwds for matrix constructor`|
|[51c7cc8](https://github.com/sagemath/sagetrac-mirror/commit/51c7cc82e605ff8030ad8757bbb40261a7ef236b)|`Polyhedron_base.vertex_adjacency_matrix: Accept kwds`|



---

archive/issue_comments_665647.json:
```json
{
    "body": "Changing commit from \"2ea081c3aed06255fac1b8a65d7c990d1a0dc508\" to \"51c7cc82e605ff8030ad8757bbb40261a7ef236b\"",
    "created_at": "2022-03-08T19:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665647",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2ea081c3aed06255fac1b8a65d7c990d1a0dc508" to "51c7cc82e605ff8030ad8757bbb40261a7ef236b"



---

archive/issue_comments_665648.json:
```json
{
    "body": "Changing dependencies from \"#33377, #32688, #33391\" to \"\"",
    "created_at": "2022-03-08T19:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33385#issuecomment-665648",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#33377, #32688, #33391" to ""



---

archive/issue_events_099083.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33385#event-99083"
}
```



---

archive/issue_events_099084.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33385#event-99084"
}
```



---

archive/issue_events_099085.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33385",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33385#event-99085"
}
```
