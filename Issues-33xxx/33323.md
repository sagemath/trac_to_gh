# Issue 33323: Cardinality of partitions of negative values

archive/issues_033086.json:
```json
{
    "body": "This should work (as long as it accepts negative values, which there is nothing wrong with it, it is just an empty set), but it results in an overflow error:\n\n```\nsage: Partitions(-5)\nPartitions of the integer -5\nsage: _.cardinality()\n```\n\nCC:  @darijgr @fchapoton @jhpalmieri\n\nBranch/Commit: c340478b4274aef5451b01dfbdf859bc98490ddf\n\nReviewer: John Palmieri\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33323\n\n",
    "closed_at": "2022-02-21T21:56:07Z",
    "created_at": "2022-02-11T06:55:27Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Cardinality of partitions of negative values",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33323",
    "user": "https://github.com/tscrim"
}
```
This should work (as long as it accepts negative values, which there is nothing wrong with it, it is just an empty set), but it results in an overflow error:

```
sage: Partitions(-5)
Partitions of the integer -5
sage: _.cardinality()
```

CC:  @darijgr @fchapoton @jhpalmieri

Branch/Commit: c340478b4274aef5451b01dfbdf859bc98490ddf

Reviewer: John Palmieri

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33323





---

archive/issue_comments_664863.json:
```json
{
    "body": "Changing commit from \"\" to \"c340478b4274aef5451b01dfbdf859bc98490ddf\"",
    "created_at": "2022-02-11T07:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664863",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "c340478b4274aef5451b01dfbdf859bc98490ddf"



---

archive/issue_comments_664864.json:
```json
{
    "body": "<a id='comment:1'></a>\nThat is for the default using `flint`, but `gap` is wrong:\n\n```\nsage: Pm5.cardinality(algorithm='gap')\n1\nsage: Pm5.cardinality(algorithm='pari')\n0\n```\nThis is needed for doctests on #30680.\n\n---\nNew commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[c340478](https://git.sagemath.org/sage.git/commit?id=c340478b4274aef5451b01dfbdf859bc98490ddf)|`Partitions of negative n is always 0.`|",
    "created_at": "2022-02-11T07:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664864",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
That is for the default using `flint`, but `gap` is wrong:

```
sage: Pm5.cardinality(algorithm='gap')
1
sage: Pm5.cardinality(algorithm='pari')
0
```
This is needed for doctests on #30680.

---
New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[c340478](https://git.sagemath.org/sage.git/commit?id=c340478b4274aef5451b01dfbdf859bc98490ddf)|`Partitions of negative n is always 0.`|



---

archive/issue_comments_664865.json:
```json
{
    "body": "Changing branch from \"\" to \"public/combinat/negative_partition_card-33323\"",
    "created_at": "2022-02-11T07:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664865",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/combinat/negative_partition_card-33323"



---

archive/issue_comments_664866.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-02-11T07:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664866",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_664867.json:
```json
{
    "body": "<a id='comment:2'></a>\nI would rather think that most combinatorial objects return a `ValueError`:\nsee `DyckWords(-2)`, `BinaryTrees(-2)`, `Posets(-2)`,  `Tableaux(-2)` and `TamariIntervalPosets(-2)`.\n\n`AlternatingSignMatrices(-2)` returns an `ArithmeticError`.\n\nBut `Compositions(-2)`, `SuperPartitions(-2)` and `Permutations(-2)`\"work\".\n\nIf you prefer, returning the empty set would be another solution. Do we have such an object ?",
    "created_at": "2022-02-11T07:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664867",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
I would rather think that most combinatorial objects return a `ValueError`:
see `DyckWords(-2)`, `BinaryTrees(-2)`, `Posets(-2)`,  `Tableaux(-2)` and `TamariIntervalPosets(-2)`.

`AlternatingSignMatrices(-2)` returns an `ArithmeticError`.

But `Compositions(-2)`, `SuperPartitions(-2)` and `Permutations(-2)`"work".

If you prefer, returning the empty set would be another solution. Do we have such an object ?



---

archive/issue_comments_664868.json:
```json
{
    "body": "<a id='comment:3'></a>\nPerhaps it would be better for these to raise a `ValueError` to be consistent with other objects. However, we would also need to make sure that this continues to work:\n\n```\nsage: s = SymmetricFunctions(QQ).s()\nsage: list(s.basis(-2))\n[]\n```\n\nWe do not seem to have a singular `EmptySet` object, just `EmptySetError`.",
    "created_at": "2022-02-11T07:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664868",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
Perhaps it would be better for these to raise a `ValueError` to be consistent with other objects. However, we would also need to make sure that this continues to work:

```
sage: s = SymmetricFunctions(QQ).s()
sage: list(s.basis(-2))
[]
```

We do not seem to have a singular `EmptySet` object, just `EmptySetError`.



---

archive/issue_comments_664869.json:
```json
{
    "body": "<a id='comment:4'></a>\nIn order to keep that continuing to work, I think we would need a more long-term fix, which would include specifying the valid indices for the grading monoid of any graded module.",
    "created_at": "2022-02-11T08:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664869",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
In order to keep that continuing to work, I think we would need a more long-term fix, which would include specifying the valid indices for the grading monoid of any graded module.



---

archive/issue_comments_664870.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis looks simple and these things work:\n\n```\nsage: P = Partitions(-3)\nsage: P.cardinality()\n0\nsage: list(P)\n[]\nsage: for a in P: print(a)\nsage:\n```\nI'm somewhat agnostic about whether `Partitions(-3)` should raise an error or return an empty set. It feels somewhat different in flavor than `Posets(-3)` because it doesn't make sense to ask for a poset with `-3` elements, while you could ask for all partitions of the number `-3` \u2014\u00a0there just aren't any. But I don't have strong feelings either way.",
    "created_at": "2022-02-11T20:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664870",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
This looks simple and these things work:

```
sage: P = Partitions(-3)
sage: P.cardinality()
0
sage: list(P)
[]
sage: for a in P: print(a)
sage:
```
I'm somewhat agnostic about whether `Partitions(-3)` should raise an error or return an empty set. It feels somewhat different in flavor than `Posets(-3)` because it doesn't make sense to ask for a poset with `-3` elements, while you could ask for all partitions of the number `-3` — there just aren't any. But I don't have strong feelings either way.



---

archive/issue_comments_664871.json:
```json
{
    "body": "<a id='comment:6'></a>\nFor the sake of (e.g.) the Euler pentagonal number theorem, it makes the most sense to return the empty set. Otherwise, the sum needs to be broken up at some nasty bounds.",
    "created_at": "2022-02-11T20:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664871",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:6'></a>
For the sake of (e.g.) the Euler pentagonal number theorem, it makes the most sense to return the empty set. Otherwise, the sum needs to be broken up at some nasty bounds.



---

archive/issue_comments_664872.json:
```json
{
    "body": "<a id='comment:7'></a>\nThis can also be a stopgap ticket until a more permanent solution is found.",
    "created_at": "2022-02-13T01:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664872",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
This can also be a stopgap ticket until a more permanent solution is found.



---

archive/issue_comments_664873.json:
```json
{
    "body": "<a id='comment:8'></a>\nAn interesting comparison point:\n\n```\nsage: Pm = Permutations(-3)\nsage: [x for x in Pm]    \n[[]]\nsage: Pm.cardinality()\nValueError: factorial -- must be nonnegative\n```\nSo there are bugs there that can be handled on another ticket.",
    "created_at": "2022-02-13T01:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664873",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
An interesting comparison point:

```
sage: Pm = Permutations(-3)
sage: [x for x in Pm]    
[[]]
sage: Pm.cardinality()
ValueError: factorial -- must be nonnegative
```
So there are bugs there that can be handled on another ticket.



---

archive/issue_comments_664874.json:
```json
{
    "body": "<a id='comment:9'></a>\nIn my opinion we should merge this ticket and then think about long-term solutions elsewhere.",
    "created_at": "2022-02-17T17:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664874",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
In my opinion we should merge this ticket and then think about long-term solutions elsewhere.



---

archive/issue_comments_664875.json:
```json
{
    "body": "<a id='comment:10'></a>\n`@`chapoton, any objections to John doing the review for this as a stopgap ticket?",
    "created_at": "2022-02-18T00:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664875",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
`@`chapoton, any objections to John doing the review for this as a stopgap ticket?



---

archive/issue_comments_664876.json:
```json
{
    "body": "<a id='comment:11'></a>\nno objection whatsoever ; I have no monopoly on reviews",
    "created_at": "2022-02-18T08:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664876",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
no objection whatsoever ; I have no monopoly on reviews



---

archive/issue_comments_664877.json:
```json
{
    "body": "<a id='comment:12'></a>\nWe value your opinion. Plus, all objections should be resolved before a positive review too.",
    "created_at": "2022-02-18T10:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664877",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
We value your opinion. Plus, all objections should be resolved before a positive review too.



---

archive/issue_comments_664878.json:
```json
{
    "body": "<a id='comment:13'></a>\nLet's merge this as is, and on other tickets continue to think about how to handle these situations.",
    "created_at": "2022-02-18T19:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664878",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>
Let's merge this as is, and on other tickets continue to think about how to handle these situations.



---

archive/issue_comments_664879.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Palmieri\"",
    "created_at": "2022-02-18T19:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664879",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "" to "John Palmieri"



---

archive/issue_comments_664880.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-18T19:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664880",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_087940.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-21T21:56:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33323#event-87940"
}
```



---

archive/issue_comments_664881.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-21T21:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664881",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_664882.json:
```json
{
    "body": "Changing branch from \"public/combinat/negative_partition_card-33323\" to \"c340478b4274aef5451b01dfbdf859bc98490ddf\"",
    "created_at": "2022-02-21T21:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33323",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33323#issuecomment-664882",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/combinat/negative_partition_card-33323" to "c340478b4274aef5451b01dfbdf859bc98490ddf"
