# Issue 33784: provide a framework for finite group actions

archive/issues_033547.json:
```json
{
    "assignees": [],
    "body": "This ticket provides an easy user interface to define a permutation group corresponding to a finite group action.\n\n```\nsage: a = lambda x: (2*x) % 7\nsage: H = PermutationGroup(action=a, domain=range(7))\nsage: H.orbits()\n[[0], [1, 2, 4], [3, 6, 5]]\nsage: H.gens()\n[(1,2,4), (3,6,5)]\n\nsage: a = lambda g, x: vector(g*x, immutable=True)\nsage: X = [vector(x, immutable=True) for x in GF(3)^2]\nsage: G = SL(2,3); G.gens()\n(\n[1 1]  [0 1]\n[0 1], [2 0]\n)\nsage: H = PermutationGroup(G.gens(), action=a, domain=X)\nsage: H.orbits()\n[[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]\nsage: H.gens()\n[((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),\n ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]\n```\n\n\nDepends on #33824\n\n**CC:**  @tscrim @kcrisman\n\n**Branch/Commit:** [fdea936a8c038820368a79e4c153745c0b442f8d](https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d)\n\n**Reviewer:** David Joyner, Travis Scrimshaw\n\n**Author:** Martin Rubey\n\nIssue created by migration from https://trac.sagemath.org/ticket/33784\n\n",
    "closed_at": "2022-05-24T22:45:04Z",
    "created_at": "2022-05-02T11:30:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "provide a framework for finite group actions",
    "type": "issue",
    "updated_at": "2022-05-24T22:45:04Z",
    "url": "https://github.com/sagemath/sage/issues/33784",
    "user": "https://github.com/mantepse"
}
```
This ticket provides an easy user interface to define a permutation group corresponding to a finite group action.

```
sage: a = lambda x: (2*x) % 7
sage: H = PermutationGroup(action=a, domain=range(7))
sage: H.orbits()
[[0], [1, 2, 4], [3, 6, 5]]
sage: H.gens()
[(1,2,4), (3,6,5)]

sage: a = lambda g, x: vector(g*x, immutable=True)
sage: X = [vector(x, immutable=True) for x in GF(3)^2]
sage: G = SL(2,3); G.gens()
(
[1 1]  [0 1]
[0 1], [2 0]
)
sage: H = PermutationGroup(G.gens(), action=a, domain=X)
sage: H.orbits()
[[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]
sage: H.gens()
[((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),
 ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]
```


Depends on #33824

**CC:**  @tscrim @kcrisman

**Branch/Commit:** [fdea936a8c038820368a79e4c153745c0b442f8d](https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d)

**Reviewer:** David Joyner, Travis Scrimshaw

**Author:** Martin Rubey

Issue created by migration from https://trac.sagemath.org/ticket/33784





---

archive/issue_events_408487.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-05-02T11:30:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408487"
}
```



---

archive/issue_comments_548666.json:
```json
{
    "body": "**Branch:** [u/mantepse/provide_a_framework_for_finite_group_actions](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/provide_a_framework_for_finite_group_actions)",
    "created_at": "2022-05-02T11:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548666",
    "user": "https://github.com/mantepse"
}
```

**Branch:** [u/mantepse/provide_a_framework_for_finite_group_actions](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/provide_a_framework_for_finite_group_actions)



---

archive/issue_comments_548667.json:
```json
{
    "body": "**Commit:** [b77e8ce027aa7f2f630d17ed6be875ade125931f](https://github.com/sagemath/sagetrac-mirror/commit/b77e8ce027aa7f2f630d17ed6be875ade125931f)",
    "created_at": "2022-05-02T11:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548667",
    "user": "https://github.com/mantepse"
}
```

**Commit:** [b77e8ce027aa7f2f630d17ed6be875ade125931f](https://github.com/sagemath/sagetrac-mirror/commit/b77e8ce027aa7f2f630d17ed6be875ade125931f)



---

archive/issue_events_408488.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-05-02T11:35:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408488"
}
```



---

archive/issue_comments_548668.json:
```json
{
    "body": "**Author:** Martin Rubey",
    "created_at": "2022-05-02T11:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548668",
    "user": "https://github.com/mantepse"
}
```

**Author:** Martin Rubey



---

archive/issue_events_408489.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-05-02T11:35:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
    "label_color": "08517b",
    "label_name": "component: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408489"
}
```



---

archive/issue_comments_548669.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nSage should have an easy to use and efficient framework to play with finite group actions.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b77e8ce027aa7f2f630d17ed6be875ade125931f\">b77e8ce</a></td><td><code>initial idea</code></td></tr></table>\n",
    "created_at": "2022-05-02T11:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548669",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'>**Comment 2:**</a>
Sage should have an easy to use and efficient framework to play with finite group actions.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b77e8ce027aa7f2f630d17ed6be875ade125931f">b77e8ce</a></td><td><code>initial idea</code></td></tr></table>




---

archive/issue_comments_548670.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c\">15d1c15</a></td><td><code>design action as subclass of PermutationGroup_generic</code></td></tr></table>\n",
    "created_at": "2022-05-03T13:14:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548670",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>**Comment 4:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c">15d1c15</a></td><td><code>design action as subclass of PermutationGroup_generic</code></td></tr></table>




---

archive/issue_comments_548671.json:
```json
{
    "body": "**Changing commit** from \"[b77e8ce027aa7f2f630d17ed6be875ade125931f](https://github.com/sagemath/sagetrac-mirror/commit/b77e8ce027aa7f2f630d17ed6be875ade125931f)\" to \"[15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c](https://github.com/sagemath/sagetrac-mirror/commit/15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c)\".",
    "created_at": "2022-05-03T13:14:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548671",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b77e8ce027aa7f2f630d17ed6be875ade125931f](https://github.com/sagemath/sagetrac-mirror/commit/b77e8ce027aa7f2f630d17ed6be875ade125931f)" to "[15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c](https://github.com/sagemath/sagetrac-mirror/commit/15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c)".



---

archive/issue_events_408490.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408490"
}
```



---

archive/issue_events_408491.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408491"
}
```



---

archive/issue_comments_548672.json:
```json
{
    "body": "**Changing commit** from \"[15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c](https://github.com/sagemath/sagetrac-mirror/commit/15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c)\" to \"[067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9](https://github.com/sagemath/sagetrac-mirror/commit/067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9)\".",
    "created_at": "2022-05-03T18:46:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548672",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c](https://github.com/sagemath/sagetrac-mirror/commit/15d1c15d1fc1d8a810633aedd1b9c2c24aeb800c)" to "[067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9](https://github.com/sagemath/sagetrac-mirror/commit/067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9)".



---

archive/issue_comments_548673.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9\">067bc8b</a></td><td><code>remove initial idea</code></td></tr></table>\n",
    "created_at": "2022-05-03T18:46:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548673",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>**Comment 6:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9">067bc8b</a></td><td><code>remove initial idea</code></td></tr></table>




---

archive/issue_comments_548674.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00f5169348afeb4e82a7b838ac0c414389fa4d02\">00f5169</a></td><td><code>add doctests</code></td></tr></table>\n",
    "created_at": "2022-05-03T19:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548674",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>**Comment 7:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00f5169348afeb4e82a7b838ac0c414389fa4d02">00f5169</a></td><td><code>add doctests</code></td></tr></table>




---

archive/issue_comments_548675.json:
```json
{
    "body": "**Changing commit** from \"[067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9](https://github.com/sagemath/sagetrac-mirror/commit/067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9)\" to \"[00f5169348afeb4e82a7b838ac0c414389fa4d02](https://github.com/sagemath/sagetrac-mirror/commit/00f5169348afeb4e82a7b838ac0c414389fa4d02)\".",
    "created_at": "2022-05-03T19:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548675",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9](https://github.com/sagemath/sagetrac-mirror/commit/067bc8bdefcd77c24d5ee53260f3aa9bdabc64f9)" to "[00f5169348afeb4e82a7b838ac0c414389fa4d02](https://github.com/sagemath/sagetrac-mirror/commit/00f5169348afeb4e82a7b838ac0c414389fa4d02)".



---

archive/issue_comments_548676.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,23 @@\n+This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.\n \n+```\n+       sage: a = lambda x: (2*x) % 6                                                                                                                                                        \n+        sage: X = [0,1,2,3,4,5]                                                                                                                                                              \n+        sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       \n+        sage: G.orbits()                                                                                                                                                                     \n+        [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           \n+                                                                                                                                                                                             \n+        sage: a = lambda g, x: vector(g*x, immutable=True)                                                                                                                                   \n+        sage: X = [vector(x, immutable=True) for x in GF(3)^2]                                                                                                                               \n+        sage: G = SL(2,3); G.gens()                                                                                                                                                          \n+        (                                                                                                                                                                                    \n+        [1 1]  [0 1]                                                                                                                                                                         \n+        [0 1], [2 0]                                                                                                                                                                         \n+        )                                                                                                                                                                                    \n+        sage: H = PermutationGroup(G.gens(), action=a, domain=X)                                                                                                                             \n+        sage: H.orbits()                                                                                                                                                                     \n+        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]                                                                                                         \n+        sage: H.gens()                                                                                                                                                                       \n+        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),                                                                                                                                             \n+         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]    \n+```\n``````\n",
    "created_at": "2022-05-03T19:15:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548676",
    "user": "https://github.com/mantepse"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,23 @@
+This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.
 
+```
+       sage: a = lambda x: (2*x) % 6                                                                                                                                                        
+        sage: X = [0,1,2,3,4,5]                                                                                                                                                              
+        sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       
+        sage: G.orbits()                                                                                                                                                                     
+        [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           
+                                                                                                                                                                                             
+        sage: a = lambda g, x: vector(g*x, immutable=True)                                                                                                                                   
+        sage: X = [vector(x, immutable=True) for x in GF(3)^2]                                                                                                                               
+        sage: G = SL(2,3); G.gens()                                                                                                                                                          
+        (                                                                                                                                                                                    
+        [1 1]  [0 1]                                                                                                                                                                         
+        [0 1], [2 0]                                                                                                                                                                         
+        )                                                                                                                                                                                    
+        sage: H = PermutationGroup(G.gens(), action=a, domain=X)                                                                                                                             
+        sage: H.orbits()                                                                                                                                                                     
+        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]                                                                                                         
+        sage: H.gens()                                                                                                                                                                       
+        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),                                                                                                                                             
+         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]    
+```
``````




---

archive/issue_comments_548677.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nThis ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.\n\n```\n        sage: a = lambda x: (2*x) % 6                                                                                                                                                        \n        sage: X = [0,1,2,3,4,5]                                                                                                                                                              \n        sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       \n        sage: G.orbits()                                                                                                                                                                     \n        [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           \n                                                                                                                                                                                             \n        sage: a = lambda g, x: vector(g*x, immutable=True)                                                                                                                                   \n        sage: X = [vector(x, immutable=True) for x in GF(3)^2]                                                                                                                               \n        sage: G = SL(2,3); G.gens()                                                                                                                                                          \n        (                                                                                                                                                                                    \n        [1 1]  [0 1]                                                                                                                                                                         \n        [0 1], [2 0]                                                                                                                                                                         \n        )                                                                                                                                                                                    \n        sage: H = PermutationGroup(G.gens(), action=a, domain=X)                                                                                                                             \n        sage: H.orbits()                                                                                                                                                                     \n        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]                                                                                                         \n        sage: H.gens()                                                                                                                                                                       \n        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),                                                                                                                                             \n         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]    \n```",
    "created_at": "2022-05-03T19:15:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548677",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'>**Comment 8:**</a>
This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.

```
        sage: a = lambda x: (2*x) % 6                                                                                                                                                        
        sage: X = [0,1,2,3,4,5]                                                                                                                                                              
        sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       
        sage: G.orbits()                                                                                                                                                                     
        [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           
                                                                                                                                                                                             
        sage: a = lambda g, x: vector(g*x, immutable=True)                                                                                                                                   
        sage: X = [vector(x, immutable=True) for x in GF(3)^2]                                                                                                                               
        sage: G = SL(2,3); G.gens()                                                                                                                                                          
        (                                                                                                                                                                                    
        [1 1]  [0 1]                                                                                                                                                                         
        [0 1], [2 0]                                                                                                                                                                         
        )                                                                                                                                                                                    
        sage: H = PermutationGroup(G.gens(), action=a, domain=X)                                                                                                                             
        sage: H.orbits()                                                                                                                                                                     
        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]                                                                                                         
        sage: H.gens()                                                                                                                                                                       
        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),                                                                                                                                             
         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]    
```



---

archive/issue_events_408492.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-05-03T19:16:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408492"
}
```



---

archive/issue_comments_548678.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nThis is nice.  Some questions.\n\n> This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.\n> \n> ```\n>         sage: a = lambda x: (2*x) % 6                                                                                                                                                        \n>         sage: X = [0,1,2,3,4,5]                                                                                                                                                              \n>         sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       \n>         sage: G.orbits()                                                                                                                                                                     \n>         [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           \n>                      \n> ``` \n\nIs there any checking that this is meaningful, or is it garbage in, garbage out?  Such as if one changed the lambda function here to be modulo 5, or 100.  (I know that 100 is garbage, I think 5 would be as well.)\n\nAlso, should it print out differently?  You do `PermutationGroup_generic.__init__` and presumably this defines its string representation.  \n\nCan we do group operations (I mean like semi/direct product etc.) on it with others?  Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.",
    "created_at": "2022-05-03T20:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548678",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'>**Comment 10:**</a>
This is nice.  Some questions.

> This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.
> 
> ```
>         sage: a = lambda x: (2*x) % 6                                                                                                                                                        
>         sage: X = [0,1,2,3,4,5]                                                                                                                                                              
>         sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       
>         sage: G.orbits()                                                                                                                                                                     
>         [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           
>                      
> ``` 

Is there any checking that this is meaningful, or is it garbage in, garbage out?  Such as if one changed the lambda function here to be modulo 5, or 100.  (I know that 100 is garbage, I think 5 would be as well.)

Also, should it print out differently?  You do `PermutationGroup_generic.__init__` and presumably this defines its string representation.  

Can we do group operations (I mean like semi/direct product etc.) on it with others?  Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.



---

archive/issue_comments_548679.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nReplying to [@kcrisman](#comment%3A10):\n> This is nice.\n\nThank you :-)\n\n> > ```\n> >         sage: a = lambda x: (2*x) % 6                                                                                                                                                        \n> >         sage: X = [0,1,2,3,4,5]                                                                                                                                                              \n> >         sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       \n> >         sage: G.orbits()                                                                                                                                                                     \n> >         [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           \n> >                      \n> > ``` \n\n> \n> Is there any checking that this is meaningful, or is it garbage in, garbage out?  Such as if one changed the lambda function here to be modulo 5, or 100.  (I know that 100 is garbage, I think 5 would be as well.)\n\nCurrently it is garbage in, garbage out.  Do you have any checks in mind one could do?\n\nMaybe it would even be possible to allow domain being specified only partially.  That is, it should suffice to include one element per orbit, to generate the full domain.\n\n> Also, should it print out differently?  You do `PermutationGroup_generic.__init__` and presumably this defines its string representation.\n\nSince `PermutationGroup(action=a, domain=X)` is just yet another way to define a `PermutationGroup`, it should be a `PermutationGroup` and print as such.  Note that only the image of \ud835\udc3a \u2192 \ud835\udd16_\ud835\udc4b is remembered.  (Can't trac do LaTeX?)\n\n> Can we do group operations (I mean like semi/direct product etc.) on it with others?  Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.\n\nDoes my reply above answer this question?",
    "created_at": "2022-05-04T06:05:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548679",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:11'>**Comment 11:**</a>
Replying to [@kcrisman](#comment%3A10):
> This is nice.

Thank you :-)

> > ```
> >         sage: a = lambda x: (2*x) % 6                                                                                                                                                        
> >         sage: X = [0,1,2,3,4,5]                                                                                                                                                              
> >         sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       
> >         sage: G.orbits()                                                                                                                                                                     
> >         [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           
> >                      
> > ``` 

> 
> Is there any checking that this is meaningful, or is it garbage in, garbage out?  Such as if one changed the lambda function here to be modulo 5, or 100.  (I know that 100 is garbage, I think 5 would be as well.)

Currently it is garbage in, garbage out.  Do you have any checks in mind one could do?

Maybe it would even be possible to allow domain being specified only partially.  That is, it should suffice to include one element per orbit, to generate the full domain.

> Also, should it print out differently?  You do `PermutationGroup_generic.__init__` and presumably this defines its string representation.

Since `PermutationGroup(action=a, domain=X)` is just yet another way to define a `PermutationGroup`, it should be a `PermutationGroup` and print as such.  Note that only the image of 𝐺 → 𝔖_𝑋 is remembered.  (Can't trac do LaTeX?)

> Can we do group operations (I mean like semi/direct product etc.) on it with others?  Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.

Does my reply above answer this question?



---

archive/issue_comments_548680.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nReplying to [@mantepse](#comment%3A11):\n> Replying to [@kcrisman](#comment%3A10):\n> > > \n> > > ```\n> > >         sage: a = lambda x: (2*x) % 6                                                                                                                                                        \n> > >         sage: X = [0,1,2,3,4,5]                                                                                                                                                              \n> > >         sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       \n> > >         sage: G.orbits()                                                                                                                                                                     \n> > >         [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           \n> > >                      \n> > > ``` \n\n> > \n> > Is there any checking that this is meaningful, or is it garbage in, garbage out?  Such as if one changed the lambda function here to be modulo 5, or 100.  (I know that 100 is garbage, I think 5 would be as well.)\n\n> \n> Currently it is garbage in, garbage out.  Do you have any checks in mind one could do?\n\nActually, the map `a = lambda x: (2*x) % 6` is garbage - it is not invertible and therefore certainly not the generator of a cyclic group.  It should be `a = lambda x: (2*x) % 5`.\n\nCurrently, `sage.combinat.cyclic_sieving_phenomenon.orbit_decomposition` is defined as follows:\n\n```\ndef orbit_decomposition(L, cyc_act) -> list[list]:\n    orbits = []\n    L_prime = set(L)\n    while L_prime:\n        obj = L_prime.pop()\n        orbit = [obj]\n        obj = cyc_act(obj)\n        while obj in L_prime:\n            orbit.append(obj)\n            L_prime.remove(obj)\n            obj = cyc_act(obj)\n        orbits.append(orbit)\n    return orbits\n```\nI think it would be better to make it\n\n```\ndef orbit_decomposition(L, cyc_act) -> list[list]:\n    orbits = []\n    L_prime = set(L)\n    while L_prime:\n        fst = L_prime.pop()\n        orbit = [fst]\n        obj = cyc_act(fst)\n        while obj != fst:\n            orbit.append(obj)\n            L_prime.discard(obj)\n            obj = cyc_act(obj)\n        orbits.append(orbit)\n    return orbits\n```\nDoing so one would have to provide only one element from each orbit, and the remaining elements would be generated by the action.  This might be practical sometimes.  Moreover and more importantly, silly mistakes as the one above would be detected, because `orbit_decomposition` would go into an infinite loop.\n\nHowever, we cannot have a similar behaviour for `PermutationGroup(gens, domain=domain)`, because of the following weirdness:\n\n```\nsage: PermutationGroup([(\"a\",\"c\")]).domain()\n{'a', 'c'}\nsage: PermutationGroup([(1,3)]).domain()\n{1, 2, 3}\n```\nSo the only way to get a permutation group with domain `{1, 3}` is\n\n```\nsage: PermutationGroup([(1,3)], domain=[1,3]).domain()\n{1, 3}\n```",
    "created_at": "2022-05-04T08:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548680",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:12'>**Comment 12:**</a>
Replying to [@mantepse](#comment%3A11):
> Replying to [@kcrisman](#comment%3A10):
> > > 
> > > ```
> > >         sage: a = lambda x: (2*x) % 6                                                                                                                                                        
> > >         sage: X = [0,1,2,3,4,5]                                                                                                                                                              
> > >         sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       
> > >         sage: G.orbits()                                                                                                                                                                     
> > >         [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           
> > >                      
> > > ``` 

> > 
> > Is there any checking that this is meaningful, or is it garbage in, garbage out?  Such as if one changed the lambda function here to be modulo 5, or 100.  (I know that 100 is garbage, I think 5 would be as well.)

> 
> Currently it is garbage in, garbage out.  Do you have any checks in mind one could do?

Actually, the map `a = lambda x: (2*x) % 6` is garbage - it is not invertible and therefore certainly not the generator of a cyclic group.  It should be `a = lambda x: (2*x) % 5`.

Currently, `sage.combinat.cyclic_sieving_phenomenon.orbit_decomposition` is defined as follows:

```
def orbit_decomposition(L, cyc_act) -> list[list]:
    orbits = []
    L_prime = set(L)
    while L_prime:
        obj = L_prime.pop()
        orbit = [obj]
        obj = cyc_act(obj)
        while obj in L_prime:
            orbit.append(obj)
            L_prime.remove(obj)
            obj = cyc_act(obj)
        orbits.append(orbit)
    return orbits
```
I think it would be better to make it

```
def orbit_decomposition(L, cyc_act) -> list[list]:
    orbits = []
    L_prime = set(L)
    while L_prime:
        fst = L_prime.pop()
        orbit = [fst]
        obj = cyc_act(fst)
        while obj != fst:
            orbit.append(obj)
            L_prime.discard(obj)
            obj = cyc_act(obj)
        orbits.append(orbit)
    return orbits
```
Doing so one would have to provide only one element from each orbit, and the remaining elements would be generated by the action.  This might be practical sometimes.  Moreover and more importantly, silly mistakes as the one above would be detected, because `orbit_decomposition` would go into an infinite loop.

However, we cannot have a similar behaviour for `PermutationGroup(gens, domain=domain)`, because of the following weirdness:

```
sage: PermutationGroup([("a","c")]).domain()
{'a', 'c'}
sage: PermutationGroup([(1,3)]).domain()
{1, 2, 3}
```
So the only way to get a permutation group with domain `{1, 3}` is

```
sage: PermutationGroup([(1,3)], domain=[1,3]).domain()
{1, 3}
```



---

archive/issue_comments_548681.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c\">8eaaba1</a></td><td><code>fix wrong doctest, improve doc</code></td></tr></table>\n",
    "created_at": "2022-05-04T08:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548681",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>**Comment 13:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c">8eaaba1</a></td><td><code>fix wrong doctest, improve doc</code></td></tr></table>




---

archive/issue_comments_548682.json:
```json
{
    "body": "**Changing commit** from \"[00f5169348afeb4e82a7b838ac0c414389fa4d02](https://github.com/sagemath/sagetrac-mirror/commit/00f5169348afeb4e82a7b838ac0c414389fa4d02)\" to \"[8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c](https://github.com/sagemath/sagetrac-mirror/commit/8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c)\".",
    "created_at": "2022-05-04T08:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548682",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[00f5169348afeb4e82a7b838ac0c414389fa4d02](https://github.com/sagemath/sagetrac-mirror/commit/00f5169348afeb4e82a7b838ac0c414389fa4d02)" to "[8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c](https://github.com/sagemath/sagetrac-mirror/commit/8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c)".



---

archive/issue_comments_548683.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\n> Currently it is garbage in, garbage out.  Do you have any checks in mind one could do?\n\nNo, I'm not sure, but I know that Sage tends to lean in that direction.  Maybe something one could ask on the list about, or David might have ideas.  Glad you saw there was a mistake, by the way - I don't know why I got confused there either.  Although should the empty permutation be a generator, strictly speaking?\n\n```\n+        sage: H.gens()\n+        [(), (1,2,4), (3,6,5)]\n```\n\nI admit I'm a little confused about the difference between the \"acting group\" and the homomorphic image here.\n\n> Since `PermutationGroup(action=a, domain=X)` is just yet another way to define a `PermutationGroup`, it should be a `PermutationGroup` and print as such.  Note that only the image of \ud835\udc3a \u2192 \ud835\udd16_\ud835\udc4b is remembered.  (Can't trac do LaTeX?)\n\nHmm, so really it just a wrapper of sorts making it easier to define permutation (sub)groups on arbitrary finite sets\n\n> > Can we do group operations (I mean like semi/direct product etc.) on it with others?  Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.\n\n> \n> Does my reply above answer this question?\n\nSo I guess not any differently from before.\n\n> I think it would be better to make it\n\nProbably that could be a separate ticket, since it would be improving already-existing functionality.\n\n> ```\n> sage: PermutationGroup([(1,3)]).domain()\n> {1, 2, 3}\n> ```\n\nYeah, this is annoying, I've run into it before.",
    "created_at": "2022-05-04T12:38:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548683",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'>**Comment 14:**</a>
> Currently it is garbage in, garbage out.  Do you have any checks in mind one could do?

No, I'm not sure, but I know that Sage tends to lean in that direction.  Maybe something one could ask on the list about, or David might have ideas.  Glad you saw there was a mistake, by the way - I don't know why I got confused there either.  Although should the empty permutation be a generator, strictly speaking?

```
+        sage: H.gens()
+        [(), (1,2,4), (3,6,5)]
```

I admit I'm a little confused about the difference between the "acting group" and the homomorphic image here.

> Since `PermutationGroup(action=a, domain=X)` is just yet another way to define a `PermutationGroup`, it should be a `PermutationGroup` and print as such.  Note that only the image of 𝐺 → 𝔖_𝑋 is remembered.  (Can't trac do LaTeX?)

Hmm, so really it just a wrapper of sorts making it easier to define permutation (sub)groups on arbitrary finite sets

> > Can we do group operations (I mean like semi/direct product etc.) on it with others?  Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.

> 
> Does my reply above answer this question?

So I guess not any differently from before.

> I think it would be better to make it

Probably that could be a separate ticket, since it would be improving already-existing functionality.

> ```
> sage: PermutationGroup([(1,3)]).domain()
> {1, 2, 3}
> ```

Yeah, this is annoying, I've run into it before.



---

archive/issue_comments_548684.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@kcrisman](#comment%3A14):\n\n> Although should the empty permutation be a generator, strictly speaking?\n> \n> ```\n> +        sage: H.gens()\n> +        [(), (1,2,4), (3,6,5)]\n> ```\n\nWell, `PermutationGroup` allows it, but I could also (manually) remove singleton orbits.\n \n> I admit I'm a little confused about the difference between the \"acting group\" and the homomorphic image here.\n\nFor example, the symmetric group acts on the singleton set trivially:\n\n```\nsage: PermutationGroup(SymmetricGroup(3).gens(), action=lambda g, x: x, domain=[1])\nPermutation Group with generators [(), ()]\n```\nand there is no way to recover the symmetric group from that.  I think that is okay, because any computation you want to do with the action you can actually do with the permutation group.\n\n> Hmm, so really it just a wrapper of sorts making it easier to define permutation (sub)groups on arbitrary finite sets\n\nIndeed.\n\n> Can we do group operations (I mean like semi/direct product etc.) on it with others?  \n\nMy plan is to provide a new implementation of combinatorial species, which will make computations with group actions of the symmetric group (and possibly some others) very convenient.  It seems that there is very little support currently.\n\n> Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.\n\nI am not sure what \"to this\" is pointing to.  With my current implementation, the action of the group is not part of the data of the `PermutationGroup`, and I think that this is how it should be.  If there is something we want to do with the action, we would indeed need a separate `FiniteGroupAction` class.  However, currently I cannot think of anything that would justify it.",
    "created_at": "2022-05-04T15:17:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548684",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@kcrisman](#comment%3A14):

> Although should the empty permutation be a generator, strictly speaking?
> 
> ```
> +        sage: H.gens()
> +        [(), (1,2,4), (3,6,5)]
> ```

Well, `PermutationGroup` allows it, but I could also (manually) remove singleton orbits.
 
> I admit I'm a little confused about the difference between the "acting group" and the homomorphic image here.

For example, the symmetric group acts on the singleton set trivially:

```
sage: PermutationGroup(SymmetricGroup(3).gens(), action=lambda g, x: x, domain=[1])
Permutation Group with generators [(), ()]
```
and there is no way to recover the symmetric group from that.  I think that is okay, because any computation you want to do with the action you can actually do with the permutation group.

> Hmm, so really it just a wrapper of sorts making it easier to define permutation (sub)groups on arbitrary finite sets

Indeed.

> Can we do group operations (I mean like semi/direct product etc.) on it with others?  

My plan is to provide a new implementation of combinatorial species, which will make computations with group actions of the symmetric group (and possibly some others) very convenient.  It seems that there is very little support currently.

> Does each (finite permutation) group automatically have an extension to this with a natural action (and would that be conjugation, right mult., left mult.)?  I'm just a little concerned about how it might be able to integrate in long-term with other group stuff.

I am not sure what "to this" is pointing to.  With my current implementation, the action of the group is not part of the data of the `PermutationGroup`, and I think that this is how it should be.  If there is something we want to do with the action, we would indeed need a separate `FiniteGroupAction` class.  However, currently I cannot think of anything that would justify it.



---

archive/issue_comments_548685.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\n> I am not sure what \"to this\" is pointing to.  With my current implementation, the action of the group is not part of the data of the `PermutationGroup`, and I think that this is how it should be.  If there is something we want to do with the action, we would indeed need a separate `FiniteGroupAction` class.  However, currently I cannot think of anything that would justify it.\n\nOkay, this paragraph clarifies greatly what you are trying to do here.  It is a little outside of my full expertise so I won't do further review, but I think this is a good start at some of your goals, and certainly for making it much easier to do permutation groups that are \"non-standard\".",
    "created_at": "2022-05-04T15:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548685",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:16'>**Comment 16:**</a>
> I am not sure what "to this" is pointing to.  With my current implementation, the action of the group is not part of the data of the `PermutationGroup`, and I think that this is how it should be.  If there is something we want to do with the action, we would indeed need a separate `FiniteGroupAction` class.  However, currently I cannot think of anything that would justify it.

Okay, this paragraph clarifies greatly what you are trying to do here.  It is a little outside of my full expertise so I won't do further review, but I think this is a good start at some of your goals, and certainly for making it much easier to do permutation groups that are "non-standard".



---

archive/issue_comments_548686.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d088d1d4471abf49045b4b8979c5348d35dc7c27\">d088d1d</a></td><td><code>remove trivial generators</code></td></tr></table>\n",
    "created_at": "2022-05-05T07:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548686",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>**Comment 17:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d088d1d4471abf49045b4b8979c5348d35dc7c27">d088d1d</a></td><td><code>remove trivial generators</code></td></tr></table>




---

archive/issue_comments_548687.json:
```json
{
    "body": "**Changing commit** from \"[8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c](https://github.com/sagemath/sagetrac-mirror/commit/8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c)\" to \"[d088d1d4471abf49045b4b8979c5348d35dc7c27](https://github.com/sagemath/sagetrac-mirror/commit/d088d1d4471abf49045b4b8979c5348d35dc7c27)\".",
    "created_at": "2022-05-05T07:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548687",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c](https://github.com/sagemath/sagetrac-mirror/commit/8eaaba12310a3e93097fbbcb5cc9a572ca9a4a4c)" to "[d088d1d4471abf49045b4b8979c5348d35dc7c27](https://github.com/sagemath/sagetrac-mirror/commit/d088d1d4471abf49045b4b8979c5348d35dc7c27)".



---

archive/issue_comments_548688.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,23 +1,25 @@\n-This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.\n+This ticket provides an easy user interface to define a permutation group corresponding to a finite group action.\n \n ```\n-       sage: a = lambda x: (2*x) % 6                                                                                                                                                        \n-        sage: X = [0,1,2,3,4,5]                                                                                                                                                              \n-        sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       \n-        sage: G.orbits()                                                                                                                                                                     \n-        [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           \n-                                                                                                                                                                                             \n-        sage: a = lambda g, x: vector(g*x, immutable=True)                                                                                                                                   \n-        sage: X = [vector(x, immutable=True) for x in GF(3)^2]                                                                                                                               \n-        sage: G = SL(2,3); G.gens()                                                                                                                                                          \n-        (                                                                                                                                                                                    \n-        [1 1]  [0 1]                                                                                                                                                                         \n-        [0 1], [2 0]                                                                                                                                                                         \n-        )                                                                                                                                                                                    \n-        sage: H = PermutationGroup(G.gens(), action=a, domain=X)                                                                                                                             \n-        sage: H.orbits()                                                                                                                                                                     \n-        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]                                                                                                         \n-        sage: H.gens()                                                                                                                                                                       \n-        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),                                                                                                                                             \n-         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]    \n+sage: a = lambda x: (2*x) % 7\n+sage: H = PermutationGroup(action=a, domain=range(7))\n+sage: H.orbits()\n+[[0], [1, 2, 4], [3, 6, 5]]\n+sage: H.gens()\n+[(1,2,4), (3,6,5)]\n+\n+sage: a = lambda g, x: vector(g*x, immutable=True)\n+sage: X = [vector(x, immutable=True) for x in GF(3)^2]\n+sage: G = SL(2,3); G.gens()\n+(\n+[1 1]  [0 1]\n+[0 1], [2 0]\n+)\n+sage: H = PermutationGroup(G.gens(), action=a, domain=X)\n+sage: H.orbits()\n+[[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]\n+sage: H.gens()\n+[((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),\n+ ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]\n ```\n+\n``````\n",
    "created_at": "2022-05-05T08:23:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548688",
    "user": "https://github.com/mantepse"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,23 +1,25 @@
-This ticket provides an easy user interface to define a permutation group corresponding to a finite group actions.
+This ticket provides an easy user interface to define a permutation group corresponding to a finite group action.
 
 ```
-       sage: a = lambda x: (2*x) % 6                                                                                                                                                        
-        sage: X = [0,1,2,3,4,5]                                                                                                                                                              
-        sage: G = PermutationGroup(action=a, domain=X)                                                                                                                                       
-        sage: G.orbits()                                                                                                                                                                     
-        [[0], [1, 2, 4], [3], [5]]                                                                                                                                                           
-                                                                                                                                                                                             
-        sage: a = lambda g, x: vector(g*x, immutable=True)                                                                                                                                   
-        sage: X = [vector(x, immutable=True) for x in GF(3)^2]                                                                                                                               
-        sage: G = SL(2,3); G.gens()                                                                                                                                                          
-        (                                                                                                                                                                                    
-        [1 1]  [0 1]                                                                                                                                                                         
-        [0 1], [2 0]                                                                                                                                                                         
-        )                                                                                                                                                                                    
-        sage: H = PermutationGroup(G.gens(), action=a, domain=X)                                                                                                                             
-        sage: H.orbits()                                                                                                                                                                     
-        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]                                                                                                         
-        sage: H.gens()                                                                                                                                                                       
-        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),                                                                                                                                             
-         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]    
+sage: a = lambda x: (2*x) % 7
+sage: H = PermutationGroup(action=a, domain=range(7))
+sage: H.orbits()
+[[0], [1, 2, 4], [3, 6, 5]]
+sage: H.gens()
+[(1,2,4), (3,6,5)]
+
+sage: a = lambda g, x: vector(g*x, immutable=True)
+sage: X = [vector(x, immutable=True) for x in GF(3)^2]
+sage: G = SL(2,3); G.gens()
+(
+[1 1]  [0 1]
+[0 1], [2 0]
+)
+sage: H = PermutationGroup(G.gens(), action=a, domain=X)
+sage: H.orbits()
+[[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]
+sage: H.gens()
+[((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),
+ ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]
 ```
+
``````




---

archive/issue_comments_548689.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nNote that what we really need (and what Gap may already have) is the general notion of a (finite) group G and a (finite) G-set V. So basically a homomorphism G -> Sym(V), although I'm not sure that's always the best way of working with such an object.\n\nGiven a group G, one often wants to cconsider *many* actions. For instance, for any subgroup H of G one probably wants to consider the natural action of G on the cosets G/H. Or one may be interested in the conjugation action on elements or subgroups (although that is probably better handled with specific conjugacy code rather than general permutation-theoretic code).\n\nI don't think you want to define different group wrappers just to store the action in every time. I would probably suggest to just first see what framework you can build up from taking *actions* as your central objects. You can then see if it is warranted to provide many wrappers in the direction of groups-with-action or G-sets (set-with-group-acting-on-it).\n\nOf course, an important example (and probably the one that's underlying most of actual functionality) is S_n itself, acting on {1,..,n}. But finite linear groups such as GL(n,q) also come with natural actions. I suspect most of the non-trivial functionality is already available in GAP and the trick will be to properly wrap/expose it in sage.",
    "created_at": "2022-05-05T19:31:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548689",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:19'>**Comment 19:**</a>
Note that what we really need (and what Gap may already have) is the general notion of a (finite) group G and a (finite) G-set V. So basically a homomorphism G -> Sym(V), although I'm not sure that's always the best way of working with such an object.

Given a group G, one often wants to cconsider *many* actions. For instance, for any subgroup H of G one probably wants to consider the natural action of G on the cosets G/H. Or one may be interested in the conjugation action on elements or subgroups (although that is probably better handled with specific conjugacy code rather than general permutation-theoretic code).

I don't think you want to define different group wrappers just to store the action in every time. I would probably suggest to just first see what framework you can build up from taking *actions* as your central objects. You can then see if it is warranted to provide many wrappers in the direction of groups-with-action or G-sets (set-with-group-acting-on-it).

Of course, an important example (and probably the one that's underlying most of actual functionality) is S_n itself, acting on {1,..,n}. But finite linear groups such as GL(n,q) also come with natural actions. I suspect most of the non-trivial functionality is already available in GAP and the trick will be to properly wrap/expose it in sage.



---

archive/issue_comments_548690.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nHi Nils, thank you for your comments!\n\nThe current branch does only one very simple thing: it provides an easy interface to obtain the image of the homomorphism G -> Sym(V).  Personally, I used the function `sage.combinat.cyclic_sieving.orbit_decomposition` so far.  The current branch is a replacement for that, and I hope that creating the `PermutationGroup` has very little overhead, but does have the advantage of providing it through a well-established interface.  Note that the action itself isn't stored, only the orbits (of course, this might be a large object) and the generators.  I admit that this takes up twice as much space as `orbit_decomposition`.\n\nI thought at first that I'd want to model group actions themselves (hence the title of the ticket), but it turned out that I don't really need this.  Moreover, I didn't find any interesting functionality such a class `FiniteGroupAction` could have, which wouldn't be a functionality already provided by `PermutationGroup`.\n\nDoes this sound reasonable?",
    "created_at": "2022-05-05T21:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548690",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:20'>**Comment 20:**</a>
Hi Nils, thank you for your comments!

The current branch does only one very simple thing: it provides an easy interface to obtain the image of the homomorphism G -> Sym(V).  Personally, I used the function `sage.combinat.cyclic_sieving.orbit_decomposition` so far.  The current branch is a replacement for that, and I hope that creating the `PermutationGroup` has very little overhead, but does have the advantage of providing it through a well-established interface.  Note that the action itself isn't stored, only the orbits (of course, this might be a large object) and the generators.  I admit that this takes up twice as much space as `orbit_decomposition`.

I thought at first that I'd want to model group actions themselves (hence the title of the ticket), but it turned out that I don't really need this.  Moreover, I didn't find any interesting functionality such a class `FiniteGroupAction` could have, which wouldn't be a functionality already provided by `PermutationGroup`.

Does this sound reasonable?



---

archive/issue_comments_548691.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nI copy+pasted all the code in that permgroup.py module in this trac ticket into a sage file, then\nattached it to a sage session and ran some examples by hand. \nHere are a few comments:\n\nline 371: I'd remove \"#See Trac 12597\". This isn't your addition, but why keep this?\n\nLines 435 and 475 return \"The following tests failed...\" Is this supposed to happen?\n\nThere are also errors in lines 552, 562, 563, 649.\n\nLine 765 returns True (not False, as in the documentation).\n\nIs line 760 needed? (\"Check trac 29624 is fixed.\") You didn't add this but this ticket is 10 years old now.\n\nLine 890 returns False (not True, as in the documentation).\n\nThere seems to be something wrong with the PermutationGroupElement code. Look at the TrypeErrors returns by running the examples in lines 896 and 899.\n\nI could go on if you like (the module has over 5000 lines). Let me know.",
    "created_at": "2022-05-06T15:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548691",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:21'>**Comment 21:**</a>
I copy+pasted all the code in that permgroup.py module in this trac ticket into a sage file, then
attached it to a sage session and ran some examples by hand. 
Here are a few comments:

line 371: I'd remove "#See Trac 12597". This isn't your addition, but why keep this?

Lines 435 and 475 return "The following tests failed..." Is this supposed to happen?

There are also errors in lines 552, 562, 563, 649.

Line 765 returns True (not False, as in the documentation).

Is line 760 needed? ("Check trac 29624 is fixed.") You didn't add this but this ticket is 10 years old now.

Line 890 returns False (not True, as in the documentation).

There seems to be something wrong with the PermutationGroupElement code. Look at the TrypeErrors returns by running the examples in lines 896 and 899.

I could go on if you like (the module has over 5000 lines). Let me know.



---

archive/issue_comments_548692.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nDavid, I think a lot of that might be cruft that could be addressed on another ticket (and maybe it should be! feel free to open one).  Here is the diff of this ticket, if it helps - should only have to review it, per se.\n\n```diff\ndiff --git a/src/sage/groups/perm_gps/permgroup.py b/src/sage/groups/perm_gps/permgroup.py\nindex f10fb48..c2ffd5e 100644\n--- a/src/sage/groups/perm_gps/permgroup.py\n+++ b/src/sage/groups/perm_gps/permgroup.py\n@@ -331,6 +331,39 @@ def PermutationGroup(gens=None, *args, **kwds):\n         sage: G2.GeneratorsSmallest()\n         [ (3,4,5), (2,3)(4,5), (1,2)(4,5) ]\n \n+    We can create a permutation group from a group action::\n+\n+        sage: a = lambda x: (2*x) % 7\n+        sage: H = PermutationGroup(action=a, domain=range(7))\n+        sage: H.orbits()\n+        [[0], [1, 2, 4], [3, 6, 5]]\n+        sage: H.gens()\n+        [(1,2,4), (3,6,5)]\n+\n+    Note that we provide generators for the acting group.  The\n+    permutation group we construct is its homomorphic image::\n+\n+        sage: a = lambda g, x: vector(g*x, immutable=True)\n+        sage: X = [vector(x, immutable=True) for x in GF(3)^2]\n+        sage: G = SL(2,3); G.gens()\n+        (\n+        [1 1]  [0 1]\n+        [0 1], [2 0]\n+        )\n+        sage: H = PermutationGroup(G.gens(), action=a, domain=X)\n+        sage: H.orbits()\n+        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]\n+        sage: H.gens()\n+        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),\n+         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]\n+\n+    The orbits of the conjugation action are the conjugacy classes,\n+    i.e., in bijection with integer partitions::\n+\n+        sage: a = lambda g, x: g*x*g^-1\n+        sage: [len(PermutationGroup(SymmetricGroup(n).gens(), action=a, domain=SymmetricGroup(n)).orbits()) for n in range(1, 8)]\n+        [1, 2, 3, 5, 7, 11, 15]\n+\n     TESTS::\n \n         sage: r = Permutation(\"(1,7,9,3)(2,4,8,6)\")\n@@ -350,6 +383,7 @@ def PermutationGroup(gens=None, *args, **kwds):\n         ...\n         DeprecationWarning: gap_group, domain, canonicalize, category will become keyword only\n         See https://trac.sagemath.org/31510 for details.\n+\n     \"\"\"\n     if not is_ExpectElement(gens) and hasattr(gens, '_permgroup_'):\n         return gens._permgroup_()\n@@ -359,6 +393,11 @@ def PermutationGroup(gens=None, *args, **kwds):\n     domain = kwds.get(\"domain\", None)\n     canonicalize = kwds.get(\"canonicalize\", True)\n     category = kwds.get(\"category\", None)\n+    action = kwds.get(\"action\", None)\n+    if action is not None:\n+        if domain is None:\n+            raise ValueError(\"you must specify the domain for an action\")\n+        return PermutationGroup_action(gens, action, domain, gap_group=gap_group)\n     if args:\n         from sage.misc.superseded import deprecation\n         deprecation(31510, \"gap_group, domain, canonicalize, category will become keyword only\")\n@@ -1299,7 +1338,7 @@ class PermutationGroup_generic(FiniteGroup):\n         EXAMPLES::\n \n             sage: G = PermutationGroup([[(1,2,3),(4,5)]])\n-            sage: e = G.identity()\n+            sage: e = G.identity()                                              # indirect doctest\n             sage: e\n             ()\n             sage: g = G.gen(0)\n@@ -4989,5 +5028,109 @@ class PermutationGroup_subgroup(PermutationGroup_generic):\n # Allow for subclasses to use a different subgroup class\n PermutationGroup_generic.Subgroup = PermutationGroup_subgroup\n \n+class PermutationGroup_action(PermutationGroup_generic):\n+    \"\"\"\n+    A permutation group given by a finite group action.\n+\n+    EXAMPLES:\n+\n+    A cyclic action::\n+\n+        sage: n = 3\n+        sage: a = lambda x: SetPartition([[e % n + 1 for e in b] for b in x])\n+        sage: S = SetPartitions(n)\n+        sage: G = PermutationGroup(action=a, domain=S)\n+        sage: G.orbits()\n+        [[{{1}, {2}, {3}}],\n+         [{{1, 2}, {3}}, {{1}, {2, 3}}, {{1, 3}, {2}}],\n+         [{{1, 2, 3}}]]\n+\n+    The regular action of the symmetric group::\n+\n+        sage: a = lambda g, x: g*x*g^-1\n+        sage: S = SymmetricGroup(3)\n+        sage: G = PermutationGroup(S.gens(), action=a, domain=S)\n+        sage: G.orbits()\n+        [[()], [(1,3,2), (1,2,3)], [(2,3), (1,3), (1,2)]]\n+\n+    The trivial action of the symmetric group::\n+\n+        sage: PermutationGroup(SymmetricGroup(3).gens(), action=lambda g, x: x, domain=[1])\n+        Permutation Group with generators [()]\n+    \"\"\"\n+    def __init__(self, gens, action, domain, gap_group=None, category=None, canonicalize=None):\n+        \"\"\"\n+        Initialize ``self``.\n+\n+        INPUT:\n+\n+        - ``gens`` -- list of generators of the group or ``None`` if the action is cyclic\n+\n+        - ``action`` -- a group action `G \\times X\\to X` if ``gens``\n+          is given, or a cyclic group action `X\\to X` if ``gens`` is\n+          ``None``\n+\n+        - ``domain`` -- the set the group is acting on\n+\n+        - ``gap_group`` -- a gap or libgap permutation group, or a string\n+          defining one (default: ``None``), this is currently not supported\n+\n+        - ``canonicalize`` -- bool (default: ``True``); if ``True``,\n+          sort generators and remove duplicates\n+\n+        OUTPUT:\n+\n+        - A finite group action given as a permutation group.\n+\n+        EXAMPLES::\n+\n+            sage: a = lambda x: (2*x) % 7\n+            sage: G = PermutationGroup(action=a, domain=range(7))\n+            sage: G.orbits()\n+            [[0], [1, 2, 4], [3, 6, 5]]\n+\n+        \"\"\"\n+        from sage.combinat.cyclic_sieving_phenomenon import orbit_decomposition\n+        from sage.sets.disjoint_set import DisjointSet\n+        if gap_group is not None:\n+            raise ValueError(\"gap_group is not supported with action\")\n+        if gens is None:\n+            self._orbits = orbit_decomposition(domain, action)\n+            gens = [tuple(o) for o in self._orbits if len(o) > 1]\n+        else:\n+            g_orbits = [orbit_decomposition(domain, lambda x: action(g, x))\n+                        for g in gens]\n+            gens = []\n+            for g_orbit in g_orbits:\n+                g_gens = [tuple(o) for o in g_orbit if len(o) > 1]\n+                if g_gens:\n+                    gens.append(g_gens)\n+\n+            D = DisjointSet(domain)\n+            for g_orbit in g_orbits:\n+                for o in g_orbit:\n+                    for i in range(1, len(o)):\n+                        D.union(o[0], o[i])\n+            self._orbits = list(D)\n+\n+        PermutationGroup_generic.__init__(self, gens=gens,\n+                                          gap_group=gap_group, domain=domain,\n+                                          category=category,\n+                                          canonicalize=canonicalize)\n+\n+    def orbits(self):\n+        \"\"\"\n+        Returns the orbits of the elements of the domain under the\n+        default group action.\n+\n+        EXAMPLES::\n+\n+            sage: a = lambda x: (2*x) % 7\n+            sage: G = PermutationGroup(action=a, domain=range(7))\n+            sage: G.orbits()\n+            [[0], [1, 2, 4], [3, 6, 5]]\n+        \"\"\"\n+        return self._orbits\n+\n from sage.misc.rest_index_of_methods import gen_rest_table_index\n __doc__ = __doc__.format(METHODS_OF_PermutationGroup_generic=gen_rest_table_index(PermutationGroup_generic))\n```",
    "created_at": "2022-05-06T15:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548692",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'>**Comment 22:**</a>
David, I think a lot of that might be cruft that could be addressed on another ticket (and maybe it should be! feel free to open one).  Here is the diff of this ticket, if it helps - should only have to review it, per se.

```diff
diff --git a/src/sage/groups/perm_gps/permgroup.py b/src/sage/groups/perm_gps/permgroup.py
index f10fb48..c2ffd5e 100644
--- a/src/sage/groups/perm_gps/permgroup.py
+++ b/src/sage/groups/perm_gps/permgroup.py
@@ -331,6 +331,39 @@ def PermutationGroup(gens=None, *args, **kwds):
         sage: G2.GeneratorsSmallest()
         [ (3,4,5), (2,3)(4,5), (1,2)(4,5) ]
 
+    We can create a permutation group from a group action::
+
+        sage: a = lambda x: (2*x) % 7
+        sage: H = PermutationGroup(action=a, domain=range(7))
+        sage: H.orbits()
+        [[0], [1, 2, 4], [3, 6, 5]]
+        sage: H.gens()
+        [(1,2,4), (3,6,5)]
+
+    Note that we provide generators for the acting group.  The
+    permutation group we construct is its homomorphic image::
+
+        sage: a = lambda g, x: vector(g*x, immutable=True)
+        sage: X = [vector(x, immutable=True) for x in GF(3)^2]
+        sage: G = SL(2,3); G.gens()
+        (
+        [1 1]  [0 1]
+        [0 1], [2 0]
+        )
+        sage: H = PermutationGroup(G.gens(), action=a, domain=X)
+        sage: H.orbits()
+        [[(0, 0)], [(1, 0), (2, 0), (0, 1), (1, 1), (2, 1), (0, 2), (1, 2), (2, 2)]]
+        sage: H.gens()
+        [((0,1),(1,1),(2,1))((0,2),(2,2),(1,2)),
+         ((1,0),(0,2),(2,0),(0,1))((1,1),(1,2),(2,2),(2,1))]
+
+    The orbits of the conjugation action are the conjugacy classes,
+    i.e., in bijection with integer partitions::
+
+        sage: a = lambda g, x: g*x*g^-1
+        sage: [len(PermutationGroup(SymmetricGroup(n).gens(), action=a, domain=SymmetricGroup(n)).orbits()) for n in range(1, 8)]
+        [1, 2, 3, 5, 7, 11, 15]
+
     TESTS::
 
         sage: r = Permutation("(1,7,9,3)(2,4,8,6)")
@@ -350,6 +383,7 @@ def PermutationGroup(gens=None, *args, **kwds):
         ...
         DeprecationWarning: gap_group, domain, canonicalize, category will become keyword only
         See https://trac.sagemath.org/31510 for details.
+
     """
     if not is_ExpectElement(gens) and hasattr(gens, '_permgroup_'):
         return gens._permgroup_()
@@ -359,6 +393,11 @@ def PermutationGroup(gens=None, *args, **kwds):
     domain = kwds.get("domain", None)
     canonicalize = kwds.get("canonicalize", True)
     category = kwds.get("category", None)
+    action = kwds.get("action", None)
+    if action is not None:
+        if domain is None:
+            raise ValueError("you must specify the domain for an action")
+        return PermutationGroup_action(gens, action, domain, gap_group=gap_group)
     if args:
         from sage.misc.superseded import deprecation
         deprecation(31510, "gap_group, domain, canonicalize, category will become keyword only")
@@ -1299,7 +1338,7 @@ class PermutationGroup_generic(FiniteGroup):
         EXAMPLES::
 
             sage: G = PermutationGroup([[(1,2,3),(4,5)]])
-            sage: e = G.identity()
+            sage: e = G.identity()                                              # indirect doctest
             sage: e
             ()
             sage: g = G.gen(0)
@@ -4989,5 +5028,109 @@ class PermutationGroup_subgroup(PermutationGroup_generic):
 # Allow for subclasses to use a different subgroup class
 PermutationGroup_generic.Subgroup = PermutationGroup_subgroup
 
+class PermutationGroup_action(PermutationGroup_generic):
+    """
+    A permutation group given by a finite group action.
+
+    EXAMPLES:
+
+    A cyclic action::
+
+        sage: n = 3
+        sage: a = lambda x: SetPartition([[e % n + 1 for e in b] for b in x])
+        sage: S = SetPartitions(n)
+        sage: G = PermutationGroup(action=a, domain=S)
+        sage: G.orbits()
+        [[{{1}, {2}, {3}}],
+         [{{1, 2}, {3}}, {{1}, {2, 3}}, {{1, 3}, {2}}],
+         [{{1, 2, 3}}]]
+
+    The regular action of the symmetric group::
+
+        sage: a = lambda g, x: g*x*g^-1
+        sage: S = SymmetricGroup(3)
+        sage: G = PermutationGroup(S.gens(), action=a, domain=S)
+        sage: G.orbits()
+        [[()], [(1,3,2), (1,2,3)], [(2,3), (1,3), (1,2)]]
+
+    The trivial action of the symmetric group::
+
+        sage: PermutationGroup(SymmetricGroup(3).gens(), action=lambda g, x: x, domain=[1])
+        Permutation Group with generators [()]
+    """
+    def __init__(self, gens, action, domain, gap_group=None, category=None, canonicalize=None):
+        """
+        Initialize ``self``.
+
+        INPUT:
+
+        - ``gens`` -- list of generators of the group or ``None`` if the action is cyclic
+
+        - ``action`` -- a group action `G \times X\to X` if ``gens``
+          is given, or a cyclic group action `X\to X` if ``gens`` is
+          ``None``
+
+        - ``domain`` -- the set the group is acting on
+
+        - ``gap_group`` -- a gap or libgap permutation group, or a string
+          defining one (default: ``None``), this is currently not supported
+
+        - ``canonicalize`` -- bool (default: ``True``); if ``True``,
+          sort generators and remove duplicates
+
+        OUTPUT:
+
+        - A finite group action given as a permutation group.
+
+        EXAMPLES::
+
+            sage: a = lambda x: (2*x) % 7
+            sage: G = PermutationGroup(action=a, domain=range(7))
+            sage: G.orbits()
+            [[0], [1, 2, 4], [3, 6, 5]]
+
+        """
+        from sage.combinat.cyclic_sieving_phenomenon import orbit_decomposition
+        from sage.sets.disjoint_set import DisjointSet
+        if gap_group is not None:
+            raise ValueError("gap_group is not supported with action")
+        if gens is None:
+            self._orbits = orbit_decomposition(domain, action)
+            gens = [tuple(o) for o in self._orbits if len(o) > 1]
+        else:
+            g_orbits = [orbit_decomposition(domain, lambda x: action(g, x))
+                        for g in gens]
+            gens = []
+            for g_orbit in g_orbits:
+                g_gens = [tuple(o) for o in g_orbit if len(o) > 1]
+                if g_gens:
+                    gens.append(g_gens)
+
+            D = DisjointSet(domain)
+            for g_orbit in g_orbits:
+                for o in g_orbit:
+                    for i in range(1, len(o)):
+                        D.union(o[0], o[i])
+            self._orbits = list(D)
+
+        PermutationGroup_generic.__init__(self, gens=gens,
+                                          gap_group=gap_group, domain=domain,
+                                          category=category,
+                                          canonicalize=canonicalize)
+
+    def orbits(self):
+        """
+        Returns the orbits of the elements of the domain under the
+        default group action.
+
+        EXAMPLES::
+
+            sage: a = lambda x: (2*x) % 7
+            sage: G = PermutationGroup(action=a, domain=range(7))
+            sage: G.orbits()
+            [[0], [1, 2, 4], [3, 6, 5]]
+        """
+        return self._orbits
+
 from sage.misc.rest_index_of_methods import gen_rest_table_index
 __doc__ = __doc__.format(METHODS_OF_PermutationGroup_generic=gen_rest_table_index(PermutationGroup_generic))
```



---

archive/issue_comments_548693.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nIf that's the only part needing review, then it looks good to me!",
    "created_at": "2022-05-06T19:29:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548693",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:23'>**Comment 23:**</a>
If that's the only part needing review, then it looks good to me!



---

archive/issue_comments_548694.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nIf so, please click on \"modify ticket\", enter your name into the \"Reviewers\" field and select \"positive review\".\n\nThank you so much!",
    "created_at": "2022-05-08T18:26:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548694",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:24'>**Comment 24:**</a>
If so, please click on "modify ticket", enter your name into the "Reviewers" field and select "positive review".

Thank you so much!



---

archive/issue_events_408493.json:
```json
{
    "actor": "https://github.com/wdjoyner",
    "created_at": "2022-05-08T19:20:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408493"
}
```



---

archive/issue_events_408494.json:
```json
{
    "actor": "https://github.com/wdjoyner",
    "created_at": "2022-05-08T19:20:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408494"
}
```



---

archive/issue_comments_548695.json:
```json
{
    "body": "**Reviewer:** wdj",
    "created_at": "2022-05-08T19:20:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548695",
    "user": "https://github.com/wdjoyner"
}
```

**Reviewer:** wdj



---

archive/issue_comments_548696.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nReplying to [@mantepse](#comment%3A24):\n> If so, please click on \"modify ticket\", enter your name into the \"Reviewers\" field and select \"positive review\".\n> \n> Thank you so much!\n\nDone.",
    "created_at": "2022-05-08T19:21:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548696",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:26'>**Comment 26:**</a>
Replying to [@mantepse](#comment%3A24):
> If so, please click on "modify ticket", enter your name into the "Reviewers" field and select "positive review".
> 
> Thank you so much!

Done.



---

archive/issue_events_408495.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-05-09T04:44:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408495"
}
```



---

archive/issue_events_408496.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-05-09T04:44:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408496"
}
```



---

archive/issue_comments_548697.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nA few little things:\n\n- `orbits()` should not return a mutable object since it is the cached object. The cached result is better as a tuple of tuples IMO. Otherwise `orbits()` needs to make a deep copy.\n- `Returns` -> `Return` in `orbits()`.\n- Real name for the reviewer.\n- It might be good to be explicit and say this is a left action.\n\nPerhaps not such a little thing, and while it isn't necessary for a positive review, it might be good to do now:\n\nI believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.",
    "created_at": "2022-05-09T04:44:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548697",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'>**Comment 27:**</a>
A few little things:

- `orbits()` should not return a mutable object since it is the cached object. The cached result is better as a tuple of tuples IMO. Otherwise `orbits()` needs to make a deep copy.
- `Returns` -> `Return` in `orbits()`.
- Real name for the reviewer.
- It might be good to be explicit and say this is a left action.

Perhaps not such a little thing, and while it isn't necessary for a positive review, it might be good to do now:

I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.



---

archive/issue_comments_548698.json:
```json
{
    "body": "**Changing reviewer** from \"wdj\" to \"wdj, Travis Scrimshaw\".",
    "created_at": "2022-05-09T04:44:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548698",
    "user": "https://github.com/tscrim"
}
```

**Changing reviewer** from "wdj" to "wdj, Travis Scrimshaw".



---

archive/issue_comments_548699.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nThank you Travis for joining, I was hoping for you!\n\nReplying to [@tscrim](#comment%3A27):\n\n> - `orbits()` should not return a mutable object since it is the cached object. The cached result is better as a tuple of tuples IMO. Otherwise `orbits()` needs to make a deep copy.\n\nI noticed this too.  The problem I had is that `PermutationGroup_generic.orbits` has the the same problem:\n\n```\nsage: G = PermutationGroup([ [(3,4)], [(1,3)] ])\nsage: O = G.orbits(); O\n[[1, 3, 4], [2]]\nsage: O[0] = 1\nsage: G.orbits()\n[1, [2]]\n```\n\nI think it is important that the two methods do the same thing.  Because of your next item,\n\n> - `Returns` -> `Return` in `orbits()`.\n\nI decided to open a new ticket to change the behaviour of `PermutationGroup_generic.orbits` first, and fix the \"Returns\".\n\n> - It might be good to be explicit and say this is a left action.\n\nDone (in the INPUT section).\n\n> Perhaps not such a little thing, and while it isn't necessary for a positive review, it might be good to do now:\n> \n> I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.\n\nI'll think about this, but I'll first open the other ticket.",
    "created_at": "2022-05-09T07:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548699",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:28'>**Comment 28:**</a>
Thank you Travis for joining, I was hoping for you!

Replying to [@tscrim](#comment%3A27):

> - `orbits()` should not return a mutable object since it is the cached object. The cached result is better as a tuple of tuples IMO. Otherwise `orbits()` needs to make a deep copy.

I noticed this too.  The problem I had is that `PermutationGroup_generic.orbits` has the the same problem:

```
sage: G = PermutationGroup([ [(3,4)], [(1,3)] ])
sage: O = G.orbits(); O
[[1, 3, 4], [2]]
sage: O[0] = 1
sage: G.orbits()
[1, [2]]
```

I think it is important that the two methods do the same thing.  Because of your next item,

> - `Returns` -> `Return` in `orbits()`.

I decided to open a new ticket to change the behaviour of `PermutationGroup_generic.orbits` first, and fix the "Returns".

> - It might be good to be explicit and say this is a left action.

Done (in the INPUT section).

> Perhaps not such a little thing, and while it isn't necessary for a positive review, it might be good to do now:
> 
> I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.

I'll think about this, but I'll first open the other ticket.



---

archive/issue_comments_548700.json:
```json
{
    "body": "**Dependencies:** #33824",
    "created_at": "2022-05-09T09:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548700",
    "user": "https://github.com/mantepse"
}
```

**Dependencies:** #33824



---

archive/issue_comments_548701.json:
```json
{
    "body": "**Changing reviewer** from \"wdj, Travis Scrimshaw\" to \"David Joyner, Travis Scrimshaw\".",
    "created_at": "2022-05-09T11:26:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548701",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "wdj, Travis Scrimshaw" to "David Joyner, Travis Scrimshaw".



---

archive/issue_comments_548702.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nReplying to [@mantepse](#comment%3A28):\n> I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.\n\nI now realise that it is unclear to me what you have in mind.  Let's say that `G` is generated by `g` and `h`.  We compute `g_orbit = orbit_decomposition(domain, lambda x: action(g, x))`.  I also need the generators corresponding to the homomorphic image of `h`, which is `orbit_decomposition(domain, lambda x: action(h, x))`, I don't see how I could avoid that.  I could apply `h*g^-1` to each element in `g_orbit`, but I don't see how this would avoid computations.\n\nHelp appreciated!",
    "created_at": "2022-05-09T14:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548702",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:31'>**Comment 31:**</a>
Replying to [@mantepse](#comment%3A28):
> I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.

I now realise that it is unclear to me what you have in mind.  Let's say that `G` is generated by `g` and `h`.  We compute `g_orbit = orbit_decomposition(domain, lambda x: action(g, x))`.  I also need the generators corresponding to the homomorphic image of `h`, which is `orbit_decomposition(domain, lambda x: action(h, x))`, I don't see how I could avoid that.  I could apply `h*g^-1` to each element in `g_orbit`, but I don't see how this would avoid computations.

Help appreciated!



---

archive/issue_comments_548703.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nReplying to [@mantepse](#comment%3A31):\n> Replying to [@mantepse](#comment%3A28):\n> > I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.\n\n> \n> I now realise that it is unclear to me what you have in mind.  Let's say that `G` is generated by `g` and `h`.  We compute `g_orbit = orbit_decomposition(domain, lambda x: action(g, x))`.  I also need the generators corresponding to the homomorphic image of `h`, which is `orbit_decomposition(domain, lambda x: action(h, x))`, I don't see how I could avoid that.  I could apply `h*g^-1` to each element in `g_orbit`, but I don't see how this would avoid computations.\n\nYou compute `orbit_decomposition()` for `g`, and then you just apply `h` to each element in each orbit. If it goes to a different orbit, then you merge the two. You can stop early once you have one orbit too. I don\u2019t think there is a way to shortcut acting on each element by each generator (at least without knowing some structure of the group). However, you do not need to hold all of the orbits for each element (i.e., also for `h` in your example) simultaneously. I don\u2019t see why you also need to apply `g^-1`.",
    "created_at": "2022-05-10T02:38:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548703",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'>**Comment 32:**</a>
Replying to [@mantepse](#comment%3A31):
> Replying to [@mantepse](#comment%3A28):
> > I believe a more efficient way to compute the action for a non-cyclic group is to directly manipulate the orbits constructed for one generator rather than building the orbits for all generators and splicing them together. This requires less memory and should at most use the same number of operations. As a bit of an extreme case, take a large product of copies of the trivial group (or `Z/2Z`) acting on a large set.

> 
> I now realise that it is unclear to me what you have in mind.  Let's say that `G` is generated by `g` and `h`.  We compute `g_orbit = orbit_decomposition(domain, lambda x: action(g, x))`.  I also need the generators corresponding to the homomorphic image of `h`, which is `orbit_decomposition(domain, lambda x: action(h, x))`, I don't see how I could avoid that.  I could apply `h*g^-1` to each element in `g_orbit`, but I don't see how this would avoid computations.

You compute `orbit_decomposition()` for `g`, and then you just apply `h` to each element in each orbit. If it goes to a different orbit, then you merge the two. You can stop early once you have one orbit too. I don’t think there is a way to shortcut acting on each element by each generator (at least without knowing some structure of the group). However, you do not need to hold all of the orbits for each element (i.e., also for `h` in your example) simultaneously. I don’t see why you also need to apply `g^-1`.



---

archive/issue_comments_548704.json:
```json
{
    "body": "**Changing commit** from \"[d088d1d4471abf49045b4b8979c5348d35dc7c27](https://github.com/sagemath/sagetrac-mirror/commit/d088d1d4471abf49045b4b8979c5348d35dc7c27)\" to \"[fdea936a8c038820368a79e4c153745c0b442f8d](https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d)\".",
    "created_at": "2022-05-10T10:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548704",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d088d1d4471abf49045b4b8979c5348d35dc7c27](https://github.com/sagemath/sagetrac-mirror/commit/d088d1d4471abf49045b4b8979c5348d35dc7c27)" to "[fdea936a8c038820368a79e4c153745c0b442f8d](https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d)".



---

archive/issue_comments_548705.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f650721ac09c827a65423df58f9c13b1d9e605b\">3f65072</a></td><td><code>make PermutationGroup_generic.orbits return a tuple of tuples, for immutability</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2a29ac50e31996cefff7b3c5ada9afbf2f92428\">b2a29ac</a></td><td><code>Merge branch 'u/mantepse/make_orbits_of_permutationgroup_immutable' of trac.sagemath.org:sage into t/33784/provide_a_framework_for_finite_group_actions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da2c2e5b60c08f6a127be34cb08331d674f667db\">da2c2e5</a></td><td><code>make PermutationGroup_generic.gens return a tuple, to ensure immutability</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5adcb077d3f03e1aac68260315c8dc4feb4ff2e\">d5adcb0</a></td><td><code>replace $...$ with `...`</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/90005e7773626f2a50b5c885161a4a4ff8259059\">90005e7</a></td><td><code>remove unused import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8dc2e1983bedb307d9688f22c6b30149d531058\">d8dc2e1</a></td><td><code>Merge branch 'u/mantepse/make_orbits_of_permutationgroup_immutable' of trac.sagemath.org:sage into t/33784/provide_a_framework_for_finite_group_actions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d\">fdea936</a></td><td><code>fix doctests</code></td></tr></table>\n",
    "created_at": "2022-05-10T10:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548705",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:33'>**Comment 33:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f650721ac09c827a65423df58f9c13b1d9e605b">3f65072</a></td><td><code>make PermutationGroup_generic.orbits return a tuple of tuples, for immutability</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2a29ac50e31996cefff7b3c5ada9afbf2f92428">b2a29ac</a></td><td><code>Merge branch 'u/mantepse/make_orbits_of_permutationgroup_immutable' of trac.sagemath.org:sage into t/33784/provide_a_framework_for_finite_group_actions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da2c2e5b60c08f6a127be34cb08331d674f667db">da2c2e5</a></td><td><code>make PermutationGroup_generic.gens return a tuple, to ensure immutability</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5adcb077d3f03e1aac68260315c8dc4feb4ff2e">d5adcb0</a></td><td><code>replace $...$ with `...`</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/90005e7773626f2a50b5c885161a4a4ff8259059">90005e7</a></td><td><code>remove unused import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8dc2e1983bedb307d9688f22c6b30149d531058">d8dc2e1</a></td><td><code>Merge branch 'u/mantepse/make_orbits_of_permutationgroup_immutable' of trac.sagemath.org:sage into t/33784/provide_a_framework_for_finite_group_actions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d">fdea936</a></td><td><code>fix doctests</code></td></tr></table>




---

archive/issue_comments_548706.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nReplying to [@tscrim](#comment%3A32):\n\nThank you for explaining!\n> You compute orbit_decomposition() for g, and then you just apply h to each element in each orbit. If it goes to a different orbit, then you merge the two. You can stop early once you have one orbit too. I don\u2019t think there is a way to shortcut acting on each element by each generator (at least without knowing some structure of the group). However, you do not need to hold all of the orbits for each element (i.e., also for h in your example) simultaneously. I don\u2019t see why you also need to apply g^-1. \n\nI still don't get it (and I made a mistake myself).  Suppose the generator corresponding to `g` is\n\n```\n(x1, g x1, g^2 x1, ...) (x2, g x2, g^2 x2, ...)...\n```\nThen applying `h` to each element of the first orbit I obtain\n\n```\n(h x1, h g x1, h g^2 x1, ...)\n```\nbut this is not a cycle of a generator of the homomorphic image, is it?",
    "created_at": "2022-05-10T10:39:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548706",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:34'>**Comment 34:**</a>
Replying to [@tscrim](#comment%3A32):

Thank you for explaining!
> You compute orbit_decomposition() for g, and then you just apply h to each element in each orbit. If it goes to a different orbit, then you merge the two. You can stop early once you have one orbit too. I don’t think there is a way to shortcut acting on each element by each generator (at least without knowing some structure of the group). However, you do not need to hold all of the orbits for each element (i.e., also for h in your example) simultaneously. I don’t see why you also need to apply g^-1. 

I still don't get it (and I made a mistake myself).  Suppose the generator corresponding to `g` is

```
(x1, g x1, g^2 x1, ...) (x2, g x2, g^2 x2, ...)...
```
Then applying `h` to each element of the first orbit I obtain

```
(h x1, h g x1, h g^2 x1, ...)
```
but this is not a cycle of a generator of the homomorphic image, is it?



---

archive/issue_comments_548707.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nAh, I think I have misunderstood what you mean by orbits. I was thinking of G-orbits for the whole group, but to define the permutation group, you need the orbits of each generator. Thus, you need to hold all of this information, which is more than you need for the G-orbits.",
    "created_at": "2022-05-10T10:58:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548707",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:35'>**Comment 35:**</a>
Ah, I think I have misunderstood what you mean by orbits. I was thinking of G-orbits for the whole group, but to define the permutation group, you need the orbits of each generator. Thus, you need to hold all of this information, which is more than you need for the G-orbits.



---

archive/issue_events_408497.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-05-10T11:45:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408497"
}
```



---

archive/issue_events_408498.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-05-10T11:45:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408498"
}
```



---

archive/issue_comments_548708.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nIndeed.  In principle I only need the generators, but I think it makes sense to compute the orbits of the group action, right away instead of asking gap to do it.\n\nFor cyclic actions, the orbits are what I'm after, in fact.",
    "created_at": "2022-05-10T11:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548708",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:36'>**Comment 36:**</a>
Indeed.  In principle I only need the generators, but I think it makes sense to compute the orbits of the group action, right away instead of asking gap to do it.

For cyclic actions, the orbits are what I'm after, in fact.



---

archive/issue_comments_548709.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nThank you. Then back to a positive review.",
    "created_at": "2022-05-10T23:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548709",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'>**Comment 37:**</a>
Thank you. Then back to a positive review.



---

archive/issue_events_408499.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-05-10T23:50:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408499"
}
```



---

archive/issue_events_408500.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-05-10T23:50:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408500"
}
```



---

archive/issue_comments_548710.json:
```json
{
    "body": "**Changing branch** from \"[u/mantepse/provide_a_framework_for_finite_group_actions](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/provide_a_framework_for_finite_group_actions)\" to \"[fdea936a8c038820368a79e4c153745c0b442f8d](https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d)\".",
    "created_at": "2022-05-24T22:45:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33784#issuecomment-548710",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mantepse/provide_a_framework_for_finite_group_actions](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/provide_a_framework_for_finite_group_actions)" to "[fdea936a8c038820368a79e4c153745c0b442f8d](https://github.com/sagemath/sagetrac-mirror/commit/fdea936a8c038820368a79e4c153745c0b442f8d)".



---

archive/issue_events_408501.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-05-24T22:45:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408501"
}
```



---

archive/issue_events_408502.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "83a89a096bc306230a2921c0fc70fa47203c5877",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-05-24T22:45:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33784",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33784#event-408502"
}
```
