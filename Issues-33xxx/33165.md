# Issue 33165: faster evaluation of polynomials in R[x] at monomials in R[y] or R[u,v] and variables in R[x]/(f)

archive/issues_032928.json:
```json
{
    "body": "This seems to be part of what's going wrong in #33156:\n\n```\nsage: R.<x> = GF(31337)[]\nsage: f = R.random_element(degree=999)\nsage: g = R.random_element(degree=9999)\nsage: S.<y> = R.quotient(f)\nsage: %timeit g(y)\n188 ms \u00b1 1.74 ms per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\nsage: %timeit (g%f)(y)\n16.4 ms \u00b1 31 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\nsage: %timeit S(g%f)\n2.97 ms \u00b1 185 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n```\n\nThis patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.\n\nThe following cases are handled: {univariate polynomial rings, multivariate polynomial rings, quotients of univariate polynomial rings} over the same base.\n\nWe also speed up evaluation at monomials in another polynomial ring in a similar way.\n\nBranch/Commit: [9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)\n\nReviewer: Marc Mezzarobba, Travis Scrimshaw\n\nAuthor: Lorenz Panny, Marc Mezzarobba, Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33165\n\n",
    "closed_at": "2022-02-27T22:00:28Z",
    "created_at": "2022-01-14T04:42:57Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "faster evaluation of polynomials in R[x] at monomials in R[y] or R[u,v] and variables in R[x]/(f)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33165",
    "user": "https://github.com/yyyyx4"
}
```
This seems to be part of what's going wrong in #33156:

```
sage: R.<x> = GF(31337)[]
sage: f = R.random_element(degree=999)
sage: g = R.random_element(degree=9999)
sage: S.<y> = R.quotient(f)
sage: %timeit g(y)
188 ms ± 1.74 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
sage: %timeit (g%f)(y)
16.4 ms ± 31 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
sage: %timeit S(g%f)
2.97 ms ± 185 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
```

This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.

The following cases are handled: {univariate polynomial rings, multivariate polynomial rings, quotients of univariate polynomial rings} over the same base.

We also speed up evaluation at monomials in another polynomial ring in a similar way.

Branch/Commit: [9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)

Reviewer: Marc Mezzarobba, Travis Scrimshaw

Author: Lorenz Panny, Marc Mezzarobba, Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33165





---

archive/issue_comments_661761.json:
```json
{
    "body": "Branch: [public/33165](https://github.com/sagemath/sagetrac-mirror/tree/public/33165)",
    "created_at": "2022-01-14T05:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661761",
    "user": "https://github.com/yyyyx4"
}
```

Branch: [public/33165](https://github.com/sagemath/sagetrac-mirror/tree/public/33165)



---

archive/issue_comments_661762.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,4 @@\n 2.97 ms \u00b1 185 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n ```\n \n-We should probably add an optimized code path for evaluation at quotient-ring elements.\n+This patch adds an optimized code path for evaluation at generators of a quotient of the polynomial's parent ring.\n``````\n",
    "created_at": "2022-01-14T05:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661762",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,4 @@
 2.97 ms ± 185 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
 ```
 
-We should probably add an optimized code path for evaluation at quotient-ring elements.
+This patch adds an optimized code path for evaluation at generators of a quotient of the polynomial's parent ring.
``````




---

archive/issue_comments_661763.json:
```json
{
    "body": "Author: Lorenz Panny",
    "created_at": "2022-01-14T05:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661763",
    "user": "https://github.com/yyyyx4"
}
```

Author: Lorenz Panny



---

archive/issue_comments_661764.json:
```json
{
    "body": "Commit: [fa12ea48c43b85d8bb4b634023028315d6333727](https://github.com/sagemath/sagetrac-mirror/commit/fa12ea48c43b85d8bb4b634023028315d6333727)",
    "created_at": "2022-01-14T05:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661764",
    "user": "https://github.com/yyyyx4"
}
```

Commit: [fa12ea48c43b85d8bb4b634023028315d6333727](https://github.com/sagemath/sagetrac-mirror/commit/fa12ea48c43b85d8bb4b634023028315d6333727)



---

archive/issue_comments_661765.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-14T05:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661765",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_661766.json:
```json
{
    "body": "<a id='comment:1'></a>\nWith the patch, `g(y)` is now just as fast as `S(g)`.\n\n---\nNew commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[fa12ea4](https://github.com/sagemath/sagetrac-mirror/commit/fa12ea48c43b85d8bb4b634023028315d6333727)|`fast path for evaluating g in R[x] at x + R[x]/(f)`|",
    "created_at": "2022-01-14T05:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661766",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:1'></a>
With the patch, `g(y)` is now just as fast as `S(g)`.

---
New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[fa12ea4](https://github.com/sagemath/sagetrac-mirror/commit/fa12ea48c43b85d8bb4b634023028315d6333727)|`fast path for evaluating g in R[x] at x + R[x]/(f)`|



---

archive/issue_comments_661767.json:
```json
{
    "body": "Changing commit from \"[fa12ea48c43b85d8bb4b634023028315d6333727](https://github.com/sagemath/sagetrac-mirror/commit/fa12ea48c43b85d8bb4b634023028315d6333727)\" to \"[ba70984be03a19408f075ce453ebb917ad46b5b5](https://github.com/sagemath/sagetrac-mirror/commit/ba70984be03a19408f075ce453ebb917ad46b5b5)\"",
    "created_at": "2022-01-14T05:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661767",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[fa12ea48c43b85d8bb4b634023028315d6333727](https://github.com/sagemath/sagetrac-mirror/commit/fa12ea48c43b85d8bb4b634023028315d6333727)" to "[ba70984be03a19408f075ce453ebb917ad46b5b5](https://github.com/sagemath/sagetrac-mirror/commit/ba70984be03a19408f075ce453ebb917ad46b5b5)"



---

archive/issue_comments_661768.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[ba70984](https://github.com/sagemath/sagetrac-mirror/commit/ba70984be03a19408f075ce453ebb917ad46b5b5)|`fast path for evaluating g in R[x] at x + R[x]/(f)`|",
    "created_at": "2022-01-14T05:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661768",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[ba70984](https://github.com/sagemath/sagetrac-mirror/commit/ba70984be03a19408f075ce453ebb917ad46b5b5)|`fast path for evaluating g in R[x] at x + R[x]/(f)`|



---

archive/issue_comments_661769.json:
```json
{
    "body": "Changing commit from \"[ba70984be03a19408f075ce453ebb917ad46b5b5](https://github.com/sagemath/sagetrac-mirror/commit/ba70984be03a19408f075ce453ebb917ad46b5b5)\" to \"[9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6](https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6)\"",
    "created_at": "2022-01-14T06:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661769",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[ba70984be03a19408f075ce453ebb917ad46b5b5](https://github.com/sagemath/sagetrac-mirror/commit/ba70984be03a19408f075ce453ebb917ad46b5b5)" to "[9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6](https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6)"



---

archive/issue_comments_661770.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[9cd6d4a](https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6)|`fast path for evaluating g in R[x] at x+(f) in R[x]/(f)`|",
    "created_at": "2022-01-14T06:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661770",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[9cd6d4a](https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6)|`fast path for evaluating g in R[x] at x+(f) in R[x]/(f)`|



---

archive/issue_comments_661771.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-01-14T08:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661771",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_661772.json:
```json
{
    "body": "Changing commit from \"[9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6](https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6)\" to \"[45bd205b4c7c788eee3c3c51e2121a3f5213d52f](https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f)\"",
    "created_at": "2022-01-14T14:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661772",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6](https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6)" to "[45bd205b4c7c788eee3c3c51e2121a3f5213d52f](https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f)"



---

archive/issue_comments_661773.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[45bd205](https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f)|`fast path for evaluating g in R[x] at y in R[y]`|",
    "created_at": "2022-01-14T14:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661773",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[45bd205](https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f)|`fast path for evaluating g in R[x] at y in R[y]`|



---

archive/issue_events_098577.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "rename": {
        "from": "evaluating polynomials in R[x] at elements of R[x]/(f) is really slow",
        "to": "faster evaluation of polynomials in R[x] at generators of R[y] or R[x]/(f)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33165#event-98577"
}
```



---

archive/issue_comments_661774.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,4 @@\n 2.97 ms \u00b1 185 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n ```\n \n-This patch adds an optimized code path for evaluation at generators of a quotient of the polynomial's parent ring.\n+This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.\n``````\n",
    "created_at": "2022-01-14T14:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661774",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,4 @@
 2.97 ms ± 185 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
 ```
 
-This patch adds an optimized code path for evaluation at generators of a quotient of the polynomial's parent ring.
+This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.
``````




---

archive/issue_comments_661775.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-01-14T14:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661775",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_661776.json:
```json
{
    "body": "Changing commit from \"[45bd205b4c7c788eee3c3c51e2121a3f5213d52f](https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f)\" to \"[5394858bb285191bfd3669e36ddd20b792bc4c9c](https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c)\"",
    "created_at": "2022-01-14T16:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[45bd205b4c7c788eee3c3c51e2121a3f5213d52f](https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f)" to "[5394858bb285191bfd3669e36ddd20b792bc4c9c](https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c)"



---

archive/issue_comments_661777.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[5394858](https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c)|`fast path for evaluating g in R[x] at u or v in R[u,v]`|",
    "created_at": "2022-01-14T16:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661777",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[5394858](https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c)|`fast path for evaluating g in R[x] at u or v in R[u,v]`|



---

archive/issue_comments_661778.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,5 @@\n ```\n \n This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.\n+\n+The following cases are handled: {univariate polynomial rings, multivariate polynomial rings, quotients of univariate polynomial rings} over the same base.\n``````\n",
    "created_at": "2022-01-14T16:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661778",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,5 @@
 ```
 
 This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.
+
+The following cases are handled: {univariate polynomial rings, multivariate polynomial rings, quotients of univariate polynomial rings} over the same base.
``````




---

archive/issue_events_098578.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "rename": {
        "from": "faster evaluation of polynomials in R[x] at generators of R[y] or R[x]/(f)",
        "to": "faster evaluation of polynomials in R[x] at generators of R[y] or R[u,v] or R[x]/(f)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33165#event-98578"
}
```



---

archive/issue_comments_661779.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[89327e5](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)|`#33165 limit slowdown for eval at elts of the base ring`|",
    "created_at": "2022-02-12T12:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[89327e5](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)|`#33165 limit slowdown for eval at elts of the base ring`|



---

archive/issue_comments_661780.json:
```json
{
    "body": "Changing commit from \"[5394858bb285191bfd3669e36ddd20b792bc4c9c](https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c)\" to \"[89327e56e2f7773b704c7f4f2d582d4b4f40de13](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)\"",
    "created_at": "2022-02-12T12:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661780",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[5394858bb285191bfd3669e36ddd20b792bc4c9c](https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c)" to "[89327e56e2f7773b704c7f4f2d582d4b4f40de13](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)"



---

archive/issue_comments_661781.json:
```json
{
    "body": "<a id='comment:10'></a>\nWhy not do it like this instead?\n\n|                                                                                                                                           |                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[89327e5](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)|`#33165 limit slowdown for eval at elts of the base ring`|\n\nThis avoids slowing down the case of evaluations at elements of the base ring as much, and extends your speed-up to evaluations using keyword syntax.",
    "created_at": "2022-02-12T12:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661781",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:10'></a>
Why not do it like this instead?

|                                                                                                                                           |                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[89327e5](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)|`#33165 limit slowdown for eval at elts of the base ring`|

This avoids slowing down the case of evaluations at elements of the base ring as much, and extends your speed-up to evaluations using keyword syntax.



---

archive/issue_comments_661782.json:
```json
{
    "body": "<a id='comment:11'></a>\nA few comments since you want to optimize this:\n\n- Instead of `is_MPolynomialRing(parent(a))` why not test `isinstance(a, MPolynomial)`. This should be faster.\n- Use `(<Element> a)._parent` as it is faster. If you don't want to break encapsulation, use `parent(a)` since it is a Cython function instead of a Python method IIRC.\n- It might be good to tweak `change_variable_name` to take advantage of this codepath.",
    "created_at": "2022-02-14T03:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661782",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>
A few comments since you want to optimize this:

- Instead of `is_MPolynomialRing(parent(a))` why not test `isinstance(a, MPolynomial)`. This should be faster.
- Use `(<Element> a)._parent` as it is faster. If you don't want to break encapsulation, use `parent(a)` since it is a Cython function instead of a Python method IIRC.
- It might be good to tweak `change_variable_name` to take advantage of this codepath.



---

archive/issue_comments_661783.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[eaf0ba3](https://github.com/sagemath/sagetrac-mirror/commit/eaf0ba3b9bf8f990334346ea57517bb94ea76b76)|`Merge tag '9.6.beta1' into public/33165`|\n|[fcd2dc9](https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a)|`some optimizations from reviewer`|",
    "created_at": "2022-02-14T12:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[eaf0ba3](https://github.com/sagemath/sagetrac-mirror/commit/eaf0ba3b9bf8f990334346ea57517bb94ea76b76)|`Merge tag '9.6.beta1' into public/33165`|
|[fcd2dc9](https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a)|`some optimizations from reviewer`|



---

archive/issue_comments_661784.json:
```json
{
    "body": "Changing commit from \"[89327e56e2f7773b704c7f4f2d582d4b4f40de13](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)\" to \"[fcd2dc931a60dd81c363bf678aa4ec4858be8d7a](https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a)\"",
    "created_at": "2022-02-14T12:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[89327e56e2f7773b704c7f4f2d582d4b4f40de13](https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13)" to "[fcd2dc931a60dd81c363bf678aa4ec4858be8d7a](https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a)"



---

archive/issue_comments_661785.json:
```json
{
    "body": "<a id='comment:13'></a>\nThanks for the suggestions! It's indeed a little bit faster with these changes.",
    "created_at": "2022-02-14T12:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661785",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:13'></a>
Thanks for the suggestions! It's indeed a little bit faster with these changes.



---

archive/issue_comments_661786.json:
```json
{
    "body": "<a id='comment:14'></a>\nPerhaps it would also be good to handle the cases when the input is a monomial? You might be better off using the `ETuple` for the multi polynomial case. At least the monomial input for that would be essentially the same as what you currently have. The univariate  case would take a bit more work.",
    "created_at": "2022-02-14T14:21:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661786",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Perhaps it would also be good to handle the cases when the input is a monomial? You might be better off using the `ETuple` for the multi polynomial case. At least the monomial input for that would be essentially the same as what you currently have. The univariate  case would take a bit more work.



---

archive/issue_comments_661787.json:
```json
{
    "body": "Changing commit from \"[fcd2dc931a60dd81c363bf678aa4ec4858be8d7a](https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a)\" to \"[54fa9e2a5723ea612bce176fa2b5e1728dee2586](https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586)\"",
    "created_at": "2022-02-15T04:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661787",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[fcd2dc931a60dd81c363bf678aa4ec4858be8d7a](https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a)" to "[54fa9e2a5723ea612bce176fa2b5e1728dee2586](https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586)"



---

archive/issue_comments_661788.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[54fa9e2](https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586)|`extend speedup to monomials (not just variables)`|",
    "created_at": "2022-02-15T04:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[54fa9e2](https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586)|`extend speedup to monomials (not just variables)`|



---

archive/issue_comments_661789.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [tscrim](#comment%3A14):\n> Perhaps it would also be good to handle the cases when the input is a monomial?\n\n\nLike this?\n\n(I didn't adapt the code for monomials in quotient rings because it's not totally obvious when it is worth it to do so.)",
    "created_at": "2022-02-15T04:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661789",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:16'></a>
Replying to [tscrim](#comment%3A14):
> Perhaps it would also be good to handle the cases when the input is a monomial?


Like this?

(I didn't adapt the code for monomials in quotient rings because it's not totally obvious when it is worth it to do so.)



---

archive/issue_comments_661790.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,3 +16,5 @@\n This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.\n \n The following cases are handled: {univariate polynomial rings, multivariate polynomial rings, quotients of univariate polynomial rings} over the same base.\n+\n+We also speed up evaluation at monomials in another polynomial ring in a similar way.\n``````\n",
    "created_at": "2022-02-15T04:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661790",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,3 +16,5 @@
 This patch adds an optimized code path for evaluation at generators of (quotients of) polynomial rings isomorphic to the polynomial's parent. With the new code, `g(y)` is about as fast as `S(g)`.
 
 The following cases are handled: {univariate polynomial rings, multivariate polynomial rings, quotients of univariate polynomial rings} over the same base.
+
+We also speed up evaluation at monomials in another polynomial ring in a similar way.
``````




---

archive/issue_events_098579.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "rename": {
        "from": "faster evaluation of polynomials in R[x] at generators of R[y] or R[u,v] or R[x]/(f)",
        "to": "faster evaluation of polynomials in R[x] at monomials in R[y] or R[u,v] and variables in R[x]/(f)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33165#event-98579"
}
```



---

archive/issue_comments_661791.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|\n|[1645418](https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee)|`Some further micro-optimizations and sparse versions to polynomial call.`|",
    "created_at": "2022-02-15T08:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
|[1645418](https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee)|`Some further micro-optimizations and sparse versions to polynomial call.`|



---

archive/issue_comments_661792.json:
```json
{
    "body": "Changing commit from \"[54fa9e2a5723ea612bce176fa2b5e1728dee2586](https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586)\" to \"[1645418738975d45f80b26a4de41cb798c302dee](https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee)\"",
    "created_at": "2022-02-15T08:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[54fa9e2a5723ea612bce176fa2b5e1728dee2586](https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586)" to "[1645418738975d45f80b26a4de41cb798c302dee](https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee)"



---

archive/issue_comments_661793.json:
```json
{
    "body": "<a id='comment:18'></a>\nYes, thank you. I have also made some additional tweaks to try and get more speed out. Most notable:\n\n- I made sure the handle the dense and sparse cases separately.\n- `0` and constants are handled as further special cases.\n- Not everything that is `x` is true as `is_gen()`:\n  {{{\nsage: R.<x> = QQ[]\nsage: R([0,1]).is_gen()\nFalse\n  }}}\n  So I now cover this case.\n\nWith my changes, I get just a little tiny bit more (at least it is no worse):\n\n```\nsage: R.<x> = GF(31337)[]\nsage: g = R(list(range(1,1001)))\nsage: U.<t,u,v> = GF(31337)[]\nsage: %timeit g(u)\n1.86 ms \u00b1 10.2 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)git\n```\nversus your branch\n\n```\nsage: %timeit g(u)\n1.88 ms \u00b1 35.7 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n```\nI didn't run timing tests extensively, but where I did test, I saw at least a little speedup.",
    "created_at": "2022-02-15T09:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661793",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
Yes, thank you. I have also made some additional tweaks to try and get more speed out. Most notable:

- I made sure the handle the dense and sparse cases separately.
- `0` and constants are handled as further special cases.
- Not everything that is `x` is true as `is_gen()`:
  {{{
sage: R.<x> = QQ[]
sage: R([0,1]).is_gen()
False
  }}}
  So I now cover this case.

With my changes, I get just a little tiny bit more (at least it is no worse):

```
sage: R.<x> = GF(31337)[]
sage: g = R(list(range(1,1001)))
sage: U.<t,u,v> = GF(31337)[]
sage: %timeit g(u)
1.86 ms ± 10.2 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)git
```
versus your branch

```
sage: %timeit g(u)
1.88 ms ± 35.7 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
```
I didn't run timing tests extensively, but where I did test, I saw at least a little speedup.



---

archive/issue_comments_661794.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[3b9e83a](https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982)|`Better handling of constants/monomials.`|",
    "created_at": "2022-02-15T09:12:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[3b9e83a](https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982)|`Better handling of constants/monomials.`|



---

archive/issue_comments_661795.json:
```json
{
    "body": "Changing commit from \"[1645418738975d45f80b26a4de41cb798c302dee](https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee)\" to \"[3b9e83a0c61f50696c75e25e6555a7c4860f0982](https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982)\"",
    "created_at": "2022-02-15T09:12:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[1645418738975d45f80b26a4de41cb798c302dee](https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee)" to "[3b9e83a0c61f50696c75e25e6555a7c4860f0982](https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982)"



---

archive/issue_comments_661796.json:
```json
{
    "body": "<a id='comment:20'></a>\nI am not sure about this change:\n\n```\n         R = parent(a)\n \n-        if parent(cst) is not R:\n-\n+        if R is not self._parent._base:\n```\nShouldn't it be `pol._parent._base` instead of `self._parent._base`?\n\nApart from that, lgtm! (But someone else should have a look since I contributed to the code.)",
    "created_at": "2022-02-17T10:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661796",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:20'></a>
I am not sure about this change:

```
         R = parent(a)
 
-        if parent(cst) is not R:
-
+        if R is not self._parent._base:
```
Shouldn't it be `pol._parent._base` instead of `self._parent._base`?

Apart from that, lgtm! (But someone else should have a look since I contributed to the code.)



---

archive/issue_comments_661797.json:
```json
{
    "body": "Reviewer: Marc Mezzarobba",
    "created_at": "2022-02-17T10:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661797",
    "user": "https://github.com/mezzarobba"
}
```

Reviewer: Marc Mezzarobba



---

archive/issue_comments_661798.json:
```json
{
    "body": "Changing author from \"Lorenz Panny\" to \"Lorenz Panny, Marc Mezzarobba, Travis Scrimshaw\"",
    "created_at": "2022-02-17T10:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661798",
    "user": "https://github.com/mezzarobba"
}
```

Changing author from "Lorenz Panny" to "Lorenz Panny, Marc Mezzarobba, Travis Scrimshaw"



---

archive/issue_comments_661799.json:
```json
{
    "body": "Changing reviewer from \"Marc Mezzarobba\" to \"Marc Mezzarobba, Travis Scrimshaw\"",
    "created_at": "2022-02-17T11:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661799",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "Marc Mezzarobba" to "Marc Mezzarobba, Travis Scrimshaw"



---

archive/issue_comments_661800.json:
```json
{
    "body": "<a id='comment:21'></a>\nSince everything else in that code is working with `pol`, I think we should check that base ring. Although from what I understand of the code above, it should be the same base ring as `self`.\n\nI have also checked your code, so if you are okay with mine, then we can set a positive review.",
    "created_at": "2022-02-17T11:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661800",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
Since everything else in that code is working with `pol`, I think we should check that base ring. Although from what I understand of the code above, it should be the same base ring as `self`.

I have also checked your code, so if you are okay with mine, then we can set a positive review.



---

archive/issue_comments_661801.json:
```json
{
    "body": "<a id='comment:22'></a>\nActually, you\u2019re right, it should check `pol._parent._base`. If you could make this change, then you can set a positive review on my behalf (assuming you have given a positive review to my changes).\n\nIt would be nice to add a test for this, but I think the code is sufficient robust with the coercion framework to make testing for this difficult. We would have do something with incompatible objects after mapping coefficients. If you can think of a simple test, please add it. Otherwise, we can just let it be since we have looked at the code\u2019s logic.",
    "created_at": "2022-02-17T11:31:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661801",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>
Actually, you’re right, it should check `pol._parent._base`. If you could make this change, then you can set a positive review on my behalf (assuming you have given a positive review to my changes).

It would be nice to add a test for this, but I think the code is sufficient robust with the coercion framework to make testing for this difficult. We would have do something with incompatible objects after mapping coefficients. If you can think of a simple test, please add it. Otherwise, we can just let it be since we have looked at the code’s logic.



---

archive/issue_comments_661802.json:
```json
{
    "body": "Changing commit from \"[3b9e83a0c61f50696c75e25e6555a7c4860f0982](https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982)\" to \"[c0e462eff5e84af394d79ac438f59121ed95be56](https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56)\"",
    "created_at": "2022-02-17T11:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[3b9e83a0c61f50696c75e25e6555a7c4860f0982](https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982)" to "[c0e462eff5e84af394d79ac438f59121ed95be56](https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56)"



---

archive/issue_comments_661803.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------|\n|[c0e462e](https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56)|`#33165 minor fix`|",
    "created_at": "2022-02-17T11:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------|
|[c0e462e](https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56)|`#33165 minor fix`|



---

archive/issue_comments_661804.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-17T20:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661804",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_661805.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-02-21T00:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661805",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_661806.json:
```json
{
    "body": "<a id='comment:25'></a>\nOn 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/rings/polynomial/polynomial_element.pyx\", line 736, in sage.rings.polynomial.polynomial_element.Polynomial.__call__\nFailed example:\n    f(y^1000)\nExpected:\n    y^10000000000 + 1\nGot:\n    y^1410065408 + 1\n**********************************************************************\n```",
    "created_at": "2022-02-21T00:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661806",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>
On 32-bit:

```
**********************************************************************
File "src/sage/rings/polynomial/polynomial_element.pyx", line 736, in sage.rings.polynomial.polynomial_element.Polynomial.__call__
Failed example:
    f(y^1000)
Expected:
    y^10000000000 + 1
Got:
    y^1410065408 + 1
**********************************************************************
```



---

archive/issue_comments_661807.json:
```json
{
    "body": "Changing commit from \"[c0e462eff5e84af394d79ac438f59121ed95be56](https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56)\" to \"[9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)\"",
    "created_at": "2022-02-21T04:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[c0e462eff5e84af394d79ac438f59121ed95be56](https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56)" to "[9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)"



---

archive/issue_comments_661808.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[9a6e4b2](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)|`Smaller degree on sparse test to prevent overflow.`|",
    "created_at": "2022-02-21T04:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661808",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[9a6e4b2](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)|`Smaller degree on sparse test to prevent overflow.`|



---

archive/issue_comments_661809.json:
```json
{
    "body": "<a id='comment:27'></a>\nTrivial change of decreasing the degree so that there is no overflow on 32-bit.",
    "created_at": "2022-02-21T04:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661809",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>
Trivial change of decreasing the degree so that there is no overflow on 32-bit.



---

archive/issue_comments_661810.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-02-21T04:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661810",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_661811.json:
```json
{
    "body": "Changing branch from \"[public/33165](https://github.com/sagemath/sagetrac-mirror/tree/public/33165)\" to \"[9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)\"",
    "created_at": "2022-02-27T22:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661811",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[public/33165](https://github.com/sagemath/sagetrac-mirror/tree/public/33165)" to "[9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f](https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f)"



---

archive/issue_events_098580.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-27T22:00:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33165#event-98580"
}
```



---

archive/issue_comments_661812.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-27T22:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33165",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33165#issuecomment-661812",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
