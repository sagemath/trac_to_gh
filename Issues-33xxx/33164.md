# Issue 33164: fix & refactor caching in EllipticCurve_generic.division_polynomial()

archive/issues_032927.json:
```json
{
    "assignees": [],
    "body": "This was discovered while digging for the underlying reason behind #33156:\n\n```\nsage: E = EllipticCurve('11a3')\nsage: R.<X> = QQ[]\nsage: S.<Y> = R.quotient(X^2)\nsage: E.division_polynomial(5, x=Y)\n-5*Y\nsage: E.division_polynomial(5, x=X)\n-5*Y\n```\nThe problem is that `Y == X`, which makes the method return an incorrect result from its cache.\n\nIn this patch, we streamline caching in three major ways:\n- Only cache the *generic* division polynomials, rather than evaluations at all inputs. (Currently all input-output pairs are stored, and this is both a source of errors\u2009\u2014\u2009as above\u2009\u2014\u2009and a source of memory leaks.)\n- Share the caches of `.division_polynomial_0()` and `.division_polynomial()`. This makes later calls to `.division_polynomial()` (with `x==None`) faster and faster as the cache is populated with more intermediate nodes appearing in the recursive formula for division polynomials.\n- In a similar vein, we make opportunistic use of already computed division polynomials, for instance when evaluating at base-field elements (and the degree is small enough for this to be beneficial), or when computing another division polynomial with a different two-torsion multiplicity.\n\n\nDepends on #33165\n\nCC:  @defeo @JohnCremona\n\nBranch/Commit: **[`0aaec67`](https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Lorenz Panny**\n\nComponent: **elliptic curves**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33164_\n\n",
    "closed_at": "2022-03-12T15:11:11Z",
    "created_at": "2022-01-14T03:09:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix & refactor caching in EllipticCurve_generic.division_polynomial()",
    "type": "issue",
    "updated_at": "2022-03-12T15:11:11Z",
    "url": "https://github.com/sagemath/sage/issues/33164",
    "user": "https://github.com/yyyyx4"
}
```
This was discovered while digging for the underlying reason behind #33156:

```
sage: E = EllipticCurve('11a3')
sage: R.<X> = QQ[]
sage: S.<Y> = R.quotient(X^2)
sage: E.division_polynomial(5, x=Y)
-5*Y
sage: E.division_polynomial(5, x=X)
-5*Y
```
The problem is that `Y == X`, which makes the method return an incorrect result from its cache.

In this patch, we streamline caching in three major ways:
- Only cache the *generic* division polynomials, rather than evaluations at all inputs. (Currently all input-output pairs are stored, and this is both a source of errors — as above — and a source of memory leaks.)
- Share the caches of `.division_polynomial_0()` and `.division_polynomial()`. This makes later calls to `.division_polynomial()` (with `x==None`) faster and faster as the cache is populated with more intermediate nodes appearing in the recursive formula for division polynomials.
- In a similar vein, we make opportunistic use of already computed division polynomials, for instance when evaluating at base-field elements (and the degree is small enough for this to be beneficial), or when computing another division polynomial with a different two-torsion multiplicity.


Depends on #33165

CC:  @defeo @JohnCremona

Branch/Commit: **[`0aaec67`](https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56)**

Reviewer: **Travis Scrimshaw**

Author: **Lorenz Panny**

Component: **elliptic curves**

_Issue created by migration from https://trac.sagemath.org/ticket/33164_





---

archive/issue_events_453041.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-14T03:09:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453041"
}
```



---

archive/issue_events_453042.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-14T03:09:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453042"
}
```



---

archive/issue_events_453043.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-14T03:09:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453043"
}
```



---

archive/issue_events_453044.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-14T03:09:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453044"
}
```



---

archive/issue_comments_535963.json:
```json
{
    "body": "Author: **Lorenz Panny**",
    "created_at": "2022-01-17T06:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535963",
    "user": "https://github.com/yyyyx4"
}
```

Author: **Lorenz Panny**



---

archive/issue_comments_535964.json:
```json
{
    "body": "Branch: **[public/33164](https://github.com/sagemath/sagetrac-mirror/tree/public/33164)**",
    "created_at": "2022-01-17T06:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535964",
    "user": "https://github.com/yyyyx4"
}
```

Branch: **[public/33164](https://github.com/sagemath/sagetrac-mirror/tree/public/33164)**



---

archive/issue_events_453045.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-17T06:25:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453045"
}
```



---

archive/issue_events_453046.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-17T06:25:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453046"
}
```



---

archive/issue_comments_535965.json:
```json
{
    "body": "Commit: **[`f114657`](https://github.com/sagemath/sagetrac-mirror/commit/f114657662a6f56bd7ee3f474fee7d09c741a13a)**",
    "created_at": "2022-01-17T06:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535965",
    "user": "https://github.com/yyyyx4"
}
```

Commit: **[`f114657`](https://github.com/sagemath/sagetrac-mirror/commit/f114657662a6f56bd7ee3f474fee7d09c741a13a)**



---

archive/issue_events_453047.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-17T06:25:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "title_is": "fix & refactor caching in EllipticCurve_generic.division_polynomial()",
    "title_was": "fix broken caching in EllipticCurve_generic.division_polynomial()",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453047"
}
```



---

archive/issue_comments_535966.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,5 +9,10 @@\n sage: E.division_polynomial(5, x=X)\n -5*Y\n ```\n+The problem is that `Y == X`, which makes the method return an incorrect result from its cache.\n \n-To fix it, we should probably include `x.parent()` in the cache key.\n+In this patch, we streamline caching in three major ways:\n+- Only cache the *generic* division polynomials, rather than evaluations at all inputs. (Currently all input-output pairs are stored, and this is both a source of errors\u2009\u2014\u2009as above\u2009\u2014\u2009and a source of memory leaks.)\n+- Share the caches of `.division_polynomial_0()` and `.division_polynomial()`. This makes later calls to `.division_polynomial()` (with `x==None`) faster and faster as the cache is populated with more intermediate nodes appearing in the recursive formula for division polynomials.\n+- In a similar vein, we make opportunistic use of already computed division polynomials, for instance when evaluating at base-field elements (and the degree is small enough for this to be beneficial), or when computing another division polynomial with a different two-torsion multiplicity.\n+\n``````\n",
    "created_at": "2022-01-17T06:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535966",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,5 +9,10 @@
 sage: E.division_polynomial(5, x=X)
 -5*Y
 ```
+The problem is that `Y == X`, which makes the method return an incorrect result from its cache.
 
-To fix it, we should probably include `x.parent()` in the cache key.
+In this patch, we streamline caching in three major ways:
+- Only cache the *generic* division polynomials, rather than evaluations at all inputs. (Currently all input-output pairs are stored, and this is both a source of errors — as above — and a source of memory leaks.)
+- Share the caches of `.division_polynomial_0()` and `.division_polynomial()`. This makes later calls to `.division_polynomial()` (with `x==None`) faster and faster as the cache is populated with more intermediate nodes appearing in the recursive formula for division polynomials.
+- In a similar vein, we make opportunistic use of already computed division polynomials, for instance when evaluating at base-field elements (and the degree is small enough for this to be beneficial), or when computing another division polynomial with a different two-torsion multiplicity.
+
``````




---

archive/issue_events_453048.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-01-17T06:25:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453048"
}
```



---

archive/issue_comments_535967.json:
```json
{
    "body": "Dependencies: **public/33165**",
    "created_at": "2022-01-17T06:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535967",
    "user": "https://github.com/yyyyx4"
}
```

Dependencies: **public/33165**



---

archive/issue_comments_535968.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6\"><code>9cd6d4a</code></a></td><td><code>fast path for evaluating g in R[x] at x+(f) in R[x]/(f)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f\"><code>45bd205</code></a></td><td><code>fast path for evaluating g in R[x] at y in R[y]</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c\"><code>5394858</code></a></td><td><code>fast path for evaluating g in R[x] at u or v in R[u,v]</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f114657662a6f56bd7ee3f474fee7d09c741a13a\"><code>f114657</code></a></td><td><code>fix caching logic for .division_polynomial(), plus some optimizations</code></td></tr></table>\n",
    "created_at": "2022-01-17T06:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535968",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cd6d4aeef0942b20ecdab9556d9c89bd2ee4bc6"><code>9cd6d4a</code></a></td><td><code>fast path for evaluating g in R[x] at x+(f) in R[x]/(f)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45bd205b4c7c788eee3c3c51e2121a3f5213d52f"><code>45bd205</code></a></td><td><code>fast path for evaluating g in R[x] at y in R[y]</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5394858bb285191bfd3669e36ddd20b792bc4c9c"><code>5394858</code></a></td><td><code>fast path for evaluating g in R[x] at u or v in R[u,v]</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f114657662a6f56bd7ee3f474fee7d09c741a13a"><code>f114657</code></a></td><td><code>fix caching logic for .division_polynomial(), plus some optimizations</code></td></tr></table>




---

archive/issue_comments_535969.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe changes in `Polynomial.__call__` are from the dependency.",
    "created_at": "2022-01-17T06:26:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535969",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:2" align="right">comment:2</div>

The changes in `Polynomial.__call__` are from the dependency.



---

archive/issue_comments_535970.json:
```json
{
    "body": "Changed dependencies from **public/33165** to **#33165**",
    "created_at": "2022-01-17T06:26:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535970",
    "user": "https://github.com/yyyyx4"
}
```

Changed dependencies from **public/33165** to **#33165**



---

archive/issue_comments_535971.json:
```json
{
    "body": "Changed commit from **[`f114657`](https://github.com/sagemath/sagetrac-mirror/commit/f114657662a6f56bd7ee3f474fee7d09c741a13a)** to **[`ad9a380`](https://github.com/sagemath/sagetrac-mirror/commit/ad9a380b8070127d00b701d1593066e605115932)**",
    "created_at": "2022-02-18T03:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535971",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f114657`](https://github.com/sagemath/sagetrac-mirror/commit/f114657662a6f56bd7ee3f474fee7d09c741a13a)** to **[`ad9a380`](https://github.com/sagemath/sagetrac-mirror/commit/ad9a380b8070127d00b701d1593066e605115932)**



---

archive/issue_comments_535972.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2dc2d99878c0e0999f921e4ec7c81e18bce1a89\"><code>a2dc2d9</code></a></td><td><code>Merge tag '9.5' into public/33164</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13\"><code>89327e5</code></a></td><td><code>#33165 limit slowdown for eval at elts of the base ring</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eaf0ba3b9bf8f990334346ea57517bb94ea76b76\"><code>eaf0ba3</code></a></td><td><code>Merge tag '9.6.beta1' into public/33165</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a\"><code>fcd2dc9</code></a></td><td><code>some optimizations from reviewer</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586\"><code>54fa9e2</code></a></td><td><code>extend speedup to monomials (not just variables)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e175b3bc2895ea2db49476097f4904d9e57b1cf6\"><code>e175b3b</code></a></td><td><code>Merge branch 'public/33165' into public/33164</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad9a380b8070127d00b701d1593066e605115932\"><code>ad9a380</code></a></td><td><code>Polynomial.is_gen() fails to recognize things like R([0,1]); cf. #33165</code></td></tr></table>\n",
    "created_at": "2022-02-18T03:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535972",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2dc2d99878c0e0999f921e4ec7c81e18bce1a89"><code>a2dc2d9</code></a></td><td><code>Merge tag '9.5' into public/33164</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89327e56e2f7773b704c7f4f2d582d4b4f40de13"><code>89327e5</code></a></td><td><code>#33165 limit slowdown for eval at elts of the base ring</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eaf0ba3b9bf8f990334346ea57517bb94ea76b76"><code>eaf0ba3</code></a></td><td><code>Merge tag '9.6.beta1' into public/33165</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcd2dc931a60dd81c363bf678aa4ec4858be8d7a"><code>fcd2dc9</code></a></td><td><code>some optimizations from reviewer</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54fa9e2a5723ea612bce176fa2b5e1728dee2586"><code>54fa9e2</code></a></td><td><code>extend speedup to monomials (not just variables)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e175b3bc2895ea2db49476097f4904d9e57b1cf6"><code>e175b3b</code></a></td><td><code>Merge branch 'public/33165' into public/33164</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad9a380b8070127d00b701d1593066e605115932"><code>ad9a380</code></a></td><td><code>Polynomial.is_gen() fails to recognize things like R([0,1]); cf. #33165</code></td></tr></table>




---

archive/issue_comments_535973.json:
```json
{
    "body": "Changed commit from **[`ad9a380`](https://github.com/sagemath/sagetrac-mirror/commit/ad9a380b8070127d00b701d1593066e605115932)** to **[`950b07d`](https://github.com/sagemath/sagetrac-mirror/commit/950b07d2a3945f60d8519118901fe44d31aeca3a)**",
    "created_at": "2022-02-21T07:30:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535973",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ad9a380`](https://github.com/sagemath/sagetrac-mirror/commit/ad9a380b8070127d00b701d1593066e605115932)** to **[`950b07d`](https://github.com/sagemath/sagetrac-mirror/commit/950b07d2a3945f60d8519118901fe44d31aeca3a)**



---

archive/issue_comments_535974.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee\"><code>1645418</code></a></td><td><code>Some further micro-optimizations and sparse versions to polynomial call.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982\"><code>3b9e83a</code></a></td><td><code>Better handling of constants/monomials.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56\"><code>c0e462e</code></a></td><td><code>#33165 minor fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f\"><code>9a6e4b2</code></a></td><td><code>Smaller degree on sparse test to prevent overflow.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/950b07d2a3945f60d8519118901fe44d31aeca3a\"><code>950b07d</code></a></td><td><code>Merge branch 'public/33165' into public/33164</code></td></tr></table>\n",
    "created_at": "2022-02-21T07:30:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535974",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1645418738975d45f80b26a4de41cb798c302dee"><code>1645418</code></a></td><td><code>Some further micro-optimizations and sparse versions to polynomial call.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b9e83a0c61f50696c75e25e6555a7c4860f0982"><code>3b9e83a</code></a></td><td><code>Better handling of constants/monomials.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0e462eff5e84af394d79ac438f59121ed95be56"><code>c0e462e</code></a></td><td><code>#33165 minor fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a6e4b258cf9ef597dcf61d44da28b49ec8e8b9f"><code>9a6e4b2</code></a></td><td><code>Smaller degree on sparse test to prevent overflow.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/950b07d2a3945f60d8519118901fe44d31aeca3a"><code>950b07d</code></a></td><td><code>Merge branch 'public/33165' into public/33164</code></td></tr></table>




---

archive/issue_comments_535975.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2feafab33e2ff8ee2c7c3b2276d5069edd9b2624\"><code>2feafab</code></a></td><td><code>Merge tag '9.6.beta2' into public/33164</code></td></tr></table>\n",
    "created_at": "2022-02-21T07:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535975",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2feafab33e2ff8ee2c7c3b2276d5069edd9b2624"><code>2feafab</code></a></td><td><code>Merge tag '9.6.beta2' into public/33164</code></td></tr></table>




---

archive/issue_comments_535976.json:
```json
{
    "body": "Changed commit from **[`950b07d`](https://github.com/sagemath/sagetrac-mirror/commit/950b07d2a3945f60d8519118901fe44d31aeca3a)** to **[`2feafab`](https://github.com/sagemath/sagetrac-mirror/commit/2feafab33e2ff8ee2c7c3b2276d5069edd9b2624)**",
    "created_at": "2022-02-21T07:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535976",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`950b07d`](https://github.com/sagemath/sagetrac-mirror/commit/950b07d2a3945f60d8519118901fe44d31aeca3a)** to **[`2feafab`](https://github.com/sagemath/sagetrac-mirror/commit/2feafab33e2ff8ee2c7c3b2276d5069edd9b2624)**



---

archive/issue_comments_535977.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAs I mentioned on #33165, `is_gen()` is not a catchall for things constructed more generally. So a more comprehensive test should be done if that fails for `polynomial_is_variable()`.\n\nFor the caching in the `x is not None` case, it might be better to have an option to compute in the generic cache and then specialize the parameter (say, you are using just a monomial input). This could be useful to reduce the cache size and possibly use already cached results (including if you vary the input). I don't think this will add a lot of complexity to the code, but it gives the user more control over the cache and computation.",
    "created_at": "2022-02-27T10:22:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535977",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

As I mentioned on #33165, `is_gen()` is not a catchall for things constructed more generally. So a more comprehensive test should be done if that fails for `polynomial_is_variable()`.

For the caching in the `x is not None` case, it might be better to have an option to compute in the generic cache and then specialize the parameter (say, you are using just a monomial input). This could be useful to reduce the cache size and possibly use already cached results (including if you vary the input). I don't think this will add a lot of complexity to the code, but it gives the user more control over the cache and computation.



---

archive/issue_comments_535978.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThank you for looking at this.\n\nReplying to [@tscrim](#comment%3A7):\n> As I mentioned on #33165, `is_gen()` is not a catchall for things constructed more generally. So a more comprehensive test should be done if that fails for `polynomial_is_variable()`.\n\nDoesn't commit `ad9a380b80` (added after you pointed out the issue in #33165) take care of this?\n\nReplying to [@tscrim](#comment%3A7):\n> For the caching in the `x is not None` case, it might be better to have an option to compute in the generic cache and then specialize the parameter (say, you are using just a monomial input). This could be useful to reduce the cache size and possibly use already cached results (including if you vary the input). I don't think this will add a lot of complexity to the code, but it gives the user more control over the cache and computation.\n\nSo, if I understand this correctly, you'd like a keyword argument to override the (existing) `evaluate` flag?",
    "created_at": "2022-03-01T08:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535978",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:8" align="right">comment:8</div>

Thank you for looking at this.

Replying to [@tscrim](#comment%3A7):
> As I mentioned on #33165, `is_gen()` is not a catchall for things constructed more generally. So a more comprehensive test should be done if that fails for `polynomial_is_variable()`.

Doesn't commit `ad9a380b80` (added after you pointed out the issue in #33165) take care of this?

Replying to [@tscrim](#comment%3A7):
> For the caching in the `x is not None` case, it might be better to have an option to compute in the generic cache and then specialize the parameter (say, you are using just a monomial input). This could be useful to reduce the cache size and possibly use already cached results (including if you vary the input). I don't think this will add a lot of complexity to the code, but it gives the user more control over the cache and computation.

So, if I understand this correctly, you'd like a keyword argument to override the (existing) `evaluate` flag?



---

archive/issue_comments_535979.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@yyyyx4](#comment%3A8):\n> Thank you for looking at this.\n> \n> Replying to [@tscrim](#comment%3A7):\n> > As I mentioned on #33165, `is_gen()` is not a catchall for things constructed more generally. So a more comprehensive test should be done if that fails for `polynomial_is_variable()`.\n\n> \n> Doesn't commit `ad9a380b80` (added after you pointed out the issue in #33165) take care of this?\n\nYes, sorry, I missed that commit.\n\n> Replying to [@tscrim](#comment%3A7):\n> > For the caching in the `x is not None` case, it might be better to have an option to compute in the generic cache and then specialize the parameter (say, you are using just a monomial input). This could be useful to reduce the cache size and possibly use already cached results (including if you vary the input). I don't think this will add a lot of complexity to the code, but it gives the user more control over the cache and computation.\n\n> \n> So, if I understand this correctly, you'd like a keyword argument to override the (existing) `evaluate` flag?\n\nYes, that is correct. At least, I could see a few situations where this could be useful for just a few simple lines of code.",
    "created_at": "2022-03-01T08:56:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535979",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@yyyyx4](#comment%3A8):
> Thank you for looking at this.
> 
> Replying to [@tscrim](#comment%3A7):
> > As I mentioned on #33165, `is_gen()` is not a catchall for things constructed more generally. So a more comprehensive test should be done if that fails for `polynomial_is_variable()`.

> 
> Doesn't commit `ad9a380b80` (added after you pointed out the issue in #33165) take care of this?

Yes, sorry, I missed that commit.

> Replying to [@tscrim](#comment%3A7):
> > For the caching in the `x is not None` case, it might be better to have an option to compute in the generic cache and then specialize the parameter (say, you are using just a monomial input). This could be useful to reduce the cache size and possibly use already cached results (including if you vary the input). I don't think this will add a lot of complexity to the code, but it gives the user more control over the cache and computation.

> 
> So, if I understand this correctly, you'd like a keyword argument to override the (existing) `evaluate` flag?

Yes, that is correct. At least, I could see a few situations where this could be useful for just a few simple lines of code.



---

archive/issue_comments_535980.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ff932b86db78d486cde0ade101bda03b35850cb\"><code>9ff932b</code></a></td><td><code>Merge tag '9.6.beta3' into public/33164</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99b2ddc19f9959e93ad9eb7e8125f1140e105d71\"><code>99b2ddc</code></a></td><td><code>add an optional argument to override the \"evaluate\" flag</code></td></tr></table>\n",
    "created_at": "2022-03-01T12:09:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535980",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ff932b86db78d486cde0ade101bda03b35850cb"><code>9ff932b</code></a></td><td><code>Merge tag '9.6.beta3' into public/33164</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99b2ddc19f9959e93ad9eb7e8125f1140e105d71"><code>99b2ddc</code></a></td><td><code>add an optional argument to override the "evaluate" flag</code></td></tr></table>




---

archive/issue_comments_535981.json:
```json
{
    "body": "Changed commit from **[`2feafab`](https://github.com/sagemath/sagetrac-mirror/commit/2feafab33e2ff8ee2c7c3b2276d5069edd9b2624)** to **[`99b2ddc`](https://github.com/sagemath/sagetrac-mirror/commit/99b2ddc19f9959e93ad9eb7e8125f1140e105d71)**",
    "created_at": "2022-03-01T12:09:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535981",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2feafab`](https://github.com/sagemath/sagetrac-mirror/commit/2feafab33e2ff8ee2c7c3b2276d5069edd9b2624)** to **[`99b2ddc`](https://github.com/sagemath/sagetrac-mirror/commit/99b2ddc19f9959e93ad9eb7e8125f1140e105d71)**



---

archive/issue_comments_535982.json:
```json
{
    "body": "Changed commit from **[`99b2ddc`](https://github.com/sagemath/sagetrac-mirror/commit/99b2ddc19f9959e93ad9eb7e8125f1140e105d71)** to **[`1bd0f0c`](https://github.com/sagemath/sagetrac-mirror/commit/1bd0f0c3f3a2fc74aba8d68a8293f700c67fd0d0)**",
    "created_at": "2022-03-01T12:12:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535982",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`99b2ddc`](https://github.com/sagemath/sagetrac-mirror/commit/99b2ddc19f9959e93ad9eb7e8125f1140e105d71)** to **[`1bd0f0c`](https://github.com/sagemath/sagetrac-mirror/commit/1bd0f0c3f3a2fc74aba8d68a8293f700c67fd0d0)**



---

archive/issue_comments_535983.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bd0f0c3f3a2fc74aba8d68a8293f700c67fd0d0\"><code>1bd0f0c</code></a></td><td><code>remove unused import</code></td></tr></table>\n",
    "created_at": "2022-03-01T12:12:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535983",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bd0f0c3f3a2fc74aba8d68a8293f700c67fd0d0"><code>1bd0f0c</code></a></td><td><code>remove unused import</code></td></tr></table>




---

archive/issue_comments_535984.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAlright, added an optional argument to override the default.",
    "created_at": "2022-03-01T12:13:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535984",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:12" align="right">comment:12</div>

Alright, added an optional argument to override the default.



---

archive/issue_comments_535985.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThank you. One last little detail. In `division_polynomial()`, have the docstring bullet points have the indentation as\n\n```\n- ``arg`` -- short description\n\n  A long description in a separate paragraph.\n\n- ``more`` -- another argument\n\n  Another long description paragraph.\n```\nRight now, your subsequent paragraphs are also indented, which may not be the desired effect.",
    "created_at": "2022-03-02T00:23:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535985",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Thank you. One last little detail. In `division_polynomial()`, have the docstring bullet points have the indentation as

```
- ``arg`` -- short description

  A long description in a separate paragraph.

- ``more`` -- another argument

  Another long description paragraph.
```
Right now, your subsequent paragraphs are also indented, which may not be the desired effect.



---

archive/issue_comments_535986.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAlso one pyflakes thing:\n\n```\nsrc/sage/schemes/elliptic_curves/ell_generic.py:62:1 'sage.misc.cachefunc.cached_function' imported but unused\n```\n\nHere's two more optional things:\n\nActually, it might make sense to `cpdef bint polynomial_is_variable()` with a (top-level) `cimport MPolynomial` (you don't need to worry about cyclic imports since it has a header file). Although this is a definite micro-optimization that might not be so useful.\n\nI might also change this\n\n```diff\n-        return x.is_gen() \\\n-                or (x.degree() == 1 and x[0].is_zero() and x[1].is_one())\n+        return (x.is_gen()\n+                or (x.degree() == 1 and x[0].is_zero() and x[1].is_one()))\n```",
    "created_at": "2022-03-02T00:28:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535986",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Also one pyflakes thing:

```
src/sage/schemes/elliptic_curves/ell_generic.py:62:1 'sage.misc.cachefunc.cached_function' imported but unused
```

Here's two more optional things:

Actually, it might make sense to `cpdef bint polynomial_is_variable()` with a (top-level) `cimport MPolynomial` (you don't need to worry about cyclic imports since it has a header file). Although this is a definite micro-optimization that might not be so useful.

I might also change this

```diff
-        return x.is_gen() \
-                or (x.degree() == 1 and x[0].is_zero() and x[1].is_one())
+        return (x.is_gen()
+                or (x.degree() == 1 and x[0].is_zero() and x[1].is_one()))
```



---

archive/issue_comments_535987.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd686472796f76a70b7262d3744cc8c9f2e58382\"><code>dd68647</code></a></td><td><code>fix doc formatting</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/485eb03457e1f3842cde8430092c5e132fc54a5e\"><code>485eb03</code></a></td><td><code>use parentheses instead of line continuation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b96b7d4c6f2c359fc365d16b3f5872caa2b9c4f1\"><code>b96b7d4</code></a></td><td><code>cythonize polynomial_is_variable()</code></td></tr></table>\n",
    "created_at": "2022-03-02T03:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535987",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd686472796f76a70b7262d3744cc8c9f2e58382"><code>dd68647</code></a></td><td><code>fix doc formatting</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/485eb03457e1f3842cde8430092c5e132fc54a5e"><code>485eb03</code></a></td><td><code>use parentheses instead of line continuation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b96b7d4c6f2c359fc365d16b3f5872caa2b9c4f1"><code>b96b7d4</code></a></td><td><code>cythonize polynomial_is_variable()</code></td></tr></table>




---

archive/issue_comments_535988.json:
```json
{
    "body": "Changed commit from **[`1bd0f0c`](https://github.com/sagemath/sagetrac-mirror/commit/1bd0f0c3f3a2fc74aba8d68a8293f700c67fd0d0)** to **[`b96b7d4`](https://github.com/sagemath/sagetrac-mirror/commit/b96b7d4c6f2c359fc365d16b3f5872caa2b9c4f1)**",
    "created_at": "2022-03-02T03:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535988",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1bd0f0c`](https://github.com/sagemath/sagetrac-mirror/commit/1bd0f0c3f3a2fc74aba8d68a8293f700c67fd0d0)** to **[`b96b7d4`](https://github.com/sagemath/sagetrac-mirror/commit/b96b7d4c6f2c359fc365d16b3f5872caa2b9c4f1)**



---

archive/issue_comments_535989.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThanks, all done.",
    "created_at": "2022-03-02T03:19:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535989",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:16" align="right">comment:16</div>

Thanks, all done.



---

archive/issue_comments_535990.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-03-02T03:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535990",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_535991.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThank you. Green bot => positive review.",
    "created_at": "2022-03-02T03:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535991",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

Thank you. Green bot => positive review.



---

archive/issue_events_453049.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-03-02T07:02:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453049"
}
```



---

archive/issue_events_453050.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-03-02T07:02:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453050"
}
```



---

archive/issue_comments_535992.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThank you!",
    "created_at": "2022-03-02T07:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535992",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:19" align="right">comment:19</div>

Thank you!



---

archive/issue_events_453051.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-03T23:13:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453051"
}
```



---

archive/issue_events_453052.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-03T23:13:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453052"
}
```



---

archive/issue_comments_535993.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nMerge failure on top of:\n\nc7adc6cc57 Trac #33112: some speedups in AdditiveAbelianGroupWrapper.discrete_log()\n\n8230df5b38 Trac #32770: Expose and access `tachyon` command line flags\n\n135c8e5bb1 Trac #31426: Apply flat shading when plotting 3d polyhedra with Three.js\n\n32e26f275f Trac #24536: find_local_maximum/minimum() fails with expressions containing complex numbers\n\nc0b15ffde0 Trac #33450: Improve vs code config\n\na76af34b81 Trac #33312: WeierstrassIsomorphism.degree() returns a Python int\n\n8368718592 Trac #33094: update URLs in SPKG.rst for ECL\n\n4f76f139db Trac #32922: Change parameter name\n\n44b5d43de7 Trac #32384: make some AdditiveAbelianGroupWrapper methods visible\n\n232f88fe88 Trac #32251: Fix doctest in the \"Y pentamino\" example from Donald Knuth\n\n6adf64eec4 Trac #30999: expose method hyperbolicity in graphs\n\n14e3e755d2 Trac #25787: Remove documentation configuration from micro_release\n\n87d5c62133 Trac #33414: Remove sage-open\n\nc254f33235 Trac #33413: Remove sage-native-execute\n\n6dcb3dc676 Trac #33412: Remove sage-update-src\n\naeb3fb2594 Trac #33411: include time for checking doctest output in '--warn-long'\n\nb20aeb7ee9 Trac #33322: Several ImageMagick tests need \"long time\"\n\ndb459d4eb3 Trac #33318: speed up is_prime() for very small integers\n\n0df0bad12f Trac #33308: Remove expired deprecations that use lazy_import(MODULE, \"*\")\n\n7c9535ef80 Trac #33292: mark invlex ordering as global\n\ne6d8672713 Trac #33286: Put topology in the reference manual\n\n6e45b9e469 Trac #33270: Difference between a formula and an image in Contour Plots\n\n895ded3c44 Trac #33224: PARI-backed LaurentSeries truncates exact polynomials to default precision\n\needa513423 Trac #33434: Fix pyflake in sage.graphs.graph\n\nf45550a9d3 Trac #33424: pep8 for function field maps\n\n9553cc37d8 Trac #33319: polynomial rings should not attempt to use Singular in characteristic >= 2^31\n\n13d038fd9f Trac #33147: use PARI's ellmul() for elliptic curves over finite fields\n\n0c85ad2f59 Trac #33433: Correct order of parameters in min_spanning_tree\n\n8e935af159 Trac #33421: Add elliptic_curves dependency to sagemath_doc_html\n\n111bcfa1f7 Trac #33216: reduce precision for .formal() in EllipticCurveIsogeny.dual()\n\n195cf6ab4d Trac #33215: WeierstrassIsomorphism should coerce its inputs to a common parent\n\ndf9c2612a6 Trac #33210: Fix Cython warnings in sage.rings.polynomial.polynomial_modn_dense_ntl\n\nac61ea8b62 Trac #33208: Remove unused code from sage/rings/padics/pow_computer_ext.pyx\n\nbc069a7cb2 Trac #33193: Fix Cython incompatible redefinition warnings in padics\n\n8a21049265 Trac #33186: Fix \"referenced before assignment\" warnings in padics\n\n490fdfded3 Trac #33055: conda-forge: Fix build of python3 spkg\n\nbeedaabc7e Trac #32997: docker image fails to build on tigerlake\n\n28f2f9a48b Trac #32786: opportunistic caching of elliptic-curve and point orders\n\n1ac2b995a4 Trac #12419: factorization of 0 in GF(p)[x,y] fails\n\n9349a36d34 Trac #33429: some cleanup in toric schemes\n\ndf9d1d77aa Trac #33427: numerical noise in effective_resistance involving RDF\n\nc6f2af1800 Trac #33425: adjust error messages in combinat/words\n\n449c7f1d66 Trac #33423: Cancel the linter\n\nb30c72fe86 Trac #33420: fix E111 (indentation) in quadratic_forms\n\ncc8a39082b Trac #33419: fix E111 (indentation) in manifolds, stats, finance\n\n6410a7cd86 Trac #33415: fix the linter\n\nec318c0d08 Trac #33410: Polyhedron_base.volume(engine='lrs', measure='induced')\n\nb6fecc7464 Trac #33399: Bug in ExpressionNice with composite variables\n\n6779f414bf Trac #33363: (Too) long doctest in sage/matrix/matrix_integer_dense.pyx\n\n9e90afaba0 Trac #29215: valuation error\n\n2a16069f4c Trac #29114: Only ./bootstrap should glob build/pkgs\n\n062a90c9d1 Trac #33403: Polyhedron._test_product, _test_dilation: Skip tests if test prereqs cannot be imported\n\ncc4ffb3fa1 Trac #33402: sage.geometry.polyhedron: More # optional\n\n9333fa5dc3 Trac #33395: document using Wolfram Engine (a.k.a. wolframscript) with Sage\n\nf346730807 Trac #33394: correct docs for running notebook on a specific port\n\n1e8ba0aac4 Updated [SageMath](../wiki/SageMath) version to 9.6.beta3\n\n\n\nmerge was not clean: conflicts in src/sage/schemes/elliptic_curves/ell_generic.py",
    "created_at": "2022-03-03T23:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535993",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:20" align="right">comment:20</div>

Merge failure on top of:

c7adc6cc57 Trac #33112: some speedups in AdditiveAbelianGroupWrapper.discrete_log()

8230df5b38 Trac #32770: Expose and access `tachyon` command line flags

135c8e5bb1 Trac #31426: Apply flat shading when plotting 3d polyhedra with Three.js

32e26f275f Trac #24536: find_local_maximum/minimum() fails with expressions containing complex numbers

c0b15ffde0 Trac #33450: Improve vs code config

a76af34b81 Trac #33312: WeierstrassIsomorphism.degree() returns a Python int

8368718592 Trac #33094: update URLs in SPKG.rst for ECL

4f76f139db Trac #32922: Change parameter name

44b5d43de7 Trac #32384: make some AdditiveAbelianGroupWrapper methods visible

232f88fe88 Trac #32251: Fix doctest in the "Y pentamino" example from Donald Knuth

6adf64eec4 Trac #30999: expose method hyperbolicity in graphs

14e3e755d2 Trac #25787: Remove documentation configuration from micro_release

87d5c62133 Trac #33414: Remove sage-open

c254f33235 Trac #33413: Remove sage-native-execute

6dcb3dc676 Trac #33412: Remove sage-update-src

aeb3fb2594 Trac #33411: include time for checking doctest output in '--warn-long'

b20aeb7ee9 Trac #33322: Several ImageMagick tests need "long time"

db459d4eb3 Trac #33318: speed up is_prime() for very small integers

0df0bad12f Trac #33308: Remove expired deprecations that use lazy_import(MODULE, "*")

7c9535ef80 Trac #33292: mark invlex ordering as global

e6d8672713 Trac #33286: Put topology in the reference manual

6e45b9e469 Trac #33270: Difference between a formula and an image in Contour Plots

895ded3c44 Trac #33224: PARI-backed LaurentSeries truncates exact polynomials to default precision

eeda513423 Trac #33434: Fix pyflake in sage.graphs.graph

f45550a9d3 Trac #33424: pep8 for function field maps

9553cc37d8 Trac #33319: polynomial rings should not attempt to use Singular in characteristic >= 2^31

13d038fd9f Trac #33147: use PARI's ellmul() for elliptic curves over finite fields

0c85ad2f59 Trac #33433: Correct order of parameters in min_spanning_tree

8e935af159 Trac #33421: Add elliptic_curves dependency to sagemath_doc_html

111bcfa1f7 Trac #33216: reduce precision for .formal() in EllipticCurveIsogeny.dual()

195cf6ab4d Trac #33215: WeierstrassIsomorphism should coerce its inputs to a common parent

df9c2612a6 Trac #33210: Fix Cython warnings in sage.rings.polynomial.polynomial_modn_dense_ntl

ac61ea8b62 Trac #33208: Remove unused code from sage/rings/padics/pow_computer_ext.pyx

bc069a7cb2 Trac #33193: Fix Cython incompatible redefinition warnings in padics

8a21049265 Trac #33186: Fix "referenced before assignment" warnings in padics

490fdfded3 Trac #33055: conda-forge: Fix build of python3 spkg

beedaabc7e Trac #32997: docker image fails to build on tigerlake

28f2f9a48b Trac #32786: opportunistic caching of elliptic-curve and point orders

1ac2b995a4 Trac #12419: factorization of 0 in GF(p)[x,y] fails

9349a36d34 Trac #33429: some cleanup in toric schemes

df9d1d77aa Trac #33427: numerical noise in effective_resistance involving RDF

c6f2af1800 Trac #33425: adjust error messages in combinat/words

449c7f1d66 Trac #33423: Cancel the linter

b30c72fe86 Trac #33420: fix E111 (indentation) in quadratic_forms

cc8a39082b Trac #33419: fix E111 (indentation) in manifolds, stats, finance

6410a7cd86 Trac #33415: fix the linter

ec318c0d08 Trac #33410: Polyhedron_base.volume(engine='lrs', measure='induced')

b6fecc7464 Trac #33399: Bug in ExpressionNice with composite variables

6779f414bf Trac #33363: (Too) long doctest in sage/matrix/matrix_integer_dense.pyx

9e90afaba0 Trac #29215: valuation error

2a16069f4c Trac #29114: Only ./bootstrap should glob build/pkgs

062a90c9d1 Trac #33403: Polyhedron._test_product, _test_dilation: Skip tests if test prereqs cannot be imported

cc4ffb3fa1 Trac #33402: sage.geometry.polyhedron: More # optional

9333fa5dc3 Trac #33395: document using Wolfram Engine (a.k.a. wolframscript) with Sage

f346730807 Trac #33394: correct docs for running notebook on a specific port

1e8ba0aac4 Updated [SageMath](../wiki/SageMath) version to 9.6.beta3



merge was not clean: conflicts in src/sage/schemes/elliptic_curves/ell_generic.py



---

archive/issue_comments_535994.json:
```json
{
    "body": "Changed commit from **[`b96b7d4`](https://github.com/sagemath/sagetrac-mirror/commit/b96b7d4c6f2c359fc365d16b3f5872caa2b9c4f1)** to **[`0aaec67`](https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56)**",
    "created_at": "2022-03-08T14:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535994",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b96b7d4`](https://github.com/sagemath/sagetrac-mirror/commit/b96b7d4c6f2c359fc365d16b3f5872caa2b9c4f1)** to **[`0aaec67`](https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56)**



---

archive/issue_comments_535995.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56\"><code>0aaec67</code></a></td><td><code>Merge tag '9.6.beta4' into public/33164</code></td></tr></table>\n",
    "created_at": "2022-03-08T14:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535995",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56"><code>0aaec67</code></a></td><td><code>Merge tag '9.6.beta4' into public/33164</code></td></tr></table>




---

archive/issue_events_453053.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-03-08T14:12:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453053"
}
```



---

archive/issue_events_453054.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-03-08T14:12:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453054"
}
```



---

archive/issue_comments_535996.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nTrivial merge.",
    "created_at": "2022-03-08T14:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535996",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:22" align="right">comment:22</div>

Trivial merge.



---

archive/issue_comments_535997.json:
```json
{
    "body": "Changed branch from **[public/33164](https://github.com/sagemath/sagetrac-mirror/tree/public/33164)** to **[`0aaec67`](https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56)**",
    "created_at": "2022-03-12T15:11:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33164#issuecomment-535997",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/33164](https://github.com/sagemath/sagetrac-mirror/tree/public/33164)** to **[`0aaec67`](https://github.com/sagemath/sagetrac-mirror/commit/0aaec679ce3bb4e43b96d140baa7fbd540cbff56)**



---

archive/issue_events_453055.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-12T15:11:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453055"
}
```



---

archive/issue_events_453056.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f4e532f7bf19f1de740667926216031e2fc4814b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-03-12T15:11:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33164",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33164#event-453056"
}
```
