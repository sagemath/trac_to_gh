# Issue 33488: Fix sagemath_doc_html build failure on Linux

archive/issues_033251.json:
```json
{
    "body": "Hello!\nI have encountered an error while building Sage. Here is  my OS info:\n\n- Debian testing (bookworm)\n- Sage-9.6.beta4\n- package sagemath_doc_html-none\n\nI ran make a few times and the package continually failed to build.\nI expected this to build, but now I can not run the sage command.\nSage is broken. I'm not sure what happened here but please let me\nknow what I can do next. I have attached the log files for you\nand a snippet of the last few lines of my terminal.\n\n```\n[sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short\n[sagemath_doc_html-none] Error: './sage --docbuild --all-documents' failed\n[sagemath_doc_html-none] make[5]: *** [Makefile:33: doc-inventory-reference] Error 1\nmake[4]: *** [Makefile:2900: sagemath_doc_html-SAGE_DOCS-no-deps] Error 2\nmake[3]: *** [Makefile:2900: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/installed/sagemath_doc_html-none] Error 2\nmake[2]: *** [Makefile:2461: all-start] Error 2\n\nreal    2m34.616s\nuser    1m18.953s\nsys     0m37.263s\n***************************************************************\nError building Sage.\n\nThe following package(s) may have failed to build (not necessarily\nduring this run of 'make all-start'):\n\n* package:         sagemath_doc_html-none\n  last build time: Mar 9 12:40\n  log file:        /home/linethan0322/sage-9.5.rc4/logs/pkgs/sagemath_doc_html-none.log\n```\n\nRelated:\n\n- #33139: Fix sagemath_doc_html build failure on Cygwin\n\nCC:  @slel\n\nKeywords: bug, sagemath, docs, broken, make, package\n\nReviewer: Kwankyu Lee\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/33488\n\n",
    "closed_at": "2022-08-02T06:31:03Z",
    "created_at": "2022-03-09T18:04:52Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Fix sagemath_doc_html build failure on Linux",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33488",
    "user": "https://github.com/WindowsSystemAdmin"
}
```
Hello!
I have encountered an error while building Sage. Here is  my OS info:

- Debian testing (bookworm)
- Sage-9.6.beta4
- package sagemath_doc_html-none

I ran make a few times and the package continually failed to build.
I expected this to build, but now I can not run the sage command.
Sage is broken. I'm not sure what happened here but please let me
know what I can do next. I have attached the log files for you
and a snippet of the last few lines of my terminal.

```
[sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short
[sagemath_doc_html-none] Error: './sage --docbuild --all-documents' failed
[sagemath_doc_html-none] make[5]: *** [Makefile:33: doc-inventory-reference] Error 1
make[4]: *** [Makefile:2900: sagemath_doc_html-SAGE_DOCS-no-deps] Error 2
make[3]: *** [Makefile:2900: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/installed/sagemath_doc_html-none] Error 2
make[2]: *** [Makefile:2461: all-start] Error 2

real    2m34.616s
user    1m18.953s
sys     0m37.263s
***************************************************************
Error building Sage.

The following package(s) may have failed to build (not necessarily
during this run of 'make all-start'):

* package:         sagemath_doc_html-none
  last build time: Mar 9 12:40
  log file:        /home/linethan0322/sage-9.5.rc4/logs/pkgs/sagemath_doc_html-none.log
```

Related:

- #33139: Fix sagemath_doc_html build failure on Cygwin

CC:  @slel

Keywords: bug, sagemath, docs, broken, make, package

Reviewer: Kwankyu Lee

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/33488





---

archive/issue_comments_505680.json:
```json
{
    "body": "Log file of the package sagemath_html-none",
    "created_at": "2022-03-09T18:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505680",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

Log file of the package sagemath_html-none



---

archive/issue_comments_505681.json:
```json
{
    "body": "Attachment [config.log](tarball://root/attachments/some-uuid/ticket33488/config.log) by @WindowsSystemAdmin created at 2022-03-09 18:06:18\n\nMy config log",
    "created_at": "2022-03-09T18:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505681",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

Attachment [config.log](tarball://root/attachments/some-uuid/ticket33488/config.log) by @WindowsSystemAdmin created at 2022-03-09 18:06:18

My config log



---

archive/issue_comments_505682.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n Hello!\n-I have encountered an error while building Sage. HEre is  my OS info:\n+I have encountered an error while building Sage. Here is  my OS info:\n Debian testing (bookworm)\n Sage-9.6.beta4\n package sagemath_doc_html-none\n-I ran make a few times and the package continually failed to build. I expected this to build, but now I can not run the sage command. Sage is broken. I m not sure what happened here but please let me know what I can do next. I have attached the log files for you and a snippet of the last few lines of my terminal.\n-sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short\n+I ran make a few times and the package continually failed to build. I expected this to build, but now I can not run the sage command. Sage is broken. I'm not sure what happened here but please let me know what I can do next. I have attached the log files for you and a snippet of the last few lines of my terminal.\n+[sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short\n [sagemath_doc_html-none] Error: './sage --docbuild --all-documents' failed\n [sagemath_doc_html-none] make[5]: *** [Makefile:33: doc-inventory-reference] Error 1\n make[4]: *** [Makefile:2900: sagemath_doc_html-SAGE_DOCS-no-deps] Error 2\n@@ -24,6 +24,7 @@\n   last build time: Mar 9 12:40\n   log file:        /home/linethan0322/sage-9.5.rc4/logs/pkgs/sagemath_doc_html-none.log\n \n+\n Summary: Error building Sage. -- Package failed to build.\n \n Issue created by migration from https://trac.sagemath.org/ticket/33488\n``````\n",
    "created_at": "2022-03-09T18:07:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505682",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
 Hello!
-I have encountered an error while building Sage. HEre is  my OS info:
+I have encountered an error while building Sage. Here is  my OS info:
 Debian testing (bookworm)
 Sage-9.6.beta4
 package sagemath_doc_html-none
-I ran make a few times and the package continually failed to build. I expected this to build, but now I can not run the sage command. Sage is broken. I m not sure what happened here but please let me know what I can do next. I have attached the log files for you and a snippet of the last few lines of my terminal.
-sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short
+I ran make a few times and the package continually failed to build. I expected this to build, but now I can not run the sage command. Sage is broken. I'm not sure what happened here but please let me know what I can do next. I have attached the log files for you and a snippet of the last few lines of my terminal.
+[sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short
 [sagemath_doc_html-none] Error: './sage --docbuild --all-documents' failed
 [sagemath_doc_html-none] make[5]: *** [Makefile:33: doc-inventory-reference] Error 1
 make[4]: *** [Makefile:2900: sagemath_doc_html-SAGE_DOCS-no-deps] Error 2
@@ -24,6 +24,7 @@
   last build time: Mar 9 12:40
   log file:        /home/linethan0322/sage-9.5.rc4/logs/pkgs/sagemath_doc_html-none.log
 
+
 Summary: Error building Sage. -- Package failed to build.
 
 Issue created by migration from https://trac.sagemath.org/ticket/33488
``````




---

archive/issue_comments_505683.json:
```json
{
    "body": "Changing keywords from \"\" to \"bug, development, make\".",
    "created_at": "2022-03-09T18:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505683",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

Changing keywords from "" to "bug, development, make".



---

archive/issue_comments_505684.json:
```json
{
    "body": "Changing keywords from \"bug, development, make\" to \"bug, sagemath, html, broken, make\".",
    "created_at": "2022-03-09T20:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505684",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

Changing keywords from "bug, development, make" to "bug, sagemath, html, broken, make".



---

archive/issue_comments_505685.json:
```json
{
    "body": "Changing keywords from \"bug, sagemath, html, broken, make\" to \"bug, sagemath, docs, broken, make, package\".",
    "created_at": "2022-03-09T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505685",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

Changing keywords from "bug, sagemath, html, broken, make" to "bug, sagemath, docs, broken, make, package".



---

archive/issue_comments_505686.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,41 @@\n+Hello!\n+I have encountered an error while building Sage. Here is  my OS info:\n \n+- Debian testing (bookworm)\n+- Sage-9.6.beta4\n+- package sagemath_doc_html-none\n+\n+I ran make a few times and the package continually failed to build.\n+I expected this to build, but now I can not run the sage command.\n+Sage is broken. I'm not sure what happened here but please let me\n+know what I can do next. I have attached the log files for you\n+and a snippet of the last few lines of my terminal.\n+\n+```\n+[sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short\n+[sagemath_doc_html-none] Error: './sage --docbuild --all-documents' failed\n+[sagemath_doc_html-none] make[5]: *** [Makefile:33: doc-inventory-reference] Error 1\n+make[4]: *** [Makefile:2900: sagemath_doc_html-SAGE_DOCS-no-deps] Error 2\n+make[3]: *** [Makefile:2900: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/installed/sagemath_doc_html-none] Error 2\n+make[2]: *** [Makefile:2461: all-start] Error 2\n+\n+real    2m34.616s\n+user    1m18.953s\n+sys     0m37.263s\n+***************************************************************\n+Error building Sage.\n+\n+The following package(s) may have failed to build (not necessarily\n+during this run of 'make all-start'):\n+\n+* package:         sagemath_doc_html-none\n+  last build time: Mar 9 12:40\n+  log file:        /home/linethan0322/sage-9.5.rc4/logs/pkgs/sagemath_doc_html-none.log\n+```\n+\n+Related:\n+\n+- #33139: Fix sagemath_doc_html build failure on Cygwin\n \n Summary: Error building Sage. -- Package failed to build.\n \n``````\n",
    "created_at": "2022-03-10T04:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505686",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,41 @@
+Hello!
+I have encountered an error while building Sage. Here is  my OS info:
 
+- Debian testing (bookworm)
+- Sage-9.6.beta4
+- package sagemath_doc_html-none
+
+I ran make a few times and the package continually failed to build.
+I expected this to build, but now I can not run the sage command.
+Sage is broken. I'm not sure what happened here but please let me
+know what I can do next. I have attached the log files for you
+and a snippet of the last few lines of my terminal.
+
+```
+[sagemath_doc_html-none] ImportError: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/matrix/matrix_mod2_dense.cpython-39-x86_64-linux-gnu.so: file too short
+[sagemath_doc_html-none] Error: './sage --docbuild --all-documents' failed
+[sagemath_doc_html-none] make[5]: *** [Makefile:33: doc-inventory-reference] Error 1
+make[4]: *** [Makefile:2900: sagemath_doc_html-SAGE_DOCS-no-deps] Error 2
+make[3]: *** [Makefile:2900: /home/linethan0322/sage-9.5.rc4/local/var/lib/sage/installed/sagemath_doc_html-none] Error 2
+make[2]: *** [Makefile:2461: all-start] Error 2
+
+real    2m34.616s
+user    1m18.953s
+sys     0m37.263s
+***************************************************************
+Error building Sage.
+
+The following package(s) may have failed to build (not necessarily
+during this run of 'make all-start'):
+
+* package:         sagemath_doc_html-none
+  last build time: Mar 9 12:40
+  log file:        /home/linethan0322/sage-9.5.rc4/logs/pkgs/sagemath_doc_html-none.log
+```
+
+Related:
+
+- #33139: Fix sagemath_doc_html build failure on Cygwin
 
 Summary: Error building Sage. -- Package failed to build.
 
``````




---

archive/issue_comments_505687.json:
```json
{
    "body": "<a id='comment:6'></a>Errors building `sagemath_doc_html` have been frequent recently.\n\nOn Linux and macOS, it seems this usually solves it:\n\n```\n$ make -s V=0 doc-clean doc-uninstall && make -s V=0\n```\n\nFailing that, this has also worked for some:\n\n```\n$ make -s V=0 distclean && make -s V=0\n```\n\nOn Cygwin, none of these helped for me.",
    "created_at": "2022-03-10T04:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505687",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>Errors building `sagemath_doc_html` have been frequent recently.

On Linux and macOS, it seems this usually solves it:

```
$ make -s V=0 doc-clean doc-uninstall && make -s V=0
```

Failing that, this has also worked for some:

```
$ make -s V=0 distclean && make -s V=0
```

On Cygwin, none of these helped for me.



---

archive/issue_comments_505688.json:
```json
{
    "body": "<a id='comment:7'></a>The above didn't work for me either.. I'm on a Debian machine",
    "created_at": "2022-03-10T17:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505688",
    "user": "https://github.com/WindowsSystemAdmin"
}
```

<a id='comment:7'></a>The above didn't work for me either.. I'm on a Debian machine



---

archive/issue_events_088217.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33488#event-88217"
}
```



---

archive/issue_events_088218.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-09T19:44:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33488#event-88218"
}
```



---

archive/issue_events_088219.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-09T19:44:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33488#event-88219"
}
```



---

archive/issue_comments_505689.json:
```json
{
    "body": "<a id='comment:9'></a>Let's close it as outdated",
    "created_at": "2022-07-09T19:44:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505689",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Let's close it as outdated



---

archive/issue_comments_505690.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-09T19:44:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505690",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_505691.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-16T11:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505691",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_505692.json:
```json
{
    "body": "<a id='comment:10'></a>I agree. The issue is not clear.",
    "created_at": "2022-07-16T11:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505692",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:10'></a>I agree. The issue is not clear.



---

archive/issue_events_088220.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-02T06:31:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33488#event-88220"
}
```



---

archive/issue_comments_505693.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-08-02T06:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33488#issuecomment-505693",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
