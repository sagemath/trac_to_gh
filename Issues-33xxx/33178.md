# Issue 33178: hilbert_numerator() algorithms disagree

archive/issues_032941.json:
```json
{
    "body": "We discovered in #33134 that `hilbert_numerator()` can return different results with `algorithm=\"singular\"` and the default `algorithm=\"sage\"`:\n\n```\nsage: n=4; m=11; P = PolynomialRing(QQ,n*m,\"x\")\nsage: x = P.gens(); M = Matrix(n,x)\nsage: I = P.ideal(M.minors(2))\nsage: J = P*[m.lm() for m in I.groebner_basis()]\nsage: expected = J.hilbert_numerator()\nsage: actual = J.hilbert_numerator(algorithm='singular')\nsage: actual == expected\nFalse\nsage: actual - expected\n4294967296*t^22 - 4294967296*t^21 + 4294967296*t^20 - 4294967296*t^19 + 4294967296*t^18\n```\n\nNote that this requires singular >= 4.2.1p2, otherwise the example will fail entirely.\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/33178\n\n",
    "created_at": "2022-01-15T03:11:35Z",
    "labels": [
        "component: algebraic geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "hilbert_numerator() algorithms disagree",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33178",
    "user": "https://github.com/orlitzky"
}
```
We discovered in #33134 that `hilbert_numerator()` can return different results with `algorithm="singular"` and the default `algorithm="sage"`:

```
sage: n=4; m=11; P = PolynomialRing(QQ,n*m,"x")
sage: x = P.gens(); M = Matrix(n,x)
sage: I = P.ideal(M.minors(2))
sage: J = P*[m.lm() for m in I.groebner_basis()]
sage: expected = J.hilbert_numerator()
sage: actual = J.hilbert_numerator(algorithm='singular')
sage: actual == expected
False
sage: actual - expected
4294967296*t^22 - 4294967296*t^21 + 4294967296*t^20 - 4294967296*t^19 + 4294967296*t^18
```

Note that this requires singular >= 4.2.1p2, otherwise the example will fail entirely.

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/33178





---

archive/issue_comments_469327.json:
```json
{
    "body": "<a id='comment:2'></a>overflow somewhere ?\n\n```\nsage: factor(4294967296)\n2^32\n```",
    "created_at": "2022-01-15T08:09:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33178#issuecomment-469327",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>overflow somewhere ?

```
sage: factor(4294967296)
2^32
```



---

archive/issue_comments_469328.json:
```json
{
    "body": "<a id='comment:3'></a>The [Singular 4.3.0 release notes](https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-3-0.html) mention:\n\n> - `hilb` avoids int overflow (also in `degree`, `stdhilb`)",
    "created_at": "2022-01-23T11:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33178#issuecomment-469328",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'></a>The [Singular 4.3.0 release notes](https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-3-0.html) mention:

> - `hilb` avoids int overflow (also in `degree`, `stdhilb`)



---

archive/issue_comments_469329.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 slelievre]:\n> The [Singular 4.3.0 release notes](https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-3-0.html) mention:\n> \n> > - `hilb` avoids int overflow (also in `degree`, `stdhilb`)\n\n\nThe issue persists with Singular 4.3.0 (tested on Arch).",
    "created_at": "2022-02-01T20:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33178#issuecomment-469329",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:4'></a>Replying to [comment:3 slelievre]:
> The [Singular 4.3.0 release notes](https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-3-0.html) mention:
> 
> > - `hilb` avoids int overflow (also in `degree`, `stdhilb`)


The issue persists with Singular 4.3.0 (tested on Arch).



---

archive/issue_events_087662.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33178#event-87662"
}
```



---

archive/issue_comments_469330.json:
```json
{
    "body": "<a id='comment:6'></a>which one is correct, `actual` or `expected` ?",
    "created_at": "2022-07-11T11:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33178#issuecomment-469330",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>which one is correct, `actual` or `expected` ?



---

archive/issue_comments_469331.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 dimpase]:\n> which one is correct, `actual` or `expected` ?\n\n\nBarring a second, independent, bug: the \"expected\" answer should be the correct one.",
    "created_at": "2022-07-13T00:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33178#issuecomment-469331",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:7'></a>Replying to [comment:6 dimpase]:
> which one is correct, `actual` or `expected` ?


Barring a second, independent, bug: the "expected" answer should be the correct one.



---

archive/issue_events_087663.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33178#event-87663"
}
```



---

archive/issue_events_087664.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33178",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33178#event-87664"
}
```
