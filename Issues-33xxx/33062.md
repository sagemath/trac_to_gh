# Issue 33062: GH Actions (docker): Run a job for "make build-local" first, cache image for job "make build"

archive/issues_032825.json:
```json
{
    "assignees": [],
    "body": "Follow up from #32703, where this was implemented for macOS.\n\nHere we implement it for the `docker`-based workflows \nvia incremental builds (#34228) on top of previous stages pushed to ghcr.io\n\n\n\nDepends on #34115\nDepends on #34228\n\nCC:  @tobiasdiez @dimpase\n\nBranch/Commit: **[`5713937`](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **porting**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33062_\n\n",
    "closed_at": "2022-09-25T16:34:31Z",
    "created_at": "2021-12-21T17:27:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "GH Actions (docker): Run a job for \"make build-local\" first, cache image for job \"make build\"",
    "type": "issue",
    "updated_at": "2022-09-25T16:34:31Z",
    "url": "https://github.com/sagemath/sage/issues/33062",
    "user": "https://github.com/mkoeppe"
}
```
Follow up from #32703, where this was implemented for macOS.

Here we implement it for the `docker`-based workflows 
via incremental builds (#34228) on top of previous stages pushed to ghcr.io



Depends on #34115
Depends on #34228

CC:  @tobiasdiez @dimpase

Branch/Commit: **[`5713937`](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)**

Reviewer: **Dima Pasechnik**

Author: **Matthias Koeppe**

Component: **porting**

_Issue created by migration from https://trac.sagemath.org/ticket/33062_





---

archive/issue_events_454923.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-21T17:27:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454923"
}
```



---

archive/issue_events_454924.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-21T17:27:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "000080",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454924"
}
```



---

archive/issue_events_454925.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-21T17:27:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454925"
}
```



---

archive/issue_events_454926.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-21T17:27:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454926"
}
```



---

archive/issue_comments_533825.json:
```json
{
    "body": "Dependencies: **#30933, #33103, #33140**",
    "created_at": "2022-01-13T18:52:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533825",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#30933, #33103, #33140**



---

archive/issue_comments_533826.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n Follow up from #32703, where this was implemented for macOS.\n \n-Here we implement it for the `docker`-based workflows.\n-\n-References\n-- https://evilmartians.com/chronicles/build-images-on-github-actions-with-docker-layer-caching\n+Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n \n+\n+\n``````\n",
    "created_at": "2022-01-30T22:10:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533826",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
 Follow up from #32703, where this was implemented for macOS.
 
-Here we implement it for the `docker`-based workflows.
-
-References
-- https://evilmartians.com/chronicles/build-images-on-github-actions-with-docker-layer-caching
+Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
 
+
+
``````




---

archive/issue_comments_533827.json:
```json
{
    "body": "Changed dependencies from **#30933, #33103, #33140** to **#33103, #33140, #33222**",
    "created_at": "2022-01-30T22:10:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533827",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30933, #33103, #33140** to **#33103, #33140, #33222**



---

archive/issue_comments_533828.json:
```json
{
    "body": "Changed dependencies from **#33103, #33140, #33222** to **#33103, #33140**",
    "created_at": "2022-02-05T19:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533828",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#33103, #33140, #33222** to **#33103, #33140**



---

archive/issue_comments_533829.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n+(split out from #33222)\n \n \n-\n``````\n",
    "created_at": "2022-02-05T19:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533829",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
+(split out from #33222)
 
 
-
``````




---

archive/issue_comments_533830.json:
```json
{
    "body": "Branch: **[u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)**",
    "created_at": "2022-02-07T00:15:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533830",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)**



---

archive/issue_comments_533831.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,26 @@\n \n Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n+To use:\n+\n+```\n+$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard\n+ => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s\n+```\n+\n+\n (split out from #33222)\n \n \n``````\n",
    "created_at": "2022-02-07T00:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533831",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,26 @@
 
 Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
+To use:
+
+```
+$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard
+ => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s
+```
+
+
 (split out from #33222)
 
 
``````




---

archive/issue_comments_533832.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/531cd1460659775baf84955457580baeb1b2f878\"><code>531cd14</code></a></td><td><code>Merge #33103</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51191fe56dfaf5d721e6d5025e58c92804cafec1\"><code>51191fe</code></a></td><td><code>.github/workflows/tox.yml (local-macos): Fix filtering of experimental packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12f88cfaafdd85b85f4ac117793cc4a2616476cc\"><code>12f88cf</code></a></td><td><code>.github/workflows/tox.yml (local-macos): Group optional/experimental package builds into fewer jobs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49236ddcb076fccc4325dc2b3142fe8baab536be\"><code>49236dd</code></a></td><td><code>tox.ini: Add local-macos-python3_pythonorg-python3.9 etc., refactor CONFIG_CONFIGURE_ARGS_1=...--with-python</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fcdc91d7f719b165c3cf912e500e831f5bb493e\"><code>1fcdc91</code></a></td><td><code>tox.ini: Updates for macos and manylinux from #31396</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41ec3aa15693c69d68e9fdf2fae08e1999706a55\"><code>41ec3aa</code></a></td><td><code>tox.ini: Reindent</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7066aa91fd1467cb08188deae7fbce35089c201\"><code>d7066aa</code></a></td><td><code>Merge #33140</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/98a5bae95e6ab995acc1dc2bf227103f71f27731\"><code>98a5bae</code></a></td><td><code>Merge tag '9.6.beta0' into t/33062/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c446d3331b2974c8f97e20818407b58fb9c474a0\"><code>c446d33</code></a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030\"><code>c9c7d9f</code></a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr></table>\n",
    "created_at": "2022-02-07T00:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533832",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/531cd1460659775baf84955457580baeb1b2f878"><code>531cd14</code></a></td><td><code>Merge #33103</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51191fe56dfaf5d721e6d5025e58c92804cafec1"><code>51191fe</code></a></td><td><code>.github/workflows/tox.yml (local-macos): Fix filtering of experimental packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12f88cfaafdd85b85f4ac117793cc4a2616476cc"><code>12f88cf</code></a></td><td><code>.github/workflows/tox.yml (local-macos): Group optional/experimental package builds into fewer jobs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49236ddcb076fccc4325dc2b3142fe8baab536be"><code>49236dd</code></a></td><td><code>tox.ini: Add local-macos-python3_pythonorg-python3.9 etc., refactor CONFIG_CONFIGURE_ARGS_1=...--with-python</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fcdc91d7f719b165c3cf912e500e831f5bb493e"><code>1fcdc91</code></a></td><td><code>tox.ini: Updates for macos and manylinux from #31396</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41ec3aa15693c69d68e9fdf2fae08e1999706a55"><code>41ec3aa</code></a></td><td><code>tox.ini: Reindent</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7066aa91fd1467cb08188deae7fbce35089c201"><code>d7066aa</code></a></td><td><code>Merge #33140</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/98a5bae95e6ab995acc1dc2bf227103f71f27731"><code>98a5bae</code></a></td><td><code>Merge tag '9.6.beta0' into t/33062/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c446d3331b2974c8f97e20818407b58fb9c474a0"><code>c446d33</code></a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030"><code>c9c7d9f</code></a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr></table>




---

archive/issue_comments_533833.json:
```json
{
    "body": "Commit: **[`c9c7d9f`](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)**",
    "created_at": "2022-02-07T00:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533833",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`c9c7d9f`](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)**



---

archive/issue_comments_533834.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n-To use:\n+To use for local builds via tox:\n \n ```\n $ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard\n``````\n",
    "created_at": "2022-02-07T00:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533834",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
-To use:
+To use for local builds via tox:
 
 ```
 $ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard
``````




---

archive/issue_comments_533835.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e56bf3e2602a51c30eac7a8b1eb96aba6db36286\"><code>e56bf3e</code></a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270\"><code>c830cdb</code></a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr></table>\n",
    "created_at": "2022-02-07T02:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533835",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e56bf3e2602a51c30eac7a8b1eb96aba6db36286"><code>e56bf3e</code></a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270"><code>c830cdb</code></a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr></table>




---

archive/issue_comments_533836.json:
```json
{
    "body": "Changed commit from **[`c9c7d9f`](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)** to **[`c830cdb`](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)**",
    "created_at": "2022-02-07T02:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533836",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c9c7d9f`](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)** to **[`c830cdb`](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)**



---

archive/issue_comments_533837.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,4 +24,5 @@\n \n (split out from #33222)\n \n+We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. \n \n``````\n",
    "created_at": "2022-02-07T02:16:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533837",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,4 +24,5 @@
 
 (split out from #33222)
 
+We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. 
 
``````




---

archive/issue_comments_533838.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2022-02-07T02:30:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533838",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_533839.json:
```json
{
    "body": "Reviewer: **https://github.com/mkoeppe/sage/actions/runs/1804137820**",
    "created_at": "2022-02-07T02:31:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533839",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **https://github.com/mkoeppe/sage/actions/runs/1804137820**



---

archive/issue_comments_533840.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nObviously there is again a lot of cut+paste going on here, but I'm not sure yet whether this is best refactored using (1) scripts to be put in `.ci/`; (2) new top-level `Makefile` targets; (3) reusable workflows in the same repo; (4) reusable workflows from a different repo. So until then, copy+paste it is",
    "created_at": "2022-02-07T02:39:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533840",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Obviously there is again a lot of cut+paste going on here, but I'm not sure yet whether this is best refactored using (1) scripts to be put in `.ci/`; (2) new top-level `Makefile` targets; (3) reusable workflows in the same repo; (4) reusable workflows from a different repo. So until then, copy+paste it is



---

archive/issue_comments_533841.json:
```json
{
    "body": "Changed commit from **[`c830cdb`](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)** to **[`47b636d`](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)**",
    "created_at": "2022-02-07T06:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533841",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c830cdb`](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)** to **[`47b636d`](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)**



---

archive/issue_comments_533842.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d\"><code>47b636d</code></a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>\n",
    "created_at": "2022-02-07T06:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533842",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d"><code>47b636d</code></a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>




---

archive/issue_events_454927.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-07T06:06:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454927"
}
```



---

archive/issue_comments_533843.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nA lot of jobs are failing because there doesn't exist a corresponding `maximal` image. \n\nWhat is the distinction between the `docker` and `docker-optional` jobs?",
    "created_at": "2022-02-07T12:52:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533843",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:14" align="right">comment:14</div>

A lot of jobs are failing because there doesn't exist a corresponding `maximal` image. 

What is the distinction between the `docker` and `docker-optional` jobs?



---

archive/issue_comments_533844.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@tobiasdiez](#comment:14):\n> What is the distinction between the `docker` and `docker-optional` jobs?\n\n`docker-optional` also runs the stages that build optional and experimental packages.",
    "created_at": "2022-02-07T16:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533844",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@tobiasdiez](#comment:14):
> What is the distinction between the `docker` and `docker-optional` jobs?

`docker-optional` also runs the stages that build optional and experimental packages.



---

archive/issue_events_454928.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-07T16:39:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454928"
}
```



---

archive/issue_events_454929.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-07T16:39:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454929"
}
```



---

archive/issue_comments_533845.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tobiasdiez](#comment:14):\n> A lot of jobs are failing because there doesn't exist a corresponding `maximal` image. \n\nNot sure if that's it but there are a number of new failures introduced by switching to `DOCKER_BUILDKIT=1`, for example https://github.com/mkoeppe/sage/runs/5087229478?check_suite_focus=true\n\n```\n > [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details \"pkgconfig(gf2x)\" || echo \"(ignoring error)\":\n------\nfailed to prepare d4bec9ys962tp15dnd39jkkya: max depth exceeded\n```\n\nThis will require some changes in `build/bin/write-dockerfile.sh`",
    "created_at": "2022-02-07T16:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533845",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tobiasdiez](#comment:14):
> A lot of jobs are failing because there doesn't exist a corresponding `maximal` image. 

Not sure if that's it but there are a number of new failures introduced by switching to `DOCKER_BUILDKIT=1`, for example https://github.com/mkoeppe/sage/runs/5087229478?check_suite_focus=true

```
 > [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details "pkgconfig(gf2x)" || echo "(ignoring error)":
------
failed to prepare d4bec9ys962tp15dnd39jkkya: max depth exceeded
```

This will require some changes in `build/bin/write-dockerfile.sh`



---

archive/issue_comments_533846.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mkoeppe](#comment:15):\n> Replying to [@tobiasdiez](#comment:14):\n> > What is the distinction between the `docker` and `docker-optional` jobs?\n\n> \n> `docker-optional` also runs the stages that build optional and experimental packages.\n> \n\nOkay, thanks! Would it then make sense to base the `docker-optional` on the image created in the `docker` job to speed up the build (i.e. as a \"stage\")?",
    "created_at": "2022-02-07T17:58:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533846",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mkoeppe](#comment:15):
> Replying to [@tobiasdiez](#comment:14):
> > What is the distinction between the `docker` and `docker-optional` jobs?

> 
> `docker-optional` also runs the stages that build optional and experimental packages.
> 

Okay, thanks! Would it then make sense to base the `docker-optional` on the image created in the `docker` job to speed up the build (i.e. as a "stage")?



---

archive/issue_comments_533847.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nIt's currently using a different package configuration (`-maximal` instead of `-standard`)",
    "created_at": "2022-02-07T18:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533847",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

It's currently using a different package configuration (`-maximal` instead of `-standard`)



---

archive/issue_comments_533848.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@mkoeppe](#comment:19):\n> It's currently using a different package configuration (`-maximal` instead of `-standard`)\n\nBut wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?",
    "created_at": "2022-02-07T21:45:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533848",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@mkoeppe](#comment:19):
> It's currently using a different package configuration (`-maximal` instead of `-standard`)

But wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?



---

archive/issue_comments_533849.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@tobiasdiez](#comment:20):\n> wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?\n\nYes, it is doing that. But it is only building optional packages on top of the `-maximal` configuration, not on top of the other configurations.",
    "created_at": "2022-02-07T22:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533849",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@tobiasdiez](#comment:20):
> wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?

Yes, it is doing that. But it is only building optional packages on top of the `-maximal` configuration, not on top of the other configurations.



---

archive/issue_comments_533850.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOkay, what confuses me is that it seems to not be part of the \"stage\" design in the sense that it's not using the stage-1 of the normal `docker` job.",
    "created_at": "2022-02-07T22:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533850",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:22" align="right">comment:22</div>

Okay, what confuses me is that it seems to not be part of the "stage" design in the sense that it's not using the stage-1 of the normal `docker` job.



---

archive/issue_comments_533851.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIt's using stage-1 of its own docker job because it needs \"maximal\", not \"minimal\"/\"standard\".",
    "created_at": "2022-02-07T22:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533851",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">comment:23</div>

It's using stage-1 of its own docker job because it needs "maximal", not "minimal"/"standard".



---

archive/issue_comments_533852.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAh okay, now I understand. And it is not possible to have one common \"stage-1\" that build all three variants?",
    "created_at": "2022-02-07T22:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533852",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:24" align="right">comment:24</div>

Ah okay, now I understand. And it is not possible to have one common "stage-1" that build all three variants?



---

archive/issue_comments_533853.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nGH Actions appears to be running on 8-bit technology: Matrix jobs that would create > 256 jobs are silently dropped from the workflow.",
    "created_at": "2022-02-07T23:24:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533853",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

GH Actions appears to be running on 8-bit technology: Matrix jobs that would create > 256 jobs are silently dropped from the workflow.



---

archive/issue_comments_533854.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.",
    "created_at": "2022-02-07T23:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533854",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.



---

archive/issue_comments_533855.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@mkoeppe](#comment:26):\n> ... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.\n\nWhy 6 stages? What I meant is that you have one job creating all docker images, then build jobs on top of this. I feel like this design is also more flexible, since you can easily run certain follow up stages only on a subset of configs.",
    "created_at": "2022-02-07T23:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533855",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@mkoeppe](#comment:26):
> ... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.

Why 6 stages? What I meant is that you have one job creating all docker images, then build jobs on top of this. I feel like this design is also more flexible, since you can easily run certain follow up stages only on a subset of configs.



---

archive/issue_comments_533856.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n2 stages * 3 * 46 also exceeds 256.",
    "created_at": "2022-02-07T23:56:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533856",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

2 stages * 3 * 46 also exceeds 256.



---

archive/issue_comments_533857.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nIn any case, the scope of the ticket is to change how it is build (= in 2 stages, to solve the 6-hour timeouts for some platforms).  I am keeping *what* is built/tested the same as before. One ticket, one change.",
    "created_at": "2022-02-08T00:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533857",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

In any case, the scope of the ticket is to change how it is build (= in 2 stages, to solve the 6-hour timeouts for some platforms).  I am keeping *what* is built/tested the same as before. One ticket, one change.



---

archive/issue_comments_533858.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@mkoeppe](#comment:28):\n> 2 stages * 3 * 46 also exceeds 256.\n\nMy point was that you shouldn't use the matrix for stages, so that you don't run into these constraints.\n- Job \"build\": (min, standard, max) for each system (=3 * 46 < 256) - build docker image\n- Job \"test-basic\": (min, standard) for each system - build sage, run tests\n- Job \"test-optional\": max for each system - build sage with optional packages, run tests\n\nThis would also keep what is build and runs in stages.",
    "created_at": "2022-02-08T10:46:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533858",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@mkoeppe](#comment:28):
> 2 stages * 3 * 46 also exceeds 256.

My point was that you shouldn't use the matrix for stages, so that you don't run into these constraints.
- Job "build": (min, standard, max) for each system (=3 * 46 < 256) - build docker image
- Job "test-basic": (min, standard) for each system - build sage, run tests
- Job "test-optional": max for each system - build sage with optional packages, run tests

This would also keep what is build and runs in stages.



---

archive/issue_comments_533859.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nJob \"build\" does not reliably fit into 6 hours.",
    "created_at": "2022-02-08T18:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533859",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Job "build" does not reliably fit into 6 hours.



---

archive/issue_comments_533860.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@mkoeppe](#comment:31):\n> Job \"build\" does not reliably fit into 6 hours.\n\nYou seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). \n\nIn this case, you can selectively add a second stage for these problematic systems using matrices as in https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#example-including-new-combinations",
    "created_at": "2022-02-08T19:05:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533860",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@mkoeppe](#comment:31):
> Job "build" does not reliably fit into 6 hours.

You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). 

In this case, you can selectively add a second stage for these problematic systems using matrices as in https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#example-including-new-combinations



---

archive/issue_comments_533861.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nAnother reason for the split into the 2 build stages is explained in the ticket description of #32703.",
    "created_at": "2022-02-08T19:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533861",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Another reason for the split into the 2 build stages is explained in the ticket description of #32703.



---

archive/issue_comments_533862.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@tobiasdiez](#comment:32):\n> you can selectively add a second stage for these problematic systems using matrices\n\n-1",
    "created_at": "2022-02-08T19:45:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533862",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@tobiasdiez](#comment:32):
> you can selectively add a second stage for these problematic systems using matrices

-1



---

archive/issue_comments_533863.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@mkoeppe](#comment:33):\n> Another reason for the split into the 2 build stages is explained in the ticket description of #32703.\n> \n\nI don't see anything there that would be easier with matrix-stages over job-stages. In the contrary, the design I proposed above can easily be extended using additional jobs (that run on top of \"build\"). While your matrix-stage design would need an additional stage, which is not possible due to 3 stages * 2 configs * 46 systems > 256.",
    "created_at": "2022-02-08T20:11:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533863",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@mkoeppe](#comment:33):
> Another reason for the split into the 2 build stages is explained in the ticket description of #32703.
> 

I don't see anything there that would be easier with matrix-stages over job-stages. In the contrary, the design I proposed above can easily be extended using additional jobs (that run on top of "build"). While your matrix-stage design would need an additional stage, which is not possible due to 3 stages * 2 configs * 46 systems > 256.



---

archive/issue_comments_533864.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\ncomment:31",
    "created_at": "2022-02-08T20:20:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533864",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

comment:31



---

archive/issue_comments_533865.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@tobiasdiez](#comment:32):\n> Replying to [@mkoeppe](#comment:31):\n> > Job \"build\" does not reliably fit into 6 hours.\n\n> \n> You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). \n\nNo, that's likely only a sporadic failure.",
    "created_at": "2022-02-08T20:28:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533865",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@tobiasdiez](#comment:32):
> Replying to [@mkoeppe](#comment:31):
> > Job "build" does not reliably fit into 6 hours.

> 
> You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). 

No, that's likely only a sporadic failure.



---

archive/issue_comments_533866.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nHere is a version where I converted your first stage to a \"prebuild\" job. It runs exactly the same code (except if I made a mistake and missed some hidden environment variables). So the prebuild job timeouts iff if your stage 1 job would time out.\n\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/1814856715\nhttps://github.com/sagemath/sagetrac-mirror/blob/public/build/refactor-ci-runtests/.github/workflows/ci-docker.yml",
    "created_at": "2022-02-08T23:24:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533866",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:38" align="right">comment:38</div>

Here is a version where I converted your first stage to a "prebuild" job. It runs exactly the same code (except if I made a mistake and missed some hidden environment variables). So the prebuild job timeouts iff if your stage 1 job would time out.

https://github.com/sagemath/sagetrac-mirror/actions/runs/1814856715
https://github.com/sagemath/sagetrac-mirror/blob/public/build/refactor-ci-runtests/.github/workflows/ci-docker.yml



---

archive/issue_comments_533867.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nOK, so to summarize, the revised plan of [comment:30](#comment:30) would be:\n\n- Job \"prebuild\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images\n- Job \"build\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images\n- Job \"test-basic\": (minimal, standard) for each system - build sage, run tests\n- Job \"test-optional\": (maximal) for each system - build sage with optional packages, run tests\n\nThis would work. Minor detail: After this change, prebuild and build would build the union of the platforms currently run for \"standard\" and for \"maximal\". That's a small change, but that would be fine with me.",
    "created_at": "2022-02-09T21:01:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533867",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">comment:39</div>

OK, so to summarize, the revised plan of [comment:30](#comment:30) would be:

- Job "prebuild": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images
- Job "build": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images
- Job "test-basic": (minimal, standard) for each system - build sage, run tests
- Job "test-optional": (maximal) for each system - build sage with optional packages, run tests

This would work. Minor detail: After this change, prebuild and build would build the union of the platforms currently run for "standard" and for "maximal". That's a small change, but that would be fine with me.



---

archive/issue_comments_533868.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nIn fact, the first two jobs should probably be named \"targets-pre\" and \"targets\"",
    "created_at": "2022-02-09T21:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533868",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

In fact, the first two jobs should probably be named "targets-pre" and "targets"



---

archive/issue_comments_533869.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@mkoeppe](#comment:39):\n> OK, so to summarize, the revised plan of [comment:30](#comment:30) would be:\n> \n> - Job \"prebuild\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images\n> - Job \"build\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images\n> - Job \"test-basic\": (minimal, standard) for each system - build sage, run tests\n> - Job \"test-optional\": (maximal) for each system - build sage with optional packages, run tests\n> \n\nYes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).",
    "created_at": "2022-02-10T15:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533869",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@mkoeppe](#comment:39):
> OK, so to summarize, the revised plan of [comment:30](#comment:30) would be:
> 
> - Job "prebuild": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images
> - Job "build": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images
> - Job "test-basic": (minimal, standard) for each system - build sage, run tests
> - Job "test-optional": (maximal) for each system - build sage with optional packages, run tests
> 

Yes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).



---

archive/issue_comments_533870.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@mkoeppe](#comment:40):\n> In fact, the first two jobs should probably be named \"targets-pre\" and \"targets\" \n\nTo be honest, I don't find \"targets\" a very illuminating name.",
    "created_at": "2022-02-10T15:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533870",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@mkoeppe](#comment:40):
> In fact, the first two jobs should probably be named "targets-pre" and "targets" 

To be honest, I don't find "targets" a very illuminating name.



---

archive/issue_comments_533871.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nA \"target\" is what make makes",
    "created_at": "2022-02-10T18:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533871",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">comment:43</div>

A "target" is what make makes



---

archive/issue_comments_533872.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nBut why is this information important for the docker images and the ci steps? I find something like `with-system-packages` or `with-python-packages` more descriptive.",
    "created_at": "2022-02-11T08:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533872",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:44" align="right">comment:44</div>

But why is this information important for the docker images and the ci steps? I find something like `with-system-packages` or `with-python-packages` more descriptive.



---

archive/issue_comments_533873.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\n`with-system-packages` already exists and it's not that",
    "created_at": "2022-02-11T18:36:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533873",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

`with-system-packages` already exists and it's not that



---

archive/issue_comments_533874.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nConsistency matters. Can't invent a new name for the same thing at every turn.",
    "created_at": "2022-02-11T18:45:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533874",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

Consistency matters. Can't invent a new name for the same thing at every turn.



---

archive/issue_comments_533875.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0590cd412c2e6075157684dfac991f1f9bebc776\"><code>0590cd4</code></a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bbb9a9398320a8aaf5bf2a99d1f08fd6607900d\"><code>1bbb9a9</code></a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd6c0e01ee2a92dce9caccdbce232f67c4584f6b\"><code>dd6c0e0</code></a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15f5bb26ed3000d1ff86ebcb72279b37b819eda2\"><code>15f5bb2</code></a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa\"><code>7bc769b</code></a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>\n",
    "created_at": "2022-02-13T18:45:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533875",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0590cd412c2e6075157684dfac991f1f9bebc776"><code>0590cd4</code></a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bbb9a9398320a8aaf5bf2a99d1f08fd6607900d"><code>1bbb9a9</code></a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd6c0e01ee2a92dce9caccdbce232f67c4584f6b"><code>dd6c0e0</code></a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15f5bb26ed3000d1ff86ebcb72279b37b819eda2"><code>15f5bb2</code></a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa"><code>7bc769b</code></a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>




---

archive/issue_comments_533876.json:
```json
{
    "body": "Changed commit from **[`47b636d`](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)** to **[`7bc769b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)**",
    "created_at": "2022-02-13T18:45:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533876",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`47b636d`](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)** to **[`7bc769b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)**



---

archive/issue_comments_533877.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nRebased",
    "created_at": "2022-02-13T18:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533877",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:48" align="right">comment:48</div>

Rebased



---

archive/issue_comments_533878.json:
```json
{
    "body": "Changed dependencies from **#33103, #33140** to none",
    "created_at": "2022-02-13T18:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533878",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#33103, #33140** to none



---

archive/issue_comments_533879.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1804137820** to **https://github.com/mkoeppe/sage/actions/runs/1837680413**",
    "created_at": "2022-02-13T19:02:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533879",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1804137820** to **https://github.com/mkoeppe/sage/actions/runs/1837680413**



---

archive/issue_comments_533880.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@tobiasdiez](#comment:41):\n> Replying to [@mkoeppe](#comment:39):\n> > OK, so to summarize, the revised plan of [comment:30](#comment:30) would be:\n> > \n> > - Job \"prebuild\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images\n> > - Job \"build\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images\n> > - Job \"test-basic\": (minimal, standard) for each system - build sage, run tests\n> > - Job \"test-optional\": (maximal) for each system - build sage with optional packages, run tests\n> > \n\n> \n> Yes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).\n\nNo objections if you want to do this work. On the present ticket, I don't want to start with reusable workflows though. I have opened #33338 for such refactoring steps.",
    "created_at": "2022-02-13T19:37:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533880",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@tobiasdiez](#comment:41):
> Replying to [@mkoeppe](#comment:39):
> > OK, so to summarize, the revised plan of [comment:30](#comment:30) would be:
> > 
> > - Job "prebuild": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images
> > - Job "build": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images
> > - Job "test-basic": (minimal, standard) for each system - build sage, run tests
> > - Job "test-optional": (maximal) for each system - build sage with optional packages, run tests
> > 

> 
> Yes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).

No objections if you want to do this work. On the present ticket, I don't want to start with reusable workflows though. I have opened #33338 for such refactoring steps.



---

archive/issue_comments_533881.json:
```json
{
    "body": "Dependencies: **#33306**",
    "created_at": "2022-02-13T19:39:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533881",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#33306**



---

archive/issue_comments_533882.json:
```json
{
    "body": "Changed commit from **[`7bc769b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)** to **[`2ed27f1`](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)**",
    "created_at": "2022-02-13T19:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533882",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7bc769b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)** to **[`2ed27f1`](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)**



---

archive/issue_comments_533883.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a12596849a909006e23d8717e5c17b38494238e\"><code>0a12596</code></a></td><td><code>tox.ini (slackware-current): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad913dbf4dd9458a034b6bbab25e2e2d04696d59\"><code>ad913db</code></a></td><td><code>tox.ini (opensuse-15.2.1,-15.4): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d789f61582647c1bc7bb34ed2ca49fb734c741c\"><code>8d789f6</code></a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add python3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c62fc35f853ba1479d7ac0653dc5d4e2ab2143f9\"><code>c62fc35</code></a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add packages needed on -current</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/928629905f47c8772aa7d7020585f076ca09c6ad\"><code>9286299</code></a></td><td><code>Merge #33196</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5dca4aa8717c3810baf2a2dc5ea20ccdf7ae6ee\"><code>a5dca4a</code></a></td><td><code>tox.ini (centos-8): Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1167bd54c7b8baeaa682ae9aa78c7cf7801299a\"><code>b1167bd</code></a></td><td><code>.github/workflows/tox*.yml: Replace centos-8 by centos-stream-8</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4898796562b32114c514ab0fb439049c0c63d56a\"><code>4898796</code></a></td><td><code>.github/workflows/tox*.yml: Replace opensuse-15 (same as opensuse-15.3) by opensuse-15.2.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e26283aba1acc1315af0aef7ecdc2d2d030f336f\"><code>e26283a</code></a></td><td><code>Merge #33103</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1\"><code>2ed27f1</code></a></td><td><code>Merge #33306</code></td></tr></table>\n",
    "created_at": "2022-02-13T19:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533883",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a12596849a909006e23d8717e5c17b38494238e"><code>0a12596</code></a></td><td><code>tox.ini (slackware-current): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad913dbf4dd9458a034b6bbab25e2e2d04696d59"><code>ad913db</code></a></td><td><code>tox.ini (opensuse-15.2.1,-15.4): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d789f61582647c1bc7bb34ed2ca49fb734c741c"><code>8d789f6</code></a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add python3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c62fc35f853ba1479d7ac0653dc5d4e2ab2143f9"><code>c62fc35</code></a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add packages needed on -current</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/928629905f47c8772aa7d7020585f076ca09c6ad"><code>9286299</code></a></td><td><code>Merge #33196</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5dca4aa8717c3810baf2a2dc5ea20ccdf7ae6ee"><code>a5dca4a</code></a></td><td><code>tox.ini (centos-8): Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1167bd54c7b8baeaa682ae9aa78c7cf7801299a"><code>b1167bd</code></a></td><td><code>.github/workflows/tox*.yml: Replace centos-8 by centos-stream-8</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4898796562b32114c514ab0fb439049c0c63d56a"><code>4898796</code></a></td><td><code>.github/workflows/tox*.yml: Replace opensuse-15 (same as opensuse-15.3) by opensuse-15.2.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e26283aba1acc1315af0aef7ecdc2d2d030f336f"><code>e26283a</code></a></td><td><code>Merge #33103</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1"><code>2ed27f1</code></a></td><td><code>Merge #33306</code></td></tr></table>




---

archive/issue_comments_533884.json:
```json
{
    "body": "Changed commit from **[`2ed27f1`](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)** to **[`21cfb54`](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)**",
    "created_at": "2022-02-14T01:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533884",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2ed27f1`](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)** to **[`21cfb54`](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)**



---

archive/issue_comments_533885.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f\"><code>21cfb54</code></a></td><td><code>.github/workflows/ci-linux.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>\n",
    "created_at": "2022-02-14T01:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533885",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f"><code>21cfb54</code></a></td><td><code>.github/workflows/ci-linux.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>




---

archive/issue_comments_533886.json:
```json
{
    "body": "Changed commit from **[`21cfb54`](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)** to **[`bfe561f`](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)**",
    "created_at": "2022-02-14T01:02:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533886",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`21cfb54`](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)** to **[`bfe561f`](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)**



---

archive/issue_comments_533887.json:
```json
{
    "body": "<div id=\"comment:54\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5\"><code>bfe561f</code></a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>\n",
    "created_at": "2022-02-14T01:02:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533887",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:54"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5"><code>bfe561f</code></a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>




---

archive/issue_events_454930.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-14T04:21:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454930"
}
```



---

archive/issue_events_454931.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-14T04:21:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454931"
}
```



---

archive/issue_comments_533888.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1837680413** to **https://github.com/mkoeppe/sage/actions/runs/1838573370**",
    "created_at": "2022-02-14T04:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533888",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1837680413** to **https://github.com/mkoeppe/sage/actions/runs/1838573370**



---

archive/issue_comments_533889.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@mkoeppe](#comment:37):\n> Replying to [@tobiasdiez](#comment:32):\n> > Replying to [@mkoeppe](#comment:31):\n> > > Job \"build\" does not reliably fit into 6 hours.\n\n> > \n> > You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). \n\n> \n> No, that's likely only a sporadic failure.\n\nActually it was building too much, fixed now in bfe561f",
    "created_at": "2022-02-14T04:24:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533889",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@mkoeppe](#comment:37):
> Replying to [@tobiasdiez](#comment:32):
> > Replying to [@mkoeppe](#comment:31):
> > > Job "build" does not reliably fit into 6 hours.

> > 
> > You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). 

> 
> No, that's likely only a sporadic failure.

Actually it was building too much, fixed now in bfe561f



---

archive/issue_comments_533890.json:
```json
{
    "body": "Changed commit from **[`bfe561f`](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)** to **[`7961b22`](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)**",
    "created_at": "2022-02-14T07:04:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533890",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bfe561f`](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)** to **[`7961b22`](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)**



---

archive/issue_comments_533891.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a\"><code>7961b22</code></a></td><td><code>.github/workflows/ci-linux.yml: Fix typo in system list</code></td></tr></table>\n",
    "created_at": "2022-02-14T07:04:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533891",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:57"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a"><code>7961b22</code></a></td><td><code>.github/workflows/ci-linux.yml: Fix typo in system list</code></td></tr></table>




---

archive/issue_comments_533892.json:
```json
{
    "body": "Work Issues: **reduce Docker layers**",
    "created_at": "2022-02-14T17:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533892",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **reduce Docker layers**



---

archive/issue_comments_533893.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\n`opensuse-15.3-maximal`:\n\n```\n#135 [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details \"pkgconfig(gf2x)\" || echo \"(ignoring error)\"\n#135 sha256:da2e30a5ebcf7a7f99e521987cff4345a05792735e3866c4f70a29402e19512e\n#135 ERROR: failed to prepare 956694vunjg38oyu4pzr7kgxx: max depth exceeded\n```\nHere `build/bin/write-dockerfile.sh` uses too many `RUN` commands because `$EXISTS` is not defined",
    "created_at": "2022-02-14T17:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533893",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

`opensuse-15.3-maximal`:

```
#135 [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details "pkgconfig(gf2x)" || echo "(ignoring error)"
#135 sha256:da2e30a5ebcf7a7f99e521987cff4345a05792735e3866c4f70a29402e19512e
#135 ERROR: failed to prepare 956694vunjg38oyu4pzr7kgxx: max depth exceeded
```
Here `build/bin/write-dockerfile.sh` uses too many `RUN` commands because `$EXISTS` is not defined



---

archive/issue_events_454932.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-14T17:47:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454932"
}
```



---

archive/issue_events_454933.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-14T17:47:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454933"
}
```



---

archive/issue_comments_533894.json:
```json
{
    "body": "Changed commit from **[`7961b22`](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)** to **[`7f1dc97`](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)**",
    "created_at": "2022-02-14T22:45:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533894",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7961b22`](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)** to **[`7f1dc97`](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)**



---

archive/issue_comments_533895.json:
```json
{
    "body": "<div id=\"comment:59\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375\"><code>7f1dc97</code></a></td><td><code>build/bin/write-dockerfile.sh (opensuse): Define EXISTS</code></td></tr></table>\n",
    "created_at": "2022-02-14T22:45:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533895",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375"><code>7f1dc97</code></a></td><td><code>build/bin/write-dockerfile.sh (opensuse): Define EXISTS</code></td></tr></table>




---

archive/issue_comments_533896.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nAlso caching still does not seem to work reliably.\n\nFor example, https://github.com/mkoeppe/sage/runs/5178183571?check_suite_focus=true has pushed like `ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-minimal-configured:9.5-81701-ge8de33c091`, and https://github.com/mkoeppe/sage/runs/5178187220?check_suite_focus=true is able to download it; but it proceeds to build everything from scratch, which leads to the 6h-timeout",
    "created_at": "2022-02-14T22:48:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533896",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

Also caching still does not seem to work reliably.

For example, https://github.com/mkoeppe/sage/runs/5178183571?check_suite_focus=true has pushed like `ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-minimal-configured:9.5-81701-ge8de33c091`, and https://github.com/mkoeppe/sage/runs/5178187220?check_suite_focus=true is able to download it; but it proceeds to build everything from scratch, which leads to the 6h-timeout



---

archive/issue_comments_533897.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nMaybe use the github workflow run id as the docker tag?",
    "created_at": "2022-02-15T12:22:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533897",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:61" align="right">comment:61</div>

Maybe use the github workflow run id as the docker tag?



---

archive/issue_comments_533898.json:
```json
{
    "body": "Changed commit from **[`7f1dc97`](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)** to **[`ac4d5ff`](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)**",
    "created_at": "2022-02-15T17:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533898",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7f1dc97`](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)** to **[`ac4d5ff`](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)**



---

archive/issue_comments_533899.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1\"><code>ac4d5ff</code></a></td><td><code>.github/workflows/ci-linux.yml: Use same TARGETS_PRE, TARGETS for all stages; do not push 2-optional*, 2-experimental*</code></td></tr></table>\n",
    "created_at": "2022-02-15T17:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533899",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1"><code>ac4d5ff</code></a></td><td><code>.github/workflows/ci-linux.yml: Use same TARGETS_PRE, TARGETS for all stages; do not push 2-optional*, 2-experimental*</code></td></tr></table>




---

archive/issue_comments_533900.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@tobiasdiez](#comment:61):\n> Maybe use the github workflow run id as the docker tag?\n\nI think this was not the problem",
    "created_at": "2022-02-15T19:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533900",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@tobiasdiez](#comment:61):
> Maybe use the github workflow run id as the docker tag?

I think this was not the problem



---

archive/issue_comments_533901.json:
```json
{
    "body": "Changed work issues from **reduce Docker layers** to none",
    "created_at": "2022-02-15T19:10:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533901",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **reduce Docker layers** to none



---

archive/issue_comments_533902.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1838573370** to **https://github.com/mkoeppe/sage/actions/runs/1848506228**",
    "created_at": "2022-02-15T19:10:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533902",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1838573370** to **https://github.com/mkoeppe/sage/actions/runs/1848506228**



---

archive/issue_comments_533903.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nStill broken - e.g. https://github.com/mkoeppe/sage/runs/5204591833?check_suite_focus=true",
    "created_at": "2022-02-16T19:14:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533903",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:65" align="right">comment:65</div>

Still broken - e.g. https://github.com/mkoeppe/sage/runs/5204591833?check_suite_focus=true



---

archive/issue_events_454934.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454934"
}
```



---

archive/issue_events_454935.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454935"
}
```



---

archive/issue_comments_533904.json:
```json
{
    "body": "Work Issues: **rebase on #33788**",
    "created_at": "2022-05-03T00:49:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533904",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **rebase on #33788**



---

archive/issue_comments_533905.json:
```json
{
    "body": "Changed dependencies from **#33306** to **#33788**",
    "created_at": "2022-05-03T00:49:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533905",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#33306** to **#33788**



---

archive/issue_comments_533906.json:
```json
{
    "body": "Changed dependencies from **#33788** to **#33788, #34115, #34228**",
    "created_at": "2022-07-27T19:21:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533906",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#33788** to **#33788, #34115, #34228**



---

archive/issue_comments_533907.json:
```json
{
    "body": "Changed commit from **[`ac4d5ff`](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)** to **[`cce8fca`](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)**",
    "created_at": "2022-07-28T04:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533907",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ac4d5ff`](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)** to **[`cce8fca`](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)**



---

archive/issue_comments_533908.json:
```json
{
    "body": "<div id=\"comment:69\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3d2200413dd20996ea3018e9501f1253d2ee61b\"><code>a3d2200</code></a></td><td><code>.github/workflows/tox-{optional,experimental}: Remove ubuntu-{hirsute,impish} here too</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03c312420a03337e5a3973de3cea5b865f6008ac\"><code>03c3124</code></a></td><td><code>Merge #34115</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9eaae57c9cf70c8bc0ed2968beb584906134927\"><code>a9eaae5</code></a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add 'tox -e docker-...-incremental'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9bfbf9f0ae96f79d514cd665c46b182337dd711\"><code>b9bfbf9</code></a></td><td><code>tox.ini: Add comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c0d7f50b18f78ce561eccfc3a6c1196887dc226\"><code>4c0d7f5</code></a></td><td><code>tox.ini: Use FROM_DOCKER_REPOSITORY</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a07874d2f2443785cc0a295d2d8989ab380d79d2\"><code>a07874d</code></a></td><td><code>build/bin/write-dockerfile.sh: In incremental build, keep logs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b254da70ced376d5e2d443340b742d07c912da16\"><code>b254da7</code></a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51a335b5d3816672f6ff4ee64f7e569fa352bccf\"><code>51a335b</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f8ef7a433f9e767b9e3c9666df26709c7316110\"><code>6f8ef7a</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e\"><code>cce8fca</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr></table>\n",
    "created_at": "2022-07-28T04:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533908",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:69"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3d2200413dd20996ea3018e9501f1253d2ee61b"><code>a3d2200</code></a></td><td><code>.github/workflows/tox-{optional,experimental}: Remove ubuntu-{hirsute,impish} here too</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03c312420a03337e5a3973de3cea5b865f6008ac"><code>03c3124</code></a></td><td><code>Merge #34115</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9eaae57c9cf70c8bc0ed2968beb584906134927"><code>a9eaae5</code></a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add 'tox -e docker-...-incremental'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9bfbf9f0ae96f79d514cd665c46b182337dd711"><code>b9bfbf9</code></a></td><td><code>tox.ini: Add comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c0d7f50b18f78ce561eccfc3a6c1196887dc226"><code>4c0d7f5</code></a></td><td><code>tox.ini: Use FROM_DOCKER_REPOSITORY</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a07874d2f2443785cc0a295d2d8989ab380d79d2"><code>a07874d</code></a></td><td><code>build/bin/write-dockerfile.sh: In incremental build, keep logs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b254da70ced376d5e2d443340b742d07c912da16"><code>b254da7</code></a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51a335b5d3816672f6ff4ee64f7e569fa352bccf"><code>51a335b</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f8ef7a433f9e767b9e3c9666df26709c7316110"><code>6f8ef7a</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e"><code>cce8fca</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr></table>




---

archive/issue_comments_533909.json:
```json
{
    "body": "Changed work issues from **rebase on #33788** to none",
    "created_at": "2022-07-28T04:24:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533909",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **rebase on #33788** to none



---

archive/issue_comments_533910.json:
```json
{
    "body": "Changed dependencies from **#33788, #34115, #34228** to **#34115, #34228**",
    "created_at": "2022-07-28T04:24:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533910",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#33788, #34115, #34228** to **#34115, #34228**



---

archive/issue_comments_533911.json:
```json
{
    "body": "<div id=\"comment:71\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61f90630d77c8957b95e943ee4d3c15a863d3743\"><code>61f9063</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ecd6b198b221d0df602139392cd53549f6943b8\"><code>1ecd6b1</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794\"><code>6d3caa2</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>\n",
    "created_at": "2022-07-28T06:42:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533911",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:71"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61f90630d77c8957b95e943ee4d3c15a863d3743"><code>61f9063</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ecd6b198b221d0df602139392cd53549f6943b8"><code>1ecd6b1</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794"><code>6d3caa2</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>




---

archive/issue_comments_533912.json:
```json
{
    "body": "Changed commit from **[`cce8fca`](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)** to **[`6d3caa2`](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)**",
    "created_at": "2022-07-28T06:42:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533912",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cce8fca`](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)** to **[`6d3caa2`](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)**



---

archive/issue_comments_533913.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,28 +1,5 @@\n Follow up from #32703, where this was implemented for macOS.\n \n-Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n+Here we implement it for the `docker`-based workflows \n+via incremental builds (#34228) on top of previous stages pushed to ghcr.io\n \n-To use for local builds via tox:\n-\n-```\n-$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard\n- => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s\n-```\n-\n-\n-(split out from #33222)\n-\n-We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. \n-\n``````\n",
    "created_at": "2022-07-28T06:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533913",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,28 +1,5 @@
 Follow up from #32703, where this was implemented for macOS.
 
-Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
+Here we implement it for the `docker`-based workflows 
+via incremental builds (#34228) on top of previous stages pushed to ghcr.io
 
-To use for local builds via tox:
-
-```
-$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard
- => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s
-```
-
-
-(split out from #33222)
-
-We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. 
-
``````




---

archive/issue_comments_533914.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1848506228** to **https://github.com/mkoeppe/sage/actions/runs/2751836720**",
    "created_at": "2022-07-28T06:54:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533914",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1848506228** to **https://github.com/mkoeppe/sage/actions/runs/2751836720**



---

archive/issue_comments_533915.json:
```json
{
    "body": "Changed commit from **[`6d3caa2`](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)** to **[`31c5be9`](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)**",
    "created_at": "2022-07-28T23:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533915",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6d3caa2`](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)** to **[`31c5be9`](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)**



---

archive/issue_comments_533916.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ae269d17726a4ac6383b9645995d8c1f4c9b3f6d\"><code>ae269d1</code></a></td><td><code>tox.ini (docker-incremental): Do not include '-incremental' in the Docker image name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d01263a7d3be04dfae133874786e4790064dca9c\"><code>d01263a</code></a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec79d4f182c2bde9e301a63dc90158181f6b2128\"><code>ec79d4f</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1caf6dbcc89c5033e2fc4b05455e3d906d7a4a6\"><code>e1caf6d</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208\"><code>31c5be9</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>\n",
    "created_at": "2022-07-28T23:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533916",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ae269d17726a4ac6383b9645995d8c1f4c9b3f6d"><code>ae269d1</code></a></td><td><code>tox.ini (docker-incremental): Do not include '-incremental' in the Docker image name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d01263a7d3be04dfae133874786e4790064dca9c"><code>d01263a</code></a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec79d4f182c2bde9e301a63dc90158181f6b2128"><code>ec79d4f</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1caf6dbcc89c5033e2fc4b05455e3d906d7a4a6"><code>e1caf6d</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208"><code>31c5be9</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>




---

archive/issue_comments_533917.json:
```json
{
    "body": "Changed commit from **[`31c5be9`](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)** to **[`951130a`](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)**",
    "created_at": "2022-07-28T23:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533917",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`31c5be9`](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)** to **[`951130a`](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)**



---

archive/issue_comments_533918.json:
```json
{
    "body": "<div id=\"comment:75\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89\"><code>951130a</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>\n",
    "created_at": "2022-07-28T23:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533918",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:75"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89"><code>951130a</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>




---

archive/issue_comments_533919.json:
```json
{
    "body": "Changed commit from **[`951130a`](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)** to **[`5b425ac`](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)**",
    "created_at": "2022-07-29T10:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533919",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`951130a`](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)** to **[`5b425ac`](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)**



---

archive/issue_comments_533920.json:
```json
{
    "body": "<div id=\"comment:76\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e\"><code>5b425ac</code></a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>\n",
    "created_at": "2022-07-29T10:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533920",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:76"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e"><code>5b425ac</code></a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>




---

archive/issue_comments_533921.json:
```json
{
    "body": "Changed commit from **[`5b425ac`](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)** to **[`31c4722`](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)**",
    "created_at": "2022-08-01T06:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533921",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5b425ac`](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)** to **[`31c4722`](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)**



---

archive/issue_comments_533922.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b354a3873b4c6fac29dee7bbd5fbf3ef6a35d8f5\"><code>b354a38</code></a></td><td><code>tox.ini, .github/workflows/docker.yml: Reimplement -incremental via SKIP_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5decadde7ae1985ab6a1b44fb52564972635f281\"><code>5decadd</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c32034cfc546afcb1043a11ab81083dec3d92be\"><code>6c32034</code></a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/979779a5312576714f12bf5bd7266de6b7884e47\"><code>979779a</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/326f61dc6ff96d15019954b55f4de87298f5e96c\"><code>326f61d</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4\"><code>31c4722</code></a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>\n",
    "created_at": "2022-08-01T06:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533922",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:77"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b354a3873b4c6fac29dee7bbd5fbf3ef6a35d8f5"><code>b354a38</code></a></td><td><code>tox.ini, .github/workflows/docker.yml: Reimplement -incremental via SKIP_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5decadde7ae1985ab6a1b44fb52564972635f281"><code>5decadd</code></a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c32034cfc546afcb1043a11ab81083dec3d92be"><code>6c32034</code></a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/979779a5312576714f12bf5bd7266de6b7884e47"><code>979779a</code></a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/326f61dc6ff96d15019954b55f4de87298f5e96c"><code>326f61d</code></a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4"><code>31c4722</code></a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>




---

archive/issue_comments_533923.json:
```json
{
    "body": "<div id=\"comment:78\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6ee7a59e10f0be55c84bac109c0739f163e3968\"><code>a6ee7a5</code></a></td><td><code>.github/workflows/ci-linux.yml: Use success() | failure()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3\"><code>f2b52ef</code></a></td><td><code>.github/workflows/ci-linux.yml: First run all 'standard' jobs, then 'minimal', ...</code></td></tr></table>\n",
    "created_at": "2022-08-01T06:33:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533923",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:78"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6ee7a59e10f0be55c84bac109c0739f163e3968"><code>a6ee7a5</code></a></td><td><code>.github/workflows/ci-linux.yml: Use success() | failure()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3"><code>f2b52ef</code></a></td><td><code>.github/workflows/ci-linux.yml: First run all 'standard' jobs, then 'minimal', ...</code></td></tr></table>




---

archive/issue_comments_533924.json:
```json
{
    "body": "Changed commit from **[`31c4722`](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)** to **[`f2b52ef`](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)**",
    "created_at": "2022-08-01T06:33:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533924",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`31c4722`](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)** to **[`f2b52ef`](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)**



---

archive/issue_comments_533925.json:
```json
{
    "body": "<div id=\"comment:79\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100\"><code>ca6d163</code></a></td><td><code>.github/workflows/ci-linux.yml: Rename stages</code></td></tr></table>\n",
    "created_at": "2022-08-01T06:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533925",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:79"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100"><code>ca6d163</code></a></td><td><code>.github/workflows/ci-linux.yml: Rename stages</code></td></tr></table>




---

archive/issue_comments_533926.json:
```json
{
    "body": "Changed commit from **[`f2b52ef`](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)** to **[`ca6d163`](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)**",
    "created_at": "2022-08-01T06:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533926",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f2b52ef`](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)** to **[`ca6d163`](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)**



---

archive/issue_events_454936.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T06:45:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454936"
}
```



---

archive/issue_events_454937.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T06:45:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454937"
}
```



---

archive/issue_comments_533927.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,4 @@\n Here we implement it for the `docker`-based workflows \n via incremental builds (#34228) on top of previous stages pushed to ghcr.io\n \n+\n``````\n",
    "created_at": "2022-08-01T06:54:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533927",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,4 @@
 Here we implement it for the `docker`-based workflows 
 via incremental builds (#34228) on top of previous stages pushed to ghcr.io
 
+
``````




---

archive/issue_comments_533928.json:
```json
{
    "body": "Work Issues: **TARGETS_OPTIONAL not passed correctly**",
    "created_at": "2022-08-03T04:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533928",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **TARGETS_OPTIONAL not passed correctly**



---

archive/issue_events_454938.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-03T04:08:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454938"
}
```



---

archive/issue_events_454939.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-03T04:08:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454939"
}
```



---

archive/issue_comments_533929.json:
```json
{
    "body": "<div id=\"comment:83\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8\"><code>5713937</code></a></td><td><code>sage -package list --has-file, --no-file: Handle disjunctions</code></td></tr></table>\n",
    "created_at": "2022-08-03T05:44:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533929",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:83"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8"><code>5713937</code></a></td><td><code>sage -package list --has-file, --no-file: Handle disjunctions</code></td></tr></table>




---

archive/issue_comments_533930.json:
```json
{
    "body": "Changed commit from **[`ca6d163`](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)** to **[`5713937`](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)**",
    "created_at": "2022-08-03T05:44:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533930",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ca6d163`](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)** to **[`5713937`](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)**



---

archive/issue_events_454940.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-03T06:12:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454940"
}
```



---

archive/issue_events_454941.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-03T06:12:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454941"
}
```



---

archive/issue_comments_533931.json:
```json
{
    "body": "Changed work issues from **TARGETS_OPTIONAL not passed correctly** to none",
    "created_at": "2022-08-03T06:12:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533931",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **TARGETS_OPTIONAL not passed correctly** to none



---

archive/issue_comments_533932.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nMarking it as critical because it is a dependency of #34266",
    "created_at": "2022-09-19T16:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533932",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:85" align="right">comment:85</div>

Marking it as critical because it is a dependency of #34266



---

archive/issue_events_454942.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T16:06:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454942"
}
```



---

archive/issue_events_454943.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T16:06:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454943"
}
```



---

archive/issue_events_454944.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454944"
}
```



---

archive/issue_events_454945.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454945"
}
```



---

archive/issue_events_454946.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-09-21T15:13:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454946"
}
```



---

archive/issue_events_454947.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-09-21T15:13:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454947"
}
```



---

archive/issue_comments_533933.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nlgtm",
    "created_at": "2022-09-21T15:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533933",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:87" align="right">comment:87</div>

lgtm



---

archive/issue_comments_533934.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/2751836720** to **Dima Pasechnik**",
    "created_at": "2022-09-21T15:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533934",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/2751836720** to **Dima Pasechnik**



---

archive/issue_comments_533935.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nThanks!",
    "created_at": "2022-09-21T15:19:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533935",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:88" align="right">comment:88</div>

Thanks!



---

archive/issue_comments_533936.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)** to **[`5713937`](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)**",
    "created_at": "2022-09-25T16:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33062#issuecomment-533936",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)** to **[`5713937`](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)**



---

archive/issue_events_454948.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-25T16:34:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454948"
}
```



---

archive/issue_events_454949.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "02bfe770f65217d006c048a09bffd2fe8d5caa3f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-09-25T16:34:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33062",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33062#event-454949"
}
```
