# Issue 33062: GH Actions (docker): Run a job for "make build-local" first, cache image for job "make build"

archive/issues_032825.json:
```json
{
    "body": "Follow up from #32703, where this was implemented for macOS.\n\nHere we implement it for the `docker`-based workflows \nvia incremental builds (#34228) on top of previous stages pushed to ghcr.io\n\n\n\n**CC:**  @tobiasdiez @dimpase\n\n**Branch/Commit:** [5713937de7ed72810013e0856b7ac0cca0d9b3e8](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Matthias Koeppe\n\n**Dependencies:** #34115, #34228\n\nIssue created by migration from https://trac.sagemath.org/ticket/33062\n\n",
    "closed_at": "2022-09-25T16:34:31Z",
    "created_at": "2021-12-21T17:27:28Z",
    "labels": [
        "component: porting",
        "critical",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "GH Actions (docker): Run a job for \"make build-local\" first, cache image for job \"make build\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33062",
    "user": "https://github.com/mkoeppe"
}
```
Follow up from #32703, where this was implemented for macOS.

Here we implement it for the `docker`-based workflows 
via incremental builds (#34228) on top of previous stages pushed to ghcr.io



**CC:**  @tobiasdiez @dimpase

**Branch/Commit:** [5713937de7ed72810013e0856b7ac0cca0d9b3e8](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)

**Reviewer:** Dima Pasechnik

**Author:** Matthias Koeppe

**Dependencies:** #34115, #34228

Issue created by migration from https://trac.sagemath.org/ticket/33062





---

archive/issue_comments_629813.json:
```json
{
    "body": "**Dependencies:** #30933, #33103, #33140",
    "created_at": "2022-01-13T18:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629813",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #30933, #33103, #33140



---

archive/issue_comments_629814.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n Follow up from #32703, where this was implemented for macOS.\n \n-Here we implement it for the `docker`-based workflows.\n-\n-References\n-- https://evilmartians.com/chronicles/build-images-on-github-actions-with-docker-layer-caching\n+Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n \n+\n+\n``````\n",
    "created_at": "2022-01-30T22:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629814",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
 Follow up from #32703, where this was implemented for macOS.
 
-Here we implement it for the `docker`-based workflows.
-
-References
-- https://evilmartians.com/chronicles/build-images-on-github-actions-with-docker-layer-caching
+Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
 
+
+
``````




---

archive/issue_comments_629815.json:
```json
{
    "body": "**Changing dependencies** from \"#30933, #33103, #33140\" to \"#33103, #33140, #33222\".",
    "created_at": "2022-01-30T22:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629815",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#30933, #33103, #33140" to "#33103, #33140, #33222".



---

archive/issue_comments_629816.json:
```json
{
    "body": "**Changing dependencies** from \"#33103, #33140, #33222\" to \"#33103, #33140\".",
    "created_at": "2022-02-05T19:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629816",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#33103, #33140, #33222" to "#33103, #33140".



---

archive/issue_comments_629817.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n+(split out from #33222)\n \n \n-\n``````\n",
    "created_at": "2022-02-05T19:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629817",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
+(split out from #33222)
 
 
-
``````




---

archive/issue_comments_629818.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)",
    "created_at": "2022-02-07T00:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629818",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)



---

archive/issue_comments_629819.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,6 +2,26 @@\n \n Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n+To use:\n+\n+```\n+$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard\n+ => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s\n+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s\n+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s\n+```\n+\n+\n (split out from #33222)\n \n \n``````\n",
    "created_at": "2022-02-07T00:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629819",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,6 +2,26 @@
 
 Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
+To use:
+
+```
+$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard
+ => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s
+ => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s
+ => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s
+```
+
+
 (split out from #33222)
 
 
``````




---

archive/issue_comments_629820.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/531cd1460659775baf84955457580baeb1b2f878\">531cd14</a></td><td><code>Merge #33103</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51191fe56dfaf5d721e6d5025e58c92804cafec1\">51191fe</a></td><td><code>.github/workflows/tox.yml (local-macos): Fix filtering of experimental packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12f88cfaafdd85b85f4ac117793cc4a2616476cc\">12f88cf</a></td><td><code>.github/workflows/tox.yml (local-macos): Group optional/experimental package builds into fewer jobs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49236ddcb076fccc4325dc2b3142fe8baab536be\">49236dd</a></td><td><code>tox.ini: Add local-macos-python3_pythonorg-python3.9 etc., refactor CONFIG_CONFIGURE_ARGS_1=...--with-python</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fcdc91d7f719b165c3cf912e500e831f5bb493e\">1fcdc91</a></td><td><code>tox.ini: Updates for macos and manylinux from #31396</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41ec3aa15693c69d68e9fdf2fae08e1999706a55\">41ec3aa</a></td><td><code>tox.ini: Reindent</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7066aa91fd1467cb08188deae7fbce35089c201\">d7066aa</a></td><td><code>Merge #33140</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/98a5bae95e6ab995acc1dc2bf227103f71f27731\">98a5bae</a></td><td><code>Merge tag '9.6.beta0' into t/33062/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c446d3331b2974c8f97e20818407b58fb9c474a0\">c446d33</a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030\">c9c7d9f</a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr></table>\n",
    "created_at": "2022-02-07T00:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629820",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/531cd1460659775baf84955457580baeb1b2f878">531cd14</a></td><td><code>Merge #33103</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51191fe56dfaf5d721e6d5025e58c92804cafec1">51191fe</a></td><td><code>.github/workflows/tox.yml (local-macos): Fix filtering of experimental packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12f88cfaafdd85b85f4ac117793cc4a2616476cc">12f88cf</a></td><td><code>.github/workflows/tox.yml (local-macos): Group optional/experimental package builds into fewer jobs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49236ddcb076fccc4325dc2b3142fe8baab536be">49236dd</a></td><td><code>tox.ini: Add local-macos-python3_pythonorg-python3.9 etc., refactor CONFIG_CONFIGURE_ARGS_1=...--with-python</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fcdc91d7f719b165c3cf912e500e831f5bb493e">1fcdc91</a></td><td><code>tox.ini: Updates for macos and manylinux from #31396</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41ec3aa15693c69d68e9fdf2fae08e1999706a55">41ec3aa</a></td><td><code>tox.ini: Reindent</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7066aa91fd1467cb08188deae7fbce35089c201">d7066aa</a></td><td><code>Merge #33140</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/98a5bae95e6ab995acc1dc2bf227103f71f27731">98a5bae</a></td><td><code>Merge tag '9.6.beta0' into t/33062/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c446d3331b2974c8f97e20818407b58fb9c474a0">c446d33</a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030">c9c7d9f</a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr></table>




---

archive/issue_comments_629821.json:
```json
{
    "body": "**Commit:** [c9c7d9f8d94870ea7c62af9f94508167b7da9030](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)",
    "created_at": "2022-02-07T00:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629821",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [c9c7d9f8d94870ea7c62af9f94508167b7da9030](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)



---

archive/issue_comments_629822.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n \n-To use:\n+To use for local builds via tox:\n \n ```\n $ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard\n``````\n",
    "created_at": "2022-02-07T00:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629822",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
 
-To use:
+To use for local builds via tox:
 
 ```
 $ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard
``````




---

archive/issue_comments_629823.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e56bf3e2602a51c30eac7a8b1eb96aba6db36286\">e56bf3e</a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270\">c830cdb</a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr></table>\n",
    "created_at": "2022-02-07T02:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629823",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e56bf3e2602a51c30eac7a8b1eb96aba6db36286">e56bf3e</a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270">c830cdb</a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr></table>




---

archive/issue_comments_629824.json:
```json
{
    "body": "**Changing commit** from \"[c9c7d9f8d94870ea7c62af9f94508167b7da9030](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)\" to \"[c830cdbff64b217077fc08ef787ceac2bb46c270](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)\".",
    "created_at": "2022-02-07T02:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629824",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c9c7d9f8d94870ea7c62af9f94508167b7da9030](https://github.com/sagemath/sagetrac-mirror/commit/c9c7d9f8d94870ea7c62af9f94508167b7da9030)" to "[c830cdbff64b217077fc08ef787ceac2bb46c270](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)".



---

archive/issue_comments_629825.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -24,4 +24,5 @@\n \n (split out from #33222)\n \n+We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. \n \n``````\n",
    "created_at": "2022-02-07T02:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629825",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -24,4 +24,5 @@
 
 (split out from #33222)
 
+We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. 
 
``````




---

archive/issue_comments_629826.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2022-02-07T02:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629826",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_629827.json:
```json
{
    "body": "**Reviewer:** https://github.com/mkoeppe/sage/actions/runs/1804137820",
    "created_at": "2022-02-07T02:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629827",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** https://github.com/mkoeppe/sage/actions/runs/1804137820



---

archive/issue_comments_629828.json:
```json
{
    "body": "<a id='comment:11'></a>\nObviously there is again a lot of cut+paste going on here, but I'm not sure yet whether this is best refactored using (1) scripts to be put in `.ci/`; (2) new top-level `Makefile` targets; (3) reusable workflows in the same repo; (4) reusable workflows from a different repo. So until then, copy+paste it is",
    "created_at": "2022-02-07T02:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629828",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Obviously there is again a lot of cut+paste going on here, but I'm not sure yet whether this is best refactored using (1) scripts to be put in `.ci/`; (2) new top-level `Makefile` targets; (3) reusable workflows in the same repo; (4) reusable workflows from a different repo. So until then, copy+paste it is



---

archive/issue_comments_629829.json:
```json
{
    "body": "**Changing commit** from \"[c830cdbff64b217077fc08ef787ceac2bb46c270](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)\" to \"[47b636d408735f106f3fc725678b2239d290868d](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)\".",
    "created_at": "2022-02-07T06:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629829",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c830cdbff64b217077fc08ef787ceac2bb46c270](https://github.com/sagemath/sagetrac-mirror/commit/c830cdbff64b217077fc08ef787ceac2bb46c270)" to "[47b636d408735f106f3fc725678b2239d290868d](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)".



---

archive/issue_comments_629830.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d\">47b636d</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>\n",
    "created_at": "2022-02-07T06:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629830",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d">47b636d</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>




---

archive/issue_comments_629831.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2022-02-07T06:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629831",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_629832.json:
```json
{
    "body": "<a id='comment:14'></a>\nA lot of jobs are failing because there doesn't exist a corresponding `maximal` image. \n\nWhat is the distinction between the `docker` and `docker-optional` jobs?",
    "created_at": "2022-02-07T12:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629832",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:14'></a>
A lot of jobs are failing because there doesn't exist a corresponding `maximal` image. 

What is the distinction between the `docker` and `docker-optional` jobs?



---

archive/issue_comments_629833.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [gh-tobiasdiez](#comment%3A14):\n> What is the distinction between the `docker` and `docker-optional` jobs?\n\n\n`docker-optional` also runs the stages that build optional and experimental packages.",
    "created_at": "2022-02-07T16:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629833",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Replying to [gh-tobiasdiez](#comment%3A14):
> What is the distinction between the `docker` and `docker-optional` jobs?


`docker-optional` also runs the stages that build optional and experimental packages.



---

archive/issue_comments_629834.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2022-02-07T16:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629834",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_629835.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [gh-tobiasdiez](#comment%3A14):\n> A lot of jobs are failing because there doesn't exist a corresponding `maximal` image. \n\n\nNot sure if that's it but there are a number of new failures introduced by switching to `DOCKER_BUILDKIT=1`, for example https://github.com/mkoeppe/sage/runs/5087229478?check_suite_focus=true\n\n```\n > [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details \"pkgconfig(gf2x)\" || echo \"(ignoring error)\":\n------\nfailed to prepare d4bec9ys962tp15dnd39jkkya: max depth exceeded\n```\n\nThis will require some changes in `build/bin/write-dockerfile.sh`",
    "created_at": "2022-02-07T16:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629835",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
Replying to [gh-tobiasdiez](#comment%3A14):
> A lot of jobs are failing because there doesn't exist a corresponding `maximal` image. 


Not sure if that's it but there are a number of new failures introduced by switching to `DOCKER_BUILDKIT=1`, for example https://github.com/mkoeppe/sage/runs/5087229478?check_suite_focus=true

```
 > [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details "pkgconfig(gf2x)" || echo "(ignoring error)":
------
failed to prepare d4bec9ys962tp15dnd39jkkya: max depth exceeded
```

This will require some changes in `build/bin/write-dockerfile.sh`



---

archive/issue_comments_629836.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [mkoeppe](#comment%3A15):\n> Replying to [gh-tobiasdiez](#comment%3A14):\n> > What is the distinction between the `docker` and `docker-optional` jobs?\n\n> \n> `docker-optional` also runs the stages that build optional and experimental packages.\n> \n\n\nOkay, thanks! Would it then make sense to base the `docker-optional` on the image created in the `docker` job to speed up the build (i.e. as a \"stage\")?",
    "created_at": "2022-02-07T17:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629836",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:18'></a>
Replying to [mkoeppe](#comment%3A15):
> Replying to [gh-tobiasdiez](#comment%3A14):
> > What is the distinction between the `docker` and `docker-optional` jobs?

> 
> `docker-optional` also runs the stages that build optional and experimental packages.
> 


Okay, thanks! Would it then make sense to base the `docker-optional` on the image created in the `docker` job to speed up the build (i.e. as a "stage")?



---

archive/issue_comments_629837.json:
```json
{
    "body": "<a id='comment:19'></a>\nIt's currently using a different package configuration (`-maximal` instead of `-standard`)",
    "created_at": "2022-02-07T18:24:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629837",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
It's currently using a different package configuration (`-maximal` instead of `-standard`)



---

archive/issue_comments_629838.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [mkoeppe](#comment%3A19):\n> It's currently using a different package configuration (`-maximal` instead of `-standard`)\n\n\nBut wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?",
    "created_at": "2022-02-07T21:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629838",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:20'></a>
Replying to [mkoeppe](#comment%3A19):
> It's currently using a different package configuration (`-maximal` instead of `-standard`)


But wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?



---

archive/issue_comments_629839.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [gh-tobiasdiez](#comment%3A20):\n> wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?\n\n\nYes, it is doing that. But it is only building optional packages on top of the `-maximal` configuration, not on top of the other configurations.",
    "created_at": "2022-02-07T22:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629839",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Replying to [gh-tobiasdiez](#comment%3A20):
> wasn't your idea with the stages, that the first stage should build all required images (i.e. minimal, standard, maximum) which could then be reused in different ways for the other stages?


Yes, it is doing that. But it is only building optional packages on top of the `-maximal` configuration, not on top of the other configurations.



---

archive/issue_comments_629840.json:
```json
{
    "body": "<a id='comment:22'></a>\nOkay, what confuses me is that it seems to not be part of the \"stage\" design in the sense that it's not using the stage-1 of the normal `docker` job.",
    "created_at": "2022-02-07T22:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629840",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:22'></a>
Okay, what confuses me is that it seems to not be part of the "stage" design in the sense that it's not using the stage-1 of the normal `docker` job.



---

archive/issue_comments_629841.json:
```json
{
    "body": "<a id='comment:23'></a>\nIt's using stage-1 of its own docker job because it needs \"maximal\", not \"minimal\"/\"standard\".",
    "created_at": "2022-02-07T22:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629841",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>
It's using stage-1 of its own docker job because it needs "maximal", not "minimal"/"standard".



---

archive/issue_comments_629842.json:
```json
{
    "body": "<a id='comment:24'></a>\nAh okay, now I understand. And it is not possible to have one common \"stage-1\" that build all three variants?",
    "created_at": "2022-02-07T22:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629842",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:24'></a>
Ah okay, now I understand. And it is not possible to have one common "stage-1" that build all three variants?



---

archive/issue_comments_629843.json:
```json
{
    "body": "<a id='comment:25'></a>\nGH Actions appears to be running on 8-bit technology: Matrix jobs that would create > 256 jobs are silently dropped from the workflow.",
    "created_at": "2022-02-07T23:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629843",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
GH Actions appears to be running on 8-bit technology: Matrix jobs that would create > 256 jobs are silently dropped from the workflow.



---

archive/issue_comments_629844.json:
```json
{
    "body": "<a id='comment:26'></a>\n... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.",
    "created_at": "2022-02-07T23:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629844",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.



---

archive/issue_comments_629845.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [mkoeppe](#comment%3A26):\n> ... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.\n\n\nWhy 6 stages? What I meant is that you have one job creating all docker images, then build jobs on top of this. I feel like this design is also more flexible, since you can easily run certain follow up stages only on a subset of configs.",
    "created_at": "2022-02-07T23:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629845",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:27'></a>
Replying to [mkoeppe](#comment%3A26):
> ... and 6 stages * 3 packages factors * 46(?) system factors would exceed that.


Why 6 stages? What I meant is that you have one job creating all docker images, then build jobs on top of this. I feel like this design is also more flexible, since you can easily run certain follow up stages only on a subset of configs.



---

archive/issue_comments_629846.json:
```json
{
    "body": "<a id='comment:28'></a>\n2 stages * 3 * 46 also exceeds 256.",
    "created_at": "2022-02-07T23:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629846",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
2 stages * 3 * 46 also exceeds 256.



---

archive/issue_comments_629847.json:
```json
{
    "body": "<a id='comment:29'></a>\nIn any case, the scope of the ticket is to change how it is build (= in 2 stages, to solve the 6-hour timeouts for some platforms).  I am keeping *what* is built/tested the same as before. One ticket, one change.",
    "created_at": "2022-02-08T00:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629847",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
In any case, the scope of the ticket is to change how it is build (= in 2 stages, to solve the 6-hour timeouts for some platforms).  I am keeping *what* is built/tested the same as before. One ticket, one change.



---

archive/issue_comments_629848.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [mkoeppe](#comment%3A28):\n> 2 stages * 3 * 46 also exceeds 256.\n\n\nMy point was that you shouldn't use the matrix for stages, so that you don't run into these constraints.\n- Job \"build\": (min, standard, max) for each system (=3 * 46 < 256) - build docker image\n- Job \"test-basic\": (min, standard) for each system - build sage, run tests\n- Job \"test-optional\": max for each system - build sage with optional packages, run tests\n\nThis would also keep what is build and runs in stages.",
    "created_at": "2022-02-08T10:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629848",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:30'></a>
Replying to [mkoeppe](#comment%3A28):
> 2 stages * 3 * 46 also exceeds 256.


My point was that you shouldn't use the matrix for stages, so that you don't run into these constraints.
- Job "build": (min, standard, max) for each system (=3 * 46 < 256) - build docker image
- Job "test-basic": (min, standard) for each system - build sage, run tests
- Job "test-optional": max for each system - build sage with optional packages, run tests

This would also keep what is build and runs in stages.



---

archive/issue_comments_629849.json:
```json
{
    "body": "<a id='comment:31'></a>\nJob \"build\" does not reliably fit into 6 hours.",
    "created_at": "2022-02-08T18:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629849",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
Job "build" does not reliably fit into 6 hours.



---

archive/issue_comments_629850.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [mkoeppe](#comment%3A31):\n> Job \"build\" does not reliably fit into 6 hours.\n\n\nYou seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). \n\nIn this case, you can selectively add a second stage for these problematic systems using matrices as in https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#example-including-new-combinations",
    "created_at": "2022-02-08T19:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629850",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:32'></a>
Replying to [mkoeppe](#comment%3A31):
> Job "build" does not reliably fit into 6 hours.


You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). 

In this case, you can selectively add a second stage for these problematic systems using matrices as in https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#example-including-new-combinations



---

archive/issue_comments_629851.json:
```json
{
    "body": "<a id='comment:33'></a>\nAnother reason for the split into the 2 build stages is explained in the ticket description of #32703.",
    "created_at": "2022-02-08T19:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629851",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
Another reason for the split into the 2 build stages is explained in the ticket description of #32703.



---

archive/issue_comments_629852.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [gh-tobiasdiez](#comment%3A32):\n> you can selectively add a second stage for these problematic systems using matrices\n\n\n-1",
    "created_at": "2022-02-08T19:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629852",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
Replying to [gh-tobiasdiez](#comment%3A32):
> you can selectively add a second stage for these problematic systems using matrices


-1



---

archive/issue_comments_629853.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [mkoeppe](#comment%3A33):\n> Another reason for the split into the 2 build stages is explained in the ticket description of #32703.\n> \n\n\nI don't see anything there that would be easier with matrix-stages over job-stages. In the contrary, the design I proposed above can easily be extended using additional jobs (that run on top of \"build\"). While your matrix-stage design would need an additional stage, which is not possible due to 3 stages * 2 configs * 46 systems > 256.",
    "created_at": "2022-02-08T20:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629853",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:35'></a>
Replying to [mkoeppe](#comment%3A33):
> Another reason for the split into the 2 build stages is explained in the ticket description of #32703.
> 


I don't see anything there that would be easier with matrix-stages over job-stages. In the contrary, the design I proposed above can easily be extended using additional jobs (that run on top of "build"). While your matrix-stage design would need an additional stage, which is not possible due to 3 stages * 2 configs * 46 systems > 256.



---

archive/issue_comments_629854.json:
```json
{
    "body": "<a id='comment:36'></a>\ncomment:31",
    "created_at": "2022-02-08T20:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629854",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>
comment:31



---

archive/issue_comments_629855.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [gh-tobiasdiez](#comment%3A32):\n> Replying to [mkoeppe](#comment%3A31):\n> > Job \"build\" does not reliably fit into 6 hours.\n\n> \n> You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). \n\n\nNo, that's likely only a sporadic failure.",
    "created_at": "2022-02-08T20:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629855",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
Replying to [gh-tobiasdiez](#comment%3A32):
> Replying to [mkoeppe](#comment%3A31):
> > Job "build" does not reliably fit into 6 hours.

> 
> You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). 


No, that's likely only a sporadic failure.



---

archive/issue_comments_629856.json:
```json
{
    "body": "<a id='comment:38'></a>\nHere is a version where I converted your first stage to a \"prebuild\" job. It runs exactly the same code (except if I made a mistake and missed some hidden environment variables). So the prebuild job timeouts iff if your stage 1 job would time out.\n\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/1814856715\nhttps://github.com/sagemath/sagetrac-mirror/blob/public/build/refactor-ci-runtests/.github/workflows/ci-docker.yml",
    "created_at": "2022-02-08T23:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629856",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:38'></a>
Here is a version where I converted your first stage to a "prebuild" job. It runs exactly the same code (except if I made a mistake and missed some hidden environment variables). So the prebuild job timeouts iff if your stage 1 job would time out.

https://github.com/sagemath/sagetrac-mirror/actions/runs/1814856715
https://github.com/sagemath/sagetrac-mirror/blob/public/build/refactor-ci-runtests/.github/workflows/ci-docker.yml



---

archive/issue_comments_629857.json:
```json
{
    "body": "<a id='comment:39'></a>\nOK, so to summarize, the revised plan of [comment:30](#comment%3A30) would be:\n\n- Job \"prebuild\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images\n- Job \"build\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images\n- Job \"test-basic\": (minimal, standard) for each system - build sage, run tests\n- Job \"test-optional\": (maximal) for each system - build sage with optional packages, run tests\n\nThis would work. Minor detail: After this change, prebuild and build would build the union of the platforms currently run for \"standard\" and for \"maximal\". That's a small change, but that would be fine with me.",
    "created_at": "2022-02-09T21:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629857",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
OK, so to summarize, the revised plan of [comment:30](#comment%3A30) would be:

- Job "prebuild": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images
- Job "build": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images
- Job "test-basic": (minimal, standard) for each system - build sage, run tests
- Job "test-optional": (maximal) for each system - build sage with optional packages, run tests

This would work. Minor detail: After this change, prebuild and build would build the union of the platforms currently run for "standard" and for "maximal". That's a small change, but that would be fine with me.



---

archive/issue_comments_629858.json:
```json
{
    "body": "<a id='comment:40'></a>\nIn fact, the first two jobs should probably be named \"targets-pre\" and \"targets\"",
    "created_at": "2022-02-09T21:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629858",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
In fact, the first two jobs should probably be named "targets-pre" and "targets"



---

archive/issue_comments_629859.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [mkoeppe](#comment%3A39):\n> OK, so to summarize, the revised plan of [comment:30](#comment%3A30) would be:\n> \n> - Job \"prebuild\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images\n> - Job \"build\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images\n> - Job \"test-basic\": (minimal, standard) for each system - build sage, run tests\n> - Job \"test-optional\": (maximal) for each system - build sage with optional packages, run tests\n> \n\n\nYes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).",
    "created_at": "2022-02-10T15:47:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629859",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:41'></a>
Replying to [mkoeppe](#comment%3A39):
> OK, so to summarize, the revised plan of [comment:30](#comment%3A30) would be:
> 
> - Job "prebuild": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images
> - Job "build": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images
> - Job "test-basic": (minimal, standard) for each system - build sage, run tests
> - Job "test-optional": (maximal) for each system - build sage with optional packages, run tests
> 


Yes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).



---

archive/issue_comments_629860.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [mkoeppe](#comment%3A40):\n> In fact, the first two jobs should probably be named \"targets-pre\" and \"targets\" \n\n\nTo be honest, I don't find \"targets\" a very illuminating name.",
    "created_at": "2022-02-10T15:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629860",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:42'></a>
Replying to [mkoeppe](#comment%3A40):
> In fact, the first two jobs should probably be named "targets-pre" and "targets" 


To be honest, I don't find "targets" a very illuminating name.



---

archive/issue_comments_629861.json:
```json
{
    "body": "<a id='comment:43'></a>\nA \"target\" is what make makes",
    "created_at": "2022-02-10T18:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629861",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>
A "target" is what make makes



---

archive/issue_comments_629862.json:
```json
{
    "body": "<a id='comment:44'></a>\nBut why is this information important for the docker images and the ci steps? I find something like `with-system-packages` or `with-python-packages` more descriptive.",
    "created_at": "2022-02-11T08:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629862",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:44'></a>
But why is this information important for the docker images and the ci steps? I find something like `with-system-packages` or `with-python-packages` more descriptive.



---

archive/issue_comments_629863.json:
```json
{
    "body": "<a id='comment:45'></a>\n`with-system-packages` already exists and it's not that",
    "created_at": "2022-02-11T18:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629863",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
`with-system-packages` already exists and it's not that



---

archive/issue_comments_629864.json:
```json
{
    "body": "<a id='comment:46'></a>\nConsistency matters. Can't invent a new name for the same thing at every turn.",
    "created_at": "2022-02-11T18:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629864",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>
Consistency matters. Can't invent a new name for the same thing at every turn.



---

archive/issue_comments_629865.json:
```json
{
    "body": "<a id='comment:47'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0590cd412c2e6075157684dfac991f1f9bebc776\">0590cd4</a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bbb9a9398320a8aaf5bf2a99d1f08fd6607900d\">1bbb9a9</a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd6c0e01ee2a92dce9caccdbce232f67c4584f6b\">dd6c0e0</a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15f5bb26ed3000d1ff86ebcb72279b37b819eda2\">15f5bb2</a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa\">7bc769b</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>\n",
    "created_at": "2022-02-13T18:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0590cd412c2e6075157684dfac991f1f9bebc776">0590cd4</a></td><td><code>.github/workflows, src/doc/en/developer/portability_testing.rst: Switch from docker.pkg.github.com to ghcr.io</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bbb9a9398320a8aaf5bf2a99d1f08fd6607900d">1bbb9a9</a></td><td><code>tox.ini (docker): Support Docker build layer caching</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd6c0e01ee2a92dce9caccdbce232f67c4584f6b">dd6c0e0</a></td><td><code>.github/workflows/tox.yml: Integrate optional and experimental  runs here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15f5bb26ed3000d1ff86ebcb72279b37b819eda2">15f5bb2</a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Split from tox.yml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa">7bc769b</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo</code></td></tr></table>




---

archive/issue_comments_629866.json:
```json
{
    "body": "**Changing commit** from \"[47b636d408735f106f3fc725678b2239d290868d](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)\" to \"[7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)\".",
    "created_at": "2022-02-13T18:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[47b636d408735f106f3fc725678b2239d290868d](https://github.com/sagemath/sagetrac-mirror/commit/47b636d408735f106f3fc725678b2239d290868d)" to "[7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)".



---

archive/issue_comments_629867.json:
```json
{
    "body": "<a id='comment:48'></a>\nRebased",
    "created_at": "2022-02-13T18:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629867",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:48'></a>
Rebased



---

archive/issue_comments_629868.json:
```json
{
    "body": "**Changing dependencies** from \"#33103, #33140\" to \"\".",
    "created_at": "2022-02-13T18:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629868",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#33103, #33140" to "".



---

archive/issue_comments_629869.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/1804137820\" to \"https://github.com/mkoeppe/sage/actions/runs/1837680413\".",
    "created_at": "2022-02-13T19:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629869",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/1804137820" to "https://github.com/mkoeppe/sage/actions/runs/1837680413".



---

archive/issue_comments_629870.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [gh-tobiasdiez](#comment%3A41):\n> Replying to [mkoeppe](#comment%3A39):\n> > OK, so to summarize, the revised plan of [comment:30](#comment%3A30) would be:\n> > \n> > - Job \"prebuild\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images\n> > - Job \"build\": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images\n> > - Job \"test-basic\": (minimal, standard) for each system - build sage, run tests\n> > - Job \"test-optional\": (maximal) for each system - build sage with optional packages, run tests\n> > \n\n> \n> Yes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).\n\n\nNo objections if you want to do this work. On the present ticket, I don't want to start with reusable workflows though. I have opened #33338 for such refactoring steps.",
    "created_at": "2022-02-13T19:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629870",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:50'></a>
Replying to [gh-tobiasdiez](#comment%3A41):
> Replying to [mkoeppe](#comment%3A39):
> > OK, so to summarize, the revised plan of [comment:30](#comment%3A30) would be:
> > 
> > - Job "prebuild": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets-pre` images
> > - Job "build": (minimal, standard, maximal) for each system (=3 * 46 < 256) - build `-with-targets` images
> > - Job "test-basic": (minimal, standard) for each system - build sage, run tests
> > - Job "test-optional": (maximal) for each system - build sage with optional packages, run tests
> > 

> 
> Yes, that's what I had in mind. And if you extract the current workflow into an reusable workflow and replace the tox command by an input, then this should also be possible without any code duplication (except for the duplicate matrix).


No objections if you want to do this work. On the present ticket, I don't want to start with reusable workflows though. I have opened #33338 for such refactoring steps.



---

archive/issue_comments_629871.json:
```json
{
    "body": "**Dependencies:** #33306",
    "created_at": "2022-02-13T19:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629871",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #33306



---

archive/issue_comments_629872.json:
```json
{
    "body": "**Changing commit** from \"[7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)\" to \"[2ed27f1014ad0db190c370210e54b99b9ea8a3e1](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)\".",
    "created_at": "2022-02-13T19:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa](https://github.com/sagemath/sagetrac-mirror/commit/7bc769b2a4df5fd38f54152d61cbb66f2cf3c8fa)" to "[2ed27f1014ad0db190c370210e54b99b9ea8a3e1](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)".



---

archive/issue_comments_629873.json:
```json
{
    "body": "<a id='comment:52'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a12596849a909006e23d8717e5c17b38494238e\">0a12596</a></td><td><code>tox.ini (slackware-current): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad913dbf4dd9458a034b6bbab25e2e2d04696d59\">ad913db</a></td><td><code>tox.ini (opensuse-15.2.1,-15.4): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d789f61582647c1bc7bb34ed2ca49fb734c741c\">8d789f6</a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add python3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c62fc35f853ba1479d7ac0653dc5d4e2ab2143f9\">c62fc35</a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add packages needed on -current</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/928629905f47c8772aa7d7020585f076ca09c6ad\">9286299</a></td><td><code>Merge #33196</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5dca4aa8717c3810baf2a2dc5ea20ccdf7ae6ee\">a5dca4a</a></td><td><code>tox.ini (centos-8): Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1167bd54c7b8baeaa682ae9aa78c7cf7801299a\">b1167bd</a></td><td><code>.github/workflows/tox*.yml: Replace centos-8 by centos-stream-8</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4898796562b32114c514ab0fb439049c0c63d56a\">4898796</a></td><td><code>.github/workflows/tox*.yml: Replace opensuse-15 (same as opensuse-15.3) by opensuse-15.2.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e26283aba1acc1315af0aef7ecdc2d2d030f336f\">e26283a</a></td><td><code>Merge #33103</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1\">2ed27f1</a></td><td><code>Merge #33306</code></td></tr></table>\n",
    "created_at": "2022-02-13T19:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a12596849a909006e23d8717e5c17b38494238e">0a12596</a></td><td><code>tox.ini (slackware-current): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad913dbf4dd9458a034b6bbab25e2e2d04696d59">ad913db</a></td><td><code>tox.ini (opensuse-15.2.1,-15.4): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d789f61582647c1bc7bb34ed2ca49fb734c741c">8d789f6</a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add python3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c62fc35f853ba1479d7ac0653dc5d4e2ab2143f9">c62fc35</a></td><td><code>build/pkgs/_prereq/distros/slackware.txt: Add packages needed on -current</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/928629905f47c8772aa7d7020585f076ca09c6ad">9286299</a></td><td><code>Merge #33196</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5dca4aa8717c3810baf2a2dc5ea20ccdf7ae6ee">a5dca4a</a></td><td><code>tox.ini (centos-8): Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1167bd54c7b8baeaa682ae9aa78c7cf7801299a">b1167bd</a></td><td><code>.github/workflows/tox*.yml: Replace centos-8 by centos-stream-8</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4898796562b32114c514ab0fb439049c0c63d56a">4898796</a></td><td><code>.github/workflows/tox*.yml: Replace opensuse-15 (same as opensuse-15.3) by opensuse-15.2.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e26283aba1acc1315af0aef7ecdc2d2d030f336f">e26283a</a></td><td><code>Merge #33103</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1">2ed27f1</a></td><td><code>Merge #33306</code></td></tr></table>




---

archive/issue_comments_629874.json:
```json
{
    "body": "**Changing commit** from \"[2ed27f1014ad0db190c370210e54b99b9ea8a3e1](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)\" to \"[21cfb54f351e90aba976460908e2e634af82a65f](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)\".",
    "created_at": "2022-02-14T01:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629874",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2ed27f1014ad0db190c370210e54b99b9ea8a3e1](https://github.com/sagemath/sagetrac-mirror/commit/2ed27f1014ad0db190c370210e54b99b9ea8a3e1)" to "[21cfb54f351e90aba976460908e2e634af82a65f](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)".



---

archive/issue_comments_629875.json:
```json
{
    "body": "<a id='comment:53'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f\">21cfb54</a></td><td><code>.github/workflows/ci-linux.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>\n",
    "created_at": "2022-02-14T01:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629875",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f">21cfb54</a></td><td><code>.github/workflows/ci-linux.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>




---

archive/issue_comments_629876.json:
```json
{
    "body": "**Changing commit** from \"[21cfb54f351e90aba976460908e2e634af82a65f](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)\" to \"[bfe561f935bee0aa47e58f556fb162058fa657a5](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)\".",
    "created_at": "2022-02-14T01:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[21cfb54f351e90aba976460908e2e634af82a65f](https://github.com/sagemath/sagetrac-mirror/commit/21cfb54f351e90aba976460908e2e634af82a65f)" to "[bfe561f935bee0aa47e58f556fb162058fa657a5](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)".



---

archive/issue_comments_629877.json:
```json
{
    "body": "<a id='comment:54'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5\">bfe561f</a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>\n",
    "created_at": "2022-02-14T01:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629877",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5">bfe561f</a></td><td><code>.github/workflows/ci-{linux,macos}.yml: Use build/make/Makefile as no-op TARGETS_OPTIONAL</code></td></tr></table>




---

archive/issue_comments_629878.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2022-02-14T04:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629878",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_629879.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/1837680413\" to \"https://github.com/mkoeppe/sage/actions/runs/1838573370\".",
    "created_at": "2022-02-14T04:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629879",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/1837680413" to "https://github.com/mkoeppe/sage/actions/runs/1838573370".



---

archive/issue_comments_629880.json:
```json
{
    "body": "<a id='comment:56'></a>\nReplying to [mkoeppe](#comment%3A37):\n> Replying to [gh-tobiasdiez](#comment%3A32):\n> > Replying to [mkoeppe](#comment%3A31):\n> > > Job \"build\" does not reliably fit into 6 hours.\n\n> > \n> > You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). \n\n> \n> No, that's likely only a sporadic failure.\n\n\nActually it was building too much, fixed now in bfe561f",
    "created_at": "2022-02-14T04:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629880",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:56'></a>
Replying to [mkoeppe](#comment%3A37):
> Replying to [gh-tobiasdiez](#comment%3A32):
> > Replying to [mkoeppe](#comment%3A31):
> > > Job "build" does not reliably fit into 6 hours.

> > 
> > You seem to have the same problem with the current setup as well (e.g. first stage of debian-bookworm fails due timeout). 

> 
> No, that's likely only a sporadic failure.


Actually it was building too much, fixed now in bfe561f



---

archive/issue_comments_629881.json:
```json
{
    "body": "**Changing commit** from \"[bfe561f935bee0aa47e58f556fb162058fa657a5](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)\" to \"[7961b22926bcca681b6d39d869c6bebbc80aba3a](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)\".",
    "created_at": "2022-02-14T07:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bfe561f935bee0aa47e58f556fb162058fa657a5](https://github.com/sagemath/sagetrac-mirror/commit/bfe561f935bee0aa47e58f556fb162058fa657a5)" to "[7961b22926bcca681b6d39d869c6bebbc80aba3a](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)".



---

archive/issue_comments_629882.json:
```json
{
    "body": "<a id='comment:57'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a\">7961b22</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo in system list</code></td></tr></table>\n",
    "created_at": "2022-02-14T07:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a">7961b22</a></td><td><code>.github/workflows/ci-linux.yml: Fix typo in system list</code></td></tr></table>




---

archive/issue_comments_629883.json:
```json
{
    "body": "**Work_Issues:** reduce Docker layers",
    "created_at": "2022-02-14T17:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629883",
    "user": "https://github.com/mkoeppe"
}
```

**Work_Issues:** reduce Docker layers



---

archive/issue_comments_629884.json:
```json
{
    "body": "<a id='comment:58'></a>\n`opensuse-15.3-maximal`:\n\n```\n#135 [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details \"pkgconfig(gf2x)\" || echo \"(ignoring error)\"\n#135 sha256:da2e30a5ebcf7a7f99e521987cff4345a05792735e3866c4f70a29402e19512e\n#135 ERROR: failed to prepare 956694vunjg38oyu4pzr7kgxx: max depth exceeded\n```\nHere `build/bin/write-dockerfile.sh` uses too many `RUN` commands because `$EXISTS` is not defined",
    "created_at": "2022-02-14T17:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629884",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:58'></a>
`opensuse-15.3-maximal`:

```
#135 [with-system-packages 130/204] RUN zypper --ignore-unknown install --no-confirm --auto-agree-with-licenses --no-recommends --details "pkgconfig(gf2x)" || echo "(ignoring error)"
#135 sha256:da2e30a5ebcf7a7f99e521987cff4345a05792735e3866c4f70a29402e19512e
#135 ERROR: failed to prepare 956694vunjg38oyu4pzr7kgxx: max depth exceeded
```
Here `build/bin/write-dockerfile.sh` uses too many `RUN` commands because `$EXISTS` is not defined



---

archive/issue_comments_629885.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2022-02-14T17:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629885",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_629886.json:
```json
{
    "body": "**Changing commit** from \"[7961b22926bcca681b6d39d869c6bebbc80aba3a](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)\" to \"[7f1dc97d99c61c74b3cdf79478ac5a0625c24375](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)\".",
    "created_at": "2022-02-14T22:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629886",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7961b22926bcca681b6d39d869c6bebbc80aba3a](https://github.com/sagemath/sagetrac-mirror/commit/7961b22926bcca681b6d39d869c6bebbc80aba3a)" to "[7f1dc97d99c61c74b3cdf79478ac5a0625c24375](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)".



---

archive/issue_comments_629887.json:
```json
{
    "body": "<a id='comment:59'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375\">7f1dc97</a></td><td><code>build/bin/write-dockerfile.sh (opensuse): Define EXISTS</code></td></tr></table>\n",
    "created_at": "2022-02-14T22:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375">7f1dc97</a></td><td><code>build/bin/write-dockerfile.sh (opensuse): Define EXISTS</code></td></tr></table>




---

archive/issue_comments_629888.json:
```json
{
    "body": "<a id='comment:60'></a>\nAlso caching still does not seem to work reliably.\n\nFor example, https://github.com/mkoeppe/sage/runs/5178183571?check_suite_focus=true has pushed like `ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-minimal-configured:9.5-81701-ge8de33c091`, and https://github.com/mkoeppe/sage/runs/5178187220?check_suite_focus=true is able to download it; but it proceeds to build everything from scratch, which leads to the 6h-timeout",
    "created_at": "2022-02-14T22:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629888",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>
Also caching still does not seem to work reliably.

For example, https://github.com/mkoeppe/sage/runs/5178183571?check_suite_focus=true has pushed like `ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-minimal-configured:9.5-81701-ge8de33c091`, and https://github.com/mkoeppe/sage/runs/5178187220?check_suite_focus=true is able to download it; but it proceeds to build everything from scratch, which leads to the 6h-timeout



---

archive/issue_comments_629889.json:
```json
{
    "body": "<a id='comment:61'></a>\nMaybe use the github workflow run id as the docker tag?",
    "created_at": "2022-02-15T12:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629889",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:61'></a>
Maybe use the github workflow run id as the docker tag?



---

archive/issue_comments_629890.json:
```json
{
    "body": "**Changing commit** from \"[7f1dc97d99c61c74b3cdf79478ac5a0625c24375](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)\" to \"[ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)\".",
    "created_at": "2022-02-15T17:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7f1dc97d99c61c74b3cdf79478ac5a0625c24375](https://github.com/sagemath/sagetrac-mirror/commit/7f1dc97d99c61c74b3cdf79478ac5a0625c24375)" to "[ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)".



---

archive/issue_comments_629891.json:
```json
{
    "body": "<a id='comment:62'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1\">ac4d5ff</a></td><td><code>.github/workflows/ci-linux.yml: Use same TARGETS_PRE, TARGETS for all stages; do not push 2-optional*, 2-experimental*</code></td></tr></table>\n",
    "created_at": "2022-02-15T17:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:62'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1">ac4d5ff</a></td><td><code>.github/workflows/ci-linux.yml: Use same TARGETS_PRE, TARGETS for all stages; do not push 2-optional*, 2-experimental*</code></td></tr></table>




---

archive/issue_comments_629892.json:
```json
{
    "body": "<a id='comment:63'></a>\nReplying to [gh-tobiasdiez](#comment%3A61):\n> Maybe use the github workflow run id as the docker tag?\n\nI think this was not the problem",
    "created_at": "2022-02-15T19:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629892",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>
Replying to [gh-tobiasdiez](#comment%3A61):
> Maybe use the github workflow run id as the docker tag?

I think this was not the problem



---

archive/issue_comments_629893.json:
```json
{
    "body": "**Changing work_issues** from \"reduce Docker layers\" to \"\".",
    "created_at": "2022-02-15T19:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629893",
    "user": "https://github.com/mkoeppe"
}
```

**Changing work_issues** from "reduce Docker layers" to "".



---

archive/issue_comments_629894.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/1838573370\" to \"https://github.com/mkoeppe/sage/actions/runs/1848506228\".",
    "created_at": "2022-02-15T19:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629894",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/1838573370" to "https://github.com/mkoeppe/sage/actions/runs/1848506228".



---

archive/issue_comments_629895.json:
```json
{
    "body": "<a id='comment:65'></a>\nStill broken - e.g. https://github.com/mkoeppe/sage/runs/5204591833?check_suite_focus=true",
    "created_at": "2022-02-16T19:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629895",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'></a>
Still broken - e.g. https://github.com/mkoeppe/sage/runs/5204591833?check_suite_focus=true



---

archive/issue_events_097967.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33062#event-97967"
}
```



---

archive/issue_comments_629896.json:
```json
{
    "body": "**Work_Issues:** rebase on #33788",
    "created_at": "2022-05-03T00:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629896",
    "user": "https://github.com/mkoeppe"
}
```

**Work_Issues:** rebase on #33788



---

archive/issue_comments_629897.json:
```json
{
    "body": "**Changing dependencies** from \"#33306\" to \"#33788\".",
    "created_at": "2022-05-03T00:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629897",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#33306" to "#33788".



---

archive/issue_comments_629898.json:
```json
{
    "body": "**Changing dependencies** from \"#33788\" to \"#33788, #34115, #34228\".",
    "created_at": "2022-07-27T19:21:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629898",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#33788" to "#33788, #34115, #34228".



---

archive/issue_comments_629899.json:
```json
{
    "body": "**Changing commit** from \"[ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)\" to \"[cce8fcaba775141920d28353792c956ec563621e](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)\".",
    "created_at": "2022-07-28T04:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629899",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1](https://github.com/sagemath/sagetrac-mirror/commit/ac4d5ff3f5c2d686aa1d9a0dd2b7faa4badc19a1)" to "[cce8fcaba775141920d28353792c956ec563621e](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)".



---

archive/issue_comments_629900.json:
```json
{
    "body": "<a id='comment:69'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3d2200413dd20996ea3018e9501f1253d2ee61b\">a3d2200</a></td><td><code>.github/workflows/tox-{optional,experimental}: Remove ubuntu-{hirsute,impish} here too</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03c312420a03337e5a3973de3cea5b865f6008ac\">03c3124</a></td><td><code>Merge #34115</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9eaae57c9cf70c8bc0ed2968beb584906134927\">a9eaae5</a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add 'tox -e docker-...-incremental'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9bfbf9f0ae96f79d514cd665c46b182337dd711\">b9bfbf9</a></td><td><code>tox.ini: Add comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c0d7f50b18f78ce561eccfc3a6c1196887dc226\">4c0d7f5</a></td><td><code>tox.ini: Use FROM_DOCKER_REPOSITORY</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a07874d2f2443785cc0a295d2d8989ab380d79d2\">a07874d</a></td><td><code>build/bin/write-dockerfile.sh: In incremental build, keep logs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b254da70ced376d5e2d443340b742d07c912da16\">b254da7</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51a335b5d3816672f6ff4ee64f7e569fa352bccf\">51a335b</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f8ef7a433f9e767b9e3c9666df26709c7316110\">6f8ef7a</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e\">cce8fca</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr></table>\n",
    "created_at": "2022-07-28T04:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:69'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3d2200413dd20996ea3018e9501f1253d2ee61b">a3d2200</a></td><td><code>.github/workflows/tox-{optional,experimental}: Remove ubuntu-{hirsute,impish} here too</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03c312420a03337e5a3973de3cea5b865f6008ac">03c3124</a></td><td><code>Merge #34115</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9eaae57c9cf70c8bc0ed2968beb584906134927">a9eaae5</a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add 'tox -e docker-...-incremental'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9bfbf9f0ae96f79d514cd665c46b182337dd711">b9bfbf9</a></td><td><code>tox.ini: Add comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c0d7f50b18f78ce561eccfc3a6c1196887dc226">4c0d7f5</a></td><td><code>tox.ini: Use FROM_DOCKER_REPOSITORY</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a07874d2f2443785cc0a295d2d8989ab380d79d2">a07874d</a></td><td><code>build/bin/write-dockerfile.sh: In incremental build, keep logs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b254da70ced376d5e2d443340b742d07c912da16">b254da7</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51a335b5d3816672f6ff4ee64f7e569fa352bccf">51a335b</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f8ef7a433f9e767b9e3c9666df26709c7316110">6f8ef7a</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e">cce8fca</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr></table>




---

archive/issue_comments_629901.json:
```json
{
    "body": "**Changing work_issues** from \"rebase on #33788\" to \"\".",
    "created_at": "2022-07-28T04:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629901",
    "user": "https://github.com/mkoeppe"
}
```

**Changing work_issues** from "rebase on #33788" to "".



---

archive/issue_comments_629902.json:
```json
{
    "body": "**Changing dependencies** from \"#33788, #34115, #34228\" to \"#34115, #34228\".",
    "created_at": "2022-07-28T04:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629902",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#33788, #34115, #34228" to "#34115, #34228".



---

archive/issue_comments_629903.json:
```json
{
    "body": "<a id='comment:71'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61f90630d77c8957b95e943ee4d3c15a863d3743\">61f9063</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ecd6b198b221d0df602139392cd53549f6943b8\">1ecd6b1</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794\">6d3caa2</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>\n",
    "created_at": "2022-07-28T06:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:71'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61f90630d77c8957b95e943ee4d3c15a863d3743">61f9063</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ecd6b198b221d0df602139392cd53549f6943b8">1ecd6b1</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794">6d3caa2</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>




---

archive/issue_comments_629904.json:
```json
{
    "body": "**Changing commit** from \"[cce8fcaba775141920d28353792c956ec563621e](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)\" to \"[6d3caa2be5c693b4b48538f6441290b931afc794](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)\".",
    "created_at": "2022-07-28T06:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[cce8fcaba775141920d28353792c956ec563621e](https://github.com/sagemath/sagetrac-mirror/commit/cce8fcaba775141920d28353792c956ec563621e)" to "[6d3caa2be5c693b4b48538f6441290b931afc794](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)".



---

archive/issue_comments_629905.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,28 +1,5 @@\n Follow up from #32703, where this was implemented for macOS.\n \n-Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io\n+Here we implement it for the `docker`-based workflows \n+via incremental builds (#34228) on top of previous stages pushed to ghcr.io\n \n-To use for local builds via tox:\n-\n-```\n-$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard\n- => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s\n- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s\n- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s\n-```\n-\n-\n-(split out from #33222)\n-\n-We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. \n-\n``````\n",
    "created_at": "2022-07-28T06:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629905",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,28 +1,5 @@
 Follow up from #32703, where this was implemented for macOS.
 
-Here we implement it for the `docker`-based workflows by Docker layer caching via ghcr.io
+Here we implement it for the `docker`-based workflows 
+via incremental builds (#34228) on top of previous stages pushed to ghcr.io
 
-To use for local builds via tox:
-
-```
-$ DOCKER_BUILDKIT=1 EXTRA_CACHE_FROM_REPOSITORIES=ghcr.io/mkoeppe/sage/ tox -e docker-ubuntu-focal-standard
- => [internal] load metadata for docker.io/library/ubuntu:focal                                                                                                                                                      0.0s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:dev                                                                                                      1.3s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:9.6.beta0-133-gc9c7d9f8d9                                                                        1.6s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:dev                                                                                                        2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:9.6.beta0-133-gc9c7d9f8d9                                                                                  1.6s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-configured:dev                                                                                                              2.5s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-pre:9.6.beta0-133-gc9c7d9f8d9                                                                            1.6s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:dev                                                                                                            2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets:9.6.beta0-133-gc9c7d9f8d9                                                                                1.4s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:dev                                                                                                   2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-targets-optional:9.6.beta0-133-gc9c7d9f8d9                                                                       1.4s
- => importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-with-system-packages:dev                                                                                                    2.4s
- => ERROR importing cache manifest from ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-standard-bootstrapped:9.6.beta0-133-gc9c7d9f8d9                                                                                1.5s
-```
-
-
-(split out from #33222)
-
-We reorganize the CI workflows: `ci-linux.yml` and `ci-macos.yml` replace `tox.yml`, `tox-optional.yml`, `tox-experimental.yml`. 
-
``````




---

archive/issue_comments_629906.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/1848506228\" to \"https://github.com/mkoeppe/sage/actions/runs/2751836720\".",
    "created_at": "2022-07-28T06:54:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629906",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/1848506228" to "https://github.com/mkoeppe/sage/actions/runs/2751836720".



---

archive/issue_comments_629907.json:
```json
{
    "body": "**Changing commit** from \"[6d3caa2be5c693b4b48538f6441290b931afc794](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)\" to \"[31c5be922be60fa856b1b6b344f7630ef337f208](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)\".",
    "created_at": "2022-07-28T23:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629907",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6d3caa2be5c693b4b48538f6441290b931afc794](https://github.com/sagemath/sagetrac-mirror/commit/6d3caa2be5c693b4b48538f6441290b931afc794)" to "[31c5be922be60fa856b1b6b344f7630ef337f208](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)".



---

archive/issue_comments_629908.json:
```json
{
    "body": "<a id='comment:74'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ae269d17726a4ac6383b9645995d8c1f4c9b3f6d\">ae269d1</a></td><td><code>tox.ini (docker-incremental): Do not include '-incremental' in the Docker image name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d01263a7d3be04dfae133874786e4790064dca9c\">d01263a</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec79d4f182c2bde9e301a63dc90158181f6b2128\">ec79d4f</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1caf6dbcc89c5033e2fc4b05455e3d906d7a4a6\">e1caf6d</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208\">31c5be9</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>\n",
    "created_at": "2022-07-28T23:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629908",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:74'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ae269d17726a4ac6383b9645995d8c1f4c9b3f6d">ae269d1</a></td><td><code>tox.ini (docker-incremental): Do not include '-incremental' in the Docker image name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d01263a7d3be04dfae133874786e4790064dca9c">d01263a</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec79d4f182c2bde9e301a63dc90158181f6b2128">ec79d4f</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1caf6dbcc89c5033e2fc4b05455e3d906d7a4a6">e1caf6d</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208">31c5be9</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>




---

archive/issue_comments_629909.json:
```json
{
    "body": "**Changing commit** from \"[31c5be922be60fa856b1b6b344f7630ef337f208](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)\" to \"[951130a65b1e533a2a84eb8ac3d4669e93856f89](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)\".",
    "created_at": "2022-07-28T23:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[31c5be922be60fa856b1b6b344f7630ef337f208](https://github.com/sagemath/sagetrac-mirror/commit/31c5be922be60fa856b1b6b344f7630ef337f208)" to "[951130a65b1e533a2a84eb8ac3d4669e93856f89](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)".



---

archive/issue_comments_629910.json:
```json
{
    "body": "<a id='comment:75'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89\">951130a</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>\n",
    "created_at": "2022-07-28T23:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:75'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89">951130a</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr></table>




---

archive/issue_comments_629911.json:
```json
{
    "body": "**Changing commit** from \"[951130a65b1e533a2a84eb8ac3d4669e93856f89](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)\" to \"[5b425ace1944fe2d74f23415e63fc6821edcd04e](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)\".",
    "created_at": "2022-07-29T10:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629911",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[951130a65b1e533a2a84eb8ac3d4669e93856f89](https://github.com/sagemath/sagetrac-mirror/commit/951130a65b1e533a2a84eb8ac3d4669e93856f89)" to "[5b425ace1944fe2d74f23415e63fc6821edcd04e](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)".



---

archive/issue_comments_629912.json:
```json
{
    "body": "<a id='comment:76'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e\">5b425ac</a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>\n",
    "created_at": "2022-07-29T10:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629912",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:76'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e">5b425ac</a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>




---

archive/issue_comments_629913.json:
```json
{
    "body": "**Changing commit** from \"[5b425ace1944fe2d74f23415e63fc6821edcd04e](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)\" to \"[31c4722cb7f540f517d8dab60d67c5f173db42a4](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)\".",
    "created_at": "2022-08-01T06:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629913",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5b425ace1944fe2d74f23415e63fc6821edcd04e](https://github.com/sagemath/sagetrac-mirror/commit/5b425ace1944fe2d74f23415e63fc6821edcd04e)" to "[31c4722cb7f540f517d8dab60d67c5f173db42a4](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)".



---

archive/issue_comments_629914.json:
```json
{
    "body": "<a id='comment:77'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b354a3873b4c6fac29dee7bbd5fbf3ef6a35d8f5\">b354a38</a></td><td><code>tox.ini, .github/workflows/docker.yml: Reimplement -incremental via SKIP_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5decadde7ae1985ab6a1b44fb52564972635f281\">5decadd</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c32034cfc546afcb1043a11ab81083dec3d92be\">6c32034</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/979779a5312576714f12bf5bd7266de6b7884e47\">979779a</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/326f61dc6ff96d15019954b55f4de87298f5e96c\">326f61d</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4\">31c4722</a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>\n",
    "created_at": "2022-08-01T06:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629914",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:77'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b354a3873b4c6fac29dee7bbd5fbf3ef6a35d8f5">b354a38</a></td><td><code>tox.ini, .github/workflows/docker.yml: Reimplement -incremental via SKIP_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5decadde7ae1985ab6a1b44fb52564972635f281">5decadd</a></td><td><code>build/bin/write-dockerfile.sh: Do not use persistent env var PACKAGES (except on nix)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c32034cfc546afcb1043a11ab81083dec3d92be">6c32034</a></td><td><code>Merge #34228</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/979779a5312576714f12bf5bd7266de6b7884e47">979779a</a></td><td><code>tox.ini (ubuntu-jammy, debian-bookworm, fedora-35, fedora-36): Do not IGNORE_MISSING_SYSTEM_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/326f61dc6ff96d15019954b55f4de87298f5e96c">326f61d</a></td><td><code>Replace tox-optional, tox-experimental.yml by use of reusable workflow in ci-linux.yml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4">31c4722</a></td><td><code>.github/workflows/ci-linux.yml: Run following stages even when a job in the previous stage fails</code></td></tr></table>




---

archive/issue_comments_629915.json:
```json
{
    "body": "<a id='comment:78'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6ee7a59e10f0be55c84bac109c0739f163e3968\">a6ee7a5</a></td><td><code>.github/workflows/ci-linux.yml: Use success() | failure()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3\">f2b52ef</a></td><td><code>.github/workflows/ci-linux.yml: First run all 'standard' jobs, then 'minimal', ...</code></td></tr></table>\n",
    "created_at": "2022-08-01T06:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629915",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:78'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6ee7a59e10f0be55c84bac109c0739f163e3968">a6ee7a5</a></td><td><code>.github/workflows/ci-linux.yml: Use success() | failure()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3">f2b52ef</a></td><td><code>.github/workflows/ci-linux.yml: First run all 'standard' jobs, then 'minimal', ...</code></td></tr></table>




---

archive/issue_comments_629916.json:
```json
{
    "body": "**Changing commit** from \"[31c4722cb7f540f517d8dab60d67c5f173db42a4](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)\" to \"[f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)\".",
    "created_at": "2022-08-01T06:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[31c4722cb7f540f517d8dab60d67c5f173db42a4](https://github.com/sagemath/sagetrac-mirror/commit/31c4722cb7f540f517d8dab60d67c5f173db42a4)" to "[f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)".



---

archive/issue_comments_629917.json:
```json
{
    "body": "<a id='comment:79'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100\">ca6d163</a></td><td><code>.github/workflows/ci-linux.yml: Rename stages</code></td></tr></table>\n",
    "created_at": "2022-08-01T06:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629917",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:79'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100">ca6d163</a></td><td><code>.github/workflows/ci-linux.yml: Rename stages</code></td></tr></table>




---

archive/issue_comments_629918.json:
```json
{
    "body": "**Changing commit** from \"[f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)\" to \"[ca6d16398420c242228656c04373b7e920684100](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)\".",
    "created_at": "2022-08-01T06:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629918",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3](https://github.com/sagemath/sagetrac-mirror/commit/f2b52ef90dfd97128c2f458d5fe5c2dd6cf188e3)" to "[ca6d16398420c242228656c04373b7e920684100](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)".



---

archive/issue_comments_629919.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2022-08-01T06:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629919",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_629920.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,4 @@\n Here we implement it for the `docker`-based workflows \n via incremental builds (#34228) on top of previous stages pushed to ghcr.io\n \n+\n``````\n",
    "created_at": "2022-08-01T06:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629920",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,4 @@
 Here we implement it for the `docker`-based workflows 
 via incremental builds (#34228) on top of previous stages pushed to ghcr.io
 
+
``````




---

archive/issue_comments_629921.json:
```json
{
    "body": "**Work_Issues:** TARGETS_OPTIONAL not passed correctly",
    "created_at": "2022-08-03T04:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629921",
    "user": "https://github.com/mkoeppe"
}
```

**Work_Issues:** TARGETS_OPTIONAL not passed correctly



---

archive/issue_comments_629922.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2022-08-03T04:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629922",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_629923.json:
```json
{
    "body": "<a id='comment:83'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8\">5713937</a></td><td><code>sage -package list --has-file, --no-file: Handle disjunctions</code></td></tr></table>\n",
    "created_at": "2022-08-03T05:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:83'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8">5713937</a></td><td><code>sage -package list --has-file, --no-file: Handle disjunctions</code></td></tr></table>




---

archive/issue_comments_629924.json:
```json
{
    "body": "**Changing commit** from \"[ca6d16398420c242228656c04373b7e920684100](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)\" to \"[5713937de7ed72810013e0856b7ac0cca0d9b3e8](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)\".",
    "created_at": "2022-08-03T05:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629924",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ca6d16398420c242228656c04373b7e920684100](https://github.com/sagemath/sagetrac-mirror/commit/ca6d16398420c242228656c04373b7e920684100)" to "[5713937de7ed72810013e0856b7ac0cca0d9b3e8](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)".



---

archive/issue_comments_629925.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2022-08-03T06:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629925",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_629926.json:
```json
{
    "body": "**Changing work_issues** from \"TARGETS_OPTIONAL not passed correctly\" to \"\".",
    "created_at": "2022-08-03T06:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629926",
    "user": "https://github.com/mkoeppe"
}
```

**Changing work_issues** from "TARGETS_OPTIONAL not passed correctly" to "".



---

archive/issue_comments_629927.json:
```json
{
    "body": "<a id='comment:85'></a>\nMarking it as critical because it is a dependency of #34266",
    "created_at": "2022-09-19T16:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629927",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:85'></a>
Marking it as critical because it is a dependency of #34266



---

archive/issue_events_097968.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33062#event-97968"
}
```



---

archive/issue_events_097969.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33062#event-97969"
}
```



---

archive/issue_comments_629928.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-09-21T15:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629928",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_629929.json:
```json
{
    "body": "<a id='comment:87'></a>\nlgtm",
    "created_at": "2022-09-21T15:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629929",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:87'></a>
lgtm



---

archive/issue_comments_629930.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/2751836720\" to \"Dima Pasechnik\".",
    "created_at": "2022-09-21T15:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629930",
    "user": "https://github.com/dimpase"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/2751836720" to "Dima Pasechnik".



---

archive/issue_comments_629931.json:
```json
{
    "body": "<a id='comment:88'></a>\nThanks!",
    "created_at": "2022-09-21T15:19:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629931",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:88'></a>
Thanks!



---

archive/issue_comments_629932.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)\" to \"[5713937de7ed72810013e0856b7ac0cca0d9b3e8](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)\".",
    "created_at": "2022-09-25T16:34:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33062#issuecomment-629932",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gh_actions__docker___run_a_job_for__make_build_local__first__cache_image_for_job__make_build_)" to "[5713937de7ed72810013e0856b7ac0cca0d9b3e8](https://github.com/sagemath/sagetrac-mirror/commit/5713937de7ed72810013e0856b7ac0cca0d9b3e8)".



---

archive/issue_events_097970.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-25T16:34:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33062",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33062#event-97970"
}
```
