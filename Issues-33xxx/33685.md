# Issue 33685: PointConfiguration, Polyhedron, PolyhedralComplex: Compute regular triangulation/subdivision

archive/issues_033448.json:
```json
{
    "body": "`Triangulation` already has a method `normal_cone`, which computes the normal cone of the GKZ polytope that exposes the triangulation.\n\nWhat is missing is a method to compute regular triangulations, given an element of the normal cone (a weight/lifting vector), computes the regular triangulation (or more generally, subdivision) of the point configuration / polyhedron. \n\nWe implement this as a generalization of `PolyhedralComplex.subdivide`, which will work when it `is_convex`. \n\nMethods for `Polyhedron`, `PointConfiguration`, and `RationalPolyhedralCone` can then be implemented by delegating to this method.\n\n- polymake has the needed functionality: https://polymake.org/doku.php/user_guide/tutorials/regular_subdivisions#regular_subdivisons\n\n\nCC:  @yuan-zhou @jplab @kliem\n\nReviewer: Yuan Zhou\n\nAuthor: Matthias Koeppe, ...\n\nBranch: u/mkoeppe/pointconfiguration__polyhedron__polyhedralcomplex__compute_regular_triangulation_subdivision\n\nStatus: needs_work\n\nDependencies: #33586, #33596, #34326\n\nCommit: d1c035f600630b7122636f6a9134db89aa06d440\n\nIssue created by migration from https://trac.sagemath.org/ticket/33685\n\n",
    "created_at": "2022-04-11T19:59:55Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "PointConfiguration, Polyhedron, PolyhedralComplex: Compute regular triangulation/subdivision",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33685",
    "user": "https://github.com/mkoeppe"
}
```
`Triangulation` already has a method `normal_cone`, which computes the normal cone of the GKZ polytope that exposes the triangulation.

What is missing is a method to compute regular triangulations, given an element of the normal cone (a weight/lifting vector), computes the regular triangulation (or more generally, subdivision) of the point configuration / polyhedron. 

We implement this as a generalization of `PolyhedralComplex.subdivide`, which will work when it `is_convex`. 

Methods for `Polyhedron`, `PointConfiguration`, and `RationalPolyhedralCone` can then be implemented by delegating to this method.

- polymake has the needed functionality: https://polymake.org/doku.php/user_guide/tutorials/regular_subdivisions#regular_subdivisons


CC:  @yuan-zhou @jplab @kliem

Reviewer: Yuan Zhou

Author: Matthias Koeppe, ...

Branch: u/mkoeppe/pointconfiguration__polyhedron__polyhedralcomplex__compute_regular_triangulation_subdivision

Status: needs_work

Dependencies: #33586, #33596, #34326

Commit: d1c035f600630b7122636f6a9134db89aa06d440

Issue created by migration from https://trac.sagemath.org/ticket/33685





---

archive/issue_events_088549.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33685#event-88549"
}
```



---

archive/issue_comments_508688.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -4,6 +4,9 @@\n \n Under some conditions, this would also make sense for polyhedral complexes.\n \n+- polymake has the needed functionality: https://polymake.org/doku.php/user_guide/tutorials/regular_subdivisions#regular_subdivisons\n+\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/33685\n```\n",
    "created_at": "2022-04-21T16:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508688",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -4,6 +4,9 @@
 
 Under some conditions, this would also make sense for polyhedral complexes.
 
+- polymake has the needed functionality: https://polymake.org/doku.php/user_guide/tutorials/regular_subdivisions#regular_subdivisons
+
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/33685
```




---

archive/issue_comments_508689.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+\\`Triangulation\\` already has a method \\`normal_cone\\`, which computes the normal cone of the GKZ polytope that exposes the triangulation.\n+\n+What is missing is a method to compute regular triangulations, given an element of the normal cone (a weight/lifting vector), computes the regular triangulation (or more generally, subdivision) of the point configuration / polyhedron. \n+\n+We implement this as a generalization of \\`PolyhedralComplex.subdivide\\`, which will work when it \\`is_convex\\`. \n+\n+Methods for \\`Polyhedron\\`, \\`PointConfiguration\\`, and \\`RationalPolyhedralCone\\` can then be implemented by delegating to this method.\n+\n+- polymake has the needed functionality: https://polymake.org/doku.php/user_guide/tutorials/regular_subdivisions#regular_subdivisons\n \n \n Comment: 1\n```\n",
    "created_at": "2022-08-07T22:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508689",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,12 @@
+\`Triangulation\` already has a method \`normal_cone\`, which computes the normal cone of the GKZ polytope that exposes the triangulation.
+
+What is missing is a method to compute regular triangulations, given an element of the normal cone (a weight/lifting vector), computes the regular triangulation (or more generally, subdivision) of the point configuration / polyhedron. 
+
+We implement this as a generalization of \`PolyhedralComplex.subdivide\`, which will work when it \`is_convex\`. 
+
+Methods for \`Polyhedron\`, \`PointConfiguration\`, and \`RationalPolyhedralCone\` can then be implemented by delegating to this method.
+
+- polymake has the needed functionality: https://polymake.org/doku.php/user_guide/tutorials/regular_subdivisions#regular_subdivisons
 
 
 Comment: 1
```




---

archive/issue_comments_508690.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T02:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_508691.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-08-08T03:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508691",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_508692.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T16:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508692",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_508693.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T18:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508693",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_508694.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T18:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_508695.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T19:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508695",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_508696.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T17:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508696",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_508697.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-09T18:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_508698.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-10T00:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_088550.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33685#event-88550"
}
```



---

archive/issue_events_088551.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33685#event-88551"
}
```



---

archive/issue_comments_508699.json:
```json
{
    "body": "<a id='comment:20'></a>The patchbot is red, but I was unable to see the Test details. Any idea why?",
    "created_at": "2022-09-10T21:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508699",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:20'></a>The patchbot is red, but I was unable to see the Test details. Any idea why?



---

archive/issue_comments_508700.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-10T21:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508700",
    "user": "https://github.com/yuan-zhou"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_508701.json:
```json
{
    "body": "<a id='comment:21'></a>\"Build & test\" (https://github.com/sagemath/sagetrac-mirror/runs/7757629097?check_suite_focus=true) shows 2 doctest failures",
    "created_at": "2022-09-10T21:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508701",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>"Build & test" (https://github.com/sagemath/sagetrac-mirror/runs/7757629097?check_suite_focus=true) shows 2 doctest failures



---

archive/issue_comments_508702.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-09-10T21:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508702",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_508703.json:
```json
{
    "body": "<a id='comment:23'></a>Ah yes, these two failures are already marked with \"FIXME\"",
    "created_at": "2022-09-10T21:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508703",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Ah yes, these two failures are already marked with "FIXME"



---

archive/issue_comments_508704.json:
```json
{
    "body": "<a id='comment:25'></a>It is very confusing that \u201ctriangulation\u201d is called although often times it is just a subdivision.\n\nDoes the function \u201cis regular subdivision\u201d test whether other is a subdivision of self, or the reverse?",
    "created_at": "2022-09-18T08:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508704",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:25'></a>It is very confusing that “triangulation” is called although often times it is just a subdivision.

Does the function “is regular subdivision” test whether other is a subdivision of self, or the reverse?



---

archive/issue_comments_508705.json:
```json
{
    "body": "<a id='comment:26'></a>Would it be better to limit the scope of `is_regular_subdivision` to only the case where `self` satisfies `is_simplicial_complex` and `is_compact`? \n\nI notice that this requirement is specified in the method `as_triangulation`. But then, inside `is_regular_subdivision`, `self.as_triangulation` is called with `check=False`, which doesn't make sense to me.",
    "created_at": "2022-09-18T19:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508705",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:26'></a>Would it be better to limit the scope of `is_regular_subdivision` to only the case where `self` satisfies `is_simplicial_complex` and `is_compact`? 

I notice that this requirement is specified in the method `as_triangulation`. But then, inside `is_regular_subdivision`, `self.as_triangulation` is called with `check=False`, which doesn't make sense to me.



---

archive/issue_comments_508706.json:
```json
{
    "body": "<a id='comment:27'></a>Even if we assume that `self` is a triangulation, the decision process that `is_regular_subdivision` now uses doesn't make any sense to me, starting from `normal = normal_cone.relative_interior().an_element()`",
    "created_at": "2022-09-19T01:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508706",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:27'></a>Even if we assume that `self` is a triangulation, the decision process that `is_regular_subdivision` now uses doesn't make any sense to me, starting from `normal = normal_cone.relative_interior().an_element()`



---

archive/issue_comments_508707.json:
```json
{
    "body": "<a id='comment:28'></a>From the reference to Polymake example, I see that Polymake doesn't have the function `polyhedralcomplex.is_regular_subdivision(otherpolyhedralcomplex)`, but only `is_regular` which determines if a subdivision of a point collection is a regular subdivision. \n\nTherefore, I think there should be two parts in your `is_regular_subdivision` method: (1) determine if self is a regular subdivision (and compute a weight vector) (2) check if self is a subdivision of other.",
    "created_at": "2022-09-19T02:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508707",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:28'></a>From the reference to Polymake example, I see that Polymake doesn't have the function `polyhedralcomplex.is_regular_subdivision(otherpolyhedralcomplex)`, but only `is_regular` which determines if a subdivision of a point collection is a regular subdivision. 

Therefore, I think there should be two parts in your `is_regular_subdivision` method: (1) determine if self is a regular subdivision (and compute a weight vector) (2) check if self is a subdivision of other.



---

archive/issue_comments_508708.json:
```json
{
    "body": "<a id='comment:29'></a>Example: \npoints = [(0,0), (0,2), (2,2), (2,0), (1,3)]. \n\n`other` is the polyhedral complex whose maximal cells are [the square with the first 4 points as its vertices, the triangle with the last three points as its vertices]\n\n`self` is the polyhedral complex whose maximal cells are [triangle (pt0, pt1, pt4), triangle (pt0, pt4, pt3), triangle (pt1, pt2, pt4)]\n\n`self` is a regular subdivision of points, but not a subdivision of `other`.",
    "created_at": "2022-09-19T03:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508708",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:29'></a>Example: 
points = [(0,0), (0,2), (2,2), (2,0), (1,3)]. 

`other` is the polyhedral complex whose maximal cells are [the square with the first 4 points as its vertices, the triangle with the last three points as its vertices]

`self` is the polyhedral complex whose maximal cells are [triangle (pt0, pt1, pt4), triangle (pt0, pt4, pt3), triangle (pt1, pt2, pt4)]

`self` is a regular subdivision of points, but not a subdivision of `other`.



---

archive/issue_comments_508709.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-10-17T20:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33685",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33685#issuecomment-508709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
