# Issue 33810: AlgebraicNumber.exactify() factors integers

archive/issues_033573.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nAs noted in `qqbar.clear_denominators()`:\n\n```\n    # This algorithm factors the polynomial denominators.\n    # We should check the size of the denominators and switch to\n    # an alternate, less precise algorithm if we decide factoring\n    # would be too slow.\n```\nTest case:\n\n```\nsage: R.<y> = QQ[]\nsage: coefficients_as_integer_ratios = [\n....:     (-2774600080567517563395913264491323241652779066919616441429094563840,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (-24216324060414384566983400245979288839929814383090701293489050615808,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (325579773864372490083706670433410006284520887405882567940047555526656,\n....:      180143564412823751787837643000565238870031999674661705128541236331583133845246252269971),\n....:     (-86736048492777879473586471630941922517134071457946320753641122078523392,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (-2338058278498910195688689352766977573607428722429118859280880481590329344,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (105830270645785996318880019945503938356315302592627229453391693256551317504,\n....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),\n....:     (1110926147990548796149597141538460730252912439930561079348611699181798425600,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (-89705438380888704653335165590083767769953879654958783855317882966200828559360,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (1151092895747371986483047191334923516591005329489629755485810229546333821625856,\n....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),\n....:     (24725641793859400310483886670136079788266826658111372723121573233077840328938576,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (-31051495080139473677925068000403254349133134904365702868216464107777210775457136,\n....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),\n....:     (9431591461895130351865642769482226964622378075329823505708119342634182162193000560,\n....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n....:     (1721694880863483428337378731387732043714427651970488363462560317808769716807148992,\n....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),\n....:     (255327752077837584624694974814916395144764296822788813014081161094149724325120096,\n....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),\n....:     (238105337335596176836773151768694069523377650990453522899627157538495252117232992338,\n....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),\n....:     (1255826892296350234297164500548658984205287902407560187136301197703464130999349114638,\n....:      14336685057075938723599535602121108975815695475838128781856222960645024492874269211797),\n....:     (1, 1)]\nsage: p = R(coefficients_as_integer_ratios)\nsage: QQbar.polynomial_root(\n....:     AA.common_polynomial(p),\n....:     CIF(RIF(-RR(0.036151142425748496), -RR(0.036151142425748489)),\n....:     RIF(-RR(0.011298617187916445), -RR(0.011298617187916443))))\n-0.03615114242574849? - 0.011298617187916444?*I\nsage: a.exactify()\n```\n\nCC:  @slel\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33810_\n\n",
    "created_at": "2022-05-05T15:27:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "AlgebraicNumber.exactify() factors integers",
    "type": "issue",
    "updated_at": "2022-08-31T02:51:13Z",
    "url": "https://github.com/sagemath/sage/issues/33810",
    "user": "https://github.com/mezzarobba"
}
```
<div id="comment:0"></div>

As noted in `qqbar.clear_denominators()`:

```
    # This algorithm factors the polynomial denominators.
    # We should check the size of the denominators and switch to
    # an alternate, less precise algorithm if we decide factoring
    # would be too slow.
```
Test case:

```
sage: R.<y> = QQ[]
sage: coefficients_as_integer_ratios = [
....:     (-2774600080567517563395913264491323241652779066919616441429094563840,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (-24216324060414384566983400245979288839929814383090701293489050615808,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (325579773864372490083706670433410006284520887405882567940047555526656,
....:      180143564412823751787837643000565238870031999674661705128541236331583133845246252269971),
....:     (-86736048492777879473586471630941922517134071457946320753641122078523392,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (-2338058278498910195688689352766977573607428722429118859280880481590329344,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (105830270645785996318880019945503938356315302592627229453391693256551317504,
....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),
....:     (1110926147990548796149597141538460730252912439930561079348611699181798425600,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (-89705438380888704653335165590083767769953879654958783855317882966200828559360,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (1151092895747371986483047191334923516591005329489629755485810229546333821625856,
....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),
....:     (24725641793859400310483886670136079788266826658111372723121573233077840328938576,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (-31051495080139473677925068000403254349133134904365702868216464107777210775457136,
....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),
....:     (9431591461895130351865642769482226964622378075329823505708119342634182162193000560,
....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
....:     (1721694880863483428337378731387732043714427651970488363462560317808769716807148992,
....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),
....:     (255327752077837584624694974814916395144764296822788813014081161094149724325120096,
....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),
....:     (238105337335596176836773151768694069523377650990453522899627157538495252117232992338,
....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),
....:     (1255826892296350234297164500548658984205287902407560187136301197703464130999349114638,
....:      14336685057075938723599535602121108975815695475838128781856222960645024492874269211797),
....:     (1, 1)]
sage: p = R(coefficients_as_integer_ratios)
sage: QQbar.polynomial_root(
....:     AA.common_polynomial(p),
....:     CIF(RIF(-RR(0.036151142425748496), -RR(0.036151142425748489)),
....:     RIF(-RR(0.011298617187916445), -RR(0.011298617187916443))))
-0.03615114242574849? - 0.011298617187916444?*I
sage: a.exactify()
```

CC:  @slel

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/33810_





---

archive/issue_events_460429.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2022-05-05T15:27:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33810#event-460429"
}
```



---

archive/issue_events_460430.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2022-05-05T15:27:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33810#event-460430"
}
```



---

archive/issue_events_460431.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2022-05-05T15:27:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33810#event-460431"
}
```



---

archive/issue_events_460432.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2022-05-05T15:27:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33810#event-460432"
}
```



---

archive/issue_comments_546398.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,35 +10,45 @@\n \n ```\n sage: R.<y> = QQ[]\n-sage: QQbar.polynomial_root(AA.common_polynomial(y^16 + 125582689229635023429716450054865898420528790240756018\n-....: 7136301197703464130999349114638/143366850570759387235995356021211089758156954758381287818562229606450244\n-....: 92874269211797*y^15 + 2381053373355961768367731517686940695233776509904535228996271575384952521172329923\n-....: 38/27080405107810106477910233915117650287651869232138687699061754481218379597651397400061*y^14 + 2553277\n-....: 52077837584624694974814916395144764296822788813014081161094149724325120096/27080405107810106477910233915\n-....: 117650287651869232138687699061754481218379597651397400061*y^13 + 172169488086348342833737873138773204371\n-....: 4427651970488363462560317808769716807148992/153455628944257270041491325519000018296693925648785896961349\n-....: 942060237484386691251933679*y^12 + 943159146189513035186564276948222696462237807532982350570811934263418\n-....: 2162193000560/4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333*y\n-....: ^11 - 31051495080139473677925068000403254349133134904365702868216464107777210775457136/15345562894425727\n-....: 0041491325519000018296693925648785896961349942060237484386691251933679*y^10 + 24725641793859400310483886\n-....: 670136079788266826658111372723121573233077840328938576/4143301981494946291120265789013000494010735992517\n-....: 219217956448435626412078440663802209333*y^9 + 1151092895747371986483047191334923516591005329489629755485\n-....: 810229546333821625856/1381100660498315430373421929671000164670245330839073072652149478542137359480221267\n-....: 403111*y^8 - 89705438380888704653335165590083767769953879654958783855317882966200828559360/4143301981494\n-....: 946291120265789013000494010735992517219217956448435626412078440663802209333*y^7 + 1110926147990548796149\n-....: 597141538460730252912439930561079348611699181798425600/4143301981494946291120265789013000494010735992517\n-....: 219217956448435626412078440663802209333*y^6 + 1058302706457859963188800199455039383563153025926272294533\n-....: 91693256551317504/13811006604983154303734219296710001646702453308390730726521494785421373594802212674031\n-....: 11*y^5 - 2338058278498910195688689352766977573607428722429118859280880481590329344/414330198149494629112\n-....: 0265789013000494010735992517219217956448435626412078440663802209333*y^4 - 867360484927778794735864716309\n-....: 41922517134071457946320753641122078523392/41433019814949462911202657890130004940107359925172192179564484\n-....: 35626412078440663802209333*y^3 + 325579773864372490083706670433410006284520887405882567940047555526656/1\n-....: 80143564412823751787837643000565238870031999674661705128541236331583133845246252269971*y^2 - 24216324060\n-....: 414384566983400245979288839929814383090701293489050615808/4143301981494946291120265789013000494010735992\n-....: 517219217956448435626412078440663802209333*y - 277460008056751756339591326449132324165277906691961644142\n-....: 9094563840/4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333), CI\n-....: F(RIF(-RR(0.036151142425748496), -RR(0.036151142425748489)), RIF(-RR(0.011298617187916445), -RR(0.011298\n-....: 617187916443))))\n+sage: coefficients_as_integer_ratios = [\n+....:     (-2774600080567517563395913264491323241652779066919616441429094563840,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (-24216324060414384566983400245979288839929814383090701293489050615808,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (325579773864372490083706670433410006284520887405882567940047555526656,\n+....:      180143564412823751787837643000565238870031999674661705128541236331583133845246252269971),\n+....:     (-86736048492777879473586471630941922517134071457946320753641122078523392,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (-2338058278498910195688689352766977573607428722429118859280880481590329344,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (105830270645785996318880019945503938356315302592627229453391693256551317504,\n+....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),\n+....:     (1110926147990548796149597141538460730252912439930561079348611699181798425600,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (-89705438380888704653335165590083767769953879654958783855317882966200828559360,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (1151092895747371986483047191334923516591005329489629755485810229546333821625856,\n+....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),\n+....:     (24725641793859400310483886670136079788266826658111372723121573233077840328938576,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (-31051495080139473677925068000403254349133134904365702868216464107777210775457136,\n+....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),\n+....:     (9431591461895130351865642769482226964622378075329823505708119342634182162193000560,\n+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),\n+....:     (1721694880863483428337378731387732043714427651970488363462560317808769716807148992,\n+....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),\n+....:     (255327752077837584624694974814916395144764296822788813014081161094149724325120096,\n+....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),\n+....:     (238105337335596176836773151768694069523377650990453522899627157538495252117232992338,\n+....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),\n+....:     (1255826892296350234297164500548658984205287902407560187136301197703464130999349114638,\n+....:      14336685057075938723599535602121108975815695475838128781856222960645024492874269211797),\n+....:     (1, 1)]\n+sage: p = R(coefficients_as_integer_ratios)\n+sage: QQbar.polynomial_root(\n+....:     AA.common_polynomial(p),\n+....:     CIF(RIF(-RR(0.036151142425748496), -RR(0.036151142425748489)),\n+....:     RIF(-RR(0.011298617187916445), -RR(0.011298617187916443))))\n -0.03615114242574849? - 0.011298617187916444?*I\n sage: a.exactify()\n ```\n``````\n",
    "created_at": "2022-05-16T12:56:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33810#issuecomment-546398",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,35 +10,45 @@
 
 ```
 sage: R.<y> = QQ[]
-sage: QQbar.polynomial_root(AA.common_polynomial(y^16 + 125582689229635023429716450054865898420528790240756018
-....: 7136301197703464130999349114638/143366850570759387235995356021211089758156954758381287818562229606450244
-....: 92874269211797*y^15 + 2381053373355961768367731517686940695233776509904535228996271575384952521172329923
-....: 38/27080405107810106477910233915117650287651869232138687699061754481218379597651397400061*y^14 + 2553277
-....: 52077837584624694974814916395144764296822788813014081161094149724325120096/27080405107810106477910233915
-....: 117650287651869232138687699061754481218379597651397400061*y^13 + 172169488086348342833737873138773204371
-....: 4427651970488363462560317808769716807148992/153455628944257270041491325519000018296693925648785896961349
-....: 942060237484386691251933679*y^12 + 943159146189513035186564276948222696462237807532982350570811934263418
-....: 2162193000560/4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333*y
-....: ^11 - 31051495080139473677925068000403254349133134904365702868216464107777210775457136/15345562894425727
-....: 0041491325519000018296693925648785896961349942060237484386691251933679*y^10 + 24725641793859400310483886
-....: 670136079788266826658111372723121573233077840328938576/4143301981494946291120265789013000494010735992517
-....: 219217956448435626412078440663802209333*y^9 + 1151092895747371986483047191334923516591005329489629755485
-....: 810229546333821625856/1381100660498315430373421929671000164670245330839073072652149478542137359480221267
-....: 403111*y^8 - 89705438380888704653335165590083767769953879654958783855317882966200828559360/4143301981494
-....: 946291120265789013000494010735992517219217956448435626412078440663802209333*y^7 + 1110926147990548796149
-....: 597141538460730252912439930561079348611699181798425600/4143301981494946291120265789013000494010735992517
-....: 219217956448435626412078440663802209333*y^6 + 1058302706457859963188800199455039383563153025926272294533
-....: 91693256551317504/13811006604983154303734219296710001646702453308390730726521494785421373594802212674031
-....: 11*y^5 - 2338058278498910195688689352766977573607428722429118859280880481590329344/414330198149494629112
-....: 0265789013000494010735992517219217956448435626412078440663802209333*y^4 - 867360484927778794735864716309
-....: 41922517134071457946320753641122078523392/41433019814949462911202657890130004940107359925172192179564484
-....: 35626412078440663802209333*y^3 + 325579773864372490083706670433410006284520887405882567940047555526656/1
-....: 80143564412823751787837643000565238870031999674661705128541236331583133845246252269971*y^2 - 24216324060
-....: 414384566983400245979288839929814383090701293489050615808/4143301981494946291120265789013000494010735992
-....: 517219217956448435626412078440663802209333*y - 277460008056751756339591326449132324165277906691961644142
-....: 9094563840/4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333), CI
-....: F(RIF(-RR(0.036151142425748496), -RR(0.036151142425748489)), RIF(-RR(0.011298617187916445), -RR(0.011298
-....: 617187916443))))
+sage: coefficients_as_integer_ratios = [
+....:     (-2774600080567517563395913264491323241652779066919616441429094563840,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (-24216324060414384566983400245979288839929814383090701293489050615808,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (325579773864372490083706670433410006284520887405882567940047555526656,
+....:      180143564412823751787837643000565238870031999674661705128541236331583133845246252269971),
+....:     (-86736048492777879473586471630941922517134071457946320753641122078523392,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (-2338058278498910195688689352766977573607428722429118859280880481590329344,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (105830270645785996318880019945503938356315302592627229453391693256551317504,
+....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),
+....:     (1110926147990548796149597141538460730252912439930561079348611699181798425600,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (-89705438380888704653335165590083767769953879654958783855317882966200828559360,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (1151092895747371986483047191334923516591005329489629755485810229546333821625856,
+....:      1381100660498315430373421929671000164670245330839073072652149478542137359480221267403111),
+....:     (24725641793859400310483886670136079788266826658111372723121573233077840328938576,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (-31051495080139473677925068000403254349133134904365702868216464107777210775457136,
+....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),
+....:     (9431591461895130351865642769482226964622378075329823505708119342634182162193000560,
+....:      4143301981494946291120265789013000494010735992517219217956448435626412078440663802209333),
+....:     (1721694880863483428337378731387732043714427651970488363462560317808769716807148992,
+....:      153455628944257270041491325519000018296693925648785896961349942060237484386691251933679),
+....:     (255327752077837584624694974814916395144764296822788813014081161094149724325120096,
+....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),
+....:     (238105337335596176836773151768694069523377650990453522899627157538495252117232992338,
+....:      27080405107810106477910233915117650287651869232138687699061754481218379597651397400061),
+....:     (1255826892296350234297164500548658984205287902407560187136301197703464130999349114638,
+....:      14336685057075938723599535602121108975815695475838128781856222960645024492874269211797),
+....:     (1, 1)]
+sage: p = R(coefficients_as_integer_ratios)
+sage: QQbar.polynomial_root(
+....:     AA.common_polynomial(p),
+....:     CIF(RIF(-RR(0.036151142425748496), -RR(0.036151142425748489)),
+....:     RIF(-RR(0.011298617187916445), -RR(0.011298617187916443))))
 -0.03615114242574849? - 0.011298617187916444?*I
 sage: a.exactify()
 ```
``````




---

archive/issue_events_460433.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33810#event-460433"
}
```



---

archive/issue_events_460434.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33810",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33810#event-460434"
}
```
