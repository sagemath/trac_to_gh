# Issue 33819: build.yml: In workflow_dispatch, make container and base tag selectable; add doc

archive/issues_033582.json:
```json
{
    "body": "as done in https://github.com/sagemath/sage-patchbot/blob/master/.github/workflows/run_patchbot.yml\n\nWe also add some documentation to the developer's guide.\n\n\nCC:  @tobiasdiez @fchapoton @kwankyu @dimpase\n\nBranch/Commit: 1f00ee3c73bbeeeff0670b622537530c0e3aa695\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nDependencies: #34104, #33873, #34092\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33819\n\n",
    "closed_at": "2022-07-11T21:56:30Z",
    "created_at": "2022-05-07T21:19:08Z",
    "labels": [
        "component: user interface"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "build.yml: In workflow_dispatch, make container and base tag selectable; add doc",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33819",
    "user": "https://github.com/mkoeppe"
}
```
as done in https://github.com/sagemath/sage-patchbot/blob/master/.github/workflows/run_patchbot.yml

We also add some documentation to the developer's guide.


CC:  @tobiasdiez @fchapoton @kwankyu @dimpase

Branch/Commit: 1f00ee3c73bbeeeff0670b622537530c0e3aa695

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Dependencies: #34104, #33873, #34092

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33819





---

archive/issue_comments_510616.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-07-04T03:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_510617.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-04T04:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510617",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_510618.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-07-04T20:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510618",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_510619.json:
```json
{
    "body": "<a id='comment:6'></a>With these changes the normal workflow triggered by a push doesn't seem to work anymore since the fallback is not used, i.e. the workflow tries to get `ghcr.io/sagemath/sage/sage-docker--with-targets` which obviously doesn't work: https://github.com/sagemath/sagetrac-mirror/runs/7173656912?check_suite_focus=true",
    "created_at": "2022-07-04T20:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510619",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:6'></a>With these changes the normal workflow triggered by a push doesn't seem to work anymore since the fallback is not used, i.e. the workflow tries to get `ghcr.io/sagemath/sage/sage-docker--with-targets` which obviously doesn't work: https://github.com/sagemath/sagetrac-mirror/runs/7173656912?check_suite_focus=true



---

archive/issue_comments_510620.json:
```json
{
    "body": "<a id='comment:7'></a>Ah, thanks for catching this",
    "created_at": "2022-07-04T21:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510620",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Ah, thanks for catching this



---

archive/issue_comments_510621.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-04T21:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510622.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-07-04T21:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_510623.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-04T21:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510623",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_510624.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-04T21:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510625.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n as done in https://github.com/sagemath/sage-patchbot/blob/master/.github/workflows/run_patchbot.yml\n+\n+We also add some documentation to the developer's guide.\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2022-07-04T21:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510625",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,7 @@
 as done in https://github.com/sagemath/sage-patchbot/blob/master/.github/workflows/run_patchbot.yml
+
+We also add some documentation to the developer's guide.
+
 
 Comment: 1
 
```




---

archive/issue_comments_510626.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-06T01:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510626",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510627.json:
```json
{
    "body": "<a id='comment:17'></a>docs build only after applying\n\n```diff\n--- a/src/doc/en/developer/trac.rst\n+++ b/src/doc/en/developer/trac.rst\n@@ -288,9 +288,8 @@ After pushing a branch to a ticket, the ticket will show badges\n linking to results of automated tests that run on the patchbot and\n other \u200btests that run on GitHub Actions.\n \n-* The Patch buildbot will automatically test your ticket. See `the\n-  patchbot wiki <https://trac.sagemath.org/wiki/patchbot>`_ for more\n-  information about its features and limitations. Make sure that you\n+* The Patch buildbot will automatically test your ticket. See :trac:`wiki/patchbot`\n+  for more information about its features and limitations. Make sure that you\n   look at the log, especially if the patch buildbot did not give you\n   the green blob.\n \n```",
    "created_at": "2022-07-06T23:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510627",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>docs build only after applying

```diff
--- a/src/doc/en/developer/trac.rst
+++ b/src/doc/en/developer/trac.rst
@@ -288,9 +288,8 @@ After pushing a branch to a ticket, the ticket will show badges
 linking to results of automated tests that run on the patchbot and
 other â€‹tests that run on GitHub Actions.
 
-* The Patch buildbot will automatically test your ticket. See `the
-  patchbot wiki <https://trac.sagemath.org/wiki/patchbot>`_ for more
-  information about its features and limitations. Make sure that you
+* The Patch buildbot will automatically test your ticket. See :trac:`wiki/patchbot`
+  for more information about its features and limitations. Make sure that you
   look at the log, especially if the patch buildbot did not give you
   the green blob.
 
```



---

archive/issue_comments_510628.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-07-06T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510628",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_510629.json:
```json
{
    "body": "<a id='comment:19'></a>Thanks, can you push the change to the ticket please?",
    "created_at": "2022-07-06T23:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510629",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>Thanks, can you push the change to the ticket please?



---

archive/issue_comments_510630.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-07T04:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510631.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-07T04:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510631",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_510632.json:
```json
{
    "body": "<a id='comment:22'></a>lgtm",
    "created_at": "2022-07-07T11:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510632",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>lgtm



---

archive/issue_comments_510633.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-07T11:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510633",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_510634.json:
```json
{
    "body": "<a id='comment:23'></a>Thanks!",
    "created_at": "2022-07-07T19:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510634",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Thanks!



---

archive/issue_comments_510635.json:
```json
{
    "body": "<a id='comment:24'></a>PDF docs don't build",
    "created_at": "2022-07-10T10:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510635",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>PDF docs don't build



---

archive/issue_comments_510636.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-10T10:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510636",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_510637.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-10T15:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510637",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510638.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-10T15:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510638",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_088806.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-11T21:56:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33819#event-88806"
}
```



---

archive/issue_comments_510639.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-11T21:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33819#issuecomment-510639",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
