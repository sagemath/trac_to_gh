# Issue 33295: Refactor sage_conf

archive/issues_033058.json:
```json
{
    "assignees": [],
    "body": "(split out from #31396)\n\nWe refactor `sage_conf` to make it easier to maintain variants of it, both the 2 in-tree variants (and another one to be added in #31396) and downstream variants:'''\n- The `configure`-generated configuration file is now `pkgs/sage-conf/_sage_conf/_conf.py`\n- The file `pkgs/sage-conf/sage_conf.py` is now static\n\n\nCC:  @kiwifb @antonio-rojas @tornaria\n\nBranch/Commit: **[eeddb03](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **scripts**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33295_\n\n",
    "closed_at": "2022-07-09T22:33:43Z",
    "created_at": "2022-02-05T17:51:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Refactor sage_conf",
    "type": "issue",
    "updated_at": "2022-07-09T22:33:43Z",
    "url": "https://github.com/sagemath/sage/issues/33295",
    "user": "https://github.com/mkoeppe"
}
```
(split out from #31396)

We refactor `sage_conf` to make it easier to maintain variants of it, both the 2 in-tree variants (and another one to be added in #31396) and downstream variants:'''
- The `configure`-generated configuration file is now `pkgs/sage-conf/_sage_conf/_conf.py`
- The file `pkgs/sage-conf/sage_conf.py` is now static


CC:  @kiwifb @antonio-rojas @tornaria

Branch/Commit: **[eeddb03](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)**

Reviewer: **François Bissey**

Author: **Matthias Koeppe**

Component: **scripts**

_Issue created by migration from https://trac.sagemath.org/ticket/33295_





---

archive/issue_events_457907.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-05T17:51:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457907"
}
```



---

archive/issue_events_457908.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-05T17:51:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20scripts",
    "label_color": "000080",
    "label_name": "c: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457908"
}
```



---

archive/issue_events_457909.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-05T17:51:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457909"
}
```



---

archive/issue_events_457910.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-05T17:51:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457910"
}
```



---

archive/issue_comments_538229.json:
```json
{
    "body": "Branch: **[u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)**",
    "created_at": "2022-02-05T17:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538229",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)**



---

archive/issue_comments_538230.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2022-02-05T18:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538230",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_538231.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155\">70c2e95</a></td><td><code>pkgs/sage-conf*: Refactor</code></td></tr></table>\n",
    "created_at": "2022-02-05T18:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538231",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155">70c2e95</a></td><td><code>pkgs/sage-conf*: Refactor</code></td></tr></table>




---

archive/issue_events_457911.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-05T18:01:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457911"
}
```



---

archive/issue_comments_538232.json:
```json
{
    "body": "Commit: **[70c2e95](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)**",
    "created_at": "2022-02-05T18:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538232",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[70c2e95](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)**



---

archive/issue_comments_538233.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThree version of `sage_conf`? So\n* \"regular\"\n* pypi\n* relocatable\n\nwhen is each one used or intended to be used? Ideally, I want something from pypi or some other repo that will give me a source tarball of the package (and only that one package).",
    "created_at": "2022-02-05T20:23:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538233",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:3" align="right">comment:3</div>

Three version of `sage_conf`? So
* "regular"
* pypi
* relocatable

when is each one used or intended to be used? Ideally, I want something from pypi or some other repo that will give me a source tarball of the package (and only that one package).



---

archive/issue_comments_538234.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@kiwifb](#comment:3):\n> when is each one used or intended to be used? \n\nExplained in `pkgs/sage-conf/README.rst`",
    "created_at": "2022-02-05T20:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538234",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@kiwifb](#comment:3):
> when is each one used or intended to be used? 

Explained in `pkgs/sage-conf/README.rst`



---

archive/issue_events_457912.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-19T02:25:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457912"
}
```



---

archive/issue_events_457913.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-19T02:25:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457913"
}
```



---

archive/issue_comments_538235.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f\">ffb5344</a></td><td><code>Merge tag '9.6.rc3' into t/33295/refactor_sage_conf</code></td></tr></table>\n",
    "created_at": "2022-05-03T01:20:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538235",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f">ffb5344</a></td><td><code>Merge tag '9.6.rc3' into t/33295/refactor_sage_conf</code></td></tr></table>




---

archive/issue_comments_538236.json:
```json
{
    "body": "Changed commit from **[70c2e95](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)** to **[ffb5344](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)**",
    "created_at": "2022-05-03T01:20:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538236",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[70c2e95](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)** to **[ffb5344](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)**



---

archive/issue_comments_538237.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nrebase is needed",
    "created_at": "2022-06-17T11:01:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538237",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

rebase is needed



---

archive/issue_comments_538238.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec\">fbb318d</a></td><td><code>Merge tag '9.7.beta2' into t/33295/refactor_sage_conf</code></td></tr></table>\n",
    "created_at": "2022-06-17T18:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538238",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec">fbb318d</a></td><td><code>Merge tag '9.7.beta2' into t/33295/refactor_sage_conf</code></td></tr></table>




---

archive/issue_comments_538239.json:
```json
{
    "body": "Changed commit from **[ffb5344](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)** to **[fbb318d](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)**",
    "created_at": "2022-06-17T18:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538239",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ffb5344](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)** to **[fbb318d](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)**



---

archive/issue_comments_538240.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI very much want this ticket in 9.7 and it looks in good shape now.",
    "created_at": "2022-06-21T00:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538240",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

I very much want this ticket in 9.7 and it looks in good shape now.



---

archive/issue_events_457914.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-06-21T00:39:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457914"
}
```



---

archive/issue_events_457915.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-06-21T00:39:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457915"
}
```



---

archive/issue_comments_538241.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2022-06-21T00:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538241",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_events_457916.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-06-21T00:59:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457916"
}
```



---

archive/issue_events_457917.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-06-21T00:59:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457917"
}
```



---

archive/issue_comments_538242.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI have spoken too soon. I see there is a file `pkgs/sage_conf/sage_conf.py.in` and its link in `sage_conf_pypi` that may still need removal. I believe it is functionally fully replaced by `_sage_conf/conf.py.in`.\n\nSimilarly, we have `pkgs/sage_conf/setup.cfg` and `pkgs/sage_conf/setup.cfg.in`, and the `.in` is not used anymore by `configure` either\n\n```\ndiff --git a/configure.ac b/configure.ac\nindex eca011d..09f694d 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -514,7 +514,7 @@ dnl AC_CONFIG_HEADERS([config.h])\n AC_CONFIG_FILES([build/make/Makefile-auto build/make/Makefile])\n AC_CONFIG_FILES([src/bin/sage-env-config src/bin/sage-src-env-config build/bin/sage-build-env-config])\n \n-AC_CONFIG_FILES([pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg])\n+AC_CONFIG_FILES([pkgs/sage-conf/_sage_conf/_conf.py])\n \n dnl Create basic directories needed for Sage\n AC_CONFIG_COMMANDS(mkdirs,\n```\n\nOnce those are dealt with, I am OK with putting things straight back to positive review.",
    "created_at": "2022-06-21T00:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538242",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

I have spoken too soon. I see there is a file `pkgs/sage_conf/sage_conf.py.in` and its link in `sage_conf_pypi` that may still need removal. I believe it is functionally fully replaced by `_sage_conf/conf.py.in`.

Similarly, we have `pkgs/sage_conf/setup.cfg` and `pkgs/sage_conf/setup.cfg.in`, and the `.in` is not used anymore by `configure` either

```
diff --git a/configure.ac b/configure.ac
index eca011d..09f694d 100644
--- a/configure.ac
+++ b/configure.ac
@@ -514,7 +514,7 @@ dnl AC_CONFIG_HEADERS([config.h])
 AC_CONFIG_FILES([build/make/Makefile-auto build/make/Makefile])
 AC_CONFIG_FILES([src/bin/sage-env-config src/bin/sage-src-env-config build/bin/sage-build-env-config])
 
-AC_CONFIG_FILES([pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg])
+AC_CONFIG_FILES([pkgs/sage-conf/_sage_conf/_conf.py])
 
 dnl Create basic directories needed for Sage
 AC_CONFIG_COMMANDS(mkdirs,
```

Once those are dealt with, I am OK with putting things straight back to positive review.



---

archive/issue_comments_538243.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThanks for catching this. Looks like I was not careful enough in one of the merges.",
    "created_at": "2022-06-25T18:29:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538243",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Thanks for catching this. Looks like I was not careful enough in one of the merges.



---

archive/issue_comments_538244.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93ca1f7f2d344f1f2611c9c0d45daaf87be64ce6\">93ca1f7</a></td><td><code>Merge tag '9.7.beta3' into t/33295/refactor_sage_conf</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98\">9d10055</a></td><td><code>pkgs/sage-conf*: Remove some obsolete files</code></td></tr></table>\n",
    "created_at": "2022-06-25T18:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538244",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93ca1f7f2d344f1f2611c9c0d45daaf87be64ce6">93ca1f7</a></td><td><code>Merge tag '9.7.beta3' into t/33295/refactor_sage_conf</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98">9d10055</a></td><td><code>pkgs/sage-conf*: Remove some obsolete files</code></td></tr></table>




---

archive/issue_comments_538245.json:
```json
{
    "body": "Changed commit from **[fbb318d](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)** to **[9d10055](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)**",
    "created_at": "2022-06-25T18:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538245",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fbb318d](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)** to **[9d10055](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)**



---

archive/issue_events_457918.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-06-25T18:31:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457918"
}
```



---

archive/issue_events_457919.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-06-25T18:31:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457919"
}
```



---

archive/issue_comments_538246.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nLGTM",
    "created_at": "2022-06-25T20:18:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538246",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

LGTM



---

archive/issue_events_457920.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-06-25T20:18:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457920"
}
```



---

archive/issue_events_457921.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-06-25T20:18:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457921"
}
```



---

archive/issue_comments_538247.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks!",
    "created_at": "2022-06-25T20:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538247",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks!



---

archive/issue_comments_538248.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI am unable to merge this ticket on top of [SageMath](../wiki/SageMath) 9.7.beta3:\n\n```\n% rm -fr sage\n% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git\n% cd sage\n% git-trac-merge 33295\n% make configure\n% source .homebrew-build-env\n% ./configure\n```\ngives\n\n```\nconfig.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'\n```\n(log attached).",
    "created_at": "2022-06-26T21:00:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538248",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:16" align="right">comment:16</div>

I am unable to merge this ticket on top of [SageMath](../wiki/SageMath) 9.7.beta3:

```
% rm -fr sage
% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git
% cd sage
% git-trac-merge 33295
% make configure
% source .homebrew-build-env
% ./configure
```
gives

```
config.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'
```
(log attached).



---

archive/issue_comments_538249.json:
```json
{
    "body": "Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket33295/config.log)**",
    "created_at": "2022-06-26T21:01:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538249",
    "user": "https://github.com/GMS103"
}
```

Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket33295/config.log)**



---

archive/issue_comments_538250.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOK, this is strange. It definitely shouldn't happen. Result of\n\n```\ngrep sage_conf.py configure*\n```\nplease. I mean it like it is, don't add an `.in` anywhere.",
    "created_at": "2022-06-26T21:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538250",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

OK, this is strange. It definitely shouldn't happen. Result of

```
grep sage_conf.py configure*
```
please. I mean it like it is, don't add an `.in` anywhere.



---

archive/issue_comments_538251.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\n\n```\n% grep sage_conf.py configure*\nconfigure:ac_config_files=\"$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg\"\nconfigure:    \"pkgs/sage-conf/sage_conf.py\") CONFIG_FILES=\"$CONFIG_FILES pkgs/sage-conf/sage_conf.py\" ;;\n% \n```\nBut I must add that this happens on macOS 12.4.\nOn macOS 11.6.7 it works.",
    "created_at": "2022-06-26T21:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538251",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:18" align="right">comment:18</div>


```
% grep sage_conf.py configure*
configure:ac_config_files="$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg"
configure:    "pkgs/sage-conf/sage_conf.py") CONFIG_FILES="$CONFIG_FILES pkgs/sage-conf/sage_conf.py" ;;
% 
```
But I must add that this happens on macOS 12.4.
On macOS 11.6.7 it works.



---

archive/issue_comments_538252.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nSomehow the branch hasn't applied, those lines shouldn't be there.",
    "created_at": "2022-06-26T21:24:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538252",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Somehow the branch hasn't applied, those lines shouldn't be there.



---

archive/issue_comments_538253.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nIn fact the problem is the following.\n\n`./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.\n\n(I was merging several tickets, some needing the option.)",
    "created_at": "2022-06-26T21:54:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538253",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:21" align="right">comment:21</div>

In fact the problem is the following.

`./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.

(I was merging several tickets, some needing the option.)



---

archive/issue_comments_538254.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@GMS103](#comment:21):\n> In fact the problem is the following.\n> \n> `./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.\n> \n> (I was merging several tickets, some needing the option.)\n\nAnd it should not whatever the configuration option. The lines I asked you to grep earlier should be absent if you are really on this branch.",
    "created_at": "2022-06-26T21:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538254",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@GMS103](#comment:21):
> In fact the problem is the following.
> 
> `./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.
> 
> (I was merging several tickets, some needing the option.)

And it should not whatever the configuration option. The lines I asked you to grep earlier should be absent if you are really on this branch.



---

archive/issue_comments_538255.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThanks for bearing with my ignorance.\n\nThis is what happens for me every time on macOS 12.4 (but not on macOS 11.6.7).\n\n```\n% rm -fr sage\n% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git\n[...]\n% cd sage\n% git-trac-merge 33295\n#33295\nremote branch: u/mkoeppe/refactor_sage_conf\n\nFrom git://trac.sagemath.org/sage\n * branch                  u/mkoeppe/refactor_sage_conf -> FETCH_HEAD\n * [new branch]            u/mkoeppe/refactor_sage_conf -> trac/u/mkoeppe/refactor_sage_conf\n\nRemoving pkgs/sage-conf_pypi/sage_conf.py.in\nMerge made by the 'recursive' strategy.\n Makefile                                                   |  2 +-\n build/pkgs/sage_conf/dependencies                          |  2 +-\n configure.ac                                               |  2 +-\n pkgs/sage-conf/.gitignore                                  |  4 +++-\n pkgs/sage-conf/_sage_conf/__main__.py                      | 22 ++++++++++++++++++++++\n pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} | 25 -------------------------\n pkgs/sage-conf/sage_conf.py                                |  2 ++\n pkgs/sage-conf/{setup.cfg.in => setup.cfg}                 |  9 +++++----\n pkgs/sage-conf_pypi/.gitignore                             |  3 ++-\n pkgs/sage-conf_pypi/MANIFEST.in                            |  5 +++--\n pkgs/sage-conf_pypi/_sage_conf                             |  1 +\n pkgs/sage-conf_pypi/sage_conf.py                           |  1 +\n pkgs/sage-conf_pypi/sage_conf.py.in                        |  1 -\n pkgs/sage-conf_pypi/setup.cfg                              | 17 +----------------\n pkgs/sage-conf_pypi/setup.py                               | 10 ++--------\n src/bin/sage-env-config.in                                 |  2 +-\n src/bin/sage-src-env-config.in                             |  2 +-\n 17 files changed, 47 insertions(+), 63 deletions(-)\n create mode 100644 pkgs/sage-conf/_sage_conf/__main__.py\n rename pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} (75%)\n create mode 100644 pkgs/sage-conf/sage_conf.py\n rename pkgs/sage-conf/{setup.cfg.in => setup.cfg} (81%)\n create mode 120000 pkgs/sage-conf_pypi/_sage_conf\n create mode 120000 pkgs/sage-conf_pypi/sage_conf.py\n delete mode 120000 pkgs/sage-conf_pypi/sage_conf.py.in\n mode change 100644 => 120000 pkgs/sage-conf_pypi/setup.cfg\n% grep sage_conf.py configure*\n% make configure\n./bootstrap -d\nrm -rf config configure build/make/Makefile-auto.in\nrm -f src/doc/en/installation/*.txt\nrm -rf src/doc/en/reference/spkg/*.rst\nrm -f environment.yml\nrm -f src/environment.yml\nrm -f src/environment-dev.yml\nrm -f environment-optional.yml\nrm -f src/environment-optional.yml\nrm -f src/Pipfile\nrm -f src/pyproject.toml\nrm -f src/requirements.txt\nrm -f src/setup.cfg\nbootstrap:83: installing 'm4/sage_spkg_configures.m4'\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/MANIFEST.in\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile-dist\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/setup.cfg\n./bootstrap-conda:48: generate conda enviroment files\nsrc/doc/bootstrap:68: installing src/doc/en/installation/arch*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/debian*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/fedora*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/cygwin*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/homebrew*.txt\nsrc/doc/bootstrap:78: installing src/doc/en/reference/spkg/*.rst\nbootstrap:74: installing 'config/config.rpath'\n./bootstrap: line 164: aclocal: command not found\nBootstrap failed, downloading required files instead.\nAttempting to download package configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz from mirrors\nDownloading the Sage mirror list\nSearching fastest mirror\n  177ms: http://files.sagemath.org/\n  399ms: http://linorg.usp.br/sage/\n   59ms: https://ftp.rediris.es/mirror/sagemath/\n  523ms: https://ftp.riken.jp/sagemath/\n  350ms: https://ftp.sun.ac.za/ftp/pub/mirrors/www.sagemath.org/\n  264ms: https://ftp.yz.yamagata-u.ac.jp/pub/math/sage/\n  174ms: https://mirror-hk.koddos.net/sagemath/\n  305ms: https://mirror.aarnet.edu.au/pub/sage/\n  245ms: https://mirror.csclub.uwaterloo.ca/sage/\n   27ms: https://mirror.dogado.de/sage/\n   12ms: https://mirror.koddos.net/sagemath/\n   26ms: https://mirror.lyrahosting.com/sagemath/\n   40ms: https://mirror.marwan.ma/sage/\n  577ms: https://mirror.rcg.sfu.ca/mirror/sage/\n  329ms: https://mirror.ufs.ac.za/sagemath/\n  111ms: https://mirror.yandex.ru/mirrors/sage.math.washington.edu/\n   81ms: https://mirrors.aliyun.com/sagemath/\n   86ms: https://mirrors.mit.edu/sage/\n  249ms: https://mirrors.nju.edu.cn/sagemath/\n  685ms: https://mirrors.tuna.tsinghua.edu.cn/sagemath/\n   55ms: https://mirrors.up.pt/pub/sage/\n  245ms: https://mirrors.ustc.edu.cn/sagemath/\n  126ms: https://mirrors.xmission.com/sage/\n   40ms: https://sage.mirror.garr.it/mirrors/sage/\n   15ms: https://www-ftp.lip6.fr/pub/math/sagemath/\n   87ms: https://www.mirrorservice.org/sites/www.sagemath.org/\nFastest mirror: https://mirror.koddos.net/sagemath/\nhttps://mirror.koddos.net/sagemath/spkg/upstream/configure/configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz\n[......................................................................]\n% grep sage_conf.py configure*\nconfigure:ac_config_files=\"$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg\"\nconfigure:    \"pkgs/sage-conf/sage_conf.py\") CONFIG_FILES=\"$CONFIG_FILES pkgs/sage-conf/sage_conf.py\" ;;\n% source .homebrew-build-env\n% ./configure\n[...]\nzn_poly-0.9.2:                               no suitable system package; standard, will be installed as an SPKG\nchecking that generated files are newer than configure... done\nconfigure: creating ./config.status\nconfig.status: creating build/make/Makefile-auto\nconfig.status: creating build/make/Makefile\nconfig.status: creating src/bin/sage-env-config\nconfig.status: creating src/bin/sage-src-env-config\nconfig.status: creating build/bin/sage-build-env-config\nconfig.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'\n% \n```",
    "created_at": "2022-06-26T22:44:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538255",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:23" align="right">comment:23</div>

Thanks for bearing with my ignorance.

This is what happens for me every time on macOS 12.4 (but not on macOS 11.6.7).

```
% rm -fr sage
% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git
[...]
% cd sage
% git-trac-merge 33295
#33295
remote branch: u/mkoeppe/refactor_sage_conf

From git://trac.sagemath.org/sage
 * branch                  u/mkoeppe/refactor_sage_conf -> FETCH_HEAD
 * [new branch]            u/mkoeppe/refactor_sage_conf -> trac/u/mkoeppe/refactor_sage_conf

Removing pkgs/sage-conf_pypi/sage_conf.py.in
Merge made by the 'recursive' strategy.
 Makefile                                                   |  2 +-
 build/pkgs/sage_conf/dependencies                          |  2 +-
 configure.ac                                               |  2 +-
 pkgs/sage-conf/.gitignore                                  |  4 +++-
 pkgs/sage-conf/_sage_conf/__main__.py                      | 22 ++++++++++++++++++++++
 pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} | 25 -------------------------
 pkgs/sage-conf/sage_conf.py                                |  2 ++
 pkgs/sage-conf/{setup.cfg.in => setup.cfg}                 |  9 +++++----
 pkgs/sage-conf_pypi/.gitignore                             |  3 ++-
 pkgs/sage-conf_pypi/MANIFEST.in                            |  5 +++--
 pkgs/sage-conf_pypi/_sage_conf                             |  1 +
 pkgs/sage-conf_pypi/sage_conf.py                           |  1 +
 pkgs/sage-conf_pypi/sage_conf.py.in                        |  1 -
 pkgs/sage-conf_pypi/setup.cfg                              | 17 +----------------
 pkgs/sage-conf_pypi/setup.py                               | 10 ++--------
 src/bin/sage-env-config.in                                 |  2 +-
 src/bin/sage-src-env-config.in                             |  2 +-
 17 files changed, 47 insertions(+), 63 deletions(-)
 create mode 100644 pkgs/sage-conf/_sage_conf/__main__.py
 rename pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} (75%)
 create mode 100644 pkgs/sage-conf/sage_conf.py
 rename pkgs/sage-conf/{setup.cfg.in => setup.cfg} (81%)
 create mode 120000 pkgs/sage-conf_pypi/_sage_conf
 create mode 120000 pkgs/sage-conf_pypi/sage_conf.py
 delete mode 120000 pkgs/sage-conf_pypi/sage_conf.py.in
 mode change 100644 => 120000 pkgs/sage-conf_pypi/setup.cfg
% grep sage_conf.py configure*
% make configure
./bootstrap -d
rm -rf config configure build/make/Makefile-auto.in
rm -f src/doc/en/installation/*.txt
rm -rf src/doc/en/reference/spkg/*.rst
rm -f environment.yml
rm -f src/environment.yml
rm -f src/environment-dev.yml
rm -f environment-optional.yml
rm -f src/environment-optional.yml
rm -f src/Pipfile
rm -f src/pyproject.toml
rm -f src/requirements.txt
rm -f src/setup.cfg
bootstrap:83: installing 'm4/sage_spkg_configures.m4'
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/MANIFEST.in
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile-dist
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/setup.cfg
./bootstrap-conda:48: generate conda enviroment files
src/doc/bootstrap:68: installing src/doc/en/installation/arch*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/debian*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/fedora*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/cygwin*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/homebrew*.txt
src/doc/bootstrap:78: installing src/doc/en/reference/spkg/*.rst
bootstrap:74: installing 'config/config.rpath'
./bootstrap: line 164: aclocal: command not found
Bootstrap failed, downloading required files instead.
Attempting to download package configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz from mirrors
Downloading the Sage mirror list
Searching fastest mirror
  177ms: http://files.sagemath.org/
  399ms: http://linorg.usp.br/sage/
   59ms: https://ftp.rediris.es/mirror/sagemath/
  523ms: https://ftp.riken.jp/sagemath/
  350ms: https://ftp.sun.ac.za/ftp/pub/mirrors/www.sagemath.org/
  264ms: https://ftp.yz.yamagata-u.ac.jp/pub/math/sage/
  174ms: https://mirror-hk.koddos.net/sagemath/
  305ms: https://mirror.aarnet.edu.au/pub/sage/
  245ms: https://mirror.csclub.uwaterloo.ca/sage/
   27ms: https://mirror.dogado.de/sage/
   12ms: https://mirror.koddos.net/sagemath/
   26ms: https://mirror.lyrahosting.com/sagemath/
   40ms: https://mirror.marwan.ma/sage/
  577ms: https://mirror.rcg.sfu.ca/mirror/sage/
  329ms: https://mirror.ufs.ac.za/sagemath/
  111ms: https://mirror.yandex.ru/mirrors/sage.math.washington.edu/
   81ms: https://mirrors.aliyun.com/sagemath/
   86ms: https://mirrors.mit.edu/sage/
  249ms: https://mirrors.nju.edu.cn/sagemath/
  685ms: https://mirrors.tuna.tsinghua.edu.cn/sagemath/
   55ms: https://mirrors.up.pt/pub/sage/
  245ms: https://mirrors.ustc.edu.cn/sagemath/
  126ms: https://mirrors.xmission.com/sage/
   40ms: https://sage.mirror.garr.it/mirrors/sage/
   15ms: https://www-ftp.lip6.fr/pub/math/sagemath/
   87ms: https://www.mirrorservice.org/sites/www.sagemath.org/
Fastest mirror: https://mirror.koddos.net/sagemath/
https://mirror.koddos.net/sagemath/spkg/upstream/configure/configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz
[......................................................................]
% grep sage_conf.py configure*
configure:ac_config_files="$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg"
configure:    "pkgs/sage-conf/sage_conf.py") CONFIG_FILES="$CONFIG_FILES pkgs/sage-conf/sage_conf.py" ;;
% source .homebrew-build-env
% ./configure
[...]
zn_poly-0.9.2:                               no suitable system package; standard, will be installed as an SPKG
checking that generated files are newer than configure... done
configure: creating ./config.status
config.status: creating build/make/Makefile-auto
config.status: creating build/make/Makefile
config.status: creating src/bin/sage-env-config
config.status: creating src/bin/sage-src-env-config
config.status: creating build/bin/sage-build-env-config
config.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'
% 
```



---

archive/issue_comments_538256.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nFrom the output:\n\n```\nbootstrap:74: installing 'config/config.rpath'\n./bootstrap: line 164: aclocal: command not found\nBootstrap failed, downloading required files instead.\n```\n\nThese downloaded files are unsuitable - they don't fit with the changes in the ticket.\n\nInstall the bootstrapping prerequisites (https://doc.sagemath.org/html/en/reference/spkg/_bootstrap.html#spkg-bootstrap)",
    "created_at": "2022-06-26T22:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538256",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

From the output:

```
bootstrap:74: installing 'config/config.rpath'
./bootstrap: line 164: aclocal: command not found
Bootstrap failed, downloading required files instead.
```

These downloaded files are unsuitable - they don't fit with the changes in the ticket.

Install the bootstrapping prerequisites (https://doc.sagemath.org/html/en/reference/spkg/_bootstrap.html#spkg-bootstrap)



---

archive/issue_comments_538257.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThanks Matthias and Fran\u00e7ois.\n\nNow I understand what happened.\nI had uninstalled Homebrew because of some problems, and I thought I had reinstalled all that was needed. But I was wrong.\n\nOnce again, sorry for the noise.",
    "created_at": "2022-06-26T23:13:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538257",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:25" align="right">comment:25</div>

Thanks Matthias and François.

Now I understand what happened.
I had uninstalled Homebrew because of some problems, and I thought I had reinstalled all that was needed. But I was wrong.

Once again, sorry for the noise.



---

archive/issue_comments_538258.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nVolker is trying to merge the ticket and I ended finding a problem. Not sure if it will have an impact on the mergability.\n\n```\n$ sage-config\nTraceback (most recent call last):\n  File \"/usr/lib/python-exec/python3.10/sage-config\", line 5, in <module>\n    from sage_conf.__main__ import _main\nModuleNotFoundError: No module named 'sage_conf.__main__'; 'sage_conf' is not a package\n```\nIt originates from `setup.cfg`\n\n```\n[options.entry_points]\nconsole_scripts =\n    sage-config = sage_conf.__main__:_main\n```\nI tried to change the last line to `sage-config = _sage_conf.__main__:_main` but it leads to a new error\n\n```\n$ sage-config\nTraceback (most recent call last):\n  File \"/usr/lib/python-exec/python3.10/sage-config\", line 5, in <module>\n    from _sage_conf.__main__ import _main\n  File \"/usr/lib/python3.10/site-packages/_sage_conf/__main__.py\", line 3, in <module>\n    from sage_conf import *\n  File \"/usr/lib/python3.10/site-packages/sage_conf.py\", line 2, in <module>\n    from _sage_conf.__main__ import _main\nImportError: cannot import name '_main' from partially initialized module '_sage_conf.__main__' (most likely due to a circular import) (/usr/lib/python3.10/site-packages/_sage_conf/__main__.py)\n```",
    "created_at": "2022-07-01T01:29:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538258",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:26" align="right">comment:26</div>

Volker is trying to merge the ticket and I ended finding a problem. Not sure if it will have an impact on the mergability.

```
$ sage-config
Traceback (most recent call last):
  File "/usr/lib/python-exec/python3.10/sage-config", line 5, in <module>
    from sage_conf.__main__ import _main
ModuleNotFoundError: No module named 'sage_conf.__main__'; 'sage_conf' is not a package
```
It originates from `setup.cfg`

```
[options.entry_points]
console_scripts =
    sage-config = sage_conf.__main__:_main
```
I tried to change the last line to `sage-config = _sage_conf.__main__:_main` but it leads to a new error

```
$ sage-config
Traceback (most recent call last):
  File "/usr/lib/python-exec/python3.10/sage-config", line 5, in <module>
    from _sage_conf.__main__ import _main
  File "/usr/lib/python3.10/site-packages/_sage_conf/__main__.py", line 3, in <module>
    from sage_conf import *
  File "/usr/lib/python3.10/site-packages/sage_conf.py", line 2, in <module>
    from _sage_conf.__main__ import _main
ImportError: cannot import name '_main' from partially initialized module '_sage_conf.__main__' (most likely due to a circular import) (/usr/lib/python3.10/site-packages/_sage_conf/__main__.py)
```



---

archive/issue_comments_538259.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n`sage_conf` is definitely a package after this ticket. Are you sure you installed it?",
    "created_at": "2022-07-01T01:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538259",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

`sage_conf` is definitely a package after this ticket. Are you sure you installed it?



---

archive/issue_comments_538260.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThese are the file I have installed\n\n```\n/usr/lib/python3.10/site-packages/__pycache__\n/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-1.pyc\n/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-2.pyc\n/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.pyc\n/usr/lib/python3.10/site-packages/_sage_conf\n/usr/lib/python3.10/site-packages/_sage_conf/__main__.py\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-1.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-2.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-1.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-2.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/_conf.py\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/METADATA\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/RECORD\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/WHEEL\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/top_level.txt\n/usr/lib/python3.10/site-packages/sage_conf.py\n```\nCould it be some semantics issue? `sage_conf.py` does not have a `main` section. Or may be it shouldn't be present?",
    "created_at": "2022-07-01T01:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538260",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">comment:28</div>

These are the file I have installed

```
/usr/lib/python3.10/site-packages/__pycache__
/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-1.pyc
/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-2.pyc
/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.pyc
/usr/lib/python3.10/site-packages/_sage_conf
/usr/lib/python3.10/site-packages/_sage_conf/__main__.py
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-1.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-2.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-1.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-2.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.pyc
/usr/lib/python3.10/site-packages/_sage_conf/_conf.py
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/METADATA
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/RECORD
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/WHEEL
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/top_level.txt
/usr/lib/python3.10/site-packages/sage_conf.py
```
Could it be some semantics issue? `sage_conf.py` does not have a `main` section. Or may be it shouldn't be present?



---

archive/issue_comments_538261.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@mkoeppe](#comment:27):\n> `sage_conf` is definitely a package after this ticket.\n\nSorry, I take this back",
    "created_at": "2022-07-01T02:03:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538261",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@mkoeppe](#comment:27):
> `sage_conf` is definitely a package after this ticket.

Sorry, I take this back



---

archive/issue_events_457922.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-01T02:04:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457922"
}
```



---

archive/issue_events_457923.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-01T02:04:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457923"
}
```



---

archive/issue_comments_538262.json:
```json
{
    "body": "Changed commit from **[9d10055](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)** to **[eeddb03](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)**",
    "created_at": "2022-07-01T02:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538262",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9d10055](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)** to **[eeddb03](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)**



---

archive/issue_comments_538263.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3\">eeddb03</a></td><td><code>pkgs/sage-conf/setup.cfg: Fix up console_scripts</code></td></tr></table>\n",
    "created_at": "2022-07-01T02:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538263",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3">eeddb03</a></td><td><code>pkgs/sage-conf/setup.cfg: Fix up console_scripts</code></td></tr></table>




---

archive/issue_events_457924.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-01T02:11:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457924"
}
```



---

archive/issue_events_457925.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-01T02:11:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457925"
}
```



---

archive/issue_events_457926.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-07-01T02:50:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457926"
}
```



---

archive/issue_events_457927.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-07-01T02:50:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457927"
}
```



---

archive/issue_comments_538264.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nMuch better. Although I am not sure I will keep `sage-config` in sage-on-gentoo. We may want a more graceful behavior for variables not found in some follow up ticket.",
    "created_at": "2022-07-01T02:50:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538264",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:33" align="right">comment:33</div>

Much better. Although I am not sure I will keep `sage-config` in sage-on-gentoo. We may want a more graceful behavior for variables not found in some follow up ticket.



---

archive/issue_comments_538265.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThanks!",
    "created_at": "2022-07-01T17:41:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538265",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Thanks!



---

archive/issue_comments_538266.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)** to **[eeddb03](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)**",
    "created_at": "2022-07-09T22:33:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33295#issuecomment-538266",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)** to **[eeddb03](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)**



---

archive/issue_events_457928.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:33:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457928"
}
```



---

archive/issue_events_457929.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "80d2ee6704563bf2fb5ad93a010d21e952a1c2c1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-07-09T22:33:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33295",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33295#event-457929"
}
```
