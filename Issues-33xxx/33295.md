# Issue 33295: Refactor sage_conf

archive/issues_033058.json:
```json
{
    "body": "(split out from #31396)\n\nWe refactor `sage_conf` to make it easier to maintain variants of it, both the 2 in-tree variants (and another one to be added in #31396) and downstream variants:'''\n- The `configure`-generated configuration file is now `pkgs/sage-conf/_sage_conf/_conf.py`\n- The file `pkgs/sage-conf/sage_conf.py` is now static\n\n\n**CC:**  @kiwifb @antonio-rojas @tornaria\n\n**Branch/Commit:** [eeddb03c6ce0ccf80a6a823e16335f445ae26ed3](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)\n\n**Reviewer:** Fran\u00e7ois Bissey\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/33295\n\n",
    "closed_at": "2022-07-09T22:33:43Z",
    "created_at": "2022-02-05T17:51:34Z",
    "labels": [
        "component: scripts",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Refactor sage_conf",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33295",
    "user": "https://github.com/mkoeppe"
}
```
(split out from #31396)

We refactor `sage_conf` to make it easier to maintain variants of it, both the 2 in-tree variants (and another one to be added in #31396) and downstream variants:'''
- The `configure`-generated configuration file is now `pkgs/sage-conf/_sage_conf/_conf.py`
- The file `pkgs/sage-conf/sage_conf.py` is now static


**CC:**  @kiwifb @antonio-rojas @tornaria

**Branch/Commit:** [eeddb03c6ce0ccf80a6a823e16335f445ae26ed3](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)

**Reviewer:** François Bissey

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/33295





---

archive/issue_comments_633969.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)",
    "created_at": "2022-02-05T17:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633969",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)



---

archive/issue_comments_633970.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2022-02-05T18:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633970",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_633971.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155\">70c2e95</a></td><td><code>pkgs/sage-conf*: Refactor</code></td></tr></table>\n",
    "created_at": "2022-02-05T18:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633971",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155">70c2e95</a></td><td><code>pkgs/sage-conf*: Refactor</code></td></tr></table>




---

archive/issue_comments_633972.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2022-02-05T18:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633972",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_633973.json:
```json
{
    "body": "**Commit:** [70c2e95d852d65dd6e02d0d6cb7189cb12f4c155](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)",
    "created_at": "2022-02-05T18:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633973",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [70c2e95d852d65dd6e02d0d6cb7189cb12f4c155](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)



---

archive/issue_comments_633974.json:
```json
{
    "body": "<a id='comment:3'></a>\nThree version of `sage_conf`? So\n* \"regular\"\n* pypi\n* relocatable\n\nwhen is each one used or intended to be used? Ideally, I want something from pypi or some other repo that will give me a source tarball of the package (and only that one package).",
    "created_at": "2022-02-05T20:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633974",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
Three version of `sage_conf`? So
* "regular"
* pypi
* relocatable

when is each one used or intended to be used? Ideally, I want something from pypi or some other repo that will give me a source tarball of the package (and only that one package).



---

archive/issue_comments_633975.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [fbissey](#comment%3A3):\n> when is each one used or intended to be used? \n\n\nExplained in `pkgs/sage-conf/README.rst`",
    "created_at": "2022-02-05T20:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633975",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Replying to [fbissey](#comment%3A3):
> when is each one used or intended to be used? 


Explained in `pkgs/sage-conf/README.rst`



---

archive/issue_events_099238.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-19T02:25:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33295#event-99238"
}
```



---

archive/issue_comments_633976.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f\">ffb5344</a></td><td><code>Merge tag '9.6.rc3' into t/33295/refactor_sage_conf</code></td></tr></table>\n",
    "created_at": "2022-05-03T01:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f">ffb5344</a></td><td><code>Merge tag '9.6.rc3' into t/33295/refactor_sage_conf</code></td></tr></table>




---

archive/issue_comments_633977.json:
```json
{
    "body": "**Changing commit** from \"[70c2e95d852d65dd6e02d0d6cb7189cb12f4c155](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)\" to \"[ffb5344a619ee2a417b1799ad10b547c24a5057f](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)\".",
    "created_at": "2022-05-03T01:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633977",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[70c2e95d852d65dd6e02d0d6cb7189cb12f4c155](https://github.com/sagemath/sagetrac-mirror/commit/70c2e95d852d65dd6e02d0d6cb7189cb12f4c155)" to "[ffb5344a619ee2a417b1799ad10b547c24a5057f](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)".



---

archive/issue_comments_633978.json:
```json
{
    "body": "<a id='comment:7'></a>\nrebase is needed",
    "created_at": "2022-06-17T11:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633978",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
rebase is needed



---

archive/issue_comments_633979.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec\">fbb318d</a></td><td><code>Merge tag '9.7.beta2' into t/33295/refactor_sage_conf</code></td></tr></table>\n",
    "created_at": "2022-06-17T18:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633979",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec">fbb318d</a></td><td><code>Merge tag '9.7.beta2' into t/33295/refactor_sage_conf</code></td></tr></table>




---

archive/issue_comments_633980.json:
```json
{
    "body": "**Changing commit** from \"[ffb5344a619ee2a417b1799ad10b547c24a5057f](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)\" to \"[fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)\".",
    "created_at": "2022-06-17T18:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633980",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ffb5344a619ee2a417b1799ad10b547c24a5057f](https://github.com/sagemath/sagetrac-mirror/commit/ffb5344a619ee2a417b1799ad10b547c24a5057f)" to "[fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)".



---

archive/issue_comments_633981.json:
```json
{
    "body": "<a id='comment:9'></a>\nI very much want this ticket in 9.7 and it looks in good shape now.",
    "created_at": "2022-06-21T00:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633981",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
I very much want this ticket in 9.7 and it looks in good shape now.



---

archive/issue_comments_633982.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-06-21T00:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633982",
    "user": "https://github.com/kiwifb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_633983.json:
```json
{
    "body": "**Reviewer:** Fran\u00e7ois Bissey",
    "created_at": "2022-06-21T00:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633983",
    "user": "https://github.com/kiwifb"
}
```

**Reviewer:** François Bissey



---

archive/issue_comments_633984.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2022-06-21T00:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633984",
    "user": "https://github.com/kiwifb"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_633985.json:
```json
{
    "body": "<a id='comment:10'></a>\nI have spoken too soon. I see there is a file `pkgs/sage_conf/sage_conf.py.in` and its link in `sage_conf_pypi` that may still need removal. I believe it is functionally fully replaced by `_sage_conf/conf.py.in`.\n\nSimilarly, we have `pkgs/sage_conf/setup.cfg` and `pkgs/sage_conf/setup.cfg.in`, and the `.in` is not used anymore by `configure` either\n\n```\ndiff --git a/configure.ac b/configure.ac\nindex eca011d..09f694d 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -514,7 +514,7 @@ dnl AC_CONFIG_HEADERS([config.h])\n AC_CONFIG_FILES([build/make/Makefile-auto build/make/Makefile])\n AC_CONFIG_FILES([src/bin/sage-env-config src/bin/sage-src-env-config build/bin/sage-build-env-config])\n \n-AC_CONFIG_FILES([pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg])\n+AC_CONFIG_FILES([pkgs/sage-conf/_sage_conf/_conf.py])\n \n dnl Create basic directories needed for Sage\n AC_CONFIG_COMMANDS(mkdirs,\n```\n\nOnce those are dealt with, I am OK with putting things straight back to positive review.",
    "created_at": "2022-06-21T00:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633985",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'></a>
I have spoken too soon. I see there is a file `pkgs/sage_conf/sage_conf.py.in` and its link in `sage_conf_pypi` that may still need removal. I believe it is functionally fully replaced by `_sage_conf/conf.py.in`.

Similarly, we have `pkgs/sage_conf/setup.cfg` and `pkgs/sage_conf/setup.cfg.in`, and the `.in` is not used anymore by `configure` either

```
diff --git a/configure.ac b/configure.ac
index eca011d..09f694d 100644
--- a/configure.ac
+++ b/configure.ac
@@ -514,7 +514,7 @@ dnl AC_CONFIG_HEADERS([config.h])
 AC_CONFIG_FILES([build/make/Makefile-auto build/make/Makefile])
 AC_CONFIG_FILES([src/bin/sage-env-config src/bin/sage-src-env-config build/bin/sage-build-env-config])
 
-AC_CONFIG_FILES([pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg])
+AC_CONFIG_FILES([pkgs/sage-conf/_sage_conf/_conf.py])
 
 dnl Create basic directories needed for Sage
 AC_CONFIG_COMMANDS(mkdirs,
```

Once those are dealt with, I am OK with putting things straight back to positive review.



---

archive/issue_comments_633986.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks for catching this. Looks like I was not careful enough in one of the merges.",
    "created_at": "2022-06-25T18:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633986",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Thanks for catching this. Looks like I was not careful enough in one of the merges.



---

archive/issue_comments_633987.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93ca1f7f2d344f1f2611c9c0d45daaf87be64ce6\">93ca1f7</a></td><td><code>Merge tag '9.7.beta3' into t/33295/refactor_sage_conf</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98\">9d10055</a></td><td><code>pkgs/sage-conf*: Remove some obsolete files</code></td></tr></table>\n",
    "created_at": "2022-06-25T18:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93ca1f7f2d344f1f2611c9c0d45daaf87be64ce6">93ca1f7</a></td><td><code>Merge tag '9.7.beta3' into t/33295/refactor_sage_conf</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98">9d10055</a></td><td><code>pkgs/sage-conf*: Remove some obsolete files</code></td></tr></table>




---

archive/issue_comments_633988.json:
```json
{
    "body": "**Changing commit** from \"[fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)\" to \"[9d100555f824ec0d7d6c509f750a3887692c3f98](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)\".",
    "created_at": "2022-06-25T18:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec](https://github.com/sagemath/sagetrac-mirror/commit/fbb318d1d130b8a20dcde0f0ac626dd7b69e50ec)" to "[9d100555f824ec0d7d6c509f750a3887692c3f98](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)".



---

archive/issue_comments_633989.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2022-06-25T18:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633989",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_633990.json:
```json
{
    "body": "<a id='comment:14'></a>\nLGTM",
    "created_at": "2022-06-25T20:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633990",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>
LGTM



---

archive/issue_comments_633991.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-06-25T20:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633991",
    "user": "https://github.com/kiwifb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_633992.json:
```json
{
    "body": "<a id='comment:15'></a>\nThanks!",
    "created_at": "2022-06-25T20:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633992",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Thanks!



---

archive/issue_comments_633993.json:
```json
{
    "body": "<a id='comment:16'></a>\nI am unable to merge this ticket on top of [SageMath](SageMath) 9.7.beta3:\n\n```\n% rm -fr sage\n% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git\n% cd sage\n% git-trac-merge 33295\n% make configure\n% source .homebrew-build-env\n% ./configure\n```\ngives\n\n```\nconfig.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'\n```\n(log attached).",
    "created_at": "2022-06-26T21:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633993",
    "user": "https://github.com/GMS103"
}
```

<a id='comment:16'></a>
I am unable to merge this ticket on top of [SageMath](SageMath) 9.7.beta3:

```
% rm -fr sage
% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git
% cd sage
% git-trac-merge 33295
% make configure
% source .homebrew-build-env
% ./configure
```
gives

```
config.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'
```
(log attached).



---

archive/attachments_021591.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "config.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket33295/config.log",
    "created_at": "2022-06-26T21:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://github.com/GMS103"
}
```



---

archive/issue_comments_633994.json:
```json
{
    "body": "",
    "created_at": "2022-06-26T21:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633994",
    "user": "https://github.com/GMS103"
}
```





---

archive/issue_comments_633995.json:
```json
{
    "body": "<a id='comment:17'></a>\nOK, this is strange. It definitely shouldn't happen. Result of\n\n```\ngrep sage_conf.py configure*\n```\nplease. I mean it like it is, don't add an `.in` anywhere.",
    "created_at": "2022-06-26T21:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633995",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
OK, this is strange. It definitely shouldn't happen. Result of

```
grep sage_conf.py configure*
```
please. I mean it like it is, don't add an `.in` anywhere.



---

archive/issue_comments_633996.json:
```json
{
    "body": "<a id='comment:18'></a>\n\n```\n% grep sage_conf.py configure*\nconfigure:ac_config_files=\"$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg\"\nconfigure:    \"pkgs/sage-conf/sage_conf.py\") CONFIG_FILES=\"$CONFIG_FILES pkgs/sage-conf/sage_conf.py\" ;;\n% \n```\nBut I must add that this happens on macOS 12.4.\nOn macOS 11.6.7 it works.",
    "created_at": "2022-06-26T21:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633996",
    "user": "https://github.com/GMS103"
}
```

<a id='comment:18'></a>

```
% grep sage_conf.py configure*
configure:ac_config_files="$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg"
configure:    "pkgs/sage-conf/sage_conf.py") CONFIG_FILES="$CONFIG_FILES pkgs/sage-conf/sage_conf.py" ;;
% 
```
But I must add that this happens on macOS 12.4.
On macOS 11.6.7 it works.



---

archive/issue_comments_633997.json:
```json
{
    "body": "<a id='comment:19'></a>\nSomehow the branch hasn't applied, those lines shouldn't be there.",
    "created_at": "2022-06-26T21:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633997",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Somehow the branch hasn't applied, those lines shouldn't be there.



---

archive/issue_comments_633998.json:
```json
{
    "body": "<a id='comment:21'></a>\nIn fact the problem is the following.\n\n`./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.\n\n(I was merging several tickets, some needing the option.)",
    "created_at": "2022-06-26T21:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633998",
    "user": "https://github.com/GMS103"
}
```

<a id='comment:21'></a>
In fact the problem is the following.

`./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.

(I was merging several tickets, some needing the option.)



---

archive/issue_comments_633999.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [gh-GMS103](#comment%3A21):\n> In fact the problem is the following.\n> \n> `./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.\n> \n> (I was merging several tickets, some needing the option.)\n\n\nAnd it should not whatever the configuration option. The lines I asked you to grep earlier should be absent if you are really on this branch.",
    "created_at": "2022-06-26T21:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-633999",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:22'></a>
Replying to [gh-GMS103](#comment%3A21):
> In fact the problem is the following.
> 
> `./configure` works, but `./configure --enable-download-from-upstream-url` fails as indicated.
> 
> (I was merging several tickets, some needing the option.)


And it should not whatever the configuration option. The lines I asked you to grep earlier should be absent if you are really on this branch.



---

archive/issue_comments_634000.json:
```json
{
    "body": "<a id='comment:23'></a>\nThanks for bearing with my ignorance.\n\nThis is what happens for me every time on macOS 12.4 (but not on macOS 11.6.7).\n\n```\n% rm -fr sage\n% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git\n[...]\n% cd sage\n% git-trac-merge 33295\n#33295\nremote branch: u/mkoeppe/refactor_sage_conf\n\nFrom git://trac.sagemath.org/sage\n * branch                  u/mkoeppe/refactor_sage_conf -> FETCH_HEAD\n * [new branch]            u/mkoeppe/refactor_sage_conf -> trac/u/mkoeppe/refactor_sage_conf\n\nRemoving pkgs/sage-conf_pypi/sage_conf.py.in\nMerge made by the 'recursive' strategy.\n Makefile                                                   |  2 +-\n build/pkgs/sage_conf/dependencies                          |  2 +-\n configure.ac                                               |  2 +-\n pkgs/sage-conf/.gitignore                                  |  4 +++-\n pkgs/sage-conf/_sage_conf/__main__.py                      | 22 ++++++++++++++++++++++\n pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} | 25 -------------------------\n pkgs/sage-conf/sage_conf.py                                |  2 ++\n pkgs/sage-conf/{setup.cfg.in => setup.cfg}                 |  9 +++++----\n pkgs/sage-conf_pypi/.gitignore                             |  3 ++-\n pkgs/sage-conf_pypi/MANIFEST.in                            |  5 +++--\n pkgs/sage-conf_pypi/_sage_conf                             |  1 +\n pkgs/sage-conf_pypi/sage_conf.py                           |  1 +\n pkgs/sage-conf_pypi/sage_conf.py.in                        |  1 -\n pkgs/sage-conf_pypi/setup.cfg                              | 17 +----------------\n pkgs/sage-conf_pypi/setup.py                               | 10 ++--------\n src/bin/sage-env-config.in                                 |  2 +-\n src/bin/sage-src-env-config.in                             |  2 +-\n 17 files changed, 47 insertions(+), 63 deletions(-)\n create mode 100644 pkgs/sage-conf/_sage_conf/__main__.py\n rename pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} (75%)\n create mode 100644 pkgs/sage-conf/sage_conf.py\n rename pkgs/sage-conf/{setup.cfg.in => setup.cfg} (81%)\n create mode 120000 pkgs/sage-conf_pypi/_sage_conf\n create mode 120000 pkgs/sage-conf_pypi/sage_conf.py\n delete mode 120000 pkgs/sage-conf_pypi/sage_conf.py.in\n mode change 100644 => 120000 pkgs/sage-conf_pypi/setup.cfg\n% grep sage_conf.py configure*\n% make configure\n./bootstrap -d\nrm -rf config configure build/make/Makefile-auto.in\nrm -f src/doc/en/installation/*.txt\nrm -rf src/doc/en/reference/spkg/*.rst\nrm -f environment.yml\nrm -f src/environment.yml\nrm -f src/environment-dev.yml\nrm -f environment-optional.yml\nrm -f src/environment-optional.yml\nrm -f src/Pipfile\nrm -f src/pyproject.toml\nrm -f src/requirements.txt\nrm -f src/setup.cfg\nbootstrap:83: installing 'm4/sage_spkg_configures.m4'\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/MANIFEST.in\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/setup.cfg\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile-dist\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/pyproject.toml\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/requirements.txt\n./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/setup.cfg\n./bootstrap-conda:48: generate conda enviroment files\nsrc/doc/bootstrap:68: installing src/doc/en/installation/arch*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/debian*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/fedora*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/cygwin*.txt\nsrc/doc/bootstrap:68: installing src/doc/en/installation/homebrew*.txt\nsrc/doc/bootstrap:78: installing src/doc/en/reference/spkg/*.rst\nbootstrap:74: installing 'config/config.rpath'\n./bootstrap: line 164: aclocal: command not found\nBootstrap failed, downloading required files instead.\nAttempting to download package configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz from mirrors\nDownloading the Sage mirror list\nSearching fastest mirror\n  177ms: http://files.sagemath.org/\n  399ms: http://linorg.usp.br/sage/\n   59ms: https://ftp.rediris.es/mirror/sagemath/\n  523ms: https://ftp.riken.jp/sagemath/\n  350ms: https://ftp.sun.ac.za/ftp/pub/mirrors/www.sagemath.org/\n  264ms: https://ftp.yz.yamagata-u.ac.jp/pub/math/sage/\n  174ms: https://mirror-hk.koddos.net/sagemath/\n  305ms: https://mirror.aarnet.edu.au/pub/sage/\n  245ms: https://mirror.csclub.uwaterloo.ca/sage/\n   27ms: https://mirror.dogado.de/sage/\n   12ms: https://mirror.koddos.net/sagemath/\n   26ms: https://mirror.lyrahosting.com/sagemath/\n   40ms: https://mirror.marwan.ma/sage/\n  577ms: https://mirror.rcg.sfu.ca/mirror/sage/\n  329ms: https://mirror.ufs.ac.za/sagemath/\n  111ms: https://mirror.yandex.ru/mirrors/sage.math.washington.edu/\n   81ms: https://mirrors.aliyun.com/sagemath/\n   86ms: https://mirrors.mit.edu/sage/\n  249ms: https://mirrors.nju.edu.cn/sagemath/\n  685ms: https://mirrors.tuna.tsinghua.edu.cn/sagemath/\n   55ms: https://mirrors.up.pt/pub/sage/\n  245ms: https://mirrors.ustc.edu.cn/sagemath/\n  126ms: https://mirrors.xmission.com/sage/\n   40ms: https://sage.mirror.garr.it/mirrors/sage/\n   15ms: https://www-ftp.lip6.fr/pub/math/sagemath/\n   87ms: https://www.mirrorservice.org/sites/www.sagemath.org/\nFastest mirror: https://mirror.koddos.net/sagemath/\nhttps://mirror.koddos.net/sagemath/spkg/upstream/configure/configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz\n[......................................................................]\n% grep sage_conf.py configure*\nconfigure:ac_config_files=\"$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg\"\nconfigure:    \"pkgs/sage-conf/sage_conf.py\") CONFIG_FILES=\"$CONFIG_FILES pkgs/sage-conf/sage_conf.py\" ;;\n% source .homebrew-build-env\n% ./configure\n[...]\nzn_poly-0.9.2:                               no suitable system package; standard, will be installed as an SPKG\nchecking that generated files are newer than configure... done\nconfigure: creating ./config.status\nconfig.status: creating build/make/Makefile-auto\nconfig.status: creating build/make/Makefile\nconfig.status: creating src/bin/sage-env-config\nconfig.status: creating src/bin/sage-src-env-config\nconfig.status: creating build/bin/sage-build-env-config\nconfig.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'\n% \n```",
    "created_at": "2022-06-26T22:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634000",
    "user": "https://github.com/GMS103"
}
```

<a id='comment:23'></a>
Thanks for bearing with my ignorance.

This is what happens for me every time on macOS 12.4 (but not on macOS 11.6.7).

```
% rm -fr sage
% git clone -c core.symlinks=true --branch develop --tags https://github.com/sagemath/sage.git
[...]
% cd sage
% git-trac-merge 33295
#33295
remote branch: u/mkoeppe/refactor_sage_conf

From git://trac.sagemath.org/sage
 * branch                  u/mkoeppe/refactor_sage_conf -> FETCH_HEAD
 * [new branch]            u/mkoeppe/refactor_sage_conf -> trac/u/mkoeppe/refactor_sage_conf

Removing pkgs/sage-conf_pypi/sage_conf.py.in
Merge made by the 'recursive' strategy.
 Makefile                                                   |  2 +-
 build/pkgs/sage_conf/dependencies                          |  2 +-
 configure.ac                                               |  2 +-
 pkgs/sage-conf/.gitignore                                  |  4 +++-
 pkgs/sage-conf/_sage_conf/__main__.py                      | 22 ++++++++++++++++++++++
 pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} | 25 -------------------------
 pkgs/sage-conf/sage_conf.py                                |  2 ++
 pkgs/sage-conf/{setup.cfg.in => setup.cfg}                 |  9 +++++----
 pkgs/sage-conf_pypi/.gitignore                             |  3 ++-
 pkgs/sage-conf_pypi/MANIFEST.in                            |  5 +++--
 pkgs/sage-conf_pypi/_sage_conf                             |  1 +
 pkgs/sage-conf_pypi/sage_conf.py                           |  1 +
 pkgs/sage-conf_pypi/sage_conf.py.in                        |  1 -
 pkgs/sage-conf_pypi/setup.cfg                              | 17 +----------------
 pkgs/sage-conf_pypi/setup.py                               | 10 ++--------
 src/bin/sage-env-config.in                                 |  2 +-
 src/bin/sage-src-env-config.in                             |  2 +-
 17 files changed, 47 insertions(+), 63 deletions(-)
 create mode 100644 pkgs/sage-conf/_sage_conf/__main__.py
 rename pkgs/sage-conf/{sage_conf.py.in => _sage_conf/_conf.py.in} (75%)
 create mode 100644 pkgs/sage-conf/sage_conf.py
 rename pkgs/sage-conf/{setup.cfg.in => setup.cfg} (81%)
 create mode 120000 pkgs/sage-conf_pypi/_sage_conf
 create mode 120000 pkgs/sage-conf_pypi/sage_conf.py
 delete mode 120000 pkgs/sage-conf_pypi/sage_conf.py.in
 mode change 100644 => 120000 pkgs/sage-conf_pypi/setup.cfg
% grep sage_conf.py configure*
% make configure
./bootstrap -d
rm -rf config configure build/make/Makefile-auto.in
rm -f src/doc/en/installation/*.txt
rm -rf src/doc/en/reference/spkg/*.rst
rm -f environment.yml
rm -f src/environment.yml
rm -f src/environment-dev.yml
rm -f environment-optional.yml
rm -f src/environment-optional.yml
rm -f src/Pipfile
rm -f src/pyproject.toml
rm -f src/requirements.txt
rm -f src/setup.cfg
bootstrap:83: installing 'm4/sage_spkg_configures.m4'
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_objects/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_environment/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_repl/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/MANIFEST.in
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagemath_categories/src/setup.cfg
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile-dist
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/Pipfile
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/pyproject.toml
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/requirements.txt
./bootstrap: installing /Users/sagemath/SageMath/Git/sage/build/pkgs/sagelib/src/setup.cfg
./bootstrap-conda:48: generate conda enviroment files
src/doc/bootstrap:68: installing src/doc/en/installation/arch*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/debian*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/fedora*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/cygwin*.txt
src/doc/bootstrap:68: installing src/doc/en/installation/homebrew*.txt
src/doc/bootstrap:78: installing src/doc/en/reference/spkg/*.rst
bootstrap:74: installing 'config/config.rpath'
./bootstrap: line 164: aclocal: command not found
Bootstrap failed, downloading required files instead.
Attempting to download package configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz from mirrors
Downloading the Sage mirror list
Searching fastest mirror
  177ms: http://files.sagemath.org/
  399ms: http://linorg.usp.br/sage/
   59ms: https://ftp.rediris.es/mirror/sagemath/
  523ms: https://ftp.riken.jp/sagemath/
  350ms: https://ftp.sun.ac.za/ftp/pub/mirrors/www.sagemath.org/
  264ms: https://ftp.yz.yamagata-u.ac.jp/pub/math/sage/
  174ms: https://mirror-hk.koddos.net/sagemath/
  305ms: https://mirror.aarnet.edu.au/pub/sage/
  245ms: https://mirror.csclub.uwaterloo.ca/sage/
   27ms: https://mirror.dogado.de/sage/
   12ms: https://mirror.koddos.net/sagemath/
   26ms: https://mirror.lyrahosting.com/sagemath/
   40ms: https://mirror.marwan.ma/sage/
  577ms: https://mirror.rcg.sfu.ca/mirror/sage/
  329ms: https://mirror.ufs.ac.za/sagemath/
  111ms: https://mirror.yandex.ru/mirrors/sage.math.washington.edu/
   81ms: https://mirrors.aliyun.com/sagemath/
   86ms: https://mirrors.mit.edu/sage/
  249ms: https://mirrors.nju.edu.cn/sagemath/
  685ms: https://mirrors.tuna.tsinghua.edu.cn/sagemath/
   55ms: https://mirrors.up.pt/pub/sage/
  245ms: https://mirrors.ustc.edu.cn/sagemath/
  126ms: https://mirrors.xmission.com/sage/
   40ms: https://sage.mirror.garr.it/mirrors/sage/
   15ms: https://www-ftp.lip6.fr/pub/math/sagemath/
   87ms: https://www.mirrorservice.org/sites/www.sagemath.org/
Fastest mirror: https://mirror.koddos.net/sagemath/
https://mirror.koddos.net/sagemath/spkg/upstream/configure/configure-b466c8ae02c04d287d28d2d669e1d111df3724ff.tar.gz
[......................................................................]
% grep sage_conf.py configure*
configure:ac_config_files="$ac_config_files pkgs/sage-conf/sage_conf.py pkgs/sage-conf/setup.cfg"
configure:    "pkgs/sage-conf/sage_conf.py") CONFIG_FILES="$CONFIG_FILES pkgs/sage-conf/sage_conf.py" ;;
% source .homebrew-build-env
% ./configure
[...]
zn_poly-0.9.2:                               no suitable system package; standard, will be installed as an SPKG
checking that generated files are newer than configure... done
configure: creating ./config.status
config.status: creating build/make/Makefile-auto
config.status: creating build/make/Makefile
config.status: creating src/bin/sage-env-config
config.status: creating src/bin/sage-src-env-config
config.status: creating build/bin/sage-build-env-config
config.status: error: cannot find input file: `pkgs/sage-conf/sage_conf.py.in'
% 
```



---

archive/issue_comments_634001.json:
```json
{
    "body": "<a id='comment:24'></a>\nFrom the output:\n\n```\nbootstrap:74: installing 'config/config.rpath'\n./bootstrap: line 164: aclocal: command not found\nBootstrap failed, downloading required files instead.\n```\n\nThese downloaded files are unsuitable - they don't fit with the changes in the ticket.\n\nInstall the bootstrapping prerequisites (https://doc.sagemath.org/html/en/reference/spkg/_bootstrap.html#spkg-bootstrap)",
    "created_at": "2022-06-26T22:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634001",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
From the output:

```
bootstrap:74: installing 'config/config.rpath'
./bootstrap: line 164: aclocal: command not found
Bootstrap failed, downloading required files instead.
```

These downloaded files are unsuitable - they don't fit with the changes in the ticket.

Install the bootstrapping prerequisites (https://doc.sagemath.org/html/en/reference/spkg/_bootstrap.html#spkg-bootstrap)



---

archive/issue_comments_634002.json:
```json
{
    "body": "<a id='comment:25'></a>\nThanks Matthias and Fran\u00e7ois.\n\nNow I understand what happened.\nI had uninstalled Homebrew because of some problems, and I thought I had reinstalled all that was needed. But I was wrong.\n\nOnce again, sorry for the noise.",
    "created_at": "2022-06-26T23:13:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634002",
    "user": "https://github.com/GMS103"
}
```

<a id='comment:25'></a>
Thanks Matthias and François.

Now I understand what happened.
I had uninstalled Homebrew because of some problems, and I thought I had reinstalled all that was needed. But I was wrong.

Once again, sorry for the noise.



---

archive/issue_comments_634003.json:
```json
{
    "body": "<a id='comment:26'></a>\nVolker is trying to merge the ticket and I ended finding a problem. Not sure if it will have an impact on the mergability.\n\n```\n$ sage-config\nTraceback (most recent call last):\n  File \"/usr/lib/python-exec/python3.10/sage-config\", line 5, in <module>\n    from sage_conf.__main__ import _main\nModuleNotFoundError: No module named 'sage_conf.__main__'; 'sage_conf' is not a package\n```\nIt originates from `setup.cfg`\n\n```\n[options.entry_points]\nconsole_scripts =\n    sage-config = sage_conf.__main__:_main\n```\nI tried to change the last line to `sage-config = _sage_conf.__main__:_main` but it leads to a new error\n\n```\n$ sage-config\nTraceback (most recent call last):\n  File \"/usr/lib/python-exec/python3.10/sage-config\", line 5, in <module>\n    from _sage_conf.__main__ import _main\n  File \"/usr/lib/python3.10/site-packages/_sage_conf/__main__.py\", line 3, in <module>\n    from sage_conf import *\n  File \"/usr/lib/python3.10/site-packages/sage_conf.py\", line 2, in <module>\n    from _sage_conf.__main__ import _main\nImportError: cannot import name '_main' from partially initialized module '_sage_conf.__main__' (most likely due to a circular import) (/usr/lib/python3.10/site-packages/_sage_conf/__main__.py)\n```",
    "created_at": "2022-07-01T01:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634003",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'></a>
Volker is trying to merge the ticket and I ended finding a problem. Not sure if it will have an impact on the mergability.

```
$ sage-config
Traceback (most recent call last):
  File "/usr/lib/python-exec/python3.10/sage-config", line 5, in <module>
    from sage_conf.__main__ import _main
ModuleNotFoundError: No module named 'sage_conf.__main__'; 'sage_conf' is not a package
```
It originates from `setup.cfg`

```
[options.entry_points]
console_scripts =
    sage-config = sage_conf.__main__:_main
```
I tried to change the last line to `sage-config = _sage_conf.__main__:_main` but it leads to a new error

```
$ sage-config
Traceback (most recent call last):
  File "/usr/lib/python-exec/python3.10/sage-config", line 5, in <module>
    from _sage_conf.__main__ import _main
  File "/usr/lib/python3.10/site-packages/_sage_conf/__main__.py", line 3, in <module>
    from sage_conf import *
  File "/usr/lib/python3.10/site-packages/sage_conf.py", line 2, in <module>
    from _sage_conf.__main__ import _main
ImportError: cannot import name '_main' from partially initialized module '_sage_conf.__main__' (most likely due to a circular import) (/usr/lib/python3.10/site-packages/_sage_conf/__main__.py)
```



---

archive/issue_comments_634004.json:
```json
{
    "body": "<a id='comment:27'></a>\n`sage_conf` is definitely a package after this ticket. Are you sure you installed it?",
    "created_at": "2022-07-01T01:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634004",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
`sage_conf` is definitely a package after this ticket. Are you sure you installed it?



---

archive/issue_comments_634005.json:
```json
{
    "body": "<a id='comment:28'></a>\nThese are the file I have installed\n\n```\n/usr/lib/python3.10/site-packages/__pycache__\n/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-1.pyc\n/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-2.pyc\n/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.pyc\n/usr/lib/python3.10/site-packages/_sage_conf\n/usr/lib/python3.10/site-packages/_sage_conf/__main__.py\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-1.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-2.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-1.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-2.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.pyc\n/usr/lib/python3.10/site-packages/_sage_conf/_conf.py\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/METADATA\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/RECORD\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/WHEEL\n/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/top_level.txt\n/usr/lib/python3.10/site-packages/sage_conf.py\n```\nCould it be some semantics issue? `sage_conf.py` does not have a `main` section. Or may be it shouldn't be present?",
    "created_at": "2022-07-01T01:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634005",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:28'></a>
These are the file I have installed

```
/usr/lib/python3.10/site-packages/__pycache__
/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-1.pyc
/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.opt-2.pyc
/usr/lib/python3.10/site-packages/__pycache__/sage_conf.cpython-310.pyc
/usr/lib/python3.10/site-packages/_sage_conf
/usr/lib/python3.10/site-packages/_sage_conf/__main__.py
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-1.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.opt-2.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/__main__.cpython-310.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-1.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.opt-2.pyc
/usr/lib/python3.10/site-packages/_sage_conf/__pycache__/_conf.cpython-310.pyc
/usr/lib/python3.10/site-packages/_sage_conf/_conf.py
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/METADATA
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/RECORD
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/WHEEL
/usr/lib/python3.10/site-packages/sage_conf-9.7b3.dist-info/top_level.txt
/usr/lib/python3.10/site-packages/sage_conf.py
```
Could it be some semantics issue? `sage_conf.py` does not have a `main` section. Or may be it shouldn't be present?



---

archive/issue_comments_634006.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [mkoeppe](#comment%3A27):\n> `sage_conf` is definitely a package after this ticket.\n\n\nSorry, I take this back",
    "created_at": "2022-07-01T02:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634006",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Replying to [mkoeppe](#comment%3A27):
> `sage_conf` is definitely a package after this ticket.


Sorry, I take this back



---

archive/issue_comments_634007.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2022-07-01T02:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634007",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_634008.json:
```json
{
    "body": "**Changing commit** from \"[9d100555f824ec0d7d6c509f750a3887692c3f98](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)\" to \"[eeddb03c6ce0ccf80a6a823e16335f445ae26ed3](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)\".",
    "created_at": "2022-07-01T02:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9d100555f824ec0d7d6c509f750a3887692c3f98](https://github.com/sagemath/sagetrac-mirror/commit/9d100555f824ec0d7d6c509f750a3887692c3f98)" to "[eeddb03c6ce0ccf80a6a823e16335f445ae26ed3](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)".



---

archive/issue_comments_634009.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3\">eeddb03</a></td><td><code>pkgs/sage-conf/setup.cfg: Fix up console_scripts</code></td></tr></table>\n",
    "created_at": "2022-07-01T02:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3">eeddb03</a></td><td><code>pkgs/sage-conf/setup.cfg: Fix up console_scripts</code></td></tr></table>




---

archive/issue_comments_634010.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2022-07-01T02:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634010",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_634011.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-07-01T02:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634011",
    "user": "https://github.com/kiwifb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_634012.json:
```json
{
    "body": "<a id='comment:33'></a>\nMuch better. Although I am not sure I will keep `sage-config` in sage-on-gentoo. We may want a more graceful behavior for variables not found in some follow up ticket.",
    "created_at": "2022-07-01T02:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634012",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:33'></a>
Much better. Although I am not sure I will keep `sage-config` in sage-on-gentoo. We may want a more graceful behavior for variables not found in some follow up ticket.



---

archive/issue_comments_634013.json:
```json
{
    "body": "<a id='comment:34'></a>\nThanks!",
    "created_at": "2022-07-01T17:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634013",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
Thanks!



---

archive/issue_comments_634014.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)\" to \"[eeddb03c6ce0ccf80a6a823e16335f445ae26ed3](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)\".",
    "created_at": "2022-07-09T22:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33295#issuecomment-634014",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/refactor_sage_conf](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refactor_sage_conf)" to "[eeddb03c6ce0ccf80a6a823e16335f445ae26ed3](https://github.com/sagemath/sagetrac-mirror/commit/eeddb03c6ce0ccf80a6a823e16335f445ae26ed3)".



---

archive/issue_events_099239.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:33:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33295",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33295#event-99239"
}
```
