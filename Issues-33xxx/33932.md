# Issue 33932: Sets of unhashable elements are broken

archive/issues_033695.json:
```json
{
    "body": "Documentation says \"Sets with unhashable objects work, but with less functionality\". However, this functionality is actually broken in at least two ways.\n\nFirst, Sets of unhashable elements fail to recognize equal elements - for example\n\n```\nS = Set([factor(10),factor(10)])\nprint(S)\n```\n\nprints `Set of elements of [2 * 5, 2 * 5]`, that is the resulting Set here contains two identical elements.\n\n---\n\nSecond, Set skips the first element when it's created from an iterator of unhashable elements:\n\n```\nS = Set( [i] for i in (1..5) )\nprint(list(S))\n```\n\nThis code prints `[[2], [3], [4], [5]]`, that is the first generated element `[1]` is missing.\n\nA patch for the latter issue was proposed at https://ask.sagemath.org/question/62252/?answer=62285#post-id-62285 which however comes with an overhead.\n\n**CC:**  @tscrim\n\n**Reviewer:** Travis Scrimshaw\n\n**Dependencies:** #23324, #34387\n\nIssue created by migration from https://trac.sagemath.org/ticket/33932\n\n",
    "closed_at": "2022-09-01T02:30:35Z",
    "created_at": "2022-05-29T02:43:43Z",
    "labels": [
        "component: misc",
        "bug",
        "invalid"
    ],
    "title": "Sets of unhashable elements are broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33932",
    "user": "https://github.com/maxale"
}
```
Documentation says "Sets with unhashable objects work, but with less functionality". However, this functionality is actually broken in at least two ways.

First, Sets of unhashable elements fail to recognize equal elements - for example

```
S = Set([factor(10),factor(10)])
print(S)
```

prints `Set of elements of [2 * 5, 2 * 5]`, that is the resulting Set here contains two identical elements.

---

Second, Set skips the first element when it's created from an iterator of unhashable elements:

```
S = Set( [i] for i in (1..5) )
print(list(S))
```

This code prints `[[2], [3], [4], [5]]`, that is the first generated element `[1]` is missing.

A patch for the latter issue was proposed at https://ask.sagemath.org/question/62252/?answer=62285#post-id-62285 which however comes with an overhead.

**CC:**  @tscrim

**Reviewer:** Travis Scrimshaw

**Dependencies:** #23324, #34387

Issue created by migration from https://trac.sagemath.org/ticket/33932





---

archive/issue_comments_552776.json:
```json
{
    "body": "<a id='comment:1'></a>\nSee also #23324",
    "created_at": "2022-06-06T21:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33932#issuecomment-552776",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>
See also #23324



---

archive/issue_comments_552777.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe second example is fixed in #34387",
    "created_at": "2022-08-31T21:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33932#issuecomment-552777",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
The second example is fixed in #34387



---

archive/issue_comments_552778.json:
```json
{
    "body": "**Dependencies:** #34387",
    "created_at": "2022-08-31T21:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33932#issuecomment-552778",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #34387



---

archive/issue_events_307874.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T22:13:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307874"
}
```



---

archive/issue_events_307875.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T22:13:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "label": "duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307875"
}
```



---

archive/issue_comments_552779.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe first example is a dup of #23324.",
    "created_at": "2022-08-31T22:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33932#issuecomment-552779",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
The first example is a dup of #23324.



---

archive/issue_events_307876.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T22:13:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307876"
}
```



---

archive/issue_comments_552780.json:
```json
{
    "body": "**Changing dependencies** from \"#34387\" to \"#23324, #34387\".",
    "created_at": "2022-08-31T22:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33932#issuecomment-552780",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#34387" to "#23324, #34387".



---

archive/issue_comments_552781.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2022-08-31T23:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33932#issuecomment-552781",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_events_307877.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-31T23:17:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307877"
}
```



---

archive/issue_events_307878.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-31T23:17:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307878"
}
```



---

archive/issue_events_307879.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-01T02:30:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307879"
}
```



---

archive/issue_events_307880.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-01T02:30:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33932#event-307880"
}
```
