# Issue 33536: Some changes suggested by lgtm

archive/issues_033299.json:
```json
{
    "assignees": [],
    "body": "Namely, caution about arguments with default value `{}`.\n\nCC:  @tscrim @slel @kliem\n\nBranch/Commit: **[`0f8e0d8`](https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6)**\n\nReviewer: **Kwankyu Lee**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **refactoring**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33536_\n\n",
    "closed_at": "2022-04-02T10:53:15Z",
    "created_at": "2022-03-20T19:54:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/refactoring",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Some changes suggested by lgtm",
    "type": "issue",
    "updated_at": "2022-04-02T10:53:15Z",
    "url": "https://github.com/sagemath/sage/issues/33536",
    "user": "https://github.com/fchapoton"
}
```
Namely, caution about arguments with default value `{}`.

CC:  @tscrim @slel @kliem

Branch/Commit: **[`0f8e0d8`](https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6)**

Reviewer: **Kwankyu Lee**

Author: **Frédéric Chapoton**

Component: **refactoring**

_Issue created by migration from https://trac.sagemath.org/ticket/33536_





---

archive/issue_events_462763.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T19:54:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462763"
}
```



---

archive/issue_events_462764.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T19:54:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462764"
}
```



---

archive/issue_events_462765.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T19:54:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462765"
}
```



---

archive/issue_events_462766.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T19:54:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462766"
}
```



---

archive/issue_comments_541645.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04002f522daa3a3f92b623e76375fff3785d2294\"><code>04002f5</code></a></td><td><code>some changes suggested by lgtm</code></td></tr></table>\n",
    "created_at": "2022-03-20T19:54:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541645",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04002f522daa3a3f92b623e76375fff3785d2294"><code>04002f5</code></a></td><td><code>some changes suggested by lgtm</code></td></tr></table>




---

archive/issue_comments_541646.json:
```json
{
    "body": "Branch: **[u/chapoton/33536](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33536)**",
    "created_at": "2022-03-20T19:54:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541646",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/33536](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33536)**



---

archive/issue_comments_541647.json:
```json
{
    "body": "Commit: **[`04002f5`](https://github.com/sagemath/sagetrac-mirror/commit/04002f522daa3a3f92b623e76375fff3785d2294)**",
    "created_at": "2022-03-20T19:54:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541647",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`04002f5`](https://github.com/sagemath/sagetrac-mirror/commit/04002f522daa3a3f92b623e76375fff3785d2294)**



---

archive/issue_events_462767.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-03-20T19:54:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462767"
}
```



---

archive/issue_comments_541648.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nwe have a green bot, so please review (easy one, I think)",
    "created_at": "2022-03-21T07:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541648",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:2" align="right">comment:2</div>

we have a green bot, so please review (easy one, I think)



---

archive/issue_comments_541649.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI don't understand how this improves the situation\n\n```diff\n-        check = kwds.pop('check', True)\n-        if args or kwds:\n+        check = kwds.get('check', True)\n+        if args or any(key != 'check' for key in kwds):\n```\nWould you explain?",
    "created_at": "2022-03-21T07:56:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541649",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:3" align="right">comment:3</div>

I don't understand how this improves the situation

```diff
-        check = kwds.pop('check', True)
-        if args or kwds:
+        check = kwds.get('check', True)
+        if args or any(key != 'check' for key in kwds):
```
Would you explain?



---

archive/issue_comments_541650.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI didn't mean to delete cc's. Sorry.",
    "created_at": "2022-03-21T07:59:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541650",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:4" align="right">comment:4</div>

I didn't mean to delete cc's. Sorry.



---

archive/issue_comments_541651.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOne should not pop from the default value of `kwds`, because this modifies this default value.",
    "created_at": "2022-03-21T08:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541651",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

One should not pop from the default value of `kwds`, because this modifies this default value.



---

archive/issue_comments_541652.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@fchapoton](#comment:5):\n> One should not pop from the default value of `kwds`, because this modifies this default value.\n\nI see. But in this case, the default is an empty dict and there actually occurs no pop to the default. On the other hand, the condition check on the second line is more complicated than the original. So we lose a tiny bit while fixing nothing. No?",
    "created_at": "2022-03-21T08:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541652",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@fchapoton](#comment:5):
> One should not pop from the default value of `kwds`, because this modifies this default value.

I see. But in this case, the default is an empty dict and there actually occurs no pop to the default. On the other hand, the condition check on the second line is more complicated than the original. So we lose a tiny bit while fixing nothing. No?



---

archive/issue_comments_541653.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nindeed. But in my opinion, it is a safe idea to never ever modify the default argument.\n\nThe idea is to fix the warning issued by \"lgtm\":\n\nhttps://lgtm.com/projects/g/sagemath/sage/alerts/?mode=tree&severity=error&ruleFocus=4840097\n\nOne could argue that the case of \"empty dict\" and \"pop\" needs no correction, but it seems to me that one can fix this little issue, despite its trivial nature.",
    "created_at": "2022-03-21T08:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541653",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

indeed. But in my opinion, it is a safe idea to never ever modify the default argument.

The idea is to fix the warning issued by "lgtm":

https://lgtm.com/projects/g/sagemath/sage/alerts/?mode=tree&severity=error&ruleFocus=4840097

One could argue that the case of "empty dict" and "pop" needs no correction, but it seems to me that one can fix this little issue, despite its trivial nature.



---

archive/issue_comments_541654.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOkay. I guess the tiny bit lost is really tiny, and we get cleaner code instead.\n\nI would let others have time to review.",
    "created_at": "2022-03-21T08:44:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541654",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:9" align="right">comment:9</div>

Okay. I guess the tiny bit lost is really tiny, and we get cleaner code instead.

I would let others have time to review.



---

archive/issue_comments_541655.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nIn `src/sage/rings/fraction_field.py`, maybe change:\n\n```diff\n-    def _call_with_args(self, x, args=(), kwds={}):\n+    def _call_with_args(self, x, args=(), kwds=None):\n         r\"\"\"\n-        Evaluation this map at ``x``.\n+        Evaluate this map at ``x``.\n\n         INPUT:\n\n         - ``check`` -- whether or not to check\n\n         EXAMPLES::\n\n             sage: R.<x> = QQ[]\n             sage: K = R.fraction_field()\n             sage: R(K.gen(), check=True)\n             x\n-\n         \"\"\"\n+        if kwds is None:\n+            kwds = {}\n         check = kwds.get('check', True)\n         if args or any(key != 'check' for key in kwds):\n             raise NotImplementedError(\"__call__ cannot be called with additional arguments other than check=True/False\")\n         return self._call_(x, check=check)\n```",
    "created_at": "2022-03-21T21:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541655",
    "user": "https://github.com/slel"
}
```

<div id="comment:10" align="right">comment:10</div>

In `src/sage/rings/fraction_field.py`, maybe change:

```diff
-    def _call_with_args(self, x, args=(), kwds={}):
+    def _call_with_args(self, x, args=(), kwds=None):
         r"""
-        Evaluation this map at ``x``.
+        Evaluate this map at ``x``.

         INPUT:

         - ``check`` -- whether or not to check

         EXAMPLES::

             sage: R.<x> = QQ[]
             sage: K = R.fraction_field()
             sage: R(K.gen(), check=True)
             x
-
         """
+        if kwds is None:
+            kwds = {}
         check = kwds.get('check', True)
         if args or any(key != 'check' for key in kwds):
             raise NotImplementedError("__call__ cannot be called with additional arguments other than check=True/False")
         return self._call_(x, check=check)
```



---

archive/issue_comments_541656.json:
```json
{
    "body": "Changed commit from **[`04002f5`](https://github.com/sagemath/sagetrac-mirror/commit/04002f522daa3a3f92b623e76375fff3785d2294)** to **[`0f8e0d8`](https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6)**",
    "created_at": "2022-03-22T07:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541656",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`04002f5`](https://github.com/sagemath/sagetrac-mirror/commit/04002f522daa3a3f92b623e76375fff3785d2294)** to **[`0f8e0d8`](https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6)**



---

archive/issue_comments_541657.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6\"><code>0f8e0d8</code></a></td><td><code>some details in fraction_field</code></td></tr></table>\n",
    "created_at": "2022-03-22T07:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541657",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6"><code>0f8e0d8</code></a></td><td><code>some details in fraction_field</code></td></tr></table>




---

archive/issue_comments_541658.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nChanging to `kwds=None` here is not compatible with the C type declaration. And this C-type cannot be changed without changing many things in many files. So, not for here.",
    "created_at": "2022-03-22T07:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541658",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

Changing to `kwds=None` here is not compatible with the C type declaration. And this C-type cannot be changed without changing many things in many files. So, not for here.



---

archive/issue_comments_541659.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nreview please",
    "created_at": "2022-03-24T14:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541659",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

review please



---

archive/issue_comments_541660.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nLGTM.",
    "created_at": "2022-03-24T21:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541660",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:14" align="right">comment:14</div>

LGTM.



---

archive/issue_comments_541661.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-namely, caution about arguments with default value `{}`\n+Namely, caution about arguments with default value `{}`.\n``````\n",
    "created_at": "2022-03-24T21:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541661",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-namely, caution about arguments with default value `{}`
+Namely, caution about arguments with default value `{}`.
``````




---

archive/issue_events_462768.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-24T21:26:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462768"
}
```



---

archive/issue_events_462769.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-24T21:26:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462769"
}
```



---

archive/issue_comments_541662.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee**",
    "created_at": "2022-03-24T21:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541662",
    "user": "https://github.com/kwankyu"
}
```

Reviewer: **Kwankyu Lee**



---

archive/issue_events_462770.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-24T21:28:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "title_is": "Some changes suggested by lgtm",
    "title_was": "some changes suggested by lgtm",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462770"
}
```



---

archive/issue_events_462771.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-02T10:53:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462771"
}
```



---

archive/issue_events_462772.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a5446dbaa479876e25b5d2ff8303e268813c3bf3",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-04-02T10:53:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33536#event-462772"
}
```



---

archive/issue_comments_541663.json:
```json
{
    "body": "Changed branch from **[u/chapoton/33536](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33536)** to **[`0f8e0d8`](https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6)**",
    "created_at": "2022-04-02T10:53:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33536#issuecomment-541663",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/33536](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/33536)** to **[`0f8e0d8`](https://github.com/sagemath/sagetrac-mirror/commit/0f8e0d85cff73e5939fec8122653308da05417b6)**
