# Issue 33574: PARI/GP error on attempt to call .n() on GpElement

archive/issues_033337.json:
```json
{
    "body": "`gp.content([1,2,3]).n()` produces an error like\n\n\n```\nTypeError: Error executing code in GP:\nCODE:\n\tsage[11]=prec(sage[10]);\nPARI/GP ERROR:\n  ***   at top-level: sage[11]=prec(sage[10])\n  ***                          ^--------------\n  ***   not a function in function call\nA function with that name existed in GP-1.39.15. Please update your script.\n\nNew syntax: prec(x,n) ===> precision(x,n)\n\nprecision(x,{n}): if n is present, return x at precision n. If n is omitted, \nreturn real precision of object x.\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33574\n\n",
    "created_at": "2022-03-26T20:18:27Z",
    "labels": [
        "component: numerical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "PARI/GP error on attempt to call .n() on GpElement",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33574",
    "user": "https://github.com/maxale"
}
```
`gp.content([1,2,3]).n()` produces an error like


```
TypeError: Error executing code in GP:
CODE:
	sage[11]=prec(sage[10]);
PARI/GP ERROR:
  ***   at top-level: sage[11]=prec(sage[10])
  ***                          ^--------------
  ***   not a function in function call
A function with that name existed in GP-1.39.15. Please update your script.

New syntax: prec(x,n) ===> precision(x,n)

precision(x,{n}): if n is present, return x at precision n. If n is omitted, 
return real precision of object x.
```


Issue created by migration from https://trac.sagemath.org/ticket/33574





---

archive/issue_events_088355.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33574#event-88355"
}
```



---

archive/issue_comments_474065.json:
```json
{
    "body": "It seems the issue is fixed with the following simple change:\n\n```\n--- numerical_approx.pyx.OLD\t2022-06-08 15:46:38.799629463 -0400\n+++ numerical_approx.pyx\t2022-06-08 15:46:50.847671116 -0400\n@@ -52,7 +52,7 @@\n \n     # Figure out input precision to check for case (1)\n     try:\n-        inprec = x.prec()\n+        inprec = x.precision()\n     except AttributeError:\n         if prec > 53 and CDF.has_coerce_map_from(P):\n             # If we can coerce to CDF, assume input precision was 53 bits\n```\n\nI'd like to propose it as a fix for this ticket, but I'm not sure how.",
    "created_at": "2022-06-08T19:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474065",
    "user": "https://github.com/maxale"
}
```

It seems the issue is fixed with the following simple change:

```
--- numerical_approx.pyx.OLD	2022-06-08 15:46:38.799629463 -0400
+++ numerical_approx.pyx	2022-06-08 15:46:50.847671116 -0400
@@ -52,7 +52,7 @@
 
     # Figure out input precision to check for case (1)
     try:
-        inprec = x.prec()
+        inprec = x.precision()
     except AttributeError:
         if prec > 53 and CDF.has_coerce_map_from(P):
             # If we can coerce to CDF, assume input precision was 53 bits
```

I'd like to propose it as a fix for this ticket, but I'm not sure how.



---

archive/issue_comments_474066.json:
```json
{
    "body": "do you know git ?\n\nif yes, you just need to push a branch here (after cloning and setting the trac remote)\n\n```\ngit push trac HEAD:u/gh-maxale/branchname_at_choice\n```\nand then copy this branch name in the ticket field \"Branch:\"\n\nofficial instructions are there: https://doc.sagemath.org/html/en/developer/manual_git.html",
    "created_at": "2022-06-11T09:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474066",
    "user": "https://github.com/fchapoton"
}
```

do you know git ?

if yes, you just need to push a branch here (after cloning and setting the trac remote)

```
git push trac HEAD:u/gh-maxale/branchname_at_choice
```
and then copy this branch name in the ticket field "Branch:"

official instructions are there: https://doc.sagemath.org/html/en/developer/manual_git.html



---

archive/issue_comments_474067.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-16T01:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474067",
    "user": "https://github.com/maxale"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_474068.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-06-16T01:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474068",
    "user": "https://github.com/maxale"
}
```

New commits:



---

archive/issue_comments_474069.json:
```json
{
    "body": "good. Please add a doctest showing that something previously broken now does work.",
    "created_at": "2022-06-16T18:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474069",
    "user": "https://github.com/fchapoton"
}
```

good. Please add a doctest showing that something previously broken now does work.



---

archive/issue_comments_474070.json:
```json
{
    "body": "I've never done that before. Are there instructions on how to create a doctest?",
    "created_at": "2022-06-17T15:03:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474070",
    "user": "https://github.com/maxale"
}
```

I've never done that before. Are there instructions on how to create a doctest?



---

archive/issue_comments_474071.json:
```json
{
    "body": "The tests are part of the documentation.\n\nThis means you just have to add a few lines in the EXAMPLES or TESTS section of the function that you are changing.\n\nin the present case, I suggest to add a `TESTS::` section below the existing EXAMPLES section : fill with example written in the ticket description.\n\nUse the existing documention as a model, with care about the correct indentation.\n\nsome instructions here:\nhttps://doc.sagemath.org/html/en/developer/coding_basics.html#writing-testable-examples",
    "created_at": "2022-06-17T15:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474071",
    "user": "https://github.com/fchapoton"
}
```

The tests are part of the documentation.

This means you just have to add a few lines in the EXAMPLES or TESTS section of the function that you are changing.

in the present case, I suggest to add a `TESTS::` section below the existing EXAMPLES section : fill with example written in the ticket description.

Use the existing documention as a model, with care about the correct indentation.

some instructions here:
https://doc.sagemath.org/html/en/developer/coding_basics.html#writing-testable-examples



---

archive/issue_events_088356.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33574#event-88356"
}
```



---

archive/issue_events_088357.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33574#event-88357"
}
```



---

archive/issue_comments_474072.json:
```json
{
    "body": "still needs that you add a doctest",
    "created_at": "2022-10-16T12:10:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474072",
    "user": "https://github.com/fchapoton"
}
```

still needs that you add a doctest



---

archive/issue_comments_474073.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-10-16T12:10:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33574#issuecomment-474073",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.
