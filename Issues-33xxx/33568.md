# Issue 33568: Add method `is_integral_domain` for polynomial quotient rings

archive/issues_033331.json:
```json
{
    "assignees": [],
    "body": "We add a method `is_integral_domain`\nto the `PolynomialQuotientRing` class.\n\nCC:  @slel\n\nBranch/Commit: **[3173fbe](https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Johannes Schmitt**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33568_\n\n",
    "closed_at": "2022-04-02T10:52:57Z",
    "created_at": "2022-03-26T14:46:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add method `is_integral_domain` for polynomial quotient rings",
    "type": "issue",
    "updated_at": "2022-04-02T10:52:57Z",
    "url": "https://github.com/sagemath/sage/issues/33568",
    "user": "https://github.com/schmittj"
}
```
We add a method `is_integral_domain`
to the `PolynomialQuotientRing` class.

CC:  @slel

Branch/Commit: **[3173fbe](https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b)**

Reviewer: **Vincent Delecroix**

Author: **Johannes Schmitt**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/33568_





---

archive/issue_events_460958.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-26T14:46:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460958"
}
```



---

archive/issue_events_460959.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-26T14:46:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460959"
}
```



---

archive/issue_comments_542360.json:
```json
{
    "body": "Branch: **[u/gh-schmittj/is_integral_domain_for_quotients](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-schmittj/is_integral_domain_for_quotients)**",
    "created_at": "2022-03-26T14:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542360",
    "user": "https://github.com/schmittj"
}
```

Branch: **[u/gh-schmittj/is_integral_domain_for_quotients](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-schmittj/is_integral_domain_for_quotients)**



---

archive/issue_events_460960.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-26T14:55:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460960"
}
```



---

archive/issue_events_460961.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-26T14:55:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460961"
}
```



---

archive/issue_comments_542361.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3dc50ed1ae80ab446cdb6d4d4d965781b8f1c874\">3dc50ed</a></td><td><code>Added method is_integral_domain to PolynomialQuotientRing</code></td></tr></table>\n",
    "created_at": "2022-03-26T14:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542361",
    "user": "https://github.com/schmittj"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3dc50ed1ae80ab446cdb6d4d4d965781b8f1c874">3dc50ed</a></td><td><code>Added method is_integral_domain to PolynomialQuotientRing</code></td></tr></table>




---

archive/issue_events_460962.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-26T14:55:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460962"
}
```



---

archive/issue_events_460963.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-26T14:55:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460963"
}
```



---

archive/issue_comments_542362.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Added method is_integral_domain to PolynomialQuotientRing\n``````\n",
    "created_at": "2022-03-26T14:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542362",
    "user": "https://github.com/schmittj"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Added method is_integral_domain to PolynomialQuotientRing
``````




---

archive/issue_comments_542363.json:
```json
{
    "body": "Commit: **[3dc50ed](https://github.com/sagemath/sagetrac-mirror/commit/3dc50ed1ae80ab446cdb6d4d4d965781b8f1c874)**",
    "created_at": "2022-03-26T14:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542363",
    "user": "https://github.com/schmittj"
}
```

Commit: **[3dc50ed](https://github.com/sagemath/sagetrac-mirror/commit/3dc50ed1ae80ab446cdb6d4d4d965781b8f1c874)**



---

archive/issue_comments_542364.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e9c2728efb25a16cfb62bf88d42a27efaff04c5\">8e9c272</a></td><td><code>Fixed some first doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/579951a75118252d45fd8b2e8e8f6c8058f4198d\">579951a</a></td><td><code>Added test checking whether ring is already known to be integral domain</code></td></tr></table>\n",
    "created_at": "2022-03-26T19:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542364",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e9c2728efb25a16cfb62bf88d42a27efaff04c5">8e9c272</a></td><td><code>Fixed some first doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/579951a75118252d45fd8b2e8e8f6c8058f4198d">579951a</a></td><td><code>Added test checking whether ring is already known to be integral domain</code></td></tr></table>




---

archive/issue_comments_542365.json:
```json
{
    "body": "Changed commit from **[3dc50ed](https://github.com/sagemath/sagetrac-mirror/commit/3dc50ed1ae80ab446cdb6d4d4d965781b8f1c874)** to **[579951a](https://github.com/sagemath/sagetrac-mirror/commit/579951a75118252d45fd8b2e8e8f6c8058f4198d)**",
    "created_at": "2022-03-26T19:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542365",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3dc50ed](https://github.com/sagemath/sagetrac-mirror/commit/3dc50ed1ae80ab446cdb6d4d4d965781b8f1c874)** to **[579951a](https://github.com/sagemath/sagetrac-mirror/commit/579951a75118252d45fd8b2e8e8f6c8058f4198d)**



---

archive/issue_events_460964.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-03-26T21:45:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460964"
}
```



---

archive/issue_events_460965.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-03-26T21:45:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460965"
}
```



---

archive/issue_events_460966.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-03-26T21:45:12Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "title_is": "Add method `is_integral_domain` for polynomial quotient rings",
    "title_was": "is_integral_domain_for_quotients",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460966"
}
```



---

archive/issue_comments_542366.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nRemember to add your name in the \"authors\" field\nand to set to \"needs review\" when ready.",
    "created_at": "2022-03-26T21:45:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542366",
    "user": "https://github.com/slel"
}
```

<div id="comment:4" align="right">comment:4</div>

Remember to add your name in the "authors" field
and to set to "needs review" when ready.



---

archive/issue_comments_542367.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n-Added method is_integral_domain to PolynomialQuotientRing\n+We add a method `is_integral_domain`\n+to the `PolynomialQuotientRing` class.\n``````\n",
    "created_at": "2022-03-26T21:45:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542367",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
-Added method is_integral_domain to PolynomialQuotientRing
+We add a method `is_integral_domain`
+to the `PolynomialQuotientRing` class.
``````




---

archive/issue_comments_542368.json:
```json
{
    "body": "Changed commit from **[579951a](https://github.com/sagemath/sagetrac-mirror/commit/579951a75118252d45fd8b2e8e8f6c8058f4198d)** to **[5a617af](https://github.com/sagemath/sagetrac-mirror/commit/5a617af22813832a77b2715d3a34ab92fe30cf86)**",
    "created_at": "2022-03-27T12:55:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542368",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[579951a](https://github.com/sagemath/sagetrac-mirror/commit/579951a75118252d45fd8b2e8e8f6c8058f4198d)** to **[5a617af](https://github.com/sagemath/sagetrac-mirror/commit/5a617af22813832a77b2715d3a34ab92fe30cf86)**



---

archive/issue_comments_542369.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a617af22813832a77b2715d3a34ab92fe30cf86\">5a617af</a></td><td><code>Added some more doctests</code></td></tr></table>\n",
    "created_at": "2022-03-27T12:55:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542369",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a617af22813832a77b2715d3a34ab92fe30cf86">5a617af</a></td><td><code>Added some more doctests</code></td></tr></table>




---

archive/issue_comments_542370.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nWith respect to the documentation. Anything after a `::` must be indented. The correct syntax for a `TESTS` or `EXAMPLES` block starting with a sentence is\n\n```\n        TESTS:\n\n        Here is an example of a quotient ring which is not an integral\n        domain, even though the base ring is integral and the modulus is\n        irreducible::\n\n            sage: B = ZZ.extension(x^2 - 5, 'a')\n```\n\nInstead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.\n\nThe test `if self.base_ring() in GcdDomains` would better be `if self.base_ring() in GcdDomains()`. I am surprised that it works the way you wrote it (as `GcdDomains` is a class).\n\nWhen `proof=False` I am not sure that the shortcut `NotImplementedError => False` is desirable\n\n```\n            except NotImplementedError:\n                if proof:\n                    raise\n                else:\n                    ret = False\n```\nYou indeed catch the `raise NotImplementedError` that could be raised few lines above but also any `NotImplementedError` that would come from `irr = self.modulus().is_irreducible()`.",
    "created_at": "2022-03-27T16:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542370",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

With respect to the documentation. Anything after a `::` must be indented. The correct syntax for a `TESTS` or `EXAMPLES` block starting with a sentence is

```
        TESTS:

        Here is an example of a quotient ring which is not an integral
        domain, even though the base ring is integral and the modulus is
        irreducible::

            sage: B = ZZ.extension(x^2 - 5, 'a')
```

Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.

The test `if self.base_ring() in GcdDomains` would better be `if self.base_ring() in GcdDomains()`. I am surprised that it works the way you wrote it (as `GcdDomains` is a class).

When `proof=False` I am not sure that the shortcut `NotImplementedError => False` is desirable

```
            except NotImplementedError:
                if proof:
                    raise
                else:
                    ret = False
```
You indeed catch the `raise NotImplementedError` that could be raised few lines above but also any `NotImplementedError` that would come from `irr = self.modulus().is_irreducible()`.



---

archive/issue_comments_542371.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThanks for taking a close look!\n> With respect to the documentation. Anything after a `::` must be indented. \n\nI'll change this.\n\n> Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.\n\nOk, I can do that, though one small comment: I believe in most cases this will mean that `is_integral_domain` will go into an infinite loop alternating with `IntegralDomains().__contains__` until an exception is raised and the `__contains__` method returns `False`. But maybe this is ok? \n\nI only added this check since otherwise doctests about splitting algebras broke. There the problem was: one of these algebras was initialized knowing it is an integral domain, but then later it was also initialized as a quotient ring, and its previous `is_integral_domain` method (which just returned `True`) was overwritten with my method which couldn't find a proof and raised an exception. (See the doctest failures in 3dc50ed for reference)\n\n> The test `if self.base_ring() in GcdDomains` would better be `if self.base_ring() in GcdDomains()`. I am surprised that it works the way you wrote it (as `GcdDomains` is a class).\n\nYes, in retrospect I am also surprised - I'll change this.\n\n> When `proof=False` I am not sure that the shortcut `NotImplementedError => False` is desirable\n> \n> ```\n>             except NotImplementedError:\n>                 if proof:\n>                     raise\n>                 else:\n>                     ret = False\n> ```\n> You indeed catch the `raise NotImplementedError` that could be raised few lines above but also any `NotImplementedError` that would come from `irr = self.modulus().is_irreducible()`.\n\nIt's true that there are two sources where the `NotImplementedError` could come from, but I think in both cases there is nothing we can do mathematically - to confirm that we are an integral domain, the only path leading to `True` right now is that we can verify that `self.modulus()` is irreducible AND that the base ring is a GCD. If you know another sufficient condition, I am happy to include it.\n\nIn fact the previous method `PolynomialQuotientRing.is_field`, which I tried to emulate, specifically uses such a `try: ... except NotImplementedError` to catch a missing implementation of `is_irreducible`.",
    "created_at": "2022-03-28T15:28:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542371",
    "user": "https://github.com/schmittj"
}
```

<div id="comment:7" align="right">comment:7</div>

Thanks for taking a close look!
> With respect to the documentation. Anything after a `::` must be indented. 

I'll change this.

> Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.

Ok, I can do that, though one small comment: I believe in most cases this will mean that `is_integral_domain` will go into an infinite loop alternating with `IntegralDomains().__contains__` until an exception is raised and the `__contains__` method returns `False`. But maybe this is ok? 

I only added this check since otherwise doctests about splitting algebras broke. There the problem was: one of these algebras was initialized knowing it is an integral domain, but then later it was also initialized as a quotient ring, and its previous `is_integral_domain` method (which just returned `True`) was overwritten with my method which couldn't find a proof and raised an exception. (See the doctest failures in 3dc50ed for reference)

> The test `if self.base_ring() in GcdDomains` would better be `if self.base_ring() in GcdDomains()`. I am surprised that it works the way you wrote it (as `GcdDomains` is a class).

Yes, in retrospect I am also surprised - I'll change this.

> When `proof=False` I am not sure that the shortcut `NotImplementedError => False` is desirable
> 
> ```
>             except NotImplementedError:
>                 if proof:
>                     raise
>                 else:
>                     ret = False
> ```
> You indeed catch the `raise NotImplementedError` that could be raised few lines above but also any `NotImplementedError` that would come from `irr = self.modulus().is_irreducible()`.

It's true that there are two sources where the `NotImplementedError` could come from, but I think in both cases there is nothing we can do mathematically - to confirm that we are an integral domain, the only path leading to `True` right now is that we can verify that `self.modulus()` is irreducible AND that the base ring is a GCD. If you know another sufficient condition, I am happy to include it.

In fact the previous method `PolynomialQuotientRing.is_field`, which I tried to emulate, specifically uses such a `try: ... except NotImplementedError` to catch a missing implementation of `is_irreducible`.



---

archive/issue_comments_542372.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@schmittj](#comment:7):\n> Thanks for taking a close look!\n> > With respect to the documentation. Anything after a `::` must be indented. \n\n> I'll change this.\n> \n> > Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.\n\n> \n> Ok, I can do that, though one small comment: I believe in most cases this will mean that `is_integral_domain` will go into an infinite loop alternating with `IntegralDomains().__contains__` until an exception is raised and the `__contains__` method returns `False`. But maybe this is ok? \n\nThe method `self in IntegralDomains()` ought to be a faster equivalent of `IntegralDomains() in self.categories()`... which is not the case. Could you simply add a comment in the code? There is a note at the end of the documentation of `IntegralDomains.__contains__` mentionning that this method should disappear (in favour of the generic one being equivalent to `IntegralDomains() in self.categories()`).\n\n> > When `proof=False` I am not sure that the shortcut `NotImplementedError => False` is desirable\n> > \n> > ```\n> >             except NotImplementedError:\n> >                 if proof:\n> >                     raise\n> >                 else:\n> >                     ret = False\n> > ```\n> > You indeed catch the `raise NotImplementedError` that could be raised few lines above but also any `NotImplementedError` that would come from `irr = self.modulus().is_irreducible()`.\n\n> \n> It's true that there are two sources where the `NotImplementedError` could come from, but I think in both cases there is nothing we can do mathematically - to confirm that we are an integral domain, the only path leading to `True` right now is that we can verify that `self.modulus()` is irreducible AND that the base ring is a GCD. If you know another sufficient condition, I am happy to include it.\n> \n> In fact the previous method `PolynomialQuotientRing.is_field`, which I tried to emulate, specifically uses such a `try: ... except NotImplementedError` to catch a missing implementation of `is_irreducible`.\n\nI think my misunderstanding comes from the weird semantic of the keyword `proof=True`/`proof=False`. I thought that `proof=False` meant \"the answer assumes some standard conjecture such as the generalized Riemann hypothesis\" (as in https://doc.sagemath.org/html/en/reference/structure/sage/structure/proof/proof.html). What your `proof=False` means is rather \"do not raise NotImplementedError but return False instead\".",
    "created_at": "2022-03-28T15:56:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542372",
    "user": "https://github.com/videlec"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@schmittj](#comment:7):
> Thanks for taking a close look!
> > With respect to the documentation. Anything after a `::` must be indented. 

> I'll change this.
> 
> > Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.

> 
> Ok, I can do that, though one small comment: I believe in most cases this will mean that `is_integral_domain` will go into an infinite loop alternating with `IntegralDomains().__contains__` until an exception is raised and the `__contains__` method returns `False`. But maybe this is ok? 

The method `self in IntegralDomains()` ought to be a faster equivalent of `IntegralDomains() in self.categories()`... which is not the case. Could you simply add a comment in the code? There is a note at the end of the documentation of `IntegralDomains.__contains__` mentionning that this method should disappear (in favour of the generic one being equivalent to `IntegralDomains() in self.categories()`).

> > When `proof=False` I am not sure that the shortcut `NotImplementedError => False` is desirable
> > 
> > ```
> >             except NotImplementedError:
> >                 if proof:
> >                     raise
> >                 else:
> >                     ret = False
> > ```
> > You indeed catch the `raise NotImplementedError` that could be raised few lines above but also any `NotImplementedError` that would come from `irr = self.modulus().is_irreducible()`.

> 
> It's true that there are two sources where the `NotImplementedError` could come from, but I think in both cases there is nothing we can do mathematically - to confirm that we are an integral domain, the only path leading to `True` right now is that we can verify that `self.modulus()` is irreducible AND that the base ring is a GCD. If you know another sufficient condition, I am happy to include it.
> 
> In fact the previous method `PolynomialQuotientRing.is_field`, which I tried to emulate, specifically uses such a `try: ... except NotImplementedError` to catch a missing implementation of `is_irreducible`.

I think my misunderstanding comes from the weird semantic of the keyword `proof=True`/`proof=False`. I thought that `proof=False` meant "the answer assumes some standard conjecture such as the generalized Riemann hypothesis" (as in https://doc.sagemath.org/html/en/reference/structure/sage/structure/proof/proof.html). What your `proof=False` means is rather "do not raise NotImplementedError but return False instead".



---

archive/issue_comments_542373.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@videlec](#comment:8):\n> Replying to [@schmittj](#comment:7):\n> > Thanks for taking a close look!\n> > > With respect to the documentation. Anything after a `::` must be indented. \n\n> > I'll change this.\n> > \n> > > Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.\n\n> > \n> > Ok, I can do that, though one small comment: I believe in most cases this will mean that `is_integral_domain` will go into an infinite loop alternating with `IntegralDomains().__contains__` until an exception is raised and the `__contains__` method returns `False`. But maybe this is ok? \n\n> \n> The method `self in IntegralDomains()` ought to be a faster equivalent of `IntegralDomains() in self.categories()`... which is not the case. Could you simply add a comment in the code? There is a note at the end of the documentation of `IntegralDomains.__contains__` mentionning that this method should disappear (in favour of the generic one being equivalent to `IntegralDomains() in self.categories()`).\n\nYou might want to use what the generic `__contains__` does\n\n```\nself.category().is_subcategory(IntegralDomains())\n```\n(see `sage/categories/category.py`).",
    "created_at": "2022-03-28T16:00:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542373",
    "user": "https://github.com/videlec"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@videlec](#comment:8):
> Replying to [@schmittj](#comment:7):
> > Thanks for taking a close look!
> > > With respect to the documentation. Anything after a `::` must be indented. 

> > I'll change this.
> > 
> > > Instead of `if IntegralDomains() in self.categories()` you might want to do `if self in IntegralDomains()`.

> > 
> > Ok, I can do that, though one small comment: I believe in most cases this will mean that `is_integral_domain` will go into an infinite loop alternating with `IntegralDomains().__contains__` until an exception is raised and the `__contains__` method returns `False`. But maybe this is ok? 

> 
> The method `self in IntegralDomains()` ought to be a faster equivalent of `IntegralDomains() in self.categories()`... which is not the case. Could you simply add a comment in the code? There is a note at the end of the documentation of `IntegralDomains.__contains__` mentionning that this method should disappear (in favour of the generic one being equivalent to `IntegralDomains() in self.categories()`).

You might want to use what the generic `__contains__` does

```
self.category().is_subcategory(IntegralDomains())
```
(see `sage/categories/category.py`).



---

archive/issue_comments_542374.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b\">3173fbe</a></td><td><code>Made suggested changes to documentation and details in code</code></td></tr></table>\n",
    "created_at": "2022-03-28T16:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542374",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b">3173fbe</a></td><td><code>Made suggested changes to documentation and details in code</code></td></tr></table>




---

archive/issue_comments_542375.json:
```json
{
    "body": "Changed commit from **[5a617af](https://github.com/sagemath/sagetrac-mirror/commit/5a617af22813832a77b2715d3a34ab92fe30cf86)** to **[3173fbe](https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b)**",
    "created_at": "2022-03-28T16:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542375",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5a617af](https://github.com/sagemath/sagetrac-mirror/commit/5a617af22813832a77b2715d3a34ab92fe30cf86)** to **[3173fbe](https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b)**



---

archive/issue_comments_542376.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI really like the proposal with `self.category().is_subcategory(IntegralDomains())`. I made all corresponding changes",
    "created_at": "2022-03-28T16:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542376",
    "user": "https://github.com/schmittj"
}
```

<div id="comment:11" align="right">comment:11</div>

I really like the proposal with `self.category().is_subcategory(IntegralDomains())`. I made all corresponding changes



---

archive/issue_comments_542377.json:
```json
{
    "body": "Author: **Johannes Schmitt**",
    "created_at": "2022-03-28T16:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542377",
    "user": "https://github.com/schmittj"
}
```

Author: **Johannes Schmitt**



---

archive/issue_events_460967.json:
```json
{
    "actor": "https://github.com/schmittj",
    "created_at": "2022-03-28T16:16:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460967"
}
```



---

archive/issue_comments_542378.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAre you sure about the semantic of `proof=False` that I mentioned in my [comment:8](#comment:8)? For `Zmod(n)` this does turns on/off random primality tests (which is very different from `NotImplementedError` becomes `False`). See the file in [sage/rings/finite_rings/integer_mod_ring.py](https://github.com/sagemath/sage/blob/develop/src/sage/rings/finite_rings/integer_mod_ring.py). To my mind, the method should always raise `NotImplementedError` when it is not able to decide.",
    "created_at": "2022-03-28T17:13:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542378",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

Are you sure about the semantic of `proof=False` that I mentioned in my [comment:8](#comment:8)? For `Zmod(n)` this does turns on/off random primality tests (which is very different from `NotImplementedError` becomes `False`). See the file in [sage/rings/finite_rings/integer_mod_ring.py](https://github.com/sagemath/sage/blob/develop/src/sage/rings/finite_rings/integer_mod_ring.py). To my mind, the method should always raise `NotImplementedError` when it is not able to decide.



---

archive/issue_comments_542379.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2022-03-28T17:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542379",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_542380.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIn the documentation of `Ring.is_integral_domain` it says\n\n```\n   Return \"True\" if this ring is an integral domain.\n\n   INPUT:\n\n   * \"proof\" -- (default: \"True\") Determines what to do in unknown\n     cases\n\n   ALGORITHM:\n\n   If the parameter \"proof\" is set to \"True\", the returned value is\n   correct but the method might throw an error.  Otherwise, if it is\n   set to \"False\", the method returns \"True\" if it can establish that\n   self is an integral domain and \"False\" otherwise.\n```\nMy impression is: if the primality tests have a nonzero chance of returning a false positive, then the implementation in `Zmod(n)` is not strictly speaking conforming to this specification in `Ring.is_integral_domain`.",
    "created_at": "2022-03-29T06:28:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542380",
    "user": "https://github.com/schmittj"
}
```

<div id="comment:14" align="right">comment:14</div>

In the documentation of `Ring.is_integral_domain` it says

```
   Return "True" if this ring is an integral domain.

   INPUT:

   * "proof" -- (default: "True") Determines what to do in unknown
     cases

   ALGORITHM:

   If the parameter "proof" is set to "True", the returned value is
   correct but the method might throw an error.  Otherwise, if it is
   set to "False", the method returns "True" if it can establish that
   self is an integral domain and "False" otherwise.
```
My impression is: if the primality tests have a nonzero chance of returning a false positive, then the implementation in `Zmod(n)` is not strictly speaking conforming to this specification in `Ring.is_integral_domain`.



---

archive/issue_events_460968.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-29T07:32:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460968"
}
```



---

archive/issue_events_460969.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2022-03-29T07:32:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460969"
}
```



---

archive/issue_comments_542381.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks for the reference. I don't like very much this specification but changing it is definitely not the goal of this ticket.",
    "created_at": "2022-03-29T07:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542381",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks for the reference. I don't like very much this specification but changing it is definitely not the goal of this ticket.



---

archive/issue_comments_542382.json:
```json
{
    "body": "Changed branch from **[u/gh-schmittj/is_integral_domain_for_quotients](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-schmittj/is_integral_domain_for_quotients)** to **[3173fbe](https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b)**",
    "created_at": "2022-04-02T10:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33568#issuecomment-542382",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-schmittj/is_integral_domain_for_quotients](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-schmittj/is_integral_domain_for_quotients)** to **[3173fbe](https://github.com/sagemath/sagetrac-mirror/commit/3173fbe57cdce8ff5c427ec8bbaf042083efeb2b)**



---

archive/issue_events_460970.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-02T10:52:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460970"
}
```



---

archive/issue_events_460971.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3dd4e6b4702021860184fe8e775c5faa370d9bb4",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-04-02T10:52:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33568",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33568#event-460971"
}
```
