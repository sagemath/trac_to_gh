# Issue 33608: Building documentation is broken in Sage 9.6.beta6

archive/issues_033371.json:
```json
{
    "assignees": [],
    "body": "Building the documentation is currently broken and fails with the following error messages:\n\n$ make doc-clean; make doc-uninstall; make\n\n```\n...\n[sagemath_doc_html-none] [semirings] building [html]: targets for 3 source files that are out of date\n[sagemath_doc_html-none] [semirings] dumping search index in English (code: en)... done\n[sagemath_doc_html-none] [semirings] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings.\n[sagemath_doc_html-none] [semirings] Extension error (matplotlib.sphinxext.plot_directive):\n[sagemath_doc_html-none] [semirings] Handler <function _copy_css_file at 0x7f0673973e50> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings/_static')\n[sagemath_doc_html-none] Build finished. The built documents can be found in /home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings\n...\n```\n\n\nCC:  @kwankyu @strogdon @haraldschilly @mkoeppe\n\nBranch: **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)**\n\nReviewer: **Tobias Diez**\n\nAuthor: **Kwankyu Lee**\n\nComponent: **documentation**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33608_\n\n",
    "closed_at": "2022-04-03T11:14:00Z",
    "created_at": "2022-03-30T20:12:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20documentation",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Building documentation is broken in Sage 9.6.beta6",
    "type": "issue",
    "updated_at": "2022-09-05T16:19:27Z",
    "url": "https://github.com/sagemath/sage/issues/33608",
    "user": "https://github.com/tobiasdiez"
}
```
Building the documentation is currently broken and fails with the following error messages:

$ make doc-clean; make doc-uninstall; make

```
...
[sagemath_doc_html-none] [semirings] building [html]: targets for 3 source files that are out of date
[sagemath_doc_html-none] [semirings] dumping search index in English (code: en)... done
[sagemath_doc_html-none] [semirings] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings.
[sagemath_doc_html-none] [semirings] Extension error (matplotlib.sphinxext.plot_directive):
[sagemath_doc_html-none] [semirings] Handler <function _copy_css_file at 0x7f0673973e50> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings/_static')
[sagemath_doc_html-none] Build finished. The built documents can be found in /home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings
...
```


CC:  @kwankyu @strogdon @haraldschilly @mkoeppe

Branch: **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)**

Reviewer: **Tobias Diez**

Author: **Kwankyu Lee**

Component: **documentation**

_Issue created by migration from https://trac.sagemath.org/ticket/33608_





---

archive/issue_events_461468.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-30T20:12:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461468"
}
```



---

archive/issue_events_461469.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-30T20:12:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461469"
}
```



---

archive/issue_events_461470.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-30T20:12:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461470"
}
```



---

archive/issue_events_461471.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-30T20:12:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461471"
}
```



---

archive/issue_comments_543167.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis is not specific to gitpod. I am experiencing it too. It seem to have been introduced in beta6. \n\nI guess that the following happens. plot_directive extension writes its own css files into _static directory for each sphinx project. In our case, _static is a symlink to ../static directory, which is shared with all projects. Hence when plot_directive attempts to write again, _static (or ../static) directory already has the files, which triggers \"File exists\" error.\n\nWhat I don't understand why this mechanism was no problem before, but now it is...",
    "created_at": "2022-03-31T00:10:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543167",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:1" align="right">comment:1</div>

This is not specific to gitpod. I am experiencing it too. It seem to have been introduced in beta6. 

I guess that the following happens. plot_directive extension writes its own css files into _static directory for each sphinx project. In our case, _static is a symlink to ../static directory, which is shared with all projects. Hence when plot_directive attempts to write again, _static (or ../static) directory already has the files, which triggers "File exists" error.

What I don't understand why this mechanism was no problem before, but now it is...



---

archive/issue_comments_543168.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAre\n\n```\n$ ./sage --docbuild tutorial html\n```\nand\n\n```\n$ ./sage --docbuild reference html\n```\nsupposed to fail after a normal `sagelib-9.6.beta6` build without doing anything else? If so, I don't see this here. Everything works.",
    "created_at": "2022-03-31T00:57:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543168",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:2" align="right">comment:2</div>

Are

```
$ ./sage --docbuild tutorial html
```
and

```
$ ./sage --docbuild reference html
```
supposed to fail after a normal `sagelib-9.6.beta6` build without doing anything else? If so, I don't see this here. Everything works.



---

archive/issue_comments_543169.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI must add that I have the `html` docs installed. Does one have to do a `make doc-clean doc-uninstall` first?",
    "created_at": "2022-03-31T01:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543169",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:3" align="right">comment:3</div>

I must add that I have the `html` docs installed. Does one have to do a `make doc-clean doc-uninstall` first?



---

archive/issue_comments_543170.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@strogdon](#comment:3):\n> I must add that I have the `html` docs installed. Does one have to do a `make doc-clean doc-uninstall` first?\n\nYes. This is also strange...",
    "created_at": "2022-03-31T02:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543170",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@strogdon](#comment:3):
> I must add that I have the `html` docs installed. Does one have to do a `make doc-clean doc-uninstall` first?

Yes. This is also strange...



---

archive/issue_comments_543171.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIn beta6, python3 was upgraded:\n\n```\n26574b0f82 Trac #33512: Update python3 to 3.10.3\n```\nIf you build sage with python 3.10.3, there are no more those errors. So this might be some incompatibility in python system library and packages...",
    "created_at": "2022-03-31T05:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543171",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:5" align="right">comment:5</div>

In beta6, python3 was upgraded:

```
26574b0f82 Trac #33512: Update python3 to 3.10.3
```
If you build sage with python 3.10.3, there are no more those errors. So this might be some incompatibility in python system library and packages...



---

archive/issue_comments_543172.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@kwankyu](#comment:5):\n> In beta6, python3 was upgraded:\n> \n> ```\n> 26574b0f82 Trac #33512: Update python3 to 3.10.3\n> ```\n> If you build sage with python 3.10.3, there are no more those errors. So this might be some incompatibility in python system library and packages... \n\nThis may be wrong. In another build, I see those errors back even with python 3.10.3. I am utterly confused.",
    "created_at": "2022-03-31T07:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543172",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@kwankyu](#comment:5):
> In beta6, python3 was upgraded:
> 
> ```
> 26574b0f82 Trac #33512: Update python3 to 3.10.3
> ```
> If you build sage with python 3.10.3, there are no more those errors. So this might be some incompatibility in python system library and packages... 

This may be wrong. In another build, I see those errors back even with python 3.10.3. I am utterly confused.



---

archive/issue_comments_543173.json:
```json
{
    "body": "Author: **Kwankyu Lee**",
    "created_at": "2022-03-31T14:06:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543173",
    "user": "https://github.com/kwankyu"
}
```

Author: **Kwankyu Lee**



---

archive/issue_events_461472.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-31T14:06:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "title_is": "Building documentation is broken",
    "title_was": "(gitpod): Building documentation is broken",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461472"
}
```



---

archive/issue_comments_543174.json:
```json
{
    "body": "Branch: **[u/klee/33608](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/33608)**",
    "created_at": "2022-03-31T14:06:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543174",
    "user": "https://github.com/kwankyu"
}
```

Branch: **[u/klee/33608](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/33608)**



---

archive/issue_events_461473.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-31T14:07:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "title_is": "Building documentation is broken in Sage 9.6.beta6",
    "title_was": "Building documentation is broken",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461473"
}
```



---

archive/issue_comments_543175.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSymlinks pointing to a non-existing directory broke documentation building. These symlinks were no problem before. But some obscure changes in Sage 9.6.beta6 (possibly merge of python 3.10.3) now makes them problematic.",
    "created_at": "2022-03-31T14:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543175",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:9" align="right">comment:9</div>

Symlinks pointing to a non-existing directory broke documentation building. These symlinks were no problem before. But some obscure changes in Sage 9.6.beta6 (possibly merge of python 3.10.3) now makes them problematic.



---

archive/issue_comments_543176.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8\">0618873</a></td><td><code>Ensure symlink points to an existing directory</code></td></tr></table>\n",
    "created_at": "2022-03-31T14:16:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543176",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8">0618873</a></td><td><code>Ensure symlink points to an existing directory</code></td></tr></table>




---

archive/issue_comments_543177.json:
```json
{
    "body": "Commit: **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)**",
    "created_at": "2022-03-31T14:16:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543177",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)**



---

archive/issue_comments_543178.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8\">0618873</a></td><td><code>Ensure symlink points to an existing directory</code></td></tr></table>\n",
    "created_at": "2022-03-31T14:16:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543178",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:11"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8">0618873</a></td><td><code>Ensure symlink points to an existing directory</code></td></tr></table>




---

archive/issue_events_461474.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-31T14:16:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461474"
}
```



---

archive/issue_events_461475.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-31T14:16:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461475"
}
```



---

archive/issue_events_461476.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-03-31T14:17:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461476"
}
```



---

archive/issue_comments_543179.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI don't want to get off topic, but since we're talking about symlinks, without this branch a fresh build of the `html` docs gives errors like\n\n```\n[reference] Handler <function _copy_css_file at 0x7f6177a57880> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static')\n```\nThere are 156 of these errors and the referenced `_static` files are symlinks to an actual `_static` folder, i.e.\n\n```\n/local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static -> ../_static\n```",
    "created_at": "2022-03-31T15:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543179",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:13" align="right">comment:13</div>

I don't want to get off topic, but since we're talking about symlinks, without this branch a fresh build of the `html` docs gives errors like

```
[reference] Handler <function _copy_css_file at 0x7f6177a57880> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static')
```
There are 156 of these errors and the referenced `_static` files are symlinks to an actual `_static` folder, i.e.

```
/local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static -> ../_static
```



---

archive/issue_comments_543180.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWith this branch (on gitpod), I now get somewhat similar errors as reported by @strogdon (but for the inventories and not static files):\n\n```\n[tensor_fr] WARNING: failed to reach any of the inventories with the following issues:\n[tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv'\n[tensor_fr] WARNING: failed to reach any of the inventories with the following issues:\n[tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv'\n```\n\nAlso the issue for building the tutorial still persist.",
    "created_at": "2022-03-31T16:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543180",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:14" align="right">comment:14</div>

With this branch (on gitpod), I now get somewhat similar errors as reported by @strogdon (but for the inventories and not static files):

```
[tensor_fr] WARNING: failed to reach any of the inventories with the following issues:
[tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv'
[tensor_fr] WARNING: failed to reach any of the inventories with the following issues:
[tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv'
```

Also the issue for building the tutorial still persist.



---

archive/issue_events_461477.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2022-03-31T17:30:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461477"
}
```



---

archive/issue_events_461478.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2022-03-31T17:30:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461478"
}
```



---

archive/issue_comments_543181.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nWith this branch after\n\n```\nmake doc-clean doc-uninstall\n```\nboth\n\n```\n./sage --docbuild tutorial html\n```\nand\n\n```\n./sage --docbuild reference html\n```\nfail as in the Description. Is `--docbuild` supposed to work out of the box in this way without doing something else?",
    "created_at": "2022-03-31T17:30:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543181",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:15" align="right">comment:15</div>

With this branch after

```
make doc-clean doc-uninstall
```
both

```
./sage --docbuild tutorial html
```
and

```
./sage --docbuild reference html
```
fail as in the Description. Is `--docbuild` supposed to work out of the box in this way without doing something else?



---

archive/issue_comments_543182.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nNot related to this issue but I'm unable to start a new `SageMath` jupyter notebook. Before opening a new issue I wanted to make sure others are seeing this.\n\n```\n./sage -n jupyter\n```\nselect `New -> [SageMath](../wiki/SageMath) 9.6.beta6` and nothing happens. In the terminal\n\n```\n[I 12:39:27.730 NotebookApp] Creating new notebook in\n```\nwith nothing else.",
    "created_at": "2022-03-31T18:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543182",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:16" align="right">comment:16</div>

Not related to this issue but I'm unable to start a new `SageMath` jupyter notebook. Before opening a new issue I wanted to make sure others are seeing this.

```
./sage -n jupyter
```
select `New -> [SageMath](../wiki/SageMath) 9.6.beta6` and nothing happens. In the terminal

```
[I 12:39:27.730 NotebookApp] Creating new notebook in
```
with nothing else.



---

archive/issue_comments_543183.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@strogdon](#comment:15):\n> With this branch after\n> \n> ```\n> make doc-clean doc-uninstall\n> ```\n> both\n> \n> ```\n> ./sage --docbuild tutorial html\n> ```\n> and\n> \n> ```\n> ./sage --docbuild reference html\n> ```\n> fail as in the Description. Is `--docbuild` supposed to work out of the box in this way without doing something else? \n\nNo. You must successfully build the docoumentation from scratch first, which means\n\n```\nmake doc-clean; make doc-uninstall; make\n```",
    "created_at": "2022-04-01T00:26:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543183",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@strogdon](#comment:15):
> With this branch after
> 
> ```
> make doc-clean doc-uninstall
> ```
> both
> 
> ```
> ./sage --docbuild tutorial html
> ```
> and
> 
> ```
> ./sage --docbuild reference html
> ```
> fail as in the Description. Is `--docbuild` supposed to work out of the box in this way without doing something else? 

No. You must successfully build the docoumentation from scratch first, which means

```
make doc-clean; make doc-uninstall; make
```



---

archive/issue_events_461479.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-04-01T00:27:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461479"
}
```



---

archive/issue_events_461480.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-04-01T00:27:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461480"
}
```



---

archive/issue_comments_543184.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@tobiasdiez](#comment:14):\n> With this branch (on gitpod), I now get somewhat similar errors as reported by @strogdon (but for the inventories and not static files):\n> \n> ```\n> [tensor_fr] WARNING: failed to reach any of the inventories with the following issues:\n> [tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv'\n> [tensor_fr] WARNING: failed to reach any of the inventories with the following issues:\n> [tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv'\n> ```\n> \n> Also the issue for building the tutorial still persist.\n\nIs this a documentation building from scratch?",
    "created_at": "2022-04-01T00:29:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543184",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@tobiasdiez](#comment:14):
> With this branch (on gitpod), I now get somewhat similar errors as reported by @strogdon (but for the inventories and not static files):
> 
> ```
> [tensor_fr] WARNING: failed to reach any of the inventories with the following issues:
> [tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv'
> [tensor_fr] WARNING: failed to reach any of the inventories with the following issues:
> [tensor_fr] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv'
> ```
> 
> Also the issue for building the tutorial still persist.

Is this a documentation building from scratch?



---

archive/issue_comments_543185.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kwankyu](#comment:17):\n> Replying to [@strogdon](#comment:15):\n> > With this branch after\n> > \n> > ```\n> > make doc-clean doc-uninstall\n> > ```\n> > both\n> > \n> > ```\n> > ./sage --docbuild tutorial html\n> > ```\n> > and\n> > \n> > ```\n> > ./sage --docbuild reference html\n> > ```\n> > fail as in the Description. Is `--docbuild` supposed to work out of the box in this way without doing something else? \n\n> \n> No. You must successfully build the docoumentation from scratch first, which means\n> \n> ```\n> make doc-clean; make doc-uninstall; make\n> ``` \n> \n>  \n\nOK, then I do not have this issue. From the `develop` branch w/o this ticket and after successfully building the documentation:\n\n```\n$ ./sage --docbuild tutorial html\n[tutorial ] Merging environment/index files...\n[tutorial ] ... done (0 todos, 23 index, 17 citations, 0 modules)\n[tutorial ] no targets are out of date.\n[tutorial ] The HTML pages are in local/share/doc/sage/html/en/tutorial.\nBuild finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/tutorial\n```\nand\n\n```\n$ ./sage --docbuild reference html\n[reference] no targets are out of date.\n[reference] The HTML pages are in local/share/doc/sage/html/en/reference/references.\nBuild finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/reference/references\n[spkg     ] no targets are out of date.\n[spkg     ] The HTML pages are in local/share/doc/sage/html/en/reference/spkg.\nBuild finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/reference/spkg\n\n...\n\n[reference] no targets are out of date.\n[reference] The HTML pages are in local/share/doc/sage/html/en/reference.\nBuild finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/reference\n```\n\nI only see the `issue` if the documentation is not built first.",
    "created_at": "2022-04-01T03:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543185",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kwankyu](#comment:17):
> Replying to [@strogdon](#comment:15):
> > With this branch after
> > 
> > ```
> > make doc-clean doc-uninstall
> > ```
> > both
> > 
> > ```
> > ./sage --docbuild tutorial html
> > ```
> > and
> > 
> > ```
> > ./sage --docbuild reference html
> > ```
> > fail as in the Description. Is `--docbuild` supposed to work out of the box in this way without doing something else? 

> 
> No. You must successfully build the docoumentation from scratch first, which means
> 
> ```
> make doc-clean; make doc-uninstall; make
> ``` 
> 
>  

OK, then I do not have this issue. From the `develop` branch w/o this ticket and after successfully building the documentation:

```
$ ./sage --docbuild tutorial html
[tutorial ] Merging environment/index files...
[tutorial ] ... done (0 todos, 23 index, 17 citations, 0 modules)
[tutorial ] no targets are out of date.
[tutorial ] The HTML pages are in local/share/doc/sage/html/en/tutorial.
Build finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/tutorial
```
and

```
$ ./sage --docbuild reference html
[reference] no targets are out of date.
[reference] The HTML pages are in local/share/doc/sage/html/en/reference/references.
Build finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/reference/references
[spkg     ] no targets are out of date.
[spkg     ] The HTML pages are in local/share/doc/sage/html/en/reference/spkg.
Build finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/reference/spkg

...

[reference] no targets are out of date.
[reference] The HTML pages are in local/share/doc/sage/html/en/reference.
Build finished. The built documents can be found in /local/sage-git/sage/local/share/doc/sage/html/en/reference
```

I only see the `issue` if the documentation is not built first.



---

archive/issue_comments_543186.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,113 +1,15 @@\n-Building the documentation on gitpod is currently broken and fails with the following error messages:\n+Building the documentation is currently broken and fails with the following error messages:\n \n-$ ./sage --docbuild tutorial html\n+$ make doc-clean; make doc-uninstall; make\n \n ```\n-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:193: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-See https://trac.sagemath.org/32987 for details.\n-  sage_makedirs(d)\n-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:210: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-See https://trac.sagemath.org/32987 for details.\n-  sage_makedirs(d)\n-[tutorial ] building [html]: targets for 23 source files that are out of date\n-[tutorial ] updating environment: [new config] 23 added, 0 changed, 0 removed\n-[tutorial ] Merging environment/index files...\n-[tutorial ] ... done (0 todos, 23 index, 17 citations, 0 modules)\n-[tutorial ] /home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/ext/multidocs.py:234: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-[tutorial ] See https://trac.sagemath.org/32987 for details.\n-[tutorial ]   sage_makedirs(citedir)\n-[tutorial ] /workspace/sagetrac-mirror/src/doc/en/tutorial/tour_numtheory.rst:129: WARNING: undefined label: sage.rings.padics.tutorial\n-[tutorial ] Merging js index files...\n-[tutorial ] ... done (2488 js index entries)\n-[tutorial ] dumping search index in English (code: en)... done\n-[tutorial ] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/tutorial.\n-Error building the documentation.\n-Traceback (most recent call last):\n-  File \"/usr/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\n-    return _run_code(code, main_globals, None,\n-  File \"/usr/lib/python3.8/runpy.py\", line 87, in _run_code\n-    exec(code, run_globals)\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__main__.py\", line 2, in <module>\n-    main()\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py\", line 1732, in main\n-    builder()\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py\", line 137, in f\n-    runsphinx()\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/sphinxbuild.py\", line 323, in runsphinx\n-    sys.stderr.raise_errors()\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/sphinxbuild.py\", line 258, in raise_errors\n-    raise OSError(self._error)\n-OSError: /workspace/sagetrac-mirror/src/doc/en/tutorial/tour_numtheory.rst:129: WARNING: undefined label: sage.rings.padics.tutorial\n+...\n+[sagemath_doc_html-none] [semirings] building [html]: targets for 3 source files that are out of date\n+[sagemath_doc_html-none] [semirings] dumping search index in English (code: en)... done\n+[sagemath_doc_html-none] [semirings] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings.\n+[sagemath_doc_html-none] [semirings] Extension error (matplotlib.sphinxext.plot_directive):\n+[sagemath_doc_html-none] [semirings] Handler <function _copy_css_file at 0x7f0673973e50> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings/_static')\n+[sagemath_doc_html-none] Build finished. The built documents can be found in /home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings\n+...\n ```\n \n-$ ./sage --docbuild reference html\n-\n-```\n-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:210: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-See https://trac.sagemath.org/32987 for details.\n-  sage_makedirs(d)\n-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:193: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-See https://trac.sagemath.org/32987 for details.\n-  sage_makedirs(d)\n-[reference] building [html]: targets for 1 source files that are out of date\n-[reference] updating environment: [new config] 1 added, 0 changed, 0 removed\n-[reference] /home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/ext/multidocs.py:234: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-[reference] See https://trac.sagemath.org/32987 for details.\n-[reference]   sage_makedirs(citedir)\n-[reference] loading cross citations... looking for now-outdated files... none found\n-[reference] dumping search index in English (code: en)... done\n-[reference] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/references.\n-[reference] Extension error (matplotlib.sphinxext.plot_directive):\n-[reference] Handler <function _copy_css_file at 0x7f703839a160> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/references/_static')\n-Build finished. The built documents can be found in /home/gitpod/sage-local/share/doc/sage/html/en/reference/references\n-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:210: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-See https://trac.sagemath.org/32987 for details.\n-  sage_makedirs(d)\n-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:193: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-See https://trac.sagemath.org/32987 for details.\n-  sage_makedirs(d)\n-[spkg     ] WARNING: failed to reach any of the inventories with the following issues:\n-[spkg     ] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv'\n-[spkg     ] WARNING: failed to reach any of the inventories with the following issues:\n-[spkg     ] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv'\n-[spkg     ] building [html]: targets for 359 source files that are out of date\n-[spkg     ] updating environment: [new config] 359 added, 0 changed, 0 removed\n-[spkg     ] /home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/ext/multidocs.py:234: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead\n-[spkg     ] See https://trac.sagemath.org/32987 for details.\n-[spkg     ]   sage_makedirs(citedir)\n-[spkg     ] loading cross citations... looking for now-outdated files... none found\n-[spkg     ] dumping search index in English (code: en)... done\n-[spkg     ] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/spkg.\n-[spkg     ] Extension error (matplotlib.sphinxext.plot_directive):\n-[spkg     ] Handler <function _copy_css_file at 0x7f703841c280> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/spkg/_static')\n-Error building the documentation.\n-Traceback (most recent call last):\n-  File \"/usr/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\n-    return _run_code(code, main_globals, None,\n-  File \"/usr/lib/python3.8/runpy.py\", line 87, in _run_code\n-    exec(code, run_globals)\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__main__.py\", line 2, in <module>\n-    main()\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py\", line 1732, in main\n-    builder()\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py\", line 537, in _wrapper\n-    self._build_everything_except_bibliography(format, *args, **kwds)\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py\", line 521, in _build_everything_except_bibliography\n-    build_many(build_ref_doc, non_references)\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py\", line 299, in build_many\n-    _build_many(target, args, processes=processes)\n-  File \"/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/utils.py\", line 289, in build_many\n-    raise worker_exc.original_exception\n-OSError: WARNING: failed to reach any of the inventories with the following issues:\n-\n-    Note: incremental documentation builds sometimes cause spurious\n-    error messages. To be certain that these are real errors, run\n-    \"make doc-clean doc-uninstall\" first and try again.\n-```\n-\n-(not sure if these issues are specific to gitpod)\n-\n-To reproduce:\n-- Go to https://gitpod.io/#https://github.com/sagemath/sagetrac-mirror/tree/develop (or if that works https://gitpod.io#snapshot/d3ce0749-4d92-44ff-bb06-04626d4e3b2c, in which case you don't need to wait for the build)\n-- Wait until the build of sagelib completes (takes about 30mins)\n-- Run above commands\n``````\n",
    "created_at": "2022-04-01T15:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543186",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,113 +1,15 @@
-Building the documentation on gitpod is currently broken and fails with the following error messages:
+Building the documentation is currently broken and fails with the following error messages:
 
-$ ./sage --docbuild tutorial html
+$ make doc-clean; make doc-uninstall; make
 
 ```
-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:193: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-See https://trac.sagemath.org/32987 for details.
-  sage_makedirs(d)
-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:210: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-See https://trac.sagemath.org/32987 for details.
-  sage_makedirs(d)
-[tutorial ] building [html]: targets for 23 source files that are out of date
-[tutorial ] updating environment: [new config] 23 added, 0 changed, 0 removed
-[tutorial ] Merging environment/index files...
-[tutorial ] ... done (0 todos, 23 index, 17 citations, 0 modules)
-[tutorial ] /home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/ext/multidocs.py:234: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-[tutorial ] See https://trac.sagemath.org/32987 for details.
-[tutorial ]   sage_makedirs(citedir)
-[tutorial ] /workspace/sagetrac-mirror/src/doc/en/tutorial/tour_numtheory.rst:129: WARNING: undefined label: sage.rings.padics.tutorial
-[tutorial ] Merging js index files...
-[tutorial ] ... done (2488 js index entries)
-[tutorial ] dumping search index in English (code: en)... done
-[tutorial ] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/tutorial.
-Error building the documentation.
-Traceback (most recent call last):
-  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
-    return _run_code(code, main_globals, None,
-  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
-    exec(code, run_globals)
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__main__.py", line 2, in <module>
-    main()
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py", line 1732, in main
-    builder()
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py", line 137, in f
-    runsphinx()
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/sphinxbuild.py", line 323, in runsphinx
-    sys.stderr.raise_errors()
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/sphinxbuild.py", line 258, in raise_errors
-    raise OSError(self._error)
-OSError: /workspace/sagetrac-mirror/src/doc/en/tutorial/tour_numtheory.rst:129: WARNING: undefined label: sage.rings.padics.tutorial
+...
+[sagemath_doc_html-none] [semirings] building [html]: targets for 3 source files that are out of date
+[sagemath_doc_html-none] [semirings] dumping search index in English (code: en)... done
+[sagemath_doc_html-none] [semirings] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings.
+[sagemath_doc_html-none] [semirings] Extension error (matplotlib.sphinxext.plot_directive):
+[sagemath_doc_html-none] [semirings] Handler <function _copy_css_file at 0x7f0673973e50> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings/_static')
+[sagemath_doc_html-none] Build finished. The built documents can be found in /home/gitpod/sage-local/share/doc/sage/html/en/reference/semirings
+...
 ```
 
-$ ./sage --docbuild reference html
-
-```
-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:210: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-See https://trac.sagemath.org/32987 for details.
-  sage_makedirs(d)
-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:193: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-See https://trac.sagemath.org/32987 for details.
-  sage_makedirs(d)
-[reference] building [html]: targets for 1 source files that are out of date
-[reference] updating environment: [new config] 1 added, 0 changed, 0 removed
-[reference] /home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/ext/multidocs.py:234: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-[reference] See https://trac.sagemath.org/32987 for details.
-[reference]   sage_makedirs(citedir)
-[reference] loading cross citations... looking for now-outdated files... none found
-[reference] dumping search index in English (code: en)... done
-[reference] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/references.
-[reference] Extension error (matplotlib.sphinxext.plot_directive):
-[reference] Handler <function _copy_css_file at 0x7f703839a160> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/references/_static')
-Build finished. The built documents can be found in /home/gitpod/sage-local/share/doc/sage/html/en/reference/references
-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:210: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-See https://trac.sagemath.org/32987 for details.
-  sage_makedirs(d)
-/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py:193: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-See https://trac.sagemath.org/32987 for details.
-  sage_makedirs(d)
-[spkg     ] WARNING: failed to reach any of the inventories with the following issues:
-[spkg     ] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/objects.inv'
-[spkg     ] WARNING: failed to reach any of the inventories with the following issues:
-[spkg     ] intersphinx inventory '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/home/gitpod/sage-local/share/doc/sage/inventory/en/reference/references/objects.inv'
-[spkg     ] building [html]: targets for 359 source files that are out of date
-[spkg     ] updating environment: [new config] 359 added, 0 changed, 0 removed
-[spkg     ] /home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/ext/multidocs.py:234: DeprecationWarning: sage_makedirs is deprecated; use os.makedirs(..., exist_ok=True) instead
-[spkg     ] See https://trac.sagemath.org/32987 for details.
-[spkg     ]   sage_makedirs(citedir)
-[spkg     ] loading cross citations... looking for now-outdated files... none found
-[spkg     ] dumping search index in English (code: en)... done
-[spkg     ] The HTML pages are in ../../home/gitpod/sage-local/share/doc/sage/html/en/reference/spkg.
-[spkg     ] Extension error (matplotlib.sphinxext.plot_directive):
-[spkg     ] Handler <function _copy_css_file at 0x7f703841c280> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/home/gitpod/sage-local/share/doc/sage/html/en/reference/spkg/_static')
-Error building the documentation.
-Traceback (most recent call last):
-  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
-    return _run_code(code, main_globals, None,
-  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
-    exec(code, run_globals)
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__main__.py", line 2, in <module>
-    main()
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py", line 1732, in main
-    builder()
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py", line 537, in _wrapper
-    self._build_everything_except_bibliography(format, *args, **kwds)
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py", line 521, in _build_everything_except_bibliography
-    build_many(build_ref_doc, non_references)
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/__init__.py", line 299, in build_many
-    _build_many(target, args, processes=processes)
-  File "/home/gitpod/sage-local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage_docbuild/utils.py", line 289, in build_many
-    raise worker_exc.original_exception
-OSError: WARNING: failed to reach any of the inventories with the following issues:
-
-    Note: incremental documentation builds sometimes cause spurious
-    error messages. To be certain that these are real errors, run
-    "make doc-clean doc-uninstall" first and try again.
-```
-
-(not sure if these issues are specific to gitpod)
-
-To reproduce:
-- Go to https://gitpod.io/#https://github.com/sagemath/sagetrac-mirror/tree/develop (or if that works https://gitpod.io#snapshot/d3ce0749-4d92-44ff-bb06-04626d4e3b2c, in which case you don't need to wait for the build)
-- Wait until the build of sagelib completes (takes about 30mins)
-- Run above commands
``````




---

archive/issue_comments_543187.json:
```json
{
    "body": "Reviewer: **Tobias Diez**",
    "created_at": "2022-04-01T15:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543187",
    "user": "https://github.com/tobiasdiez"
}
```

Reviewer: **Tobias Diez**



---

archive/issue_comments_543188.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI should have tested it with\n\n```\nmake doc-clean; make doc-uninstall; make\n```\nin the first place, since the first issue I mentioned earlier is fixed by it.\n\nRunning this command on `develop` leads to the issues with `_static`, and with this branch these issues are fixed. Thus, lets get this in.",
    "created_at": "2022-04-01T15:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543188",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:21" align="right">comment:21</div>

I should have tested it with

```
make doc-clean; make doc-uninstall; make
```
in the first place, since the first issue I mentioned earlier is fixed by it.

Running this command on `develop` leads to the issues with `_static`, and with this branch these issues are fixed. Thus, lets get this in.



---

archive/issue_events_461481.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-04-01T15:39:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461481"
}
```



---

archive/issue_events_461482.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-04-01T15:39:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461482"
}
```



---

archive/issue_comments_543189.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nIf the documentation has not been built, then (for example) `./sage --docbuild tutorial html` fails. I think this used to work, but I'm not sure and if it did, I don't know how long ago. Is there a ticket for this issue?",
    "created_at": "2022-04-01T19:07:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543189",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

If the documentation has not been built, then (for example) `./sage --docbuild tutorial html` fails. I think this used to work, but I'm not sure and if it did, I don't know how long ago. Is there a ticket for this issue?



---

archive/issue_comments_543190.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@jhpalmieri](#comment:22):\n> If the documentation has not been built, then (for example) `./sage --docbuild tutorial html` fails. I think this used to work, but I'm not sure and if it did, I don't know how long ago. Is there a ticket for this issue?\n\nPerhaps no. It could have worked before. But when I try that now, it fails because the reference manual is not yet built. Hence I am not sure whether building an individual document from source without building the whole documentation is something we do efforts to support.",
    "created_at": "2022-04-02T01:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543190",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@jhpalmieri](#comment:22):
> If the documentation has not been built, then (for example) `./sage --docbuild tutorial html` fails. I think this used to work, but I'm not sure and if it did, I don't know how long ago. Is there a ticket for this issue?

Perhaps no. It could have worked before. But when I try that now, it fails because the reference manual is not yet built. Hence I am not sure whether building an individual document from source without building the whole documentation is something we do efforts to support.



---

archive/issue_comments_543191.json:
```json
{
    "body": "Changed branch from **[u/klee/33608](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/33608)** to **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)**",
    "created_at": "2022-04-03T11:14:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543191",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/klee/33608](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/33608)** to **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)**



---

archive/issue_events_461483.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-03T11:14:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461483"
}
```



---

archive/issue_events_461484.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b438a789189362e37d6faf1818020a4b032440f0",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-04-03T11:14:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33608#event-461484"
}
```



---

archive/issue_comments_543192.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [Steven Trogdon](#comment:13):\n> I don't want to get off topic, but since we're talking about symlinks, without this branch a fresh build of the `html` docs gives errors like\n> \n> ```\n> [reference] Handler <function _copy_css_file at 0x7f6177a57880> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static')\n> ```\n> There are 156 of these errors and the referenced `_static` files are symlinks to an actual `_static` folder, i.e.\n> \n> ```\n> /local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static -> ../_static\n> ```\n\nThis may be fixed by https://github.com/matplotlib/matplotlib/pull/23805",
    "created_at": "2022-09-05T16:19:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543192",
    "user": "https://github.com/collares"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [Steven Trogdon](#comment:13):
> I don't want to get off topic, but since we're talking about symlinks, without this branch a fresh build of the `html` docs gives errors like
> 
> ```
> [reference] Handler <function _copy_css_file at 0x7f6177a57880> for event 'build-finished' threw an exception (exception: [Errno 17] File exists: '/local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static')
> ```
> There are 156 of these errors and the referenced `_static` files are symlinks to an actual `_static` folder, i.e.
> 
> ```
> /local/sage-git/sage/local/share/doc/sage/html/en/reference/references/_static -> ../_static
> ```

This may be fixed by https://github.com/matplotlib/matplotlib/pull/23805



---

archive/issue_comments_543193.json:
```json
{
    "body": "Changed commit from **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)** to none",
    "created_at": "2022-09-05T16:19:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33608#issuecomment-543193",
    "user": "https://github.com/collares"
}
```

Changed commit from **[`0618873`](https://github.com/sagemath/sagetrac-mirror/commit/0618873a41e68684cfcf92702a320e194b5c78f8)** to none
