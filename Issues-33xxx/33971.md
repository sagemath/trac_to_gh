# Issue 33971: Height of a dynamical system is wrong

archive/issues_033734.json:
```json
{
    "body": "The height of a dynamical system is currently calculated as the max of the heights of the coefficients, which is incorrect. To avoid writing a complicated formula, the correct height can be thought of as treating the coefficients of all coordinate functions as one big projective point and taking the height of that. For example\n\n```\nP.<x,y>=ProjectiveSpace(QQ,1)\nf=DynamicalSystem([1/25*x^2 + 25/3*x*y+y^2,1*y^2])\nexp(f.global_height())\n```\n\ngives 25, but should be 625.\n\nAssignee: @guojing0\n\nCC:  @bhutz @enderwannabe\n\nKeywords: gsoc2022\n\nBranch/Commit: d24eea822da6c3676b3194898da152828f3ee46b\n\nReviewer: Ben Hutz\n\nAuthor: Jing Guo\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33971\n\n",
    "closed_at": "2022-08-01T20:20:42Z",
    "created_at": "2022-06-10T11:45:38Z",
    "labels": [
        "component: dynamics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Height of a dynamical system is wrong",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33971",
    "user": "https://github.com/guojing0"
}
```
The height of a dynamical system is currently calculated as the max of the heights of the coefficients, which is incorrect. To avoid writing a complicated formula, the correct height can be thought of as treating the coefficients of all coordinate functions as one big projective point and taking the height of that. For example

```
P.<x,y>=ProjectiveSpace(QQ,1)
f=DynamicalSystem([1/25*x^2 + 25/3*x*y+y^2,1*y^2])
exp(f.global_height())
```

gives 25, but should be 625.

Assignee: @guojing0

CC:  @bhutz @enderwannabe

Keywords: gsoc2022

Branch/Commit: d24eea822da6c3676b3194898da152828f3ee46b

Reviewer: Ben Hutz

Author: Jing Guo

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33971





---

archive/issue_comments_677324.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n-The height of a dynamical system is the max of the heights of the polynomials, which is calculated as the max of the heights of the cofficients.\n-\n-The following is wrong:\n+The height of a dynamical system is the max of the heights of the polynomials, which is calculated as the max of the heights of the cofficients. This is wrong:\n \n ```\n P.<x,y>=ProjectiveSpace(QQ,1)\n``````\n",
    "created_at": "2022-06-10T11:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677324",
    "user": "https://github.com/guojing0"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
-The height of a dynamical system is the max of the heights of the polynomials, which is calculated as the max of the heights of the cofficients.
-
-The following is wrong:
+The height of a dynamical system is the max of the heights of the polynomials, which is calculated as the max of the heights of the cofficients. This is wrong:
 
 ```
 P.<x,y>=ProjectiveSpace(QQ,1)
``````




---

archive/issue_comments_677325.json:
```json
{
    "body": "Changing type from enhancement to task.",
    "created_at": "2022-06-10T11:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677325",
    "user": "https://github.com/guojing0"
}
```

Changing type from enhancement to task.



---

archive/issue_comments_677326.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The height of a dynamical system is the max of the heights of the polynomials, which is calculated as the max of the heights of the cofficients. This is wrong:\n+The height of a dynamical system is currently calculated as the max of the heights of the coefficients, which is incorrect. To avoid writing a complicated formula, the correct height can be thought of as treating the coefficients of all coordinate functions as one big projective point and taking the height of that. For example\n \n ```\n P.<x,y>=ProjectiveSpace(QQ,1)\n@@ -6,3 +6,4 @@\n exp(f.global_height())\n ```\n \n+gives 25, but should be 625.\n``````\n",
    "created_at": "2022-06-10T16:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677326",
    "user": "https://github.com/bhutz"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The height of a dynamical system is the max of the heights of the polynomials, which is calculated as the max of the heights of the cofficients. This is wrong:
+The height of a dynamical system is currently calculated as the max of the heights of the coefficients, which is incorrect. To avoid writing a complicated formula, the correct height can be thought of as treating the coefficients of all coordinate functions as one big projective point and taking the height of that. For example
 
 ```
 P.<x,y>=ProjectiveSpace(QQ,1)
@@ -6,3 +6,4 @@
 exp(f.global_height())
 ```
 
+gives 25, but should be 625.
``````




---

archive/issue_comments_677327.json:
```json
{
    "body": "Changing type from task to defect.",
    "created_at": "2022-06-10T16:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677327",
    "user": "https://github.com/bhutz"
}
```

Changing type from task to defect.



---

archive/issue_comments_677328.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-guojing0/33971_dyn_sys_height\"",
    "created_at": "2022-06-16T08:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677328",
    "user": "https://github.com/guojing0"
}
```

Changing branch from "" to "u/gh-guojing0/33971_dyn_sys_height"



---

archive/issue_comments_677329.json:
```json
{
    "body": "Set assignee to @guojing0.",
    "created_at": "2022-06-16T08:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677329",
    "user": "https://github.com/guojing0"
}
```

Set assignee to @guojing0.



---

archive/issue_comments_677330.json:
```json
{
    "body": "Changing commit from \"\" to \"5fb2a6ea44400e469caee82748cf863ca0c5f724\"",
    "created_at": "2022-06-16T08:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677330",
    "user": "https://github.com/guojing0"
}
```

Changing commit from "" to "5fb2a6ea44400e469caee82748cf863ca0c5f724"



---

archive/issue_comments_677331.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-21T14:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677332.json:
```json
{
    "body": "Changing commit from \"5fb2a6ea44400e469caee82748cf863ca0c5f724\" to \"a2892e00569fe3b7731d20b04511f94b3ec1cbf3\"",
    "created_at": "2022-06-21T14:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677332",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5fb2a6ea44400e469caee82748cf863ca0c5f724" to "a2892e00569fe3b7731d20b04511f94b3ec1cbf3"



---

archive/issue_comments_677333.json:
```json
{
    "body": "Changing commit from \"a2892e00569fe3b7731d20b04511f94b3ec1cbf3\" to \"0d582710e18af55d4c7b3626a12237e322a80647\"",
    "created_at": "2022-06-22T11:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677333",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a2892e00569fe3b7731d20b04511f94b3ec1cbf3" to "0d582710e18af55d4c7b3626a12237e322a80647"



---

archive/issue_comments_677334.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-22T11:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677334",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677335.json:
```json
{
    "body": "<a id='comment:7'></a>These changes are meant to add a height function for polynomials. As such, they should have their own ticket, as this ticket is meant to address dynamical systems specifically.",
    "created_at": "2022-06-22T17:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677335",
    "user": "https://github.com/EnderWannabe"
}
```

<a id='comment:7'></a>These changes are meant to add a height function for polynomials. As such, they should have their own ticket, as this ticket is meant to address dynamical systems specifically.



---

archive/issue_comments_677336.json:
```json
{
    "body": "<a id='comment:8'></a>As suggested by Alex, a new ticket #34060 is created.",
    "created_at": "2022-06-24T08:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677336",
    "user": "https://github.com/guojing0"
}
```

<a id='comment:8'></a>As suggested by Alex, a new ticket #34060 is created.



---

archive/issue_comments_677337.json:
```json
{
    "body": "Changing commit from \"0d582710e18af55d4c7b3626a12237e322a80647\" to \"\"",
    "created_at": "2022-06-24T08:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677337",
    "user": "https://github.com/guojing0"
}
```

Changing commit from "0d582710e18af55d4c7b3626a12237e322a80647" to ""



---

archive/issue_comments_677338.json:
```json
{
    "body": "Changing branch from \"u/gh-guojing0/33971_dyn_sys_height\" to \"\"",
    "created_at": "2022-06-24T08:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677338",
    "user": "https://github.com/guojing0"
}
```

Changing branch from "u/gh-guojing0/33971_dyn_sys_height" to ""



---

archive/issue_comments_677339.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-guojing0/33971_ds_height\"",
    "created_at": "2022-06-28T15:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677339",
    "user": "https://github.com/guojing0"
}
```

Changing branch from "" to "u/gh-guojing0/33971_ds_height"



---

archive/issue_comments_677340.json:
```json
{
    "body": "Changing commit from \"\" to \"38425b51bcdc7fd556d8bd54f488d4e0a4096b14\"",
    "created_at": "2022-06-28T15:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677340",
    "user": "https://github.com/guojing0"
}
```

Changing commit from "" to "38425b51bcdc7fd556d8bd54f488d4e0a4096b14"



---

archive/issue_comments_677341.json:
```json
{
    "body": "<a id='comment:9'></a>New commits:",
    "created_at": "2022-06-28T15:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677341",
    "user": "https://github.com/guojing0"
}
```

<a id='comment:9'></a>New commits:



---

archive/issue_comments_677342.json:
```json
{
    "body": "Changing commit from \"38425b51bcdc7fd556d8bd54f488d4e0a4096b14\" to \"c7187f42ed44c13ced8458c9bdf8a038f3701f76\"",
    "created_at": "2022-06-29T01:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "38425b51bcdc7fd556d8bd54f488d4e0a4096b14" to "c7187f42ed44c13ced8458c9bdf8a038f3701f76"



---

archive/issue_comments_677343.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-29T01:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677343",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677344.json:
```json
{
    "body": "<a id='comment:11'></a>The return values of the examples in the docstring of `global_height` in `projective_morphism.py` are same as before, except for the first one (current result is something like 20.83484...):\n\n\n```\nsage: P.<x,y> = ProjectiveSpace(QQ,1)\nsage: H = Hom(P,P)\nsage: f = H([1/1331*x^2+1/4000*y^2, 210*x*y]);\nsage: f.global_height()\n8.29404964010203\n```\n\nI also added the example from description to the documentation.",
    "created_at": "2022-06-29T01:46:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677344",
    "user": "https://github.com/guojing0"
}
```

<a id='comment:11'></a>The return values of the examples in the docstring of `global_height` in `projective_morphism.py` are same as before, except for the first one (current result is something like 20.83484...):


```
sage: P.<x,y> = ProjectiveSpace(QQ,1)
sage: H = Hom(P,P)
sage: f = H([1/1331*x^2+1/4000*y^2, 210*x*y]);
sage: f.global_height()
8.29404964010203
```

I also added the example from description to the documentation.



---

archive/issue_comments_677345.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-29T05:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677345",
    "user": "https://github.com/guojing0"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_677346.json:
```json
{
    "body": "<a id='comment:13'></a>A couple issues here\n\n- The dimension of the projective space is off by 1. It should be\n\n```\nP = ProjectiveSpace(K, len(coeffs)-1)\n```\n\n- I'd suggest having one less variable defined\n\n```\nproj_point = P.point(coeffs)\nreturn proj_point.global_height()\n```\nto\n\n```\nreturn P.point(coeffs).global_height()\n```\n\n- correct the doc string to describe what this height is actually doing. (i.e., this is the global height of the coefficents as a projective point)\n\n- There seems to be an issue with scaling. The definition of height should be independent of the representative, so these should return the same height. I suggest adding an example for this too. There is an issue somewhere as these are giving different values.\n\n```\nP.<x,y>=ProjectiveSpace(QQ,1)\nf=DynamicalSystem([1/25*x^2 + 25/3*x*y+y^2,1*y^2])\nprint(f.global_height())\nc=10000\nf.scale_by(c)\nf.global_height()\n```\n\n- These should be implemented for Affine Dynamical systems too. Careful here that you construct the correct projective point; it may be simplest to homogenize the dynamical system first and then call the projective version (don't forget the case of morphisms between spaces of different dimensions).\n\n- The local_height and local_height_arch seem not to be implemented for affine morphisms at all yet.",
    "created_at": "2022-06-30T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677346",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:13'></a>A couple issues here

- The dimension of the projective space is off by 1. It should be

```
P = ProjectiveSpace(K, len(coeffs)-1)
```

- I'd suggest having one less variable defined

```
proj_point = P.point(coeffs)
return proj_point.global_height()
```
to

```
return P.point(coeffs).global_height()
```

- correct the doc string to describe what this height is actually doing. (i.e., this is the global height of the coefficents as a projective point)

- There seems to be an issue with scaling. The definition of height should be independent of the representative, so these should return the same height. I suggest adding an example for this too. There is an issue somewhere as these are giving different values.

```
P.<x,y>=ProjectiveSpace(QQ,1)
f=DynamicalSystem([1/25*x^2 + 25/3*x*y+y^2,1*y^2])
print(f.global_height())
c=10000
f.scale_by(c)
f.global_height()
```

- These should be implemented for Affine Dynamical systems too. Careful here that you construct the correct projective point; it may be simplest to homogenize the dynamical system first and then call the projective version (don't forget the case of morphisms between spaces of different dimensions).

- The local_height and local_height_arch seem not to be implemented for affine morphisms at all yet.



---

archive/issue_comments_677347.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-30T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677347",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_677348.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ben Hutz\"",
    "created_at": "2022-06-30T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677348",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "" to "Ben Hutz"



---

archive/issue_comments_677349.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-01T05:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677349",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677350.json:
```json
{
    "body": "Changing commit from \"c7187f42ed44c13ced8458c9bdf8a038f3701f76\" to \"a182698d195cfb07cb24d7d1f48da93fd36aa0ff\"",
    "created_at": "2022-07-01T05:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c7187f42ed44c13ced8458c9bdf8a038f3701f76" to "a182698d195cfb07cb24d7d1f48da93fd36aa0ff"



---

archive/issue_comments_677351.json:
```json
{
    "body": "Changing commit from \"a182698d195cfb07cb24d7d1f48da93fd36aa0ff\" to \"eb1d7918cc48c5c111f3031b1460ff09be272de0\"",
    "created_at": "2022-07-01T05:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677351",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a182698d195cfb07cb24d7d1f48da93fd36aa0ff" to "eb1d7918cc48c5c111f3031b1460ff09be272de0"



---

archive/issue_comments_677352.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-01T05:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677353.json:
```json
{
    "body": "Changing commit from \"eb1d7918cc48c5c111f3031b1460ff09be272de0\" to \"71c8807bf1210d8f3c51c855b87306a8c6ef97e7\"",
    "created_at": "2022-07-01T07:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "eb1d7918cc48c5c111f3031b1460ff09be272de0" to "71c8807bf1210d8f3c51c855b87306a8c6ef97e7"



---

archive/issue_comments_677354.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-01T07:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677354",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677355.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-02T07:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677355",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677356.json:
```json
{
    "body": "Changing commit from \"71c8807bf1210d8f3c51c855b87306a8c6ef97e7\" to \"30dd5f26d32036b41f7fbbb35e2e6687a9186cdf\"",
    "created_at": "2022-07-02T07:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677356",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "71c8807bf1210d8f3c51c855b87306a8c6ef97e7" to "30dd5f26d32036b41f7fbbb35e2e6687a9186cdf"



---

archive/issue_comments_677357.json:
```json
{
    "body": "Changing commit from \"30dd5f26d32036b41f7fbbb35e2e6687a9186cdf\" to \"28369c6885e4cadad8bad7055aaac21bbdb600ec\"",
    "created_at": "2022-07-02T07:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677357",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "30dd5f26d32036b41f7fbbb35e2e6687a9186cdf" to "28369c6885e4cadad8bad7055aaac21bbdb600ec"



---

archive/issue_comments_677358.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-02T07:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677359.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-02T07:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677359",
    "user": "https://github.com/guojing0"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_677360.json:
```json
{
    "body": "<a id='comment:19'></a>The things in bhutz's reviews are fixed. The three height functions (`global_height`, `local_height`, and `local_height_arch`) for affine morphisms are implemented as well.",
    "created_at": "2022-07-02T07:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677360",
    "user": "https://github.com/guojing0"
}
```

<a id='comment:19'></a>The things in bhutz's reviews are fixed. The three height functions (`global_height`, `local_height`, and `local_height_arch`) for affine morphisms are implemented as well.



---

archive/issue_comments_677361.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-07-05T17:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677361",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_677362.json:
```json
{
    "body": "<a id='comment:20'></a>- add description to the affine one that you are taking the height of the homogenization.\n\n-doc test failures:\n\n```\n1 item had failures:\n   3 of  32 in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.global_height\n    [612 tests, 3 failures, 4.79 s]\n```\nI did not run the full set of doc tests, so be sure to do so.\n\n- docs fail to build\n\n```\nOSError: /home/ben/sage-dev/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.global_height:60: WARNING: Literal block expected; none found.\n```",
    "created_at": "2022-07-05T17:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677362",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:20'></a>- add description to the affine one that you are taking the height of the homogenization.

-doc test failures:

```
1 item had failures:
   3 of  32 in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.global_height
    [612 tests, 3 failures, 4.79 s]
```
I did not run the full set of doc tests, so be sure to do so.

- docs fail to build

```
OSError: /home/ben/sage-dev/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.global_height:60: WARNING: Literal block expected; none found.
```



---

archive/issue_comments_677363.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-06T05:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677364.json:
```json
{
    "body": "Changing commit from \"28369c6885e4cadad8bad7055aaac21bbdb600ec\" to \"0a617700847eff2c4f3afb99adf80541bc4cb100\"",
    "created_at": "2022-07-06T05:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "28369c6885e4cadad8bad7055aaac21bbdb600ec" to "0a617700847eff2c4f3afb99adf80541bc4cb100"



---

archive/issue_comments_677365.json:
```json
{
    "body": "Changing commit from \"0a617700847eff2c4f3afb99adf80541bc4cb100\" to \"94a28058512d44978f57d228b7d1c56f1563e493\"",
    "created_at": "2022-07-09T02:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677365",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0a617700847eff2c4f3afb99adf80541bc4cb100" to "94a28058512d44978f57d228b7d1c56f1563e493"



---

archive/issue_comments_677366.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-09T02:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677366",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677367.json:
```json
{
    "body": "<a id='comment:23'></a>The status badge says that building documentation is successful. It passed all the tests after I ran `./sage -t affine_morphism.py` and `./sage -t projective_morphism.py`.",
    "created_at": "2022-07-09T04:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677367",
    "user": "https://github.com/guojing0"
}
```

<a id='comment:23'></a>The status badge says that building documentation is successful. It passed all the tests after I ran `./sage -t affine_morphism.py` and `./sage -t projective_morphism.py`.



---

archive/issue_comments_677368.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-09T04:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677368",
    "user": "https://github.com/guojing0"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_677369.json:
```json
{
    "body": "Changing commit from \"94a28058512d44978f57d228b7d1c56f1563e493\" to \"ab35cbc1fbda7fa4c05c67d63c949440bf0c1aef\"",
    "created_at": "2022-07-09T04:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677369",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "94a28058512d44978f57d228b7d1c56f1563e493" to "ab35cbc1fbda7fa4c05c67d63c949440bf0c1aef"



---

archive/issue_comments_677370.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-09T04:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677370",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677371.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-07-11T13:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677371",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_677372.json:
```json
{
    "body": "<a id='comment:25'></a>The functionality works when the domain and codomain have the same dimension, but not when they do not.\n\n```\nP.<x,y,z> = ProjectiveSpace(QQ,2)\nA.<z,w>=ProjectiveSpace(QQ,1)\nH = Hom(P,A)\nf = H([1/1331*x^2 + 4000*y*z,y^2])\nf.global_height()\n```\n\n```\nP.<x,y> = AffineSpace(QQ,2)\nA.<z>=AffineSpace(QQ,1)\nH = Hom(P,A)\nf = H([1/1331*x^2 + 4000*y])\nf.global_height()\n```\n\nThis example no longer makes sense since normalization does not have an effect on the height. Delete the text and the second half of the example.\n\n```\n        This function does not automatically normalize::\n\n            sage: P.<x,y,z> = ProjectiveSpace(ZZ,2)\n            sage: H = Hom(P,P)\n            sage: f = H([4*x^2 + 100*y^2, 210*x*y, 10000*z^2]);\n            sage: f.global_height()\n            8.51719319141624\n            sage: f.normalize_coordinates()\n            sage: f.global_height()\n            8.51719319141624\n```",
    "created_at": "2022-07-11T13:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677372",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:25'></a>The functionality works when the domain and codomain have the same dimension, but not when they do not.

```
P.<x,y,z> = ProjectiveSpace(QQ,2)
A.<z,w>=ProjectiveSpace(QQ,1)
H = Hom(P,A)
f = H([1/1331*x^2 + 4000*y*z,y^2])
f.global_height()
```

```
P.<x,y> = AffineSpace(QQ,2)
A.<z>=AffineSpace(QQ,1)
H = Hom(P,A)
f = H([1/1331*x^2 + 4000*y])
f.global_height()
```

This example no longer makes sense since normalization does not have an effect on the height. Delete the text and the second half of the example.

```
        This function does not automatically normalize::

            sage: P.<x,y,z> = ProjectiveSpace(ZZ,2)
            sage: H = Hom(P,P)
            sage: f = H([4*x^2 + 100*y^2, 210*x*y, 10000*z^2]);
            sage: f.global_height()
            8.51719319141624
            sage: f.normalize_coordinates()
            sage: f.global_height()
            8.51719319141624
```



---

archive/issue_comments_677373.json:
```json
{
    "body": "Changing commit from \"ab35cbc1fbda7fa4c05c67d63c949440bf0c1aef\" to \"d24eea822da6c3676b3194898da152828f3ee46b\"",
    "created_at": "2022-07-12T04:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ab35cbc1fbda7fa4c05c67d63c949440bf0c1aef" to "d24eea822da6c3676b3194898da152828f3ee46b"



---

archive/issue_comments_677374.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-12T04:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_677375.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-12T04:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677375",
    "user": "https://github.com/guojing0"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_677376.json:
```json
{
    "body": "<a id='comment:27'></a>The two examples are added as parts of the `EXAMPLES`.",
    "created_at": "2022-07-12T04:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677376",
    "user": "https://github.com/guojing0"
}
```

<a id='comment:27'></a>The two examples are added as parts of the `EXAMPLES`.



---

archive/issue_comments_677377.json:
```json
{
    "body": "<a id='comment:28'></a>This is passing my tests now. I'd like to have the patchbot pick it up before I marked it positive. Let's give it a couple days.",
    "created_at": "2022-07-12T20:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677377",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:28'></a>This is passing my tests now. I'd like to have the patchbot pick it up before I marked it positive. Let's give it a couple days.



---

archive/issue_comments_677378.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-14T13:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677378",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_677379.json:
```json
{
    "body": "Changing branch from \"u/gh-guojing0/33971_ds_height\" to \"d24eea822da6c3676b3194898da152828f3ee46b\"",
    "created_at": "2022-08-01T20:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677379",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gh-guojing0/33971_ds_height" to "d24eea822da6c3676b3194898da152828f3ee46b"



---

archive/issue_comments_677380.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-01T20:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33971#issuecomment-677380",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_088980.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-01T20:20:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33971",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33971#event-88980"
}
```
