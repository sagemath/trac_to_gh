# Issue 33031: add tolerance to is_hermitian() for sparse "double" matrices

archive/issues_032794.json:
```json
{
    "body": "Discovered in #33023, the implementation of `is_hermitian()` for sparse double matrices is the generic one that tests equality of entries, and can fail due to numerical imprecision.\n\nWe already have an `is_hermitian()` for DENSE double matrices, but it is not used for the sparse class, which is its sibling and not a child. A quick way to fix this is to implement the \"naive\" version from the sense class in the sparse class. But a better solution might be to move the \"naive\" algorithm for dense matrices up into the superclass, and just allow the generic method to take a tolerance. If that's stable, it would allow us to avoid reimplementing `is_hermitian()` three times.\n\nWhen this has been fixed, the `# known bug` tags need to be removed from the following tests in `src/sage/matrix/matrix_double_sparse.pyx`:\n\n```\nsage: L = A.cholesky()                    # known bug, 33031        \nsage: (A - L*L.T).norm(1) < 1e-10         # known bug, 33031        \nTrue                                                                \nsage: B = A.change_ring(RR)               # known bug, 33031        \nsage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031\n```\n\n```\nsage: L = A.cholesky()                    # known bug, 33031        \nsage: (A - L*L.H).norm(1) < 1e-10         # known bug, 33031        \nTrue                                                                \nsage: B = A.change_ring(CC)               # known bug, 33031        \nsage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031\n```\n\nCC:  @collares @kliem\n\nBranch/Commit: 4c14a9e36e2780cb2e0b249ca2b83f1ee86a43e6\n\nReviewer: Dima Pasechnik\n\nAuthor: Michael Orlitzky\n\nDependencies: #33023\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33031\n\n",
    "closed_at": "2022-01-01T00:23:22Z",
    "created_at": "2021-12-16T12:33:50Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "add tolerance to is_hermitian() for sparse \"double\" matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33031",
    "user": "https://github.com/orlitzky"
}
```
Discovered in #33023, the implementation of `is_hermitian()` for sparse double matrices is the generic one that tests equality of entries, and can fail due to numerical imprecision.

We already have an `is_hermitian()` for DENSE double matrices, but it is not used for the sparse class, which is its sibling and not a child. A quick way to fix this is to implement the "naive" version from the sense class in the sparse class. But a better solution might be to move the "naive" algorithm for dense matrices up into the superclass, and just allow the generic method to take a tolerance. If that's stable, it would allow us to avoid reimplementing `is_hermitian()` three times.

When this has been fixed, the `# known bug` tags need to be removed from the following tests in `src/sage/matrix/matrix_double_sparse.pyx`:

```
sage: L = A.cholesky()                    # known bug, 33031        
sage: (A - L*L.T).norm(1) < 1e-10         # known bug, 33031        
True                                                                
sage: B = A.change_ring(RR)               # known bug, 33031        
sage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031
```

```
sage: L = A.cholesky()                    # known bug, 33031        
sage: (A - L*L.H).norm(1) < 1e-10         # known bug, 33031        
True                                                                
sage: B = A.change_ring(CC)               # known bug, 33031        
sage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031
```

CC:  @collares @kliem

Branch/Commit: 4c14a9e36e2780cb2e0b249ca2b83f1ee86a43e6

Reviewer: Dima Pasechnik

Author: Michael Orlitzky

Dependencies: #33023

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33031





---

archive/issue_comments_658594.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,20 @@\n \n We already have an `is_hermitian()` for DENSE double matrices, but it is not used for the sparse class, which is its sibling and not a child. A quick way to fix this is to implement the \"naive\" version from the sense class in the sparse class. But a better solution might be to move the \"naive\" algorithm for dense matrices up into the superclass, and just allow the generic method to take a tolerance. If that's stable, it would allow us to avoid reimplementing `is_hermitian()` three times.\n \n+When this has been fixed, the `# known bug` tags need to be removed from the following tests in `src/sage/matrix/matrix_double_sparse.pyx`:\n+\n+```\n+sage: L = A.cholesky()                    # known bug, 33031        \n+sage: (A - L*L.T).norm(1) < 1e-10         # known bug, 33031        \n+True                                                                \n+sage: B = A.change_ring(RR)               # known bug, 33031        \n+sage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031\n+```\n+\n+```\n+sage: L = A.cholesky()                    # known bug, 33031        \n+sage: (A - L*L.H).norm(1) < 1e-10         # known bug, 33031        \n+True                                                                \n+sage: B = A.change_ring(CC)               # known bug, 33031        \n+sage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031\n+```\n``````\n",
    "created_at": "2021-12-16T12:39:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658594",
    "user": "https://github.com/orlitzky"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,20 @@
 
 We already have an `is_hermitian()` for DENSE double matrices, but it is not used for the sparse class, which is its sibling and not a child. A quick way to fix this is to implement the "naive" version from the sense class in the sparse class. But a better solution might be to move the "naive" algorithm for dense matrices up into the superclass, and just allow the generic method to take a tolerance. If that's stable, it would allow us to avoid reimplementing `is_hermitian()` three times.
 
+When this has been fixed, the `# known bug` tags need to be removed from the following tests in `src/sage/matrix/matrix_double_sparse.pyx`:
+
+```
+sage: L = A.cholesky()                    # known bug, 33031        
+sage: (A - L*L.T).norm(1) < 1e-10         # known bug, 33031        
+True                                                                
+sage: B = A.change_ring(RR)               # known bug, 33031        
+sage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031
+```
+
+```
+sage: L = A.cholesky()                    # known bug, 33031        
+sage: (A - L*L.H).norm(1) < 1e-10         # known bug, 33031        
+True                                                                
+sage: B = A.change_ring(CC)               # known bug, 33031        
+sage: (B.cholesky() - L).norm(1) < 1e-10  # known bug, 33031
+```
``````




---

archive/issue_comments_658595.json:
```json
{
    "body": "<a id='comment:2'></a>This also needs to take into account cases with entries such as RBF and CBF, RIF amd CIF.",
    "created_at": "2021-12-16T13:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658595",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>This also needs to take into account cases with entries such as RBF and CBF, RIF amd CIF.



---

archive/issue_comments_658596.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 dimpase]:\n> This also needs to take into account cases with entries such as RBF and CBF, RIF amd CIF.\n\n\n`is_hermitian()` already fails on `RBF` and `RIF` matrices for want of a `conjugate()` method...",
    "created_at": "2021-12-16T13:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658596",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:3'></a>Replying to [comment:2 dimpase]:
> This also needs to take into account cases with entries such as RBF and CBF, RIF amd CIF.


`is_hermitian()` already fails on `RBF` and `RIF` matrices for want of a `conjugate()` method...



---

archive/issue_comments_658597.json:
```json
{
    "body": "<a id='comment:4'></a>Here's a proof-of-concept that attempts to fix sparse RDF/CDF without breaking anything else.\n\n---\nNew commits:",
    "created_at": "2021-12-16T15:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658597",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:4'></a>Here's a proof-of-concept that attempts to fix sparse RDF/CDF without breaking anything else.

---
New commits:



---

archive/issue_comments_658598.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mjo/ticket/33031\"",
    "created_at": "2021-12-16T15:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658598",
    "user": "https://github.com/orlitzky"
}
```

Changing branch from "" to "u/mjo/ticket/33031"



---

archive/issue_comments_658599.json:
```json
{
    "body": "Changing author from \"\" to \"Michael Orlitzky\"",
    "created_at": "2021-12-16T15:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658599",
    "user": "https://github.com/orlitzky"
}
```

Changing author from "" to "Michael Orlitzky"



---

archive/issue_comments_658600.json:
```json
{
    "body": "Changing commit from \"\" to \"1dea31b1f45b51feb2699e0f42d3644ef81f87b4\"",
    "created_at": "2021-12-16T15:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658600",
    "user": "https://github.com/orlitzky"
}
```

Changing commit from "" to "1dea31b1f45b51feb2699e0f42d3644ef81f87b4"



---

archive/issue_comments_658601.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#33023\"",
    "created_at": "2021-12-16T15:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658601",
    "user": "https://github.com/orlitzky"
}
```

Changing dependencies from "" to "#33023"



---

archive/issue_comments_658602.json:
```json
{
    "body": "Changing work_issues from \"\" to \"actually fix is_hermitian() and not just cholesky()\"",
    "created_at": "2021-12-16T17:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658602",
    "user": "https://github.com/orlitzky"
}
```

Changing work_issues from "" to "actually fix is_hermitian() and not just cholesky()"



---

archive/issue_comments_658603.json:
```json
{
    "body": "Changing commit from \"1dea31b1f45b51feb2699e0f42d3644ef81f87b4\" to \"0f04c34500c58cd004b78b0ef5d46ec8962e326b\"",
    "created_at": "2021-12-20T22:06:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658603",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1dea31b1f45b51feb2699e0f42d3644ef81f87b4" to "0f04c34500c58cd004b78b0ef5d46ec8962e326b"



---

archive/issue_comments_658604.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-12-20T22:06:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658604",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_658605.json:
```json
{
    "body": "Changing work_issues from \"actually fix is_hermitian() and not just cholesky()\" to \"\"",
    "created_at": "2021-12-20T22:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658605",
    "user": "https://github.com/orlitzky"
}
```

Changing work_issues from "actually fix is_hermitian() and not just cholesky()" to ""



---

archive/issue_comments_658606.json:
```json
{
    "body": "<a id='comment:8'></a>I've also fixed `is_skew_hermitian()`, since doing so is trivial. First things first: can someone confirm that my tolerance of `1e-12` is large enough to avoid the issue on aarch64 (or wherever the problem was observed)?\n\nThis is only a minimal refactoring to address the immediate problem. I've opened #33053 to track the larger issue.",
    "created_at": "2021-12-20T22:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658606",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:8'></a>I've also fixed `is_skew_hermitian()`, since doing so is trivial. First things first: can someone confirm that my tolerance of `1e-12` is large enough to avoid the issue on aarch64 (or wherever the problem was observed)?

This is only a minimal refactoring to address the immediate problem. I've opened #33053 to track the larger issue.



---

archive/issue_comments_658607.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-12-20T22:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658607",
    "user": "https://github.com/orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_658608.json:
```json
{
    "body": "<a id='comment:9'></a>The test runs a little further, but fails after the `change_ring` call:\n\n```\nsage: n = ZZ.random_element(1,5)\n....: A = matrix.random(CDF, n, sparse=True)\n....: I = matrix.identity(CDF, n, sparse=True)\n....: A = A*A.conjugate_transpose() + I\n....: L = A.cholesky()\n....: assert (A - L*L.H).norm(1) < 1e-10\n....: B = A.change_ring(CC)\n....: assert (B.cholesky() - L).norm(1) < 1e-10\n....: \n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-4-193612c9eade> in <module>\n      6 assert (A - L*L.H).norm(Integer(1)) < RealNumber('1e-10')\n      7 B = A.change_ring(CC)\n----> 8 assert (B.cholesky() - L).norm(Integer(1)) < RealNumber('1e-10')\n\n/nix/store/zqyv54wwjaal14k1skabdk9ch6rr6v6r-python3-3.9.6-env/lib/python3.9/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.cholesky (build/cythonized/sage/matrix/matrix2.c:84977)()\n  12631 \n  12632         if not self.is_hermitian():\n> 12633             raise ValueError(\"matrix is not Hermitian\")\n  12634 \n  12635         # Use classical=True to ensure that we don't get a permuted L.\n\nValueError: matrix is not Hermitian\nsage: A\n[ 3.229039802593019 + 1.6322627083148353e-17*I  -0.021330037612755842 - 1.3824367515761828*I    0.18142736612755045 + 0.5825316936751774*I]\n[ -0.021330037612755842 + 1.3824367515761828*I 4.0201724676288855 - 1.6208942612402586e-17*I    -0.2251207850381418 - 1.1919564519572095*I]\n[   0.18142736612755045 - 0.5825316936751775*I    -0.2251207850381418 + 1.1919564519572095*I  1.9658297004722771 - 2.185885234400264e-17*I]\nsage: B\n[3.22903980259302 + 1.63226270831484e-17*I  -0.0213300376127558 - 1.38243675157618*I   0.181427366127550 + 0.582531693675177*I]\n[ -0.0213300376127558 + 1.38243675157618*I 4.02017246762889 - 1.62089426124026e-17*I   -0.225120785038142 - 1.19195645195721*I]\n[  0.181427366127550 - 0.582531693675178*I   -0.225120785038142 + 1.19195645195721*I 1.96582970047228 - 2.18588523440026e-17*I]\n```\n\nThis does not seem to be due to the tolerance, though, because `(B - B.H).norm(1)` is `1.5474000715052094e-16`.",
    "created_at": "2021-12-21T19:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658608",
    "user": "https://github.com/collares"
}
```

<a id='comment:9'></a>The test runs a little further, but fails after the `change_ring` call:

```
sage: n = ZZ.random_element(1,5)
....: A = matrix.random(CDF, n, sparse=True)
....: I = matrix.identity(CDF, n, sparse=True)
....: A = A*A.conjugate_transpose() + I
....: L = A.cholesky()
....: assert (A - L*L.H).norm(1) < 1e-10
....: B = A.change_ring(CC)
....: assert (B.cholesky() - L).norm(1) < 1e-10
....: 
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-4-193612c9eade> in <module>
      6 assert (A - L*L.H).norm(Integer(1)) < RealNumber('1e-10')
      7 B = A.change_ring(CC)
----> 8 assert (B.cholesky() - L).norm(Integer(1)) < RealNumber('1e-10')

/nix/store/zqyv54wwjaal14k1skabdk9ch6rr6v6r-python3-3.9.6-env/lib/python3.9/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.cholesky (build/cythonized/sage/matrix/matrix2.c:84977)()
  12631 
  12632         if not self.is_hermitian():
> 12633             raise ValueError("matrix is not Hermitian")
  12634 
  12635         # Use classical=True to ensure that we don't get a permuted L.

ValueError: matrix is not Hermitian
sage: A
[ 3.229039802593019 + 1.6322627083148353e-17*I  -0.021330037612755842 - 1.3824367515761828*I    0.18142736612755045 + 0.5825316936751774*I]
[ -0.021330037612755842 + 1.3824367515761828*I 4.0201724676288855 - 1.6208942612402586e-17*I    -0.2251207850381418 - 1.1919564519572095*I]
[   0.18142736612755045 - 0.5825316936751775*I    -0.2251207850381418 + 1.1919564519572095*I  1.9658297004722771 - 2.185885234400264e-17*I]
sage: B
[3.22903980259302 + 1.63226270831484e-17*I  -0.0213300376127558 - 1.38243675157618*I   0.181427366127550 + 0.582531693675177*I]
[ -0.0213300376127558 + 1.38243675157618*I 4.02017246762889 - 1.62089426124026e-17*I   -0.225120785038142 - 1.19195645195721*I]
[  0.181427366127550 - 0.582531693675178*I   -0.225120785038142 + 1.19195645195721*I 1.96582970047228 - 2.18588523440026e-17*I]
```

This does not seem to be due to the tolerance, though, because `(B - B.H).norm(1)` is `1.5474000715052094e-16`.



---

archive/issue_comments_658609.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-21T20:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_658610.json:
```json
{
    "body": "Changing commit from \"0f04c34500c58cd004b78b0ef5d46ec8962e326b\" to \"4c14a9e36e2780cb2e0b249ca2b83f1ee86a43e6\"",
    "created_at": "2021-12-21T20:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658610",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0f04c34500c58cd004b78b0ef5d46ec8962e326b" to "4c14a9e36e2780cb2e0b249ca2b83f1ee86a43e6"



---

archive/issue_comments_658611.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:9 gh-collares]:\n> The test runs a little further, but fails after the `change_ring` call:\n> \n\n\nArgh, of course, you're now hitting the same problem over `RR` and `CC`, which we use to check the answer. Thankfully those aren't crucial to the process. I just pushed another commit that checks the answer against the dense RDF/CDF factorization instead, which will use a different but supposedly stable `is_hermitian()`, but the same `cholesky()` that we had with RR/CC.",
    "created_at": "2021-12-21T20:44:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658611",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:11'></a>Replying to [comment:9 gh-collares]:
> The test runs a little further, but fails after the `change_ring` call:
> 


Argh, of course, you're now hitting the same problem over `RR` and `CC`, which we use to check the answer. Thankfully those aren't crucial to the process. I just pushed another commit that checks the answer against the dense RDF/CDF factorization instead, which will use a different but supposedly stable `is_hermitian()`, but the same `cholesky()` that we had with RR/CC.



---

archive/issue_comments_658612.json:
```json
{
    "body": "<a id='comment:12'></a>`matrix_double_sparse.pyx` passes now. Thanks!",
    "created_at": "2021-12-21T22:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658612",
    "user": "https://github.com/collares"
}
```

<a id='comment:12'></a>`matrix_double_sparse.pyx` passes now. Thanks!



---

archive/issue_comments_658613.json:
```json
{
    "body": "<a id='comment:13'></a>I would have kept `skew = False` as the default.\n\n```\n-    def _is_hermitian(self, skew = False):\n+    def _is_hermitian(self, skew, tolerance):\n```",
    "created_at": "2021-12-23T10:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658613",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>I would have kept `skew = False` as the default.

```
-    def _is_hermitian(self, skew = False):
+    def _is_hermitian(self, skew, tolerance):
```



---

archive/issue_comments_658614.json:
```json
{
    "body": "<a id='comment:14'></a>maybe a default for tolerance may be set, too.",
    "created_at": "2021-12-23T15:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658614",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>maybe a default for tolerance may be set, too.



---

archive/issue_comments_658615.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:13 dimpase]:\n> I would have kept `skew = False` as the default.\n> \n> ```\n> -    def _is_hermitian(self, skew = False):\n> +    def _is_hermitian(self, skew, tolerance):\n> ```\n\n\nThis is mainly a style choice since it's an internal function and users won't be annoyed by the extra parameter. I think it's kind of nice to see the symmetry/contrast between uses of the internal function in the user-facing ones. i.e.:\n\n```python\n# in the superclass\ndef is_hermitian(self):\n    return self._is_hermitian(skew=False, tolerance=0)\ndef is_skew_hermitian(self):\n    return self._is_hermitian(skew=True, tolerance=0)\n# in the subclass\ndef is_hermitian(self, tolerance=1e-12):\n    return self._is_hermitian(skew=False, tolerance=tolerance)\ndef is_skew_hermitian(self, tolerance=1e-12):\n    return self._is_hermitian(skew=True, tolerance=tolerance)\n```\n\nThe user-facing method always knows the value of the `skew` parameter, so there's never any real need to \"default\" it. Doing so would only save a total of five characters. The tolerance parameter is similar... a default of zero would work now, but would be superfluous when we finish making the tolerance (in the superclass) user-facing in #33053.",
    "created_at": "2021-12-24T12:56:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658615",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:15'></a>Replying to [comment:13 dimpase]:
> I would have kept `skew = False` as the default.
> 
> ```
> -    def _is_hermitian(self, skew = False):
> +    def _is_hermitian(self, skew, tolerance):
> ```


This is mainly a style choice since it's an internal function and users won't be annoyed by the extra parameter. I think it's kind of nice to see the symmetry/contrast between uses of the internal function in the user-facing ones. i.e.:

```python
# in the superclass
def is_hermitian(self):
    return self._is_hermitian(skew=False, tolerance=0)
def is_skew_hermitian(self):
    return self._is_hermitian(skew=True, tolerance=0)
# in the subclass
def is_hermitian(self, tolerance=1e-12):
    return self._is_hermitian(skew=False, tolerance=tolerance)
def is_skew_hermitian(self, tolerance=1e-12):
    return self._is_hermitian(skew=True, tolerance=tolerance)
```

The user-facing method always knows the value of the `skew` parameter, so there's never any real need to "default" it. Doing so would only save a total of five characters. The tolerance parameter is similar... a default of zero would work now, but would be superfluous when we finish making the tolerance (in the superclass) user-facing in #33053.



---

archive/issue_comments_658616.json:
```json
{
    "body": "<a id='comment:16'></a>ok",
    "created_at": "2021-12-24T14:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658616",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>ok



---

archive/issue_comments_658617.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2021-12-24T14:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658617",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_658618.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-24T14:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658618",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_087285.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-01T00:23:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33031#event-87285"
}
```



---

archive/issue_comments_658619.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-01-01T00:23:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658619",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_658620.json:
```json
{
    "body": "Changing branch from \"u/mjo/ticket/33031\" to \"4c14a9e36e2780cb2e0b249ca2b83f1ee86a43e6\"",
    "created_at": "2022-01-01T00:23:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33031#issuecomment-658620",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mjo/ticket/33031" to "4c14a9e36e2780cb2e0b249ca2b83f1ee86a43e6"
