# Issue 33382: Improve handling of default arguments in interacts library

archive/issues_033145.json:
```json
{
    "assignees": [],
    "body": "While working on using pytest for doctesting, I encountered the following error, which is triggered by the import of `interacts.all`:\n\n```\nsage/interacts/all.py:20: in <module>\nfrom . import calculus\nsage/interacts/calculus.py:19: in <module>\nfrom .library import taylor_polynomial\nsage/interacts/library.py:1030: in <module>\ninterval_g = input_grid(1,2,default=[[0,8]], label=\"keyboard: \"),\nsage/repl/ipython_kernel/widgets_sagenb.py:559: in input_grid\ngrid = Grid(nrows, ncols, make_widget, **kwds)\nsage/repl/ipython_kernel/widgets.py:430: in init\nself._update()\nsage/repl/ipython_kernel/widgets.py:456: in _update\nv[i].append(col.children[i].get_interact_value())\nsage/repl/ipython_kernel/widgets.py:154: in get_interact_value\nv = self.get_value()\nsage/repl/ipython_kernel/widgets.py:196: in get_value\nreturn sage_eval(self.value, get_globals())\nsage/repl/user_globals.py:99: in get_globals\n_check()\nsage/repl/user_globals.py:82: in _check\nraise RuntimeError(\nE RuntimeError: the user-space globals dictionary has not been initialized. Use initialize_globals() or set_globals() or use a different function which doesn't need these globals\n```\nThe reason for this error is that `interacts.all` imports `interacts/library`, which contains a few methods whose default arguments call methods that have sideeffects (or at least require a certain initialization to happen first). This is fixed by moving the default argument calculation to a lambda callable which is only invoked once the function is executed. As part of this, the `library_interact` decorator is converted to a decorator factory that accepts the interaction widget as parameter. This aligns it with the `interact` decorator of ipwidgets (see https://ipywidgets.readthedocs.io/en/latest/examples/Using%20Interact.html#Basic-interact, example 6).  As a nice plus, the startup time of sage is minimally decreased as importing `interacts.all` is now less involved.\n\nCC:  @mkoeppe @fchapoton @slel @kwankyu\n\nBranch/Commit: **[`fdd51be`](https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540)**\n\nReviewer: **Matthias Koeppe**\n\nAuthor: **Tobias Diez**\n\nComponent: **interact**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/33382_\n\n",
    "closed_at": "2022-05-20T22:27:17Z",
    "created_at": "2022-02-19T19:45:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interact",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve handling of default arguments in interacts library",
    "type": "issue",
    "updated_at": "2022-05-20T22:27:17Z",
    "url": "https://github.com/sagemath/sage/issues/33382",
    "user": "https://github.com/tobiasdiez"
}
```
While working on using pytest for doctesting, I encountered the following error, which is triggered by the import of `interacts.all`:

```
sage/interacts/all.py:20: in <module>
from . import calculus
sage/interacts/calculus.py:19: in <module>
from .library import taylor_polynomial
sage/interacts/library.py:1030: in <module>
interval_g = input_grid(1,2,default=[[0,8]], label="keyboard: "),
sage/repl/ipython_kernel/widgets_sagenb.py:559: in input_grid
grid = Grid(nrows, ncols, make_widget, **kwds)
sage/repl/ipython_kernel/widgets.py:430: in init
self._update()
sage/repl/ipython_kernel/widgets.py:456: in _update
v[i].append(col.children[i].get_interact_value())
sage/repl/ipython_kernel/widgets.py:154: in get_interact_value
v = self.get_value()
sage/repl/ipython_kernel/widgets.py:196: in get_value
return sage_eval(self.value, get_globals())
sage/repl/user_globals.py:99: in get_globals
_check()
sage/repl/user_globals.py:82: in _check
raise RuntimeError(
E RuntimeError: the user-space globals dictionary has not been initialized. Use initialize_globals() or set_globals() or use a different function which doesn't need these globals
```
The reason for this error is that `interacts.all` imports `interacts/library`, which contains a few methods whose default arguments call methods that have sideeffects (or at least require a certain initialization to happen first). This is fixed by moving the default argument calculation to a lambda callable which is only invoked once the function is executed. As part of this, the `library_interact` decorator is converted to a decorator factory that accepts the interaction widget as parameter. This aligns it with the `interact` decorator of ipwidgets (see https://ipywidgets.readthedocs.io/en/latest/examples/Using%20Interact.html#Basic-interact, example 6).  As a nice plus, the startup time of sage is minimally decreased as importing `interacts.all` is now less involved.

CC:  @mkoeppe @fchapoton @slel @kwankyu

Branch/Commit: **[`fdd51be`](https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540)**

Reviewer: **Matthias Koeppe**

Author: **Tobias Diez**

Component: **interact**

_Issue created by migration from https://trac.sagemath.org/ticket/33382_





---

archive/issue_events_458838.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-19T19:45:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458838"
}
```



---

archive/issue_events_458839.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-19T19:45:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interact",
    "label_color": "0000ff",
    "label_name": "c: interact",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458839"
}
```



---

archive/issue_events_458840.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-19T19:45:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458840"
}
```



---

archive/issue_events_458841.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-19T19:45:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458841"
}
```



---

archive/issue_events_458842.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-19T19:46:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458842"
}
```



---

archive/issue_comments_539520.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nLooks like you made all default arguments 1-element tuples, that's probably from copy+paste+black",
    "created_at": "2022-02-19T20:24:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539520",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Looks like you made all default arguments 1-element tuples, that's probably from copy+paste+black



---

archive/issue_events_458843.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-19T20:24:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458843"
}
```



---

archive/issue_events_458844.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-19T20:24:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458844"
}
```



---

archive/issue_comments_539521.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/177b365f3a61137a7c6aad965ee6399d2cbea5fd\">177b365</a></td><td><code>Fix single-object tuple > object</code></td></tr></table>\n",
    "created_at": "2022-02-23T22:46:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539521",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/177b365f3a61137a7c6aad965ee6399d2cbea5fd">177b365</a></td><td><code>Fix single-object tuple > object</code></td></tr></table>




---

archive/issue_comments_539522.json:
```json
{
    "body": "Changed commit from **[`eceee99`](https://github.com/sagemath/sagetrac-mirror/commit/eceee9990a556fe5a1f377c695fb4b2294150d1b)** to **[`177b365`](https://github.com/sagemath/sagetrac-mirror/commit/177b365f3a61137a7c6aad965ee6399d2cbea5fd)**",
    "created_at": "2022-02-23T22:46:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539522",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`eceee99`](https://github.com/sagemath/sagetrac-mirror/commit/eceee9990a556fe5a1f377c695fb4b2294150d1b)** to **[`177b365`](https://github.com/sagemath/sagetrac-mirror/commit/177b365f3a61137a7c6aad965ee6399d2cbea5fd)**



---

archive/issue_comments_539523.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThanks for spotting this. Was indeed a stupid copy & paste error.",
    "created_at": "2022-02-23T22:46:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539523",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:4" align="right">comment:4</div>

Thanks for spotting this. Was indeed a stupid copy & paste error.



---

archive/issue_events_458845.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-23T22:46:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458845"
}
```



---

archive/issue_events_458846.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-23T22:46:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458846"
}
```



---

archive/issue_comments_539524.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nPatchbot shows failures",
    "created_at": "2022-02-24T02:25:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539524",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Patchbot shows failures



---

archive/issue_events_458847.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-24T02:25:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458847"
}
```



---

archive/issue_events_458848.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-24T02:25:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458848"
}
```



---

archive/issue_comments_539525.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d68c4a1781aba8d2d8ab5f072e6515c3a94b291\">1d68c4a</a></td><td><code>Merge remote-tracking branch 'origin/develop' into public/interacts/remove_import_calls</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d747e1d493f6de1949088a623191a0f2de439d73\">d747e1d</a></td><td><code>Convert to decorator factory</code></td></tr></table>\n",
    "created_at": "2022-03-01T12:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539525",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d68c4a1781aba8d2d8ab5f072e6515c3a94b291">1d68c4a</a></td><td><code>Merge remote-tracking branch 'origin/develop' into public/interacts/remove_import_calls</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d747e1d493f6de1949088a623191a0f2de439d73">d747e1d</a></td><td><code>Convert to decorator factory</code></td></tr></table>




---

archive/issue_comments_539526.json:
```json
{
    "body": "Changed commit from **[`177b365`](https://github.com/sagemath/sagetrac-mirror/commit/177b365f3a61137a7c6aad965ee6399d2cbea5fd)** to **[`d747e1d`](https://github.com/sagemath/sagetrac-mirror/commit/d747e1d493f6de1949088a623191a0f2de439d73)**",
    "created_at": "2022-03-01T12:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539526",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`177b365`](https://github.com/sagemath/sagetrac-mirror/commit/177b365f3a61137a7c6aad965ee6399d2cbea5fd)** to **[`d747e1d`](https://github.com/sagemath/sagetrac-mirror/commit/d747e1d493f6de1949088a623191a0f2de439d73)**



---

archive/issue_comments_539527.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nShould work now.",
    "created_at": "2022-03-01T12:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539527",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:7" align="right">comment:7</div>

Should work now.



---

archive/issue_events_458849.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-01T12:57:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458849"
}
```



---

archive/issue_events_458850.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-01T12:57:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458850"
}
```



---

archive/issue_comments_539528.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,4 +23,4 @@\n raise RuntimeError(\n E RuntimeError: the user-space globals dictionary has not been initialized. Use initialize_globals() or set_globals() or use a different function which doesn't need these globals\n ```\n-The reason for this error is that `interacts.all` imports `interacts/library`, which contains a few methods whose default arguments call methods that have sideeffects (or at least require a certain initialization to happen first). This is fixed by moving the default argument calculation to the body of the method, which I would say is good practice anyway for more involved default arguments. As a nice plus, the startup time of sage is minimally decreased as importing `interacts.all` is now less involved.\n+The reason for this error is that `interacts.all` imports `interacts/library`, which contains a few methods whose default arguments call methods that have sideeffects (or at least require a certain initialization to happen first). This is fixed by moving the default argument calculation to a lambda callable which is only invoked once the function is executed. As part of this, the `library_interact` decorator is converted to a decorator factory that accepts the interaction widget as parameter. This aligns it with the `interact` decorator of ipwidgets (see https://ipywidgets.readthedocs.io/en/latest/examples/Using%20Interact.html#Basic-interact, example 6).  As a nice plus, the startup time of sage is minimally decreased as importing `interacts.all` is now less involved.\n``````\n",
    "created_at": "2022-03-01T12:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539528",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,4 +23,4 @@
 raise RuntimeError(
 E RuntimeError: the user-space globals dictionary has not been initialized. Use initialize_globals() or set_globals() or use a different function which doesn't need these globals
 ```
-The reason for this error is that `interacts.all` imports `interacts/library`, which contains a few methods whose default arguments call methods that have sideeffects (or at least require a certain initialization to happen first). This is fixed by moving the default argument calculation to the body of the method, which I would say is good practice anyway for more involved default arguments. As a nice plus, the startup time of sage is minimally decreased as importing `interacts.all` is now less involved.
+The reason for this error is that `interacts.all` imports `interacts/library`, which contains a few methods whose default arguments call methods that have sideeffects (or at least require a certain initialization to happen first). This is fixed by moving the default argument calculation to a lambda callable which is only invoked once the function is executed. As part of this, the `library_interact` decorator is converted to a decorator factory that accepts the interaction widget as parameter. This aligns it with the `interact` decorator of ipwidgets (see https://ipywidgets.readthedocs.io/en/latest/examples/Using%20Interact.html#Basic-interact, example 6).  As a nice plus, the startup time of sage is minimally decreased as importing `interacts.all` is now less involved.
``````




---

archive/issue_comments_539529.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n`@library_interact` is part of the public API; can it still be used in the old way?",
    "created_at": "2022-03-01T17:31:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539529",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

`@library_interact` is part of the public API; can it still be used in the old way?



---

archive/issue_comments_539530.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@mkoeppe](#comment:8):\n> `@library_interact` is part of the public API; can it still be used in the old way?\n\nNo, I couldn't come up with a way that would be backwards compatible. I think this shouldn't really be a problem since it's clearly a local helper method (and should probably not even be exposed).",
    "created_at": "2022-03-01T18:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539530",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@mkoeppe](#comment:8):
> `@library_interact` is part of the public API; can it still be used in the old way?

No, I couldn't come up with a way that would be backwards compatible. I think this shouldn't really be a problem since it's clearly a local helper method (and should probably not even be exposed).



---

archive/issue_comments_539531.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nIt's public API. If you can't keep it compatible, create a function with a new name and deprecate the old function.",
    "created_at": "2022-03-01T18:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539531",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

It's public API. If you can't keep it compatible, create a function with a new name and deprecate the old function.



---

archive/issue_comments_539532.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAny suggestions for a good new name?",
    "created_at": "2022-03-01T19:10:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539532",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:11" align="right">comment:11</div>

Any suggestions for a good new name?



---

archive/issue_comments_539533.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53ed8d19b64cb96f533162908266f795fcf1f314\">53ed8d1</a></td><td><code>Add backwards compatibility</code></td></tr></table>\n",
    "created_at": "2022-03-02T12:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539533",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53ed8d19b64cb96f533162908266f795fcf1f314">53ed8d1</a></td><td><code>Add backwards compatibility</code></td></tr></table>




---

archive/issue_comments_539534.json:
```json
{
    "body": "Changed commit from **[`d747e1d`](https://github.com/sagemath/sagetrac-mirror/commit/d747e1d493f6de1949088a623191a0f2de439d73)** to **[`53ed8d1`](https://github.com/sagemath/sagetrac-mirror/commit/53ed8d19b64cb96f533162908266f795fcf1f314)**",
    "created_at": "2022-03-02T12:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539534",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d747e1d`](https://github.com/sagemath/sagetrac-mirror/commit/d747e1d493f6de1949088a623191a0f2de439d73)** to **[`53ed8d1`](https://github.com/sagemath/sagetrac-mirror/commit/53ed8d19b64cb96f533162908266f795fcf1f314)**



---

archive/issue_comments_539535.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@mkoeppe](#comment:8):\n> `@library_interact` is part of the public API; can it still be used in the old way?\n\nI've now found a way to add backwards compatibility of the `library_interact` decorator.",
    "created_at": "2022-03-02T12:15:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539535",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@mkoeppe](#comment:8):
> `@library_interact` is part of the public API; can it still be used in the old way?

I've now found a way to add backwards compatibility of the `library_interact` decorator.



---

archive/issue_comments_539536.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI think this test block needs a blank line here:\n\n```diff\n     TESTS:\n+\n     Backwards compatibility::\n```",
    "created_at": "2022-03-02T14:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539536",
    "user": "https://github.com/slel"
}
```

<div id="comment:15" align="right">comment:15</div>

I think this test block needs a blank line here:

```diff
     TESTS:
+
     Backwards compatibility::
```



---

archive/issue_comments_539537.json:
```json
{
    "body": "Changed commit from **[`53ed8d1`](https://github.com/sagemath/sagetrac-mirror/commit/53ed8d19b64cb96f533162908266f795fcf1f314)** to **[`fdd51be`](https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540)**",
    "created_at": "2022-03-02T16:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539537",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`53ed8d1`](https://github.com/sagemath/sagetrac-mirror/commit/53ed8d19b64cb96f533162908266f795fcf1f314)** to **[`fdd51be`](https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540)**



---

archive/issue_comments_539538.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540\">fdd51be</a></td><td><code>Add newline</code></td></tr></table>\n",
    "created_at": "2022-03-02T16:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539538",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540">fdd51be</a></td><td><code>Add newline</code></td></tr></table>




---

archive/issue_comments_539539.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThanks, fixed!\n\nBtw, is it on purpose that there doesn't exist an entry for `interacts` in the documentation?",
    "created_at": "2022-03-02T16:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539539",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:17" align="right">comment:17</div>

Thanks, fixed!

Btw, is it on purpose that there doesn't exist an entry for `interacts` in the documentation?



---

archive/issue_comments_539540.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nBased on [a quick websearch](https://duckduckgo.com/?q=interact+site%3Adoc.sagemath.org),\nit seems there are two documents:\n\n- [SageMath reference manual: Interacts for the Sage Jupyter notebook](https://doc.sagemath.org/html/en/reference/repl/sage/repl/ipython_kernel/interact.html)\n- [SageMath tutorials: Sage Interact Quickstart](https://doc.sagemath.org/html/en/prep/Quickstarts/Interact.html)",
    "created_at": "2022-03-02T16:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539540",
    "user": "https://github.com/slel"
}
```

<div id="comment:18" align="right">comment:18</div>

Based on [a quick websearch](https://duckduckgo.com/?q=interact+site%3Adoc.sagemath.org),
it seems there are two documents:

- [SageMath reference manual: Interacts for the Sage Jupyter notebook](https://doc.sagemath.org/html/en/reference/repl/sage/repl/ipython_kernel/interact.html)
- [SageMath tutorials: Sage Interact Quickstart](https://doc.sagemath.org/html/en/prep/Quickstarts/Interact.html)



---

archive/issue_comments_539541.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOne can also inspect the output of\n\n```\nsage: search_src('interact')\nsage: search_doc('interact')\nsage: search_def('interact')\n```",
    "created_at": "2022-03-02T16:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539541",
    "user": "https://github.com/slel"
}
```

<div id="comment:19" align="right">comment:19</div>

One can also inspect the output of

```
sage: search_src('interact')
sage: search_doc('interact')
sage: search_def('interact')
```



---

archive/issue_comments_539542.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@slel](#comment:18):\n> Based on [a quick websearch](https://duckduckgo.com/?q=interact+site%3Adoc.sagemath.org),\n> it seems there are two documents:\n> \n> - [SageMath reference manual: Interacts for the Sage Jupyter notebook](https://doc.sagemath.org/html/en/reference/repl/sage/repl/ipython_kernel/interact.html)\n> - [SageMath tutorials: Sage Interact Quickstart](https://doc.sagemath.org/html/en/prep/Quickstarts/Interact.html)\n\nThanks! What I meant is that there is no entry under the \"Reference manual\" https://doc.sagemath.org/html/en/reference/index.html",
    "created_at": "2022-03-02T16:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539542",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@slel](#comment:18):
> Based on [a quick websearch](https://duckduckgo.com/?q=interact+site%3Adoc.sagemath.org),
> it seems there are two documents:
> 
> - [SageMath reference manual: Interacts for the Sage Jupyter notebook](https://doc.sagemath.org/html/en/reference/repl/sage/repl/ipython_kernel/interact.html)
> - [SageMath tutorials: Sage Interact Quickstart](https://doc.sagemath.org/html/en/prep/Quickstarts/Interact.html)

Thanks! What I meant is that there is no entry under the "Reference manual" https://doc.sagemath.org/html/en/reference/index.html



---

archive/issue_comments_539543.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nTrue, that page has a section \"User interfaces\" with two headings:\n\n- \"Command Line Interface\", which under \"Miscellaneous\" has links to\n  \"Interacts\", \"Widgets\", and a few other Jupyter-related things\n- \"Jupyter Notebook Interface\", which points straight to the official\n  Jupyter Notebook documentation\n\nThat could probably be improved.",
    "created_at": "2022-03-02T16:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539543",
    "user": "https://github.com/slel"
}
```

<div id="comment:21" align="right">comment:21</div>

True, that page has a section "User interfaces" with two headings:

- "Command Line Interface", which under "Miscellaneous" has links to
  "Interacts", "Widgets", and a few other Jupyter-related things
- "Jupyter Notebook Interface", which points straight to the official
  Jupyter Notebook documentation

That could probably be improved.



---

archive/issue_comments_539544.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWondering if the use of `lambda` is going to create a problem for pickling the interacts.\nBut it looks like this may already be broken for stock ipywidgets interacts -  https://github.com/jupyter-widgets/ipywidgets/issues/2879",
    "created_at": "2022-03-04T05:52:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539544",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Wondering if the use of `lambda` is going to create a problem for pickling the interacts.
But it looks like this may already be broken for stock ipywidgets interacts -  https://github.com/jupyter-widgets/ipywidgets/issues/2879



---

archive/issue_comments_539545.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@slel](#comment:21):\n> That could probably be improved.\n\nThanks for the clarification, let's do this in a follow-up ticket.\n\nAnything else to do here?",
    "created_at": "2022-03-20T17:53:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539545",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@slel](#comment:21):
> That could probably be improved.

Thanks for the clarification, let's do this in a follow-up ticket.

Anything else to do here?



---

archive/issue_comments_539546.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nPing",
    "created_at": "2022-04-08T21:25:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539546",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:24" align="right">comment:24</div>

Ping



---

archive/issue_events_458851.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458851"
}
```



---

archive/issue_events_458852.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458852"
}
```



---

archive/issue_comments_539547.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nCould this ticket please be reviewed? Thanks!",
    "created_at": "2022-05-08T09:13:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539547",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:26" align="right">comment:26</div>

Could this ticket please be reviewed? Thanks!



---

archive/issue_comments_539548.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nLGTM",
    "created_at": "2022-05-08T12:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539548",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

LGTM



---

archive/issue_events_458853.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-08T12:51:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458853"
}
```



---

archive/issue_events_458854.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-08T12:51:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458854"
}
```



---

archive/issue_comments_539549.json:
```json
{
    "body": "Reviewer: **Matthias Koeppe**",
    "created_at": "2022-05-08T12:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539549",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Matthias Koeppe**



---

archive/issue_comments_539550.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThanks!",
    "created_at": "2022-05-08T21:01:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539550",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:28" align="right">comment:28</div>

Thanks!



---

archive/issue_comments_539551.json:
```json
{
    "body": "Changed branch from **[public/interacts/remove_import_calls](https://github.com/sagemath/sagetrac-mirror/tree/public/interacts/remove_import_calls)** to **[`fdd51be`](https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540)**",
    "created_at": "2022-05-20T22:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/33382#issuecomment-539551",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/interacts/remove_import_calls](https://github.com/sagemath/sagetrac-mirror/tree/public/interacts/remove_import_calls)** to **[`fdd51be`](https://github.com/sagemath/sagetrac-mirror/commit/fdd51be76399035a88c9a5944c96b60b7411a540)**



---

archive/issue_events_458855.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-05-20T22:27:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458855"
}
```



---

archive/issue_events_458856.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4d136aad12ec591f839ac179f12388164e71d0ac",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-05-20T22:27:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/33382",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/33382#event-458856"
}
```
