# Issue 33789: sage-dist-helpers (sdh_pip_install): Change default to --build-isolation

archive/issues_033552.json:
```json
{
    "body": "... hence, provisioning the build environment for each package from the stored wheels. \n\nThis gets us another step closer to using modern Python packaging infrastructure. It will make the build process more robust because it avoids concurrent read and write access to `site-packages`.\n\nIf it fails, it falls back the old behavior (`--no-build-isolation`) and issues a warning.\n\n\nCC:  @jhpalmieri\n\nBranch/Commit: 378d704ec64ba94161117e0f4a1437d3249080d8\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/33789\n\n",
    "closed_at": "2022-07-09T22:33:41Z",
    "created_at": "2022-05-03T02:14:42Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "sage-dist-helpers (sdh_pip_install): Change default to --build-isolation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33789",
    "user": "https://github.com/mkoeppe"
}
```
... hence, provisioning the build environment for each package from the stored wheels. 

This gets us another step closer to using modern Python packaging infrastructure. It will make the build process more robust because it avoids concurrent read and write access to `site-packages`.

If it fails, it falls back the old behavior (`--no-build-isolation`) and issues a warning.


CC:  @jhpalmieri

Branch/Commit: 378d704ec64ba94161117e0f4a1437d3249080d8

Reviewer: John Palmieri

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/33789





---

archive/issue_comments_510177.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-06-29T01:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_510178.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,9 @@\n ... hence, provisioning the build environment for each package from the stored wheels. \n \n-Fallback will be to `--no-build-isolation --no-deps`.\n+This gets us another step closer to using modern Python packaging infrastructure. It will make the build process more robust because it avoids concurrent read and write access to `site-packages`.\n+\n+If it fails, it falls back the old behavior (`--no-build-isolation`) and issues a warning.\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2022-06-29T01:48:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510178",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,9 @@
 ... hence, provisioning the build environment for each package from the stored wheels. 
 
-Fallback will be to `--no-build-isolation --no-deps`.
+This gets us another step closer to using modern Python packaging infrastructure. It will make the build process more robust because it avoids concurrent read and write access to `site-packages`.
+
+If it fails, it falls back the old behavior (`--no-build-isolation`) and issues a warning.
+
 
 Comment: 1
 
```




---

archive/issue_comments_510179.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-29T01:48:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510179",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_510180.json:
```json
{
    "body": "<a id='comment:5'></a>Why does `tomli` require `no-build-isolation`? Also, a comment like \"Our new default\" is going to become dated. Maybe \"The default as of Sage 9.7\" instead?",
    "created_at": "2022-07-06T17:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510180",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>Why does `tomli` require `no-build-isolation`? Also, a comment like "Our new default" is going to become dated. Maybe "The default as of Sage 9.7" instead?



---

archive/issue_comments_510181.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-06T17:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510181",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510182.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-06T17:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_510183.json:
```json
{
    "body": "<a id='comment:8'></a>To clarify, build with isolation is the default in `pip`, right? So it makes sense for us to switch to this, except in cases where necessary. If that's correct, feel free to set to \"positive review\" on my behalf.\n\n(Sage builds, including lots of optional packages, with this branch.)",
    "created_at": "2022-07-08T04:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510183",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>To clarify, build with isolation is the default in `pip`, right? So it makes sense for us to switch to this, except in cases where necessary. If that's correct, feel free to set to "positive review" on my behalf.

(Sage builds, including lots of optional packages, with this branch.)



---

archive/issue_comments_510184.json:
```json
{
    "body": "<a id='comment:9'></a>Yes, it's the default in pip.",
    "created_at": "2022-07-08T04:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510184",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Yes, it's the default in pip.



---

archive/issue_comments_510185.json:
```json
{
    "body": "<a id='comment:10'></a>Thanks!",
    "created_at": "2022-07-08T04:20:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510185",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Thanks!



---

archive/issue_comments_510186.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-08T04:20:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510186",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_510187.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-09T22:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33789#issuecomment-510187",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_088766.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:33:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33789",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33789#event-88766"
}
```
