# Issue 34211: Put tensor modules of FiniteRankFreeModule in Modules().TensorProducts()

Issue created by migration from https://trac.sagemath.org/ticket/34448

Original creator: mkoeppe

Original creation time: 2022-08-28 23:29:22

CC:  tscrim egourgoulhon chapoton

... and add the method `tensor_factors` (#34393)


---

Comment by mkoeppe created at 2022-08-29 02:39:01

Last 10 new commits:


---

Comment by git created at 2022-08-29 02:44:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-02 18:26:09

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2022-09-02 18:37:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-04 19:36:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-06 21:37:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-07 00:57:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-07 01:04:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-09-07 01:05:47

Changing status from new to needs_review.


---

Comment by git created at 2022-09-07 18:14:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-24 21:54:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-25 23:37:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-25 23:43:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2022-09-26 13:55:25

LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:

```diff
-    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,
+    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,
```

and

```diff
+    tensor = FiniteRankFreeModule.tensor
```

Now, instances of `VectorFieldModule` are not free modules (those are implemented via `VectorFieldFreeModule` instead), so having `VectorFieldModule.tensor` being `FiniteRankFreeModule.tensor` looks problematic. For instance:

```
sage: M = manifolds.Sphere(2)
sage: XM = M.vector_field_module()
sage: XM.tensor?
   Construct a tensor on the free module "self" or a tensor product
   with other modules.
   ...
```

but `self` is not a free module. Maybe declaring `tensor = _tensor` would be preferable here. 

I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket. In particular we have still `category=Modules(self._ring)` in `TensorFieldModule.__init__`.


---

Comment by mkoeppe created at 2022-09-26 17:19:57

Replying to [comment:22 Eric Gourgoulhon]:
> I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket.

The next step in this direction is #34589


---

Comment by git created at 2022-09-26 17:21:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-09-26 17:22:30

Replying to [comment:22 Eric Gourgoulhon]:
> LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:
> {{{
> #!diff
> -    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,
> +    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,
> }}}
> and
> {{{
> #!diff
> +    tensor = FiniteRankFreeModule.tensor
> }}}

Thanks for catching this. I've reverted this change.


---

Comment by egourgoulhon created at 2022-09-27 09:23:44

Thanks!


---

Comment by egourgoulhon created at 2022-09-27 09:23:44

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-09-27 17:52:33

Thank you!


---

Comment by vbraun created at 2022-09-29 21:02:29

Resolution: fixed
