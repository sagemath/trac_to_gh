# Issue 34211: Put tensor modules of FiniteRankFreeModule in Modules().TensorProducts()

archive/issues_034211.json:
```json
{
    "body": "CC:  tscrim egourgoulhon chapoton\n\n... and add the method `tensor_factors` (#34393)\n\nIssue created by migration from https://trac.sagemath.org/ticket/34448\n\n",
    "created_at": "2022-08-28T23:29:22Z",
    "labels": [
        "categories",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Put tensor modules of FiniteRankFreeModule in Modules().TensorProducts()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34211",
    "user": "mkoeppe"
}
```
CC:  tscrim egourgoulhon chapoton

... and add the method `tensor_factors` (#34393)

Issue created by migration from https://trac.sagemath.org/ticket/34448





---

archive/issue_comments_485312.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2022-08-29T02:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485312",
    "user": "mkoeppe"
}
```

Last 10 new commits:



---

archive/issue_comments_485313.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-29T02:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485313",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485314.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-09-02T18:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485314",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_485315.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-02T18:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485315",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485316.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-04T19:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485316",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485317.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-06T21:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485317",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485318.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-07T00:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485318",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485319.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-07T01:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485319",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485320.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-07T01:05:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485320",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_485321.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-07T18:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485321",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485322.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-24T21:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485322",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485323.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-25T23:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485323",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485324.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-25T23:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485324",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485325.json:
```json
{
    "body": "LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:\n\n```diff\n-    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n+    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n```\n\nand\n\n```diff\n+    tensor = FiniteRankFreeModule.tensor\n```\n\nNow, instances of `VectorFieldModule` are not free modules (those are implemented via `VectorFieldFreeModule` instead), so having `VectorFieldModule.tensor` being `FiniteRankFreeModule.tensor` looks problematic. For instance:\n\n```\nsage: M = manifolds.Sphere(2)\nsage: XM = M.vector_field_module()\nsage: XM.tensor?\n   Construct a tensor on the free module \"self\" or a tensor product\n   with other modules.\n   ...\n```\n\nbut `self` is not a free module. Maybe declaring `tensor = _tensor` would be preferable here. \n\nI understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket. In particular we have still `category=Modules(self._ring)` in `TensorFieldModule.__init__`.",
    "created_at": "2022-09-26T13:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485325",
    "user": "egourgoulhon"
}
```

LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:

```diff
-    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,
+    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,
```

and

```diff
+    tensor = FiniteRankFreeModule.tensor
```

Now, instances of `VectorFieldModule` are not free modules (those are implemented via `VectorFieldFreeModule` instead), so having `VectorFieldModule.tensor` being `FiniteRankFreeModule.tensor` looks problematic. For instance:

```
sage: M = manifolds.Sphere(2)
sage: XM = M.vector_field_module()
sage: XM.tensor?
   Construct a tensor on the free module "self" or a tensor product
   with other modules.
   ...
```

but `self` is not a free module. Maybe declaring `tensor = _tensor` would be preferable here. 

I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket. In particular we have still `category=Modules(self._ring)` in `TensorFieldModule.__init__`.



---

archive/issue_comments_485326.json:
```json
{
    "body": "Replying to [comment:22 Eric Gourgoulhon]:\n> I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket.\n\nThe next step in this direction is #34589",
    "created_at": "2022-09-26T17:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485326",
    "user": "mkoeppe"
}
```

Replying to [comment:22 Eric Gourgoulhon]:
> I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket.

The next step in this direction is #34589



---

archive/issue_comments_485327.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-26T17:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485327",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485328.json:
```json
{
    "body": "Replying to [comment:22 Eric Gourgoulhon]:\n> LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:\n> {{{\n> #!diff\n> -    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n> +    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n> }}}\n> and\n> {{{\n> #!diff\n> +    tensor = FiniteRankFreeModule.tensor\n> }}}\n\nThanks for catching this. I've reverted this change.",
    "created_at": "2022-09-26T17:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485328",
    "user": "mkoeppe"
}
```

Replying to [comment:22 Eric Gourgoulhon]:
> LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:
> {{{
> #!diff
> -    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,
> +    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,
> }}}
> and
> {{{
> #!diff
> +    tensor = FiniteRankFreeModule.tensor
> }}}

Thanks for catching this. I've reverted this change.



---

archive/issue_comments_485329.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-09-27T09:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485329",
    "user": "egourgoulhon"
}
```

Thanks!



---

archive/issue_comments_485330.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-27T09:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485330",
    "user": "egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485331.json:
```json
{
    "body": "Thank you!",
    "created_at": "2022-09-27T17:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485331",
    "user": "mkoeppe"
}
```

Thank you!



---

archive/issue_comments_485332.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-29T21:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34211#issuecomment-485332",
    "user": "vbraun"
}
```

Resolution: fixed
