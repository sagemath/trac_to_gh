# Issue 16407: Implement LinearCode.cardinality()

archive/issues_016407.json:
```json
{
    "body": "CC:  @nathanncohen simonking @nthiery @tscrim\n\n`LinearCode.cardinality()` comes up in tab completion, but it is not actually there. Where does it come from? We do not need to worry any more since it will now come from the `LinearCode` class itself.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16644\n\n",
    "created_at": "2014-07-10T15:06:23Z",
    "labels": [
        "component: coding theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Implement LinearCode.cardinality()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16407",
    "user": "https://github.com/ppurka"
}
```
CC:  @nathanncohen simonking @nthiery @tscrim

`LinearCode.cardinality()` comes up in tab completion, but it is not actually there. Where does it come from? We do not need to worry any more since it will now come from the `LinearCode` class itself.

Issue created by migration from https://trac.sagemath.org/ticket/16644





---

archive/issue_comments_215227.json:
```json
{
    "body": "(the same happens with `c.cartesian_product` and `c.sum`, and probably others too... `:-/`)",
    "created_at": "2014-07-10T15:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215227",
    "user": "https://github.com/nathanncohen"
}
```

(the same happens with `c.cartesian_product` and `c.sum`, and probably others too... `:-/`)



---

archive/issue_comments_215228.json:
```json
{
    "body": "Replying to [comment:1 ncohen]:\n> (the same happens with `c.cartesian_product` and `c.sum`, and probably others too... `:-/`)\nYikes! Where are all these methods coming from? They are not in any of the classes that `LinearCode` inherits from.\n----\nNew commits:",
    "created_at": "2014-07-10T15:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215228",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:1 ncohen]:
> (the same happens with `c.cartesian_product` and `c.sum`, and probably others too... `:-/`)
Yikes! Where are all these methods coming from? They are not in any of the classes that `LinearCode` inherits from.
----
New commits:



---

archive/issue_comments_215229.json:
```json
{
    "body": "> Yikes! Where are all these methods coming from? They are not in any of the classes that `LinearCode` inherits from.\n\nDon't ask me, I always blame it on categories whatever happens.\n\nNathann",
    "created_at": "2014-07-10T15:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215229",
    "user": "https://github.com/nathanncohen"
}
```

> Yikes! Where are all these methods coming from? They are not in any of the classes that `LinearCode` inherits from.

Don't ask me, I always blame it on categories whatever happens.

Nathann



---

archive/issue_comments_215230.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-07-10T15:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215230",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_215231.json:
```json
{
    "body": "Sorry, I need to sleep. I based previous commit on the wrong branch. Did a forced update now.",
    "created_at": "2014-07-10T15:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215231",
    "user": "https://github.com/ppurka"
}
```

Sorry, I need to sleep. I based previous commit on the wrong branch. Did a forced update now.



---

archive/issue_comments_215232.json:
```json
{
    "body": "Oh, I see. WHen you will be awake: we had to write a LOT of code in the combinatorial design folders recently, and had queues of 5/6 ticket in `needs_review` depending on each other: we would have died if we had not added to every commit the ticket number at the beginning of the commit message. Otherwise you have no way to guess which commits belong to a given ticket.\n\nGood night ! `;-)`\n\nNathann",
    "created_at": "2014-07-10T15:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215232",
    "user": "https://github.com/nathanncohen"
}
```

Oh, I see. WHen you will be awake: we had to write a LOT of code in the combinatorial design folders recently, and had queues of 5/6 ticket in `needs_review` depending on each other: we would have died if we had not added to every commit the ticket number at the beginning of the commit message. Otherwise you have no way to guess which commits belong to a given ticket.

Good night ! `;-)`

Nathann



---

archive/issue_comments_215233.json:
```json
{
    "body": "Should this be in `needs_review` ?\n\nNathann",
    "created_at": "2014-07-16T12:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215233",
    "user": "https://github.com/nathanncohen"
}
```

Should this be in `needs_review` ?

Nathann



---

archive/issue_comments_215234.json:
```json
{
    "body": "Yes, of course. Thanks. I think cardinality should definitely be implemented, but am not so clear about cartesian product and sum, and possibly a bunch of others.",
    "created_at": "2014-07-16T13:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215234",
    "user": "https://github.com/ppurka"
}
```

Yes, of course. Thanks. I think cardinality should definitely be implemented, but am not so clear about cartesian product and sum, and possibly a bunch of others.



---

archive/issue_comments_215235.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-16T13:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215235",
    "user": "https://github.com/ppurka"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_215236.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-16T13:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215236",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_215237.json:
```json
{
    "body": "> Yes, of course. Thanks. I think cardinality should definitely be implemented, but am not so clear about cartesian product and sum, and possibly a bunch of others.\n\nWell, that's a different problem: why the hell are all those function half-inherited ? `T_T`\n\nNathann",
    "created_at": "2014-07-16T13:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215237",
    "user": "https://github.com/nathanncohen"
}
```

> Yes, of course. Thanks. I think cardinality should definitely be implemented, but am not so clear about cartesian product and sum, and possibly a bunch of others.

Well, that's a different problem: why the hell are all those function half-inherited ? `T_T`

Nathann



---

archive/issue_comments_215238.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-07-16T17:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215238",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_215239.json:
```json
{
    "body": "Nicolas, can you explain to me why this is not working. And, more importantly. why do we get totally useless diagnostics for why it is not working?",
    "created_at": "2014-07-16T17:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215239",
    "user": "https://github.com/vbraun"
}
```

Nicolas, can you explain to me why this is not working. And, more importantly. why do we get totally useless diagnostics for why it is not working?



---

archive/issue_comments_215240.json:
```json
{
    "body": "I believe it's because it's not a new style parent and it doesn't properly initialize its category:\n\n```python\nclass LinearCode(module.Module_old):\n    def __init__(self, gen_mat, d=None):\n        ParentWithGens.__init__(self, base_ring)\n```\n\nand in `Module_old`:\n\n```python\ndef category(self):\n    \"\"\"\n    Return the category to which this module belongs.\n    \"\"\"\n    # Defining a category method is deprecated for parents.\n    # Instead, the category should be specified in the constructor.\n    # See: http://sagetrac.org/sage_trac/wiki/CategoriesRoadMap\n    if self._is_category_initialized():\n        return Parent.category(self)\n    from sage.categories.modules import Modules\n    return Modules(self.base_ring())\n```\n",
    "created_at": "2014-07-16T17:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215240",
    "user": "https://github.com/tscrim"
}
```

I believe it's because it's not a new style parent and it doesn't properly initialize its category:

```python
class LinearCode(module.Module_old):
    def __init__(self, gen_mat, d=None):
        ParentWithGens.__init__(self, base_ring)
```

and in `Module_old`:

```python
def category(self):
    """
    Return the category to which this module belongs.
    """
    # Defining a category method is deprecated for parents.
    # Instead, the category should be specified in the constructor.
    # See: http://sagetrac.org/sage_trac/wiki/CategoriesRoadMap
    if self._is_category_initialized():
        return Parent.category(self)
    from sage.categories.modules import Modules
    return Modules(self.base_ring())
```




---

archive/issue_comments_215241.json:
```json
{
    "body": "That doesn't explain why it half-works, nor is it an excuse for the total failure to provide a useful error message.",
    "created_at": "2014-07-18T14:38:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215241",
    "user": "https://github.com/vbraun"
}
```

That doesn't explain why it half-works, nor is it an excuse for the total failure to provide a useful error message.



---

archive/issue_comments_215242.json:
```json
{
    "body": "Because it doesn't initialize its category, we have:\n\n```\nsage: C = codes.HammingCode(3, GF(2))\nsage: C.__class__.__mro__\n(sage.coding.linear_code.LinearCode,\n sage.modules.module.Module_old,\n sage.structure.parent_gens.ParentWithAdditiveAbelianGens,\n sage.structure.parent_gens.ParentWithGens,\n sage.structure.parent_base.ParentWithBase,\n sage.structure.parent_old.Parent,\n sage.structure.parent.Parent,\n sage.structure.category_object.CategoryObject,\n sage.structure.sage_object.SageObject,\n object)\n```\n\nI believe the `__getattr__` in `parent.pyx` is why it gets listed by tab completion, but because the method doesn't actually exist in the MRO, it can't call it. Simon or Nicolas could probably give a better explanation. IMO it's not worth it to try and contrive a \"proper\" error message, but instead put a note somewhere that this is a sign that the category framework is being abused.\n\nSo here's the branch which changes `LinearCode` to a new-style parent and all (non-long) tests pass in the coding folding. However because I don't know about codes, I can't implement an `_an_element_` for the test suite, nor do I know what the proper/best category is (i.e. are they finite dimensional modules? I'm guessing they are but IDK for sure). However this does fix the issue on this ticket.\n----\nNew commits:",
    "created_at": "2014-07-18T16:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215242",
    "user": "https://github.com/tscrim"
}
```

Because it doesn't initialize its category, we have:

```
sage: C = codes.HammingCode(3, GF(2))
sage: C.__class__.__mro__
(sage.coding.linear_code.LinearCode,
 sage.modules.module.Module_old,
 sage.structure.parent_gens.ParentWithAdditiveAbelianGens,
 sage.structure.parent_gens.ParentWithGens,
 sage.structure.parent_base.ParentWithBase,
 sage.structure.parent_old.Parent,
 sage.structure.parent.Parent,
 sage.structure.category_object.CategoryObject,
 sage.structure.sage_object.SageObject,
 object)
```

I believe the `__getattr__` in `parent.pyx` is why it gets listed by tab completion, but because the method doesn't actually exist in the MRO, it can't call it. Simon or Nicolas could probably give a better explanation. IMO it's not worth it to try and contrive a "proper" error message, but instead put a note somewhere that this is a sign that the category framework is being abused.

So here's the branch which changes `LinearCode` to a new-style parent and all (non-long) tests pass in the coding folding. However because I don't know about codes, I can't implement an `_an_element_` for the test suite, nor do I know what the proper/best category is (i.e. are they finite dimensional modules? I'm guessing they are but IDK for sure). However this does fix the issue on this ticket.
----
New commits:



---

archive/issue_comments_215243.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2014-07-18T16:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215243",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_215244.json:
```json
{
    "body": "Replying to [comment:15 tscrim]:\n> IMO it's not worth it to try and contrive a \"proper\" error message\n\nI suggest you read the history of this ticket again. Getting proper error messages is **crucial** for any programming framework.",
    "created_at": "2014-07-18T22:41:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215244",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:15 tscrim]:
> IMO it's not worth it to try and contrive a "proper" error message

I suggest you read the history of this ticket again. Getting proper error messages is **crucial** for any programming framework.



---

archive/issue_comments_215245.json:
```json
{
    "body": "`@`tscrim: there is still this problem with `element_class`. I have been able to get some other stuff working with your patch.\n\n```\nsage: C = codes.HammingCode(3, GF(2))                                           \nsage: C.cardinality()                                                           \n16\nsage: C.an_element()\n(1, 0, 0, 0, 0, 1, 1)\nsage: C2 = C.cartesian_product(C)\nsage: C2.an_element()\n((1, 0, 0, 0, 0, 1, 1), (1, 0, 0, 0, 0, 1, 1))\nsage: C.categories()\n[Category of vector spaces over Finite Field of size 2,\n Category of modules over Finite Field of size 2,\n Category of bimodules over Finite Field of size 2 on the left and Finite Field of size 2 on the right,\n Category of right modules over Finite Field of size 2,\n Category of left modules over Finite Field of size 2,\n Category of commutative additive groups,\n Category of additive groups,\n Category of additive inverse additive unital additive magmas,\n Category of commutative additive monoids,\n Category of additive monoids,\n Category of additive unital additive magmas,\n Category of commutative additive semigroups,\n Category of additive commutative additive magmas,\n Category of additive semigroups,\n Category of additive magmas,\n Category of sets,\n Category of sets with partial maps,\n Category of objects]\nsage: C.element_class()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-5-66b2e3babdf7> in <module>()\n----> 1 C.element_class()\n\n/home/punarbasu/Installations/sage-git/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:7290)()\n\n/home/punarbasu/Installations/sage-git/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1687)()\n\nAttributeError: 'LinearCode_with_category' object has no attribute 'element_class'\n```\n\n\n\n**Edit**: Also implemented `C.zero()` so that `C.sum()` works.\n\n```\nsage: C.zero_element()\n(0, 0, 0, 0, 0, 0, 0)\nsage: C.sum(()) # indirect doctest\n(0, 0, 0, 0, 0, 0, 0)\n```\n\nSo, we just need to figure out where this `element_class` is coming from and fix that.",
    "created_at": "2014-07-19T08:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215245",
    "user": "https://github.com/ppurka"
}
```

`@`tscrim: there is still this problem with `element_class`. I have been able to get some other stuff working with your patch.

```
sage: C = codes.HammingCode(3, GF(2))                                           
sage: C.cardinality()                                                           
16
sage: C.an_element()
(1, 0, 0, 0, 0, 1, 1)
sage: C2 = C.cartesian_product(C)
sage: C2.an_element()
((1, 0, 0, 0, 0, 1, 1), (1, 0, 0, 0, 0, 1, 1))
sage: C.categories()
[Category of vector spaces over Finite Field of size 2,
 Category of modules over Finite Field of size 2,
 Category of bimodules over Finite Field of size 2 on the left and Finite Field of size 2 on the right,
 Category of right modules over Finite Field of size 2,
 Category of left modules over Finite Field of size 2,
 Category of commutative additive groups,
 Category of additive groups,
 Category of additive inverse additive unital additive magmas,
 Category of commutative additive monoids,
 Category of additive monoids,
 Category of additive unital additive magmas,
 Category of commutative additive semigroups,
 Category of additive commutative additive magmas,
 Category of additive semigroups,
 Category of additive magmas,
 Category of sets,
 Category of sets with partial maps,
 Category of objects]
sage: C.element_class()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-5-66b2e3babdf7> in <module>()
----> 1 C.element_class()

/home/punarbasu/Installations/sage-git/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:7290)()

/home/punarbasu/Installations/sage-git/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1687)()

AttributeError: 'LinearCode_with_category' object has no attribute 'element_class'
```



**Edit**: Also implemented `C.zero()` so that `C.sum()` works.

```
sage: C.zero_element()
(0, 0, 0, 0, 0, 0, 0)
sage: C.sum(()) # indirect doctest
(0, 0, 0, 0, 0, 0, 0)
```

So, we just need to figure out where this `element_class` is coming from and fix that.



---

archive/issue_comments_215246.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-19T08:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215247.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-19T17:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215248.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-07-19T17:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215248",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_215249.json:
```json
{
    "body": "It comes from the category framework, although I believe it is there more for compatibility with old-style parents.\n\nI've made `LinearCode` into a facade parent (because I didn't want to deal with changing it over to have a proper element here...yes I'm being somewhat lazy), put it also in the category of `FiniteEnumeratedSets` (as such, we get `cardinality` for free), and made it so that it passes the `TestSuite`.",
    "created_at": "2014-07-19T17:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215249",
    "user": "https://github.com/tscrim"
}
```

It comes from the category framework, although I believe it is there more for compatibility with old-style parents.

I've made `LinearCode` into a facade parent (because I didn't want to deal with changing it over to have a proper element here...yes I'm being somewhat lazy), put it also in the category of `FiniteEnumeratedSets` (as such, we get `cardinality` for free), and made it so that it passes the `TestSuite`.



---

archive/issue_comments_215250.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-19T19:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215250",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_215251.json:
```json
{
    "body": "The real WTF here is not that LinearCode is misusing the category framework, but the utterly wrong and misleading error message that was produced. In Python, AttributeError means **you** need to implement that attribute but haven't. Nathan and Punarbasu are experienced developers, and if you manage to confuse them then I can guarantee your that there are 10 potential Sage developers that gave up before they posted anything on trac. If only a handful of people that have talked personally to Nicolas can work with the framework then this is going to kill Sage sooner or later. We need to be able to attract new developers, and hurdles like the one in this ticket will prevent that for sure.",
    "created_at": "2014-07-19T19:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215251",
    "user": "https://github.com/vbraun"
}
```

The real WTF here is not that LinearCode is misusing the category framework, but the utterly wrong and misleading error message that was produced. In Python, AttributeError means **you** need to implement that attribute but haven't. Nathan and Punarbasu are experienced developers, and if you manage to confuse them then I can guarantee your that there are 10 potential Sage developers that gave up before they posted anything on trac. If only a handful of people that have talked personally to Nicolas can work with the framework then this is going to kill Sage sooner or later. We need to be able to attract new developers, and hurdles like the one in this ticket will prevent that for sure.



---

archive/issue_comments_215252.json:
```json
{
    "body": "`@`tscrim: I think what vbraun brought up needs to be fixed in the category framework somewhere.\n\nOther than that, we can not depend on `cardinality` of the `FiniteEnumeratedSets`, even if it comes \"for free\". It comes at a huge cost because it generates all the elements of the linear code - it makes working with large linear codes difficult. We have a vector space structure here, so we can be much more efficient (which was my original patch in this ticket).\n\n```\nsage: C = codes.ReedSolomonCode(10, 7, GF(11))\nsage: %time C.cardinality()                                                                                             \nCPU times: user 8.14 s, sys: 60 ms, total: 8.2 s\nWall time: 8.1 s\n19487171\nsage: %time len(C)\nCPU times: user 0 ns, sys: 0 ns, total: 0 ns\nWall time: 62.9 \u00b5s\n19487171\n```\n",
    "created_at": "2014-07-20T16:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215252",
    "user": "https://github.com/ppurka"
}
```

`@`tscrim: I think what vbraun brought up needs to be fixed in the category framework somewhere.

Other than that, we can not depend on `cardinality` of the `FiniteEnumeratedSets`, even if it comes "for free". It comes at a huge cost because it generates all the elements of the linear code - it makes working with large linear codes difficult. We have a vector space structure here, so we can be much more efficient (which was my original patch in this ticket).

```
sage: C = codes.ReedSolomonCode(10, 7, GF(11))
sage: %time C.cardinality()                                                                                             
CPU times: user 8.14 s, sys: 60 ms, total: 8.2 s
Wall time: 8.1 s
19487171
sage: %time len(C)
CPU times: user 0 ns, sys: 0 ns, total: 0 ns
Wall time: 62.9 Âµs
19487171
```




---

archive/issue_comments_215253.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T01:40:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215254.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-23T01:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215254",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_215255.json:
```json
{
    "body": "`@`vbraun I would argue that `AttributeError` is the correct error: the attribute should be there according to the category, but it is not because it is an old-style parent. I'd rather spend my time fixing the problem and educating people about categories rather than trying to come up with a different error message. This solves the issue in the ticket description and we shouldn't hold up this ticket -- the error message should be on a separate ticket.\n\n`@`ncohen You actually were right in comment:4. I wonder if you're starting to understand categories. :P\n\n`@`ppurka I didn't look at/see the `__len__` method. I've changed that into `cardinality` and made `__len__` into an alias (so it will appear in the documentation).",
    "created_at": "2014-07-23T01:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215255",
    "user": "https://github.com/tscrim"
}
```

`@`vbraun I would argue that `AttributeError` is the correct error: the attribute should be there according to the category, but it is not because it is an old-style parent. I'd rather spend my time fixing the problem and educating people about categories rather than trying to come up with a different error message. This solves the issue in the ticket description and we shouldn't hold up this ticket -- the error message should be on a separate ticket.

`@`ncohen You actually were right in comment:4. I wonder if you're starting to understand categories. :P

`@`ppurka I didn't look at/see the `__len__` method. I've changed that into `cardinality` and made `__len__` into an alias (so it will appear in the documentation).



---

archive/issue_comments_215256.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-23T02:29:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215256",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_215257.json:
```json
{
    "body": "Giving correct diagnostics **is** a way of educating people about categories, and arguably the best way since you can't be looking over everybody's shoulder all the time. I just caught this ticket by chance, and you would have never noticed.",
    "created_at": "2014-07-23T02:29:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215257",
    "user": "https://github.com/vbraun"
}
```

Giving correct diagnostics **is** a way of educating people about categories, and arguably the best way since you can't be looking over everybody's shoulder all the time. I just caught this ticket by chance, and you would have never noticed.



---

archive/issue_comments_215258.json:
```json
{
    "body": "`@`vbraun I think we should open a different ticket for fixing the categories. In this ticket the `LinearCode` class is changed to use the new category framework. I will have to check the latest changes, but they seem quite ok at first glance.\n\n\nI will open a different ticket for addressing the error messages given by the categories. Does this sound reasonable to you?",
    "created_at": "2014-07-23T03:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215258",
    "user": "https://github.com/ppurka"
}
```

`@`vbraun I think we should open a different ticket for fixing the categories. In this ticket the `LinearCode` class is changed to use the new category framework. I will have to check the latest changes, but they seem quite ok at first glance.


I will open a different ticket for addressing the error messages given by the categories. Does this sound reasonable to you?



---

archive/issue_comments_215259.json:
```json
{
    "body": "Fine with me...",
    "created_at": "2014-07-23T04:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215259",
    "user": "https://github.com/vbraun"
}
```

Fine with me...



---

archive/issue_comments_215260.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-23T06:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215260",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_215261.json:
```json
{
    "body": "> `@`ncohen You actually were right in comment:4. I wonder if you're starting to understand categories. :P\n\nWe are old ennemies now.\n\nNathann",
    "created_at": "2014-07-23T08:04:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215261",
    "user": "https://github.com/nathanncohen"
}
```

> `@`ncohen You actually were right in comment:4. I wonder if you're starting to understand categories. :P

We are old ennemies now.

Nathann



---

archive/issue_comments_215262.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-23T16:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215262",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_215263.json:
```json
{
    "body": "This looks good to me. It passes all sage doctests and fails in 3 places which are due to gap (see #16660).",
    "created_at": "2014-07-23T16:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215263",
    "user": "https://github.com/ppurka"
}
```

This looks good to me. It passes all sage doctests and fails in 3 places which are due to gap (see #16660).



---

archive/issue_comments_215264.json:
```json
{
    "body": "I get the errors of #16660 with `develop`, so it's not a dependency IMO.",
    "created_at": "2014-07-27T22:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215264",
    "user": "https://github.com/tscrim"
}
```

I get the errors of #16660 with `develop`, so it's not a dependency IMO.



---

archive/issue_comments_215265.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-28T14:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215265",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048813.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-28T14:10:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16407#event-48813"
}
```



---

archive/issue_comments_215266.json:
```json
{
    "body": "Followup at #16707",
    "created_at": "2014-08-01T02:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16407#issuecomment-215266",
    "user": "https://github.com/vbraun"
}
```

Followup at #16707
