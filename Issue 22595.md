# Issue 22595: Add an option to the test runner to exit immediately upon the first failure

archive/issues_022595.json:
```json
{
    "body": "Inspired by the `--exitfirst` option to `py.test`, this adds a `--fail-once` option to Sage's test runner to exit immediately upon the first test failure.\n\nI've wanted something like this at several points, but one reason in particular is that part of the build of the patchbot Docker image is to perform the baseline test run, so that the image itself can be reused without having to rebuild the baseline each time.  Obviously, if a test fails during the baseline test run then I want the Docker image build to fail immediately, and not wait until the rest of the test suite has run.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22832\n\n",
    "created_at": "2017-04-19T11:41:36Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Add an option to the test runner to exit immediately upon the first failure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22595",
    "user": "https://github.com/embray"
}
```
Inspired by the `--exitfirst` option to `py.test`, this adds a `--fail-once` option to Sage's test runner to exit immediately upon the first test failure.

I've wanted something like this at several points, but one reason in particular is that part of the build of the patchbot Docker image is to perform the baseline test run, so that the image itself can be reused without having to rebuild the baseline each time.  Obviously, if a test fails during the baseline test run then I want the Docker image build to fail immediately, and not wait until the rest of the test suite has run.

Issue created by migration from https://trac.sagemath.org/ticket/22832





---

archive/issue_comments_314850.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-04-19T11:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314850",
    "user": "https://github.com/embray"
}
```

New commits:



---

archive/issue_comments_314851.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-19T11:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314851",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_314852.json:
```json
{
    "body": "Replying to [ticket:22832 embray]:\n> Inspired by the `--exitfirst` option to `py.test`, this adds a `--fail-once` option to Sage's test runner to exit immediately upon the first test failure.\n\nObvious question: why not call the Sage option `exitfirst`? I find it a better name than `fail-once`.",
    "created_at": "2017-04-19T12:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314852",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:22832 embray]:
> Inspired by the `--exitfirst` option to `py.test`, this adds a `--fail-once` option to Sage's test runner to exit immediately upon the first test failure.

Obvious question: why not call the Sage option `exitfirst`? I find it a better name than `fail-once`.



---

archive/issue_comments_314853.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-04-19T12:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314853",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_314854.json:
```json
{
    "body": "I'm making some changes, hang on...",
    "created_at": "2017-04-19T12:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314854",
    "user": "https://github.com/jdemeyer"
}
```

I'm making some changes, hang on...



---

archive/issue_comments_314855.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-04-19T15:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314855",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_314856.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-04-19T15:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314856",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_314857.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-20T09:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314857",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314858.json:
```json
{
    "body": "I'm fine with that, thanks.",
    "created_at": "2017-04-20T09:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314858",
    "user": "https://github.com/embray"
}
```

I'm fine with that, thanks.



---

archive/issue_comments_314859.json:
```json
{
    "body": "Replying to [comment:2 jdemeyer]:\n> Replying to [ticket:22832 embray]:\n> > Inspired by the `--exitfirst` option to `py.test`, this adds a `--fail-once` option to Sage's test runner to exit immediately upon the first test failure.\n> \n> Obvious question: why not call the Sage option `exitfirst`? I find it a better name than `fail-once`.\n\nI personally find \"fail once\" to be clearer than \"exit first\"--\"Exit first what?\" is what it makes me ask.  That said, the documentation makes it clear enough, and I don't mind the consistency.",
    "created_at": "2017-04-20T09:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314859",
    "user": "https://github.com/embray"
}
```

Replying to [comment:2 jdemeyer]:
> Replying to [ticket:22832 embray]:
> > Inspired by the `--exitfirst` option to `py.test`, this adds a `--fail-once` option to Sage's test runner to exit immediately upon the first test failure.
> 
> Obvious question: why not call the Sage option `exitfirst`? I find it a better name than `fail-once`.

I personally find "fail once" to be clearer than "exit first"--"Exit first what?" is what it makes me ask.  That said, the documentation makes it clear enough, and I don't mind the consistency.



---

archive/issue_comments_314860.json:
```json
{
    "body": "Oops, one little nitpick--you forgot to remove the line `fail_immediately=False` after renaming it to `abort_now` everywhere else.",
    "created_at": "2017-04-20T09:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314860",
    "user": "https://github.com/embray"
}
```

Oops, one little nitpick--you forgot to remove the line `fail_immediately=False` after renaming it to `abort_now` everywhere else.



---

archive/issue_comments_314861.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-20T09:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314861",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_314862.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-20T09:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_314863.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-04-20T09:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314863",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_314864.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-23T12:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22595#issuecomment-314864",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
