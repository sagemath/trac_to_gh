# Issue 11283: Add algorithm Magma to Conic methods

archive/issues_011283.json:
```json
{
    "body": "Assignee: @aghitza\n\nCC:  florian\n\nKeywords: magma conic\n\nAdd the option algorithm='magma' to (has_)rational_point for conics.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11455\n\n",
    "created_at": "2011-06-09T11:22:10Z",
    "labels": [
        "component: algebraic geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "Add algorithm Magma to Conic methods",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11283",
    "user": "https://github.com/mstreng"
}
```
Assignee: @aghitza

CC:  florian

Keywords: magma conic

Add the option algorithm='magma' to (has_)rational_point for conics.

Issue created by migration from https://trac.sagemath.org/ticket/11455





---

archive/issue_comments_124119.json:
```json
{
    "body": "Apparently the Magma interface for number field elements doesn't work the way I thought it would:\n\n```\nsage: L.<s> = QuadraticField(2)\nsage: m = magma(s)\nsage: m.sage()\nNameError: name 's' is not defined\n```\n\n```\nsage: K.<i> = QuadraticField(-1)\nsage: m = magma(i).sage(); m\nI\nsage: m.parent()\nSymbolic Ring\nsage: K(m)\nTypeError: <type 'sage.symbolic.expression.Expression'>\n```\nFraction fields are a problem too:\n\n```\nsage: R.<x> = QQ[]\nsage: y=x^2/x; y.parent()\nFraction Field of Univariate Polynomial Ring in x over Rational Field\nsage: m = magma(y)\nsage: m.sage()\nNameError: name 'x' is not defined\nsage: (m.Numerator().sage()/m.Denominator().sage())\nx\n```",
    "created_at": "2011-06-09T13:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124119",
    "user": "https://github.com/mstreng"
}
```

Apparently the Magma interface for number field elements doesn't work the way I thought it would:

```
sage: L.<s> = QuadraticField(2)
sage: m = magma(s)
sage: m.sage()
NameError: name 's' is not defined
```

```
sage: K.<i> = QuadraticField(-1)
sage: m = magma(i).sage(); m
I
sage: m.parent()
Symbolic Ring
sage: K(m)
TypeError: <type 'sage.symbolic.expression.Expression'>
```
Fraction fields are a problem too:

```
sage: R.<x> = QQ[]
sage: y=x^2/x; y.parent()
Fraction Field of Univariate Polynomial Ring in x over Rational Field
sage: m = magma(y)
sage: m.sage()
NameError: name 'x' is not defined
sage: (m.Numerator().sage()/m.Denominator().sage())
x
```



---

archive/issue_comments_124120.json:
```json
{
    "body": "Attachment [trac_11455_magma_algorithm_conics.patch](tarball://root/attachments/some-uuid/ticket11455/trac_11455_magma_algorithm_conics.patch) by @mstreng created at 2011-08-18 12:17:46\n\nuse magma to solve conics",
    "created_at": "2011-08-18T12:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124120",
    "user": "https://github.com/mstreng"
}
```

Attachment [trac_11455_magma_algorithm_conics.patch](tarball://root/attachments/some-uuid/ticket11455/trac_11455_magma_algorithm_conics.patch) by @mstreng created at 2011-08-18 12:17:46

use magma to solve conics



---

archive/issue_comments_124121.json:
```json
{
    "body": "Please review #10621, a student will need #11455 for his project in September.",
    "created_at": "2011-08-18T12:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124121",
    "user": "https://github.com/mstreng"
}
```

Please review #10621, a student will need #11455 for his project in September.



---

archive/issue_comments_124122.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-08-18T12:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124122",
    "user": "https://github.com/mstreng"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_124123.json:
```json
{
    "body": "Something is wrong, in 5.0.prealpha1, I get\n\n```\nsage: K.<i> = QuadraticField(-1)\nsage: C = Conic(K,[1,1,1])\nsage: C.rational_point(algorithm='magma')\nNotImplementedError: No correct conversion implemented for converting the Magma point (-i : 1 : 0) on Conic over Number Field with defining polynomial t^2 + 1 over the Rational Field defined by\nX^2 + Y^2 + Z^2 to a correct Sage point on self (=Projective Conic Curve over Number Field in i with defining polynomial x^2 + 1 defined by x^2 + y^2 + z^2)\n```",
    "created_at": "2012-02-03T13:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124123",
    "user": "https://github.com/mstreng"
}
```

Something is wrong, in 5.0.prealpha1, I get

```
sage: K.<i> = QuadraticField(-1)
sage: C = Conic(K,[1,1,1])
sage: C.rational_point(algorithm='magma')
NotImplementedError: No correct conversion implemented for converting the Magma point (-i : 1 : 0) on Conic over Number Field with defining polynomial t^2 + 1 over the Rational Field defined by
X^2 + Y^2 + Z^2 to a correct Sage point on self (=Projective Conic Curve over Number Field in i with defining polynomial x^2 + 1 defined by x^2 + y^2 + z^2)
```



---

archive/issue_comments_124124.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-02-03T13:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124124",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124125.json:
```json
{
    "body": "Replying to [comment:6 mstreng]:\n> Something is wrong\n\n\nHere's the reason:\n\n```\nsage: K = QuadraticField(-1, 'i')\nsage: L = NumberField(x^2+1, 'i')\nsage: magma(K.gen()).sage() in K\nFalse\nsage: magma(K.gen()).sage() in L\nTrue\nsage: magma(L.gen()).sage() in K\nFalse\nsage: magma(L.gen()).sage() in L\nTrue\nsage: magma(L.gen()).sage() == magma(K.gen()).sage()\nTrue\n```\nA field loses its embeddings when converted to Magma and back. A new patch is coming up.",
    "created_at": "2012-02-03T14:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124125",
    "user": "https://github.com/mstreng"
}
```

Replying to [comment:6 mstreng]:
> Something is wrong


Here's the reason:

```
sage: K = QuadraticField(-1, 'i')
sage: L = NumberField(x^2+1, 'i')
sage: magma(K.gen()).sage() in K
False
sage: magma(K.gen()).sage() in L
True
sage: magma(L.gen()).sage() in K
False
sage: magma(L.gen()).sage() in L
True
sage: magma(L.gen()).sage() == magma(K.gen()).sage()
True
```
A field loses its embeddings when converted to Magma and back. A new patch is coming up.



---

archive/issue_comments_124126.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-03T14:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124126",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124127.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-02-03T14:43:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124127",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124128.json:
```json
{
    "body": "Attachment [11455.patch](tarball://root/attachments/some-uuid/ticket11455/11455.patch) by @mstreng created at 2012-02-03 15:31:52",
    "created_at": "2012-02-03T15:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124128",
    "user": "https://github.com/mstreng"
}
```

Attachment [11455.patch](tarball://root/attachments/some-uuid/ticket11455/11455.patch) by @mstreng created at 2012-02-03 15:31:52



---

archive/issue_comments_124129.json:
```json
{
    "body": "With this patch on 5.0.prealpha1, all tests pass (except those that already fail on an unpatched 5.0.prealpha1).",
    "created_at": "2012-02-03T17:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124129",
    "user": "https://github.com/mstreng"
}
```

With this patch on 5.0.prealpha1, all tests pass (except those that already fail on an unpatched 5.0.prealpha1).



---

archive/issue_comments_124130.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-03T17:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124130",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124131.json:
```json
{
    "body": "Apply 11455.patch\n\n(for patchbot)",
    "created_at": "2012-03-11T19:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124131",
    "user": "https://github.com/loefflerd"
}
```

Apply 11455.patch

(for patchbot)



---

archive/issue_comments_124132.json:
```json
{
    "body": "Attachment [11455.2.patch](tarball://root/attachments/some-uuid/ticket11455/11455.2.patch) by @mstreng created at 2012-08-03 11:38:26",
    "created_at": "2012-08-03T11:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124132",
    "user": "https://github.com/mstreng"
}
```

Attachment [11455.2.patch](tarball://root/attachments/some-uuid/ticket11455/11455.2.patch) by @mstreng created at 2012-08-03 11:38:26



---

archive/issue_comments_124133.json:
```json
{
    "body": "apply 11455.2.patch (which does not introduce any trailing whitespaces, but is otherwise the same)",
    "created_at": "2012-08-03T11:40:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124133",
    "user": "https://github.com/mstreng"
}
```

apply 11455.2.patch (which does not introduce any trailing whitespaces, but is otherwise the same)



---

archive/issue_comments_124134.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-04T19:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124134",
    "user": "https://trac.sagemath.org/admin/accounts/users/florian"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_124135.json:
```json
{
    "body": "This has passed all test (including long) in Sage-5.2. I checked how the documentation look and that the patch works as it should (on Sage-5.2)",
    "created_at": "2012-08-04T19:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124135",
    "user": "https://trac.sagemath.org/admin/accounts/users/florian"
}
```

This has passed all test (including long) in Sage-5.2. I checked how the documentation look and that the patch works as it should (on Sage-5.2)



---

archive/issue_comments_124136.json:
```json
{
    "body": "Thanks Florian",
    "created_at": "2012-08-05T06:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124136",
    "user": "https://github.com/mstreng"
}
```

Thanks Florian



---

archive/issue_comments_124137.json:
```json
{
    "body": "You should use\n\n```\n# optional - magma\n```\ninstead of\n\n```\n# optional, uses magma\n```",
    "created_at": "2012-08-06T15:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124137",
    "user": "https://github.com/jdemeyer"
}
```

You should use

```
# optional - magma
```
instead of

```
# optional, uses magma
```



---

archive/issue_comments_124138.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-08-06T15:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124138",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_124139.json:
```json
{
    "body": "Attachment [11455.3.patch](tarball://root/attachments/some-uuid/ticket11455/11455.3.patch) by @mstreng created at 2012-08-06 16:19:34\n\nsame as previous one, but with corrected \"optional - magma\" tag",
    "created_at": "2012-08-06T16:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124139",
    "user": "https://github.com/mstreng"
}
```

Attachment [11455.3.patch](tarball://root/attachments/some-uuid/ticket11455/11455.3.patch) by @mstreng created at 2012-08-06 16:19:34

same as previous one, but with corrected "optional - magma" tag



---

archive/issue_comments_124140.json:
```json
{
    "body": "apply 11455.3.patch",
    "created_at": "2012-08-06T16:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124140",
    "user": "https://github.com/mstreng"
}
```

apply 11455.3.patch



---

archive/issue_comments_124141.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-08-06T16:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124141",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124142.json:
```json
{
    "body": "oops, with the correct \"optional\" tag, it turns out a lot of the optional tests fail",
    "created_at": "2012-08-06T19:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124142",
    "user": "https://github.com/mstreng"
}
```

oops, with the correct "optional" tag, it turns out a lot of the optional tests fail



---

archive/issue_comments_124143.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-08-06T19:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124143",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124144.json:
```json
{
    "body": "Attachment [11455-doctests.patch](tarball://root/attachments/some-uuid/ticket11455/11455-doctests.patch) by @mstreng created at 2012-08-06 20:42:15\n\napply on top of previous, fixes instable doctests",
    "created_at": "2012-08-06T20:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124144",
    "user": "https://github.com/mstreng"
}
```

Attachment [11455-doctests.patch](tarball://root/attachments/some-uuid/ticket11455/11455-doctests.patch) by @mstreng created at 2012-08-06 20:42:15

apply on top of previous, fixes instable doctests



---

archive/issue_comments_124145.json:
```json
{
    "body": "All tests pass! Florian, could you review again?",
    "created_at": "2012-08-06T21:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124145",
    "user": "https://github.com/mstreng"
}
```

All tests pass! Florian, could you review again?



---

archive/issue_comments_124146.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-08-06T21:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124146",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124147.json:
```json
{
    "body": "And thanks Jeroen for catching this!",
    "created_at": "2012-08-06T21:45:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124147",
    "user": "https://github.com/mstreng"
}
```

And thanks Jeroen for catching this!



---

archive/issue_comments_124148.json:
```json
{
    "body": "I'll review it again, sorry for letting the #optional, uses magma slip by.",
    "created_at": "2012-08-07T09:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124148",
    "user": "https://trac.sagemath.org/admin/accounts/users/florian"
}
```

I'll review it again, sorry for letting the #optional, uses magma slip by.



---

archive/issue_comments_124149.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-07T19:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124149",
    "user": "https://trac.sagemath.org/admin/accounts/users/florian"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_124150.json:
```json
{
    "body": "Reviewed it from scratch, everything works.",
    "created_at": "2012-08-07T19:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124150",
    "user": "https://trac.sagemath.org/admin/accounts/users/florian"
}
```

Reviewed it from scratch, everything works.



---

archive/issue_events_029777.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-14T07:02:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11283#event-29777"
}
```



---

archive/issue_comments_124151.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-08-14T07:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11283#issuecomment-124151",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
