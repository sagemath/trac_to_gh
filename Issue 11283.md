# Issue 11283: Add algorithm Magma to Conic methods

Issue created by migration from https://trac.sagemath.org/ticket/11455

Original creator: mstreng

Original creation time: 2011-06-09 11:22:10

Assignee: AlexGhitza

CC:  florian

Keywords: magma conic

Add the option algorithm='magma' to (has_)rational_point for conics.


---

Comment by mstreng created at 2011-06-09 13:45:57

Apparently the Magma interface for number field elements doesn't work the way I thought it would:

```
sage: L.<s> = QuadraticField(2)
sage: m = magma(s)
sage: m.sage()
NameError: name 's' is not defined
```


```
sage: K.<i> = QuadraticField(-1)
sage: m = magma(i).sage(); m
I
sage: m.parent()
Symbolic Ring
sage: K(m)
TypeError: <type 'sage.symbolic.expression.Expression'>
```

Fraction fields are a problem too:

```
sage: R.<x> = QQ[]
sage: y=x^2/x; y.parent()
Fraction Field of Univariate Polynomial Ring in x over Rational Field
sage: m = magma(y)
sage: m.sage()
NameError: name 'x' is not defined
sage: (m.Numerator().sage()/m.Denominator().sage())
x
```



---

Attachment

use magma to solve conics


---

Comment by mstreng created at 2011-08-18 12:21:58

Please review #10621, a student will need #11455 for his project in September.


---

Comment by mstreng created at 2011-08-18 12:21:58

Changing priority from minor to major.


---

Comment by mstreng created at 2011-08-18 12:21:58

Changing status from new to needs_review.


---

Comment by mstreng created at 2012-02-03 13:21:20

Something is wrong, in 5.0.prealpha1, I get

```
sage: K.<i> = QuadraticField(-1)
sage: C = Conic(K,[1,1,1])
sage: C.rational_point(algorithm='magma')
NotImplementedError: No correct conversion implemented for converting the Magma point (-i : 1 : 0) on Conic over Number Field with defining polynomial t^2 + 1 over the Rational Field defined by
X^2 + Y^2 + Z^2 to a correct Sage point on self (=Projective Conic Curve over Number Field in i with defining polynomial x^2 + 1 defined by x^2 + y^2 + z^2)
```



---

Comment by mstreng created at 2012-02-03 13:21:20

Changing status from needs_review to needs_work.


---

Comment by mstreng created at 2012-02-03 14:22:17

Replying to [comment:6 mstreng]:
> Something is wrong

Here's the reason:

```
sage: K = QuadraticField(-1, 'i')
sage: L = NumberField(x^2+1, 'i')
sage: magma(K.gen()).sage() in K
False
sage: magma(K.gen()).sage() in L
True
sage: magma(L.gen()).sage() in K
False
sage: magma(L.gen()).sage() in L
True
sage: magma(L.gen()).sage() == magma(K.gen()).sage()
True
```

A field loses its embeddings when converted to Magma and back. A new patch is coming up.


---

Comment by mstreng created at 2012-02-03 14:31:19

Changing status from needs_work to needs_review.


---

Comment by mstreng created at 2012-02-03 14:43:44

Changing status from needs_review to needs_work.


---

Attachment


---

Comment by mstreng created at 2012-02-03 17:26:19

With this patch on 5.0.prealpha1, all tests pass (except those that already fail on an unpatched 5.0.prealpha1).


---

Comment by mstreng created at 2012-02-03 17:26:19

Changing status from needs_work to needs_review.


---

Comment by davidloeffler created at 2012-03-11 19:30:43

Apply 11455.patch

(for patchbot)


---

Attachment


---

Comment by mstreng created at 2012-08-03 11:40:07

apply 11455.2.patch (which does not introduce any trailing whitespaces, but is otherwise the same)


---

Comment by florian created at 2012-08-04 19:01:52

Changing status from needs_review to positive_review.


---

Comment by florian created at 2012-08-04 19:01:52

This has passed all test (including long) in Sage-5.2. I checked how the documentation look and that the patch works as it should (on Sage-5.2)


---

Comment by mstreng created at 2012-08-05 06:07:48

Thanks Florian


---

Comment by jdemeyer created at 2012-08-06 15:06:22

You should use

```
# optional - magma
```

instead of

```
# optional, uses magma
```



---

Comment by jdemeyer created at 2012-08-06 15:06:22

Changing status from positive_review to needs_work.


---

Attachment

same as previous one, but with corrected "optional - magma" tag


---

Comment by mstreng created at 2012-08-06 16:20:33

apply 11455.3.patch


---

Comment by mstreng created at 2012-08-06 16:20:33

Changing status from needs_work to needs_review.


---

Comment by mstreng created at 2012-08-06 19:20:22

oops, with the correct "optional" tag, it turns out a lot of the optional tests fail


---

Comment by mstreng created at 2012-08-06 19:20:22

Changing status from needs_review to needs_work.


---

Attachment

apply on top of previous, fixes instable doctests


---

Comment by mstreng created at 2012-08-06 21:42:05

All tests pass! Florian, could you review again?


---

Comment by mstreng created at 2012-08-06 21:42:05

Changing status from needs_work to needs_review.


---

Comment by mstreng created at 2012-08-06 21:45:08

And thanks Jeroen for catching this!


---

Comment by florian created at 2012-08-07 09:24:49

I'll review it again, sorry for letting the #optional, uses magma slip by.


---

Comment by florian created at 2012-08-07 19:11:22

Changing status from needs_review to positive_review.


---

Comment by florian created at 2012-08-07 19:11:22

Reviewed it from scratch, everything works.


---

Comment by jdemeyer created at 2012-08-14 07:02:29

Resolution: fixed
