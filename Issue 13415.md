# Issue 13415: Enable polynomial content over padic fields

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2012-10-19 00:56:41

Assignee: roed

Currently, one cannot call `content()` for a polynomial defined over `Qp`:

```
sage: K = Qp(3)
sage: R.<t> = K[]
sage: t.content()
TypeError: ground ring is a field.  Answer is only defined up to units.
```


The intention is apparently to protect the user from calling `content()` if he mistakenly got from `Zp` into `Qp`, since the content there would be always zero or one. However, this can be annoying when writing algorithms which work over `Zp` and `Qp`Â but which have to take the content into account over `Zp`.

Additionally, the content shows a somewhat strange behaviour for zero polynomials::

```
sage: R = Zp(3)
sage: S.<t> = R[]
sage: f = S(R(0,3)); f
(O(3^3))
sage: f.is_zero()
True
sage: f.content()
3 + O(3^23)
sage: _.is_zero()
False
```


I don't think that the current behaviour is mathematically incorrect, but I believe it's not very intuitive.


---

Attachment

I'm happy with this.  Let me know when you want a review.


---

Comment by tscrim created at 2012-11-25 07:28:22

As a quick informal review, the `OUTPUT:` block is indented one too many times.


---

Comment by niles created at 2014-01-28 14:27:24

rebased and converted to git branch; changed indentation of `OUTPUT:` block, but no other changes
----
New commits:


---

Comment by saraedum created at 2014-06-25 19:46:28

Changing status from new to needs_review.


---

Comment by saraedum created at 2014-06-25 19:46:28

Changing keywords from "" to "sd59".


---

Comment by jdemeyer created at 2014-09-12 08:20:39

Is there are reason you are only doing this for `capped_relative_dense` rings and not in the generic `Polynomial_padic`?
----
New commits:


---

Comment by jdemeyer created at 2015-01-23 08:49:02

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-01-23 08:49:02

This should be done for generic padics polynomials. I would prefer to get the same answer for `Zp` and `Qp`, i.e. `p^k` where `k` is the minimal valuation. That would be more useful than always getting `1` as answer over `Qp`.


---

Comment by jdemeyer created at 2015-01-23 08:49:02

Changing priority from trivial to major.


---

Comment by saraedum created at 2015-01-23 13:55:17

Replying to [comment:14 jdemeyer]:
> Is there are reason you are only doing this for `capped_relative_dense` rings and not in the generic `Polynomial_padic`?
I believe `Polynomial_padic` did not exist when I wrote this first. Anyway, there is no reason, I'll change it.


---

Comment by saraedum created at 2015-01-23 14:00:35

Replying to [comment:15 jdemeyer]:
> This should be done for generic padics polynomials. I would prefer to get the same answer for `Zp` and `Qp`, i.e. `p^k` where `k` is the minimal valuation. That would be more useful than always getting `1` as answer over `Qp`.
This would be inconsistent with the current behaviour of `content()` over `QQ`. What should be the answer if a coefficient has negative valuation? I would rather stick to the usual definition of content. If people are interested in the content over `Zp`, then they should change the base ring.


---

Comment by saraedum created at 2015-01-23 14:16:18

Btw. I'd rather return the content as an ideal, just like `QQ` does. But this could probably break some code. Do you think this would be an acceptable change?


---

Comment by jdemeyer created at 2015-01-23 16:41:17

I think it's certainly not a good idea that `content()` sometimes returns an element and sometimes returns an ideal. Ideally, there would be two methods:
- `content()` returning an ideal in the mathematical sense
- `content_gen()` returning an element, preferably a generator of the _fractional ideal_ generated by the coefficients.


---

Comment by jdemeyer created at 2015-01-23 16:45:57

Replying to [comment:17 saraedum]:
> What should be the answer if a coefficient has negative valuation?
`p^k` where `k` is the minimal valuation of the coefficients.

> I would rather stick to the usual definition of content.
The "usual" definition doesn't care about the unit part, so answering `p^k` is a more useful and equally correct answer over `Qp`.


---

Comment by saraedum created at 2015-01-23 16:57:08

Replying to [comment:19 jdemeyer]:
> I think it's certainly not a good idea that `content()` sometimes returns an element and sometimes returns an ideal. Ideally, there would be two methods:
> - `content()` returning an ideal in the mathematical sense
> - `content_gen()` returning an element, preferably a generator of the _fractional ideal_ generated by the coefficients.
What is the value of `content_gen()`? It is almost always equivalent to `content().gen()` unless in some cases where both should raise an error?


---

Comment by saraedum created at 2015-01-23 16:57:30

Replying to [comment:20 jdemeyer]:
> Replying to [comment:17 saraedum]:
> > What should be the answer if a coefficient has negative valuation?
> `p^k` where `k` is the minimal valuation of the coefficients.
> 
> > I would rather stick to the usual definition of content.
> The "usual" definition doesn't care about the unit part, so answering `p^k` is a more useful and equally correct answer over `Qp`.
Ok. You are right. I'll change it.


---

Comment by git created at 2015-02-18 17:17:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2015-02-18 17:19:54

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-02-19 10:43:53

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-02-19 10:43:53

See [comment:14]


---

Comment by git created at 2016-03-15 23:47:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-03-17 02:43:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2016-03-17 02:43:41

Changing status from needs_work to needs_review.


---

Comment by aly.deines created at 2016-03-19 16:17:37

Looks good to me.


---

Comment by aly.deines created at 2016-03-19 16:17:37

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-03-20 23:41:47

Resolution: fixed


---

Comment by aly.deines created at 2016-03-23 15:09:34

Changing keywords from "sd59" to "sd59, sd71".


---

Comment by aly.deines created at 2016-03-23 17:42:57

Changing keywords from "sd59, sd71" to "sd59, days71".
