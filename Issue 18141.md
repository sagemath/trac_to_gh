# Issue 18141: list(ZZ) --> infinite loop

Issue created by migration from https://trac.sagemath.org/ticket/18378

Original creator: ncohen

Original creation time: 2015-05-07 16:14:25

CC:  vdelecroix

For some reason, `list(something)` breaks if `__len__` raises a `NotImplementedError`, but `__len__` is ignored if a `TypeError` is returned.

Python....

As `len(NN)` already raises a `NotImplementedError` I just copied the behaviour.

Nathann


---

Comment by ncohen created at 2015-05-07 16:16:12

Changing status from new to needs_review.


---

Comment by git created at 2015-05-07 16:16:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nbruin created at 2015-05-07 16:35:47

For posterity, the reason that `TypeError` gets caught is to make this work:

```
sage: l=(i for i in range(10))
sage: len(l)
TypeError: object of type 'generator' has no len()
sage: list(l)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```

It may well be an accident that `list` checks `len` of its argument before it checks if it's iterable, so I would not consider changing the error type a reliable way to prevent an infinite loop. I don't think python officially supports a way of preventing `list(<infinite iterable>)` from going in an infinite loop. It works, though...


---

Comment by ncohen created at 2015-05-07 17:46:50

> It may well be an accident that `list` checks `len` of its argument before it checks if it's iterable, so I would not consider changing the error type a reliable way to prevent an infinite loop. I don't think python officially supports a way of preventing `list(<infinite iterable>)` from going in an infinite loop.

Oh I see. Thanks `;-)`


---

Comment by git created at 2015-05-07 19:24:05

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jpflori created at 2015-05-18 20:34:37

Changing status from needs_review to positive_review.


---

Comment by jpflori created at 2015-05-18 20:34:37

Looks good enough to me, especially if `NN` already behaves like this.


---

Comment by ncohen created at 2015-05-18 20:36:04

Thanks !

Nathann


---

Comment by vbraun created at 2015-05-19 22:07:37

Resolution: fixed
