# Issue 25763: sage with 64 bit openblas

archive/issues_025763.json:
```json
{
    "body": "Keywords: openblas\n\nBy default, openblas compiles with a 32 bit interface (even when the binary is 64 bit). To build with the 64 bit interface, you have to set the [INTERFACE64](https://github.com/xianyi/OpenBLAS/blob/b03ae3f4dc90a3bde83b98f3fd67e8c618c0390b/Makefile.rule#L115) environment variable. [Here](https://github.com/Homebrew/homebrew-science/issues/48#issuecomment-11636954) is some discussion about the differences.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26000\n\n",
    "created_at": "2018-08-04T15:15:03Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "sage with 64 bit openblas",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25763",
    "user": "@timokau"
}
```
Keywords: openblas

By default, openblas compiles with a 32 bit interface (even when the binary is 64 bit). To build with the 64 bit interface, you have to set the [INTERFACE64](https://github.com/xianyi/OpenBLAS/blob/b03ae3f4dc90a3bde83b98f3fd67e8c618c0390b/Makefile.rule#L115) environment variable. [Here](https://github.com/Homebrew/homebrew-science/issues/48#issuecomment-11636954) is some discussion about the differences.

Issue created by migration from https://trac.sagemath.org/ticket/26000





---

archive/issue_comments_363707.json:
```json
{
    "body": "Attachment [tests.log](tarball://root/attachments/some-uuid/ticket26000/tests.log) by @timokau created at 2018-08-04 15:15:32",
    "created_at": "2018-08-04T15:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363707",
    "user": "@timokau"
}
```

Attachment [tests.log](tarball://root/attachments/some-uuid/ticket26000/tests.log) by @timokau created at 2018-08-04 15:15:32



---

archive/issue_comments_363708.json:
```json
{
    "body": "Attachment [dochtml.log](tarball://root/attachments/some-uuid/ticket26000/dochtml.log) by @timokau created at 2018-08-04 15:16:02",
    "created_at": "2018-08-04T15:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363708",
    "user": "@timokau"
}
```

Attachment [dochtml.log](tarball://root/attachments/some-uuid/ticket26000/dochtml.log) by @timokau created at 2018-08-04 15:16:02



---

archive/issue_comments_363709.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-08-05T11:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363709",
    "user": "@timokau"
}
```

New commits:



---

archive/issue_comments_363710.json:
```json
{
    "body": "Replying to [ticket:26000 gh-timokau]:\n> By default, openblas compiles with a 32 bit interface (even when the binary is 64 bit). To build with the 64 bit interface, you have to set the [INTERFACE64](https://github.com/xianyi/OpenBLAS/blob/b03ae3f4dc90a3bde83b98f3fd67e8c618c0390b/Makefile.rule#L115) environment variable. [Here](https://github.com/Homebrew/homebrew-science/issues/48#issuecomment-11636954) is some discussion about the differences.\n\nAfter reading that page, I don't think that we should enable INTERFACE64. An environment variable to change the API? That makes no sense to me...\n\nSo why should we do this?",
    "created_at": "2018-08-07T14:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363710",
    "user": "jdemeyer"
}
```

Replying to [ticket:26000 gh-timokau]:
> By default, openblas compiles with a 32 bit interface (even when the binary is 64 bit). To build with the 64 bit interface, you have to set the [INTERFACE64](https://github.com/xianyi/OpenBLAS/blob/b03ae3f4dc90a3bde83b98f3fd67e8c618c0390b/Makefile.rule#L115) environment variable. [Here](https://github.com/Homebrew/homebrew-science/issues/48#issuecomment-11636954) is some discussion about the differences.

After reading that page, I don't think that we should enable INTERFACE64. An environment variable to change the API? That makes no sense to me...

So why should we do this?



---

archive/issue_comments_363711.json:
```json
{
    "body": "Did you maybe misunderstand that? Its a configure-time variable, nothing unusual. Not runtime.\n\nThe advantages would be higher precision data types and higher compatibility with system openblas.",
    "created_at": "2018-08-07T18:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363711",
    "user": "@timokau"
}
```

Did you maybe misunderstand that? Its a configure-time variable, nothing unusual. Not runtime.

The advantages would be higher precision data types and higher compatibility with system openblas.



---

archive/issue_comments_363712.json:
```json
{
    "body": "Replying to [comment:4 gh-timokau]:\n> higher compatibility with system openblas.\n\nDo distros set INTERFACE64?",
    "created_at": "2018-08-07T19:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363712",
    "user": "jdemeyer"
}
```

Replying to [comment:4 gh-timokau]:
> higher compatibility with system openblas.

Do distros set INTERFACE64?



---

archive/issue_comments_363713.json:
```json
{
    "body": "In nix we have two versions, `openblas` and `openblasCompat`. `openblas` uses `INTERFACE64` on 64 bit machines while `openblasCompat` always uses 32.\n\nIts harder for other distros to have multiple variants of the same library though, so maybe they just use the `Compat` version all the time. I don't know for sure. Either way, if we figure out where the `INTERFACE64` failures are coming from we would keep compatibility for 32 bit anyways. So it would be a win-win.",
    "created_at": "2018-08-07T19:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363713",
    "user": "@timokau"
}
```

In nix we have two versions, `openblas` and `openblasCompat`. `openblas` uses `INTERFACE64` on 64 bit machines while `openblasCompat` always uses 32.

Its harder for other distros to have multiple variants of the same library though, so maybe they just use the `Compat` version all the time. I don't know for sure. Either way, if we figure out where the `INTERFACE64` failures are coming from we would keep compatibility for 32 bit anyways. So it would be a win-win.



---

archive/issue_comments_363714.json:
```json
{
    "body": "Replying to [comment:6 gh-timokau]:\n> In nix we have two versions, `openblas` and `openblasCompat`. `openblas` uses `INTERFACE64` on 64 bit machines while `openblasCompat` always uses 32.\n\nSo then use `openblasCompat`.\n\nIt's still not clear which bug this ticket is supposed to fix...",
    "created_at": "2018-08-10T19:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363714",
    "user": "jdemeyer"
}
```

Replying to [comment:6 gh-timokau]:
> In nix we have two versions, `openblas` and `openblasCompat`. `openblas` uses `INTERFACE64` on 64 bit machines while `openblasCompat` always uses 32.

So then use `openblasCompat`.

It's still not clear which bug this ticket is supposed to fix...



---

archive/issue_comments_363715.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> It's still not clear which bug this ticket is supposed to fix...\n\nIts an enhancement. Nix specific, using openblasCompat means we also have to build two versions of flint and two versions of all the sage dependencies that depend on flint. Thats a bit annoying.\n\nIn general, 64 bit is not only the future, I would argue it is the present. I don't know how long other distros will keep INTERFACET64=0 (if they currently do that). And ignoring distros for the moment, the main reason for 64 bit are 64 bit datatypes of course.",
    "created_at": "2018-08-10T20:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25763#issuecomment-363715",
    "user": "@timokau"
}
```

Replying to [comment:7 jdemeyer]:
> It's still not clear which bug this ticket is supposed to fix...

Its an enhancement. Nix specific, using openblasCompat means we also have to build two versions of flint and two versions of all the sage dependencies that depend on flint. Thats a bit annoying.

In general, 64 bit is not only the future, I would argue it is the present. I don't know how long other distros will keep INTERFACET64=0 (if they currently do that). And ignoring distros for the moment, the main reason for 64 bit are 64 bit datatypes of course.
