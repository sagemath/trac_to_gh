# Issue 23193: Cannot create a RealBall with rational radius

Issue created by migration from Trac.

Original creator: deinst

Original creation time: 2017-07-14 03:11:37

CC:  tmonteil mmezzarobba vdelecroix â€‹fredrik.johansson

For example


```
sage: RBF(1, 1/2)
```


will fail with `unable to convert 1 to a RealBall` but

```
sage: RBF(1, 0.5)
```


will succeed.   If this is not intentional I'll put a patch together.



---

Comment by mmezzarobba created at 2017-08-28 16:39:15

Well, I intentionally left that out at first when writing the bulk of the constructor code, and then never got around to implementing it, but I certainly agree that it would be good to have. So feel free to go ahead and add it!


---

Comment by deinst created at 2018-07-26 19:39:39

Changing priority from major to minor.


---

Comment by deinst created at 2018-07-26 19:39:39

Changing keywords from "" to "sagedays@icerm".


---

Comment by git created at 2018-07-26 21:31:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by deinst created at 2018-07-26 21:33:15

Changing status from new to needs_review.


---

Comment by @bryangingechen created at 2018-08-04 15:56:27

It looks like the line `cdef Integer foo` should be removed.

This test:

```python
sage: RBF(13, 1)
[1e+1 +/- 4.01]
```


looks crazy to me. Namely, why is the radius 1 printed as 4.01? I get the same output in the current version of Sage if I put in `RBF(13, 1.)`, so this behavior has been around for a while. Is it actually correct / expected? What am I missing?


---

Comment by git created at 2018-08-04 22:30:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-08-04 22:46:02

`@`gh-bryangingechen My guess is that it is an error with the printing (maybe with upstream):

```
sage: RBF(13,0.89)
[1.3e+1 +/- 0.891]
sage: RBF(11,0.9)
[1e+1 +/- 1.91]
sage: RBF(12,0.9)
[1e+1 +/- 2.91]
sage: RBF(13,0.9)
[1e+1 +/- 3.91]
sage: RBF(14,0.9)
[1e+1 +/- 4.91]
sage: RBF(15,0.9)
[2e+1 +/- 5.91]
```


```
sage: x = RBF(14,0.9)
sage: x.center()
14.0000000000000
sage: x.rad()
0.90000000
sage: x.rad().parent()
Real Field with 30 bits of precision
sage: (0.9).parent()
Real Field with 53 bits of precision
sage: x.center().parent()
Real Field with 53 bits of precision
```

Should there be a precision loss with the radius too?

David, don't forget to add your real name to the authors field.

I think this also might fix #25456.


---

Comment by deinst created at 2018-08-04 23:09:05

Sorry about the extra foo.

The printing is a consequence of Arb's printing.  The arb function `arb_get_str` returns a string that is guaranteed to contain the original ball when read back in and is rounded so that it is accurate to one unit in the last decimal place.  This behavior can be puzzling particularly when the error magnitude is not much smaller than the absolute value of of the midpoint.


---

Comment by @bryangingechen created at 2018-08-05 05:54:02

Changing status from needs_review to positive_review.


---

Comment by @bryangingechen created at 2018-08-05 05:54:02

OK, as long as the print behavior is known. It might be good to open a ticket to document it a bit more, though perhaps #15944 will eventually cover it.


---

Comment by vdelecroix created at 2018-08-07 19:48:00

Changing status from positive_review to needs_info.


---

Comment by vdelecroix created at 2018-08-07 19:48:00

Have you looked at #25456? Have you read [https://trac.sagemath.org/ticket/25456#comment:4](https://trac.sagemath.org/ticket/25456#comment:4)? There is a good reason for *not* doing what you propose.


---

Comment by vdelecroix created at 2018-08-07 19:53:54

Changing status from needs_info to positive_review.


---

Comment by vdelecroix created at 2018-08-07 19:53:54

Though, here it only deals with integer/rationals.


---

Comment by deinst created at 2018-08-07 20:25:09

I have looked at  #25456 but I have been, I think, careful to ensure that the arb ball includes the rational number in question.


---

Comment by vbraun created at 2018-08-11 16:55:03

Resolution: fixed
