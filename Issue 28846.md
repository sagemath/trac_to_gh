# Issue 28846: first parameter of a normal method must be self

archive/issues_028846.json:
```json
{
    "body": "CC:  tscrim jmantysalo\n\nas suggested by lgtm\n\nIssue created by migration from https://trac.sagemath.org/ticket/29083\n\n",
    "created_at": "2020-01-26T13:20:14Z",
    "labels": [
        "refactoring",
        "major",
        "enhancement"
    ],
    "title": "first parameter of a normal method must be self",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28846",
    "user": "chapoton"
}
```
CC:  tscrim jmantysalo

as suggested by lgtm

Issue created by migration from https://trac.sagemath.org/ticket/29083





---

archive/issue_comments_407887.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-01-26T13:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407887",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_407888.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-26T13:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407888",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_407889.json:
```json
{
    "body": "bot is morally green. Rather big diff this time, sorry. Please review.",
    "created_at": "2020-01-26T15:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407889",
    "user": "chapoton"
}
```

bot is morally green. Rather big diff this time, sorry. Please review.



---

archive/issue_comments_407890.json:
```json
{
    "body": "Nope. Just in the first function there is\n\n`J` -- a fractional quaternion ideal with same order as `I`\n\nbut now `I` has changed to `self`.",
    "created_at": "2020-01-26T16:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407890",
    "user": "jmantysalo"
}
```

Nope. Just in the first function there is

`J` -- a fractional quaternion ideal with same order as `I`

but now `I` has changed to `self`.



---

archive/issue_comments_407891.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-01-26T16:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407891",
    "user": "jmantysalo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_407892.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-26T17:15:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407892",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407893.json:
```json
{
    "body": "ok, thanks, fixed. I also fixed another similar glitch and some pyflakes warning.",
    "created_at": "2020-01-26T17:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407893",
    "user": "chapoton"
}
```

ok, thanks, fixed. I also fixed another similar glitch and some pyflakes warning.



---

archive/issue_comments_407894.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-26T17:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407894",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_407895.json:
```json
{
    "body": "A typo \"Return the sum of selfy\", otherwise this could be marked as positive review. However, I guess the error message \"self and J must be right ideals\" should be \"- - of the same order\" or something like that. But that's not your fault.",
    "created_at": "2020-01-26T19:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407895",
    "user": "jmantysalo"
}
```

A typo "Return the sum of selfy", otherwise this could be marked as positive review. However, I guess the error message "self and J must be right ideals" should be "- - of the same order" or something like that. But that's not your fault.



---

archive/issue_comments_407896.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-01-26T19:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407896",
    "user": "jmantysalo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_407897.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-26T19:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407897",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407898.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-26T19:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407898",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_407899.json:
```json
{
    "body": "Thanks a lot, Jori. I have fixed the typo, and left the error message as it is, not being able to change it into something better.",
    "created_at": "2020-01-26T19:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407899",
    "user": "chapoton"
}
```

Thanks a lot, Jori. I have fixed the typo, and left the error message as it is, not being able to change it into something better.



---

archive/issue_comments_407900.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-26T19:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407900",
    "user": "jmantysalo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_407901.json:
```json
{
    "body": "Good now. Thanks.",
    "created_at": "2020-01-26T19:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407901",
    "user": "jmantysalo"
}
```

Good now. Thanks.



---

archive/issue_comments_407902.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2020-01-27T00:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407902",
    "user": "nbruin"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_407903.json:
```json
{
    "body": "This ticket is creating a lot of churn in the revision history of files, but the benefit of the change is not argued. Is it really the case that functions in classes should have their first argument named \"self\"? It's indeed the case that on instances, these functions will be wrapped in bound methods that have their first argument as \"self\", but that doesn't necessarily say that the intent of the routine is best expressed by naming that parameter \"self\".\n\nIt may well be the case that the unbound functions do get called as well, in which case there isn't an obvious \"self\".\n\nFor instance, if you look in `sage/structure/element.pyx`, you can find plenty of routines that quite consistently name their arguments \"left\" and \"right\" (for coercion operations). In the style of `__rmul__`, it could well be that those arguments are swapped in order!\n\nIt could well be that the changes in this ticket have taken into account the subtleties that can arise and has only changed cases that benefit from using \"self\", but currently no such argument is made, which makes it look like the commit just blindly enforces \"first argument of a method must be named self\".\n\nPlease clarify in what way this commit improves the code base.",
    "created_at": "2020-01-27T00:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407903",
    "user": "nbruin"
}
```

This ticket is creating a lot of churn in the revision history of files, but the benefit of the change is not argued. Is it really the case that functions in classes should have their first argument named "self"? It's indeed the case that on instances, these functions will be wrapped in bound methods that have their first argument as "self", but that doesn't necessarily say that the intent of the routine is best expressed by naming that parameter "self".

It may well be the case that the unbound functions do get called as well, in which case there isn't an obvious "self".

For instance, if you look in `sage/structure/element.pyx`, you can find plenty of routines that quite consistently name their arguments "left" and "right" (for coercion operations). In the style of `__rmul__`, it could well be that those arguments are swapped in order!

It could well be that the changes in this ticket have taken into account the subtleties that can arise and has only changed cases that benefit from using "self", but currently no such argument is made, which makes it look like the commit just blindly enforces "first argument of a method must be named self".

Please clarify in what way this commit improves the code base.



---

archive/issue_comments_407904.json:
```json
{
    "body": "This is pep8\n\nhttps://lgtm.com/rules/910082/",
    "created_at": "2020-01-27T08:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407904",
    "user": "chapoton"
}
```

This is pep8

https://lgtm.com/rules/910082/



---

archive/issue_comments_407905.json:
```json
{
    "body": "Replying to [comment:11 chapoton]:\n> This is pep8\n> \n> https://lgtm.com/rules/910082/\n\nAs pep8 explains, these are *guidelines* not *rules*. It may be that the instances that this commit changes arose from uninformed copying of using \"not self\" in other places, in which case changing them might make sense.\n\nBut I know that at least in the coercion framework, there are places where using \"left\" and \"right\" was done very consciously to emphasize that the order of the arguments might NOT have a \"self\" first and/or because the code expressed intent better with more semantic naming.\n\nIn a method that doesn't change attributes on \"self\", it can be pretty irrelevant if the first argument is the instance the wrapper through which the function is called is bound to.\n\nAs PEP8 points out: \"A Foolish Consistency is the Hobgoblin of Little Minds\". I think there is a real possibility that (some of) the instances changed in the commit here are intentionally deviating from the general quideline. Perhaps putting a comment with them \"first argument named \"left\" for a reason\" helps future PEP-8 fervour.\n\n(spacing etc. is less controversial in my mind, but if you're changing names in code, you're actually messing with the expression of semantics the original author put there. You want to make sure that you're informed about such those before making a decision. That probably means it's not worth PEP8-ing this stuff).\n\n**EDIT:** Looking at some of the examples, I think changing to \"self\" does make sense in some cases, but then the naming of the other variables would need to be balanced too: \"left/right\" should be changed to \"self/other\" to have a balanced naming scheme. It's actually helpful in that code to have a correspondence between the naming of the two parameters. Similarly, the example of \"I/J\" can be changed to \"self/other\", but \"self/J\" is actually less clear in my opinion, because the similarity between the parameters is lost. There may be cases there where \"left/right\" really is better! I can't tell.",
    "created_at": "2020-01-27T17:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407905",
    "user": "nbruin"
}
```

Replying to [comment:11 chapoton]:
> This is pep8
> 
> https://lgtm.com/rules/910082/

As pep8 explains, these are *guidelines* not *rules*. It may be that the instances that this commit changes arose from uninformed copying of using "not self" in other places, in which case changing them might make sense.

But I know that at least in the coercion framework, there are places where using "left" and "right" was done very consciously to emphasize that the order of the arguments might NOT have a "self" first and/or because the code expressed intent better with more semantic naming.

In a method that doesn't change attributes on "self", it can be pretty irrelevant if the first argument is the instance the wrapper through which the function is called is bound to.

As PEP8 points out: "A Foolish Consistency is the Hobgoblin of Little Minds". I think there is a real possibility that (some of) the instances changed in the commit here are intentionally deviating from the general quideline. Perhaps putting a comment with them "first argument named "left" for a reason" helps future PEP-8 fervour.

(spacing etc. is less controversial in my mind, but if you're changing names in code, you're actually messing with the expression of semantics the original author put there. You want to make sure that you're informed about such those before making a decision. That probably means it's not worth PEP8-ing this stuff).

**EDIT:** Looking at some of the examples, I think changing to "self" does make sense in some cases, but then the naming of the other variables would need to be balanced too: "left/right" should be changed to "self/other" to have a balanced naming scheme. It's actually helpful in that code to have a correspondence between the naming of the two parameters. Similarly, the example of "I/J" can be changed to "self/other", but "self/J" is actually less clear in my opinion, because the similarity between the parameters is lost. There may be cases there where "left/right" really is better! I can't tell.



---

archive/issue_comments_407906.json:
```json
{
    "body": "IMO this should be discussed in the devel list.\n\n(Personally I also found it easier to read for example `a+b + c` than `a + b + c` if for some reason it is more logical to think it as `(a+b)+c`.)",
    "created_at": "2020-01-28T06:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407906",
    "user": "jmantysalo"
}
```

IMO this should be discussed in the devel list.

(Personally I also found it easier to read for example `a+b + c` than `a + b + c` if for some reason it is more logical to think it as `(a+b)+c`.)



---

archive/issue_comments_407907.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-01-29T10:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407907",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_407908.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-01-29T10:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407908",
    "user": "chapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_407909.json:
```json
{
    "body": "ok, here is a new branch, not touching any method involving the coercion framework, except for some methods about comparison.\n\nThis should be less controversial, I hope.",
    "created_at": "2020-01-29T10:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407909",
    "user": "chapoton"
}
```

ok, here is a new branch, not touching any method involving the coercion framework, except for some methods about comparison.

This should be less controversial, I hope.



---

archive/issue_comments_407910.json:
```json
{
    "body": "green bot. Nils, do you approve this version ?",
    "created_at": "2020-01-29T15:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407910",
    "user": "chapoton"
}
```

green bot. Nils, do you approve this version ?



---

archive/issue_comments_407911.json:
```json
{
    "body": "Replying to [comment:16 chapoton]:\n> green bot. Nils, do you approve this version ?\n\nNo, as I wrote, in several cases (and some remain in the current commit) there are parameters that have highly associated names `I/J`, `left/right` etc. That's actually an important part of the legibility of the code. By changing the first parameter to `self` you break that association, which makes the code less clear, in my opinion. So that's a deterioration in legibility, because a guideline is applied superficially.\n\nI think in those cases, if the author would have chosen `self` as a first argument, they would have chosen an associated name, like `other` for the other. Using `self/other` has the advantage that the first parameter is now called `self`, which looks familiar. The name `other` at least suggests it's something that plays a similar role to what `self` plays, and also occurs a lot (at least in the sage codebase), so looks familiar too. Whether `other` appropriately describes the role of the parameter (in coercion it could, because it's often just the \"other\" object involved in a binary operator, so it remains to to see what can be done with it).\n\nPersonally I wouldn't touch these files just to force compliance with a guideline, but might bring such guidelines up in review of new code, and might make changes in a file I'm touching anyway.\n\n(I have no beef with the single parameter functions, but since they're usually quite trivial I don't think there's a legibility issue to begin with. The only thing is precedent for future code)",
    "created_at": "2020-01-30T01:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407911",
    "user": "nbruin"
}
```

Replying to [comment:16 chapoton]:
> green bot. Nils, do you approve this version ?

No, as I wrote, in several cases (and some remain in the current commit) there are parameters that have highly associated names `I/J`, `left/right` etc. That's actually an important part of the legibility of the code. By changing the first parameter to `self` you break that association, which makes the code less clear, in my opinion. So that's a deterioration in legibility, because a guideline is applied superficially.

I think in those cases, if the author would have chosen `self` as a first argument, they would have chosen an associated name, like `other` for the other. Using `self/other` has the advantage that the first parameter is now called `self`, which looks familiar. The name `other` at least suggests it's something that plays a similar role to what `self` plays, and also occurs a lot (at least in the sage codebase), so looks familiar too. Whether `other` appropriately describes the role of the parameter (in coercion it could, because it's often just the "other" object involved in a binary operator, so it remains to to see what can be done with it).

Personally I wouldn't touch these files just to force compliance with a guideline, but might bring such guidelines up in review of new code, and might make changes in a file I'm touching anyway.

(I have no beef with the single parameter functions, but since they're usually quite trivial I don't think there's a legibility issue to begin with. The only thing is precedent for future code)



---

archive/issue_comments_407912.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-01-31T20:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407912",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_407913.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-01-31T21:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407913",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_407914.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-31T21:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407914",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407915.json:
```json
{
    "body": "ok. Here is a branch with much less changes, that I hope will be ok for you. I have been careful to change right to other when I was changing left to self. So consistency is preserved. I also checked that the doc was coherently fixed.\n\nPlease review",
    "created_at": "2020-01-31T21:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407915",
    "user": "chapoton"
}
```

ok. Here is a branch with much less changes, that I hope will be ok for you. I have been careful to change right to other when I was changing left to self. So consistency is preserved. I also checked that the doc was coherently fixed.

Please review



---

archive/issue_comments_407916.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-01T18:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407916",
    "user": "nbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_407917.json:
```json
{
    "body": "Ok, bot is green, the ticket accomplishes something in a direction someone is passionate about, and I think there's now a reasonable sign care has been taken to not harm the code base in other ways. So: positive review.",
    "created_at": "2020-02-01T18:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407917",
    "user": "nbruin"
}
```

Ok, bot is green, the ticket accomplishes something in a direction someone is passionate about, and I think there's now a reasonable sign care has been taken to not harm the code base in other ways. So: positive review.



---

archive/issue_comments_407918.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-10T20:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28846#issuecomment-407918",
    "user": "vbraun"
}
```

Resolution: fixed
