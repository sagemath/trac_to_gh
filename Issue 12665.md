# Issue 12665: MPFR doesn't compile with GCC-4.7.0 on ia64

archive/issues_012665.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  @nexttime jpflori @mwhansen\n\nThe error is exactly the same as #12765.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12837\n\n",
    "created_at": "2012-04-13T08:32:14Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "MPFR doesn't compile with GCC-4.7.0 on ia64",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12665",
    "user": "https://github.com/jdemeyer"
}
```
Assignee: tbd

CC:  @nexttime jpflori @mwhansen

The error is exactly the same as #12765.

Issue created by migration from https://trac.sagemath.org/ticket/12837





---

archive/issue_comments_150918.json:
```json
{
    "body": "For the record:\n\nI'm currently also cleaning up the spkg; stay tuned...",
    "created_at": "2012-04-13T18:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150918",
    "user": "https://github.com/nexttime"
}
```

For the record:

I'm currently also cleaning up the spkg; stay tuned...



---

archive/issue_comments_150919.json:
```json
{
    "body": "leif, any progress on the MPFR package?  If not, I'll provide a new spkg fixing the ia64 issue.",
    "created_at": "2012-04-19T12:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150919",
    "user": "https://github.com/jdemeyer"
}
```

leif, any progress on the MPFR package?  If not, I'll provide a new spkg fixing the ia64 issue.



---

archive/issue_comments_150920.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> leif, any progress on the MPFR package?  If not, I'll provide a new spkg fixing the ia64 issue.\n\nI just haven't announced it yet; cf. sage-release.",
    "created_at": "2012-04-19T13:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150920",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:3 jdemeyer]:
> leif, any progress on the MPFR package?  If not, I'll provide a new spkg fixing the ia64 issue.

I just haven't announced it yet; cf. sage-release.



---

archive/issue_comments_150921.json:
```json
{
    "body": "Oh, and there are still two \"open\" issues:\n\n\n```sh\n    if [ \"$SAGE64\" = yes ]; then\n        if [ -z \"$CFLAG64\" ]; then\n            CFLAG64=-m64\n        fi\n        echo \"Building a 64-bit version of MPFR (using '$CFLAG64').\"\n        # XXX Shouldn't this be put into the *required* CFLAGS?\n        default_cflags=\"$default_cflags $CFLAG64\"\n        CPPFLAGS=\"$CPPFLAGS $CFLAG64\"\n        LDFLAGS=\"$LDFLAGS $CFLAG64\"\n        # As MPFR doesn't have C++ files, we don't have to modify CXXFLAGS.\n    fi\n```\n\n(I think I'll just change that.)\n\n\n\n\n\n```sh\n    # XXX What is the following supposed to achieve???\n    # (GMP/MPIR is a prerequisite for MPFR, and we always build MPIR with\n    # '--enable-gmpcompat', since MPFR and other packages won't build without\n    # that anyway.) \n    if [ ! -f \"$SAGE_LOCAL/include/gmp.h\" ]; then\n        SAGE_CONF_OPTS=\"$SAGE_CONF_OPTS --disable-static --enable-shared\"\n    fi\n\n    if [ \"$UNAME\" = CYGWIN ]; then\n        SAGE_CONF_OPTS=\"$SAGE_CONF_OPTS --disable-static --enable-shared\"\n    fi\n```\n\n(I feel a bit uncomfortable just removing the first `if`-block, since I have absolutely no idea why or how it did get there.  The second `if` seems related; I didn't plan to remove that.)",
    "created_at": "2012-04-19T13:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150921",
    "user": "https://github.com/nexttime"
}
```

Oh, and there are still two "open" issues:


```sh
    if [ "$SAGE64" = yes ]; then
        if [ -z "$CFLAG64" ]; then
            CFLAG64=-m64
        fi
        echo "Building a 64-bit version of MPFR (using '$CFLAG64')."
        # XXX Shouldn't this be put into the *required* CFLAGS?
        default_cflags="$default_cflags $CFLAG64"
        CPPFLAGS="$CPPFLAGS $CFLAG64"
        LDFLAGS="$LDFLAGS $CFLAG64"
        # As MPFR doesn't have C++ files, we don't have to modify CXXFLAGS.
    fi
```

(I think I'll just change that.)





```sh
    # XXX What is the following supposed to achieve???
    # (GMP/MPIR is a prerequisite for MPFR, and we always build MPIR with
    # '--enable-gmpcompat', since MPFR and other packages won't build without
    # that anyway.) 
    if [ ! -f "$SAGE_LOCAL/include/gmp.h" ]; then
        SAGE_CONF_OPTS="$SAGE_CONF_OPTS --disable-static --enable-shared"
    fi

    if [ "$UNAME" = CYGWIN ]; then
        SAGE_CONF_OPTS="$SAGE_CONF_OPTS --disable-static --enable-shared"
    fi
```

(I feel a bit uncomfortable just removing the first `if`-block, since I have absolutely no idea why or how it did get there.  The second `if` seems related; I didn't plan to remove that.)



---

archive/issue_comments_150922.json:
```json
{
    "body": "Ok, now committed the changes, new spkg is at the same, usual place.\n\nIt uses `required_cflags` for `$CFLAG64`; the rest is still in.",
    "created_at": "2012-04-19T15:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150922",
    "user": "https://github.com/nexttime"
}
```

Ok, now committed the changes, new spkg is at the same, usual place.

It uses `required_cflags` for `$CFLAG64`; the rest is still in.



---

archive/issue_comments_150923.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-04-19T15:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150923",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_150924.json:
```json
{
    "body": "Diff between the previous spkg in Sage and my new p1 spkg.  For reference / review only.",
    "created_at": "2012-04-19T15:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150924",
    "user": "https://github.com/nexttime"
}
```

Diff between the previous spkg in Sage and my new p1 spkg.  For reference / review only.



---

archive/issue_comments_150925.json:
```json
{
    "body": "Attachment [mpfr-3.1.0.p0-p1.diff](tarball://root/attachments/some-uuid/ticket12837/mpfr-3.1.0.p0-p1.diff) by @nexttime created at 2012-04-19 15:06:18\n\nAttached a diff to the p0, for review purposes.",
    "created_at": "2012-04-19T15:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150925",
    "user": "https://github.com/nexttime"
}
```

Attachment [mpfr-3.1.0.p0-p1.diff](tarball://root/attachments/some-uuid/ticket12837/mpfr-3.1.0.p0-p1.diff) by @nexttime created at 2012-04-19 15:06:18

Attached a diff to the p0, for review purposes.



---

archive/issue_comments_150926.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-04-26T13:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150926",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_150927.json:
```json
{
    "body": "Looks good to me!",
    "created_at": "2012-04-26T13:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150927",
    "user": "https://github.com/vbraun"
}
```

Looks good to me!



---

archive/issue_comments_150928.json:
```json
{
    "body": "Replying to [comment:8 vbraun]:\n> Looks good to me!\n\nThanks, progress... :-)",
    "created_at": "2012-04-26T13:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150928",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:8 vbraun]:
> Looks good to me!

Thanks, progress... :-)



---

archive/issue_events_034953.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-30T09:51:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12665#event-34953"
}
```



---

archive/issue_comments_150929.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-04-30T09:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12665#issuecomment-150929",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
