# Issue 12665: MPFR doesn't compile with GCC-4.7.0 on ia64

Issue created by migration from https://trac.sagemath.org/ticket/12837

Original creator: jdemeyer

Original creation time: 2012-04-13 08:32:14

Assignee: tbd

CC:  leif jpflori mhansen

The error is exactly the same as #12765.


---

Comment by leif created at 2012-04-13 18:19:02

For the record:

I'm currently also cleaning up the spkg; stay tuned...


---

Comment by jdemeyer created at 2012-04-19 12:17:40

leif, any progress on the MPFR package?  If not, I'll provide a new spkg fixing the ia64 issue.


---

Comment by leif created at 2012-04-19 13:23:56

Replying to [comment:3 jdemeyer]:
> leif, any progress on the MPFR package?  If not, I'll provide a new spkg fixing the ia64 issue.

I just haven't announced it yet; cf. sage-release.


---

Comment by leif created at 2012-04-19 13:50:34

Oh, and there are still two "open" issues:


```sh
    if [ "$SAGE64" = yes ]; then
        if [ -z "$CFLAG64" ]; then
            CFLAG64=-m64
        fi
        echo "Building a 64-bit version of MPFR (using '$CFLAG64')."
        # XXX Shouldn't this be put into the *required* CFLAGS?
        default_cflags="$default_cflags $CFLAG64"
        CPPFLAGS="$CPPFLAGS $CFLAG64"
        LDFLAGS="$LDFLAGS $CFLAG64"
        # As MPFR doesn't have C++ files, we don't have to modify CXXFLAGS.
    fi
```

(I think I'll just change that.)





```sh
    # XXX What is the following supposed to achieve???
    # (GMP/MPIR is a prerequisite for MPFR, and we always build MPIR with
    # '--enable-gmpcompat', since MPFR and other packages won't build without
    # that anyway.) 
    if [ ! -f "$SAGE_LOCAL/include/gmp.h" ]; then
        SAGE_CONF_OPTS="$SAGE_CONF_OPTS --disable-static --enable-shared"
    fi

    if [ "$UNAME" = CYGWIN ]; then
        SAGE_CONF_OPTS="$SAGE_CONF_OPTS --disable-static --enable-shared"
    fi
```

(I feel a bit uncomfortable just removing the first `if`-block, since I have absolutely no idea why or how it did get there.  The second `if` seems related; I didn't plan to remove that.)


---

Comment by leif created at 2012-04-19 15:02:09

Ok, now committed the changes, new spkg is at the same, usual place.

It uses `required_cflags` for `$CFLAG64`; the rest is still in.


---

Comment by leif created at 2012-04-19 15:02:09

Changing status from new to needs_review.


---

Comment by leif created at 2012-04-19 15:05:29

Diff between the previous spkg in Sage and my new p1 spkg.  For reference / review only.


---

Attachment

Attached a diff to the p0, for review purposes.


---

Comment by vbraun created at 2012-04-26 13:37:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2012-04-26 13:37:50

Looks good to me!


---

Comment by leif created at 2012-04-26 13:52:43

Replying to [comment:8 vbraun]:
> Looks good to me!

Thanks, progress... :-)


---

Comment by jdemeyer created at 2012-04-30 09:51:08

Resolution: fixed
