# Issue 34099: base_ring is wrong for rational points in a projective space over a finite field

archive/issues_034099.json:
```json
{
    "body": "In [SageMath](SageMath) 9.4:\n\n```\nsage: P3 = ProjectiveSpace(2, GF(3))                                                                                                                                                                                \nsage: a = P3( (0,0,1) ); a                                                                                                                                                                                          \n(0 : 0 : 1)\nsage: a.parent()                                                                                                                                                                                                    \nSet of rational points of Projective Space of dimension 2 over Finite Field of size 3\nsage: a.base_ring()                                                                                                                                                                                                 \nInteger Ring\nsage: a.parent().base_ring()                                                                                                                                                                                        \nInteger Ring\n```\n\nSurely in both cases the base ring should be GF(3).\n\nThis also afflicts points generated in other ways.  For example\n\n```\nsage: x,y,z = P3.gens()                                                                                                                                                                                             \nsage: C = Curve(x+y+z)                                                                                                                                                                                              \nsage: b = C.rational_points()[0]                                                                                                                                                                                    \nsage: b                                                                                                                                                                                                             \n(0 : 2 : 1)\nsage: b.parent()                                                                                                                                                                                                    \nSet of rational points of Projective Plane Curve over Finite Field of size 3 defined by x0 + x1 + x2\nsage: b.base_ring()                                                                                                                                                                                                 \nInteger Ring\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34336\n\n",
    "created_at": "2022-08-10T19:13:07Z",
    "labels": [
        "component: algebraic geometry",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "base_ring is wrong for rational points in a projective space over a finite field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34099",
    "user": "https://trac.sagemath.org/admin/accounts/users/msaaltink"
}
```
In [SageMath](SageMath) 9.4:

```
sage: P3 = ProjectiveSpace(2, GF(3))                                                                                                                                                                                
sage: a = P3( (0,0,1) ); a                                                                                                                                                                                          
(0 : 0 : 1)
sage: a.parent()                                                                                                                                                                                                    
Set of rational points of Projective Space of dimension 2 over Finite Field of size 3
sage: a.base_ring()                                                                                                                                                                                                 
Integer Ring
sage: a.parent().base_ring()                                                                                                                                                                                        
Integer Ring
```

Surely in both cases the base ring should be GF(3).

This also afflicts points generated in other ways.  For example

```
sage: x,y,z = P3.gens()                                                                                                                                                                                             
sage: C = Curve(x+y+z)                                                                                                                                                                                              
sage: b = C.rational_points()[0]                                                                                                                                                                                    
sage: b                                                                                                                                                                                                             
(0 : 2 : 1)
sage: b.parent()                                                                                                                                                                                                    
Set of rational points of Projective Plane Curve over Finite Field of size 3 defined by x0 + x1 + x2
sage: b.base_ring()                                                                                                                                                                                                 
Integer Ring
```


Issue created by migration from https://trac.sagemath.org/ticket/34336





---

archive/issue_comments_483102.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-14T00:52:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483102",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_483103.json:
```json
{
    "body": "These fairly simple changes seem to do the trick.\n\n(I think the \"author\" field is for the author of the patch, not the bug report \u2014 someone please correct me if I'm wrong!)\n----\nNew commits:",
    "created_at": "2022-08-14T00:52:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483103",
    "user": "https://github.com/yyyyx4"
}
```

These fairly simple changes seem to do the trick.

(I think the "author" field is for the author of the patch, not the bug report â€” someone please correct me if I'm wrong!)
----
New commits:



---

archive/issue_comments_483104.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-14T05:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483105.json:
```json
{
    "body": "I made small edits.\n\n```diff\ndiff --git a/src/sage/schemes/generic/homset.py b/src/sage/schemes/generic/homset.py\nindex 4115f163b4..5a67c614ef 100644\n--- a/src/sage/schemes/generic/homset.py\n+++ b/src/sage/schemes/generic/homset.py\n@@ -154,7 +154,7 @@ class SchemeHomsetFactory(UniqueFactory):\n         if isinstance(Y, CommutativeRing):\n             Y = AffineScheme(Y)\n         if base is None:\n-            from sage.structure.all import coercion_model\n+            from sage.structure.element import coercion_model\n             base = coercion_model.common_parent(X.base_ring(), Y.base_ring())\n         if is_AffineScheme(base):\n             base_spec = base\n```\n\n\nIt is not recommended to import from `.all`, which is intended for filling the global namespace for users.\n\n\n```diff\ndiff --git a/src/sage/schemes/generic/morphism.py b/src/sage/schemes/generic/morphism.py\nindex b1409f05ba..4c75777c1d 100644\n--- a/src/sage/schemes/generic/morphism.py\n+++ b/src/sage/schemes/generic/morphism.py\n@@ -482,7 +482,7 @@ class SchemeMorphism(Element):\n     def base_ring(self):\n         r\"\"\"\n         Return the base ring of ``self``, that is, the ring over which\n-        the coefficients of ``self`` are given as polynomials.\n+        the defining polynomials of ``self`` are defined.\n \n         OUTPUT:\n \n```\n\n\nas the meaning of the original sentence is not clear.\n\nI am positive otherwise.",
    "created_at": "2022-08-14T05:43:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483105",
    "user": "https://github.com/kwankyu"
}
```

I made small edits.

```diff
diff --git a/src/sage/schemes/generic/homset.py b/src/sage/schemes/generic/homset.py
index 4115f163b4..5a67c614ef 100644
--- a/src/sage/schemes/generic/homset.py
+++ b/src/sage/schemes/generic/homset.py
@@ -154,7 +154,7 @@ class SchemeHomsetFactory(UniqueFactory):
         if isinstance(Y, CommutativeRing):
             Y = AffineScheme(Y)
         if base is None:
-            from sage.structure.all import coercion_model
+            from sage.structure.element import coercion_model
             base = coercion_model.common_parent(X.base_ring(), Y.base_ring())
         if is_AffineScheme(base):
             base_spec = base
```


It is not recommended to import from `.all`, which is intended for filling the global namespace for users.


```diff
diff --git a/src/sage/schemes/generic/morphism.py b/src/sage/schemes/generic/morphism.py
index b1409f05ba..4c75777c1d 100644
--- a/src/sage/schemes/generic/morphism.py
+++ b/src/sage/schemes/generic/morphism.py
@@ -482,7 +482,7 @@ class SchemeMorphism(Element):
     def base_ring(self):
         r"""
         Return the base ring of ``self``, that is, the ring over which
-        the coefficients of ``self`` are given as polynomials.
+        the defining polynomials of ``self`` are defined.
 
         OUTPUT:
 
```


as the meaning of the original sentence is not clear.

I am positive otherwise.



---

archive/issue_comments_483106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-14T08:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483107.json:
```json
{
    "body": "You can set positive review if you are okay with my edits.",
    "created_at": "2022-08-14T13:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483107",
    "user": "https://github.com/kwankyu"
}
```

You can set positive review if you are okay with my edits.



---

archive/issue_comments_483108.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-14T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483108",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_483109.json:
```json
{
    "body": "Looks good, thank you!",
    "created_at": "2022-08-14T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483109",
    "user": "https://github.com/yyyyx4"
}
```

Looks good, thank you!



---

archive/issue_comments_483110.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-30T19:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34099#issuecomment-483110",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
