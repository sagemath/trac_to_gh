# Issue 34099: base_ring is wrong for rational points in a projective space over a finite field

Issue created by migration from https://trac.sagemath.org/ticket/34336

Original creator: msaaltink

Original creation time: 2022-08-10 19:13:07

In [SageMath](SageMath) 9.4:

```
sage: P3 = ProjectiveSpace(2, GF(3))                                                                                                                                                                                
sage: a = P3( (0,0,1) ); a                                                                                                                                                                                          
(0 : 0 : 1)
sage: a.parent()                                                                                                                                                                                                    
Set of rational points of Projective Space of dimension 2 over Finite Field of size 3
sage: a.base_ring()                                                                                                                                                                                                 
Integer Ring
sage: a.parent().base_ring()                                                                                                                                                                                        
Integer Ring
```

Surely in both cases the base ring should be GF(3).

This also afflicts points generated in other ways.  For example

```
sage: x,y,z = P3.gens()                                                                                                                                                                                             
sage: C = Curve(x+y+z)                                                                                                                                                                                              
sage: b = C.rational_points()[0]                                                                                                                                                                                    
sage: b                                                                                                                                                                                                             
(0 : 2 : 1)
sage: b.parent()                                                                                                                                                                                                    
Set of rational points of Projective Plane Curve over Finite Field of size 3 defined by x0 + x1 + x2
sage: b.base_ring()                                                                                                                                                                                                 
Integer Ring
```



---

Comment by lorenz created at 2022-08-14 00:52:52

Changing status from new to needs_review.


---

Comment by lorenz created at 2022-08-14 00:52:52

These fairly simple changes seem to do the trick.

(I think the "author" field is for the author of the patch, not the bug report â€” someone please correct me if I'm wrong!)
----
New commits:


---

Comment by git created at 2022-08-14 05:28:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-08-14 05:43:07

I made small edits.

```diff
diff --git a/src/sage/schemes/generic/homset.py b/src/sage/schemes/generic/homset.py
index 4115f163b4..5a67c614ef 100644
--- a/src/sage/schemes/generic/homset.py
+++ b/src/sage/schemes/generic/homset.py
@@ -154,7 +154,7 @@ class SchemeHomsetFactory(UniqueFactory):
         if isinstance(Y, CommutativeRing):
             Y = AffineScheme(Y)
         if base is None:
-            from sage.structure.all import coercion_model
+            from sage.structure.element import coercion_model
             base = coercion_model.common_parent(X.base_ring(), Y.base_ring())
         if is_AffineScheme(base):
             base_spec = base
```


It is not recommended to import from `.all`, which is intended for filling the global namespace for users.


```diff
diff --git a/src/sage/schemes/generic/morphism.py b/src/sage/schemes/generic/morphism.py
index b1409f05ba..4c75777c1d 100644
--- a/src/sage/schemes/generic/morphism.py
+++ b/src/sage/schemes/generic/morphism.py
@@ -482,7 +482,7 @@ class SchemeMorphism(Element):
     def base_ring(self):
         r"""
         Return the base ring of ``self``, that is, the ring over which
-        the coefficients of ``self`` are given as polynomials.
+        the defining polynomials of ``self`` are defined.
 
         OUTPUT:
 
```


as the meaning of the original sentence is not clear.

I am positive otherwise.


---

Comment by git created at 2022-08-14 08:45:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-08-14 13:01:11

You can set positive review if you are okay with my edits.


---

Comment by lorenz created at 2022-08-14 16:01:49

Changing status from needs_review to positive_review.


---

Comment by lorenz created at 2022-08-14 16:01:49

Looks good, thank you!


---

Comment by vbraun created at 2022-08-30 19:04:03

Resolution: fixed
