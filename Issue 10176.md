# Issue 10176: Gamma0 equivalence function for number field cusps returns wrong transformation matrix

Issue created by migration from https://trac.sagemath.org/ticket/10177

Original creator: mtaranes

Original creation time: 2010-10-27 11:34:26

Assignee: craigcitro

CC:  cremona

Keywords: number field cusps

The transformation matrix returned by 'is_Gamma0_equivalent' for number field cusps is not in Gamma0(N). My fault (this is even wrong in the example I wrote for the documentation, sorry...):

```
  sage: k.<a> = NumberField(x^2 + 5)
  sage: N = k.ideal(3)
  sage: alpha = NFCusp(k, 3, a + 1)
  sage: beta = NFCusp(k, 2, a - 3)
  sage: alpha.is_Gamma0_equivalent(beta, N, Transformation=True)
  (True, [2*a - 4, -3*a - 4, -5*a + 2, 3*a + 13])
 }}}
The matrix is not in Gamma0(3)!

It's not difficult to compute the right matrix. I'll be happy to write a patch in a few weeks (after I submit my thesis). 


---

Comment by mtaranes created at 2010-12-13 17:17:19

Changing status from new to needs_review.


---

Attachment

Here is a patch, based on Sage 4.6.


---

Comment by davidloeffler created at 2010-12-16 13:14:20

Changing status from needs_review to positive_review.


---

Comment by davidloeffler created at 2010-12-16 13:14:20

Looks fine to me, and all doctests in sage/modular pass. (I set the milestone to 4.6.2, as 4.6.1 is in feature freeze, I believe).


---

Comment by cremona created at 2010-12-16 20:45:27

Replying to [comment:2 davidloeffler]:
> Looks fine to me, and all doctests in sage/modular pass. (I set the milestone to 4.6.2, as 4.6.1 is in feature freeze, I believe).

Thanks, David -- it would quite nice to get this in before Maite's viva (Jan 27th)!


---

Comment by jdemeyer created at 2010-12-17 14:11:28

Milestone set back to 4.6.1 by special request from John Cremona.


---

Comment by jdemeyer created at 2010-12-19 09:34:22

Resolution: fixed
