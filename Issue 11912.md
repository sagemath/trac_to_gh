# Issue 11912: Restores a test in sage/tests/french_book/number_theory.py

Issue created by migration from Trac.

Original creator: roed

Original creation time: 2011-11-25 21:09:11

Assignee: AlexGhitza

CC:  zimmerma

Ticket #8334 inappropriately changed the following test in `sage/tests/french_book/number_theory.py`:

```
sage: R = GF(9,name='x'); R
Finite Field in x of size 3^2
sage: Q.<x> = PolynomialRing(GF(3))
sage: R2 = GF(9,name='x',modulus=x^2+1); R2
Finite Field in x of size 3^2
sage: p = R(x+1); R2(p)
Traceback (most recent call last):
...
TypeError: unable to coerce from a finite field other than the prime subfield
```

to instead raise a `NotImplementedError`.  The original behavior was restored in #8335, but that ticket has stagnated.

We add a patch to restore the original error message and type.


---

Comment by roed created at 2011-11-25 21:10:53

Changing status from new to needs_review.


---

Comment by zimmerma created at 2011-11-26 07:12:35

thank you David. I will review that ticket during the Sage-Flint days, unless someone beats me.

Paul

PS: btw, please use different tickets to solve different issues


---

Comment by davidloeffler created at 2011-12-31 15:16:34

Changing status from needs_review to needs_work.


---

Comment by davidloeffler created at 2011-12-31 15:16:34


```
File "/storage/masiao/sage-4.8.alpha5/devel/sage-testing/sage/rings/finite_rings/finite_field_givaro.py", line 327:
    sage: F81(F9.gen())
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError
Got:
    Traceback (most recent call last):
      File "/storage/masiao/sage-4.8.alpha5/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/storage/masiao/sage-4.8.alpha5/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/storage/masiao/sage-4.8.alpha5/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_6[50]>", line 1, in <module>
        F81(F9.gen())###line 327:
    sage: F81(F9.gen())
      File "parent.pyx", line 984, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7320)
      File "parent.pyx", line 2149, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:14043)
      File "parent.pyx", line 2156, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:14194)
      File "parent.pyx", line 2013, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:12824)
      File "parent.pyx", line 2064, in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:13220)
      File "parent_old.pyx", line 501, in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:6047)
      File "/storage/masiao/sage-4.8.alpha5/local/lib/python/site-packages/sage/rings/finite_rings/finite_field_givaro.py", line 357, in _coerce_map_from_
        raise TypeError, "unable to coerce from a finite field other than the prime subfield"
    TypeError: unable to coerce from a finite field other than the prime subfield
```



---

Comment by zimmerma created at 2012-01-03 20:52:28

Changing status from needs_work to needs_info.


---

Comment by zimmerma created at 2012-01-03 20:52:28

David, on top of 4.7.2 it works for me:

```
[zimmerma`@`coing finite_rings]$ sage -t finite_field_givaro.py
sage -t  "devel/sage-12084/sage/rings/finite_rings/finite_field_givaro.py"
         [4.8 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 4.8 seconds
```

Did you apply another patch which would be in conflict with that one?

Paul


---

Comment by davidloeffler created at 2012-01-03 22:15:33

No, this is in a fresh build of 4.8.alpha5 with no patches applied. Moreover I can't see how it *can* work, in any version, since #8334 added a doctest to finite_field_givaro which expects the NotImplementedError, and the patch here changes the NotImplementedError back to a TypeError but does not change this doctest.


---

Attachment

I've updated the patch to change that doctest.


---

Comment by roed created at 2012-01-04 11:42:45

Changing status from needs_info to needs_review.


---

Comment by davidloeffler created at 2012-01-04 12:00:59

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-01-15 21:57:25

Resolution: fixed
