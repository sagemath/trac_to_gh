# Issue 28352: threejs does not work when openGL is not supported

Issue created by migration from https://trac.sagemath.org/ticket/28589

Original creator: tmonteil

Original creation time: 2019-10-10 19:51:13

On some configs, `OpenGL` is not supported, and `threejs` relies on it. Since it is now the default 3d viewer, nothing will be drawn when trying to plot 3d objects: there should be some fallback to `jmol` when such case appears.


---

Comment by tmonteil created at 2019-10-10 19:53:31

I do not know how to detect that the web browser supports `OpenGL` though.


---

Comment by paulmasson created at 2019-10-11 00:44:16

Three.js more precisely uses WebGL, which is [supported](https://caniuse.com/#feat=webgl) in all major browsers. If someone is using a browser so old that it does not support WebGL, they should be told to upgrade that massive security risk.

Detection of WebGL capability occurs in the browser, so there could be no automatic fallback once the process is handed off to the browser. At most we could display an error message, but I highly doubt even that will be necessary.


---

Comment by paulmasson created at 2019-10-11 00:44:16

Changing keywords from "" to "threejs".


---

Comment by tmonteil created at 2019-10-11 09:06:20

I went on that issue when developing Sage Debian Live. It runs up-to-date Debian buster with firefox-esr, but on 32bit. Firefox supports OpenGL but this latter seems not available.


---

Comment by tmonteil created at 2019-10-11 09:07:22

I don't know how, but jupyter should be able to get feedback from the browser when such issue appears.


---

Comment by egourgoulhon created at 2019-10-12 13:28:57

Replying to [comment:3 tmonteil]:
> I went on that issue when developing Sage Debian Live. It runs up-to-date Debian buster with firefox-esr, but on 32bit. Firefox supports OpenGL but this latter seems not available.
What do you mean by that? I may be wrong, but from that page, I would say that OpenGL is available in Debian buster 32bit:
https://packages.debian.org/buster/libgl1-mesa-dev


---

Comment by embray created at 2019-12-16 11:27:34

Replying to [comment:2 paulmasson]:

> Detection of WebGL capability occurs in the browser, so there could be no automatic fallback once the process is handed off to the browser. At most we could display an error message, but I highly doubt even that will be necessary.

Displaying a helpful error message would be good at a minimum.  Currently, if ThreeJS fails to work (this can happen even on modern browsers if WebGL is explicitly disabled), the user just gets a blank screen.  In the JS console there will be an error message, but the average user is not inclined to check the console for errors.  They just see a blank screen and panic.  Better to give an error message and suggest alternate rendering methods.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.
