# Issue 17968: mistune buggers up sage install

archive/issues_017968.json:
```json
{
    "body": "CC:  @vbraun @kiwifb\n\nKeywords: install, packages, mistune\n\nLogfile:\n\n```\nFound local metadata for mistune-0.5.1\nFound local sources at /home/skraeling/sage/upstream/mistune-0.5.1.tar.gz\nChecksum: 21f0c7bf9bad7fac2e34355ed2c50e48557e2c8d vs 21f0c7bf9bad7fac2e34355ed2c50e48557e2c8d\nmistune-0.5.1\n====================================================\nSetting up build directory for mistune-0.5.1\nFinished set up\n****************************************************\nHost system:\nLinux angband 3.13.0-37-generic #64-Ubuntu SMP Mon Sep 22 21:30:01 UTC 2014 i686 i686 i686 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/home/skraeling/sage/local/libexec/gcc/i686-pc-linux-gnu/4.9.2/lto-wrapper\nTarget: i686-pc-linux-gnu\nConfigured with: ../src/configure --prefix=/home/skraeling/sage/local --with-local-prefix=/home/skraeling/sage/local --with-gmp=/home/skraeling/sage/local --with-mpfr=/home/skraeling/sage/local --with-mpc=/home/skraeling/sage/local --with-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm  \nThread model: posix\ngcc version 4.9.2 (GCC) \n****************************************************\nTraceback (most recent call last):\n  File \"/home/skraeling/sage/local/bin/pip\", line 9, in <module>\n    load_entry_point('pip==6.1.1', 'console_scripts', 'pip')()\n  File \"build/bdist.linux-i686/egg/pkg_resources/__init__.py\", line 521, in load_entry_point\n  File \"build/bdist.linux-i686/egg/pkg_resources/__init__.py\", line 2632, in load_entry_point\n  File \"build/bdist.linux-i686/egg/pkg_resources/__init__.py\", line 2312, in load\n  File \"build/bdist.linux-i686/egg/pkg_resources/__init__.py\", line 2318, in resolve\n  File \"/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/__init__.py\", line 15, in <module>\n    from pip.vcs import git, mercurial, subversion, bazaar  # noqa\n  File \"/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/vcs/mercurial.py\", line 10, in <module>\n    from pip.download import path_to_url\n  File \"/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/download.py\", line 32, in <module>\n    from pip._vendor import requests, six\n  File \"/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/_vendor/__init__.py\", line 92, in load_module\n    raise ImportError(\"No module named '%s'\" % (name,))\nImportError: No module named 'pip._vendor.requests'\nError installing mistune ... exiting\n\nreal\t0m0.545s\nuser\t0m0.232s\nsys\t0m0.076s\n************************************************************************\nError installing package mistune-0.5.1\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the relevant part of the log file\n  /home/skraeling/sage/logs/pkgs/mistune-0.5.1.log\nDescribe your computer, operating system, etc.\nIf you want to try to fix the problem yourself, *don't* just cd to\n/home/skraeling/sage/local/var/tmp/sage/build/mistune-0.5.1 and type 'make' or whatever is appropriate.\nInstead, the following commands setup all environment variables\ncorrectly and load a subshell for you to debug the error:\n  (cd '/home/skraeling/sage/local/var/tmp/sage/build/mistune-0.5.1' && '/home/skraeling/sage/sage' --sh)\nWhen you are done debugging, you can type \"exit\" to leave the subshell.\n************************************************************************\n```\n\nThis happened both before and after distclean.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18205\n\n",
    "created_at": "2015-04-15T14:27:29Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "mistune buggers up sage install",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17968",
    "user": "@darijgr"
}
```
CC:  @vbraun @kiwifb

Keywords: install, packages, mistune

Logfile:

```
Found local metadata for mistune-0.5.1
Found local sources at /home/skraeling/sage/upstream/mistune-0.5.1.tar.gz
Checksum: 21f0c7bf9bad7fac2e34355ed2c50e48557e2c8d vs 21f0c7bf9bad7fac2e34355ed2c50e48557e2c8d
mistune-0.5.1
====================================================
Setting up build directory for mistune-0.5.1
Finished set up
****************************************************
Host system:
Linux angband 3.13.0-37-generic #64-Ubuntu SMP Mon Sep 22 21:30:01 UTC 2014 i686 i686 i686 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/home/skraeling/sage/local/libexec/gcc/i686-pc-linux-gnu/4.9.2/lto-wrapper
Target: i686-pc-linux-gnu
Configured with: ../src/configure --prefix=/home/skraeling/sage/local --with-local-prefix=/home/skraeling/sage/local --with-gmp=/home/skraeling/sage/local --with-mpfr=/home/skraeling/sage/local --with-mpc=/home/skraeling/sage/local --with-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm  
Thread model: posix
gcc version 4.9.2 (GCC) 
****************************************************
Traceback (most recent call last):
  File "/home/skraeling/sage/local/bin/pip", line 9, in <module>
    load_entry_point('pip==6.1.1', 'console_scripts', 'pip')()
  File "build/bdist.linux-i686/egg/pkg_resources/__init__.py", line 521, in load_entry_point
  File "build/bdist.linux-i686/egg/pkg_resources/__init__.py", line 2632, in load_entry_point
  File "build/bdist.linux-i686/egg/pkg_resources/__init__.py", line 2312, in load
  File "build/bdist.linux-i686/egg/pkg_resources/__init__.py", line 2318, in resolve
  File "/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/__init__.py", line 15, in <module>
    from pip.vcs import git, mercurial, subversion, bazaar  # noqa
  File "/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/vcs/mercurial.py", line 10, in <module>
    from pip.download import path_to_url
  File "/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/download.py", line 32, in <module>
    from pip._vendor import requests, six
  File "/home/skraeling/sage/local/lib/python2.7/site-packages/pip-6.1.1-py2.7.egg/pip/_vendor/__init__.py", line 92, in load_module
    raise ImportError("No module named '%s'" % (name,))
ImportError: No module named 'pip._vendor.requests'
Error installing mistune ... exiting

real	0m0.545s
user	0m0.232s
sys	0m0.076s
************************************************************************
Error installing package mistune-0.5.1
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the relevant part of the log file
  /home/skraeling/sage/logs/pkgs/mistune-0.5.1.log
Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/home/skraeling/sage/local/var/tmp/sage/build/mistune-0.5.1 and type 'make' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
  (cd '/home/skraeling/sage/local/var/tmp/sage/build/mistune-0.5.1' && '/home/skraeling/sage/sage' --sh)
When you are done debugging, you can type "exit" to leave the subshell.
************************************************************************
```

This happened both before and after distclean.

Issue created by migration from https://trac.sagemath.org/ticket/18205





---

archive/issue_comments_241443.json:
```json
{
    "body": "This is caused by the last commit on #18080.\n\nI have made myself a branch u/darij/rm_mistune that reverts it, but I guess it breaks the IPython notebook.",
    "created_at": "2015-04-15T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241443",
    "user": "@darijgr"
}
```

This is caused by the last commit on #18080.

I have made myself a branch u/darij/rm_mistune that reverts it, but I guess it breaks the IPython notebook.



---

archive/issue_comments_241444.json:
```json
{
    "body": "Ah yes thats the pip issue again, forgot about that\n----\nNew commits:",
    "created_at": "2015-04-15T14:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241444",
    "user": "@vbraun"
}
```

Ah yes thats the pip issue again, forgot about that
----
New commits:



---

archive/issue_comments_241445.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-15T14:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241445",
    "user": "@vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_241446.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-15T14:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241446",
    "user": "@vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_241447.json:
```json
{
    "body": "Ah yes thats the pip issue again, forgot about that\n----\nNew commits:",
    "created_at": "2015-04-15T14:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241447",
    "user": "@vbraun"
}
```

Ah yes thats the pip issue again, forgot about that
----
New commits:



---

archive/issue_comments_241448.json:
```json
{
    "body": "Can't review a makefile, but can confirm that it compiles. Thank you!",
    "created_at": "2015-04-15T15:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241448",
    "user": "@darijgr"
}
```

Can't review a makefile, but can confirm that it compiles. Thank you!



---

archive/issue_comments_241449.json:
```json
{
    "body": "I guess it'll stay broken, then",
    "created_at": "2015-04-15T16:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241449",
    "user": "@vbraun"
}
```

I guess it'll stay broken, then



---

archive/issue_comments_241450.json:
```json
{
    "body": "OK, I'm assuming the things after the colon in build/deps are the dependencies of the thing before. And the spkg-install change is similar to what we have in other such files.\n\nPositive_review then!",
    "created_at": "2015-04-15T18:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241450",
    "user": "@darijgr"
}
```

OK, I'm assuming the things after the colon in build/deps are the dependencies of the thing before. And the spkg-install change is similar to what we have in other such files.

Positive_review then!



---

archive/issue_comments_241451.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-15T18:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241451",
    "user": "@darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_241452.json:
```json
{
    "body": "Stupid question: have you check if there is any call to `pip` left anywhere?",
    "created_at": "2015-04-15T21:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241452",
    "user": "@kiwifb"
}
```

Stupid question: have you check if there is any call to `pip` left anywhere?



---

archive/issue_comments_241453.json:
```json
{
    "body": "Yes, I checked.",
    "created_at": "2015-04-15T21:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241453",
    "user": "@vbraun"
}
```

Yes, I checked.



---

archive/issue_comments_241454.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-15T21:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17968#issuecomment-241454",
    "user": "@vbraun"
}
```

Resolution: fixed
