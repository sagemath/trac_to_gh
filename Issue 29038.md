# Issue 29038: DiGraph constructor not able to handle incidence matrix [[1], [-1]]

Issue created by migration from https://trac.sagemath.org/ticket/29275

Original creator: @vipul79321

Original creation time: 2020-03-03 18:51:47

CC:  dcoudert

Currently, DiGraph constructor throws error for following type of incidence matrix.

```
sage: m=Matrix([[1,-1],[-1,1]])
sage: g=DiGraph(m,format='incidence_matrix')
Traceback (most recent call last)
...
ValueError: each column represents an edge: -1 goes to 1
```



---

Comment by @vipul79321 created at 2020-03-03 18:56:59

New commits:


---

Comment by @vipul79321 created at 2020-03-03 18:56:59

Changing status from new to needs_review.


---

Comment by @vipul79321 created at 2020-03-03 19:28:18

Changing type from PLEASE CHANGE to defect.


---

Comment by dcoudert created at 2020-03-04 07:54:04

Instead of `L = sorted(set(c.list()))`, we could use `L = [c[i] for i in NZ]`, no ?
and then we would only had to check that `sorted(L) == [-1, 1]`


---

Comment by git created at 2020-03-04 08:29:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-04 08:29:30

Replying to [comment:3 dcoudert]:
> Instead of `L = sorted(set(c.list()))`, we could use `L = [c[i] for i in NZ]`, no ?
> and then we would only had to check that `sorted(L) == [-1, 1]`
Done


---

Comment by dcoudert created at 2020-03-04 08:46:10

the comments for #29276 also apply here: ensure that you can handle a column with only zeros, add relevant doctests.


---

Comment by @vipul79321 created at 2020-03-04 08:58:25

Replying to [comment:6 dcoudert]:
> the comments for #29276 also apply here: ensure that you can handle a column with only zeros, add relevant doctests.
can i add following doctest for both #29275 and #29276:


```
TESTS:

Fix bug reported in :trac:`29275` and :trac:`29276`::

    sage: m = Matrix([[0,1],[0,-1]])
    sage: m
    [ 0  1]
    [ 0 -1]
    sage: G = DiGraph(m,format='incidence_matrix')
    sage: list(G.edges(labels=False))
    [(1, 0)]
```


or shall I add separate doctest for this ticket?


---

Comment by dcoudert created at 2020-03-04 09:06:59

separated dockets is better.


---

Comment by git created at 2020-03-04 09:27:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-04 09:28:10

Replying to [comment:8 dcoudert]:
> separated dockets is better.
Done


---

Comment by dcoudert created at 2020-03-04 10:08:39

If #29276 is duplicate of this ticket, we can make all doctests refer to this ticket.

Don't forget to add your name in Authors field.


---

Comment by @vipul79321 created at 2020-03-04 12:00:01

Replying to [comment:11 dcoudert]:
> If #29276 is duplicate of this ticket, we can make all doctests refer to this ticket.
No, I dont think #29276 is duplicate of #29275 both have completely different aim. #29275 is more of defect and #29276 is somewhat type of enhancement.
Although both have same branches performing same thing.
If you want, I can make `u/gh-vipul79321/ticket29275` specifically for #29275 by removing `if not NZ` part from code and corresponding doctest.


---

Comment by dcoudert created at 2020-03-04 12:02:57

You have to ensure that tickets are not touching the same part of the code, otherwise we may have merge conflicts.

One option is to do everything in this ticket (certainly the easiest solution), and the other is to ensure that tickets are completely independent. I let you decide.


---

Comment by @vipul79321 created at 2020-03-04 13:06:52

Replying to [comment:14 dcoudert]:
> You have to ensure that tickets are not touching the same part of the code, otherwise we may have merge conflicts.
> 
> One option is to do everything in this ticket (certainly the easiest solution), and the other is to ensure that tickets are completely independent. I let you decide.

If that's the case then, It would be better to go with easiest solution for clean merging.
But I dont want to make doctest of ticket #29276 refer to ticket #29275. Can we keep it as it is?


---

Comment by dcoudert created at 2020-03-04 13:24:32

If we keep only one ticket, we cannot refer the other ticket.
You can adjust the ticket description for instance like:
- title: `fix issues in the DiGraph constructor for incidence matrix`
- description: merge all issues.


---

Comment by git created at 2020-03-04 13:50:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-03-04 16:52:53

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2020-03-04 16:52:53

LGTM.


---

Comment by vbraun created at 2020-03-08 11:27:10

Resolution: fixed
