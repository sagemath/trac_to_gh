# Issue 13232: Improve _repr_ for macdonald symmetric functions and friends and further cleanup

Issue created by migration from https://trac.sagemath.org/ticket/13404

Original creator: nthiery

Original creation time: 2012-08-27 07:41:56

Assignee: sage-combinat

CC:  zabrocki aschilling saliola

Keywords: symmetric functions,




---

Comment by hthomas created at 2012-08-27 11:44:00

Salut Nicolas--

My 2c: 

"in the ... basis", not "on the ... basis".  

And for me, I don't think of the h basis as "homogeneous", but rather as "complete".  The bases are all homogeneous, after all!  I guess some people say "complete homogeneous", and maybe that's best -- it gives the word "complete" more meaning (i.e., the h_i are complete subject to being homogeneous).  But maybe I was brought up wrong...

cheers,

Hugh


---

Comment by saliola created at 2012-08-27 13:21:13

I agree with Hugh regarding "homogeneous". I prefer "complete" or "complete homogeneous".


---

Comment by aschilling created at 2012-08-27 21:27:31

Replying to [comment:4 saliola]:
> I agree with Hugh regarding "homogeneous". I prefer "complete" or "complete homogeneous".

I definitely disagree. Most author abbreviate to "homogeneous". Why is this symbol for this "h" and not "c"? You can change it to "complete homogeneous" if you care about this. But I think just "complete" is a confusing convention.


---

Comment by zabrocki created at 2012-08-28 02:23:33

I'm not super keen on just the name 'complete,' at least not as an 'only' option.  To go with what the textbooks say (since they set they tend to motivate the notation in other references) : to describe the generators h_n, Macdonald uses "complete symmetric function" (but then uses the word 'complete' only rarely elsewhere in the book), Sagan and Stanley uses "complete homogeneous symmetric functions".  When I write and I shorten 'complete homogeneous' I go with 'homogeneous' and I can provide lots of references that uses this name.  The short name 'h' to me is short for 'homogeneous.'  While I don't mind using both names, I would vote against restricting to the name 'complete' only.


---

Comment by nthiery created at 2012-08-31 09:14:11

Changing keywords from "symmetric functions," to "symmetric functions".


---

Comment by nthiery created at 2012-08-31 09:14:11

Changing status from new to needs_review.


---

Comment by nthiery created at 2012-08-31 10:43:15

Oops: the updated patch fixes two remaining fixing doctests and an indirect doctest.


---

Comment by nthiery created at 2012-08-31 11:10:36

Green light; all tested passed as well 5.3.rc0 on sage.math.u-psud.fr.


---

Comment by aschilling created at 2012-08-31 18:42:45

I looked over the patch and overall it looks very good to me. Thanks, Nicolas, for making these changes! Just a quick questions: so this is now consistent with NSym and QSym, right?

Here is one question:

```
                            sage: SymmetricFunctions(FractionField(QQ['q','t'])).macdonald().P() 
	 	            Macdonald polynomials in the P basis over Fraction Field of Multivariate Polynomial Ring in q, t over Rational Field 
1017	 	            sage: SymmetricFunctions(FractionField(QQ['q','t'])).macdonald(t=2).P() 
1018	 	            Macdonald polynomials in the P basis with t=2 over Fraction Field of Multivariate Polynomial Ring in q, t over Rational Field 
1019	 	            sage: SymmetricFunctions(FractionField(QQ['q','t'])).macdonald(q=2).P() 
1020	 	            Macdonald polynomials in the P basis with q=2 over Fraction Field of Multivariate Polynomial Ring in q, t over Rational Field 
1021	 	            sage: SymmetricFunctions(FractionField(QQ['q','t'])).macdonald(q=2, t=2).P() 
1022	 	            Macdonald polynomials in the P basis with q=2 and t=2 over Fraction Field of Multivariate Polynomial Ring in q, t over Rational Field 
1023	 	            sage: Sym = SymmetricFunctions(FractionField(QQ['t'])).macdonald() 
1024	 	            Traceback (most recent call last): 
1025	 	            ... 
1026	 	            ValueError: parameter q must be in the base ring 
 	1019	            sage: Sym = SymmetricFunctions(FractionField(QQ['q,t'])); Sym.rename("Sym"); Sym 
 	1020	            Sym 
 	1021	            sage: Sym.macdonald().P() 
 	1022	            Sym in the Macdonald P basis 
 	1023	            sage: Sym.macdonald(t=2).P() 
 	1024	            Sym in the Macdonald P with t=2 basis 
 	1025	            sage: Sym.rename() 
 	1026	 
 	1027	        TESTS:: 
 	1028	 
 	1029	            sage: Sym.macdonald().P()._prefix 
 	1030	            'McdP' 
 	1031	            sage: Sym.macdonald().Ht()._prefix 
 	1032	            'McdHt' 
```

Don't you want to keep some tests when q is set to a value or both parameters are set to a value?

Also, where is zee specified in this code?

```
 	1519	    def _dual_basis_default(self): 
 	1520	        """ 
 	1521	        Returns the default value for ``self.dual_basis()`` 
 	1522	 
 	1523	        .. SEEALSO:: :meth:`dual_basis` 
 	1524	 
 	1525	        EXAMPLES: 
 	1526	 
 	1527	        This default implementation constructs the dual basis using 
 	1528	        the standard (Hall) scalar product:: 
 	1529	 
 	1530	            sage: Sym = SymmetricFunctions(QQ) 
 	1531	            sage: Sym.p()._dual_basis_default() 
 	1532	            Dual basis to Symmetric Functions over Rational Field in the powersum basis with respect to the Hall scalar product 
 	1533	 
 	1534	        This is meant to be overiden by subclasses for which an 
 	1535	        explicit dual basis is known:: 
 	1536	 
 	1537	            sage: Sym.s()._dual_basis_default() 
 	1538	            Symmetric Functions over Rational Field in the Schur basis 
 	1539	            sage: Sym.h()._dual_basis_default() 
 	1540	            Symmetric Functions over Rational Field in the monomial basis 
 	1541	            sage: Sym.m()._dual_basis_default() 
 	1542	            Symmetric Functions over Rational Field in the homogeneous basis 
 	1543	            sage: Sym.f()._dual_basis_default() 
 	1544	            Symmetric Functions over Rational Field in the elementary basis 
 	1545	            sage: Sym.e()._dual_basis_default() 
 	1546	            Symmetric Functions over Rational Field in the forgotten basis 
 	1547	        """ 
 	1548	        return self.dual_basis(scalar=zee, scalar_name = "Hall scalar product") 
```


Other than these questions I am happy to set a positive review!

Anne


---

Comment by nthiery created at 2012-08-31 20:29:29

Hi Anne,

Replying to [comment:12 aschilling]:
> I looked over the patch and overall it looks very good to me. Thanks, Nicolas, for making these changes!

You are welcome!

> Just a quick questions: so this is now consistent with NSym and QSym, right?

Yes! Well, almost: there remains the on->in change for NSym and Qsym
(and in general "with realizations"), but that's for another patch.

> Don't you want to keep some tests when q is set to a value or both parameters are set to a value?

That would have been better indeed. That being said, the doctests of
SymmetricFunctionsBases.ParentMethods._repr_ includes an example with
two parameters, and the failure when q is wrong is tested in
Macdonald.__init__; so if you don't mind I'll be lazy and leave things
as is.

> Also, where is zee specified in this code?

```
 	1519	    def _dual_basis_default(self): 
 	1520	        ...
 	1548	        return self.dual_basis(scalar=zee, scalar_name = "Hall scalar product") 
                                                      ^^^ Here ?
```


> Other than these questions I am happy to set a positive review!

Thanks!

Cheers,
                 Nicolas


---

Comment by nthiery created at 2012-08-31 21:04:44

zee is defined as a function around the top of sfa.py.

Cheers,
                   Nicolas


---

Comment by aschilling created at 2012-08-31 21:06:23

Could you please also comment on this line in the commit message:

"- Updated to doctests in jack.py: the new outputs are equal but
  not identical to the previous ones. Why did it change?"

Could you please be more specific what previous means and what precisely is equal, but not identical?

Anne


---

Comment by nthiery created at 2012-08-31 21:21:42

Replying to [comment:15 aschilling]:
> Could you please be more specific what previous means and what precisely is equal, but not identical?

It's about this hunk:


```
@@ -363,21 +361,18 @@ class Jack(UniqueRepresentation):
             sage: Sym = SymmetricFunctions(FractionField(QQ['t']))
             sage: JP = Sym.jack().P()
             sage: JQp = Sym.jack().Qp(); JQp
-            Jack polynomials in the Qp basis over Fraction Field of Univariate Polynomial Ring in t over Rational Field
+            Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field in the Jack Qp basis
             sage: a = JQp([2])
             sage: a.scalar(JP([2]))
             1
             sage: a.scalar(JP([1,1]))
             0
             sage: JP(JQp([2]))                        # todo: missing auto normalization
-            ((-t+1)/(-t-1))*JackP[1, 1] + JackP[2]
+            ((2*t-2)/(2*t+2))*JackP[1, 1] + JackP[2]
             sage: JP._normalize(JP(JQp([2])))
-            ((-t+1)/(-t-1))*JackP[1, 1] + JackP[2]
+            ((t-1)/(t+1))*JackP[1, 1] + JackP[2]
         """
```



---

Comment by aschilling created at 2012-08-31 21:50:45

Yes, this is weird, but I think it is related to the comment "missing auto normalization". Mike and I ran into a similar issue win 5457.

Patch looks good otherwise!

Anne


---

Comment by aschilling created at 2012-08-31 21:51:07

Changing status from needs_review to positive_review.


---

Comment by aschilling created at 2012-09-01 04:36:36

There is one more thing that Mike pointed out to me. Currently we have

```
sage: Sym = SymmetricFunctions(FractionField(QQ['t']))
sage: ks = Sym.kschur(4)
sage: ks
4-Schur functions with t=t
sage: s = Sym.schur()
sage: s
Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field in the Schur basis
```

Should ks be changed to

```
4-Bounded Subspace of Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field in the 4-Schur basis
```


Thanks,

Anne


---

Comment by aschilling created at 2012-09-01 04:36:52

Changing status from positive_review to needs_info.


---

Comment by nthiery created at 2012-09-01 06:40:42

Replying to [comment:19 aschilling]:
> There is one more thing that Mike pointed out to me. Currently we have
> {{{
> sage: Sym = SymmetricFunctions(FractionField(QQ['t']))
> sage: ks = Sym.kschur(4)
> sage: ks
> 4-Schur functions with t=t
> sage: s = Sym.schur()
> sage: s
> Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field in the Schur basis
> }}}
> Should ks be changed to
> {{{
> 4-Bounded Subspace of Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field in the 4-Schur basis
> }}}

Good question. It's a bit long, but has some desirable features
besides consistency with realizations/bases:

- The ground field is specified
- It refers to Sym, in such a way that if Sym is renamed to something short, this gets shorter as well

Btw 1: it would be good to have t specified in the name of the kBoundedSubspace.


```
sage: Sym.kBoundedSubspace(3)
3-bounded Subspace of Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field
sage: Sym.kBoundedSubspace(3,1)
3-bounded Subspace of Symmetric Functions over Fraction Field of Univariate Polynomial Ring in t over Rational Field with t = 1
```


Btw 2: in the docstrings of new_kschur, wouldn't we want to change


```
sage: KBoundedSubspace(Sym,3,1)
```


to

```
sage: Sym.kBoundedSubspace(3,1)
```


(except probably once in the __init__, for testing purposes)?

I am not sure I'll have the time to implement that before Tuesday, so
feel free to beat me to it.

Cheers,
                           Nicolas


---

Comment by zabrocki created at 2012-09-03 20:53:13

I made the changes to the k-Schur functions and k-bounded subspace names.  Both the space and the basis depend on the value of t and the naming follows this dependency.  I did not yet change the "Btw 2" that Nicolas mentions so I will not set to "needs review" yet, but let me know if you are satisfied with the naming conventions.

Also I rebased Nicolas' patch to reflect changes in dependencies and changes to #5457 and #13399.


---

Comment by zabrocki created at 2012-09-03 23:06:39

Changing status from needs_info to needs_review.


---

Comment by zabrocki created at 2012-09-03 23:06:39

Latest patch modifies the doc-tests in new_kschur.py to reflect Nicolas' note "Btw 2".  If you are happy with the names, this is ready for review.


---

Comment by aschilling created at 2012-09-04 00:25:52

Replying to [comment:23 zabrocki]:
> Latest patch modifies the doc-tests in new_kschur.py to reflect Nicolas' note "Btw 2".  If you are happy with the names, this is ready for review.

Hi Mike, the changes look good to me with one exception. Nicolas mentioned in his Btw 2:
"(except probably once in the init, for testing purposes)". Could you please leave one of the original kBoundedSubspace tests in the _init_ ?

Other than that, all tests pass for me on sage-5.3.rc0 + 2 5457 patches + 13399 patch.

Anne


---

Comment by zabrocki created at 2012-09-04 00:54:02

> Hi Mike, the changes look good to me with one exception. Nicolas mentioned in his Btw 2:
> "(except probably once in the init, for testing purposes)". Could you please leave one of the original kBoundedSubspace tests in the _init_ ?
Thanks for catching that.  I had that change but didn't qrefresh before I attached the patch.

Ignore/delete the patch trac_13404_kschur_rename-mz.2.patch ... it was an accident


---

Comment by aschilling created at 2012-09-04 03:01:48

Replying to [comment:25 zabrocki]:
> > Hi Mike, the changes look good to me with one exception. Nicolas mentioned in his Btw 2:
> > "(except probably once in the init, for testing purposes)". Could you please leave one of the original kBoundedSubspace tests in the _init_ ?
> Thanks for catching that.  I had that change but didn't qrefresh before I attached the patch.
> 
> Ignore/delete the patch trac_13404_kschur_rename-mz.2.patch ... it was an accident

Ok, looks good and tests pass!

Anne


---

Comment by aschilling created at 2012-09-04 03:02:01

Changing status from needs_review to positive_review.


---

Comment by nthiery created at 2012-09-04 10:07:40

Replying to [comment:25 zabrocki]:
> Ignore/delete the patch trac_13404_kschur_rename-mz.2.patch ... it was an accident

Deleted.

Thanks for finalizing this patch!


---

Comment by nthiery created at 2012-09-04 10:08:23

And thanks Anne for the review!


---

Comment by aschilling created at 2012-09-05 15:50:49

Hi Nicolas and Mike,

I fodled your two patches together and commuted it past 13399, so that it now only depends on #5457. I did not change any content.

Please and set a positive review if happy!

Anne


---

Comment by aschilling created at 2012-09-05 15:51:58

Apply: trac_13404-sf-nt.3.patch


---

Comment by zabrocki created at 2012-09-05 16:15:38

I've tested and looked it over and I am happy with it.  Thanks Anne for doing all the work to get these cleaned up.  12140-comment!  It has a positive review already so I'm not changing anything but I am satisfied it seems to apply cleanly and runs as before.


---

Comment by aschilling created at 2012-09-08 05:03:57

The new uploaded patch fixes a doc test failure in relation with #8899.

Anne


---

Attachment


---

Comment by nthiery created at 2012-09-08 09:20:28

I double checked the change and confirm the positive review. Thanks Anne!


---

Comment by jdemeyer created at 2012-09-11 07:58:12

Resolution: fixed
