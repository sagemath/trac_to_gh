# Issue 26677: py3: fixing doctests in elliptic_curves/cm.py

Issue created by migration from https://trac.sagemath.org/ticket/26914

Original creator: chapoton

Original creation time: 2018-12-18 16:53:05

CC:  tscrim cremona

by more sorting of discriminants




---

Comment by chapoton created at 2018-12-18 16:53:30

New commits:


---

Comment by chapoton created at 2018-12-18 16:53:30

Changing status from new to needs_review.


---

Comment by cremona created at 2018-12-18 17:33:04

All looks fine apart from this:

```
-    dlist = sum([v for h, v in iteritems(discriminants_with_bounded_class_number(K.degree(), proof=proof))], [])
+    dlist = sorted(Df for v in discriminants_with_bounded_class_number(K.degree(), proof=proof).values() for Df in v)
```

whose syntax looks suspicious to me.


---

Comment by chapoton created at 2018-12-18 19:00:40

Hmm. Why suspicious ? The "sorted" is the only real change we are making here. If my understanding of the mathematics involved is ok, this should not be a problem.

Or maybe you are troubled by the double for ? This is a perfectly valid python syntax. We can chain the "for", the second one depending on the argument of the first. Here the effect is to flatten a list of lists.

https://www.python.org/dev/peps/pep-0289/


---

Comment by cremona created at 2018-12-18 19:33:10

Replying to [comment:3 chapoton]:
> Hmm. Why suspicious ? The "sorted" is the only real change we are making here. If my understanding of the mathematics involved is ok, this should not be a problem.
> 
> Or maybe you are troubled by the double for ? This is a perfectly valid python syntax. We can chain the "for", the second one depending on the argument of the first. Here the effect is to flatten a list of lists.
> 
> https://www.python.org/dev/peps/pep-0289/

Thanks for the lesson!  I had never seen a double for so thought it was a mistake (and did not have time to check).


---

Comment by git created at 2018-12-18 21:07:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-12-19 07:49:58

green bot, ready for review


---

Comment by cremona created at 2018-12-19 08:57:00

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-12-23 23:39:33

Resolution: fixed
