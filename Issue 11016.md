# Issue 11016: Make testcc.sh exit with an exit code of 1 if attempting to compile a file fails.

archive/issues_011016.json:
```json
{
    "body": "CC:  jhpalmieri mkoeppe @kliem\n\nThe script `$SAGE_LOCAL/bin/testcc.sh` checks to see what C compiler the environment variable `$CC` is. But currently the script always exits with a 0, even if an error occurs. \n\nThis patch will correct that. \n\nNote some forms of error will not be detected. If CC is defined as `ls`, then the code will try to list the C file, which will succeed without error. But the changes will allow one to check if a compiler is installed or not. \n\n\n```\ndrkirkby@hawk:~$ export CC=cc\ndrkirkby@hawk:~$ sage-4.7.alpha3/local/bin/testcc.sh $CC\nSun_Studio\ndrkirkby@hawk:~$ export CC=gcc\ndrkirkby@hawk:~$ sage-4.7.alpha3/local/bin/testcc.sh $CC\nGCC\ndrkirkby@hawk:~$ export CC=junk\ndrkirkby@hawk:~$ sage-4.7.alpha3/local/bin/testcc.sh $CC\nError - junk is not compiling a C file properly\n```\n\n\nSince the `testcc.sh` script is not under revision control, the attached file just needs to replace the one currently in Sage. The patch is for review purposes only.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11169\n\n",
    "created_at": "2011-04-10T21:06:11Z",
    "labels": [
        "scripts",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Make testcc.sh exit with an exit code of 1 if attempting to compile a file fails.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11016",
    "user": "drkirkby"
}
```
CC:  jhpalmieri mkoeppe @kliem

The script `$SAGE_LOCAL/bin/testcc.sh` checks to see what C compiler the environment variable `$CC` is. But currently the script always exits with a 0, even if an error occurs. 

This patch will correct that. 

Note some forms of error will not be detected. If CC is defined as `ls`, then the code will try to list the C file, which will succeed without error. But the changes will allow one to check if a compiler is installed or not. 


```
drkirkby@hawk:~$ export CC=cc
drkirkby@hawk:~$ sage-4.7.alpha3/local/bin/testcc.sh $CC
Sun_Studio
drkirkby@hawk:~$ export CC=gcc
drkirkby@hawk:~$ sage-4.7.alpha3/local/bin/testcc.sh $CC
GCC
drkirkby@hawk:~$ export CC=junk
drkirkby@hawk:~$ sage-4.7.alpha3/local/bin/testcc.sh $CC
Error - junk is not compiling a C file properly
```


Since the `testcc.sh` script is not under revision control, the attached file just needs to replace the one currently in Sage. The patch is for review purposes only.

Issue created by migration from https://trac.sagemath.org/ticket/11169





---

archive/issue_comments_119782.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-10T22:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119782",
    "user": "drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_119783.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2011-04-10T22:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119783",
    "user": "drkirkby"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_119784.json:
```json
{
    "body": "Where is test.cc used?  It does not seem to be used by prereq-0.9 in sage-4.7.rc4.",
    "created_at": "2011-05-25T13:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119784",
    "user": "mariah"
}
```

Where is test.cc used?  It does not seem to be used by prereq-0.9 in sage-4.7.rc4.



---

archive/issue_comments_119785.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-05-25T13:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119785",
    "user": "mariah"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_119786.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd32\".",
    "created_at": "2011-08-24T23:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119786",
    "user": "was"
}
```

Changing keywords from "" to "sd32".



---

archive/issue_comments_119787.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-01-31T23:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119787",
    "user": "drkirkby"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_119788.json:
```json
{
    "body": "Replying to [comment:2 mariah]:\n> Where is test.cc used?  It does not seem to be used by prereq-0.9 in sage-4.7.rc4.\n\nSome of the .spkg's use it. Not many I must admit, but a few do, mainly in an attempt to support the Sun (now Oracle) compiler, but it might be used for AIX/HP-UX too. \n\nIt would be worth fixing this bug. It might be sensible to add support for 'clang' to this script later, although since that's supposed to be compatible with gcc, perhaps it's not needed.",
    "created_at": "2012-01-31T23:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119788",
    "user": "drkirkby"
}
```

Replying to [comment:2 mariah]:
> Where is test.cc used?  It does not seem to be used by prereq-0.9 in sage-4.7.rc4.

Some of the .spkg's use it. Not many I must admit, but a few do, mainly in an attempt to support the Sun (now Oracle) compiler, but it might be used for AIX/HP-UX too. 

It would be worth fixing this bug. It might be sensible to add support for 'clang' to this script later, although since that's supposed to be compatible with gcc, perhaps it's not needed.



---

archive/issue_comments_119789.json:
```json
{
    "body": "Attachment",
    "created_at": "2012-04-02T10:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119789",
    "user": "jdemeyer"
}
```

Attachment



---

archive/issue_comments_119790.json:
```json
{
    "body": "I'm not entirely sure this patch is a good idea.  How universal is the command line option \"-E\" to run the preprocessor?",
    "created_at": "2012-04-02T10:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119790",
    "user": "jdemeyer"
}
```

I'm not entirely sure this patch is a good idea.  How universal is the command line option "-E" to run the preprocessor?



---

archive/issue_comments_119791.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2012-04-02T10:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119791",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_119792.json:
```json
{
    "body": "is this ancient ticket now obsolete ?",
    "created_at": "2020-04-26T19:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119792",
    "user": "chapoton"
}
```

is this ancient ticket now obsolete ?



---

archive/issue_comments_119793.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-04-26T19:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119793",
    "user": "chapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_119794.json:
```json
{
    "body": "I agree that this is invalid.\n\nCurrently, there is no use case for this ticket. We only use `local/bin/testcc.sh` to check whether or not a compiler is `GCC` or `Sun_Studio` or `HP_on_HP-UX`. It is never used to check whether or not a compiler is suitable for anything.",
    "created_at": "2020-04-27T19:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119794",
    "user": "@kliem"
}
```

I agree that this is invalid.

Currently, there is no use case for this ticket. We only use `local/bin/testcc.sh` to check whether or not a compiler is `GCC` or `Sun_Studio` or `HP_on_HP-UX`. It is never used to check whether or not a compiler is suitable for anything.



---

archive/issue_comments_119795.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-27T19:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119795",
    "user": "@kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_119796.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2020-04-27T19:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11016#issuecomment-119796",
    "user": "chapoton"
}
```

Resolution: invalid
