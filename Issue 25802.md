# Issue 25802: LieAlgebraHomset is not unique

Issue created by migration from Trac.

Original creator: @ehaka

Original creation time: 2018-08-10 05:38:15

Keywords: Lie algebras, morphisms

`sage.algebras.lie_algebras.morphism.LieAlgebraHomset` does not have the same unique behavior as Hom. A minimal example:


```
sage: from sage.algebras.lie_algebras.morphism import LieAlgebraHomset
sage: L = LieAlgebra(QQ,1,abelian=True)
sage: LieAlgebraHomset(L,L) == LieAlgebraHomset(L,L)
True
sage: LieAlgebraHomset(L,L) is LieAlgebraHomset(L,L)
False
```


This causes an issue with pickling for `LieAlgebraHomomorphism_im_gens`. Running

```python
L.<X> = LieAlgebra(QQ,1,abelian=True)
f = LieAlgebraHomomorphism_im_gens(LieAlgebraHomset(L,L),[X])
f._test_pickling()
```

outputs

```
RuntimeError: There is a bug in the coercion code in Sage.
Both x (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X) and y (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X) are supposed to have identical parents but they don't.
In fact, x has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'
whereas y has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'
Original elements Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and maps
<type 'NoneType'> None
<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'> (map internal to coercion system -- copy before use)
Coercion map:
  From: Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field
  To:   Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field
```



---

Comment by tscrim created at 2018-08-10 06:10:40

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-08-10 06:10:40

This is actually the correct behavior I believe. Part of the reason is that `Hom` already does the caching:

```
sage: Hom(L,L) is Hom(L,L)
True
```

The other is that `*Homset` should (in principle) work with something that is not a `UniqueRepresentation`, in which case it should not support that UR behavior.

Yes, it is subtle, and I am not completely sure it is properly documented. However, it is what should be happening and you should be using `Hom` to construct the homset.


---

Comment by @ehaka created at 2018-08-10 08:01:26

I see, it seems that indeed also the Homset superclass behaves the same way. Good to know for the future, thanks!


---

Comment by tscrim created at 2018-08-10 09:53:20

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid
