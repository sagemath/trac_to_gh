# Issue 25802: LieAlgebraHomset is not unique

archive/issues_025802.json:
```json
{
    "body": "Keywords: Lie algebras, morphisms\n\n`sage.algebras.lie_algebras.morphism.LieAlgebraHomset` does not have the same unique behavior as Hom. A minimal example:\n\n\n```\nsage: from sage.algebras.lie_algebras.morphism import LieAlgebraHomset\nsage: L = LieAlgebra(QQ,1,abelian=True)\nsage: LieAlgebraHomset(L,L) == LieAlgebraHomset(L,L)\nTrue\nsage: LieAlgebraHomset(L,L) is LieAlgebraHomset(L,L)\nFalse\n```\n\n\nThis causes an issue with pickling for `LieAlgebraHomomorphism_im_gens`. Running\n\n```python\nL.<X> = LieAlgebra(QQ,1,abelian=True)\nf = LieAlgebraHomomorphism_im_gens(LieAlgebraHomset(L,L),[X])\nf._test_pickling()\n```\n\noutputs\n\n```\nRuntimeError: There is a bug in the coercion code in Sage.\nBoth x (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X) and y (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X) are supposed to have identical parents but they don't.\nIn fact, x has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'\nwhereas y has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'\nOriginal elements Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and maps\n<type 'NoneType'> None\n<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'> (map internal to coercion system -- copy before use)\nCoercion map:\n  From: Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field\n  To:   Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26039\n\n",
    "created_at": "2018-08-10T05:38:15Z",
    "labels": [
        "algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "LieAlgebraHomset is not unique",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25802",
    "user": "@ehaka"
}
```
Keywords: Lie algebras, morphisms

`sage.algebras.lie_algebras.morphism.LieAlgebraHomset` does not have the same unique behavior as Hom. A minimal example:


```
sage: from sage.algebras.lie_algebras.morphism import LieAlgebraHomset
sage: L = LieAlgebra(QQ,1,abelian=True)
sage: LieAlgebraHomset(L,L) == LieAlgebraHomset(L,L)
True
sage: LieAlgebraHomset(L,L) is LieAlgebraHomset(L,L)
False
```


This causes an issue with pickling for `LieAlgebraHomomorphism_im_gens`. Running

```python
L.<X> = LieAlgebra(QQ,1,abelian=True)
f = LieAlgebraHomomorphism_im_gens(LieAlgebraHomset(L,L),[X])
f._test_pickling()
```

outputs

```
RuntimeError: There is a bug in the coercion code in Sage.
Both x (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X) and y (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X) are supposed to have identical parents but they don't.
In fact, x has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'
whereas y has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'
Original elements Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and maps
<type 'NoneType'> None
<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'> (map internal to coercion system -- copy before use)
Coercion map:
  From: Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field
  To:   Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field
```


Issue created by migration from https://trac.sagemath.org/ticket/26039





---

archive/issue_comments_364229.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-10T06:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25802#issuecomment-364229",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_364230.json:
```json
{
    "body": "This is actually the correct behavior I believe. Part of the reason is that `Hom` already does the caching:\n\n```\nsage: Hom(L,L) is Hom(L,L)\nTrue\n```\n\nThe other is that `*Homset` should (in principle) work with something that is not a `UniqueRepresentation`, in which case it should not support that UR behavior.\n\nYes, it is subtle, and I am not completely sure it is properly documented. However, it is what should be happening and you should be using `Hom` to construct the homset.",
    "created_at": "2018-08-10T06:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25802#issuecomment-364230",
    "user": "tscrim"
}
```

This is actually the correct behavior I believe. Part of the reason is that `Hom` already does the caching:

```
sage: Hom(L,L) is Hom(L,L)
True
```

The other is that `*Homset` should (in principle) work with something that is not a `UniqueRepresentation`, in which case it should not support that UR behavior.

Yes, it is subtle, and I am not completely sure it is properly documented. However, it is what should be happening and you should be using `Hom` to construct the homset.



---

archive/issue_comments_364231.json:
```json
{
    "body": "I see, it seems that indeed also the Homset superclass behaves the same way. Good to know for the future, thanks!",
    "created_at": "2018-08-10T08:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25802#issuecomment-364231",
    "user": "@ehaka"
}
```

I see, it seems that indeed also the Homset superclass behaves the same way. Good to know for the future, thanks!



---

archive/issue_comments_364232.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-10T09:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25802#issuecomment-364232",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_364233.json:
```json
{
    "body": "Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25802#issuecomment-364233",
    "user": "embray"
}
```

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_comments_364234.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25802#issuecomment-364234",
    "user": "embray"
}
```

Resolution: invalid
