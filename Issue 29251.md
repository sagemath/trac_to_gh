# Issue 29251: sage-spkg: Advertise sage -buildsh, not sage -sh

archive/issues_029251.json:
```json
{
    "body": "CC:  dimpase jhpalmieri\n\nFollow-up from #29052, which removed environment variables only needed at build time of sage-the-distribution from the `sage-env`.\n\nConsequently, the debugging hints displayed by sage-spkg at the end of a failing build should say `sage-buildsh` instead of `sage-sh`.\n\nSee also #29045.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29488\n\n",
    "created_at": "2020-04-09T18:28:19Z",
    "labels": [
        "build",
        "critical",
        "bug"
    ],
    "title": "sage-spkg: Advertise sage -buildsh, not sage -sh",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29251",
    "user": "mkoeppe"
}
```
CC:  dimpase jhpalmieri

Follow-up from #29052, which removed environment variables only needed at build time of sage-the-distribution from the `sage-env`.

Consequently, the debugging hints displayed by sage-spkg at the end of a failing build should say `sage-buildsh` instead of `sage-sh`.

See also #29045.


Issue created by migration from https://trac.sagemath.org/ticket/29488





---

archive/issue_comments_414506.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-09T22:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414506",
    "user": "jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_414507.json:
```json
{
    "body": "Many `spkg-check.in` and `spkg-install.in` files contain\n\n```\nif [ -z \"$SAGE_LOCAL\" ]; then\n    echo >&2 \"Error: SAGE_LOCAL undefined - exiting...\"\n    echo >&2 \"Maybe run 'sage -sh'?\"\n    exit 1\nfi\n```\n\nShould these lines just be deleted?",
    "created_at": "2020-04-09T22:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414507",
    "user": "jhpalmieri"
}
```

Many `spkg-check.in` and `spkg-install.in` files contain

```
if [ -z "$SAGE_LOCAL" ]; then
    echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
    echo >&2 "Maybe run 'sage -sh'?"
    exit 1
fi
```

Should these lines just be deleted?



---

archive/issue_comments_414508.json:
```json
{
    "body": "Anyway, here's a first draft (without any changes to those \"spkg-*.in\" files).\n----\nNew commits:",
    "created_at": "2020-04-09T22:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414508",
    "user": "jhpalmieri"
}
```

Anyway, here's a first draft (without any changes to those "spkg-*.in" files).
----
New commits:



---

archive/issue_comments_414509.json:
```json
{
    "body": "Replying to [comment:1 jhpalmieri]:\n> Many `spkg-check.in` and `spkg-install.in` files contain\n> {{{\n> if [ -z \"$SAGE_LOCAL\" ]; then\n>     echo >&2 \"Error: SAGE_LOCAL undefined - exiting...\"\n>     echo >&2 \"Maybe run 'sage -sh'?\"\n>     exit 1\n> fi\n> }}}\n> Should these lines just be deleted?\n\nYes, I think so -- they are outdated",
    "created_at": "2020-04-09T22:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414509",
    "user": "mkoeppe"
}
```

Replying to [comment:1 jhpalmieri]:
> Many `spkg-check.in` and `spkg-install.in` files contain
> {{{
> if [ -z "$SAGE_LOCAL" ]; then
>     echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
>     echo >&2 "Maybe run 'sage -sh'?"
>     exit 1
> fi
> }}}
> Should these lines just be deleted?

Yes, I think so -- they are outdated



---

archive/issue_comments_414510.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> Replying to [comment:1 jhpalmieri]:\n> > Many `spkg-check.in` and `spkg-install.in` files contain\n> > {{{\n> > if [ -z \"$SAGE_LOCAL\" ]; then\n> >     echo >&2 \"Error: SAGE_LOCAL undefined - exiting...\"\n> >     echo >&2 \"Maybe run 'sage -sh'?\"\n> >     exit 1\n> > fi\n> > }}}\n> > Should these lines just be deleted?\n> \n> Yes, I think so -- they are outdated\n\nThat's going to be a bit of a patch bomb. Do it on another ticket?",
    "created_at": "2020-04-09T22:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414510",
    "user": "jhpalmieri"
}
```

Replying to [comment:4 mkoeppe]:
> Replying to [comment:1 jhpalmieri]:
> > Many `spkg-check.in` and `spkg-install.in` files contain
> > {{{
> > if [ -z "$SAGE_LOCAL" ]; then
> >     echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
> >     echo >&2 "Maybe run 'sage -sh'?"
> >     exit 1
> > fi
> > }}}
> > Should these lines just be deleted?
> 
> Yes, I think so -- they are outdated

That's going to be a bit of a patch bomb. Do it on another ticket?



---

archive/issue_comments_414511.json:
```json
{
    "body": "Good idea",
    "created_at": "2020-04-09T22:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414511",
    "user": "mkoeppe"
}
```

Good idea



---

archive/issue_comments_414512.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-09T23:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414512",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_414513.json:
```json
{
    "body": "Replying to [comment:5 jhpalmieri]:\n> That's going to be a bit of a patch bomb. Do it on another ticket?\n\nThis is now #29492",
    "created_at": "2020-04-09T23:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414513",
    "user": "mkoeppe"
}
```

Replying to [comment:5 jhpalmieri]:
> That's going to be a bit of a patch bomb. Do it on another ticket?

This is now #29492



---

archive/issue_comments_414514.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2020-04-15T03:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414514",
    "user": "mkoeppe"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_414515.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-16T22:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29251#issuecomment-414515",
    "user": "vbraun"
}
```

Resolution: fixed
