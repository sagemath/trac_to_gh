# Issue 29251: sage-spkg: Advertise sage -buildsh, not sage -sh

Issue created by migration from https://trac.sagemath.org/ticket/29488

Original creator: mkoeppe

Original creation time: 2020-04-09 18:28:19

CC:  dimpase jhpalmieri

Follow-up from #29052, which removed environment variables only needed at build time of sage-the-distribution from the `sage-env`.

Consequently, the debugging hints displayed by sage-spkg at the end of a failing build should say `sage-buildsh` instead of `sage-sh`.

See also #29045.



---

Comment by jhpalmieri created at 2020-04-09 22:13:56

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2020-04-09 22:13:56

Many `spkg-check.in` and `spkg-install.in` files contain

```
if [ -z "$SAGE_LOCAL" ]; then
    echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
    echo >&2 "Maybe run 'sage -sh'?"
    exit 1
fi
```

Should these lines just be deleted?


---

Comment by jhpalmieri created at 2020-04-09 22:15:04

Anyway, here's a first draft (without any changes to those "spkg-*.in" files).
----
New commits:


---

Comment by mkoeppe created at 2020-04-09 22:17:09

Replying to [comment:1 jhpalmieri]:
> Many `spkg-check.in` and `spkg-install.in` files contain
> {{{
> if [ -z "$SAGE_LOCAL" ]; then
>     echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
>     echo >&2 "Maybe run 'sage -sh'?"
>     exit 1
> fi
> }}}
> Should these lines just be deleted?

Yes, I think so -- they are outdated


---

Comment by jhpalmieri created at 2020-04-09 22:22:11

Replying to [comment:4 mkoeppe]:
> Replying to [comment:1 jhpalmieri]:
> > Many `spkg-check.in` and `spkg-install.in` files contain
> > {{{
> > if [ -z "$SAGE_LOCAL" ]; then
> >     echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
> >     echo >&2 "Maybe run 'sage -sh'?"
> >     exit 1
> > fi
> > }}}
> > Should these lines just be deleted?
> 
> Yes, I think so -- they are outdated

That's going to be a bit of a patch bomb. Do it on another ticket?


---

Comment by mkoeppe created at 2020-04-09 22:41:18

Good idea


---

Comment by mkoeppe created at 2020-04-09 23:45:42

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-04-09 23:49:56

Replying to [comment:5 jhpalmieri]:
> That's going to be a bit of a patch bomb. Do it on another ticket?

This is now #29492


---

Comment by mkoeppe created at 2020-04-15 03:19:41

Changing priority from critical to blocker.


---

Comment by vbraun created at 2020-04-16 22:33:44

Resolution: fixed
