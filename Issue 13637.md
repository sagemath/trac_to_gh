# Issue 13637: cygwin metaticket: port Sage to Microsoft Windows (via Cygwin): stage 2 -- Sage starts and passes a lot of doctests

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2012-12-18 20:49:34

Assignee: tbd

CC:  jpflori dimpase was eviatarbach

At #6743, we are really very close to having Sage on Cygwin build with `make` and appropriate prereqs.  This ticket is that Sage also _starts_ without extra intervention on Cygwin.

The current status is that #6743 actually achieves this goal, but in the past this wasn't always the case, and so it is a good idea to have a ticket for this!  Hopefully it won't be necessary, though.

Currently (with Sage 5.5.rc0) we need #11635 and the prereq of `libgc-devel` to start but _not_ to build.  Also, #9167 and friends are needed for Maxima and ECL to perform properly as libraries.


---

Comment by kcrisman created at 2013-03-08 16:52:29

Changing status from new to needs_review.


---

Comment by kcrisman created at 2013-03-08 16:52:29

Looks like we won't need this... of course, one never knows, with all the upgrades to spkgs in every version!  Anyway, I'm setting this to sage-pending on #6743 for now.


---

Comment by jpflori created at 2013-04-12 12:06:58

I guess we should close this one.


---

Comment by kcrisman created at 2013-04-12 12:45:06

Until #6743 is merged, I say never say never!  There always seems to be some crazy thing that stands in the way.


---

Comment by kcrisman created at 2013-05-23 13:56:14

Given that #6743 is closed (though not merged in a specific Sage version yet), perhaps this should be as well now?   Are the 5.10 betas doing well on Cygwin?

With respect to _keeping_ it working... JP, are you saying that you have the hardware and time to commit to monitoring this for (say) 2 years?  I just don't have the access to Windows/time to mess with them often enough to guarantee this; given how finicky Cygwin is, we will likely have to keep fixing things that other tickets do - either in terms of missing includes in pyx files or in terms of spkgs which don't have proper stuff...  Thanks for all your amazing work on this!


---

Comment by jdemeyer created at 2013-05-24 12:03:35

Replying to [comment:4 kcrisman]:
> JP, are you saying that you have the hardware and time to commit to monitoring this for (say) 2 years?
I think hardware shouldn't be the problem, I'm sure William can setup a VM for this if needed. Time, on the other hand, is a more valuable resource...


---

Comment by jpflori created at 2013-05-24 13:29:23

Replying to [comment:5 jdemeyer]:
> Replying to [comment:4 kcrisman]:
> > JP, are you saying that you have the hardware and time to commit to monitoring this for (say) 2 years?
> I think hardware shouldn't be the problem, I'm sure William can setup a VM for this if needed.
Yeah that would be very helpful, at least for a buildbot (though it may need human intervention somehow because of rebasing issues, but also note that 64 bits cygwin is on its way and seems quite already in a usale state except for the lack of an installer and me being able to find where to downnload it!).
>  Time, on the other hand, is a more valuable resource...
For at least one year, or mybe two years, i.e. until I change job, I should have some time for that.


---

Comment by jpflori created at 2013-05-24 13:30:36

And having VMs already turned on somewhere would also be nice to run things such as "make ptestlong" which are incredibly slow because of forking.


---

Comment by dimpase created at 2013-05-24 13:40:22

A buildbot would need a cygwin-less way to log in onto it, otherwise rebasing can't always be done. And the standard WIndows way (with a GUI -- "remote desktop connection") might be too slow if the work needs to be done across continents. Are there alternatives? I don't really know. There are sshd "native" WIndows implementations, but I never tried them.


---

Comment by jpflori created at 2013-05-24 13:47:19

Using "rebase -O" should be possible even though other Cygwin processes are running (as long as nothing from Sage is).


---

Comment by dimpase created at 2013-05-24 13:55:27

Replying to [comment:9 jpflori]:
> Using "rebase -O" should be possible even though other Cygwin processes are running (as long as nothing from Sage is).
yes, but if you want to install a new version of Sage, then you probably want to wipe the rebase databases and do a full, cygwin-less, rebase.


---

Comment by jpflori created at 2013-05-24 13:59:14

I'd say the trick would be to never let Sage enter the rebase database by only using "rebase -O" :)


---

Comment by dimpase created at 2013-05-24 14:57:25

Replying to [comment:11 jpflori]:
> I'd say the trick would be to never let Sage enter the rebase database by only using "rebase -O" :)

Are you sure that "rebase -O" does not add stuff to the database? I thought it does, it just does not move what's already there...


---

Comment by jpflori created at 2013-05-24 15:04:59

Replying to [comment:12 dimpase]:
> Replying to [comment:11 jpflori]:
> > I'd say the trick would be to never let Sage enter the rebase database by only using "rebase -O" :)
> 
> Are you sure that "rebase -O" does not add stuff to the database? I thought it does, it just does not move what's already there...
Yup, completely sure, it just reads what's there to rebase after what already exists, but does not write anything.

E.g. if you "rebase -O" two copies of sage and try to run them at the same time, it will likely fail because "rebase -O" will have used the same addesses.


---

Comment by jdemeyer created at 2013-05-24 15:08:23

Replying to [comment:7 jpflori]:
> And having VMs already turned on somewhere would also be nice to run things such as "make ptestlong" which are incredibly slow because of forking.
What is "incredibly slow"? For me, there is no problem if Sage can be built and tested within 48 hours. Is that feasible?


---

Comment by dimpase created at 2013-05-24 16:17:30

Replying to [comment:13 jpflori]:
> Replying to [comment:12 dimpase]:
> > Replying to [comment:11 jpflori]:
> > > I'd say the trick would be to never let Sage enter the rebase database by only using "rebase -O" :)
> > 
> > Are you sure that "rebase -O" does not add stuff to the database? I thought it does, it just does not move what's already there...
> Yup, completely sure, it just reads what's there to rebase after what already exists, but does not write anything.

The mapping of dlls to addresses must be stored somewhere. (where?)
Are you saying that the next run of "rebase -O" completely erases this mapping, and builds a new one from scratch?


---

Comment by jpflori created at 2013-05-25 10:29:18

I'd say it's stored into the dlls themselves, not sure though, but not in the system-wide database for sure, my usual user doesnt have write access to it anyway.

I'm not sure a second run would change everything, it just acts like a usual rebase (without -O) but does not record the results into the system-wide database, so if no dll was added into the global database and you're not adding new stuff to the list of additional files you want to rebase then nothing will change (maybe if you remove some then it will try to pack the address space used).


---

Comment by jdemeyer created at 2013-12-15 18:49:57

Changing status from needs_review to needs_info.


---

Comment by embray created at 2017-04-13 10:31:05

This ticket hasn't been updated in 4+ years, and doesn't really discuss anything that's still an open issue for the Cygwin port.

The best way right now to track progress on the Cygwin port is to just search on the [porting: Cygwin component](https://trac.sagemath.org/query?status=needs_info&status=needs_review&status=needs_work&status=new&status=positive_review&component=porting%3A+Cygwin&col=id&col=summary&col=status&col=type&col=priority&col=milestone&col=component&order=priority).


---

Comment by embray created at 2017-04-13 10:31:05

Resolution: worksforme
