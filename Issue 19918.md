# Issue 19918: Graph Generators: Add Turan Graph

Issue created by migration from https://trac.sagemath.org/ticket/20155

Original creator: mcognetta

Original creation time: 2016-03-03 22:29:53

Keywords: graphs

Turan graphs are a well known family of graphs but have not been added to Sage (although they are in some other computer algebra systems). This patch would add support for Turan Graphs in the sage/graphs/families.py code.


---

Comment by mcognetta created at 2016-03-04 03:16:07

New commits:


---

Comment by mcognetta created at 2016-03-04 03:16:07

Changing status from new to needs_review.


---

Comment by dcoudert created at 2016-03-04 07:50:12

Hello,

If the method for assigning positions to vertices is also valid for multipartite complete graphs, you could instead add it to the `CompleteMultipartiteGraph` method and then just call this method with appropriate parameters. This would thus improve both methods. Your method could thus be reduced to:

```
if n < r:
   raise ValueError('n should be at least r')
if n < 1:
   raise ValueError('n should be at least 1')
if r < 1:
   raise ValueError('r should be at least 1')

name = "Turan Graph with n: {}, r: {}".format(n,r)

if r == 1:
   g = Graph(name=name)
   g.add_vertices(range(n))
   return g

if r == 2:
   g = graphs.CompleteBipartiteGraph(floor(n/2),ceil(n/2))
   g.name(name)
   return g

sizes = [ceil(n/r) for i in range(n%r)]
sizes += [floor(n/r) for i in range(r-(n%r))]
g = graphs.CompleteMultipartiteGraph(sizes)
g.name(name)
return g
```

I'm not sure the case `r==2` is actually needed. 

Also, I don't understand the need for method `calculate_positions` since it is called only once. You could simply add the code in the method.

I think there is no need for importing `math`. You should try calling `floor` and `ceil` directly.

There are several typos in the method descriptions: `wih`, `properity`, etc.

You must add some `TESTS` to ilustrate the errors when calling the method with wrong parameters.

Thanks for your first patch.

David.


---

Comment by dcoudert created at 2016-03-04 12:33:36

It might actually be safer to use something like that (without calls to ceil, floor):

```
sage: n,r=20,3
sage: [n//r]*(r-n%r)+[n//r+1]*(n%r)
[6, 7, 7]
```



---

Comment by mcognetta created at 2016-03-04 16:25:35

Replying to [comment:3 dcoudert]:
> Hello,
> 
> If the method for assigning positions to vertices is also valid for multipartite complete graphs, you could instead add it to the `CompleteMultipartiteGraph` method and then just call this method with appropriate parameters. This would thus improve both methods. Your method could thus be reduced to:
> {{{
> if n < r:
>    raise ValueError('n should be at least r')
> if n < 1:
>    raise ValueError('n should be at least 1')
> if r < 1:
>    raise ValueError('r should be at least 1')
> 
> name = "Turan Graph with n: {}, r: {}".format(n,r)
> 
> if r == 1:
>    g = Graph(name=name)
>    g.add_vertices(range(n))
>    return g
> 
> if r == 2:
>    g = graphs.CompleteBipartiteGraph(floor(n/2),ceil(n/2))
>    g.name(name)
>    return g
> 
> sizes = [ceil(n/r) for i in range(n%r)]
> sizes += [floor(n/r) for i in range(r-(n%r))]
> g = graphs.CompleteMultipartiteGraph(sizes)
> g.name(name)
> return g
> }}}
> I'm not sure the case `r==2` is actually needed. 
> 
> Also, I don't understand the need for method `calculate_positions` since it is called only once. You could simply add the code in the method.
> 
> I think there is no need for importing `math`. You should try calling `floor` and `ceil` directly.
> 
> There are several typos in the method descriptions: `wih`, `properity`, etc.
> 
> You must add some `TESTS` to ilustrate the errors when calling the method with wrong parameters.
> 
> Thanks for your first patch.
> 
> David.


Yes, I think that I will end up doing this. I wrote the code before really thinking about just using the CompleteMultipartiteGraph code.


I originally tried to just use ceil() and floor() but I got an error that I couldn't fix.

I will edit this patch and reupload it.

Thanks.


---

Comment by git created at 2016-03-05 19:43:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-03-07 13:33:29

Hello,

I saw that you have opened a new ticket for the method to compute the position of vertices of complete multi-partite graphs.

I have some comments on this ticket:
* remove the empty line between 'def' and 'r"""'
* You could use some latex in the method description: ``(n mod r)` subsets of size floor`(n/r)` and `r - (n mod r)` subsets of size ceil`(n/r)`` -> ``(n mod r)` subsets of size `\floor{n/r}` and `r - (n mod r)` subsets of size `\ceil{n/r}``
* use `g.size()`instead of `len(g.edges())`
* You can combine the tests. 

```
if n<1 or n<r or r<1:
    raise ValueError("Input parameters must satisfy '1 < r < n'.")
```

* TESTS -> TEST
* instead of `floor(...)`  you should use `[n//r]*(r-n%r)+[n//r+1]*(n%r)`. This is safe in Python. 
* you can remove `import math`
* move the `from ... import...` after the ifs. No need to import when the parameters are wrong (ok, minor improvement)
* You don't need the `vertex_set = []` statement.
* I'm not sure if the statement `'Turan Graph with n: %d, r: %d'%(n,r)` is compatible with Python 3. This should be better `'Turan Graph with n: {}, r: {}'.format(n,r)`

David.


---

Comment by dcoudert created at 2016-03-07 13:33:29

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-03-07 19:40:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mcognetta created at 2016-03-07 19:40:56

Replying to [comment:7 dcoudert]:
> Hello,
> 
> I saw that you have opened a new ticket for the method to compute the position of vertices of complete multi-partite graphs.
> 
> I have some comments on this ticket:
> * remove the empty line between 'def' and 'r"""'
> * You could use some latex in the method description: ``(n mod r)` subsets of size floor`(n/r)` and `r - (n mod r)` subsets of size ceil`(n/r)`` -> ``(n mod r)` subsets of size `\floor{n/r}` and `r - (n mod r)` subsets of size `\ceil{n/r}``
> * use `g.size()`instead of `len(g.edges())`
> * You can combine the tests. 
> {{{
> if n<1 or n<r or r<1:
>     raise ValueError("Input parameters must satisfy '1 < r < n'.")
> }}}
> * TESTS -> TEST
> * instead of `floor(...)`  you should use `[n//r]*(r-n%r)+[n//r+1]*(n%r)`. This is safe in Python. 
> * you can remove `import math`
> * move the `from ... import...` after the ifs. No need to import when the parameters are wrong (ok, minor improvement)
> * You don't need the `vertex_set = []` statement.
> * I'm not sure if the statement `'Turan Graph with n: %d, r: %d'%(n,r)` is compatible with Python 3. This should be better `'Turan Graph with n: {}, r: {}'.format(n,r)`
> 
> David.

Thanks for the advice. I updated the code to reflect your suggestions.


---

Comment by dcoudert created at 2016-03-08 10:52:11

Much better.

- `the nuber of vertices`-> `the number of vertices`

- Why have you 4 points at the end of the `ValueError: ` line. 1 point is enough.

When done, you have to switch back the paper to needs review.

David.


---

Comment by git created at 2016-03-08 17:47:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mcognetta created at 2016-03-08 19:42:29

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2016-03-09 08:06:48

Hello,

the patch is almost good to go. I just realizes that the `n mod r` was not properly displayed in the html doc. You could use instead `n \pmod{r}` which produces `n (mod r)`.
Check also the `\ceil`, etc.

David.


---

Comment by git created at 2016-03-09 22:23:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-03-10 07:40:38

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2016-03-10 07:40:38

This patch is now good to go.
Thanks.
David.


---

Comment by vbraun created at 2016-03-10 21:25:04

Resolution: fixed
