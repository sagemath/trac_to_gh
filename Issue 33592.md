# Issue 33592: sage.graphs: Do not use SAGE_TMP in doctests

Issue created by migration from https://trac.sagemath.org/ticket/33829

Original creator: mkoeppe

Original creation time: 2022-05-09 23:26:54

CC:  mjo dcoudert dimpase chapoton

(split out from #33213)


---

Comment by mkoeppe created at 2022-05-09 23:28:10

New commits:


---

Comment by mkoeppe created at 2022-05-09 23:28:10

Changing status from new to needs_review.


---

Comment by git created at 2022-05-09 23:29:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-05-10 09:18:53

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2022-05-10 09:18:53

LGTM. All tests pass.


---

Comment by vbraun created at 2022-05-22 10:26:21

Merge failure on top of:

e2ebf445d0 Trac #33825: Use pytest-xdist to run pytest in parallel

b4009625f3 Trac #33824: make gens and orbits of PermutationGroup immutable

af23627f18 Trac #33809: some pathlib in combinat and groups

955b5d994c Trac #33803: Fixes for the distributions sagemath-objects, sagemath-categories

3e6b41f7d6 Trac #33799: Replace SAGE_TMP in doctests of sage.misc.{persist,ostools}, sage.doctest, sage.repl

a3fd7185e3 Trac #33797: sage.misc.temporary_file: Remove use of SAGE_TMP

2ca053010a Trac #33794: modules/fp_graded/morphism.py test failure

7037fba482 Trac #33793: sage.misc.cython: Replace use of SPYX_TMP by a new cached function in sage.misc.temporary_file

d1152701c4 Trac #33787: Installation manual: Update section "system-wide install"

0ae55652cf Trac #33782: ci-cygwin: Update python version

833f53d1cc Trac #33779: Remove use of SAGE_TMP in sage.interfaces.latte

b376a8d71c Trac #33771: SSLContext needs an argument

df168c8112 Trac #33763: Refactor src/sage/docs

9597eafded Trac #33748: make accessing coefficients of finite-field elements easier

f02236f5b6 Trac #33744: Compute bases/circuits in MatroidUnion

8943dc07fc Trac #33743: Faster random tree generator

773ec37bec Trac #33740: Add conda dev environment

5e65c16108 Trac #33734: variety() for polynomial systems over â„š using msolve

8e7dcca8d3 Trac #33733: allow to use flint for Stirling numbers

6f4efb0bf3 Updated [SageMath](SageMath) version to 9.7.beta0



merge was not clean: conflicts in src/sage/graphs/isgci.py


---

Comment by vbraun created at 2022-05-22 10:26:21

Changing status from positive_review to needs_work.


---

Comment by git created at 2022-05-25 20:50:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-05-25 20:51:12

Merged #33771 to resolve merge conflict


---

Comment by mkoeppe created at 2022-05-25 20:51:28

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2022-05-26 08:59:19

in `isgci.py` in the following block you use variable `d` but this variable is unknown (reported by pyflakes)

```diff
+            # Save a systemwide updated copy whenever possible
+            try:
+                z.extract(_XML_FILE, GRAPHS_DATA_DIR)
+                z.extract(_SMALLGRAPHS_FILE, GRAPHS_DATA_DIR)
+            except IOError:
+                z.extract(_XML_FILE, d)
+                z.extract(_SMALLGRAPHS_FILE, GRAPHS_DATA_DIR)
```


pyflakes also complains about  `os`  that is imported but not used. This is a minor issue.


---

Comment by dimpase created at 2022-06-10 09:20:33

lgtm


---

Comment by dimpase created at 2022-06-10 09:20:33

Changing status from needs_review to positive_review.


---

Comment by mjo created at 2022-06-10 11:40:39

something should still be done with the `isgci.py` routine from comment:10

it looks like the fallback `SAGE_TMP` location never worked because `_parse_db` doesn't try the fallback location, so maybe we should just delete the whole `except IOError:` block


---

Comment by mjo created at 2022-06-10 11:40:39

Changing status from positive_review to needs_work.


---

Comment by dimpase created at 2022-06-10 16:56:26

I'm trying to replace what's inside the `except` by `pass`. We can of course go even further and get rid of `try` all together.


---

Comment by dimpase created at 2022-06-10 22:29:05

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2022-06-10 22:29:05

New commits:


---

Comment by git created at 2022-06-13 10:01:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2022-06-13 10:06:57

rebased over latest 9.7.beta2


---

Comment by dimpase created at 2022-06-13 10:58:17

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2022-06-13 10:58:17

it works


---

Comment by vbraun created at 2022-06-17 22:52:58

Resolution: fixed
