# Issue 31344: Do not require base ring of quaternion algebra to be a field

Issue created by migration from https://trac.sagemath.org/ticket/31581

Original creator: pbruin

Original creation time: 2021-03-30 18:04:28

Keywords: quaternion algebra

Currently, an error is raised when constructing a quaternion algebra over a base ring that is not a field.  This can be weakened to the condition that the base ring is a commutative ring in which 2 is a unit.

For backwards compatibility, when using the syntax `QuaternionAlgebra(a, b)`, the elements `a` and `b` must lie in a domain `R`, and the resulting quaternion algebra is defined over the fraction field of `R`.



---

Comment by pbruin created at 2021-03-30 18:06:27

Changing status from new to needs_review.


---

Comment by roed created at 2021-03-30 23:43:06

There should be some tests showing that multiplication works without issues when the base ring is not a field.  Also, in the documentation, is the construction `QuaternionAlgebra(a, b)` okay if `a` and `b` have the same parent which is an integral domain where 2 is invertible?  Or do you need to give the ring explicitly in this case?

Otherwise, it looks good (once tests pass).


---

Comment by roed created at 2021-03-30 23:43:06

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-03-31 13:09:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2021-03-31 13:10:03

Changing status from needs_work to needs_review.


---

Comment by pbruin created at 2021-03-31 13:10:03

Thanks, I added some doctests and clarified the documentation for the `QuaternionAlgebra(a, b)` syntax.  One does not need to give the ring explicitly, but we take the _fraction field_ of a common parent (which must be a domain of characteristic not 2) in that case, for consistency with the case where `a` and `b` are integers.


---

Comment by mkoeppe created at 2021-04-02 20:21:54

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage


---

Comment by roed created at 2021-04-28 05:49:11

Changing status from needs_review to positive_review.


---

Comment by roed created at 2021-04-28 05:49:11

Looks good; sorry for the wait!


---

Comment by vbraun created at 2021-05-27 20:28:50

Resolution: fixed
