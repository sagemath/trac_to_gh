# Issue 33956: configure: Make display of package versions less confusing

archive/issues_033956.json:
```json
{
    "body": "When we don't install the SPKG, then its exact version is not relevant.\n\nWe change the output from\n\n```\ngc-8.0.4:     no suitable system package; standard, will be installed as an SPKG\ngcc-11.3.0:   using system package; SPKG will not be installed\n```\n\nto\n\n```\ngc:     no suitable system package; standard, version 8.0.4 will be installed as an SPKG\ngcc:    using system package; SPKG will not be installed\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34193\n\n",
    "created_at": "2022-07-16T17:35:01Z",
    "labels": [
        "build: configure",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "configure: Make display of package versions less confusing",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33956",
    "user": "mkoeppe"
}
```
When we don't install the SPKG, then its exact version is not relevant.

We change the output from

```
gc-8.0.4:     no suitable system package; standard, will be installed as an SPKG
gcc-11.3.0:   using system package; SPKG will not be installed
```

to

```
gc:     no suitable system package; standard, version 8.0.4 will be installed as an SPKG
gcc:    using system package; SPKG will not be installed
```


Issue created by migration from https://trac.sagemath.org/ticket/34193





---

archive/issue_comments_482177.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-07-18T03:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482177",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_482178.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-18T03:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482178",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_482179.json:
```json
{
    "body": "Looks good to me. A few questions:\n\n- The number 32 is hard-coded in the formatting string. How much work would it be to determine that from the list of all packages? (This is not really worth spending time on, though.)\n\n- With or without this branch: `pip` packages are treated differently than others if I run this after building Sage:\n\n```\ncharset_normalizer:             standard, SPKG version 2.0.4 will be installed\ncliquer:                        already installed as an SPKG\n```\n\n (At least I'm guessing it's `pip` vs. other types.) Should the `cliquer` message say \"already installed version $SPKG_VERSION as an SPKG\"? Should they both say that?",
    "created_at": "2022-07-18T17:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482179",
    "user": "jhpalmieri"
}
```

Looks good to me. A few questions:

- The number 32 is hard-coded in the formatting string. How much work would it be to determine that from the list of all packages? (This is not really worth spending time on, though.)

- With or without this branch: `pip` packages are treated differently than others if I run this after building Sage:

```
charset_normalizer:             standard, SPKG version 2.0.4 will be installed
cliquer:                        already installed as an SPKG
```

 (At least I'm guessing it's `pip` vs. other types.) Should the `cliquer` message say "already installed version $SPKG_VERSION as an SPKG"? Should they both say that?



---

archive/issue_comments_482180.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-18T18:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482180",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482181.json:
```json
{
    "body": "Replying to [comment:3 jhpalmieri]:\n> - The number 32 is hard-coded in the formatting string. How much work would it be to determine that from the list of all packages? (This is not really worth spending time on, though.)\n\nNot sure that we would want to automatically change it if a package with a longer name comes along",
    "created_at": "2022-07-18T18:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482181",
    "user": "mkoeppe"
}
```

Replying to [comment:3 jhpalmieri]:
> - The number 32 is hard-coded in the formatting string. How much work would it be to determine that from the list of all packages? (This is not really worth spending time on, though.)

Not sure that we would want to automatically change it if a package with a longer name comes along



---

archive/issue_comments_482182.json:
```json
{
    "body": "Replying to [comment:3 jhpalmieri]:\n> - With or without this branch: `pip` packages are treated differently than others if I run this after building Sage:\n> {{{\n> charset_normalizer:             standard, SPKG version 2.0.4 will be installed\n> cliquer:                        already installed as an SPKG\n> }}}\n>  (At least I'm guessing it's `pip` vs. other types.)\n\nThis version of the message is actually for packages with an `spkg-configure.m4` that are installed already (and hence the test for a system package is not run at all).\n\n> Should the `cliquer` message say \"already installed version $SPKG_VERSION as an SPKG\"? Should they both say that?\n\nI've made a change in this direction, but I guess it could be done more generally",
    "created_at": "2022-07-18T18:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482182",
    "user": "mkoeppe"
}
```

Replying to [comment:3 jhpalmieri]:
> - With or without this branch: `pip` packages are treated differently than others if I run this after building Sage:
> {{{
> charset_normalizer:             standard, SPKG version 2.0.4 will be installed
> cliquer:                        already installed as an SPKG
> }}}
>  (At least I'm guessing it's `pip` vs. other types.)

This version of the message is actually for packages with an `spkg-configure.m4` that are installed already (and hence the test for a system package is not run at all).

> Should the `cliquer` message say "already installed version $SPKG_VERSION as an SPKG"? Should they both say that?

I've made a change in this direction, but I guess it could be done more generally



---

archive/issue_comments_482183.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-18T21:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482183",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482184.json:
```json
{
    "body": "Now it knows how to talk about package upgrades/downgrades",
    "created_at": "2022-07-18T21:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482184",
    "user": "mkoeppe"
}
```

Now it knows how to talk about package upgrades/downgrades



---

archive/issue_comments_482185.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-18T21:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482185",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482186.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-18T21:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482186",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482187.json:
```json
{
    "body": "Ready for testing",
    "created_at": "2022-07-18T21:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482187",
    "user": "mkoeppe"
}
```

Ready for testing



---

archive/issue_comments_482188.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-18T23:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482188",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482189.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-07-19T00:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482189",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_482190.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-19T00:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482190",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482191.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-19T00:14:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482191",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_482192.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-19T18:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482192",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_482193.json:
```json
{
    "body": "This looks good to me.\n\nThis is not new to this ticket, and not particularly relevant to the changes here, but I don't quite see how `uninstall_message` works. When will it be set to \"use \\\"$srcdir/configure --disable-SPKG_NAME\\\" to uninstall\" \u2014\u00a0it seems as though this would be most useful for optional/experimental packages.",
    "created_at": "2022-07-19T18:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482193",
    "user": "jhpalmieri"
}
```

This looks good to me.

This is not new to this ticket, and not particularly relevant to the changes here, but I don't quite see how `uninstall_message` works. When will it be set to "use \"$srcdir/configure --disable-SPKG_NAME\" to uninstall" — it seems as though this would be most useful for optional/experimental packages.



---

archive/issue_comments_482194.json:
```json
{
    "body": "The uninstall message is only issued for packages with `spkg-configure.m4` for which currently an SPKG is installed. The uninstallation command is particularly useful for these packages because after uninstallation, `configure` will test again whether the system package can be used.",
    "created_at": "2022-07-19T19:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482194",
    "user": "mkoeppe"
}
```

The uninstall message is only issued for packages with `spkg-configure.m4` for which currently an SPKG is installed. The uninstallation command is particularly useful for these packages because after uninstallation, `configure` will test again whether the system package can be used.



---

archive/issue_comments_482195.json:
```json
{
    "body": "Thanks for the review!",
    "created_at": "2022-07-19T19:16:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482195",
    "user": "mkoeppe"
}
```

Thanks for the review!



---

archive/issue_comments_482196.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-04T22:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33956",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33956#issuecomment-482196",
    "user": "vbraun"
}
```

Resolution: fixed
