# Issue 33956: configure: Make display of package versions less confusing

Issue created by migration from https://trac.sagemath.org/ticket/34193

Original creator: mkoeppe

Original creation time: 2022-07-16 17:35:01

When we don't install the SPKG, then its exact version is not relevant.

We change the output from

```
gc-8.0.4:     no suitable system package; standard, will be installed as an SPKG
gcc-11.3.0:   using system package; SPKG will not be installed
```

to

```
gc:     no suitable system package; standard, version 8.0.4 will be installed as an SPKG
gcc:    using system package; SPKG will not be installed
```



---

Comment by mkoeppe created at 2022-07-18 03:24:57

New commits:


---

Comment by mkoeppe created at 2022-07-18 03:24:57

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2022-07-18 17:55:19

Looks good to me. A few questions:

- The number 32 is hard-coded in the formatting string. How much work would it be to determine that from the list of all packages? (This is not really worth spending time on, though.)

- With or without this branch: `pip` packages are treated differently than others if I run this after building Sage:

```
charset_normalizer:             standard, SPKG version 2.0.4 will be installed
cliquer:                        already installed as an SPKG
```

 (At least I'm guessing it's `pip` vs. other types.) Should the `cliquer` message say "already installed version $SPKG_VERSION as an SPKG"? Should they both say that?


---

Comment by git created at 2022-07-18 18:24:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-07-18 18:25:59

Replying to [comment:3 jhpalmieri]:
> - The number 32 is hard-coded in the formatting string. How much work would it be to determine that from the list of all packages? (This is not really worth spending time on, though.)

Not sure that we would want to automatically change it if a package with a longer name comes along


---

Comment by mkoeppe created at 2022-07-18 18:28:16

Replying to [comment:3 jhpalmieri]:
> - With or without this branch: `pip` packages are treated differently than others if I run this after building Sage:
> {{{
> charset_normalizer:             standard, SPKG version 2.0.4 will be installed
> cliquer:                        already installed as an SPKG
> }}}
>  (At least I'm guessing it's `pip` vs. other types.)

This version of the message is actually for packages with an `spkg-configure.m4` that are installed already (and hence the test for a system package is not run at all).

> Should the `cliquer` message say "already installed version $SPKG_VERSION as an SPKG"? Should they both say that?

I've made a change in this direction, but I guess it could be done more generally


---

Comment by git created at 2022-07-18 21:00:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-07-18 21:01:13

Now it knows how to talk about package upgrades/downgrades


---

Comment by git created at 2022-07-18 21:27:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-07-18 21:29:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-07-18 21:29:24

Ready for testing


---

Comment by git created at 2022-07-18 23:47:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-07-19 00:02:02

Changing status from needs_review to needs_work.


---

Comment by git created at 2022-07-19 00:14:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-07-19 00:14:10

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2022-07-19 18:55:06

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2022-07-19 18:55:06

This looks good to me.

This is not new to this ticket, and not particularly relevant to the changes here, but I don't quite see how `uninstall_message` works. When will it be set to "use \"$srcdir/configure --disable-SPKG_NAME\" to uninstall" — it seems as though this would be most useful for optional/experimental packages.


---

Comment by mkoeppe created at 2022-07-19 19:16:45

The uninstall message is only issued for packages with `spkg-configure.m4` for which currently an SPKG is installed. The uninstallation command is particularly useful for these packages because after uninstallation, `configure` will test again whether the system package can be used.


---

Comment by mkoeppe created at 2022-07-19 19:16:56

Thanks for the review!


---

Comment by vbraun created at 2022-08-04 22:45:22

Resolution: fixed
