# Issue 24329: BooleanFunction evaluated on Integer computes IndexError wrongly

Issue created by migration from Trac.

Original creator: asante

Original creation time: 2018-01-19 10:39:11

Keywords: BooleanFunction

BooleanFunction objects can be evaluated by calling with either a list of boolean-interpretable values or with an integer (then the bits of the binary representation of the integer is used).
The binary-representation size of the integer is wrongly computed


```
sage: BooleanFunction([0,1])(0)
....: BooleanFunction([0,1])([0])
....: BooleanFunction([0,1])(1)
....: BooleanFunction([0,1])([1])
....: BooleanFunction([0,1])(2)
....: BooleanFunction([0,1])(3)
....: 
False
False
True
True
False
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-72-3f38181c7a4e> in <module>()
      4 BooleanFunction([Integer(0),Integer(1)])([Integer(1)])
      5 BooleanFunction([Integer(0),Integer(1)])(Integer(2))
----> 6 BooleanFunction([Integer(0),Integer(1)])(Integer(3))

/home/asante/.local/src/sage/src/sage/crypto/boolean_function.pyx in sage.crypto.boolean_function.BooleanFunction.__call__ (build/cythonized/sage/crypto/boolean_function.c:12758)()
    636         if isinstance(x, (int,long,Integer)):
    637             if x > self._truth_table.size:
--> 638                 raise IndexError("index out of bound")
    639             return bitset_in(self._truth_table,x)
    640         elif isinstance(x, list):

IndexError: index out of bound
```


Calling the above BooleanFunction on the input `2` should already results in an `index out of bound` error.


---

Comment by asante created at 2018-01-19 13:15:10

Set assignee to asante.


---

Comment by asante created at 2018-01-19 13:15:10

I think this should be fixable by changing line 637 to
`if x >= self._truth_table.size:`


---

Comment by asante created at 2018-01-19 14:46:57

I'm struggling with compiling sage again, so could not yet test my patch :/
----
New commits:


---

Comment by asante created at 2018-01-22 20:28:07

OK, I tested the patch, it should be fine this way.


---

Comment by asante created at 2018-01-22 20:28:07

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-01-23 13:41:57

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-01-23 13:41:57

LGTM.


---

Comment by vbraun created at 2018-01-27 15:59:50

Resolution: fixed
