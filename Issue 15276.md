# Issue 15276: Polynomial factorization over generic fields

Issue created by migration from Trac.

Original creator: nthiery

Original creation time: 2013-12-11 21:38:38

CC:  defeo

Factorization is a fundamental building block of computer algebra, yet Sage is
still missing a generic implementation of factorization that would
work over any (reasonable) field. Students and colleagues are stumbling over this over and over.

For example, the following currently raise NotImplementedError:

```
sage: K = QQ['x0,x1'].fraction_field()
sage: x0,x1 = K.gens()
sage: x = K['x'].gen()
sage: p = x^2 - (x0+x1)*x
sage: factor(p)
```


We might want this to work too:


```
sage: K = QQ['x0,x1']
sage: x0,x1 = K.gens()
sage: x = K['x'].gen()
sage: p = x^2 - (x0+x1)*x
sage: factor(p)
```


By the way, here is one of my favorite MuPAD demo about genericity:

```
Q  := Dom::Rational:
Qx := Dom::Fraction(Dom::UnivariatePolynomial(x, Q)):
F  := Dom::AlgebraicExtension(Qx, poly(z^2 - x, [z])):
P  := Dom::UnivariatePolynomial(u,F):
P(u*z)*P(z)
                              x u
f := P(u^2 - x^3);
factor(f);
                      (u + x z) (u - x z)
```

This ought to work in Sage too, but it fails because Sage can't test
the primality of z^2-x below:

```
sage: Px.<x> = QQ[]
sage: Qx = Px.fraction_field()
sage: Qxz = Qx['z']
sage: z = Qxz.gen()
sage: (z^2-x).is_irreducible()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
```


So the algebraic extension is not recognized as giving a field:

```
sage: F = Qxz.quo(z^2-x)
sage: F in Fields()
```


Having a factorization over generic fields should do the job.


---

Comment by jdemeyer created at 2014-10-08 09:25:57

Replying to [ticket:15513 nthiery]:
> Sage is still missing a generic implementation of factorization that would
> work over any (reasonable) field.
This issue is *way* too general. I think it fails bullet points 2 and 4 of [http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets](http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets)


---

Comment by nthiery created at 2014-10-08 09:39:45

Replying to [comment:6 jdemeyer]:
> Replying to [ticket:15513 nthiery]:
> > Sage is still missing a generic implementation of factorization that would
> > work over any (reasonable) field.
> This issue is *way* too general. I think it fails bullet points 2 and 4 of [http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets](http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets)

Why too general? It asks for a very specific feature: having a default generic implementation of multivariate polynomials over (reasonably computable) fields. There exists algorithms for this, e.g. implemented in MuPAD.


---

Comment by jdemeyer created at 2014-10-08 09:45:42

Please remove the working examples from the ticket description such that it's more clear what you actually want.


---

Comment by jdemeyer created at 2014-10-08 11:42:13

Replying to [comment:8 nthiery]:
> Why too general? It asks for a very specific feature: having a default generic implementation of multivariate polynomials over (reasonably computable) fields.
Fine, but none of the examples in your description was an example of a factorization of a *multi*-variate polynomial over a *field* which currently *fails* in Sage.


---

Comment by jdemeyer created at 2014-10-08 11:45:02

Note: I'm not trying to deny that there are issues with factorization of polynomials in Sage, but at least make it clear what this ticket is really about.


---

Comment by nthiery created at 2014-10-09 11:25:50

I agree that the description was crappy, and my latest update had not improved it. I was in the middle of discussion with the Singular people and just wanted to make sure I had updated the datapoints, before going back to it later.

But please don't destroy data points! Those are vital to reproduce issues and measure progress.


---

Comment by jdemeyer created at 2014-10-09 11:34:14

Replying to [comment:17 nthiery]:
> But please don't destroy data points!
Initially, I planned to remove all examples which didn't fit the description. Until I realized I had no examples left...


---

Comment by jdemeyer created at 2014-10-09 11:37:10

> Implement a generic implementation of univariate polynomial
> factorization that would work over any (computable enough) field.
This is still way too general. I think the two examples you mention really should be 2 tickets, and those tickets should be just about those examples, nothing too general.


---

Comment by jdemeyer created at 2014-10-09 11:37:58

Replying to [comment:17 nthiery]:
> But please don't destroy data points! Those are vital to reproduce issues and measure progress.
What's the point of having information like "this used to fail, but now works"?


---

Comment by nthiery created at 2014-10-09 11:40:53

Replying to [comment:19 jdemeyer]:
> This is still way too general. I think the two examples you mention really should be 2 tickets, and those tickets should be just about those examples, nothing too general.

I agree we could split a second ticket for factorization over a ring. But for fields I don't see how it is too general: as far as I know, there exist generic algorithms that cover all cases.


---

Comment by nthiery created at 2014-10-09 11:47:31

Replying to [comment:20 jdemeyer]:
> Replying to [comment:17 nthiery]:
> > But please don't destroy data points! Those are vital to reproduce issues and measure progress.
> What's the point of having information like "this used to fail, but now works"?

Tracking progress, and keeping a trace of history. For example, people may stumble on similar issues with various versions of Sage and want to report it. And learn from the ticket "nice, my special case is now fixed, but I should be careful because not all cases are".

And honestly I don't see, with the new layout, what disadvantage there can be of having this information.

Anyway, I am bailing out of this discussion. It's not my area, I have tried to bring in as much useful information I could, if you know better how to lay it out so that the job gets done, go ahead.


---

Comment by jdemeyer created at 2014-10-09 11:50:04

Replying to [comment:21 nthiery]:
> as far as I know, there exist generic algorithms that cover all cases.
I have very strong doubts about this. Factorization algorithms over `CC`, over `QQ` and over `GF(q)` are very different, so I don't see how one algorithm could work in all cases.


---

Comment by jdemeyer created at 2014-10-09 11:52:42

Replying to [comment:22 nthiery]:
> And honestly I don't see, with the new layout, what disadvantage there can be of having this information.
Too much irrelevant information can be confusing. But I'll leave it for now.


---

Comment by jdemeyer created at 2014-10-09 12:10:08

> as far as I know, there exist generic algorithms that cover all cases.
There are generic algorithms for factorization of multi-variate polynomials, assuming you can do uni-variate factorization. Perhaps that's what you had in mind?


---

Comment by nthiery created at 2014-10-10 12:28:37

Oh, wait, wait, wait, where is my mind ... Yes, of course factorization over K[x] for K=QQ, CC, ... is completely different; I am even illustrating this in my usuals intros to Sage :-)

So, let's see. What I had in mind was indeed generic factorization algorithm for the standard constructions of fields from existing ones.

Ok, I'll try now to rewrite the description in a proper way. It's not my area, so please clarify it :-)


---

Comment by nthiery created at 2014-10-10 13:19:31

Changing type from enhancement to task.


---

Comment by nthiery created at 2014-10-10 13:20:38

Ok, a first draft is there. Please, someone competent, expand it as appropriate!
