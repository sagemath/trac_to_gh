# Issue 34008: With plantri installed, a doctest creates a file in SAGE_ROOT

archive/issues_034008.json:
```json
{
    "body": "The doctest in `graphs/graph_generators.py`\n\n```\n            sage: list(graphs.plantri_gen(\"6 -c 3\"))  # optional plantri\n            Traceback (most recent call last):\n            ...\n            AttributeError: invalid options '6 -c 3'\n```\n\ncreates a file \"3\" in `SAGE_ROOT` if the optional package `plantri` is detected and used. Maybe the doctest should be changed, maybe the code should be changed so that the error is caught before the file is created.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34245\n\n",
    "created_at": "2022-07-29T18:03:33Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "With plantri installed, a doctest creates a file in SAGE_ROOT",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34008",
    "user": "https://github.com/jhpalmieri"
}
```
The doctest in `graphs/graph_generators.py`

```
            sage: list(graphs.plantri_gen("6 -c 3"))  # optional plantri
            Traceback (most recent call last):
            ...
            AttributeError: invalid options '6 -c 3'
```

creates a file "3" in `SAGE_ROOT` if the optional package `plantri` is detected and used. Maybe the doctest should be changed, maybe the code should be changed so that the error is caught before the file is created.

Issue created by migration from https://trac.sagemath.org/ticket/34245





---

archive/issue_comments_482094.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-30T03:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482094",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_482095.json:
```json
{
    "body": "Good catch! (Plantri parses \"3\" as the name of the output file.) This little patch fixes the doctest so it tests the same sagemath codepath without creating a file.\n----\nNew commits:",
    "created_at": "2022-07-30T03:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482095",
    "user": "https://github.com/DaveWitteMorris"
}
```

Good catch! (Plantri parses "3" as the name of the output file.) This little patch fixes the doctest so it tests the same sagemath codepath without creating a file.
----
New commits:



---

archive/issue_comments_482096.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-30T09:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482096",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_482097.json:
```json
{
    "body": "Thank you for the fix.",
    "created_at": "2022-07-30T09:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482097",
    "user": "https://github.com/dcoudert"
}
```

Thank you for the fix.



---

archive/issue_comments_482098.json:
```json
{
    "body": "FYI, plantri writes to `stderr`:\n- when `options='6 -c3'`\n\n```\n['/Users/dcoudert/sage/local/bin/plantri 6 -c3 \\n',\n '2 triangulations written to stdout; cpu=0.00 sec\\n']\n```\n\n- when `options='6 -c=3'`\n\n```\n['/Users/dcoudert/sage/local/bin/plantri 6 -c=3 \\n',\n '>E /Users/dcoudert/sage/local/bin/plantri:  -= is not permitted\\n']\n```\n\n- when `options='6 -c 3'`\n\n```\n['/Users/dcoudert/sage/local/bin/plantri 6 -c 3 \\n',\n '2 triangulations written to 3; cpu=0.02 sec\\n']\n```\n\nIn this last case, the graphs are written in file `3` and this is not an error. Consequently, some users may write output to file without noticing it and I don't know how to prevent that. We may however raise a warning since we can detect that `stdout` is missing.",
    "created_at": "2022-07-30T09:16:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482098",
    "user": "https://github.com/dcoudert"
}
```

FYI, plantri writes to `stderr`:
- when `options='6 -c3'`

```
['/Users/dcoudert/sage/local/bin/plantri 6 -c3 \n',
 '2 triangulations written to stdout; cpu=0.00 sec\n']
```

- when `options='6 -c=3'`

```
['/Users/dcoudert/sage/local/bin/plantri 6 -c=3 \n',
 '>E /Users/dcoudert/sage/local/bin/plantri:  -= is not permitted\n']
```

- when `options='6 -c 3'`

```
['/Users/dcoudert/sage/local/bin/plantri 6 -c 3 \n',
 '2 triangulations written to 3; cpu=0.02 sec\n']
```

In this last case, the graphs are written in file `3` and this is not an error. Consequently, some users may write output to file without noticing it and I don't know how to prevent that. We may however raise a warning since we can detect that `stdout` is missing.



---

archive/issue_comments_482099.json:
```json
{
    "body": "Thanks for the review and additional comments. Perhaps there should be a follow-up ticket.",
    "created_at": "2022-08-01T00:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482099",
    "user": "https://github.com/DaveWitteMorris"
}
```

Thanks for the review and additional comments. Perhaps there should be a follow-up ticket.



---

archive/issue_events_089286.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-04T22:46:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34008#event-89286"
}
```



---

archive/issue_comments_482100.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-04T22:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34008#issuecomment-482100",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
