# Issue 12698: update optional package openssl to version 1.0.1a

archive/issues_012698.json:
```json
{
    "body": "Assignee: tbd\n\nUpgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12870\n\n",
    "created_at": "2012-04-23T20:26:52Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "update optional package openssl to version 1.0.1a",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12698",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```
Assignee: tbd

Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.

Issue created by migration from https://trac.sagemath.org/ticket/12870





---

archive/issue_comments_151508.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-04-26T18:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151508",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_151509.json:
```json
{
    "body": "Can you change the permissions:\n\n```\nwstein@sage:/scratch/wstein/ref/sage-5.0.beta15-boxen-x86_64-Linux$ wget  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg\n--13:51:00--  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg\n           => `openssl-1.0.1a.spkg'\nResolving boxen.math.washington.edu... 128.208.160.197\nConnecting to boxen.math.washington.edu|128.208.160.197|:80... connected.\nHTTP request sent, awaiting response... 403 Forbidden\n13:51:00 ERROR 403: Forbidden.\n```\n",
    "created_at": "2012-04-30T20:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151509",
    "user": "https://github.com/williamstein"
}
```

Can you change the permissions:

```
wstein@sage:/scratch/wstein/ref/sage-5.0.beta15-boxen-x86_64-Linux$ wget  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
--13:51:00--  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
           => `openssl-1.0.1a.spkg'
Resolving boxen.math.washington.edu... 128.208.160.197
Connecting to boxen.math.washington.edu|128.208.160.197|:80... connected.
HTTP request sent, awaiting response... 403 Forbidden
13:51:00 ERROR 403: Forbidden.
```




---

archive/issue_comments_151510.json:
```json
{
    "body": "Done. Apologies.",
    "created_at": "2012-05-01T14:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151510",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Done. Apologies.



---

archive/issue_comments_151511.json:
```json
{
    "body": "REPORT:\n\n(this is long, but there is really only one trivial change I want made.)\n\n1. Delete this file -- why is it there?\n\n```\n-rw-r-----  1 wstein wstein  21M 2012-04-19 05:20 openssl-1.0.1a.tar\n```\n\n\n2. It builds fine on sage.math (64-bit ubuntu).\n\n3. It fails to build on OS X 10.7.3 after building sage-5.0.pre15 out of the box:\n\n```\ngcc -I. -I.. -I../include  -fPIC -fno-common -DOPENSSL_PIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -arch i386 -O3 -fomit-frame-pointer -DL_ENDIAN -DOPENSSL_BN_ASM_PART_WORDS -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DRMD160_ASM -DAE\nS_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM   -c -o mem_dbg.o mem_dbg.c\ngcc: error: i386: No such file or directory\ngcc: error: unrecognized option \u2018-arch\u2019\ngcc: error: i386: No such file or directory\ngcc: error: unrecognized option \u2018-arch\u2019\nmake[1]: *** [cryptlib.o] Error 1\nmake[1]: *** Waiting for unfinished jobs....\nmake[1]: *** [mem.o] Error 1\ngcc: error: i386: No such file or directory\ngcc: error: unrecognized option \u2018-arch\u2019\nmake[1]: *** [mem_dbg.o] Error 1\nmake: *** [build_crypto] Error 1\nError building openssl.\n\nreal\t0m3.738s\nuser\t0m2.527s\nsys\t0m0.910s\n************************************************************************\nError installing package openssl-1.0.1a\n```\n\n\nThis looks like some OS version detection code is wrong? Note `gcc: error: unrecognized option \u2018-arch\u2019`.  Exactly the same problem happens with the openssl-1.0.0.p0 that we currently have in the optional package repo.\n\n\n4. On Ubuntu 64-bit (sage.math), I tried rebuilding Python after building the new openssl, and that worked fine and did include openssl support. \n\n5. I ran all doctests on ubuntu 64-bit and that worked fine.  This isn't surprising, since I think no doctests use openssl. \n\n6. On OS X 10.6, I tried this:\n\n```\nbsd:sage-5.0.beta8 wstein$ ./sage -i  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg\n```\n\nand it worked fine. \n\n7. It would be nice if there was an \".hgignore\" file since\n\n```\n$ hg status\n? openssl-1.0.1a.spkg\n? openssl-1.0.1a/SPKG.txt\n? openssl-1.0.1a/openssl-1.0.1a.tar\n? openssl-1.0.1a/src/ACKNOWLEDGMENTS\n? openssl-1.0.1a/src/CHANGES\n? openssl-1.0.1a/src/CHANGES.SSLeay\n? openssl-1.0.1a/src/Configure\n...\n```\n\n\nSUMMARY: The OS X 10.7.3 issue looks serious, but should not hold this back, because it is already in the current openssl optional package; it should be considered a new bug on a separate ticket.   Otherwise, we just need to delete the upstream tarball which is there for no reason.  Since this is an optional spkg, and we still don't officially support OS X 10.7.3, I don't consider this a total blocker for a positive review. \n\nTHUS: Positive review contingent on deleting that one tar file.",
    "created_at": "2012-05-01T17:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151511",
    "user": "https://github.com/williamstein"
}
```

REPORT:

(this is long, but there is really only one trivial change I want made.)

1. Delete this file -- why is it there?

```
-rw-r-----  1 wstein wstein  21M 2012-04-19 05:20 openssl-1.0.1a.tar
```


2. It builds fine on sage.math (64-bit ubuntu).

3. It fails to build on OS X 10.7.3 after building sage-5.0.pre15 out of the box:

```
gcc -I. -I.. -I../include  -fPIC -fno-common -DOPENSSL_PIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -arch i386 -O3 -fomit-frame-pointer -DL_ENDIAN -DOPENSSL_BN_ASM_PART_WORDS -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DRMD160_ASM -DAE
S_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM   -c -o mem_dbg.o mem_dbg.c
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
make[1]: *** [cryptlib.o] Error 1
make[1]: *** Waiting for unfinished jobs....
make[1]: *** [mem.o] Error 1
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
make[1]: *** [mem_dbg.o] Error 1
make: *** [build_crypto] Error 1
Error building openssl.

real	0m3.738s
user	0m2.527s
sys	0m0.910s
************************************************************************
Error installing package openssl-1.0.1a
```


This looks like some OS version detection code is wrong? Note `gcc: error: unrecognized option ‘-arch’`.  Exactly the same problem happens with the openssl-1.0.0.p0 that we currently have in the optional package repo.


4. On Ubuntu 64-bit (sage.math), I tried rebuilding Python after building the new openssl, and that worked fine and did include openssl support. 

5. I ran all doctests on ubuntu 64-bit and that worked fine.  This isn't surprising, since I think no doctests use openssl. 

6. On OS X 10.6, I tried this:

```
bsd:sage-5.0.beta8 wstein$ ./sage -i  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
```

and it worked fine. 

7. It would be nice if there was an ".hgignore" file since

```
$ hg status
? openssl-1.0.1a.spkg
? openssl-1.0.1a/SPKG.txt
? openssl-1.0.1a/openssl-1.0.1a.tar
? openssl-1.0.1a/src/ACKNOWLEDGMENTS
? openssl-1.0.1a/src/CHANGES
? openssl-1.0.1a/src/CHANGES.SSLeay
? openssl-1.0.1a/src/Configure
...
```


SUMMARY: The OS X 10.7.3 issue looks serious, but should not hold this back, because it is already in the current openssl optional package; it should be considered a new bug on a separate ticket.   Otherwise, we just need to delete the upstream tarball which is there for no reason.  Since this is an optional spkg, and we still don't officially support OS X 10.7.3, I don't consider this a total blocker for a positive review. 

THUS: Positive review contingent on deleting that one tar file.



---

archive/issue_comments_151512.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-02T17:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151512",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_151513.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2012-05-06T12:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151513",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_151514.json:
```json
{
    "body": "Which is the correct spkg?",
    "created_at": "2012-05-06T12:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151514",
    "user": "https://github.com/jdemeyer"
}
```

Which is the correct spkg?



---

archive/issue_comments_151515.json:
```json
{
    "body": "***ping***\n\nplease clarify: why are there two spkg's listed?",
    "created_at": "2012-05-09T08:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151515",
    "user": "https://github.com/jdemeyer"
}
```

***ping***

please clarify: why are there two spkg's listed?



---

archive/issue_comments_151516.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-05-23T19:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151516",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_151517.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-23T19:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151517",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_151518.json:
```json
{
    "body": "The spkg posted by William supercedes my spkg.  (William's spkg\nremoves a tar file that I mistakenly left in the spkg.)\n\nI have removed my spkg from the Description.\n\nI am setting this back to positive review because William gave it\na positive review.",
    "created_at": "2012-05-23T19:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151518",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

The spkg posted by William supercedes my spkg.  (William's spkg
removes a tar file that I mistakenly left in the spkg.)

I have removed my spkg from the Description.

I am setting this back to positive review because William gave it
a positive review.



---

archive/issue_comments_151519.json:
```json
{
    "body": "spkg is on the webserver+mirros now.",
    "created_at": "2012-05-26T09:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151519",
    "user": "https://github.com/haraldschilly"
}
```

spkg is on the webserver+mirros now.



---

archive/issue_events_035097.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-26T16:29:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12698#event-35097"
}
```



---

archive/issue_comments_151520.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-26T16:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151520",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_151521.json:
```json
{
    "body": "See #13126 for a follow-up.",
    "created_at": "2012-06-17T17:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12698#issuecomment-151521",
    "user": "https://github.com/jhpalmieri"
}
```

See #13126 for a follow-up.
