# Issue 12698: update optional package openssl to version 1.0.1a

Issue created by migration from Trac.

Original creator: mariah

Original creation time: 2012-04-23 20:26:52

Assignee: tbd

Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.


---

Comment by mariah created at 2012-04-26 18:35:44

Changing status from new to needs_review.


---

Comment by was created at 2012-04-30 20:51:36

Can you change the permissions:

```
wstein`@`sage:/scratch/wstein/ref/sage-5.0.beta15-boxen-x86_64-Linux$ wget  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
--13:51:00--  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
           => `openssl-1.0.1a.spkg'
Resolving boxen.math.washington.edu... 128.208.160.197
Connecting to boxen.math.washington.edu|128.208.160.197|:80... connected.
HTTP request sent, awaiting response... 403 Forbidden
13:51:00 ERROR 403: Forbidden.
```



---

Comment by mariah created at 2012-05-01 14:45:50

Done. Apologies.


---

Comment by was created at 2012-05-01 17:05:43

REPORT:

(this is long, but there is really only one trivial change I want made.)

1. Delete this file -- why is it there?

```
-rw-r-----  1 wstein wstein  21M 2012-04-19 05:20 openssl-1.0.1a.tar
```


2. It builds fine on sage.math (64-bit ubuntu).

3. It fails to build on OS X 10.7.3 after building sage-5.0.pre15 out of the box:

```
gcc -I. -I.. -I../include  -fPIC -fno-common -DOPENSSL_PIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -arch i386 -O3 -fomit-frame-pointer -DL_ENDIAN -DOPENSSL_BN_ASM_PART_WORDS -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DRMD160_ASM -DAE
S_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM   -c -o mem_dbg.o mem_dbg.c
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
make[1]: *** [cryptlib.o] Error 1
make[1]: *** Waiting for unfinished jobs....
make[1]: *** [mem.o] Error 1
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
make[1]: *** [mem_dbg.o] Error 1
make: *** [build_crypto] Error 1
Error building openssl.

real	0m3.738s
user	0m2.527s
sys	0m0.910s
************************************************************************
Error installing package openssl-1.0.1a
```


This looks like some OS version detection code is wrong? Note `gcc: error: unrecognized option ‘-arch’`.  Exactly the same problem happens with the openssl-1.0.0.p0 that we currently have in the optional package repo.


4. On Ubuntu 64-bit (sage.math), I tried rebuilding Python after building the new openssl, and that worked fine and did include openssl support. 

5. I ran all doctests on ubuntu 64-bit and that worked fine.  This isn't surprising, since I think no doctests use openssl. 

6. On OS X 10.6, I tried this:

```
bsd:sage-5.0.beta8 wstein$ ./sage -i  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
```

and it worked fine. 

7. It would be nice if there was an ".hgignore" file since

```
$ hg status
? openssl-1.0.1a.spkg
? openssl-1.0.1a/SPKG.txt
? openssl-1.0.1a/openssl-1.0.1a.tar
? openssl-1.0.1a/src/ACKNOWLEDGMENTS
? openssl-1.0.1a/src/CHANGES
? openssl-1.0.1a/src/CHANGES.SSLeay
? openssl-1.0.1a/src/Configure
...
```


SUMMARY: The OS X 10.7.3 issue looks serious, but should not hold this back, because it is already in the current openssl optional package; it should be considered a new bug on a separate ticket.   Otherwise, we just need to delete the upstream tarball which is there for no reason.  Since this is an optional spkg, and we still don't officially support OS X 10.7.3, I don't consider this a total blocker for a positive review. 

THUS: Positive review contingent on deleting that one tar file.


---

Comment by was created at 2012-05-02 17:07:53

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-05-06 12:24:36

Changing status from positive_review to needs_info.


---

Comment by jdemeyer created at 2012-05-06 12:24:36

Which is the correct spkg?


---

Comment by jdemeyer created at 2012-05-09 08:00:39

**ping**

please clarify: why are there two spkg's listed?


---

Comment by mariah created at 2012-05-23 19:15:03

Changing status from needs_info to needs_review.


---

Comment by mariah created at 2012-05-23 19:20:37

Changing status from needs_review to positive_review.


---

Comment by mariah created at 2012-05-23 19:20:37

The spkg posted by William supercedes my spkg.  (William's spkg
removes a tar file that I mistakenly left in the spkg.)

I have removed my spkg from the Description.

I am setting this back to positive review because William gave it
a positive review.


---

Comment by schilly created at 2012-05-26 09:23:38

spkg is on the webserver+mirros now.


---

Comment by jdemeyer created at 2012-05-26 16:29:36

Resolution: fixed


---

Comment by jhpalmieri created at 2012-06-17 17:58:16

See #13126 for a follow-up.
