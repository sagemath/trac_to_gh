# Issue 26985: Proper powering in CDF

archive/issues_026985.json:
```json
{
    "body": "Fix the Cython warning\n\n```\n\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/27222\n\n",
    "created_at": "2019-02-05T08:39:16Z",
    "labels": [
        "basic arithmetic",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Proper powering in CDF",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26985",
    "user": "jdemeyer"
}
```
Fix the Cython warning

```

```


Issue created by migration from https://trac.sagemath.org/ticket/27222





---

archive/issue_comments_379905.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-05T09:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379905",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379906.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-02-05T09:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379906",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_379907.json:
```json
{
    "body": "Patchbot reports some failures:\n\n```\nsage -t --long src/sage/symbolic/random_tests.py  # 1 doctest failed\nsage -t --long src/sage/modular/modform/numerical.py  # 6 doctests failed\n```\n",
    "created_at": "2019-02-05T13:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379907",
    "user": "tscrim"
}
```

Patchbot reports some failures:

```
sage -t --long src/sage/symbolic/random_tests.py  # 1 doctest failed
sage -t --long src/sage/modular/modform/numerical.py  # 6 doctests failed
```




---

archive/issue_comments_379908.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-05T13:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379908",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_379909.json:
```json
{
    "body": "There is a strange regression: `CDF(-0.26319743704743886) ** -1` now returns a non-real number `-3.799429094819641 - 4.652958679558198e-16*I`. The old code didn't seem to do that.",
    "created_at": "2019-02-05T14:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379909",
    "user": "jdemeyer"
}
```

There is a strange regression: `CDF(-0.26319743704743886) ** -1` now returns a non-real number `-3.799429094819641 - 4.652958679558198e-16*I`. The old code didn't seem to do that.



---

archive/issue_comments_379910.json:
```json
{
    "body": "GSL seems to special-case powering by a *complex* -1 but not by a *real* -1.",
    "created_at": "2019-02-05T14:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379910",
    "user": "jdemeyer"
}
```

GSL seems to special-case powering by a *complex* -1 but not by a *real* -1.



---

archive/issue_comments_379911.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-05T14:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379911",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379912.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-05T14:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379912",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379913.json:
```json
{
    "body": "I added a few special cases for powering to an integer.",
    "created_at": "2019-02-05T14:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379913",
    "user": "jdemeyer"
}
```

I added a few special cases for powering to an integer.



---

archive/issue_comments_379914.json:
```json
{
    "body": "I agree with the change. Let us wait for a patchbot report.",
    "created_at": "2019-02-05T15:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379914",
    "user": "tscrim"
}
```

I agree with the change. Let us wait for a patchbot report.



---

archive/issue_comments_379915.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-06T05:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379915",
    "user": "tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_379916.json:
```json
{
    "body": "Failures again reported by the patchbot:\n\n```\nsage -t --long src/sage/symbolic/expression.pyx  # 1 doctest failed\nsage -t --long src/sage/modular/abvar/torsion_subgroup.py  # 1 doctest failed\nsage -t --long src/sage/tests/french_book/mpoly.py  # 1 doctest failed\n```\n\nalthough the `torsion_subgroup.py` is almost certainly unrelated.",
    "created_at": "2019-02-06T05:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379916",
    "user": "tscrim"
}
```

Failures again reported by the patchbot:

```
sage -t --long src/sage/symbolic/expression.pyx  # 1 doctest failed
sage -t --long src/sage/modular/abvar/torsion_subgroup.py  # 1 doctest failed
sage -t --long src/sage/tests/french_book/mpoly.py  # 1 doctest failed
```

although the `torsion_subgroup.py` is almost certainly unrelated.



---

archive/issue_comments_379917.json:
```json
{
    "body": "Replying to [comment:12 tscrim]:\n> the `torsion_subgroup.py` is almost certainly unrelated.\n\nSee #27224 for that.\n\nThe french book doctest will need to wait for #23572 (let's hope that it will finally get merged now).",
    "created_at": "2019-02-06T08:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379917",
    "user": "jdemeyer"
}
```

Replying to [comment:12 tscrim]:
> the `torsion_subgroup.py` is almost certainly unrelated.

See #27224 for that.

The french book doctest will need to wait for #23572 (let's hope that it will finally get merged now).



---

archive/issue_comments_379918.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-06T09:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379918",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379919.json:
```json
{
    "body": "So #23572 is going to be a dependency of this? I am guessing you want to wait until that is merged before proceeding.",
    "created_at": "2019-02-07T00:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379919",
    "user": "tscrim"
}
```

So #23572 is going to be a dependency of this? I am guessing you want to wait until that is merged before proceeding.



---

archive/issue_comments_379920.json:
```json
{
    "body": "Replying to [comment:15 tscrim]:\n> I am guessing you want to wait until that is merged before proceeding.\n\nIndeed. Let's hope that the next beta will have it.",
    "created_at": "2019-02-07T08:22:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379920",
    "user": "jdemeyer"
}
```

Replying to [comment:15 tscrim]:
> I am guessing you want to wait until that is merged before proceeding.

Indeed. Let's hope that the next beta will have it.



---

archive/issue_comments_379921.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-07T21:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379921",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379922.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-07T21:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379922",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379923.json:
```json
{
    "body": "This just fixes the doctest from `french_book`. If #23572 gets merged, I'll rebase it then.",
    "created_at": "2019-02-07T21:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379923",
    "user": "jdemeyer"
}
```

This just fixes the doctest from `french_book`. If #23572 gets merged, I'll rebase it then.



---

archive/issue_comments_379924.json:
```json
{
    "body": "Feel free to flip this to positive review if you think #23572 will take time. Although from what Volker wrote on #23572, it seems like that is easy to fix. Anyways, up to you on the order.",
    "created_at": "2019-02-07T21:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379924",
    "user": "tscrim"
}
```

Feel free to flip this to positive review if you think #23572 will take time. Although from what Volker wrote on #23572, it seems like that is easy to fix. Anyways, up to you on the order.



---

archive/issue_comments_379925.json:
```json
{
    "body": "Replying to [comment:21 tscrim]:\n> Feel free to flip this to positive review if you think #23572 will take time.\n\nI don't know whether it will take time. if this happens to be merged before #23572, fine. If it doesn't, also fine.",
    "created_at": "2019-02-07T21:21:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379925",
    "user": "jdemeyer"
}
```

Replying to [comment:21 tscrim]:
> Feel free to flip this to positive review if you think #23572 will take time.

I don't know whether it will take time. if this happens to be merged before #23572, fine. If it doesn't, also fine.



---

archive/issue_comments_379926.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-07T21:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379926",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_379927.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-08T23:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379927",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_379928.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2019-02-08T23:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379928",
    "user": "vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_379929.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2019-02-08T23:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379929",
    "user": "vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_379930.json:
```json
{
    "body": "This conflicts with #23572, per your request I'm giving that one priority",
    "created_at": "2019-02-08T23:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379930",
    "user": "vbraun"
}
```

This conflicts with #23572, per your request I'm giving that one priority



---

archive/issue_comments_379931.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-02-11T21:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379931",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_379932.json:
```json
{
    "body": "I merged #23572 and tests still pass on the patchbot.",
    "created_at": "2019-02-12T09:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379932",
    "user": "jdemeyer"
}
```

I merged #23572 and tests still pass on the patchbot.



---

archive/issue_comments_379933.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-12T09:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379933",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_379934.json:
```json
{
    "body": "I am confirming this is good.",
    "created_at": "2019-02-12T16:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379934",
    "user": "tscrim"
}
```

I am confirming this is good.



---

archive/issue_comments_379935.json:
```json
{
    "body": "Merge conflict...",
    "created_at": "2019-02-13T20:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379935",
    "user": "vbraun"
}
```

Merge conflict...



---

archive/issue_comments_379936.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-02-13T20:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379936",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_379937.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-16T23:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379937",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379938.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-16T23:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379938",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379939.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-16T23:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379939",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379940.json:
```json
{
    "body": "Sorry, one other test I just thought of. Can you add a doctest showing the behavior of something that masquerades as an element of `ZZ`, such as `4/2`? Once added and a green patchbot, you can set a positive review.",
    "created_at": "2019-02-17T00:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379940",
    "user": "tscrim"
}
```

Sorry, one other test I just thought of. Can you add a doctest showing the behavior of something that masquerades as an element of `ZZ`, such as `4/2`? Once added and a green patchbot, you can set a positive review.



---

archive/issue_comments_379941.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-19T11:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379941",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379942.json:
```json
{
    "body": "Replying to [comment:36 tscrim]:\n> Sorry, one other test I just thought of. Can you add a doctest showing the behavior of something that masquerades as an element of `ZZ`, such as `4/2`?\n\nI did that. As expected, this is showing a worse result than using `ZZ(2)` as exponent since powering by `QQ` uses the coercion model to actually do a powering by `CDF`.",
    "created_at": "2019-02-19T12:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379942",
    "user": "jdemeyer"
}
```

Replying to [comment:36 tscrim]:
> Sorry, one other test I just thought of. Can you add a doctest showing the behavior of something that masquerades as an element of `ZZ`, such as `4/2`?

I did that. As expected, this is showing a worse result than using `ZZ(2)` as exponent since powering by `QQ` uses the coercion model to actually do a powering by `CDF`.



---

archive/issue_comments_379943.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-20T06:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379943",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_379944.json:
```json
{
    "body": "Thank you.",
    "created_at": "2019-02-20T06:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379944",
    "user": "tscrim"
}
```

Thank you.



---

archive/issue_comments_379945.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-23T23:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26985#issuecomment-379945",
    "user": "vbraun"
}
```

Resolution: fixed
