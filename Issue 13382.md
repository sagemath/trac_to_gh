# Issue 13382: BuiltinFunction expects to be instantiated only once

Issue created by migration from https://trac.sagemath.org/ticket/13586

Original creator: burcin

Original creation time: 2012-10-08 15:38:51

Assignee: burcin

Keywords: symbolic function

From [this ask.sagemath.org question](http://ask.sagemath.org/question/1843/weird-behavior-builtinfunction):


```
sage: from sage.symbolic.function import BuiltinFunction
sage: class AFunction(BuiltinFunction):                            
....:         def __init__(self, name, exp=1):
....:             self.exponent=exp
....:         BuiltinFunction.__init__(self, name, nargs=1)
....:     def _eval_(self, arg):
....:             return arg**self.exponent
....: 
sage: p2 = AFunction('p2', 2)
sage: p2(x)                  
x^2
sage: p3 = AFunction('p3', 3)
sage: p3(x)                  
x^2
```


ATM, we only allow a `BuiltinFunction` to be instantiated once.


---

Attachment


---

Comment by burcin created at 2012-10-08 15:40:56

Changing status from new to needs_review.


---

Comment by kcrisman created at 2012-10-09 01:23:37

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2012-10-09 01:23:37

Nice work, Burcin.  I guess this doesn't stop someone from doing

```
sage: p4 = AFunction('p2',3)
```

but I suppose that is the user's problem, since they are redefining the name `p2`.  Similarly, is this (new behavior, I think) ok?  I think so, but just want to make sure.

```
sage: class MyFunction(BuiltinFunction):
....:     def __init__(self,name):
....:         self.exponent=1
....:         BuiltinFunction.__init__(self,name,nargs=1)
....:     def _eval_(self,arg):
....:         return arg**self.exponent
....:     
sage: MyFunction('p')
p
sage: p = MyFunction('p')
sage: p
p
sage: p(2)
2
sage: p(3)
3
sage: q = MyFunction('q')
sage: q(3)
3
sage: p
p
sage: q
q
```


----

Patchbot: Apply trac_13586-builtin_function.patch


---

Comment by burcin created at 2012-10-09 09:22:55

Thanks for the quick review.

Replying to [comment:2 kcrisman]:

> Similarly, is this (new behavior, I think) ok?  I think so, but just want to make sure.
> {{{
> sage: class MyFunction(BuiltinFunction):
> ....:     def __init__(self,name):
> ....:         self.exponent=1
> ....:         BuiltinFunction.__init__(self,name,nargs=1)
> ....:     def _eval_(self,arg):
> ....:         return arg**self.exponent
> ....:     
> sage: MyFunction('p')
> p
> sage: p = MyFunction('p')
> sage: p
> p
> sage: p(2)
> 2
> sage: p(3)
> 3
> sage: q = MyFunction('q')
> sage: q(3)
> 3
> sage: p
> p
> sage: q
> q
> }}}

I think this is how it used to work without the patch as well. But I admit that I don't understand your question. Are you surprised that `q` prints as `q` not `p`? We always use the user supplied name when printing the instance object. It's a different matter for the `self` argument you have inside the `_eval_()` function.


---

Comment by kcrisman created at 2012-10-09 15:49:32

No, it's just that you said "ATM, we only allow a BuiltinFunction to be instantiated once."  Whereas now it can be instantiated more than once with or without different arguments etc.  Probably this is ok, I just wanted to be sure.  No problem.


---

Comment by jdemeyer created at 2012-10-17 21:01:32

Resolution: fixed
