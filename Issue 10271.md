# Issue 10271: laurent series truncate behaviour different from power series truncate

archive/issues_010271.json:
```json
{
    "body": "Assignee: @malb\n\nKeywords: laurent series, truncate\n\nThere is the following difference in behaviour between truncate() for power series and laurent series:\n\nsage: P.<p> = PowerSeriesRing(QQ)\nsage: L.<l> = LaurentSeriesRing(QQ)\nsage: f = p^2 + p^3 + p^5 +p^6 + O(p^7)\nsage: g = l^2 + l^3 + l^5 +l^6 + O(l^7)\nsage: f.truncate(6)\np^5 + p^3 + p^2\nsage: g.truncate(6)\nl^2 + l^3 + l^5 + O(l^6)\nsage: f.truncate_powerseries(6)\np^2 + p^3 + p^5 + O(p^6)\n\nThe problem is simply that g.truncate() calls truncate_powerseries() on its underlying power series.\n\nThe attached patch changes LaurentSeries.truncate() such that is calls truncate() on the underlying powerseries. For the current behaviour, it also adds a method truncate_laurentseries() which calls truncate_powerseries() on the underlying powerseries.\n\nIn my opinion, the methods truncate_powerseries and truncate_laurentseries are superfluous since they are equivalent to add_bigoh().\n\nIssue created by migration from https://trac.sagemath.org/ticket/10272\n\n",
    "created_at": "2010-11-15T14:28:46Z",
    "labels": [
        "component: commutative algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "laurent series truncate behaviour different from power series truncate",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10271",
    "user": "https://github.com/tkluck"
}
```
Assignee: @malb

Keywords: laurent series, truncate

There is the following difference in behaviour between truncate() for power series and laurent series:

sage: P.<p> = PowerSeriesRing(QQ)
sage: L.<l> = LaurentSeriesRing(QQ)
sage: f = p^2 + p^3 + p^5 +p^6 + O(p^7)
sage: g = l^2 + l^3 + l^5 +l^6 + O(l^7)
sage: f.truncate(6)
p^5 + p^3 + p^2
sage: g.truncate(6)
l^2 + l^3 + l^5 + O(l^6)
sage: f.truncate_powerseries(6)
p^2 + p^3 + p^5 + O(p^6)

The problem is simply that g.truncate() calls truncate_powerseries() on its underlying power series.

The attached patch changes LaurentSeries.truncate() such that is calls truncate() on the underlying powerseries. For the current behaviour, it also adds a method truncate_laurentseries() which calls truncate_powerseries() on the underlying powerseries.

In my opinion, the methods truncate_powerseries and truncate_laurentseries are superfluous since they are equivalent to add_bigoh().

Issue created by migration from https://trac.sagemath.org/ticket/10272





---

archive/issue_comments_104650.json:
```json
{
    "body": "Is this ready for review?  If so, you should change its status to \"needs review\".",
    "created_at": "2011-01-11T05:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104650",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Is this ready for review?  If so, you should change its status to "needs review".



---

archive/issue_comments_104651.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-01-11T13:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104651",
    "user": "https://github.com/tkluck"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_104652.json:
```json
{
    "body": "Thanks, I just did.",
    "created_at": "2011-01-11T13:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104652",
    "user": "https://github.com/tkluck"
}
```

Thanks, I just did.



---

archive/issue_comments_104653.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-12T00:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104653",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_104654.json:
```json
{
    "body": "Looks good, positive review.  Doesn't break any doctests in rings because Laurent series are so poorly tested!\nOnly bad thing is that you should include the ticket number on the patch, i.e. this one should have been named something like trac_10272_laurent_series_truncate.patch.  This helps the release manager and others in a variety of ways.",
    "created_at": "2011-01-12T00:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104654",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Looks good, positive review.  Doesn't break any doctests in rings because Laurent series are so poorly tested!
Only bad thing is that you should include the ticket number on the patch, i.e. this one should have been named something like trac_10272_laurent_series_truncate.patch.  This helps the release manager and others in a variety of ways.



---

archive/issue_events_026415.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-17T17:16:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10271#event-26415"
}
```



---

archive/issue_comments_104655.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-01-17T17:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104655",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_104656.json:
```json
{
    "body": "Patches should be created using `hg export tip`, not `hg diff`.  I also remind you that a patch should have a sensible commit message (use `hg qrefresh -e` for that) and that the ticket number should appear on the first line of the commit message.",
    "created_at": "2011-01-17T17:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104656",
    "user": "https://github.com/jdemeyer"
}
```

Patches should be created using `hg export tip`, not `hg diff`.  I also remind you that a patch should have a sensible commit message (use `hg qrefresh -e` for that) and that the ticket number should appear on the first line of the commit message.



---

archive/issue_comments_104657.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-16T16:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104657",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_104658.json:
```json
{
    "body": "I just added the patch in the right format, i.e. the output of `hg_sage.export()` instead of a normal diff.",
    "created_at": "2011-03-16T16:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104658",
    "user": "https://github.com/tkluck"
}
```

I just added the patch in the right format, i.e. the output of `hg_sage.export()` instead of a normal diff.



---

archive/issue_comments_104659.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-03-16T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104659",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_104660.json:
```json
{
    "body": "Please read [http://sagemath.org/doc/developer/conventions.html#documentation-strings](http://sagemath.org/doc/developer/conventions.html#documentation-strings) and fix the documentation of this new function accordingly.  In particular, you should add at least one example.",
    "created_at": "2011-03-16T18:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104660",
    "user": "https://github.com/jdemeyer"
}
```

Please read [http://sagemath.org/doc/developer/conventions.html#documentation-strings](http://sagemath.org/doc/developer/conventions.html#documentation-strings) and fix the documentation of this new function accordingly.  In particular, you should add at least one example.



---

archive/issue_comments_104661.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-17T16:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104661",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_104662.json:
```json
{
    "body": "Thanks, just added docstrings and examples.",
    "created_at": "2011-03-17T16:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104662",
    "user": "https://github.com/tkluck"
}
```

Thanks, just added docstrings and examples.



---

archive/issue_comments_104663.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-05T15:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104663",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_104664.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-04-05T16:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104664",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_104665.json:
```json
{
    "body": "This needs to be rebased:\n\n```\napplying /scratch/jdemeyer/merger/downloads/trac_10272_laurent_series_truncate.patch\npatching file sage/rings/laurent_series_ring_element.pyx\nHunk #1 FAILED at 725\n1 out of 1 hunks FAILED -- saving rejects to file sage/rings/laurent_series_ring_element.pyx.rej\nabort: patch failed to apply\n```\n",
    "created_at": "2011-04-05T16:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104665",
    "user": "https://github.com/jdemeyer"
}
```

This needs to be rebased:

```
applying /scratch/jdemeyer/merger/downloads/trac_10272_laurent_series_truncate.patch
patching file sage/rings/laurent_series_ring_element.pyx
Hunk #1 FAILED at 725
1 out of 1 hunks FAILED -- saving rejects to file sage/rings/laurent_series_ring_element.pyx.rej
abort: patch failed to apply
```




---

archive/issue_comments_104666.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-30T18:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104666",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_104667.json:
```json
{
    "body": "Attachment [trac_10272_laurent_series_truncate.patch](tarball://root/attachments/some-uuid/ticket10272/trac_10272_laurent_series_truncate.patch) by @tkluck created at 2011-11-30 18:49:28\n\nSorry for not having done this earlier, I totally forgot. I just uploaded a new version that should apply cleanly against the current version. Please review.",
    "created_at": "2011-11-30T18:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104667",
    "user": "https://github.com/tkluck"
}
```

Attachment [trac_10272_laurent_series_truncate.patch](tarball://root/attachments/some-uuid/ticket10272/trac_10272_laurent_series_truncate.patch) by @tkluck created at 2011-11-30 18:49:28

Sorry for not having done this earlier, I totally forgot. I just uploaded a new version that should apply cleanly against the current version. Please review.



---

archive/issue_comments_104668.json:
```json
{
    "body": "\n```\n\nsage -t  \"devel/sage-main/sage/rings/laurent_series_ring_element.pyx\"\n\t [2.1 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 2.1 seconds\n```\n\nAnd it still applies.",
    "created_at": "2012-05-26T07:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104668",
    "user": "https://github.com/kcrisman"
}
```


```

sage -t  "devel/sage-main/sage/rings/laurent_series_ring_element.pyx"
	 [2.1 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 2.1 seconds
```

And it still applies.



---

archive/issue_comments_104669.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-26T07:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104669",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_104670.json:
```json
{
    "body": "Changing keywords from \"laurent series, truncate\" to \"laurent series, truncate sd40.5\".",
    "created_at": "2012-05-26T07:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104670",
    "user": "https://github.com/kcrisman"
}
```

Changing keywords from "laurent series, truncate" to "laurent series, truncate sd40.5".



---

archive/issue_events_026416.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-05T11:52:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10271#event-26416"
}
```



---

archive/issue_comments_104671.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-06-05T11:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10271",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10271#issuecomment-104671",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
