# Issue 13125: Add doctests for the scripts rst2txt and rst2sws

Issue created by migration from https://trac.sagemath.org/ticket/13297

Original creator: slabbe

Original creation time: 2012-07-26 16:14:10

Assignee: slabbe

`sage -rst2sws` and `sage -rst2txt` introduced in #11459 are not doctested and are suceptible to be broken in the future. Such doctests can be added to the file `sage/tests/cmdline.py`.


---

Comment by slabbe created at 2014-11-21 16:33:46

Motivated by the (second) issue found in #17371, I finally wrote doctests for cmdline rst2txt and rst2sws.

Needs review!
----
New commits:


---

Comment by slabbe created at 2014-11-21 16:33:46

Changing status from new to needs_review.


---

Comment by kcrisman created at 2014-11-21 17:23:55

Ah!  Maybe we can also use this to test other scripts of this nature... see #17377.

Just a comment (I don't have time immediately to try this): What of `sage --rst2txt` - is that eventually a new way?  I think that is now supported, anyway, maybe should put that instead for consistency's sake (not that I care, I know others do).


---

Comment by cheuberg created at 2014-11-21 19:54:00

Would it be feasible to check that the output of `-rst2sws` does what it should, e.g. using the python `tarfile` module to extract `sage_worksheet/worksheet.html` and check its content?


---

Comment by kcrisman created at 2014-11-21 20:27:07

I think that should be pretty reasonable, as long as one uses temp files throughout.


---

Comment by git created at 2014-11-21 20:57:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2014-11-21 21:00:36

Thanks for your comments, I fix them accordingly. I also added more tests.


---

Comment by cheuberg created at 2014-11-22 05:16:31

The new tests seem to be reasonable. Doctests pass. The `.sws` file generated in the test can be imported into the sage worksheet, so it seems to be ok. I manually checked `./sage -docbuild file=src/sage/tests/cmdline.py html` to check that no new `ReSt` errors are introduced by this ticket (the list at the top is rendered messily, but that's not this ticket's fault).

For me, this is a positive review. I do not yet press the button in order to give Karl-Dieter or others still a possibility to comment.


---

Comment by kcrisman created at 2014-11-23 02:07:15

Nono, looks fine to me too but I don't have time to test and think about it, so feel free!


---

Comment by cheuberg created at 2014-11-23 05:37:33

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-11-24 16:02:14

Resolution: fixed
