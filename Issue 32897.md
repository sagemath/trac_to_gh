# Issue 32897: random error in hilbert_poincare_series

archive/issues_032897.json:
```json
{
    "body": "CC:  @dkwo @antonio-rojas @orlitzky simonking\n\nThis was found on 9.5-rc0, using singular 4.2.1 from system (void linux, we haven't upgraded to 4.2.1p3 yet). In case this is relevant, flint is up to date (2.8.4). I wasn't able to reproduce on 9.5-beta9.\n\n```\nsage -t --long --random-seed=136266901849903582203467517333467427001 src/sage/rings/polynomial/hilbert.pyx\n**********************************************************************\nFile \"src/sage/rings/polynomial/hilbert.pyx\", line 581, in sage.rings.polynomial.hilbert.hilbert_poincare_series\nFailed example:\n    J.hilbert_numerator(algorithm='singular')\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.hilbert.hilbert_poincare_series[11]>\", line 1, in <module>\n        J.hilbert_numerator(algorithm='singular')\n      File \"/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 297, in __call__\n        return self.f(self._instance, *args, **kwds)\n      File \"/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/rings/qqbar_decorators.py\", line 96, in wrapper\n        return func(*args, **kwds)\n      File \"/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 2900, in hilbert_numerator\n        hs = hilb(gb, 1, attributes={gb: {'isSB': 1}})\n      File \"sage/libs/singular/function.pyx\", line 1334, in sage.libs.singular.function.SingularFunction.__call__ (build/cythonized/sage/libs/singular/function.cpp:15222)\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1532, in sage.libs.singular.function.call_function (build/cythonized/sage/libs/singular/function.cpp:17224)\n        raise RuntimeError(\"error in Singular function call %r:\\n%s\" %\n    RuntimeError: error in Singular function call 'hilb':\n    int overflow in hilb 1\n**********************************************************************\n1 item had failures:\n   1 of  13 in sage.rings.polynomial.hilbert.hilbert_poincare_series\n    [25 tests, 1 failure, 0.22 s]\n----------------------------------------------------------------------\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33134\n\n",
    "created_at": "2022-01-09T19:01:27Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "random error in hilbert_poincare_series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32897",
    "user": "@tornaria"
}
```
CC:  @dkwo @antonio-rojas @orlitzky simonking

This was found on 9.5-rc0, using singular 4.2.1 from system (void linux, we haven't upgraded to 4.2.1p3 yet). In case this is relevant, flint is up to date (2.8.4). I wasn't able to reproduce on 9.5-beta9.

```
sage -t --long --random-seed=136266901849903582203467517333467427001 src/sage/rings/polynomial/hilbert.pyx
**********************************************************************
File "src/sage/rings/polynomial/hilbert.pyx", line 581, in sage.rings.polynomial.hilbert.hilbert_poincare_series
Failed example:
    J.hilbert_numerator(algorithm='singular')
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.hilbert.hilbert_poincare_series[11]>", line 1, in <module>
        J.hilbert_numerator(algorithm='singular')
      File "/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 297, in __call__
        return self.f(self._instance, *args, **kwds)
      File "/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/rings/qqbar_decorators.py", line 96, in wrapper
        return func(*args, **kwds)
      File "/usr/lib/sage-9.5.rc0/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 2900, in hilbert_numerator
        hs = hilb(gb, 1, attributes={gb: {'isSB': 1}})
      File "sage/libs/singular/function.pyx", line 1334, in sage.libs.singular.function.SingularFunction.__call__ (build/cythonized/sage/libs/singular/function.cpp:15222)
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1532, in sage.libs.singular.function.call_function (build/cythonized/sage/libs/singular/function.cpp:17224)
        raise RuntimeError("error in Singular function call %r:\n%s" %
    RuntimeError: error in Singular function call 'hilb':
    int overflow in hilb 1
**********************************************************************
1 item had failures:
   1 of  13 in sage.rings.polynomial.hilbert.hilbert_poincare_series
    [25 tests, 1 failure, 0.22 s]
----------------------------------------------------------------------
```


Issue created by migration from https://trac.sagemath.org/ticket/33134





---

archive/issue_comments_469191.json:
```json
{
    "body": "This doctest was changed in [720d10e](https://git.sagemath.org/sage.git/commit?id=720d10e8a7f7d2bf4038b65c64e73db494106a57), so I guess (a) this is not random at all (b) we need to update singular in void linux.",
    "created_at": "2022-01-09T21:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469191",
    "user": "@tornaria"
}
```

This doctest was changed in [720d10e](https://git.sagemath.org/sage.git/commit?id=720d10e8a7f7d2bf4038b65c64e73db494106a57), so I guess (a) this is not random at all (b) we need to update singular in void linux.



---

archive/issue_comments_469192.json:
```json
{
    "body": "`@`arojas: I wonder if we should change/remove this doctest, or else require singular >= 4.2.1p2?\n\nEdit: I meant 4.2.1p2",
    "created_at": "2022-01-09T21:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469192",
    "user": "@tornaria"
}
```

`@`arojas: I wonder if we should change/remove this doctest, or else require singular >= 4.2.1p2?

Edit: I meant 4.2.1p2



---

archive/issue_comments_469193.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build: configure.",
    "created_at": "2022-01-09T21:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469193",
    "user": "@mkoeppe"
}
```

Changing component from PLEASE CHANGE to build: configure.



---

archive/issue_comments_469194.json:
```json
{
    "body": "See also #32789",
    "created_at": "2022-01-09T21:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469194",
    "user": "@mkoeppe"
}
```

See also #32789



---

archive/issue_comments_469195.json:
```json
{
    "body": "Replying to [comment:2 tornaria]:\n> `@`arojas: I wonder if we should change/remove this doctest, or else require singular >= 4.2.1p2?\n> \n> Edit: I meant 4.2.1p2\n\nThat's what I already asked in #32907#comment:18",
    "created_at": "2022-01-09T21:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469195",
    "user": "@antonio-rojas"
}
```

Replying to [comment:2 tornaria]:
> `@`arojas: I wonder if we should change/remove this doctest, or else require singular >= 4.2.1p2?
> 
> Edit: I meant 4.2.1p2

That's what I already asked in #32907#comment:18



---

archive/issue_comments_469196.json:
```json
{
    "body": "Is this the only failing test with 4.2.1? Either way, I think we should change the tests to pass with >=singular-4.2.1, for two reasons. First, v4.2.1 is not that old, and it's polite to give distros some time to catch up. Second, testing for \"patchlevel 2 or higher\" is a pain in the ass because it doesn't show up in the pkg-config file.",
    "created_at": "2022-01-09T22:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469196",
    "user": "@orlitzky"
}
```

Is this the only failing test with 4.2.1? Either way, I think we should change the tests to pass with >=singular-4.2.1, for two reasons. First, v4.2.1 is not that old, and it's polite to give distros some time to catch up. Second, testing for "patchlevel 2 or higher" is a pain in the ass because it doesn't show up in the pkg-config file.



---

archive/issue_comments_469197.json:
```json
{
    "body": "It's going to take me a while to build rc0, but something like this should do the trick:\n\n\n```\n    This example exceeded the capabilities of Singular before version 4.2.1p2:: \n                                                                                \n        sage: expected = (120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30       \n        ....:             + 2753520*t^29 - 13522410*t^28 + 52832780*t^27        \n        ....:             - 168384150*t^26 + 445188744*t^25 - 987193350*t^24    \n        ....:             + 1847488500*t^23 + 1372406746*t^22 - 403422496*t^21  \n        ....:             - 8403314*t^20 - 471656596*t^19 + 1806623746*t^18     \n        ....:             + 752776200*t^17 + 752776200*t^16 - 1580830020*t^15   \n        ....:             + 1673936550*t^14 - 1294246800*t^13 + 786893250*t^12  \n        ....:             - 382391100*t^11 + 146679390*t^10 - 42299400*t^9      \n        ....:             + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5  \n        ....:             - 39270*t^4 + 5060*t^3 - 330*t^2 + 1)                 \n        ....: actual = None                                                     \n        sage: try:                                                              \n        ....:     actual = J.hilbert_numerator(algorithm='singular')            \n        ....: except RuntimeError:                                              \n        ....:     pass                                                          \n        ....: actual is None or (actual == expected)                            \n        True                                                                    \n```\n",
    "created_at": "2022-01-09T22:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469197",
    "user": "@orlitzky"
}
```

It's going to take me a while to build rc0, but something like this should do the trick:


```
    This example exceeded the capabilities of Singular before version 4.2.1p2:: 
                                                                                
        sage: expected = (120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30       
        ....:             + 2753520*t^29 - 13522410*t^28 + 52832780*t^27        
        ....:             - 168384150*t^26 + 445188744*t^25 - 987193350*t^24    
        ....:             + 1847488500*t^23 + 1372406746*t^22 - 403422496*t^21  
        ....:             - 8403314*t^20 - 471656596*t^19 + 1806623746*t^18     
        ....:             + 752776200*t^17 + 752776200*t^16 - 1580830020*t^15   
        ....:             + 1673936550*t^14 - 1294246800*t^13 + 786893250*t^12  
        ....:             - 382391100*t^11 + 146679390*t^10 - 42299400*t^9      
        ....:             + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5  
        ....:             - 39270*t^4 + 5060*t^3 - 330*t^2 + 1)                 
        ....: actual = None                                                     
        sage: try:                                                              
        ....:     actual = J.hilbert_numerator(algorithm='singular')            
        ....: except RuntimeError:                                              
        ....:     pass                                                          
        ....: actual is None or (actual == expected)                            
        True                                                                    
```




---

archive/issue_comments_469198.json:
```json
{
    "body": "Replying to [comment:6 mjo]:\n> Is this the only failing test with 4.2.1? Either way, I think we should change the tests to pass with >=singular-4.2.1, for two reasons. First, v4.2.1 is not that old, and it's polite to give distros some time to catch up. Second, testing for \"patchlevel 2 or higher\" is a pain in the ass because it doesn't show up in the pkg-config file.\n\nYes, this is the only failing test for me.\n\nI'm not sure what's the purpose of this example/test. It seems to me the simplest thing is to tag it as \"# not tested - requires singular >=4.2.1p2\".",
    "created_at": "2022-01-10T03:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469198",
    "user": "@tornaria"
}
```

Replying to [comment:6 mjo]:
> Is this the only failing test with 4.2.1? Either way, I think we should change the tests to pass with >=singular-4.2.1, for two reasons. First, v4.2.1 is not that old, and it's polite to give distros some time to catch up. Second, testing for "patchlevel 2 or higher" is a pain in the ass because it doesn't show up in the pkg-config file.

Yes, this is the only failing test for me.

I'm not sure what's the purpose of this example/test. It seems to me the simplest thing is to tag it as "# not tested - requires singular >=4.2.1p2".



---

archive/issue_comments_469199.json:
```json
{
    "body": "Well, something else is going on. With 4.2.1p3...\n\n\n```\nsage: n=4; m=11; P = PolynomialRing(QQ,n*m,\"x\")\nsage: x = P.gens(); M = Matrix(n,x)\nsage: I = P.ideal(M.minors(2))\nsage: J = P*[m.lm() for m in I.groebner_basis()]\nsage: expected = J.hilbert_numerator()\nsage: actual = J.hilbert_numerator(algorithm='singular')\nsage: actual == expected\nFalse\nsage: actual - expected\n4294967296*t^22 - 4294967296*t^21 + 4294967296*t^20 - 4294967296*t^19 + 4294967296*t^18\n```\n",
    "created_at": "2022-01-10T11:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469199",
    "user": "@orlitzky"
}
```

Well, something else is going on. With 4.2.1p3...


```
sage: n=4; m=11; P = PolynomialRing(QQ,n*m,"x")
sage: x = P.gens(); M = Matrix(n,x)
sage: I = P.ideal(M.minors(2))
sage: J = P*[m.lm() for m in I.groebner_basis()]
sage: expected = J.hilbert_numerator()
sage: actual = J.hilbert_numerator(algorithm='singular')
sage: actual == expected
False
sage: actual - expected
4294967296*t^22 - 4294967296*t^21 + 4294967296*t^20 - 4294967296*t^19 + 4294967296*t^18
```




---

archive/issue_comments_469200.json:
```json
{
    "body": "Simon, we should be expecting the Hilbert numerators to be the same with both algorithm=sage and algorithm=singular, right?",
    "created_at": "2022-01-10T11:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469200",
    "user": "@orlitzky"
}
```

Simon, we should be expecting the Hilbert numerators to be the same with both algorithm=sage and algorithm=singular, right?



---

archive/issue_comments_469201.json:
```json
{
    "body": "We updated to singular-4.3.0 (released wed) and everything passes now.",
    "created_at": "2022-01-14T17:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469201",
    "user": "@tornaria"
}
```

We updated to singular-4.3.0 (released wed) and everything passes now.



---

archive/issue_comments_469202.json:
```json
{
    "body": "Replying to [comment:11 tornaria]:\n> We updated to singular-4.3.0 (released wed) and everything passes now.\n\nDo the \"sage\" and \"singular\" algorithms still produce different results (comment:9)? At this point I'm more worried that we've added a doctest for the wrong answer...",
    "created_at": "2022-01-14T17:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469202",
    "user": "@orlitzky"
}
```

Replying to [comment:11 tornaria]:
> We updated to singular-4.3.0 (released wed) and everything passes now.

Do the "sage" and "singular" algorithms still produce different results (comment:9)? At this point I'm more worried that we've added a doctest for the wrong answer...



---

archive/issue_comments_469203.json:
```json
{
    "body": "Replying to [comment:12 mjo]:\n> Replying to [comment:11 tornaria]:\n> > We updated to singular-4.3.0 (released wed) and everything passes now.\n> \n> Do the \"sage\" and \"singular\" algorithms still produce different results (comment:9)? At this point I'm more worried that we've added a doctest for the wrong answer...\n\nI'm getting the same as you. I couldn't help but notice that the difference is a multiple of `2^32`. In fact the coefficients we get from singular are just the truncation to `int32_t` of the ones we get from sage.\n\nMay be a bug in singular?",
    "created_at": "2022-01-14T18:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469203",
    "user": "@tornaria"
}
```

Replying to [comment:12 mjo]:
> Replying to [comment:11 tornaria]:
> > We updated to singular-4.3.0 (released wed) and everything passes now.
> 
> Do the "sage" and "singular" algorithms still produce different results (comment:9)? At this point I'm more worried that we've added a doctest for the wrong answer...

I'm getting the same as you. I couldn't help but notice that the difference is a multiple of `2^32`. In fact the coefficients we get from singular are just the truncation to `int32_t` of the ones we get from sage.

May be a bug in singular?



---

archive/issue_comments_469204.json:
```json
{
    "body": ".. or in the conversion from singular -> sage?",
    "created_at": "2022-01-14T18:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469204",
    "user": "@tornaria"
}
```

.. or in the conversion from singular -> sage?



---

archive/issue_comments_469205.json:
```json
{
    "body": "I've opened #33178 to investigate the underlying problem since that will take more time. For now let's just get rid of the test.\n----\nNew commits:",
    "created_at": "2022-01-15T03:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469205",
    "user": "@orlitzky"
}
```

I've opened #33178 to investigate the underlying problem since that will take more time. For now let's just get rid of the test.
----
New commits:



---

archive/issue_comments_469206.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-01-15T03:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469206",
    "user": "@orlitzky"
}
```

Changing priority from major to critical.



---

archive/issue_comments_469207.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-15T03:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469207",
    "user": "@orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_469208.json:
```json
{
    "body": "Set milestone to sage-9.6 after Sage 9.5 release.",
    "created_at": "2022-01-30T15:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469208",
    "user": "@slel"
}
```

Set milestone to sage-9.6 after Sage 9.5 release.



---

archive/issue_comments_469209.json:
```json
{
    "body": "Wouldn't it be better to mark it as `# known bug`?",
    "created_at": "2022-04-07T06:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469209",
    "user": "@tscrim"
}
```

Wouldn't it be better to mark it as `# known bug`?



---

archive/issue_comments_469210.json:
```json
{
    "body": "Replying to [comment:17 tscrim]:\n> Wouldn't it be better to mark it as `# known bug`?\n\nWhile it *is* a known bug, I don't see what benefit there is to (temporarily) recording one of the many possible wrong answers in the sage source code. Once the bug is fixed in #33178, the test will be brought back with the correct answer and a meaningful explanation.",
    "created_at": "2022-04-07T12:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469210",
    "user": "@orlitzky"
}
```

Replying to [comment:17 tscrim]:
> Wouldn't it be better to mark it as `# known bug`?

While it *is* a known bug, I don't see what benefit there is to (temporarily) recording one of the many possible wrong answers in the sage source code. Once the bug is fixed in #33178, the test will be brought back with the correct answer and a meaningful explanation.



---

archive/issue_comments_469211.json:
```json
{
    "body": "Replying to [comment:18 mjo]:\n> Replying to [comment:17 tscrim]:\n> > Wouldn't it be better to mark it as `# known bug`?\n> \n> While it *is* a known bug, I don't see what benefit there is to (temporarily) recording one of the many possible wrong answers in the sage source code.\n\nWe should find what we believe to be the correct answer and record it there.\n\n> Once the bug is fixed in #33178, the test will be brought back with the correct answer and a meaningful explanation.\n\nFrom my experience, I would be skeptical of it reappearing. This doctest is testing something, but the answer doesn't necessarily reflect that. If we don't trust at least one way of generating the \"answer,\" then the other algorithm should have big warnings attached to it. One other option if we don't trust any output is to add some more information to the discussion before the doctest to warn the user IMO.",
    "created_at": "2022-04-08T08:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469211",
    "user": "@tscrim"
}
```

Replying to [comment:18 mjo]:
> Replying to [comment:17 tscrim]:
> > Wouldn't it be better to mark it as `# known bug`?
> 
> While it *is* a known bug, I don't see what benefit there is to (temporarily) recording one of the many possible wrong answers in the sage source code.

We should find what we believe to be the correct answer and record it there.

> Once the bug is fixed in #33178, the test will be brought back with the correct answer and a meaningful explanation.

From my experience, I would be skeptical of it reappearing. This doctest is testing something, but the answer doesn't necessarily reflect that. If we don't trust at least one way of generating the "answer," then the other algorithm should have big warnings attached to it. One other option if we don't trust any output is to add some more information to the discussion before the doctest to warn the user IMO.



---

archive/issue_comments_469212.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-05-05T12:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469212",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_469213.json:
```json
{
    "body": "Replying to [comment:19 tscrim]:\n>\n> From my experience, I would be skeptical of it reappearing. This doctest is testing something, but the answer doesn't necessarily reflect that. If we don't trust at least one way of generating the \"answer,\" then the other algorithm should have big warnings attached to it. One other option if we don't trust any output is to add some more information to the discussion before the doctest to warn the user IMO.\n\nI wrote a random test for `hilbert_numerator()` that will help to ensure the two algorithms agree, once they do. I think that's a better approach than strcmp on the result.",
    "created_at": "2022-05-05T13:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469213",
    "user": "@orlitzky"
}
```

Replying to [comment:19 tscrim]:
>
> From my experience, I would be skeptical of it reappearing. This doctest is testing something, but the answer doesn't necessarily reflect that. If we don't trust at least one way of generating the "answer," then the other algorithm should have big warnings attached to it. One other option if we don't trust any output is to add some more information to the discussion before the doctest to warn the user IMO.

I wrote a random test for `hilbert_numerator()` that will help to ensure the two algorithms agree, once they do. I think that's a better approach than strcmp on the result.



---

archive/issue_comments_469214.json:
```json
{
    "body": "rebased over #33160\n----\nNew commits:",
    "created_at": "2022-07-11T12:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469214",
    "user": "@dimpase"
}
```

rebased over #33160
----
New commits:



---

archive/issue_comments_469215.json:
```json
{
    "body": "this just adds one `#not tested` example, the rest is taken care in #33160",
    "created_at": "2022-07-11T12:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469215",
    "user": "@dimpase"
}
```

this just adds one `#not tested` example, the rest is taken care in #33160



---

archive/issue_comments_469216.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-11T12:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469216",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_469217.json:
```json
{
    "body": "On 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/rings/polynomial/hilbert.pyx\", line 583, in sage.rings.polynomial.hilbert.hilbert_poincare_series\nFailed example:\n    J.hilbert_numerator(algorithm='singular')\nExpected nothing\nGot:\n    overflow at t^22\n    overflow at t^21\n    overflow at t^20\n    overflow at t^19\n    overflow at t^18\n    120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30 + 2753520*t^29 - 13522410*t^28 + 52832780*t^27 - 168384150*t^26 + 445188744*t^25 - 987193350*t^24 + 1847488500*t^23 + 752776200*t^17 + 752776200*t^16 - 1580830020*t^15 + 1673936550*t^14 - 1294246800*t^13 + 786893250*t^12 - 382391100*t^11 + 146679390*t^10 - 42299400*t^9 + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5 - 39270*t^4 + 5060*t^3 - 330*t^2 + 1\n**********************************************************************\n```\n",
    "created_at": "2022-07-17T08:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469217",
    "user": "@vbraun"
}
```

On 32-bit:

```
**********************************************************************
File "src/sage/rings/polynomial/hilbert.pyx", line 583, in sage.rings.polynomial.hilbert.hilbert_poincare_series
Failed example:
    J.hilbert_numerator(algorithm='singular')
Expected nothing
Got:
    overflow at t^22
    overflow at t^21
    overflow at t^20
    overflow at t^19
    overflow at t^18
    120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30 + 2753520*t^29 - 13522410*t^28 + 52832780*t^27 - 168384150*t^26 + 445188744*t^25 - 987193350*t^24 + 1847488500*t^23 + 752776200*t^17 + 752776200*t^16 - 1580830020*t^15 + 1673936550*t^14 - 1294246800*t^13 + 786893250*t^12 - 382391100*t^11 + 146679390*t^10 - 42299400*t^9 + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5 - 39270*t^4 + 5060*t^3 - 330*t^2 + 1
**********************************************************************
```




---

archive/issue_comments_469218.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-17T08:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469218",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_469219.json:
```json
{
    "body": "one needs to add 32-bit test case",
    "created_at": "2022-07-17T10:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469219",
    "user": "@dimpase"
}
```

one needs to add 32-bit test case



---

archive/issue_comments_469220.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-17T16:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469220",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_469221.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-17T16:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469221",
    "user": "@dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_469222.json:
```json
{
    "body": "this should be it",
    "created_at": "2022-07-17T16:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469222",
    "user": "@dimpase"
}
```

this should be it



---

archive/issue_comments_469223.json:
```json
{
    "body": "I've made it part of #33160 now",
    "created_at": "2022-07-18T23:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469223",
    "user": "@mkoeppe"
}
```

I've made it part of #33160 now



---

archive/issue_comments_469224.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-07-18T23:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469224",
    "user": "@mkoeppe"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_469225.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-18T23:23:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469225",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_469226.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2022-07-29T09:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32897#issuecomment-469226",
    "user": "@slel"
}
```

Resolution: duplicate
