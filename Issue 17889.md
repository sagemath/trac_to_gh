# Issue 17889: Coin-OR CBC: new-style SPKG

archive/issues_017889.json:
```json
{
    "body": "CC:  tmonteil vdelecroix dcoudert\n\nThis branch turns CBC into a new-style spkg.\n\nThe new upstream/cbc-2.9.4.tar.bz2 file is automatically built by the spkg-src script (the current version in Sage is 2.8.1).\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/18126\n\n",
    "created_at": "2015-04-05T17:32:53Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Coin-OR CBC: new-style SPKG",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17889",
    "user": "ncohen"
}
```
CC:  tmonteil vdelecroix dcoudert

This branch turns CBC into a new-style spkg.

The new upstream/cbc-2.9.4.tar.bz2 file is automatically built by the spkg-src script (the current version in Sage is 2.8.1).

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/18126





---

archive/issue_comments_240027.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-05T17:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240027",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_240028.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-05T17:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240028",
    "user": "ncohen"
}
```

New commits:



---

archive/issue_comments_240029.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd66\".",
    "created_at": "2015-04-05T17:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240029",
    "user": "ncohen"
}
```

Changing keywords from "" to "sd66".



---

archive/issue_comments_240030.json:
```json
{
    "body": "Are you sure it's `IBM Coportation` ?\n\n\nI have the following issue, and I don't find it at that address.\n\n\n```\nconfetti:sage dcoudert$ ./sage -i cbc\nFound local metadata for cbc-2.9.4\nAttempting to download package cbc-2.9.4\n>>> Trying to download http://www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2\n[Traceback (most recent call last):\n  File \"<stdin>\", line 35, in <module>\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 240, in retrieve\n    fp = self.open(url, data)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 208, in open\n    return getattr(self, name)(url)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 359, in open_http\n    return self.http_error(url, fp, errcode, errmsg, headers)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 376, in http_error\n    return self.http_error_default(url, fp, errcode, errmsg, headers)\n  File \"<stdin>\", line 17, in http_error_default\nIOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2'\nError: failed to download package cbc-2.9.4\n```\n",
    "created_at": "2015-04-06T01:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240030",
    "user": "dcoudert"
}
```

Are you sure it's `IBM Coportation` ?


I have the following issue, and I don't find it at that address.


```
confetti:sage dcoudert$ ./sage -i cbc
Found local metadata for cbc-2.9.4
Attempting to download package cbc-2.9.4
>>> Trying to download http://www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2
[Traceback (most recent call last):
  File "<stdin>", line 35, in <module>
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 240, in retrieve
    fp = self.open(url, data)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 208, in open
    return getattr(self, name)(url)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 359, in open_http
    return self.http_error(url, fp, errcode, errmsg, headers)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 376, in http_error
    return self.http_error_default(url, fp, errcode, errmsg, headers)
  File "<stdin>", line 17, in http_error_default
IOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2'
Error: failed to download package cbc-2.9.4
```




---

archive/issue_comments_240031.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-06T01:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240031",
    "user": "dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_240032.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-06T08:40:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240032",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240033.json:
```json
{
    "body": "Hellooooo,\n\n> Are you sure it's `IBM Coportation` ?\n\nWhile updating that I noticed that the license had changed. Fixed.\n\n> I have the following issue, and I don't find it at that address.\n\nThis is because you do not have the new .tar.bz2 file. The spkg-src script (see the ticket's description) that this branch contains will download it for you.\n\nNathann",
    "created_at": "2015-04-06T08:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240033",
    "user": "ncohen"
}
```

Hellooooo,

> Are you sure it's `IBM Coportation` ?

While updating that I noticed that the license had changed. Fixed.

> I have the following issue, and I don't find it at that address.

This is because you do not have the new .tar.bz2 file. The spkg-src script (see the ticket's description) that this branch contains will download it for you.

Nathann



---

archive/issue_comments_240034.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-06T08:42:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240034",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_240035.json:
```json
{
    "body": "Hello,\n\nstill not working. Also, I don't see a cbc page at http://www.sagemath.org/packages/upstream/\n\nWhy not pointing directly to http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz ?\n\nDavid.",
    "created_at": "2015-04-06T11:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240035",
    "user": "dcoudert"
}
```

Hello,

still not working. Also, I don't see a cbc page at http://www.sagemath.org/packages/upstream/

Why not pointing directly to http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz ?

David.



---

archive/issue_comments_240036.json:
```json
{
    "body": "Hello,\n\n> still not working.\n\nCould you give a more informative error message? What happens when you run spkg-src?\n\n> Also, I don't see a cbc page at http://www.sagemath.org/packages/upstream/\n\nNo problem here, that's because coin is an optional package. You don't see Nauty there either.\n\n> Why not pointing directly to http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz ?\n\nBecause it is not a .tar.bz2 file, and that's what I think we have to put in our upstream/ folder.\n\nNathann",
    "created_at": "2015-04-06T12:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240036",
    "user": "ncohen"
}
```

Hello,

> still not working.

Could you give a more informative error message? What happens when you run spkg-src?

> Also, I don't see a cbc page at http://www.sagemath.org/packages/upstream/

No problem here, that's because coin is an optional package. You don't see Nauty there either.

> Why not pointing directly to http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz ?

Because it is not a .tar.bz2 file, and that's what I think we have to put in our upstream/ folder.

Nathann



---

archive/issue_comments_240037.json:
```json
{
    "body": "Hello,\n\nI should run `spkg-src` and not `sage -i cbc` ???\nYou should mention it in the ticket description.\n\n\n```\nconfetti:sage dcoudert$ build/pkgs/cbc/spkg-src \ncat: package-version.txt: No such file or directory\nsed: illegal option -- r\nusage: sed script [-Ealn] [-i extension] [file ...]\n       sed [-Ealn] [-i extension] [-e script] ... [-f script_file] ... [file ...]\n--2015-04-06 14:08:36--  http://www.coin-or.org/download/source/Cbc/Cbc-.tgz\nR\u00e9solution de www.coin-or.org (www.coin-or.org)\u2026 130.127.215.8\nConnexion \u00e0 www.coin-or.org (www.coin-or.org)|130.127.215.8|:80\u2026 connect\u00e9.\nrequ\u00eate HTTP transmise, en attente de la r\u00e9ponse\u2026 404 Not Found\n2015-04-06 14:08:39 erreur\u00a0404\u00a0: Not Found.\n\n```\n\n\n\n```\nconfetti:sage dcoudert$ ./sage -i cbc\nFound local metadata for cbc-2.9.4\nAttempting to download package cbc-2.9.4\n>>> Trying to download http://www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2\n[Traceback (most recent call last):\n  File \"<stdin>\", line 35, in <module>\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 240, in retrieve\n    fp = self.open(url, data)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 208, in open\n    return getattr(self, name)(url)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 359, in open_http\n    return self.http_error(url, fp, errcode, errmsg, headers)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 376, in http_error\n    return self.http_error_default(url, fp, errcode, errmsg, headers)\n  File \"<stdin>\", line 17, in http_error_default\nIOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2'\nError: failed to download package cbc-2.9.4\n```\n",
    "created_at": "2015-04-06T12:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240037",
    "user": "dcoudert"
}
```

Hello,

I should run `spkg-src` and not `sage -i cbc` ???
You should mention it in the ticket description.


```
confetti:sage dcoudert$ build/pkgs/cbc/spkg-src 
cat: package-version.txt: No such file or directory
sed: illegal option -- r
usage: sed script [-Ealn] [-i extension] [file ...]
       sed [-Ealn] [-i extension] [-e script] ... [-f script_file] ... [file ...]
--2015-04-06 14:08:36--  http://www.coin-or.org/download/source/Cbc/Cbc-.tgz
Résolution de www.coin-or.org (www.coin-or.org)… 130.127.215.8
Connexion à www.coin-or.org (www.coin-or.org)|130.127.215.8|:80… connecté.
requête HTTP transmise, en attente de la réponse… 404 Not Found
2015-04-06 14:08:39 erreur 404 : Not Found.

```



```
confetti:sage dcoudert$ ./sage -i cbc
Found local metadata for cbc-2.9.4
Attempting to download package cbc-2.9.4
>>> Trying to download http://www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2
[Traceback (most recent call last):
  File "<stdin>", line 35, in <module>
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 240, in retrieve
    fp = self.open(url, data)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 208, in open
    return getattr(self, name)(url)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 359, in open_http
    return self.http_error(url, fp, errcode, errmsg, headers)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 376, in http_error
    return self.http_error_default(url, fp, errcode, errmsg, headers)
  File "<stdin>", line 17, in http_error_default
IOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2'
Error: failed to download package cbc-2.9.4
```




---

archive/issue_comments_240038.json:
```json
{
    "body": "Hello,\n\n> I should run `spkg-src` and not `sage -i cbc` ???\n\nspkg-src downloads the upstream Cbc for you, transforms it a bit and stores it in upstream. Could you start this script while going in the right folder first?\n\nThe spkg-src scripts are just there to make the developer's life easier when a spkg gets udpated. You change the version number, start the script, and the .tar.bz2 file is built for you.\n\nOnce this is done, the command `sage -i cbc` will find the .tar.bz2 file.\n\nNathann",
    "created_at": "2015-04-06T12:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240038",
    "user": "ncohen"
}
```

Hello,

> I should run `spkg-src` and not `sage -i cbc` ???

spkg-src downloads the upstream Cbc for you, transforms it a bit and stores it in upstream. Could you start this script while going in the right folder first?

The spkg-src scripts are just there to make the developer's life easier when a spkg gets udpated. You change the version number, start the script, and the .tar.bz2 file is built for you.

Once this is done, the command `sage -i cbc` will find the .tar.bz2 file.

Nathann



---

archive/issue_comments_240039.json:
```json
{
    "body": "Additionally, these `spkg-src` scripts are also useful to certify that the guy who uploads a .tar.bz2 file has not introduced any code in the original package. As you can see how the .tar.bz2 file is built, I cannot be suspected of introducing backdoors on everybody's computer.\n\nNathann",
    "created_at": "2015-04-06T12:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240039",
    "user": "ncohen"
}
```

Additionally, these `spkg-src` scripts are also useful to certify that the guy who uploads a .tar.bz2 file has not introduced any code in the original package. As you can see how the .tar.bz2 file is built, I cannot be suspected of introducing backdoors on everybody's computer.

Nathann



---

archive/issue_comments_240040.json:
```json
{
    "body": "\n```\nconfetti:cbc dcoudert$ ./spkg-src \nsed: illegal option -- r\nusage: sed script [-Ealn] [-i extension] [file ...]\n       sed [-Ealn] [-i extension] [-e script] ... [-f script_file] ... [file ...]\n--2015-04-06 14:35:26--  http://www.coin-or.org/download/source/Cbc/Cbc-.tgz\nR\u00e9solution de www.coin-or.org (www.coin-or.org)\u2026 130.127.215.8\nConnexion \u00e0 www.coin-or.org (www.coin-or.org)|130.127.215.8|:80\u2026 connect\u00e9.\nrequ\u00eate HTTP transmise, en attente de la r\u00e9ponse\u2026 404 Not Found\n2015-04-06 14:35:27 erreur\u00a0404\u00a0: Not Found.\n```\n\n\n\n```\nconfetti:cbc dcoudert$ cat package-version.txt | sed -re \"s/^(.*)\\\\.p.+$/\\\\1/\"\nsed: illegal option -- r\nusage: sed script [-Ealn] [-i extension] [file ...]\n       sed [-Ealn] [-i extension] [-e script] ... [-f script_file] ... [file ...]\n```\n\n\n\n```\nconfetti:cbc dcoudert$ cat package-version.txt | sed -e \"s/^(.*)\\\\.p.+$/\\\\1/\"\nsed: 1: \"s/^(.*)\\.p.+$/\\1/\n\": \\1 not defined in the RE\n```\n\n\n\n```\nconfetti:cbc dcoudert$ cat package-version.txt | sed -e \"s/^(.*)\\\\.p.+$/$1/\"\n2.9.4\n```\n",
    "created_at": "2015-04-06T12:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240040",
    "user": "dcoudert"
}
```


```
confetti:cbc dcoudert$ ./spkg-src 
sed: illegal option -- r
usage: sed script [-Ealn] [-i extension] [file ...]
       sed [-Ealn] [-i extension] [-e script] ... [-f script_file] ... [file ...]
--2015-04-06 14:35:26--  http://www.coin-or.org/download/source/Cbc/Cbc-.tgz
Résolution de www.coin-or.org (www.coin-or.org)… 130.127.215.8
Connexion à www.coin-or.org (www.coin-or.org)|130.127.215.8|:80… connecté.
requête HTTP transmise, en attente de la réponse… 404 Not Found
2015-04-06 14:35:27 erreur 404 : Not Found.
```



```
confetti:cbc dcoudert$ cat package-version.txt | sed -re "s/^(.*)\\.p.+$/\\1/"
sed: illegal option -- r
usage: sed script [-Ealn] [-i extension] [file ...]
       sed [-Ealn] [-i extension] [-e script] ... [-f script_file] ... [file ...]
```



```
confetti:cbc dcoudert$ cat package-version.txt | sed -e "s/^(.*)\\.p.+$/\\1/"
sed: 1: "s/^(.*)\.p.+$/\1/
": \1 not defined in the RE
```



```
confetti:cbc dcoudert$ cat package-version.txt | sed -e "s/^(.*)\\.p.+$/$1/"
2.9.4
```




---

archive/issue_comments_240041.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-06T12:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240041",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240042.json:
```json
{
    "body": "Some progress\n\n```\nconfetti:sage dcoudert$ ./sage -i cbc\nFound local metadata for cbc-2.9.4\nAttempting to download package cbc-2.9.4\n>>> Trying to download http://www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2\n[Traceback (most recent call last):\n  File \"<stdin>\", line 35, in <module>\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 240, in retrieve\n    fp = self.open(url, data)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 208, in open\n    return getattr(self, name)(url)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 359, in open_http\n    return self.http_error(url, fp, errcode, errmsg, headers)\n  File \"/Users/dcoudert/sage/local/lib/python/urllib.py\", line 376, in http_error\n    return self.http_error_default(url, fp, errcode, errmsg, headers)\n  File \"<stdin>\", line 17, in http_error_default\nIOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2'\nError: failed to download package cbc-2.9.4\nconfetti:sage dcoudert$          \nconfetti:sage dcoudert$ cd build/pkgs/cbc/\nconfetti:cbc dcoudert$ ./spkg-src \n--2015-04-06 14:48:46--  http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz\nR\u00e9solution de www.coin-or.org (www.coin-or.org)\u2026 130.127.215.8\nConnexion \u00e0 www.coin-or.org (www.coin-or.org)|130.127.215.8|:80\u2026 connect\u00e9.\nrequ\u00eate HTTP transmise, en attente de la r\u00e9ponse\u2026 200 OK\nTaille\u00a0: 13761766 (13M) [application/x-gzip]\nSauvegarde en\u00a0: \u00ab\u00a0Cbc-2.9.4.tgz\u00a0\u00bb\n\nCbc-2.9.4.tgz                                       100%[===================================================================================================================>]  13,12M  74,6KB/s   ds 2m 37s \n\n2015-04-06 14:51:24 (85,5 KB/s) \u2014 \u00ab\u00a0Cbc-2.9.4.tgz\u00a0\u00bb sauvegard\u00e9 [13761766/13761766]\n\nmv: rename Cbc-2.9.4.tar.bz2 to /upstream/cbc-2.9.4.tar.bz2: No such file or directory\nconfetti:cbc dcoudert$ ll\ntotal 23032\n-rw-r--r--  1 dcoudert  staff  11768072 31 mar 09:30 Cbc-2.9.4.tar.bz2\n-rw-r--r--  1 dcoudert  staff       905  6 avr 14:04 SPKG.txt\n-rw-r--r--  1 dcoudert  staff       128  6 avr 14:04 checksums.ini\n-rw-r--r--  1 dcoudert  staff         6  6 avr 14:04 package-version.txt\n-rwxr-xr-x  1 dcoudert  staff      1220  6 avr 14:04 spkg-install\n-rwxr-xr-x  1 dcoudert  staff       429  6 avr 14:47 spkg-src\n```\n\n\nAlso, version 2.9.4 is not listed on page http://www.sagemath.org/packages/optional/\nOnly 2.8.1.p0",
    "created_at": "2015-04-06T12:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240042",
    "user": "dcoudert"
}
```

Some progress

```
confetti:sage dcoudert$ ./sage -i cbc
Found local metadata for cbc-2.9.4
Attempting to download package cbc-2.9.4
>>> Trying to download http://www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2
[Traceback (most recent call last):
  File "<stdin>", line 35, in <module>
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 240, in retrieve
    fp = self.open(url, data)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 208, in open
    return getattr(self, name)(url)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 359, in open_http
    return self.http_error(url, fp, errcode, errmsg, headers)
  File "/Users/dcoudert/sage/local/lib/python/urllib.py", line 376, in http_error
    return self.http_error_default(url, fp, errcode, errmsg, headers)
  File "<stdin>", line 17, in http_error_default
IOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/cbc/cbc-2.9.4.tar.bz2'
Error: failed to download package cbc-2.9.4
confetti:sage dcoudert$          
confetti:sage dcoudert$ cd build/pkgs/cbc/
confetti:cbc dcoudert$ ./spkg-src 
--2015-04-06 14:48:46--  http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz
Résolution de www.coin-or.org (www.coin-or.org)… 130.127.215.8
Connexion à www.coin-or.org (www.coin-or.org)|130.127.215.8|:80… connecté.
requête HTTP transmise, en attente de la réponse… 200 OK
Taille : 13761766 (13M) [application/x-gzip]
Sauvegarde en : « Cbc-2.9.4.tgz »

Cbc-2.9.4.tgz                                       100%[===================================================================================================================>]  13,12M  74,6KB/s   ds 2m 37s 

2015-04-06 14:51:24 (85,5 KB/s) — « Cbc-2.9.4.tgz » sauvegardé [13761766/13761766]

mv: rename Cbc-2.9.4.tar.bz2 to /upstream/cbc-2.9.4.tar.bz2: No such file or directory
confetti:cbc dcoudert$ ll
total 23032
-rw-r--r--  1 dcoudert  staff  11768072 31 mar 09:30 Cbc-2.9.4.tar.bz2
-rw-r--r--  1 dcoudert  staff       905  6 avr 14:04 SPKG.txt
-rw-r--r--  1 dcoudert  staff       128  6 avr 14:04 checksums.ini
-rw-r--r--  1 dcoudert  staff         6  6 avr 14:04 package-version.txt
-rwxr-xr-x  1 dcoudert  staff      1220  6 avr 14:04 spkg-install
-rwxr-xr-x  1 dcoudert  staff       429  6 avr 14:47 spkg-src
```


Also, version 2.9.4 is not listed on page http://www.sagemath.org/packages/optional/
Only 2.8.1.p0



---

archive/issue_comments_240043.json:
```json
{
    "body": "Hello,\n\nThis fails because your `SAGE_ROOT` variable is not set. You can:\n\n1) Define it in your bash; or\n2) Run the script from the console that you get after a `sage -sh`\n\nNathann",
    "created_at": "2015-04-06T12:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240043",
    "user": "ncohen"
}
```

Hello,

This fails because your `SAGE_ROOT` variable is not set. You can:

1) Define it in your bash; or
2) Run the script from the console that you get after a `sage -sh`

Nathann



---

archive/issue_comments_240044.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-06T13:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240044",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240045.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-06T13:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240045",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_240046.json:
```json
{
    "body": "You did a push while I was testing the stuff, so I don't know if it will change something.\n\nAfter setting SAGE_ROOT in .bash_profile :\n\n```\nconfetti:cbc dcoudert$ ./spkg-src \n--2015-04-06 15:07:53--  http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz\nR\u00e9solution de www.coin-or.org (www.coin-or.org)\u2026 130.127.215.8\nConnexion \u00e0 www.coin-or.org (www.coin-or.org)|130.127.215.8|:80\u2026 connect\u00e9.\nrequ\u00eate HTTP transmise, en attente de la r\u00e9ponse\u2026 200 OK\nTaille : 13761766 (13M) [application/x-gzip]\nSauvegarde en : \u00ab Cbc-2.9.4.tgz \u00bb\n\nCbc-2.9.4.tgz                                       100%[===================================================================================================================>]  13,12M  93,9KB/s   ds 2m 9s  \n\n2015-04-06 15:10:05 (104 KB/s) \u2014 \u00ab Cbc-2.9.4.tgz \u00bb sauvegard\u00e9 [13761766/13761766]\n\n./spkg-src: line 17: sage: command not found\nconfetti:cbc dcoudert$ echo $SAGE_ROOT\n/Users/dcoudert/sage/\nconfetti:cbc dcoudert$ sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath Version 6.6.rc2, Release Date: 2015-04-02                 \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: \nExiting Sage (CPU time 0m0.02s, Wall time 0m5.00s).\nconfetti:cbc dcoudert$ cd $SAGE_ROOT\nconfetti:sage dcoudert$ sage -i cbc\nFound local metadata for cbc-2.9.4\nFound local sources at /Users/dcoudert/sage/upstream/cbc-2.9.4.tar.bz2\nChecksum: 6afb943dcc3f60bff525456ad175cf19f6a2e28e vs 6afb943dcc3f60bff525456ad175cf19f6a2e28e\ncbc-2.9.4\n====================================================\nSetting up build directory for cbc-2.9.4\n...\n...\nSuccessfully installed cbc-2.9.4\nDeleting temporary build directory\n/Users/dcoudert/sage/local/var/tmp/sage/build/cbc-2.9.4\nFinished installing cbc-2.9.4.spkg\n\nWarning: it might be needed to update the Sage library before\ninstalled packages work: you should run 'make' from $SAGE_ROOT\nbefore running Sage.\n\n```\n\n\nSo it is working this way, but it was not working when trying first `sage -i cbc`. Don't know why.\n\nWhat should I do next?",
    "created_at": "2015-04-06T13:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240046",
    "user": "dcoudert"
}
```

You did a push while I was testing the stuff, so I don't know if it will change something.

After setting SAGE_ROOT in .bash_profile :

```
confetti:cbc dcoudert$ ./spkg-src 
--2015-04-06 15:07:53--  http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz
Résolution de www.coin-or.org (www.coin-or.org)… 130.127.215.8
Connexion à www.coin-or.org (www.coin-or.org)|130.127.215.8|:80… connecté.
requête HTTP transmise, en attente de la réponse… 200 OK
Taille : 13761766 (13M) [application/x-gzip]
Sauvegarde en : « Cbc-2.9.4.tgz »

Cbc-2.9.4.tgz                                       100%[===================================================================================================================>]  13,12M  93,9KB/s   ds 2m 9s  

2015-04-06 15:10:05 (104 KB/s) — « Cbc-2.9.4.tgz » sauvegardé [13761766/13761766]

./spkg-src: line 17: sage: command not found
confetti:cbc dcoudert$ echo $SAGE_ROOT
/Users/dcoudert/sage/
confetti:cbc dcoudert$ sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath Version 6.6.rc2, Release Date: 2015-04-02                 │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
Exiting Sage (CPU time 0m0.02s, Wall time 0m5.00s).
confetti:cbc dcoudert$ cd $SAGE_ROOT
confetti:sage dcoudert$ sage -i cbc
Found local metadata for cbc-2.9.4
Found local sources at /Users/dcoudert/sage/upstream/cbc-2.9.4.tar.bz2
Checksum: 6afb943dcc3f60bff525456ad175cf19f6a2e28e vs 6afb943dcc3f60bff525456ad175cf19f6a2e28e
cbc-2.9.4
====================================================
Setting up build directory for cbc-2.9.4
...
...
Successfully installed cbc-2.9.4
Deleting temporary build directory
/Users/dcoudert/sage/local/var/tmp/sage/build/cbc-2.9.4
Finished installing cbc-2.9.4.spkg

Warning: it might be needed to update the Sage library before
installed packages work: you should run 'make' from $SAGE_ROOT
before running Sage.

```


So it is working this way, but it was not working when trying first `sage -i cbc`. Don't know why.

What should I do next?



---

archive/issue_comments_240047.json:
```json
{
    "body": "Hello !\n\n> You did a push while I was testing the stuff, so I don't know if it will change something.\n\nI added a warning to say something more useful when SAGE_ROOT is not defined. This block of 4 lines can be found in most `spkg-install` scripts that Sage ships.\n\n> So it is working this way, but it was not working when trying first `sage -i cbc`. Don't know why.\n\nNew-style spkg work this way: ideally we have in upstream/ the copy of the source files, as given by the original authors of the software. Then, in build/pkgs we have some scripts to install it as it should in Sage.\n\nAs the sources were not available on your computer (and obviously not on Sage's server either, as the version we have here is more recent) the spkg-src script downloaded it from Coin's website and created the upstream/ archive. Then, with `sage -i cbc` you called the scripts from `build/pkgs/`, which used the new .tar.bz2 file.\n\n> What should I do next?\n\nWell, now you apparently have Cbc on your computer. So you can solve LP with it, check that tests pass when you add `--optional=sage,coin` to `sage -t`.\n\nNathann",
    "created_at": "2015-04-06T13:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240047",
    "user": "ncohen"
}
```

Hello !

> You did a push while I was testing the stuff, so I don't know if it will change something.

I added a warning to say something more useful when SAGE_ROOT is not defined. This block of 4 lines can be found in most `spkg-install` scripts that Sage ships.

> So it is working this way, but it was not working when trying first `sage -i cbc`. Don't know why.

New-style spkg work this way: ideally we have in upstream/ the copy of the source files, as given by the original authors of the software. Then, in build/pkgs we have some scripts to install it as it should in Sage.

As the sources were not available on your computer (and obviously not on Sage's server either, as the version we have here is more recent) the spkg-src script downloaded it from Coin's website and created the upstream/ archive. Then, with `sage -i cbc` you called the scripts from `build/pkgs/`, which used the new .tar.bz2 file.

> What should I do next?

Well, now you apparently have Cbc on your computer. So you can solve LP with it, check that tests pass when you add `--optional=sage,coin` to `sage -t`.

Nathann



---

archive/issue_comments_240048.json:
```json
{
    "body": "- The changes made on the source code should better be in a separate patch file rather than a `sed` command within the `spkg-install` script (so that one can easily see what changed from upstream in a uniform way). The associated comment should be part of the patch, see #17357\n- I do not see the point of `spkg-src` : since there is no change made in the tarball, why not just keep the upstream `Cbc-2.9.4.tgz` file and rename it `cbc-2.9.4.tar.gz` without any modification and put the link http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz in the ticket description ?\n- \"SPKG Maintainers\" field is no longer required, see https://groups.google.com/forum/?fromgroups#!searchin/sage-devel/spkg$20maintainers/sage-devel/-MZAvj8qxVk/EdbRFw0hGucJ http://thread.gmane.org/gmane.comp.mathematics.sage.devel/75324",
    "created_at": "2015-04-06T20:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240048",
    "user": "tmonteil"
}
```

- The changes made on the source code should better be in a separate patch file rather than a `sed` command within the `spkg-install` script (so that one can easily see what changed from upstream in a uniform way). The associated comment should be part of the patch, see #17357
- I do not see the point of `spkg-src` : since there is no change made in the tarball, why not just keep the upstream `Cbc-2.9.4.tgz` file and rename it `cbc-2.9.4.tar.gz` without any modification and put the link http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz in the ticket description ?
- "SPKG Maintainers" field is no longer required, see https://groups.google.com/forum/?fromgroups#!searchin/sage-devel/spkg$20maintainers/sage-devel/-MZAvj8qxVk/EdbRFw0hGucJ http://thread.gmane.org/gmane.comp.mathematics.sage.devel/75324



---

archive/issue_comments_240049.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-06T20:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240049",
    "user": "tmonteil"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_240050.json:
```json
{
    "body": "Hello,\n\n> - The changes made on the source code should better be in a separate patch file rather than a `sed` command within the `spkg-install` script (so that one can easily see what changed from upstream in a uniform way). The associated comment should be part of the patch, see #17357\n\nThe `spkg-install` file is a pure copy of what the spkg already contains.\n\n> - I do not see the point of `spkg-src` : since there is no change made in the tarball, why not just keep the upstream `Cbc-2.9.4.tgz` file and rename it `cbc-2.9.4.tar.gz` without any modification and put the link http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz in the ticket description ?\n\nBecause I believe that we need .tar.bz2 files in upstream. There is no other reason.\n\n> - \"SPKG Maintainers\" field is no longer required, see https://groups.google.com/forum/?fromgroups#!searchin/sage-devel/spkg$20maintainers/sage-devel/-MZAvj8qxVk/EdbRFw0hGucJ http://thread.gmane.org/gmane.comp.mathematics.sage.devel/75324\n\nI don't mind. I will remove it in a second and set the patch to `needs_review` again, waiting for your answer about the first two points.\n\nNathann",
    "created_at": "2015-04-06T20:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240050",
    "user": "ncohen"
}
```

Hello,

> - The changes made on the source code should better be in a separate patch file rather than a `sed` command within the `spkg-install` script (so that one can easily see what changed from upstream in a uniform way). The associated comment should be part of the patch, see #17357

The `spkg-install` file is a pure copy of what the spkg already contains.

> - I do not see the point of `spkg-src` : since there is no change made in the tarball, why not just keep the upstream `Cbc-2.9.4.tgz` file and rename it `cbc-2.9.4.tar.gz` without any modification and put the link http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz in the ticket description ?

Because I believe that we need .tar.bz2 files in upstream. There is no other reason.

> - "SPKG Maintainers" field is no longer required, see https://groups.google.com/forum/?fromgroups#!searchin/sage-devel/spkg$20maintainers/sage-devel/-MZAvj8qxVk/EdbRFw0hGucJ http://thread.gmane.org/gmane.comp.mathematics.sage.devel/75324

I don't mind. I will remove it in a second and set the patch to `needs_review` again, waiting for your answer about the first two points.

Nathann



---

archive/issue_comments_240051.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-06T20:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240051",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240052.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-06T20:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240052",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_240053.json:
```json
{
    "body": "Hi,\n\nthe third point was the minor one,\n- concerning the first point, it is better to have our custom changes in a single well-defined place, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#patching-sources\n- concerning the second point, tar.gz files are also accepted and `spkg-src` should be avoided as possible, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#modified-tarballs\n\nCiao,\nThierry",
    "created_at": "2015-04-06T21:22:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240053",
    "user": "tmonteil"
}
```

Hi,

the third point was the minor one,
- concerning the first point, it is better to have our custom changes in a single well-defined place, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#patching-sources
- concerning the second point, tar.gz files are also accepted and `spkg-src` should be avoided as possible, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#modified-tarballs

Ciao,
Thierry



---

archive/issue_comments_240054.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-06T21:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240054",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240055.json:
```json
{
    "body": "Hello,\n\n> - concerning the first point, it is better to have our custom changes in a single well-defined place, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#patching-sources\n\nIn general applying patches is a good idea, but here we are patching an automatically generated file. I believe that it is safer to change it with a sed command (which just replaces some text with another one), as we would otherwise have to change the patch files (using the sed comand) whenever it changes.\n\n> - concerning the second point, tar.gz files are also accepted and `spkg-src` should be avoided as possible, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#modified-tarballs\n\nI removed the script.\n\nNathann",
    "created_at": "2015-04-06T21:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240055",
    "user": "ncohen"
}
```

Hello,

> - concerning the first point, it is better to have our custom changes in a single well-defined place, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#patching-sources

In general applying patches is a good idea, but here we are patching an automatically generated file. I believe that it is safer to change it with a sed command (which just replaces some text with another one), as we would otherwise have to change the patch files (using the sed comand) whenever it changes.

> - concerning the second point, tar.gz files are also accepted and `spkg-src` should be avoided as possible, you can have a look at : http://www.sagemath.org/doc/developer/packaging.html#modified-tarballs

I removed the script.

Nathann



---

archive/issue_comments_240056.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-06T22:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240056",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_240057.json:
```json
{
    "body": "Having a .tar.gz file seems to break the install scipts. I removed the last commit and set the ticket's description to its original text.",
    "created_at": "2015-04-06T22:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240057",
    "user": "ncohen"
}
```

Having a .tar.gz file seems to break the install scipts. I removed the last commit and set the ticket's description to its original text.



---

archive/issue_comments_240058.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-07T21:06:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240058",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240059.json:
```json
{
    "body": "Replying to [comment:30 ncohen]:\n> Having a .tar.gz file seems to break the install scipts.\n> \n\nI think this is because you did not update `checksums.ini`.\n\nThe installation works fine, but then, when i do `sage -b`, i got : \n\n\n```\n...\nbuilding 'sage.numerical.backends.coin_backend' extension\nExecuting 1 command (using 1 thread)\nerror: [Errno 13] Permission denied\n```\n\n\nDo you know what could be wrong ?",
    "created_at": "2015-04-07T21:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240059",
    "user": "tmonteil"
}
```

Replying to [comment:30 ncohen]:
> Having a .tar.gz file seems to break the install scipts.
> 

I think this is because you did not update `checksums.ini`.

The installation works fine, but then, when i do `sage -b`, i got : 


```
...
building 'sage.numerical.backends.coin_backend' extension
Executing 1 command (using 1 thread)
error: [Errno 13] Permission denied
```


Do you know what could be wrong ?



---

archive/issue_comments_240060.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-07T21:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240060",
    "user": "tmonteil"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_240061.json:
```json
{
    "body": "Yo !\n\n> I think this is because you did not update `checksums.ini`.\n\nI am an idiot `T_T`\n\n> The installation works fine, but then, when i do `sage -b`, i got : \n> \n> {{{\n> ...\n> building 'sage.numerical.backends.coin_backend' extension\n> Executing 1 command (using 1 thread)\n> error: [Errno 13] Permission denied\n> }}}\n> \n> Do you know what could be wrong ?\n\nNo idea. What is the line that raises that? Are you the user with writing permissions on SAGE_ROOT and its subdirectories?\n\nNathann",
    "created_at": "2015-04-07T21:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240061",
    "user": "ncohen"
}
```

Yo !

> I think this is because you did not update `checksums.ini`.

I am an idiot `T_T`

> The installation works fine, but then, when i do `sage -b`, i got : 
> 
> {{{
> ...
> building 'sage.numerical.backends.coin_backend' extension
> Executing 1 command (using 1 thread)
> error: [Errno 13] Permission denied
> }}}
> 
> Do you know what could be wrong ?

No idea. What is the line that raises that? Are you the user with writing permissions on SAGE_ROOT and its subdirectories?

Nathann



---

archive/issue_comments_240062.json:
```json
{
    "body": "Replying to [comment:33 ncohen]:\n> No idea. What is the line that raises that? \n\nThe full output of `sage -b` command is:\n\n\n```\nscons: `install' is up to date.\nUpdating Cython code....\nEnabling Cython debugging support\nFinished Cythonizing, time: 14.40 seconds.\nDiscovering Python source code....\nDiscovered Python source, time: 0.23 seconds.\nCleaning up stale installed files....\n- cleaning /opt/sagemath/sage-6.3/local/lib/python2.7/site-packages\n- cleaning /opt/sagemath/sage-6.3/local/lib/site-python\n- cleaning /opt/sagemath/sage-6.3/src/build/lib.linux-i686-2.7\nFinished cleaning, time: 0.29 seconds.\nrunning install\nrunning build\nrunning build_py\nrunning build_ext\nbuilding 'sage.numerical.backends.coin_backend' extension\nExecuting 1 command (using 1 thread)\nerror: [Errno 13] Permission denied\n```\n\n\nNote that `sage -i cbc` ended with `Finished installing cbc-2.9.4.spkg`. I have been out of memory during sd66, i hope it did not mess up something on my directory.\n\n> Are you the user with writing permissions on SAGE_ROOT and its subdirectories?\n\nYes, i have only one user on my computer :)",
    "created_at": "2015-04-07T21:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240062",
    "user": "tmonteil"
}
```

Replying to [comment:33 ncohen]:
> No idea. What is the line that raises that? 

The full output of `sage -b` command is:


```
scons: `install' is up to date.
Updating Cython code....
Enabling Cython debugging support
Finished Cythonizing, time: 14.40 seconds.
Discovering Python source code....
Discovered Python source, time: 0.23 seconds.
Cleaning up stale installed files....
- cleaning /opt/sagemath/sage-6.3/local/lib/python2.7/site-packages
- cleaning /opt/sagemath/sage-6.3/local/lib/site-python
- cleaning /opt/sagemath/sage-6.3/src/build/lib.linux-i686-2.7
Finished cleaning, time: 0.29 seconds.
running install
running build
running build_py
running build_ext
building 'sage.numerical.backends.coin_backend' extension
Executing 1 command (using 1 thread)
error: [Errno 13] Permission denied
```


Note that `sage -i cbc` ended with `Finished installing cbc-2.9.4.spkg`. I have been out of memory during sd66, i hope it did not mess up something on my directory.

> Are you the user with writing permissions on SAGE_ROOT and its subdirectories?

Yes, i have only one user on my computer :)



---

archive/issue_comments_240063.json:
```json
{
    "body": "Replying to [comment:34 tmonteil]:\n> \n> Yes, i have only one user on my computer :)\n\nBut that doesn't mean the folder belongs to you, there are plenty of system class user out there - root in particular. Have you done anything as root with your install?",
    "created_at": "2015-04-07T21:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240063",
    "user": "fbissey"
}
```

Replying to [comment:34 tmonteil]:
> 
> Yes, i have only one user on my computer :)

But that doesn't mean the folder belongs to you, there are plenty of system class user out there - root in particular. Have you done anything as root with your install?



---

archive/issue_comments_240064.json:
```json
{
    "body": "Replying to [comment:35 fbissey]:\n> Have you done anything as root with your install?\n\nNot that i recall, but perhaps some chmod operation was not allowed when my disk was full. I double-checked that all files and subdirectories of SAGE_ROOT belong to my daily user (`find ! -user 1000` leads to nothing). I removed all cbc-related code, and the problem is still there, so it is probably an unrelated issue, sorry for the noise, i will come back to the review once this is fixed.",
    "created_at": "2015-04-07T22:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240064",
    "user": "tmonteil"
}
```

Replying to [comment:35 fbissey]:
> Have you done anything as root with your install?

Not that i recall, but perhaps some chmod operation was not allowed when my disk was full. I double-checked that all files and subdirectories of SAGE_ROOT belong to my daily user (`find ! -user 1000` leads to nothing). I removed all cbc-related code, and the problem is still there, so it is probably an unrelated issue, sorry for the noise, i will come back to the review once this is fixed.



---

archive/issue_comments_240065.json:
```json
{
    "body": "I set the ticket back to `needs_review` in the meantime. I have seen tickets go forgotten just because of their status `:-P`\n\nNathann",
    "created_at": "2015-04-08T07:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240065",
    "user": "ncohen"
}
```

I set the ticket back to `needs_review` in the meantime. I have seen tickets go forgotten just because of their status `:-P`

Nathann



---

archive/issue_comments_240066.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-08T07:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240066",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_240067.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-08T08:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240067",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_240068.json:
```json
{
    "body": "The following worked well:\n- downloading the tarball from http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz\n- rename it to `cbc-2.9.4.tar.gz` and move it to `$SAGE_ROOT/upstream`\n- do `sage -i cbc`\n- do `make`\n\nCould you update the ticket description?\n\nVincent",
    "created_at": "2015-04-08T08:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240068",
    "user": "vdelecroix"
}
```

The following worked well:
- downloading the tarball from http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz
- rename it to `cbc-2.9.4.tar.gz` and move it to `$SAGE_ROOT/upstream`
- do `sage -i cbc`
- do `make`

Could you update the ticket description?

Vincent



---

archive/issue_comments_240069.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-08T08:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240069",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_240070.json:
```json
{
    "body": "Replying to [comment:39 ncohen]:\n\nNote that the installation with `.tgz` did not work for me and I had to rename it `.tar.gz`.\n\nVincent",
    "created_at": "2015-04-08T08:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240070",
    "user": "vdelecroix"
}
```

Replying to [comment:39 ncohen]:

Note that the installation with `.tgz` did not work for me and I had to rename it `.tar.gz`.

Vincent



---

archive/issue_comments_240071.json:
```json
{
    "body": "> Note that the installation with `.tgz` did not work for me and I had to rename it `.tar.gz`.\n\nI had not noticed. Could you make the modification so that I do not get it wrong again?\n\nNathann",
    "created_at": "2015-04-08T08:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240071",
    "user": "ncohen"
}
```

> Note that the installation with `.tgz` did not work for me and I had to rename it `.tar.gz`.

I had not noticed. Could you make the modification so that I do not get it wrong again?

Nathann



---

archive/issue_comments_240072.json:
```json
{
    "body": "Running `sage -t numerical/backends/coin_backend.pyx --optional Coin` I got a lot of errors claiming that `get_solver` is not defined. Could you update the doctests in that ticket?\n\nVincent",
    "created_at": "2015-04-08T08:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240072",
    "user": "vdelecroix"
}
```

Running `sage -t numerical/backends/coin_backend.pyx --optional Coin` I got a lot of errors claiming that `get_solver` is not defined. Could you update the doctests in that ticket?

Vincent



---

archive/issue_comments_240073.json:
```json
{
    "body": "you must run then with --optional=sage,coin. Otherwise ONLY the lines with a flag get executed.\n\nNathann",
    "created_at": "2015-04-08T08:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240073",
    "user": "ncohen"
}
```

you must run then with --optional=sage,coin. Otherwise ONLY the lines with a flag get executed.

Nathann



---

archive/issue_comments_240074.json:
```json
{
    "body": "Much better ;-)",
    "created_at": "2015-04-08T08:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240074",
    "user": "vdelecroix"
}
```

Much better ;-)



---

archive/issue_comments_240075.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-08T08:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240075",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_240076.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-04-08T13:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240076",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_240077.json:
```json
{
    "body": "Please remove this message\n\n```\nATTENTION: YOU HAVE TO REBUILD THE SAGE LIBRARY TO GET THIS TO WORK\n```\n\n\nAfter building a package, there is already\n\n```\nWarning: it might be needed to update the Sage library before\ninstalled packages work: you should run 'make' from $SAGE_ROOT\nbefore running Sage.\n```\n",
    "created_at": "2015-04-08T13:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240077",
    "user": "jdemeyer"
}
```

Please remove this message

```
ATTENTION: YOU HAVE TO REBUILD THE SAGE LIBRARY TO GET THIS TO WORK
```


After building a package, there is already

```
Warning: it might be needed to update the Sage library before
installed packages work: you should run 'make' from $SAGE_ROOT
before running Sage.
```




---

archive/issue_comments_240078.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-08T15:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240078",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240079.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-04-08T15:55:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240079",
    "user": "ncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_240080.json:
```json
{
    "body": "Download link with the correct filename?",
    "created_at": "2015-04-09T12:15:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240080",
    "user": "vbraun"
}
```

Download link with the correct filename?



---

archive/issue_comments_240081.json:
```json
{
    "body": "> Download link with the correct filename?\n\n\n```\nwget \nhttp://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz -O cbc-2.9.4.tar.gz\n```\n",
    "created_at": "2015-04-09T12:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240081",
    "user": "ncohen"
}
```

> Download link with the correct filename?


```
wget 
http://www.coin-or.org/download/source/Cbc/Cbc-2.9.4.tgz -O cbc-2.9.4.tar.gz
```




---

archive/issue_comments_240082.json:
```json
{
    "body": "Thanks, if you would also please integrate the renaming into the release management script?",
    "created_at": "2015-04-09T12:23:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240082",
    "user": "vbraun"
}
```

Thanks, if you would also please integrate the renaming into the release management script?



---

archive/issue_comments_240083.json:
```json
{
    "body": "Thanks, if you would also please integrate the renaming into the release management script?",
    "created_at": "2015-04-09T12:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240083",
    "user": "vbraun"
}
```

Thanks, if you would also please integrate the renaming into the release management script?



---

archive/issue_comments_240084.json:
```json
{
    "body": "Do you need a permanent url for the package with the right name?\n\nNathann",
    "created_at": "2015-04-09T12:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240084",
    "user": "ncohen"
}
```

Do you need a permanent url for the package with the right name?

Nathann



---

archive/issue_comments_240085.json:
```json
{
    "body": "yes, that is preferred",
    "created_at": "2015-04-09T12:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240085",
    "user": "vbraun"
}
```

yes, that is preferred



---

archive/issue_comments_240086.json:
```json
{
    "body": "What for? Don't you download it just once, to add it to Sage's mirrors?\n\nNathann",
    "created_at": "2015-04-09T12:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240086",
    "user": "ncohen"
}
```

What for? Don't you download it just once, to add it to Sage's mirrors?

Nathann



---

archive/issue_comments_240087.json:
```json
{
    "body": "upstream might also modify their tarball while we are waiting for sage-6.6",
    "created_at": "2015-04-09T12:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240087",
    "user": "vbraun"
}
```

upstream might also modify their tarball while we are waiting for sage-6.6



---

archive/issue_comments_240088.json:
```json
{
    "body": "We have the checksums, no worries.\n\nNathann",
    "created_at": "2015-04-09T12:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240088",
    "user": "ncohen"
}
```

We have the checksums, no worries.

Nathann



---

archive/issue_comments_240089.json:
```json
{
    "body": "I'm not testing optional package checksums fyi",
    "created_at": "2015-04-09T12:50:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240089",
    "user": "vbraun"
}
```

I'm not testing optional package checksums fyi



---

archive/issue_comments_240090.json:
```json
{
    "body": "Would it be better for you if I re-wrote the spkg-src script that we had before? It would download the file and renames it for you.\n\nNathann",
    "created_at": "2015-04-09T12:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240090",
    "user": "ncohen"
}
```

Would it be better for you if I re-wrote the spkg-src script that we had before? It would download the file and renames it for you.

Nathann



---

archive/issue_comments_240091.json:
```json
{
    "body": "Volker?",
    "created_at": "2015-04-10T07:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240091",
    "user": "ncohen"
}
```

Volker?



---

archive/issue_comments_240092.json:
```json
{
    "body": "How's that going to help? I'm not going to manually run a different script every time some tarball gets updated.",
    "created_at": "2015-04-10T08:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240092",
    "user": "vbraun"
}
```

How's that going to help? I'm not going to manually run a different script every time some tarball gets updated.



---

archive/issue_comments_240093.json:
```json
{
    "body": "> How's that going to help? I'm not going to manually run a different script every time some tarball gets updated.\n\nWell right now you have to download it manually [1]. They don't upload the tarballs on my server when they make a new release, and unfortunately you cannot download it directly yourself because the first letter is in upper case. Life is tough.\n\nNathann\n\n[1] http://www.steinertriples.fr/ncohen/tmp/cbc-2.9.4.tar.gz",
    "created_at": "2015-04-10T08:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240093",
    "user": "ncohen"
}
```

> How's that going to help? I'm not going to manually run a different script every time some tarball gets updated.

Well right now you have to download it manually [1]. They don't upload the tarballs on my server when they make a new release, and unfortunately you cannot download it directly yourself because the first letter is in upper case. Life is tough.

Nathann

[1] http://www.steinertriples.fr/ncohen/tmp/cbc-2.9.4.tar.gz



---

archive/issue_comments_240094.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-14T19:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17889",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17889#issuecomment-240094",
    "user": "vbraun"
}
```

Resolution: fixed
