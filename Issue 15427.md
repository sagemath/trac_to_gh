# Issue 15427: Bug in IncidenceStructure.is_block_design

archive/issues_015427.json:
```json
{
    "body": "CC:  chapoton stefan wdj\n\nThis bug has been noticed by Frederic in #15285 :\n\n\n```\nsage: IncidenceStructure([0,1,2],[[0,1],[0,2],[1,2]]*15).is_block_design()\n(True, [1, 3, 2, 15])\nsage: IncidenceStructure([0,1,2],[[0,1],[0,2],[1,2]]*15).parameters()     \n(2, 3, 2, 15)\n```\n\n\nTurns out that the code of `is_block_design` was rather unclear, and rather... Costly. Here is a simpler, faster and more correct version in which the bug in solved.\n\nBefore: \n\n```\nsage: D = IncidenceStructure(range(32),designs.steiner_quadruple_system(32))\nsage: time D.is_block_design()                                              \nCPU times: user 14.31 s, sys: 0.00 s, total: 14.32 s\nWall time: 14.33 s\n(True, [3, 32, 4, 1])\n```\n\n\nAfter:\n\n```\nsage: D = IncidenceStructure(range(32),designs.steiner_quadruple_system(32))\nsage: time D.is_block_design()                                              \nCPU times: user 0.18 s, sys: 0.01 s, total: 0.19 s\nWall time: 0.17 s\n(True, [2, 32, 4, 15])\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15664\n\n",
    "created_at": "2014-01-11T14:06:37Z",
    "labels": [
        "combinatorics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Bug in IncidenceStructure.is_block_design",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15427",
    "user": "ncohen"
}
```
CC:  chapoton stefan wdj

This bug has been noticed by Frederic in #15285 :


```
sage: IncidenceStructure([0,1,2],[[0,1],[0,2],[1,2]]*15).is_block_design()
(True, [1, 3, 2, 15])
sage: IncidenceStructure([0,1,2],[[0,1],[0,2],[1,2]]*15).parameters()     
(2, 3, 2, 15)
```


Turns out that the code of `is_block_design` was rather unclear, and rather... Costly. Here is a simpler, faster and more correct version in which the bug in solved.

Before: 

```
sage: D = IncidenceStructure(range(32),designs.steiner_quadruple_system(32))
sage: time D.is_block_design()                                              
CPU times: user 14.31 s, sys: 0.00 s, total: 14.32 s
Wall time: 14.33 s
(True, [3, 32, 4, 1])
```


After:

```
sage: D = IncidenceStructure(range(32),designs.steiner_quadruple_system(32))
sage: time D.is_block_design()                                              
CPU times: user 0.18 s, sys: 0.01 s, total: 0.19 s
Wall time: 0.17 s
(True, [2, 32, 4, 15])
```


Issue created by migration from https://trac.sagemath.org/ticket/15664





---

archive/issue_comments_199145.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-01-11T14:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199145",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_199146.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-01-11T14:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199146",
    "user": "ncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_199147.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-01-11T17:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199147",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_199148.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2014-01-11T17:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199148",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_199149.json:
```json
{
    "body": "Hello,\n\nNice job !\n\nDo you still need to use `self.blocks()` instead of `self.blcks` ? You have replaced some of them, but there remains one.",
    "created_at": "2014-01-12T20:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199149",
    "user": "chapoton"
}
```

Hello,

Nice job !

Do you still need to use `self.blocks()` instead of `self.blcks` ? You have replaced some of them, but there remains one.



---

archive/issue_comments_199150.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2014-01-12T20:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199150",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_199151.json:
```json
{
    "body": "Fixed !\n\nNathann",
    "created_at": "2014-01-12T20:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199151",
    "user": "ncohen"
}
```

Fixed !

Nathann



---

archive/issue_comments_199152.json:
```json
{
    "body": "Looks good to me.\n\nOne last detail : there lacks a space after \"2\" in \"2is used when none is provided\"\n\nThen you can set a positive review.",
    "created_at": "2014-01-13T20:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199152",
    "user": "chapoton"
}
```

Looks good to me.

One last detail : there lacks a space after "2" in "2is used when none is provided"

Then you can set a positive review.



---

archive/issue_comments_199153.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2014-01-14T09:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199153",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_199154.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-01-14T09:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199154",
    "user": "ncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_199155.json:
```json
{
    "body": "Done ! Thanks for the review `;-)`\n\nNathann",
    "created_at": "2014-01-14T09:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199155",
    "user": "ncohen"
}
```

Done ! Thanks for the review `;-)`

Nathann



---

archive/issue_comments_199156.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-02-03T16:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15427#issuecomment-199156",
    "user": "vbraun"
}
```

Resolution: fixed
