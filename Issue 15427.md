# Issue 15427: Bug in IncidenceStructure.is_block_design

Issue created by migration from https://trac.sagemath.org/ticket/15664

Original creator: ncohen

Original creation time: 2014-01-11 14:06:37

CC:  chapoton stefan wdj

This bug has been noticed by Frederic in #15285 :


```
sage: IncidenceStructure([0,1,2],[[0,1],[0,2],[1,2]]*15).is_block_design()
(True, [1, 3, 2, 15])
sage: IncidenceStructure([0,1,2],[[0,1],[0,2],[1,2]]*15).parameters()     
(2, 3, 2, 15)
```


Turns out that the code of `is_block_design` was rather unclear, and rather... Costly. Here is a simpler, faster and more correct version in which the bug in solved.

Before: 

```
sage: D = IncidenceStructure(range(32),designs.steiner_quadruple_system(32))
sage: time D.is_block_design()                                              
CPU times: user 14.31 s, sys: 0.00 s, total: 14.32 s
Wall time: 14.33 s
(True, [3, 32, 4, 1])
```


After:

```
sage: D = IncidenceStructure(range(32),designs.steiner_quadruple_system(32))
sage: time D.is_block_design()                                              
CPU times: user 0.18 s, sys: 0.01 s, total: 0.19 s
Wall time: 0.17 s
(True, [2, 32, 4, 15])
```



---

Comment by ncohen created at 2014-01-11 14:07:55

Changing status from new to needs_review.


---

Comment by ncohen created at 2014-01-11 14:14:01

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2014-01-11 17:48:50

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-01-11 17:49:45

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by chapoton created at 2014-01-12 20:05:39

Hello,

Nice job !

Do you still need to use `self.blocks()` instead of `self.blcks` ? You have replaced some of them, but there remains one.


---

Comment by git created at 2014-01-12 20:31:54

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by ncohen created at 2014-01-12 20:33:06

Fixed !

Nathann


---

Comment by chapoton created at 2014-01-13 20:27:47

Looks good to me.

One last detail : there lacks a space after "2" in "2is used when none is provided"

Then you can set a positive review.


---

Comment by git created at 2014-01-14 09:16:46

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by ncohen created at 2014-01-14 09:17:14

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-01-14 09:17:14

Done ! Thanks for the review `;-)`

Nathann


---

Comment by vbraun created at 2014-02-03 16:07:46

Resolution: fixed
