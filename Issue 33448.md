# Issue 33448: PointConfiguration, Polyhedron, PolyhedralComplex: Compute regular triangulation/subdivision

archive/issues_033448.json:
```json
{
    "body": "CC:  @yuan-zhou @jplab @kliem\n\n`Triangulation` already has a method `normal_cone`, which computes the normal cone of the GKZ polytope that exposes the triangulation.\n\nWhat seems to be missing is a method to compute regular triangulations, given an element of the normal cone (a weight/lifting vector), computes the regular triangulation (or more generally, subdivision) of the point configuration / polyhedron. \n\nUnder some conditions, this would also make sense for polyhedral complexes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33685\n\n",
    "created_at": "2022-04-11T19:59:55Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "PointConfiguration, Polyhedron, PolyhedralComplex: Compute regular triangulation/subdivision",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33448",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @yuan-zhou @jplab @kliem

`Triangulation` already has a method `normal_cone`, which computes the normal cone of the GKZ polytope that exposes the triangulation.

What seems to be missing is a method to compute regular triangulations, given an element of the normal cone (a weight/lifting vector), computes the regular triangulation (or more generally, subdivision) of the point configuration / polyhedron. 

Under some conditions, this would also make sense for polyhedral complexes.

Issue created by migration from https://trac.sagemath.org/ticket/33685





---

archive/issue_events_088549.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33448#event-88549"
}
```



---

archive/issue_comments_475635.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T02:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_475636.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-08-08T03:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475636",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_475637.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T16:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475637",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_475638.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T18:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475638",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_475639.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T18:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_475640.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T19:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_475641.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T17:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475641",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_475642.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-09T18:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475642",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_475643.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-10T00:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_088550.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33448#event-88550"
}
```



---

archive/issue_events_088551.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33448#event-88551"
}
```



---

archive/issue_comments_475644.json:
```json
{
    "body": "The patchbot is red, but I was unable to see the Test details. Any idea why?",
    "created_at": "2022-09-10T21:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475644",
    "user": "https://github.com/yuan-zhou"
}
```

The patchbot is red, but I was unable to see the Test details. Any idea why?



---

archive/issue_comments_475645.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-10T21:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475645",
    "user": "https://github.com/yuan-zhou"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_475646.json:
```json
{
    "body": "\"Build & test\" (https://github.com/sagemath/sagetrac-mirror/runs/7757629097?check_suite_focus=true) shows 2 doctest failures",
    "created_at": "2022-09-10T21:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475646",
    "user": "https://github.com/mkoeppe"
}
```

"Build & test" (https://github.com/sagemath/sagetrac-mirror/runs/7757629097?check_suite_focus=true) shows 2 doctest failures



---

archive/issue_comments_475647.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-09-10T21:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475647",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_475648.json:
```json
{
    "body": "Ah yes, these two failures are already marked with \"FIXME\"",
    "created_at": "2022-09-10T21:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475648",
    "user": "https://github.com/mkoeppe"
}
```

Ah yes, these two failures are already marked with "FIXME"



---

archive/issue_comments_475649.json:
```json
{
    "body": "It is very confusing that \u201ctriangulation\u201d is called although often times it is just a subdivision.\n\nDoes the function \u201cis regular subdivision\u201d test whether other is a subdivision of self, or the reverse?",
    "created_at": "2022-09-18T08:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475649",
    "user": "https://github.com/yuan-zhou"
}
```

It is very confusing that “triangulation” is called although often times it is just a subdivision.

Does the function “is regular subdivision” test whether other is a subdivision of self, or the reverse?



---

archive/issue_comments_475650.json:
```json
{
    "body": "Would it be better to limit the scope of `is_regular_subdivision` to only the case where `self` satisfies `is_simplicial_complex` and `is_compact`? \n\nI notice that this requirement is specified in the method `as_triangulation`. But then, inside `is_regular_subdivision`, `self.as_triangulation` is called with `check=False`, which doesn't make sense to me.",
    "created_at": "2022-09-18T19:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475650",
    "user": "https://github.com/yuan-zhou"
}
```

Would it be better to limit the scope of `is_regular_subdivision` to only the case where `self` satisfies `is_simplicial_complex` and `is_compact`? 

I notice that this requirement is specified in the method `as_triangulation`. But then, inside `is_regular_subdivision`, `self.as_triangulation` is called with `check=False`, which doesn't make sense to me.



---

archive/issue_comments_475651.json:
```json
{
    "body": "Even if we assume that `self` is a triangulation, the decision process that `is_regular_subdivision` now uses doesn't make any sense to me, starting from `normal = normal_cone.relative_interior().an_element()`",
    "created_at": "2022-09-19T01:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475651",
    "user": "https://github.com/yuan-zhou"
}
```

Even if we assume that `self` is a triangulation, the decision process that `is_regular_subdivision` now uses doesn't make any sense to me, starting from `normal = normal_cone.relative_interior().an_element()`



---

archive/issue_comments_475652.json:
```json
{
    "body": "From the reference to Polymake example, I see that Polymake doesn't have the function `polyhedralcomplex.is_regular_subdivision(otherpolyhedralcomplex)`, but only `is_regular` which determines if a subdivision of a point collection is a regular subdivision. \n\nTherefore, I think there should be two parts in your `is_regular_subdivision` method: (1) determine if self is a regular subdivision (and compute a weight vector) (2) check if self is a subdivision of other.",
    "created_at": "2022-09-19T02:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475652",
    "user": "https://github.com/yuan-zhou"
}
```

From the reference to Polymake example, I see that Polymake doesn't have the function `polyhedralcomplex.is_regular_subdivision(otherpolyhedralcomplex)`, but only `is_regular` which determines if a subdivision of a point collection is a regular subdivision. 

Therefore, I think there should be two parts in your `is_regular_subdivision` method: (1) determine if self is a regular subdivision (and compute a weight vector) (2) check if self is a subdivision of other.



---

archive/issue_comments_475653.json:
```json
{
    "body": "Example: \npoints = [(0,0), (0,2), (2,2), (2,0), (1,3)]. \n\n`other` is the polyhedral complex whose maximal cells are [the square with the first 4 points as its vertices, the triangle with the last three points as its vertices]\n\n`self` is the polyhedral complex whose maximal cells are [triangle (pt0, pt1, pt4), triangle (pt0, pt4, pt3), triangle (pt1, pt2, pt4)]\n\n`self` is a regular subdivision of points, but not a subdivision of `other`.",
    "created_at": "2022-09-19T03:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475653",
    "user": "https://github.com/yuan-zhou"
}
```

Example: 
points = [(0,0), (0,2), (2,2), (2,0), (1,3)]. 

`other` is the polyhedral complex whose maximal cells are [the square with the first 4 points as its vertices, the triangle with the last three points as its vertices]

`self` is the polyhedral complex whose maximal cells are [triangle (pt0, pt1, pt4), triangle (pt0, pt4, pt3), triangle (pt1, pt2, pt4)]

`self` is a regular subdivision of points, but not a subdivision of `other`.



---

archive/issue_comments_475654.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-10-17T20:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33448#issuecomment-475654",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
