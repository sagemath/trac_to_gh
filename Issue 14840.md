# Issue 14840: Inconsistency in polynomial .reverse(n)

archive/issues_014840.json:
```json
{
    "body": "CC:  @mezzarobba @jhpalmieri\n\nKeywords: polynomial univariate reverse\n\nThe optional argument of the `.reverse()` method of univariate polynomials is interpreted inconsistently through different classes.\n\nRationals interpret is as \"length\":\n\n\n```python\nsage: _.<x> = QQ[]\nsage: (x+1).reverse(1)\n1\nsage: (x).reverse(1)\n0\n```\n\n\n\nThe docstring for generic polynomials (inherited by `CC`, number fields, `Polynomial_GF2X`,  `Polynomial_ZZ_pEX`, ...) says:\n\n> If an optional degree argument is given the coefficient list will\n> be truncated or zero padded as necessary and the reverse polynomial\n> will have the specified degree.\n\nbut the behaviour is inconsistent with it\n\n\n```python\nsage: _.<x> = GF(2)[]\nsage: (x+1).reverse(1)\nx + 1\nsage: (x).reverse(1)\n1\nsage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]\n[False, False, True, False, False, False, False, False, False, False]\nsage: inspect.getmro(x.__class__)[2]\n<type 'sage.rings.polynomial.polynomial_element.Polynomial'>\n```\n\n\n`Polynomial_zmod_flint` and `Polynomial_integer_dense_flint` have the exact same docstring and behaviour, though they do not inherit `.reverse()` from the generic class:\n\n\n```python\nsage: _.<x> = ZZ[]\nsage: (x+1).reverse(1)\nx + 1\nsage: (x).reverse(1)\n1\nsage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]\n[True, True, False, False, False, False, False, False, False]\n<type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>\n```\n\n\n\nReals take no optional argument. The docstring says\n\n> Returns x!^d f(1/x) where d is the degree of f.\n\nand the behaviour is consistent with it\n\n\n```python\nsage: (x+1).reverse()\nx + 1.00000000000000\nsage: x.reverse()\n1.00000000000000\n```\n\n\nIn my opinion the best behaviour is the one of the generic class, but the docstring should be amended to something similar to the last one, which is the proper mathematical definition. The behaviour of rationals should be corrected to conform to the other classes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15077\n\n",
    "created_at": "2013-08-22T11:29:39Z",
    "labels": [
        "component: commutative algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Inconsistency in polynomial .reverse(n)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14840",
    "user": "https://github.com/defeo"
}
```
CC:  @mezzarobba @jhpalmieri

Keywords: polynomial univariate reverse

The optional argument of the `.reverse()` method of univariate polynomials is interpreted inconsistently through different classes.

Rationals interpret is as "length":


```python
sage: _.<x> = QQ[]
sage: (x+1).reverse(1)
1
sage: (x).reverse(1)
0
```



The docstring for generic polynomials (inherited by `CC`, number fields, `Polynomial_GF2X`,  `Polynomial_ZZ_pEX`, ...) says:

> If an optional degree argument is given the coefficient list will
> be truncated or zero padded as necessary and the reverse polynomial
> will have the specified degree.

but the behaviour is inconsistent with it


```python
sage: _.<x> = GF(2)[]
sage: (x+1).reverse(1)
x + 1
sage: (x).reverse(1)
1
sage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]
[False, False, True, False, False, False, False, False, False, False]
sage: inspect.getmro(x.__class__)[2]
<type 'sage.rings.polynomial.polynomial_element.Polynomial'>
```


`Polynomial_zmod_flint` and `Polynomial_integer_dense_flint` have the exact same docstring and behaviour, though they do not inherit `.reverse()` from the generic class:


```python
sage: _.<x> = ZZ[]
sage: (x+1).reverse(1)
x + 1
sage: (x).reverse(1)
1
sage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]
[True, True, False, False, False, False, False, False, False]
<type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>
```



Reals take no optional argument. The docstring says

> Returns x!^d f(1/x) where d is the degree of f.

and the behaviour is consistent with it


```python
sage: (x+1).reverse()
x + 1.00000000000000
sage: x.reverse()
1.00000000000000
```


In my opinion the best behaviour is the one of the generic class, but the docstring should be amended to something similar to the last one, which is the proper mathematical definition. The behaviour of rationals should be corrected to conform to the other classes.

Issue created by migration from https://trac.sagemath.org/ticket/15077





---

archive/issue_comments_189043.json:
```json
{
    "body": "This is obsolete. `QQ['x']` now works as the other cases.",
    "created_at": "2019-05-17T17:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189043",
    "user": "https://github.com/fchapoton"
}
```

This is obsolete. `QQ['x']` now works as the other cases.



---

archive/issue_comments_189044.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-05-17T17:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189044",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_189045.json:
```json
{
    "body": "There remain two issues: unifying the documentation, and also the version for `RR` does not allow for an optional argument. Low priority, but I say we keep this open.",
    "created_at": "2019-05-17T17:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189045",
    "user": "https://github.com/jhpalmieri"
}
```

There remain two issues: unifying the documentation, and also the version for `RR` does not allow for an optional argument. Low priority, but I say we keep this open.



---

archive/issue_comments_189046.json:
```json
{
    "body": "There remained actually more issues. The issue for `QQ['x']` was indeed fixed by ticket #21194 but that ticket only fixed some of the inconsistencies. Those that I have noticed and fix are:\n\n- No `degree` parameter for polynomials over `RR` (as already mentioned);\n- No `degree` parameter for polynomials over `Zmod(...)` using NTL;\n- Several inconsistencies in the documentation (polynomials over `ZZ` and `Zmod(...)` using Flint, polynomials over p-adics).\n\nI hope I didn't forgot anything!",
    "created_at": "2019-08-22T14:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189046",
    "user": "https://github.com/bgrenet"
}
```

There remained actually more issues. The issue for `QQ['x']` was indeed fixed by ticket #21194 but that ticket only fixed some of the inconsistencies. Those that I have noticed and fix are:

- No `degree` parameter for polynomials over `RR` (as already mentioned);
- No `degree` parameter for polynomials over `Zmod(...)` using NTL;
- Several inconsistencies in the documentation (polynomials over `ZZ` and `Zmod(...)` using Flint, polynomials over p-adics).

I hope I didn't forgot anything!



---

archive/issue_comments_189047.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-22T14:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189047",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_189048.json:
```json
{
    "body": "ok, let it be",
    "created_at": "2019-11-13T16:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189048",
    "user": "https://github.com/fchapoton"
}
```

ok, let it be



---

archive/issue_comments_189049.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-11-13T16:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189049",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_189050.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-11-16T20:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14840#issuecomment-189050",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_014554.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-11-16T20:15:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14840",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14840#event-14554"
}
```
