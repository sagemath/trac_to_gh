# Issue 24724: Followup to #21524 -- upgrade broken when gcc spkg is installed

Issue created by migration from Trac.

Original creator: embray

Original creation time: 2018-03-12 19:52:52




---

Comment by embray created at 2018-03-12 19:53:15

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2018-03-12 20:16:04

There was a change in a recent beta to use clang instead of gcc when available. As a result, I have machines which used to build gcc, and indeed in which `$SAGE_LOCAL/bin/gcc` exists, but which now use clang according to Sage's configure:

```
configure:8250: result:     gcc-7.2.0 not installed (configure check)
```

So should you check whether `$(SAGE_LOCAL)/bin/gcc` exists, or should you check whether gcc is going to be installed?


---

Comment by jhpalmieri created at 2018-03-12 23:47:59

I also don't understand the spacing. I am guessing that the leading space in `GCC_DEP` was put there intentionally in #24703 (maybe so people could concatenate dependencies without worrying about the sort of issue that arose here), so why delete it? It doesn't harm anything, right?


---

Comment by embray created at 2018-03-13 14:40:10

Replying to [comment:3 jhpalmieri]:
> I also don't understand the spacing. I am guessing that the leading space in `GCC_DEP` was put there intentionally in #24703 (maybe so people could concatenate dependencies without worrying about the sort of issue that arose here), so why delete it? It doesn't harm anything, right?

That leading space was actually needed in the old code, but it's superfluous (albeit harmless, as you say) in the new code.


---

Comment by jhpalmieri created at 2018-03-13 16:37:34

Changing status from needs_review to positive_review.


---

Comment by git created at 2018-03-16 16:40:14

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2018-03-16 16:40:14

Changing status from positive_review to needs_review.


---

Comment by embray created at 2018-03-16 16:41:03

While we're at it, since this wasn't merged yet here's a quick fix to another bug I found.


---

Comment by embray created at 2018-03-16 16:41:03

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-03-19 07:57:40

Resolution: fixed
