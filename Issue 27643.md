# Issue 27643: Update Kenzo and its interface

Issue created by migration from https://trac.sagemath.org/ticket/27880

Original creator: mmarco

Original creation time: 2019-05-28 08:27:34

CC:  jhpalmieri tscrim

An upcoming version of Kenzo will include functions to compute homotopy groups. 

This ticket will track the work to update it and the corresponding interface


---

Comment by jhpalmieri created at 2019-06-04 22:14:04

New commits:


---

Comment by mmarco created at 2019-06-07 16:17:33

I have fixed some style and doctests.

Some functions (k2s_matrix, s2k_matrix, s2k_dictmat and pairing) that still need proper dosctrings.
----
New commits:


---

Comment by mmarco created at 2019-06-07 16:37:53

I have been testing the conversion from sage to kenzo simplicial sets, and it seems to be quite fragile at the moment:


```

sage: from sage.homology.simplicial_set import SimplicialSet
sage: S = simplicial_sets.Sphere(3)
sage: W = S.wedge(S)
sage: SimplicialSet(W)
Simplicial set with 3 non-degenerate simplices
sage: KFiniteSimplicialSet(SimplicialSet(W))
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-57-8f9e5a4c20e4> in <module>()
----> 1 KFiniteSimplicialSet(SimplicialSet(W))

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in KFiniteSimplicialSet(ssimpset)
    744                             auxiliar_list.append(degen_z)
    745                         list_rslt.append(auxiliar_list)
--> 746         return KenzoSimplicialSet(build_finite_ss2(list_rslt))
    747 
    748 

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7787)()
    804         """
    805         lispargs = EclObject(list(args))
--> 806         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))
    807 
    808     def __richcmp__(left, right, int op):

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5449)()
    376     if ecl_nvalues > 1:
    377         s = si_coerce_to_base_string(ecl_values(1))
--> 378         raise RuntimeError("ECL says: {}".format(
    379             char_to_str(ecl_base_string_pointer_safe(s))))
    380     else:

RuntimeError: ECL says: In BUILD-FINITE-SS, the symbol SIGMA_3 is present two times.
```



if we try to avoid the problem of duplication of strings by constructing the wedge from simplicial complexes we get:


```
sage: S3 = simplicial_complexes.Sphere(3)
sage: W3 = SimplicialSet(S3.wedge(S3))
sage: W3
Simplicial set with 59 non-degenerate simplices
sage: KFiniteSimplicialSet(W3)
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-61-4b410c60e632> in <module>()
----> 1 KFiniteSimplicialSet(W3)

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in KFiniteSimplicialSet(ssimpset)
    744                             auxiliar_list.append(degen_z)
    745                         list_rslt.append(auxiliar_list)
--> 746         return KenzoSimplicialSet(build_finite_ss2(list_rslt))
    747 
    748 

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7773)()
    803 
    804         """
--> 805         lispargs = EclObject(list(args))
    806         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))
    807 

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__init__ (build/cythonized/sage/libs/ecl.c:7307)()
    668         """
    669         if len(args) != 0:
--> 670             self.set_obj(python_to_ecl(args[0]))
    671 
    672     def __reduce__(self):

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.python_to_ecl (build/cythonized/sage/libs/ecl.c:6351)()
    483             return Cnil
    484         else:
--> 485             L=cl_cons(python_to_ecl(pyobj[0]),Cnil)
    486             ptr=L
    487             for a in pyobj[1:]:

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.python_to_ecl (build/cythonized/sage/libs/ecl.c:6351)()
    483             return Cnil
    484         else:
--> 485             L=cl_cons(python_to_ecl(pyobj[0]),Cnil)
    486             ptr=L
    487             for a in pyobj[1:]:

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.python_to_ecl (build/cythonized/sage/libs/ecl.c:6045)()
    464     elif isinstance(pyobj,unicode):
    465         s=str_to_bytes(pyobj)
--> 466         return ecl_safe_read_string(s)
    467     elif isinstance(pyobj,bytes):
    468         s=<bytes>pyobj

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_read_string (build/cythonized/sage/libs/ecl.c:5524)()
    384     cdef cl_object o
    385     o = ecl_cstring_to_base_string_or_nil(s)
--> 386     o = ecl_safe_funcall(read_from_string_clobj,o)
    387     return o
    388 

/home/mmarco/sage-python3/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_funcall (build/cythonized/sage/libs/ecl.c:5291)()
    363     if ecl_nvalues > 1:
    364         s = si_coerce_to_base_string(ecl_values(1))
--> 365         raise RuntimeError("ECL says: {}".format(
    366             char_to_str(ecl_base_string_pointer_safe(s))))
    367     else:

RuntimeError: ECL says: Reader error in file #<string-input stream from "('L1',)">, position 6:
A comma has appeared out of a backquote.
```



---

Comment by embray created at 2019-06-14 14:55:02

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).


---

Comment by jhpalmieri created at 2019-06-21 21:06:26

Sorry, but I can't figure out how to install kenzo. I tried `make kenzo` followed by `make`, and that didn't work: if I run `sage -t src/sage/interfaces/kenzo.py`, I get errors like

```
RuntimeError: ECL says: The function MAKE-ARRAY-FROM-LISTS is undefined.
```

It seems as though ECL doesn't know about Kenzo.

Anyway, regarding the problem with wedges, in Sage, a simplex in a simplicial set cannot be determined from its name: two different simplices may have the same name. (By default, all n-simplices are just called "sigma_n".)

```
sage: from sage.homology.simplicial_set import SimplicialSet
sage: S = simplicial_sets.Sphere(3)
sage: W = S.wedge(S)
sage: W.n_cells(3)
[sigma_3, sigma_3]
```

But those simplices are not the same:

```
sage: W.n_cells(3)[0] == W.n_cells(3)[1]
False
```

So when translating to a Kenzo simplicial set, you will need to come up with some way of distinguishing non-equal simplices of the same dimension. You could use their hash values, for instance.

I also don't understand this:

```
    if hasattr(ssimpset, 'factors') and str(ssimpset)[0:5] != 'Wedge':
        return KFiniteSimplicialSet(ssimpset.factor(0)).cartesian_product(KFiniteSimplicialSet(ssimpset.factor(1)))
```

First, maybe it would be better to test `if isinstance(ssimpset, Factors)`. Similarly, you could test `isinstance(ssimpset, WedgeOfSimplicialSets)` instead of checking the string representation. Second, there are four types of simplicial sets with factors, not just wedges and Cartesian products: smash products and disjoint unions also. Oh, finally, there could be more than two factors, and the current code just takes `ssimpset.factor(0)` and `ssimpset.factor(1)`.


---

Comment by jhpalmieri created at 2019-06-21 21:13:23

Maybe Kenzo is installing fine, but the branch here is using commands that aren't present in the current version of Kenzo, and that's why I'm running into problems. Could that be the case? If I install it without using this branch, then things work okay.


---

Comment by mmarco created at 2019-06-22 13:38:54

Replying to [comment:9 jhpalmieri]:
> Maybe Kenzo is installing fine, but the branch here is using commands that aren't present in the current version of Kenzo, and that's why I'm running into problems. Could that be the case? If I install it without using this branch, then things work okay.


Yes, that is exactly what is going on. Some functions in this branch depend on some functionalities of kenzo that we are developing in a fork (more precisely, in the testing branch of https://github.com/miguelmarco/kenzo ).

Our long term goal is to make a new kenzo release and include an update of the kenzo optional package in this ticket when it is ready.

In the meantime, you can install the testing version of our kenzo fork by cloning the mentioned repo, checking out its testing branch, and runing:


```
sage -ecl < compile.lisp
```


that will compile the kenzo package into a file called `kenzo--all-systems.fasb`. Then rename it as `kenzo.fas` and copy it to your SAGE_LOCAL/lib/ecl directory.


---

Comment by mmarco created at 2019-06-22 13:47:58

Replying to [comment:8 jhpalmieri]:

> Anyway, regarding the problem with wedges, in Sage, a simplex in a simplicial set cannot be determined from its name: two different simplices may have the same name. (By default, all n-simplices are just called "sigma_n".)
> {{{
> sage: from sage.homology.simplicial_set import SimplicialSet
> sage: S = simplicial_sets.Sphere(3)
> sage: W = S.wedge(S)
> sage: W.n_cells(3)
> [sigma_3, sigma_3]
> }}}
> But those simplices are not the same:
> {{{
> sage: W.n_cells(3)[0] == W.n_cells(3)[1]
> False
> }}}
> So when translating to a Kenzo simplicial set, you will need to come up with some way of distinguishing non-equal simplices of the same dimension. You could use their hash values, for instance.


Yes, that is my impression too. I was a little worried about the strength of the hash value though: can we guarantee that different cells will always have different hashes? From a quick look at the current code, it seems that the memory address of the object is used in the hash, so it should really distiguish them (modulo hash function collisions), but i wanted to make sure about that.


> 
> I also don't understand this:
> {{{
>     if hasattr(ssimpset, 'factors') and str(ssimpset)[0:5] != 'Wedge':
>         return KFiniteSimplicialSet(ssimpset.factor(0)).cartesian_product(KFiniteSimplicialSet(ssimpset.factor(1)))
> }}}
> First, maybe it would be better to test `if isinstance(ssimpset, Factors)`. Similarly, you could test `isinstance(ssimpset, WedgeOfSimplicialSets)` instead of checking the string representation. Second, there are four types of simplicial sets with factors, not just wedges and Cartesian products: smash products and disjoint unions also. Oh, finally, there could be more than two factors, and the current code just takes `ssimpset.factor(0)` and `ssimpset.factor(1)`.


Yes, I also noticed that. Hopefully next week I will have some time to try to improve it.


---

Comment by jhpalmieri created at 2019-06-22 15:38:22

Replying to [comment:11 mmarco]:
> Replying to [comment:8 jhpalmieri]:
> 
> > Anyway, regarding the problem with wedges, in Sage, a simplex in a simplicial set cannot be determined from its name: two different simplices may have the same name. (By default, all n-simplices are just called "sigma_n".)
> > {{{
> > sage: from sage.homology.simplicial_set import SimplicialSet
> > sage: S = simplicial_sets.Sphere(3)
> > sage: W = S.wedge(S)
> > sage: W.n_cells(3)
> > [sigma_3, sigma_3]
> > }}}
> > But those simplices are not the same:
> > {{{
> > sage: W.n_cells(3)[0] == W.n_cells(3)[1]
> > False
> > }}}
> > So when translating to a Kenzo simplicial set, you will need to come up with some way of distinguishing non-equal simplices of the same dimension. You could use their hash values, for instance.
> 
> 
> Yes, that is my impression too. I was a little worried about the strength of the hash value though: can we guarantee that different cells will always have different hashes? From a quick look at the current code, it seems that the memory address of the object is used in the hash, so it should really distiguish them (modulo hash function collisions), but i wanted to make sure about that.

Since the hash is based on `id(...)`, it should distinguish them.


---

Comment by git created at 2019-06-24 12:12:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-03 12:00:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2019-07-04 17:24:19

Is it worth having a separate function that takes a Sage simplex and returns a Kenzo simplex with a meaningful name?


---

Comment by mmarco created at 2019-07-04 18:39:39

Replying to [comment:15 jhpalmieri]:
> Is it worth having a separate function that takes a Sage simplex and returns a Kenzo simplex with a meaningful name?


If you ask this because of the KAbstractSimplex function, I also don't see a point for it. I assumed it was used somewhere else, but apparantely it is not.

Since this is still a work in progress it could happen that it becomes useful at some point. If it doesn't, we can safely remove it.


---

Comment by jhpalmieri created at 2019-07-04 18:57:43

I was thinking for `KFiniteSimplicialSet`. With a Sage simplicial set, you can tell if it contains a given simplex, and so you can check if one simplicial set is contained in another. When you do the translation here, you may lose that information.


---

Comment by mmarco created at 2019-07-04 19:19:14

Oh, I see. Maybe it's a good idea, but I don't see off the top of my head how to design/implement it.

Do you have a suggestion?


---

Comment by git created at 2019-07-04 20:18:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-05 17:38:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-12 11:21:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-12 11:32:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-09-25 15:19:56

Some pep and doc cleanup in the branch

public/ticket/27880
----
New commits:


---

Comment by git created at 2019-09-30 09:09:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-04 09:26:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-04 11:39:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-06 14:48:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-06 15:32:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-09 10:25:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-09 10:36:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-09 11:28:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-12 18:01:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-12-12 19:51:14

EXAMPLES:: must be followed by an empty line


---

Comment by git created at 2019-12-15 10:31:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2019-12-17 15:01:28

Changing status from new to needs_review.


---

Comment by git created at 2019-12-17 15:02:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-12-17 15:03:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2019-12-17 22:18:01

First, all tests pass. Second, with some minor tweaks, the documentation builds. I suggest this:

```diff
diff --git a/src/doc/en/reference/interfaces/index.rst b/src/doc/en/reference/interfaces/index.rst
index 8680b94deb..95a8678b07 100644
--- a/src/doc/en/reference/interfaces/index.rst
+++ b/src/doc/en/reference/interfaces/index.rst
@@ -76,6 +76,7 @@ and testing to make sure nothing funny is going on).
    sage/interfaces/gp
    sage/interfaces/jmoldata
    sage/interfaces/kash
+   sage/interfaces/kenzo
    sage/interfaces/latte
    sage/interfaces/lie
    sage/interfaces/lisp
diff --git a/src/sage/interfaces/kenzo.py b/src/sage/interfaces/kenzo.py
index cea442cf0a..82fc2281b4 100644
--- a/src/sage/interfaces/kenzo.py
+++ b/src/sage/interfaces/kenzo.py
@@ -534,9 +534,9 @@ class KenzoChainComplex(KenzoObject):
         OUTPUT:
 
         - A :class:`KenzoChainComplexMorphism` representing the null morphism between
-        ``self`` and ``target`` of degree ``degree``. If ``target`` takes None value,
-        ``self`` is assumed as the target chain complex; if ``degree`` takes None value,
-        0 is assumed as the degree of the null morphism.
+          ``self`` and ``target`` of degree ``degree``. If ``target`` takes None value,
+          ``self`` is assumed as the target chain complex; if ``degree`` takes None value,
+          0 is assumed as the degree of the null morphism.
 
         EXAMPLES::
 
@@ -576,20 +576,20 @@ class KenzoChainComplex(KenzoObject):
         - ``dim`` -- An integer number or None (default)
 
         - ``comb`` -- A list representing a formal sum of generators in the module
-        of dimension ``dim`` or None (default). For example, to represent
-        G7G12 + 3*G7G0 - 5*G7G3 we use the list [3, 'G7G0', -5, 'G7G3', 1, 'G7G12'].
-        Note that the generators must be in ascending order respect to the number
-        after the second G in their representation; the parameter
-        ``comb`` = [1, 'G7G12', 3, 'G7G0', -5, 'G7G3'] will produce an error in
-        Kenzo.
+          of dimension ``dim`` or None (default). For example, to represent
+          G7G12 + 3*G7G0 - 5*G7G3 we use the list [3, 'G7G0', -5, 'G7G3', 1, 'G7G12'].
+          Note that the generators must be in ascending order respect to the number
+          after the second G in their representation; the parameter
+          ``comb`` = [1, 'G7G12', 3, 'G7G0', -5, 'G7G3'] will produce an error in
+          Kenzo.
 
         OUTPUT:
 
         - If ``dim`` and ``comb`` are not None, it returns a Kenzo combination
-        representing the differential of the formal combination represented by
-        ``comb`` in the chain complex ``self`` in dimension ``dim``. On the other
-        hand, if `dim`` or ``comb`` (or both) take None value, the differential
-        :class:`KenzoMorphismChainComplex` of ``self`` is returned.
+          representing the differential of the formal combination represented by
+          ``comb`` in the chain complex ``self`` in dimension ``dim``. On the other
+          hand, if `dim`` or ``comb`` (or both) take None value, the differential
+          :class:`KenzoMorphismChainComplex` of ``self`` is returned.
 
         EXAMPLES::
 
@@ -1805,9 +1805,9 @@ def build_morphism(source_complex, target_complex, degree, algorithm, strategy,
     - ``algorithm`` -- A Lisp function defining the mapping (:intr slot in Kenzo)
 
     - ``strategy`` -- The strategy (:strt slot in Kenzo), which must be one of
-    the two strings ``gnrt`` or ``cmbn``, depending if the ``algorithm`` (a Lisp
-    function) uses as arguments a degree and a generator or a combination,
-    respectively.
+      the two strings ``gnrt`` or ``cmbn``, depending if the ``algorithm`` (a Lisp
+      function) uses as arguments a degree and a generator or a combination,
+      respectively.
 
     - ``orgn`` -- A list containing a description about the origin of the morphism
 
```


Some other comments:
- I would prefer that you didn't use `id` for identity morphisms in the examples, since `id` is an important built-in Python function, so I don't like to see it redefined. This is not a major issue.
- I find it odd that `KenzoSimplicialSet` inherits from the chain complex class. This means that if `K` is a Kenzo simplicial set, the help message for `K.homology` says

```
Return the "n"'th homology group of the kenzo chain complex
```

 and also tab completion reveals `K.tensor_product`. I don't know what a tensor product of a simplicial set with a chain complex, or with a simplicial set, is supposed to return.
- I've had some crashes, but they're not repeatable. "Crashes" is the wrong word — "hangs" is better, and ctrl-c has not interrupted the process successfully, or maybe I didn't wait long enough. If I figure out how to reproduce this problem, I'll let you know. Here's an example:

```pycon
sage: [K.homotopy_group(n) for n in range(1,4)]
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-11-92360101f0b6> in <module>()
----> 1 [K.homotopy_group(n) for n in range(Integer(1),Integer(4))]

<ipython-input-11-92360101f0b6> in <listcomp>(.0)
----> 1 [K.homotopy_group(n) for n in range(Integer(1),Integer(4))]

/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in homotopy_group(self, n)
    740         if n not in ZZ or n < 2:
    741             raise ValueError("""homotopy groups can only be computed
--> 742                 for dimensions greater than 1""")
    743         lgens = homotopy_list(self._kenzo, n).python()
    744         if lgens is not None:

ValueError: homotopy groups can only be computed
                for dimensions greater than 1
sage: [K.homotopy_group(n) for n in range(2,4)]
thread_suspend failed
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-12-912b096813cd> in <module>()
----> 1 [K.homotopy_group(n) for n in range(Integer(2),Integer(4))]

<ipython-input-12-912b096813cd> in <listcomp>(.0)
----> 1 [K.homotopy_group(n) for n in range(Integer(2),Integer(4))]

/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in homotopy_group(self, n)
    741             raise ValueError("""homotopy groups can only be computed
    742                 for dimensions greater than 1""")
--> 743         lgens = homotopy_list(self._kenzo, n).python()
    744         if lgens is not None:
    745             trgens = [0 if i == 1 else i for i in sorted(lgens)]

/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7793)()
    803         """
    804         lispargs = EclObject(list(args))
--> 805         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))
    806 
    807     def __richcmp__(left, right, int op):

/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5368)()
    369 cdef cl_object ecl_safe_apply(cl_object func, cl_object args) except NULL:
    370     cdef cl_object s
--> 371     ecl_sig_on()
    372     cl_funcall(3,safe_apply_clobj,func,args)
    373     ecl_sig_off()

RuntimeError: Aborted
sage: K.homotopy_group(2)
^C^C^C^C^C^C^C^C^Z
```



---

Comment by jhpalmieri created at 2019-12-17 22:21:41

There are lots of functions defined at the start of the file, which means that `from sage.interfaces.kenzo import [TAB]` lists lots of options, most of which the user won't actually want. Is this a problem? I think you could put something like  `del chcm_mat, homologie, ...` at the end of the file, but I don't know if it's worth bothering.

A related question: is it worth putting commands like `ecl_eval("(require :kenzo)")` in a try-except block, so that if users try `import sage.interfaces.kenzo` without first installing Kenzo, they get a better error message than a traceback followed by

```
RuntimeError: ECL says: Module error: Don't know how to REQUIRE KENZO.
```

?


---

Comment by jhpalmieri created at 2019-12-17 22:26:50

Are these changes safe?

```diff
diff --git a/src/sage/interfaces/kenzo.py b/src/sage/interfaces/kenzo.py
index cea442cf0a..9c48464dc5 100644
--- a/src/sage/interfaces/kenzo.py
+++ b/src/sage/interfaces/kenzo.py
@@ -620,7 +620,7 @@ class KenzoChainComplex(KenzoObject):
             ------------------------------------------------------------------------------
             <BLANKLINE>
         """
-        if dim is not None and comb is not None:
+        if dim and comb:
             cmbn_list = pairing(comb)
             return KenzoObject(dffr_aux1(self._kenzo, dim, cmbn_list))
         else:
@@ -741,7 +741,7 @@ class KenzoSimplicialSet(KenzoChainComplex):
             raise ValueError("""homotopy groups can only be computed
                 for dimensions greater than 1""")
         lgens = homotopy_list(self._kenzo, n).python()
-        if lgens is not None:
+        if lgens:
             trgens = [0 if i == 1 else i for i in sorted(lgens)]
             return AbelianGroup(trgens)
         else:
```



---

Comment by git created at 2019-12-18 12:01:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2019-12-18 12:09:17

I did some of the changes suggested by jhpalmieri. In particular, I did add the module to the documentation index, used a different name for the identity in the doctests, checked that kenzo is installed, and changed the names of the functions we import prepending a `_`.

I expected this last change to solve the problem of the functions appearing in the tab completion, but they still appear. At least, they appear at the end of the list, which might make clearer to the user that they are auxiliary functions.


I haven't been able to reproduce the hangs. Any hint on what you did to get them?
----
New commits:


---

Comment by mmarco created at 2019-12-18 12:17:36

Replying to [comment:42 jhpalmieri]:
> Are these changes safe?


I would say they are not. Those variables could be zero or empty lists, and not all of those cases are equivalent to being `None`.

Maybe the code could be rewritten to treat those cases correctly, but for the sake of robustness, I would prefear to leave the specific check for being `None`.


---

Comment by @ana-romero created at 2019-12-18 12:29:52

Replying to [comment:40 jhpalmieri]:
> - I find it odd that `KenzoSimplicialSet` inherits from the chain complex class. This means that if `K` is a Kenzo simplicial set, the help message for `K.homology` says
> {{{
> Return the "n"'th homology group of the kenzo chain complex
> }}}
>  and also tab completion reveals `K.tensor_product`. I don't know what a tensor product of a simplicial set with a chain complex, or with a simplicial set, is supposed to return.
We prefer to maintain the same class structure of Kenzo, where a simplicial set is implemented inheriting from the class Chain Complex because one can always define a chain complex associated to every simplicial set, and the homology groups of a simplicial set are defined as the homology groups of the associated chain complex. When we ask for the tensor product of a simplicial set and a chain complex, Kenzo computes the tensor product of the chain complex associated to the simplicial set and the second chain complex.


---

Comment by jhpalmieri created at 2019-12-18 23:49:50

Replying to [comment:44 mmarco]:
> I did some of the changes suggested by jhpalmieri. In particular, I did add the module to the documentation index, used a different name for the identity in the doctests, checked that kenzo is installed, and changed the names of the functions we import prepending a `_`.
> 
> I expected this last change to solve the problem of the functions appearing in the tab completion, but they still appear. At least, they appear at the end of the list, which might make clearer to the user that they are auxiliary functions.
> 
> 
> I haven't been able to reproduce the hangs. Any hint on what you did to get them?

It's not repeatable. For example:

```
sage: from sage.interfaces.kenzo import EilenbergMacLaneSpace, Sphere
sage: Sphere(4)
[K1 Simplicial-Set]
sage: S4 = Sphere(4)
sage: [S4.homotopy_group(n) for n in range(6)]
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-4-625ee4458732> in <module>()
----> 1 [S4.homotopy_group(n) for n in range(Integer(6))]

<ipython-input-4-625ee4458732> in <listcomp>(.0)
----> 1 [S4.homotopy_group(n) for n in range(Integer(6))]

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in homotopy_group(self, n)
    741         if n not in ZZ or n < 2:
    742             raise ValueError("""homotopy groups can only be computed
--> 743                 for dimensions greater than 1""")
    744         lgens = _homotopy_list(self._kenzo, n).python()
    745         if lgens is not None:

ValueError: homotopy groups can only be computed
                for dimensions greater than 1
sage: [S4.homotopy_group(n) for n in range(1,6)]
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-6-f090838c72c2> in <module>()
----> 1 [S4.homotopy_group(n) for n in range(Integer(1),Integer(6))]

<ipython-input-6-f090838c72c2> in <listcomp>(.0)
----> 1 [S4.homotopy_group(n) for n in range(Integer(1),Integer(6))]

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in homotopy_group(self, n)
    741         if n not in ZZ or n < 2:
    742             raise ValueError("""homotopy groups can only be computed
--> 743                 for dimensions greater than 1""")
    744         lgens = _homotopy_list(self._kenzo, n).python()
    745         if lgens is not None:

ValueError: homotopy groups can only be computed
                for dimensions greater than 1
sage: [S4.homotopy_group(n) for n in range(2,6)]
thread_suspend failed
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-7-e6bf0078ab7e> in <module>()
----> 1 [S4.homotopy_group(n) for n in range(Integer(2),Integer(6))]

<ipython-input-7-e6bf0078ab7e> in <listcomp>(.0)
----> 1 [S4.homotopy_group(n) for n in range(Integer(2),Integer(6))]

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python3.7/site-packages/sage/interfaces/kenzo.py in homotopy_group(self, n)
    742             raise ValueError("""homotopy groups can only be computed
    743                 for dimensions greater than 1""")
--> 744         lgens = _homotopy_list(self._kenzo, n).python()
    745         if lgens is not None:
    746             trgens = [0 if i == 1 else i for i in sorted(lgens)]

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7792)()
    803         """
    804         lispargs = EclObject(list(args))
--> 805         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))
    806 
    807     def __richcmp__(left, right, int op):

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5367)()
    369 cdef cl_object ecl_safe_apply(cl_object func, cl_object args) except NULL:
    370     cdef cl_object s
--> 371     ecl_sig_on()
    372     cl_funcall(3,safe_apply_clobj,func,args)
    373     ecl_sig_off()

RuntimeError: Aborted
```

but the next time I run Sage with the same commands, it works.


---

Comment by jhpalmieri created at 2019-12-18 23:56:16

Replying to [comment:46 gh-ana-romero]:
> Replying to [comment:40 jhpalmieri]:
> > - I find it odd that `KenzoSimplicialSet` inherits from the chain complex class. This means that if `K` is a Kenzo simplicial set, the help message for `K.homology` says
> > {{{
> > Return the "n"'th homology group of the kenzo chain complex
> > }}}
> >  and also tab completion reveals `K.tensor_product`. I don't know what a tensor product of a simplicial set with a chain complex, or with a simplicial set, is supposed to return.
> We prefer to maintain the same class structure of Kenzo, where a simplicial set is implemented inheriting from the class Chain Complex because one can always define a chain complex associated to every simplicial set, and the homology groups of a simplicial set are defined as the homology groups of the associated chain complex. When we ask for the tensor product of a simplicial set and a chain complex, Kenzo computes the tensor product of the chain complex associated to the simplicial set and the second chain complex.

Okay, in that case I request that you document this: probably document in the class `KenzoSimplicialSet` that the class inherits from chain complexes, and maybe in some of the chain complex methods what happens if you are applying them to simplicial sets.


---

Comment by jhpalmieri created at 2019-12-18 23:58:18

Is equality implemented for simplicial sets?

```
sage: S4 = Sphere(4)
sage: S4
[K1 Simplicial-Set]
sage: Sphere(4)
[K1 Simplicial-Set]
sage: S4 == Sphere(4)
False
```

Is this the expected behavior?


---

Comment by jhpalmieri created at 2019-12-19 00:01:16

Related to the simplicial set/chain complex inheritance: how can I get a chain complex from a simplicial set? For example:

```
sage: from sage.interfaces.kenzo import Sphere, SChainComplex
sage: S4 = Sphere(4)
sage: SChainComplex(S4)
Trivial chain complex over Integer Ring
```

That's not right.


---

Comment by git created at 2019-12-19 01:01:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2019-12-19 01:02:12

I changed the leading single underscore to double underscores at the start and end; that seems to hide them. Is this okay?


---

Comment by git created at 2019-12-19 12:48:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2019-12-19 12:48:36

Replying to [comment:52 jhpalmieri]:
> I changed the leading single underscore to double underscores at the start and end; that seems to hide them. Is this okay?

It is good from my part. It solves the problem of tab completion, and does not introduce other problems.


I haven't been able to reproduce your hangs. I am guessing there might be some system-specific oddity involved.

> Related to the simplicial set/chain complex inheritance: how can I get a chain complex from a simplicial set? For example:

I think you are right. I send a commit to treat the case where a nontrivial module in the chain complex is surrounded with trivial ones.
----
New commits:
----
New commits:


---

Comment by git created at 2020-01-15 14:31:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2020-01-15 14:41:15

I added a few lines to clarify that kenzo simplicial sets can be seen as a particular case of chain complexes.

Could not reproduce the problems pointed by jhpalmieri.

Do you agree to give a positive review, and maybe open another ticket to track the heisenbug?


---

Comment by mmarco created at 2020-01-16 11:15:03

I discovered there is a bug in the Kenzo module to compute the homtopy group:


```
sage: from sage.interfaces.kenzo import KFiniteSimplicialSet
sage: CP2 = simplicial_sets.ComplexProjectiveSpace(2)
sage: KCP2 = KFiniteSimplicialSet(CP2)
sage: KCP2.homotopy_group(2)
Multiplicative Abelian group isomorphic to Z
sage: KCP2.homotopy_group(3)
Trivial Abelian group
sage: KCP2.homotopy_group(4)
Trivial Abelian group
sage: KCP2.homotopy_group(5)
Trivial Abelian group
sage: KCP2.homotopy_group(6)
Trivial Abelian group
```


The fifth homotopy groups and higher are wrong.

We have found the source of the error and are working on it. Will make a new release of the kenzo package in a few days.


---

Comment by mmarco created at 2020-01-16 11:15:03

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by git created at 2020-05-21 15:02:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2020-05-21 15:02:52

Bumped Kenzo version, and added some warnings in the documentation. I think it is ready for review.
----
New commits:


---

Comment by mmarco created at 2020-05-21 15:03:13

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-05-21 22:34:11

Please put the new upstream_url field in checksums.ini


---

Comment by git created at 2020-05-21 22:40:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-05-25 06:53:29

Does everything it says it does, and I have no troubles with installing it on Ubuntu 18. LGTM.


---

Comment by tscrim created at 2020-05-25 06:53:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-05-26 22:33:56

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2020-05-26 22:33:56

PDF build fails even though its supposedly optional:

```
[docpdf] Traceback (most recent call last):
[docpdf]   File "/home/release/Sage/local/lib/python3.7/runpy.py", line 193, in _run_module_as_main
[docpdf]     "__main__", mod_spec)
[docpdf]   File "/home/release/Sage/local/lib/python3.7/runpy.py", line 85, in _run_code
[docpdf]     exec(code, run_globals)
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[docpdf]     main()
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 1717, in main
[docpdf]     builder()
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 328, in _wrapper
[docpdf]     getattr(get_builder(document), 'inventory')(*args, **kwds)
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 553, in _wrapper
[docpdf]     self._build_everything_except_bibliography(lang, format, *args, **kwds)
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 539, in _build_everything_except_bibliography
[docpdf]     build_many(build_ref_doc, non_references)
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 281, in build_many
[docpdf]     _build_many(target, args, processes=NUM_THREADS)
[docpdf]   File "/home/release/Sage/local/lib/python3.7/site-packages/sage_setup/docbuild/utils.py", line 283, in build_many
[docpdf]     raise worker_exc.original_exception
[docpdf] sage.misc.package.PackageNotFoundError: the package 'kenzo' was not found. You can install it by running 'sage -i kenzo' in a shell
[docpdf] 
[docpdf]     Note: incremental documentation builds sometimes cause spurious
[docpdf]     error messages. To be certain that these are real errors, run
[docpdf]     "make doc-clean" first and try again.
make[1]: *** [Makefile:2019: doc-pdf] Error 1
```



---

Comment by tscrim created at 2020-05-26 22:47:25

It is probably this line at the top of the file:

```
+if not 'kenzo' in installed_packages():
+    raise PackageNotFoundError('kenzo')
```

coupled with the fact that it has been added to the references (which it wasn't before).

`@`vbraun Is there a mechanism in the html doc that catches this error being thrown? Is the same thing not done for the pdf doc?


---

Comment by jhpalmieri created at 2020-05-27 00:04:14

I get the same error when building the html docs. Do we need that line? I would be tempted to at least change it to

```
if 'kenzo' in installed_packages():
    # do all of the Kenzo initialization
    # Redirection of ECL and Maxima stdout to /dev/null
    # This is also done in the Maxima library, but we
    # also do it here for redundancy.
    ecl_eval(r"""(defparameter *dev-null* (make-two-way-stream
                  (make-concatenated-stream) (make-broadcast-stream)))""")
    ...
```

Maybe even turn this into a function and then call the function. The style in the Sage library doesn't have a lot of code evaluated when a module is loaded, as is done in `kenzo.py`.


---

Comment by jhpalmieri created at 2020-05-27 00:05:15

Oh, and there are some doctests that need fixing:

```diff
diff --git a/src/sage/interfaces/kenzo.py b/src/sage/interfaces/kenzo.py
index dd3aeae9fe..f23fc54fd2 100644
--- a/src/sage/interfaces/kenzo.py
+++ b/src/sage/interfaces/kenzo.py
@@ -1121,14 +1119,14 @@ def SChainComplex(kchaincomplex, start=0, end=15):
 
     ::
 
-        sage: from sage.interfaces.kenzo import SChainComplex, Sphere
-        sage: S4 = Sphere(4)
-        sage: C = SChainComplex(S4)
-        sage: C
+        sage: from sage.interfaces.kenzo import SChainComplex, Sphere          # optional - kenzo
+        sage: S4 = Sphere(4)                      # optional - kenzo
+        sage: C = SChainComplex(S4)               # optional - kenzo
+        sage: C                                   # optional - kenzo
         Chain complex with at most 3 nonzero terms over Integer Ring
-        sage: C._ascii_art_()
+        sage: C._ascii_art_()                     # optional - kenzo
         0 <-- C_4 <-- 0  ...  0 <-- C_0 <-- 0
-        sage: [C.homology(i) for i in range(6)]
+        sage: [C.homology(i) for i in range(6)]   # optional - kenzo
         [Z, 0, 0, 0, Z, 0]
     """
     matrices = {}
```



---

Comment by jhpalmieri created at 2020-05-27 01:40:46

And to the extent that I looked at this 5 months ago, I'm sure I didn't run tests without installing Kenzo first.


---

Comment by tscrim created at 2020-05-27 01:45:48

Replying to [comment:70 jhpalmieri]:
> And to the extent that I looked at this 5 months ago, I'm sure I didn't run tests without installing Kenzo first.

I did the same thing: I installed Kenzo and ran tests, forgetting to run them before the installation.


---

Comment by git created at 2020-05-28 01:39:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by jhpalmieri created at 2020-05-28 01:41:56

Here is a proposed fix (the [last commit](https://git.sagemath.org/sage.git/commit/?id=217e47c23a094e28573a615bd42fc29232d38f3c) is the only new thing). The change to `spkg-install.in` means that `make kenzo-clean` actually does something.


---

Comment by jhpalmieri created at 2020-05-28 01:41:56

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2020-05-28 01:44:09

Oh, I've also removed the use of `sage.misc.packages`, because (a) the Sage distro people don't like it, and (b) it could allow for the use of a system-wide installation of Kenzo (using a system-wide installation of `ecl`).


---

Comment by tscrim created at 2020-05-28 03:26:35

Replying to [comment:75 jhpalmieri]:
> Oh, I've also removed the use of `sage.misc.packages`, because (a) the Sage distro people don't like it, and (b) it could allow for the use of a system-wide installation of Kenzo (using a system-wide installation of `ecl`).

I think this would be better as a `Feature` following #20382.


---

Comment by jhpalmieri created at 2020-05-28 04:56:34

If you want to do that now, that's great. Otherwise, let's do it on another ticket.


---

Comment by tscrim created at 2020-05-28 05:05:20

I think we should do that now as a replacement to the `kenzo_installed` function. I can't do it today, but I will do it first thing tomorrow morning.


---

Comment by git created at 2020-05-29 01:30:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-05-29 01:33:00

Okay, here it is using `Feature`. However, I cannot install Kenzo with 9.2.beta0 as I am getting this error:

```
[kenzo-1.1.9] Copying package files from temporary location /home/uqtscrim/sage/local/var/tmp/sage/build/kenzo-1.1.9/inst to /home/uqtscrim/sage/local
[kenzo-1.1.9] cp: cannot overwrite non-directory '/home/uqtscrim/sage/local/./lib/ecl' with directory '/home/uqtscrim/sage/local/var/tmp/sage/build/kenzo-1.1.9/inst/home/uqtscrim/sage/local/./lib/ecl'
```

even though this `ecl` is a symlink to `$SAGE_ROOT/include/ecl`. Ideas?


---

Comment by jhpalmieri created at 2020-05-29 05:03:28

What OS is this?


---

Comment by tscrim created at 2020-05-29 05:04:33

Ubuntu 18.04


---

Comment by jhpalmieri created at 2020-05-29 05:10:07

I don't have any ideas, but I'll try with an Ubuntu virtual machine on my mac. If necessary, we can revert my change to `spkg-install.in`, and just manually copy the file. Or try this instead:

```diff
diff --git a/build/pkgs/kenzo/spkg-install.in b/build/pkgs/kenzo/spkg-install.in
index 294a543d7e..315b6142f3 100644
--- a/build/pkgs/kenzo/spkg-install.in
+++ b/build/pkgs/kenzo/spkg-install.in
@@ -8,7 +8,8 @@ cd src
 ecl < compile.lisp
 
 echo "moving kenzo--all-systems.fasb to  $SAGE_LOCAL/lib/ecl/kenzo.fas"
-sdh_install -T kenzo--all-systems.fasb $SAGE_LOCAL/lib/ecl/kenzo.fas
+cp kenzo--all-systems.fasb kenzo.fas
+sdh_install kenzo.fas $SAGE_LOCAL/lib/ecl
 
 
 if [ $? -ne 0 ]; then
```

(I seem to remember some people have problems with `sdh_install -T` before.)


---

Comment by jhpalmieri created at 2020-05-29 05:39:32

I see the problem on Ubuntu, and my proposal didn't work, but try this (copied from maxima's spkg-install.in file):

```diff
diff --git a/build/pkgs/kenzo/spkg-install.in b/build/pkgs/kenzo/spkg-install.in
index 294a543d7e..fed616705f 100644
--- a/build/pkgs/kenzo/spkg-install.in
+++ b/build/pkgs/kenzo/spkg-install.in
@@ -7,8 +7,12 @@ cd src
 
 ecl < compile.lisp
 
-echo "moving kenzo--all-systems.fasb to  $SAGE_LOCAL/lib/ecl/kenzo.fas"
-sdh_install -T kenzo--all-systems.fasb $SAGE_LOCAL/lib/ecl/kenzo.fas
+# Install Kenzo into ECL's library directory:
+ECLLIB=`ecl -eval "(princ (SI:GET-LIBRARY-PATHNAME))" -eval "(quit)"`
+echo
+echo "Now installing Kenzo as '$ECLLIB/kenzo.fas'..."
+cp -f kenzo--all-systems.fasb "$ECLLIB/kenzo.fas" \
+    || sdh_die "Failed to install 'kenzo--all-systems.fasb' as '$ECLLIB/kenzo.fas'."
 
 
 if [ $? -ne 0 ]; then
```

It doesn't create a good manifest file, so uninstallation doesn't do anything. `maxima.fas` is missing from maxima's manifest, too, so I guess we could settle for this.


---

Comment by tscrim created at 2020-05-29 05:46:07

So that worked. It is strange that this worked on the same machine with 9.1 but not with 9.2.beta0. Something seems to have changed between the two versions...


---

Comment by jhpalmieri created at 2020-05-29 16:22:30

I may be misunderstanding, but my guess is this: with 9.1, you were using the "original" branch. I changed spkg-install.in, and perhaps you didn't try that with 9.1, but coincidentally tried it for the first time with 9.2.

Anyway, I still prefer my most recently proposed change to spkg-install.in to the original branch: the original branch just copies files to `SAGE_LOCAL/lib/ecl`, whereas the proposal tries to guess the location of `ecl` libraries (in case it's in a nonstandard location). Or maybe it's easier to say: we should install `kenzo.fas` the same place we install `maxima.fas`. I wish we could get this to write a good manifest file so that `make kenzo-clean` would actually uninstall something, but I don't know how to overcome the problems on Ubuntu.


---

Comment by git created at 2020-05-29 19:52:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2020-05-29 19:55:00

Here are two changes: my proposed change to `spkg-install.in` and also explicitly `(require :kenzo)`. This shouldn't be necessary since it's part of the feature check, but it doesn't hurt, and it's a good idea to make it explicit in case the feature check gets changed.


---

Comment by jhpalmieri created at 2020-05-30 19:48:55

I'm happy with your feature changes, by the way; thanks for doing that.


---

Comment by tscrim created at 2020-05-31 05:31:47

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-05-31 05:31:47

No, I was using commit 217e47c. Strange.

Thanks. I think you changes are good. I like the explicit check. Back to positive as this should now build the docs as well (at least is does for me).


---

Comment by vbraun created at 2020-05-31 23:12:02

Resolution: fixed
