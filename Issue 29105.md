# Issue 29105: pari spkg-configure.m4 should check gphelp more carefully

archive/issues_029105.json:
```json
{
    "body": "CC:  dimpase embray fbissey isuruf @timokau arojas vdelecroix\n\nFollow-up from #29319 for `fedora-31-standard` (https://github.com/mkoeppe/sage/runs/509417970):\n\n```\nInstalling cypari-2.1.1\n    Generating PARI functions: (!_) (#_) (%) (%#) (+_) (-_) CatalanCould not find translation file, docdir='/usr/bin' at /usr/bin/gphelp line 153.\n    subprocess.CalledProcessError: Command '['gphelp', '-raw', 'Catalan']' returned non-zero exit status 2.\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29342\n\n",
    "created_at": "2020-03-15T20:27:25Z",
    "labels": [
        "build: configure",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "pari spkg-configure.m4 should check gphelp more carefully",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29105",
    "user": "mkoeppe"
}
```
CC:  dimpase embray fbissey isuruf @timokau arojas vdelecroix

Follow-up from #29319 for `fedora-31-standard` (https://github.com/mkoeppe/sage/runs/509417970):

```
Installing cypari-2.1.1
    Generating PARI functions: (!_) (#_) (%) (%#) (+_) (-_) CatalanCould not find translation file, docdir='/usr/bin' at /usr/bin/gphelp line 153.
    subprocess.CalledProcessError: Command '['gphelp', '-raw', 'Catalan']' returned non-zero exit status 2.
```


Issue created by migration from https://trac.sagemath.org/ticket/29342





---

archive/issue_comments_411976.json:
```json
{
    "body": "We have to be careful. My memory tells me cypari and `gphelp -raw` needs the documentation installed including the raw `tex` files - uncompressed. In the case of `Catalan` a run with `strace` tells me `gphelp` opens `usersch3.tex`.",
    "created_at": "2020-03-15T20:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411976",
    "user": "fbissey"
}
```

We have to be careful. My memory tells me cypari and `gphelp -raw` needs the documentation installed including the raw `tex` files - uncompressed. In the case of `Catalan` a run with `strace` tells me `gphelp` opens `usersch3.tex`.



---

archive/issue_comments_411977.json:
```json
{
    "body": "Looks like this error was already discussed in #28242.",
    "created_at": "2020-03-15T21:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411977",
    "user": "mkoeppe"
}
```

Looks like this error was already discussed in #28242.



---

archive/issue_comments_411978.json:
```json
{
    "body": "The problem on Fedora is that the docs are not installed by default:\n\n```\n# grep tsflags /etc/dnf/dnf.conf \ntsflags=nodocs\n```\n",
    "created_at": "2020-03-15T22:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411978",
    "user": "mkoeppe"
}
```

The problem on Fedora is that the docs are not installed by default:

```
# grep tsflags /etc/dnf/dnf.conf 
tsflags=nodocs
```




---

archive/issue_comments_411979.json:
```json
{
    "body": "One needs to install using  `yum install pari-gp --setopt='tsflags='`",
    "created_at": "2020-03-15T22:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411979",
    "user": "mkoeppe"
}
```

One needs to install using  `yum install pari-gp --setopt='tsflags='`



---

archive/issue_comments_411980.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-03-15T22:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411980",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_411981.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-15T22:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411981",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411982.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-03-15T22:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411982",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_411983.json:
```json
{
    "body": "`@`dimpase: This one also touches fedora - and is ready for review",
    "created_at": "2020-03-18T02:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411983",
    "user": "mkoeppe"
}
```

`@`dimpase: This one also touches fedora - and is ready for review



---

archive/issue_comments_411984.json:
```json
{
    "body": "it should be \n\n```\n+'pari-gp --setopt=tsflags='\n```\n\nnot just\n\n```\n+pari-gp --setopt=tsflags=\n```\n\nto prevent bootstrap for pulling these two things apart.",
    "created_at": "2020-03-18T16:13:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411984",
    "user": "dimpase"
}
```

it should be 

```
+'pari-gp --setopt=tsflags='
```

not just

```
+pari-gp --setopt=tsflags=
```

to prevent bootstrap for pulling these two things apart.



---

archive/issue_comments_411985.json:
```json
{
    "body": "That flag applies to the whole command line.",
    "created_at": "2020-03-18T16:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411985",
    "user": "mkoeppe"
}
```

That flag applies to the whole command line.



---

archive/issue_comments_411986.json:
```json
{
    "body": "OK, this works, positive review. \n\nThe next obstacle on Fedora 31: there is no openblas.pc, and\nso I cooked up one, put it somewhere, pointed PKG_CONFIG_PATH there,\nthen openblas is recognised along with R, gsl, etc, but `make` ends with\n\n\n```\nmake[2]: Entering directory '/home/dima/sagetrac-mirror/build/make'\nmake[2]: *** No rule to make target '/home/dima/sagetrac-mirror/src/lib/pkgconfig/cblas.pc', needed by '/home/dima/sagetrac-mirror/local/lib/pkgconfig/cblas.pc'.  Stop.\nmake[2]: Leaving directory '/home/dima/sagetrac-mirror/build/make'\n```\n",
    "created_at": "2020-03-19T02:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411986",
    "user": "dimpase"
}
```

OK, this works, positive review. 

The next obstacle on Fedora 31: there is no openblas.pc, and
so I cooked up one, put it somewhere, pointed PKG_CONFIG_PATH there,
then openblas is recognised along with R, gsl, etc, but `make` ends with


```
make[2]: Entering directory '/home/dima/sagetrac-mirror/build/make'
make[2]: *** No rule to make target '/home/dima/sagetrac-mirror/src/lib/pkgconfig/cblas.pc', needed by '/home/dima/sagetrac-mirror/local/lib/pkgconfig/cblas.pc'.  Stop.
make[2]: Leaving directory '/home/dima/sagetrac-mirror/build/make'
```




---

archive/issue_comments_411987.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-19T02:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411987",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_411988.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-03-19T02:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411988",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_411989.json:
```json
{
    "body": "Replying to [comment:15 dimpase]:\n> The next obstacle on Fedora 31: there is no openblas.pc, and\n> so I cooked up one, put it somewhere, pointed PKG_CONFIG_PATH there,\n> then openblas is recognised along with R, gsl, etc, but `make` ends with\n> \n> {{{\n> make[2]: Entering directory '/home/dima/sagetrac-mirror/build/make'\n> make[2]: *** No rule to make target '/home/dima/sagetrac-mirror/src/lib/pkgconfig/cblas.pc', needed by '/home/dima/sagetrac-mirror/local/lib/pkgconfig/cblas.pc'.  Stop.\n> make[2]: Leaving directory '/home/dima/sagetrac-mirror/build/make'\n> }}}\n\nYes, the pkgconfig mess needs to be cleaned up. #29082",
    "created_at": "2020-03-19T03:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411989",
    "user": "mkoeppe"
}
```

Replying to [comment:15 dimpase]:
> The next obstacle on Fedora 31: there is no openblas.pc, and
> so I cooked up one, put it somewhere, pointed PKG_CONFIG_PATH there,
> then openblas is recognised along with R, gsl, etc, but `make` ends with
> 
> {{{
> make[2]: Entering directory '/home/dima/sagetrac-mirror/build/make'
> make[2]: *** No rule to make target '/home/dima/sagetrac-mirror/src/lib/pkgconfig/cblas.pc', needed by '/home/dima/sagetrac-mirror/local/lib/pkgconfig/cblas.pc'.  Stop.
> make[2]: Leaving directory '/home/dima/sagetrac-mirror/build/make'
> }}}

Yes, the pkgconfig mess needs to be cleaned up. #29082



---

archive/issue_comments_411990.json:
```json
{
    "body": "Yes, I'm on it.",
    "created_at": "2020-03-19T03:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411990",
    "user": "dimpase"
}
```

Yes, I'm on it.



---

archive/issue_comments_411991.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-25T22:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29105#issuecomment-411991",
    "user": "vbraun"
}
```

Resolution: fixed
