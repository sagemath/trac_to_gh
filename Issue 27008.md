# Issue 27008: py3: fix doctests in generic_graph (part 9) -- automorphism_group

Issue created by migration from https://trac.sagemath.org/ticket/27245

Original creator: dcoudert

Original creation time: 2019-02-09 13:03:25

Keywords: py3, graph

We fix failing doctests in `automorphism_group`.

We also do some minor cleaning in the method.


---

Comment by dcoudert created at 2019-02-09 13:04:35

New commits:


---

Comment by dcoudert created at 2019-02-09 13:04:35

Changing status from new to needs_review.


---

Comment by kdilks created at 2019-02-11 16:26:53

In labelled automorphism group test, why not have `d = digraphs.DeBruijn(3,2)` at the very beginning?

In the check for correct domain in the empty group case, is there any reason for changing the output from a set to a sorted list?


---

Comment by git created at 2019-02-11 16:52:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-02-11 16:56:23

Replying to [comment:2 kdilks]:
> In labelled automorphism group test, why not have `d = digraphs.DeBruijn(3,2)` at the very beginning?
Right, done.

> In the check for correct domain in the empty group case, is there any reason for changing the output from a set to a sorted list?
In py2 we always get `{'a', 'b'}`, but in py3 I get `{'b', 'a'}`. So I proposed to used a sorted list to ensure that we always get the same result. Alternatives are to tag doctests as `# py2` or `# py3`, or to change the test to check equality with the set `{'a', 'b'}`, etc. I don't know which is the best option here.


---

Comment by kdilks created at 2019-02-11 17:36:41

Why not make it `Graph({'a':['a'], 'b':[]}).automorphism_group().domain() == {'a', 'b'} ` returns `True` ?


---

Comment by git created at 2019-02-11 18:06:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-02-11 18:07:32

Agreed. It better shows that the output is a set. Thanks.


---

Comment by kdilks created at 2019-02-11 20:23:33

It looks like the test doesn't work this way, presumably because `ag.domain()` is `<class 'sage.sets.finite_enumerated_set.FiniteEnumeratedSet_with_category'>`, and ` {'a', 'b'} ` is just ` <type 'set'> `.


---

Comment by dcoudert created at 2019-02-11 22:26:54


```
sage: from sage.sets.finite_enumerated_set import FiniteEnumeratedSet
sage: F = FiniteEnumeratedSet(['a', 'b'])
sage: F
{'a', 'b'}
sage: type(F)
<class 'sage.sets.finite_enumerated_set.FiniteEnumeratedSet_with_category'>
sage: ag = Graph({'a':['a'], 'b':[]}).automorphism_group()
sage: ag.domain()
{'b', 'a'}
sage: type(ag.domain())
<class 'sage.sets.finite_enumerated_set.FiniteEnumeratedSet_with_category'>
sage: ag.domain() == F
False
```

So I propose to return to my previous proposal unless you have a better solution.


---

Comment by kdilks created at 2019-02-12 10:36:38

I'm fine with the previous proposal. It looks like `domain()` really needs to be a FiniteEnumeratedSet() to play nicely with GAP.


---

Comment by git created at 2019-02-12 13:24:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-02-12 13:24:47

So let's go back to something that is working. Thanks.


---

Comment by dcoudert created at 2019-02-25 17:07:06

I just tried over 8.7.beta5 and it's working well. So can we set this ticket to positive review ?


---

Comment by kdilks created at 2019-02-25 17:09:49

Trying to get my computer updated to 8.7b5 so I can double-check.


---

Comment by kdilks created at 2019-02-25 19:53:01

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-02-25 20:37:21

Thank you.


---

Comment by vbraun created at 2019-02-28 17:54:07

Resolution: fixed
