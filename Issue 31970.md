# Issue 31970: homebrew  llvm / clang - followup to #30835

archive/issues_031970.json:
```json
{
    "body": "CC:  mkoeppe jhpalmieri\n\nin #30835 problems with using clang(++) from Homebrew on macOS were found\n\n* Pillow build broken\n* PATH needs to be adjusted (?)\n\nIssue created by migration from https://trac.sagemath.org/ticket/32207\n\n",
    "created_at": "2021-07-16T10:29:38Z",
    "labels": [
        "build",
        "minor",
        "bug"
    ],
    "title": "homebrew  llvm / clang - followup to #30835",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31970",
    "user": "dimpase"
}
```
CC:  mkoeppe jhpalmieri

in #30835 problems with using clang(++) from Homebrew on macOS were found

* Pillow build broken
* PATH needs to be adjusted (?)

Issue created by migration from https://trac.sagemath.org/ticket/32207





---

archive/issue_comments_456802.json:
```json
{
    "body": "reported here: https://github.com/python-pillow/Pillow/issues/5622",
    "created_at": "2021-07-19T15:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456802",
    "user": "dimpase"
}
```

reported here: https://github.com/python-pillow/Pillow/issues/5622



---

archive/issue_comments_456803.json:
```json
{
    "body": "the setup.py patch in Pillow is obsolete anyway, and should be removed.",
    "created_at": "2021-07-20T14:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456803",
    "user": "dimpase"
}
```

the setup.py patch in Pillow is obsolete anyway, and should be removed.



---

archive/issue_comments_456804.json:
```json
{
    "body": "https://github.com/python-pillow/Pillow/pull/5624 provides a fix. Will backport here.",
    "created_at": "2021-07-21T15:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456804",
    "user": "dimpase"
}
```

https://github.com/python-pillow/Pillow/pull/5624 provides a fix. Will backport here.



---

archive/issue_comments_456805.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-07-21T16:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456805",
    "user": "dimpase"
}
```

New commits:



---

archive/issue_comments_456806.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-21T16:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456806",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_456807.json:
```json
{
    "body": "Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456807",
    "user": "mkoeppe"
}
```

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_comments_456808.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-03T07:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456808",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_456809.json:
```json
{
    "body": "hopefully pillow problem will be fixed by #33116",
    "created_at": "2022-03-03T18:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456809",
    "user": "dimpase"
}
```

hopefully pillow problem will be fixed by #33116



---

archive/issue_comments_456810.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-03T23:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456810",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_456811.json:
```json
{
    "body": "we need to remove this obsolete (?) workaround to let Homebrew's clang do the job. Apparently also OK for Xcode's clang.\n----\nNew commits:",
    "created_at": "2022-03-03T23:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456811",
    "user": "dimpase"
}
```

we need to remove this obsolete (?) workaround to let Homebrew's clang do the job. Apparently also OK for Xcode's clang.
----
New commits:



---

archive/issue_comments_456812.json:
```json
{
    "body": "The only thing to review here is removal of the Darwin-only Pillow workaround, which is no longer necessary, according to my tests.\n\nPlease review.",
    "created_at": "2022-03-15T19:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456812",
    "user": "dimpase"
}
```

The only thing to review here is removal of the Darwin-only Pillow workaround, which is no longer necessary, according to my tests.

Please review.



---

archive/issue_comments_456813.json:
```json
{
    "body": "Changing keywords from \"\" to \"macOS, Darwin\".",
    "created_at": "2022-03-16T09:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456813",
    "user": "dimpase"
}
```

Changing keywords from "" to "macOS, Darwin".



---

archive/issue_comments_456814.json:
```json
{
    "body": "Can someone remind me of why, in the pillow installation log file, it says toward the end\n\n```\nSuccessfully built Pillow\nWARNING: Skipping Pillow as it is not installed.\n```\n",
    "created_at": "2022-03-16T17:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456814",
    "user": "jhpalmieri"
}
```

Can someone remind me of why, in the pillow installation log file, it says toward the end

```
Successfully built Pillow
WARNING: Skipping Pillow as it is not installed.
```




---

archive/issue_comments_456815.json:
```json
{
    "body": "I guess it's coming from `pip` ?\n\n```\nsrc/pip/_internal/req/req_install.py: logger.warning(\"Skipping %s as it is not installed.\", self.name)\n```\n\n\nnamely, before installing a newly built wheel, `pip` is called to uninstall the package.\nBut if it wasn't installed one gets this warning. Harmless.",
    "created_at": "2022-03-16T17:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456815",
    "user": "dimpase"
}
```

I guess it's coming from `pip` ?

```
src/pip/_internal/req/req_install.py: logger.warning("Skipping %s as it is not installed.", self.name)
```


namely, before installing a newly built wheel, `pip` is called to uninstall the package.
But if it wasn't installed one gets this warning. Harmless.



---

archive/issue_comments_456816.json:
```json
{
    "body": "\n```\n$ pip uninstall foobar\nWARNING: Skipping foobar as it is not installed.\n```\n",
    "created_at": "2022-03-16T18:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456816",
    "user": "dimpase"
}
```


```
$ pip uninstall foobar
WARNING: Skipping foobar as it is not installed.
```




---

archive/issue_comments_456817.json:
```json
{
    "body": "Pillow builds for me (with the standard gcc, not using homebrew's llvm etc.). Sage itself does not \u2014 see my recent post on sage-support \u2014 so I can't test further.",
    "created_at": "2022-03-17T21:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456817",
    "user": "jhpalmieri"
}
```

Pillow builds for me (with the standard gcc, not using homebrew's llvm etc.). Sage itself does not — see my recent post on sage-support — so I can't test further.



---

archive/issue_comments_456818.json:
```json
{
    "body": "I understand that #33522 fixes the scipy error you're talking about. It has nothing to do with this ticket, I think.",
    "created_at": "2022-03-17T23:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456818",
    "user": "dimpase"
}
```

I understand that #33522 fixes the scipy error you're talking about. It has nothing to do with this ticket, I think.



---

archive/issue_comments_456819.json:
```json
{
    "body": "I think you're right, but I would like to see for myself that Sage builds with this branch (+#33522).",
    "created_at": "2022-03-18T00:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456819",
    "user": "jhpalmieri"
}
```

I think you're right, but I would like to see for myself that Sage builds with this branch (+#33522).



---

archive/issue_comments_456820.json:
```json
{
    "body": "I haven't checked llvm/clang, but it works with the standard OS X clang + homebrew's gfortran. Is this good enough?",
    "created_at": "2022-03-18T04:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456820",
    "user": "jhpalmieri"
}
```

I haven't checked llvm/clang, but it works with the standard OS X clang + homebrew's gfortran. Is this good enough?



---

archive/issue_comments_456821.json:
```json
{
    "body": "Yes, that's good enough. Thanks.",
    "created_at": "2022-03-18T08:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456821",
    "user": "dimpase"
}
```

Yes, that's good enough. Thanks.



---

archive/issue_comments_456822.json:
```json
{
    "body": "in case, tests are running on #33512#comment:3",
    "created_at": "2022-03-18T09:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456822",
    "user": "dimpase"
}
```

in case, tests are running on #33512#comment:3



---

archive/issue_comments_456823.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-18T14:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456823",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_456824.json:
```json
{
    "body": "Great, let's merge it.",
    "created_at": "2022-03-18T14:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456824",
    "user": "jhpalmieri"
}
```

Great, let's merge it.



---

archive/issue_comments_456825.json:
```json
{
    "body": "FWIW, Positive review on Apple Silicon M1 Macs with Homebrew up to date, both macOS 11.6.5 (Big Sur) with Xcode 13.2.1 and macOS 12.3 (Monterey) with Xcode 13.3.",
    "created_at": "2022-03-20T19:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456825",
    "user": "@GMS103"
}
```

FWIW, Positive review on Apple Silicon M1 Macs with Homebrew up to date, both macOS 11.6.5 (Big Sur) with Xcode 13.2.1 and macOS 12.3 (Monterey) with Xcode 13.3.



---

archive/issue_comments_456826.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-03-27T15:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31970#issuecomment-456826",
    "user": "vbraun"
}
```

Resolution: fixed
