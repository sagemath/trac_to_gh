# Issue 19008: segfault in sage/rings/polynomial/multi_polynomial_libsingular.so

Issue created by migration from Trac.

Original creator: cnassau

Original creation time: 2015-09-19 13:47:06

Keywords: libsingular, matrix, substitution

This code crashes Sage (version 6.9.beta5, detected on the branch for #6101):

```
br = PolynomialRing(ZZ,"a,b,c,d,x1,x2,y1,y2")
br.inject_variables()
dct = {b:a,d:c,x1:0,x2:0,y1:0,y2:0}
L1 = matrix(br,[[x1,x2],[-x1,-x2],[y1,y2],[-y1,-y2]]).transpose().subs(dct)
```


Backtrace:

```
------------------------------------------------------------------------
/waste/cn/sage-git/local/lib/python2.7/site-packages/sage/ext/interrupt/interrupt.so(+0x4125)[0x7ff648c6a125]
/waste/cn/sage-git/local/lib/python2.7/site-packages/sage/ext/interrupt/interrupt.so(+0x4177)[0x7ff648c6a177]
/waste/cn/sage-git/local/lib/python2.7/site-packages/sage/ext/interrupt/interrupt.so(+0x6029)[0x7ff648c6c029]
/lib64/libpthread.so.0(+0xf890)[0x7ff64b9ec890]
/waste/cn/sage-git/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so(+0x3f1cd)[0x7ff628bd81cd]
/waste/cn/sage-git/local/lib/python2.7/site-packages/sage/matrix/matrix2.so(+0x13c2f6)[0x7ff62f9192f6]
/waste/cn/sage-git/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x48a9)[0x7ff64bd041f9]
/waste/cn/sage-git/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7ff64bd05a1d]
/waste/cn/sage-git/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7ff64bd05b52]
/waste/cn/sage-git/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x92)[0x7ff64bd30722]
/waste/cn/sage-git/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xd9)[0x7ff64bd31c59]
/waste/cn/sage-git/local/lib/libpython2.7.so.1.0(Py_Main+0xc4d)[0x7ff64bd479ed]
/lib64/libc.so.6(__libc_start_main+0xf5)[0x7ff64af4fb05]
python[0x4007be]
```




---

Attachment

Smaller case, still crashing in 6.9.beta7:

```
sage: br = PolynomialRing(ZZ,"a,x1,x2")
sage: br.inject_variables()
sage: dct = {x1:a, x2:0}
sage: matrix(br,[This is the Trac macro *x2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x2-macro)).subs(dct)
```



---

Comment by chapoton created at 2015-10-04 14:34:21

Changing component from PLEASE CHANGE to commutative algebra.


---

Comment by chapoton created at 2015-10-04 14:45:41

Interestingly, this seem to appear more generally when the result of substitution is zero:

```
sage: br = PolynomialRing(ZZ,"a,x1,x2")
sage: br.inject_variables()
sage: dct = {x1:a, x2:-1}
sage: matrix(br,[This is the Trac macro *1+x2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1+x2-macro)).subs(dct)
```

BOOM!


---

Comment by vdelecroix created at 2016-07-27 03:48:49

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-07-27 03:48:49

duplicate of the already fixed #17785.


---

Comment by jdemeyer created at 2016-07-27 07:58:22

Changing status from needs_review to positive_review.


---

Comment by embray created at 2016-08-30 13:32:25

Resolution: wontfix


---

Comment by embray created at 2016-08-30 13:32:25

Determined to be invalid/duplicate/wontfix (closing as "wontfix" as a catch-all resolution).
