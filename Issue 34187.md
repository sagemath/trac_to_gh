# Issue 34187: Common base class for FiniteRankFreeModule and TensorFreeModule

archive/issues_034187.json:
```json
{
    "body": "CC:  egourgoulhon tscrim\n\nCurrently `TensorFreeModule` (and similar classes) inherits many methods from `FiniteRankFreeModule` that actually only work with the base module.\nTrying to use them leads to incomprehensible error messages. For example:\n\n```\nsage: M = FiniteRankFreeModule(ZZ, 3, name='M')\nsage: M.tensor_module(2, 1).tensor_module(3, 3)\nFree module of type-(3,3) tensors on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring\nsage: _.an_element()\nValueError: the None has not been defined on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring\n```\n\n\nAs discussed in #30229#comment:6, we introduce a common base class that only defines the methods that should be inherited by `TensorFreeModule` and other such classes.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34424\n\n",
    "created_at": "2022-08-24T17:33:05Z",
    "labels": [
        "linear algebra",
        "major",
        "enhancement"
    ],
    "title": "Common base class for FiniteRankFreeModule and TensorFreeModule",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34187",
    "user": "mkoeppe"
}
```
CC:  egourgoulhon tscrim

Currently `TensorFreeModule` (and similar classes) inherits many methods from `FiniteRankFreeModule` that actually only work with the base module.
Trying to use them leads to incomprehensible error messages. For example:

```
sage: M = FiniteRankFreeModule(ZZ, 3, name='M')
sage: M.tensor_module(2, 1).tensor_module(3, 3)
Free module of type-(3,3) tensors on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring
sage: _.an_element()
ValueError: the None has not been defined on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring
```


As discussed in #30229#comment:6, we introduce a common base class that only defines the methods that should be inherited by `TensorFreeModule` and other such classes.


Issue created by migration from https://trac.sagemath.org/ticket/34424





---

archive/issue_comments_485122.json:
```json
{
    "body": "I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions",
    "created_at": "2022-08-24T17:52:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485122",
    "user": "mkoeppe"
}
```

I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions



---

archive/issue_comments_485123.json:
```json
{
    "body": "Here's a basic version that works.\n\nSome more of the methods can probably be moved to `FiniteRankFreeModule_abstract` -- but currently all doctests pass as is, so in this case we should add some examples that use subclasses.\n----\nNew commits:",
    "created_at": "2022-08-25T02:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485123",
    "user": "mkoeppe"
}
```

Here's a basic version that works.

Some more of the methods can probably be moved to `FiniteRankFreeModule_abstract` -- but currently all doctests pass as is, so in this case we should add some examples that use subclasses.
----
New commits:



---

archive/issue_comments_485124.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-25T03:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485124",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485125.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-25T03:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485125",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485126.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-25T03:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485126",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_485127.json:
```json
{
    "body": "Thanks for implementing this!\n\nReplying to [comment:1 mkoeppe]:\n> I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions\n\nSounds good to me.",
    "created_at": "2022-08-25T09:36:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485127",
    "user": "egourgoulhon"
}
```

Thanks for implementing this!

Replying to [comment:1 mkoeppe]:
> I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions

Sounds good to me.



---

archive/issue_comments_485128.json:
```json
{
    "body": "Just one suggestion: in the docstring of `FiniteRankFreeModule_abstract`:\n\n```diff\n- Free module of finite rank over a commutative ring.\n+ Abstract base class for free modules of finite rank over a commutative ring.\n```\n\nOtherwise, LGTM.",
    "created_at": "2022-08-26T15:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485128",
    "user": "egourgoulhon"
}
```

Just one suggestion: in the docstring of `FiniteRankFreeModule_abstract`:

```diff
- Free module of finite rank over a commutative ring.
+ Abstract base class for free modules of finite rank over a commutative ring.
```

Otherwise, LGTM.



---

archive/issue_comments_485129.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-26T19:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485129",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485130.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-26T22:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485130",
    "user": "egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485131.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-08-26T22:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485131",
    "user": "egourgoulhon"
}
```

Thanks!



---

archive/issue_comments_485132.json:
```json
{
    "body": "Thank you!",
    "created_at": "2022-08-26T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485132",
    "user": "mkoeppe"
}
```

Thank you!



---

archive/issue_comments_485133.json:
```json
{
    "body": "When merged with #31276, this gives a doctest failure",
    "created_at": "2022-08-28T23:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485133",
    "user": "mkoeppe"
}
```

When merged with #31276, this gives a doctest failure



---

archive/issue_comments_485134.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2022-08-28T23:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485134",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_485135.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-08-28T23:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485135",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_485136.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-29T02:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485136",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485137.json:
```json
{
    "body": "Bots are green, back to positive review (hoping that's OK)",
    "created_at": "2022-08-29T02:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485137",
    "user": "mkoeppe"
}
```

Bots are green, back to positive review (hoping that's OK)



---

archive/issue_comments_485138.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-30T19:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34187#issuecomment-485138",
    "user": "vbraun"
}
```

Resolution: fixed
