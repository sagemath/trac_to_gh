# Issue 16755: Direct Fixdoctests

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2014-09-16 11:33:55




---

Comment by vbraun created at 2014-09-16 13:10:22

New commits:


---

Comment by vbraun created at 2014-09-16 13:10:22

Changing component from PLEASE CHANGE to scripts.


---

Comment by vbraun created at 2014-09-16 13:10:22

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-09-16 13:10:22

Changing type from PLEASE CHANGE to enhancement.


---

Comment by jdemeyer created at 2014-09-16 13:22:02

I would replace `sage -git` by `git` since this is supposed to be run from a Sage shell anyway.


---

Comment by git created at 2014-09-16 13:46:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2014-09-16 16:47:36

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2014-09-16 16:47:36

You also need to fix the documentation (output of `./sage --advanced`)


---

Comment by jdemeyer created at 2014-09-16 16:51:58

And could you please add a `\n` to the output file, because otherwise you always get

```diff
diff --git a/src/sage/rings/integer.pyx b/src/sage/rings/integer.pyx
index c85ba09..59cb6c1 100644
--- a/src/sage/rings/integer.pyx
+++ b/src/sage/rings/integer.pyx
`@``@` -6515,4 +6515,4 `@``@` cdef double mpz_get_d_nearest(mpz_t x) except? -648555075988944.5:
     cdef double d = <double>q64
     if resultsign < 0:
         d = -d
-    return ldexp(d, shift)
+    return ldexp(d, shift)
\ No newline at end of file
```

(I know you didn't introduce this bug, but it's such a trivial fix...)


---

Comment by jdemeyer created at 2014-09-16 16:59:11

Shouldn't

```
if relative.startswith('.'):
```

be

```
if relative.startswith('..'):
```

(although it seems that `relpath` strips `./`)


---

Comment by jdemeyer created at 2014-09-16 17:02:20

There is of course a large margin for improvement in the `sage-fixdoctests` script (ideally, it should be integrated within the doctesting framework), but if you make the small changes I mentioned, I'm happy with this ticket.


---

Comment by vbraun created at 2014-09-16 18:33:09

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2014-09-16 18:33:09

done


---

Comment by git created at 2014-09-16 18:33:14

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2014-09-16 18:33:14

Changing status from positive_review to needs_review.


---

Comment by jdemeyer created at 2014-09-16 19:35:18

Changing status from needs_review to positive_review.


---

Comment by git created at 2014-09-18 14:35:35

Changing status from positive_review to needs_review.


---

Comment by git created at 2014-09-18 14:35:35

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by vbraun created at 2014-09-18 14:36:25

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-09-18 14:36:25

Forgot the cmdline test...


---

Comment by jdemeyer created at 2014-09-18 16:35:40

Any reason you write

```
with open(test_file, 'r') as f:
    fixed_test = f.read()
```

instead of

```
    fixed_test = open(test_file).read()
```



---

Comment by vbraun created at 2014-09-18 16:37:37

I don't really care either way much, but to me the first version makes it clearer how long the file is actually open for.


---

Comment by jdemeyer created at 2014-09-18 19:23:13

lgtm (I was going to set positive_review but apparently you already did that :-p)


---

Comment by vbraun created at 2014-09-19 15:08:56

Resolution: fixed
