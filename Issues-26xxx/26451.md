# Issue 26451: Upgrade to Sphinx 1.8.5

archive/issues_026214.json:
```json
{
    "assignees": [],
    "body": "This ticket upgrades Sphinx to version 1.8.5.\n\nOur previous upgrade was to Sphinx 1.7.6 in #26033.\n\n**Tarball**: https://files.pythonhosted.org/packages/2a/86/8e1e8400bb6eca5ed960917952600fce90599e1cb0d20ddedd81ba163370/Sphinx-1.8.5.tar.gz\n\nDepends on #27528\n\nCC:  @timokau @kiwifb @antonio-rojas @embray @slel @jhpalmieri @dimpase @tobihan\n\nKeywords: **sphinx, conda, upgrade**\n\nBranch/Commit: **[`f1a08e3`](https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Julian R\u00fcth, Jeroen Demeyer, John Palmieri, Tobias Hansen**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26451_\n\n",
    "closed_at": "2019-04-02T21:30:01Z",
    "created_at": "2018-10-10T07:53:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade to Sphinx 1.8.5",
    "type": "issue",
    "updated_at": "2019-04-02T21:30:01Z",
    "url": "https://github.com/sagemath/sage/issues/26451",
    "user": "https://github.com/saraedum"
}
```
This ticket upgrades Sphinx to version 1.8.5.

Our previous upgrade was to Sphinx 1.7.6 in #26033.

**Tarball**: https://files.pythonhosted.org/packages/2a/86/8e1e8400bb6eca5ed960917952600fce90599e1cb0d20ddedd81ba163370/Sphinx-1.8.5.tar.gz

Depends on #27528

CC:  @timokau @kiwifb @antonio-rojas @embray @slel @jhpalmieri @dimpase @tobihan

Keywords: **sphinx, conda, upgrade**

Branch/Commit: **[`f1a08e3`](https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365)**

Reviewer: **Dima Pasechnik**

Author: **Julian Rüth, Jeroen Demeyer, John Palmieri, Tobias Hansen**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/26451_





---

archive/issue_events_364440.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-10-10T07:53:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364440"
}
```



---

archive/issue_events_364441.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-10-10T07:53:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364441"
}
```



---

archive/issue_events_364442.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-10-10T07:53:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364442"
}
```



---

archive/issue_events_364443.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-10-10T07:53:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364443"
}
```



---

archive/issue_comments_407839.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nNote that there is nothing I can doctest here.",
    "created_at": "2018-10-10T07:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407839",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:1" align="right">comment:1</div>

Note that there is nothing I can doctest here.



---

archive/issue_comments_407840.json:
```json
{
    "body": "Branch: **[u/saraedum/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/26451)**",
    "created_at": "2018-10-10T07:57:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407840",
    "user": "https://github.com/saraedum"
}
```

Branch: **[u/saraedum/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/26451)**



---

archive/issue_comments_407841.json:
```json
{
    "body": "Work Issues: **is the patchbot happy?**",
    "created_at": "2018-10-10T07:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407841",
    "user": "https://github.com/saraedum"
}
```

Work Issues: **is the patchbot happy?**



---

archive/issue_comments_407842.json:
```json
{
    "body": "Commit: **[`eb00e75`](https://github.com/sagemath/sagetrac-mirror/commit/eb00e754ad464ed4e0374e86ffd0e779e6909369)**",
    "created_at": "2018-10-10T07:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407842",
    "user": "https://github.com/saraedum"
}
```

Commit: **[`eb00e75`](https://github.com/sagemath/sagetrac-mirror/commit/eb00e754ad464ed4e0374e86ffd0e779e6909369)**



---

archive/issue_events_364444.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-10-10T07:57:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364444"
}
```



---

archive/issue_comments_407843.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb00e754ad464ed4e0374e86ffd0e779e6909369\"><code>eb00e75</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr></table>\n",
    "created_at": "2018-10-10T07:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407843",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb00e754ad464ed4e0374e86ffd0e779e6909369"><code>eb00e75</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr></table>




---

archive/issue_comments_407844.json:
```json
{
    "body": "Changed keywords from none to **sphinx, conda**",
    "created_at": "2018-10-10T07:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407844",
    "user": "https://github.com/saraedum"
}
```

Changed keywords from none to **sphinx, conda**



---

archive/issue_events_364445.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-10T08:14:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364445"
}
```



---

archive/issue_events_364446.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-10T08:14:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364446"
}
```



---

archive/issue_comments_407845.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI'd rather upgrade Sphinx while we're at it. That's a good thing to do and I would need to do that anyway to test this ticket.",
    "created_at": "2018-10-10T08:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407845",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I'd rather upgrade Sphinx while we're at it. That's a good thing to do and I would need to do that anyway to test this ticket.



---

archive/issue_comments_407846.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI was fearing that you would propose that ;)\n\nI am not planning on working on upgrading Sphinx in Sage (as I've got too many other things to worry about.) I don't know what has chahnged in 1.8.1 and whether we would want to upgrade at all.\n\nMore generally, I don't know what we're aiming for here. I feel we don't have enough people to keep Sage-the-distribution close to upstream most of the time so that's probably not what we should be aiming for?\n\nThat said, feel free to upgrade Sphinx :) But if anybody likes these small changes and we want to move the Sphinx upgrade into a separate ticket, I would prefer that.",
    "created_at": "2018-10-10T08:27:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407846",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:7" align="right">comment:7</div>

I was fearing that you would propose that ;)

I am not planning on working on upgrading Sphinx in Sage (as I've got too many other things to worry about.) I don't know what has chahnged in 1.8.1 and whether we would want to upgrade at all.

More generally, I don't know what we're aiming for here. I feel we don't have enough people to keep Sage-the-distribution close to upstream most of the time so that's probably not what we should be aiming for?

That said, feel free to upgrade Sphinx :) But if anybody likes these small changes and we want to move the Sphinx upgrade into a separate ticket, I would prefer that.



---

archive/issue_comments_407847.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n ApplicationError: Source directory and destination directory cannot be identical\n ```\n \n-coming out of Sphinx as they have chahnged the argument checking of the `Sphinx` constructor it seems.\n+coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx` constructor it seems.\n \n It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.\n``````\n",
    "created_at": "2018-10-10T08:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407847",
    "user": "https://github.com/saraedum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 ApplicationError: Source directory and destination directory cannot be identical
 ```
 
-coming out of Sphinx as they have chahnged the argument checking of the `Sphinx` constructor it seems.
+coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx` constructor it seems.
 
 It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.
``````




---

archive/issue_comments_407848.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n ApplicationError: Source directory and destination directory cannot be identical\n ```\n \n-coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx` constructor it seems.\n+coming out of Sphinx as they have chahnged the argument checking of the `Sphinx` constructor it seems.\n \n It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.\n``````\n",
    "created_at": "2018-10-10T08:30:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407848",
    "user": "https://github.com/antonio-rojas"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 ApplicationError: Source directory and destination directory cannot be identical
 ```
 
-coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx` constructor it seems.
+coming out of Sphinx as they have chahnged the argument checking of the `Sphinx` constructor it seems.
 
 It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.
``````




---

archive/issue_comments_407849.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nUpgrading sphinx requires further changes to make docs build. I have a minimal patch at https://git.archlinux.org/svntogit/community.git/tree/trunk/sagemath-doc-sphinx-1.8.patch?h=packages/sagemath-doc\nto make it build, although with it one still gets lots of deprecation warnings due to changes in logging functions.",
    "created_at": "2018-10-10T08:30:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407849",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:9" align="right">comment:9</div>

Upgrading sphinx requires further changes to make docs build. I have a minimal patch at https://git.archlinux.org/svntogit/community.git/tree/trunk/sagemath-doc-sphinx-1.8.patch?h=packages/sagemath-doc
to make it build, although with it one still gets lots of deprecation warnings due to changes in logging functions.



---

archive/issue_comments_407850.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n ApplicationError: Source directory and destination directory cannot be identical\n ```\n \n-coming out of Sphinx as they have chahnged the argument checking of the `Sphinx` constructor it seems.\n+coming out of Sphinx in conda as they have chahnged the argument checking of the `Sphinx` constructor it seems.\n \n It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.\n``````\n",
    "created_at": "2018-10-10T08:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407850",
    "user": "https://github.com/antonio-rojas"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 ApplicationError: Source directory and destination directory cannot be identical
 ```
 
-coming out of Sphinx as they have chahnged the argument checking of the `Sphinx` constructor it seems.
+coming out of Sphinx in conda as they have chahnged the argument checking of the `Sphinx` constructor it seems.
 
 It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.
``````




---

archive/issue_comments_407851.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAntonio, does Sphinx 1.8.1 work with just those changes (even if there are deprecation warnings)? If so, we might as well upgrade.",
    "created_at": "2018-10-10T08:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407851",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Antonio, does Sphinx 1.8.1 work with just those changes (even if there are deprecation warnings)? If so, we might as well upgrade.



---

archive/issue_comments_407852.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@jdemeyer](#comment:11):\n> Antonio, does Sphinx 1.8.1 work with just those changes (even if there are deprecation warnings)? If so, we might as well upgrade.\n\nYes, with Julian's patch and mine introspection works and docs build correctly.",
    "created_at": "2018-10-10T08:35:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407852",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@jdemeyer](#comment:11):
> Antonio, does Sphinx 1.8.1 work with just those changes (even if there are deprecation warnings)? If so, we might as well upgrade.

Yes, with Julian's patch and mine introspection works and docs build correctly.



---

archive/issue_comments_407853.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n ApplicationError: Source directory and destination directory cannot be identical\n ```\n \n-coming out of Sphinx in conda as they have chahnged the argument checking of the `Sphinx` constructor it seems.\n+coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.\n \n-It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.\n+**Tarball**: https://files.pythonhosted.org/packages/c7/e9/b1bed881847680cecc70159b8b9d5fd1cd4e85627c534712c2c7b339f8b6/Sphinx-1.8.1.tar.gz\n``````\n",
    "created_at": "2018-10-10T08:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407853",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 ApplicationError: Source directory and destination directory cannot be identical
 ```
 
-coming out of Sphinx in conda as they have chahnged the argument checking of the `Sphinx` constructor it seems.
+coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.
 
-It would be nice to be more friendly to downstream by making Sage work better with Sphinx 1.8 already.
+**Tarball**: https://files.pythonhosted.org/packages/c7/e9/b1bed881847680cecc70159b8b9d5fd1cd4e85627c534712c2c7b339f8b6/Sphinx-1.8.1.tar.gz
``````




---

archive/issue_events_364447.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-10T08:36:35Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "title_is": "Upgrade to sphinx 1.8.1",
    "title_was": "Prepare for sphinx 1.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364447"
}
```



---

archive/issue_comments_407854.json:
```json
{
    "body": "Changed work issues from **is the patchbot happy?** to none",
    "created_at": "2018-10-10T08:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407854",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **is the patchbot happy?** to none



---

archive/issue_comments_407855.json:
```json
{
    "body": "Changed author from **Julian R\u00fcth** to **Julian R\u00fcth, Jeroen Demeyer**",
    "created_at": "2018-10-10T08:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407855",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Julian Rüth** to **Julian Rüth, Jeroen Demeyer**



---

archive/issue_events_364448.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-10T08:36:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364448"
}
```



---

archive/issue_events_364449.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-10T08:36:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364449"
}
```



---

archive/issue_comments_407856.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\njdemeyer, did you forget to push your branch? (you added yourself as an Author but did not push any changes it seems.)",
    "created_at": "2018-10-10T10:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407856",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:14" align="right">comment:14</div>

jdemeyer, did you forget to push your branch? (you added yourself as an Author but did not push any changes it seems.)



---

archive/issue_comments_407857.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nPlease give me time...",
    "created_at": "2018-10-10T10:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407857",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Please give me time...



---

archive/issue_comments_407858.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nNote that there is a licensing issue in sphinxify.py, see #26453.",
    "created_at": "2018-10-10T10:20:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407858",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:16" align="right">comment:16</div>

Note that there is a licensing issue in sphinxify.py, see #26453.



---

archive/issue_comments_407859.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6051437fb79d3566313d641f1f31a79f2a8ff5e\"><code>a605143</code></a></td><td><code>Call Sphinx 1.8.! with the correct outdir set</code></td></tr></table>\n",
    "created_at": "2018-10-10T10:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407859",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6051437fb79d3566313d641f1f31a79f2a8ff5e"><code>a605143</code></a></td><td><code>Call Sphinx 1.8.! with the correct outdir set</code></td></tr></table>




---

archive/issue_comments_407860.json:
```json
{
    "body": "Changed commit from **[`eb00e75`](https://github.com/sagemath/sagetrac-mirror/commit/eb00e754ad464ed4e0374e86ffd0e779e6909369)** to **[`a605143`](https://github.com/sagemath/sagetrac-mirror/commit/a6051437fb79d3566313d641f1f31a79f2a8ff5e)**",
    "created_at": "2018-10-10T10:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407860",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`eb00e75`](https://github.com/sagemath/sagetrac-mirror/commit/eb00e754ad464ed4e0374e86ffd0e779e6909369)** to **[`a605143`](https://github.com/sagemath/sagetrac-mirror/commit/a6051437fb79d3566313d641f1f31a79f2a8ff5e)**



---

archive/issue_comments_407861.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ae155f09f45896ac8a06f35c128c500e3023deb\"><code>4ae155f</code></a></td><td><code>Call Sphinx 1.8.1 with the correct outdir set</code></td></tr></table>\n",
    "created_at": "2018-10-10T10:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407861",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ae155f09f45896ac8a06f35c128c500e3023deb"><code>4ae155f</code></a></td><td><code>Call Sphinx 1.8.1 with the correct outdir set</code></td></tr></table>




---

archive/issue_comments_407862.json:
```json
{
    "body": "Changed commit from **[`a605143`](https://github.com/sagemath/sagetrac-mirror/commit/a6051437fb79d3566313d641f1f31a79f2a8ff5e)** to **[`4ae155f`](https://github.com/sagemath/sagetrac-mirror/commit/4ae155f09f45896ac8a06f35c128c500e3023deb)**",
    "created_at": "2018-10-10T10:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407862",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a605143`](https://github.com/sagemath/sagetrac-mirror/commit/a6051437fb79d3566313d641f1f31a79f2a8ff5e)** to **[`4ae155f`](https://github.com/sagemath/sagetrac-mirror/commit/4ae155f09f45896ac8a06f35c128c500e3023deb)**



---

archive/issue_comments_407863.json:
```json
{
    "body": "Changed branch from **[u/saraedum/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/26451)** to **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)**",
    "created_at": "2018-10-11T07:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407863",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/saraedum/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/26451)** to **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)**



---

archive/issue_comments_407864.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19b29e552caf792bbd5eb1e335b6072f2125a981\"><code>19b29e5</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr></table>\n",
    "created_at": "2018-10-12T17:53:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407864",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19b29e552caf792bbd5eb1e335b6072f2125a981"><code>19b29e5</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr></table>




---

archive/issue_comments_407865.json:
```json
{
    "body": "Changed commit from **[`4ae155f`](https://github.com/sagemath/sagetrac-mirror/commit/4ae155f09f45896ac8a06f35c128c500e3023deb)** to **[`19b29e5`](https://github.com/sagemath/sagetrac-mirror/commit/19b29e552caf792bbd5eb1e335b6072f2125a981)**",
    "created_at": "2018-10-12T17:53:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407865",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`4ae155f`](https://github.com/sagemath/sagetrac-mirror/commit/4ae155f09f45896ac8a06f35c128c500e3023deb)** to **[`19b29e5`](https://github.com/sagemath/sagetrac-mirror/commit/19b29e552caf792bbd5eb1e335b6072f2125a981)**



---

archive/issue_comments_407866.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nBy the way, see also #26449 for issues with Sphinx and the Python 3 build of Sage.",
    "created_at": "2018-10-12T18:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407866",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

By the way, see also #26449 for issues with Sphinx and the Python 3 build of Sage.



---

archive/issue_comments_407867.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI just did the upgrade on nix and I also needed to apply the same patch to sagenb's `sphinxify.py` (https://github.com/sagemath/sagenb/pull/461).",
    "created_at": "2018-10-22T21:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407867",
    "user": "https://github.com/timokau"
}
```

<div id="comment:22" align="right">comment:22</div>

I just did the upgrade on nix and I also needed to apply the same patch to sagenb's `sphinxify.py` (https://github.com/sagemath/sagenb/pull/461).



---

archive/issue_events_364450.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-22T21:14:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364450"
}
```



---

archive/issue_events_364451.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-22T21:14:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364451"
}
```



---

archive/issue_comments_407868.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@timokau](#comment:22):\n> I just did the upgrade on nix and I also needed to apply the same patch to sagenb's `sphinxify.py` (https://github.com/sagemath/sagenb/pull/461).\n\nOnce upon a time `sphinxify` was a part of sagenb and it was used in sage itself. So time ago we put an end to that. May be it is time to go in reverse and have (the now deprecated) sagenb use sage's sphinxify.",
    "created_at": "2018-10-22T21:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407868",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@timokau](#comment:22):
> I just did the upgrade on nix and I also needed to apply the same patch to sagenb's `sphinxify.py` (https://github.com/sagemath/sagenb/pull/461).

Once upon a time `sphinxify` was a part of sagenb and it was used in sage itself. So time ago we put an end to that. May be it is time to go in reverse and have (the now deprecated) sagenb use sage's sphinxify.



---

archive/issue_comments_407869.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThe documentation does not build for me on OS X: I get\n\n```\n[reference]     valuations: 1 todos, 14 index, 1409 citations, 13 modules\n[reference] ... done (472 todos, 2068 index, 1409 citations, 2019 modules)\n[reference] preparing documents... skipping loading of indexes... done\n[reference] Merging js index files...\n[reference]     algebras: 3466 js index entries\n[reference]     arithgroup: 966 js index entries\n\n   ...\n\n[reference]     structure: 1995 js index entries\n[reference]     tensor_free_modules: 1035 js index entries\n[reference]     valuations: 817 js index entries\n[reference] ... done (44888 js index entries)\n[reference] WARNING: cannot copy static file IOError(20, 'Not a directory')\n[reference] copying static files... copying extra files... done\n[reference] The HTML pages are in local/share/doc/sage/html/en/reference.\nError building the documentation.\nTraceback (most recent call last):\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n    main()\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 1715, in main\n    builder()\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 338, in _wrapper\n    getattr(get_builder(document), name)(*args, **kwds)\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 536, in _wrapper\n    getattr(DocBuilder(self.name, lang), format)(*args, **kwds)\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 130, in f\n    runsphinx()\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py\", line 319, in runsphinx\n    sys.stderr.raise_errors()\n  File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py\", line 254, in raise_errors\n    raise OSError(self._error)\nOSError: WARNING: cannot copy static file IOError(20, 'Not a directory')\n```\nIndeed, `local/share/doc/sage/html/en/reference/_static` is a file, not a directory: it is the file `graphviz.css` from Sphinx. If I delete it, create a directory `_static`, and run `make` again, then only `graphviz.css` is copied to the directory, so the reference manual is missing all of its css files. The other parts of the documentation look good.",
    "created_at": "2018-10-23T19:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407869",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

The documentation does not build for me on OS X: I get

```
[reference]     valuations: 1 todos, 14 index, 1409 citations, 13 modules
[reference] ... done (472 todos, 2068 index, 1409 citations, 2019 modules)
[reference] preparing documents... skipping loading of indexes... done
[reference] Merging js index files...
[reference]     algebras: 3466 js index entries
[reference]     arithgroup: 966 js index entries

   ...

[reference]     structure: 1995 js index entries
[reference]     tensor_free_modules: 1035 js index entries
[reference]     valuations: 817 js index entries
[reference] ... done (44888 js index entries)
[reference] WARNING: cannot copy static file IOError(20, 'Not a directory')
[reference] copying static files... copying extra files... done
[reference] The HTML pages are in local/share/doc/sage/html/en/reference.
Error building the documentation.
Traceback (most recent call last):
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/runpy.py", line 174, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
    main()
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 1715, in main
    builder()
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 338, in _wrapper
    getattr(get_builder(document), name)(*args, **kwds)
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 536, in _wrapper
    getattr(DocBuilder(self.name, lang), format)(*args, **kwds)
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 130, in f
    runsphinx()
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py", line 319, in runsphinx
    sys.stderr.raise_errors()
  File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py", line 254, in raise_errors
    raise OSError(self._error)
OSError: WARNING: cannot copy static file IOError(20, 'Not a directory')
```
Indeed, `local/share/doc/sage/html/en/reference/_static` is a file, not a directory: it is the file `graphviz.css` from Sphinx. If I delete it, create a directory `_static`, and run `make` again, then only `graphviz.css` is copied to the directory, so the reference manual is missing all of its css files. The other parts of the documentation look good.



---

archive/issue_comments_407870.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThere is some odd behavior with `graphviz.css`. First, it gets copied to `local/share/doc/sage/inventory/en/reference/_static` (a file, not a directory): Sphinx shouldn't copy any css files in the inventory build. Then it also gets copied to a similar location in the html build. I commented out `'sphinx.ext.graphviz'` in the list of extensions in `src/doc/common/conf.py` and started over, but the same thing happened. So something strange is going on with graphviz and our custom builder for the reference manual. In contrast, `./sage --docbuild tutorial html` works fine.",
    "created_at": "2018-10-23T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407870",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">comment:26</div>

There is some odd behavior with `graphviz.css`. First, it gets copied to `local/share/doc/sage/inventory/en/reference/_static` (a file, not a directory): Sphinx shouldn't copy any css files in the inventory build. Then it also gets copied to a similar location in the html build. I commented out `'sphinx.ext.graphviz'` in the list of extensions in `src/doc/common/conf.py` and started over, but the same thing happened. So something strange is going on with graphviz and our custom builder for the reference manual. In contrast, `./sage --docbuild tutorial html` works fine.



---

archive/issue_comments_407871.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nSee https://github.com/sphinx-doc/sphinx/pull/5549",
    "created_at": "2018-10-24T05:54:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407871",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

See https://github.com/sphinx-doc/sphinx/pull/5549



---

archive/issue_comments_407872.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jdemeyer](#comment:27):\n> See https://github.com/sphinx-doc/sphinx/pull/5549\n\nThat's very helpful, thank you, but it leads to my next problem: with that fix applied, `graphviz.css` is still copied to `local/share/doc/sage/inventory/en/reference/_static/`, and there is no reason to copy css files to the inventory build. As a consequence, I see this error:\n\n```\nBuilding reference manual, second pass.\n\n[arithgrou] WARNING: failed to reach any of the inventories with the following issues:\n[arithgrou] WARNING: intersphinx inventory '/Users/jpalmier/Desktop/Sage/git/sage/local/share/doc/sage/inventory/en/reference/_static/objects.inv' not fetchable due to <type 'exceptions.IOError'>: [Errno 2] No such file or directory: '/Users/jpalmier/Desktop/Sage/git/sage/local/share/doc/sage/inventory/en/reference/_static/objects.inv'\n```\nI think intersphinx looks in every subdirectory of `inventory/en/reference/`, including `_static`, which should not be there.",
    "created_at": "2018-10-24T18:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407872",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jdemeyer](#comment:27):
> See https://github.com/sphinx-doc/sphinx/pull/5549

That's very helpful, thank you, but it leads to my next problem: with that fix applied, `graphviz.css` is still copied to `local/share/doc/sage/inventory/en/reference/_static/`, and there is no reason to copy css files to the inventory build. As a consequence, I see this error:

```
Building reference manual, second pass.

[arithgrou] WARNING: failed to reach any of the inventories with the following issues:
[arithgrou] WARNING: intersphinx inventory '/Users/jpalmier/Desktop/Sage/git/sage/local/share/doc/sage/inventory/en/reference/_static/objects.inv' not fetchable due to <type 'exceptions.IOError'>: [Errno 2] No such file or directory: '/Users/jpalmier/Desktop/Sage/git/sage/local/share/doc/sage/inventory/en/reference/_static/objects.inv'
```
I think intersphinx looks in every subdirectory of `inventory/en/reference/`, including `_static`, which should not be there.



---

archive/issue_comments_407873.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nAnd once I clean that up, I still see a *file* `_static` in the html reference build.",
    "created_at": "2018-10-24T20:22:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407873",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:29" align="right">comment:29</div>

And once I clean that up, I still see a *file* `_static` in the html reference build.



---

archive/issue_comments_407874.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI wonder if the problem is that it tries to copy `graphviz.css` to, for example, `html/en/reference/algebras/_static`, which is a symlink pointing to the as yet non-existent `html/en/reference/_static`.",
    "created_at": "2018-10-24T23:25:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407874",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

I wonder if the problem is that it tries to copy `graphviz.css` to, for example, `html/en/reference/algebras/_static`, which is a symlink pointing to the as yet non-existent `html/en/reference/_static`.



---

archive/issue_comments_407875.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)** to **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)**",
    "created_at": "2018-10-25T19:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407875",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)** to **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)**



---

archive/issue_comments_407876.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nHere is a new branch. I'm not happy about the changes to `src/sage_setup/docbuild/__init__.py`, but I couldn't get the reference manual to build otherwise. Maybe there is another Sphinx bug, or maybe it's something about our multidoc extension. I would be happy if someone found a cleaner fix.\n\n(This requires Jeroen's Sphinx fix from https://github.com/sphinx-doc/sphinx/pull/5549, by the way. I did not add that as a patch to Sphinx, although maybe we will need to if Sphinx doesn't fix it themselves.)\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1efde599241c638941b2e9f8ff38bb1a5b5c19e3\"><code>1efde59</code></a></td><td><code>merging</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b79b1d9af2d2769831ababb09803840711fb65c3\"><code>b79b1d9</code></a></td><td><code>trac 26451: silence deprecation warnings about app.info, app.debug, etc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c\"><code>4a91a60</code></a></td><td><code>trac 26451: remove bad _static directory, bad _static file</code></td></tr></table>\n",
    "created_at": "2018-10-25T19:23:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407876",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

Here is a new branch. I'm not happy about the changes to `src/sage_setup/docbuild/__init__.py`, but I couldn't get the reference manual to build otherwise. Maybe there is another Sphinx bug, or maybe it's something about our multidoc extension. I would be happy if someone found a cleaner fix.

(This requires Jeroen's Sphinx fix from https://github.com/sphinx-doc/sphinx/pull/5549, by the way. I did not add that as a patch to Sphinx, although maybe we will need to if Sphinx doesn't fix it themselves.)

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1efde599241c638941b2e9f8ff38bb1a5b5c19e3"><code>1efde59</code></a></td><td><code>merging</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b79b1d9af2d2769831ababb09803840711fb65c3"><code>b79b1d9</code></a></td><td><code>trac 26451: silence deprecation warnings about app.info, app.debug, etc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c"><code>4a91a60</code></a></td><td><code>trac 26451: remove bad _static directory, bad _static file</code></td></tr></table>




---

archive/issue_comments_407877.json:
```json
{
    "body": "Changed commit from **[`19b29e5`](https://github.com/sagemath/sagetrac-mirror/commit/19b29e552caf792bbd5eb1e335b6072f2125a981)** to **[`4a91a60`](https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c)**",
    "created_at": "2018-10-25T19:23:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407877",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`19b29e5`](https://github.com/sagemath/sagetrac-mirror/commit/19b29e552caf792bbd5eb1e335b6072f2125a981)** to **[`4a91a60`](https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c)**



---

archive/issue_comments_407878.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65ab61522cacad7558350f3cb1f0b16d0001235e\"><code>65ab615</code></a></td><td><code>trac 26451: a little reST fix</code></td></tr></table>\n",
    "created_at": "2018-10-26T21:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407878",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65ab61522cacad7558350f3cb1f0b16d0001235e"><code>65ab615</code></a></td><td><code>trac 26451: a little reST fix</code></td></tr></table>




---

archive/issue_comments_407879.json:
```json
{
    "body": "Changed commit from **[`4a91a60`](https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c)** to **[`65ab615`](https://github.com/sagemath/sagetrac-mirror/commit/65ab61522cacad7558350f3cb1f0b16d0001235e)**",
    "created_at": "2018-10-26T21:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407879",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4a91a60`](https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c)** to **[`65ab615`](https://github.com/sagemath/sagetrac-mirror/commit/65ab61522cacad7558350f3cb1f0b16d0001235e)**



---

archive/issue_comments_407880.json:
```json
{
    "body": "Dependencies: **#26558**",
    "created_at": "2018-10-26T21:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407880",
    "user": "https://github.com/jhpalmieri"
}
```

Dependencies: **#26558**



---

archive/issue_comments_407881.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nWith this (plus Jeroen's Sphinx fix, plus #26558 if your version of TeXLive is recent), the html and pdf docs build for me.",
    "created_at": "2018-10-26T21:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407881",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:34" align="right">comment:34</div>

With this (plus Jeroen's Sphinx fix, plus #26558 if your version of TeXLive is recent), the html and pdf docs build for me.



---

archive/issue_events_364452.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-11-18T22:52:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "title_is": "Upgrade to Sphinx 1.8.2",
    "title_was": "Upgrade to sphinx 1.8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364452"
}
```



---

archive/issue_comments_407882.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,12 @@\n-With sphinx 1.8.1 we see quite a few\n+This ticket is to upgrade to Sphinx 1.8.2.\n+\n+Our previous upgrade was to Sphinx 1.7.6 in #26033.\n+\n+With Sphinx 1.8.1 we see quite a few\n \n ```\n ApplicationError: Source directory and destination directory cannot be identical\n ```\n-\n coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.\n \n-**Tarball**: https://files.pythonhosted.org/packages/c7/e9/b1bed881847680cecc70159b8b9d5fd1cd4e85627c534712c2c7b339f8b6/Sphinx-1.8.1.tar.gz\n+**Tarball**: https://files.pythonhosted.org/packages/4c/ea/7388faba7cf02999e1bc42f6a8eb1ea0120aec3dd93474cee21cea2d693f/Sphinx-1.8.2.tar.gz\n``````\n",
    "created_at": "2018-11-18T22:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407882",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,12 @@
-With sphinx 1.8.1 we see quite a few
+This ticket is to upgrade to Sphinx 1.8.2.
+
+Our previous upgrade was to Sphinx 1.7.6 in #26033.
+
+With Sphinx 1.8.1 we see quite a few
 
 ```
 ApplicationError: Source directory and destination directory cannot be identical
 ```
-
 coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.
 
-**Tarball**: https://files.pythonhosted.org/packages/c7/e9/b1bed881847680cecc70159b8b9d5fd1cd4e85627c534712c2c7b339f8b6/Sphinx-1.8.1.tar.gz
+**Tarball**: https://files.pythonhosted.org/packages/4c/ea/7388faba7cf02999e1bc42f6a8eb1ea0120aec3dd93474cee21cea2d693f/Sphinx-1.8.2.tar.gz
``````




---

archive/issue_comments_407883.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThe following tickets mentioned in the discussion above are now fixed and closed,\n\n- #26449 Sphinx and the Python 3 build of Sage\n- #26453 Relicense sphinxify.py\n- #26558 doc-pdf fails due to conflict with new babel.sty\n\nThe following pull request to Sphinx was merged on 2018-10-28,\n\n- [Sphinx issue 5549: Correctly deal with non-existing static dir in graphviz extension](https://github.com/sphinx-doc/sphinx/pull/5549)\n\nand finally\n\n- Sphinx 1.8.2 was uploaded to PyPI on 2018-11-11.\n\nIs this comment from the ticket description still a problem with Sphinx 1.8.2?\n\n> With Sphinx 1.8.1 we see quite a few\n> \n> ```\n> ApplicationError: Source directory and destination directory cannot be identical\n> ```\n> coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.",
    "created_at": "2018-11-18T22:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407883",
    "user": "https://github.com/slel"
}
```

<div id="comment:35" align="right">comment:35</div>

The following tickets mentioned in the discussion above are now fixed and closed,

- #26449 Sphinx and the Python 3 build of Sage
- #26453 Relicense sphinxify.py
- #26558 doc-pdf fails due to conflict with new babel.sty

The following pull request to Sphinx was merged on 2018-10-28,

- [Sphinx issue 5549: Correctly deal with non-existing static dir in graphviz extension](https://github.com/sphinx-doc/sphinx/pull/5549)

and finally

- Sphinx 1.8.2 was uploaded to PyPI on 2018-11-11.

Is this comment from the ticket description still a problem with Sphinx 1.8.2?

> With Sphinx 1.8.1 we see quite a few
> 
> ```
> ApplicationError: Source directory and destination directory cannot be identical
> ```
> coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.



---

archive/issue_comments_407884.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nSphinx 1.8.3 was released on 2018-12-25.\n\nTarball: https://files.pythonhosted.org/packages/4d/ed/4595274b5c9ce53a768cc0804ef65fd6282c956b93919a969e98d53894e4/Sphinx-1.8.3.tar.gz",
    "created_at": "2019-01-13T18:52:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407884",
    "user": "https://github.com/slel"
}
```

<div id="comment:36" align="right">comment:36</div>

Sphinx 1.8.3 was released on 2018-12-25.

Tarball: https://files.pythonhosted.org/packages/4d/ed/4595274b5c9ce53a768cc0804ef65fd6282c956b93919a969e98d53894e4/Sphinx-1.8.3.tar.gz



---

archive/issue_comments_407885.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nUnfortunately the patch no longer works with 1.8.3. I'm getting this error on the second pass:\n\n```\n[manifolds] building [html]: targets for 60 source files that are out of date\n[manifolds] updating environment: 60 added, 0 changed, 0 removed\n[manifolds]   app.builder.info(bold('loading cross citations... '), nonl=1)\n[manifolds]   app.builder.info(\"done (%s citations).\"%len(cache))\n[manifolds]   app.builder.info(bold('linking _static directory.'))\n[manifolds] The HTML pages are in doc/html/en/reference/manifolds.\n[manifolds] Exception occurred:\n[manifolds]   File \"/usr/lib/python2.7/os.py\", line 157, in makedirs\n[manifolds]     mkdir(name, mode)\n[manifolds] OSError: [Errno 17] File exists: '/build/sagemath-doc/src/sage-8.6/src/doc/html/en/reference/manifolds/_static'\n[manifolds] The full traceback has been saved in /tmp/sphinx-err-EkdWJl.log, if you want to report the issue to the developers.\n[manifolds] Please also report this if it was a user error, so that a better error message can be provided next time.\n[manifolds] A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!\nError building the documentation.\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/build/sagemath-doc/src/sage-8.6/src/sage_setup/docbuild/__main__.py\", line 2, in <module>\n    main()\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 1744, in main\n    builder()\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 356, in _wrapper\n    getattr(get_builder(document), name)(*args, **kwds)\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 547, in _wrapper\n    build_many(build_ref_doc, L)\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 290, in build_many\n    results.append(target(arg))\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 74, in build_ref_doc\n    getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 772, in _wrapper\n    getattr(DocBuilder, build_type)(self, *args, **kwds)\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py\", line 130, in f\n    runsphinx()\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/sphinxbuild.py\", line 319, in runsphinx\n    sys.stderr.raise_errors()\n  File \"/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/sphinxbuild.py\", line 254, in raise_errors\n    raise OSError(self._error)\nOSError: Exception occurred:\n\n    Note: incremental documentation builds sometimes cause spurious\n    error messages. To be certain that these are real errors, run\n    \"make doc-clean\" first and try again.\n```",
    "created_at": "2019-01-17T07:01:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407885",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:37" align="right">comment:37</div>

Unfortunately the patch no longer works with 1.8.3. I'm getting this error on the second pass:

```
[manifolds] building [html]: targets for 60 source files that are out of date
[manifolds] updating environment: 60 added, 0 changed, 0 removed
[manifolds]   app.builder.info(bold('loading cross citations... '), nonl=1)
[manifolds]   app.builder.info("done (%s citations)."%len(cache))
[manifolds]   app.builder.info(bold('linking _static directory.'))
[manifolds] The HTML pages are in doc/html/en/reference/manifolds.
[manifolds] Exception occurred:
[manifolds]   File "/usr/lib/python2.7/os.py", line 157, in makedirs
[manifolds]     mkdir(name, mode)
[manifolds] OSError: [Errno 17] File exists: '/build/sagemath-doc/src/sage-8.6/src/doc/html/en/reference/manifolds/_static'
[manifolds] The full traceback has been saved in /tmp/sphinx-err-EkdWJl.log, if you want to report the issue to the developers.
[manifolds] Please also report this if it was a user error, so that a better error message can be provided next time.
[manifolds] A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!
Error building the documentation.
Traceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 174, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/build/sagemath-doc/src/sage-8.6/src/sage_setup/docbuild/__main__.py", line 2, in <module>
    main()
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 1744, in main
    builder()
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 356, in _wrapper
    getattr(get_builder(document), name)(*args, **kwds)
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 547, in _wrapper
    build_many(build_ref_doc, L)
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 290, in build_many
    results.append(target(arg))
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 74, in build_ref_doc
    getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 772, in _wrapper
    getattr(DocBuilder, build_type)(self, *args, **kwds)
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/__init__.py", line 130, in f
    runsphinx()
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/sphinxbuild.py", line 319, in runsphinx
    sys.stderr.raise_errors()
  File "/build/sagemath-doc/src/sage-8.6/local-python/sage_setup/docbuild/sphinxbuild.py", line 254, in raise_errors
    raise OSError(self._error)
OSError: Exception occurred:

    Note: incremental documentation builds sometimes cause spurious
    error messages. To be certain that these are real errors, run
    "make doc-clean" first and try again.
```



---

archive/issue_comments_407886.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nThe problem is that /build/sagemath-doc/src/sage-8.6/src/doc/html/en/reference/manifolds/_static is a symlink to a non-existant ../_static, which makes sphinx raise an error after [this commit](https://github.com/sphinx-doc/sphinx/commit/a7d950ad580eb1feab5094b59857c2eebb8a8976)",
    "created_at": "2019-01-17T19:09:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407886",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:38" align="right">comment:38</div>

The problem is that /build/sagemath-doc/src/sage-8.6/src/doc/html/en/reference/manifolds/_static is a symlink to a non-existant ../_static, which makes sphinx raise an error after [this commit](https://github.com/sphinx-doc/sphinx/commit/a7d950ad580eb1feab5094b59857c2eebb8a8976)



---

archive/issue_comments_407887.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI don't understand what Sphinx is doing. I don't know if I will have time to work on this soon, but a starting point is to get rid of [my proposed _static commit](https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c). The other commits (or variations on them \u2013 in particular `environment.patch` needs to be modified) are I think needed.\n\nHere is my first question: why does the inventory builder create `_static` directories? Those directories should not be there in the first place. They only contain `graphviz.css`, which makes me think it's a bug in Sphinx's graphviz extension. A Sage-specific patch for Sphinx that might help:\n\n```diff\ndiff --git a/sphinx/ext/graphviz.py~ b/sphinx/ext/graphviz.py\nindex c9b1541..6fffcd6 100644\n--- a/sphinx/ext/graphviz.py\n+++ b/sphinx/ext/graphviz.py\n@@ -410,7 +410,7 @@ def man_visit_graphviz(self, node):\n \n def on_build_finished(app, exc):\n     # type: (Sphinx, Exception) -> None\n-    if exc is None:\n+    if exc is None and not app.config.multidoc_first_pass:\n         src = path.join(sphinx.package_dir, 'templates', 'graphviz', 'graphviz.css')\n         dst = path.join(app.outdir, '_static')\n         copy_asset(src, dst)\n```",
    "created_at": "2019-01-18T00:01:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407887",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:39" align="right">comment:39</div>

I don't understand what Sphinx is doing. I don't know if I will have time to work on this soon, but a starting point is to get rid of [my proposed _static commit](https://github.com/sagemath/sagetrac-mirror/commit/4a91a6005a550f99bd927b447d36cf7adc4e0f2c). The other commits (or variations on them – in particular `environment.patch` needs to be modified) are I think needed.

Here is my first question: why does the inventory builder create `_static` directories? Those directories should not be there in the first place. They only contain `graphviz.css`, which makes me think it's a bug in Sphinx's graphviz extension. A Sage-specific patch for Sphinx that might help:

```diff
diff --git a/sphinx/ext/graphviz.py~ b/sphinx/ext/graphviz.py
index c9b1541..6fffcd6 100644
--- a/sphinx/ext/graphviz.py
+++ b/sphinx/ext/graphviz.py
@@ -410,7 +410,7 @@ def man_visit_graphviz(self, node):
 
 def on_build_finished(app, exc):
     # type: (Sphinx, Exception) -> None
-    if exc is None:
+    if exc is None and not app.config.multidoc_first_pass:
         src = path.join(sphinx.package_dir, 'templates', 'graphviz', 'graphviz.css')
         dst = path.join(app.outdir, '_static')
         copy_asset(src, dst)
```



---

archive/issue_comments_407888.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThat patch doesn't quite work: there is still a `_static` directory in `local/share/doc/sage/inventory/en/reference/`, although it prevents them from being created in all of the subdirectories. Something stupid like `not 'inventory' in app.outdir` works, although there should be better ways to check that we're doing an inventory build. That still doesn't work, of course, but it's a place to start.",
    "created_at": "2019-01-18T00:26:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407888",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:40" align="right">comment:40</div>

That patch doesn't quite work: there is still a `_static` directory in `local/share/doc/sage/inventory/en/reference/`, although it prevents them from being created in all of the subdirectories. Something stupid like `not 'inventory' in app.outdir` works, although there should be better ways to check that we're doing an inventory build. That still doesn't work, of course, but it's a place to start.



---

archive/issue_comments_407889.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nIf I use some sort of stupid patch on graphviz.py, then Sphinx crashes when it reaches the second pass, because of the reason you point out: `html/en/reference/_static` does not exist, but there are symlinks pointing to it. If I then manually create this directory (which we could add to the code), the docbuild still fails:\n\n```\nWARNING: search index couldn't be loaded, but not all documents will be built: the index will be incomplete.\n```\nThere is a method in sphinx.builders.html called `load_indexer`, and for reasons I don't understand, it is not finding all of the relevant files: its input is two lists, the files it thinks it should include, and the files covered by the index, and if they are not the same, it raises this warning. I added some print statements to see how these two sets differed, and I couldn't see any pattern. When I disable that warning, it gets much farther, but I'm guessing that something will be broken with either the documentation or the index.",
    "created_at": "2019-01-18T06:14:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407889",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:41" align="right">comment:41</div>

If I use some sort of stupid patch on graphviz.py, then Sphinx crashes when it reaches the second pass, because of the reason you point out: `html/en/reference/_static` does not exist, but there are symlinks pointing to it. If I then manually create this directory (which we could add to the code), the docbuild still fails:

```
WARNING: search index couldn't be loaded, but not all documents will be built: the index will be incomplete.
```
There is a method in sphinx.builders.html called `load_indexer`, and for reasons I don't understand, it is not finding all of the relevant files: its input is two lists, the files it thinks it should include, and the files covered by the index, and if they are not the same, it raises this warning. I added some print statements to see how these two sets differed, and I couldn't see any pattern. When I disable that warning, it gets much farther, but I'm guessing that something will be broken with either the documentation or the index.



---

archive/issue_comments_407890.json:
```json
{
    "body": "Changed commit from **[`65ab615`](https://github.com/sagemath/sagetrac-mirror/commit/65ab61522cacad7558350f3cb1f0b16d0001235e)** to **[`fc3b36f`](https://github.com/sagemath/sagetrac-mirror/commit/fc3b36f017d01c198e87d146a868f1ab7eddd23d)**",
    "created_at": "2019-01-18T06:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407890",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`65ab615`](https://github.com/sagemath/sagetrac-mirror/commit/65ab61522cacad7558350f3cb1f0b16d0001235e)** to **[`fc3b36f`](https://github.com/sagemath/sagetrac-mirror/commit/fc3b36f017d01c198e87d146a868f1ab7eddd23d)**



---

archive/issue_comments_407891.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5f44be86403a552662fbf4c4a1c3d171ec0412e\"><code>a5f44be</code></a></td><td><code>trac 26451: src/misc/sphinxify fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc3b36f017d01c198e87d146a868f1ab7eddd23d\"><code>fc3b36f</code></a></td><td><code>trac 26451:</code></td></tr></table>\n",
    "created_at": "2019-01-18T06:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407891",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5f44be86403a552662fbf4c4a1c3d171ec0412e"><code>a5f44be</code></a></td><td><code>trac 26451: src/misc/sphinxify fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc3b36f017d01c198e87d146a868f1ab7eddd23d"><code>fc3b36f</code></a></td><td><code>trac 26451:</code></td></tr></table>




---

archive/issue_comments_407892.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nOkay, here is my current \"progress\". If I use the branch I just posted, along with this change to Sphinx (which is a terrible idea):\n\n```diff\ndiff --git a/sphinx/builders/html.py b/sphinx/builders/html.py\nindex 5060d1f..6747b6c 100644\n--- a/sphinx/builders/html.py\n+++ b/sphinx/builders/html.py\n@@ -1010,7 +1010,7 @@ class StandaloneHTMLBuilder(Builder):\n             with f:\n                 self.indexer.load(f, self.indexer_format)\n         except (IOError, OSError, ValueError):\n-            if keep:\n+            if keep and False:\n                 logger.warning(__('search index couldn\\'t be loaded, but not all '\n                                   'documents will be built: the index will be '\n                                   'incomplete.'))\n```\nthen the documentation builds. Remaining questions: is the documentation complete? Is the index complete? What is the right way to fix the problem that this stupid patch fixes? Are the other changes okay?",
    "created_at": "2019-01-18T06:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407892",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:43" align="right">comment:43</div>

Okay, here is my current "progress". If I use the branch I just posted, along with this change to Sphinx (which is a terrible idea):

```diff
diff --git a/sphinx/builders/html.py b/sphinx/builders/html.py
index 5060d1f..6747b6c 100644
--- a/sphinx/builders/html.py
+++ b/sphinx/builders/html.py
@@ -1010,7 +1010,7 @@ class StandaloneHTMLBuilder(Builder):
             with f:
                 self.indexer.load(f, self.indexer_format)
         except (IOError, OSError, ValueError):
-            if keep:
+            if keep and False:
                 logger.warning(__('search index couldn\'t be loaded, but not all '
                                   'documents will be built: the index will be '
                                   'incomplete.'))
```
then the documentation builds. Remaining questions: is the documentation complete? Is the index complete? What is the right way to fix the problem that this stupid patch fixes? Are the other changes okay?



---

archive/issue_comments_407893.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nThis really should be rebased to #26949 since that makes non-trivial changes to the docbuilder.",
    "created_at": "2019-01-18T09:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407893",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

This really should be rebased to #26949 since that makes non-trivial changes to the docbuilder.



---

archive/issue_comments_407894.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,4 @@\n ```\n coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.\n \n-**Tarball**: https://files.pythonhosted.org/packages/4c/ea/7388faba7cf02999e1bc42f6a8eb1ea0120aec3dd93474cee21cea2d693f/Sphinx-1.8.2.tar.gz\n+**Tarball**: https://files.pythonhosted.org/packages/4d/ed/4595274b5c9ce53a768cc0804ef65fd6282c956b93919a969e98d53894e4/Sphinx-1.8.3.tar.gz\n``````\n",
    "created_at": "2019-01-18T09:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407894",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,4 @@
 ```
 coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.
 
-**Tarball**: https://files.pythonhosted.org/packages/4c/ea/7388faba7cf02999e1bc42f6a8eb1ea0120aec3dd93474cee21cea2d693f/Sphinx-1.8.2.tar.gz
+**Tarball**: https://files.pythonhosted.org/packages/4d/ed/4595274b5c9ce53a768cc0804ef65fd6282c956b93919a969e98d53894e4/Sphinx-1.8.3.tar.gz
``````




---

archive/issue_comments_407895.json:
```json
{
    "body": "Changed dependencies from **#26558** to **#26949**",
    "created_at": "2019-01-18T09:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407895",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#26558** to **#26949**



---

archive/issue_events_364453.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-18T09:19:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "title_is": "Upgrade to Sphinx 1.8.3",
    "title_was": "Upgrade to Sphinx 1.8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364453"
}
```



---

archive/issue_comments_407896.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nNote that the line from #26949\n\n```\nfrom sphinx.ext.autodoc.inspector import format_annotation, formatargspec\n```\nand later use of `formatargspec` leads to deprecation warnings with new versions of Sphinx.",
    "created_at": "2019-01-18T23:53:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407896",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:45" align="right">comment:45</div>

Note that the line from #26949

```
from sphinx.ext.autodoc.inspector import format_annotation, formatargspec
```
and later use of `formatargspec` leads to deprecation warnings with new versions of Sphinx.



---

archive/issue_comments_407897.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOn the other hand, documentation seems to build with the branch here + #26949. Now to figure out which changes are actually needed once rebased to #26949.",
    "created_at": "2019-01-19T00:17:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407897",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:46" align="right">comment:46</div>

On the other hand, documentation seems to build with the branch here + #26949. Now to figure out which changes are actually needed once rebased to #26949.



---

archive/issue_comments_407898.json:
```json
{
    "body": "Changed commit from **[`fc3b36f`](https://github.com/sagemath/sagetrac-mirror/commit/fc3b36f017d01c198e87d146a868f1ab7eddd23d)** to **[`54179cd`](https://github.com/sagemath/sagetrac-mirror/commit/54179cdace30db612c53e2626beab20c2e09f903)**",
    "created_at": "2019-01-21T07:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407898",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fc3b36f`](https://github.com/sagemath/sagetrac-mirror/commit/fc3b36f017d01c198e87d146a868f1ab7eddd23d)** to **[`54179cd`](https://github.com/sagemath/sagetrac-mirror/commit/54179cdace30db612c53e2626beab20c2e09f903)**



---

archive/issue_comments_407899.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a3ef7f3e59350b30da4aa19c7a9260fbfafdf40\"><code>4a3ef7f</code></a></td><td><code>Make sage autodoc work for both py2 and py3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54179cdace30db612c53e2626beab20c2e09f903\"><code>54179cd</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr></table>\n",
    "created_at": "2019-01-21T07:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407899",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a3ef7f3e59350b30da4aa19c7a9260fbfafdf40"><code>4a3ef7f</code></a></td><td><code>Make sage autodoc work for both py2 and py3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54179cdace30db612c53e2626beab20c2e09f903"><code>54179cd</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr></table>




---

archive/issue_comments_407900.json:
```json
{
    "body": "Changed author from **Julian R\u00fcth, Jeroen Demeyer** to **Julian R\u00fcth, Jeroen Demeyer, John Palmieri**",
    "created_at": "2019-01-21T07:04:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407900",
    "user": "https://github.com/jhpalmieri"
}
```

Changed author from **Julian Rüth, Jeroen Demeyer** to **Julian Rüth, Jeroen Demeyer, John Palmieri**



---

archive/issue_comments_407901.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nOkay, let's try this.",
    "created_at": "2019-01-21T07:04:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407901",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:48" align="right">comment:48</div>

Okay, let's try this.



---

archive/issue_events_364454.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-01-21T07:04:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364454"
}
```



---

archive/issue_events_364455.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-01-21T07:04:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364455"
}
```



---

archive/issue_comments_407902.json:
```json
{
    "body": "Changed commit from **[`54179cd`](https://github.com/sagemath/sagetrac-mirror/commit/54179cdace30db612c53e2626beab20c2e09f903)** to **[`08a92c9`](https://github.com/sagemath/sagetrac-mirror/commit/08a92c96413f26e1a63fe346ab98fd5265cd0ef5)**",
    "created_at": "2019-01-21T07:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407902",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`54179cd`](https://github.com/sagemath/sagetrac-mirror/commit/54179cdace30db612c53e2626beab20c2e09f903)** to **[`08a92c9`](https://github.com/sagemath/sagetrac-mirror/commit/08a92c96413f26e1a63fe346ab98fd5265cd0ef5)**



---

archive/issue_comments_407903.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08a92c96413f26e1a63fe346ab98fd5265cd0ef5\"><code>08a92c9</code></a></td><td><code>trac 26451: patch Sphinx's graphviz.py</code></td></tr></table>\n",
    "created_at": "2019-01-21T07:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407903",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08a92c96413f26e1a63fe346ab98fd5265cd0ef5"><code>08a92c9</code></a></td><td><code>trac 26451: patch Sphinx's graphviz.py</code></td></tr></table>




---

archive/issue_comments_407904.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nI'd rather wait until the dependency is actually merged to review this.",
    "created_at": "2019-01-21T07:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407904",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:50" align="right">comment:50</div>

I'd rather wait until the dependency is actually merged to review this.



---

archive/issue_comments_407905.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nWhat's the upstream story of that patch? Was it proposed somewhere? What is its purpose?",
    "created_at": "2019-01-22T20:23:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407905",
    "user": "https://github.com/timokau"
}
```

<div id="comment:51" align="right">comment:51</div>

What's the upstream story of that patch? Was it proposed somewhere? What is its purpose?



---

archive/issue_comments_407906.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nFor its purpose, see comments 25-30, 39, and maybe some others. (Search this page for \"graphviz\".) Basically, Sphinx needlessly copies the file `graphviz.css` to `inventory/en/refererence/MODULE/_static/` directories, and then that confuses the intersphinx build. I haven't reported it upstream because I don't know how Sage-specific it is. We have our own inventory builder, our own \"multidocs\" extension, etc., and it is not clear how much those are responsible for the problem.\n\nI would also not be surprised if there were better ways to handle the problem with `graphviz.css`. I believe that my suggestion works, so now is the time to confirm that and then to improve on it. (Or wait until #26949 is merged and then do that.)",
    "created_at": "2019-01-22T20:51:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407906",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:52" align="right">comment:52</div>

For its purpose, see comments 25-30, 39, and maybe some others. (Search this page for "graphviz".) Basically, Sphinx needlessly copies the file `graphviz.css` to `inventory/en/refererence/MODULE/_static/` directories, and then that confuses the intersphinx build. I haven't reported it upstream because I don't know how Sage-specific it is. We have our own inventory builder, our own "multidocs" extension, etc., and it is not clear how much those are responsible for the problem.

I would also not be surprised if there were better ways to handle the problem with `graphviz.css`. I believe that my suggestion works, so now is the time to confirm that and then to improve on it. (Or wait until #26949 is merged and then do that.)



---

archive/issue_comments_407907.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)** to **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)**",
    "created_at": "2019-01-29T08:56:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407907",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)** to **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)**



---

archive/issue_comments_407908.json:
```json
{
    "body": "Changed dependencies from **#26949** to none",
    "created_at": "2019-01-29T08:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407908",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#26949** to none



---

archive/issue_comments_407909.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nRebased to 8.7.beta1\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe643be82b82a4bb06ee04cbe24421fb9c55d97e\"><code>fe643be</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e7aa0422d570a48265a1bf351e9237868fea31c4\"><code>e7aa042</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd941c1288596aaa7206c64455ea2b6f10f52a2b\"><code>fd941c1</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7248a2c9737e1af66fadee939c281f94a16f3fe\"><code>c7248a2</code></a></td><td><code>trac 26451: patch Sphinx's graphviz.py</code></td></tr></table>\n",
    "created_at": "2019-01-29T08:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407909",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:54" align="right">comment:54</div>

Rebased to 8.7.beta1

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe643be82b82a4bb06ee04cbe24421fb9c55d97e"><code>fe643be</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e7aa0422d570a48265a1bf351e9237868fea31c4"><code>e7aa042</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd941c1288596aaa7206c64455ea2b6f10f52a2b"><code>fd941c1</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7248a2c9737e1af66fadee939c281f94a16f3fe"><code>c7248a2</code></a></td><td><code>trac 26451: patch Sphinx's graphviz.py</code></td></tr></table>




---

archive/issue_comments_407910.json:
```json
{
    "body": "Changed commit from **[`08a92c9`](https://github.com/sagemath/sagetrac-mirror/commit/08a92c96413f26e1a63fe346ab98fd5265cd0ef5)** to **[`c7248a2`](https://github.com/sagemath/sagetrac-mirror/commit/c7248a2c9737e1af66fadee939c281f94a16f3fe)**",
    "created_at": "2019-01-29T08:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407910",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`08a92c9`](https://github.com/sagemath/sagetrac-mirror/commit/08a92c96413f26e1a63fe346ab98fd5265cd0ef5)** to **[`c7248a2`](https://github.com/sagemath/sagetrac-mirror/commit/c7248a2c9737e1af66fadee939c281f94a16f3fe)**



---

archive/issue_comments_407911.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nI also restored some of the older commits, to make clear who did what.",
    "created_at": "2019-01-29T09:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407911",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

I also restored some of the older commits, to make clear who did what.



---

archive/issue_comments_407912.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nBased on the diff, I'm willing to give this ticket the benefit of the doubt. I cannot say that I understand everything but there is nothing obviously bad.\n\nI haven't actually built the documentation yet, I'll do that next.",
    "created_at": "2019-01-29T09:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407912",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Based on the diff, I'm willing to give this ticket the benefit of the doubt. I cannot say that I understand everything but there is nothing obviously bad.

I haven't actually built the documentation yet, I'll do that next.



---

archive/issue_comments_407913.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nAs a packager I share Timo's concerns about the sphinx patch. Are there plans to upstream it?",
    "created_at": "2019-01-29T09:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407913",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:57" align="right">comment:57</div>

As a packager I share Timo's concerns about the sphinx patch. Are there plans to upstream it?



---

archive/issue_comments_407914.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@antonio-rojas](#comment:57):\n> As a packager I share Timo's concerns about the sphinx patch.\n\nIs there is any particular reason that you're concerned about that specific patch and not the other patches that Sage has for Sphinx?",
    "created_at": "2019-01-29T13:32:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407914",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@antonio-rojas](#comment:57):
> As a packager I share Timo's concerns about the sphinx patch.

Is there is any particular reason that you're concerned about that specific patch and not the other patches that Sage has for Sphinx?



---

archive/issue_comments_407915.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@jdemeyer](#comment:58):\n> Replying to [@antonio-rojas](#comment:57):\n> > As a packager I share Timo's concerns about the sphinx patch.\n\n> \n> Is there is any particular reason that you're concerned about that specific patch and not the other patches that Sage has for Sphinx?\n\nYes, those other patches either address minor issues or are not relevant to Arch, so not having them is not a problem. This one is necessary for docs to build at all.",
    "created_at": "2019-01-29T13:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407915",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@jdemeyer](#comment:58):
> Replying to [@antonio-rojas](#comment:57):
> > As a packager I share Timo's concerns about the sphinx patch.

> 
> Is there is any particular reason that you're concerned about that specific patch and not the other patches that Sage has for Sphinx?

Yes, those other patches either address minor issues or are not relevant to Arch, so not having them is not a problem. This one is necessary for docs to build at all.



---

archive/issue_comments_407916.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nThere is a minor regression in the produced documentation: a `<BLANKLIKE>` in a doctest is now rendered as `<BLANKLINE>` instead of an actual blank line.",
    "created_at": "2019-01-29T15:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407916",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

There is a minor regression in the produced documentation: a `<BLANKLIKE>` in a doctest is now rendered as `<BLANKLINE>` instead of an actual blank line.



---

archive/issue_comments_407917.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nThat's the only issue in the generated documentation I could find by diffing the docs before and after this ticket. It does have problems with parsing <code>\\`A = \\` \\`\\`self\\`\\`</code> (see `src/sage/categories/filtered_algebras_with_basis.py`) but the current version also has problems, just different problems.",
    "created_at": "2019-01-29T15:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407917",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:61" align="right">comment:61</div>

That's the only issue in the generated documentation I could find by diffing the docs before and after this ticket. It does have problems with parsing <code>\`A = \` \`\`self\`\`</code> (see `src/sage/categories/filtered_algebras_with_basis.py`) but the current version also has problems, just different problems.



---

archive/issue_comments_407918.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nReplying to [@jdemeyer](#comment:60):\n> There is a minor regression in the produced documentation: a `<BLANKLIKE>` in a doctest is now rendered as `<BLANKLINE>` instead of an actual blank line.\n\nDid you check to see if other `nonmath_substitutes` from `misc.sagedoc` are handled properly? (Or I should say, at least as properly as they currently are?)",
    "created_at": "2019-01-29T19:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407918",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:62" align="right">comment:62</div>

Replying to [@jdemeyer](#comment:60):
> There is a minor regression in the produced documentation: a `<BLANKLIKE>` in a doctest is now rendered as `<BLANKLINE>` instead of an actual blank line.

Did you check to see if other `nonmath_substitutes` from `misc.sagedoc` are handled properly? (Or I should say, at least as properly as they currently are?)



---

archive/issue_comments_407919.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nMaybe this isn't handled by `sage.misc.sagedoc`, but should instead be handled by `sphinx.ext.doctest`: lines like\n\n```\n        if self.name == 'doctest':\n            if '<BLANKLINE>' in code:\n                # convert <BLANKLINE>s to ordinary blank lines for presentation\n                test = code\n                code = blankline_re.sub('', code)\n```\nThere weren't any changes in this between the old and new versions of Sphinx.",
    "created_at": "2019-01-29T20:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407919",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:63" align="right">comment:63</div>

Maybe this isn't handled by `sage.misc.sagedoc`, but should instead be handled by `sphinx.ext.doctest`: lines like

```
        if self.name == 'doctest':
            if '<BLANKLINE>' in code:
                # convert <BLANKLINE>s to ordinary blank lines for presentation
                test = code
                code = blankline_re.sub('', code)
```
There weren't any changes in this between the old and new versions of Sphinx.



---

archive/issue_comments_407920.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)** to **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)**",
    "created_at": "2019-01-30T06:03:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407920",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/jdemeyer/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/26451)** to **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)**



---

archive/issue_comments_407921.json:
```json
{
    "body": "Changed commit from **[`c7248a2`](https://github.com/sagemath/sagetrac-mirror/commit/c7248a2c9737e1af66fadee939c281f94a16f3fe)** to **[`5f7b6ec`](https://github.com/sagemath/sagetrac-mirror/commit/5f7b6ecf8b4596fb497642b71cd87b140428fbab)**",
    "created_at": "2019-01-30T06:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407921",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`c7248a2`](https://github.com/sagemath/sagetrac-mirror/commit/c7248a2c9737e1af66fadee939c281f94a16f3fe)** to **[`5f7b6ec`](https://github.com/sagemath/sagetrac-mirror/commit/5f7b6ecf8b4596fb497642b71cd87b140428fbab)**



---

archive/issue_comments_407922.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@antonio-rojas](#comment:59):\n> Replying to [@jdemeyer](#comment:58):\n> > Replying to [@antonio-rojas](#comment:57):\n> > > As a packager I share Timo's concerns about the sphinx patch.\n\n> > \n> > Is there is any particular reason that you're concerned about that specific patch and not the other patches that Sage has for Sphinx?\n\n> \n> Yes, those other patches either address minor issues or are not relevant to Arch, so not having them is not a problem. This one is necessary for docs to build at all.\n\nHere is maybe a better approach with graphviz.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0347a79e81c77867f78b448ef1dc0796af24a9fe\"><code>0347a79</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f7b6ecf8b4596fb497642b71cd87b140428fbab\"><code>5f7b6ec</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr></table>\n",
    "created_at": "2019-01-30T06:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407922",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@antonio-rojas](#comment:59):
> Replying to [@jdemeyer](#comment:58):
> > Replying to [@antonio-rojas](#comment:57):
> > > As a packager I share Timo's concerns about the sphinx patch.

> > 
> > Is there is any particular reason that you're concerned about that specific patch and not the other patches that Sage has for Sphinx?

> 
> Yes, those other patches either address minor issues or are not relevant to Arch, so not having them is not a problem. This one is necessary for docs to build at all.

Here is maybe a better approach with graphviz.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0347a79e81c77867f78b448ef1dc0796af24a9fe"><code>0347a79</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f7b6ecf8b4596fb497642b71cd87b140428fbab"><code>5f7b6ec</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr></table>




---

archive/issue_comments_407923.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nThe point here is that the inventory builder is Sage-specific, and that's where the problem lies. So patching graphviz.py to deal with the inventory builder is okay (in my opinion) and would not make sense to report upstream. It looks like we can deal with it differently, though: rather than preventing graphviz.py from populating `_static` directories, we can remove them in the cleanup stage of the inventory build.",
    "created_at": "2019-01-30T06:06:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407923",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:66" align="right">comment:66</div>

The point here is that the inventory builder is Sage-specific, and that's where the problem lies. So patching graphviz.py to deal with the inventory builder is okay (in my opinion) and would not make sense to report upstream. It looks like we can deal with it differently, though: rather than preventing graphviz.py from populating `_static` directories, we can remove them in the cleanup stage of the inventory build.



---

archive/issue_comments_407924.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nGreat! I'll look into the `<BLANKLINE>` thing now.",
    "created_at": "2019-01-30T14:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407924",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:67" align="right">comment:67</div>

Great! I'll look into the `<BLANKLINE>` thing now.



---

archive/issue_comments_407925.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@jhpalmieri](#comment:66):\n> The point here is that the inventory builder is Sage-specific, and that's where the problem lies. So patching graphviz.py to deal with the inventory builder is okay (in my opinion) and would not make sense to report upstream. It looks like we can deal with it differently, though: rather than preventing graphviz.py from populating `_static` directories, we can remove them in the cleanup stage of the inventory build.\n\nThanks. With this branch, the docs build fine on Arch with unpatched sphinx 1.8.3, modulo #26608",
    "created_at": "2019-01-30T14:26:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407925",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@jhpalmieri](#comment:66):
> The point here is that the inventory builder is Sage-specific, and that's where the problem lies. So patching graphviz.py to deal with the inventory builder is okay (in my opinion) and would not make sense to report upstream. It looks like we can deal with it differently, though: rather than preventing graphviz.py from populating `_static` directories, we can remove them in the cleanup stage of the inventory build.

Thanks. With this branch, the docs build fine on Arch with unpatched sphinx 1.8.3, modulo #26608



---

archive/issue_comments_407926.json:
```json
{
    "body": "Changed commit from **[`5f7b6ec`](https://github.com/sagemath/sagetrac-mirror/commit/5f7b6ecf8b4596fb497642b71cd87b140428fbab)** to **[`a3ceda2`](https://github.com/sagemath/sagetrac-mirror/commit/a3ceda240bb3e8bbb840d8635e5a62dc240d858a)**",
    "created_at": "2019-01-30T17:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407926",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5f7b6ec`](https://github.com/sagemath/sagetrac-mirror/commit/5f7b6ecf8b4596fb497642b71cd87b140428fbab)** to **[`a3ceda2`](https://github.com/sagemath/sagetrac-mirror/commit/a3ceda240bb3e8bbb840d8635e5a62dc240d858a)**



---

archive/issue_comments_407927.json:
```json
{
    "body": "<div id=\"comment:69\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3568fd6a76821e4903ea7693d6d8204a6b37a5e\"><code>a3568fd</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3ceda240bb3e8bbb840d8635e5a62dc240d858a\"><code>a3ceda2</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr></table>\n",
    "created_at": "2019-01-30T17:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407927",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:69"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3568fd6a76821e4903ea7693d6d8204a6b37a5e"><code>a3568fd</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3ceda240bb3e8bbb840d8635e5a62dc240d858a"><code>a3ceda2</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr></table>




---

archive/issue_comments_407928.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nThe most recent commit is an attempt on my part to squash the commits that add and then remove the graphviz patch. My first time squashing, so I hope it worked.",
    "created_at": "2019-01-30T17:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407928",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:70" align="right">comment:70</div>

The most recent commit is an attempt on my part to squash the commits that add and then remove the graphviz patch. My first time squashing, so I hope it worked.



---

archive/issue_comments_407929.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nThanks for avoiding the graphviz.py patch. Now we can also use the patch in Debian.\n\nIn Debian we have a few new failing doctests with sage 8.6, sphinx 1.8.3 and this patch. There is this:\n\n```\nsage -t --long src/doc/common/conf.py\n**********************************************************************\nFile \"src/doc/common/conf.py\", line 619, in doc.common.conf.call_intersphinx\nFailed example:\n    for line in open(thematic_index).readlines():  # optional - dochtml\n        if \"padics\" in line:\n            sys.stdout.write(line)\nExpected:\n    <li><a class=\"reference external\" href=\"../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial\" title=\"(in Sage Reference Manual: p-Adics v...)\"><span>Introduction to the -adics</span></a></li>\nGot:\n    <li><a class=\"reference external\" href=\"../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial\" title=\"(in Sage Reference Manual: p-Adics v8.6)\"><span>Introduction to the p-adics</span></a></li>\n```\nand 6 occurances of `ApplicationError: Source directory and destination directory cannot be identical` in `sagenb/misc/sphinxify.py` (which need to be fixed in sagenb I guess).",
    "created_at": "2019-01-31T23:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407929",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:71" align="right">comment:71</div>

Thanks for avoiding the graphviz.py patch. Now we can also use the patch in Debian.

In Debian we have a few new failing doctests with sage 8.6, sphinx 1.8.3 and this patch. There is this:

```
sage -t --long src/doc/common/conf.py
**********************************************************************
File "src/doc/common/conf.py", line 619, in doc.common.conf.call_intersphinx
Failed example:
    for line in open(thematic_index).readlines():  # optional - dochtml
        if "padics" in line:
            sys.stdout.write(line)
Expected:
    <li><a class="reference external" href="../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial" title="(in Sage Reference Manual: p-Adics v...)"><span>Introduction to the -adics</span></a></li>
Got:
    <li><a class="reference external" href="../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial" title="(in Sage Reference Manual: p-Adics v8.6)"><span>Introduction to the p-adics</span></a></li>
```
and 6 occurances of `ApplicationError: Source directory and destination directory cannot be identical` in `sagenb/misc/sphinxify.py` (which need to be fixed in sagenb I guess).



---

archive/issue_events_364456.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-31T23:41:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364456"
}
```



---

archive/issue_events_364457.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-31T23:41:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364457"
}
```



---

archive/issue_comments_407930.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nCc Dima Pasechnik about the sagenb question.",
    "created_at": "2019-01-31T23:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407930",
    "user": "https://github.com/slel"
}
```

<div id="comment:72" align="right">comment:72</div>

Cc Dima Pasechnik about the sagenb question.



---

archive/issue_comments_407931.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nReplying to [@slel](#comment:72):\n> Cc Dima Pasechnik about the sagenb question.\n\nThanks. This is now https://github.com/sagemath/sagenb/issues/465",
    "created_at": "2019-02-01T00:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407931",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:73" align="right">comment:73</div>

Replying to [@slel](#comment:72):
> Cc Dima Pasechnik about the sagenb question.

Thanks. This is now https://github.com/sagemath/sagenb/issues/465



---

archive/issue_comments_407932.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62b989d5ee1d9646db85ea56053cd22e9ffde5ab\"><code>62b989d</code></a></td><td><code>trac 26451: fix doctest in src/doc/common/conf.py</code></td></tr></table>\n",
    "created_at": "2019-02-01T18:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407932",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62b989d5ee1d9646db85ea56053cd22e9ffde5ab"><code>62b989d</code></a></td><td><code>trac 26451: fix doctest in src/doc/common/conf.py</code></td></tr></table>




---

archive/issue_comments_407933.json:
```json
{
    "body": "Changed commit from **[`a3ceda2`](https://github.com/sagemath/sagetrac-mirror/commit/a3ceda240bb3e8bbb840d8635e5a62dc240d858a)** to **[`62b989d`](https://github.com/sagemath/sagetrac-mirror/commit/62b989d5ee1d9646db85ea56053cd22e9ffde5ab)**",
    "created_at": "2019-02-01T18:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407933",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a3ceda2`](https://github.com/sagemath/sagetrac-mirror/commit/a3ceda240bb3e8bbb840d8635e5a62dc240d858a)** to **[`62b989d`](https://github.com/sagemath/sagetrac-mirror/commit/62b989d5ee1d9646db85ea56053cd22e9ffde5ab)**



---

archive/issue_comments_407934.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nThe SageNB problem should be fixed from their end, and here is a fix for the Sage doctest failure.",
    "created_at": "2019-02-01T18:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407934",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:75" align="right">comment:75</div>

The SageNB problem should be fixed from their end, and here is a fix for the Sage doctest failure.



---

archive/issue_comments_407935.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nReplying to [@jhpalmieri](#comment:75):\n> The SageNB problem should be fixed from their end, and here is a fix for the Sage doctest failure.\n\nIt is fixed now (the fix will be the next sagenb release).",
    "created_at": "2019-02-01T19:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407935",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:76" align="right">comment:76</div>

Replying to [@jhpalmieri](#comment:75):
> The SageNB problem should be fixed from their end, and here is a fix for the Sage doctest failure.

It is fixed now (the fix will be the next sagenb release).



---

archive/issue_comments_407936.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nOne annoying warning with this sphinx now:\n\n```\nsrc/sage_setup/docbuild/ext/sage_autodoc.py:1170: RemovedInSphinx20Warning: formatargspec() is now deprecated.  Please use sphinx.util.inspect.Signature \n```\n\n(and the same warning in `sage_autodoc.py:1072`)",
    "created_at": "2019-02-01T19:49:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407936",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:77" align="right">comment:77</div>

One annoying warning with this sphinx now:

```
src/sage_setup/docbuild/ext/sage_autodoc.py:1170: RemovedInSphinx20Warning: formatargspec() is now deprecated.  Please use sphinx.util.inspect.Signature 
```

(and the same warning in `sage_autodoc.py:1072`)



---

archive/issue_events_364458.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-01T19:49:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364458"
}
```



---

archive/issue_events_364459.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-01T19:49:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364459"
}
```



---

archive/issue_comments_407937.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nNoted in [comment:45](#comment:45). It's annoying but can we deal with it on another ticket?",
    "created_at": "2019-02-01T20:02:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407937",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:78" align="right">comment:78</div>

Noted in [comment:45](#comment:45). It's annoying but can we deal with it on another ticket?



---

archive/issue_comments_407938.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nIn particular, I don't know how to solve it. `Signature` does not seem to be just a drop-in replacement. We could just silence the warnings, but that's probably a bad idea.",
    "created_at": "2019-02-01T20:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407938",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:79" align="right">comment:79</div>

In particular, I don't know how to solve it. `Signature` does not seem to be just a drop-in replacement. We could just silence the warnings, but that's probably a bad idea.



---

archive/issue_comments_407939.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2019-02-01T20:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407939",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_407940.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nI agree, it needs a bit of coding (examples may be found by googling this warning...)\nA new ticket then. By the way, the sagenb update is on #27200.",
    "created_at": "2019-02-01T20:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407940",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:80" align="right">comment:80</div>

I agree, it needs a bit of coding (examples may be found by googling this warning...)
A new ticket then. By the way, the sagenb update is on #27200.



---

archive/issue_events_364460.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-01T20:30:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364460"
}
```



---

archive/issue_events_364461.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-01T20:30:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364461"
}
```



---

archive/issue_comments_407941.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nJeroen, do you agree with the positive review?",
    "created_at": "2019-02-01T21:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407941",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:81" align="right">comment:81</div>

Jeroen, do you agree with the positive review?



---

archive/issue_events_364462.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-02T07:53:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364462"
}
```



---

archive/issue_events_364463.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-02T07:53:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364463"
}
```



---

archive/issue_comments_407942.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nIs the `<BLANKLINE>` issue fixed?",
    "created_at": "2019-02-02T07:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407942",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:82" align="right">comment:82</div>

Is the `<BLANKLINE>` issue fixed?



---

archive/issue_comments_407943.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nto me, blankline is blankline, how to check this...",
    "created_at": "2019-02-02T08:03:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407943",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:83" align="right">comment:83</div>

to me, blankline is blankline, how to check this...



---

archive/issue_comments_407944.json:
```json
{
    "body": "Dependencies: **#27200**",
    "created_at": "2019-02-02T09:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407944",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#27200**



---

archive/issue_comments_407945.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nsome of the doctests here are fixed by #27200, adding as a dependency",
    "created_at": "2019-02-02T09:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407945",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:84" align="right">comment:84</div>

some of the doctests here are fixed by #27200, adding as a dependency



---

archive/issue_events_364464.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-02-02T17:54:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364464"
}
```



---

archive/issue_events_364465.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-02-02T17:54:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364465"
}
```



---

archive/issue_comments_407946.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nTwo problems:\n- The BLANKLINE problem is still there. For example, in `calculus/riemann.pyx`, a doctest for `complex_to_spiderweb` includes `<BLANKLINE>`. With the old Sphinx, this was printed as an actual blank line, while with the new one, it prints \"<BLANKLINE>\".\n- The real blocker: math is not rendered in the reference manual (although it is in the tutorial). Indeed, in the generated html files, these lines were included in the old Sphinx, but not in the new one. I don't know why, and I don't know if I have time figure it out right now:\n\n```\n    <script type=\"text/javascript\" src=\"../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js\"></script>\n    <script type=\"text/javascript\" src=\"../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js\"></script>\n```\nManually adding those lines fixes the problem, but they should be there automatically.",
    "created_at": "2019-02-02T17:54:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407946",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:85" align="right">comment:85</div>

Two problems:
- The BLANKLINE problem is still there. For example, in `calculus/riemann.pyx`, a doctest for `complex_to_spiderweb` includes `<BLANKLINE>`. With the old Sphinx, this was printed as an actual blank line, while with the new one, it prints "<BLANKLINE>".
- The real blocker: math is not rendered in the reference manual (although it is in the tutorial). Indeed, in the generated html files, these lines were included in the old Sphinx, but not in the new one. I don't know why, and I don't know if I have time figure it out right now:

```
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
```
Manually adding those lines fixes the problem, but they should be there automatically.



---

archive/issue_comments_407947.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nI tried to replace src/doc/common/themes/sageref with a symlink to src/doc/common/themes/sage, but this did not change the result (no TeX in reference manual).\n\nCould it be some special parallel hack that breaks it? I really have no idea.",
    "created_at": "2019-02-04T12:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407947",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:86" align="right">comment:86</div>

I tried to replace src/doc/common/themes/sageref with a symlink to src/doc/common/themes/sage, but this did not change the result (no TeX in reference manual).

Could it be some special parallel hack that breaks it? I really have no idea.



---

archive/issue_comments_407948.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nI think the issue is that in the new Sphinx, `sphinx.ext.mathjax` has the line\n\n```\n    app.connect('env-check-consistency', install_mathjax)\n```\nAs far as I can tell, this means that those lines should be produced when `self.env.check_consistency()` is run, but it doesn't get run during the reference/html build. I'm guessing this is because of our multidocs extension, or maybe the sage_autodoc extension.",
    "created_at": "2019-02-05T18:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407948",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:87" align="right">comment:87</div>

I think the issue is that in the new Sphinx, `sphinx.ext.mathjax` has the line

```
    app.connect('env-check-consistency', install_mathjax)
```
As far as I can tell, this means that those lines should be produced when `self.env.check_consistency()` is run, but it doesn't get run during the reference/html build. I'm guessing this is because of our multidocs extension, or maybe the sage_autodoc extension.



---

archive/issue_comments_407949.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nSphinx 1.8.4 was released and uploaded to PyPI on 2019-02-03.\n\n- **Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz",
    "created_at": "2019-02-14T14:14:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407949",
    "user": "https://github.com/slel"
}
```

<div id="comment:89" align="right">comment:89</div>

Sphinx 1.8.4 was released and uploaded to PyPI on 2019-02-03.

- **Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz



---

archive/issue_comments_407950.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nUnfortunately this doesn't help with the mathjax issue. I'm stuck, so I hope someone else has some ideas.",
    "created_at": "2019-02-14T16:03:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407950",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:90" align="right">comment:90</div>

Unfortunately this doesn't help with the mathjax issue. I'm stuck, so I hope someone else has some ideas.



---

archive/issue_comments_407951.json:
```json
{
    "body": "Changed commit from **[`62b989d`](https://github.com/sagemath/sagetrac-mirror/commit/62b989d5ee1d9646db85ea56053cd22e9ffde5ab)** to **[`d566fc9`](https://github.com/sagemath/sagetrac-mirror/commit/d566fc954df56bf61efab7eaf25d7ee87fee5f11)**",
    "created_at": "2019-02-19T22:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407951",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`62b989d`](https://github.com/sagemath/sagetrac-mirror/commit/62b989d5ee1d9646db85ea56053cd22e9ffde5ab)** to **[`d566fc9`](https://github.com/sagemath/sagetrac-mirror/commit/d566fc954df56bf61efab7eaf25d7ee87fee5f11)**



---

archive/issue_comments_407952.json:
```json
{
    "body": "<div id=\"comment:91\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc5d0abb172cdb75f3b13a76f8e80c3e8841ca48\"><code>bc5d0ab</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a55761e8c54a382f6a36475212ac98754c2f3e9\"><code>8a55761</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3b6076190ee56ad4d0425ae01994bd549d74ec8\"><code>d3b6076</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09a1415cd5bfd7c0d67551631a5ef6bf625ec5dd\"><code>09a1415</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ed8d9edc215961ad5989a0c10b4c84c84738a41\"><code>0ed8d9e</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/caef35123c420973199afeeb254b93e92de58ed7\"><code>caef351</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.4.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b93bc29f23061ce97c1172512c72ba35a39978b\"><code>0b93bc2</code></a></td><td><code>trac 26451: patch Sphinx so it recognizes \"sage:\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d566fc954df56bf61efab7eaf25d7ee87fee5f11\"><code>d566fc9</code></a></td><td><code>trac 26451: emit 'env-check-consistency' if not first pass building ref manual,</code></td></tr></table>\n",
    "created_at": "2019-02-19T22:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407952",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:91"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc5d0abb172cdb75f3b13a76f8e80c3e8841ca48"><code>bc5d0ab</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a55761e8c54a382f6a36475212ac98754c2f3e9"><code>8a55761</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3b6076190ee56ad4d0425ae01994bd549d74ec8"><code>d3b6076</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09a1415cd5bfd7c0d67551631a5ef6bf625ec5dd"><code>09a1415</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ed8d9edc215961ad5989a0c10b4c84c84738a41"><code>0ed8d9e</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/caef35123c420973199afeeb254b93e92de58ed7"><code>caef351</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.4.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b93bc29f23061ce97c1172512c72ba35a39978b"><code>0b93bc2</code></a></td><td><code>trac 26451: patch Sphinx so it recognizes "sage:"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d566fc954df56bf61efab7eaf25d7ee87fee5f11"><code>d566fc9</code></a></td><td><code>trac 26451: emit 'env-check-consistency' if not first pass building ref manual,</code></td></tr></table>




---

archive/issue_comments_407953.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nOkay, I've fixed the mathjax problem and the `<BLANKLINE>` problem. The second of these involves patching Sphinx, so if you don't want patches, you will get `<BLANKLINE>` in some doctest output, rather than an actual blank line. Sphinx still produces lots of `formatargspec() is now deprecated` warnings, but I suggest we deal with those in a separate ticket.\n\nOh, by the way, [Sphinx 2.0.0.beta1](https://github.com/sphinx-doc/sphinx/blob/v2.0.0b1/CHANGES) has been released. It drops Python 2.7 support, so it's not for us yet.",
    "created_at": "2019-02-19T22:51:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407953",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:92" align="right">comment:92</div>

Okay, I've fixed the mathjax problem and the `<BLANKLINE>` problem. The second of these involves patching Sphinx, so if you don't want patches, you will get `<BLANKLINE>` in some doctest output, rather than an actual blank line. Sphinx still produces lots of `formatargspec() is now deprecated` warnings, but I suggest we deal with those in a separate ticket.

Oh, by the way, [Sphinx 2.0.0.beta1](https://github.com/sphinx-doc/sphinx/blob/v2.0.0b1/CHANGES) has been released. It drops Python 2.7 support, so it's not for us yet.



---

archive/issue_events_364466.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-02-19T23:04:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364466"
}
```



---

archive/issue_events_364467.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-02-19T23:04:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364467"
}
```



---

archive/issue_comments_407954.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,4 @@\n ```\n coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.\n \n-**Tarball**: https://files.pythonhosted.org/packages/4d/ed/4595274b5c9ce53a768cc0804ef65fd6282c956b93919a969e98d53894e4/Sphinx-1.8.3.tar.gz\n+**Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz\n``````\n",
    "created_at": "2019-02-19T23:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407954",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,4 @@
 ```
 coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.
 
-**Tarball**: https://files.pythonhosted.org/packages/4d/ed/4595274b5c9ce53a768cc0804ef65fd6282c956b93919a969e98d53894e4/Sphinx-1.8.3.tar.gz
+**Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz
``````




---

archive/issue_events_364468.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-02-19T23:12:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "title_is": "Upgrade to Sphinx 1.8.4",
    "title_was": "Upgrade to Sphinx 1.8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364468"
}
```



---

archive/issue_comments_407955.json:
```json
{
    "body": "Changed keywords from **sphinx, conda** to **sphinx, conda, upgrade**",
    "created_at": "2019-02-19T23:12:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407955",
    "user": "https://github.com/slel"
}
```

Changed keywords from **sphinx, conda** to **sphinx, conda, upgrade**



---

archive/issue_comments_407956.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This ticket is to upgrade to Sphinx 1.8.2.\n+This ticket is to upgrade to Sphinx 1.8.4.\n \n Our previous upgrade was to Sphinx 1.7.6 in #26033.\n \n@@ -7,6 +7,7 @@\n ```\n ApplicationError: Source directory and destination directory cannot be identical\n ```\n-coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.\n+coming out of Sphinx in conda as they have changed the argument checking\n+of the `Sphinx()` constructor it seems.\n \n **Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz\n``````\n",
    "created_at": "2019-02-19T23:12:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407956",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This ticket is to upgrade to Sphinx 1.8.2.
+This ticket is to upgrade to Sphinx 1.8.4.
 
 Our previous upgrade was to Sphinx 1.7.6 in #26033.
 
@@ -7,6 +7,7 @@
 ```
 ApplicationError: Source directory and destination directory cannot be identical
 ```
-coming out of Sphinx in conda as they have changed the argument checking of the `Sphinx()` constructor it seems.
+coming out of Sphinx in conda as they have changed the argument checking
+of the `Sphinx()` constructor it seems.
 
 **Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz
``````




---

archive/issue_comments_407957.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nIf all else fails, we can just silence those deprecation warnings the same way we silence lots of other \"chatter\" in the Sphinx build. See `sage_setup/docbuild/sphinxbuild.py`.",
    "created_at": "2019-02-19T23:13:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407957",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:95" align="right">comment:95</div>

If all else fails, we can just silence those deprecation warnings the same way we silence lots of other "chatter" in the Sphinx build. See `sage_setup/docbuild/sphinxbuild.py`.



---

archive/issue_comments_407958.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nWhy wasn't the `sage:` prompt patch necessary before?\n\nOn nixos with this patch applied I get some kind of unicode issue (not sure if its 100% reproducible; I think I've seen it working some time):\n\n```\nsage -t docsrc/common/conf.py\n**********************************************************************\nFile \"docsrc/common/conf.py\", line 614, in common.conf.call_intersphinx\nFailed example:\n    for line in open(thematic_index).readlines():  # optional - dochtml\n        if \"padics\" in line:\n            sys.stdout.write(line)\nExpected:\n    <li><a class=\"reference external\" href=\"../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial\" title=\"(i\nn Sage Reference Manual: p-Adics v...)\"><span>Introduction to the p-adics</span></a></li>\nGot:\n    <li><a class=\"reference external\" href=\"../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial\" title=\"(\u0432\n Sage Reference Manual: p-Adics v8.6)\"><span>Introduction to the p-adics</span></a></li>\n**********************************************************************\n1 item had failures:\n   1 of   4 in common.conf.call_intersphinx\n    [3 tests, 1 failure, 0.01 s]\n```\n\nI don't know if this has to do with some different dependency on nix or if it could also happen on sage-the-distro.",
    "created_at": "2019-02-20T14:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407958",
    "user": "https://github.com/timokau"
}
```

<div id="comment:96" align="right">comment:96</div>

Why wasn't the `sage:` prompt patch necessary before?

On nixos with this patch applied I get some kind of unicode issue (not sure if its 100% reproducible; I think I've seen it working some time):

```
sage -t docsrc/common/conf.py
**********************************************************************
File "docsrc/common/conf.py", line 614, in common.conf.call_intersphinx
Failed example:
    for line in open(thematic_index).readlines():  # optional - dochtml
        if "padics" in line:
            sys.stdout.write(line)
Expected:
    <li><a class="reference external" href="../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial" title="(i
n Sage Reference Manual: p-Adics v...)"><span>Introduction to the p-adics</span></a></li>
Got:
    <li><a class="reference external" href="../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial" title="(в
 Sage Reference Manual: p-Adics v8.6)"><span>Introduction to the p-adics</span></a></li>
**********************************************************************
1 item had failures:
   1 of   4 in common.conf.call_intersphinx
    [3 tests, 1 failure, 0.01 s]
```

I don't know if this has to do with some different dependency on nix or if it could also happen on sage-the-distro.



---

archive/issue_comments_407959.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nReplying to [@timokau](#comment:96):\n> Why wasn't the `sage:` prompt patch necessary before?\n\nBecause the file being patched didn't exist before.\n\n> On nixos with this patch applied I get some kind of unicode issue (not sure if its 100% reproducible; I think I've seen it working some time):\n> \n> ```\n> sage -t docsrc/common/conf.py\n> **********************************************************************\n> File \"docsrc/common/conf.py\", line 614, in common.conf.call_intersphinx\n> Failed example:\n>     for line in open(thematic_index).readlines():  # optional - dochtml\n>         if \"padics\" in line:\n>             sys.stdout.write(line)\n> Expected:\n>     <li><a class=\"reference external\" href=\"../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial\" title=\"(i\n> n Sage Reference Manual: p-Adics v...)\"><span>Introduction to the p-adics</span></a></li>\n> Got:\n>     <li><a class=\"reference external\" href=\"../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial\" title=\"(\u0432\n>  Sage Reference Manual: p-Adics v8.6)\"><span>Introduction to the p-adics</span></a></li>\n> **********************************************************************\n> 1 item had failures:\n>    1 of   4 in common.conf.call_intersphinx\n>     [3 tests, 1 failure, 0.01 s]\n> ```\n> \n> I don't know if this has to do with some different dependency on nix or if it could also happen on sage-the-distro.\n\nI don't see this with sage-the-distro. The file `doc/common/conf.py` had its doctests changed recently in another ticket (to fix Python 3 issues, I think). This branch doesn't touch that file, and I don't see why it would be related.",
    "created_at": "2019-02-20T16:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407959",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:97" align="right">comment:97</div>

Replying to [@timokau](#comment:96):
> Why wasn't the `sage:` prompt patch necessary before?

Because the file being patched didn't exist before.

> On nixos with this patch applied I get some kind of unicode issue (not sure if its 100% reproducible; I think I've seen it working some time):
> 
> ```
> sage -t docsrc/common/conf.py
> **********************************************************************
> File "docsrc/common/conf.py", line 614, in common.conf.call_intersphinx
> Failed example:
>     for line in open(thematic_index).readlines():  # optional - dochtml
>         if "padics" in line:
>             sys.stdout.write(line)
> Expected:
>     <li><a class="reference external" href="../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial" title="(i
> n Sage Reference Manual: p-Adics v...)"><span>Introduction to the p-adics</span></a></li>
> Got:
>     <li><a class="reference external" href="../reference/padics/sage/rings/padics/tutorial.html#sage-rings-padics-tutorial" title="(в
>  Sage Reference Manual: p-Adics v8.6)"><span>Introduction to the p-adics</span></a></li>
> **********************************************************************
> 1 item had failures:
>    1 of   4 in common.conf.call_intersphinx
>     [3 tests, 1 failure, 0.01 s]
> ```
> 
> I don't know if this has to do with some different dependency on nix or if it could also happen on sage-the-distro.

I don't see this with sage-the-distro. The file `doc/common/conf.py` had its doctests changed recently in another ticket (to fix Python 3 issues, I think). This branch doesn't touch that file, and I don't see why it would be related.



---

archive/issue_comments_407960.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@jhpalmieri](#comment:92):\n> Okay, I've fixed the mathjax problem and the `<BLANKLINE>` problem. The second of these involves patching Sphinx, so if you don't want patches, you will get `<BLANKLINE>` in some doctest output, rather than an actual blank line.\n\nInstead of adding this very sage specific patch to sphinx, why not do this in a sphinx extension?\n\nLike this:\n\n```\n--- a/src/doc/common/conf.py\n+++ b/src/doc/common/conf.py\n@@ -13,7 +13,7 @@\n \n # Add any Sphinx extension module names here, as strings. They can be extensions\n # coming with Sphinx (named 'sphinx.ext.*') or your custom ones.\n-extensions = ['inventory_builder', 'multidocs',\n+extensions = ['inventory_builder', 'multidocs', 'trim_doctest_flags',\n               'sage_autodoc',  'sphinx.ext.graphviz',\n               'sphinx.ext.inheritance_diagram', 'sphinx.ext.todo',\n               'sphinx.ext.extlinks', 'matplotlib.sphinxext.plot_directive']\n--- /dev/null\n+++ b/src/sage_setup/docbuild/ext/trim_doctest_flags.py\n@@ -0,0 +1,67 @@\n+\"\"\"\n+    trim doctest flags\n+    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+    transforms for code-blocks.\n+\n+    modified from sphinx.transforms.post_transforms.code\n+\n+    :copyright: Copyright 2007-2019 by the Sphinx team, see AUTHORS.\n+    :license: BSD, see LICENSE for details.\n+\"\"\"\n+\n+import sys\n+from typing import NamedTuple\n+\n+from docutils import nodes\n+from pygments.lexers import PythonConsoleLexer, guess_lexer\n+\n+from sphinx import addnodes\n+from sphinx.ext import doctest\n+from sphinx.transforms import SphinxTransform\n+\n+class TrimDoctestFlagsTransformSage(SphinxTransform):\n+    \"\"\"\n+    Trim doctest flags like ``# doctest: +FLAG`` from sage code-blocks.\n+\n+    The only difference from Sphinx' TrimDoctestFlagsTransform is that\n+    here lines starting with 'sage:' rather than '>>>' are transformed.\n+    \"\"\"\n+    default_priority = 401\n+\n+    def apply(self, **kwargs):\n+        # type: (Any) -> None\n+        if not self.config.trim_doctest_flags:\n+            return\n+\n+        for node in self.document.traverse(nodes.literal_block):\n+            if self.is_pyconsole(node):\n+                source = node.rawsource\n+                source = doctest.blankline_re.sub('', source)\n+                source = doctest.doctestopt_re.sub('', source)\n+                node.rawsource = source\n+                node[:] = [nodes.Text(source)]\n+\n+    @staticmethod\n+    def is_pyconsole(node):\n+        # type: (nodes.literal_block) -> bool\n+        if node.rawsource != node.astext():\n+            return False  # skip parsed-literal node\n+\n+        language = node.get('language')\n+        if language in ('pycon', 'pycon3'):\n+            return True\n+        elif language in ('py', 'py3', 'python', 'python3', 'default'):\n+            return node.rawsource.startswith('sage:')\n+        elif language == 'guess':\n+            try:\n+                lexer = guess_lexer(node.rawsource)\n+                return isinstance(lexer, PythonConsoleLexer)\n+            except Exception:\n+                pass\n+\n+        return False\n+\n+\n+def setup(app):\n+    app.add_post_transform(TrimDoctestFlagsTransformSage)\n```\n\nhttps://salsa.debian.org/science-team/sagemath/blob/master/debian/patches/u1-sphinx-1.8-doctest-transform.patch",
    "created_at": "2019-02-24T14:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407960",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@jhpalmieri](#comment:92):
> Okay, I've fixed the mathjax problem and the `<BLANKLINE>` problem. The second of these involves patching Sphinx, so if you don't want patches, you will get `<BLANKLINE>` in some doctest output, rather than an actual blank line.

Instead of adding this very sage specific patch to sphinx, why not do this in a sphinx extension?

Like this:

```
--- a/src/doc/common/conf.py
+++ b/src/doc/common/conf.py
@@ -13,7 +13,7 @@
 
 # Add any Sphinx extension module names here, as strings. They can be extensions
 # coming with Sphinx (named 'sphinx.ext.*') or your custom ones.
-extensions = ['inventory_builder', 'multidocs',
+extensions = ['inventory_builder', 'multidocs', 'trim_doctest_flags',
               'sage_autodoc',  'sphinx.ext.graphviz',
               'sphinx.ext.inheritance_diagram', 'sphinx.ext.todo',
               'sphinx.ext.extlinks', 'matplotlib.sphinxext.plot_directive']
--- /dev/null
+++ b/src/sage_setup/docbuild/ext/trim_doctest_flags.py
@@ -0,0 +1,67 @@
+"""
+    trim doctest flags
+    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+    transforms for code-blocks.
+
+    modified from sphinx.transforms.post_transforms.code
+
+    :copyright: Copyright 2007-2019 by the Sphinx team, see AUTHORS.
+    :license: BSD, see LICENSE for details.
+"""
+
+import sys
+from typing import NamedTuple
+
+from docutils import nodes
+from pygments.lexers import PythonConsoleLexer, guess_lexer
+
+from sphinx import addnodes
+from sphinx.ext import doctest
+from sphinx.transforms import SphinxTransform
+
+class TrimDoctestFlagsTransformSage(SphinxTransform):
+    """
+    Trim doctest flags like ``# doctest: +FLAG`` from sage code-blocks.
+
+    The only difference from Sphinx' TrimDoctestFlagsTransform is that
+    here lines starting with 'sage:' rather than '>>>' are transformed.
+    """
+    default_priority = 401
+
+    def apply(self, **kwargs):
+        # type: (Any) -> None
+        if not self.config.trim_doctest_flags:
+            return
+
+        for node in self.document.traverse(nodes.literal_block):
+            if self.is_pyconsole(node):
+                source = node.rawsource
+                source = doctest.blankline_re.sub('', source)
+                source = doctest.doctestopt_re.sub('', source)
+                node.rawsource = source
+                node[:] = [nodes.Text(source)]
+
+    @staticmethod
+    def is_pyconsole(node):
+        # type: (nodes.literal_block) -> bool
+        if node.rawsource != node.astext():
+            return False  # skip parsed-literal node
+
+        language = node.get('language')
+        if language in ('pycon', 'pycon3'):
+            return True
+        elif language in ('py', 'py3', 'python', 'python3', 'default'):
+            return node.rawsource.startswith('sage:')
+        elif language == 'guess':
+            try:
+                lexer = guess_lexer(node.rawsource)
+                return isinstance(lexer, PythonConsoleLexer)
+            except Exception:
+                pass
+
+        return False
+
+
+def setup(app):
+    app.add_post_transform(TrimDoctestFlagsTransformSage)
```

https://salsa.debian.org/science-team/sagemath/blob/master/debian/patches/u1-sphinx-1.8-doctest-transform.patch



---

archive/issue_comments_407961.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nThere is a balance to be struck: we're more or less forking Sphinx with extensions like this, so they require maintenance: as Sphinx changes, so should the extension. This recently required a fair amount of work for Sage's autodoc extension (#26949).\n\nSo is it better to patch Sphinx or create an extension?",
    "created_at": "2019-02-24T16:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407961",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:99" align="right">comment:99</div>

There is a balance to be struck: we're more or less forking Sphinx with extensions like this, so they require maintenance: as Sphinx changes, so should the extension. This recently required a fair amount of work for Sage's autodoc extension (#26949).

So is it better to patch Sphinx or create an extension?



---

archive/issue_comments_407962.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nAny more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?",
    "created_at": "2019-03-07T04:15:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407962",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:0" align="right">comment:0</div>

Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?



---

archive/issue_comments_407963.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nReplying to [@jhpalmieri](#comment:100):\n> Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?\n\nI already implemented it and posted the patch here. Is there something wrong with it?",
    "created_at": "2019-03-07T09:32:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407963",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:101" align="right">comment:101</div>

Replying to [@jhpalmieri](#comment:100):
> Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?

I already implemented it and posted the patch here. Is there something wrong with it?



---

archive/issue_comments_407964.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nReplying to [@tobihan](#comment:101):\n> Replying to [@jhpalmieri](#comment:100):\n> > Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?\n\n> \n> I already implemented it and posted the patch here. Is there something wrong with it?\n\nCare to propose a full branch? (So that it's 100% clear what the solution is)",
    "created_at": "2019-03-07T12:12:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407964",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:102" align="right">comment:102</div>

Replying to [@tobihan](#comment:101):
> Replying to [@jhpalmieri](#comment:100):
> > Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?

> 
> I already implemented it and posted the patch here. Is there something wrong with it?

Care to propose a full branch? (So that it's 100% clear what the solution is)



---

archive/issue_comments_407965.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nReplying to [@tobihan](#comment:101):\n> Replying to [@jhpalmieri](#comment:100):\n> > Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?\n\n> \n> I already implemented it and posted the patch here. Is there something wrong with it?\n\nNot necessarily, but I did respond and ask a question about the philosophy of patches vs. extensions. I was hoping for a discussion.",
    "created_at": "2019-03-07T16:03:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407965",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:103" align="right">comment:103</div>

Replying to [@tobihan](#comment:101):
> Replying to [@jhpalmieri](#comment:100):
> > Any more comments on this? If people who deal with distributions feel that using a Sphinx extension would be better than a patch, then please go ahead and implement that. If people feel that patching is better, then what else needs to be done?

> 
> I already implemented it and posted the patch here. Is there something wrong with it?

Not necessarily, but I did respond and ask a question about the philosophy of patches vs. extensions. I was hoping for a discussion.



---

archive/issue_comments_407966.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nFrom a packagers standpoint the extension is clearly better. Since the sphinx patch does not make much sense for us we would probably have to keep patching in the extension anyway. But I thought that was obvious and you were asking for opinions of sage developers.",
    "created_at": "2019-03-07T16:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407966",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:4" align="right">comment:4</div>

From a packagers standpoint the extension is clearly better. Since the sphinx patch does not make much sense for us we would probably have to keep patching in the extension anyway. But I thought that was obvious and you were asking for opinions of sage developers.



---

archive/issue_comments_407967.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nFrom developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...",
    "created_at": "2019-03-15T16:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407967",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...



---

archive/issue_comments_407968.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nReplying to [@dimpase](#comment:105):\n> From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...\n\nOk, here is a branch:\nhttps://github.com/sagemath/sagetrac-mirror/commits/u/thansen/26451",
    "created_at": "2019-03-17T13:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407968",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:106" align="right">comment:106</div>

Replying to [@dimpase](#comment:105):
> From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...

Ok, here is a branch:
https://github.com/sagemath/sagetrac-mirror/commits/u/thansen/26451



---

archive/issue_comments_407969.json:
```json
{
    "body": "<div id=\"comment:107\" align=\"right\">comment:107</div>\n\nReplying to [@tobihan](#comment:106):\n> Replying to [@dimpase](#comment:105):\n> > From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...\n\n> \n> Ok, here is a branch:\n> https://github.com/sagemath/sagetrac-mirror/commits/u/thansen/26451\n\nClarification. I am assuming this needs to be applied on top of the current branch already in this ticket. Right?",
    "created_at": "2019-03-17T21:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407969",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:107" align="right">comment:107</div>

Replying to [@tobihan](#comment:106):
> Replying to [@dimpase](#comment:105):
> > From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...

> 
> Ok, here is a branch:
> https://github.com/sagemath/sagetrac-mirror/commits/u/thansen/26451

Clarification. I am assuming this needs to be applied on top of the current branch already in this ticket. Right?



---

archive/issue_comments_407970.json:
```json
{
    "body": "<div id=\"comment:108\" align=\"right\">comment:108</div>\n\nReplying to [@kiwifb](#comment:107):\n> Replying to [@tobihan](#comment:106):\n> > Replying to [@dimpase](#comment:105):\n> > > From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...\n\n> > \n> > Ok, here is a branch:\n> > https://github.com/sagemath/sagetrac-mirror/commits/u/thansen/26451\n\n> \n> Clarification. I am assuming this needs to be applied on top of the current branch already in this ticket. Right?\n\nNo, this is just the branch of this ticket with John's fix for the <BLANKLINE> issue removed and my patch applied.",
    "created_at": "2019-03-17T23:38:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407970",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:108" align="right">comment:108</div>

Replying to [@kiwifb](#comment:107):
> Replying to [@tobihan](#comment:106):
> > Replying to [@dimpase](#comment:105):
> > > From developers point of view, we appreciate your efforts a lot --- although  we'd much prefer a branch with your solution to a link to Debian patches, from which one sometimes might need to do reverse engineering to get what's needed and works in Sage sans Debian...

> > 
> > Ok, here is a branch:
> > https://github.com/sagemath/sagetrac-mirror/commits/u/thansen/26451

> 
> Clarification. I am assuming this needs to be applied on top of the current branch already in this ticket. Right?

No, this is just the branch of this ticket with John's fix for the <BLANKLINE> issue removed and my patch applied.



---

archive/issue_comments_407971.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSo, building reference manual, mathjax works on u/thansen/26451",
    "created_at": "2019-03-17T23:46:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407971",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

So, building reference manual, mathjax works on u/thansen/26451



---

archive/issue_comments_407972.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\nReplying to [@dimpase](#comment:109):\n> So, building reference manual, mathjax works on u/thansen/26451\n\nThe thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.",
    "created_at": "2019-03-17T23:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407972",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:110" align="right">comment:110</div>

Replying to [@dimpase](#comment:109):
> So, building reference manual, mathjax works on u/thansen/26451

The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.



---

archive/issue_comments_407973.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\nReplying to [@tobihan](#comment:110):\n> Replying to [@dimpase](#comment:109):\n> > So, building reference manual, mathjax works on u/thansen/26451\n\n> \n> The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.\n\nSorry, I got lost here. Is `u/thansen/26451` a complete branch? If so, please put it into the Branch field of the ticket, and add your name to the list of authors.",
    "created_at": "2019-03-18T09:30:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407973",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:111" align="right">comment:111</div>

Replying to [@tobihan](#comment:110):
> Replying to [@dimpase](#comment:109):
> > So, building reference manual, mathjax works on u/thansen/26451

> 
> The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.

Sorry, I got lost here. Is `u/thansen/26451` a complete branch? If so, please put it into the Branch field of the ticket, and add your name to the list of authors.



---

archive/issue_comments_407974.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nReplying to [@dimpase](#comment:111):\n> Replying to [@tobihan](#comment:110):\n> > Replying to [@dimpase](#comment:109):\n> > > So, building reference manual, mathjax works on u/thansen/26451\n\n> > \n> > The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.\n\n> \n> Sorry, I got lost here. Is `u/thansen/26451` a complete branch? If so, please put it into the Branch field of the ticket, and add your name to the list of authors.\n\nThat's why I asked the question earlier. I was going to do just that on thansen's behalf, but when I clicked on the link I could only see one commit. Now that may just have been the way I navigated there, that's why I asked.",
    "created_at": "2019-03-18T09:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407974",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:112" align="right">comment:112</div>

Replying to [@dimpase](#comment:111):
> Replying to [@tobihan](#comment:110):
> > Replying to [@dimpase](#comment:109):
> > > So, building reference manual, mathjax works on u/thansen/26451

> > 
> > The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.

> 
> Sorry, I got lost here. Is `u/thansen/26451` a complete branch? If so, please put it into the Branch field of the ticket, and add your name to the list of authors.

That's why I asked the question earlier. I was going to do just that on thansen's behalf, but when I clicked on the link I could only see one commit. Now that may just have been the way I navigated there, that's why I asked.



---

archive/issue_comments_407975.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">comment:113</div>\n\nReplying to [@dimpase](#comment:111):\n> Replying to [@tobihan](#comment:110):\n> > Replying to [@dimpase](#comment:109):\n> > > So, building reference manual, mathjax works on u/thansen/26451\n\n> > \n> > The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.\n\n> \n> Sorry, I got lost here. Is `u/thansen/26451` a complete branch? If so, please put it into the Branch field of the ticket, and add your name to the list of authors.\n\nYes, it's a complete branch. I didn't put it in the branch field of the ticket because this is John's ticket and he never said we should use my fix instead of his.",
    "created_at": "2019-03-18T10:02:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407975",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:113" align="right">comment:113</div>

Replying to [@dimpase](#comment:111):
> Replying to [@tobihan](#comment:110):
> > Replying to [@dimpase](#comment:109):
> > > So, building reference manual, mathjax works on u/thansen/26451

> > 
> > The thing I changed has nothing to do with mathjax, it's a different fix for the <BLANKLINE> issue.

> 
> Sorry, I got lost here. Is `u/thansen/26451` a complete branch? If so, please put it into the Branch field of the ticket, and add your name to the list of authors.

Yes, it's a complete branch. I didn't put it in the branch field of the ticket because this is John's ticket and he never said we should use my fix instead of his.



---

archive/issue_comments_407976.json:
```json
{
    "body": "Changed author from **Julian R\u00fcth, Jeroen Demeyer, John Palmieri** to **Julian R\u00fcth, Jeroen Demeyer, John Palmieri, Tobias Hansen**",
    "created_at": "2019-03-18T10:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407976",
    "user": "https://github.com/dimpase"
}
```

Changed author from **Julian Rüth, Jeroen Demeyer, John Palmieri** to **Julian Rüth, Jeroen Demeyer, John Palmieri, Tobias Hansen**



---

archive/issue_comments_407977.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIMHO John won't mind---in fact he appears to have said OK to this on [comment:101](#comment:101). (John, please shout if I am wrong).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dca2e53c28a14edfb0c41e24deb6a5d986512bd2\"><code>dca2e53</code></a></td><td><code>trac 26451: emit 'env-check-consistency' if not first pass building ref manual,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c17bbf83d2cdf7d748fd9fa4d3b10348bce3ed27\"><code>c17bbf8</code></a></td><td><code>trac 26451: Add sphinx extension to modify lines in codeblocks starting with 'sage:'</code></td></tr></table>\n",
    "created_at": "2019-03-18T10:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407977",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

IMHO John won't mind---in fact he appears to have said OK to this on [comment:101](#comment:101). (John, please shout if I am wrong).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dca2e53c28a14edfb0c41e24deb6a5d986512bd2"><code>dca2e53</code></a></td><td><code>trac 26451: emit 'env-check-consistency' if not first pass building ref manual,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c17bbf83d2cdf7d748fd9fa4d3b10348bce3ed27"><code>c17bbf8</code></a></td><td><code>trac 26451: Add sphinx extension to modify lines in codeblocks starting with 'sage:'</code></td></tr></table>




---

archive/issue_comments_407978.json:
```json
{
    "body": "Changed commit from **[`d566fc9`](https://github.com/sagemath/sagetrac-mirror/commit/d566fc954df56bf61efab7eaf25d7ee87fee5f11)** to **[`c17bbf8`](https://github.com/sagemath/sagetrac-mirror/commit/c17bbf83d2cdf7d748fd9fa4d3b10348bce3ed27)**",
    "created_at": "2019-03-18T10:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407978",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`d566fc9`](https://github.com/sagemath/sagetrac-mirror/commit/d566fc954df56bf61efab7eaf25d7ee87fee5f11)** to **[`c17bbf8`](https://github.com/sagemath/sagetrac-mirror/commit/c17bbf83d2cdf7d748fd9fa4d3b10348bce3ed27)**



---

archive/issue_comments_407979.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)** to **[u/thansen/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/thansen/26451)**",
    "created_at": "2019-03-18T10:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407979",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)** to **[u/thansen/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/thansen/26451)**



---

archive/issue_comments_407980.json:
```json
{
    "body": "Changed dependencies from **#27200** to none",
    "created_at": "2019-03-18T10:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407980",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27200** to none



---

archive/issue_comments_407981.json:
```json
{
    "body": "Changed branch from **[u/thansen/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/thansen/26451)** to **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)**",
    "created_at": "2019-03-22T03:09:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407981",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/thansen/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/thansen/26451)** to **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)**



---

archive/issue_comments_407982.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHere is a different approach for the `<BLANKLINE>` problem, as suggested [on Sphinx's github page](https://github.com/sphinx-doc/sphinx/issues/6188). I've added a dependency, #27528, which also removes `highlighting.patch`. It is necessary here because it suppresses some warnings which are produced by `SageMathTransform`.\n\nIf this is acceptable, we should probably squash some commits: we don't need to create `trim_doctest_flags.py` and then delete it.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea8430971336174dabb9511b9360a242e3475155\"><code>ea84309</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f93af9335c4e1204a3a56311ee0cd4e583c5f184\"><code>f93af93</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d559c8839cb1ca935bd26400ff4aa647bf46ae03\"><code>d559c88</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e91297450b9aace4c41501d168b30b7b19f38cbc\"><code>e912974</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89332f44bbdfa0f0a593cf517fa225b9048c21c9\"><code>89332f4</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35e7862dfdac5bf1fc25e9dcb35ff105970df773\"><code>35e7862</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.4.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b96fa8057e69c162a2c94778f9ca72cb3cc223e\"><code>3b96fa8</code></a></td><td><code>trac 26451: emit 'env-check-consistency' if not first pass building ref manual,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/550e46933210efbe2c18f81051e3dc32740122f7\"><code>550e469</code></a></td><td><code>trac 26451: Add sphinx extension to modify lines in codeblocks starting with 'sage:'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0dfcab9dfbc4d403c77cf058df1ef0502d0b2eff\"><code>0dfcab9</code></a></td><td><code>trac 26451: use a Sphinx transform module to deal with <BLANKLINE></code></td></tr></table>\n",
    "created_at": "2019-03-22T03:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407982",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

Here is a different approach for the `<BLANKLINE>` problem, as suggested [on Sphinx's github page](https://github.com/sphinx-doc/sphinx/issues/6188). I've added a dependency, #27528, which also removes `highlighting.patch`. It is necessary here because it suppresses some warnings which are produced by `SageMathTransform`.

If this is acceptable, we should probably squash some commits: we don't need to create `trim_doctest_flags.py` and then delete it.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea8430971336174dabb9511b9360a242e3475155"><code>ea84309</code></a></td><td><code>Upgrade to Sphinx 1.8.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f93af9335c4e1204a3a56311ee0cd4e583c5f184"><code>f93af93</code></a></td><td><code>Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d559c8839cb1ca935bd26400ff4aa647bf46ae03"><code>d559c88</code></a></td><td><code>trac 26451: Sphinx 1.8.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e91297450b9aace4c41501d168b30b7b19f38cbc"><code>e912974</code></a></td><td><code>trac 26461: inventory builder: remove _static directory upon cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89332f44bbdfa0f0a593cf517fa225b9048c21c9"><code>89332f4</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35e7862dfdac5bf1fc25e9dcb35ff105970df773"><code>35e7862</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.4.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b96fa8057e69c162a2c94778f9ca72cb3cc223e"><code>3b96fa8</code></a></td><td><code>trac 26451: emit 'env-check-consistency' if not first pass building ref manual,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/550e46933210efbe2c18f81051e3dc32740122f7"><code>550e469</code></a></td><td><code>trac 26451: Add sphinx extension to modify lines in codeblocks starting with 'sage:'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0dfcab9dfbc4d403c77cf058df1ef0502d0b2eff"><code>0dfcab9</code></a></td><td><code>trac 26451: use a Sphinx transform module to deal with <BLANKLINE></code></td></tr></table>




---

archive/issue_comments_407983.json:
```json
{
    "body": "Changed commit from **[`c17bbf8`](https://github.com/sagemath/sagetrac-mirror/commit/c17bbf83d2cdf7d748fd9fa4d3b10348bce3ed27)** to **[`0dfcab9`](https://github.com/sagemath/sagetrac-mirror/commit/0dfcab9dfbc4d403c77cf058df1ef0502d0b2eff)**",
    "created_at": "2019-03-22T03:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407983",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`c17bbf8`](https://github.com/sagemath/sagetrac-mirror/commit/c17bbf83d2cdf7d748fd9fa4d3b10348bce3ed27)** to **[`0dfcab9`](https://github.com/sagemath/sagetrac-mirror/commit/0dfcab9dfbc4d403c77cf058df1ef0502d0b2eff)**



---

archive/issue_comments_407984.json:
```json
{
    "body": "Dependencies: **#27528**",
    "created_at": "2019-03-22T03:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407984",
    "user": "https://github.com/jhpalmieri"
}
```

Dependencies: **#27528**



---

archive/issue_comments_407985.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWith this branch on top of 8.7 and sphinx 1.8.5 I'm getting:\n\n```\nProcess Process-79:\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/multiprocessing/process.py\", line 267, in _bootstrap\n    self.run()\n  File \"/usr/lib/python2.7/multiprocessing/process.py\", line 114, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 79, in build_ref_doc\n    getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 763, in _wrapper\n    getattr(DocBuilder, build_type)(self, *args, **kwds)\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 135, in f\n    runsphinx()\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py\", line 314, in runsphinx\n    sys.stderr.raise_errors()\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py\", line 249, in raise_errors\n    raise OSError(self._error)\nOSError: /build/sagemath-doc/src/sage-8.7/src/doc/en/reference/combinat/sage/combinat/shifted_primed_tableau.rst:267: WARNING: Could not lex literal_block as \"pycon\". Highlighting skipped.\nError building the documentation.\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/build/sagemath-doc/src/sage-8.7/src/sage_setup/docbuild/__main__.py\", line 2, in <module>\n    main()\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 1732, in main\n    builder()\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 358, in _wrapper\n    getattr(get_builder(document), name)(*args, **kwds)\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 549, in _wrapper\n    build_many(build_ref_doc, L)\n  File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/utils.py\", line 214, in _build_many\n    raise worker_exc\nWorkerDiedException: worker for ('reference/combinat', 'en', 'html', {}) died with non-zero exit code 1\n\n    Note: incremental documentation builds sometimes cause spurious\n    error messages. To be certain that these are real errors, run\n    \"make doc-clean\" first and try again.\n```",
    "created_at": "2019-03-24T12:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407985",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:7" align="right">comment:7</div>

With this branch on top of 8.7 and sphinx 1.8.5 I'm getting:

```
Process Process-79:
Traceback (most recent call last):
  File "/usr/lib/python2.7/multiprocessing/process.py", line 267, in _bootstrap
    self.run()
  File "/usr/lib/python2.7/multiprocessing/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 79, in build_ref_doc
    getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 763, in _wrapper
    getattr(DocBuilder, build_type)(self, *args, **kwds)
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 135, in f
    runsphinx()
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py", line 314, in runsphinx
    sys.stderr.raise_errors()
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py", line 249, in raise_errors
    raise OSError(self._error)
OSError: /build/sagemath-doc/src/sage-8.7/src/doc/en/reference/combinat/sage/combinat/shifted_primed_tableau.rst:267: WARNING: Could not lex literal_block as "pycon". Highlighting skipped.
Error building the documentation.
Traceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 174, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/build/sagemath-doc/src/sage-8.7/src/sage_setup/docbuild/__main__.py", line 2, in <module>
    main()
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 1732, in main
    builder()
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 358, in _wrapper
    getattr(get_builder(document), name)(*args, **kwds)
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 549, in _wrapper
    build_many(build_ref_doc, L)
  File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/utils.py", line 214, in _build_many
    raise worker_exc
WorkerDiedException: worker for ('reference/combinat', 'en', 'html', {}) died with non-zero exit code 1

    Note: incremental documentation builds sometimes cause spurious
    error messages. To be certain that these are real errors, run
    "make doc-clean" first and try again.
```



---

archive/issue_comments_407986.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSphinx 1.8.5 was released on PyPI on 2019-03-10, and Sphinx 2.0.0b2 on 2019-03-20. See\n\n- https://pypi.org/project/Sphinx/#history",
    "created_at": "2019-03-24T14:13:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407986",
    "user": "https://github.com/slel"
}
```

<div id="comment:8" align="right">comment:8</div>

Sphinx 1.8.5 was released on PyPI on 2019-03-10, and Sphinx 2.0.0b2 on 2019-03-20. See

- https://pypi.org/project/Sphinx/#history



---

archive/issue_comments_407987.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI believe that Sphinx 2.0.0b2 is dropping support for Python 2.7, so we can't use that. I'll look at 1.8.5.",
    "created_at": "2019-03-24T18:23:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407987",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

I believe that Sphinx 2.0.0b2 is dropping support for Python 2.7, so we can't use that. I'll look at 1.8.5.



---

archive/issue_comments_407988.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nReplying to [@antonio-rojas](#comment:117):\n> With this branch on top of 8.7 and sphinx 1.8.5 I'm getting:\n> \n> ```\n> Process Process-79:\n> Traceback (most recent call last):\n>   File \"/usr/lib/python2.7/multiprocessing/process.py\", line 267, in _bootstrap\n>     self.run()\n>   File \"/usr/lib/python2.7/multiprocessing/process.py\", line 114, in run\n>     self._target(*self._args, **self._kwargs)\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 79, in build_ref_doc\n>     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 763, in _wrapper\n>     getattr(DocBuilder, build_type)(self, *args, **kwds)\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 135, in f\n>     runsphinx()\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py\", line 314, in runsphinx\n>     sys.stderr.raise_errors()\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py\", line 249, in raise_errors\n>     raise OSError(self._error)\n> OSError: /build/sagemath-doc/src/sage-8.7/src/doc/en/reference/combinat/sage/combinat/shifted_primed_tableau.rst:267: WARNING: Could not lex literal_block as \"pycon\". Highlighting skipped.\n> Error building the documentation.\n> Traceback (most recent call last):\n>   File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n>     \"__main__\", fname, loader, pkg_name)\n>   File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n>     exec code in run_globals\n>   File \"/build/sagemath-doc/src/sage-8.7/src/sage_setup/docbuild/__main__.py\", line 2, in <module>\n>     main()\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 1732, in main\n>     builder()\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 358, in _wrapper\n>     getattr(get_builder(document), name)(*args, **kwds)\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py\", line 549, in _wrapper\n>     build_many(build_ref_doc, L)\n>   File \"/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/utils.py\", line 214, in _build_many\n>     raise worker_exc\n> WorkerDiedException: worker for ('reference/combinat', 'en', 'html', {}) died with non-zero exit code 1\n> \n>     Note: incremental documentation builds sometimes cause spurious\n>     error messages. To be certain that these are real errors, run\n>     \"make doc-clean\" first and try again.\n> ```\n\nDid you also use the branch from #27528? That would get rid of the warning which is causing the problems. This is somewhat moot, since I am reworking #27528. I should be able to post something later today.",
    "created_at": "2019-03-24T18:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407988",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:120" align="right">comment:120</div>

Replying to [@antonio-rojas](#comment:117):
> With this branch on top of 8.7 and sphinx 1.8.5 I'm getting:
> 
> ```
> Process Process-79:
> Traceback (most recent call last):
>   File "/usr/lib/python2.7/multiprocessing/process.py", line 267, in _bootstrap
>     self.run()
>   File "/usr/lib/python2.7/multiprocessing/process.py", line 114, in run
>     self._target(*self._args, **self._kwargs)
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 79, in build_ref_doc
>     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 763, in _wrapper
>     getattr(DocBuilder, build_type)(self, *args, **kwds)
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 135, in f
>     runsphinx()
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py", line 314, in runsphinx
>     sys.stderr.raise_errors()
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/sphinxbuild.py", line 249, in raise_errors
>     raise OSError(self._error)
> OSError: /build/sagemath-doc/src/sage-8.7/src/doc/en/reference/combinat/sage/combinat/shifted_primed_tableau.rst:267: WARNING: Could not lex literal_block as "pycon". Highlighting skipped.
> Error building the documentation.
> Traceback (most recent call last):
>   File "/usr/lib/python2.7/runpy.py", line 174, in _run_module_as_main
>     "__main__", fname, loader, pkg_name)
>   File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
>     exec code in run_globals
>   File "/build/sagemath-doc/src/sage-8.7/src/sage_setup/docbuild/__main__.py", line 2, in <module>
>     main()
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 1732, in main
>     builder()
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 358, in _wrapper
>     getattr(get_builder(document), name)(*args, **kwds)
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/__init__.py", line 549, in _wrapper
>     build_many(build_ref_doc, L)
>   File "/build/sagemath-doc/src/sage-8.7/local-python/sage_setup/docbuild/utils.py", line 214, in _build_many
>     raise worker_exc
> WorkerDiedException: worker for ('reference/combinat', 'en', 'html', {}) died with non-zero exit code 1
> 
>     Note: incremental documentation builds sometimes cause spurious
>     error messages. To be certain that these are real errors, run
>     "make doc-clean" first and try again.
> ```

Did you also use the branch from #27528? That would get rid of the warning which is causing the problems. This is somewhat moot, since I am reworking #27528. I should be able to post something later today.



---

archive/issue_comments_407989.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">comment:121</div>\n\nReplying to [@jhpalmieri](#comment:120):\n> \n> Did you also use the branch from #27528? That would get rid of the warning which is causing the problems. This is somewhat moot, since I am reworking #27528. I should be able to post something later today.\n\nAh, no. I was under the (wrong) impression that branches in trac tickets already pulled the changes from dependant tickets.",
    "created_at": "2019-03-24T18:30:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407989",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:121" align="right">comment:121</div>

Replying to [@jhpalmieri](#comment:120):
> 
> Did you also use the branch from #27528? That would get rid of the warning which is causing the problems. This is somewhat moot, since I am reworking #27528. I should be able to post something later today.

Ah, no. I was under the (wrong) impression that branches in trac tickets already pulled the changes from dependant tickets.



---

archive/issue_comments_407990.json:
```json
{
    "body": "<div id=\"comment:122\" align=\"right\">comment:122</div>\n\nReplying to [@antonio-rojas](#comment:121):\n> Replying to [@jhpalmieri](#comment:120):\n> > \n> > Did you also use the branch from #27528? That would get rid of the warning which is causing the problems. This is somewhat moot, since I am reworking #27528. I should be able to post something later today.\n\n> \n> Ah, no. I was under the (wrong) impression that branches in trac tickets already pulled the changes from dependant tickets.\n\nSometimes they do and sometimes they don't. I don't know what I am supposed to do when preparing branches: base this one on the one from #27528 or on `develop`?",
    "created_at": "2019-03-24T18:37:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407990",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:122" align="right">comment:122</div>

Replying to [@antonio-rojas](#comment:121):
> Replying to [@jhpalmieri](#comment:120):
> > 
> > Did you also use the branch from #27528? That would get rid of the warning which is causing the problems. This is somewhat moot, since I am reworking #27528. I should be able to post something later today.

> 
> Ah, no. I was under the (wrong) impression that branches in trac tickets already pulled the changes from dependant tickets.

Sometimes they do and sometimes they don't. I don't know what I am supposed to do when preparing branches: base this one on the one from #27528 or on `develop`?



---

archive/issue_comments_407991.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,5 @@\n-This ticket is to upgrade to Sphinx 1.8.4.\n+This ticket is to upgrade to Sphinx 1.8.5.\n \n Our previous upgrade was to Sphinx 1.7.6 in #26033.\n \n-With Sphinx 1.8.1 we see quite a few\n-\n-```\n-ApplicationError: Source directory and destination directory cannot be identical\n-```\n-coming out of Sphinx in conda as they have changed the argument checking\n-of the `Sphinx()` constructor it seems.\n-\n-**Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz\n+**Tarball**: https://files.pythonhosted.org/packages/2a/86/8e1e8400bb6eca5ed960917952600fce90599e1cb0d20ddedd81ba163370/Sphinx-1.8.5.tar.gz\n``````\n",
    "created_at": "2019-03-24T23:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407991",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,5 @@
-This ticket is to upgrade to Sphinx 1.8.4.
+This ticket is to upgrade to Sphinx 1.8.5.
 
 Our previous upgrade was to Sphinx 1.7.6 in #26033.
 
-With Sphinx 1.8.1 we see quite a few
-
-```
-ApplicationError: Source directory and destination directory cannot be identical
-```
-coming out of Sphinx in conda as they have changed the argument checking
-of the `Sphinx()` constructor it seems.
-
-**Tarball**: https://files.pythonhosted.org/packages/dd/f8/df628d41f42793d446285767164c6a8da71d82892f2c98c43e0523836d39/Sphinx-1.8.4.tar.gz
+**Tarball**: https://files.pythonhosted.org/packages/2a/86/8e1e8400bb6eca5ed960917952600fce90599e1cb0d20ddedd81ba163370/Sphinx-1.8.5.tar.gz
``````




---

archive/issue_events_364469.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-24T23:09:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364469"
}
```



---

archive/issue_events_364470.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-24T23:09:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364470"
}
```



---

archive/issue_comments_407992.json:
```json
{
    "body": "Changed commit from **[`0dfcab9`](https://github.com/sagemath/sagetrac-mirror/commit/0dfcab9dfbc4d403c77cf058df1ef0502d0b2eff)** to **[`0a92d48`](https://github.com/sagemath/sagetrac-mirror/commit/0a92d485970b31b8fb4b70a589d063534b9ab936)**",
    "created_at": "2019-03-24T23:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407992",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0dfcab9`](https://github.com/sagemath/sagetrac-mirror/commit/0dfcab9dfbc4d403c77cf058df1ef0502d0b2eff)** to **[`0a92d48`](https://github.com/sagemath/sagetrac-mirror/commit/0a92d485970b31b8fb4b70a589d063534b9ab936)**



---

archive/issue_comments_407993.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48b7acd9c132462e57317ededf422269e4e389d3\"><code>48b7acd</code></a></td><td><code>trac 27528: remove some patches for Sphinx and pygments.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b23b8ccc43bdb63e6606e39cc73b2b4984bdfa7c\"><code>b23b8cc</code></a></td><td><code>trac 27528: use a custom Sphinx transform to handle <BLANKLINE></code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/687b3385e80af4efd6ee8db79200c518a731af1d\"><code>687b338</code></a></td><td><code>trac 27528: clean up some code-blocks in the reST documentation.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1794bb9a26ddf577832884e4eaff79f86f41307\"><code>e1794bb</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.5.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c61a0417ac55a8b77a938006180d22c7bfead99e\"><code>c61a041</code></a></td><td><code>trac 26451: Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e32410abb5756c181cd9d90f363cb023b3a9542\"><code>5e32410</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a92d485970b31b8fb4b70a589d063534b9ab936\"><code>0a92d48</code></a></td><td><code>trac 26451: inventory builder: remove _static directory upon cleanup,</code></td></tr></table>\n",
    "created_at": "2019-03-24T23:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407993",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48b7acd9c132462e57317ededf422269e4e389d3"><code>48b7acd</code></a></td><td><code>trac 27528: remove some patches for Sphinx and pygments.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b23b8ccc43bdb63e6606e39cc73b2b4984bdfa7c"><code>b23b8cc</code></a></td><td><code>trac 27528: use a custom Sphinx transform to handle <BLANKLINE></code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/687b3385e80af4efd6ee8db79200c518a731af1d"><code>687b338</code></a></td><td><code>trac 27528: clean up some code-blocks in the reST documentation.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1794bb9a26ddf577832884e4eaff79f86f41307"><code>e1794bb</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.5.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c61a0417ac55a8b77a938006180d22c7bfead99e"><code>c61a041</code></a></td><td><code>trac 26451: Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e32410abb5756c181cd9d90f363cb023b3a9542"><code>5e32410</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a92d485970b31b8fb4b70a589d063534b9ab936"><code>0a92d48</code></a></td><td><code>trac 26451: inventory builder: remove _static directory upon cleanup,</code></td></tr></table>




---

archive/issue_events_364471.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-24T23:50:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364471"
}
```



---

archive/issue_events_364472.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-24T23:50:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364472"
}
```



---

archive/issue_comments_407994.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHere is a new branch which is based on #27528. I put the `<BLANKLINE>` stuff at #27528, not here, since I needed it there.",
    "created_at": "2019-03-24T23:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407994",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

Here is a new branch which is based on #27528. I put the `<BLANKLINE>` stuff at #27528, not here, since I needed it there.



---

archive/issue_events_364473.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-24T23:51:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "title_is": "Upgrade to Sphinx 1.8.5",
    "title_was": "Upgrade to Sphinx 1.8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364473"
}
```



---

archive/issue_events_364474.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364474"
}
```



---

archive/issue_events_364475.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364475"
}
```



---

archive/issue_comments_407995.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407995",
    "user": "https://github.com/embray"
}
```

<div id="comment:7" align="right">comment:7</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_407996.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This ticket is to upgrade to Sphinx 1.8.5.\n+This ticket upgrades Sphinx to version 1.8.5.\n \n Our previous upgrade was to Sphinx 1.7.6 in #26033.\n \n``````\n",
    "created_at": "2019-03-25T17:26:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407996",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This ticket is to upgrade to Sphinx 1.8.5.
+This ticket upgrades Sphinx to version 1.8.5.
 
 Our previous upgrade was to Sphinx 1.7.6 in #26033.
 
``````




---

archive/issue_comments_407997.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/737afd8f314bd1e16feaec562bb4b5efa2effa8b\"><code>737afd8</code></a></td><td><code>trac 26451: fix one doctest</code></td></tr></table>\n",
    "created_at": "2019-03-25T18:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407997",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/737afd8f314bd1e16feaec562bb4b5efa2effa8b"><code>737afd8</code></a></td><td><code>trac 26451: fix one doctest</code></td></tr></table>




---

archive/issue_comments_407998.json:
```json
{
    "body": "Changed commit from **[`0a92d48`](https://github.com/sagemath/sagetrac-mirror/commit/0a92d485970b31b8fb4b70a589d063534b9ab936)** to **[`737afd8`](https://github.com/sagemath/sagetrac-mirror/commit/737afd8f314bd1e16feaec562bb4b5efa2effa8b)**",
    "created_at": "2019-03-25T18:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407998",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0a92d48`](https://github.com/sagemath/sagetrac-mirror/commit/0a92d485970b31b8fb4b70a589d063534b9ab936)** to **[`737afd8`](https://github.com/sagemath/sagetrac-mirror/commit/737afd8f314bd1e16feaec562bb4b5efa2effa8b)**



---

archive/issue_comments_407999.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nPDF documentation builds fine for me.",
    "created_at": "2019-03-25T22:19:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-407999",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:0" align="right">comment:0</div>

PDF documentation builds fine for me.



---

archive/issue_comments_408000.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nlooks good to me.",
    "created_at": "2019-03-26T00:13:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408000",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

looks good to me.



---

archive/issue_events_364476.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-03-26T00:13:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364476"
}
```



---

archive/issue_events_364477.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-03-26T00:13:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364477"
}
```



---

archive/issue_comments_408001.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nGreat! Now we need to silence all of the stupid deprecation warnings.",
    "created_at": "2019-03-26T04:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408001",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

Great! Now we need to silence all of the stupid deprecation warnings.



---

archive/issue_comments_408002.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSee #27578 for a ticket to stop using the deprecated `formatargspec`.",
    "created_at": "2019-03-30T22:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408002",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

See #27578 for a ticket to stop using the deprecated `formatargspec`.



---

archive/issue_comments_408003.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nMerge conflict",
    "created_at": "2019-03-30T22:37:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408003",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

Merge conflict



---

archive/issue_events_364478.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-30T22:37:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364478"
}
```



---

archive/issue_events_364479.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-30T22:37:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364479"
}
```



---

archive/issue_comments_408004.json:
```json
{
    "body": "Changed commit from **[`737afd8`](https://github.com/sagemath/sagetrac-mirror/commit/737afd8f314bd1e16feaec562bb4b5efa2effa8b)** to **[`f1a08e3`](https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365)**",
    "created_at": "2019-03-31T01:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408004",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`737afd8`](https://github.com/sagemath/sagetrac-mirror/commit/737afd8f314bd1e16feaec562bb4b5efa2effa8b)** to **[`f1a08e3`](https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365)**



---

archive/issue_comments_408005.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a55438e9fe1f53931a8b0ed96f928a05f8e72e71\"><code>a55438e</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.5.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/827ff8023fb8e0d12de3613738585a3940b514eb\"><code>827ff80</code></a></td><td><code>trac 26451: Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22736d7d7e0f2ef96ddd08ef9fbb4544d8824b3d\"><code>22736d7</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4cab150f22d17a8613d061f82888ae0dc28ad412\"><code>4cab150</code></a></td><td><code>trac 26451: inventory builder: remove _static directory upon cleanup,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365\"><code>f1a08e3</code></a></td><td><code>trac 26451: fix one doctest</code></td></tr></table>\n",
    "created_at": "2019-03-31T01:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408005",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a55438e9fe1f53931a8b0ed96f928a05f8e72e71"><code>a55438e</code></a></td><td><code>trac 26451: upgrade to Sphinx 1.8.5.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/827ff8023fb8e0d12de3613738585a3940b514eb"><code>827ff80</code></a></td><td><code>trac 26451: Call Sphinx() 1.8 constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22736d7d7e0f2ef96ddd08ef9fbb4544d8824b3d"><code>22736d7</code></a></td><td><code>trac 26451: change 'app.builder.info' to 'logger.info'.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4cab150f22d17a8613d061f82888ae0dc28ad412"><code>4cab150</code></a></td><td><code>trac 26451: inventory builder: remove _static directory upon cleanup,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365"><code>f1a08e3</code></a></td><td><code>trac 26451: fix one doctest</code></td></tr></table>




---

archive/issue_events_364480.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-31T01:52:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364480"
}
```



---

archive/issue_events_364481.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-03-31T01:52:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364481"
}
```



---

archive/issue_comments_408006.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nRebased.",
    "created_at": "2019-03-31T01:52:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408006",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

Rebased.



---

archive/issue_comments_408007.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)** to **[`f1a08e3`](https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365)**",
    "created_at": "2019-04-02T21:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26451#issuecomment-408007",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/26451](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/26451)** to **[`f1a08e3`](https://github.com/sagemath/sagetrac-mirror/commit/f1a08e3522b66afe96e8fdd389cf1114b1db1365)**



---

archive/issue_events_364482.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-02T21:30:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364482"
}
```



---

archive/issue_events_364483.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d5121619811994a3008217f2c0c099aa85f333fc",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-04-02T21:30:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26451",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26451#event-364483"
}
```
