# Issue 26348: 3 other internet doctests failing in findstat.py

archive/issues_026111.json:
```json
{
    "body": "As reported in [sage-release for 8.4.beta6](https://groups.google.com/d/msg/sage-release/lKuxjPFGWVw/zmEBYcAaAAAJ), the command\n\n```\nsage -tp --long --optional=sage,optional,external src/sage/databases/findstat.py\n```\n\ngives\n\n```\nsage -t --long src/sage/databases/findstat.py\n**********************************************************************\nFile \"src/sage/databases/findstat.py\", line 106, in sage.databases.findstat\nFailed example:\n    r = findstat(Permutations, lambda pi: pi.saliances()[0]); r           # optional -- internet, random\n\n    (St000051: The size of the left subtree. , [Mp00069: complement, Mp00061: to increasing tree], 24)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 659, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1068, in compile_and_execute\n        compiled = compiler(example)\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 635, in compiler\n        compileflags, 1)\n      File \"<doctest sage.databases.findstat[7]>\", line 3\n        (St000051: The size of the left subtree. , [Mp00069: complement, Mp00061: to increasing tree], Integer(24))\n                 ^\n    SyntaxError: invalid syntax\n**********************************************************************\nFile \"src/sage/databases/findstat.py\", line 110, in sage.databases.findstat\nFailed example:\n    (s, list_f, quality) = next((a,b,c) for a,b,c in r if a.id() == 51)   # optional -- internet\nException raised:\n    Traceback (most recent call last):\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 659, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1070, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.databases.findstat[8]>\", line 1, in <module>\n        (s, list_f, quality) = next((a,b,c) for a,b,c in r if a.id() == Integer(51))   # optional -- internet\n    StopIteration\n**********************************************************************\nFile \"src/sage/databases/findstat.py\", line 130, in sage.databases.findstat\nFailed example:\n    print(list_f[0].code() + \"\\r\\n\" + list_f[1].code())                   # optional -- internet, random\nException raised:\n    Traceback (most recent call last):\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 659, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1070, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.databases.findstat[12]>\", line 1, in <module>\n        print(list_f[Integer(0)].code() + \"\\r\\n\" + list_f[Integer(1)].code())                   # optional -- internet, random\n    IndexError: list index out of range\n**********************************************************************\n1 item had failures:\n   3 of  16 in sage.databases.findstat\n    7 webbrowser tests not run\n    [247 tests, 3 failures, 72.88 s]\n```\n\nBranch/Commit: d35a6e3b9ff5ea1cd332dbb67aacc52d6f82d8fc\n\nReviewer: S\u00e9bastien Labb\u00e9, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Martin Rubey\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26348\n\n",
    "closed_at": "2018-10-20T11:58:48Z",
    "created_at": "2018-09-26T05:16:06Z",
    "labels": [
        "component: doctest coverage",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "3 other internet doctests failing in findstat.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26348",
    "user": "https://github.com/seblabbe"
}
```
As reported in [sage-release for 8.4.beta6](https://groups.google.com/d/msg/sage-release/lKuxjPFGWVw/zmEBYcAaAAAJ), the command

```
sage -tp --long --optional=sage,optional,external src/sage/databases/findstat.py
```

gives

```
sage -t --long src/sage/databases/findstat.py
**********************************************************************
File "src/sage/databases/findstat.py", line 106, in sage.databases.findstat
Failed example:
    r = findstat(Permutations, lambda pi: pi.saliances()[0]); r           # optional -- internet, random

    (St000051: The size of the left subtree. , [Mp00069: complement, Mp00061: to increasing tree], 24)
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 659, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1068, in compile_and_execute
        compiled = compiler(example)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 635, in compiler
        compileflags, 1)
      File "<doctest sage.databases.findstat[7]>", line 3
        (St000051: The size of the left subtree. , [Mp00069: complement, Mp00061: to increasing tree], Integer(24))
                 ^
    SyntaxError: invalid syntax
**********************************************************************
File "src/sage/databases/findstat.py", line 110, in sage.databases.findstat
Failed example:
    (s, list_f, quality) = next((a,b,c) for a,b,c in r if a.id() == 51)   # optional -- internet
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 659, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1070, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.databases.findstat[8]>", line 1, in <module>
        (s, list_f, quality) = next((a,b,c) for a,b,c in r if a.id() == Integer(51))   # optional -- internet
    StopIteration
**********************************************************************
File "src/sage/databases/findstat.py", line 130, in sage.databases.findstat
Failed example:
    print(list_f[0].code() + "\r\n" + list_f[1].code())                   # optional -- internet, random
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 659, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1070, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.databases.findstat[12]>", line 1, in <module>
        print(list_f[Integer(0)].code() + "\r\n" + list_f[Integer(1)].code())                   # optional -- internet, random
    IndexError: list index out of range
**********************************************************************
1 item had failures:
   3 of  16 in sage.databases.findstat
    7 webbrowser tests not run
    [247 tests, 3 failures, 72.88 s]
```

Branch/Commit: d35a6e3b9ff5ea1cd332dbb67aacc52d6f82d8fc

Reviewer: Sébastien Labbé, Frédéric Chapoton

Author: Martin Rubey

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26348





---

archive/issue_comments_392016.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,7 +1,10 @@\n+As reported in [sage-release for 8.4.beta6](https://groups.google.com/d/msg/sage-release/lKuxjPFGWVw/zmEBYcAaAAAJ), the command\n+\n ```\n sage -tp --long --optional=sage,optional,external src/sage/databases/findstat.py\n ```\n \n+gives\n \n ```\n sage -t --long src/sage/databases/findstat.py\n```\n",
    "created_at": "2018-09-26T05:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392016",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,7 +1,10 @@
+As reported in [sage-release for 8.4.beta6](https://groups.google.com/d/msg/sage-release/lKuxjPFGWVw/zmEBYcAaAAAJ), the command
+
 ```
 sage -tp --long --optional=sage,optional,external src/sage/databases/findstat.py
 ```
 
+gives
 
 ```
 sage -t --long src/sage/databases/findstat.py
```




---

archive/issue_comments_392017.json:
```json
{
    "body": "<a id='comment:2'></a>The first one seems to indicate that the meaning of \"...\" has changed: it fails because the next line is interpreted as part of the doctest instead of part of the output.\n\nThe other failures are a consequence of the first.",
    "created_at": "2018-09-26T07:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392017",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>The first one seems to indicate that the meaning of "..." has changed: it fails because the next line is interpreted as part of the doctest instead of part of the output.

The other failures are a consequence of the first.



---

archive/issue_comments_392018.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-27T08:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392018",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_392019.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2018-09-27T08:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392019",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_392020.json:
```json
{
    "body": "<a id='comment:5'></a>We should rather keep the #random, so that we do not have to change the doctests every week or so.",
    "created_at": "2018-09-30T12:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392020",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>We should rather keep the #random, so that we do not have to change the doctests every week or so.



---

archive/issue_comments_392021.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-08T18:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392021",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_392022.json:
```json
{
    "body": "<a id='comment:6'></a>I suggest we update doctests and/or readd `# random` tag later in another ticket if needed. Positive review.",
    "created_at": "2018-10-08T18:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392022",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:6'></a>I suggest we update doctests and/or readd `# random` tag later in another ticket if needed. Positive review.



---

archive/issue_comments_392023.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-10-08T18:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392023",
    "user": "https://github.com/seblabbe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_392024.json:
```json
{
    "body": "<a id='comment:7'></a>oups, the plugins \"doctest continuation\" seems unhappy. And sometimes `pyflakes` too.",
    "created_at": "2018-10-08T18:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392024",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:7'></a>oups, the plugins "doctest continuation" seems unhappy. And sometimes `pyflakes` too.



---

archive/issue_comments_392025.json:
```json
{
    "body": "<a id='comment:8'></a>pyflakes (when run using python3) warns about an exception class called StandardError that has been removed in Python 3",
    "created_at": "2018-10-08T19:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392025",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>pyflakes (when run using python3) warns about an exception class called StandardError that has been removed in Python 3



---

archive/issue_comments_392026.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 slabbe]:\n> oups, the plugins \"doctest continuation\" seems unhappy. And sometimes `pyflakes` too.\n\n\nI do not understand this.  It is complaining about the doctest which I just changed:\n\n```\n    sage: r = findstat(Permutations, lambda pi: pi.saliances()[0]); r           # optional -- internet\n    0: ...\n    ... (St000051: The size of the left subtree of a binary tree., [Mp00069: complement, Mp00061: to increasing tree], 1000)\n    ...\n    sage: (s, list_f, quality) = next((a,b,c) for a,b,c in r if a.id() == 51)   # optional -- internet\n```\nI can't see what's wrong with it - any ideas?\n\nConcerning `StandardError`, it seems that this should be replaced with `Exception`.",
    "created_at": "2018-10-08T20:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392026",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>Replying to [comment:7 slabbe]:
> oups, the plugins "doctest continuation" seems unhappy. And sometimes `pyflakes` too.


I do not understand this.  It is complaining about the doctest which I just changed:

```
    sage: r = findstat(Permutations, lambda pi: pi.saliances()[0]); r           # optional -- internet
    0: ...
    ... (St000051: The size of the left subtree of a binary tree., [Mp00069: complement, Mp00061: to increasing tree], 1000)
    ...
    sage: (s, list_f, quality) = next((a,b,c) for a,b,c in r if a.id() == 51)   # optional -- internet
```
I can't see what's wrong with it - any ideas?

Concerning `StandardError`, it seems that this should be replaced with `Exception`.



---

archive/issue_comments_392027.json:
```json
{
    "body": "<a id='comment:10'></a>The plugin is not smart. If you think it's ok, just go on.",
    "created_at": "2018-10-09T06:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392027",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>The plugin is not smart. If you think it's ok, just go on.



---

archive/issue_comments_392028.json:
```json
{
    "body": "<a id='comment:11'></a>Can I use or look at the plugin without setting up a patchbot?",
    "created_at": "2018-10-09T06:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392028",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:11'></a>Can I use or look at the plugin without setting up a patchbot?



---

archive/issue_comments_392029.json:
```json
{
    "body": "<a id='comment:12'></a>The code is here: https://github.com/sagemath/sage-patchbot\n\nPatchbot is not so easy to use. Some instructions for usage inside an ipython session are here at the bottom: https://wiki.sagemath.org/patchbot",
    "created_at": "2018-10-09T07:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392029",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>The code is here: https://github.com/sagemath/sage-patchbot

Patchbot is not so easy to use. Some instructions for usage inside an ipython session are here at the bottom: https://wiki.sagemath.org/patchbot



---

archive/issue_comments_392030.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-09T07:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_392031.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-10-09T07:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392031",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_392032.json:
```json
{
    "body": "<a id='comment:15'></a>ok, even if I would have prefered to keep \"# random\"",
    "created_at": "2018-10-12T13:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392032",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>ok, even if I would have prefered to keep "# random"



---

archive/issue_comments_392033.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-12T13:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392033",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065537.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-20T11:58:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26348#event-65537"
}
```



---

archive/issue_comments_392034.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-20T11:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392034",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_392035.json:
```json
{
    "body": "<a id='comment:17'></a>This should be re-targeted for 8.5.",
    "created_at": "2018-10-28T14:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26348#issuecomment-392035",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>This should be re-targeted for 8.5.



---

archive/issue_events_065538.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T14:52:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26348",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26348#event-65538"
}
```
