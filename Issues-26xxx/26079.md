# Issue 26079: Quotients of finite dimensional Lie algebras

archive/issues_025842.json:
```json
{
    "body": "An implementation of quotients of finite dimensional Lie algebras with basis. As with ideals, in the finite dimensional case a naive (and probably inefficient) to compute quotients is available by reducing a basis of the Lie algebra modulo the ideal and computing structural coefficients in terms of the reduced basis. Part of a part of #16824\n\n**CC:**  @tscrim\n\n**Keywords:** Lie algebras, ideals, quotients\n\n**Branch/Commit:** [01a3669e7472ca82c3fd56e755eca0e1b08cbbc7](https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Eero Hakavuori\n\n**Dependencies:** #26078\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26079\n\n",
    "closed_at": "2018-09-22T10:22:36Z",
    "created_at": "2018-08-17T07:13:43Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Quotients of finite dimensional Lie algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26079",
    "user": "https://github.com/ehaka"
}
```
An implementation of quotients of finite dimensional Lie algebras with basis. As with ideals, in the finite dimensional case a naive (and probably inefficient) to compute quotients is available by reducing a basis of the Lie algebra modulo the ideal and computing structural coefficients in terms of the reduced basis. Part of a part of #16824

**CC:**  @tscrim

**Keywords:** Lie algebras, ideals, quotients

**Branch/Commit:** [01a3669e7472ca82c3fd56e755eca0e1b08cbbc7](https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7)

**Reviewer:** Travis Scrimshaw

**Author:** Eero Hakavuori

**Dependencies:** #26078

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/26079





---

archive/issue_comments_502959.json:
```json
{
    "body": "<a id='comment:1'></a>\nSome implementation already exists in a codebase that I need to clean up and import into Sage.",
    "created_at": "2018-08-17T07:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502959",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:1'></a>
Some implementation already exists in a codebase that I need to clean up and import into Sage.



---

archive/issue_comments_502960.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2018-09-02T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502960",
    "user": "https://github.com/ehaka"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_502961.json:
```json
{
    "body": "<a id='comment:2'></a>\nAn initial implementation in the commits. The Lie algebra that the quotient was created from is stored  for internal use in the `__ambient` attribute instead of `_ambient` as the latter is being used in `product_space` in `sage.categories.algebras.finite_dimensional_lie_algebras_with_basis`, which caused issues with e.g. lower central series computations for quotient Lie algebras.\n\n---\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69dfbfe2257f97f1ea5fec495f3a1909558214c8\">69dfbfe</a></td><td><code>Preserve nilpotent category for ideals and subalgebras of nilpotent Lie algebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0d60e1f775af58e648f1c062d6128a2f164217d\">a0d60e1</a></td><td><code>Refactored subobject computations to use lift and retract instead of value</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59576970729d4378562773cc04af617b183b2127\">5957697</a></td><td><code>Fix for lower central series computation of subalgebras: 'from_vector' now checks if the vector is given in the ambient or intrinsic form</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2cdaed522396d8154a9eed6246580a886b8f366\">e2cdaed</a></td><td><code>Added doctest for nilpotency step computation of ideals and subalgebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff672fc23d93ec67f595348827cc69e2e07bcf12\">ff672fc</a></td><td><code>retract to subalgebra now checks that the element is contained in the subalgebra</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d7c00706e3bc93cc85d81ef7d2f77c8632ea86a\">2d7c007</a></td><td><code>Added repr_short method to ideals mimicking ring ideals</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/209c75541d4f6a4bfe7ba1c469b14a9ffe66a6e8\">209c755</a></td><td><code>Fixed error in testing if a subalgebra or ideal is an ideal of a Lie algebra</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0be7e09dbe2abba1c6d6d2accffd0362b3307f73\">0be7e09</a></td><td><code>Merge remote-tracking branch 'trac/u/gh-ehaka/lie_ideals-26078' into quotients-26079</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a23c5ec07e9afcd6a7ca02d7db09c51b4fb45b7\">5a23c5e</a></td><td><code>trac #26079: initial implementation of quotients of finite dimensional Lie algebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ead5abdd0a6ee15a81c3092811d28aea61d528dc\">ead5abd</a></td><td><code>trac #26079: removed unnecessary conversion from elements of the quotient to the ambient Lie algebra</code></td></tr></table>\n",
    "created_at": "2018-09-02T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502961",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:2'></a>
An initial implementation in the commits. The Lie algebra that the quotient was created from is stored  for internal use in the `__ambient` attribute instead of `_ambient` as the latter is being used in `product_space` in `sage.categories.algebras.finite_dimensional_lie_algebras_with_basis`, which caused issues with e.g. lower central series computations for quotient Lie algebras.

---
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69dfbfe2257f97f1ea5fec495f3a1909558214c8">69dfbfe</a></td><td><code>Preserve nilpotent category for ideals and subalgebras of nilpotent Lie algebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0d60e1f775af58e648f1c062d6128a2f164217d">a0d60e1</a></td><td><code>Refactored subobject computations to use lift and retract instead of value</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59576970729d4378562773cc04af617b183b2127">5957697</a></td><td><code>Fix for lower central series computation of subalgebras: 'from_vector' now checks if the vector is given in the ambient or intrinsic form</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2cdaed522396d8154a9eed6246580a886b8f366">e2cdaed</a></td><td><code>Added doctest for nilpotency step computation of ideals and subalgebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff672fc23d93ec67f595348827cc69e2e07bcf12">ff672fc</a></td><td><code>retract to subalgebra now checks that the element is contained in the subalgebra</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d7c00706e3bc93cc85d81ef7d2f77c8632ea86a">2d7c007</a></td><td><code>Added repr_short method to ideals mimicking ring ideals</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/209c75541d4f6a4bfe7ba1c469b14a9ffe66a6e8">209c755</a></td><td><code>Fixed error in testing if a subalgebra or ideal is an ideal of a Lie algebra</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0be7e09dbe2abba1c6d6d2accffd0362b3307f73">0be7e09</a></td><td><code>Merge remote-tracking branch 'trac/u/gh-ehaka/lie_ideals-26078' into quotients-26079</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a23c5ec07e9afcd6a7ca02d7db09c51b4fb45b7">5a23c5e</a></td><td><code>trac #26079: initial implementation of quotients of finite dimensional Lie algebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ead5abdd0a6ee15a81c3092811d28aea61d528dc">ead5abd</a></td><td><code>trac #26079: removed unnecessary conversion from elements of the quotient to the ambient Lie algebra</code></td></tr></table>




---

archive/issue_comments_502962.json:
```json
{
    "body": "**Commit:** [ead5abdd0a6ee15a81c3092811d28aea61d528dc](https://github.com/sagemath/sagetrac-mirror/commit/ead5abdd0a6ee15a81c3092811d28aea61d528dc)",
    "created_at": "2018-09-02T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502962",
    "user": "https://github.com/ehaka"
}
```

**Commit:** [ead5abdd0a6ee15a81c3092811d28aea61d528dc](https://github.com/sagemath/sagetrac-mirror/commit/ead5abdd0a6ee15a81c3092811d28aea61d528dc)



---

archive/issue_comments_502963.json:
```json
{
    "body": "**Author:** Eero Hakavuori",
    "created_at": "2018-09-02T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502963",
    "user": "https://github.com/ehaka"
}
```

**Author:** Eero Hakavuori



---

archive/issue_comments_502964.json:
```json
{
    "body": "**Branch:** [u/gh-ehaka/quotients-26079](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-ehaka/quotients-26079)",
    "created_at": "2018-09-02T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502964",
    "user": "https://github.com/ehaka"
}
```

**Branch:** [u/gh-ehaka/quotients-26079](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-ehaka/quotients-26079)



---

archive/issue_comments_502965.json:
```json
{
    "body": "<a id='comment:3'></a>\nSo having `_ambient` and `__ambient` being different objects will be horribly confusing and prone to causing errors. So what we probably need is a better test in `product_space` (or anything else that needs to check if something is constructed as a subalgebra. I haven't thought about this yet, but will try to do so today. Do you have any ideas?",
    "created_at": "2018-09-03T02:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502965",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
So having `_ambient` and `__ambient` being different objects will be horribly confusing and prone to causing errors. So what we probably need is a better test in `product_space` (or anything else that needs to check if something is constructed as a subalgebra. I haven't thought about this yet, but will try to do so today. Do you have any ideas?



---

archive/issue_comments_502966.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2018-09-03T02:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502966",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_502967.json:
```json
{
    "body": "<a id='comment:4'></a>\nOne option could be to replicate the `is_ideal` approach and to add a `is_subalgebra` method, leaving the particular implementation to the classes themselves. In the current implementation the subalgebras are already overriding `is_ideal` since `module` currently refers to the intrinsic basis of the subalgebra. This is possibly something that I should refactor in #26078, since the mix between the intrinsic and ambient bases is a bit confusing as well. Perhaps for subalgebras anything referring to vectors is best done only in the ambient basis?\n\nAnother possibility would be to make use of the `Subobjects` category. Ideals and subalgebras are in the `Subobjects` category and quotients in the `Subquotients` category instead. So subalgebras are distinguished from quotients by containment in `LieAlgebras(R).Subobjects()`. Although I am not sure how this would fit together with other Lie algebra implementations that use `_ambient` (nor do I know what are all the places where this is used).",
    "created_at": "2018-09-03T06:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502967",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:4'></a>
One option could be to replicate the `is_ideal` approach and to add a `is_subalgebra` method, leaving the particular implementation to the classes themselves. In the current implementation the subalgebras are already overriding `is_ideal` since `module` currently refers to the intrinsic basis of the subalgebra. This is possibly something that I should refactor in #26078, since the mix between the intrinsic and ambient bases is a bit confusing as well. Perhaps for subalgebras anything referring to vectors is best done only in the ambient basis?

Another possibility would be to make use of the `Subobjects` category. Ideals and subalgebras are in the `Subobjects` category and quotients in the `Subquotients` category instead. So subalgebras are distinguished from quotients by containment in `LieAlgebras(R).Subobjects()`. Although I am not sure how this would fit together with other Lie algebra implementations that use `_ambient` (nor do I know what are all the places where this is used).



---

archive/issue_comments_502968.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [gh-ehaka](#comment%3A4):\n> One option could be to replicate the `is_ideal` approach and to add a `is_subalgebra` method, leaving the particular implementation to the classes themselves. In the current implementation the subalgebras are already overriding `is_ideal` since `module` currently refers to the intrinsic basis of the subalgebra. This is possibly something that I should refactor in #26078, since the mix between the intrinsic and ambient bases is a bit confusing as well. Perhaps for subalgebras anything referring to vectors is best done only in the ambient basis?\n\n\nI think in terms of computations, it would be better to do keep it in terms of the local basis. This will be much faster and structure coefficients can be computed lazily (i.e., on demand) because you keep track of the lift to the ambient (which should basically be stored in a list or some other fast data structure).\n\n> Another possibility would be to make use of the `Subobjects` category. Ideals and subalgebras are in the `Subobjects` category and quotients in the `Subquotients` category instead. So subalgebras are distinguished from quotients by containment in `LieAlgebras(R).Subobjects()`. Although I am not sure how this would fit together with other Lie algebra implementations that use `_ambient` (nor do I know what are all the places where this is used).\n\n\nThis should not be heavily (or maybe even at all other than some toy examples) used currently because I never got around to really implementing subalgebras. I think this would be a better strategy (I don't think categories were implemented in Sage when I first did this). The only other thing that seems reasonable to me is doing an `is_subalgebra`, but that seems kind of dumb and would be better suited to doing things like `L.is_subalgebra(M)`.\n\nI guess also nobody thought about having subobjects of quotients. Although this lift to the ambient is really just an optimization because the ambient will already have the structure coeffs, but the submodule may not. However, I think it is generally a useful optimization (as it allows you to work only with the submodules).",
    "created_at": "2018-09-03T09:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502968",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Replying to [gh-ehaka](#comment%3A4):
> One option could be to replicate the `is_ideal` approach and to add a `is_subalgebra` method, leaving the particular implementation to the classes themselves. In the current implementation the subalgebras are already overriding `is_ideal` since `module` currently refers to the intrinsic basis of the subalgebra. This is possibly something that I should refactor in #26078, since the mix between the intrinsic and ambient bases is a bit confusing as well. Perhaps for subalgebras anything referring to vectors is best done only in the ambient basis?


I think in terms of computations, it would be better to do keep it in terms of the local basis. This will be much faster and structure coefficients can be computed lazily (i.e., on demand) because you keep track of the lift to the ambient (which should basically be stored in a list or some other fast data structure).

> Another possibility would be to make use of the `Subobjects` category. Ideals and subalgebras are in the `Subobjects` category and quotients in the `Subquotients` category instead. So subalgebras are distinguished from quotients by containment in `LieAlgebras(R).Subobjects()`. Although I am not sure how this would fit together with other Lie algebra implementations that use `_ambient` (nor do I know what are all the places where this is used).


This should not be heavily (or maybe even at all other than some toy examples) used currently because I never got around to really implementing subalgebras. I think this would be a better strategy (I don't think categories were implemented in Sage when I first did this). The only other thing that seems reasonable to me is doing an `is_subalgebra`, but that seems kind of dumb and would be better suited to doing things like `L.is_subalgebra(M)`.

I guess also nobody thought about having subobjects of quotients. Although this lift to the ambient is really just an optimization because the ambient will already have the structure coeffs, but the submodule may not. However, I think it is generally a useful optimization (as it allows you to work only with the submodules).



---

archive/issue_comments_502969.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c0251b7d734e16252e5597343e4c2ce97b3a2af\">3c0251b</a></td><td><code>Merge branch 'develop' into u/gh-ehaka/quotients-26079</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/115b5792518905e9d5f7a859c7b7d4818a34b966\">115b579</a></td><td><code>trac #26079: fix for changed ideal baseclass and fixed nonsense doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3289fc4422873912dbfe27638981f30743d55bbc\">3289fc4</a></td><td><code>trac #26079: modified Lie algebra product space computation to test for Subobject category instead of the _ambient attribute</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08fc4dc3c841ee49c85aa4ca3025fcf68d610028\">08fc4dc</a></td><td><code>trac #26079: removed orphaned line of code</code></td></tr></table>\n",
    "created_at": "2018-09-20T18:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c0251b7d734e16252e5597343e4c2ce97b3a2af">3c0251b</a></td><td><code>Merge branch 'develop' into u/gh-ehaka/quotients-26079</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/115b5792518905e9d5f7a859c7b7d4818a34b966">115b579</a></td><td><code>trac #26079: fix for changed ideal baseclass and fixed nonsense doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3289fc4422873912dbfe27638981f30743d55bbc">3289fc4</a></td><td><code>trac #26079: modified Lie algebra product space computation to test for Subobject category instead of the _ambient attribute</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08fc4dc3c841ee49c85aa4ca3025fcf68d610028">08fc4dc</a></td><td><code>trac #26079: removed orphaned line of code</code></td></tr></table>




---

archive/issue_comments_502970.json:
```json
{
    "body": "**Changing commit** from \"[ead5abdd0a6ee15a81c3092811d28aea61d528dc](https://github.com/sagemath/sagetrac-mirror/commit/ead5abdd0a6ee15a81c3092811d28aea61d528dc)\" to \"[08fc4dc3c841ee49c85aa4ca3025fcf68d610028](https://github.com/sagemath/sagetrac-mirror/commit/08fc4dc3c841ee49c85aa4ca3025fcf68d610028)\".",
    "created_at": "2018-09-20T18:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502970",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ead5abdd0a6ee15a81c3092811d28aea61d528dc](https://github.com/sagemath/sagetrac-mirror/commit/ead5abdd0a6ee15a81c3092811d28aea61d528dc)" to "[08fc4dc3c841ee49c85aa4ca3025fcf68d610028](https://github.com/sagemath/sagetrac-mirror/commit/08fc4dc3c841ee49c85aa4ca3025fcf68d610028)".



---

archive/issue_comments_502971.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [tscrim](#comment%3A5):\n> This should not be heavily (or maybe even at all other than some toy examples) used currently because I never got around to really implementing subalgebras. I think this would be a better strategy (I don't think categories were implemented in Sage when I first did this).\n\n\nTrying to find all uses of `_ambient` with `search_src` under the category and algebra modules only turned up a commented out piece of code in `sage.algebras.lie_algebras.lie_algebra.py` and the Lie algebra example in `sage.categories.examples.finite_dimensional_lie_algebras_with_basis.py`, which conveniently enough already uses the `Subobjects` category.\n\nBased on the above search, I replaced the use of the `_ambient` attribute in the `product_space` method of `FiniteDimensionalLieAlgebrasWithBasis` to test for containment in the `Subobjects` subcategory instead. All the doctests still worked, so at least on the surface the change did not break anything.",
    "created_at": "2018-09-20T19:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502971",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:7'></a>
Replying to [tscrim](#comment%3A5):
> This should not be heavily (or maybe even at all other than some toy examples) used currently because I never got around to really implementing subalgebras. I think this would be a better strategy (I don't think categories were implemented in Sage when I first did this).


Trying to find all uses of `_ambient` with `search_src` under the category and algebra modules only turned up a commented out piece of code in `sage.algebras.lie_algebras.lie_algebra.py` and the Lie algebra example in `sage.categories.examples.finite_dimensional_lie_algebras_with_basis.py`, which conveniently enough already uses the `Subobjects` category.

Based on the above search, I replaced the use of the `_ambient` attribute in the `product_space` method of `FiniteDimensionalLieAlgebrasWithBasis` to test for containment in the `Subobjects` subcategory instead. All the doctests still worked, so at least on the surface the change did not break anything.



---

archive/issue_comments_502972.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2018-09-20T19:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502972",
    "user": "https://github.com/ehaka"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_502973.json:
```json
{
    "body": "<a id='comment:9'></a>\nThank you. There are a few more things, but it is almost ready.\n\nYou should have a method\n\n```python\ndef defining_ideal(self):\n    return self._I\n```\n(This is what is done for, e.g., quotients of the `FreeAlgebra`.)\n\nThese changes limit a little bit the number of function calls. While they are not likely to give a significant/noticeable speedup, they do help limit the overhead a bit more:\n\n```diff\n-        sorted_indices = [ambient.basis().inverse_family()[X]\n-                          for X in ambient.basis()]\n+        inv = ambient.basis().inverse_family()\n+        sorted_indices = [iv[X] for X in ambient.basis()]\n```\n\n```diff\n-        sm = L.module().submodule_with_basis([I.reduce(L.basis()[i]).to_vector()\n+        B = L.basis()\n+        sm = L.module().submodule_with_basis([I.reduce(B[i]).to_vector()\n                                               for i in index_set])\n```\n\n```diff\n-        Xdict = X.monomial_coefficients().items()\n-        return L.sum(ck * L.basis()[ik] for ik, ck in Xdict)\n+        B = L.basis()\n+        return L.sum(ck * B[ik] for ik, ck in X)\n```\n(This also reduced the memory overhead.) Lastly, pull the `sm.basis()` call outside of the for loop.",
    "created_at": "2018-09-21T01:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502973",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Thank you. There are a few more things, but it is almost ready.

You should have a method

```python
def defining_ideal(self):
    return self._I
```
(This is what is done for, e.g., quotients of the `FreeAlgebra`.)

These changes limit a little bit the number of function calls. While they are not likely to give a significant/noticeable speedup, they do help limit the overhead a bit more:

```diff
-        sorted_indices = [ambient.basis().inverse_family()[X]
-                          for X in ambient.basis()]
+        inv = ambient.basis().inverse_family()
+        sorted_indices = [iv[X] for X in ambient.basis()]
```

```diff
-        sm = L.module().submodule_with_basis([I.reduce(L.basis()[i]).to_vector()
+        B = L.basis()
+        sm = L.module().submodule_with_basis([I.reduce(B[i]).to_vector()
                                               for i in index_set])
```

```diff
-        Xdict = X.monomial_coefficients().items()
-        return L.sum(ck * L.basis()[ik] for ik, ck in Xdict)
+        B = L.basis()
+        return L.sum(ck * B[ik] for ik, ck in X)
```
(This also reduced the memory overhead.) Lastly, pull the `sm.basis()` call outside of the for loop.



---

archive/issue_comments_502974.json:
```json
{
    "body": "**Changing commit** from \"[08fc4dc3c841ee49c85aa4ca3025fcf68d610028](https://github.com/sagemath/sagetrac-mirror/commit/08fc4dc3c841ee49c85aa4ca3025fcf68d610028)\" to \"[e775e2596a2fa39dae5b3ad304dd49d3a0329001](https://github.com/sagemath/sagetrac-mirror/commit/e775e2596a2fa39dae5b3ad304dd49d3a0329001)\".",
    "created_at": "2018-09-21T05:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502974",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[08fc4dc3c841ee49c85aa4ca3025fcf68d610028](https://github.com/sagemath/sagetrac-mirror/commit/08fc4dc3c841ee49c85aa4ca3025fcf68d610028)" to "[e775e2596a2fa39dae5b3ad304dd49d3a0329001](https://github.com/sagemath/sagetrac-mirror/commit/e775e2596a2fa39dae5b3ad304dd49d3a0329001)".



---

archive/issue_comments_502975.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e775e2596a2fa39dae5b3ad304dd49d3a0329001\">e775e25</a></td><td><code>trac #26079: some effiency improvements</code></td></tr></table>\n",
    "created_at": "2018-09-21T05:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502975",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e775e2596a2fa39dae5b3ad304dd49d3a0329001">e775e25</a></td><td><code>trac #26079: some effiency improvements</code></td></tr></table>




---

archive/issue_comments_502976.json:
```json
{
    "body": "**Changing commit** from \"[e775e2596a2fa39dae5b3ad304dd49d3a0329001](https://github.com/sagemath/sagetrac-mirror/commit/e775e2596a2fa39dae5b3ad304dd49d3a0329001)\" to \"[01a3669e7472ca82c3fd56e755eca0e1b08cbbc7](https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7)\".",
    "created_at": "2018-09-21T05:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e775e2596a2fa39dae5b3ad304dd49d3a0329001](https://github.com/sagemath/sagetrac-mirror/commit/e775e2596a2fa39dae5b3ad304dd49d3a0329001)" to "[01a3669e7472ca82c3fd56e755eca0e1b08cbbc7](https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7)".



---

archive/issue_comments_502977.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7\">01a3669</a></td><td><code>trac #26079: moved import out of __classcall__</code></td></tr></table>\n",
    "created_at": "2018-09-21T05:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502977",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7">01a3669</a></td><td><code>trac #26079: moved import out of __classcall__</code></td></tr></table>




---

archive/issue_comments_502978.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2018-09-21T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502978",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_502979.json:
```json
{
    "body": "<a id='comment:12'></a>\nThank you again for doing such a fine job implementing this. LGTM.",
    "created_at": "2018-09-21T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502979",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Thank you again for doing such a fine job implementing this. LGTM.



---

archive/issue_comments_502980.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2018-09-21T11:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502980",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_502981.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-ehaka/quotients-26079](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-ehaka/quotients-26079)\" to \"[01a3669e7472ca82c3fd56e755eca0e1b08cbbc7](https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7)\".",
    "created_at": "2018-09-22T10:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502981",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/gh-ehaka/quotients-26079](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-ehaka/quotients-26079)" to "[01a3669e7472ca82c3fd56e755eca0e1b08cbbc7](https://github.com/sagemath/sagetrac-mirror/commit/01a3669e7472ca82c3fd56e755eca0e1b08cbbc7)".



---

archive/issue_comments_502982.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2018-09-22T10:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26079#issuecomment-502982",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_073966.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-22T10:22:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26079",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26079#event-73966"
}
```
