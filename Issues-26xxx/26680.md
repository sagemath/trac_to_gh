# Issue 26680: clean generic_graph.py (part 14) - visualization

archive/issues_026443.json:
```json
{
    "body": "CC:  @tscrim @fchapoton\n\nKeywords: py3, graph\n\nWe clean (PEP8 and avoid `.vertices` / `.edges`) methods related to graph visualization: `_color_by_label`, `latex_options`, `set_latex_options`, `layout`, `layout_spring`, `layout_ranked`, `layout_extend_randomly`, `layout_circular`, `layout_tree`, `layout_graphviz`, `_layout_bounding_box`, `_circle_embedding`, `_line_embedding`, `graphplot`, `_rich_repr_`, `plot`, `show`, `plot3d`, `show3d`, `_keys_for_vertices`, `graphviz_string`, `graphviz_to_file_named`, and `tachyon_vertex_plot`.\n\nRemaining calls to `.vertices`:\n- `layout_circular` calls `_circle_embedding` with a list of vertices ordered by `.vertices`. Changing this will change the layout.\n\n- `_keys_for_vertices` returns a mapping vertex to unique string identifier as required by `dot2tex`. It uses the order of `self.vertices()` to build the mapping. It is then used in `graphviz_string` and `layout_graphviz`. \n\nAny advice for these 2 cases is more than welcome ;)\n\nIssue created by migration from https://trac.sagemath.org/ticket/26680\n\n",
    "closed_at": "2018-12-07T12:10:36Z",
    "created_at": "2018-11-11T18:58:42Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "clean generic_graph.py (part 14) - visualization",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26680",
    "user": "https://github.com/dcoudert"
}
```
CC:  @tscrim @fchapoton

Keywords: py3, graph

We clean (PEP8 and avoid `.vertices` / `.edges`) methods related to graph visualization: `_color_by_label`, `latex_options`, `set_latex_options`, `layout`, `layout_spring`, `layout_ranked`, `layout_extend_randomly`, `layout_circular`, `layout_tree`, `layout_graphviz`, `_layout_bounding_box`, `_circle_embedding`, `_line_embedding`, `graphplot`, `_rich_repr_`, `plot`, `show`, `plot3d`, `show3d`, `_keys_for_vertices`, `graphviz_string`, `graphviz_to_file_named`, and `tachyon_vertex_plot`.

Remaining calls to `.vertices`:
- `layout_circular` calls `_circle_embedding` with a list of vertices ordered by `.vertices`. Changing this will change the layout.

- `_keys_for_vertices` returns a mapping vertex to unique string identifier as required by `dot2tex`. It uses the order of `self.vertices()` to build the mapping. It is then used in `graphviz_string` and `layout_graphviz`. 

Any advice for these 2 cases is more than welcome ;)

Issue created by migration from https://trac.sagemath.org/ticket/26680





---

archive/issue_comments_371731.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-11T19:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371731",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_371732.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-11-11T19:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371732",
    "user": "https://github.com/dcoudert"
}
```

New commits:



---

archive/issue_comments_371733.json:
```json
{
    "body": "one failing doctest, and one plugin warning (missing `r'''`)",
    "created_at": "2018-12-03T07:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371733",
    "user": "https://github.com/fchapoton"
}
```

one failing doctest, and one plugin warning (missing `r'''`)



---

archive/issue_comments_371734.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-03T12:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371735.json:
```json
{
    "body": "I fixed the plugin warning, but I don't find the failing doctest. Which one is it ?",
    "created_at": "2018-12-03T12:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371735",
    "user": "https://github.com/dcoudert"
}
```

I fixed the plugin warning, but I don't find the failing doctest. Which one is it ?



---

archive/issue_comments_371736.json:
```json
{
    "body": "in the patchbot:\n\n```\nsage -t --long --warn-long 55.5 src/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 19671, in sage.graphs.generic_graph.GenericGraph.?\nFailed example:\n    P.plot3d(engine='tachyon', edge_colors=edge_colors).show() # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generic_graph.GenericGraph.?[20]>\", line 1, in <module>\n        P.plot3d(engine='tachyon', edge_colors=edge_colors).show() # long time\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 19788, in plot3d\n        for u,v,l in edge_colors[color]:\n    TypeError: 'int' object is not iterable\n```",
    "created_at": "2018-12-03T12:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371736",
    "user": "https://github.com/fchapoton"
}
```

in the patchbot:

```
sage -t --long --warn-long 55.5 src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 19671, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    P.plot3d(engine='tachyon', edge_colors=edge_colors).show() # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generic_graph.GenericGraph.?[20]>", line 1, in <module>
        P.plot3d(engine='tachyon', edge_colors=edge_colors).show() # long time
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19788, in plot3d
        for u,v,l in edge_colors[color]:
    TypeError: 'int' object is not iterable
```



---

archive/issue_comments_371737.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-03T12:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371738.json:
```json
{
    "body": "ok, fixed.",
    "created_at": "2018-12-03T12:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371738",
    "user": "https://github.com/dcoudert"
}
```

ok, fixed.



---

archive/issue_comments_371739.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-03T16:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371739",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_371740.json:
```json
{
    "body": "ok, let it be. But.. \n\n* not a good idea (rather a very bad idea) to mix **many** trivial pep8 changes with non trivial code changes. A few pep8 changes are ok. I myself try hard to refrain to do that, as tempting as it would be. Let us hope that your graph tickets will be reviewed nevertheless.\n\n* pep8 should not be enforced in the doctests, no way. It's only for the code.",
    "created_at": "2018-12-03T16:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371740",
    "user": "https://github.com/fchapoton"
}
```

ok, let it be. But.. 

* not a good idea (rather a very bad idea) to mix **many** trivial pep8 changes with non trivial code changes. A few pep8 changes are ok. I myself try hard to refrain to do that, as tempting as it would be. Let us hope that your graph tickets will be reviewed nevertheless.

* pep8 should not be enforced in the doctests, no way. It's only for the code.



---

archive/issue_comments_371741.json:
```json
{
    "body": "May be I should split the other tickets into easier to review tickets... Some of them are way too big.",
    "created_at": "2018-12-03T16:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371741",
    "user": "https://github.com/dcoudert"
}
```

May be I should split the other tickets into easier to review tickets... Some of them are way too big.



---

archive/issue_events_066131.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-07T12:10:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26680#event-66131"
}
```



---

archive/issue_comments_371742.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-07T12:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26680",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26680#issuecomment-371742",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
