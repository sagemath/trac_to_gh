# Issue 26249: port Sage to FreeBSD 12

archive/issues_026012.json:
```json
{
    "assignees": [],
    "body": "In FreeBSD 12 the long-standing incompleteness of its libm has been helped. This simplifies a lot, compared to #22679.\n\nWe will not try to work around the toolchain [problem related to gfortran/libgcc_s](https://wiki.freebsd.org/libgcc%20problem). Instead, we just [add a line](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=208120#c14) at the end of `/etc/libmap.conf` as\nfollows:\n\n```\nlibgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1\n```\nAlso, we create the following symbolic links:\n\n```\n$ ls -l ~/bin\ntotal 0\nlrwxr-xr-x  1 dima  dima  20 Apr 27 12:49 make -> /usr/local/bin/gmake\nlrwxr-xr-x  1 dima  dima  21 Apr 27 13:46 patch -> /usr/local/bin/gpatch\n```\nand use the standard shell, `/bin/sh`. In `~/.profile` we put\n\n```\nexport LDFLAGS=\"-L/usr/local/lib\"\nexport CFLAGS=\"-I/usr/local/include\"\nexport CXXFLAGS=$CFLAGS\nexport CPPFLAGS=$CFLAGS\nexport FCFLAGS=$CFLAGS\nexport FFLAGS=$CFLAGS\n```\nto account for clang not looking into `/usr/local` by default.\n\n\nThings to fix:\n\n* #26250 (fixes to rubiks)\n* #27764 (a fix to flint)\n* #26253 (update of psutils)\n* yasm check is broken on FreeBSD (it's always YES!)\n* #26602 (cephes removed)\n* #26287 (update to gc, to the FreeBSD's version)\n* #26288 (update to matplotlib, fixes compilation errors)\n* #26190 (update to latte_int---which is an optional package)\n* #26733 (update to openblas)\n* #26315 (update to giac, to be able to use clang 6.0.1)\n* #27262 (needed to link `sagelib` to libs from /usr/local/lib)\n\n---\nThere is some hope that the `libgcc_s.so.1` problem will finally be [fixed in FreeBSD https://lists.freebsd.org/pipermail/freebsd-ports/2019-April/115972.html]\n\nThe strategy which would pay off to make Sage an \"easy\" FreeBSD port is to add/enhance  as many needed by Sage external libraries as separate ports into FreeBSD, so that Sage does not need to vendor this. To this end, #27330 is very relevant ticket.\n\nA first foray into this is enhancing FreeBSD's port of flint2 to be linkable with NTL (something that is a requirement for flint2 in Sage), see [here](https://lists.freebsd.org/pipermail/freebsd-ports/2019-February/115504.html). The necessary work on the flint2 side has been done in the meantime, see https://github.com/wbhart/flint2/pull/543 - so now it's only the FreeBSD part that needs to be done.\n\nFew obvious other candidates for a port in FreeBSD are gf2x and ecm.\n\nDepends on #26253\nDepends on #27764\n\nCC:  @mkoeppe\n\nComponent: **porting: BSD**\n\nAuthor: **Dima Pasechnik, Li-Wen Hsu**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26249_\n\n",
    "created_at": "2018-09-11T16:03:18Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20bsd",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/pending"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "port Sage to FreeBSD 12",
    "type": "issue",
    "updated_at": "2020-06-19T14:18:20Z",
    "url": "https://github.com/sagemath/sage/issues/26249",
    "user": "https://github.com/dimpase"
}
```
In FreeBSD 12 the long-standing incompleteness of its libm has been helped. This simplifies a lot, compared to #22679.

We will not try to work around the toolchain [problem related to gfortran/libgcc_s](https://wiki.freebsd.org/libgcc%20problem). Instead, we just [add a line](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=208120#c14) at the end of `/etc/libmap.conf` as
follows:

```
libgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1
```
Also, we create the following symbolic links:

```
$ ls -l ~/bin
total 0
lrwxr-xr-x  1 dima  dima  20 Apr 27 12:49 make -> /usr/local/bin/gmake
lrwxr-xr-x  1 dima  dima  21 Apr 27 13:46 patch -> /usr/local/bin/gpatch
```
and use the standard shell, `/bin/sh`. In `~/.profile` we put

```
export LDFLAGS="-L/usr/local/lib"
export CFLAGS="-I/usr/local/include"
export CXXFLAGS=$CFLAGS
export CPPFLAGS=$CFLAGS
export FCFLAGS=$CFLAGS
export FFLAGS=$CFLAGS
```
to account for clang not looking into `/usr/local` by default.


Things to fix:

* #26250 (fixes to rubiks)
* #27764 (a fix to flint)
* #26253 (update of psutils)
* yasm check is broken on FreeBSD (it's always YES!)
* #26602 (cephes removed)
* #26287 (update to gc, to the FreeBSD's version)
* #26288 (update to matplotlib, fixes compilation errors)
* #26190 (update to latte_int---which is an optional package)
* #26733 (update to openblas)
* #26315 (update to giac, to be able to use clang 6.0.1)
* #27262 (needed to link `sagelib` to libs from /usr/local/lib)

---
There is some hope that the `libgcc_s.so.1` problem will finally be [fixed in FreeBSD https://lists.freebsd.org/pipermail/freebsd-ports/2019-April/115972.html]

The strategy which would pay off to make Sage an "easy" FreeBSD port is to add/enhance  as many needed by Sage external libraries as separate ports into FreeBSD, so that Sage does not need to vendor this. To this end, #27330 is very relevant ticket.

A first foray into this is enhancing FreeBSD's port of flint2 to be linkable with NTL (something that is a requirement for flint2 in Sage), see [here](https://lists.freebsd.org/pipermail/freebsd-ports/2019-February/115504.html). The necessary work on the flint2 side has been done in the meantime, see https://github.com/wbhart/flint2/pull/543 - so now it's only the FreeBSD part that needs to be done.

Few obvious other candidates for a port in FreeBSD are gf2x and ecm.

Depends on #26253
Depends on #27764

CC:  @mkoeppe

Component: **porting: BSD**

Author: **Dima Pasechnik, Li-Wen Hsu**

_Issue created by migration from https://trac.sagemath.org/ticket/26249_





---

archive/issue_events_358885.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:03:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358885"
}
```



---

archive/issue_events_358886.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:03:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20bsd",
    "label_color": "0000b0",
    "label_name": "c: porting: bsd",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358886"
}
```



---

archive/issue_events_358887.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:03:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358887"
}
```



---

archive/issue_comments_404573.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,9 @@\n libgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1\n ```\n \n+Things to fix:\n+\n+* #26250\n+\n+* ...\n+\n``````\n",
    "created_at": "2018-09-11T16:09:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404573",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,9 @@
 libgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1
 ```
 
+Things to fix:
+
+* #26250
+
+* ...
+
``````




---

archive/issue_comments_404574.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,5 +11,5 @@\n \n * #26250\n \n-* ...\n+* #26252\n \n``````\n",
    "created_at": "2018-09-11T21:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404574",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,5 +11,5 @@
 
 * #26250
 
-* ...
+* #26252
 
``````




---

archive/issue_comments_404575.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n \n Things to fix:\n \n-* #26250\n+* #26250 (fixes to rubiks)\n+* #26252 (fixes to flint)\n+* #26253 (update of psutils)\n \n-* #26252\n-\n``````\n",
    "created_at": "2018-09-11T21:43:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404575",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 
 Things to fix:
 
-* #26250
+* #26250 (fixes to rubiks)
+* #26252 (fixes to flint)
+* #26253 (update of psutils)
 
-* #26252
-
``````




---

archive/issue_comments_404576.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,4 @@\n * #26250 (fixes to rubiks)\n * #26252 (fixes to flint)\n * #26253 (update of psutils)\n-\n+* yasm check is broken on FreeBSD (it's always YES!)\n``````\n",
    "created_at": "2018-09-11T22:07:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404576",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,4 @@
 * #26250 (fixes to rubiks)
 * #26252 (fixes to flint)
 * #26253 (update of psutils)
-
+* yasm check is broken on FreeBSD (it's always YES!)
``````




---

archive/issue_comments_404577.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,3 +13,4 @@\n * #26252 (fixes to flint)\n * #26253 (update of psutils)\n * yasm check is broken on FreeBSD (it's always YES!)\n+* cephes to be removed\n``````\n",
    "created_at": "2018-09-12T13:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404577",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,3 +13,4 @@
 * #26252 (fixes to flint)
 * #26253 (update of psutils)
 * yasm check is broken on FreeBSD (it's always YES!)
+* cephes to be removed
``````




---

archive/issue_comments_404578.json:
```json
{
    "body": "Author: **Dima Pasechnik, Li-Wen Hsu**",
    "created_at": "2018-09-12T15:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404578",
    "user": "https://github.com/lwhsu"
}
```

Author: **Dima Pasechnik, Li-Wen Hsu**



---

archive/issue_comments_404579.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n * #26253 (update of psutils)\n * yasm check is broken on FreeBSD (it's always YES!)\n * cephes to be removed\n+* #26287 (update to gc, to the FreeBSD's version)\n``````\n",
    "created_at": "2018-09-15T03:40:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404579",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 * #26253 (update of psutils)
 * yasm check is broken on FreeBSD (it's always YES!)
 * cephes to be removed
+* #26287 (update to gc, to the FreeBSD's version)
``````




---

archive/issue_comments_404580.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,4 @@\n * yasm check is broken on FreeBSD (it's always YES!)\n * cephes to be removed\n * #26287 (update to gc, to the FreeBSD's version)\n+* #26288 (update to matplotlib, fixes compilation errors)\n``````\n",
    "created_at": "2018-09-15T04:11:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404580",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,4 @@
 * yasm check is broken on FreeBSD (it's always YES!)
 * cephes to be removed
 * #26287 (update to gc, to the FreeBSD's version)
+* #26288 (update to matplotlib, fixes compilation errors)
``````




---

archive/issue_comments_404581.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,3 +16,4 @@\n * cephes to be removed\n * #26287 (update to gc, to the FreeBSD's version)\n * #26288 (update to matplotlib, fixes compilation errors)\n+* #26190 (update to latte_int---which is an optional package)\n``````\n",
    "created_at": "2018-09-15T11:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404581",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,3 +16,4 @@
 * cephes to be removed
 * #26287 (update to gc, to the FreeBSD's version)
 * #26288 (update to matplotlib, fixes compilation errors)
+* #26190 (update to latte_int---which is an optional package)
``````




---

archive/issue_comments_404582.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,9 @@\n * #26252 (fixes to flint)\n * #26253 (update of psutils)\n * yasm check is broken on FreeBSD (it's always YES!)\n-* cephes to be removed\n+* #26602 (cephes removed)\n * #26287 (update to gc, to the FreeBSD's version)\n * #26288 (update to matplotlib, fixes compilation errors)\n * #26190 (update to latte_int---which is an optional package)\n+* #26733 (update to openblas)\n+* #26315 (update to giac, to be able to use clang 6.0.1)\n``````\n",
    "created_at": "2018-11-21T17:46:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404582",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,9 @@
 * #26252 (fixes to flint)
 * #26253 (update of psutils)
 * yasm check is broken on FreeBSD (it's always YES!)
-* cephes to be removed
+* #26602 (cephes removed)
 * #26287 (update to gc, to the FreeBSD's version)
 * #26288 (update to matplotlib, fixes compilation errors)
 * #26190 (update to latte_int---which is an optional package)
+* #26733 (update to openblas)
+* #26315 (update to giac, to be able to use clang 6.0.1)
``````




---

archive/issue_events_358888.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-21T17:46:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358888"
}
```



---

archive/issue_events_358889.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-21T17:46:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358889"
}
```



---

archive/issue_comments_404583.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThis scipy [problem](https://github.com/sagemath/sage/issues/22679#comment:93) is still there.\n(while this works with the system's python2)\nIt's a matter of comparing the patches used there with what we do in Sage. Perhaps they disable multithreading...",
    "created_at": "2018-11-28T14:19:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404583",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

This scipy [problem](https://github.com/sagemath/sage/issues/22679#comment:93) is still there.
(while this works with the system's python2)
It's a matter of comparing the patches used there with what we do in Sage. Perhaps they disable multithreading...



---

archive/issue_comments_404584.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.",
    "created_at": "2018-11-29T09:32:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404584",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.



---

archive/issue_comments_404585.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@embray](#comment%3A12):\n> I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything. I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.\n\nI can give you access to the FreeBSD 12.0 VM I am running on GCE, this would be easier, I guess. (12.0 is still in beta/RC cycle, so installation is not straightforward, you basically need to build it from source).",
    "created_at": "2018-11-29T10:19:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404585",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@embray](#comment%3A12):
> I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything. I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.

I can give you access to the FreeBSD 12.0 VM I am running on GCE, this would be easier, I guess. (12.0 is still in beta/RC cycle, so installation is not straightforward, you basically need to build it from source).



---

archive/issue_comments_404586.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\ncurrently testing what we have here (with Sage 8.6) on the released FreeBSD 12.0",
    "created_at": "2019-01-20T22:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404586",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

currently testing what we have here (with Sage 8.6) on the released FreeBSD 12.0



---

archive/issue_comments_404587.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nthe next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299\n(pyexpat module does not build)",
    "created_at": "2019-02-10T09:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404587",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299
(pyexpat module does not build)



---

archive/issue_comments_404588.json:
```json
{
    "body": "Dependencies: **#27254**",
    "created_at": "2019-02-11T09:54:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404588",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#27254**



---

archive/issue_comments_404589.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@dimpase](#comment%3A15):\n> the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299\n> (pyexpat module does not build)\n\nfor the time being, working around this by not installing setuptools and pip for py3",
    "created_at": "2019-02-11T09:54:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404589",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@dimpase](#comment%3A15):
> the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299
> (pyexpat module does not build)

for the time being, working around this by not installing setuptools and pip for py3



---

archive/issue_comments_404590.json:
```json
{
    "body": "Changed dependencies from **#27254** to **#27254, #/26253**",
    "created_at": "2019-02-11T12:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404590",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27254** to **#27254, #/26253**



---

archive/issue_comments_404591.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,3 +19,4 @@\n * #26190 (update to latte_int---which is an optional package)\n * #26733 (update to openblas)\n * #26315 (update to giac, to be able to use clang 6.0.1)\n+* #27262 (needed to link `sagelib` to libs from /usr/local/lib)\n``````\n",
    "created_at": "2019-02-12T17:10:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404591",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,3 +19,4 @@
 * #26190 (update to latte_int---which is an optional package)
 * #26733 (update to openblas)
 * #26315 (update to giac, to be able to use clang 6.0.1)
+* #27262 (needed to link `sagelib` to libs from /usr/local/lib)
``````




---

archive/issue_comments_404592.json:
```json
{
    "body": "Changed dependencies from **#27254, #/26253** to **#27254, #26253, #27262**",
    "created_at": "2019-02-12T17:10:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404592",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27254, #/26253** to **#27254, #26253, #27262**



---

archive/issue_comments_404593.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,3 +20,12 @@\n * #26733 (update to openblas)\n * #26315 (update to giac, to be able to use clang 6.0.1)\n * #27262 (needed to link `sagelib` to libs from /usr/local/lib)\n+\n+---\n+There is some hope that the `libgcc_s.so.1` problem will finally be [fixed in FreeBSD https://lists.freebsd.org/pipermail/freebsd-ports/2019-April/115972.html]\n+\n+The strategy which would pay off to make Sage an \"easy\" FreeBSD port is to add/enhance  as many needed by Sage external libraries as separate ports into FreeBSD, so that Sage does not need to vendor this. To this end, #27330 is very relevant ticket.\n+\n+A first foray into this is enhancing FreeBSD's port of flint2 to be linkable with NTL (something that is a requirement for flint2 in Sage), see [here](https://lists.freebsd.org/pipermail/freebsd-ports/2019-February/115504.html). The necessary work on the flint2 side has been done in the meantime, see https://github.com/wbhart/flint2/pull/543 - so now it's only the FreeBSD part that needs to be done.\n+\n+Few obvious other candidates for a port in FreeBSD are gf2x and ecm.\n``````\n",
    "created_at": "2019-04-08T19:48:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404593",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,3 +20,12 @@
 * #26733 (update to openblas)
 * #26315 (update to giac, to be able to use clang 6.0.1)
 * #27262 (needed to link `sagelib` to libs from /usr/local/lib)
+
+---
+There is some hope that the `libgcc_s.so.1` problem will finally be [fixed in FreeBSD https://lists.freebsd.org/pipermail/freebsd-ports/2019-April/115972.html]
+
+The strategy which would pay off to make Sage an "easy" FreeBSD port is to add/enhance  as many needed by Sage external libraries as separate ports into FreeBSD, so that Sage does not need to vendor this. To this end, #27330 is very relevant ticket.
+
+A first foray into this is enhancing FreeBSD's port of flint2 to be linkable with NTL (something that is a requirement for flint2 in Sage), see [here](https://lists.freebsd.org/pipermail/freebsd-ports/2019-February/115504.html). The necessary work on the flint2 side has been done in the meantime, see https://github.com/wbhart/flint2/pull/543 - so now it's only the FreeBSD part that needs to be done.
+
+Few obvious other candidates for a port in FreeBSD are gf2x and ecm.
``````




---

archive/issue_comments_404594.json:
```json
{
    "body": "Changed dependencies from **#27254, #26253, #27262** to **#27254, #26253, #27262, #27764**",
    "created_at": "2019-05-03T16:16:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404594",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27254, #26253, #27262** to **#27254, #26253, #27262, #27764**



---

archive/issue_comments_404595.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n Things to fix:\n \n * #26250 (fixes to rubiks)\n-* #26252 (fixes to flint)\n+* #27764 (a fix to flint)\n * #26253 (update of psutils)\n * yasm check is broken on FreeBSD (it's always YES!)\n * #26602 (cephes removed)\n``````\n",
    "created_at": "2019-05-03T16:16:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404595",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 Things to fix:
 
 * #26250 (fixes to rubiks)
-* #26252 (fixes to flint)
+* #27764 (a fix to flint)
 * #26253 (update of psutils)
 * yasm check is broken on FreeBSD (it's always YES!)
 * #26602 (cephes removed)
``````




---

archive/issue_events_358890.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-03T16:16:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358890"
}
```



---

archive/issue_events_358891.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-03T16:16:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358891"
}
```



---

archive/issue_comments_404596.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404596",
    "user": "https://github.com/embray"
}
```

<div id="comment:21" align="right">comment:21</div>

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_events_358892.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:54:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358892"
}
```



---

archive/issue_events_358893.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-08-31T21:37:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26249#event-358893"
}
```



---

archive/issue_comments_404597.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,6 +6,26 @@\n ```\n libgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1\n ```\n+Also, we create the following symbolic links:\n+\n+```\n+$ ls -l ~/bin\n+total 0\n+lrwxr-xr-x  1 dima  dima  20 Apr 27 12:49 make -> /usr/local/bin/gmake\n+lrwxr-xr-x  1 dima  dima  21 Apr 27 13:46 patch -> /usr/local/bin/gpatch\n+```\n+and use the standard shell, `/bin/sh`. In `~/.profile` we put\n+\n+```\n+export LDFLAGS=\"-L/usr/local/lib\"\n+export CFLAGS=\"-I/usr/local/include\"\n+export CXXFLAGS=$CFLAGS\n+export CPPFLAGS=$CFLAGS\n+export FCFLAGS=$CFLAGS\n+export FFLAGS=$CFLAGS\n+```\n+to account for clang not looking into `/usr/local` by default.\n+\n \n Things to fix:\n \n``````\n",
    "created_at": "2019-08-31T21:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404597",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,6 +6,26 @@
 ```
 libgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1
 ```
+Also, we create the following symbolic links:
+
+```
+$ ls -l ~/bin
+total 0
+lrwxr-xr-x  1 dima  dima  20 Apr 27 12:49 make -> /usr/local/bin/gmake
+lrwxr-xr-x  1 dima  dima  21 Apr 27 13:46 patch -> /usr/local/bin/gpatch
+```
+and use the standard shell, `/bin/sh`. In `~/.profile` we put
+
+```
+export LDFLAGS="-L/usr/local/lib"
+export CFLAGS="-I/usr/local/include"
+export CXXFLAGS=$CFLAGS
+export CPPFLAGS=$CFLAGS
+export FCFLAGS=$CFLAGS
+export FFLAGS=$CFLAGS
+```
+to account for clang not looking into `/usr/local` by default.
+
 
 Things to fix:
 
``````




---

archive/issue_comments_404598.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nto use flang (which is a possibility on FreeBSD at least), one needs\n\n```diff\n--- a/build/pkgs/numpy/spkg-install\n+++ b/build/pkgs/numpy/spkg-install\n@@ -18,7 +18,7 @@ export FFLAGS=\"$FFLAGS -fPIC\"\n export FCFLAGS=\"$FCFLAGS -fPIC\"\n \n export NUMPY_FCONFIG=\"config_fc --noopt --noarch\"\n-\n+export LDFLAGS=\"$LDFLAGS -lexecinfo\" # needed for flang\n ################################################\n \n sage-python23 setup.py \\\n```\ndue to it being somewhat underlinked.",
    "created_at": "2019-08-31T21:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404598",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

to use flang (which is a possibility on FreeBSD at least), one needs

```diff
--- a/build/pkgs/numpy/spkg-install
+++ b/build/pkgs/numpy/spkg-install
@@ -18,7 +18,7 @@ export FFLAGS="$FFLAGS -fPIC"
 export FCFLAGS="$FCFLAGS -fPIC"
 
 export NUMPY_FCONFIG="config_fc --noopt --noarch"
-
+export LDFLAGS="$LDFLAGS -lexecinfo" # needed for flang
 ################################################
 
 sage-python23 setup.py \
```
due to it being somewhat underlinked.



---

archive/issue_comments_404599.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nAs I have to abandon the FreeBSD VM I've been using, I've pushed the current WIP branch\nto https://github.com/lwhsu/sagemath/commits/wip31082019\n\nTBC on another FreeBSD machine.",
    "created_at": "2019-08-31T21:42:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404599",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:23" align="right">comment:23</div>

As I have to abandon the FreeBSD VM I've been using, I've pushed the current WIP branch
to https://github.com/lwhsu/sagemath/commits/wip31082019

TBC on another FreeBSD machine.



---

archive/issue_comments_404600.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nA work-in-progress has been submitted to the FreeBSD Phabricator:\n\nhttps://reviews.freebsd.org/D24195\n\nIts aim is to upgrade the existing port to 9.0.\n\nDo not hesitate to comment or modify!",
    "created_at": "2020-03-26T16:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404600",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:24" align="right">comment:24</div>

A work-in-progress has been submitted to the FreeBSD Phabricator:

https://reviews.freebsd.org/D24195

Its aim is to upgrade the existing port to 9.0.

Do not hesitate to comment or modify!



---

archive/issue_comments_404601.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI think it'd be much better to use the work done on \n#27330 - you don't even need to build a special Python version, but use one on the system!\n(And, of course, use autoconf, don't mess around with generated ./configure)",
    "created_at": "2020-03-26T17:00:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404601",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

I think it'd be much better to use the work done on 
#27330 - you don't even need to build a special Python version, but use one on the system!
(And, of course, use autoconf, don't mess around with generated ./configure)



---

archive/issue_comments_404602.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI used the external packages when this is possible with the released Sage 9.0. This version still builds the bundled Python. I guess that the progress done with #27330 will be available in the next release?\n\nThanks for your comment, I'll try to use autoconf.",
    "created_at": "2020-03-26T17:38:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404602",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:26" align="right">comment:26</div>

I used the external packages when this is possible with the released Sage 9.0. This version still builds the bundled Python. I guess that the progress done with #27330 will be available in the next release?

Thanks for your comment, I'll try to use autoconf.



---

archive/issue_comments_404603.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nA large part of #27330 is already in 9.0.\nBut yes, I think it's much better to wait for 9.1, or actually start using 9.1.betas \n(we're near the first release candidate).\n\nIIRC FreeBSD has quite a few packages available, although they aren't always built\nwith pre-reqs needed for Sage, e.g. Flint is not built with NTL support.",
    "created_at": "2020-03-26T17:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404603",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

A large part of #27330 is already in 9.0.
But yes, I think it's much better to wait for 9.1, or actually start using 9.1.betas 
(we're near the first release candidate).

IIRC FreeBSD has quite a few packages available, although they aren't always built
with pre-reqs needed for Sage, e.g. Flint is not built with NTL support.



---

archive/issue_comments_404604.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nGreat! I'll try to work on 9.1 ASAP.\n\nYou are right about Flint: the ports used Cmake, and the NTL option is not available in CMakeLists.txt (and it is not even enabled by default with configure).\n\nBut we can change that, and I just sent a PR to fix it:\n\nhttps://bugs.freebsd.org/bugzilla/show_bug.cgi?id=245085",
    "created_at": "2020-03-26T21:07:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404604",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:28" align="right">comment:28</div>

Great! I'll try to work on 9.1 ASAP.

You are right about Flint: the ports used Cmake, and the NTL option is not available in CMakeLists.txt (and it is not even enabled by default with configure).

But we can change that, and I just sent a PR to fix it:

https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=245085



---

archive/issue_comments_404605.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nAnd I just added a port for Cliquer, from your autotoolized version:\n\nhttps://www.freshports.org/math/cliquer/",
    "created_at": "2020-03-27T15:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404605",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:29" align="right">comment:29</div>

And I just added a port for Cliquer, from your autotoolized version:

https://www.freshports.org/math/cliquer/



---

archive/issue_comments_404606.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nThanks. I suggest that every Sage library/package mentioned in #27330 be made a FreeBSD port (some of them are), this should be enough to finish this task.\n\nWe have plans to turn Sage into a \"normal\" pip-installable Python library, but this probably won't happen before the end of the year.",
    "created_at": "2020-03-28T03:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404606",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:30" align="right">comment:30</div>

Thanks. I suggest that every Sage library/package mentioned in #27330 be made a FreeBSD port (some of them are), this should be enough to finish this task.

We have plans to turn Sage into a "normal" pip-installable Python library, but this probably won't happen before the end of the year.



---

archive/issue_comments_404607.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI recently also added eclib, m4ri, gf2x, gp2c and the Pari packages (elldata, galdata, galpol, nftables and seadata).\n\nAnd still going on!",
    "created_at": "2020-03-28T19:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404607",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:31" align="right">comment:31</div>

I recently also added eclib, m4ri, gf2x, gp2c and the Pari packages (elldata, galdata, galpol, nftables and seadata).

And still going on!



---

archive/issue_comments_404608.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nSome news: I have just updated the WIP-port to 9.1.beta9: it is available at\nhttps://reviews.freebsd.org/D24195\n\nEvery possible packages listed in #27330 are used as external packages, thanks for that!\n\nUnfortunately, there remain some problems, mostly caused by staging (DESTDIR): a lot of libraries are referring to the directory where they have been built: e.g.\n\nError: 'lib/python3.7/site-packages/PIL/_imagingft.so' is referring to /usr/ports/math/sage/work/stage\nError: 'lib/libldl.so.2.2.6' is referring to /usr/ports/math/sage/work/stage\n\nIs there some possibility to let them refer to relative directories?\nHow would you set SAGE_LOCAL?",
    "created_at": "2020-04-08T10:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404608",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:32" align="right">comment:32</div>

Some news: I have just updated the WIP-port to 9.1.beta9: it is available at
https://reviews.freebsd.org/D24195

Every possible packages listed in #27330 are used as external packages, thanks for that!

Unfortunately, there remain some problems, mostly caused by staging (DESTDIR): a lot of libraries are referring to the directory where they have been built: e.g.

Error: 'lib/python3.7/site-packages/PIL/_imagingft.so' is referring to /usr/ports/math/sage/work/stage
Error: 'lib/libldl.so.2.2.6' is referring to /usr/ports/math/sage/work/stage

Is there some possibility to let them refer to relative directories?
How would you set SAGE_LOCAL?



---

archive/issue_comments_404609.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nTo be more precise: I have played with SAGE_LOCAL and SAGE_DESTDIR.\n\nThe logical choice seemed to set SAGE_LOCAL=$PREFIX and SAGE_DESTDIR=$STAGEDIR, but this is not the case.",
    "created_at": "2020-04-10T16:58:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404609",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:33" align="right">comment:33</div>

To be more precise: I have played with SAGE_LOCAL and SAGE_DESTDIR.

The logical choice seemed to set SAGE_LOCAL=$PREFIX and SAGE_DESTDIR=$STAGEDIR, but this is not the case.



---

archive/issue_comments_404610.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nActually, to be more positive, it mostly works!\n\nLooking for the root of the problem, only 29 libraries are not fully staged - but of course, thereafter the other binaries using one of this library become affected.\n\nATM (with 9.1.beta9), my list of affected libraries is:\n\nlibamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libamd.so.2\n\nlibbraiding.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libbraiding.so.0\n\nlibbrial_groebner.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial_groebner.so.3\n\nlibbrial.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial.so.3\n\nlibbtf.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libbtf.so.1\n\nlibcamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcamd.so.2\n\nlibccolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libccolamd.so.2\n\nlibcddgmp.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libcddgmp.so.0\n\nlibcholmod.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libcholmod.so.3\n\nlibcolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcolamd.so.2\n\nlibecl.so.16.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libecl.so.16.1\n\nlibfactory-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libfactory-4.1.1.so\n\nlibfflas.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libfflas.so.1\n\nlibffpack.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libffpack.so.1\n\nlibgap.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libgap.so.0\n\nlibgc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libgc.so.1\n\nlibhomfly.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libhomfly.so.0\n\nlibiml.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libiml.so.1\n\nliblinbox.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/liblinbox.so.0\n\nliblrcalc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/liblrcalc.so.1\n\nlibomalloc-0.9.6.so => /usr/ports/math/sage/work/stage/usr/local/lib/libomalloc-0.9.6.so\n\nlibpolys-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libpolys-4.1.1.so\n\nlibppl.so.14 => /usr/ports/math/sage/work/stage/usr/local/lib/libppl.so.14\n\nlibpynac.so.18 => /usr/ports/math/sage/work/stage/usr/local/lib/libpynac.so.18\n\nlibsingular_resources-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libsingular_resources-4.1.1.so\n\nlibSingular-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libSingular-4.1.1.so\n\nlibsuitesparseconfig.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libsuitesparseconfig.so.5\n\nlibumfpack.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libumfpack.so.5\n\nlibzn_poly-0.9.so => /usr/ports/math/sage/work/stage/usr/local/lib/libzn_poly-0.9.so\n\nSome of them like libgc, brial, or fflas-ffpack should be fixed RSN (thanks to #27330 ).\n\nI guess that the most problematic case is libsuitesparseconfig.so, which is widely used.",
    "created_at": "2020-04-10T17:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404610",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:34" align="right">comment:34</div>

Actually, to be more positive, it mostly works!

Looking for the root of the problem, only 29 libraries are not fully staged - but of course, thereafter the other binaries using one of this library become affected.

ATM (with 9.1.beta9), my list of affected libraries is:

libamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libamd.so.2

libbraiding.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libbraiding.so.0

libbrial_groebner.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial_groebner.so.3

libbrial.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial.so.3

libbtf.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libbtf.so.1

libcamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcamd.so.2

libccolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libccolamd.so.2

libcddgmp.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libcddgmp.so.0

libcholmod.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libcholmod.so.3

libcolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcolamd.so.2

libecl.so.16.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libecl.so.16.1

libfactory-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libfactory-4.1.1.so

libfflas.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libfflas.so.1

libffpack.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libffpack.so.1

libgap.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libgap.so.0

libgc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libgc.so.1

libhomfly.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libhomfly.so.0

libiml.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libiml.so.1

liblinbox.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/liblinbox.so.0

liblrcalc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/liblrcalc.so.1

libomalloc-0.9.6.so => /usr/ports/math/sage/work/stage/usr/local/lib/libomalloc-0.9.6.so

libpolys-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libpolys-4.1.1.so

libppl.so.14 => /usr/ports/math/sage/work/stage/usr/local/lib/libppl.so.14

libpynac.so.18 => /usr/ports/math/sage/work/stage/usr/local/lib/libpynac.so.18

libsingular_resources-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libsingular_resources-4.1.1.so

libSingular-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libSingular-4.1.1.so

libsuitesparseconfig.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libsuitesparseconfig.so.5

libumfpack.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libumfpack.so.5

libzn_poly-0.9.so => /usr/ports/math/sage/work/stage/usr/local/lib/libzn_poly-0.9.so

Some of them like libgc, brial, or fflas-ffpack should be fixed RSN (thanks to #27330 ).

I guess that the most problematic case is libsuitesparseconfig.so, which is widely used.



---

archive/issue_comments_404611.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI cc Matthias, who has been doing a lot of work on improving Sage's installation.\nHe'd be able to understand the issue better than me, hopefully.",
    "created_at": "2020-04-11T15:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404611",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:35" align="right">comment:35</div>

I cc Matthias, who has been doing a lot of work on improving Sage's installation.
He'd be able to understand the issue better than me, hopefully.



---

archive/issue_comments_404612.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nThe problem is documented in build/pkgs/suitesparse/patches/03-buildflags.patch:\n\n\"Note that -L$(INSTALL_LIB) cannot be removed from LDFLAGS unless the package \nis broken into components. It is necessary as the components are progressively\ninstalled in INSTALL_LIB one after the other.\"\n\nIt has been reported in #28832 and fixed for OS X with -install_name, but this does not fix it for FreeBSD. I'll have to try other patches - unless suiteparse could be used from a system package? It is not yet listed in #27330 but would be awesome!",
    "created_at": "2020-04-11T18:50:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404612",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:36" align="right">comment:36</div>

The problem is documented in build/pkgs/suitesparse/patches/03-buildflags.patch:

"Note that -L$(INSTALL_LIB) cannot be removed from LDFLAGS unless the package 
is broken into components. It is necessary as the components are progressively
installed in INSTALL_LIB one after the other."

It has been reported in #28832 and fixed for OS X with -install_name, but this does not fix it for FreeBSD. I'll have to try other patches - unless suiteparse could be used from a system package? It is not yet listed in #27330 but would be awesome!



---

archive/issue_comments_404613.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nNow we have #29502 for suitesparse - not done yet.",
    "created_at": "2020-04-13T03:42:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404613",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

Now we have #29502 for suitesparse - not done yet.



---

archive/issue_comments_404614.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nSome news: after #29502 for suitesparse and #29024 for singular, only 13 libraries (+ of course the modules built around them!) cause problems with staging: libbraiding libbrial_groebner libbrial libecl libfflas libffpack libgap libgc libhomfly liblinbox libppl libpynac libzn_poly-0.\n\nAmong them, all are listed in #27330 (with or without a ticket), but libpynac. We do not even have pynac in the FreeBSD ports tree (but we have math/GiNaC) => it will be my next target.",
    "created_at": "2020-04-17T19:54:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404614",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:38" align="right">comment:38</div>

Some news: after #29502 for suitesparse and #29024 for singular, only 13 libraries (+ of course the modules built around them!) cause problems with staging: libbraiding libbrial_groebner libbrial libecl libfflas libffpack libgap libgc libhomfly liblinbox libppl libpynac libzn_poly-0.

Among them, all are listed in #27330 (with or without a ticket), but libpynac. We do not even have pynac in the FreeBSD ports tree (but we have math/GiNaC) => it will be my next target.



---

archive/issue_comments_404615.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nAfter giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!\n\nMeanwhile, our ports must be patched:\n\n- lang/ecl: add a symbolic link for $PREFIX/lib/ecl\n\n- math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)\n\nThey are not submitted yet, but if someone want to work on #29617 the patches are available at\n- https://people.freebsd.org/~thierry/lang_ecl.diff\n- https://people.freebsd.org/~thierry/math_maxima.diff",
    "created_at": "2020-04-29T16:48:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404615",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:39" align="right">comment:39</div>

After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!

Meanwhile, our ports must be patched:

- lang/ecl: add a symbolic link for $PREFIX/lib/ecl

- math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)

They are not submitted yet, but if someone want to work on #29617 the patches are available at
- https://people.freebsd.org/~thierry/lang_ecl.diff
- https://people.freebsd.org/~thierry/math_maxima.diff



---

archive/issue_comments_404616.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A39):\n> After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!\n> \n> Meanwhile, our ports must be patched:\n> \n> - lang/ecl: add a symbolic link for $PREFIX/lib/ecl\n> \n> - math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)\n\nthere are many free Common Lisp implementations, I suppose there can be lang/cl as a \"main\" package with a number of slaves, perhaps SBCL as a standard one.",
    "created_at": "2020-04-30T07:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404616",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@thierry-FreeBSD](#comment%3A39):
> After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!
> 
> Meanwhile, our ports must be patched:
> 
> - lang/ecl: add a symbolic link for $PREFIX/lib/ecl
> 
> - math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)

there are many free Common Lisp implementations, I suppose there can be lang/cl as a "main" package with a number of slaves, perhaps SBCL as a standard one.



---

archive/issue_comments_404617.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI'd recommend to add system package information for FreeBSD. See #29354 where this is done for Slackware (except for the bits that use docker)",
    "created_at": "2020-04-30T20:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404617",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

I'd recommend to add system package information for FreeBSD. See #29354 where this is done for Slackware (except for the bits that use docker)



---

archive/issue_comments_404618.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nWell, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!\n\nNext step: try to solve the problem with bad staging (non-respect of $DESTDIR) for the libraries built by Sage.",
    "created_at": "2020-05-04T21:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404618",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:42" align="right">comment:42</div>

Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!

Next step: try to solve the problem with bad staging (non-respect of $DESTDIR) for the libraries built by Sage.



---

archive/issue_comments_404619.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A42):\n> Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!\n\nYes, and the trick is to put the names of these packages in a freebsd.txt file to record the correspondence of spkg to FreeBSD port.",
    "created_at": "2020-05-05T02:03:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404619",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@thierry-FreeBSD](#comment%3A42):
> Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!

Yes, and the trick is to put the names of these packages in a freebsd.txt file to record the correspondence of spkg to FreeBSD port.



---

archive/issue_comments_404620.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nOK, I'll do it!",
    "created_at": "2020-05-05T07:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404620",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:44" align="right">comment:44</div>

OK, I'll do it!



---

archive/issue_comments_404621.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A44):\n> OK, I'll do it!\n\nDone in #29653.",
    "created_at": "2020-05-05T17:34:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404621",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@thierry-FreeBSD](#comment%3A44):
> OK, I'll do it!

Done in #29653.



---

archive/issue_comments_404622.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nNext, if you're serious about FreeBSD support, I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform.",
    "created_at": "2020-05-08T16:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404622",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

Next, if you're serious about FreeBSD support, I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform.



---

archive/issue_comments_404623.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@mkoeppe](#comment%3A46):\n> I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform. \n> \n\nThanks, this is interesting - but at this point a bit premature: there is no compilation error, but Sage is not yet ready for FreeBSD, even if we are making progress.",
    "created_at": "2020-05-10T13:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404623",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@mkoeppe](#comment%3A46):
> I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform. 
> 

Thanks, this is interesting - but at this point a bit premature: there is no compilation error, but Sage is not yet ready for FreeBSD, even if we are making progress.



---

archive/issue_comments_404624.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nWell, we are almost done!\n\nIt is not yet committable in the FreeBSD ports tree, because there are some pre-requisites (isl to be upgraded, and two possible forks for ECL and Maxima if no better solution is found).\n\nSee https://reviews.freebsd.org/D24195 for details.",
    "created_at": "2020-05-31T14:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404624",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:48" align="right">comment:48</div>

Well, we are almost done!

It is not yet committable in the FreeBSD ports tree, because there are some pre-requisites (isl to be upgraded, and two possible forks for ECL and Maxima if no better solution is found).

See https://reviews.freebsd.org/D24195 for details.



---

archive/issue_comments_404625.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nfor ecl I suggest to use a not yet merged\nhttps://trac.sagemath.org/ticket/22191\n\nwhich looks good on Linux and OpenBSD.\n\nalso a new release of Flint is coming.",
    "created_at": "2020-05-31T15:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404625",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:49" align="right">comment:49</div>

for ecl I suggest to use a not yet merged
https://trac.sagemath.org/ticket/22191

which looks good on Linux and OpenBSD.

also a new release of Flint is coming.



---

archive/issue_comments_404626.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nThanks! I'm just in discussion with the maintainers of these two ports (ECL and Maxima). Let's check this version.",
    "created_at": "2020-05-31T15:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404626",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:50" align="right">comment:50</div>

Thanks! I'm just in discussion with the maintainers of these two ports (ECL and Maxima). Let's check this version.



---

archive/issue_comments_404627.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\necl obviously must be upgraded to the latest release (maxima currently packaged with Sage works well with it, too).\n\nwhich bugs of maxima one prefers, is another question. :-)\n\nour experience with updating maxima is that each new release has serious regressions.",
    "created_at": "2020-05-31T16:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404627",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

ecl obviously must be upgraded to the latest release (maxima currently packaged with Sage works well with it, too).

which bugs of maxima one prefers, is another question. :-)

our experience with updating maxima is that each new release has serious regressions.



---

archive/issue_comments_404628.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nhere is Flint update ticket\nhttps://trac.sagemath.org/ticket/29719\n\nit is awaiting upstream putting in\nfinishing touches here:\nhttps://github.com/wbhart/flint2/issues/753",
    "created_at": "2020-05-31T16:26:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404628",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:52" align="right">comment:52</div>

here is Flint update ticket
https://trac.sagemath.org/ticket/29719

it is awaiting upstream putting in
finishing touches here:
https://github.com/wbhart/flint2/issues/753



---

archive/issue_comments_404629.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI guess that it is safer to get Sage 9.1 into our ports tree with the current dependencies.\n\nWe'll look to upgrade these afterwards!",
    "created_at": "2020-05-31T17:35:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404629",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:53" align="right">comment:53</div>

I guess that it is safer to get Sage 9.1 into our ports tree with the current dependencies.

We'll look to upgrade these afterwards!



---

archive/issue_comments_404630.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nWe are done, 9.1 is in the tree:\nhttps://www.freshports.org/math/sage/\n\nand we are working on the upgrade of ECL to 20.4.24:\nhttps://bugs.freebsd.org/bugzilla/show_bug.cgi?id=247283",
    "created_at": "2020-06-17T10:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404630",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:54" align="right">comment:54</div>

We are done, 9.1 is in the tree:
https://www.freshports.org/math/sage/

and we are working on the upgrade of ECL to 20.4.24:
https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=247283



---

archive/issue_comments_404631.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A54):\n> We are done, 9.1 is in the tree:\n> https://www.freshports.org/math/sage/\n\nThis is great!\n\nI guess we should make the Sagemath source FreeBSD-friendly, so that one can build\nSage from source using the standard ./configure + make route, right? This would need\n\n* adding data for the needed packages, that is, there should be\n  `build/pkgs/*/distros/freebsd.txt` files added with package names.\n\n* adding pre-reqs data: `build/pkgs/freebsd.txt` and `build/pkgs/freebsd-bootstrap.txt`\n\n* import patches you added in FreeBSD to Sage (if any)",
    "created_at": "2020-06-17T11:37:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404631",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@thierry-FreeBSD](#comment%3A54):
> We are done, 9.1 is in the tree:
> https://www.freshports.org/math/sage/

This is great!

I guess we should make the Sagemath source FreeBSD-friendly, so that one can build
Sage from source using the standard ./configure + make route, right? This would need

* adding data for the needed packages, that is, there should be
  `build/pkgs/*/distros/freebsd.txt` files added with package names.

* adding pre-reqs data: `build/pkgs/freebsd.txt` and `build/pkgs/freebsd-bootstrap.txt`

* import patches you added in FreeBSD to Sage (if any)



---

archive/issue_comments_404632.json:
```json
{
    "body": "Changed dependencies from **#27254, #26253, #27262, #27764** to **#26253, #27764**",
    "created_at": "2020-06-17T11:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404632",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27254, #26253, #27262, #27764** to **#26253, #27764**



---

archive/issue_comments_404633.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nThe most important patch concerns configure.ac: without it, you cannot even run configure!\n\nI submitted it with the system package information in #29653, but it has been rejected.\n\nThe other patches are mostly specific and related to the ports system, caused by differences in directories, but shouldn't be necessary for those trying to build Sage by themselves with the bundled packages.\n\nmkoeppe asked me to set up a testing infrastructure. I'm not familiar at all with that, but I'll try to do it (any pointers appreciated!).",
    "created_at": "2020-06-17T12:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404633",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:57" align="right">comment:57</div>

The most important patch concerns configure.ac: without it, you cannot even run configure!

I submitted it with the system package information in #29653, but it has been rejected.

The other patches are mostly specific and related to the ports system, caused by differences in directories, but shouldn't be necessary for those trying to build Sage by themselves with the bundled packages.

mkoeppe asked me to set up a testing infrastructure. I'm not familiar at all with that, but I'll try to do it (any pointers appreciated!).



---

archive/issue_comments_404634.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nI will look at #29653 - it needs a rebase over the latest 9.2.beta1 \n\nregarding testing - is docker ported to FreeBSD?\n\nAnyway, one can set a patchbot, for this one just needs a FreeBSD host that will pull branches and build/test them.",
    "created_at": "2020-06-17T13:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404634",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:58" align="right">comment:58</div>

I will look at #29653 - it needs a rebase over the latest 9.2.beta1 

regarding testing - is docker ported to FreeBSD?

Anyway, one can set a patchbot, for this one just needs a FreeBSD host that will pull branches and build/test them.



---

archive/issue_comments_404635.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThere exists a port of docker: https://www.freshports.org/sysutils/docker (but I never used it!).",
    "created_at": "2020-06-17T13:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404635",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:59" align="right">comment:59</div>

There exists a port of docker: https://www.freshports.org/sysutils/docker (but I never used it!).



---

archive/issue_comments_404636.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nI don't think docker port is production ready at the moment. I suggest the faster way would be having a github mirror and use hosted CI service: https://wiki.freebsd.org/HostedCI",
    "created_at": "2020-06-17T15:51:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404636",
    "user": "https://github.com/lwhsu"
}
```

<div id="comment:60" align="right">comment:60</div>

I don't think docker port is production ready at the moment. I suggest the faster way would be having a github mirror and use hosted CI service: https://wiki.freebsd.org/HostedCI



---

archive/issue_comments_404637.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A54):\n> We are done, 9.1 is in the tree:\n> https://www.freshports.org/math/sage/\n\nI've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6\n\nHow do I get the new port in there? Do I need a system update (if yes, to what?)?\nOr it's easier?\nI've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.",
    "created_at": "2020-06-19T10:59:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404637",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:61" align="right">comment:61</div>

Replying to [@thierry-FreeBSD](#comment%3A54):
> We are done, 9.1 is in the tree:
> https://www.freshports.org/math/sage/

I've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6

How do I get the new port in there? Do I need a system update (if yes, to what?)?
Or it's easier?
I've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.



---

archive/issue_comments_404638.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nYou did the right thing!\n\n- 12.1-RELEASE-p6 is OK\n\n- `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.",
    "created_at": "2020-06-19T11:30:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404638",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:62" align="right">comment:62</div>

You did the right thing!

- 12.1-RELEASE-p6 is OK

- `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.



---

archive/issue_comments_404639.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@dimpase](#comment%3A61):\n> Replying to [@thierry-FreeBSD](#comment%3A54):\n> > We are done, 9.1 is in the tree:\n> > https://www.freshports.org/math/sage/\n\n> \n> I've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6\n> \n> How do I get the new port in there? Do I need a system update (if yes, to what?)?\n> Or it's easier?\n> I've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.\n\nI guess there are two possibilities, one is portsnap is not updated yet (unlikely, IIRC it updates hourly), the other is it's tracking quarterly branch, and 9.1 is only in latest branch now.  I haven't used portsnap for a while so I might also be wrong.\n\nTo get the latest ports tree in real-time, you can try to use svn to checkout from:\n\nhttps://svn.freebsd.org/ports/head\n\nor git from\n\nhttps://github.com/freebsd/freebsd-ports",
    "created_at": "2020-06-19T11:32:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404639",
    "user": "https://github.com/lwhsu"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@dimpase](#comment%3A61):
> Replying to [@thierry-FreeBSD](#comment%3A54):
> > We are done, 9.1 is in the tree:
> > https://www.freshports.org/math/sage/

> 
> I've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6
> 
> How do I get the new port in there? Do I need a system update (if yes, to what?)?
> Or it's easier?
> I've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.

I guess there are two possibilities, one is portsnap is not updated yet (unlikely, IIRC it updates hourly), the other is it's tracking quarterly branch, and 9.1 is only in latest branch now.  I haven't used portsnap for a while so I might also be wrong.

To get the latest ports tree in real-time, you can try to use svn to checkout from:

https://svn.freebsd.org/ports/head

or git from

https://github.com/freebsd/freebsd-ports



---

archive/issue_comments_404640.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A62):\n> You did the right thing!\n> \n> - 12.1-RELEASE-p6 is OK\n> \n> - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.\n\nOK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)\n\n\nlwhsu - did you see my email about CI? (just checking)",
    "created_at": "2020-06-19T11:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404640",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:64" align="right">comment:64</div>

Replying to [@thierry-FreeBSD](#comment%3A62):
> You did the right thing!
> 
> - 12.1-RELEASE-p6 is OK
> 
> - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.

OK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)


lwhsu - did you see my email about CI? (just checking)



---

archive/issue_comments_404641.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@dimpase](#comment%3A64):\n> Replying to [@thierry-FreeBSD](#comment%3A62):\n> > You did the right thing!\n> > \n> > - 12.1-RELEASE-p6 is OK\n> > \n> > - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.\n\n> \n> OK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)\n\nYes there are two steps. One if for fetching the content and the other one is for actually updating the ports tree.  See portsnap(8)\n \n> lwhsu - did you see my email about CI? (just checking)\n\nYes, please forgive me for needing longer to response.",
    "created_at": "2020-06-19T14:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26249#issuecomment-404641",
    "user": "https://github.com/lwhsu"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@dimpase](#comment%3A64):
> Replying to [@thierry-FreeBSD](#comment%3A62):
> > You did the right thing!
> > 
> > - 12.1-RELEASE-p6 is OK
> > 
> > - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.

> 
> OK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)

Yes there are two steps. One if for fetching the content and the other one is for actually updating the ports tree.  See portsnap(8)
 
> lwhsu - did you see my email about CI? (just checking)

Yes, please forgive me for needing longer to response.
