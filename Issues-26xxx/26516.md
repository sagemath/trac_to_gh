# Issue 26516: Wrong sig_on_count in SharedMeatAxe

archive/issues_026279.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nWhen running doctests in my applications of SharedMeatAxe, `sig_on_count` reveals problems.\n\nComponent: **interfaces**\n\nKeywords: **libgap sig_on_count**\n\nAuthor: **Simon King**\n\nBranch/Commit: **[`6f876e7`](https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c)**\n\nReviewer: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26516_\n\n",
    "closed_at": "2019-01-23T14:17:59Z",
    "created_at": "2018-10-21T09:09:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Wrong sig_on_count in SharedMeatAxe",
    "type": "issue",
    "updated_at": "2019-01-23T14:17:59Z",
    "url": "https://github.com/sagemath/sage/issues/26516",
    "user": "https://github.com/simon-king-jena"
}
```
<div id="comment:0"></div>

When running doctests in my applications of SharedMeatAxe, `sig_on_count` reveals problems.

Component: **interfaces**

Keywords: **libgap sig_on_count**

Author: **Simon King**

Branch/Commit: **[`6f876e7`](https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c)**

Reviewer: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/26516_





---

archive/issue_events_362177.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-10-21T09:09:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362177"
}
```



---

archive/issue_events_362178.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-10-21T09:09:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362178"
}
```



---

archive/issue_events_362179.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-10-21T09:09:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362179"
}
```



---

archive/issue_events_362180.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-10-21T09:09:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362180"
}
```



---

archive/issue_comments_408838.json:
```json
{
    "body": "Replying to [@simon-king-jena](https://github.com/sagemath/sage/issues/26516#comment:0):\n> Proposed fix: move the sig_off() call to the \"finally\" clause, directly before libgap_exit()\n\nNo, that `finally` is meant for `libgap_exit`. So you need a nested `try`/`finally`:\n\n```\ntry:\n    sig_on()\n    try:\n        ...\n    finally:\n        sig_off\nfinally:\n    libgap_exit()\n```\nor something like that.",
    "created_at": "2018-10-21T09:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408838",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [@simon-king-jena](https://github.com/sagemath/sage/issues/26516#comment:0):
> Proposed fix: move the sig_off() call to the "finally" clause, directly before libgap_exit()

No, that `finally` is meant for `libgap_exit`. So you need a nested `try`/`finally`:

```
try:
    sig_on()
    try:
        ...
    finally:
        sig_off
finally:
    libgap_exit()
```
or something like that.



---

archive/issue_comments_408839.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,4 +26,4 @@\n ```\n So, sig_off() is only called when no error is raised. But in my applications, I am in fact catching errors raised by libgap. So, maybe it is no surprise that the sig_on/sig_off count got wrong.\n \n-Proposed fix: move the sig_off() call to the \"finally\" clause, directly before libgap_exit()\n+Proposed fix: wrap the `sig_off()` in an additional `try`/`finally` block.\n``````\n",
    "created_at": "2018-10-21T09:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408839",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,4 +26,4 @@
 ```
 So, sig_off() is only called when no error is raised. But in my applications, I am in fact catching errors raised by libgap. So, maybe it is no surprise that the sig_on/sig_off count got wrong.
 
-Proposed fix: move the sig_off() call to the "finally" clause, directly before libgap_exit()
+Proposed fix: wrap the `sig_off()` in an additional `try`/`finally` block.
``````




---

archive/issue_comments_408840.json:
```json
{
    "body": "Replying to [@simon-king-jena](https://github.com/sagemath/sage/issues/26516#comment:0):\n> But in my applications, I am in fact catching errors raised by libgap.\n\nCan you elaborate on what you mean with that? As far as I know, libgap is a C library, so how could it raise Python exceptions?",
    "created_at": "2018-10-21T09:38:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408840",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [@simon-king-jena](https://github.com/sagemath/sage/issues/26516#comment:0):
> But in my applications, I am in fact catching errors raised by libgap.

Can you elaborate on what you mean with that? As far as I know, libgap is a C library, so how could it raise Python exceptions?



---

archive/issue_comments_408841.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@jdemeyer](#comment%3A3):\n> Replying to [@simon-king-jena](https://github.com/sagemath/sage/issues/26516#comment:0):\n> > But in my applications, I am in fact catching errors raised by libgap.\n> \n> \n> Can you elaborate on what you mean with that? As far as I know, libgap is a C library, so how could it raise Python exceptions?\n\nRight. I use \"libgap\" synonymous to SageMath's libgap wrapper.\n\nAnyway, I am doing things like this:\n\n```\n    try:\n        G = G.MinimalGeneratingSet().Group()\n    except (RuntimeError, ValueError):\n        G = G.SmallGeneratingSet().Group()\n```\nFor some of my groups, the attempt to compute a minimal generating set fails, and if I understand correctly, the libgap wrapper would call sig_on(), then kindly ask libgap to compute the minimal generating set, and when this fails would not call sig_off() before raising a Python error.\n\nEDIT: I tested and found that *this* is not giving a sig_on_count() failure. But I am now going through the actual tests of my applications and will hopefully be able to create a minimal example.",
    "created_at": "2018-10-21T09:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408841",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@jdemeyer](#comment%3A3):
> Replying to [@simon-king-jena](https://github.com/sagemath/sage/issues/26516#comment:0):
> > But in my applications, I am in fact catching errors raised by libgap.
> 
> 
> Can you elaborate on what you mean with that? As far as I know, libgap is a C library, so how could it raise Python exceptions?

Right. I use "libgap" synonymous to SageMath's libgap wrapper.

Anyway, I am doing things like this:

```
    try:
        G = G.MinimalGeneratingSet().Group()
    except (RuntimeError, ValueError):
        G = G.SmallGeneratingSet().Group()
```
For some of my groups, the attempt to compute a minimal generating set fails, and if I understand correctly, the libgap wrapper would call sig_on(), then kindly ask libgap to compute the minimal generating set, and when this fails would not call sig_off() before raising a Python error.

EDIT: I tested and found that *this* is not giving a sig_on_count() failure. But I am now going through the actual tests of my applications and will hopefully be able to create a minimal example.



---

archive/issue_comments_408842.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@simon-king-jena](#comment%3A4):\n> if I understand correctly, the libgap wrapper would call sig_on(), then kindly ask libgap to compute the minimal generating set, and when this fails would not call sig_off() before raising a Python error.\n\nNo, the code that you posted in this ticket is correct in that sense. Libgap error handling in Sage uses `sig_error()` (see `error_handler` in `src/sage/libs/gap/util.pyx`). For that, there must *not* be a `sig_off()` call.\n\n> But I am now going through the actual tests of my applications and will hopefully be able to create a minimal example.\n\nPlease do.",
    "created_at": "2018-10-21T10:43:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408842",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@simon-king-jena](#comment%3A4):
> if I understand correctly, the libgap wrapper would call sig_on(), then kindly ask libgap to compute the minimal generating set, and when this fails would not call sig_off() before raising a Python error.

No, the code that you posted in this ticket is correct in that sense. Libgap error handling in Sage uses `sig_error()` (see `error_handler` in `src/sage/libs/gap/util.pyx`). For that, there must *not* be a `sig_off()` call.

> But I am now going through the actual tests of my applications and will hopefully be able to create a minimal example.

Please do.



---

archive/issue_comments_408843.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@jdemeyer](#comment%3A5):\n> Replying to [@simon-king-jena](#comment%3A4):\n> > if I understand correctly, the libgap wrapper would call sig_on(), then kindly ask libgap to compute the minimal generating set, and when this fails would not call sig_off() before raising a Python error.\n> \n> \n> No, the code that you posted in this ticket is correct in that sense. Libgap error handling in Sage uses `sig_error()` (see `error_handler` in `src/sage/libs/gap/util.pyx`). For that, there must *not* be a `sig_off()` call.\n\nI see. In that case, my original assessment was very likely wrong. I have moved my cohomology programs from using gap-via-pexpect to using gap-via-libgap, and so it seemed very likely to me that the problem came from that move, even more so when it seemed to me that sig_off() was forgotten in basically all try-except-finally clauses in sage/libs/gap/*.\n\nCurrently, my smallest example triggering sig_on_count to complain is an example in which another library results in an error in an example that previously worked. So, very likely the wrong sig_on/off count comes from there, not from libgap.",
    "created_at": "2018-10-21T10:57:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408843",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@jdemeyer](#comment%3A5):
> Replying to [@simon-king-jena](#comment%3A4):
> > if I understand correctly, the libgap wrapper would call sig_on(), then kindly ask libgap to compute the minimal generating set, and when this fails would not call sig_off() before raising a Python error.
> 
> 
> No, the code that you posted in this ticket is correct in that sense. Libgap error handling in Sage uses `sig_error()` (see `error_handler` in `src/sage/libs/gap/util.pyx`). For that, there must *not* be a `sig_off()` call.

I see. In that case, my original assessment was very likely wrong. I have moved my cohomology programs from using gap-via-pexpect to using gap-via-libgap, and so it seemed very likely to me that the problem came from that move, even more so when it seemed to me that sig_off() was forgotten in basically all try-except-finally clauses in sage/libs/gap/*.

Currently, my smallest example triggering sig_on_count to complain is an example in which another library results in an error in an example that previously worked. So, very likely the wrong sig_on/off count comes from there, not from libgap.



---

archive/issue_comments_408844.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@simon-king-jena](#comment%3A6):\n> Currently, my smallest example triggering sig_on_count to complain is an example in which another library results in an error in an example that previously worked. So, very likely the wrong sig_on/off count comes from there, not from libgap.\n\nActually it seems that the problem rather lies in the SharedMeatAxe wrapper, not in the libgap wrapper. Namely, when wrapped libmtx functions are called, they are encapsulated into sig_on/sig_off, but the wrapper also translates propagated C errors into Python errors. So, presumable when such error is raised, sig_off ought to be called.\n\nQuestion on the way to proceed:\n- Change the topic of this ticket from libgap wrapper to libmtx wrapper?\n- Resolve this ticket as \"invalid/won't fix\" and open a new ticket addressing the libmtx wrapper?",
    "created_at": "2018-10-21T11:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408844",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@simon-king-jena](#comment%3A6):
> Currently, my smallest example triggering sig_on_count to complain is an example in which another library results in an error in an example that previously worked. So, very likely the wrong sig_on/off count comes from there, not from libgap.

Actually it seems that the problem rather lies in the SharedMeatAxe wrapper, not in the libgap wrapper. Namely, when wrapped libmtx functions are called, they are encapsulated into sig_on/sig_off, but the wrapper also translates propagated C errors into Python errors. So, presumable when such error is raised, sig_off ought to be called.

Question on the way to proceed:
- Change the topic of this ticket from libgap wrapper to libmtx wrapper?
- Resolve this ticket as "invalid/won't fix" and open a new ticket addressing the libmtx wrapper?



---

archive/issue_comments_408845.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nTechnical question about sig_on/sig_off, sig_check, and sig_error.\n\nAssume that in the error handler of the libmtx wrapper I call sig_error, similar to what is done in the case of libgap. Would it be needed to henceforth only use sig_on/sig_off, but not sig_check? Namely, when calling sig_error, it is required that sig_on has been called before.\n\nAnd if that's really the case, then maybe it would be good to know about the use cases of the different sig_* functions. So far, I thought it is like this:\n- Use sig_on/sig_off arount a library call that potentially takes a long time.\n- Use sig_check when there is a tight loop involving library calls, as that's faster than sig_on/sig_off.\n- I didn't know at all about sig_error.\n\nSo, is it really the case that I have to accept the slow-down that comes from being forced to use sig_on/off instead of sig_check?\n\nIn any case, I realised that I need to go through matrix_gfpn_dense, as there are many library calls that are in fact not wrapped into sig_on/off pairs.",
    "created_at": "2018-10-21T13:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408845",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

Technical question about sig_on/sig_off, sig_check, and sig_error.

Assume that in the error handler of the libmtx wrapper I call sig_error, similar to what is done in the case of libgap. Would it be needed to henceforth only use sig_on/sig_off, but not sig_check? Namely, when calling sig_error, it is required that sig_on has been called before.

And if that's really the case, then maybe it would be good to know about the use cases of the different sig_* functions. So far, I thought it is like this:
- Use sig_on/sig_off arount a library call that potentially takes a long time.
- Use sig_check when there is a tight loop involving library calls, as that's faster than sig_on/sig_off.
- I didn't know at all about sig_error.

So, is it really the case that I have to accept the slow-down that comes from being forced to use sig_on/off instead of sig_check?

In any case, I realised that I need to go through matrix_gfpn_dense, as there are many library calls that are in fact not wrapped into sig_on/off pairs.



---

archive/issue_comments_408846.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@simon-king-jena](#comment%3A8):\n> Technical question about sig_on/sig_off, sig_check, and sig_error.\n> \n> Assume that in the error handler of the libmtx wrapper I call sig_error, similar to what is done in the case of libgap. Would it be needed to henceforth only use sig_on/sig_off, but not sig_check? Namely, when calling sig_error, it is required that sig_on has been called before.\n\nAbsolutely.\n\n> And if that's really the case, then maybe it would be good to know about the use cases of the different sig_* functions. So far, I thought it is like this:\n> - Use sig_on/sig_off arount a library call that potentially takes a long time.\n> - Use sig_check when there is a tight loop involving library calls, as that's faster than sig_on/sig_off.\n\nThat's more or less correct.\n\n> - I didn't know at all about sig_error.\n\n`sig_error` is quite specialized to handle errors from a C library in a callback. But for SharedMeatAxe, this doesn't seem to be needed since it has a way to deal with errors already.\n\nConclusion: the best solution is probably to wrap errors from SharedMeatAxe as\n\n```\nsig_on()\ntry:\n    # MeatAxe call which might raise a Python exception\nfinally:\n    sig_off()\n```",
    "created_at": "2018-10-21T16:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408846",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@simon-king-jena](#comment%3A8):
> Technical question about sig_on/sig_off, sig_check, and sig_error.
> 
> Assume that in the error handler of the libmtx wrapper I call sig_error, similar to what is done in the case of libgap. Would it be needed to henceforth only use sig_on/sig_off, but not sig_check? Namely, when calling sig_error, it is required that sig_on has been called before.

Absolutely.

> And if that's really the case, then maybe it would be good to know about the use cases of the different sig_* functions. So far, I thought it is like this:
> - Use sig_on/sig_off arount a library call that potentially takes a long time.
> - Use sig_check when there is a tight loop involving library calls, as that's faster than sig_on/sig_off.

That's more or less correct.

> - I didn't know at all about sig_error.

`sig_error` is quite specialized to handle errors from a C library in a callback. But for SharedMeatAxe, this doesn't seem to be needed since it has a way to deal with errors already.

Conclusion: the best solution is probably to wrap errors from SharedMeatAxe as

```
sig_on()
try:
    # MeatAxe call which might raise a Python exception
finally:
    sig_off()
```



---

archive/issue_comments_408847.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,29 +1 @@\n-When running doctests in my applications of libgap, sig_on_count reveals problems.\n-\n-Indeed, in `src/sage/libs/gap/*`, one often sees constructions like the following:\n-\n-```python\n-        try:\n-            sig_on()\n-            result = libGAP_EQ(self.value, c_other.value)\n-            sig_off()\n-        except RuntimeError as msg:\n-            raise ValueError('libGAP: cannot compare equality: '+str(msg))\n-        finally:\n-            libgap_exit()\n-...\n-        try:\n-            libgap_enter()\n-            sig_on()\n-            result = libGAP_SUM(self.value, (<GapElement>right).value)\n-            sig_off()\n-        except RuntimeError as msg:\n-            libGAP_ClearError()\n-            raise ValueError('libGAP: '+str(msg))\n-        finally:\n-            libgap_exit()\n-...\n-```\n-So, sig_off() is only called when no error is raised. But in my applications, I am in fact catching errors raised by libgap. So, maybe it is no surprise that the sig_on/sig_off count got wrong.\n-\n-Proposed fix: wrap the `sig_off()` in an additional `try`/`finally` block.\n+When running doctests in my applications of SharedMeatAxe, `sig_on_count` reveals problems.\n``````\n",
    "created_at": "2018-10-21T16:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408847",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,29 +1 @@
-When running doctests in my applications of libgap, sig_on_count reveals problems.
-
-Indeed, in `src/sage/libs/gap/*`, one often sees constructions like the following:
-
-```python
-        try:
-            sig_on()
-            result = libGAP_EQ(self.value, c_other.value)
-            sig_off()
-        except RuntimeError as msg:
-            raise ValueError('libGAP: cannot compare equality: '+str(msg))
-        finally:
-            libgap_exit()
-...
-        try:
-            libgap_enter()
-            sig_on()
-            result = libGAP_SUM(self.value, (<GapElement>right).value)
-            sig_off()
-        except RuntimeError as msg:
-            libGAP_ClearError()
-            raise ValueError('libGAP: '+str(msg))
-        finally:
-            libgap_exit()
-...
-```
-So, sig_off() is only called when no error is raised. But in my applications, I am in fact catching errors raised by libgap. So, maybe it is no surprise that the sig_on/sig_off count got wrong.
-
-Proposed fix: wrap the `sig_off()` in an additional `try`/`finally` block.
+When running doctests in my applications of SharedMeatAxe, `sig_on_count` reveals problems.
``````




---

archive/issue_events_362181.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-21T16:05:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "title_is": "Wrong sig_on_count in SharedMeatAxe",
    "title_was": "Wrong sig_on_count in libgap",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362181"
}
```



---

archive/issue_comments_408848.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@simon-king-jena](#comment%3A8):\n> - Use sig_check when there is a tight loop involving library calls, as that's faster than sig_on/sig_off.\n\nActually, a more important reason is not so much that it's faster but safer too. `sig_on()`/`sig_off()` is really \"use this only when you really know what you are doing\" while `sig_check()` is pretty foolproof.",
    "created_at": "2018-10-21T16:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408848",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@simon-king-jena](#comment%3A8):
> - Use sig_check when there is a tight loop involving library calls, as that's faster than sig_on/sig_off.

Actually, a more important reason is not so much that it's faster but safer too. `sig_on()`/`sig_off()` is really "use this only when you really know what you are doing" while `sig_check()` is pretty foolproof.



---

archive/issue_comments_408849.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI suppose changing title and description means I should use **this** ticket to fix the libmtx wrapper, rather than create a new ticket.\n\nReplying to [@jdemeyer](#comment%3A9):\n> `sig_error` is quite specialized to handle errors from a C library in a callback. But for SharedMeatAxe, this doesn't seem to be needed since it has a way to deal with errors already.\n\nIn SharedMeatAxe, in contrast to MeatAxe, I am consequently propagating error values, so that a program calling a library function can take proper action when an error occurs. MeatAxe does make it possible to have a custom error handler, which I am using here of course.\n\nMaybe I am misunderstanding the role of sig_*. Namely, the library functions have an error return value, and Cython knows about it (it is declared in the .pxd files). So, a Python error is raised regardless whether sig_on/sig_off is involved or not.\n\nIs it correct that the only added bonus of using sig_on/sig_off is that the user can interrupt with ctrl-c?",
    "created_at": "2018-10-21T16:56:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408849",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:11" align="right">comment:11</div>

I suppose changing title and description means I should use **this** ticket to fix the libmtx wrapper, rather than create a new ticket.

Replying to [@jdemeyer](#comment%3A9):
> `sig_error` is quite specialized to handle errors from a C library in a callback. But for SharedMeatAxe, this doesn't seem to be needed since it has a way to deal with errors already.

In SharedMeatAxe, in contrast to MeatAxe, I am consequently propagating error values, so that a program calling a library function can take proper action when an error occurs. MeatAxe does make it possible to have a custom error handler, which I am using here of course.

Maybe I am misunderstanding the role of sig_*. Namely, the library functions have an error return value, and Cython knows about it (it is declared in the .pxd files). So, a Python error is raised regardless whether sig_on/sig_off is involved or not.

Is it correct that the only added bonus of using sig_on/sig_off is that the user can interrupt with ctrl-c?



---

archive/issue_comments_408850.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@simon-king-jena](#comment%3A11):\n> Is it correct that the only added bonus of using sig_on/sig_off is that the user can interrupt with ctrl-c?\n\nYes.",
    "created_at": "2018-10-21T17:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408850",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@simon-king-jena](#comment%3A11):
> Is it correct that the only added bonus of using sig_on/sig_off is that the user can interrupt with ctrl-c?

Yes.



---

archive/issue_comments_408851.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@jdemeyer](#comment%3A12):\n> Replying to [@simon-king-jena](#comment%3A11):\n> > Is it correct that the only added bonus of using sig_on/sig_off is that the user can interrupt with ctrl-c?\n> \n> \n> Yes.\n\nOK, in that case I should use\n\n```\nsig_on()\ntry:\n    <library call>\nfinally:\n    sig_off()\n```\nonly for functions that potentially run long enough so that it makes sense for them being interruptible.",
    "created_at": "2018-10-21T17:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408851",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@jdemeyer](#comment%3A12):
> Replying to [@simon-king-jena](#comment%3A11):
> > Is it correct that the only added bonus of using sig_on/sig_off is that the user can interrupt with ctrl-c?
> 
> 
> Yes.

OK, in that case I should use

```
sig_on()
try:
    <library call>
finally:
    sig_off()
```
only for functions that potentially run long enough so that it makes sense for them being interruptible.



---

archive/issue_comments_408852.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIs it ok if Python stuff happens between sig_on and sig_off, such as\n\n```python\n        try:\n            mat = MatAlloc(self.Data.Field, self._nrows, right._ncols)\n            MatMulStrassen(mat, self.Data, right.Data)\n            return new_mtx(mat, self)\n        finally:\n            sig_off()\n```\n?\n\nOr should, in particular, return statements happen *after* the `finally: sig_off()'?",
    "created_at": "2018-10-21T17:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408852",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

Is it ok if Python stuff happens between sig_on and sig_off, such as

```python
        try:
            mat = MatAlloc(self.Data.Field, self._nrows, right._ncols)
            MatMulStrassen(mat, self.Data, right.Data)
            return new_mtx(mat, self)
        finally:
            sig_off()
```
?

Or should, in particular, return statements happen *after* the `finally: sig_off()'?



---

archive/issue_comments_408853.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@simon-king-jena](#comment%3A14):\n> Is it ok if Python stuff happens between sig_on and sig_off\n\nYou should try hard to avoid that as it's unsafe.\n\n> Or should, in particular, return statements happen *after* the `finally: sig_off()'?\n\nThere is nothing in particular about `return` statements. There just shouldn't be any kind of Python object manipulation (especially no creation of new Python objects).",
    "created_at": "2018-10-21T18:29:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408853",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@simon-king-jena](#comment%3A14):
> Is it ok if Python stuff happens between sig_on and sig_off

You should try hard to avoid that as it's unsafe.

> Or should, in particular, return statements happen *after* the `finally: sig_off()'?

There is nothing in particular about `return` statements. There just shouldn't be any kind of Python object manipulation (especially no creation of new Python objects).



---

archive/issue_comments_408854.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@jdemeyer](#comment%3A15):\n> Replying to [@simon-king-jena](#comment%3A14):\n> > Is it ok if Python stuff happens between sig_on and sig_off\n> \n> \n> You should try hard to avoid that as it's unsafe.\n> \n> > Or should, in particular, return statements happen *after* the `finally: sig_off()'?\n> \n> \n> There is nothing in particular about `return` statements. There just shouldn't be any kind of Python object manipulation (especially no creation of new Python objects).\n\nGood, then I guess the following is bad, as `new_mtx` creates a python object (namely: a !Matrix_gfpn_dense):\n\n```python\n        sig_on()\n        try:\n            mat = MatAlloc(self.Data.Field, self.Data.Nor+other.Data.Nor, self.Data.Noc)\n            memcpy(mat.Data, self.Data.Data, FfCurrentRowSize*self.Data.Nor)\n            memcpy(MatGetPtr(mat, self.Data.Nor), other.Data.Data, FfCurrentRowSize*other.Data.Nor)\n            return new_mtx(mat, self)\n        finally:\n            sig_off()\n```",
    "created_at": "2018-10-21T19:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408854",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@jdemeyer](#comment%3A15):
> Replying to [@simon-king-jena](#comment%3A14):
> > Is it ok if Python stuff happens between sig_on and sig_off
> 
> 
> You should try hard to avoid that as it's unsafe.
> 
> > Or should, in particular, return statements happen *after* the `finally: sig_off()'?
> 
> 
> There is nothing in particular about `return` statements. There just shouldn't be any kind of Python object manipulation (especially no creation of new Python objects).

Good, then I guess the following is bad, as `new_mtx` creates a python object (namely: a !Matrix_gfpn_dense):

```python
        sig_on()
        try:
            mat = MatAlloc(self.Data.Field, self.Data.Nor+other.Data.Nor, self.Data.Noc)
            memcpy(mat.Data, self.Data.Data, FfCurrentRowSize*self.Data.Nor)
            memcpy(MatGetPtr(mat, self.Data.Nor), other.Data.Data, FfCurrentRowSize*other.Data.Nor)
            return new_mtx(mat, self)
        finally:
            sig_off()
```



---

archive/issue_comments_408855.json:
```json
{
    "body": "Branch: **[u/SimonKing/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/MeatAxe_sig_on_count)**",
    "created_at": "2018-10-21T21:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408855",
    "user": "https://github.com/simon-king-jena"
}
```

Branch: **[u/SimonKing/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/MeatAxe_sig_on_count)**



---

archive/issue_events_362182.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-10-21T21:06:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362182"
}
```



---

archive/issue_comments_408856.json:
```json
{
    "body": "Commit: **[`3772613`](https://github.com/sagemath/sagetrac-mirror/commit/3772613b0401c025950666d26ad30e0d37965018)**",
    "created_at": "2018-10-21T21:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408856",
    "user": "https://github.com/simon-king-jena"
}
```

Commit: **[`3772613`](https://github.com/sagemath/sagetrac-mirror/commit/3772613b0401c025950666d26ad30e0d37965018)**



---

archive/issue_comments_408857.json:
```json
{
    "body": "Author: **Simon King**",
    "created_at": "2018-10-21T21:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408857",
    "user": "https://github.com/simon-king-jena"
}
```

Author: **Simon King**



---

archive/issue_comments_408858.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI am sorry that I cannot provide a new test, but I think the code is a bit safer now.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3772613b0401c025950666d26ad30e0d37965018\"><code>3772613</code></a></td><td><code>Fix sig_on/off count in matrix_gfpn_dense</code></td></tr></table>\n",
    "created_at": "2018-10-21T21:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408858",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

I am sorry that I cannot provide a new test, but I think the code is a bit safer now.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3772613b0401c025950666d26ad30e0d37965018"><code>3772613</code></a></td><td><code>Fix sig_on/off count in matrix_gfpn_dense</code></td></tr></table>




---

archive/issue_comments_408859.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI assume that you actually tested this? No patchbot with meataxe has tested this so far.",
    "created_at": "2018-10-24T09:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408859",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

I assume that you actually tested this? No patchbot with meataxe has tested this so far.



---

archive/issue_comments_408860.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nIt would be safer to do `self._converter.field_to_int` calls outside of `sig_on`, as that involves Python calls.\n\nWhile looking at that code, I also noticed a potential bug: #26546",
    "created_at": "2018-10-24T09:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408860",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

It would be safer to do `self._converter.field_to_int` calls outside of `sig_on`, as that involves Python calls.

While looking at that code, I also noticed a potential bug: #26546



---

archive/issue_events_362183.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-24T09:46:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362183"
}
```



---

archive/issue_events_362184.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-10-24T09:46:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362184"
}
```



---

archive/issue_comments_408861.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI suggest to base this on top of #26546",
    "created_at": "2018-10-24T09:55:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408861",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

I suggest to base this on top of #26546



---

archive/issue_comments_408862.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cda646e3374fa37268744b90ae7e53b124ff88cb\"><code>cda646e</code></a></td><td><code>FieldConverter_class: new methods fel_to_field and field_to_fel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81808c073c1066087814f0768d1a8d9fbcf7930d\"><code>81808c0</code></a></td><td><code>Mention that this is for Cython only</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3b9049f5deb2c3db20a0cbf9af10d198795d677\"><code>a3b9049</code></a></td><td><code>Merge branch 't/26546/matrix_gfpn_dense__exceptions_ignored_in_field_to_int__' into MeatAxe_sig_on_count</code></td></tr></table>\n",
    "created_at": "2018-11-03T11:38:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408862",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cda646e3374fa37268744b90ae7e53b124ff88cb"><code>cda646e</code></a></td><td><code>FieldConverter_class: new methods fel_to_field and field_to_fel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81808c073c1066087814f0768d1a8d9fbcf7930d"><code>81808c0</code></a></td><td><code>Mention that this is for Cython only</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3b9049f5deb2c3db20a0cbf9af10d198795d677"><code>a3b9049</code></a></td><td><code>Merge branch 't/26546/matrix_gfpn_dense__exceptions_ignored_in_field_to_int__' into MeatAxe_sig_on_count</code></td></tr></table>




---

archive/issue_comments_408863.json:
```json
{
    "body": "Changed commit from **[`3772613`](https://github.com/sagemath/sagetrac-mirror/commit/3772613b0401c025950666d26ad30e0d37965018)** to **[`a3b9049`](https://github.com/sagemath/sagetrac-mirror/commit/a3b9049f5deb2c3db20a0cbf9af10d198795d677)**",
    "created_at": "2018-11-03T11:38:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408863",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3772613`](https://github.com/sagemath/sagetrac-mirror/commit/3772613b0401c025950666d26ad30e0d37965018)** to **[`a3b9049`](https://github.com/sagemath/sagetrac-mirror/commit/a3b9049f5deb2c3db20a0cbf9af10d198795d677)**



---

archive/issue_events_362185.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-11-03T11:56:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362185"
}
```



---

archive/issue_events_362186.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2018-11-03T11:56:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362186"
}
```



---

archive/issue_comments_408864.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nWhile merging with #26546 I had to resolve a couple of conflicts. Now all tests pass, I think that the usage of sig_on/sig_off is safer, and thus it is ready for review.",
    "created_at": "2018-11-03T11:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408864",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:24" align="right">comment:24</div>

While merging with #26546 I had to resolve a couple of conflicts. Now all tests pass, I think that the usage of sig_on/sig_off is safer, and thus it is ready for review.



---

archive/issue_comments_408865.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI'd rather review this after the dependency has actually been merged. Feel free to remind me when that happens.",
    "created_at": "2018-11-05T08:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408865",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

I'd rather review this after the dependency has actually been merged. Feel free to remind me when that happens.



---

archive/issue_comments_408866.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\non this branch with installed meataxe, and #22626 and #26856, merged all the tests pass.",
    "created_at": "2018-12-30T16:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408866",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

on this branch with installed meataxe, and #22626 and #26856, merged all the tests pass.



---

archive/issue_events_362187.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-30T16:19:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362187"
}
```



---

archive/issue_events_362188.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-30T16:19:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362188"
}
```



---

archive/issue_comments_408867.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@jdemeyer](#comment%3A25):\n> I'd rather review this after the dependency has actually been merged. Feel free to remind me when that happens.\n\nReplying to [@dimpase](#comment%3A26):\n> on this branch with installed meataxe, and #22626 and #26856, merged all the tests pass. \n\nIs that the reminder? `;-)`",
    "created_at": "2018-12-30T16:57:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408867",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@jdemeyer](#comment%3A25):
> I'd rather review this after the dependency has actually been merged. Feel free to remind me when that happens.

Replying to [@dimpase](#comment%3A26):
> on this branch with installed meataxe, and #22626 and #26856, merged all the tests pass. 

Is that the reminder? `;-)`



---

archive/issue_comments_408868.json:
```json
{
    "body": "Changed branch from **[u/SimonKing/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/MeatAxe_sig_on_count)** to **[u/jdemeyer/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/MeatAxe_sig_on_count)**",
    "created_at": "2018-12-30T20:53:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408868",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/SimonKing/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/MeatAxe_sig_on_count)** to **[u/jdemeyer/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/MeatAxe_sig_on_count)**



---

archive/issue_comments_408869.json:
```json
{
    "body": "Changed commit from **[`a3b9049`](https://github.com/sagemath/sagetrac-mirror/commit/a3b9049f5deb2c3db20a0cbf9af10d198795d677)** to **[`6f876e7`](https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c)**",
    "created_at": "2018-12-30T20:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408869",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`a3b9049`](https://github.com/sagemath/sagetrac-mirror/commit/a3b9049f5deb2c3db20a0cbf9af10d198795d677)** to **[`6f876e7`](https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c)**



---

archive/issue_comments_408870.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nRebased to 8.6.beta0 and put back this comment (assuming that it was removed by accident)\n\n```diff\n-            # Inverting a singular matrix causes MatInverse to raise a\n-            # ZeroDivisionError (see sage_meataxe_error_handler).\n-            # So we need to support exceptions here.\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c\"><code>6f876e7</code></a></td><td><code>Fix sig_on/off count in matrix_gfpn_dense</code></td></tr></table>\n",
    "created_at": "2018-12-30T20:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408870",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Rebased to 8.6.beta0 and put back this comment (assuming that it was removed by accident)

```diff
-            # Inverting a singular matrix causes MatInverse to raise a
-            # ZeroDivisionError (see sage_meataxe_error_handler).
-            # So we need to support exceptions here.
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c"><code>6f876e7</code></a></td><td><code>Fix sig_on/off count in matrix_gfpn_dense</code></td></tr></table>




---

archive/issue_events_362189.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-06T08:27:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362189"
}
```



---

archive/issue_events_362190.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-06T08:27:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362190"
}
```



---

archive/issue_comments_408871.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2019-01-06T08:27:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408871",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_362191.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362191"
}
```



---

archive/issue_events_362192.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362192"
}
```



---

archive/issue_comments_408872.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408872",
    "user": "https://github.com/embray"
}
```

<div id="comment:31" align="right">comment:31</div>

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_408873.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/MeatAxe_sig_on_count)** to **[`6f876e7`](https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c)**",
    "created_at": "2019-01-23T14:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26516#issuecomment-408873",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/MeatAxe_sig_on_count](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/MeatAxe_sig_on_count)** to **[`6f876e7`](https://github.com/sagemath/sagetrac-mirror/commit/6f876e7753f18a0b38273ae5f3e4cb09139ffb2c)**



---

archive/issue_events_362193.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-23T14:17:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362193"
}
```



---

archive/issue_events_362194.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "33ec2f82027014c780c2d9bbf680d023f79dab26",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-23T14:17:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26516",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26516#event-362194"
}
```
