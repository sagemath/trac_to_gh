# Issue 26756: py3: some care for integer.pyx

archive/issues_026519.json:
```json
{
    "body": "where hex, oct, long, hash are problematic.\n\nHere we take care only of hex and long.\n\n**CC:**  @tscrim @jdemeyer @embray\n\n**Branch/Commit:** [394817c666c8bab73711c859cf047cab2b1517a1](https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1)\n\n**Reviewer:** Travis Scrimshaw, Erik Bray\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26756\n\n",
    "closed_at": "2018-12-07T12:10:32Z",
    "created_at": "2018-11-24T12:52:44Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "py3: some care for integer.pyx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26756",
    "user": "https://github.com/fchapoton"
}
```
where hex, oct, long, hash are problematic.

Here we take care only of hex and long.

**CC:**  @tscrim @jdemeyer @embray

**Branch/Commit:** [394817c666c8bab73711c859cf047cab2b1517a1](https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1)

**Reviewer:** Travis Scrimshaw, Erik Bray

**Author:** Frédéric Chapoton

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/26756





---

archive/issue_events_075217.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "rename": {
        "from": "py3: some care integer.pyx",
        "to": "py3: some care for integer.pyx"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26756#event-75217"
}
```




---

archive/issue_comments_515591.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a98f30b59a2bc9703cf5033b41a1b4e9d7baa199\">a98f30b</a></td><td><code>some fixes and deprecation for hex / oct of Integer</code></td></tr></table>\n",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515591",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a98f30b59a2bc9703cf5033b41a1b4e9d7baa199">a98f30b</a></td><td><code>some fixes and deprecation for hex / oct of Integer</code></td></tr></table>




---

archive/issue_comments_515592.json:
```json
{
    "body": "**Author:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515592",
    "user": "https://github.com/fchapoton"
}
```


**Author:** Frédéric Chapoton



---

archive/issue_comments_515593.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515593",
    "user": "https://github.com/fchapoton"
}
```


**Changing status** from new to needs_review.



---

archive/issue_comments_515594.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-where hex, oct, long, hash are problematic\n+where hex, oct, long, hash are problematic.\n+\n+Here we take care only of hex and long.\n``````\n",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515594",
    "user": "https://github.com/fchapoton"
}
```


**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-where hex, oct, long, hash are problematic
+where hex, oct, long, hash are problematic.
+
+Here we take care only of hex and long.
``````




---

archive/issue_comments_515595.json:
```json
{
    "body": "**Branch:** [u/chapoton/26756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26756)",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515595",
    "user": "https://github.com/fchapoton"
}
```


**Branch:** [u/chapoton/26756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26756)



---

archive/issue_comments_515596.json:
```json
{
    "body": "**Commit:** [a98f30b59a2bc9703cf5033b41a1b4e9d7baa199](https://github.com/sagemath/sagetrac-mirror/commit/a98f30b59a2bc9703cf5033b41a1b4e9d7baa199)",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515596",
    "user": "https://github.com/fchapoton"
}
```


**Commit:** [a98f30b59a2bc9703cf5033b41a1b4e9d7baa199](https://github.com/sagemath/sagetrac-mirror/commit/a98f30b59a2bc9703cf5033b41a1b4e9d7baa199)



---

archive/issue_comments_515597.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b816484ef88b66a514f5c5114546d29309391e4\">3b81648</a></td><td><code>fixing doctests for hex and oct in lazy_import</code></td></tr></table>\n",
    "created_at": "2018-11-24T16:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515597",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b816484ef88b66a514f5c5114546d29309391e4">3b81648</a></td><td><code>fixing doctests for hex and oct in lazy_import</code></td></tr></table>




---

archive/issue_comments_515598.json:
```json
{
    "body": "**Changing commit** from \"[a98f30b59a2bc9703cf5033b41a1b4e9d7baa199](https://github.com/sagemath/sagetrac-mirror/commit/a98f30b59a2bc9703cf5033b41a1b4e9d7baa199)\" to \"[3b816484ef88b66a514f5c5114546d29309391e4](https://github.com/sagemath/sagetrac-mirror/commit/3b816484ef88b66a514f5c5114546d29309391e4)\".",
    "created_at": "2018-11-24T16:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515598",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[a98f30b59a2bc9703cf5033b41a1b4e9d7baa199](https://github.com/sagemath/sagetrac-mirror/commit/a98f30b59a2bc9703cf5033b41a1b4e9d7baa199)" to "[3b816484ef88b66a514f5c5114546d29309391e4](https://github.com/sagemath/sagetrac-mirror/commit/3b816484ef88b66a514f5c5114546d29309391e4)".



---

archive/issue_comments_515599.json:
```json
{
    "body": "<a id='comment:3'></a>\nLGTM.",
    "created_at": "2018-11-24T17:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515599",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:3'></a>
LGTM.



---

archive/issue_comments_515600.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2018-11-24T17:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515600",
    "user": "https://github.com/tscrim"
}
```


**Changing status** from needs_review to positive_review.



---

archive/issue_comments_515601.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2018-11-24T17:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515601",
    "user": "https://github.com/tscrim"
}
```


**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_515602.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2018-11-26T10:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515602",
    "user": "https://github.com/embray"
}
```


**Changing status** from positive_review to needs_work.



---

archive/issue_comments_515603.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe changes to `LazyImport` are not right.  I agree with *not* using the `hex()` and `oct()` built-ins here.  Rather, it should just pass to `self.get_object.__hex__()` and `__oct__()` respectively; there's no guarantee that the proxied object has `.oct()` or `.hex()` methods.\n\nThis is meant to be pretty a pretty generic proxy class (in fact I have a ticket I would like to revive sometime where I reimplement this on an existing proxy library for Python: #22793).",
    "created_at": "2018-11-26T10:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515603",
    "user": "https://github.com/embray"
}
```


<a id='comment:4'></a>
The changes to `LazyImport` are not right.  I agree with *not* using the `hex()` and `oct()` built-ins here.  Rather, it should just pass to `self.get_object.__hex__()` and `__oct__()` respectively; there's no guarantee that the proxied object has `.oct()` or `.hex()` methods.

This is meant to be pretty a pretty generic proxy class (in fact I have a ticket I would like to revive sometime where I reimplement this on an existing proxy library for Python: #22793).



---

archive/issue_comments_515604.json:
```json
{
    "body": "<a id='comment:5'></a>\nHello Erik. Glad to see you back. Would you please look at #26740 ?\n\nHere are the only remaining `__hex__` in sage:\n\n```\nchapoton@pc-chapoton:~/sage$ git grep \"def __hex__(\" src/sage\nsrc/sage/libs/ntl/ntl_GF2X.pyx:    def __hex__(self):\nsrc/sage/misc/lazy_import.pyx:    def __hex__(self):\nsrc/sage/rings/integer.pyx:    def __hex__(self):\nsrc/sage/rings/real_mpfr.pyx:    def __hex__(self):\n```\nand we also have\n\n```\nsrc/sage/libs/ntl/ntl_GF2X.pyx:    def hex(ntl_GF2X self):\nsrc/sage/rings/real_mpfr.pyx:    def hex(self):\n```\nI think the `__hex__` should all disappear. In python3, `hex` call the `__index__` method.",
    "created_at": "2018-11-26T11:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515604",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:5'></a>
Hello Erik. Glad to see you back. Would you please look at #26740 ?

Here are the only remaining `__hex__` in sage:

```
chapoton@pc-chapoton:~/sage$ git grep "def __hex__(" src/sage
src/sage/libs/ntl/ntl_GF2X.pyx:    def __hex__(self):
src/sage/misc/lazy_import.pyx:    def __hex__(self):
src/sage/rings/integer.pyx:    def __hex__(self):
src/sage/rings/real_mpfr.pyx:    def __hex__(self):
```
and we also have

```
src/sage/libs/ntl/ntl_GF2X.pyx:    def hex(ntl_GF2X self):
src/sage/rings/real_mpfr.pyx:    def hex(self):
```
I think the `__hex__` should all disappear. In python3, `hex` call the `__index__` method.



---

archive/issue_comments_515605.json:
```json
{
    "body": "<a id='comment:6'></a>\nI never went away really.  I've just been working on other stuff (mainly related to GAP).  But I thought I should try to take a day or two to catch up on other things :)\n\nThat's a good point.  You could also leave `__hex__` and `__oct__` as they were previously, but they should be bracketed with a Cython-level if like `IF PY_MAJOR_VERSION < 3:`.",
    "created_at": "2018-11-26T14:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515605",
    "user": "https://github.com/embray"
}
```


<a id='comment:6'></a>
I never went away really.  I've just been working on other stuff (mainly related to GAP).  But I thought I should try to take a day or two to catch up on other things :)

That's a good point.  You could also leave `__hex__` and `__oct__` as they were previously, but they should be bracketed with a Cython-level if like `IF PY_MAJOR_VERSION < 3:`.



---

archive/issue_comments_515606.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b406d22b25f7c8717ffe775dfe2e5e267ca48b37\">b406d22</a></td><td><code>Merge branch 'u/chapoton/26756' in 8.5.b6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1\">394817c</a></td><td><code>trac 26756 some changes in __hex__, __oct__ for lazy imports</code></td></tr></table>\n",
    "created_at": "2018-12-03T12:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b406d22b25f7c8717ffe775dfe2e5e267ca48b37">b406d22</a></td><td><code>Merge branch 'u/chapoton/26756' in 8.5.b6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1">394817c</a></td><td><code>trac 26756 some changes in __hex__, __oct__ for lazy imports</code></td></tr></table>




---

archive/issue_comments_515607.json:
```json
{
    "body": "**Changing commit** from \"[3b816484ef88b66a514f5c5114546d29309391e4](https://github.com/sagemath/sagetrac-mirror/commit/3b816484ef88b66a514f5c5114546d29309391e4)\" to \"[394817c666c8bab73711c859cf047cab2b1517a1](https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1)\".",
    "created_at": "2018-12-03T12:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515607",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[3b816484ef88b66a514f5c5114546d29309391e4](https://github.com/sagemath/sagetrac-mirror/commit/3b816484ef88b66a514f5c5114546d29309391e4)" to "[394817c666c8bab73711c859cf047cab2b1517a1](https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1)".



---

archive/issue_comments_515608.json:
```json
{
    "body": "<a id='comment:8'></a>\nbetter like this, Erik ?",
    "created_at": "2018-12-03T12:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515608",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:8'></a>
better like this, Erik ?



---

archive/issue_comments_515609.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2018-12-03T12:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515609",
    "user": "https://github.com/fchapoton"
}
```


**Changing status** from needs_work to needs_review.



---

archive/issue_comments_515610.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2018-12-05T09:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515610",
    "user": "https://github.com/embray"
}
```


**Changing status** from needs_review to positive_review.



---

archive/issue_comments_515611.json:
```json
{
    "body": "<a id='comment:9'></a>\nOkay, thanks!",
    "created_at": "2018-12-05T09:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515611",
    "user": "https://github.com/embray"
}
```


<a id='comment:9'></a>
Okay, thanks!



---

archive/issue_comments_515612.json:
```json
{
    "body": "**Changing reviewer** from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Erik Bray\".",
    "created_at": "2018-12-05T09:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515612",
    "user": "https://github.com/embray"
}
```


**Changing reviewer** from "Travis Scrimshaw" to "Travis Scrimshaw, Erik Bray".



---

archive/issue_comments_515613.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2018-12-07T12:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515613",
    "user": "https://github.com/vbraun"
}
```


**Resolution:** fixed



---

archive/issue_comments_515614.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/26756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26756)\" to \"[394817c666c8bab73711c859cf047cab2b1517a1](https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1)\".",
    "created_at": "2018-12-07T12:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26756#issuecomment-515614",
    "user": "https://github.com/vbraun"
}
```


**Changing branch** from "[u/chapoton/26756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26756)" to "[394817c666c8bab73711c859cf047cab2b1517a1](https://github.com/sagemath/sagetrac-mirror/commit/394817c666c8bab73711c859cf047cab2b1517a1)".



---

archive/issue_events_075218.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-07T12:10:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26756",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26756#event-75218"
}
```

