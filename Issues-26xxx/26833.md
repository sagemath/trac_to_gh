# Issue 26833: Upgrade to Cysignals 1.10.2

archive/issues_026833.json:
```json
{
    "body": "CC:  @antonio-rojas @embray @kiwifb @timokau @infinity0 @jdemeyer @slel @tobihan\n\nKeywords: upgrade, cysignals\n\n- Tarball: https://files.pythonhosted.org/packages/51/5f/727aa099de5c60b3fb42cdde72097277803dabe78b177afdb5b835bbf909/cysignals-1.10.2.tar.gz\n\nThis is a blocker because it fixes #27384 which is required to run GAP on Cygwin.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27070\n\n",
    "closed_at": "2019-03-15T08:09:45Z",
    "created_at": "2019-01-17T06:04:01Z",
    "labels": [
        "component: packages: standard",
        "blocker"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Upgrade to Cysignals 1.10.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26833",
    "user": "https://github.com/slel"
}
```
CC:  @antonio-rojas @embray @kiwifb @timokau @infinity0 @jdemeyer @slel @tobihan

Keywords: upgrade, cysignals

- Tarball: https://files.pythonhosted.org/packages/51/5f/727aa099de5c60b3fb42cdde72097277803dabe78b177afdb5b835bbf909/cysignals-1.10.2.tar.gz

This is a blocker because it fixes #27384 which is required to run GAP on Cygwin.

Issue created by migration from https://trac.sagemath.org/ticket/27070





---

archive/issue_comments_377081.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-01-18T10:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377081",
    "user": "https://github.com/embray"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_377082.json:
```json
{
    "body": "Fine for me if somebody wants to do this, but there is no real reason for this upgrade. I mainly made the new release to answer to a Python bug.",
    "created_at": "2019-01-18T13:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377082",
    "user": "https://github.com/jdemeyer"
}
```

Fine for me if somebody wants to do this, but there is no real reason for this upgrade. I mainly made the new release to answer to a Python bug.



---

archive/issue_comments_377083.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-03-10T21:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377083",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_377084.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-10T21:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377084",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_377085.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2019-03-11T11:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377085",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_377086.json:
```json
{
    "body": "Why is this a blocker?",
    "created_at": "2019-03-11T18:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377086",
    "user": "https://github.com/timokau"
}
```

Why is this a blocker?



---

archive/issue_comments_377087.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-11T22:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377087",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_377088.json:
```json
{
    "body": "I am not entirely sure. However, I am sending this off to the buildbots, so it is somewhat moot (but it would still be good to have an answer Jeroen `;)`).",
    "created_at": "2019-03-11T22:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377088",
    "user": "https://github.com/tscrim"
}
```

I am not entirely sure. However, I am sending this off to the buildbots, so it is somewhat moot (but it would still be good to have an answer Jeroen `;)`).



---

archive/issue_comments_377089.json:
```json
{
    "body": "It's a blocker because it fixes #27384",
    "created_at": "2019-03-11T23:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377089",
    "user": "https://github.com/jdemeyer"
}
```

It's a blocker because it fixes #27384



---

archive/issue_comments_377090.json:
```json
{
    "body": "This is failing to build on OS X on conda-forge: https://github.com/conda-forge/cysignals-feedstock/pull/19 (despite cysignals on OS X being tested on Travis CI).",
    "created_at": "2019-03-12T09:54:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377090",
    "user": "https://github.com/jdemeyer"
}
```

This is failing to build on OS X on conda-forge: https://github.com/conda-forge/cysignals-feedstock/pull/19 (despite cysignals on OS X being tested on Travis CI).



---

archive/issue_comments_377091.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-03-12T09:54:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377091",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_377092.json:
```json
{
    "body": "Replying to [comment:10 jdemeyer]:\n> It's a blocker because it fixes #27384\n\n\nWhich itself is not really a blocker (though it is a bad issue) except to the extent that it's a prerequisite to fixing #27214 which could also be argued is not a blocker, but it is a pretty severe problem the more and more I look at it.",
    "created_at": "2019-03-12T11:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377092",
    "user": "https://github.com/embray"
}
```

Replying to [comment:10 jdemeyer]:
> It's a blocker because it fixes #27384


Which itself is not really a blocker (though it is a bad issue) except to the extent that it's a prerequisite to fixing #27214 which could also be argued is not a blocker, but it is a pretty severe problem the more and more I look at it.



---

archive/issue_comments_377093.json:
```json
{
    "body": "Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?",
    "created_at": "2019-03-12T11:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377093",
    "user": "https://github.com/embray"
}
```

Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?



---

archive/issue_comments_377094.json:
```json
{
    "body": "Replying to [comment:14 embray]:\n> Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?\n\n\nWe do care if the problem with conda-forge also exists on the computers of Sage users. At this point, I don't know if the build failure is specific to Conda (and I guess it's not).",
    "created_at": "2019-03-12T12:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377094",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:14 embray]:
> Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?


We do care if the problem with conda-forge also exists on the computers of Sage users. At this point, I don't know if the build failure is specific to Conda (and I guess it's not).



---

archive/issue_comments_377095.json:
```json
{
    "body": "Okay, I just wasn't sure if the tests were built by default.  But if so then that's a reasonable caution I suppose.",
    "created_at": "2019-03-12T12:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377095",
    "user": "https://github.com/embray"
}
```

Okay, I just wasn't sure if the tests were built by default.  But if so then that's a reasonable caution I suppose.



---

archive/issue_comments_377096.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-03-12T20:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377096",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377097.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-12T20:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377097",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_377098.json:
```json
{
    "body": "I'm getting this with 1.10.0 on OSX, please check before setting back to positive review:\n\n```\n[fpylll-0.4.1dev]     In file included from build/src/fpylll/fplll/integer_matrix.cpp:697:\n[fpylll-0.4.1dev]     In file included from /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals/struct_signals.h:45:\n[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:75:26: error: reference to 'memory_order' is ambiguous\n[fpylll-0.4.1dev]     void atomic_thread_fence(memory_order);\n[fpylll-0.4.1dev]                              ^\n[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:68:3: note: candidate found by name lookup is 'memory_order'\n[fpylll-0.4.1dev]     } memory_order;\n[fpylll-0.4.1dev]       ^\n[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/atomic:588:3: note: candidate found by name lookup is 'std::__1::memory_order'\n[fpylll-0.4.1dev]     } memory_order;\n[fpylll-0.4.1dev]       ^\n```",
    "created_at": "2019-03-13T09:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377098",
    "user": "https://github.com/vbraun"
}
```

I'm getting this with 1.10.0 on OSX, please check before setting back to positive review:

```
[fpylll-0.4.1dev]     In file included from build/src/fpylll/fplll/integer_matrix.cpp:697:
[fpylll-0.4.1dev]     In file included from /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals/struct_signals.h:45:
[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:75:26: error: reference to 'memory_order' is ambiguous
[fpylll-0.4.1dev]     void atomic_thread_fence(memory_order);
[fpylll-0.4.1dev]                              ^
[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:68:3: note: candidate found by name lookup is 'memory_order'
[fpylll-0.4.1dev]     } memory_order;
[fpylll-0.4.1dev]       ^
[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/atomic:588:3: note: candidate found by name lookup is 'std::__1::memory_order'
[fpylll-0.4.1dev]     } memory_order;
[fpylll-0.4.1dev]       ^
```



---

archive/issue_comments_377099.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-13T09:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377099",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_377100.json:
```json
{
    "body": "Which OS X machine is that? I cannot reproduce it on your `osx.fritz.box` (I tried cysignals-1.10.**1** but probably that doesn't make a difference for this error).",
    "created_at": "2019-03-13T14:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377100",
    "user": "https://github.com/jdemeyer"
}
```

Which OS X machine is that? I cannot reproduce it on your `osx.fritz.box` (I tried cysignals-1.10.**1** but probably that doesn't make a difference for this error).



---

archive/issue_comments_377101.json:
```json
{
    "body": "Yes, that one. Whats the compiler invocation? I have\n\n```\n    gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c build/src/fpylll/fplll/integer_matrix.cpp -o build/temp.macosx-10.9-x86_64-2.7/build/src/fpylll/fplll/integer_matrix.o -std=c++11\n```",
    "created_at": "2019-03-13T18:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377101",
    "user": "https://github.com/vbraun"
}
```

Yes, that one. Whats the compiler invocation? I have

```
    gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c build/src/fpylll/fplll/integer_matrix.cpp -o build/temp.macosx-10.9-x86_64-2.7/build/src/fpylll/fplll/integer_matrix.o -std=c++11
```



---

archive/issue_comments_377102.json:
```json
{
    "body": "You built sage's gcc, the buildbot doesn't and runs XCode clang",
    "created_at": "2019-03-13T18:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377102",
    "user": "https://github.com/vbraun"
}
```

You built sage's gcc, the buildbot doesn't and runs XCode clang



---

archive/issue_comments_377103.json:
```json
{
    "body": "I get the same error on OS X (not building Sage's gcc).",
    "created_at": "2019-03-13T20:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377103",
    "user": "https://github.com/jhpalmieri"
}
```

I get the same error on OS X (not building Sage's gcc).



---

archive/issue_comments_377104.json:
```json
{
    "body": "Confirmed indeed with clang.",
    "created_at": "2019-03-14T08:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377104",
    "user": "https://github.com/jdemeyer"
}
```

Confirmed indeed with clang.



---

archive/issue_comments_377105.json:
```json
{
    "body": "The problem is essentially that this doesn't compile:\n\n```\nusing namespace std;\n#include <atomic>\n#include <stdatomic.h>\n```",
    "created_at": "2019-03-14T09:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377105",
    "user": "https://github.com/jdemeyer"
}
```

The problem is essentially that this doesn't compile:

```
using namespace std;
#include <atomic>
#include <stdatomic.h>
```



---

archive/issue_comments_377106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-03-14T14:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377107.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-14T14:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_377108.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-14T14:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377108",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_377109.json:
```json
{
    "body": "I tested on that OS X machine that the cysignals test suite passes and that Sage builds.",
    "created_at": "2019-03-14T14:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377109",
    "user": "https://github.com/jdemeyer"
}
```

I tested on that OS X machine that the cysignals test suite passes and that Sage builds.



---

archive/issue_comments_377110.json:
```json
{
    "body": "I'm going to test this on Cygwin in a few minutes, but I don't expect any problems.",
    "created_at": "2019-03-14T14:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377110",
    "user": "https://github.com/embray"
}
```

I'm going to test this on Cygwin in a few minutes, but I don't expect any problems.



---

archive/issue_comments_377111.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-14T17:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377111",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_067241.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-15T08:09:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26833#event-67241"
}
```



---

archive/issue_comments_377112.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-15T08:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377112",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
