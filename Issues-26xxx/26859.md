# Issue 26859: Intersphinx: include python.inv files for Python 2 and 3

archive/issues_026622.json:
```json
{
    "assignees": [],
    "body": "The file `src/doc/common/python.inv` is specific to Python 2. We should include an inventory file for Python 3, to prepare for docbuilding with Python 3.\n\n\nCC:  @fchapoton @strogdon @jdemeyer\n\nBranch/Commit: **[45566df](https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14)**\n\nReviewer: **Erik Bray**\n\nAuthor: **John Palmieri**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26859_\n\n",
    "closed_at": "2018-12-23T23:40:18Z",
    "created_at": "2018-12-08T23:26:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Intersphinx: include python.inv files for Python 2 and 3",
    "type": "issue",
    "updated_at": "2018-12-28T14:06:38Z",
    "url": "https://github.com/sagemath/sage/issues/26859",
    "user": "https://github.com/jhpalmieri"
}
```
The file `src/doc/common/python.inv` is specific to Python 2. We should include an inventory file for Python 3, to prepare for docbuilding with Python 3.


CC:  @fchapoton @strogdon @jdemeyer

Branch/Commit: **[45566df](https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14)**

Reviewer: **Erik Bray**

Author: **John Palmieri**

_Issue created by migration from https://trac.sagemath.org/ticket/26859_





---

archive/issue_events_350906.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-12-08T23:26:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350906"
}
```



---

archive/issue_events_350907.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-12-08T23:26:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350907"
}
```



---

archive/issue_events_350908.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-12-08T23:26:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350908"
}
```



---

archive/issue_events_350909.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-12-08T23:26:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350909"
}
```



---

archive/issue_comments_416435.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/update-python.inv](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/update-python.inv)**",
    "created_at": "2018-12-08T23:28:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416435",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/update-python.inv](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/update-python.inv)**



---

archive/issue_comments_416436.json:
```json
{
    "body": "Commit: **[45566df](https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14)**",
    "created_at": "2018-12-08T23:29:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416436",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[45566df](https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14)**



---

archive/issue_comments_416437.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14\">45566df</a></td><td><code>trac 26589: include inventory files python2.inv and python3.inv,</code></td></tr></table>\n",
    "created_at": "2018-12-08T23:29:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416437",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">Comment 2</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14">45566df</a></td><td><code>trac 26589: include inventory files python2.inv and python3.inv,</code></td></tr></table>




---

archive/issue_events_350910.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-12-08T23:29:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350910"
}
```



---

archive/issue_comments_416438.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nNote that the script `update-python-inv.sh` should not need to be run often, but it should still be compatible with OS X. OS X does not include `wget` as standard, but it does include `curl`, so the script will use either one. Also, the old script used `cut` in a non-posix standard way. Please test this script on linux.",
    "created_at": "2018-12-08T23:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416438",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">Comment 3</div>

Note that the script `update-python-inv.sh` should not need to be run often, but it should still be compatible with OS X. OS X does not include `wget` as standard, but it does include `curl`, so the script will use either one. Also, the old script used `cut` in a non-posix standard way. Please test this script on linux.



---

archive/issue_comments_416439.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nthese *.inv-files, these are some binary blobs. Is there a reason for this, could they be replaced by something which can be used to generate them?",
    "created_at": "2018-12-08T23:39:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416439",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">Comment 4</div>

these *.inv-files, these are some binary blobs. Is there a reason for this, could they be replaced by something which can be used to generate them?



---

archive/issue_comments_416440.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@dimpase](#comment%3A4):\n> these *.inv-files, these are some binary blobs. Is there a reason for this, could they be replaced by something which can be used to generate them? \n\nNot without internet access. If we want to maintain the ability to build Sage and its documentation without internet access, we need to have these files. (With internet access, we could replace the files with links to the on-line versions.)",
    "created_at": "2018-12-08T23:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416440",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@dimpase](#comment%3A4):
> these *.inv-files, these are some binary blobs. Is there a reason for this, could they be replaced by something which can be used to generate them? 

Not without internet access. If we want to maintain the ability to build Sage and its documentation without internet access, we need to have these files. (With internet access, we could replace the files with links to the on-line versions.)



---

archive/issue_comments_416441.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nHmm, I don't get it - these files, they must be generated somehow... It's not some binary-only firmware, is it?",
    "created_at": "2018-12-08T23:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416441",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

Hmm, I don't get it - these files, they must be generated somehow... It's not some binary-only firmware, is it?



---

archive/issue_comments_416442.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nThey come from python.org (e.g., https://docs.python.org/3/objects.inv), and they contain links to python.org. I'm sure the Python people have some autogeneration for them, but I don't know how we would do that. \n\nSee http://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#confval-intersphinx_mapping for how we could use the links if we assumed internet access. (I think being able to build without internet access is valuable and I am not suggesting changing that \u2013\u00a0I am including this link if you want to figure out what is in the files and if there is any way we could generate them ourselves.) As noted on that Sphinx page, you can also run\n\n```\n./sage --python -msphinx.ext.intersphinx src/doc/common/python.inv\n```\nto see the intersphinx mapping provided by that file.",
    "created_at": "2018-12-08T23:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416442",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">Comment 7</div>

They come from python.org (e.g., https://docs.python.org/3/objects.inv), and they contain links to python.org. I'm sure the Python people have some autogeneration for them, but I don't know how we would do that. 

See http://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#confval-intersphinx_mapping for how we could use the links if we assumed internet access. (I think being able to build without internet access is valuable and I am not suggesting changing that – I am including this link if you want to figure out what is in the files and if there is any way we could generate them ourselves.) As noted on that Sphinx page, you can also run

```
./sage --python -msphinx.ext.intersphinx src/doc/common/python.inv
```
to see the intersphinx mapping provided by that file.



---

archive/issue_comments_416443.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI just found [this](https://sphobjinv.readthedocs.io/en/latest/index.html), which lets you create your own `object.inv` files. Maybe we could use that. I am not that interested in spending time on it: the binary files are not that big, and I don't mind just distributing them with Sage.",
    "created_at": "2018-12-08T23:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416443",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">Comment 8</div>

I just found [this](https://sphobjinv.readthedocs.io/en/latest/index.html), which lets you create your own `object.inv` files. Maybe we could use that. I am not that interested in spending time on it: the binary files are not that big, and I don't mind just distributing them with Sage.



---

archive/issue_comments_416444.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThe whole issue would not have arisen if these files were generated...\n\nPerhaps Jeroen could comment on the ease of having this done properly.",
    "created_at": "2018-12-09T00:03:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416444",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">Comment 9</div>

The whole issue would not have arisen if these files were generated...

Perhaps Jeroen could comment on the ease of having this done properly.



---

archive/issue_comments_416445.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\n\"Done properly\". Thanks very much.  ;)",
    "created_at": "2018-12-09T00:08:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416445",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:10" align="right">Comment 10</div>

"Done properly". Thanks very much.  ;)



---

archive/issue_comments_416446.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI would say, by the way, that if you want to change how these files are produced, if it is feasible and especially if it will take a while, it belongs on a separate ticket.",
    "created_at": "2018-12-09T00:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416446",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:11" align="right">Comment 11</div>

I would say, by the way, that if you want to change how these files are produced, if it is feasible and especially if it will take a while, it belongs on a separate ticket.



---

archive/issue_comments_416447.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@jhpalmieri](#comment%3A10):\n> \"Done properly\". Thanks very much.  ;)\n\nyes, sometimes I wish we could do anonymous refereeing of tickets :)",
    "created_at": "2018-12-09T00:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416447",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@jhpalmieri](#comment%3A10):
> "Done properly". Thanks very much.  ;)

yes, sometimes I wish we could do anonymous refereeing of tickets :)



---

archive/issue_comments_416448.json:
```json
{
    "body": "Reviewer: **Erik Bray**",
    "created_at": "2018-12-10T12:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416448",
    "user": "https://github.com/embray"
}
```

Reviewer: **Erik Bray**



---

archive/issue_events_350911.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-10T12:33:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350911"
}
```



---

archive/issue_events_350912.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-10T12:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350912"
}
```



---

archive/issue_comments_416449.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nI believe for the `.inv` files the usual approach is for them to be generated and distributed by the relevant projects' maintainers.  So for the ones from Python the correct approach is to download them and include our own copies of them if necessary.\n\nI think this approach looks good for now.",
    "created_at": "2018-12-10T12:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416449",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">Comment 13</div>

I believe for the `.inv` files the usual approach is for them to be generated and distributed by the relevant projects' maintainers.  So for the ones from Python the correct approach is to download them and include our own copies of them if necessary.

I think this approach looks good for now.



---

archive/issue_comments_416450.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nSage does generate plenty of `.inv` files while building its docs. Why would one not generate all the `.inv` files then, relying instead on selective manual downloads of stuff? This looks flaky to me...",
    "created_at": "2018-12-11T10:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416450",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">Comment 14</div>

Sage does generate plenty of `.inv` files while building its docs. Why would one not generate all the `.inv` files then, relying instead on selective manual downloads of stuff? This looks flaky to me...



---

archive/issue_comments_416451.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nThat would require building the docs for Python, for matplotlib, etc. (or at the very least their inventories).  Flaky or not (I don't think it is) it's pretty normal.  The inventories are just databases of keywords--it's the same reason you would download any pre-computed database of maths results.",
    "created_at": "2018-12-11T11:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416451",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">Comment 15</div>

That would require building the docs for Python, for matplotlib, etc. (or at the very least their inventories).  Flaky or not (I don't think it is) it's pretty normal.  The inventories are just databases of keywords--it's the same reason you would download any pre-computed database of maths results.



---

archive/issue_events_350913.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-23T23:40:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350913"
}
```



---

archive/issue_events_350914.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2c886e08a4eb7c0968728b8f82a392b02e42a357",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-12-23T23:40:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350914"
}
```



---

archive/issue_comments_416452.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/update-python.inv](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/update-python.inv)** to **[45566df](https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14)**",
    "created_at": "2018-12-23T23:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416452",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/update-python.inv](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/update-python.inv)** to **[45566df](https://github.com/sagemath/sagetrac-mirror/commit/45566dfb0fe3c5c86c991109b7a4b02e9fa9ef14)**



---

archive/issue_comments_416453.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nThis tickets were closed as fixed after the Sage 8.5 release.",
    "created_at": "2018-12-28T14:06:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26859#issuecomment-416453",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">Comment 17</div>

This tickets were closed as fixed after the Sage 8.5 release.



---

archive/issue_events_350915.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:06:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350915"
}
```



---

archive/issue_events_350916.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:06:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26859",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26859#event-350916"
}
```
