# Issue 26795: Some memory leaks

archive/issues_026558.json:
```json
{
    "assignees": [],
    "body": "(Add more leaks here. But not the one that is taken care in #26794)\n\nFirst one, handled at #26796\n\n```\ndef bad8(n):\n    from sage.graphs.independent_sets import IndependentSets\n    G = Graph(2)\n    for i in range(n):\n        x = [0] in IndependentSets(G)\n        if i % 10000 == 0:\n            print get_memory_usage()\n\nbad8(100000)\n```\n\nSecond, in #26806: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.\n\nThird: Also `dimension()` of posets seems to have a leak. Root cause might be something already corrected.\n\nMore in comments.\n\nCC:  @mkoeppe\n\nBranch/Commit: **[`f786410`](https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572)**\n\nReviewer: **Jori M\u00e4ntysalo**\n\nAuthor: **Dima Pasechnik**\n\nComponent: **memleak**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26795_\n\n",
    "closed_at": "2018-12-07T12:10:30Z",
    "created_at": "2018-12-01T16:22:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/memleak",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Some memory leaks",
    "type": "issue",
    "updated_at": "2018-12-07T12:10:30Z",
    "url": "https://github.com/sagemath/sage/issues/26795",
    "user": "https://github.com/jm58660"
}
```
(Add more leaks here. But not the one that is taken care in #26794)

First one, handled at #26796

```
def bad8(n):
    from sage.graphs.independent_sets import IndependentSets
    G = Graph(2)
    for i in range(n):
        x = [0] in IndependentSets(G)
        if i % 10000 == 0:
            print get_memory_usage()

bad8(100000)
```

Second, in #26806: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.

Third: Also `dimension()` of posets seems to have a leak. Root cause might be something already corrected.

More in comments.

CC:  @mkoeppe

Branch/Commit: **[`f786410`](https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572)**

Reviewer: **Jori MÃ¤ntysalo**

Author: **Dima Pasechnik**

Component: **memleak**

_Issue created by migration from https://trac.sagemath.org/ticket/26795_





---

archive/issue_events_368294.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-01T16:22:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368294"
}
```



---

archive/issue_events_368295.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-01T16:22:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/memleak",
    "label_color": "696969",
    "label_name": "memleak",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368295"
}
```



---

archive/issue_events_368296.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-01T16:22:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368296"
}
```



---

archive/issue_events_368297.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-01T16:22:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368297"
}
```



---

archive/issue_comments_412742.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,4 @@\n bad8(100000)\n ```\n \n+Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.\n``````\n",
    "created_at": "2018-12-01T16:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412742",
    "user": "https://github.com/jm58660"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,4 @@
 bad8(100000)
 ```
 
+Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.
``````




---

archive/issue_comments_412743.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-(Add more leaks here.)\n+(Add more leaks here. But not the one that is taken care in #26794)\n \n ```\n def bad8(n):\n``````\n",
    "created_at": "2018-12-01T16:49:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412743",
    "user": "https://github.com/jm58660"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-(Add more leaks here.)
+(Add more leaks here. But not the one that is taken care in #26794)
 
 ```
 def bad8(n):
``````




---

archive/issue_comments_412744.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nfixing the `IndependentSets` leak is more tricky: how can I deallocate the memory of a variable local to the generator?  (It has to be local, because one may want to have two iterators over the independent sets, see the doctest of the method.)",
    "created_at": "2018-12-01T19:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412744",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:3" align="right">comment:3</div>

fixing the `IndependentSets` leak is more tricky: how can I deallocate the memory of a variable local to the generator?  (It has to be local, because one may want to have two iterators over the independent sets, see the doctest of the method.)



---

archive/issue_comments_412745.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@mantepse](#comment:3):\n> fixing the `IndependentSets` leak is more tricky: how can I deallocate the memory of a variable local to the generator?  (It has to be local, because one may want to have two iterators over the independent sets, see the doctest of the method.)\n\nTrying to understand... So every call to `iter()` will create kind of \"implicit object\" by calling `__iter__()` that by design of `yield` statement will create a state for an iterator. But because it is \"implicit\", there can no explicit destructor? Then the iterator must add a back-reference to some class variable, I guess. Something like\n\n```\nclass Foo:\n    sometype refs\n    def __init__():\n        refs = []\n    def __iter__():\n        x = reserve_memory()\n        refs.append(x)\n        . . .\n    def __dealloc__():\n        for x in refs:\n            release_memory(x)\n```",
    "created_at": "2018-12-01T19:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412745",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@mantepse](#comment:3):
> fixing the `IndependentSets` leak is more tricky: how can I deallocate the memory of a variable local to the generator?  (It has to be local, because one may want to have two iterators over the independent sets, see the doctest of the method.)

Trying to understand... So every call to `iter()` will create kind of "implicit object" by calling `__iter__()` that by design of `yield` statement will create a state for an iterator. But because it is "implicit", there can no explicit destructor? Then the iterator must add a back-reference to some class variable, I guess. Something like

```
class Foo:
    sometype refs
    def __init__():
        refs = []
    def __iter__():
        x = reserve_memory()
        refs.append(x)
        . . .
    def __dealloc__():
        for x in refs:
            release_memory(x)
```



---

archive/issue_comments_412746.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt was actually quite easy, see #26796",
    "created_at": "2018-12-01T20:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412746",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:5" align="right">comment:5</div>

It was actually quite easy, see #26796



---

archive/issue_comments_412747.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@mantepse](#comment:5):\n> It was actually quite easy, see #26796\n\nAh, of course. `finally` is always called.",
    "created_at": "2018-12-01T20:14:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412747",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@mantepse](#comment:5):
> It was actually quite easy, see #26796

Ah, of course. `finally` is always called.



---

archive/issue_comments_412748.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n (Add more leaks here. But not the one that is taken care in #26794)\n+\n+First one, handled at #26796\n \n ```\n def bad8(n):\n@@ -12,4 +14,7 @@\n bad8(100000)\n ```\n \n-Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.\n+Second: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.\n+\n+Third: Also `dimension()` of posets seems to have a leak. Root cause might be something already corrected.\n+\n``````\n",
    "created_at": "2018-12-01T20:14:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412748",
    "user": "https://github.com/jm58660"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 (Add more leaks here. But not the one that is taken care in #26794)
+
+First one, handled at #26796
 
 ```
 def bad8(n):
@@ -12,4 +14,7 @@
 bad8(100000)
 ```
 
-Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.
+Second: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.
+
+Third: Also `dimension()` of posets seems to have a leak. Root cause might be something already corrected.
+
``````




---

archive/issue_comments_412749.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n`add_col()` in `src/sage/numerical/backends/glpk_backend.pyx` contains\n\n```\ncol_i = <int *> sig_malloc((len(indices)+1) * sizeof(int))\ncol_values = <double *> sig_malloc((len(indices)+1) * sizeof(double))\n```\n\nWhere are those freed?",
    "created_at": "2018-12-02T06:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412749",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:7" align="right">comment:7</div>

`add_col()` in `src/sage/numerical/backends/glpk_backend.pyx` contains

```
col_i = <int *> sig_malloc((len(indices)+1) * sizeof(int))
col_values = <double *> sig_malloc((len(indices)+1) * sizeof(double))
```

Where are those freed?



---

archive/issue_comments_412750.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jm58660](#comment:7):\n> `add_col()` in `src/sage/numerical/backends/glpk_backend.pyx` contains\n> \n> ```\n> col_i = <int *> sig_malloc((len(indices)+1) * sizeof(int))\n> col_values = <double *> sig_malloc((len(indices)+1) * sizeof(double))\n> ```\n> \n> Where are those freed?\n\nit appears they can (and must!) be freed at the end of this function, as glpk copies all that data, and not re-uses it later.",
    "created_at": "2018-12-02T10:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412750",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jm58660](#comment:7):
> `add_col()` in `src/sage/numerical/backends/glpk_backend.pyx` contains
> 
> ```
> col_i = <int *> sig_malloc((len(indices)+1) * sizeof(int))
> col_values = <double *> sig_malloc((len(indices)+1) * sizeof(double))
> ```
> 
> Where are those freed?

it appears they can (and must!) be freed at the end of this function, as glpk copies all that data, and not re-uses it later.



---

archive/issue_comments_412751.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI tried running tests with the following patch, and it does not appear to break anything:\n\n```diff\ndiff --git a/src/sage/numerical/backends/glpk_backend.pyx b/src/sage/numerical/backends/glpk_backend.pyx\nindex 738365b608..6de416afdf 100644\n--- a/src/sage/numerical/backends/glpk_backend.pyx\n+++ b/src/sage/numerical/backends/glpk_backend.pyx\n@@ -831,6 +831,8 @@ cdef class GLPKBackend(GenericBackend):\n \n         glp_set_mat_col(self.lp, n, len(indices), col_i, col_values)\n         glp_set_col_bnds(self.lp, n, GLP_LO, 0,0)\n+        sig_free(col_i)\n+        sig_free(col_values)\n \n \n     cpdef int solve(self) except -1:\n```",
    "created_at": "2018-12-02T12:28:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412751",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

I tried running tests with the following patch, and it does not appear to break anything:

```diff
diff --git a/src/sage/numerical/backends/glpk_backend.pyx b/src/sage/numerical/backends/glpk_backend.pyx
index 738365b608..6de416afdf 100644
--- a/src/sage/numerical/backends/glpk_backend.pyx
+++ b/src/sage/numerical/backends/glpk_backend.pyx
@@ -831,6 +831,8 @@ cdef class GLPKBackend(GenericBackend):
 
         glp_set_mat_col(self.lp, n, len(indices), col_i, col_values)
         glp_set_col_bnds(self.lp, n, GLP_LO, 0,0)
+        sig_free(col_i)
+        sig_free(col_values)
 
 
     cpdef int solve(self) except -1:
```



---

archive/issue_comments_412752.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nPerhaps mkoeppe can confirm whether this is a bug in GLPK backend.",
    "created_at": "2018-12-02T12:30:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412752",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Perhaps mkoeppe can confirm whether this is a bug in GLPK backend.



---

archive/issue_comments_412753.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@dimpase](#comment:9):\n\n> I tried running tests with the following patch, and it does not appear to break anything:\n\nIs this the one that is responsible for leak in `dimension()` of poset?",
    "created_at": "2018-12-02T13:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412753",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@dimpase](#comment:9):

> I tried running tests with the following patch, and it does not appear to break anything:

Is this the one that is responsible for leak in `dimension()` of poset?



---

archive/issue_comments_412754.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI think the poset thing is fixed by #26796.\n\nBut the patch I just posted is surely needed - you can see it fixes the following leak:\n\n```\nsage: def bad99(n):\n....:     from sage.numerical.backends.generic_backend import get_solver\n....:     for i in range(n):\n....:         p = get_solver(solver = \"GLPK\")\n....:         p.add_linear_constraints(5, 0, None)\n....:         p.add_col(range(5), range(5))\n....:         if i % 10000 == 0:\n....:             print get_memory_usage()\n....: \n....: bad99(100000)\n```",
    "created_at": "2018-12-02T15:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412754",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

I think the poset thing is fixed by #26796.

But the patch I just posted is surely needed - you can see it fixes the following leak:

```
sage: def bad99(n):
....:     from sage.numerical.backends.generic_backend import get_solver
....:     for i in range(n):
....:         p = get_solver(solver = "GLPK")
....:         p.add_linear_constraints(5, 0, None)
....:         p.add_col(range(5), range(5))
....:         if i % 10000 == 0:
....:             print get_memory_usage()
....: 
....: bad99(100000)
```



---

archive/issue_events_368298.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-02T16:06:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368298"
}
```



---

archive/issue_comments_412755.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c5e849e04cb4f8e14f78da5af60159dcad67836\"><code>3c5e849</code></a></td><td><code>fix a memory leak in glpk backend</code></td></tr></table>\n",
    "created_at": "2018-12-02T16:06:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412755",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c5e849e04cb4f8e14f78da5af60159dcad67836"><code>3c5e849</code></a></td><td><code>fix a memory leak in glpk backend</code></td></tr></table>




---

archive/issue_comments_412756.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2018-12-02T16:06:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412756",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_comments_412757.json:
```json
{
    "body": "Commit: **[`3c5e849`](https://github.com/sagemath/sagetrac-mirror/commit/3c5e849e04cb4f8e14f78da5af60159dcad67836)**",
    "created_at": "2018-12-02T16:06:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412757",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`3c5e849`](https://github.com/sagemath/sagetrac-mirror/commit/3c5e849e04cb4f8e14f78da5af60159dcad67836)**



---

archive/issue_comments_412758.json:
```json
{
    "body": "Branch: **[public/packages/glpkbackendmemleak](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/glpkbackendmemleak)**",
    "created_at": "2018-12-02T16:06:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412758",
    "user": "https://github.com/dimpase"
}
```

Branch: **[public/packages/glpkbackendmemleak](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/glpkbackendmemleak)**



---

archive/issue_comments_412759.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\na similar bug seems to be in `add_col` coin backend...",
    "created_at": "2018-12-02T16:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412759",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

a similar bug seems to be in `add_col` coin backend...



---

archive/issue_comments_412760.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nSomeone should check `src/sage/matroids/basis_matroid.pyx` and make a ticket for that if needed before closing this one, as otherwise we may forgot that.",
    "created_at": "2018-12-02T18:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412760",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:15" align="right">comment:15</div>

Someone should check `src/sage/matroids/basis_matroid.pyx` and make a ticket for that if needed before closing this one, as otherwise we may forgot that.



---

archive/issue_events_368299.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-02T18:07:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368299"
}
```



---

archive/issue_events_368300.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-02T18:07:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368300"
}
```



---

archive/issue_comments_412761.json:
```json
{
    "body": "Changed commit from **[`3c5e849`](https://github.com/sagemath/sagetrac-mirror/commit/3c5e849e04cb4f8e14f78da5af60159dcad67836)** to **[`c407d99`](https://github.com/sagemath/sagetrac-mirror/commit/c407d99c3d3a8302f1f0519702935a4049406ceb)**",
    "created_at": "2018-12-02T23:24:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412761",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3c5e849`](https://github.com/sagemath/sagetrac-mirror/commit/3c5e849e04cb4f8e14f78da5af60159dcad67836)** to **[`c407d99`](https://github.com/sagemath/sagetrac-mirror/commit/c407d99c3d3a8302f1f0519702935a4049406ceb)**



---

archive/issue_comments_412762.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4442be1dcb03a1287aa0cbf81ae2a0cb25d85bc\"><code>f4442be</code></a></td><td><code>fix memory leaks in coin backend</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c407d99c3d3a8302f1f0519702935a4049406ceb\"><code>c407d99</code></a></td><td><code>remove obsolete C++-specific Cython declarations</code></td></tr></table>\n",
    "created_at": "2018-12-02T23:24:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412762",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4442be1dcb03a1287aa0cbf81ae2a0cb25d85bc"><code>f4442be</code></a></td><td><code>fix memory leaks in coin backend</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c407d99c3d3a8302f1f0519702935a4049406ceb"><code>c407d99</code></a></td><td><code>remove obsolete C++-specific Cython declarations</code></td></tr></table>




---

archive/issue_comments_412763.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@jm58660](#comment:15):\n> Someone should check `src/sage/matroids/basis_matroid.pyx` and make a ticket for that if needed before closing this one, as otherwise we may forgot that.\n\nCoin backend hopefully fixed too.\n\nPlease post the code showing the leak in basis_matroid",
    "created_at": "2018-12-02T23:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412763",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@jm58660](#comment:15):
> Someone should check `src/sage/matroids/basis_matroid.pyx` and make a ticket for that if needed before closing this one, as otherwise we may forgot that.

Coin backend hopefully fixed too.

Please post the code showing the leak in basis_matroid



---

archive/issue_comments_412764.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@dimpase](#comment:17):\n\n> Please post the code showing the leak in basis_matroid\n\n```\nfrom sage.matroids.advanced import *\nimport gc\n\ni = 0\nwhile True:\n    if i%1000==0: print get_memory_usage()\n    i += 1\n    M = BasisMatroid(matroids.named_matroids.NonFano())\n    N = BasisMatroid(matroids.named_matroids.Fano())\n    m = {e:e for e in M.groundset()}\n    M._is_relaxation(N, m)\n    N._is_relaxation(M, m)\n```",
    "created_at": "2018-12-03T07:09:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412764",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@dimpase](#comment:17):

> Please post the code showing the leak in basis_matroid

```
from sage.matroids.advanced import *
import gc

i = 0
while True:
    if i%1000==0: print get_memory_usage()
    i += 1
    M = BasisMatroid(matroids.named_matroids.NonFano())
    N = BasisMatroid(matroids.named_matroids.Fano())
    m = {e:e for e in M.groundset()}
    M._is_relaxation(N, m)
    N._is_relaxation(M, m)
```



---

archive/issue_comments_412765.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nregarding Poset dimension. It seems it's already a problem in the beginning of the function:\n\n```python\nimport gc\nfrom sage.graphs.comparability import greedy_is_comparability as is_comparability\ni = 0                                                                            \nfor P in Posets(8):\n    if i % 1000 == 0:\n        gc.collect()\n        print get_memory_usage()\n    i += 1\n    _ = is_comparability(P._hasse_diagram.transitive_closure().to_undirected().complement())            \n```\n\nIf I remove the call to `is_comparability()` the problem is gone here.",
    "created_at": "2018-12-03T10:30:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412765",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

regarding Poset dimension. It seems it's already a problem in the beginning of the function:

```python
import gc
from sage.graphs.comparability import greedy_is_comparability as is_comparability
i = 0                                                                            
for P in Posets(8):
    if i % 1000 == 0:
        gc.collect()
        print get_memory_usage()
    i += 1
    _ = is_comparability(P._hasse_diagram.transitive_closure().to_undirected().complement())            
```

If I remove the call to `is_comparability()` the problem is gone here.



---

archive/issue_comments_412766.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@dimpase](#comment:19):\n\n> If I remove the call to `is_comparability()` the problem is gone here.\n\nBut if I change the line to be only `is_comparability()`, then there is no problem. Uh, a hard one is this.",
    "created_at": "2018-12-03T11:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412766",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@dimpase](#comment:19):

> If I remove the call to `is_comparability()` the problem is gone here.

But if I change the line to be only `is_comparability()`, then there is no problem. Uh, a hard one is this.



---

archive/issue_comments_412767.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nWhat's this:\n\n```\nimport gc\n\ni = 0\nGG = graphs()\n_ = next(GG); _ = next(GG); \nfor P in GG:\n    if i > 20000: break\n    if i % 1000 == 0:\n        _ = gc.collect()\n        print get_memory_usage(), P.order()\n    i += 1\n    _ = P.convexity_properties()\n```\n\n??? There is an explicit `__destruct__` in class `ConvexityProperties`.",
    "created_at": "2018-12-03T11:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412767",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:21" align="right">comment:21</div>

What's this:

```
import gc

i = 0
GG = graphs()
_ = next(GG); _ = next(GG); 
for P in GG:
    if i > 20000: break
    if i % 1000 == 0:
        _ = gc.collect()
        print get_memory_usage(), P.order()
    i += 1
    _ = P.convexity_properties()
```

??? There is an explicit `__destruct__` in class `ConvexityProperties`.



---

archive/issue_comments_412768.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jm58660](#comment:20):\n> Replying to [@dimpase](#comment:19):\n> \n> > If I remove the call to `is_comparability()` the problem is gone here.\n\n> \n> But if I change the line to be only `is_comparability()`, then there is no problem. Uh, a hard one is this.\n\nBy the way, (with `_ = ...` present) do you notice that it stabilises approximately half-way, stops growing? Feels like an internal cache somewhere fills in, and then it's full, so no extra growth...",
    "created_at": "2018-12-03T11:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412768",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jm58660](#comment:20):
> Replying to [@dimpase](#comment:19):
> 
> > If I remove the call to `is_comparability()` the problem is gone here.

> 
> But if I change the line to be only `is_comparability()`, then there is no problem. Uh, a hard one is this.

By the way, (with `_ = ...` present) do you notice that it stabilises approximately half-way, stops growing? Feels like an internal cache somewhere fills in, and then it's full, so no extra growth...



---

archive/issue_comments_412769.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@dimpase](#comment:22):\n\n> By the way, (with `_ = ...` present) do you notice that it stabilises approximately half-way, stops growing? Feels like an internal cache somewhere fills in, and then it's full, so no extra growth...\n\nYes, I have noticed that. And sometime the grow stalls for a while and then continues.\n\nI guess that Python runs malloc() at C-level with some kind of heuristics, \"the user will propably ask for more soon anyways\".",
    "created_at": "2018-12-03T11:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412769",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@dimpase](#comment:22):

> By the way, (with `_ = ...` present) do you notice that it stabilises approximately half-way, stops growing? Feels like an internal cache somewhere fills in, and then it's full, so no extra growth...

Yes, I have noticed that. And sometime the grow stalls for a while and then continues.

I guess that Python runs malloc() at C-level with some kind of heuristics, "the user will propably ask for more soon anyways".



---

archive/issue_comments_412770.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jm58660](#comment:21):\n> What's this:\n> \n> ```\n> import gc\n> \n> i = 0\n> GG = graphs()\n> _ = next(GG); _ = next(GG); \n> for P in GG:\n>     if i > 20000: break\n>     if i % 1000 == 0:\n>         _ = gc.collect()\n>         print get_memory_usage(), P.order()\n>     i += 1\n>     _ = P.convexity_properties()\n> ```\n> \n> ??? There is an explicit `__destruct__` in class `ConvexityProperties`.\n\nI've noticed this one missing:\n\n```diff\ndiff --git a/src/sage/graphs/convexity_properties.pyx b/src/sage/graphs/convexity_properties.pyx\nindex 474eb0e4cf..6b66e77a39 100644\n--- a/src/sage/graphs/convexity_properties.pyx\n+++ b/src/sage/graphs/convexity_properties.pyx\n@@ -333,6 +333,7 @@ cdef class ConvexityProperties:\n                 if bitset_len(tmp) < self._n:\n                     bitset_add(bs, i)\n \n+        bitset_free(tmp)\n \n     cpdef hull_number(self, value_only=True, verbose=False):\n         r\"\"\"\n```\nbut it does not seem to matter here.",
    "created_at": "2018-12-03T12:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412770",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jm58660](#comment:21):
> What's this:
> 
> ```
> import gc
> 
> i = 0
> GG = graphs()
> _ = next(GG); _ = next(GG); 
> for P in GG:
>     if i > 20000: break
>     if i % 1000 == 0:
>         _ = gc.collect()
>         print get_memory_usage(), P.order()
>     i += 1
>     _ = P.convexity_properties()
> ```
> 
> ??? There is an explicit `__destruct__` in class `ConvexityProperties`.

I've noticed this one missing:

```diff
diff --git a/src/sage/graphs/convexity_properties.pyx b/src/sage/graphs/convexity_properties.pyx
index 474eb0e4cf..6b66e77a39 100644
--- a/src/sage/graphs/convexity_properties.pyx
+++ b/src/sage/graphs/convexity_properties.pyx
@@ -333,6 +333,7 @@ cdef class ConvexityProperties:
                 if bitset_len(tmp) < self._n:
                     bitset_add(bs, i)
 
+        bitset_free(tmp)
 
     cpdef hull_number(self, value_only=True, verbose=False):
         r"""
```
but it does not seem to matter here.



---

archive/issue_comments_412771.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c42c3bc27da534544dc62a953d5457d6c27532b5\"><code>c42c3bc</code></a></td><td><code>added one missing free()...</code></td></tr></table>\n",
    "created_at": "2018-12-03T12:12:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412771",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c42c3bc27da534544dc62a953d5457d6c27532b5"><code>c42c3bc</code></a></td><td><code>added one missing free()...</code></td></tr></table>




---

archive/issue_comments_412772.json:
```json
{
    "body": "Changed commit from **[`c407d99`](https://github.com/sagemath/sagetrac-mirror/commit/c407d99c3d3a8302f1f0519702935a4049406ceb)** to **[`c42c3bc`](https://github.com/sagemath/sagetrac-mirror/commit/c42c3bc27da534544dc62a953d5457d6c27532b5)**",
    "created_at": "2018-12-03T12:12:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412772",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c407d99`](https://github.com/sagemath/sagetrac-mirror/commit/c407d99c3d3a8302f1f0519702935a4049406ceb)** to **[`c42c3bc`](https://github.com/sagemath/sagetrac-mirror/commit/c42c3bc27da534544dc62a953d5457d6c27532b5)**



---

archive/issue_comments_412773.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jm58660](#comment:21):\n> What's this:\n> \n> ```\n> import gc\n> \n> i = 0\n> GG = graphs()\n> _ = next(GG); _ = next(GG); \n> for P in GG:\n>     if i > 20000: break\n>     if i % 1000 == 0:\n>         _ = gc.collect()\n>         print get_memory_usage(), P.order()\n>     i += 1\n>     _ = P.convexity_properties()\n> ```\n> \n> ??? There is an explicit `__destruct__` in class `ConvexityProperties`.\n\nhowever, `__destruct__` is not called, as one can see by putting a `print()` there.",
    "created_at": "2018-12-03T15:01:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412773",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jm58660](#comment:21):
> What's this:
> 
> ```
> import gc
> 
> i = 0
> GG = graphs()
> _ = next(GG); _ = next(GG); 
> for P in GG:
>     if i > 20000: break
>     if i % 1000 == 0:
>         _ = gc.collect()
>         print get_memory_usage(), P.order()
>     i += 1
>     _ = P.convexity_properties()
> ```
> 
> ??? There is an explicit `__destruct__` in class `ConvexityProperties`.

however, `__destruct__` is not called, as one can see by putting a `print()` there.



---

archive/issue_comments_412774.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572\"><code>f786410</code></a></td><td><code>misnamed method</code></td></tr></table>\n",
    "created_at": "2018-12-03T16:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412774",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572"><code>f786410</code></a></td><td><code>misnamed method</code></td></tr></table>




---

archive/issue_comments_412775.json:
```json
{
    "body": "Changed commit from **[`c42c3bc`](https://github.com/sagemath/sagetrac-mirror/commit/c42c3bc27da534544dc62a953d5457d6c27532b5)** to **[`f786410`](https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572)**",
    "created_at": "2018-12-03T16:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412775",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c42c3bc`](https://github.com/sagemath/sagetrac-mirror/commit/c42c3bc27da534544dc62a953d5457d6c27532b5)** to **[`f786410`](https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572)**



---

archive/issue_comments_412776.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nOK, the latest commit fixes `convexity_properties` leak.",
    "created_at": "2018-12-03T16:39:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412776",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

OK, the latest commit fixes `convexity_properties` leak.



---

archive/issue_comments_412777.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nShould we now make another ticket about `_is_relaxation()` and try to review and close this one?",
    "created_at": "2018-12-03T19:34:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412777",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:29" align="right">comment:29</div>

Should we now make another ticket about `_is_relaxation()` and try to review and close this one?



---

archive/issue_comments_412778.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nAs you like - you know more about leaks than me :-)",
    "created_at": "2018-12-03T19:39:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412778",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:30" align="right">comment:30</div>

As you like - you know more about leaks than me :-)



---

archive/issue_comments_412779.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,7 +14,8 @@\n bad8(100000)\n ```\n \n-Second: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.\n+Second, in #26806: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.\n \n Third: Also `dimension()` of posets seems to have a leak. Root cause might be something already corrected.\n \n+More in comments.\n``````\n",
    "created_at": "2018-12-03T19:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412779",
    "user": "https://github.com/jm58660"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,7 +14,8 @@
 bad8(100000)
 ```
 
-Second: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.
+Second, in #26806: Propably `_is_relaxation()` in `src/sage/matroids/basis_matroid.pyx`, `bitset_init` for `bb_comp` and `b2`, but no corresponding `bitset_free`.
 
 Third: Also `dimension()` of posets seems to have a leak. Root cause might be something already corrected.
 
+More in comments.
``````




---

archive/issue_comments_412780.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@dimpase](#comment:30):\n> As you like - you know more about leaks than me :-)\n\nOK, I made #26806. To confirm, is this now ready for review?",
    "created_at": "2018-12-03T19:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412780",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@dimpase](#comment:30):
> As you like - you know more about leaks than me :-)

OK, I made #26806. To confirm, is this now ready for review?



---

archive/issue_events_368301.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-03T19:52:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368301"
}
```



---

archive/issue_events_368302.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-03T19:52:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368302"
}
```



---

archive/issue_comments_412781.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThanks. Yes, please review!",
    "created_at": "2018-12-03T19:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412781",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">comment:32</div>

Thanks. Yes, please review!



---

archive/issue_comments_412782.json:
```json
{
    "body": "Reviewer: **Jori M\u00e4ntysalo**",
    "created_at": "2018-12-04T07:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412782",
    "user": "https://github.com/jm58660"
}
```

Reviewer: **Jori MÃ¤ntysalo**



---

archive/issue_comments_412783.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThis is OK. Thanks for fixes.",
    "created_at": "2018-12-04T07:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412783",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:33" align="right">comment:33</div>

This is OK. Thanks for fixes.



---

archive/issue_events_368303.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-04T07:00:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368303"
}
```



---

archive/issue_events_368304.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-12-04T07:00:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368304"
}
```



---

archive/issue_events_368305.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-07T12:10:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368305"
}
```



---

archive/issue_events_368306.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "990a82ec4a2bf2ceba92008d0733d94354d8cb0d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-12-07T12:10:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26795#event-368306"
}
```



---

archive/issue_comments_412784.json:
```json
{
    "body": "Changed branch from **[public/packages/glpkbackendmemleak](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/glpkbackendmemleak)** to **[`f786410`](https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572)**",
    "created_at": "2018-12-07T12:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26795",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26795#issuecomment-412784",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/packages/glpkbackendmemleak](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/glpkbackendmemleak)** to **[`f786410`](https://github.com/sagemath/sagetrac-mirror/commit/f786410df2a639ad1e95fc7c78e09b851c02d572)**
