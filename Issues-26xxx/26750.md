# Issue 26750: Use GroupHomset_libgap for permutation groups, as well

archive/issues_026513.json:
```json
{
    "body": "At the moment the construction of group homomorphisms between groups implemented under the classes `ParentLibGAP` and `PermutationGroup_generic` (and vice versa) is not possible in sage using the method `hom`. For example, it isn't possible to construct the natural projection from symplectic groups onto the corresponding projective group although this is possible using GAP:\n\n```\nsage: Sp43 = Sp(4,3)\nsage: PSp43 = PSp(4,3)\nsage: natProj = Sp43.hom(PSp43.gens())\nTraceback (most recent call last):\n...\nTypeError: unable to convert [(3,4)(6,7)(9,10)(12,13)(17,20)(18,21)(19,22)(23,32)(24,33)(25,34)(26,38)(27,39)(28,40)(29,35)(30,36)(31,37), (1,5,14,17,27,22,19,36,3)(2,6,32)(4,7,23,20,37,13,16,26,40)(8,24,29,30,39,10,33,11,34)(9,15,35)(12,25,38)(21,28,31)] to an element of Set of Morphisms from Symplectic Group of degree 4 over Finite Field of size 3 to The projective symplectic linear group of degree 4 over Finite Field of size 3 in Category of finite groups\n```\n\nThe reason for this is that the constructor of the class `GroupHomset_libgap` explicitly checks both groups to be instances of `ParentLibGAP`. So an easy way to have `hom` work in such cases, as well, would be to allow `PermutationGroup_generic` additionally.\n\nAn alternative option is to shift `PermutationGroup_generic` into the `ParentLibGAP` framework. But this would cause a lot of work to have all doctests pass through. The main problem here is that the element class of PermutationGroup_generic still has `parent` as second (optional) argument (in opposite to `ParentLibGAP`).\n\nTherefore, this ticket will follow the first option!\n\nCC:  @tscrim @simonbrandhorst\n\nKeywords: permutation group, homomorphism, libgap\n\nReviewer: Simon Brandhorst\n\nAuthor: Sebastian Oehms\n\nBranch: 66ceb94036041b2bf05e1f4abf91ea8bdeac862a\n\nDependencies: #26420\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26750\n\n",
    "closed_at": "2018-12-27T16:04:02Z",
    "created_at": "2018-11-23T20:03:47Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.6",
    "title": "Use GroupHomset_libgap for permutation groups, as well",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26750",
    "user": "https://github.com/soehms"
}
```
At the moment the construction of group homomorphisms between groups implemented under the classes `ParentLibGAP` and `PermutationGroup_generic` (and vice versa) is not possible in sage using the method `hom`. For example, it isn't possible to construct the natural projection from symplectic groups onto the corresponding projective group although this is possible using GAP:

```
sage: Sp43 = Sp(4,3)
sage: PSp43 = PSp(4,3)
sage: natProj = Sp43.hom(PSp43.gens())
Traceback (most recent call last):
...
TypeError: unable to convert [(3,4)(6,7)(9,10)(12,13)(17,20)(18,21)(19,22)(23,32)(24,33)(25,34)(26,38)(27,39)(28,40)(29,35)(30,36)(31,37), (1,5,14,17,27,22,19,36,3)(2,6,32)(4,7,23,20,37,13,16,26,40)(8,24,29,30,39,10,33,11,34)(9,15,35)(12,25,38)(21,28,31)] to an element of Set of Morphisms from Symplectic Group of degree 4 over Finite Field of size 3 to The projective symplectic linear group of degree 4 over Finite Field of size 3 in Category of finite groups
```

The reason for this is that the constructor of the class `GroupHomset_libgap` explicitly checks both groups to be instances of `ParentLibGAP`. So an easy way to have `hom` work in such cases, as well, would be to allow `PermutationGroup_generic` additionally.

An alternative option is to shift `PermutationGroup_generic` into the `ParentLibGAP` framework. But this would cause a lot of work to have all doctests pass through. The main problem here is that the element class of PermutationGroup_generic still has `parent` as second (optional) argument (in opposite to `ParentLibGAP`).

Therefore, this ticket will follow the first option!

CC:  @tscrim @simonbrandhorst

Keywords: permutation group, homomorphism, libgap

Reviewer: Simon Brandhorst

Author: Sebastian Oehms

Branch: 66ceb94036041b2bf05e1f4abf91ea8bdeac862a

Dependencies: #26420

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26750





---

archive/issue_comments_372423.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-24T10:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372423",
    "user": "https://github.com/soehms"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_372424.json:
```json
{
    "body": "<a id='comment:2'></a>I do the following:                           \n\n1) I add the method `gap` to the classes `PermutationGroup_generic` and `PermutationGroupElement` to achieve compatibility with class `GroupHomset_libgap` and its elements class. For the same reason I add the method `_subgroup_constructor` to `PermutationGroup_generic` (needed in the methods `pushforward`, `kernel` and `preimage` in `GroupMorphism_libgap`)\n\n2) I implement the method `_Hom_` in `PermutationGroup_generic` to have `hom` use class `GroupHomset_libgap`.\n\n\n3) In the module `libgap_morphism` I add `PermutationGroup_generic` to the list of allowed parent-instances at all relevant pieces of code. Furthermore, I changed the `_element_constructor_` in order to avoid buffer size overflow by transferring long lists of large permutation generators to GAP. This is done in a new local method `_obtain_gap_hom`.\n\n4) I take the occasion to implement two methods from framework: `section` of class `Map` and `natural_map` of class `HomsetWithBase` improving their default implementation using the possibilities of `GroupHomset_libgap` and its element class.\n\n---\nNew commits:",
    "created_at": "2018-11-24T10:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372424",
    "user": "https://github.com/soehms"
}
```

<a id='comment:2'></a>I do the following:                           

1) I add the method `gap` to the classes `PermutationGroup_generic` and `PermutationGroupElement` to achieve compatibility with class `GroupHomset_libgap` and its elements class. For the same reason I add the method `_subgroup_constructor` to `PermutationGroup_generic` (needed in the methods `pushforward`, `kernel` and `preimage` in `GroupMorphism_libgap`)

2) I implement the method `_Hom_` in `PermutationGroup_generic` to have `hom` use class `GroupHomset_libgap`.


3) In the module `libgap_morphism` I add `PermutationGroup_generic` to the list of allowed parent-instances at all relevant pieces of code. Furthermore, I changed the `_element_constructor_` in order to avoid buffer size overflow by transferring long lists of large permutation generators to GAP. This is done in a new local method `_obtain_gap_hom`.

4) I take the occasion to implement two methods from framework: `section` of class `Map` and `natural_map` of class `HomsetWithBase` improving their default implementation using the possibilities of `GroupHomset_libgap` and its element class.

---
New commits:



---

archive/issue_comments_372425.json:
```json
{
    "body": "<a id='comment:3'></a>I am not convinced the function `_obtain_gap_hom` is useful/necessary. \nIt seems to be used only for the `natural_map` method. But then the code just belongs there.\nBut indeed one could replace \n\n```\ngens = [g.gap() for g in dom.gens()]\n```\nby\n\n```\ngens = dom.gap().GeneratorsOfGroup()\n```\nin the `_element_constructor_`\nand likewise for the images in natural map. Would that fix the overflow?",
    "created_at": "2018-11-28T16:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372425",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:3'></a>I am not convinced the function `_obtain_gap_hom` is useful/necessary. 
It seems to be used only for the `natural_map` method. But then the code just belongs there.
But indeed one could replace 

```
gens = [g.gap() for g in dom.gens()]
```
by

```
gens = dom.gap().GeneratorsOfGroup()
```
in the `_element_constructor_`
and likewise for the images in natural map. Would that fix the overflow?



---

archive/issue_comments_372426.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-28T22:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372426",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372427.json:
```json
{
    "body": "<a id='comment:5'></a>Thanks for looking at this, Simon! Of course you are right: This method has been a stupid idea! I corrected as you suggested.",
    "created_at": "2018-11-28T22:22:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372427",
    "user": "https://github.com/soehms"
}
```

<a id='comment:5'></a>Thanks for looking at this, Simon! Of course you are right: This method has been a stupid idea! I corrected as you suggested.



---

archive/issue_comments_372428.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-28T23:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372428",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372429.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2018-11-28T23:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372429",
    "user": "https://github.com/soehms"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_372430.json:
```json
{
    "body": "<a id='comment:8'></a>New commits:",
    "created_at": "2018-11-28T23:32:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372430",
    "user": "https://github.com/soehms"
}
```

<a id='comment:8'></a>New commits:



---

archive/issue_comments_372431.json:
```json
{
    "body": "<a id='comment:9'></a>I think I need some help. I wanted to restore the doctest of `_obtain_gap_hom` in `_element_constructor_` but pushed from the wrong branch.\n\nHow can I go back to commit deaa64722319dc847871b77b15cab2efbb972850?",
    "created_at": "2018-11-28T23:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372431",
    "user": "https://github.com/soehms"
}
```

<a id='comment:9'></a>I think I need some help. I wanted to restore the doctest of `_obtain_gap_hom` in `_element_constructor_` but pushed from the wrong branch.

How can I go back to commit deaa64722319dc847871b77b15cab2efbb972850?



---

archive/issue_comments_372432.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-11-28T23:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372433.json:
```json
{
    "body": "<a id='comment:11'></a>I think I got it!",
    "created_at": "2018-11-28T23:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372433",
    "user": "https://github.com/soehms"
}
```

<a id='comment:11'></a>I think I got it!



---

archive/issue_comments_372434.json:
```json
{
    "body": "<a id='comment:12'></a>in the `_element_constructor` method:\n\n```\nif list(x) == codom.gens():\n    # avoid buffer size overflow in the interface\n    imgs = codom.gap().GeneratorsOfGroup()\n```\nthis seems to fit better with the `natural_map` method? Put it there.",
    "created_at": "2018-11-29T01:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372434",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:12'></a>in the `_element_constructor` method:

```
if list(x) == codom.gens():
    # avoid buffer size overflow in the interface
    imgs = codom.gap().GeneratorsOfGroup()
```
this seems to fit better with the `natural_map` method? Put it there.



---

archive/issue_comments_372435.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-01T22:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372435",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372436.json:
```json
{
    "body": "<a id='comment:14'></a>Thanks for your useful hints, Simon! There where two problems:\n\n1) I provided the wrong example, so that you did not have a chance to see what these lines of code should be good for. The correct example needs to have an instance of `PermutationGroup_subgroup` as codomain and be large enough to produce:\n\n```\npython2: libgap.c:184: libgap_get_input: Assertion `strlen(libGAP_stdin_buffer) < length' failed\n```\n\n2) The origin for this error, has not been in the `_element_constructor_` method. So any changes here where useless, as you pointed out. Actually, the problem was that GAP didn't know about the subgroup construction.\n\nSo I revert all changes of code with respect to the `_element_constructor_` and provide the example which caused the trouble in its docstring. I inserted a line of code in the constructor of the `PermutationGroup_subgroup` class to have the `gap` method of such a subgroup work well. This line I explain by a doctest in `gap`.\n\nIn addition I change the implementation of `gap`, since I realized that the former one can cause pickling errors.",
    "created_at": "2018-12-01T22:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372436",
    "user": "https://github.com/soehms"
}
```

<a id='comment:14'></a>Thanks for your useful hints, Simon! There where two problems:

1) I provided the wrong example, so that you did not have a chance to see what these lines of code should be good for. The correct example needs to have an instance of `PermutationGroup_subgroup` as codomain and be large enough to produce:

```
python2: libgap.c:184: libgap_get_input: Assertion `strlen(libGAP_stdin_buffer) < length' failed
```

2) The origin for this error, has not been in the `_element_constructor_` method. So any changes here where useless, as you pointed out. Actually, the problem was that GAP didn't know about the subgroup construction.

So I revert all changes of code with respect to the `_element_constructor_` and provide the example which caused the trouble in its docstring. I inserted a line of code in the constructor of the `PermutationGroup_subgroup` class to have the `gap` method of such a subgroup work well. This line I explain by a doctest in `gap`.

In addition I change the implementation of `gap`, since I realized that the former one can cause pickling errors.



---

archive/issue_comments_372437.json:
```json
{
    "body": "<a id='comment:17'></a>It seems you are caching twice here. Once with the decorator once inside the method.\n\n```\n@cached_method\ndef gap(self):\n```\n\n---\nNew commits:",
    "created_at": "2018-12-04T09:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372437",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:17'></a>It seems you are caching twice here. Once with the decorator once inside the method.

```
@cached_method
def gap(self):
```

---
New commits:



---

archive/issue_comments_372438.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 sbrandhorst]:\n> It seems you are caching twice here. Once with the decorator once inside the method.\n> \n> ```\n> @cached_method\n> def gap(self):\n> ```\n> \n> ---\n> New commits:\n> |                                                                                                                                          |                                                  |\n> |------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n> |[e1e4da0](https://git.sagemath.org/sage.git/commit?id=e1e4da03582f9674e1628a02e6b502d9dfdcee85)|`resetting to a new branch because of merge error`|\n\n\nI inserted the decorator since I removed the explixit caching via the `_libgap` attribute (since this caused pickling problems). I am not aware that there is an implicite caching mechanism via the element construction of class `Gap`. Can you explain how this is working?",
    "created_at": "2018-12-05T19:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372438",
    "user": "https://github.com/soehms"
}
```

<a id='comment:18'></a>Replying to [comment:17 sbrandhorst]:
> It seems you are caching twice here. Once with the decorator once inside the method.
> 
> ```
> @cached_method
> def gap(self):
> ```
> 
> ---
> New commits:
> |                                                                                                                                          |                                                  |
> |------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
> |[e1e4da0](https://git.sagemath.org/sage.git/commit?id=e1e4da03582f9674e1628a02e6b502d9dfdcee85)|`resetting to a new branch because of merge error`|


I inserted the decorator since I removed the explixit caching via the `_libgap` attribute (since this caused pickling problems). I am not aware that there is an implicite caching mechanism via the element construction of class `Gap`. Can you explain how this is working?



---

archive/issue_comments_372439.json:
```json
{
    "body": "<a id='comment:19'></a>I've linked this ticket to #26902, which aims at planning and tracking conversion of Sage library code from pexpect gap to libgap.",
    "created_at": "2018-12-15T15:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372439",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>I've linked this ticket to #26902, which aims at planning and tracking conversion of Sage library code from pexpect gap to libgap.



---

archive/issue_comments_372440.json:
```json
{
    "body": "<a id='comment:20'></a>Could you take care of pyflakes' advice (see patchbot output) and remove unneeded imports:\n\n```\n========== pyflakes ==========\ngit checkout patchbot/ticket_merged\nsrc/sage/categories/homset.py:73: 'sage.misc.constant_function.ConstantFunction' imported but unused\nsrc/sage/categories/homset.py:75: 'types' imported but unused\nfound 2 pyflakes errors in the modified files\n```",
    "created_at": "2018-12-16T11:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372440",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>Could you take care of pyflakes' advice (see patchbot output) and remove unneeded imports:

```
========== pyflakes ==========
git checkout patchbot/ticket_merged
src/sage/categories/homset.py:73: 'sage.misc.constant_function.ConstantFunction' imported but unused
src/sage/categories/homset.py:75: 'types' imported but unused
found 2 pyflakes errors in the modified files
```



---

archive/issue_comments_372441.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:18 soehms]:\n> I inserted the decorator since I removed the explixit caching via the `_libgap` attribute (since this caused pickling problems). I am not aware that there is an implicite caching mechanism via the element construction of class `Gap`. Can you explain how this is working?\n\nIt still seems to be there:\n\n```\n+    @cached_method\n+    def gap(self):\n+        if self._libgap is not None:\n+            return self._libgap\n+        from sage.libs.gap.libgap import libgap\n+        return libgap(self)\n```\nTo me it looks like there are 2 caches once via the _libgap attribute and once in the `@`cached method\nSay if one first calls `.gap()` and then the _libgap attribute is set somewhere",
    "created_at": "2018-12-16T12:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372441",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:21'></a>Replying to [comment:18 soehms]:
> I inserted the decorator since I removed the explixit caching via the `_libgap` attribute (since this caused pickling problems). I am not aware that there is an implicite caching mechanism via the element construction of class `Gap`. Can you explain how this is working?

It still seems to be there:

```
+    @cached_method
+    def gap(self):
+        if self._libgap is not None:
+            return self._libgap
+        from sage.libs.gap.libgap import libgap
+        return libgap(self)
```
To me it looks like there are 2 caches once via the _libgap attribute and once in the `@`cached method
Say if one first calls `.gap()` and then the _libgap attribute is set somewhere



---

archive/issue_comments_372442.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:21 sbrandhorst]:\n> Replying to [comment:18 soehms]:\n> To me it looks like there are 2 caches once via the _libgap attribute and once in the `@`cached method\n> Say if one first calls `.gap()` and then the _libgap attribute is set somewhere\n\n\nIn general it isn't cached via that attribute (I've removed that in my last change):\n\n```\nsage: S = SymmetricGroup(6)\nsage: print S._libgap\nNone\nsage: S.gap()\nSym( [ 1 .. 6 ] )\nsage: print S._libgap\nNone\n```",
    "created_at": "2018-12-16T13:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372442",
    "user": "https://github.com/soehms"
}
```

<a id='comment:22'></a>Replying to [comment:21 sbrandhorst]:
> Replying to [comment:18 soehms]:
> To me it looks like there are 2 caches once via the _libgap attribute and once in the `@`cached method
> Say if one first calls `.gap()` and then the _libgap attribute is set somewhere


In general it isn't cached via that attribute (I've removed that in my last change):

```
sage: S = SymmetricGroup(6)
sage: print S._libgap
None
sage: S.gap()
Sym( [ 1 .. 6 ] )
sage: print S._libgap
None
```



---

archive/issue_comments_372443.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-16T16:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372444.json:
```json
{
    "body": "<a id='comment:24'></a>```\n+        from sage.libs.gap.element import GapElement_Permutation\n+        if isinstance(img_gap, GapElement_Permutation):\n+            return self.codomain()(img_gap.sage())\n```\nWhat happens here is a conversion of a gap element to an element of a permutation group. \nIt would be more useful to let this be handled by the permuation group code\ni.e. in the element constructor of permutation groups and not in the `_call_` method of the morphism.\nAlso there are a few little python style remarks for the doctests, like\n\n```\n+            sage: GS=G.subgroup([G.gen(0)])\n```\nshould be \n\n```\n+            sage: GS = G.subgroup([G.gen(0)])\n```",
    "created_at": "2018-12-21T11:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372444",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:24'></a>```
+        from sage.libs.gap.element import GapElement_Permutation
+        if isinstance(img_gap, GapElement_Permutation):
+            return self.codomain()(img_gap.sage())
```
What happens here is a conversion of a gap element to an element of a permutation group. 
It would be more useful to let this be handled by the permuation group code
i.e. in the element constructor of permutation groups and not in the `_call_` method of the morphism.
Also there are a few little python style remarks for the doctests, like

```
+            sage: GS=G.subgroup([G.gen(0)])
```
should be 

```
+            sage: GS = G.subgroup([G.gen(0)])
```



---

archive/issue_comments_372445.json:
```json
{
    "body": "<a id='comment:27'></a>I follow your suggestion concerning the `_call_` method and I revert one of your style changes because of a failing doctest (see patchbot).\n\n---\nNew commits:",
    "created_at": "2018-12-22T11:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372445",
    "user": "https://github.com/soehms"
}
```

<a id='comment:27'></a>I follow your suggestion concerning the `_call_` method and I revert one of your style changes because of a failing doctest (see patchbot).

---
New commits:



---

archive/issue_comments_372446.json:
```json
{
    "body": "<a id='comment:29'></a>Positive review if you are happy with my changes & we have a green bot\n\n---\nNew commits:",
    "created_at": "2018-12-22T15:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372446",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:29'></a>Positive review if you are happy with my changes & we have a green bot

---
New commits:



---

archive/issue_comments_372447.json:
```json
{
    "body": "<a id='comment:30'></a>btw. if you split up your tickets into smaller ones, they are easier to review",
    "created_at": "2018-12-22T15:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372447",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:30'></a>btw. if you split up your tickets into smaller ones, they are easier to review



---

archive/issue_comments_372448.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:29 sbrandhorst]:\n> Positive review if you are happy with my changes & we have a green bot\n> \n> ---\n> New commits:\n> |                                                                                                                                          |                                                                    |\n> |------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|\n> |[e0feb00](https://git.sagemath.org/sage.git/commit?id=e0feb001f33e1f78efd180d38a6ddbbe6741ebeb)|`changes to docs and the permutation group and subgroup constructor`|\n\n\nThis is a good improvement in order to get the permutation groups closer to libgap!\nI just do two doc-string adaptions and rename your `GapElement` since that name is already used globally with respect to `sage.interfaces.gap`\n\nThanks for the review, Simon.\nI wish you a merry Christmas!\n\n---\nNew commits:",
    "created_at": "2018-12-23T12:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372448",
    "user": "https://github.com/soehms"
}
```

<a id='comment:32'></a>Replying to [comment:29 sbrandhorst]:
> Positive review if you are happy with my changes & we have a green bot
> 
> ---
> New commits:
> |                                                                                                                                          |                                                                    |
> |------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
> |[e0feb00](https://git.sagemath.org/sage.git/commit?id=e0feb001f33e1f78efd180d38a6ddbbe6741ebeb)|`changes to docs and the permutation group and subgroup constructor`|


This is a good improvement in order to get the permutation groups closer to libgap!
I just do two doc-string adaptions and rename your `GapElement` since that name is already used globally with respect to `sage.interfaces.gap`

Thanks for the review, Simon.
I wish you a merry Christmas!

---
New commits:



---

archive/issue_comments_372449.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:30 sbrandhorst]:\n> btw. if you split up your tickets into smaller ones, they are easier to review\n  \nSure! I will try to take care of that the next time!",
    "created_at": "2018-12-23T12:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372449",
    "user": "https://github.com/soehms"
}
```

<a id='comment:33'></a>Replying to [comment:30 sbrandhorst]:
> btw. if you split up your tickets into smaller ones, they are easier to review
  
Sure! I will try to take care of that the next time!



---

archive/issue_comments_372450.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-23T12:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372450",
    "user": "https://github.com/soehms"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_066224.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-27T16:04:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26750#event-66224"
}
```



---

archive/issue_comments_372451.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-27T16:04:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372451",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066225.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T13:56:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "milestone": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26750#event-66225"
}
```



---

archive/issue_comments_372452.json:
```json
{
    "body": "<a id='comment:37'></a>I've created a follow up ticket #27234 since by the improvements in connection with GAP 4.10 upgrade, the implementation of the `gap` method of class `PermutationGroupElement` can be done properly, right now.",
    "created_at": "2019-02-07T22:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26750#issuecomment-372452",
    "user": "https://github.com/soehms"
}
```

<a id='comment:37'></a>I've created a follow up ticket #27234 since by the improvements in connection with GAP 4.10 upgrade, the implementation of the `gap` method of class `PermutationGroupElement` can be done properly, right now.
