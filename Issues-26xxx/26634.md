# Issue 26634: clean generic_graph.py (part 5)

archive/issues_026397.json:
```json
{
    "body": "CC:  @tscrim\n\nKeywords: py3, graph\n\nHere, we improve methods `antisymmetric`, `transitive_closure`, `is_transitively_reduced` and `transitive_reduction`. In particular, we add parameter `loops` to `transitive_closure` to control the addition of loops to the resulting graph (e.g., add a loop to u if u belongs to a directed cycle).\n\nIssue created by migration from https://trac.sagemath.org/ticket/26634\n\n",
    "closed_at": "2018-12-08T02:54:29Z",
    "created_at": "2018-11-04T16:44:07Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "clean generic_graph.py (part 5)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26634",
    "user": "https://github.com/dcoudert"
}
```
CC:  @tscrim

Keywords: py3, graph

Here, we improve methods `antisymmetric`, `transitive_closure`, `is_transitively_reduced` and `transitive_reduction`. In particular, we add parameter `loops` to `transitive_closure` to control the addition of loops to the resulting graph (e.g., add a loop to u if u belongs to a directed cycle).

Issue created by migration from https://trac.sagemath.org/ticket/26634





---

archive/issue_comments_371290.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-11-04T16:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371290",
    "user": "https://github.com/dcoudert"
}
```

New commits:



---

archive/issue_comments_371291.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-04T16:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371291",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_371292.json:
```json
{
    "body": "I do not understand why there should be a `loops` for `transitive_closure()`. It does not seem well-defined or useful.",
    "created_at": "2018-11-05T02:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371292",
    "user": "https://github.com/tscrim"
}
```

I do not understand why there should be a `loops` for `transitive_closure()`. It does not seem well-defined or useful.



---

archive/issue_comments_371293.json:
```json
{
    "body": "You are right and I should change that but I don't know what would be a good way to handle graphs with loops: remove loops ? put loops everywhere ? keep existing loops only ?",
    "created_at": "2018-11-05T08:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371293",
    "user": "https://github.com/dcoudert"
}
```

You are right and I should change that but I don't know what would be a good way to handle graphs with loops: remove loops ? put loops everywhere ? keep existing loops only ?



---

archive/issue_comments_371294.json:
```json
{
    "body": "I would either just keep existing loops or raise an error. One could make the case for removing loops too, but I would rather just keep what is there.",
    "created_at": "2018-11-05T13:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371294",
    "user": "https://github.com/tscrim"
}
```

I would either just keep existing loops or raise an error. One could make the case for removing loops too, but I would rather just keep what is there.



---

archive/issue_comments_371295.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-05T18:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371295",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371296.json:
```json
{
    "body": "Would that be better ? Roughly: if the graph has loops, either we let them in the transitive closure (`loops=True`) or we remove them from the transitive closure (`loops=False`).\n\nBefore this patch, a loop was added to each vertex of the the transitive closure of a graph without loops but allowing loops.",
    "created_at": "2018-11-05T18:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371296",
    "user": "https://github.com/dcoudert"
}
```

Would that be better ? Roughly: if the graph has loops, either we let them in the transitive closure (`loops=True`) or we remove them from the transitive closure (`loops=False`).

Before this patch, a loop was added to each vertex of the the transitive closure of a graph without loops but allowing loops.



---

archive/issue_comments_371297.json:
```json
{
    "body": "Tested over 8.5.beta3.",
    "created_at": "2018-11-13T12:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371297",
    "user": "https://github.com/dcoudert"
}
```

Tested over 8.5.beta3.



---

archive/issue_comments_371298.json:
```json
{
    "body": "Sorry, I have been really busy and can only do a few quick things with Sage right now. I am keeping track of the larger changes you are doing and plan to review them all.\n\nThinking a little bit more, I think adding a loop to every vertex might be the most reasonable definition of the transitive closure of a graph that allows loops. I do not think removing loops is a good way to do it as the transitive closure should always contain the original graph as an induced subgraph. So perhaps there is some fringe benefit to having a `loops` option, but I am more inclined to keep the current behavior. If you wanted a graph with loops, you would have already created a graph allowing loops. However, this behavior should be well-documented.",
    "created_at": "2018-11-13T14:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371298",
    "user": "https://github.com/tscrim"
}
```

Sorry, I have been really busy and can only do a few quick things with Sage right now. I am keeping track of the larger changes you are doing and plan to review them all.

Thinking a little bit more, I think adding a loop to every vertex might be the most reasonable definition of the transitive closure of a graph that allows loops. I do not think removing loops is a good way to do it as the transitive closure should always contain the original graph as an induced subgraph. So perhaps there is some fringe benefit to having a `loops` option, but I am more inclined to keep the current behavior. If you wanted a graph with loops, you would have already created a graph allowing loops. However, this behavior should be well-documented.



---

archive/issue_comments_371299.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-13T17:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371299",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371300.json:
```json
{
    "body": "I have reverted `transitive_closure` to it's initial behavior but added a clear note about loops, plus examples. I have also added an example in `antisymmetric` to show the that loops in directed graphs are ignored.\n\nPS: I really understand time constraints, busy schedule and heavy load :(",
    "created_at": "2018-11-13T17:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371300",
    "user": "https://github.com/dcoudert"
}
```

I have reverted `transitive_closure` to it's initial behavior but added a clear note about loops, plus examples. I have also added an example in `antisymmetric` to show the that loops in directed graphs are ignored.

PS: I really understand time constraints, busy schedule and heavy load :(



---

archive/issue_comments_371301.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-04T20:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371301",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371302.json:
```json
{
    "body": "I have rebased this ticket on 8.5.beta6. The patchbot was complaining so it may help it...",
    "created_at": "2018-12-04T20:52:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371302",
    "user": "https://github.com/dcoudert"
}
```

I have rebased this ticket on 8.5.beta6. The patchbot was complaining so it may help it...



---

archive/issue_comments_371303.json:
```json
{
    "body": "ok, let it be",
    "created_at": "2018-12-06T20:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371303",
    "user": "https://github.com/fchapoton"
}
```

ok, let it be



---

archive/issue_comments_371304.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-06T20:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371304",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_371305.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-08T02:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26634#issuecomment-371305",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066069.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-08T02:54:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26634",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26634#event-66069"
}
```
