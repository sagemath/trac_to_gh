# Issue 26954: Upgrade to gcc 7.4.0 and build gcc and gfortran without isl

archive/issues_026717.json:
```json
{
    "body": "This ticket upgrades to gcc 7.4.0 and builds gcc and gfortran without isl.\n\n**Tarball**: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz\n\nThe upgrade fixes the issue that gcc 7.2.0 does not build on newer systems that have glibc 2.28:\n\nThis issue looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835\n\n```\n[gcc-7.2.0] libtool: compile:  /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/xgcc -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/bin/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/lib/ -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/include -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/sys-include -DHAVE_CONFIG_H -I../../../src/libatomic/config/x86 -I../../../src/libatomic/config/posix -I../../../src/libatomic -I. -Wall -Werror -pthread -g -O2 -MT cas_16_1_.lo -MD -MP -MF .deps/cas_16_1_.lo.Ppo -DN=16 -DIFUNC_ALT=1 -mcx16 -c ../../../src/libatomic/cas_n.c -o cas_16_1_.o >/dev/null 2>&1\n[gcc-7.2.0] ../../../../src/libsanitizer/sanitizer_common/sanitizer_platform_limits_posix.cc:157:10: fatal error: sys/ustat.h: No such file or directory\n[gcc-7.2.0]  #include <sys/ustat.h>\n[gcc-7.2.0]           ^~~~~~~~~~~~~\n[gcc-7.2.0] compilation terminated.\n[gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1\n```\n\nThe reason for building without isl is that sage now includes isl as an optional package, so we should build gcc without it for the sake of consistency (see discussion in #26735).\n\n\nRelated tickets: #26735, #27016.\n\nCC:  @slel\n\nKeywords: upgrade, gcc, gfortran, isl\n\nBranch/Commit: [efc63b8a5e5252c41c648815541bf6fca48f15c9](https://github.com/sagemath/sagetrac-mirror/commit/efc63b8a5e5252c41c648815541bf6fca48f15c9)\n\nReviewer: Volker Braun\n\nAuthor: Konrad K. Dabrowski\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26954\n\n",
    "closed_at": "2019-07-04T11:09:36Z",
    "created_at": "2018-12-25T14:04:40Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Upgrade to gcc 7.4.0 and build gcc and gfortran without isl",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26954",
    "user": "https://github.com/vbraun"
}
```
This ticket upgrades to gcc 7.4.0 and builds gcc and gfortran without isl.

**Tarball**: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz

The upgrade fixes the issue that gcc 7.2.0 does not build on newer systems that have glibc 2.28:

This issue looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835

```
[gcc-7.2.0] libtool: compile:  /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/xgcc -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/bin/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/lib/ -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/include -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/sys-include -DHAVE_CONFIG_H -I../../../src/libatomic/config/x86 -I../../../src/libatomic/config/posix -I../../../src/libatomic -I. -Wall -Werror -pthread -g -O2 -MT cas_16_1_.lo -MD -MP -MF .deps/cas_16_1_.lo.Ppo -DN=16 -DIFUNC_ALT=1 -mcx16 -c ../../../src/libatomic/cas_n.c -o cas_16_1_.o >/dev/null 2>&1
[gcc-7.2.0] ../../../../src/libsanitizer/sanitizer_common/sanitizer_platform_limits_posix.cc:157:10: fatal error: sys/ustat.h: No such file or directory
[gcc-7.2.0]  #include <sys/ustat.h>
[gcc-7.2.0]           ^~~~~~~~~~~~~
[gcc-7.2.0] compilation terminated.
[gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1
```

The reason for building without isl is that sage now includes isl as an optional package, so we should build gcc without it for the sake of consistency (see discussion in #26735).


Related tickets: #26735, #27016.

CC:  @slel

Keywords: upgrade, gcc, gfortran, isl

Branch/Commit: [efc63b8a5e5252c41c648815541bf6fca48f15c9](https://github.com/sagemath/sagetrac-mirror/commit/efc63b8a5e5252c41c648815541bf6fca48f15c9)

Reviewer: Volker Braun

Author: Konrad K. Dabrowski

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26954





---

archive/issue_comments_519852.json:
```json
{
    "body": "Changing branch from \"\" to \"u/Konrad127123/the_gcc_package_doesn_t_build_with_new_gcc\"",
    "created_at": "2018-12-30T22:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519852",
    "user": "https://github.com/Konrad127123"
}
```

Changing branch from "" to "u/Konrad127123/the_gcc_package_doesn_t_build_with_new_gcc"



---

archive/issue_comments_519853.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-30T22:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519853",
    "user": "https://github.com/Konrad127123"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_519854.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe attached commits upgrade `gcc` to 7.4, which should fix this and make that the fix for #26735 redundant.\n\nI've also disabled building `gcc` with `isl`, since that is now an optional package in sage (see also discussion in #26735). If `isl` ever becomes a standard package, `gcc` should be made to depend on it, the `--disable-isl` line can be removed and the hacks for `gmp` and friends when building `gcc` should also be added for `isl`.\n\nI have not tested this set of changes yet.\n\n---\nNew commits:\n|                                                                                                                                          |                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------|\n|[6f07d2f](https://github.com/sagemath/sagetrac-mirror/commit/6f07d2f6189611aac9646292029e48a940dedac1)|`Update gcc to 7.4`|\n|[62d8e3b](https://github.com/sagemath/sagetrac-mirror/commit/62d8e3bedb5bf141c0ef2937a9e47db9cc0c4327)|`isl patch is in gcc 7.4`|\n|[299a61a](https://github.com/sagemath/sagetrac-mirror/commit/299a61a467c05ab4da70bb11fb85684f042d774a)|`Disable isl when building gcc to avoid inconsistently building gcc with sage's optional isl package. See also #26735.`|",
    "created_at": "2018-12-30T22:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519854",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:2'></a>
The attached commits upgrade `gcc` to 7.4, which should fix this and make that the fix for #26735 redundant.

I've also disabled building `gcc` with `isl`, since that is now an optional package in sage (see also discussion in #26735). If `isl` ever becomes a standard package, `gcc` should be made to depend on it, the `--disable-isl` line can be removed and the hacks for `gmp` and friends when building `gcc` should also be added for `isl`.

I have not tested this set of changes yet.

---
New commits:
|                                                                                                                                          |                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
|[6f07d2f](https://github.com/sagemath/sagetrac-mirror/commit/6f07d2f6189611aac9646292029e48a940dedac1)|`Update gcc to 7.4`|
|[62d8e3b](https://github.com/sagemath/sagetrac-mirror/commit/62d8e3bedb5bf141c0ef2937a9e47db9cc0c4327)|`isl patch is in gcc 7.4`|
|[299a61a](https://github.com/sagemath/sagetrac-mirror/commit/299a61a467c05ab4da70bb11fb85684f042d774a)|`Disable isl when building gcc to avoid inconsistently building gcc with sage's optional isl package. See also #26735.`|



---

archive/issue_comments_519855.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,3 +8,7 @@\n [gcc-7.2.0] compilation terminated.\n [gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1\n ```\n+\n+\n+---\n+New upstream: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz\n``````\n",
    "created_at": "2018-12-30T22:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519855",
    "user": "https://github.com/Konrad127123"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,3 +8,7 @@
 [gcc-7.2.0] compilation terminated.
 [gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1
 ```
+
+
+---
+New upstream: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz
``````




---

archive/issue_comments_519856.json:
```json
{
    "body": "Changing commit from \"\" to \"299a61a467c05ab4da70bb11fb85684f042d774a\"",
    "created_at": "2018-12-30T22:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519856",
    "user": "https://github.com/Konrad127123"
}
```

Changing commit from "" to "299a61a467c05ab4da70bb11fb85684f042d774a"



---

archive/issue_comments_519857.json:
```json
{
    "body": "Changing author from \"\" to \"Konrad K. Dabrowski\"",
    "created_at": "2018-12-30T22:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519857",
    "user": "https://github.com/Konrad127123"
}
```

Changing author from "" to "Konrad K. Dabrowski"



---

archive/issue_comments_519858.json:
```json
{
    "body": "<a id='comment:3'></a>\nUpdate: with the attached changes, `gcc` now builds again on my computer (and #26735 does not come back).\n\n\n(Later in the build process (but only if I build `gcc`), I get the following error when trying to build `givaro`:\n\n```\n-----------------------------------------------\nchecking gmp.h usability... yes\nchecking gmp.h presence... yes\nchecking for gmp.h... yes\nchecking for GMP library... yes\nchecking gmpxx.h usability... no\nchecking gmpxx.h presence... yes\nconfigure: WARNING: gmpxx.h: present but cannot be compiled\nconfigure: WARNING: gmpxx.h:     check for missing prerequisite headers?\nconfigure: WARNING: gmpxx.h: see the Autoconf documentation\nconfigure: WARNING: gmpxx.h:     section \"Present But Cannot Be Compiled\"\nconfigure: WARNING: gmpxx.h: proceeding with the compiler's result\nconfigure: WARNING:     ## --------------------------------------------------- ##\nconfigure: WARNING:     ## Report this to http://github.com/linbox-team/givaro ##\nconfigure: WARNING:     ## --------------------------------------------------- ##\nchecking for gmpxx.h... no\nyour GMP does not have c++ support. Compile GMP with --enable-cxx\n********************************************************************************\n```\nMy suspicion is that this failure is unrelated, and should be a separate issue.)",
    "created_at": "2019-01-01T23:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519858",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:3'></a>
Update: with the attached changes, `gcc` now builds again on my computer (and #26735 does not come back).


(Later in the build process (but only if I build `gcc`), I get the following error when trying to build `givaro`:

```
-----------------------------------------------
checking gmp.h usability... yes
checking gmp.h presence... yes
checking for gmp.h... yes
checking for GMP library... yes
checking gmpxx.h usability... no
checking gmpxx.h presence... yes
configure: WARNING: gmpxx.h: present but cannot be compiled
configure: WARNING: gmpxx.h:     check for missing prerequisite headers?
configure: WARNING: gmpxx.h: see the Autoconf documentation
configure: WARNING: gmpxx.h:     section "Present But Cannot Be Compiled"
configure: WARNING: gmpxx.h: proceeding with the compiler's result
configure: WARNING:     ## --------------------------------------------------- ##
configure: WARNING:     ## Report this to http://github.com/linbox-team/givaro ##
configure: WARNING:     ## --------------------------------------------------- ##
checking for gmpxx.h... no
your GMP does not have c++ support. Compile GMP with --enable-cxx
********************************************************************************
```
My suspicion is that this failure is unrelated, and should be a separate issue.)



---

archive/issue_comments_519859.json:
```json
{
    "body": "<a id='comment:4'></a>\nUpdate: I tried bulding sage again with the attached patch. It worked, and all tests passed with `make testlong`. The `givaro` issue above was most likely a case of running out of diskspace.",
    "created_at": "2019-01-04T21:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519859",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:4'></a>
Update: I tried bulding sage again with the attached patch. It worked, and all tests passed with `make testlong`. The `givaro` issue above was most likely a case of running out of diskspace.



---

archive/issue_events_075818.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75818"
}
```



---

archive/issue_comments_519860.json:
```json
{
    "body": "<a id='comment:5'></a>\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519860",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_519861.json:
```json
{
    "body": "<a id='comment:6'></a>\n> Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.\n\nThis patch is ready to go. It just needs someone to review it :).",
    "created_at": "2019-01-23T19:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519861",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:6'></a>
> Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.

This patch is ready to go. It just needs someone to review it :).



---

archive/issue_comments_519862.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt looks like #27016 will likely conflict with this. Perhaps I could combine the two (especially if my ticket is reviewed)?",
    "created_at": "2019-01-23T22:30:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519862",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
It looks like #27016 will likely conflict with this. Perhaps I could combine the two (especially if my ticket is reviewed)?



---

archive/issue_comments_519863.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [embray](#comment%3A7):\n> It looks like #27016 will likely conflict with this. Perhaps I could combine the two (especially if my ticket is reviewed)? \n\nI don't have enough knowledge of the build system to feel comfortable reviewing #27016. I have no objection to you combining the two: cherry-pick 6f07d2f and 62d8e3b, then add --without-isl to the configure options for both gcc and gfortran (I just noticed gfortran is built from the same source as gcc, so it should also get the --without-isl option for the same reason; my patch currently omits this.)",
    "created_at": "2019-01-23T23:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519863",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:8'></a>
Replying to [embray](#comment%3A7):
> It looks like #27016 will likely conflict with this. Perhaps I could combine the two (especially if my ticket is reviewed)? 

I don't have enough knowledge of the build system to feel comfortable reviewing #27016. I have no objection to you combining the two: cherry-pick 6f07d2f and 62d8e3b, then add --without-isl to the configure options for both gcc and gfortran (I just noticed gfortran is built from the same source as gcc, so it should also get the --without-isl option for the same reason; my patch currently omits this.)



---

archive/issue_comments_519864.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-23T23:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519864",
    "user": "https://github.com/Konrad127123"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_519865.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|\n|[2436a0e](https://github.com/sagemath/sagetrac-mirror/commit/2436a0e87776da0e881b1a5edebad26dfa9aef26)|`Disable isl when building gfortran to avoid inconsistently building gfortran with sage's optional isl package.`|",
    "created_at": "2019-01-28T13:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
|[2436a0e](https://github.com/sagemath/sagetrac-mirror/commit/2436a0e87776da0e881b1a5edebad26dfa9aef26)|`Disable isl when building gfortran to avoid inconsistently building gfortran with sage's optional isl package.`|



---

archive/issue_comments_519866.json:
```json
{
    "body": "Changing commit from \"299a61a467c05ab4da70bb11fb85684f042d774a\" to \"2436a0e87776da0e881b1a5edebad26dfa9aef26\"",
    "created_at": "2019-01-28T13:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "299a61a467c05ab4da70bb11fb85684f042d774a" to "2436a0e87776da0e881b1a5edebad26dfa9aef26"



---

archive/issue_comments_519867.json:
```json
{
    "body": "<a id='comment:10'></a>\nI've now also added --without-isl to the configure script for gfortran. I've not tested the gfortran part. I've not merged with #27016.",
    "created_at": "2019-01-28T14:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519867",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:10'></a>
I've now also added --without-isl to the configure script for gfortran. I've not tested the gfortran part. I've not merged with #27016.



---

archive/issue_comments_519868.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-28T14:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519868",
    "user": "https://github.com/Konrad127123"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_519869.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, gcc, gfortran, isl\".",
    "created_at": "2019-01-30T12:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519869",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "upgrade, gcc, gfortran, isl".



---

archive/issue_events_075819.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "rename": {
        "from": "The gcc package doesn't build with new gcc",
        "to": "Upgrade to gcc 7.4.0 and build gcc and gfortran without isl"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75819"
}
```



---

archive/issue_comments_519870.json:
```json
{
    "body": "<a id='comment:11'></a>\nChanging the ticket summary from \"The gcc package doesn't build with new gcc\"\nto \"Upgrade to gcc 7.4.0 and build gcc and gfortran without isl\".",
    "created_at": "2019-01-30T12:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519870",
    "user": "https://github.com/slel"
}
```

<a id='comment:11'></a>
Changing the ticket summary from "The gcc package doesn't build with new gcc"
to "Upgrade to gcc 7.4.0 and build gcc and gfortran without isl".



---

archive/issue_comments_519871.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n-Looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835\n+This ticket upgrades to gcc 7.4.0 and builds gcc and gfortran without isl.\n+\n+**Tarball**: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz\n+\n+This fixes the issue that gcc 7.2.0 does not build with isl >= 0.20.\n+\n+This issue looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835\n \n ```\n [gcc-7.2.0] libtool: compile:  /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/xgcc -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/bin/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/lib/ -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/include -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/sys-include -DHAVE_CONFIG_H -I../../../src/libatomic/config/x86 -I../../../src/libatomic/config/posix -I../../../src/libatomic -I. -Wall -Werror -pthread -g -O2 -MT cas_16_1_.lo -MD -MP -MF .deps/cas_16_1_.lo.Ppo -DN=16 -DIFUNC_ALT=1 -mcx16 -c ../../../src/libatomic/cas_n.c -o cas_16_1_.o >/dev/null 2>&1\n@@ -9,6 +15,4 @@\n [gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1\n ```\n \n-\n----\n-New upstream: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz\n+Related tickets: #26735, #27016.\n``````\n",
    "created_at": "2019-01-30T12:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519871",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
-Looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835
+This ticket upgrades to gcc 7.4.0 and builds gcc and gfortran without isl.
+
+**Tarball**: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz
+
+This fixes the issue that gcc 7.2.0 does not build with isl >= 0.20.
+
+This issue looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835
 
 ```
 [gcc-7.2.0] libtool: compile:  /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/xgcc -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/var/tmp/sage/build/gcc-7.2.0/gcc-build/./gcc/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/bin/ -B/mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/lib/ -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/include -isystem /mnt/disk/home/buildslave-sage/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeq/local/x86_64-pc-linux-gnu/sys-include -DHAVE_CONFIG_H -I../../../src/libatomic/config/x86 -I../../../src/libatomic/config/posix -I../../../src/libatomic -I. -Wall -Werror -pthread -g -O2 -MT cas_16_1_.lo -MD -MP -MF .deps/cas_16_1_.lo.Ppo -DN=16 -DIFUNC_ALT=1 -mcx16 -c ../../../src/libatomic/cas_n.c -o cas_16_1_.o >/dev/null 2>&1
@@ -9,6 +15,4 @@
 [gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1
 ```
 
-
----
-New upstream: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz
+Related tickets: #26735, #27016.
``````




---

archive/issue_comments_519872.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|\n|[83dfeb9](https://github.com/sagemath/sagetrac-mirror/commit/83dfeb9eef485e41a7d49c041f03eb9545ea3ba9)|`Update gcc to 7.4`|\n|[8154dda](https://github.com/sagemath/sagetrac-mirror/commit/8154ddac0c619de1dec417c7c10463dff912ed4c)|`isl patch is in gcc 7.4`|\n|[efc63b8](https://github.com/sagemath/sagetrac-mirror/commit/efc63b8a5e5252c41c648815541bf6fca48f15c9)|`Disable isl when building gcc to avoid inconsistently building gcc with sage's optional isl package. See also #26735.`|",
    "created_at": "2019-03-19T17:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
|[83dfeb9](https://github.com/sagemath/sagetrac-mirror/commit/83dfeb9eef485e41a7d49c041f03eb9545ea3ba9)|`Update gcc to 7.4`|
|[8154dda](https://github.com/sagemath/sagetrac-mirror/commit/8154ddac0c619de1dec417c7c10463dff912ed4c)|`isl patch is in gcc 7.4`|
|[efc63b8](https://github.com/sagemath/sagetrac-mirror/commit/efc63b8a5e5252c41c648815541bf6fca48f15c9)|`Disable isl when building gcc to avoid inconsistently building gcc with sage's optional isl package. See also #26735.`|



---

archive/issue_comments_519873.json:
```json
{
    "body": "Changing commit from \"2436a0e87776da0e881b1a5edebad26dfa9aef26\" to \"efc63b8a5e5252c41c648815541bf6fca48f15c9\"",
    "created_at": "2019-03-19T17:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2436a0e87776da0e881b1a5edebad26dfa9aef26" to "efc63b8a5e5252c41c648815541bf6fca48f15c9"



---

archive/issue_comments_519874.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n **Tarball**: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz\n \n-This fixes the issue that gcc 7.2.0 does not build with isl >= 0.20.\n+The upgrade fixes the issue that gcc 7.2.0 does not build on newer systems that have glibc 2.28:\n \n This issue looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835\n \n@@ -15,4 +15,7 @@\n [gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1\n ```\n \n+The reason for building without isl is that sage now includes isl as an optional package, so we should build gcc without it for the sake of consistency (see discussion in #26735).\n+\n+\n Related tickets: #26735, #27016.\n``````\n",
    "created_at": "2019-03-19T17:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519874",
    "user": "https://github.com/Konrad127123"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 **Tarball**: ftp://ftp.mirrorservice.org/sites/sourceware.org/pub/gcc/releases/gcc-7.4.0/gcc-7.4.0.tar.xz
 
-This fixes the issue that gcc 7.2.0 does not build with isl >= 0.20.
+The upgrade fixes the issue that gcc 7.2.0 does not build on newer systems that have glibc 2.28:
 
 This issue looks like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=85835
 
@@ -15,4 +15,7 @@
 [gcc-7.2.0] make[10]: *** [Makefile:523: sanitizer_platform_limits_posix.lo] Error 1
 ```
 
+The reason for building without isl is that sage now includes isl as an optional package, so we should build gcc without it for the sake of consistency (see discussion in #26735).
+
+
 Related tickets: #26735, #27016.
``````




---

archive/issue_comments_519875.json:
```json
{
    "body": "<a id='comment:14'></a>\nPatch now rebased on top of #27016.",
    "created_at": "2019-03-19T17:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519875",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:14'></a>
Patch now rebased on top of #27016.



---

archive/issue_comments_519876.json:
```json
{
    "body": "<a id='comment:15'></a>\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519876",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_075820.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75820"
}
```



---

archive/issue_events_075821.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75821"
}
```



---

archive/issue_comments_519877.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2019-07-02T17:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519877",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_519878.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-02T17:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519878",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_075822.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-03T06:53:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75822"
}
```



---

archive/issue_events_075823.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-03T06:53:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75823"
}
```



---

archive/issue_comments_519879.json:
```json
{
    "body": "Changing branch from \"u/Konrad127123/the_gcc_package_doesn_t_build_with_new_gcc\" to \"efc63b8a5e5252c41c648815541bf6fca48f15c9\"",
    "created_at": "2019-07-04T11:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519879",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/Konrad127123/the_gcc_package_doesn_t_build_with_new_gcc" to "efc63b8a5e5252c41c648815541bf6fca48f15c9"



---

archive/issue_events_075824.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-04T11:09:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26954#event-75824"
}
```



---

archive/issue_comments_519880.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-04T11:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26954#issuecomment-519880",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
