# Issue 26755: Error integrate with Fricas as algorithm fresnel_sin called

archive/issues_026518.json:
```json
{
    "body": "CC:  @slel\n\nKeywords: fricas, fresnel, integrate\n\nThis ticket tracks the problem reported at\n\n- [Ask Sage question 44369: Error integrate with Fricas as algorithm fresnel_sin called](https://ask.sagemath.org/question/44369)\n\nobserved in [SageMath](SageMath) 8.5.beta2:\n\n```\nsage: from sympy import fresnelc, fresnels\nsage: var('b x')\nsage: integrate(x^7*fresnels(b*x), x, algorithm=\"fricas\")\nTraceback (most recent call last)\n...\nTypeError: An error occurred when FriCAS evaluated '((x)^(7))*(fresnel_sin((b)*(x)))':\n   There are no library operations named fresnel_sin\n      Use HyperDoc Browse or issue\n                              )what op fresnel_sin\n      to learn if there is any operation containing \" fresnel_sin \" in its\n      name.\n\n   Cannot find a definition or applicable library operation named\n      fresnel_sin with argument type(s)\n                              Polynomial(Integer)\n\n      Perhaps you should use \"@\" to indicate the required return type, or \n      \"$\" to specify which version of the function you need.\n```\n\nFriCAS does not have `fresnel_sin` but has `fresnelS` and `fresnelC`:\n\n- http://fricas.github.io/api/FloatLiouvilianFunctions.html\n\nWhen running the same command inside Fricas 1.3.4 itself, it works OK\n\n```\nintegrate(x^7*fresnelS(b*x),x)   \n\n   (3)\n                                    2     2\n             5   2 5               b %pi x       8   4 8\n       (- 7 b %pi x  + 105 b x)sin(--------) + (b %pi x  - 105)fresnelS(b x)\n                                       2\n     + \n                                    2     2\n         7   3 7       3     3     b %pi x\n       (b %pi x  - 35 b %pi x )cos(--------)\n                                       2\n  /\n        8   4\n     8 b %pi\n```\n\nWhy the error says when FriCAS evaluated '((x)^(7))*(fresnel_sin((b)*(x)))'\nwhen Fricas itself does not have this function?\n\nNotice that there is no problem using default integrate algorithm in Sage:\n\n```\nsage: integrate(x^7*fresnels(b*x),x)\n1/8*x^8*fresnel_sin(b*x) - 1/16*sqrt(1/2)*((105*I + 105)*(1/4)^(1/4)*pi*erf(sqrt(1/2*I*pi)*b*x) - (105*I - 105)*(1/4)^(1/4)*pi*erf(sqrt(-1/2*I*pi)*b*x) - 4*(sqrt(1/2)*pi^4*b^7*x^7 - 35*sqrt(1/2)*pi^2*b^3*x^3)*cos(1/2*pi*b^2*x^2) + 28*(sqrt(1/2)*pi^3*b^5*x^5 - 15*sqrt(1/2)*pi*b*x)*sin(1/2*pi*b^2*x^2))/(pi^5*b^8)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26755\n\n",
    "closed_at": "2019-02-26T13:58:00Z",
    "created_at": "2018-11-24T07:17:55Z",
    "labels": [
        "component: symbolics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Error integrate with Fricas as algorithm fresnel_sin called",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26755",
    "user": "https://github.com/nasser1"
}
```
CC:  @slel

Keywords: fricas, fresnel, integrate

This ticket tracks the problem reported at

- [Ask Sage question 44369: Error integrate with Fricas as algorithm fresnel_sin called](https://ask.sagemath.org/question/44369)

observed in [SageMath](SageMath) 8.5.beta2:

```
sage: from sympy import fresnelc, fresnels
sage: var('b x')
sage: integrate(x^7*fresnels(b*x), x, algorithm="fricas")
Traceback (most recent call last)
...
TypeError: An error occurred when FriCAS evaluated '((x)^(7))*(fresnel_sin((b)*(x)))':
   There are no library operations named fresnel_sin
      Use HyperDoc Browse or issue
                              )what op fresnel_sin
      to learn if there is any operation containing " fresnel_sin " in its
      name.

   Cannot find a definition or applicable library operation named
      fresnel_sin with argument type(s)
                              Polynomial(Integer)

      Perhaps you should use "@" to indicate the required return type, or 
      "$" to specify which version of the function you need.
```

FriCAS does not have `fresnel_sin` but has `fresnelS` and `fresnelC`:

- http://fricas.github.io/api/FloatLiouvilianFunctions.html

When running the same command inside Fricas 1.3.4 itself, it works OK

```
integrate(x^7*fresnelS(b*x),x)   

   (3)
                                    2     2
             5   2 5               b %pi x       8   4 8
       (- 7 b %pi x  + 105 b x)sin(--------) + (b %pi x  - 105)fresnelS(b x)
                                       2
     + 
                                    2     2
         7   3 7       3     3     b %pi x
       (b %pi x  - 35 b %pi x )cos(--------)
                                       2
  /
        8   4
     8 b %pi
```

Why the error says when FriCAS evaluated '((x)^(7))*(fresnel_sin((b)*(x)))'
when Fricas itself does not have this function?

Notice that there is no problem using default integrate algorithm in Sage:

```
sage: integrate(x^7*fresnels(b*x),x)
1/8*x^8*fresnel_sin(b*x) - 1/16*sqrt(1/2)*((105*I + 105)*(1/4)^(1/4)*pi*erf(sqrt(1/2*I*pi)*b*x) - (105*I - 105)*(1/4)^(1/4)*pi*erf(sqrt(-1/2*I*pi)*b*x) - 4*(sqrt(1/2)*pi^4*b^7*x^7 - 35*sqrt(1/2)*pi^2*b^3*x^3)*cos(1/2*pi*b^2*x^2) + 28*(sqrt(1/2)*pi^3*b^5*x^5 - 15*sqrt(1/2)*pi*b*x)*sin(1/2*pi*b^2*x^2))/(pi^5*b^8)
```


Issue created by migration from https://trac.sagemath.org/ticket/26755





---

archive/issue_comments_372481.json:
```json
{
    "body": "I think that this was just fixed in #26746:\n\n```\nsage: from sympy import fresnelc, fresnels\nsage: var('a b c d e m n x ')\nsage: integrate(x^7*fresnels(b*x),x,algorithm=\"fricas\")\n1/8*((pi^3*b^7*x^7 - 35*pi*b^3*x^3)*cos(1/2*pi*b^2*x^2) + (pi^4*b^8*x^8 - 105)*fresnel_sin(b*x) - 7*(pi^2*b^5*x^5 - 15*b*x)*sin(1/2*pi*b^2*x^2))/(pi^4*b^8)\n```",
    "created_at": "2018-11-24T07:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372481",
    "user": "https://github.com/mantepse"
}
```

I think that this was just fixed in #26746:

```
sage: from sympy import fresnelc, fresnels
sage: var('a b c d e m n x ')
sage: integrate(x^7*fresnels(b*x),x,algorithm="fricas")
1/8*((pi^3*b^7*x^7 - 35*pi*b^3*x^3)*cos(1/2*pi*b^2*x^2) + (pi^4*b^8*x^8 - 105)*fresnel_sin(b*x) - 7*(pi^2*b^5*x^5 - 15*b*x)*sin(1/2*pi*b^2*x^2))/(pi^4*b^8)
```



---

archive/issue_comments_372482.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-24T07:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372482",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_events_066231.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-11-24T07:38:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26755#event-66231"
}
```



---

archive/issue_comments_372483.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-24T08:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372483",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_372484.json:
```json
{
    "body": "Thanks. This is confirmed fixed in \n\n \n```\nSageMath version 8.5.beta5, Release Date: 2018-11-25   \n```\n \n\n```\nsage: from sympy import fresnelc, fresnels\nsage: var('a b c d e m n x ')\nsage: integrate(x^7*fresnels(b*x),x,algorithm=\"fricas\")\n\n1/8*((pi^3*b^7*x^7 - 35*pi*b^3*x^3)*cos(1/2*pi*b^2*x^2) + (pi^4*b^8*x^8 - 105)*fresnel_sin(b*x) - 7*(pi^2*b^5*x^5 - 15*b*x)*sin(1/2*pi*b^2*x^2))/(pi^4*b^8)\nsage: \n\n\n```",
    "created_at": "2018-11-28T08:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372484",
    "user": "https://github.com/nasser1"
}
```

Thanks. This is confirmed fixed in 

 
```
SageMath version 8.5.beta5, Release Date: 2018-11-25   
```
 

```
sage: from sympy import fresnelc, fresnels
sage: var('a b c d e m n x ')
sage: integrate(x^7*fresnels(b*x),x,algorithm="fricas")

1/8*((pi^3*b^7*x^7 - 35*pi*b^3*x^3)*cos(1/2*pi*b^2*x^2) + (pi^4*b^8*x^8 - 105)*fresnel_sin(b*x) - 7*(pi^2*b^5*x^5 - 15*b*x)*sin(1/2*pi*b^2*x^2))/(pi^4*b^8)
sage: 


```



---

archive/issue_comments_372485.json:
```json
{
    "body": "Changing keywords from \"fricas fresnel\" to \"fricas, fresnel, integrate\".",
    "created_at": "2019-02-15T04:17:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372485",
    "user": "https://github.com/slel"
}
```

Changing keywords from "fricas fresnel" to "fricas, fresnel, integrate".



---

archive/issue_comments_372486.json:
```json
{
    "body": "Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372486",
    "user": "https://github.com/embray"
}
```

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_events_066232.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-26T13:58:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26755#event-66232"
}
```



---

archive/issue_comments_372487.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26755",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26755#issuecomment-372487",
    "user": "https://github.com/embray"
}
```

Resolution: invalid
