# Issue 26592: py3: combinat/designs: bytes-like object is required, not 'str'

archive/issues_026355.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\n\n```\nsage: print(version())\nSageMath version 8.5.beta1, Release Date: 2018-10-27\nsage: print(sys.version)\n3.6.6 (default, Oct 27 2018, 01:34:38)\n[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]\nsage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-a3d9f9e592f1> in <module>()\n----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))\n\n/opt/s/sage/local/lib/python3.6/site-packages/sage/combinat/designs/covering_design.py in best_known_covering_design_www(v, k, t, verbose)\n    505     f.close()\n    506\n--> 507     if 'covering not in database' in s:   #not found\n    508         str = \"no (%d,%d,%d) covering design in database\\n\"%(v,k,t)\n    509         raise ValueError(str)\n\nTypeError: a bytes-like object is required, not 'str'\n```\n\nCC:  @sagetrac-dgordon @seblabbe @slel @vinklein @zerline\n\nComponent: **python3**\n\nKeywords: **thursdaysbdx**\n\nAuthor: **Samuel Leli\u00e8vre**\n\nBranch: **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26592_\n\n",
    "closed_at": "2019-05-06T11:56:44Z",
    "created_at": "2018-10-29T15:43:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: combinat/designs: bytes-like object is required, not 'str'",
    "type": "issue",
    "updated_at": "2019-05-13T14:10:05Z",
    "url": "https://github.com/sagemath/sage/issues/26592",
    "user": "https://github.com/seblabbe"
}
```
<div id="comment:0"></div>


```
sage: print(version())
SageMath version 8.5.beta1, Release Date: 2018-10-27
sage: print(sys.version)
3.6.6 (default, Oct 27 2018, 01:34:38)
[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]
sage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-a3d9f9e592f1> in <module>()
----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))

/opt/s/sage/local/lib/python3.6/site-packages/sage/combinat/designs/covering_design.py in best_known_covering_design_www(v, k, t, verbose)
    505     f.close()
    506
--> 507     if 'covering not in database' in s:   #not found
    508         str = "no (%d,%d,%d) covering design in database\n"%(v,k,t)
    509         raise ValueError(str)

TypeError: a bytes-like object is required, not 'str'
```

CC:  @sagetrac-dgordon @seblabbe @slel @vinklein @zerline

Component: **python3**

Keywords: **thursdaysbdx**

Author: **Samuel Lelièvre**

Branch: **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)**

Reviewer: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/26592_





---

archive/issue_events_362998.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-10-29T15:43:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-362998"
}
```



---

archive/issue_events_362999.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-10-29T15:43:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-362999"
}
```



---

archive/issue_events_363000.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-10-29T15:43:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363000"
}
```



---

archive/issue_events_363001.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-10-29T15:43:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363001"
}
```



---

archive/issue_comments_409771.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe whole https://math.ccrwest.org was down for a few days. It's back up now.",
    "created_at": "2018-10-31T15:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409771",
    "user": "https://github.com/slel"
}
```

<div id="comment:1" align="right">comment:1</div>

The whole https://math.ccrwest.org was down for a few days. It's back up now.



---

archive/issue_comments_409772.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis needs some Python 3 love now though.\n\nHere's what I get with a Python3-based Sage:\n\n```\nsage: print(version())\nSageMath version 8.5.beta1, Release Date: 2018-10-27\nsage: print(sys.version)\n3.6.6 (default, Oct 27 2018, 01:34:38)\n[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]\nsage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-a3d9f9e592f1> in <module>()\n----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))\n\n/opt/s/sage/local/lib/python3.6/site-packages/sage/combinat/designs/covering_design.py in best_known_covering_design_www(v, k, t, verbose)\n    505     f.close()\n    506\n--> 507     if 'covering not in database' in s:   #not found\n    508         str = \"no (%d,%d,%d) covering design in database\\n\"%(v,k,t)\n    509         raise ValueError(str)\n\nTypeError: a bytes-like object is required, not 'str'\n```",
    "created_at": "2018-10-31T15:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409772",
    "user": "https://github.com/slel"
}
```

<div id="comment:2" align="right">comment:2</div>

This needs some Python 3 love now though.

Here's what I get with a Python3-based Sage:

```
sage: print(version())
SageMath version 8.5.beta1, Release Date: 2018-10-27
sage: print(sys.version)
3.6.6 (default, Oct 27 2018, 01:34:38)
[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]
sage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-a3d9f9e592f1> in <module>()
----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))

/opt/s/sage/local/lib/python3.6/site-packages/sage/combinat/designs/covering_design.py in best_known_covering_design_www(v, k, t, verbose)
    505     f.close()
    506
--> 507     if 'covering not in database' in s:   #not found
    508         str = "no (%d,%d,%d) covering design in database\n"%(v,k,t)
    509         raise ValueError(str)

TypeError: a bytes-like object is required, not 'str'
```



---

archive/issue_comments_409773.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFeel free to repurpose the present ticket for that.",
    "created_at": "2018-10-31T15:08:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409773",
    "user": "https://github.com/slel"
}
```

<div id="comment:3" align="right">comment:3</div>

Feel free to repurpose the present ticket for that.



---

archive/issue_events_363002.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-11-20T08:17:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363002"
}
```



---

archive/issue_events_363003.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-11-20T08:17:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363003"
}
```



---

archive/issue_events_363004.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-11-20T08:17:02Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "title_is": "py3: combinat/designs: bytes-like object is required, not 'str'",
    "title_was": "internet doctest failing in combinat/designs [SSL: UNKNOWN_PROTOCOL]",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363004"
}
```



---

archive/issue_comments_409774.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,121 +1,22 @@\n-With 8.5.beta1, the command\n \n ```\n-sage -t --long --optional=sage,internet src/sage/combinat/designs/design_catalog.py src/sage/combinat/designs/covering_design.py\n+sage: print(version())\n+SageMath version 8.5.beta1, Release Date: 2018-10-27\n+sage: print(sys.version)\n+3.6.6 (default, Oct 27 2018, 01:34:38)\n+[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]\n+sage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)\n+---------------------------------------------------------------------------\n+TypeError                                 Traceback (most recent call last)\n+<ipython-input-1-a3d9f9e592f1> in <module>()\n+----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))\n+\n+/opt/s/sage/local/lib/python3.6/site-packages/sage/combinat/designs/covering_design.py in best_known_covering_design_www(v, k, t, verbose)\n+    505     f.close()\n+    506\n+--> 507     if 'covering not in database' in s:   #not found\n+    508         str = \"no (%d,%d,%d) covering design in database\\n\"%(v,k,t)\n+    509         raise ValueError(str)\n+\n+TypeError: a bytes-like object is required, not 'str'\n ```\n-\n-gives:\n-\n-```\n-Doctesting 2 files.\n-sage -t --long src/sage/combinat/designs/design_catalog.py\n-**********************************************************************\n-File \"src/sage/combinat/designs/design_catalog.py\", line 22, in sage.combinat.designs.design_catalog\n-Failed example:\n-    C = designs.best_known_covering_design_from_LJCR(7, 3, 2)   # optional - internet\n-Exception raised:\n-    Traceback (most recent call last):\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n-        self.compile_and_execute(example, compiler, test.globs)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n-        exec(compiled, globs)\n-      File \"<doctest sage.combinat.designs.design_catalog[1]>\", line 1, in <module>\n-        C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))   # optional - internet\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/combinat/designs/covering_design.py\", line 503, in best_known_covering_design_www\n-        f = urlopen(url)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 154, in urlopen\n-        return opener.open(url, data, timeout)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 429, in open\n-        response = self._open(req, data)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 447, in _open\n-        '_open', req)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 407, in _call_chain\n-        result = func(*args)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 1241, in https_open\n-        context=self._context)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 1198, in do_open\n-        raise URLError(err)\n-    URLError: <urlopen error [SSL: UNKNOWN_PROTOCOL] unknown protocol (_ssl.c:726)>\n-**********************************************************************\n-File \"src/sage/combinat/designs/design_catalog.py\", line 23, in sage.combinat.designs.design_catalog\n-Failed example:\n-    C                            # optional - internet\n-Exception raised:\n-    Traceback (most recent call last):\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n-        self.compile_and_execute(example, compiler, test.globs)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n-        exec(compiled, globs)\n-      File \"<doctest sage.combinat.designs.design_catalog[2]>\", line 1, in <module>\n-        C                            # optional - internet\n-    NameError: name 'C' is not defined\n-**********************************************************************\n-File \"src/sage/combinat/designs/design_catalog.py\", line 28, in sage.combinat.designs.design_catalog\n-Failed example:\n-    C.incidence_structure()      # optional - internet\n-Exception raised:\n-    Traceback (most recent call last):\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n-        self.compile_and_execute(example, compiler, test.globs)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n-        exec(compiled, globs)\n-      File \"<doctest sage.combinat.designs.design_catalog[3]>\", line 1, in <module>\n-        C.incidence_structure()      # optional - internet\n-    NameError: name 'C' is not defined\n-**********************************************************************\n-1 item had failures:\n-   3 of   5 in sage.combinat.designs.design_catalog\n-    [4 tests, 3 failures, 0.34 s]\n-sage -t --long src/sage/combinat/designs/covering_design.py\n-**********************************************************************\n-File \"src/sage/combinat/designs/covering_design.py\", line 473, in sage.combinat.designs.covering_design.best_known_covering_design_www\n-Failed example:\n-    C = best_known_covering_design_www(7, 3, 2)   # optional - internet\n-Exception raised:\n-    Traceback (most recent call last):\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n-        self.compile_and_execute(example, compiler, test.globs)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n-        exec(compiled, globs)\n-      File \"<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[1]>\", line 1, in <module>\n-        C = best_known_covering_design_www(Integer(7), Integer(3), Integer(2))   # optional - internet\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/combinat/designs/covering_design.py\", line 503, in best_known_covering_design_www\n-        f = urlopen(url)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 154, in urlopen\n-        return opener.open(url, data, timeout)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 429, in open\n-        response = self._open(req, data)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 447, in _open\n-        '_open', req)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 407, in _call_chain\n-        result = func(*args)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 1241, in https_open\n-        context=self._context)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py\", line 1198, in do_open\n-        raise URLError(err)\n-    URLError: <urlopen error [SSL: UNKNOWN_PROTOCOL] unknown protocol (_ssl.c:726)>\n-**********************************************************************\n-File \"src/sage/combinat/designs/covering_design.py\", line 474, in sage.combinat.designs.covering_design.best_known_covering_design_www\n-Failed example:\n-    print(C)                                     # optional - internet\n-Exception raised:\n-    Traceback (most recent call last):\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n-        self.compile_and_execute(example, compiler, test.globs)\n-      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n-        exec(compiled, globs)\n-      File \"<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[2]>\", line 1, in <module>\n-        print(C)                                     # optional - internet\n-    NameError: name 'C' is not defined\n-**********************************************************************\n-1 item had failures:\n-   2 of   4 in sage.combinat.designs.covering_design.best_known_covering_design_www\n-    [49 tests, 2 failures, 0.37 s]\n-----------------------------------------------------------------------\n-sage -t --long src/sage/combinat/designs/design_catalog.py  # 3 doctests failed\n-sage -t --long src/sage/combinat/designs/covering_design.py  # 2 doctests failed\n-----------------------------------------------------------------------\n-Total time for all tests: 1.0 seconds\n-    cpu time: 0.0 seconds\n-    cumulative wall time: 0.7 seconds\n-```\n``````\n",
    "created_at": "2018-11-20T08:17:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409774",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,121 +1,22 @@
-With 8.5.beta1, the command
 
 ```
-sage -t --long --optional=sage,internet src/sage/combinat/designs/design_catalog.py src/sage/combinat/designs/covering_design.py
+sage: print(version())
+SageMath version 8.5.beta1, Release Date: 2018-10-27
+sage: print(sys.version)
+3.6.6 (default, Oct 27 2018, 01:34:38)
+[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]
+sage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
+<ipython-input-1-a3d9f9e592f1> in <module>()
+----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))
+
+/opt/s/sage/local/lib/python3.6/site-packages/sage/combinat/designs/covering_design.py in best_known_covering_design_www(v, k, t, verbose)
+    505     f.close()
+    506
+--> 507     if 'covering not in database' in s:   #not found
+    508         str = "no (%d,%d,%d) covering design in database\n"%(v,k,t)
+    509         raise ValueError(str)
+
+TypeError: a bytes-like object is required, not 'str'
 ```
-
-gives:
-
-```
-Doctesting 2 files.
-sage -t --long src/sage/combinat/designs/design_catalog.py
-**********************************************************************
-File "src/sage/combinat/designs/design_catalog.py", line 22, in sage.combinat.designs.design_catalog
-Failed example:
-    C = designs.best_known_covering_design_from_LJCR(7, 3, 2)   # optional - internet
-Exception raised:
-    Traceback (most recent call last):
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
-        self.compile_and_execute(example, compiler, test.globs)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
-        exec(compiled, globs)
-      File "<doctest sage.combinat.designs.design_catalog[1]>", line 1, in <module>
-        C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))   # optional - internet
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/combinat/designs/covering_design.py", line 503, in best_known_covering_design_www
-        f = urlopen(url)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 154, in urlopen
-        return opener.open(url, data, timeout)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 429, in open
-        response = self._open(req, data)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 447, in _open
-        '_open', req)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 407, in _call_chain
-        result = func(*args)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 1241, in https_open
-        context=self._context)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 1198, in do_open
-        raise URLError(err)
-    URLError: <urlopen error [SSL: UNKNOWN_PROTOCOL] unknown protocol (_ssl.c:726)>
-**********************************************************************
-File "src/sage/combinat/designs/design_catalog.py", line 23, in sage.combinat.designs.design_catalog
-Failed example:
-    C                            # optional - internet
-Exception raised:
-    Traceback (most recent call last):
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
-        self.compile_and_execute(example, compiler, test.globs)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
-        exec(compiled, globs)
-      File "<doctest sage.combinat.designs.design_catalog[2]>", line 1, in <module>
-        C                            # optional - internet
-    NameError: name 'C' is not defined
-**********************************************************************
-File "src/sage/combinat/designs/design_catalog.py", line 28, in sage.combinat.designs.design_catalog
-Failed example:
-    C.incidence_structure()      # optional - internet
-Exception raised:
-    Traceback (most recent call last):
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
-        self.compile_and_execute(example, compiler, test.globs)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
-        exec(compiled, globs)
-      File "<doctest sage.combinat.designs.design_catalog[3]>", line 1, in <module>
-        C.incidence_structure()      # optional - internet
-    NameError: name 'C' is not defined
-**********************************************************************
-1 item had failures:
-   3 of   5 in sage.combinat.designs.design_catalog
-    [4 tests, 3 failures, 0.34 s]
-sage -t --long src/sage/combinat/designs/covering_design.py
-**********************************************************************
-File "src/sage/combinat/designs/covering_design.py", line 473, in sage.combinat.designs.covering_design.best_known_covering_design_www
-Failed example:
-    C = best_known_covering_design_www(7, 3, 2)   # optional - internet
-Exception raised:
-    Traceback (most recent call last):
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
-        self.compile_and_execute(example, compiler, test.globs)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
-        exec(compiled, globs)
-      File "<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[1]>", line 1, in <module>
-        C = best_known_covering_design_www(Integer(7), Integer(3), Integer(2))   # optional - internet
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/combinat/designs/covering_design.py", line 503, in best_known_covering_design_www
-        f = urlopen(url)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 154, in urlopen
-        return opener.open(url, data, timeout)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 429, in open
-        response = self._open(req, data)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 447, in _open
-        '_open', req)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 407, in _call_chain
-        result = func(*args)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 1241, in https_open
-        context=self._context)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/urllib2.py", line 1198, in do_open
-        raise URLError(err)
-    URLError: <urlopen error [SSL: UNKNOWN_PROTOCOL] unknown protocol (_ssl.c:726)>
-**********************************************************************
-File "src/sage/combinat/designs/covering_design.py", line 474, in sage.combinat.designs.covering_design.best_known_covering_design_www
-Failed example:
-    print(C)                                     # optional - internet
-Exception raised:
-    Traceback (most recent call last):
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
-        self.compile_and_execute(example, compiler, test.globs)
-      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
-        exec(compiled, globs)
-      File "<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[2]>", line 1, in <module>
-        print(C)                                     # optional - internet
-    NameError: name 'C' is not defined
-**********************************************************************
-1 item had failures:
-   2 of   4 in sage.combinat.designs.covering_design.best_known_covering_design_www
-    [49 tests, 2 failures, 0.37 s]
-----------------------------------------------------------------------
-sage -t --long src/sage/combinat/designs/design_catalog.py  # 3 doctests failed
-sage -t --long src/sage/combinat/designs/covering_design.py  # 2 doctests failed
-----------------------------------------------------------------------
-Total time for all tests: 1.0 seconds
-    cpu time: 0.0 seconds
-    cumulative wall time: 0.7 seconds
-```
``````




---

archive/issue_comments_409775.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nOk, I updated the goal of this ticket as suggested.",
    "created_at": "2018-11-20T08:17:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409775",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:4" align="right">comment:4</div>

Ok, I updated the goal of this ticket as suggested.



---

archive/issue_events_363005.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:36:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363005"
}
```



---

archive/issue_events_363006.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:36:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363006"
}
```



---

archive/issue_comments_409776.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAs suggested in [#26502 comment:8](https://github.com/sagemath/sage/issues/26502#comment:8), the url address apparently changed to:\n\n\u200bhttp://dmgordon.org/cover/\n\nSo we need to redo the changes that were made in #26502 in order to fix this issue.",
    "created_at": "2019-03-07T08:33:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409776",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:6" align="right">comment:6</div>

As suggested in [#26502 comment:8](https://github.com/sagemath/sage/issues/26502#comment:8), the url address apparently changed to:

​http://dmgordon.org/cover/

So we need to redo the changes that were made in #26502 in order to fix this issue.



---

archive/issue_comments_409777.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe problem with dmgordon.org is that the server certificate chain is incomplete:\n\n```\nsage: from six.moves.urllib.request import urlopen\nsage: url = \"https://dmgordon.org/cover/\"\nsage: f = urlopen(url)\n---------------------------------------------------------------------------\nURLError                                  Traceback (most recent call last)\n<ipython-input-6-152a0d5393b6> in <module>()\n----> 1 f = urlopen(url)\n\n...\n\n/home/vklein/odk/sage/local/lib/python2.7/urllib2.pyc in do_open(self, http_class, req, **http_conn_args)\n   1196         except socket.error, err: # XXX what error?\n   1197             h.close()\n-> 1198             raise URLError(err)\n   1199         else:\n   1200             try:\n\nURLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:726)>\n```\n\nShould we find a way to ignore ssl verification or to contact dmgordon.org owner ?",
    "created_at": "2019-03-07T09:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409777",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:7" align="right">comment:7</div>

The problem with dmgordon.org is that the server certificate chain is incomplete:

```
sage: from six.moves.urllib.request import urlopen
sage: url = "https://dmgordon.org/cover/"
sage: f = urlopen(url)
---------------------------------------------------------------------------
URLError                                  Traceback (most recent call last)
<ipython-input-6-152a0d5393b6> in <module>()
----> 1 f = urlopen(url)

...

/home/vklein/odk/sage/local/lib/python2.7/urllib2.pyc in do_open(self, http_class, req, **http_conn_args)
   1196         except socket.error, err: # XXX what error?
   1197             h.close()
-> 1198             raise URLError(err)
   1199         else:
   1200             try:

URLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:726)>
```

Should we find a way to ignore ssl verification or to contact dmgordon.org owner ?



---

archive/issue_comments_409778.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI just emailed Dan Gordon to report the various issues we are trying to tackle here:\n\n- http vs https\n- `get_cover.php` seems gone from http://ljcr.dmgordon.org/cover/\n  (`show_cover.php` returns some html-formatted string)",
    "created_at": "2019-03-07T13:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409778",
    "user": "https://github.com/slel"
}
```

<div id="comment:8" align="right">comment:8</div>

I just emailed Dan Gordon to report the various issues we are trying to tackle here:

- http vs https
- `get_cover.php` seems gone from http://ljcr.dmgordon.org/cover/
  (`show_cover.php` returns some html-formatted string)



---

archive/issue_comments_409779.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThank you Samuel.\\\\\nFor the http vs https part, note that `urlopen(\"http://dmgordon.org/cover/get_cover.php\")` return the famous `HTTP Error 404: Not Found`.",
    "created_at": "2019-03-07T14:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409779",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:9" align="right">comment:9</div>

Thank you Samuel.\\
For the http vs https part, note that `urlopen("http://dmgordon.org/cover/get_cover.php")` return the famous `HTTP Error 404: Not Found`.



---

archive/issue_comments_409780.json:
```json
{
    "body": "Changed keywords from none to **thursdaysbdx**",
    "created_at": "2019-03-07T14:03:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409780",
    "user": "https://github.com/vinklein"
}
```

Changed keywords from none to **thursdaysbdx**



---

archive/issue_comments_409781.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nMy attempt so far is using:\n\n```diff\ndiff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py\nindex 87dda39064..23beebc2e8 100644\n--- a/src/sage/combinat/designs/covering_design.py\n+++ b/src/sage/combinat/designs/covering_design.py\n@@ -497,7 +497,7 @@ def best_known_covering_design_www(v, k, t, verbose=False):\n\n     param = (\"?v=%s&k=%s&t=%s\"%(v,k,t))\n\n-    url = \"https://math.ccrwest.org/cover/get_cover.php\"+param\n+    url = \"http://ljcr.dmgordon.org/cover/show_cover.php\" + param\n     if verbose:\n         print(\"Looking up the bounds at %s\" % url)\n     f = urlopen(url)\n```\n\nwhich returns html instead of plain text, but I guess we could easily de-html-ify it.",
    "created_at": "2019-03-07T14:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409781",
    "user": "https://github.com/slel"
}
```

<div id="comment:11" align="right">comment:11</div>

My attempt so far is using:

```diff
diff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py
index 87dda39064..23beebc2e8 100644
--- a/src/sage/combinat/designs/covering_design.py
+++ b/src/sage/combinat/designs/covering_design.py
@@ -497,7 +497,7 @@ def best_known_covering_design_www(v, k, t, verbose=False):

     param = ("?v=%s&k=%s&t=%s"%(v,k,t))

-    url = "https://math.ccrwest.org/cover/get_cover.php"+param
+    url = "http://ljcr.dmgordon.org/cover/show_cover.php" + param
     if verbose:
         print("Looking up the bounds at %s" % url)
     f = urlopen(url)
```

which returns html instead of plain text, but I guess we could easily de-html-ify it.



---

archive/issue_comments_409782.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIt's feasible but calling `get_cover.php` will be far cleaner.\\\\\nAnother concern for me is that without https, given that the current code call `sage_eval` on the result, this code look like an open door to inject any (sage) code you want on a sage user's computer.",
    "created_at": "2019-03-07T16:23:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409782",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:12" align="right">comment:12</div>

It's feasible but calling `get_cover.php` will be far cleaner.\\
Another concern for me is that without https, given that the current code call `sage_eval` on the result, this code look like an open door to inject any (sage) code you want on a sage user's computer.



---

archive/issue_comments_409783.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThe following changes should suffice once `get_cover.php`  is repaired.\n\n(I think it currently gives an extra initial  `\\n\\n<html>\\n<body>\\n` we don't expect.)\n\n```diff\ndiff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py\nindex 87dda39064..ef7512b704 100644\n--- a/src/sage/combinat/designs/covering_design.py\n+++ b/src/sage/combinat/designs/covering_design.py\n@@ -21,11 +21,11 @@ design from this database, we include extra information:\n REFERENCES:\n\n .. [1] La Jolla Covering Repository,\n-  https://math.ccrwest.org/cover.html\n+  http://ljcr.dmgordon.org/cover.html\n\n .. [2] Coverings,\n   Daniel Gordon and Douglas Stinson,\n-  https://math.ccrwest.org/gordon/hcd.pdf\n+  https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view\n   from the Handbook of Combinatorial Designs\n\n AUTHORS:\n@@ -452,8 +452,10 @@ class CoveringDesign(SageObject):\n\n def best_known_covering_design_www(v, k, t, verbose=False):\n     r\"\"\"\n-    Gives the best known `(v,k,t)` covering design, using the database\n-    available at `<https://math.ccrwest.org/cover.html>`_\n+    Return the best known `(v, k, t)` covering design from an online database.\n+\n+    This uses the La Jolla Covering Repository, a database\n+    available at `<http://ljcr.dmgordon.org/cover.html>`_\n\n     INPUT:\n@@ -488,7 +490,7 @@ def best_known_covering_design_www(v, k, t, verbose=False):\n     \"\"\"\n     # import compatible with py2 and py3\n     from six.moves.urllib.request import urlopen\n-\n+    from sage.cpython.string import bytes_to_str\n     from sage.misc.sage_eval import sage_eval\n\n     v = int(v)\n@@ -497,12 +499,11 @@ def best_known_covering_design_www(v, k, t, verbose=False):\n\n     param = (\"?v=%s&k=%s&t=%s\"%(v,k,t))\n\n-    url = \"https://math.ccrwest.org/cover/get_cover.php\"+param\n+    url = \"http://ljcr.dmgordon.org/cover/get_cover.php\" + param\n     if verbose:\n         print(\"Looking up the bounds at %s\" % url)\n-    f = urlopen(url)\n-    s = f.read()\n-    f.close()\n+    with urlopen(url) as f:\n+        s = bytes_to_str(f.read())\n\n     if 'covering not in database' in s:   #not found\n         str = \"no (%d,%d,%d) covering design in database\\n\"%(v,k,t)\n```\n\nI'll propose a branch if Dan Gordon confirms this about `get_cover.php`.",
    "created_at": "2019-03-08T07:35:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409783",
    "user": "https://github.com/slel"
}
```

<div id="comment:13" align="right">comment:13</div>

The following changes should suffice once `get_cover.php`  is repaired.

(I think it currently gives an extra initial  `\n\n<html>\n<body>\n` we don't expect.)

```diff
diff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py
index 87dda39064..ef7512b704 100644
--- a/src/sage/combinat/designs/covering_design.py
+++ b/src/sage/combinat/designs/covering_design.py
@@ -21,11 +21,11 @@ design from this database, we include extra information:
 REFERENCES:

 .. [1] La Jolla Covering Repository,
-  https://math.ccrwest.org/cover.html
+  http://ljcr.dmgordon.org/cover.html

 .. [2] Coverings,
   Daniel Gordon and Douglas Stinson,
-  https://math.ccrwest.org/gordon/hcd.pdf
+  https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view
   from the Handbook of Combinatorial Designs

 AUTHORS:
@@ -452,8 +452,10 @@ class CoveringDesign(SageObject):

 def best_known_covering_design_www(v, k, t, verbose=False):
     r"""
-    Gives the best known `(v,k,t)` covering design, using the database
-    available at `<https://math.ccrwest.org/cover.html>`_
+    Return the best known `(v, k, t)` covering design from an online database.
+
+    This uses the La Jolla Covering Repository, a database
+    available at `<http://ljcr.dmgordon.org/cover.html>`_

     INPUT:
@@ -488,7 +490,7 @@ def best_known_covering_design_www(v, k, t, verbose=False):
     """
     # import compatible with py2 and py3
     from six.moves.urllib.request import urlopen
-
+    from sage.cpython.string import bytes_to_str
     from sage.misc.sage_eval import sage_eval

     v = int(v)
@@ -497,12 +499,11 @@ def best_known_covering_design_www(v, k, t, verbose=False):

     param = ("?v=%s&k=%s&t=%s"%(v,k,t))

-    url = "https://math.ccrwest.org/cover/get_cover.php"+param
+    url = "http://ljcr.dmgordon.org/cover/get_cover.php" + param
     if verbose:
         print("Looking up the bounds at %s" % url)
-    f = urlopen(url)
-    s = f.read()
-    f.close()
+    with urlopen(url) as f:
+        s = bytes_to_str(f.read())

     if 'covering not in database' in s:   #not found
         str = "no (%d,%d,%d) covering design in database\n"%(v,k,t)
```

I'll propose a branch if Dan Gordon confirms this about `get_cover.php`.



---

archive/issue_comments_409784.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nDan Gordon was able to get rid of the extra initial `\\n\\n<html>\\n<body>\\n`.\nWe're almost there, but one thing puzzles me about `sage -t`.\n\nWith the following code in `src/sage/combinat/designs/covering_design.py`\n\n```\ndef best_known_covering_design_www(v, k, t, verbose=False):\n    r\"\"\"\n    Return the best known `(v, k, t)` covering design from an online database.\n\n    This uses the La Jolla Covering Repository, a database\n    available at `<http://ljcr.dmgordon.org/cover.html>`_\n\n    INPUT:\n\n    - ``v`` -- integer, the size of the point set for the design\n\n    - ``k`` -- integer, the number of points per block\n\n    - ``t`` -- integer, the size of sets covered by the blocks\n\n    - ``verbose`` -- bool (default: ``False``), print verbose message\n\n    OUTPUT:\n\n    A :class:`CoveringDesign` object representing the ``(v, k, t)``-covering\n    design with smallest number of blocks available in the database.\n\n    EXAMPLES::\n\n        sage: from sage.combinat.designs.covering_design import (\n        ....:     best_known_covering_design_www)          # optional - internet\n        sage: C = best_known_covering_design_www(7, 3, 2)  # optional - internet\n        sage: print(C)                                     # optional - internet\n        C(7,3,2) = 7\n        Method: lex covering\n        Submitted on: 1996-12-01 00:00:00\n        0  1  2\n        0  3  4\n        0  5  6\n        1  3  5\n        1  4  6\n        2  3  6\n        2  4  5\n\n    A ValueError is raised if the ``(v, k, t)`` parameters are not\n    found in the database.\n    \"\"\"\n    # import compatible with py2 and py3\n    from six.moves.urllib.request import urlopen\n    from sage.cpython.string import bytes_to_str\n    from sage.misc.sage_eval import sage_eval\n\n    v = int(v)\n    k = int(k)\n    t = int(t)\n\n    param = \"?v=%s&k=%s&t=%s\" % (v, k, t)\n\n    url = \"http://ljcr.dmgordon.org/cover/get_cover.php\" + param\n    if verbose:\n        print(\"Looking up the bounds at %s\" % url)\n    with urlopen(url) as f:\n        s = bytes_to_str(f.read())\n\n    if 'covering not in database' in s:  # not found\n        str = \"no (%d, %d, %d) covering design in database\\n\" % (v, k, t)\n        raise ValueError(str)\n\n    return sage_eval(s)\n```\nthe function now works manually, i.e. I can do\n\n```\nsage: from sage.combinat.designs.covering_design import (\n....:     best_known_covering_design_www)\nsage: C = best_known_covering_design_www(7, 3, 2)\nsage: print(C)\nC(7, 3, 2) = 7\nMethod: lex covering\nSubmitted on: 1996-12-01 00:00:00\n0  1  2\n0  3  4\n0  5  6\n1  3  5\n1  4  6\n2  3  6\n2  4  5\n\n```\nbut, for some reason I cannot figure out, `sage -t` gives a `NameError` saying\n`name 'best_known_covering_design_www' is not defined`:\n\n```\n$ sage -t --optional=internet src/sage/combinat/designs/covering_design.py\nRunning doctests with ID 2019-03-08-21-29-22-a6581694.\nGit branch: t-26592-covering-designs-www\nUsing --optional=internet\nDoctesting 1 file.\nsage -t --warn-long 81.7 src/sage/combinat/designs/covering_design.py\n**********************************************************************\nFile \"src/sage/combinat/designs/covering_design.py\", line 514, in sage.combinat.designs.covering_design.best_known_covering_design_www\nFailed example:\n    C = best_known_covering_design_www(7, 3, 2)  # optional - internet\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[0]>\", line 1, in <module>\n        C = best_known_covering_design_www(Integer(7), Integer(3), Integer(2))  # optional - internet\n    NameError: name 'best_known_covering_design_www' is not defined\n**********************************************************************\nFile \"src/sage/combinat/designs/covering_design.py\", line 515, in sage.combinat.designs.covering_design.best_known_covering_design_www\nFailed example:\n    print(C)                                     # optional - internet\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[1]>\", line 1, in <module>\n        print(C)                                     # optional - internet\n    NameError: name 'C' is not defined\n**********************************************************************\n1 item had failures:\n   2 of   3 in sage.combinat.designs.covering_design.best_known_covering_design_www\n    [2 tests, 2 failures, 0.01 s]\n----------------------------------------------------------------------\nsage -t --warn-long 81.7 src/sage/combinat/designs/covering_design.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.1 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n```\nCan somebody enlighten me?",
    "created_at": "2019-03-08T20:42:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409784",
    "user": "https://github.com/slel"
}
```

<div id="comment:14" align="right">comment:14</div>

Dan Gordon was able to get rid of the extra initial `\n\n<html>\n<body>\n`.
We're almost there, but one thing puzzles me about `sage -t`.

With the following code in `src/sage/combinat/designs/covering_design.py`

```
def best_known_covering_design_www(v, k, t, verbose=False):
    r"""
    Return the best known `(v, k, t)` covering design from an online database.

    This uses the La Jolla Covering Repository, a database
    available at `<http://ljcr.dmgordon.org/cover.html>`_

    INPUT:

    - ``v`` -- integer, the size of the point set for the design

    - ``k`` -- integer, the number of points per block

    - ``t`` -- integer, the size of sets covered by the blocks

    - ``verbose`` -- bool (default: ``False``), print verbose message

    OUTPUT:

    A :class:`CoveringDesign` object representing the ``(v, k, t)``-covering
    design with smallest number of blocks available in the database.

    EXAMPLES::

        sage: from sage.combinat.designs.covering_design import (
        ....:     best_known_covering_design_www)          # optional - internet
        sage: C = best_known_covering_design_www(7, 3, 2)  # optional - internet
        sage: print(C)                                     # optional - internet
        C(7,3,2) = 7
        Method: lex covering
        Submitted on: 1996-12-01 00:00:00
        0  1  2
        0  3  4
        0  5  6
        1  3  5
        1  4  6
        2  3  6
        2  4  5

    A ValueError is raised if the ``(v, k, t)`` parameters are not
    found in the database.
    """
    # import compatible with py2 and py3
    from six.moves.urllib.request import urlopen
    from sage.cpython.string import bytes_to_str
    from sage.misc.sage_eval import sage_eval

    v = int(v)
    k = int(k)
    t = int(t)

    param = "?v=%s&k=%s&t=%s" % (v, k, t)

    url = "http://ljcr.dmgordon.org/cover/get_cover.php" + param
    if verbose:
        print("Looking up the bounds at %s" % url)
    with urlopen(url) as f:
        s = bytes_to_str(f.read())

    if 'covering not in database' in s:  # not found
        str = "no (%d, %d, %d) covering design in database\n" % (v, k, t)
        raise ValueError(str)

    return sage_eval(s)
```
the function now works manually, i.e. I can do

```
sage: from sage.combinat.designs.covering_design import (
....:     best_known_covering_design_www)
sage: C = best_known_covering_design_www(7, 3, 2)
sage: print(C)
C(7, 3, 2) = 7
Method: lex covering
Submitted on: 1996-12-01 00:00:00
0  1  2
0  3  4
0  5  6
1  3  5
1  4  6
2  3  6
2  4  5

```
but, for some reason I cannot figure out, `sage -t` gives a `NameError` saying
`name 'best_known_covering_design_www' is not defined`:

```
$ sage -t --optional=internet src/sage/combinat/designs/covering_design.py
Running doctests with ID 2019-03-08-21-29-22-a6581694.
Git branch: t-26592-covering-designs-www
Using --optional=internet
Doctesting 1 file.
sage -t --warn-long 81.7 src/sage/combinat/designs/covering_design.py
**********************************************************************
File "src/sage/combinat/designs/covering_design.py", line 514, in sage.combinat.designs.covering_design.best_known_covering_design_www
Failed example:
    C = best_known_covering_design_www(7, 3, 2)  # optional - internet
Exception raised:
    Traceback (most recent call last):
      File "/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[0]>", line 1, in <module>
        C = best_known_covering_design_www(Integer(7), Integer(3), Integer(2))  # optional - internet
    NameError: name 'best_known_covering_design_www' is not defined
**********************************************************************
File "src/sage/combinat/designs/covering_design.py", line 515, in sage.combinat.designs.covering_design.best_known_covering_design_www
Failed example:
    print(C)                                     # optional - internet
Exception raised:
    Traceback (most recent call last):
      File "/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/s/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.designs.covering_design.best_known_covering_design_www[1]>", line 1, in <module>
        print(C)                                     # optional - internet
    NameError: name 'C' is not defined
**********************************************************************
1 item had failures:
   2 of   3 in sage.combinat.designs.covering_design.best_known_covering_design_www
    [2 tests, 2 failures, 0.01 s]
----------------------------------------------------------------------
sage -t --warn-long 81.7 src/sage/combinat/designs/covering_design.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.1 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```
Can somebody enlighten me?



---

archive/issue_comments_409785.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n* do not break the import line\n\n* OR tag the first line of the import\n\n* OR use optional=sage,internet ?",
    "created_at": "2019-03-09T06:58:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409785",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

* do not break the import line

* OR tag the first line of the import

* OR use optional=sage,internet ?



---

archive/issue_comments_409786.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n@slel with your patch and python 2 i obtain the following:\n\n```\nsage: best_known_covering_design_www(7, 3, 2)\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-2-a930c6c24a1d> in <module>()\n----> 1 best_known_covering_design_www(Integer(7), Integer(3), Integer(2))\n\n<ipython-input-1-598f13fbcc94> in best_known_covering_design_www(v, k, t, verbose)\n     55     if verbose:\n     56         print(\"Looking up the bounds at %s\" % url)\n---> 57     with urlopen(url) as f:\n     58         s = bytes_to_str(f.read())\n     59 \n\nAttributeError: addinfourl instance has no attribute '__exit__'\n\n```\nSee: https://stackoverflow.com/questions/30627937/traceback-attributeerroraddinfourl-instance-has-no-attribute-exit/30628142",
    "created_at": "2019-03-11T09:10:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409786",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:16" align="right">comment:16</div>

@slel with your patch and python 2 i obtain the following:

```
sage: best_known_covering_design_www(7, 3, 2)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-2-a930c6c24a1d> in <module>()
----> 1 best_known_covering_design_www(Integer(7), Integer(3), Integer(2))

<ipython-input-1-598f13fbcc94> in best_known_covering_design_www(v, k, t, verbose)
     55     if verbose:
     56         print("Looking up the bounds at %s" % url)
---> 57     with urlopen(url) as f:
     58         s = bytes_to_str(f.read())
     59 

AttributeError: addinfourl instance has no attribute '__exit__'

```
See: https://stackoverflow.com/questions/30627937/traceback-attributeerroraddinfourl-instance-has-no-attribute-exit/30628142



---

archive/issue_comments_409787.json:
```json
{
    "body": "Branch: **[u/vklein/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26592)**",
    "created_at": "2019-03-11T09:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409787",
    "user": "https://github.com/vinklein"
}
```

Branch: **[u/vklein/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26592)**



---

archive/issue_comments_409788.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe py2 and py3 tests pass with branch u/vklein/26592.\\\\\n\nI will now look for a way to avoid calling `sage_eval` on a internet given result.\\\\\nIt really looks like an highway for code injection to me.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27eeb10c43f0a090de107ebd5f427ad26de3bf53\"><code>27eeb10</code></a></td><td><code>Trac #26592: apply and fix slelievre's patch ...</code></td></tr></table>\n",
    "created_at": "2019-03-11T09:32:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409788",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:18" align="right">comment:18</div>

The py2 and py3 tests pass with branch u/vklein/26592.\\

I will now look for a way to avoid calling `sage_eval` on a internet given result.\\
It really looks like an highway for code injection to me.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27eeb10c43f0a090de107ebd5f427ad26de3bf53"><code>27eeb10</code></a></td><td><code>Trac #26592: apply and fix slelievre's patch ...</code></td></tr></table>




---

archive/issue_comments_409789.json:
```json
{
    "body": "Commit: **[`27eeb10`](https://github.com/sagemath/sagetrac-mirror/commit/27eeb10c43f0a090de107ebd5f427ad26de3bf53)**",
    "created_at": "2019-03-11T09:32:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409789",
    "user": "https://github.com/vinklein"
}
```

Commit: **[`27eeb10`](https://github.com/sagemath/sagetrac-mirror/commit/27eeb10c43f0a090de107ebd5f427ad26de3bf53)**



---

archive/issue_comments_409790.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nConstructing \"manually\" the `CoveringDesign` is not that easy because his `__init__` function has eleven named parameters with default values, that mean there is a lot of potential string format that `get_cover.php` could return.\n\nDo we know if get_cover.php always return a string in the form \"CoveringDesign(<all init parameters positionally>)\" ?",
    "created_at": "2019-03-11T14:31:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409790",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:19" align="right">comment:19</div>

Constructing "manually" the `CoveringDesign` is not that easy because his `__init__` function has eleven named parameters with default values, that mean there is a lot of potential string format that `get_cover.php` could return.

Do we know if get_cover.php always return a string in the form "CoveringDesign(<all init parameters positionally>)" ?



---

archive/issue_events_363007.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-13T17:14:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363007"
}
```



---

archive/issue_events_363008.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363008"
}
```



---

archive/issue_events_363009.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363009"
}
```



---

archive/issue_comments_409791.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409791",
    "user": "https://github.com/embray"
}
```

<div id="comment:22" align="right">comment:22</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_409792.json:
```json
{
    "body": "Changed branch from **[u/vklein/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26592)** to **[u/slelievre/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/26592)**",
    "created_at": "2019-04-15T02:03:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409792",
    "user": "https://github.com/slel"
}
```

Changed branch from **[u/vklein/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26592)** to **[u/slelievre/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/26592)**



---

archive/issue_comments_409793.json:
```json
{
    "body": "Changed commit from **[`27eeb10`](https://github.com/sagemath/sagetrac-mirror/commit/27eeb10c43f0a090de107ebd5f427ad26de3bf53)** to **[`e863721`](https://github.com/sagemath/sagetrac-mirror/commit/e863721bac6eca92b83d17a220692c127dffc88d)**",
    "created_at": "2019-04-15T02:07:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409793",
    "user": "https://github.com/slel"
}
```

Changed commit from **[`27eeb10`](https://github.com/sagemath/sagetrac-mirror/commit/27eeb10c43f0a090de107ebd5f427ad26de3bf53)** to **[`e863721`](https://github.com/sagemath/sagetrac-mirror/commit/e863721bac6eca92b83d17a220692c127dffc88d)**



---

archive/issue_comments_409794.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nNew branch based on Sage 8.8.beta2.\n\nA first commit does pep8 reformatting + updating urls.\n\nThe second commit has the actual `bytes_to_str` fix in\n`best_known_covering_design_www` and a minor\nimprovement to `is_covering`.\n\nPlease review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1437e5bee48bc2e11b730413f0e6b48dd368cf7\"><code>a1437e5</code></a></td><td><code>26592: Fix urls and do a round of pep8 in covering_designs.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e863721bac6eca92b83d17a220692c127dffc88d\"><code>e863721</code></a></td><td><code>26592: Fix py3 bytes_to_str + minor speedup</code></td></tr></table>\n",
    "created_at": "2019-04-15T02:07:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409794",
    "user": "https://github.com/slel"
}
```

<div id="comment:24" align="right">comment:24</div>

New branch based on Sage 8.8.beta2.

A first commit does pep8 reformatting + updating urls.

The second commit has the actual `bytes_to_str` fix in
`best_known_covering_design_www` and a minor
improvement to `is_covering`.

Please review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1437e5bee48bc2e11b730413f0e6b48dd368cf7"><code>a1437e5</code></a></td><td><code>26592: Fix urls and do a round of pep8 in covering_designs.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e863721bac6eca92b83d17a220692c127dffc88d"><code>e863721</code></a></td><td><code>26592: Fix py3 bytes_to_str + minor speedup</code></td></tr></table>




---

archive/issue_events_363010.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-04-15T02:07:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363010"
}
```



---

archive/issue_events_363011.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-04-15T02:07:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363011"
}
```



---

archive/issue_comments_409795.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThere is no point in these being in-line imports: \n\n```\n     from six.moves.urllib.request import urlopen\n-\n+    from sage.cpython.string import bytes_to_str\n```\n\nThose modules are always loaded by Sage so they might as well go at the module-level.",
    "created_at": "2019-04-16T16:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409795",
    "user": "https://github.com/embray"
}
```

<div id="comment:25" align="right">comment:25</div>

There is no point in these being in-line imports: 

```
     from six.moves.urllib.request import urlopen
-
+    from sage.cpython.string import bytes_to_str
```

Those modules are always loaded by Sage so they might as well go at the module-level.



---

archive/issue_comments_409796.json:
```json
{
    "body": "Changed commit from **[`e863721`](https://github.com/sagemath/sagetrac-mirror/commit/e863721bac6eca92b83d17a220692c127dffc88d)** to **[`a69f4ec`](https://github.com/sagemath/sagetrac-mirror/commit/a69f4ecdf33625f037bbad1375c6b3f24a5b5f12)**",
    "created_at": "2019-04-17T08:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409796",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e863721`](https://github.com/sagemath/sagetrac-mirror/commit/e863721bac6eca92b83d17a220692c127dffc88d)** to **[`a69f4ec`](https://github.com/sagemath/sagetrac-mirror/commit/a69f4ecdf33625f037bbad1375c6b3f24a5b5f12)**



---

archive/issue_comments_409797.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a69f4ecdf33625f037bbad1375c6b3f24a5b5f12\"><code>a69f4ec</code></a></td><td><code>26592: Move imports to beginning of file</code></td></tr></table>\n",
    "created_at": "2019-04-17T08:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409797",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a69f4ecdf33625f037bbad1375c6b3f24a5b5f12"><code>a69f4ec</code></a></td><td><code>26592: Move imports to beginning of file</code></td></tr></table>




---

archive/issue_comments_409798.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nLike this?",
    "created_at": "2019-04-17T08:24:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409798",
    "user": "https://github.com/slel"
}
```

<div id="comment:27" align="right">comment:27</div>

Like this?



---

archive/issue_comments_409799.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThis line:\n\n```\nhttps://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view\n```\nis not something that we should link to.\n\nOtherwise, looks good. In the future, please avoid doing large scale pep8 cleanup at the same time as serious changes.",
    "created_at": "2019-04-28T07:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409799",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:28" align="right">comment:28</div>

This line:

```
https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view
```
is not something that we should link to.

Otherwise, looks good. In the future, please avoid doing large scale pep8 cleanup at the same time as serious changes.



---

archive/issue_comments_409800.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@fchapoton](#comment%3A28):\n> This line:\n> \n> ```\n> https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view\n> ```\n> is not something that we should link to.\n\nOther options I can see are the following:\n\n- Dan Gordon's publications page: https://www.dmgordon.org/Publications/\n- the CRC Press page for the book: https://www.crcpress.com/Handbook-of-Combinatorial-Designs-Second-Edition/Colbourn-Dinitz/p/book/9781584885061\n- one of the editors' page for the book: http://www.cems.uvm.edu/~jdinitz/hcd.html\n\n> Otherwise, looks good. In the future, please avoid doing large scale pep8 cleanup at the same time as serious changes.\n\nSorry about that, I got slightly carried away. I tried to use a different commit for each type of changes, but probably could have done a better job of that, or used different tickets altogether. Thanks for reviewing anyway and for the advice for the future.",
    "created_at": "2019-04-28T08:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409800",
    "user": "https://github.com/slel"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@fchapoton](#comment%3A28):
> This line:
> 
> ```
> https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view
> ```
> is not something that we should link to.

Other options I can see are the following:

- Dan Gordon's publications page: https://www.dmgordon.org/Publications/
- the CRC Press page for the book: https://www.crcpress.com/Handbook-of-Combinatorial-Designs-Second-Edition/Colbourn-Dinitz/p/book/9781584885061
- one of the editors' page for the book: http://www.cems.uvm.edu/~jdinitz/hcd.html

> Otherwise, looks good. In the future, please avoid doing large scale pep8 cleanup at the same time as serious changes.

Sorry about that, I got slightly carried away. I tried to use a different commit for each type of changes, but probably could have done a better job of that, or used different tickets altogether. Thanks for reviewing anyway and for the advice for the future.



---

archive/issue_comments_409801.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nOr we could link to the copy archived at the Internet Archive's Wayback Machine:\n\n- https://web.archive.org/web/20170829210149/https://www.ccrwest.org/gordon/hcd.pdf",
    "created_at": "2019-04-28T08:46:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409801",
    "user": "https://github.com/slel"
}
```

<div id="comment:30" align="right">comment:30</div>

Or we could link to the copy archived at the Internet Archive's Wayback Machine:

- https://web.archive.org/web/20170829210149/https://www.ccrwest.org/gordon/hcd.pdf



---

archive/issue_comments_409802.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@slel](#comment%3A29):\n> Replying to [@fchapoton](#comment%3A28):\n> > This line:\n> > \n> > ```\n> > https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view\n> > ```\n> > is not something that we should link to.\n> \n> \n> Other options I can see are the following:\n> \n> - Dan Gordon's publications page: https://www.dmgordon.org/Publications/\n\nYes, this one is better. One should also give the title (Coverings, chapter 1 of whatever)",
    "created_at": "2019-04-28T10:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409802",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@slel](#comment%3A29):
> Replying to [@fchapoton](#comment%3A28):
> > This line:
> > 
> > ```
> > https://drive.google.com/file/d/0B6s9_JNV1EjtUFd4MkhBc0hSdVU/view
> > ```
> > is not something that we should link to.
> 
> 
> Other options I can see are the following:
> 
> - Dan Gordon's publications page: https://www.dmgordon.org/Publications/

Yes, this one is better. One should also give the title (Coverings, chapter 1 of whatever)



---

archive/issue_comments_409803.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nHaving my papers on google drive was the last part of my website that I hadn't updated.  I've moved them now, so that paper can now be linked to at [https://www.dmgordon.org/papers/hcd.pdf](https://www.dmgordon.org/papers/hcd.pdf).",
    "created_at": "2019-04-29T21:25:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409803",
    "user": "https://github.com/sagetrac-dgordon"
}
```

<div id="comment:32" align="right">comment:32</div>

Having my papers on google drive was the last part of my website that I hadn't updated.  I've moved them now, so that paper can now be linked to at [https://www.dmgordon.org/papers/hcd.pdf](https://www.dmgordon.org/papers/hcd.pdf).



---

archive/issue_comments_409804.json:
```json
{
    "body": "Changed commit from **[`a69f4ec`](https://github.com/sagemath/sagetrac-mirror/commit/a69f4ecdf33625f037bbad1375c6b3f24a5b5f12)** to **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)**",
    "created_at": "2019-05-01T00:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409804",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a69f4ec`](https://github.com/sagemath/sagetrac-mirror/commit/a69f4ecdf33625f037bbad1375c6b3f24a5b5f12)** to **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)**



---

archive/issue_comments_409805.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1\"><code>1f3afa8</code></a></td><td><code>Update Gordon--Stinson bibliographic reference</code></td></tr></table>\n",
    "created_at": "2019-05-01T00:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409805",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1"><code>1f3afa8</code></a></td><td><code>Update Gordon--Stinson bibliographic reference</code></td></tr></table>




---

archive/issue_comments_409806.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nUpdated now, please review.",
    "created_at": "2019-05-01T00:32:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409806",
    "user": "https://github.com/slel"
}
```

<div id="comment:34" align="right">comment:34</div>

Updated now, please review.



---

archive/issue_comments_409807.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nok, thx",
    "created_at": "2019-05-01T06:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409807",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:35" align="right">comment:35</div>

ok, thx



---

archive/issue_comments_409808.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-05-01T06:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409808",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_409809.json:
```json
{
    "body": "Author: **Samuel Leli\u00e8vre**",
    "created_at": "2019-05-01T06:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409809",
    "user": "https://github.com/fchapoton"
}
```

Author: **Samuel Lelièvre**



---

archive/issue_events_363012.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-01T06:47:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363012"
}
```



---

archive/issue_events_363013.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-01T06:47:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363013"
}
```



---

archive/issue_events_363014.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-06T11:56:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363014"
}
```



---

archive/issue_events_363015.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "46912716a3b8d21445b5188ff5327949e195905e",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-05-06T11:56:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26592#event-363015"
}
```



---

archive/issue_comments_409810.json:
```json
{
    "body": "Changed branch from **[u/slelievre/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/26592)** to **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)**",
    "created_at": "2019-05-06T11:56:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409810",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/slelievre/26592](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/26592)** to **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)**



---

archive/issue_comments_409811.json:
```json
{
    "body": "Changed commit from **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)** to none",
    "created_at": "2019-05-13T13:29:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409811",
    "user": "https://github.com/seblabbe"
}
```

Changed commit from **[`1f3afa8`](https://github.com/sagemath/sagetrac-mirror/commit/1f3afa8ed60c5ab665a2d7ed3421323fe21dd6c1)** to none



---

archive/issue_comments_409812.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nWith 8.8.beta5, I get:\n\n```\nsage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-1-a3d9f9e592f1> in <module>()\n----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))\n\n/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/combinat/designs/covering_design.pyc in best_known_covering_design_www(v, k, t, verbose)\n    525     if verbose:\n    526         print(\"Looking up the bounds at %s\" % url)\n--> 527     with urlopen(url) as f:\n    528         s = bytes_to_str(f.read())\n    529     if 'covering not in database' in s:  # not found\n\nAttributeError: addinfourl instance has no attribute '__exit__'\n```\nWere you obtaining the same issue with this branch?",
    "created_at": "2019-05-13T13:29:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409812",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:37" align="right">comment:37</div>

With 8.8.beta5, I get:

```
sage: C = designs.best_known_covering_design_from_LJCR(7, 3, 2)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-1-a3d9f9e592f1> in <module>()
----> 1 C = designs.best_known_covering_design_from_LJCR(Integer(7), Integer(3), Integer(2))

/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/combinat/designs/covering_design.pyc in best_known_covering_design_www(v, k, t, verbose)
    525     if verbose:
    526         print("Looking up the bounds at %s" % url)
--> 527     with urlopen(url) as f:
    528         s = bytes_to_str(f.read())
    529     if 'covering not in database' in s:  # not found

AttributeError: addinfourl instance has no attribute '__exit__'
```
Were you obtaining the same issue with this branch?



---

archive/issue_comments_409813.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI think so `with urelopen(url) as...` syntax has been introduced with commit `e863721`.\\\\\n\nIt should be avoided (see [comment:16](https://github.com/sagemath/sage/issues/26592#comment:16))",
    "created_at": "2019-05-13T13:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409813",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:38" align="right">comment:38</div>

I think so `with urelopen(url) as...` syntax has been introduced with commit `e863721`.\\

It should be avoided (see [comment:16](https://github.com/sagemath/sage/issues/26592#comment:16))



---

archive/issue_comments_409814.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nOpen a new ticket to fix that #27821",
    "created_at": "2019-05-13T14:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26592#issuecomment-409814",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:39" align="right">comment:39</div>

Open a new ticket to fix that #27821
