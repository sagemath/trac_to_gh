# Issue 26856: Upgrade to gap_packages 4.10 and remove database_gap

archive/issues_026619.json:
```json
{
    "body": "After the upgrade to GAP 4.10 in #22626, we revisit what\nGAP packages are available in Sage via the GAP standard\nSPKG and via extra optional SPGKs.\n\nAll GAP packages formerly in our \"database_gap\"\noptional SPKG, except tomlib, now get installed\nwith GAP as part of our \"gap\" standard SPKG.\n\nThis ticket adds tomlib to the \"gap\" standard SPKG\nand removes the \"database_gap\" optional SPKG.\n\n(All packages previously in \"database_gap\" have\nGPL-compatible licenses and can therefore be\ndistributed as part of the \"gap\" standard SPKG\nwithout license worries.)\n\nWe also update the list of extra GAP packages\nin gap_packages, which remains a separate and\noptional SPKG.\n\nOnce the present ticket is merged, GAP packages\nshipped with the \"gap\" standard SPKG and with\nthe \"gap_packages\" optional SPKG are as follows.\n\n'''GAP packages now shipped with \"gap\"\n(standard SageMath package)'''\n\nA basic package used by most GAP packages\nfor their documentation\n\n- GAPDoc\n\nFive database packages formerly in \"database_gap\"\n\n- PrimGrp\n- SmallGrp\n- TransGrp\n- TomLib\n- AtlasRep\n\nTwelve more packages\n\n- AutPGrp\n- Alnuth\n- CRISP\n- !CTblLib\n- FactInt\n- FGA\n- IRREDSOL\n- LAGUNA\n- Polenta\n- Polycyclic\n- ResClasses\n- Sophus\n\n'''GAP packages now shipped with \"gap_packages\"\n(optional SageMath package)'''\n\nTwenty-five \"pure GAP\" packages\n(not requiring compilation)\n\n- AClib\n- AutoDoc\n- CoReLG\n- CRIME\n- Cryst\n- CrystCat\n- DESIGN\n- GBNP\n- HAP\n- HAPcryst\n- hecke\n- LieAlgDB\n- LiePRing\n- LieRing\n- loops\n- MapClass\n- polymaking\n- QPA\n- QuaGroup\n- RadiRoot\n- Repsn\n- SLA\n- SONATA\n- Toric\n- utils\n\nFour compiled GAP packages\n\n- cohomolo\n- GRAPE\n- GUAVA\n- nq\n\n**No longer distributed**\n\n- HAPprime: unmaintained, partly merged in HAP, \n  see [list of \"No longer redistributed with GAP or renamed\" GAP packages](https://www.gap-system.org/Packages/packages.html#deppkg),\n  source code [archived at GitHub](https://github.com/gap-packages/happrime)\n\n\nCC:  alexk @antonio-rojas @dimpase @embray @kiwifb @mantepse @miguelmarco @slel @tscrim @vbraun\n\nKeywords: GAP\n\nReviewer: Erik Bray, Dima Pasechnik\n\nAuthor: Dima Pasechnik, Erik Bray\n\nBranch: 8bf1044efda750d8a767d88aa6a2afda69edadbe\n\nDependencies: #22626, #26889, #26965\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26856\n\n",
    "closed_at": "2018-12-31T10:37:12Z",
    "created_at": "2018-12-08T08:04:53Z",
    "labels": [
        "component: packages: optional",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.6",
    "title": "Upgrade to gap_packages 4.10 and remove database_gap",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26856",
    "user": "https://github.com/dimpase"
}
```
After the upgrade to GAP 4.10 in #22626, we revisit what
GAP packages are available in Sage via the GAP standard
SPKG and via extra optional SPGKs.

All GAP packages formerly in our "database_gap"
optional SPKG, except tomlib, now get installed
with GAP as part of our "gap" standard SPKG.

This ticket adds tomlib to the "gap" standard SPKG
and removes the "database_gap" optional SPKG.

(All packages previously in "database_gap" have
GPL-compatible licenses and can therefore be
distributed as part of the "gap" standard SPKG
without license worries.)

We also update the list of extra GAP packages
in gap_packages, which remains a separate and
optional SPKG.

Once the present ticket is merged, GAP packages
shipped with the "gap" standard SPKG and with
the "gap_packages" optional SPKG are as follows.

'''GAP packages now shipped with "gap"
(standard SageMath package)'''

A basic package used by most GAP packages
for their documentation

- GAPDoc

Five database packages formerly in "database_gap"

- PrimGrp
- SmallGrp
- TransGrp
- TomLib
- AtlasRep

Twelve more packages

- AutPGrp
- Alnuth
- CRISP
- !CTblLib
- FactInt
- FGA
- IRREDSOL
- LAGUNA
- Polenta
- Polycyclic
- ResClasses
- Sophus

'''GAP packages now shipped with "gap_packages"
(optional SageMath package)'''

Twenty-five "pure GAP" packages
(not requiring compilation)

- AClib
- AutoDoc
- CoReLG
- CRIME
- Cryst
- CrystCat
- DESIGN
- GBNP
- HAP
- HAPcryst
- hecke
- LieAlgDB
- LiePRing
- LieRing
- loops
- MapClass
- polymaking
- QPA
- QuaGroup
- RadiRoot
- Repsn
- SLA
- SONATA
- Toric
- utils

Four compiled GAP packages

- cohomolo
- GRAPE
- GUAVA
- nq

**No longer distributed**

- HAPprime: unmaintained, partly merged in HAP, 
  see [list of "No longer redistributed with GAP or renamed" GAP packages](https://www.gap-system.org/Packages/packages.html#deppkg),
  source code [archived at GitHub](https://github.com/gap-packages/happrime)


CC:  alexk @antonio-rojas @dimpase @embray @kiwifb @mantepse @miguelmarco @slel @tscrim @vbraun

Keywords: GAP

Reviewer: Erik Bray, Dima Pasechnik

Author: Dima Pasechnik, Erik Bray

Branch: 8bf1044efda750d8a767d88aa6a2afda69edadbe

Dependencies: #22626, #26889, #26965

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26856





---

archive/issue_comments_398279.json:
```json
{
    "body": "<a id='comment:1'></a>Last 10 new commits:",
    "created_at": "2018-12-08T13:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398279",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>Last 10 new commits:



---

archive/issue_comments_398280.json:
```json
{
    "body": "<a id='comment:3'></a>Is there a particular reason to merge `database_gap` into `gap_packages`?",
    "created_at": "2018-12-10T12:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398280",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>Is there a particular reason to merge `database_gap` into `gap_packages`?



---

archive/issue_comments_398281.json:
```json
{
    "body": "<a id='comment:4'></a>historically, there were several reasons to have separate gap, database_gap and gap_packages, and do not install all the possible GAP packages\n\n* largish sizes of downloads\n* licensing issues---stuff in database_gap is not GPL-compatible before GAP 4.9 or 4.10\n* non-working with libgap GAP kernel extensions\n\nthe 1st one, if we decide not to re-package original GAP tarball (and I am very much for not re-packaging), would be gone.\n\nthe 2nd one is (completely, from the point of view of GAP's LICENCE file) fixed since GAP 4.10 (or even 4.9).\n\nthe 3rd one is fixed by #22626, although this has to be verified.",
    "created_at": "2018-12-10T13:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398281",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>historically, there were several reasons to have separate gap, database_gap and gap_packages, and do not install all the possible GAP packages

* largish sizes of downloads
* licensing issues---stuff in database_gap is not GPL-compatible before GAP 4.9 or 4.10
* non-working with libgap GAP kernel extensions

the 1st one, if we decide not to re-package original GAP tarball (and I am very much for not re-packaging), would be gone.

the 2nd one is (completely, from the point of view of GAP's LICENCE file) fixed since GAP 4.10 (or even 4.9).

the 3rd one is fixed by #22626, although this has to be verified.



---

archive/issue_comments_398282.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 dimpase]:\n> the 3rd one is fixed by #22626, although this has to be verified.\n\n\nLast I checked this is broken actually, but it's mostly a problem with my install script I think.  I need to tinker with that a bit more.",
    "created_at": "2018-12-10T17:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398282",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>Replying to [comment:4 dimpase]:
> the 3rd one is fixed by #22626, although this has to be verified.


Last I checked this is broken actually, but it's mostly a problem with my install script I think.  I need to tinker with that a bit more.



---

archive/issue_comments_398283.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-10T17:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398283",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398284.json:
```json
{
    "body": "<a id='comment:7'></a>Note that most of database_gap is already in our new gap (4.10) package, with exception of tomlib. \n\nI'll add tomlib to gap 4.10, and get rid of database_gap.",
    "created_at": "2018-12-11T11:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398284",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Note that most of database_gap is already in our new gap (4.10) package, with exception of tomlib. 

I'll add tomlib to gap 4.10, and get rid of database_gap.



---

archive/issue_comments_398285.json:
```json
{
    "body": "<a id='comment:8'></a>I am checking whether `database_gap` is already in the branch on #22626, running\n\n```\n./sage -tp  --optional=dochtml,memlimit,mpir,python2,database_gap,sage src/sage/groups/perm_gps/permgroup.py \n```\n(that is, adding `database_gap` to the `optional` list) and get the following weird error:\n\n```\nUsing --optional=database_gap,dochtml,memlimit,mpir,python2,sage\nDoctesting 1 file using 4 threads.\nsage -t src/sage/groups/perm_gps/permgroup.py\n**********************************************************************\nFile \"src/sage/groups/perm_gps/permgroup.py\", line 733, in sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_\nFailed example:\n    p = f(mg); p\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_[19]>\", line 1, in <module>\n        p = f(mg); p\n    TypeError: 'NoneType' object is not callable\n**********************************************************************\nFile \"src/sage/groups/perm_gps/permgroup.py\", line 735, in sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_\nFailed example:\n    PG(p._gap_()) == p\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_[20]>\", line 1, in <module>\n        PG(p._gap_()) == p\n    NameError: name 'p' is not defined\n**********************************************************************\n1 item had failures:\n   2 of  27 in sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_\n    [862 tests, 2 failures, 18.36 s]\n----------------------------------------------------------------------\nsage -t src/sage/groups/perm_gps/permgroup.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 18.6 seconds\n```\n\nWithout `database_gap` in optional, everything passes. The trouble is that the failing tests are not tagged as optional, i.e. it should not matter whether `database_gap` is passed or not. \n\nNeedless to say, these tests work at the Sage prompt just fine.\n\nMy hunch is that it might be related to the recent #25706, which unfortunately mixes `libgap` and `gap`. (Even if this were true, it would not take away the general flakiness of Sage's doctesting framework...)",
    "created_at": "2018-12-13T05:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398285",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>I am checking whether `database_gap` is already in the branch on #22626, running

```
./sage -tp  --optional=dochtml,memlimit,mpir,python2,database_gap,sage src/sage/groups/perm_gps/permgroup.py 
```
(that is, adding `database_gap` to the `optional` list) and get the following weird error:

```
Using --optional=database_gap,dochtml,memlimit,mpir,python2,sage
Doctesting 1 file using 4 threads.
sage -t src/sage/groups/perm_gps/permgroup.py
**********************************************************************
File "src/sage/groups/perm_gps/permgroup.py", line 733, in sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_
Failed example:
    p = f(mg); p
Exception raised:
    Traceback (most recent call last):
      File "/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_[19]>", line 1, in <module>
        p = f(mg); p
    TypeError: 'NoneType' object is not callable
**********************************************************************
File "src/sage/groups/perm_gps/permgroup.py", line 735, in sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_
Failed example:
    PG(p._gap_()) == p
Exception raised:
    Traceback (most recent call last):
      File "/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dimpase/Sage/sagetrac-mirror/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_[20]>", line 1, in <module>
        PG(p._gap_()) == p
    NameError: name 'p' is not defined
**********************************************************************
1 item had failures:
   2 of  27 in sage.groups.perm_gps.permgroup.PermutationGroup_generic._coerce_map_from_
    [862 tests, 2 failures, 18.36 s]
----------------------------------------------------------------------
sage -t src/sage/groups/perm_gps/permgroup.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 18.6 seconds
```

Without `database_gap` in optional, everything passes. The trouble is that the failing tests are not tagged as optional, i.e. it should not matter whether `database_gap` is passed or not. 

Needless to say, these tests work at the Sage prompt just fine.

My hunch is that it might be related to the recent #25706, which unfortunately mixes `libgap` and `gap`. (Even if this were true, it would not take away the general flakiness of Sage's doctesting framework...)



---

archive/issue_comments_398286.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 dimpase]:\n> it would not take away the general flakiness of Sage's doctesting framework...\n\n\nThe \"doctest framework\" is not flaky. Code in Sage or its tests is flaky.",
    "created_at": "2018-12-13T10:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398286",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>Replying to [comment:8 dimpase]:
> it would not take away the general flakiness of Sage's doctesting framework...


The "doctest framework" is not flaky. Code in Sage or its tests is flaky.



---

archive/issue_comments_398287.json:
```json
{
    "body": "<a id='comment:10'></a>One way or another, I have no idea where to even start looking, and what kind of side effects might cause this, and whether it's side-effects in Sage alone, or in Sage interacting with the doctest framework---in the latter case this means it's not possible to reproduce on \"standalone\" Sage.",
    "created_at": "2018-12-13T11:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398287",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>One way or another, I have no idea where to even start looking, and what kind of side effects might cause this, and whether it's side-effects in Sage alone, or in Sage interacting with the doctest framework---in the latter case this means it's not possible to reproduce on "standalone" Sage.



---

archive/issue_comments_398288.json:
```json
{
    "body": "<a id='comment:11'></a>The issue in comment 8 disappears (I dare not call this a fix, cause the only proof I have is that tests pass!) with the [latest commit](https://git.sagemath.org/sage.git/commit?id=ef2230a3c98cb6d8b500e5ba6b925199c30a5647) on this branch,\nwhich reduces insanity in `src/sage/groups/matrix_gps/finitely_generated.py`, see #26889,\nwhere it should be posted as an independent thing.\n\nAt least I can say that my hunch seems to have been right...\n\n---\nLast 10 new commits:",
    "created_at": "2018-12-13T14:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398288",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>The issue in comment 8 disappears (I dare not call this a fix, cause the only proof I have is that tests pass!) with the [latest commit](https://git.sagemath.org/sage.git/commit?id=ef2230a3c98cb6d8b500e5ba6b925199c30a5647) on this branch,
which reduces insanity in `src/sage/groups/matrix_gps/finitely_generated.py`, see #26889,
where it should be posted as an independent thing.

At least I can say that my hunch seems to have been right...

---
Last 10 new commits:



---

archive/issue_comments_398289.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-13T14:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398289",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_398290.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 dimpase]:\n> One way or another, I have no idea where to even start looking, and what kind of side effects might cause this\n\n\nIn many cases, the mysterious failure of doctests is due to some changing interaction with the Python garbage collector. For example, adding an extra test might change the time when the garbage collector kicks in, causing these strange failures. This is especially true when weak references are involved. And the failing test involves the coercion model, which is using weak references.",
    "created_at": "2018-12-13T16:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398290",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:10 dimpase]:
> One way or another, I have no idea where to even start looking, and what kind of side effects might cause this


In many cases, the mysterious failure of doctests is due to some changing interaction with the Python garbage collector. For example, adding an extra test might change the time when the garbage collector kicks in, causing these strange failures. This is especially true when weak references are involved. And the failing test involves the coercion model, which is using weak references.



---

archive/issue_comments_398291.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-14T09:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398292.json:
```json
{
    "body": "<a id='comment:14'></a>All that is needed to have the doctests pass with `database_gap` in `--optional` is the latest commit. \n\nWe still need to make sure that tables of marks (GAP 4.8 tomlib package) are there, and then remove `#optional : database_gap` tags and `database_gap` package.",
    "created_at": "2018-12-14T09:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398292",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>All that is needed to have the doctests pass with `database_gap` in `--optional` is the latest commit. 

We still need to make sure that tables of marks (GAP 4.8 tomlib package) are there, and then remove `#optional : database_gap` tags and `database_gap` package.



---

archive/issue_comments_398293.json:
```json
{
    "body": "<a id='comment:15'></a>OK, I'll make our default GAP, without `gap_packages` installed, to be the same as vanilla GAP 4.10, which is, package-wise, as follows:\n\n```\n$ ./gap\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   GAP 4.10.0 of 01-Nov-2018\n \u2502  GAP  \u2502   https://www.gap-system.org\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   Architecture: x86_64-pc-linux-gnu-default64\n Configuration:  gmp 6.1.2, readline\n Loading the library and packages ...\n Packages:   AClib 1.3.1, Alnuth 3.1.0, AtlasRep 1.5.1, AutoDoc 2018.09.20, AutPGrp 1.10, CRISP 1.4.4, Cryst 4.1.18, CrystCat 1.1.8, CTblLib 1.2.2, \n             FactInt 1.6.2, FGA 1.4.0, GAPDoc 1.6.2, IRREDSOL 1.4, LAGUNA 3.9.0, Polenta 1.3.8, Polycyclic 2.14, PrimGrp 3.3.2, RadiRoot 2.8, \n             ResClasses 4.7.1, SmallGrp 1.3, Sophus 1.24, SpinSym 1.5, TomLib 1.2.7, TransGrp 2.0.4, utils 0.59 \n```\n\nThis covers everything that is in `database_gap`, and more - so we'll move some things out of `gap_packages` into the main `gap` package.",
    "created_at": "2018-12-14T11:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398293",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>OK, I'll make our default GAP, without `gap_packages` installed, to be the same as vanilla GAP 4.10, which is, package-wise, as follows:

```
$ ./gap
 ┌───────┐   GAP 4.10.0 of 01-Nov-2018
 │  GAP  │   https://www.gap-system.org
 └───────┘   Architecture: x86_64-pc-linux-gnu-default64
 Configuration:  gmp 6.1.2, readline
 Loading the library and packages ...
 Packages:   AClib 1.3.1, Alnuth 3.1.0, AtlasRep 1.5.1, AutoDoc 2018.09.20, AutPGrp 1.10, CRISP 1.4.4, Cryst 4.1.18, CrystCat 1.1.8, CTblLib 1.2.2, 
             FactInt 1.6.2, FGA 1.4.0, GAPDoc 1.6.2, IRREDSOL 1.4, LAGUNA 3.9.0, Polenta 1.3.8, Polycyclic 2.14, PrimGrp 3.3.2, RadiRoot 2.8, 
             ResClasses 4.7.1, SmallGrp 1.3, Sophus 1.24, SpinSym 1.5, TomLib 1.2.7, TransGrp 2.0.4, utils 0.59 
```

This covers everything that is in `database_gap`, and more - so we'll move some things out of `gap_packages` into the main `gap` package.



---

archive/issue_comments_398294.json:
```json
{
    "body": "<a id='comment:16'></a>I thought that we should remove `build/pkgs/gap/patches/nodefaultpackages.patch`, but this breaks pexpect interface to GAP. Note that `database_gap` and `gap_packages` do not not attempt to change the GAP package autoloading settings, so we should leave them as they are (it does not seem to be easy to fix).\n\nIt does not really matter. We can modify stripts starting `gap_console()` to enable autoloading (or not)...",
    "created_at": "2018-12-14T14:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398294",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>I thought that we should remove `build/pkgs/gap/patches/nodefaultpackages.patch`, but this breaks pexpect interface to GAP. Note that `database_gap` and `gap_packages` do not not attempt to change the GAP package autoloading settings, so we should leave them as they are (it does not seem to be easy to fix).

It does not really matter. We can modify stripts starting `gap_console()` to enable autoloading (or not)...



---

archive/issue_comments_398295.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-14T18:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398295",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398296.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-14T23:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398296",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398297.json:
```json
{
    "body": "<a id='comment:19'></a>done getting rid of database_gap\n\nNow on to gap_packages...",
    "created_at": "2018-12-14T23:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398297",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>done getting rid of database_gap

Now on to gap_packages...



---

archive/issue_comments_398298.json:
```json
{
    "body": "<a id='comment:21'></a>opened #26901 to deal with changes in the only (apart from gap_packages) package of Sage dependent on database_gap.",
    "created_at": "2018-12-15T12:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398298",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'></a>opened #26901 to deal with changes in the only (apart from gap_packages) package of Sage dependent on database_gap.



---

archive/issue_comments_398299.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-16T09:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398299",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398300.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-18T13:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398300",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398301.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-18T15:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398301",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398302.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-18T17:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398302",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398303.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-18T19:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398303",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398304.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-18T23:54:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398304",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398305.json:
```json
{
    "body": "<a id='comment:28'></a>The latest bit does not work, as I don't know how to build GAP packages in the current setup. We have built them in place before, so this needs some work.",
    "created_at": "2018-12-19T00:00:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398305",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>The latest bit does not work, as I don't know how to build GAP packages in the current setup. We have built them in place before, so this needs some work.



---

archive/issue_comments_398306.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-19T00:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398306",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_398307.json:
```json
{
    "body": "<a id='comment:30'></a>Certainly, we can keep the present arrangement, where binaries of GAP packages are installed in place, into package's bin/ subdirectories.",
    "created_at": "2018-12-19T08:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398307",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>Certainly, we can keep the present arrangement, where binaries of GAP packages are installed in place, into package's bin/ subdirectories.



---

archive/issue_comments_398308.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-19T21:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398308",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398309.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-19T22:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398309",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398310.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-20T10:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398310",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398311.json:
```json
{
    "body": "<a id='comment:34'></a>It turns out that most of the changes so far here should go to #22626. Once this is done I'll update the branch accordingly.",
    "created_at": "2018-12-20T12:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398311",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>It turns out that most of the changes so far here should go to #22626. Once this is done I'll update the branch accordingly.



---

archive/issue_comments_398312.json:
```json
{
    "body": "<a id='comment:35'></a>Is there any reason the IO package isn't installed here?  It seems to be mentioned quite often, but we don't provide a means to install it.",
    "created_at": "2018-12-20T13:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398312",
    "user": "https://github.com/embray"
}
```

<a id='comment:35'></a>Is there any reason the IO package isn't installed here?  It seems to be mentioned quite often, but we don't provide a means to install it.



---

archive/issue_comments_398313.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-20T13:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398313",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398314.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:35 embray]:\n> Is there any reason the IO package isn't installed here?  It seems to be mentioned quite often, but we don't provide a means to install it.\n\n\nI'm currently going for the minimal thing: get gap_packages spkg working the way it was.\nWe never had io package there, as it was breaking libgap in a bad way.\n(there are open tickets about io package).\n\nDoes this sound like a good plan to you? We can postpone io package, it's not needed to be ready by the Debian freeze deadline.",
    "created_at": "2018-12-20T13:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398314",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>Replying to [comment:35 embray]:
> Is there any reason the IO package isn't installed here?  It seems to be mentioned quite often, but we don't provide a means to install it.


I'm currently going for the minimal thing: get gap_packages spkg working the way it was.
We never had io package there, as it was breaking libgap in a bad way.
(there are open tickets about io package).

Does this sound like a good plan to you? We can postpone io package, it's not needed to be ready by the Debian freeze deadline.



---

archive/issue_comments_398315.json:
```json
{
    "body": "<a id='comment:38'></a>I need to adjust formatting in a dozen of tests, after that should be ready for review.",
    "created_at": "2018-12-20T13:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398315",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:38'></a>I need to adjust formatting in a dozen of tests, after that should be ready for review.



---

archive/issue_comments_398316.json:
```json
{
    "body": "<a id='comment:39'></a>OK regarding the IO package.  If we weren't installing it in the first place I'm fine just sticking to the minimum set of packages that we were always installing in the first place.\n\nI am also making some updates to this: In particular I'm not happy with the way the compiled packages are installed.  Let me know when you're done your changes (set needs_review) and I'll add my changes on top of that.",
    "created_at": "2018-12-20T13:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398316",
    "user": "https://github.com/embray"
}
```

<a id='comment:39'></a>OK regarding the IO package.  If we weren't installing it in the first place I'm fine just sticking to the minimum set of packages that we were always installing in the first place.

I am also making some updates to this: In particular I'm not happy with the way the compiled packages are installed.  Let me know when you're done your changes (set needs_review) and I'll add my changes on top of that.



---

archive/issue_comments_398317.json:
```json
{
    "body": "<a id='comment:40'></a>I'm getting an unpleasant surprise from the doctest framework here - it mangles long lines in this file, e.g. here:\n\n```\nFile \"src/sage/algebras/quantum_groups/quantum_group_gap.py\", line 757, in sage.algebras.quantum_groups.quantum_group_gap.QuantumGroup.coproduct\nFailed example:\n    [Q.coproduct(f, 2)._latex_() for f in Q.F_simple()]  # optional - gap_packages\nExpected:\n    ['1 {(1<x>1<x>F_{\\\\alpha_{1}})}+-q^{2}+q^{-2} {(1<x>F_{\\\\alpha_{1}}<x>[ K_{1} ; 1 ])}+1 {(1<x>F_{\\\\alpha_{1}}<x>K_{1})}+q^{4}-2+q^{-4} {(F_{\\\\alpha_{1}}<x>[ K_{1} ; 1 ]<x>[ K_{1} ; 1 ])}+-q^{2}+q^{-2} {(F_{\\\\alpha_{1}}<x>[ K_{1} ; 1 ]<x>K_{1})}+-q^{2}+q^{-2} {(F_{\\\\alpha_{1}}<x>K_{1}<x>[ K_{1} ; 1 ])}+1 {(F_{\\\\alpha_{1}}<x>K_{1}<x>K_{1})}',\n     '1 {(1<x>1<x>F_{\\\\alpha_{2}})}+-q+q^{-1} {(1<x>F_{\\\\alpha_{2}}<x>[ K_{2} ; 1 ])}+1 {(1<x>F_{\\\\alpha_{2}}<x>K_{2})}+q^{2}-2+q^{-2} {(F_{\\\\alpha_{2}}<x>[ K_{2} ; 1 ]<x>[ K_{2} ; 1 ])}+-q+q^{-1} {(F_{\\\\alpha_{2}}<x>[ K_{2} ; 1 ]<x>K_{2})}+-q+q^{-1} {(F_{\\\\alpha_{2}}<x>K_{2}<x>[ K_{2} ; 1 ])}+1 {(F_{\\\\alpha_{2}}<x>K_{2}<x>K_{2})}']\nGot:\n    ['1 {(1<x>1<x>F_{\\\\alpha_{1}})}+-q^{2}+q^{-2} {(1<x>F_{\\\\alpha_{1}}<x>[ K_{1} ; 1 ])}+1 {(1<x>F_{\\\\alpha_{1}}<x>K_{1})}+q^{4}-2+q^{-4} {(F\\n1<x>[ K_{1} ; 1 ]<x>[ K_{1} ; 1 ])}+-q^{2}+q^{-2} {(F_{\\\\alpha_{1}}<x>[ K_{1} ; 1 ]<x>K_{1})}+-q^{2}+q^{-2} {(F\\n1<x>K_{1}<x>[ K_{1} ; 1 ])}+1 {(F_{\\\\alpha_{1}}<x>K_{1}<x>K_{1})}',\n     '1 {(1<x>1<x>F_{\\\\alpha_{2}})}+-q+q^{-1} {(1<x>F_{\\\\alpha_{2}}<x>[ K_{2} ; 1 ])}+1 {(1<x>F_{\\\\alpha_{2}}<x>K_{2})}+q^{2}-2+q^{-2} {(F\\n4<x>[ K_{2} ; 1 ]<x>[ K_{2} ; 1 ])}+-q+q^{-1} {(F_{\\\\alpha_{2}}<x>[ K_{2} ; 1 ]<x>K_{2})}+-q+q^{-1} {(F_{\\\\alpha_{2}}<x>K\\n2<x>[ K_{2} ; 1 ])}+1 {(F_{\\\\alpha_{2}}<x>K_{2}<x>K_{2})}']\n```\nand instead of `F_{\\\\alpha_{1}}` at few places it outputs `F\\n1` - probably some unfortunate combination of escape sequences, dunno... (needless to say, the output at the sage prompt is fine).\n\nI'm inclined to mark these as `# known bug` and deal with them later...",
    "created_at": "2018-12-20T14:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398317",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:40'></a>I'm getting an unpleasant surprise from the doctest framework here - it mangles long lines in this file, e.g. here:

```
File "src/sage/algebras/quantum_groups/quantum_group_gap.py", line 757, in sage.algebras.quantum_groups.quantum_group_gap.QuantumGroup.coproduct
Failed example:
    [Q.coproduct(f, 2)._latex_() for f in Q.F_simple()]  # optional - gap_packages
Expected:
    ['1 {(1<x>1<x>F_{\\alpha_{1}})}+-q^{2}+q^{-2} {(1<x>F_{\\alpha_{1}}<x>[ K_{1} ; 1 ])}+1 {(1<x>F_{\\alpha_{1}}<x>K_{1})}+q^{4}-2+q^{-4} {(F_{\\alpha_{1}}<x>[ K_{1} ; 1 ]<x>[ K_{1} ; 1 ])}+-q^{2}+q^{-2} {(F_{\\alpha_{1}}<x>[ K_{1} ; 1 ]<x>K_{1})}+-q^{2}+q^{-2} {(F_{\\alpha_{1}}<x>K_{1}<x>[ K_{1} ; 1 ])}+1 {(F_{\\alpha_{1}}<x>K_{1}<x>K_{1})}',
     '1 {(1<x>1<x>F_{\\alpha_{2}})}+-q+q^{-1} {(1<x>F_{\\alpha_{2}}<x>[ K_{2} ; 1 ])}+1 {(1<x>F_{\\alpha_{2}}<x>K_{2})}+q^{2}-2+q^{-2} {(F_{\\alpha_{2}}<x>[ K_{2} ; 1 ]<x>[ K_{2} ; 1 ])}+-q+q^{-1} {(F_{\\alpha_{2}}<x>[ K_{2} ; 1 ]<x>K_{2})}+-q+q^{-1} {(F_{\\alpha_{2}}<x>K_{2}<x>[ K_{2} ; 1 ])}+1 {(F_{\\alpha_{2}}<x>K_{2}<x>K_{2})}']
Got:
    ['1 {(1<x>1<x>F_{\\alpha_{1}})}+-q^{2}+q^{-2} {(1<x>F_{\\alpha_{1}}<x>[ K_{1} ; 1 ])}+1 {(1<x>F_{\\alpha_{1}}<x>K_{1})}+q^{4}-2+q^{-4} {(F\n1<x>[ K_{1} ; 1 ]<x>[ K_{1} ; 1 ])}+-q^{2}+q^{-2} {(F_{\\alpha_{1}}<x>[ K_{1} ; 1 ]<x>K_{1})}+-q^{2}+q^{-2} {(F\n1<x>K_{1}<x>[ K_{1} ; 1 ])}+1 {(F_{\\alpha_{1}}<x>K_{1}<x>K_{1})}',
     '1 {(1<x>1<x>F_{\\alpha_{2}})}+-q+q^{-1} {(1<x>F_{\\alpha_{2}}<x>[ K_{2} ; 1 ])}+1 {(1<x>F_{\\alpha_{2}}<x>K_{2})}+q^{2}-2+q^{-2} {(F\n4<x>[ K_{2} ; 1 ]<x>[ K_{2} ; 1 ])}+-q+q^{-1} {(F_{\\alpha_{2}}<x>[ K_{2} ; 1 ]<x>K_{2})}+-q+q^{-1} {(F_{\\alpha_{2}}<x>K\n2<x>[ K_{2} ; 1 ])}+1 {(F_{\\alpha_{2}}<x>K_{2}<x>K_{2})}']
```
and instead of `F_{\\alpha_{1}}` at few places it outputs `F\n1` - probably some unfortunate combination of escape sequences, dunno... (needless to say, the output at the sage prompt is fine).

I'm inclined to mark these as `# known bug` and deal with them later...



---

archive/issue_comments_398318.json:
```json
{
    "body": "<a id='comment:41'></a>In the case of the \"grape\" package, ISTM the only actual \"compiled\" part is not technically part of the package at all, but rather it builds its own copy of nauty.  It ought to be able to use the nauty that's already included in Sage.\n\nI probably won't stress about it too much in the short time that we have, but this should probably be fixed later.",
    "created_at": "2018-12-20T14:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398318",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>In the case of the "grape" package, ISTM the only actual "compiled" part is not technically part of the package at all, but rather it builds its own copy of nauty.  It ought to be able to use the nauty that's already included in Sage.

I probably won't stress about it too much in the short time that we have, but this should probably be fixed later.



---

archive/issue_comments_398319.json:
```json
{
    "body": "<a id='comment:42'></a>I agree about nauty/grape - see #26923",
    "created_at": "2018-12-20T14:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398319",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>I agree about nauty/grape - see #26923



---

archive/issue_comments_398320.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:40 dimpase]:\n> I'm getting an unpleasant surprise from the doctest framework here - it mangles long lines in this file, e.g. here:\n> and instead of `F_{\\\\alpha_{1}}` at few places it outputs `F\\n1` - probably some unfortunate combination of escape sequences, dunno... (needless to say, the output at the sage prompt is fine).\n\n\nI'm not so sure about that.  I don't think the doctest framework is doing that, but I'll look into it later.",
    "created_at": "2018-12-20T14:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398320",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>Replying to [comment:40 dimpase]:
> I'm getting an unpleasant surprise from the doctest framework here - it mangles long lines in this file, e.g. here:
> and instead of `F_{\\alpha_{1}}` at few places it outputs `F\n1` - probably some unfortunate combination of escape sequences, dunno... (needless to say, the output at the sage prompt is fine).


I'm not so sure about that.  I don't think the doctest framework is doing that, but I'll look into it later.



---

archive/issue_comments_398321.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [comment:43 embray]:\n> Replying to [comment:40 dimpase]:\n> > I'm getting an unpleasant surprise from the doctest framework here - it mangles long lines in this file, e.g. here:\n> > and instead of `F_{\\\\alpha_{1}}` at few places it outputs `F\\n1` - probably some unfortunate combination of escape sequences, dunno... (needless to say, the output at the sage prompt is fine).\n\n> \n> I'm not so sure about that.  I don't think the doctest framework is doing that, but I'll look into it later.\n\n\nMight be a \"noisy line\" thing - but why only while doctesting? Anyhow I have opened #26924 to deal with it.",
    "created_at": "2018-12-20T14:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398321",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>Replying to [comment:43 embray]:
> Replying to [comment:40 dimpase]:
> > I'm getting an unpleasant surprise from the doctest framework here - it mangles long lines in this file, e.g. here:
> > and instead of `F_{\\alpha_{1}}` at few places it outputs `F\n1` - probably some unfortunate combination of escape sequences, dunno... (needless to say, the output at the sage prompt is fine).

> 
> I'm not so sure about that.  I don't think the doctest framework is doing that, but I'll look into it later.


Might be a "noisy line" thing - but why only while doctesting? Anyhow I have opened #26924 to deal with it.



---

archive/issue_comments_398322.json:
```json
{
    "body": "<a id='comment:45'></a>I'm running the tests for some of these packages.  A bunch of tests fail for guava: I'm not sure whether or not this is expected.",
    "created_at": "2018-12-20T14:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398322",
    "user": "https://github.com/embray"
}
```

<a id='comment:45'></a>I'm running the tests for some of these packages.  A bunch of tests fail for guava: I'm not sure whether or not this is expected.



---

archive/issue_comments_398323.json:
```json
{
    "body": "<a id='comment:46'></a>A new failure I'm getting is:\n\n```\nFile \"src/sage/graphs/strongly_regular_db.pyx\", line 2445, in sage.graphs.strongly_regular_db.SRG_416_100_36_20\nFailed example:\n    g = SRG_416_100_36_20()                # optional - gap_packages # long time\nExpected nothing\nGot:\n    #I  io package is not available. Check that the name is correct\n    #I  and it is present in one of the GAP root directories (see '??RootPaths')\n    #I  io package is not available. Check that the name is correct\n    #I  and it is present in one of the GAP root directories (see '??RootPaths')\n**********************************************************************\n1 item had failures:\n   1 of   4 in sage.graphs.strongly_regular_db.SRG_416_100_36_20\n    [334 tests, 1 failure, 61.16 s]\n```\n\nSo perhaps one of these packages at least tries to load the IO package if available, though doesn't strictly need it.  In that case we should at least be silencing this message.",
    "created_at": "2018-12-20T14:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398323",
    "user": "https://github.com/embray"
}
```

<a id='comment:46'></a>A new failure I'm getting is:

```
File "src/sage/graphs/strongly_regular_db.pyx", line 2445, in sage.graphs.strongly_regular_db.SRG_416_100_36_20
Failed example:
    g = SRG_416_100_36_20()                # optional - gap_packages # long time
Expected nothing
Got:
    #I  io package is not available. Check that the name is correct
    #I  and it is present in one of the GAP root directories (see '??RootPaths')
    #I  io package is not available. Check that the name is correct
    #I  and it is present in one of the GAP root directories (see '??RootPaths')
**********************************************************************
1 item had failures:
   1 of   4 in sage.graphs.strongly_regular_db.SRG_416_100_36_20
    [334 tests, 1 failure, 61.16 s]
```

So perhaps one of these packages at least tries to load the IO package if available, though doesn't strictly need it.  In that case we should at least be silencing this message.



---

archive/issue_comments_398324.json:
```json
{
    "body": "<a id='comment:47'></a>Another one that's a bit troubling is:\n\n```\nsage -t --long src/sage/tests/gap_packages.py\n**********************************************************************\nFile \"src/sage/tests/gap_packages.py\", line 8, in sage.tests.gap_packages\nFailed example:\n    test_packages(pkgs, only_failures=True)    # optional - gap_packages\nExpected:\n      Status   Package   GAP Output\n    +--------+---------+------------+\nGot:\n    #I  polymake command not found. Please set POLYMAKE_COMMAND by hand\n    #I  HAP warning: Set POLYMAKE_PATH manually if needed.\n    #I  HAP warning: Set BROWSER_PATH manually if needed.\n    #I  HAP warning: Set ASY_PATH manually if needed.\n    #I  You may wish to install the xgap package\n    #I  and enjoy the graphic capabilities of SONATA.\n    #I  qpa-version package is not available. Check that the name is correct\n    #I  and it is present in one of the GAP root directories (see '??RootPaths')\n      Status    Package       GAP Output\n    +---------+-------------+------------+\n      Failure   polenta       fail\n      Failure   qpa-version   fail\n      Failure   resclasses    fail\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.tests.gap_packages\n    [10 tests, 1 failure, 3.98 s]\n```\n\nI get these warnings when loading the relevant GAP packages in a vanilla GAP source tree, so I suppose they're normal and/or expected, or at least not indicative of any specific bug on our part.  But we probably need to at least temporarily silence them for the purposes of the code and tests they affect.\n\nThe one exception being the error about \"qpa-version\".  The name of the package is just \"qpa\", but its source directory is unusually named \"qpa-version-<x.y>\", so there's some code that's making an invalid assumption about GAP package names :sigh:",
    "created_at": "2018-12-20T14:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398324",
    "user": "https://github.com/embray"
}
```

<a id='comment:47'></a>Another one that's a bit troubling is:

```
sage -t --long src/sage/tests/gap_packages.py
**********************************************************************
File "src/sage/tests/gap_packages.py", line 8, in sage.tests.gap_packages
Failed example:
    test_packages(pkgs, only_failures=True)    # optional - gap_packages
Expected:
      Status   Package   GAP Output
    +--------+---------+------------+
Got:
    #I  polymake command not found. Please set POLYMAKE_COMMAND by hand
    #I  HAP warning: Set POLYMAKE_PATH manually if needed.
    #I  HAP warning: Set BROWSER_PATH manually if needed.
    #I  HAP warning: Set ASY_PATH manually if needed.
    #I  You may wish to install the xgap package
    #I  and enjoy the graphic capabilities of SONATA.
    #I  qpa-version package is not available. Check that the name is correct
    #I  and it is present in one of the GAP root directories (see '??RootPaths')
      Status    Package       GAP Output
    +---------+-------------+------------+
      Failure   polenta       fail
      Failure   qpa-version   fail
      Failure   resclasses    fail
**********************************************************************
1 item had failures:
   1 of   5 in sage.tests.gap_packages
    [10 tests, 1 failure, 3.98 s]
```

I get these warnings when loading the relevant GAP packages in a vanilla GAP source tree, so I suppose they're normal and/or expected, or at least not indicative of any specific bug on our part.  But we probably need to at least temporarily silence them for the purposes of the code and tests they affect.

The one exception being the error about "qpa-version".  The name of the package is just "qpa", but its source directory is unusually named "qpa-version-<x.y>", so there's some code that's making an invalid assumption about GAP package names :sigh:



---

archive/issue_comments_398325.json:
```json
{
    "body": "<a id='comment:48'></a>Replying to [comment:46 embray]:\n> A new failure I'm getting is:\n> \n> \n> ```\n> File \"src/sage/graphs/strongly_regular_db.pyx\", line 2445, in sage.graphs.strongly_regular_db.SRG_416_100_36_20\n> Failed example:\n>     g = SRG_416_100_36_20()                # optional - gap_packages # long time\n> Expected nothing\n> Got:\n>     #I  io package is not available. Check that the name is correct\n>     #I  and it is present in one of the GAP root directories (see '??RootPaths')\n>     #I  io package is not available. Check that the name is correct\n>     #I  and it is present in one of the GAP root directories (see '??RootPaths')\n> **********************************************************************\n> 1 item had failures:\n>    1 of   4 in sage.graphs.strongly_regular_db.SRG_416_100_36_20\n>     [334 tests, 1 failure, 61.16 s]\n> ```\n> \n> So perhaps one of these packages at least tries to load the IO package if available, though doesn't strictly need it.  In that case we should at least be silencing this message.\n\n\nYes, atlasrep does this.\nHowever, you might have a stale libgap workspace. I saw this warning, and then went away after I wiped the workspaces out.",
    "created_at": "2018-12-20T14:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398325",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>Replying to [comment:46 embray]:
> A new failure I'm getting is:
> 
> 
> ```
> File "src/sage/graphs/strongly_regular_db.pyx", line 2445, in sage.graphs.strongly_regular_db.SRG_416_100_36_20
> Failed example:
>     g = SRG_416_100_36_20()                # optional - gap_packages # long time
> Expected nothing
> Got:
>     #I  io package is not available. Check that the name is correct
>     #I  and it is present in one of the GAP root directories (see '??RootPaths')
>     #I  io package is not available. Check that the name is correct
>     #I  and it is present in one of the GAP root directories (see '??RootPaths')
> **********************************************************************
> 1 item had failures:
>    1 of   4 in sage.graphs.strongly_regular_db.SRG_416_100_36_20
>     [334 tests, 1 failure, 61.16 s]
> ```
> 
> So perhaps one of these packages at least tries to load the IO package if available, though doesn't strictly need it.  In that case we should at least be silencing this message.


Yes, atlasrep does this.
However, you might have a stale libgap workspace. I saw this warning, and then went away after I wiped the workspaces out.



---

archive/issue_comments_398326.json:
```json
{
    "body": "<a id='comment:49'></a>Replying to [comment:47 embray]:\n> Another one that's a bit troubling is:\n> \n> \n> ```\n> sage -t --long src/sage/tests/gap_packages.py\n> **********************************************************************\n> File \"src/sage/tests/gap_packages.py\", line 8, in sage.tests.gap_packages\n> Failed example:\n>     test_packages(pkgs, only_failures=True)    # optional - gap_packages\n> Expected:\n>       Status   Package   GAP Output\n>     +--------+---------+------------+\n> Got:\n>     #I  polymake command not found. Please set POLYMAKE_COMMAND by hand\n>     #I  HAP warning: Set POLYMAKE_PATH manually if needed.\n>     #I  HAP warning: Set BROWSER_PATH manually if needed.\n>     #I  HAP warning: Set ASY_PATH manually if needed.\n>     #I  You may wish to install the xgap package\n>     #I  and enjoy the graphic capabilities of SONATA.\n>     #I  qpa-version package is not available. Check that the name is correct\n>     #I  and it is present in one of the GAP root directories (see '??RootPaths')\n>       Status    Package       GAP Output\n>     +---------+-------------+------------+\n>       Failure   polenta       fail\n>       Failure   qpa-version   fail\n>       Failure   resclasses    fail\n> **********************************************************************\n> 1 item had failures:\n>    1 of   5 in sage.tests.gap_packages\n>     [10 tests, 1 failure, 3.98 s]\n> ```\n> \n> I get these warnings when loading the relevant GAP packages in a vanilla GAP source tree, so I suppose they're normal and/or expected, or at least not indicative of any specific bug on our part.  But we probably need to at least temporarily silence them for the purposes of the code and tests they affect.\n> \n> The one exception being the error about \"qpa-version\".  The name of the package is just \"qpa\", but its source directory is unusually named \"qpa-version-<x.y>\", so there's some code that's making an invalid assumption about GAP package names :sigh:\n\n\nYes, that's where I am now too. I'll need to step away for an hour, I'll push what I have in a second.",
    "created_at": "2018-12-20T15:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398326",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:49'></a>Replying to [comment:47 embray]:
> Another one that's a bit troubling is:
> 
> 
> ```
> sage -t --long src/sage/tests/gap_packages.py
> **********************************************************************
> File "src/sage/tests/gap_packages.py", line 8, in sage.tests.gap_packages
> Failed example:
>     test_packages(pkgs, only_failures=True)    # optional - gap_packages
> Expected:
>       Status   Package   GAP Output
>     +--------+---------+------------+
> Got:
>     #I  polymake command not found. Please set POLYMAKE_COMMAND by hand
>     #I  HAP warning: Set POLYMAKE_PATH manually if needed.
>     #I  HAP warning: Set BROWSER_PATH manually if needed.
>     #I  HAP warning: Set ASY_PATH manually if needed.
>     #I  You may wish to install the xgap package
>     #I  and enjoy the graphic capabilities of SONATA.
>     #I  qpa-version package is not available. Check that the name is correct
>     #I  and it is present in one of the GAP root directories (see '??RootPaths')
>       Status    Package       GAP Output
>     +---------+-------------+------------+
>       Failure   polenta       fail
>       Failure   qpa-version   fail
>       Failure   resclasses    fail
> **********************************************************************
> 1 item had failures:
>    1 of   5 in sage.tests.gap_packages
>     [10 tests, 1 failure, 3.98 s]
> ```
> 
> I get these warnings when loading the relevant GAP packages in a vanilla GAP source tree, so I suppose they're normal and/or expected, or at least not indicative of any specific bug on our part.  But we probably need to at least temporarily silence them for the purposes of the code and tests they affect.
> 
> The one exception being the error about "qpa-version".  The name of the package is just "qpa", but its source directory is unusually named "qpa-version-<x.y>", so there's some code that's making an invalid assumption about GAP package names :sigh:


Yes, that's where I am now too. I'll need to step away for an hour, I'll push what I have in a second.



---

archive/issue_comments_398327.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-20T15:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398327",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398328.json:
```json
{
    "body": "<a id='comment:51'></a>OK, over to you now.",
    "created_at": "2018-12-20T15:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398328",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'></a>OK, over to you now.



---

archive/issue_comments_398329.json:
```json
{
    "body": "<a id='comment:52'></a>I think this change\n\n```diff\ndiff --git a/src/sage/algebras/quantum_groups/quantum_group_gap.py b/src/sage/algebras/quantum_groups/quantum_group_gap.py\nindex 4ce98f4..0e4549b 100644\n--- a/src/sage/algebras/quantum_groups/quantum_group_gap.py\n+++ b/src/sage/algebras/quantum_groups/quantum_group_gap.py\n@@ -1566,8 +1564,8 @@ class QuantumGroupModule(Parent, UniqueRepresentation):\n             sage: Q = QuantumGroup(['A',2])           # optional - gap_packages\n             sage: V = Q.highest_weight_module([1,1])  # optional - gap_packages\n             sage: V.gap()                             # optional - gap_packages\n-            <8-dimensional left-module over QuantumUEA( <root system of type A2>,\n-             Qpar = q )>\n+            <8-dimensional left-module over QuantumUEA( <root system of type A\n+            2>, Qpar = q )>\n         \"\"\"\n         return self._libgap\n```\n\nThis one feels like a bug in the GAP and/or the QuaGroup package to me, but I confirmed that this is in fact the output provided by GAP and not a bug on our end, so for the time being there's nothing to be done (other than possibly report it upstream)\n\nThis is one of the problems with GAP objects not having a real string representation that isn't tied to how exactly they're printed to the screen :|",
    "created_at": "2018-12-20T15:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398329",
    "user": "https://github.com/embray"
}
```

<a id='comment:52'></a>I think this change

```diff
diff --git a/src/sage/algebras/quantum_groups/quantum_group_gap.py b/src/sage/algebras/quantum_groups/quantum_group_gap.py
index 4ce98f4..0e4549b 100644
--- a/src/sage/algebras/quantum_groups/quantum_group_gap.py
+++ b/src/sage/algebras/quantum_groups/quantum_group_gap.py
@@ -1566,8 +1564,8 @@ class QuantumGroupModule(Parent, UniqueRepresentation):
             sage: Q = QuantumGroup(['A',2])           # optional - gap_packages
             sage: V = Q.highest_weight_module([1,1])  # optional - gap_packages
             sage: V.gap()                             # optional - gap_packages
-            <8-dimensional left-module over QuantumUEA( <root system of type A2>,
-             Qpar = q )>
+            <8-dimensional left-module over QuantumUEA( <root system of type A
+            2>, Qpar = q )>
         """
         return self._libgap
```

This one feels like a bug in the GAP and/or the QuaGroup package to me, but I confirmed that this is in fact the output provided by GAP and not a bug on our end, so for the time being there's nothing to be done (other than possibly report it upstream)

This is one of the problems with GAP objects not having a real string representation that isn't tied to how exactly they're printed to the screen :|



---

archive/issue_comments_398330.json:
```json
{
    "body": "<a id='comment:53'></a>The problem here, accounting for all these test failures including the test above that was modified, is that the QuaGroups package seems (I have not looked for the exact code) to insert linebreaks into the representations of its types in different places depending on the terminal width.  Not exactly sure if that's a GAP thing in general or something specific to this package, but this is the first place it's come up.  In any case we apparently aren't dealing well with those unnecessary line breaks.",
    "created_at": "2018-12-20T15:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398330",
    "user": "https://github.com/embray"
}
```

<a id='comment:53'></a>The problem here, accounting for all these test failures including the test above that was modified, is that the QuaGroups package seems (I have not looked for the exact code) to insert linebreaks into the representations of its types in different places depending on the terminal width.  Not exactly sure if that's a GAP thing in general or something specific to this package, but this is the first place it's come up.  In any case we apparently aren't dealing well with those unnecessary line breaks.



---

archive/issue_comments_398331.json:
```json
{
    "body": "<a id='comment:54'></a>linebreaks are inserted by GAP, it was always the case.",
    "created_at": "2018-12-20T15:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398331",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:54'></a>linebreaks are inserted by GAP, it was always the case.



---

archive/issue_comments_398332.json:
```json
{
    "body": "<a id='comment:55'></a>I see now, the output splitting is indeed done by default by GAP.  Again, this is no good, especially since it can depend on terminal width.  I haven't found yet exactly where GAP determines this, but I need to figure out a way to force it to just not do this at all, if possible.  That might be something to do as part of #22626 or as a follow-up.",
    "created_at": "2018-12-20T16:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398332",
    "user": "https://github.com/embray"
}
```

<a id='comment:55'></a>I see now, the output splitting is indeed done by default by GAP.  Again, this is no good, especially since it can depend on terminal width.  I haven't found yet exactly where GAP determines this, but I need to figure out a way to force it to just not do this at all, if possible.  That might be something to do as part of #22626 or as a follow-up.



---

archive/issue_comments_398333.json:
```json
{
    "body": "<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T00:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398333",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398334.json:
```json
{
    "body": "<a id='comment:57'></a>Replying to [comment:47 embray]:\n> Another one that's a bit troubling is:\n> \n> \n> ```\n> sage -t --long src/sage/tests/gap_packages.py\n> [.....]\n>      +---------+-------------+------------+\n>       Failure   polenta       fail\n>       Failure   qpa-version   fail\n>       Failure   resclasses    fail\n> **********************************************************************\n> 1 item had failures:\n>    1 of   5 in sage.tests.gap_packages\n>     [10 tests, 1 failure, 3.98 s]\n> ```\n> \n> I get these warnings when loading the relevant GAP packages in a vanilla GAP source tree, so I suppose they're normal and/or expected, or at least not indicative of any specific bug on our part.  But we probably need to at least temporarily silence them for the purposes of the code and tests they affect.\n\n\n> The one exception being the error about \"qpa-version\".  The name of the package is just \"qpa\", but its source directory is unusually named \"qpa-version-<x.y>\", so there's some code that's making an invalid assumption about GAP package names :sigh:\n\n\nthe latest commit fixes these failures, which are two-fold:\nmissing dependencies and weird `-version`-part which one should strip.\n\nI should still figure out how to suppress these `#I ...` lines...",
    "created_at": "2018-12-21T00:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398334",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:57'></a>Replying to [comment:47 embray]:
> Another one that's a bit troubling is:
> 
> 
> ```
> sage -t --long src/sage/tests/gap_packages.py
> [.....]
>      +---------+-------------+------------+
>       Failure   polenta       fail
>       Failure   qpa-version   fail
>       Failure   resclasses    fail
> **********************************************************************
> 1 item had failures:
>    1 of   5 in sage.tests.gap_packages
>     [10 tests, 1 failure, 3.98 s]
> ```
> 
> I get these warnings when loading the relevant GAP packages in a vanilla GAP source tree, so I suppose they're normal and/or expected, or at least not indicative of any specific bug on our part.  But we probably need to at least temporarily silence them for the purposes of the code and tests they affect.


> The one exception being the error about "qpa-version".  The name of the package is just "qpa", but its source directory is unusually named "qpa-version-<x.y>", so there's some code that's making an invalid assumption about GAP package names :sigh:


the latest commit fixes these failures, which are two-fold:
missing dependencies and weird `-version`-part which one should strip.

I should still figure out how to suppress these `#I ...` lines...



---

archive/issue_comments_398335.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T01:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398335",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398336.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T10:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398336",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398337.json:
```json
{
    "body": "<a id='comment:60'></a>By the way, I tried installing IO package in the same way as this ticket builds packages needing compilation, but this fails due to a \"missing\" header (not sure what goes wrong):\n\n```\n[gap_packages-4.10.0] configure: creating ./config.status\n[gap_packages-4.10.0] config.status: creating Makefile\n[gap_packages-4.10.0] config.status: creating src/pkgconfig.h\n[gap_packages-4.10.0] config.status: executing depfiles commands\n[gap_packages-4.10.0] config.status: executing libtool commands\n[gap_packages-4.10.0] make[2]: Entering directory '/mnt/opt/Sage/sage-dev/local/share/gap/pkg/io-4.5.4'\n[gap_packages-4.10.0] /bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I./src  -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include        -O2 -g   -g -O2 -MT src/io_la-io.lo -MD -MP -MF src/.deps/io_la-io.Tpo -c -o src/io_la-io.lo `test -f 'src/io.c' || echo './'`src/io.c\n[gap_packages-4.10.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I./src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include -O2 -g -g -O2 -MT src/io_la-io.lo -MD -MP -MF src/.deps/io_la-io.Tpo -c src/io.c  -fPIC -DPIC -o src/.libs/io_la-io.o\n[gap_packages-4.10.0] src/io.c:14:10: fatal error: src/compiled.h: No such file or directory\n[gap_packages-4.10.0]  #include \"src/compiled.h\"          /* GAP headers                */\n[gap_packages-4.10.0]           ^~~~~~~~~~~~~~~~\n```\nlooks like the corresponding `-I` arguments all have an extra `/src` suffix, something that prevents this header to be found.",
    "created_at": "2018-12-21T10:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398337",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:60'></a>By the way, I tried installing IO package in the same way as this ticket builds packages needing compilation, but this fails due to a "missing" header (not sure what goes wrong):

```
[gap_packages-4.10.0] configure: creating ./config.status
[gap_packages-4.10.0] config.status: creating Makefile
[gap_packages-4.10.0] config.status: creating src/pkgconfig.h
[gap_packages-4.10.0] config.status: executing depfiles commands
[gap_packages-4.10.0] config.status: executing libtool commands
[gap_packages-4.10.0] make[2]: Entering directory '/mnt/opt/Sage/sage-dev/local/share/gap/pkg/io-4.5.4'
[gap_packages-4.10.0] /bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I./src  -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include        -O2 -g   -g -O2 -MT src/io_la-io.lo -MD -MP -MF src/.deps/io_la-io.Tpo -c -o src/io_la-io.lo `test -f 'src/io.c' || echo './'`src/io.c
[gap_packages-4.10.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I./src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include -O2 -g -g -O2 -MT src/io_la-io.lo -MD -MP -MF src/.deps/io_la-io.Tpo -c src/io.c  -fPIC -DPIC -o src/.libs/io_la-io.o
[gap_packages-4.10.0] src/io.c:14:10: fatal error: src/compiled.h: No such file or directory
[gap_packages-4.10.0]  #include "src/compiled.h"          /* GAP headers                */
[gap_packages-4.10.0]           ^~~~~~~~~~~~~~~~
```
looks like the corresponding `-I` arguments all have an extra `/src` suffix, something that prevents this header to be found.



---

archive/issue_comments_398338.json:
```json
{
    "body": "<a id='comment:61'></a>...\"thanks\" to Gatwick drone operators, I can do this work now, and not sit on a plane off to Singapore...",
    "created_at": "2018-12-21T10:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398338",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:61'></a>..."thanks" to Gatwick drone operators, I can do this work now, and not sit on a plane off to Singapore...



---

archive/issue_comments_398339.json:
```json
{
    "body": "<a id='comment:62'></a>GAP's IO is on #26930",
    "created_at": "2018-12-21T11:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398339",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:62'></a>GAP's IO is on #26930



---

archive/issue_comments_398340.json:
```json
{
    "body": "<a id='comment:63'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T12:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398340",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:63'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398341.json:
```json
{
    "body": "<a id='comment:64'></a>OK, seems to be ready now",
    "created_at": "2018-12-21T12:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398341",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:64'></a>OK, seems to be ready now



---

archive/issue_comments_398342.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-21T12:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398342",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_398343.json:
```json
{
    "body": "<a id='comment:65'></a>\n```diff\n\ndiff --git a/src/sage/graphs/strongly_regular_db.pyx b/src/sage/graphs/strongly_regular_db.pyx\nindex 8df9bf5..06a0780 100644\n--- a/src/sage/graphs/strongly_regular_db.pyx\n+++ b/src/sage/graphs/strongly_regular_db.pyx\n@@ -2442,7 +2442,9 @@ def SRG_416_100_36_20():\n     EXAMPLES::\n \n         sage: from sage.graphs.strongly_regular_db import SRG_416_100_36_20\n+        sage: libgap.eval(\"SetInfoLevel(InfoWarning,0)\") # silence #I warnings\n         sage: g = SRG_416_100_36_20()                # optional - gap_packages # long time\n+        sage: libgap.eval(\"SetInfoLevel(InfoWarning,1)\") # silence #I warnings\n         sage: g.is_strongly_regular(parameters=True) # optional - gap_packages # long time\n         (416, 100, 36, 20)\n     \"\"\"\n```\n\nI don't like that this is done in the doctest; it distracts from the actual documentation.  I think this should go in the function itself.  We've already seen the warning in question, decided it is not important to us, and can go ahead and silence it.",
    "created_at": "2018-12-21T13:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398343",
    "user": "https://github.com/embray"
}
```

<a id='comment:65'></a>
```diff

diff --git a/src/sage/graphs/strongly_regular_db.pyx b/src/sage/graphs/strongly_regular_db.pyx
index 8df9bf5..06a0780 100644
--- a/src/sage/graphs/strongly_regular_db.pyx
+++ b/src/sage/graphs/strongly_regular_db.pyx
@@ -2442,7 +2442,9 @@ def SRG_416_100_36_20():
     EXAMPLES::
 
         sage: from sage.graphs.strongly_regular_db import SRG_416_100_36_20
+        sage: libgap.eval("SetInfoLevel(InfoWarning,0)") # silence #I warnings
         sage: g = SRG_416_100_36_20()                # optional - gap_packages # long time
+        sage: libgap.eval("SetInfoLevel(InfoWarning,1)") # silence #I warnings
         sage: g.is_strongly_regular(parameters=True) # optional - gap_packages # long time
         (416, 100, 36, 20)
     """
```

I don't like that this is done in the doctest; it distracts from the actual documentation.  I think this should go in the function itself.  We've already seen the warning in question, decided it is not important to us, and can go ahead and silence it.



---

archive/issue_comments_398344.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:59 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                    |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n> |[08ffb33](https://git.sagemath.org/sage.git/commit/?id=08ffb3396308b4643cfcbed1c56c0272c39f6a17)|`more doctest fixes`|\n\n\nThis change doesn't seem to work for me.  Those tests passed before this commit, and fail after.  I tried clearing my existing workspaces but it still fails.  That's troubling--it may still be some badly managed random state somewhere.  Unless I'm missing something else.",
    "created_at": "2018-12-21T14:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398344",
    "user": "https://github.com/embray"
}
```

<a id='comment:66'></a>Replying to [comment:59 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                    |
> |-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
> |[08ffb33](https://git.sagemath.org/sage.git/commit/?id=08ffb3396308b4643cfcbed1c56c0272c39f6a17)|`more doctest fixes`|


This change doesn't seem to work for me.  Those tests passed before this commit, and fail after.  I tried clearing my existing workspaces but it still fails.  That's troubling--it may still be some badly managed random state somewhere.  Unless I'm missing something else.



---

archive/issue_comments_398345.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:61 dimpase]:\n> ...\"thanks\" to Gatwick drone operators, I can do this work now, and not sit on a plane off to Singapore...\n\n\nHuh?? What happened?  :(",
    "created_at": "2018-12-21T14:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398345",
    "user": "https://github.com/embray"
}
```

<a id='comment:67'></a>Replying to [comment:61 dimpase]:
> ..."thanks" to Gatwick drone operators, I can do this work now, and not sit on a plane off to Singapore...


Huh?? What happened?  :(



---

archive/issue_comments_398346.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [comment:67 embray]:\n> Replying to [comment:61 dimpase]:\n> > ...\"thanks\" to Gatwick drone operators, I can do this work now, and not sit on a plane off to Singapore...\n\n> \n> Huh?? What happened?  :(\n\nLucky you, you don't read news. :-)\nGatwick was shut down for ~36 hours due to some not yet caught folks flying a largish drone over it several times, 700+ flights cancelled, 100s diverted. We were able to book an even cheaper flight, via Berlin, and get a full refund. They are open since this morning, and in fact the airline rebooked us for tonight, but we were in the full panic mode and got the other flight already...",
    "created_at": "2018-12-21T14:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398346",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:68'></a>Replying to [comment:67 embray]:
> Replying to [comment:61 dimpase]:
> > ..."thanks" to Gatwick drone operators, I can do this work now, and not sit on a plane off to Singapore...

> 
> Huh?? What happened?  :(

Lucky you, you don't read news. :-)
Gatwick was shut down for ~36 hours due to some not yet caught folks flying a largish drone over it several times, 700+ flights cancelled, 100s diverted. We were able to book an even cheaper flight, via Berlin, and get a full refund. They are open since this morning, and in fact the airline rebooked us for tonight, but we were in the full panic mode and got the other flight already...



---

archive/issue_comments_398347.json:
```json
{
    "body": "<a id='comment:69'></a>Replying to [comment:66 embray]:\n> Replying to [comment:59 git]:\n> > Branch pushed to git repo; I updated commit sha1. New commits:\n> > |                                                                                                                                           |                    |\n> > |-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n> > |[08ffb33](https://git.sagemath.org/sage.git/commit/?id=08ffb3396308b4643cfcbed1c56c0272c39f6a17)|`more doctest fixes`|\n\n> \n> This change doesn't seem to work for me.  Those tests passed before this commit, and fail after.  I tried clearing my existing workspaces but it still fails.  That's troubling--it may still be some badly managed random state somewhere.  Unless I'm missing something else.\n\n\nthey pass for me, both with and without `--long`, on Linux and on OSX.\n\nI'd try `rm -rf local/share/gap local/include/gap` followed by `./sage -f gap gap_packages` followed up by `make build`, and then testing...\n\n(and wiping out `~/.sage/gap/` too)",
    "created_at": "2018-12-21T14:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398347",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:69'></a>Replying to [comment:66 embray]:
> Replying to [comment:59 git]:
> > Branch pushed to git repo; I updated commit sha1. New commits:
> > |                                                                                                                                           |                    |
> > |-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
> > |[08ffb33](https://git.sagemath.org/sage.git/commit/?id=08ffb3396308b4643cfcbed1c56c0272c39f6a17)|`more doctest fixes`|

> 
> This change doesn't seem to work for me.  Those tests passed before this commit, and fail after.  I tried clearing my existing workspaces but it still fails.  That's troubling--it may still be some badly managed random state somewhere.  Unless I'm missing something else.


they pass for me, both with and without `--long`, on Linux and on OSX.

I'd try `rm -rf local/share/gap local/include/gap` followed by `./sage -f gap gap_packages` followed up by `make build`, and then testing...

(and wiping out `~/.sage/gap/` too)



---

archive/issue_comments_398348.json:
```json
{
    "body": "<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T14:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398348",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398349.json:
```json
{
    "body": "<a id='comment:71'></a>Replying to [comment:70 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                       |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n> |[1e5f679](https://git.sagemath.org/sage.git/commit/?id=1e5f679c41a7b27088ed330f986df91d03099a71)|`move silencing into the function body`|\n\n\nthis addresses comment 65.",
    "created_at": "2018-12-21T14:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398349",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:71'></a>Replying to [comment:70 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                       |
> |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
> |[1e5f679](https://git.sagemath.org/sage.git/commit/?id=1e5f679c41a7b27088ed330f986df91d03099a71)|`move silencing into the function body`|


this addresses comment 65.



---

archive/issue_comments_398350.json:
```json
{
    "body": "<a id='comment:72'></a>Replying to [comment:66 embray]:\n> Replying to [comment:59 git]:\n> > Branch pushed to git repo; I updated commit sha1. New commits:\n> > |                                                                                                                                           |                    |\n> > |-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n> > |[08ffb33](https://git.sagemath.org/sage.git/commit/?id=08ffb3396308b4643cfcbed1c56c0272c39f6a17)|`more doctest fixes`|\n\n> \n> This change doesn't seem to work for me.  Those tests passed before this commit, and fail after.  I tried clearing my existing workspaces but it still fails.  That's troubling--it may still be some badly managed random state somewhere.  Unless I'm missing something else.\n\n\nNevermind, that was my fault.  Nevertheless, this still won't work: The outcomes of these tests depend on whether or not `gap_packages` is installed, so if it isn't then these will give different results.  I'm not sure what to do: Maybe these tests should be rewritten to be more flexible, or the code that's being tested needs to be rewritten to be less sensitive to what GAP packages are installed (if that's even possible...)",
    "created_at": "2018-12-21T14:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398350",
    "user": "https://github.com/embray"
}
```

<a id='comment:72'></a>Replying to [comment:66 embray]:
> Replying to [comment:59 git]:
> > Branch pushed to git repo; I updated commit sha1. New commits:
> > |                                                                                                                                           |                    |
> > |-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
> > |[08ffb33](https://git.sagemath.org/sage.git/commit/?id=08ffb3396308b4643cfcbed1c56c0272c39f6a17)|`more doctest fixes`|

> 
> This change doesn't seem to work for me.  Those tests passed before this commit, and fail after.  I tried clearing my existing workspaces but it still fails.  That's troubling--it may still be some badly managed random state somewhere.  Unless I'm missing something else.


Nevermind, that was my fault.  Nevertheless, this still won't work: The outcomes of these tests depend on whether or not `gap_packages` is installed, so if it isn't then these will give different results.  I'm not sure what to do: Maybe these tests should be rewritten to be more flexible, or the code that's being tested needs to be rewritten to be less sensitive to what GAP packages are installed (if that's even possible...)



---

archive/issue_comments_398351.json:
```json
{
    "body": "<a id='comment:73'></a>Let's just make gap_packages standard, as planned anyway. This will alleviate this problem.",
    "created_at": "2018-12-21T15:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398351",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:73'></a>Let's just make gap_packages standard, as planned anyway. This will alleviate this problem.



---

archive/issue_comments_398352.json:
```json
{
    "body": "<a id='comment:74'></a>I don't think we should do that.  It's bad enough that we're adding all the \"default\" packages, but that does seem defensible.\n\nOtherwise there's no point in even having a separate spkg.\n\nMeanwhile, I don't like that merely having some random package installed can cause actually different (even if not substantively) results, in ways that are very difficult to trace.  This is a really annoying problem with GAP...",
    "created_at": "2018-12-21T15:17:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398352",
    "user": "https://github.com/embray"
}
```

<a id='comment:74'></a>I don't think we should do that.  It's bad enough that we're adding all the "default" packages, but that does seem defensible.

Otherwise there's no point in even having a separate spkg.

Meanwhile, I don't like that merely having some random package installed can cause actually different (even if not substantively) results, in ways that are very difficult to trace.  This is a really annoying problem with GAP...



---

archive/issue_comments_398353.json:
```json
{
    "body": "<a id='comment:75'></a>Let's see... For the test that's failing in `sage.libs.gap.element` it should suffice to just put ellipses after `ValueError: libGAP: Error, no method found!`.  That's the only part that's important; the rest are details.\n\nThe other two look like they might result from different PRNG states, so it might suffice for those two to explicitly re-seed the PRNG before them; let me try.",
    "created_at": "2018-12-21T15:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398353",
    "user": "https://github.com/embray"
}
```

<a id='comment:75'></a>Let's see... For the test that's failing in `sage.libs.gap.element` it should suffice to just put ellipses after `ValueError: libGAP: Error, no method found!`.  That's the only part that's important; the rest are details.

The other two look like they might result from different PRNG states, so it might suffice for those two to explicitly re-seed the PRNG before them; let me try.



---

archive/issue_comments_398354.json:
```json
{
    "body": "<a id='comment:76'></a>Replying to [comment:74 embray]:\n> I don't think we should do that.  It's bad enough that we're adding all the \"default\" packages, but that does seem defensible.\n> \n> Otherwise there's no point in even having a separate spkg.\n\n\nfor transition from several to one package it's OK, I think.\nWe can merge them later on another ticket.\n \n> \n> Meanwhile, I don't like that merely having some random package installed can cause actually different (even if not substantively) results, in ways that are very difficult to trace.  This is a really annoying problem with GAP...",
    "created_at": "2018-12-21T15:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398354",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:76'></a>Replying to [comment:74 embray]:
> I don't think we should do that.  It's bad enough that we're adding all the "default" packages, but that does seem defensible.
> 
> Otherwise there's no point in even having a separate spkg.


for transition from several to one package it's OK, I think.
We can merge them later on another ticket.
 
> 
> Meanwhile, I don't like that merely having some random package installed can cause actually different (even if not substantively) results, in ways that are very difficult to trace.  This is a really annoying problem with GAP...



---

archive/issue_comments_398355.json:
```json
{
    "body": "<a id='comment:77'></a>I'm definitely -1 on making it a standard package, especially in the short time that we have.  These have always been an optional add-on, and for the time being I don't want to add any more footprint to the default installation than we already are (keep in mind, this also increases the possibility of bugs in user code for which we don't have test cases).",
    "created_at": "2018-12-21T15:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398355",
    "user": "https://github.com/embray"
}
```

<a id='comment:77'></a>I'm definitely -1 on making it a standard package, especially in the short time that we have.  These have always been an optional add-on, and for the time being I don't want to add any more footprint to the default installation than we already are (keep in mind, this also increases the possibility of bugs in user code for which we don't have test cases).



---

archive/issue_comments_398356.json:
```json
{
    "body": "<a id='comment:78'></a>In the cases of the test we have failing currently, it appears that loading some of these packages just modifies the PRNG state, so the best solution for now is to explicitly re-seed them before the affected tests (not ideal, but it will ensure consistent results).",
    "created_at": "2018-12-21T15:43:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398356",
    "user": "https://github.com/embray"
}
```

<a id='comment:78'></a>In the cases of the test we have failing currently, it appears that loading some of these packages just modifies the PRNG state, so the best solution for now is to explicitly re-seed them before the affected tests (not ideal, but it will ensure consistent results).



---

archive/issue_comments_398357.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-21T15:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398357",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_398358.json:
```json
{
    "body": "<a id='comment:79'></a>Public branch for this ticket.  It is up-to-date with Dima's branch minus the last two commits that are contentious.",
    "created_at": "2018-12-21T15:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398358",
    "user": "https://github.com/embray"
}
```

<a id='comment:79'></a>Public branch for this ticket.  It is up-to-date with Dima's branch minus the last two commits that are contentious.



---

archive/issue_comments_398359.json:
```json
{
    "body": "<a id='comment:80'></a>your branch does not merge cleanly...",
    "created_at": "2018-12-21T15:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398359",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:80'></a>your branch does not merge cleanly...



---

archive/issue_comments_398360.json:
```json
{
    "body": "<a id='comment:81'></a>How about tagging the previously untagged tests that differ if gap_packages are installed with `# optional - gap_packages`, and be done with it? It's not that many tests, right?",
    "created_at": "2018-12-21T15:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398360",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:81'></a>How about tagging the previously untagged tests that differ if gap_packages are installed with `# optional - gap_packages`, and be done with it? It's not that many tests, right?



---

archive/issue_comments_398361.json:
```json
{
    "body": "<a id='comment:82'></a>~~It might need to be rebased again already; I don't know what Volker has been doing.~~ I just didn't push it yet.\n\nI already have another solution for these tests that is less fragile.",
    "created_at": "2018-12-21T16:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398361",
    "user": "https://github.com/embray"
}
```

<a id='comment:82'></a>~~It might need to be rebased again already; I don't know what Volker has been doing.~~ I just didn't push it yet.

I already have another solution for these tests that is less fragile.



---

archive/issue_comments_398362.json:
```json
{
    "body": "<a id='comment:83'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2018-12-21T16:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:83'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_398363.json:
```json
{
    "body": "<a id='comment:84'></a>For the remaining problematic tests I was able to fix them by manually calling (with some explanation in the prose) `libgap.set_seed(0)` before them (and modifying the expected output to correspond to that random seed).\n\nIt's unfortunate but possibly necessary, since the state of the PRNG can seem to depend on which packages were loaded and when, and for whatever reason those tests just happened to be very sensitive to this.\n\nI'm re-running the full test suite now to see if any other examples like this turn up.",
    "created_at": "2018-12-21T16:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398363",
    "user": "https://github.com/embray"
}
```

<a id='comment:84'></a>For the remaining problematic tests I was able to fix them by manually calling (with some explanation in the prose) `libgap.set_seed(0)` before them (and modifying the expected output to correspond to that random seed).

It's unfortunate but possibly necessary, since the state of the PRNG can seem to depend on which packages were loaded and when, and for whatever reason those tests just happened to be very sensitive to this.

I'm re-running the full test suite now to see if any other examples like this turn up.



---

archive/issue_comments_398364.json:
```json
{
    "body": "<a id='comment:85'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T16:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:85'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398365.json:
```json
{
    "body": "<a id='comment:86'></a>Oops, forgot to finish the tests for libgap.set_seed.",
    "created_at": "2018-12-21T16:55:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398365",
    "user": "https://github.com/embray"
}
```

<a id='comment:86'></a>Oops, forgot to finish the tests for libgap.set_seed.



---

archive/issue_comments_398366.json:
```json
{
    "body": "<a id='comment:87'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-21T16:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398366",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:87'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_398367.json:
```json
{
    "body": "<a id='comment:88'></a>your branch does not have 8.5.rc1 merged, by the way. Just testing it might show wrong test faults...",
    "created_at": "2018-12-21T17:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398367",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:88'></a>your branch does not have 8.5.rc1 merged, by the way. Just testing it might show wrong test faults...



---

archive/issue_comments_398368.json:
```json
{
    "body": "<a id='comment:89'></a>Replying to [comment:8 dimpase]:\n> I am checking whether `database_gap` is already in the branch on #22626, running\n> \n> ```\n> ./sage -tp  --optional=dochtml,memlimit,mpir,python2,database_gap,sage src/sage/groups/perm_gps/permgroup.py \n> ```\n\n\nI don't suppose you ever found a solution and/or explanation for this failure?  I have some workarounds for most everything else but this.",
    "created_at": "2018-12-21T17:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398368",
    "user": "https://github.com/embray"
}
```

<a id='comment:89'></a>Replying to [comment:8 dimpase]:
> I am checking whether `database_gap` is already in the branch on #22626, running
> 
> ```
> ./sage -tp  --optional=dochtml,memlimit,mpir,python2,database_gap,sage src/sage/groups/perm_gps/permgroup.py 
> ```


I don't suppose you ever found a solution and/or explanation for this failure?  I have some workarounds for most everything else but this.



---

archive/issue_comments_398369.json:
```json
{
    "body": "<a id='comment:90'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T17:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398369",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:90'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398370.json:
```json
{
    "body": "<a id='comment:91'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-21T17:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398370",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:91'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398371.json:
```json
{
    "body": "<a id='comment:92'></a>Replying to [comment:89 embray]:\n> Replying to [comment:8 dimpase]:\n> > I am checking whether `database_gap` is already in the branch on #22626, running\n> > \n> > ```\n> > ./sage -tp  --optional=dochtml,memlimit,mpir,python2,database_gap,sage src/sage/groups/perm_gps/permgroup.py \n> > ```\n\n> \n> I don't suppose you ever found a solution and/or explanation for this failure?  I have some workarounds for most everything else but this.\n\n\nsee comment:11. Have you merged the corresponding commit? (from the ticket it refers to)\n\nthat's why #26889 is a dependence of this ticket.",
    "created_at": "2018-12-21T18:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398371",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:92'></a>Replying to [comment:89 embray]:
> Replying to [comment:8 dimpase]:
> > I am checking whether `database_gap` is already in the branch on #22626, running
> > 
> > ```
> > ./sage -tp  --optional=dochtml,memlimit,mpir,python2,database_gap,sage src/sage/groups/perm_gps/permgroup.py 
> > ```

> 
> I don't suppose you ever found a solution and/or explanation for this failure?  I have some workarounds for most everything else but this.


see comment:11. Have you merged the corresponding commit? (from the ticket it refers to)

that's why #26889 is a dependence of this ticket.



---

archive/issue_comments_398372.json:
```json
{
    "body": "<a id='comment:93'></a>Ah, right, I had forgotten about that.  That makes sense.\n\nThe issue here again seems to have something in part to do with the random number generator state in GAP.  In the case of:\n\n```\nsage: MG = GU(3,2).as_matrix_group()\nsage: PG = MG.as_permutation_group()\nsage: PG2 = MG._permutation_group_()\n```\n\n*usually* `PG` and `PG2` will be the same, but on rare occasion they will be different, and that just happened to be the case in this test.  Could that be a bug in GAP, or expected behavior?  That I don't know.\n\nThat code is still a mess on the Sage end too as well, so any effort to clean it up can't hurt.",
    "created_at": "2018-12-21T18:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398372",
    "user": "https://github.com/embray"
}
```

<a id='comment:93'></a>Ah, right, I had forgotten about that.  That makes sense.

The issue here again seems to have something in part to do with the random number generator state in GAP.  In the case of:

```
sage: MG = GU(3,2).as_matrix_group()
sage: PG = MG.as_permutation_group()
sage: PG2 = MG._permutation_group_()
```

*usually* `PG` and `PG2` will be the same, but on rare occasion they will be different, and that just happened to be the case in this test.  Could that be a bug in GAP, or expected behavior?  That I don't know.

That code is still a mess on the Sage end too as well, so any effort to clean it up can't hurt.



---

archive/issue_comments_398373.json:
```json
{
    "body": "<a id='comment:94'></a>Replying to [comment:93 embray]:\n> Ah, right, I had forgotten about that.  That makes sense.\n> \n> The issue here again seems to have something in part to do with the random number generator state in GAP.  In the case of:\n> \n> \n> ```\n> sage: MG = GU(3,2).as_matrix_group()\n> sage: PG = MG.as_permutation_group()\n> sage: PG2 = MG._permutation_group_()\n> ```\n> \n> *usually* `PG` and `PG2` will be the same, but on rare occasion they will be different, and that just happened to be the case in this test.  Could that be a bug in GAP, or expected behavior?  That I don't know.\n\n\nWe have two instances of GAP talking to each other, how their RNGs are syncronised is\nan interesting question. Are they?",
    "created_at": "2018-12-21T19:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398373",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:94'></a>Replying to [comment:93 embray]:
> Ah, right, I had forgotten about that.  That makes sense.
> 
> The issue here again seems to have something in part to do with the random number generator state in GAP.  In the case of:
> 
> 
> ```
> sage: MG = GU(3,2).as_matrix_group()
> sage: PG = MG.as_permutation_group()
> sage: PG2 = MG._permutation_group_()
> ```
> 
> *usually* `PG` and `PG2` will be the same, but on rare occasion they will be different, and that just happened to be the case in this test.  Could that be a bug in GAP, or expected behavior?  That I don't know.


We have two instances of GAP talking to each other, how their RNGs are syncronised is
an interesting question. Are they?



---

archive/issue_comments_398374.json:
```json
{
    "body": "<a id='comment:95'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-22T00:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:95'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398375.json:
```json
{
    "body": "<a id='comment:96'></a>new gap_packages installation does not work, breaks at cohomolo GAP package:\n\n```\n[gap_packages-4.10.0] cp calcpres.gap ..//..//bin/x86_64-pc-linux-gnu-default64/calcpres.gap\n[gap_packages-4.10.0] chmod +x ..//..//bin/x86_64-pc-linux-gnu-default64/calcpres.gap\n[gap_packages-4.10.0] make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7/standalone/progs.d'\n[gap_packages-4.10.0] make[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7'\n[gap_packages-4.10.0] bin/ -> /home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/inst/home/scratch2/dimpase/sage/sage/local/lib/gap/pkg/cohomolo-1.6.7\n[gap_packages-4.10.0] make[2]: Entering directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7'\n[gap_packages-4.10.0] cd standalone/progs.d; make clean\n[gap_packages-4.10.0] make[3]: Entering directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7/standalone/progs.d'\n[gap_packages-4.10.0] /bin/rm -f *.o\n[gap_packages-4.10.0] make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7/standalone/progs.d'\n[gap_packages-4.10.0] make[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7'\n[gap_packages-4.10.0] ********************************************************************************\n[gap_packages-4.10.0] Error: source file/directory bin does not exist\n[gap_packages-4.10.0] ********************************************************************************\n```\n(this is on Fedora 26, in case it matters)",
    "created_at": "2018-12-22T00:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398375",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:96'></a>new gap_packages installation does not work, breaks at cohomolo GAP package:

```
[gap_packages-4.10.0] cp calcpres.gap ..//..//bin/x86_64-pc-linux-gnu-default64/calcpres.gap
[gap_packages-4.10.0] chmod +x ..//..//bin/x86_64-pc-linux-gnu-default64/calcpres.gap
[gap_packages-4.10.0] make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7/standalone/progs.d'
[gap_packages-4.10.0] make[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7'
[gap_packages-4.10.0] bin/ -> /home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/inst/home/scratch2/dimpase/sage/sage/local/lib/gap/pkg/cohomolo-1.6.7
[gap_packages-4.10.0] make[2]: Entering directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7'
[gap_packages-4.10.0] cd standalone/progs.d; make clean
[gap_packages-4.10.0] make[3]: Entering directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7/standalone/progs.d'
[gap_packages-4.10.0] /bin/rm -f *.o
[gap_packages-4.10.0] make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7/standalone/progs.d'
[gap_packages-4.10.0] make[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/cohomolo-1.6.7'
[gap_packages-4.10.0] ********************************************************************************
[gap_packages-4.10.0] Error: source file/directory bin does not exist
[gap_packages-4.10.0] ********************************************************************************
```
(this is on Fedora 26, in case it matters)



---

archive/issue_comments_398376.json:
```json
{
    "body": "<a id='comment:97'></a>#22626 breaks some of the `# optional - database_gap` doctests. I'll ignore that failure for now but please fix asap.",
    "created_at": "2018-12-23T10:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398376",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:97'></a>#22626 breaks some of the `# optional - database_gap` doctests. I'll ignore that failure for now but please fix asap.



---

archive/issue_comments_398377.json:
```json
{
    "body": "<a id='comment:98'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-24T02:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:98'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398378.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-24T02:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398378",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_398379.json:
```json
{
    "body": "<a id='comment:100'></a>Replying to [comment:97 vbraun]:\n> #22626 breaks some of the `# optional - database_gap` doctests. I'll ignore that failure for now but please fix asap.\n\n\nYes, this ticket gets rid of database_gap (everything there will be a part of gap package), so this is taken care of here.\n\nI've also fixed the build failure here, so it's ready for review, I think.",
    "created_at": "2018-12-24T02:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398379",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:100'></a>Replying to [comment:97 vbraun]:
> #22626 breaks some of the `# optional - database_gap` doctests. I'll ignore that failure for now but please fix asap.


Yes, this ticket gets rid of database_gap (everything there will be a part of gap package), so this is taken care of here.

I've also fixed the build failure here, so it's ready for review, I think.



---

archive/issue_comments_398380.json:
```json
{
    "body": "<a id='comment:1'></a>So the current scheme is that gap_packages remains optional spkg, for the time being at least. I'd rather make it standard too, and then merge into gap package,\nbut Erik thinks it's too big a change (I don't think so---I think the change between what we have in Sage 8.4 (and 8.5) is already very big, not the least due to GAP 4.10 being quite a big change from GAP 4.8, and forcing people to adjust their code several times is worse than asking to do so once--- but OK).",
    "created_at": "2018-12-24T02:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398380",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>So the current scheme is that gap_packages remains optional spkg, for the time being at least. I'd rather make it standard too, and then merge into gap package,
but Erik thinks it's too big a change (I don't think so---I think the change between what we have in Sage 8.4 (and 8.5) is already very big, not the least due to GAP 4.10 being quite a big change from GAP 4.8, and forcing people to adjust their code several times is worse than asking to do so once--- but OK).



---

archive/issue_comments_398381.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-24T21:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398382.json:
```json
{
    "body": "<a id='comment:3'></a>this commit went AWOL from the current branch. With it in, all tests pass",
    "created_at": "2018-12-24T21:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398382",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>this commit went AWOL from the current branch. With it in, all tests pass



---

archive/issue_comments_398383.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-26T02:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398384.json:
```json
{
    "body": "<a id='comment:5'></a>One more AWOL commit.",
    "created_at": "2018-12-26T02:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398384",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>One more AWOL commit.



---

archive/issue_comments_398385.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-26T03:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398385",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398386.json:
```json
{
    "body": "<a id='comment:107'></a>Replying to [comment:71 dimpase]:\n> Replying to [comment:70 git]:\n> > Branch pushed to git repo; I updated commit sha1. New commits:\n> > |                                                                                                                                           |                                       |\n> > |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n> > |[1e5f679](https://git.sagemath.org/sage.git/commit/?id=1e5f679c41a7b27088ed330f986df91d03099a71)|`move silencing into the function body`|\n\n> \n> this addresses comment 65.\n\n\nThis should probably use `InfoLevel(InfoWarning)` to get the previous level, not just assume to restore it to 1.  Probably unlikely to matter usually but it is still a bug waiting to happen.",
    "created_at": "2018-12-28T11:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398386",
    "user": "https://github.com/embray"
}
```

<a id='comment:107'></a>Replying to [comment:71 dimpase]:
> Replying to [comment:70 git]:
> > Branch pushed to git repo; I updated commit sha1. New commits:
> > |                                                                                                                                           |                                       |
> > |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
> > |[1e5f679](https://git.sagemath.org/sage.git/commit/?id=1e5f679c41a7b27088ed330f986df91d03099a71)|`move silencing into the function body`|

> 
> this addresses comment 65.


This should probably use `InfoLevel(InfoWarning)` to get the previous level, not just assume to restore it to 1.  Probably unlikely to matter usually but it is still a bug waiting to happen.



---

archive/issue_comments_398387.json:
```json
{
    "body": "<a id='comment:108'></a>Replying to [comment:106 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                                                      |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n> |[37e2329](https://git.sagemath.org/sage.git/commit/?id=37e23290bad2ee4d36463647f4c058c500b81eba)|`tagged # random - answer is always mathematically OK, outputs differ`|\n\n\nI'm going to double-check but this shouldn't be necessary.  This is what #26874 was fixing.",
    "created_at": "2018-12-28T11:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398387",
    "user": "https://github.com/embray"
}
```

<a id='comment:108'></a>Replying to [comment:106 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                                                      |
> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
> |[37e2329](https://git.sagemath.org/sage.git/commit/?id=37e23290bad2ee4d36463647f4c058c500b81eba)|`tagged # random - answer is always mathematically OK, outputs differ`|


I'm going to double-check but this shouldn't be necessary.  This is what #26874 was fixing.



---

archive/issue_comments_398388.json:
```json
{
    "body": "<a id='comment:9'></a>Yes, merging in #26874 guarantees that test always works the same way, as the RNG state is consistent.\n\nI'll deal with comment:107 and then do a couple final checks before setting positive_review.",
    "created_at": "2018-12-28T11:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398388",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>Yes, merging in #26874 guarantees that test always works the same way, as the RNG state is consistent.

I'll deal with comment:107 and then do a couple final checks before setting positive_review.



---

archive/issue_comments_398389.json:
```json
{
    "body": "<a id='comment:110'></a>Replying to [comment:98 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                       |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n> |[bd849fb](https://git.sagemath.org/sage.git/commit/?id=bd849fbe2b32a6cc8d4b56b334e4293846061a6b)|`don't clean too early`|\n\n\nThis \"fix\" is a problem as well.  The \"cleanup\" commands that were moved were deliberately *before* `sdh_install *` so that files that shouldn't be installed aren't installed.  I'll see if I can reproduce the problem you had; I did not have the same problem on Ubuntu.",
    "created_at": "2018-12-28T11:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398389",
    "user": "https://github.com/embray"
}
```

<a id='comment:110'></a>Replying to [comment:98 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                       |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
> |[bd849fb](https://git.sagemath.org/sage.git/commit/?id=bd849fbe2b32a6cc8d4b56b334e4293846061a6b)|`don't clean too early`|


This "fix" is a problem as well.  The "cleanup" commands that were moved were deliberately *before* `sdh_install *` so that files that shouldn't be installed aren't installed.  I'll see if I can reproduce the problem you had; I did not have the same problem on Ubuntu.



---

archive/issue_comments_398390.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-28T11:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398390",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_398391.json:
```json
{
    "body": "<a id='comment:112'></a>Replying to [comment:94 dimpase]:\n> Replying to [comment:93 embray]:\n> > Ah, right, I had forgotten about that.  That makes sense.\n> > \n> > The issue here again seems to have something in part to do with the random number generator state in GAP.  In the case of:\n> > \n> > \n> > ```\n> > sage: MG = GU(3,2).as_matrix_group()\n> > sage: PG = MG.as_permutation_group()\n> > sage: PG2 = MG._permutation_group_()\n> > ```\n> > \n> > *usually* `PG` and `PG2` will be the same, but on rare occasion they will be different, and that just happened to be the case in this test.  Could that be a bug in GAP, or expected behavior?  That I don't know.\n\n> \n> We have two instances of GAP talking to each other, how their RNGs are syncronised is\n> an interesting question. Are they?\n\n\nNope.  I do have an experimental branch where I modified `Randstate.set_seed_gap()` to seed both libgap and the pexpect GAP simultaneously, but I haven't decided whether or not to use it yet.",
    "created_at": "2018-12-28T11:34:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398391",
    "user": "https://github.com/embray"
}
```

<a id='comment:112'></a>Replying to [comment:94 dimpase]:
> Replying to [comment:93 embray]:
> > Ah, right, I had forgotten about that.  That makes sense.
> > 
> > The issue here again seems to have something in part to do with the random number generator state in GAP.  In the case of:
> > 
> > 
> > ```
> > sage: MG = GU(3,2).as_matrix_group()
> > sage: PG = MG.as_permutation_group()
> > sage: PG2 = MG._permutation_group_()
> > ```
> > 
> > *usually* `PG` and `PG2` will be the same, but on rare occasion they will be different, and that just happened to be the case in this test.  Could that be a bug in GAP, or expected behavior?  That I don't know.

> 
> We have two instances of GAP talking to each other, how their RNGs are syncronised is
> an interesting question. Are they?


Nope.  I do have an experimental branch where I modified `Randstate.set_seed_gap()` to seed both libgap and the pexpect GAP simultaneously, but I haven't decided whether or not to use it yet.



---

archive/issue_comments_398392.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-28T15:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_398393.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-28T15:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_398394.json:
```json
{
    "body": "<a id='comment:5'></a>Can you check if the latest commit fixes the issue from comment:96 ?  I can't reproduce that so I'm not really sure what's going on there (seeing more of the log might help too, if it's not fixed...)",
    "created_at": "2018-12-28T15:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398394",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>Can you check if the latest commit fixes the issue from comment:96 ?  I can't reproduce that so I'm not really sure what's going on there (seeing more of the log might help too, if it's not fixed...)



---

archive/issue_comments_398395.json:
```json
{
    "body": "Changing keywords from \"\" to \"GAP\".",
    "created_at": "2018-12-28T15:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398395",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "GAP".



---

archive/issue_comments_398396.json:
```json
{
    "body": "<a id='comment:6'></a>Does this also fix #23054?",
    "created_at": "2018-12-28T15:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398396",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>Does this also fix #23054?



---

archive/issue_comments_398397.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n-now everything needed is already in GAP's tarball.\n+Now everything needed is already in GAP's tarball.\n \n-There is also no more copyright-induced hassle of having database_gap\n-separate and optional, although gap_packages still need a look at the respective copyrights (if we wish to make it standard)\n+There is also no more copyright-induced hassle of having \\`database_gap\\`\n+separate and optional, although \\`gap_packages\\` still need a look at the respective copyrights (if we wish to make it standard).\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2018-12-28T15:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398397",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,7 +1,8 @@
-now everything needed is already in GAP's tarball.
+Now everything needed is already in GAP's tarball.
 
-There is also no more copyright-induced hassle of having database_gap
-separate and optional, although gap_packages still need a look at the respective copyrights (if we wish to make it standard)
+There is also no more copyright-induced hassle of having \`database_gap\`
+separate and optional, although \`gap_packages\` still need a look at the respective copyrights (if we wish to make it standard).
+
 
 Comment: 1
 
```




---

archive/issue_events_066451.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-12-28T15:37:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "milestone": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26856#event-66451"
}
```



---

archive/issue_comments_398398.json:
```json
{
    "body": "Attachment [gap_packages-4.10.0.log](tarball://root/attachments/some-uuid/ticket26856/gap_packages-4.10.0.log) by @mantepse created at 2018-12-28 15:57:56",
    "created_at": "2018-12-28T15:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398398",
    "user": "https://github.com/mantepse"
}
```

Attachment [gap_packages-4.10.0.log](tarball://root/attachments/some-uuid/ticket26856/gap_packages-4.10.0.log) by @mantepse created at 2018-12-28 15:57:56



---

archive/issue_comments_398399.json:
```json
{
    "body": "<a id='comment:7'></a>I also have the problem from comment:96, on ubuntu 17.10, sage 8.6.beta0.  I attached the log.",
    "created_at": "2018-12-28T15:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398399",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:7'></a>I also have the problem from comment:96, on ubuntu 17.10, sage 8.6.beta0.  I attached the log.



---

archive/issue_comments_398400.json:
```json
{
    "body": "<a id='comment:8'></a>Thanks--I was able to reproduce the problem in a docker container.  My attempted fix doesn't seem to help.  Not sure what the problem is though; it's an odd one...",
    "created_at": "2018-12-28T17:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398400",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>Thanks--I was able to reproduce the problem in a docker container.  My attempted fix doesn't seem to help.  Not sure what the problem is though; it's an odd one...



---

archive/issue_comments_398401.json:
```json
{
    "body": "<a id='comment:119'></a>Replying to [comment:118 embray]:\n> Thanks--I was able to reproduce the problem in a docker container.  My attempted fix doesn't seem to help.  Not sure what the problem is though; it's an odd one...\n\n\nIMHO it should not hold up this ticket - open a follow-up ticket to fix it.",
    "created_at": "2018-12-28T17:40:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398401",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:119'></a>Replying to [comment:118 embray]:
> Thanks--I was able to reproduce the problem in a docker container.  My attempted fix doesn't seem to help.  Not sure what the problem is though; it's an odd one...


IMHO it should not hold up this ticket - open a follow-up ticket to fix it.



---

archive/issue_comments_398402.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-28T17:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398402",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_398403.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2018-12-28T17:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398403",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_398404.json:
```json
{
    "body": "<a id='comment:3'></a>Rebased on 8.6.beta0",
    "created_at": "2018-12-28T17:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398404",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>Rebased on 8.6.beta0



---

archive/issue_comments_398405.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-28T17:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398406.json:
```json
{
    "body": "<a id='comment:5'></a>Merged fix from #26965 so that this branch can be built successfully from a fresh install.",
    "created_at": "2018-12-28T17:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398406",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>Merged fix from #26965 so that this branch can be built successfully from a fresh install.



---

archive/issue_comments_398407.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-28T17:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398407",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_398408.json:
```json
{
    "body": "<a id='comment:6'></a>comment in the commit 293e79a\tis a bit off, as altlasrep has a cache of files downloaded from the net, not generated.",
    "created_at": "2018-12-28T18:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398408",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>comment in the commit 293e79a	is a bit off, as altlasrep has a cache of files downloaded from the net, not generated.



---

archive/issue_comments_398409.json:
```json
{
    "body": "<a id='comment:7'></a>I am getting timeouts in these iffy parts of libgap:\n\n```\nsage -t --warn-long 109.1 src/sage/libs/gap/all_documented_functions.py\n    Timed out\nsage -t --warn-long 109.1 src/sage/libs/gap/assigned_names.py\n    Timed out\n```\nsomething these should be tagged `# long time` ?",
    "created_at": "2018-12-28T18:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398409",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>I am getting timeouts in these iffy parts of libgap:

```
sage -t --warn-long 109.1 src/sage/libs/gap/all_documented_functions.py
    Timed out
sage -t --warn-long 109.1 src/sage/libs/gap/assigned_names.py
    Timed out
```
something these should be tagged `# long time` ?



---

archive/issue_comments_398410.json:
```json
{
    "body": "<a id='comment:8'></a>Wherever the files come from I just mean that they are created by the package at runtime and are not \"installed\".",
    "created_at": "2018-12-28T18:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398410",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>Wherever the files come from I just mean that they are created by the package at runtime and are not "installed".



---

archive/issue_comments_398411.json:
```json
{
    "body": "<a id='comment:129'></a>Replying to [comment:127 dimpase]:\n> I am getting timeouts in these iffy parts of libgap:\n> \n> ```\n> sage -t --warn-long 109.1 src/sage/libs/gap/all_documented_functions.py\n>     Timed out\n> sage -t --warn-long 109.1 src/sage/libs/gap/assigned_names.py\n>     Timed out\n> ```\n> something these should be tagged `# long time` ?\n\n\n\nI think they are.  I originally meant, as part of #22626 to deprecate these modules and disable their tests, but I forgot to add that to the work items.\n\nWhile we're at it I'll go ahead and mark the tests to be skipped, and will handle the deprecation later, perhaps as part of #26959.",
    "created_at": "2018-12-28T18:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398411",
    "user": "https://github.com/embray"
}
```

<a id='comment:129'></a>Replying to [comment:127 dimpase]:
> I am getting timeouts in these iffy parts of libgap:
> 
> ```
> sage -t --warn-long 109.1 src/sage/libs/gap/all_documented_functions.py
>     Timed out
> sage -t --warn-long 109.1 src/sage/libs/gap/assigned_names.py
>     Timed out
> ```
> something these should be tagged `# long time` ?



I think they are.  I originally meant, as part of #22626 to deprecate these modules and disable their tests, but I forgot to add that to the work items.

While we're at it I'll go ahead and mark the tests to be skipped, and will handle the deprecation later, perhaps as part of #26959.



---

archive/issue_comments_398412.json:
```json
{
    "body": "<a id='comment:0'></a>OK, tests are running, I'll have a look in the morning (I'm on UTC+8 now, sorry :-))",
    "created_at": "2018-12-28T18:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398412",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>OK, tests are running, I'll have a look in the morning (I'm on UTC+8 now, sorry :-))



---

archive/issue_comments_398413.json:
```json
{
    "body": "<a id='comment:1'></a>I did a fresh test run earlier today and everything looked good, but it will be good to get a second opinion.  I'm about to push one more change to disable skip those problematic tests.",
    "created_at": "2018-12-28T18:46:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398413",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>I did a fresh test run earlier today and everything looked good, but it will be good to get a second opinion.  I'm about to push one more change to disable skip those problematic tests.



---

archive/issue_comments_398414.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-28T20:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398415.json:
```json
{
    "body": "<a id='comment:3'></a>seems to work here!  (same timeouts, because I didn't have the final commit yet)\n\nThank you!",
    "created_at": "2018-12-28T23:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398415",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:3'></a>seems to work here!  (same timeouts, because I didn't have the final commit yet)

Thank you!



---

archive/issue_comments_398416.json:
```json
{
    "body": "<a id='comment:4'></a>OK, great, all works. \n\n---\nNew commits:",
    "created_at": "2018-12-29T02:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398416",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>OK, great, all works. 

---
New commits:



---

archive/issue_comments_398417.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-29T02:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398417",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_398418.json:
```json
{
    "body": "<a id='comment:136'></a>Replying to [comment:116 slelievre]:\n> Does this also fix #23054?\n\nyes it does, thanks for pointing this out.",
    "created_at": "2018-12-29T03:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398418",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:136'></a>Replying to [comment:116 slelievre]:
> Does this also fix #23054?

yes it does, thanks for pointing this out.



---

archive/issue_comments_398419.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-31T10:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398419",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066452.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-31T10:37:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26856#event-66452"
}
```



---

archive/issue_comments_398420.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,102 @@\n+After the upgrade to GAP 4.10 in #22626, we revisit what\n+GAP packages are available in Sage via the GAP standard\n+SPKG and via extra optional SPGKs.\n+\n+All GAP packages formerly in our \"database_gap\"\n+optional SPKG, except tomlib, now get installed\n+with GAP as part of our \"gap\" standard SPKG.\n+\n+This ticket adds tomlib to the \"gap\" standard SPKG\n+and removes the \"database_gap\" optional SPKG.\n+\n+(All packages previously in \"database_gap\" have\n+GPL-compatible licenses and can therefore be\n+distributed as part of the \"gap\" standard SPKG\n+without license worries.)\n+\n+We also update the list of extra GAP packages\n+in gap_packages, which remains a separate and\n+optional SPKG.\n+\n+Once the present ticket is merged, GAP packages\n+shipped with the \"gap\" standard SPKG and with\n+the \"gap_packages\" optional SPKG are as follows.\n+\n+'''GAP packages now shipped with \"gap\"\n+(standard SageMath package)'''\n+\n+A basic package used by most GAP packages\n+for their documentation\n+\n+- GAPDoc\n+\n+Five database packages formerly in \"database_gap\"\n+\n+- PrimGrp\n+- SmallGrp\n+- TransGrp\n+- TomLib\n+- AtlasRep\n+\n+Twelve more packages\n+\n+- AutPGrp\n+- Alnuth\n+- CRISP\n+- !CTblLib\n+- FactInt\n+- FGA\n+- IRREDSOL\n+- LAGUNA\n+- Polenta\n+- Polycyclic\n+- ResClasses\n+- Sophus\n+\n+'''GAP packages now shipped with \"gap_packages\"\n+(optional SageMath package)'''\n+\n+Twenty-five \"pure GAP\" packages\n+(not requiring compilation)\n+\n+- AClib\n+- AutoDoc\n+- CoReLG\n+- CRIME\n+- Cryst\n+- CrystCat\n+- DESIGN\n+- GBNP\n+- HAP\n+- HAPcryst\n+- hecke\n+- LieAlgDB\n+- LiePRing\n+- LieRing\n+- loops\n+- MapClass\n+- polymaking\n+- QPA\n+- QuaGroup\n+- RadiRoot\n+- Repsn\n+- SLA\n+- SONATA\n+- Toric\n+- utils\n+\n+Four compiled GAP packages\n+\n+- cohomolo\n+- GRAPE\n+- GUAVA\n+- nq\n+\n+**No longer distributed**\n+\n+- HAPprime: unmaintained, partly merged in HAP, \n+  see [list of \"No longer redistributed with GAP or renamed\" GAP packages](https://www.gap-system.org/Packages/packages.html#deppkg),\n+  source code [archived at GitHub](https://github.com/gap-packages/happrime)\n \n \n Comment: 1\n```\n",
    "created_at": "2021-07-07T12:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26856#issuecomment-398420",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,102 @@
+After the upgrade to GAP 4.10 in #22626, we revisit what
+GAP packages are available in Sage via the GAP standard
+SPKG and via extra optional SPGKs.
+
+All GAP packages formerly in our "database_gap"
+optional SPKG, except tomlib, now get installed
+with GAP as part of our "gap" standard SPKG.
+
+This ticket adds tomlib to the "gap" standard SPKG
+and removes the "database_gap" optional SPKG.
+
+(All packages previously in "database_gap" have
+GPL-compatible licenses and can therefore be
+distributed as part of the "gap" standard SPKG
+without license worries.)
+
+We also update the list of extra GAP packages
+in gap_packages, which remains a separate and
+optional SPKG.
+
+Once the present ticket is merged, GAP packages
+shipped with the "gap" standard SPKG and with
+the "gap_packages" optional SPKG are as follows.
+
+'''GAP packages now shipped with "gap"
+(standard SageMath package)'''
+
+A basic package used by most GAP packages
+for their documentation
+
+- GAPDoc
+
+Five database packages formerly in "database_gap"
+
+- PrimGrp
+- SmallGrp
+- TransGrp
+- TomLib
+- AtlasRep
+
+Twelve more packages
+
+- AutPGrp
+- Alnuth
+- CRISP
+- !CTblLib
+- FactInt
+- FGA
+- IRREDSOL
+- LAGUNA
+- Polenta
+- Polycyclic
+- ResClasses
+- Sophus
+
+'''GAP packages now shipped with "gap_packages"
+(optional SageMath package)'''
+
+Twenty-five "pure GAP" packages
+(not requiring compilation)
+
+- AClib
+- AutoDoc
+- CoReLG
+- CRIME
+- Cryst
+- CrystCat
+- DESIGN
+- GBNP
+- HAP
+- HAPcryst
+- hecke
+- LieAlgDB
+- LiePRing
+- LieRing
+- loops
+- MapClass
+- polymaking
+- QPA
+- QuaGroup
+- RadiRoot
+- Repsn
+- SLA
+- SONATA
+- Toric
+- utils
+
+Four compiled GAP packages
+
+- cohomolo
+- GRAPE
+- GUAVA
+- nq
+
+**No longer distributed**
+
+- HAPprime: unmaintained, partly merged in HAP, 
+  see [list of "No longer redistributed with GAP or renamed" GAP packages](https://www.gap-system.org/Packages/packages.html#deppkg),
+  source code [archived at GitHub](https://github.com/gap-packages/happrime)
 
 
 Comment: 1
```

