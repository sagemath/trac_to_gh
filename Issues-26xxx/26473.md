# Issue 26473: py3: fix doctests failures of sage/combinat/words/word_*datatype*

archive/issues_026236.json:
```json
{
    "body": "with 8.4.rc0, the python 3 failures in `sage/combinat/words` are:\n\n```\n----------------------------------------------------------------------\nsage -t abstract_word.py  # 13 doctests failed\nsage -t word_char.pyx  # 3 doctests failed\nsage -t word_generators.py  # 23 doctests failed\nsage -t word_infinite_datatypes.py  # 22 doctests failed\nsage -t words.py  # 7 doctests failed\nsage -t word.py  # 8 doctests failed\nsage -t word_datatypes.pyx  # 1 doctest failed\nsage -t suffix_trees.py  # 2 doctests failed\nsage -t morphism.py  # 16 doctests failed\nsage -t finite_word.py  # 73 doctests failed\nsage -t paths.py  # 15 doctests failed\n----------------------------------------------------------------------\n```\n\noften of the following form due to `word_infinite_datatypes.py`:\n\n```\n**********************************************************************\nFile \"word_infinite_datatypes.py\", line 1035, in sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__\nFailed example:\n    w[::2]\nException raised:\n    Traceback (most recent call last):\n      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 659, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1070, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__[17]>\", line 1, in <module>\n        w[::Integer(2)]\n      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py\", line 1161, in __getitem__\n        return super(WordDatatype_iter_with_caching,self).__getitem__(key)\n      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py\", line 874, in __getitem__\n        data = itertools.islice(self, key.start, stop, key.step)\n    ValueError: Step for islice() must be a positive integer or None.\n**********************************************************************\n```\n\nWe fix issues in `word_infinite_datatypes.py` and `word_datatype.py` and now with this ticket, there are a lot less failing doctests in `sage/combinat/words`:\n\n```\n----------------------------------------------------------------------\nsage -t abstract_word.py  # 4 doctests failed\nsage -t word_generators.py  # 2 doctests failed\nsage -t word.py  # 1 doctest failed\nsage -t morphism.py  # 9 doctests failed\nsage -t finite_word.py  # 7 doctests failed\n----------------------------------------------------------------------\n```\n\nBranch/Commit: b541ed5cebb0a4aac7de1408501c082a515f14cb\n\nReviewer: Vincent Klein\n\nAuthor: S\u00e9bastien Labb\u00e9\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26473\n\n",
    "closed_at": "2018-10-20T11:57:37Z",
    "created_at": "2018-10-11T21:31:24Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "py3: fix doctests failures of sage/combinat/words/word_*datatype*",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26473",
    "user": "https://github.com/seblabbe"
}
```
with 8.4.rc0, the python 3 failures in `sage/combinat/words` are:

```
----------------------------------------------------------------------
sage -t abstract_word.py  # 13 doctests failed
sage -t word_char.pyx  # 3 doctests failed
sage -t word_generators.py  # 23 doctests failed
sage -t word_infinite_datatypes.py  # 22 doctests failed
sage -t words.py  # 7 doctests failed
sage -t word.py  # 8 doctests failed
sage -t word_datatypes.pyx  # 1 doctest failed
sage -t suffix_trees.py  # 2 doctests failed
sage -t morphism.py  # 16 doctests failed
sage -t finite_word.py  # 73 doctests failed
sage -t paths.py  # 15 doctests failed
----------------------------------------------------------------------
```

often of the following form due to `word_infinite_datatypes.py`:

```
**********************************************************************
File "word_infinite_datatypes.py", line 1035, in sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__
Failed example:
    w[::2]
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 659, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1070, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__[17]>", line 1, in <module>
        w[::Integer(2)]
      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py", line 1161, in __getitem__
        return super(WordDatatype_iter_with_caching,self).__getitem__(key)
      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py", line 874, in __getitem__
        data = itertools.islice(self, key.start, stop, key.step)
    ValueError: Step for islice() must be a positive integer or None.
**********************************************************************
```

We fix issues in `word_infinite_datatypes.py` and `word_datatype.py` and now with this ticket, there are a lot less failing doctests in `sage/combinat/words`:

```
----------------------------------------------------------------------
sage -t abstract_word.py  # 4 doctests failed
sage -t word_generators.py  # 2 doctests failed
sage -t word.py  # 1 doctest failed
sage -t morphism.py  # 9 doctests failed
sage -t finite_word.py  # 7 doctests failed
----------------------------------------------------------------------
```

Branch/Commit: b541ed5cebb0a4aac7de1408501c082a515f14cb

Reviewer: Vincent Klein

Author: Sébastien Labbé

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26473





---

archive/issue_comments_393772.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-10-11T21:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393772",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_393773.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-11T21:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393773",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_393774.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -28,6 +28,19 @@\n **********************************************************************\n \\`\\`\\`\n \n+With this ticket, there are a lot less failing doctests in \\`sage/combinat/words\\`:\n+\n+\\`\\`\\`\n+----------------------------------------------------------------------\n+sage -t words.py  # 1 doctest failed\n+sage -t word.py  # 1 doctest failed\n+sage -t abstract_word.py  # 4 doctests failed\n+sage -t word_generators.py  # 9 doctests failed\n+sage -t morphism.py  # 9 doctests failed\n+sage -t finite_word.py  # 17 doctests failed\n+----------------------------------------------------------------------\n+\\`\\`\\`\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/26473\n```\n",
    "created_at": "2018-10-11T21:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393774",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -28,6 +28,19 @@
 **********************************************************************
 \`\`\`
 
+With this ticket, there are a lot less failing doctests in \`sage/combinat/words\`:
+
+\`\`\`
+----------------------------------------------------------------------
+sage -t words.py  # 1 doctest failed
+sage -t word.py  # 1 doctest failed
+sage -t abstract_word.py  # 4 doctests failed
+sage -t word_generators.py  # 9 doctests failed
+sage -t morphism.py  # 9 doctests failed
+sage -t finite_word.py  # 17 doctests failed
+----------------------------------------------------------------------
+\`\`\`
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/26473
```




---

archive/issue_comments_393775.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-11T21:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393775",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393776.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-10-11T21:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393776",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_393777.json:
```json
{
    "body": "<a id='comment:4'></a>I am still working on it ...",
    "created_at": "2018-10-11T21:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393777",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:4'></a>I am still working on it ...



---

archive/issue_comments_393778.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-11T23:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393778",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393779.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-11T23:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393780.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2018-10-11T23:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393780",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_393781.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+with 8.4.rc0, the python 3 failures in \\`sage/combinat/words\\` are:\n \n+\\`\\`\\`\n+----------------------------------------------------------------------\n+sage -t abstract_word.py  # 13 doctests failed\n+sage -t word_char.pyx  # 3 doctests failed\n+sage -t word_generators.py  # 23 doctests failed\n+sage -t word_infinite_datatypes.py  # 22 doctests failed\n+sage -t words.py  # 7 doctests failed\n+sage -t word.py  # 8 doctests failed\n+sage -t word_datatypes.pyx  # 1 doctest failed\n+sage -t suffix_trees.py  # 2 doctests failed\n+sage -t morphism.py  # 16 doctests failed\n+sage -t finite_word.py  # 73 doctests failed\n+sage -t paths.py  # 15 doctests failed\n+----------------------------------------------------------------------\n+\\`\\`\\`\n+\n+often of the following form due to \\`word_infinite_datatypes.py\\`:\n+\n+\\`\\`\\`\n+**********************************************************************\n+File \"word_infinite_datatypes.py\", line 1035, in sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__\n+Failed example:\n+    w[::2]\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 659, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1070, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__[17]>\", line 1, in <module>\n+        w[::Integer(2)]\n+      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py\", line 1161, in __getitem__\n+        return super(WordDatatype_iter_with_caching,self).__getitem__(key)\n+      File \"/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py\", line 874, in __getitem__\n+        data = itertools.islice(self, key.start, stop, key.step)\n+    ValueError: Step for islice() must be a positive integer or None.\n+**********************************************************************\n+\\`\\`\\`\n+\n+We fix issues in \\`word_infinite_datatypes.py\\` and \\`word_datatype.py\\` and now with this ticket, there are a lot less failing doctests in \\`sage/combinat/words\\`:\n+\n+\\`\\`\\`\n+----------------------------------------------------------------------\n+sage -t abstract_word.py  # 4 doctests failed\n+sage -t word_generators.py  # 2 doctests failed\n+sage -t word.py  # 1 doctest failed\n+sage -t morphism.py  # 9 doctests failed\n+sage -t finite_word.py  # 7 doctests failed\n+----------------------------------------------------------------------\n+\\`\\`\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2018-10-11T23:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393781",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,55 @@
+with 8.4.rc0, the python 3 failures in \`sage/combinat/words\` are:
 
+\`\`\`
+----------------------------------------------------------------------
+sage -t abstract_word.py  # 13 doctests failed
+sage -t word_char.pyx  # 3 doctests failed
+sage -t word_generators.py  # 23 doctests failed
+sage -t word_infinite_datatypes.py  # 22 doctests failed
+sage -t words.py  # 7 doctests failed
+sage -t word.py  # 8 doctests failed
+sage -t word_datatypes.pyx  # 1 doctest failed
+sage -t suffix_trees.py  # 2 doctests failed
+sage -t morphism.py  # 16 doctests failed
+sage -t finite_word.py  # 73 doctests failed
+sage -t paths.py  # 15 doctests failed
+----------------------------------------------------------------------
+\`\`\`
+
+often of the following form due to \`word_infinite_datatypes.py\`:
+
+\`\`\`
+**********************************************************************
+File "word_infinite_datatypes.py", line 1035, in sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__
+Failed example:
+    w[::2]
+Exception raised:
+    Traceback (most recent call last):
+      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 659, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1070, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.combinat.words.word_infinite_datatypes.WordDatatype_iter_with_caching.__getitem__[17]>", line 1, in <module>
+        w[::Integer(2)]
+      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py", line 1161, in __getitem__
+        return super(WordDatatype_iter_with_caching,self).__getitem__(key)
+      File "/home/slabbe/GitBox/sage3/local/lib/python3.6/site-packages/sage/combinat/words/word_infinite_datatypes.py", line 874, in __getitem__
+        data = itertools.islice(self, key.start, stop, key.step)
+    ValueError: Step for islice() must be a positive integer or None.
+**********************************************************************
+\`\`\`
+
+We fix issues in \`word_infinite_datatypes.py\` and \`word_datatype.py\` and now with this ticket, there are a lot less failing doctests in \`sage/combinat/words\`:
+
+\`\`\`
+----------------------------------------------------------------------
+sage -t abstract_word.py  # 4 doctests failed
+sage -t word_generators.py  # 2 doctests failed
+sage -t word.py  # 1 doctest failed
+sage -t morphism.py  # 9 doctests failed
+sage -t finite_word.py  # 7 doctests failed
+----------------------------------------------------------------------
+\`\`\`
 
 Comment: 1
 
```




---

archive/issue_comments_393782.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-10-11T23:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393782",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_393783.json:
```json
{
    "body": "Set assignee to @vinklein.",
    "created_at": "2018-10-12T07:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393783",
    "user": "https://github.com/vinklein"
}
```

Set assignee to @vinklein.



---

archive/issue_comments_393784.json:
```json
{
    "body": "Remove assignee @vinklein.",
    "created_at": "2018-10-12T08:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393784",
    "user": "https://github.com/vinklein"
}
```

Remove assignee @vinklein.



---

archive/issue_comments_393785.json:
```json
{
    "body": "<a id='comment:11'></a>Looks good to me.\n\nPyflakes complaints are unrelated with this ticket's modifications.\n\nThanks.",
    "created_at": "2018-10-12T08:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393785",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:11'></a>Looks good to me.

Pyflakes complaints are unrelated with this ticket's modifications.

Thanks.



---

archive/issue_comments_393786.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-12T08:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393786",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065803.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-20T11:57:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26473#event-65803"
}
```



---

archive/issue_comments_393787.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-20T11:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393787",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065804.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T14:52:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26473#event-65804"
}
```



---

archive/issue_comments_393788.json:
```json
{
    "body": "<a id='comment:13'></a>This should be re-targeted for 8.5.",
    "created_at": "2018-10-28T14:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26473",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26473#issuecomment-393788",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>This should be re-targeted for 8.5.
