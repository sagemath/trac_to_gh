# Issue 26123: residue field of a valuation on a function field should be a function field when possible

archive/issues_025886.json:
```json
{
    "body": "Currently, the residue field of a non-classical valuation on a function field is not a real function field:\n\n```\nsage: R.<x> = QQ[]\nsage: v = GaussValuation(R, QQ.valuation(2))\nsage: K.<x> = FunctionField(QQ)\nsage: v = K.valuation(v)\nsage: v.residue_field()\nFraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)\n```\n\nThis ticket changes this to be `Rational function field in x over Finite Field of size 2`.\n\nCC:  swewers\n\nBranch/Commit: 34a2d1995966eaf06eea81475c64ec240b323158\n\nReviewer: Stefan Wewers\n\nAuthor: Julian R\u00fcth\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26123\n\n",
    "closed_at": "2018-09-03T23:29:39Z",
    "created_at": "2018-08-25T10:31:53Z",
    "labels": [
        "component: commutative algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "residue field of a valuation on a function field should be a function field when possible",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26123",
    "user": "https://github.com/saraedum"
}
```
Currently, the residue field of a non-classical valuation on a function field is not a real function field:

```
sage: R.<x> = QQ[]
sage: v = GaussValuation(R, QQ.valuation(2))
sage: K.<x> = FunctionField(QQ)
sage: v = K.valuation(v)
sage: v.residue_field()
Fraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)
```

This ticket changes this to be `Rational function field in x over Finite Field of size 2`.

CC:  swewers

Branch/Commit: 34a2d1995966eaf06eea81475c64ec240b323158

Reviewer: Stefan Wewers

Author: Julian Rüth

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26123





---

archive/issue_comments_495799.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-25T14:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495799",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_495800.json:
```json
{
    "body": "Changing work_issues from \"\" to \"is the patchbot happy?\"",
    "created_at": "2018-08-25T14:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495800",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "" to "is the patchbot happy?"



---

archive/issue_comments_495801.json:
```json
{
    "body": "Changing branch from \"\" to \"u/saraedum/26123\"",
    "created_at": "2018-08-25T14:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495801",
    "user": "https://github.com/saraedum"
}
```

Changing branch from "" to "u/saraedum/26123"



---

archive/issue_comments_495802.json:
```json
{
    "body": "Changing commit from \"\" to \"a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39\"",
    "created_at": "2018-08-25T15:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495802",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing commit from "" to "a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39"



---

archive/issue_comments_495803.json:
```json
{
    "body": "<a id='comment:4'></a>\nThere should be a test that `v.reduce(f)` works in this situation. \nThe docstring for `reduce` test this only for standard valuations,\nwhere the residue field is not a function field. \n\n---\nNew commits:\n|                                                                                                                                          |                                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|\n|[a5c8755](https://github.com/sagemath/sagetrac-mirror/commit/a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39)|`Make residue_ring of a valuation on a function field a function field`|",
    "created_at": "2018-08-25T15:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495803",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

<a id='comment:4'></a>
There should be a test that `v.reduce(f)` works in this situation. 
The docstring for `reduce` test this only for standard valuations,
where the residue field is not a function field. 

---
New commits:
|                                                                                                                                          |                                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|
|[a5c8755](https://github.com/sagemath/sagetrac-mirror/commit/a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39)|`Make residue_ring of a valuation on a function field a function field`|



---

archive/issue_comments_495804.json:
```json
{
    "body": "<a id='comment:5'></a>\nWe have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.",
    "created_at": "2018-08-26T11:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495804",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:5'></a>
We have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.



---

archive/issue_comments_495805.json:
```json
{
    "body": "<a id='comment:6'></a>\nHm\u2026so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)",
    "created_at": "2018-08-26T11:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495805",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:6'></a>
Hm…so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)



---

archive/issue_comments_495806.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy?\" to \"is the patchbot happy? no.\"",
    "created_at": "2018-08-26T11:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495806",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "is the patchbot happy?" to "is the patchbot happy? no."



---

archive/issue_comments_495807.json:
```json
{
    "body": "Changing commit from \"a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39\" to \"09e076f57175cfe4f421bdf3bfd333a1cf7b4239\"",
    "created_at": "2018-08-27T15:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39" to "09e076f57175cfe4f421bdf3bfd333a1cf7b4239"



---

archive/issue_comments_495808.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[5bb3a1f](https://github.com/sagemath/sagetrac-mirror/commit/5bb3a1f605cdd1aa8b23abb3963c61b2619d0ae5)|`Merge remote-tracking branch 'trac/develop' into 26123`|\n|[09e076f](https://github.com/sagemath/sagetrac-mirror/commit/09e076f57175cfe4f421bdf3bfd333a1cf7b4239)|`Fix residue_ring() for pseudo-valuations on function fields`|",
    "created_at": "2018-08-27T15:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495808",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[5bb3a1f](https://github.com/sagemath/sagetrac-mirror/commit/5bb3a1f605cdd1aa8b23abb3963c61b2619d0ae5)|`Merge remote-tracking branch 'trac/develop' into 26123`|
|[09e076f](https://github.com/sagemath/sagetrac-mirror/commit/09e076f57175cfe4f421bdf3bfd333a1cf7b4239)|`Fix residue_ring() for pseudo-valuations on function fields`|



---

archive/issue_comments_495809.json:
```json
{
    "body": "<a id='comment:9'></a>\nNew commits:\n|                                                                                                                                          |                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[5bb3a1f](https://github.com/sagemath/sagetrac-mirror/commit/5bb3a1f605cdd1aa8b23abb3963c61b2619d0ae5)|`Merge remote-tracking branch 'trac/develop' into 26123`|\n|[09e076f](https://github.com/sagemath/sagetrac-mirror/commit/09e076f57175cfe4f421bdf3bfd333a1cf7b4239)|`Fix residue_ring() for pseudo-valuations on function fields`|",
    "created_at": "2018-08-27T15:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495809",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:9'></a>
New commits:
|                                                                                                                                          |                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[5bb3a1f](https://github.com/sagemath/sagetrac-mirror/commit/5bb3a1f605cdd1aa8b23abb3963c61b2619d0ae5)|`Merge remote-tracking branch 'trac/develop' into 26123`|
|[09e076f](https://github.com/sagemath/sagetrac-mirror/commit/09e076f57175cfe4f421bdf3bfd333a1cf7b4239)|`Fix residue_ring() for pseudo-valuations on function fields`|



---

archive/issue_comments_495810.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy? no.\" to \"is the patchbot happy?\"",
    "created_at": "2018-08-27T15:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495810",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "is the patchbot happy? no." to "is the patchbot happy?"



---

archive/issue_comments_495811.json:
```json
{
    "body": "<a id='comment:10'></a>\nTrivial pyflakes error:\n\n   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used\n\nOtherwise, everything is fine.",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495811",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

<a id='comment:10'></a>
Trivial pyflakes error:

   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used

Otherwise, everything is fine.



---

archive/issue_comments_495812.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Stefan Wewers\"",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495812",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing reviewer from "" to "Stefan Wewers"



---

archive/issue_comments_495813.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495813",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_495814.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy?\" to \"is the patchbot happy? no\"",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495814",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing work_issues from "is the patchbot happy?" to "is the patchbot happy? no"



---

archive/issue_comments_495815.json:
```json
{
    "body": "Changing commit from \"09e076f57175cfe4f421bdf3bfd333a1cf7b4239\" to \"34a2d1995966eaf06eea81475c64ec240b323158\"",
    "created_at": "2018-08-29T01:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495815",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "09e076f57175cfe4f421bdf3bfd333a1cf7b4239" to "34a2d1995966eaf06eea81475c64ec240b323158"



---

archive/issue_comments_495816.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[274f2e0](https://github.com/sagemath/sagetrac-mirror/commit/274f2e0693c38a5bc340670d3479274d7dc9f9c8)|`fix pyflakes warning`|\n|[34a2d19](https://github.com/sagemath/sagetrac-mirror/commit/34a2d1995966eaf06eea81475c64ec240b323158)|`Fix doctest output in documentation`|",
    "created_at": "2018-08-29T01:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495816",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[274f2e0](https://github.com/sagemath/sagetrac-mirror/commit/274f2e0693c38a5bc340670d3479274d7dc9f9c8)|`fix pyflakes warning`|
|[34a2d19](https://github.com/sagemath/sagetrac-mirror/commit/34a2d1995966eaf06eea81475c64ec240b323158)|`Fix doctest output in documentation`|



---

archive/issue_comments_495817.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy? no\" to \"is the patchbot happy?\"",
    "created_at": "2018-08-29T01:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495817",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "is the patchbot happy? no" to "is the patchbot happy?"



---

archive/issue_comments_495818.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-29T01:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495818",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_495819.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy?\" to \"\"",
    "created_at": "2018-08-29T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495819",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing work_issues from "is the patchbot happy?" to ""



---

archive/issue_comments_495820.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-29T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495820",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_081884.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-03T23:29:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26123#event-81884"
}
```



---

archive/issue_comments_495821.json:
```json
{
    "body": "Changing branch from \"u/saraedum/26123\" to \"34a2d1995966eaf06eea81475c64ec240b323158\"",
    "created_at": "2018-09-03T23:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495821",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/saraedum/26123" to "34a2d1995966eaf06eea81475c64ec240b323158"



---

archive/issue_comments_495822.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-03T23:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-495822",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
