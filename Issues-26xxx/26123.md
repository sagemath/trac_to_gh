# Issue 26123: residue field of a valuation on a function field should be a function field when possible

archive/issues_025886.json:
```json
{
    "body": "Currently, the residue field of a non-classical valuation on a function field is not a real function field:\n\n```\nsage: R.<x> = QQ[]\nsage: v = GaussValuation(R, QQ.valuation(2))\nsage: K.<x> = FunctionField(QQ)\nsage: v = K.valuation(v)\nsage: v.residue_field()\nFraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)\n```\n\nThis ticket changes this to be `Rational function field in x over Finite Field of size 2`.\n\nCC:  swewers\n\nBranch/Commit: 34a2d1995966eaf06eea81475c64ec240b323158\n\nReviewer: Stefan Wewers\n\nAuthor: Julian R\u00fcth\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26123\n\n",
    "closed_at": "2018-09-03T23:29:39Z",
    "created_at": "2018-08-25T10:31:53Z",
    "labels": [
        "component: commutative algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "residue field of a valuation on a function field should be a function field when possible",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26123",
    "user": "https://github.com/saraedum"
}
```
Currently, the residue field of a non-classical valuation on a function field is not a real function field:

```
sage: R.<x> = QQ[]
sage: v = GaussValuation(R, QQ.valuation(2))
sage: K.<x> = FunctionField(QQ)
sage: v = K.valuation(v)
sage: v.residue_field()
Fraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)
```

This ticket changes this to be `Rational function field in x over Finite Field of size 2`.

CC:  swewers

Branch/Commit: 34a2d1995966eaf06eea81475c64ec240b323158

Reviewer: Stefan Wewers

Author: Julian Rüth

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26123





---

archive/issue_comments_502105.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2018-08-25T10:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502105",
    "user": "https://github.com/saraedum"
}
```

Changing priority from major to minor.



---

archive/issue_comments_502106.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-25T14:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502106",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_502107.json:
```json
{
    "body": "Changing work_issues from \"\" to \"is the patchbot happy?\"",
    "created_at": "2018-08-25T14:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502107",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "" to "is the patchbot happy?"



---

archive/issue_comments_502108.json:
```json
{
    "body": "Changing branch from \"\" to \"u/saraedum/26123\"",
    "created_at": "2018-08-25T14:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502108",
    "user": "https://github.com/saraedum"
}
```

Changing branch from "" to "u/saraedum/26123"



---

archive/issue_comments_502109.json:
```json
{
    "body": "Changing commit from \"\" to \"a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39\"",
    "created_at": "2018-08-25T15:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502109",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing commit from "" to "a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39"



---

archive/issue_comments_502110.json:
```json
{
    "body": "<a id='comment:4'></a>There should be a test that `v.reduce(f)` works in this situation. \nThe docstring for `reduce` test this only for standard valuations,\nwhere the residue field is not a function field. \n\n---\nNew commits:",
    "created_at": "2018-08-25T15:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502110",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

<a id='comment:4'></a>There should be a test that `v.reduce(f)` works in this situation. 
The docstring for `reduce` test this only for standard valuations,
where the residue field is not a function field. 

---
New commits:



---

archive/issue_comments_502111.json:
```json
{
    "body": "<a id='comment:5'></a>We have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.",
    "created_at": "2018-08-26T11:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502111",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:5'></a>We have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.



---

archive/issue_comments_502112.json:
```json
{
    "body": "<a id='comment:6'></a>Hm\u2026so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)",
    "created_at": "2018-08-26T11:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502112",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:6'></a>Hm…so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)



---

archive/issue_comments_502113.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy?\" to \"is the patchbot happy? no.\"",
    "created_at": "2018-08-26T11:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502113",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "is the patchbot happy?" to "is the patchbot happy? no."



---

archive/issue_comments_502114.json:
```json
{
    "body": "Changing commit from \"a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39\" to \"09e076f57175cfe4f421bdf3bfd333a1cf7b4239\"",
    "created_at": "2018-08-27T15:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502114",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a5c8755fb98f1f9f0125bcbe2e604d6c2849ba39" to "09e076f57175cfe4f421bdf3bfd333a1cf7b4239"



---

archive/issue_comments_502115.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-27T15:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502115",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_502116.json:
```json
{
    "body": "<a id='comment:9'></a>New commits:",
    "created_at": "2018-08-27T15:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502116",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:9'></a>New commits:



---

archive/issue_comments_502117.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy? no.\" to \"is the patchbot happy?\"",
    "created_at": "2018-08-27T15:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502117",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "is the patchbot happy? no." to "is the patchbot happy?"



---

archive/issue_comments_502118.json:
```json
{
    "body": "<a id='comment:10'></a>Trivial pyflakes error:\n\n   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used\n\nOtherwise, everything is fine.",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502118",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

<a id='comment:10'></a>Trivial pyflakes error:

   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used

Otherwise, everything is fine.



---

archive/issue_comments_502119.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Stefan Wewers\"",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502119",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing reviewer from "" to "Stefan Wewers"



---

archive/issue_comments_502120.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502120",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_502121.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy?\" to \"is the patchbot happy? no\"",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502121",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing work_issues from "is the patchbot happy?" to "is the patchbot happy? no"



---

archive/issue_comments_502122.json:
```json
{
    "body": "Changing commit from \"09e076f57175cfe4f421bdf3bfd333a1cf7b4239\" to \"34a2d1995966eaf06eea81475c64ec240b323158\"",
    "created_at": "2018-08-29T01:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "09e076f57175cfe4f421bdf3bfd333a1cf7b4239" to "34a2d1995966eaf06eea81475c64ec240b323158"



---

archive/issue_comments_502123.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-29T01:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502123",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_502124.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy? no\" to \"is the patchbot happy?\"",
    "created_at": "2018-08-29T01:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502124",
    "user": "https://github.com/saraedum"
}
```

Changing work_issues from "is the patchbot happy? no" to "is the patchbot happy?"



---

archive/issue_comments_502125.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-29T01:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502125",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_502126.json:
```json
{
    "body": "Changing work_issues from \"is the patchbot happy?\" to \"\"",
    "created_at": "2018-08-29T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502126",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing work_issues from "is the patchbot happy?" to ""



---

archive/issue_comments_502127.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-29T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502127",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065156.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-03T23:29:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26123#event-65156"
}
```



---

archive/issue_comments_502128.json:
```json
{
    "body": "Changing branch from \"u/saraedum/26123\" to \"34a2d1995966eaf06eea81475c64ec240b323158\"",
    "created_at": "2018-09-03T23:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502128",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/saraedum/26123" to "34a2d1995966eaf06eea81475c64ec240b323158"



---

archive/issue_comments_502129.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-03T23:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26123",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26123#issuecomment-502129",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
