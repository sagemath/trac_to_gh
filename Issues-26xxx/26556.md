# Issue 26556: multiplicative order for square matrices over ZZ

archive/issues_026319.json:
```json
{
    "assignees": [],
    "body": "references:\n\nhttps://magma.maths.usyd.edu.au/magma/handbook/text/659\n\nand https://www.jstor.org/stable/2695329\n\nCC:  @videlec @ClementPernet @tscrim\n\nBranch/Commit: **[`1b4e065`](https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26556_\n\n",
    "closed_at": "2018-10-28T20:26:16Z",
    "created_at": "2018-10-25T19:16:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "multiplicative order for square matrices over ZZ",
    "type": "issue",
    "updated_at": "2018-10-28T20:26:16Z",
    "url": "https://github.com/sagemath/sage/issues/26556",
    "user": "https://github.com/fchapoton"
}
```
references:

https://magma.maths.usyd.edu.au/magma/handbook/text/659

and https://www.jstor.org/stable/2695329

CC:  @videlec @ClementPernet @tscrim

Branch/Commit: **[`1b4e065`](https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474)**

Reviewer: **Travis Scrimshaw**

Author: **Frédéric Chapoton**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/26556_





---

archive/issue_events_365646.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-25T19:16:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365646"
}
```



---

archive/issue_events_365647.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-25T19:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365647"
}
```



---

archive/issue_events_365648.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-25T19:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365648"
}
```



---

archive/issue_events_365649.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-25T19:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365649"
}
```



---

archive/issue_comments_409421.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe111033adf5cfc0d068a1f2fb2b4e588f10da52\"><code>fe11103</code></a></td><td><code>multiplicative order for matrices over ZZ</code></td></tr></table>\n",
    "created_at": "2018-10-25T19:16:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409421",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe111033adf5cfc0d068a1f2fb2b4e588f10da52"><code>fe11103</code></a></td><td><code>multiplicative order for matrices over ZZ</code></td></tr></table>




---

archive/issue_comments_409422.json:
```json
{
    "body": "Branch: **[u/chapoton/26556](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26556)**",
    "created_at": "2018-10-25T19:16:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409422",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/26556](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26556)**



---

archive/issue_comments_409423.json:
```json
{
    "body": "Commit: **[`fe11103`](https://github.com/sagemath/sagetrac-mirror/commit/fe111033adf5cfc0d068a1f2fb2b4e588f10da52)**",
    "created_at": "2018-10-25T19:16:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409423",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`fe11103`](https://github.com/sagemath/sagetrac-mirror/commit/fe111033adf5cfc0d068a1f2fb2b4e588f10da52)**



---

archive/issue_events_365650.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-25T19:16:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365650"
}
```



---

archive/issue_comments_409424.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI am not sure it makes sense to test twice if the base ring is finite. Why not do\n\n```\nif K in Fields.Finite:\n    ...\nelif K is ZZ:\n    ...\nelse:\n    raise NotImplementedError\n```\n(note that you do not have to actually construct the instance of the category to check containment).\n\nAlso, in `impossible_order`, should it be `GL_n(ZZ)`?\n\nI might be too much an iterative programmer, but I don't see the point of having the `impossible_order` as a separate function, I don't see much benefit to not doing\n\n```python\n            # Check if o1 can be an order of a matrix in GL_n(QQ)\n            # Uses Thm 2.7 [KuPa2002]\n            fac = o1.factor()\n            S = sum((pi - 1) * pi**(ei - 1) for pi, ei in fac)\n            if S > n + int(fac[0] == (2, 1)):\n                return Infinity\n```",
    "created_at": "2018-10-26T01:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409424",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:2" align="right">comment:2</div>

I am not sure it makes sense to test twice if the base ring is finite. Why not do

```
if K in Fields.Finite:
    ...
elif K is ZZ:
    ...
else:
    raise NotImplementedError
```
(note that you do not have to actually construct the instance of the category to check containment).

Also, in `impossible_order`, should it be `GL_n(ZZ)`?

I might be too much an iterative programmer, but I don't see the point of having the `impossible_order` as a separate function, I don't see much benefit to not doing

```python
            # Check if o1 can be an order of a matrix in GL_n(QQ)
            # Uses Thm 2.7 [KuPa2002]
            fac = o1.factor()
            S = sum((pi - 1) * pi**(ei - 1) for pi, ei in fac)
            if S > n + int(fac[0] == (2, 1)):
                return Infinity
```



---

archive/issue_comments_409425.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/721c96632573081510754089b05137b6956f2edf\"><code>721c966</code></a></td><td><code>trac 26556 some details</code></td></tr></table>\n",
    "created_at": "2018-10-26T06:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409425",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/721c96632573081510754089b05137b6956f2edf"><code>721c966</code></a></td><td><code>trac 26556 some details</code></td></tr></table>




---

archive/issue_comments_409426.json:
```json
{
    "body": "Changed commit from **[`fe11103`](https://github.com/sagemath/sagetrac-mirror/commit/fe111033adf5cfc0d068a1f2fb2b4e588f10da52)** to **[`721c966`](https://github.com/sagemath/sagetrac-mirror/commit/721c96632573081510754089b05137b6956f2edf)**",
    "created_at": "2018-10-26T06:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409426",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fe11103`](https://github.com/sagemath/sagetrac-mirror/commit/fe111033adf5cfc0d068a1f2fb2b4e588f10da52)** to **[`721c966`](https://github.com/sagemath/sagetrac-mirror/commit/721c96632573081510754089b05137b6956f2edf)**



---

archive/issue_comments_409427.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\ncuriosity: why is that valid?\n\n```\nif o1 != o2:\n    return Infinity\n```",
    "created_at": "2018-10-26T07:05:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409427",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

curiosity: why is that valid?

```
if o1 != o2:
    return Infinity
```



---

archive/issue_comments_409428.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAccording to the given reference (Jstor) and magma doc, the projection of every finite subgroup  of GL_n(QQ) modulo any odd prime number is injective. So if we find two different orders for a matrix modulo two different primes, the original matrix cannot have finite order.",
    "created_at": "2018-10-26T07:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409428",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

According to the given reference (Jstor) and magma doc, the projection of every finite subgroup  of GL_n(QQ) modulo any odd prime number is injective. So if we find two different orders for a matrix modulo two different primes, the original matrix cannot have finite order.



---

archive/issue_comments_409429.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f829c4eb13a3b226b6916a940e522ea9844cd870\"><code>f829c4e</code></a></td><td><code>trac 26556 adding more doctests</code></td></tr></table>\n",
    "created_at": "2018-10-26T14:19:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409429",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f829c4eb13a3b226b6916a940e522ea9844cd870"><code>f829c4e</code></a></td><td><code>trac 26556 adding more doctests</code></td></tr></table>




---

archive/issue_comments_409430.json:
```json
{
    "body": "Changed commit from **[`721c966`](https://github.com/sagemath/sagetrac-mirror/commit/721c96632573081510754089b05137b6956f2edf)** to **[`f829c4e`](https://github.com/sagemath/sagetrac-mirror/commit/f829c4eb13a3b226b6916a940e522ea9844cd870)**",
    "created_at": "2018-10-26T14:19:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409430",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`721c966`](https://github.com/sagemath/sagetrac-mirror/commit/721c96632573081510754089b05137b6956f2edf)** to **[`f829c4e`](https://github.com/sagemath/sagetrac-mirror/commit/f829c4eb13a3b226b6916a940e522ea9844cd870)**



---

archive/issue_comments_409431.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe doctests in `f829c4e` is likely to test only infinite order examples (a random matrix has infinite order). You would better add some known finite order examples (and also test conjugates).",
    "created_at": "2018-10-26T15:19:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409431",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

The doctests in `f829c4e` is likely to test only infinite order examples (a random matrix has infinite order). You would better add some known finite order examples (and also test conjugates).



---

archive/issue_comments_409432.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@videlec](#comment:7):\n> The doctests in `f829c4e` is likely to test only infinite order examples (a random matrix has infinite order). You would better add some known finite order examples (and also test conjugates).\n\nNo, it does also provide a few finite order examples..",
    "created_at": "2018-10-26T15:20:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409432",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@videlec](#comment:7):
> The doctests in `f829c4e` is likely to test only infinite order examples (a random matrix has infinite order). You would better add some known finite order examples (and also test conjugates).

No, it does also provide a few finite order examples..



---

archive/issue_comments_409433.json:
```json
{
    "body": "Changed commit from **[`f829c4e`](https://github.com/sagemath/sagetrac-mirror/commit/f829c4eb13a3b226b6916a940e522ea9844cd870)** to **[`1b4e065`](https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474)**",
    "created_at": "2018-10-26T15:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409433",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f829c4e`](https://github.com/sagemath/sagetrac-mirror/commit/f829c4eb13a3b226b6916a940e522ea9844cd870)** to **[`1b4e065`](https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474)**



---

archive/issue_comments_409434.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474\"><code>1b4e065</code></a></td><td><code>trac 26556 one more doctest</code></td></tr></table>\n",
    "created_at": "2018-10-26T15:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409434",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474"><code>1b4e065</code></a></td><td><code>trac 26556 one more doctest</code></td></tr></table>




---

archive/issue_comments_409435.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI have added another doctest, a matrix of size 8 and order 24, conjugated at random.",
    "created_at": "2018-10-26T15:38:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409435",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

I have added another doctest, a matrix of size 8 and order 24, conjugated at random.



---

archive/issue_comments_409436.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2018-10-27T02:30:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409436",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_409437.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nVincent, any other comments? Otherwise I will set a positive review.",
    "created_at": "2018-10-27T02:30:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409437",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

Vincent, any other comments? Otherwise I will set a positive review.



---

archive/issue_comments_409438.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nGood for me.",
    "created_at": "2018-10-27T08:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409438",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

Good for me.



---

archive/issue_comments_409439.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThank you.",
    "created_at": "2018-10-27T13:08:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409439",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Thank you.



---

archive/issue_events_365651.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-10-27T13:08:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365651"
}
```



---

archive/issue_events_365652.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-10-27T13:08:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365652"
}
```



---

archive/issue_events_365653.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-28T20:26:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365653"
}
```



---

archive/issue_events_365654.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "96db4788391619bb7e35d6cccda2944b22f72b15",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-10-28T20:26:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26556#event-365654"
}
```



---

archive/issue_comments_409440.json:
```json
{
    "body": "Changed branch from **[u/chapoton/26556](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26556)** to **[`1b4e065`](https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474)**",
    "created_at": "2018-10-28T20:26:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26556#issuecomment-409440",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/26556](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26556)** to **[`1b4e065`](https://github.com/sagemath/sagetrac-mirror/commit/1b4e0654f77dbeded4ea36c956ea4ef2b5dcf474)**
