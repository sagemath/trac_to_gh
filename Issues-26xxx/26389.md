# Issue 26389: Listing meataxe matrices with zero rows is broken

archive/issues_026152.json:
```json
{
    "body": "CC:  simonking\n\n```\nsage: Matrix(GF(9), 0, 3)._list()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-673c5638db92> in <module>()\n----> 1 Matrix(GF(Integer(9)), Integer(0), Integer(3))._list()\n\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/matrix/matrix_gfpn_dense.pyx in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense._list (build/cythonized/sage/matrix/matrix_gfpn_dense.c:9038)()\n    908             FfStepPtr(&(p))\n    909             sig_check()\n--> 910         x.extend([self._converter.int_to_field(FfToInt(FfExtract(p,j))) for j in range(self.Data.Noc)])\n    911         self.cache('list', x)\n    912         return x\n\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/matrix/matrix_gfpn_dense.pyx in sage.matrix.matrix_gfpn_dense.FieldConverter_class.int_to_field (build/cythonized/sage/matrix/matrix_gfpn_dense.c:3717)()\n    135 \n    136         \"\"\"\n--> 137         return self.field(x)\n    138     cpdef int field_to_int(self, x):\n    139         \"\"\"\n\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_givaro.pyx in sage.rings.finite_rings.element_givaro.Cache_givaro.fetch_int (build/cythonized/sage/rings/finite_rings/element_givaro.cpp:8618)()\n    591 \n    592         if n<0 or n>k.cardinality():\n--> 593             raise TypeError(\"n must be between 0 and self.order()\")\n    594 \n    595         for i from 0 <= i < k.exponent():\n\nTypeError: n must be between 0 and self.order()\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/26389\n\n",
    "closed_at": "2018-10-20T11:58:32Z",
    "created_at": "2018-10-03T10:34:22Z",
    "labels": [
        "component: interfaces: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "Listing meataxe matrices with zero rows is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26389",
    "user": "https://github.com/tscrim"
}
```
CC:  simonking

```
sage: Matrix(GF(9), 0, 3)._list()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-673c5638db92> in <module>()
----> 1 Matrix(GF(Integer(9)), Integer(0), Integer(3))._list()

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/matrix/matrix_gfpn_dense.pyx in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense._list (build/cythonized/sage/matrix/matrix_gfpn_dense.c:9038)()
    908             FfStepPtr(&(p))
    909             sig_check()
--> 910         x.extend([self._converter.int_to_field(FfToInt(FfExtract(p,j))) for j in range(self.Data.Noc)])
    911         self.cache('list', x)
    912         return x

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/matrix/matrix_gfpn_dense.pyx in sage.matrix.matrix_gfpn_dense.FieldConverter_class.int_to_field (build/cythonized/sage/matrix/matrix_gfpn_dense.c:3717)()
    135 
    136         """
--> 137         return self.field(x)
    138     cpdef int field_to_int(self, x):
    139         """

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_givaro.pyx in sage.rings.finite_rings.element_givaro.Cache_givaro.fetch_int (build/cythonized/sage/rings/finite_rings/element_givaro.cpp:8618)()
    591 
    592         if n<0 or n>k.cardinality():
--> 593             raise TypeError("n must be between 0 and self.order()")
    594 
    595         for i from 0 <= i < k.exponent():

TypeError: n must be between 0 and self.order()
```

Issue created by migration from https://trac.sagemath.org/ticket/26389





---

archive/issue_comments_368219.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2018-10-03T15:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368219",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_368220.json:
```json
{
    "body": "> Do you know offhand (i.e., don't spend much time on this) of a simple way I can extract out the relevant matrix >computation? This is not a minimal example, and it would be useful to get it down smaller.\n\n\nRight. But I didn't see the failure from the doctest yet, even after I installed meataxe to my installation (on mac). Do you have a specific procedure likely to encounter the failure?",
    "created_at": "2018-10-04T00:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368220",
    "user": "https://github.com/kwankyu"
}
```

> Do you know offhand (i.e., don't spend much time on this) of a simple way I can extract out the relevant matrix >computation? This is not a minimal example, and it would be useful to get it down smaller.


Right. But I didn't see the failure from the doctest yet, even after I installed meataxe to my installation (on mac). Do you have a specific procedure likely to encounter the failure?



---

archive/issue_comments_368221.json:
```json
{
    "body": "Replying to [comment:2 klee]:\n> > Do you know offhand (i.e., don't spend much time on this) of a simple way I can extract out the relevant matrix >computation? This is not a minimal example, and it would be useful to get it down smaller.\n\n> \n> Right. But I didn't see the failure from the doctest yet, even after I installed meataxe to my installation (on mac). Do you have a specific procedure likely to encounter the failure?  \n\n\nYou may also have to run `sage -b`. However, it doesn't always happen, which is the annoying part. Usually I just run `sage -tp` on the file a bunch of times and it happens with some reasonable frequency.",
    "created_at": "2018-10-04T00:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368221",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:2 klee]:
> > Do you know offhand (i.e., don't spend much time on this) of a simple way I can extract out the relevant matrix >computation? This is not a minimal example, and it would be useful to get it down smaller.

> 
> Right. But I didn't see the failure from the doctest yet, even after I installed meataxe to my installation (on mac). Do you have a specific procedure likely to encounter the failure?  


You may also have to run `sage -b`. However, it doesn't always happen, which is the annoying part. Usually I just run `sage -tp` on the file a bunch of times and it happens with some reasonable frequency.



---

archive/issue_comments_368222.json:
```json
{
    "body": "Still no failure from \n\n```\n for i in {1..100}; do sage -tp src/sage/rings/function_field/ideal.py; done\n```\non mac, after `sage -i meataxe; make`",
    "created_at": "2018-10-04T04:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368222",
    "user": "https://github.com/kwankyu"
}
```

Still no failure from 

```
 for i in {1..100}; do sage -tp src/sage/rings/function_field/ideal.py; done
```
on mac, after `sage -i meataxe; make`



---

archive/issue_comments_368223.json:
```json
{
    "body": "Replying to [ticket:26389 tscrim]:\n> There is likely an issue with `Matrix_gfpn_dense` or `meataxe`, which is likely caused by where things are in memory. This was first noticed by the following test in `rings/function_field/ideal.py`:\n\n\nQuestion: Are you using a special branch? Or do you mean the test in `sage/rings/function_field/function_field_ideal.py`, not `sage/rings/function_field/ideal.py` (which doesn't exist)?\n\nWhen running the tests in `.../function_field_ideal.py` a hundred times, I get no problems whatsoever. And yes, I do have meataxe installed (using it intensively in computations with the p_group_cohomology package).\n\nThis raises the question what kind of machine you are using. Anything special concerning endianness, size of long, I think I recall there can also be issues regarding whether char is signed or not?",
    "created_at": "2018-10-05T10:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368223",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [ticket:26389 tscrim]:
> There is likely an issue with `Matrix_gfpn_dense` or `meataxe`, which is likely caused by where things are in memory. This was first noticed by the following test in `rings/function_field/ideal.py`:


Question: Are you using a special branch? Or do you mean the test in `sage/rings/function_field/function_field_ideal.py`, not `sage/rings/function_field/ideal.py` (which doesn't exist)?

When running the tests in `.../function_field_ideal.py` a hundred times, I get no problems whatsoever. And yes, I do have meataxe installed (using it intensively in computations with the p_group_cohomology package).

This raises the question what kind of machine you are using. Anything special concerning endianness, size of long, I think I recall there can also be issues regarding whether char is signed or not?



---

archive/issue_comments_368224.json:
```json
{
    "body": "Replying to [comment:5 SimonKing]:\n> Replying to [ticket:26389 tscrim]:\n> > There is likely an issue with `Matrix_gfpn_dense` or `meataxe`, which is likely caused by where things are in memory. This was first noticed by the following test in `rings/function_field/ideal.py`:\n\n> \n> Question: Are you using a special branch? Or do you mean the test in `sage/rings/function_field/function_field_ideal.py`, not `sage/rings/function_field/ideal.py` (which doesn't exist)?\n> \n> When running the tests in `.../function_field_ideal.py` a hundred times, I get no problems whatsoever. And yes, I do have meataxe installed (using it intensively in computations with the p_group_cohomology package).\n\n\nNo, I am running vanilla 8.4.beta7. It seems like you are running 8.4.beta6 or below (specifically, this was added in #25435).\n\n> This raises the question what kind of machine you are using. Anything special concerning endianness, size of long, I think I recall there can also be issues regarding whether char is signed or not?\n\n\nI have seen this arise on multiple patchbots from multiple tickets ([sardonis on 25477](https://patchbot.sagemath.org/log/25477/Ubuntu/16.04/ppc64le/4.4.0-124-generic/sardonis/2018-10-03%2003:21:26?short), [sage4 on 12053](https://patchbot.sagemath.org/log/12053/Gentoo%20Base%20System/2.2/x86_64/4.4.26-gentoo/sage4/2018-10-05%2001:58:09?short), [sage4 on 26400](https://patchbot.sagemath.org/log/26400/Gentoo%20Base%20System/2.2/x86_64/4.4.26-gentoo/sage4/2018-10-04%2015:16:29?short)). I don't think I have anything special. I kinda recall there being a signed char issue, but I thought you had fixed that.",
    "created_at": "2018-10-05T10:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368224",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:5 SimonKing]:
> Replying to [ticket:26389 tscrim]:
> > There is likely an issue with `Matrix_gfpn_dense` or `meataxe`, which is likely caused by where things are in memory. This was first noticed by the following test in `rings/function_field/ideal.py`:

> 
> Question: Are you using a special branch? Or do you mean the test in `sage/rings/function_field/function_field_ideal.py`, not `sage/rings/function_field/ideal.py` (which doesn't exist)?
> 
> When running the tests in `.../function_field_ideal.py` a hundred times, I get no problems whatsoever. And yes, I do have meataxe installed (using it intensively in computations with the p_group_cohomology package).


No, I am running vanilla 8.4.beta7. It seems like you are running 8.4.beta6 or below (specifically, this was added in #25435).

> This raises the question what kind of machine you are using. Anything special concerning endianness, size of long, I think I recall there can also be issues regarding whether char is signed or not?


I have seen this arise on multiple patchbots from multiple tickets ([sardonis on 25477](https://patchbot.sagemath.org/log/25477/Ubuntu/16.04/ppc64le/4.4.0-124-generic/sardonis/2018-10-03%2003:21:26?short), [sage4 on 12053](https://patchbot.sagemath.org/log/12053/Gentoo%20Base%20System/2.2/x86_64/4.4.26-gentoo/sage4/2018-10-05%2001:58:09?short), [sage4 on 26400](https://patchbot.sagemath.org/log/26400/Gentoo%20Base%20System/2.2/x86_64/4.4.26-gentoo/sage4/2018-10-04%2015:16:29?short)). I don't think I have anything special. I kinda recall there being a signed char issue, but I thought you had fixed that.



---

archive/issue_comments_368225.json:
```json
{
    "body": "Replying to [comment:4 klee]:\n> Still no failure from \n> \n> ```\n>  for i in {1..100}; do sage -tp src/sage/rings/function_field/ideal.py; done\n> ```\n> on mac, after `sage -i meataxe; make`\n\n\nMaybe it is not something that shows up on macs (I am running Ubuntu 16.04 LTS).",
    "created_at": "2018-10-05T10:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368225",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:4 klee]:
> Still no failure from 
> 
> ```
>  for i in {1..100}; do sage -tp src/sage/rings/function_field/ideal.py; done
> ```
> on mac, after `sage -i meataxe; make`


Maybe it is not something that shows up on macs (I am running Ubuntu 16.04 LTS).



---

archive/issue_comments_368226.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n> No, I am running vanilla 8.4.beta7. It seems like you are running 8.4.beta6 or below (specifically, this was added in #25435).\n\n\nThat would explain it: I got\n\n```\nsage: version()\n'SageMath version 8.4.beta5, Release Date: 2018-09-15'\n```\n\nOK, I'll try to see what I can do.\n\nEDIT: I'll use the current develop branch merged with the branch that introduces singular-4.1.1.p3.",
    "created_at": "2018-10-05T10:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368226",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:6 tscrim]:
> No, I am running vanilla 8.4.beta7. It seems like you are running 8.4.beta6 or below (specifically, this was added in #25435).


That would explain it: I got

```
sage: version()
'SageMath version 8.4.beta5, Release Date: 2018-09-15'
```

OK, I'll try to see what I can do.

EDIT: I'll use the current develop branch merged with the branch that introduces singular-4.1.1.p3.



---

archive/issue_comments_368227.json:
```json
{
    "body": "After upgrading, I indeed get frequent errors with that test, namely twice the same test in the same file:\n\n```\nFile \"src/sage/rings/function_field/ideal.py\", line 2581, in sage.rings.function_field.ideal.FunctionFieldIdealInfinite_global.is_prime\nFailed example:\n    I.factor()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 659, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1070, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.function_field.ideal.FunctionFieldIdealInfinite_global.is_prime[4]>\", line 1, in <module>\n        I.factor()\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py\", line 2673, in factor\n        return Factorization(self._factor(), cr=True)\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py\", line 2695, in _factor\n        for iprime, exp in O._to_iF(self).factor():\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py\", line 1574, in factor\n        return Factorization(self._factor(), cr=True)\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py\", line 1600, in _factor\n        qs = [q[0] for q in O.decomposition(prime)]\n      File \"sage/misc/cachefunc.pyx\", line 1953, in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10824)\n        w = self._instance_call(*args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1829, in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10280)\n        return self.f(self._instance, *args, **kwds)\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/order.py\", line 1840, in decomposition\n        Jb =[Kb[0]] + [div(Kb[j],Kb[j-1]) for j in range(1,len(Kb))]\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/order.py\", line 1807, in div\n        sJbsIb,proj_sJbsIb,lift_sJbsIb = sJb.quotient_abstract(sIb)\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/modules/free_module.py\", line 4548, in quotient_abstract\n        if check and (not is_FreeModule(sub) or not sub.is_subspace(self)):\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/modules/free_module.py\", line 3792, in is_subspace\n        return self.is_submodule(other)\n      File \"/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/modules/free_module.py\", line 1460, in is_submodule\n        return all(x in S for x in M.list())\n      File \"sage/matrix/matrix0.pyx\", line 156, in sage.matrix.matrix0.Matrix.list (build/cythonized/sage/matrix/matrix0.c:4165)\n        return list(self._list())\n      File \"sage/matrix/matrix_gfpn_dense.pyx\", line 910, in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense._list (build/cythonized/sage/matrix/matrix_gfpn_dense.c:9038)\n        x.extend([self._converter.int_to_field(FfToInt(FfExtract(p,j))) for j in range(self.Data.Noc)])\n      File \"sage/matrix/matrix_gfpn_dense.pyx\", line 137, in sage.matrix.matrix_gfpn_dense.FieldConverter_class.int_to_field (build/cythonized/sage/matrix/matrix_gfpn_dense.c:3717)\n        return self.field(x)\n      File \"sage/rings/finite_rings/element_givaro.pyx\", line 593, in sage.rings.finite_rings.element_givaro.Cache_givaro.fetch_int (build/cythonized/sage/rings/finite_rings/element_givaro.cpp:8618)\n        raise TypeError(\"n must be between 0 and self.order()\")\n    TypeError: n must be between 0 and self.order()\n```\nThe error seems to indicate that the matrix contains items that do not belong to the underlying field. And that sounds pretty much like a memory corruption.\n\nI cannot dive into it at the moment (need to prepare a written exam to be held tomorrow), but at least I can confirm the problem.",
    "created_at": "2018-10-07T06:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368227",
    "user": "https://github.com/simon-king-jena"
}
```

After upgrading, I indeed get frequent errors with that test, namely twice the same test in the same file:

```
File "src/sage/rings/function_field/ideal.py", line 2581, in sage.rings.function_field.ideal.FunctionFieldIdealInfinite_global.is_prime
Failed example:
    I.factor()
Exception raised:
    Traceback (most recent call last):
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 659, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1070, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.function_field.ideal.FunctionFieldIdealInfinite_global.is_prime[4]>", line 1, in <module>
        I.factor()
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py", line 2673, in factor
        return Factorization(self._factor(), cr=True)
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py", line 2695, in _factor
        for iprime, exp in O._to_iF(self).factor():
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py", line 1574, in factor
        return Factorization(self._factor(), cr=True)
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/ideal.py", line 1600, in _factor
        qs = [q[0] for q in O.decomposition(prime)]
      File "sage/misc/cachefunc.pyx", line 1953, in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10824)
        w = self._instance_call(*args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1829, in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10280)
        return self.f(self._instance, *args, **kwds)
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/order.py", line 1840, in decomposition
        Jb =[Kb[0]] + [div(Kb[j],Kb[j-1]) for j in range(1,len(Kb))]
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/rings/function_field/order.py", line 1807, in div
        sJbsIb,proj_sJbsIb,lift_sJbsIb = sJb.quotient_abstract(sIb)
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/modules/free_module.py", line 4548, in quotient_abstract
        if check and (not is_FreeModule(sub) or not sub.is_subspace(self)):
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/modules/free_module.py", line 3792, in is_subspace
        return self.is_submodule(other)
      File "/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/modules/free_module.py", line 1460, in is_submodule
        return all(x in S for x in M.list())
      File "sage/matrix/matrix0.pyx", line 156, in sage.matrix.matrix0.Matrix.list (build/cythonized/sage/matrix/matrix0.c:4165)
        return list(self._list())
      File "sage/matrix/matrix_gfpn_dense.pyx", line 910, in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense._list (build/cythonized/sage/matrix/matrix_gfpn_dense.c:9038)
        x.extend([self._converter.int_to_field(FfToInt(FfExtract(p,j))) for j in range(self.Data.Noc)])
      File "sage/matrix/matrix_gfpn_dense.pyx", line 137, in sage.matrix.matrix_gfpn_dense.FieldConverter_class.int_to_field (build/cythonized/sage/matrix/matrix_gfpn_dense.c:3717)
        return self.field(x)
      File "sage/rings/finite_rings/element_givaro.pyx", line 593, in sage.rings.finite_rings.element_givaro.Cache_givaro.fetch_int (build/cythonized/sage/rings/finite_rings/element_givaro.cpp:8618)
        raise TypeError("n must be between 0 and self.order()")
    TypeError: n must be between 0 and self.order()
```
The error seems to indicate that the matrix contains items that do not belong to the underlying field. And that sounds pretty much like a memory corruption.

I cannot dive into it at the moment (need to prepare a written exam to be held tomorrow), but at least I can confirm the problem.



---

archive/issue_comments_368228.json:
```json
{
    "body": "The good thing is that it seems not to be caused by some obscure side-effect of other tests: I did\n\n```\nsage: K.<x> = FunctionField(GF(3^2)); _.<t> = PolynomialRing(K)\nsage: F.<y> = K.extension(t^3 + t^2 - x^4)\nsage: Oinf = F.maximal_order_infinite()\nsage: I = Oinf.ideal(1/x)\nsage: I.factor()\n```\nin three new Sage sessions. The first two times the test worked. The third time it failed.",
    "created_at": "2018-10-07T06:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368228",
    "user": "https://github.com/simon-king-jena"
}
```

The good thing is that it seems not to be caused by some obscure side-effect of other tests: I did

```
sage: K.<x> = FunctionField(GF(3^2)); _.<t> = PolynomialRing(K)
sage: F.<y> = K.extension(t^3 + t^2 - x^4)
sage: Oinf = F.maximal_order_infinite()
sage: I = Oinf.ideal(1/x)
sage: I.factor()
```
in three new Sage sessions. The first two times the test worked. The third time it failed.



---

archive/issue_comments_368229.json:
```json
{
    "body": "Please do not always change the ticket description. It makes me get a long mail (stating the old description but not the new one). Moreover it hides what you have actually changed (unless one clicks on the \"diff\" button).\n\nSo please, when you dig further, write a comment.",
    "created_at": "2018-10-08T09:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368229",
    "user": "https://github.com/simon-king-jena"
}
```

Please do not always change the ticket description. It makes me get a long mail (stating the old description but not the new one). Moreover it hides what you have actually changed (unless one clicks on the "diff" button).

So please, when you dig further, write a comment.



---

archive/issue_comments_368230.json:
```json
{
    "body": "Since its optional I don't really see this as a blocker; Though if a simple bugfix materializes really soon I'd consider merging it...",
    "created_at": "2018-10-11T22:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368230",
    "user": "https://github.com/vbraun"
}
```

Since its optional I don't really see this as a blocker; Though if a simple bugfix materializes really soon I'd consider merging it...



---

archive/issue_comments_368231.json:
```json
{
    "body": "Nice! So, the problem is just a corner case that was forgotten to be dealt with in my *wrapper* for SharedMeatAxe. That's a big relief. I thought it would be caused by a problem in SharedMeatAxe's memory management.",
    "created_at": "2018-10-15T11:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368231",
    "user": "https://github.com/simon-king-jena"
}
```

Nice! So, the problem is just a corner case that was forgotten to be dealt with in my *wrapper* for SharedMeatAxe. That's a big relief. I thought it would be caused by a problem in SharedMeatAxe's memory management.



---

archive/issue_comments_368232.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-10-15T11:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368232",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_368233.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-15T11:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368233",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_368234.json:
```json
{
    "body": "The mystery is why this bug suddenly shows up now. As far as I can tell (by looking at git history), this has been broken all the time since #12103.",
    "created_at": "2018-10-15T11:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368234",
    "user": "https://github.com/jdemeyer"
}
```

The mystery is why this bug suddenly shows up now. As far as I can tell (by looking at git history), this has been broken all the time since #12103.



---

archive/issue_comments_368235.json:
```json
{
    "body": "Replying to [comment:23 jdemeyer]:\n> The mystery is why this bug suddenly shows up now. As far as I can tell (by looking at git history), this has been broken all the time since #12103.\n\n\nWell, it is not a big surprise if the old code accessed uninitialised memory.",
    "created_at": "2018-10-15T15:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368235",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:23 jdemeyer]:
> The mystery is why this bug suddenly shows up now. As far as I can tell (by looking at git history), this has been broken all the time since #12103.


Well, it is not a big surprise if the old code accessed uninitialised memory.



---

archive/issue_comments_368236.json:
```json
{
    "body": "Patchbot passed on sage4 which has `meataxe` installed.",
    "created_at": "2018-10-15T15:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368236",
    "user": "https://github.com/jdemeyer"
}
```

Patchbot passed on sage4 which has `meataxe` installed.



---

archive/issue_comments_368237.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-18T17:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368237",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_368238.json:
```json
{
    "body": "LGTM. Thank you Jeroen.",
    "created_at": "2018-10-18T17:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368238",
    "user": "https://github.com/tscrim"
}
```

LGTM. Thank you Jeroen.



---

archive/issue_comments_368239.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-20T11:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368239",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065630.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-20T11:58:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26389#event-65630"
}
```



---

archive/issue_events_065631.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T14:52:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26389#event-65631"
}
```



---

archive/issue_comments_368240.json:
```json
{
    "body": "This should be re-targeted for 8.5.",
    "created_at": "2018-10-28T14:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26389#issuecomment-368240",
    "user": "https://github.com/embray"
}
```

This should be re-targeted for 8.5.
