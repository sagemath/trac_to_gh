# Issue 26111: Implement faster iterator for Lyndon words

archive/issues_025874.json:
```json
{
    "assignees": [],
    "body": "Having an iterator for Lyndon words with a fixed length and alphabet size is useful that does not return elements (e.g., the free Lie algebra). Moreover, by having less transient objects, we can also improve the speed.\n\nCurrent branch:\n\n```\nsage: LW = LyndonWords(11,6)\nsage: %time for x in LW: pass\nCPU times: user 2.17 s, sys: 40 ms, total: 2.21 s\nWall time: 2.17 s\n\nsage: LW = LyndonWords(11,7)\nsage: %time for x in LW: pass\nCPU times: user 20.7 s, sys: 20 ms, total: 20.7 s\nWall time: 20.7 s\n```\nvs old version:\n\n```\nsage: LW = LyndonWords(11,6)\nsage: %time for x in LW: pass\nCPU times: user 2.86 s, sys: 12 ms, total: 2.87 s\nWall time: 2.85 s\n\nsage: LW = LyndonWords(11,7)\nsage: %time for x in LW: pass\nCPU times: user 26.8 s, sys: 12 ms, total: 26.8 s\nWall time: 26.7 s\n```\n\nDepends on #25462\n\nCC:  @sagetrac-sage-combinat @mantepse @videlec\n\nBranch/Commit: **[0b4c68b](https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588)**\n\nReviewer: **Martin Rubey**\n\nAuthor: **Travis Scrimshaw**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26111_\n\n",
    "closed_at": "2018-08-29T22:31:24Z",
    "created_at": "2018-08-23T00:34:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement faster iterator for Lyndon words",
    "type": "issue",
    "updated_at": "2018-08-29T22:31:24Z",
    "url": "https://github.com/sagemath/sage/issues/26111",
    "user": "https://github.com/tscrim"
}
```
Having an iterator for Lyndon words with a fixed length and alphabet size is useful that does not return elements (e.g., the free Lie algebra). Moreover, by having less transient objects, we can also improve the speed.

Current branch:

```
sage: LW = LyndonWords(11,6)
sage: %time for x in LW: pass
CPU times: user 2.17 s, sys: 40 ms, total: 2.21 s
Wall time: 2.17 s

sage: LW = LyndonWords(11,7)
sage: %time for x in LW: pass
CPU times: user 20.7 s, sys: 20 ms, total: 20.7 s
Wall time: 20.7 s
```
vs old version:

```
sage: LW = LyndonWords(11,6)
sage: %time for x in LW: pass
CPU times: user 2.86 s, sys: 12 ms, total: 2.87 s
Wall time: 2.85 s

sage: LW = LyndonWords(11,7)
sage: %time for x in LW: pass
CPU times: user 26.8 s, sys: 12 ms, total: 26.8 s
Wall time: 26.7 s
```

Depends on #25462

CC:  @sagetrac-sage-combinat @mantepse @videlec

Branch/Commit: **[0b4c68b](https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588)**

Reviewer: **Martin Rubey**

Author: **Travis Scrimshaw**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/26111_





---

archive/issue_events_360487.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-23T00:34:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360487"
}
```



---

archive/issue_events_360488.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-23T00:34:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360488"
}
```



---

archive/issue_events_360489.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-23T00:34:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360489"
}
```



---

archive/issue_events_360490.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-23T00:34:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360490"
}
```



---

archive/issue_comments_402343.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdb880b3e8f19fb546019fb28aad34e32f3de328\">fdb880b</a></td><td><code>Implementing \"fast\" iterator for Lyndon words of a fixed length and alphabet size.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb\">a17239b</a></td><td><code>Using new iterator in the free Lie algebra.</code></td></tr></table>\n",
    "created_at": "2018-08-23T00:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402343",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdb880b3e8f19fb546019fb28aad34e32f3de328">fdb880b</a></td><td><code>Implementing "fast" iterator for Lyndon words of a fixed length and alphabet size.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb">a17239b</a></td><td><code>Using new iterator in the free Lie algebra.</code></td></tr></table>




---

archive/issue_events_360491.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-23T00:34:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360491"
}
```



---

archive/issue_comments_402344.json:
```json
{
    "body": "Commit: **[a17239b](https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb)**",
    "created_at": "2018-08-23T00:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402344",
    "user": "https://github.com/tscrim"
}
```

Commit: **[a17239b](https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb)**



---

archive/issue_comments_402345.json:
```json
{
    "body": "Branch: **[public/combinat/fast_lyndon_iter-26111](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fast_lyndon_iter-26111)**",
    "created_at": "2018-08-23T00:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402345",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/combinat/fast_lyndon_iter-26111](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fast_lyndon_iter-26111)**



---

archive/issue_comments_402346.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nGiven #25262, it would be good to add a \"long\" doctest, so we can avoid performance regressions in future.",
    "created_at": "2018-08-23T03:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402346",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:2" align="right">comment:2</div>

Given #25262, it would be good to add a "long" doctest, so we can avoid performance regressions in future.



---

archive/issue_comments_402347.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nNotes to myself:\n\nThere seem to be Gray codes available, eg:\n\n* https://hal.inria.fr/hal-00966527/document\n* http://www.cis.uoguelph.ca/~sawada/papers/bubble4.pdf\n\n(Note that the very simple iterative algorithm on page 217 of Ruskey's book visits also the necklaces.)",
    "created_at": "2018-08-23T03:45:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402347",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:3" align="right">comment:3</div>

Notes to myself:

There seem to be Gray codes available, eg:

* https://hal.inria.fr/hal-00966527/document
* http://www.cis.uoguelph.ca/~sawada/papers/bubble4.pdf

(Note that the very simple iterative algorithm on page 217 of Ruskey's book visits also the necklaces.)



---

archive/issue_comments_402348.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21\">bbacc76</a></td><td><code>Added long test to lyndon_word.py.</code></td></tr></table>\n",
    "created_at": "2018-08-23T07:27:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402348",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21">bbacc76</a></td><td><code>Added long test to lyndon_word.py.</code></td></tr></table>




---

archive/issue_comments_402349.json:
```json
{
    "body": "Changed commit from **[a17239b](https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb)** to **[bbacc76](https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21)**",
    "created_at": "2018-08-23T07:27:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402349",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a17239b](https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb)** to **[bbacc76](https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21)**



---

archive/issue_comments_402350.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@mantepse](#comment:2):\n> Given #25262, it would be good to add a \"long\" doctest, so we can avoid performance regressions in future.\n\nThat is not really how #25262 is suppose to work, and I don't believe is a better way to catch regressions (there will be less noise, but the noise will still be there). However, I've added it.",
    "created_at": "2018-08-23T07:31:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402350",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@mantepse](#comment:2):
> Given #25262, it would be good to add a "long" doctest, so we can avoid performance regressions in future.

That is not really how #25262 is suppose to work, and I don't believe is a better way to catch regressions (there will be less noise, but the noise will still be there). However, I've added it.



---

archive/issue_comments_402351.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHere is a naive implementation of the iterative FKM algorithm from Ruskey's book. I couldn't get http://puma.dimai.unifi.it/17_1_2/weston.pdf to work, and I haven't checked what it's advantage would be.\n\nI won't steel the joy of timing this from you :-)\n\n```\ndef FKM_iterativ(k, n):\n    a = [0]*(n+1)\n    if n == 1:\n        yield a[:]\n    i = n;\n    while True:\n        a[i] += 1\n        for j in range(1, n-i+1):\n            a[j + i] = a[j]\n        if n == i:            \n            yield a[:]\n        i = n\n        while a[i] == k-1:\n            i -= 1\n        if i == 0:\n            break\n```",
    "created_at": "2018-08-23T19:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402351",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:6" align="right">comment:6</div>

Here is a naive implementation of the iterative FKM algorithm from Ruskey's book. I couldn't get http://puma.dimai.unifi.it/17_1_2/weston.pdf to work, and I haven't checked what it's advantage would be.

I won't steel the joy of timing this from you :-)

```
def FKM_iterativ(k, n):
    a = [0]*(n+1)
    if n == 1:
        yield a[:]
    i = n;
    while True:
        a[i] += 1
        for j in range(1, n-i+1):
            a[j + i] = a[j]
        if n == i:            
            yield a[:]
        i = n
        while a[i] == k-1:
            i -= 1
        if i == 0:
            break
```



---

archive/issue_comments_402352.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32\">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f\">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5\">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3\">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/947233c544347fd6938f69357ecdd0fd16df2878\">947233c</a></td><td><code>Merge branch 'public/25462' of git://trac.sagemath.org/sage into public/combinat/speedup_set_partitions-25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a79e30251c4757969d0b849ce47c4fc07fcc3456\">a79e302</a></td><td><code>Reverted to an_element() and added some additional reviewer changes.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003\">87bf535</a></td><td><code>Cythonizing iterator.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3\">ba6a115</a></td><td><code>Fixing doctests due to ordering change.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95d5d9190b1f149507d91839edbd1bdcefeb152f\">95d5d91</a></td><td><code>Merge branch 'public/combinat/speedup_set_partitions-25462' of git://trac.sagemath.org/sage into public/combinat/fast_lyndon_iter-26111</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e\">8cc9d0e</a></td><td><code>Using a Cython version of FKM algorithm to generate Lyndon words.</code></td></tr></table>\n",
    "created_at": "2018-08-24T00:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402352",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/947233c544347fd6938f69357ecdd0fd16df2878">947233c</a></td><td><code>Merge branch 'public/25462' of git://trac.sagemath.org/sage into public/combinat/speedup_set_partitions-25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a79e30251c4757969d0b849ce47c4fc07fcc3456">a79e302</a></td><td><code>Reverted to an_element() and added some additional reviewer changes.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003">87bf535</a></td><td><code>Cythonizing iterator.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3">ba6a115</a></td><td><code>Fixing doctests due to ordering change.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95d5d9190b1f149507d91839edbd1bdcefeb152f">95d5d91</a></td><td><code>Merge branch 'public/combinat/speedup_set_partitions-25462' of git://trac.sagemath.org/sage into public/combinat/fast_lyndon_iter-26111</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e">8cc9d0e</a></td><td><code>Using a Cython version of FKM algorithm to generate Lyndon words.</code></td></tr></table>




---

archive/issue_comments_402353.json:
```json
{
    "body": "Changed commit from **[bbacc76](https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21)** to **[8cc9d0e](https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e)**",
    "created_at": "2018-08-24T00:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402353",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bbacc76](https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21)** to **[8cc9d0e](https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e)**



---

archive/issue_comments_402354.json:
```json
{
    "body": "Dependencies: **#25462**",
    "created_at": "2018-08-24T00:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402354",
    "user": "https://github.com/tscrim"
}
```

Dependencies: **#25462**



---

archive/issue_comments_402355.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe \"joy\" of timing...sure...\n\nAnyways...that was a good find. The FKM algorithm is *much* faster than what was previously there (approximately 4x faster):\n\n```\nsage: %time for l in generate_lyndon_words(11,6): pass\nCPU times: user 1.74 s, sys: 36 ms, total: 1.78 s\nWall time: 1.76 s\nsage: %time for l in FKM_iterative(11,6): pass\nCPU times: user 452 ms, sys: 32 ms, total: 484 ms\nWall time: 432 ms\n\nsage: %time for l in generate_lyndon_words(11,7): pass\nCPU times: user 16.7 s, sys: 28 ms, total: 16.7 s\nWall time: 16.7 s\nsage: %time for l in FKM_iterative(11,7): pass\nCPU times: user 3.75 s, sys: 28 ms, total: 3.78 s\nWall time: 3.74 s\n```\n\nWith Cython (approximate another 10x speedup):\n\n```\nsage: %time for l in FKM_iterative_cython(11,6): pass\nCPU times: user 36 ms, sys: 20 ms, total: 56 ms\nWall time: 40.7 ms\nsage: %time for l in FKM_iterative_cython(11,7): pass\nCPU times: user 340 ms, sys: 12 ms, total: 352 ms\nWall time: 322 ms\n```\n\nI have merged in #25462 and added the Cython code in such a way as to not (add) conflict with #25659.",
    "created_at": "2018-08-24T00:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402355",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

The "joy" of timing...sure...

Anyways...that was a good find. The FKM algorithm is *much* faster than what was previously there (approximately 4x faster):

```
sage: %time for l in generate_lyndon_words(11,6): pass
CPU times: user 1.74 s, sys: 36 ms, total: 1.78 s
Wall time: 1.76 s
sage: %time for l in FKM_iterative(11,6): pass
CPU times: user 452 ms, sys: 32 ms, total: 484 ms
Wall time: 432 ms

sage: %time for l in generate_lyndon_words(11,7): pass
CPU times: user 16.7 s, sys: 28 ms, total: 16.7 s
Wall time: 16.7 s
sage: %time for l in FKM_iterative(11,7): pass
CPU times: user 3.75 s, sys: 28 ms, total: 3.78 s
Wall time: 3.74 s
```

With Cython (approximate another 10x speedup):

```
sage: %time for l in FKM_iterative_cython(11,6): pass
CPU times: user 36 ms, sys: 20 ms, total: 56 ms
Wall time: 40.7 ms
sage: %time for l in FKM_iterative_cython(11,7): pass
CPU times: user 340 ms, sys: 12 ms, total: 352 ms
Wall time: 322 ms
```

I have merged in #25462 and added the Cython code in such a way as to not (add) conflict with #25659.



---

archive/issue_comments_402356.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nGreat! (sorry, I actually did think that you would enjoy the timing)\n\nOne thing I do not yet understand: on my laptop, FKM is roughly 12 times faster than the original iterator (i.e., without this ticket).\n\nI'll try this ticket now to check.",
    "created_at": "2018-08-24T08:33:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402356",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:9" align="right">comment:9</div>

Great! (sorry, I actually did think that you would enjoy the timing)

One thing I do not yet understand: on my laptop, FKM is roughly 12 times faster than the original iterator (i.e., without this ticket).

I'll try this ticket now to check.



---

archive/issue_comments_402357.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nDear Travis!\n\nThe following cuts the time by a half, but I'm not sure whether it's correct...  What do you think?  (more precisely: should it really be `FiniteWord_char`?)\n\n```diff\ndiff --git a/src/sage/combinat/lyndon_word.py b/src/sage/combinat/lyndon_word.py\nindex 880dd4139c..15d0f56d41 100644\n--- a/src/sage/combinat/lyndon_word.py\n+++ b/src/sage/combinat/lyndon_word.py\n@@ -457,8 +457,9 @@ class LyndonWords_nk(UniqueRepresentation, Parent):\n             sage: sum(1 for lw in LyndonWords(11, 6))  # long time\n             295020\n         \"\"\"\n+        from sage.combinat.words.word import FiniteWord_char\n         for lw in generate_lyndon_words(self._n, self._k):\n-            yield self._words([i+1 for i in lw], check=False)\n+            yield FiniteWord_char(self._words, [i+1 for i in lw])\n \n def StandardBracketedLyndonWords(n, k):\n     \"\"\"\n```",
    "created_at": "2018-08-24T17:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402357",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:10" align="right">comment:10</div>

Dear Travis!

The following cuts the time by a half, but I'm not sure whether it's correct...  What do you think?  (more precisely: should it really be `FiniteWord_char`?)

```diff
diff --git a/src/sage/combinat/lyndon_word.py b/src/sage/combinat/lyndon_word.py
index 880dd4139c..15d0f56d41 100644
--- a/src/sage/combinat/lyndon_word.py
+++ b/src/sage/combinat/lyndon_word.py
@@ -457,8 +457,9 @@ class LyndonWords_nk(UniqueRepresentation, Parent):
             sage: sum(1 for lw in LyndonWords(11, 6))  # long time
             295020
         """
+        from sage.combinat.words.word import FiniteWord_char
         for lw in generate_lyndon_words(self._n, self._k):
-            yield self._words([i+1 for i in lw], check=False)
+            yield FiniteWord_char(self._words, [i+1 for i in lw])
 
 def StandardBracketedLyndonWords(n, k):
     """
```



---

archive/issue_comments_402358.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nTo be nicer with the words code use\n\n```\nself._words.element_classes['char'](self._words, [i+1 for i in lw])\n```\nThat should roughly be the same. And you can even keep a reference `W = self._words.element_classes['char']` to save extra micro seconds.",
    "created_at": "2018-08-24T17:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402358",
    "user": "https://github.com/videlec"
}
```

<div id="comment:11" align="right">comment:11</div>

To be nicer with the words code use

```
self._words.element_classes['char'](self._words, [i+1 for i in lw])
```
That should roughly be the same. And you can even keep a reference `W = self._words.element_classes['char']` to save extra micro seconds.



---

archive/issue_comments_402359.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThank you Vincent!\n\nHowever, it turns out that \"char\" is probably incorrect:\n\n```\nsage: list(LyndonWords(1000,1))\nOverflowError: value too large to convert to unsigned char\n```\nSo it should be\n\n```diff\ndiff --git a/src/sage/combinat/lyndon_word.py b/src/sage/combinat/lyndon_word.py\nindex 880dd4139c..8c0f49cfdd 100644\n--- a/src/sage/combinat/lyndon_word.py\n+++ b/src/sage/combinat/lyndon_word.py\n@@ -457,8 +457,9 @@ class LyndonWords_nk(UniqueRepresentation, Parent):\n             sage: sum(1 for lw in LyndonWords(11, 6))  # long time\n             295020\n         \"\"\"\n+        W = self._words._element_classes['list']\n         for lw in generate_lyndon_words(self._n, self._k):\n-            yield self._words([i+1 for i in lw], check=False)\n+            yield W(self._words, [i+1 for i in lw])\n \n def StandardBracketedLyndonWords(n, k):\n     \"\"\"\n```\n\nThis doesn't seem to be essentially slower than \"char\"...",
    "created_at": "2018-08-24T18:54:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402359",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:12" align="right">comment:12</div>

Thank you Vincent!

However, it turns out that "char" is probably incorrect:

```
sage: list(LyndonWords(1000,1))
OverflowError: value too large to convert to unsigned char
```
So it should be

```diff
diff --git a/src/sage/combinat/lyndon_word.py b/src/sage/combinat/lyndon_word.py
index 880dd4139c..8c0f49cfdd 100644
--- a/src/sage/combinat/lyndon_word.py
+++ b/src/sage/combinat/lyndon_word.py
@@ -457,8 +457,9 @@ class LyndonWords_nk(UniqueRepresentation, Parent):
             sage: sum(1 for lw in LyndonWords(11, 6))  # long time
             295020
         """
+        W = self._words._element_classes['list']
         for lw in generate_lyndon_words(self._n, self._k):
-            yield self._words([i+1 for i in lw], check=False)
+            yield W(self._words, [i+1 for i in lw])
 
 def StandardBracketedLyndonWords(n, k):
     """
```

This doesn't seem to be essentially slower than "char"...



---

archive/issue_comments_402360.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n@tscrim, a tiny thing:\n\n```diff\ndiff --git a/src/sage/algebras/lie_algebras/free_lie_algebra.py b/src/sage/algebras/lie_algebras/free_lie_algebra.py\nindex 1d0665d225..49fcf058c9 100644\n--- a/src/sage/algebras/lie_algebras/free_lie_algebra.py\n+++ b/src/sage/algebras/lie_algebras/free_lie_algebra.py\n@@ -809,7 +809,7 @@ class FreeLieAlgebra(Parent, UniqueRepresentation):\n             n = len(self._indices)\n             ret = []\n             for lw in generate_lyndon_words(n, k):\n-                b = self._standard_bracket(tuple([names[i] for i in lw]))\n+                b = self._standard_bracket(tuple(names[i] for i in lw))\n                 ret.append(self.element_class(self, {b: one}))\n             return tuple(ret)\n```",
    "created_at": "2018-08-24T18:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402360",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:13" align="right">comment:13</div>

@tscrim, a tiny thing:

```diff
diff --git a/src/sage/algebras/lie_algebras/free_lie_algebra.py b/src/sage/algebras/lie_algebras/free_lie_algebra.py
index 1d0665d225..49fcf058c9 100644
--- a/src/sage/algebras/lie_algebras/free_lie_algebra.py
+++ b/src/sage/algebras/lie_algebras/free_lie_algebra.py
@@ -809,7 +809,7 @@ class FreeLieAlgebra(Parent, UniqueRepresentation):
             n = len(self._indices)
             ret = []
             for lw in generate_lyndon_words(n, k):
-                b = self._standard_bracket(tuple([names[i] for i in lw]))
+                b = self._standard_bracket(tuple(names[i] for i in lw))
                 ret.append(self.element_class(self, {b: one}))
             return tuple(ret)
```



---

archive/issue_comments_402361.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAnother one:\n\n```diff\ndiff --git a/src/sage/algebras/lie_algebras/free_lie_algebra.py b/src/sage/algebras/lie_algebras/free_lie_algebra.py\nindex 1d0665d225..1ef05a7f4f 100644\n--- a/src/sage/algebras/lie_algebras/free_lie_algebra.py\n+++ b/src/sage/algebras/lie_algebras/free_lie_algebra.py\n@@ -774,13 +774,13 @@ class FreeLieAlgebra(Parent, UniqueRepresentation):\n                  [x0, [[x0, x1], x1]],\n                  [x0, [x0, [x1, x2]]],\n                  [x0, [[x0, x2], x1]],\n-                 [[x0, x1], [x0, x2]],\n                  [x0, [[x0, x2], x2]],\n+                 [[x0, x1], [x0, x2]],\n                  [[[x0, x1], x1], x1],\n                  [x0, [x1, [x1, x2]]],\n                  [[x0, [x1, x2]], x1],\n-                 [[[x0, x2], x1], x1],\n                  [x0, [[x1, x2], x2]],\n+                 [[[x0, x2], x1], x1],\n                  [[x0, x2], [x1, x2]],\n                  [[[x0, x2], x2], x1],\n                  [[[x0, x2], x2], x2],\n```",
    "created_at": "2018-08-24T18:59:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402361",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:14" align="right">comment:14</div>

Another one:

```diff
diff --git a/src/sage/algebras/lie_algebras/free_lie_algebra.py b/src/sage/algebras/lie_algebras/free_lie_algebra.py
index 1d0665d225..1ef05a7f4f 100644
--- a/src/sage/algebras/lie_algebras/free_lie_algebra.py
+++ b/src/sage/algebras/lie_algebras/free_lie_algebra.py
@@ -774,13 +774,13 @@ class FreeLieAlgebra(Parent, UniqueRepresentation):
                  [x0, [[x0, x1], x1]],
                  [x0, [x0, [x1, x2]]],
                  [x0, [[x0, x2], x1]],
-                 [[x0, x1], [x0, x2]],
                  [x0, [[x0, x2], x2]],
+                 [[x0, x1], [x0, x2]],
                  [[[x0, x1], x1], x1],
                  [x0, [x1, [x1, x2]]],
                  [[x0, [x1, x2]], x1],
-                 [[[x0, x2], x1], x1],
                  [x0, [[x1, x2], x2]],
+                 [[[x0, x2], x1], x1],
                  [[x0, x2], [x1, x2]],
                  [[[x0, x2], x2], x1],
                  [[[x0, x2], x2], x2],
```



---

archive/issue_comments_402362.json:
```json
{
    "body": "Reviewer: **Martin Rubey**",
    "created_at": "2018-08-24T18:59:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402362",
    "user": "https://github.com/mantepse"
}
```

Reviewer: **Martin Rubey**



---

archive/issue_comments_402363.json:
```json
{
    "body": "Changed commit from **[8cc9d0e](https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e)** to **[7b25ddc](https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f)**",
    "created_at": "2018-08-24T21:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402363",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8cc9d0e](https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e)** to **[7b25ddc](https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f)**



---

archive/issue_comments_402364.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f\">7b25ddc</a></td><td><code>Using faster generator for LyndonWords and fixing doctest in free_lie_algebra.py.</code></td></tr></table>\n",
    "created_at": "2018-08-24T21:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402364",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f">7b25ddc</a></td><td><code>Using faster generator for LyndonWords and fixing doctest in free_lie_algebra.py.</code></td></tr></table>




---

archive/issue_comments_402365.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThe change in [comment:13](#comment:13) is actually slower in both Python and Cython. It has something to do with how Python constructs these things internally (but I agree that it is counter-intuitive).\n\nWith [comment:12](#comment:12):\n\n```\nsage: LW = LyndonWords(11,6)\nsage: %time for x in LW: pass\nCPU times: user 200 ms, sys: 21.3 ms, total: 222 ms\nWall time: 201 ms\nsage: LW = LyndonWords(11,7)\nsage: %time for x in LW: pass\nCPU times: user 1.85 s, sys: 8.12 ms, total: 1.85 s\nWall time: 1.84 s\n```\nvs old\n\n```\nsage: LW = LyndonWords(11,6)\nsage: %time for x in LW: pass\nCPU times: user 475 ms, sys: 42.2 ms, total: 518 ms\nWall time: 465 ms\nsage: LW = LyndonWords(11,7)\nsage: %time for x in LW: pass\nCPU times: user 4.25 s, sys: 17.8 ms, total: 4.27 s\nWall time: 4.24 s\n```",
    "created_at": "2018-08-24T21:44:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402365",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

The change in [comment:13](#comment:13) is actually slower in both Python and Cython. It has something to do with how Python constructs these things internally (but I agree that it is counter-intuitive).

With [comment:12](#comment:12):

```
sage: LW = LyndonWords(11,6)
sage: %time for x in LW: pass
CPU times: user 200 ms, sys: 21.3 ms, total: 222 ms
Wall time: 201 ms
sage: LW = LyndonWords(11,7)
sage: %time for x in LW: pass
CPU times: user 1.85 s, sys: 8.12 ms, total: 1.85 s
Wall time: 1.84 s
```
vs old

```
sage: LW = LyndonWords(11,6)
sage: %time for x in LW: pass
CPU times: user 475 ms, sys: 42.2 ms, total: 518 ms
Wall time: 465 ms
sage: LW = LyndonWords(11,7)
sage: %time for x in LW: pass
CPU times: user 4.25 s, sys: 17.8 ms, total: 4.27 s
Wall time: 4.24 s
```



---

archive/issue_comments_402366.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOne more doctest, a pyflakes thing, and a corner case:\n\n`sum(1 for lw in LyndonWords(1, 1000))` is stupid, but (with this patch) it kills my computer by filling up the memory really quickly.  Without this patch, it hits the recursion limit, whereas it gives `0` (which is correct) up to and including length 988.\n\n```diff\n\ndiff --git a/src/sage/combinat/combinat_cython.pyx b/src/sage/combinat/combinat_cython.pyx\nindex 1a53431a5a..227e5d8900 100644\n--- a/src/sage/combinat/combinat_cython.pyx\n+++ b/src/sage/combinat/combinat_cython.pyx\n@@ -168,6 +168,9 @@ def generate_lyndon_words(Py_ssize_t n, Py_ssize_t k):\n \n         sage: list(generate_lyndon_words(5, 0))\n         []\n+\n+        sage: list(generate_lyndon_words(1, 1000))\n+        []\n     \"\"\"\n     cdef Py_ssize_t i, j\n     if k == 0:\n@@ -176,6 +179,8 @@ def generate_lyndon_words(Py_ssize_t n, Py_ssize_t k):\n         for i in range(n):\n             yield [i]\n         return\n+    if n == 1:\n+        return\n \n     cdef list a = [0] * (k+1)\n     i = k\ndiff --git a/src/sage/combinat/lyndon_word.py b/src/sage/combinat/lyndon_word.py\nindex 8c0f49cfdd..306f7a3cf9 100644\n--- a/src/sage/combinat/lyndon_word.py\n+++ b/src/sage/combinat/lyndon_word.py\n@@ -23,7 +23,6 @@ from sage.arith.all import factorial, divisors, gcd, moebius\n from sage.misc.all import prod\n \n from . import necklace\n-from sage.combinat.integer_vector import IntegerVectors, integer_vectors_nk_fast_iter\n from sage.combinat.words.words import FiniteWords\n from sage.combinat.combinat_cython import generate_lyndon_words\n \n@@ -456,6 +455,12 @@ class LyndonWords_nk(UniqueRepresentation, Parent):\n \n             sage: sum(1 for lw in LyndonWords(11, 6))  # long time\n             295020\n+\n+            sage: sum(1 for lw in LyndonWords(1000, 1))\n+            1000\n+\n+            sage: sum(1 for lw in LyndonWords(1, 1000))\n+            0\n         \"\"\"\n         W = self._words._element_classes['list']\n         for lw in generate_lyndon_words(self._n, self._k):\n```",
    "created_at": "2018-08-25T07:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402366",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:18" align="right">comment:18</div>

One more doctest, a pyflakes thing, and a corner case:

`sum(1 for lw in LyndonWords(1, 1000))` is stupid, but (with this patch) it kills my computer by filling up the memory really quickly.  Without this patch, it hits the recursion limit, whereas it gives `0` (which is correct) up to and including length 988.

```diff

diff --git a/src/sage/combinat/combinat_cython.pyx b/src/sage/combinat/combinat_cython.pyx
index 1a53431a5a..227e5d8900 100644
--- a/src/sage/combinat/combinat_cython.pyx
+++ b/src/sage/combinat/combinat_cython.pyx
@@ -168,6 +168,9 @@ def generate_lyndon_words(Py_ssize_t n, Py_ssize_t k):
 
         sage: list(generate_lyndon_words(5, 0))
         []
+
+        sage: list(generate_lyndon_words(1, 1000))
+        []
     """
     cdef Py_ssize_t i, j
     if k == 0:
@@ -176,6 +179,8 @@ def generate_lyndon_words(Py_ssize_t n, Py_ssize_t k):
         for i in range(n):
             yield [i]
         return
+    if n == 1:
+        return
 
     cdef list a = [0] * (k+1)
     i = k
diff --git a/src/sage/combinat/lyndon_word.py b/src/sage/combinat/lyndon_word.py
index 8c0f49cfdd..306f7a3cf9 100644
--- a/src/sage/combinat/lyndon_word.py
+++ b/src/sage/combinat/lyndon_word.py
@@ -23,7 +23,6 @@ from sage.arith.all import factorial, divisors, gcd, moebius
 from sage.misc.all import prod
 
 from . import necklace
-from sage.combinat.integer_vector import IntegerVectors, integer_vectors_nk_fast_iter
 from sage.combinat.words.words import FiniteWords
 from sage.combinat.combinat_cython import generate_lyndon_words
 
@@ -456,6 +455,12 @@ class LyndonWords_nk(UniqueRepresentation, Parent):
 
             sage: sum(1 for lw in LyndonWords(11, 6))  # long time
             295020
+
+            sage: sum(1 for lw in LyndonWords(1000, 1))
+            1000
+
+            sage: sum(1 for lw in LyndonWords(1, 1000))
+            0
         """
         W = self._words._element_classes['list']
         for lw in generate_lyndon_words(self._n, self._k):
```



---

archive/issue_comments_402367.json:
```json
{
    "body": "Changed commit from **[7b25ddc](https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f)** to **[b9d8ee4](https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da)**",
    "created_at": "2018-08-25T07:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402367",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7b25ddc](https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f)** to **[b9d8ee4](https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da)**



---

archive/issue_comments_402368.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da\">b9d8ee4</a></td><td><code>Corner case, pyflakes, and some extra doctests.</code></td></tr></table>\n",
    "created_at": "2018-08-25T07:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402368",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da">b9d8ee4</a></td><td><code>Corner case, pyflakes, and some extra doctests.</code></td></tr></table>




---

archive/issue_comments_402369.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nFixed and added. I also added more doctests for the other corner case of `LyndonWords(1,1)`.",
    "created_at": "2018-08-25T07:51:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402369",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Fixed and added. I also added more doctests for the other corner case of `LyndonWords(1,1)`.



---

archive/issue_comments_402370.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nGood catch! Funny that the `# long` disappeared :-)\n\nI have a few hopefully final questions/requests: \n\n* since it is very likely that more and more fundamental iterators are cythonized in a similar way (eg. #25864 would probably make a lot of sense), I think it would be good to create and stick to a good naming scheme.  It might be a pain to do that later.  In short, I think `lyndon_word_iterator` would be better.\n\n* there is a typo in the docstring of the iterator, I propose the following instead:\n\n```diff\n\ndiff --git a/src/sage/combinat/combinat_cython.pyx b/src/sage/combinat/combinat_cython.pyx\nindex a3e98d3f94..84e707ce7a 100644\n--- a/src/sage/combinat/combinat_cython.pyx\n+++ b/src/sage/combinat/combinat_cython.pyx\n@@ -144,14 +144,14 @@ def _stirling_number2(n, k):\n \n def generate_lyndon_words(Py_ssize_t n, Py_ssize_t k):\n     \"\"\"\n-    Generate all Lyndon words with of length ``k`` with ``n`` letters.\n+    Generate the Lyndon words of fixed length `k` over the alphabet `{0, 1, ..., n-1}`.\n \n     The resulting Lyndon words will be words represented as lists\n     whose alphabet is ``range(n)``.\n \n     ALGORITHM:\n \n-    The FKM algorithm from *Combinatorial Generation* by Ruskey.\n+    The iterative FKM Algorithm 7.2 from *Combinatorial Generation* by Ruskey.\n \n     EXAMPLES::\n```\n\n* in the documentation of the module `lyndon_word.py`, `k` and `n` are swapped in the docstrings `class LyndonWords_nk` and `__init__` just thereafter.  Should this be fixed in a separate ticket - I think it's easier to do it now.\n\nOtherwise, I think it is ready to go.",
    "created_at": "2018-08-25T13:40:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402370",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:21" align="right">comment:21</div>

Good catch! Funny that the `# long` disappeared :-)

I have a few hopefully final questions/requests: 

* since it is very likely that more and more fundamental iterators are cythonized in a similar way (eg. #25864 would probably make a lot of sense), I think it would be good to create and stick to a good naming scheme.  It might be a pain to do that later.  In short, I think `lyndon_word_iterator` would be better.

* there is a typo in the docstring of the iterator, I propose the following instead:

```diff

diff --git a/src/sage/combinat/combinat_cython.pyx b/src/sage/combinat/combinat_cython.pyx
index a3e98d3f94..84e707ce7a 100644
--- a/src/sage/combinat/combinat_cython.pyx
+++ b/src/sage/combinat/combinat_cython.pyx
@@ -144,14 +144,14 @@ def _stirling_number2(n, k):
 
 def generate_lyndon_words(Py_ssize_t n, Py_ssize_t k):
     """
-    Generate all Lyndon words with of length ``k`` with ``n`` letters.
+    Generate the Lyndon words of fixed length `k` over the alphabet `{0, 1, ..., n-1}`.
 
     The resulting Lyndon words will be words represented as lists
     whose alphabet is ``range(n)``.
 
     ALGORITHM:
 
-    The FKM algorithm from *Combinatorial Generation* by Ruskey.
+    The iterative FKM Algorithm 7.2 from *Combinatorial Generation* by Ruskey.
 
     EXAMPLES::
```

* in the documentation of the module `lyndon_word.py`, `k` and `n` are swapped in the docstrings `class LyndonWords_nk` and `__init__` just thereafter.  Should this be fixed in a separate ticket - I think it's easier to do it now.

Otherwise, I think it is ready to go.



---

archive/issue_comments_402371.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nYou can make and push changes too. :) I am going to bed now, but can do it in the morning.",
    "created_at": "2018-08-25T13:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402371",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:22" align="right">comment:22</div>

You can make and push changes too. :) I am going to bed now, but can do it in the morning.



---

archive/issue_comments_402372.json:
```json
{
    "body": "Changed commit from **[b9d8ee4](https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da)** to **[2b3f9d4](https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795)**",
    "created_at": "2018-08-25T14:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402372",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b9d8ee4](https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da)** to **[2b3f9d4](https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795)**



---

archive/issue_comments_402373.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795\">2b3f9d4</a></td><td><code>fix doc and rename iterator</code></td></tr></table>\n",
    "created_at": "2018-08-25T14:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402373",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795">2b3f9d4</a></td><td><code>fix doc and rename iterator</code></td></tr></table>




---

archive/issue_comments_402374.json:
```json
{
    "body": "Changed commit from **[2b3f9d4](https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795)** to **[0b4c68b](https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588)**",
    "created_at": "2018-08-25T21:25:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402374",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2b3f9d4](https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795)** to **[0b4c68b](https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588)**



---

archive/issue_comments_402375.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588\">0b4c68b</a></td><td><code>A few more doc tweaks and making Ruskey a proper reference.</code></td></tr></table>\n",
    "created_at": "2018-08-25T21:25:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402375",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588">0b4c68b</a></td><td><code>A few more doc tweaks and making Ruskey a proper reference.</code></td></tr></table>




---

archive/issue_comments_402376.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThank you. I made a few other small changes: I make Ruskey into an actual reference and the 1-line description of `lyndon_word_iterator` just use `n` as code because the alphabet description is given in the main body (and I prefer to use code format as much as possible in the 1-line descriptions for methods).\n\nIf my changes are good, then positive review.",
    "created_at": "2018-08-25T21:28:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402376",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:25" align="right">comment:25</div>

Thank you. I made a few other small changes: I make Ruskey into an actual reference and the 1-line description of `lyndon_word_iterator` just use `n` as code because the alphabet description is given in the main body (and I prefer to use code format as much as possible in the 1-line descriptions for methods).

If my changes are good, then positive review.



---

archive/issue_events_360492.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-25T21:35:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360492"
}
```



---

archive/issue_events_360493.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-25T21:35:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360493"
}
```



---

archive/issue_comments_402377.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThank you.",
    "created_at": "2018-08-25T21:45:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402377",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:27" align="right">comment:27</div>

Thank you.



---

archive/issue_comments_402378.json:
```json
{
    "body": "Changed branch from **[public/combinat/fast_lyndon_iter-26111](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fast_lyndon_iter-26111)** to **[0b4c68b](https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588)**",
    "created_at": "2018-08-29T22:31:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26111#issuecomment-402378",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/combinat/fast_lyndon_iter-26111](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fast_lyndon_iter-26111)** to **[0b4c68b](https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588)**



---

archive/issue_events_360494.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-29T22:31:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360494"
}
```



---

archive/issue_events_360495.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a9a75255762134c2d17181c9d09230cc8131abe0",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-08-29T22:31:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26111",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26111#event-360495"
}
```
