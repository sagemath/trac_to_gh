# Issue 26930: add GAP io and crypting pkgs

archive/issues_026693.json:
```json
{
    "assignees": [],
    "body": "These GAP packages extend GAP kernel functionality. \nOn the libgap side, this requires tinkering with the loader, see\non #22626 Erik [proposed a patch](https://github.com/sagemath/sage/issues/22626#comment:424).\n\nHere is a branch that implements this.\n\nWe also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, done in #27218.\n\nDepends on #27218\nDepends on #27230\nDepends on #27380\n\nCC:  @embray @kiwifb @timokau @jhpalmieri @AndrewAtLarge\n\nBranch/Commit: **[`c84753f`](https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8)**\n\nReviewer: **Erik Bray**\n\nAuthor: **Dima Pasechnik, Erik Bray**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26930_\n\n",
    "closed_at": "2019-03-03T22:38:24Z",
    "created_at": "2018-12-21T11:33:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "add GAP io and crypting pkgs",
    "type": "issue",
    "updated_at": "2019-03-03T22:38:24Z",
    "url": "https://github.com/sagemath/sage/issues/26930",
    "user": "https://github.com/dimpase"
}
```
These GAP packages extend GAP kernel functionality. 
On the libgap side, this requires tinkering with the loader, see
on #22626 Erik [proposed a patch](https://github.com/sagemath/sage/issues/22626#comment:424).

Here is a branch that implements this.

We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, done in #27218.

Depends on #27218
Depends on #27230
Depends on #27380

CC:  @embray @kiwifb @timokau @jhpalmieri @AndrewAtLarge

Branch/Commit: **[`c84753f`](https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8)**

Reviewer: **Erik Bray**

Author: **Dima Pasechnik, Erik Bray**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/26930_





---

archive/issue_events_371764.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-21T11:33:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371764"
}
```



---

archive/issue_events_371765.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-21T11:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371765"
}
```



---

archive/issue_events_371766.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-21T11:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371766"
}
```



---

archive/issue_events_371767.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-12-21T11:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371767"
}
```



---

archive/issue_comments_414886.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\non OSX the dlopen call does not work. However, it does if given full path to the dll, i.e.\n\n```diff\n--- a/src/sage/libs/gap/util.pyx\n+++ b/src/sage/libs/gap/util.pyx\n@@ -263,7 +263,8 @@ cdef initialize():\n     # Note: we could use RTLD_NOLOAD and avoid the subsequent dlclose() but\n     # this isn't portable\n     cdef void* handle\n-    handle = dlopen(\"libgap.so\", RTLD_NOW | RTLD_GLOBAL)\n+    # handle = dlopen(\"libgap.so\", RTLD_NOW | RTLD_GLOBAL)\n+    handle = dlopen(\"/Users/dima/sagetrac-mirror/local/lib/python2.7/site-packages/sage/libs/gap/libgap.so\", RTLD_NOW | RTLD_GLOBAL)\n     if handle == NULL:\n         raise RuntimeError(\n                 \"Could not dlopen() libgap.so even though it should already \"\n```\nname resolution procedures are different on OSX. Actually, I don't know what's happening  on Linux so that libgap.so is found.\nPerhaps, it's already loaded on Linux, but not on OSX?",
    "created_at": "2018-12-21T13:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414886",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

on OSX the dlopen call does not work. However, it does if given full path to the dll, i.e.

```diff
--- a/src/sage/libs/gap/util.pyx
+++ b/src/sage/libs/gap/util.pyx
@@ -263,7 +263,8 @@ cdef initialize():
     # Note: we could use RTLD_NOLOAD and avoid the subsequent dlclose() but
     # this isn't portable
     cdef void* handle
-    handle = dlopen("libgap.so", RTLD_NOW | RTLD_GLOBAL)
+    # handle = dlopen("libgap.so", RTLD_NOW | RTLD_GLOBAL)
+    handle = dlopen("/Users/dima/sagetrac-mirror/local/lib/python2.7/site-packages/sage/libs/gap/libgap.so", RTLD_NOW | RTLD_GLOBAL)
     if handle == NULL:
         raise RuntimeError(
                 "Could not dlopen() libgap.so even though it should already "
```
name resolution procedures are different on OSX. Actually, I don't know what's happening  on Linux so that libgap.so is found.
Perhaps, it's already loaded on Linux, but not on OSX?



---

archive/issue_comments_414887.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThat's not really the intended \"libgap.so\".  I meant the one from GAP itself, in `$SAGE_LOCAL/lib/libgap.so`.  The re-dlopening the Python module might do it as well.\n\nThe other option, as I mentioned, would be to use Python's built-in `sys.setdlopenflags(...)`, but that has to be called before importing any modules (e.g. `sage.lib.gap.libgap`) that are linked with libgap.  It would probably be good afterwards to set it back to its default which is `RTLD_LAZY`.\n\nBut yes, it's probably more portable either way to give a full path to the relevant shared object.",
    "created_at": "2018-12-21T13:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414887",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">comment:2</div>

That's not really the intended "libgap.so".  I meant the one from GAP itself, in `$SAGE_LOCAL/lib/libgap.so`.  The re-dlopening the Python module might do it as well.

The other option, as I mentioned, would be to use Python's built-in `sys.setdlopenflags(...)`, but that has to be called before importing any modules (e.g. `sage.lib.gap.libgap`) that are linked with libgap.  It would probably be good afterwards to set it back to its default which is `RTLD_LAZY`.

But yes, it's probably more portable either way to give a full path to the relevant shared object.



---

archive/issue_comments_414888.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@embray](#comment:2):\n> That's not really the intended \"libgap.so\".  I meant the one from GAP itself, in `$SAGE_LOCAL/lib/libgap.so`.  \n\noh, right --- except it's `.dylib`, not `.so`. (I searched for `libgap.so`, absent-mindedly, found unique match, tried it :-))\n\nAnd indeed simply replacing `libgap.so` with `libgap.dylib` in the dlopen call suffices,\nno need for the full path.\n\nSo this is easy to fix - except that in C I would have gone for a macro with the right extension, how is one supposed to do this in Cython?",
    "created_at": "2018-12-21T14:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414888",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@embray](#comment:2):
> That's not really the intended "libgap.so".  I meant the one from GAP itself, in `$SAGE_LOCAL/lib/libgap.so`.  

oh, right --- except it's `.dylib`, not `.so`. (I searched for `libgap.so`, absent-mindedly, found unique match, tried it :-))

And indeed simply replacing `libgap.so` with `libgap.dylib` in the dlopen call suffices,
no need for the full path.

So this is easy to fix - except that in C I would have gone for a macro with the right extension, how is one supposed to do this in Cython?



---

archive/issue_comments_414889.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYour plan isn't clear from the ticket description. Is your plan to add IO to the `gap_packages` optional package? By the way: Could you remind me of the current status? I.e., is `database_gap` now part of `gap_packages`, or is it still independent? Is it supposed to be standard soon?",
    "created_at": "2018-12-26T16:21:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414889",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:4" align="right">comment:4</div>

Your plan isn't clear from the ticket description. Is your plan to add IO to the `gap_packages` optional package? By the way: Could you remind me of the current status? I.e., is `database_gap` now part of `gap_packages`, or is it still independent? Is it supposed to be standard soon?



---

archive/issue_comments_414890.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@simon-king-jena](#comment:4):\n> Your plan isn't clear from the ticket description. Is your plan to add IO to the `gap_packages` optional package? By the way: Could you remind me of the current status? I.e., is `database_gap` now part of `gap_packages`, or is it still independent? Is it supposed to be standard soon?\n\n`database_gap` spkg is there no more, it's part of `gap` spkg; in fact, already \non #22626.\nOn #26856 Erik prefers to keep `gap_packages` optional, at least for the upcoming (quick) release 8.6, to make Debian deadline of 12 Jan.\n\nWe have not included IO there, as it'd be an extra over the current `gap_packages`, and something that needs more testing. Then we can extend `gap_packages` (and merge everything into `gap`, as we are already using the same tarball for `gap` and `gap_packages` anyway).",
    "created_at": "2018-12-26T16:28:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414890",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@simon-king-jena](#comment:4):
> Your plan isn't clear from the ticket description. Is your plan to add IO to the `gap_packages` optional package? By the way: Could you remind me of the current status? I.e., is `database_gap` now part of `gap_packages`, or is it still independent? Is it supposed to be standard soon?

`database_gap` spkg is there no more, it's part of `gap` spkg; in fact, already 
on #22626.
On #26856 Erik prefers to keep `gap_packages` optional, at least for the upcoming (quick) release 8.6, to make Debian deadline of 12 Jan.

We have not included IO there, as it'd be an extra over the current `gap_packages`, and something that needs more testing. Then we can extend `gap_packages` (and merge everything into `gap`, as we are already using the same tarball for `gap` and `gap_packages` anyway).



---

archive/issue_comments_414891.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAnd now a question on the IO package: From its documentation, I see that it allows to pickle any GAP object into a file object. But that's cumbersome for serialisation in Sage.\n\nIn Sage, we want a `__reduce__` method (or a different serialisation protocol) to return a data tuple that is eventually dumped to a string by standard Python tools. But it seems wrong to me if we have a complicated object (say, a cohomology ring) with several attributes, one of them being defined in libgap, and to write only this attribute directly to a file.\n\nSo, how do you envision libgap serialisation?",
    "created_at": "2018-12-26T16:30:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414891",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:6" align="right">comment:6</div>

And now a question on the IO package: From its documentation, I see that it allows to pickle any GAP object into a file object. But that's cumbersome for serialisation in Sage.

In Sage, we want a `__reduce__` method (or a different serialisation protocol) to return a data tuple that is eventually dumped to a string by standard Python tools. But it seems wrong to me if we have a complicated object (say, a cohomology ring) with several attributes, one of them being defined in libgap, and to write only this attribute directly to a file.

So, how do you envision libgap serialisation?



---

archive/issue_comments_414892.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWould you rather prefer IO dumping to a string? (i.e. into memory, right?)\nI'm not sure, but perhaps this is doable via their streams; it sounds like a reasonable feature to add to IO, if it's not there yet.\n\nAs Python serialisation was never my concern, I have little idea about it.",
    "created_at": "2018-12-26T16:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414892",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

Would you rather prefer IO dumping to a string? (i.e. into memory, right?)
I'm not sure, but perhaps this is doable via their streams; it sounds like a reasonable feature to add to IO, if it's not there yet.

As Python serialisation was never my concern, I have little idea about it.



---

archive/issue_comments_414893.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@dimpase](#comment:7):\n> As Python serialisation was never my concern, I have little idea about it.\n\nThis is a SageMath ticket. So, Python serialisation has to come into play sooner or later.\n\nHaving IO installed and working is a nice first step. But eventually,\n\n```\nsage: G = libgap.DihedralGroup(8)\nsage: loads(dumps(G))\n```\nshould work. And also something like the following should work:\n\n```python\nclass Foo(Ring):\n    def __init__(self, G):\n        assert G in Groups()\n        self.G = G\n        ...\n    def __reduce__(self):\n        return Foo, self.G\n```\nand then\n\n```\nsage: loads(dumps(Foo(libgap.DihedralGroup(8))))\n```\n\nBut that would be for two follow-up tickets. One for pickling, the other for making libgap aware of Sage's categories (thus, translating `G in Groups()` into `bool(G.IsGroup())`).",
    "created_at": "2018-12-26T16:46:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414893",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@dimpase](#comment:7):
> As Python serialisation was never my concern, I have little idea about it.

This is a SageMath ticket. So, Python serialisation has to come into play sooner or later.

Having IO installed and working is a nice first step. But eventually,

```
sage: G = libgap.DihedralGroup(8)
sage: loads(dumps(G))
```
should work. And also something like the following should work:

```python
class Foo(Ring):
    def __init__(self, G):
        assert G in Groups()
        self.G = G
        ...
    def __reduce__(self):
        return Foo, self.G
```
and then

```
sage: loads(dumps(Foo(libgap.DihedralGroup(8))))
```

But that would be for two follow-up tickets. One for pickling, the other for making libgap aware of Sage's categories (thus, translating `G in Groups()` into `bool(G.IsGroup())`).



---

archive/issue_comments_414894.json:
```json
{
    "body": "Changed commit from **[`3b47f26`](https://github.com/sagemath/sagetrac-mirror/commit/3b47f262f0f0db432151826bea079c28b805b07b)** to **[`eed5de7`](https://github.com/sagemath/sagetrac-mirror/commit/eed5de7ffec325d75f08eb8b2b777228e148fabf)**",
    "created_at": "2018-12-27T16:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414894",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3b47f26`](https://github.com/sagemath/sagetrac-mirror/commit/3b47f262f0f0db432151826bea079c28b805b07b)** to **[`eed5de7`](https://github.com/sagemath/sagetrac-mirror/commit/eed5de7ffec325d75f08eb8b2b777228e148fabf)**



---

archive/issue_comments_414895.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35abd3462b00a1b7bf42ace3df0f119c90b29bc2\"><code>35abd34</code></a></td><td><code>Merge branch 'develop' of trac.sagemath.org:sage into gap410pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db3f63ef80152cafa36dce38fe49e97bf0df3f6e\"><code>db3f63e</code></a></td><td><code>more libGAP in as_permutation(), less pexpect mess</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d77eeec35faf376b8d715b0d18510753ee544fc\"><code>2d77eee</code></a></td><td><code>follow up pyflake hints (all but one)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7dd5fa67e041e5b6d3f4e5046a484333a7e8d9d7\"><code>7dd5fa6</code></a></td><td><code>reviewer's example and fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca05b247f3c373950a1f883ac5c97f8bb1917781\"><code>ca05b24</code></a></td><td><code>Merge branch 'u/dimpase/groups/better_as_permutation' of trac.sagemath.org:sage into gap410pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd849fbe2b32a6cc8d4b56b334e4293846061a6b\"><code>bd849fb</code></a></td><td><code>don't clean too early</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff7722e4edb044fcadef0c83d78d72193a4aa013\"><code>ff7722e</code></a></td><td><code>suppress \"#I..\" warnings</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf405752a966b932afb7a7bb34d7be388c94324b\"><code>bf40575</code></a></td><td><code>silencing of #I warning from GAP in the function body</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37e23290bad2ee4d36463647f4c058c500b81eba\"><code>37e2329</code></a></td><td><code>tagged # random - answer is always mathematically OK, outputs differ</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eed5de7ffec325d75f08eb8b2b777228e148fabf\"><code>eed5de7</code></a></td><td><code>inital support for IO, following Erik on #22626</code></td></tr></table>\n",
    "created_at": "2018-12-27T16:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414895",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35abd3462b00a1b7bf42ace3df0f119c90b29bc2"><code>35abd34</code></a></td><td><code>Merge branch 'develop' of trac.sagemath.org:sage into gap410pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db3f63ef80152cafa36dce38fe49e97bf0df3f6e"><code>db3f63e</code></a></td><td><code>more libGAP in as_permutation(), less pexpect mess</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d77eeec35faf376b8d715b0d18510753ee544fc"><code>2d77eee</code></a></td><td><code>follow up pyflake hints (all but one)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7dd5fa67e041e5b6d3f4e5046a484333a7e8d9d7"><code>7dd5fa6</code></a></td><td><code>reviewer's example and fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca05b247f3c373950a1f883ac5c97f8bb1917781"><code>ca05b24</code></a></td><td><code>Merge branch 'u/dimpase/groups/better_as_permutation' of trac.sagemath.org:sage into gap410pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd849fbe2b32a6cc8d4b56b334e4293846061a6b"><code>bd849fb</code></a></td><td><code>don't clean too early</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff7722e4edb044fcadef0c83d78d72193a4aa013"><code>ff7722e</code></a></td><td><code>suppress "#I.." warnings</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf405752a966b932afb7a7bb34d7be388c94324b"><code>bf40575</code></a></td><td><code>silencing of #I warning from GAP in the function body</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37e23290bad2ee4d36463647f4c058c500b81eba"><code>37e2329</code></a></td><td><code>tagged # random - answer is always mathematically OK, outputs differ</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eed5de7ffec325d75f08eb8b2b777228e148fabf"><code>eed5de7</code></a></td><td><code>inital support for IO, following Erik on #22626</code></td></tr></table>




---

archive/issue_comments_414896.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nrebased over the branch on #26856, added OSX (and perhaps even Cygwin?) support.",
    "created_at": "2018-12-27T16:06:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414896",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

rebased over the branch on #26856, added OSX (and perhaps even Cygwin?) support.



---

archive/issue_comments_414897.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f49332f10f0b869fe5f81a60c6ffcf609ee10d7\"><code>5f49332</code></a></td><td><code>fix sdh_install of symlinks with invalid targets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9854c3a3a59fd2ab42aacfb78f38346439f280d9\"><code>9854c3a</code></a></td><td><code>Merge branch 'u/embray/build/sdh-install-symlinks' into public/ticket-26856</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/963757f864e94a44d1e0a66400a61efb493c99ba\"><code>963757f</code></a></td><td><code>don't clean too early</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da38d2c1dae99deb5d817bb15b1d69ff087b53fc\"><code>da38d2c</code></a></td><td><code>tagged # random - answer is always mathematically OK, outputs differ</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8b912d22cf2ab6b86f378500b27340b0f06d41e\"><code>d8b912d</code></a></td><td><code>inital support for IO, following Erik on #22626</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e6f33cec28d63a3adce00f07297bb3313e8ce86\"><code>0e6f33c</code></a></td><td><code>IO has landed, no need for this workaround</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bf1044efda750d8a767d88aa6a2afda69edadbe\"><code>8bf1044</code></a></td><td><code>disable doctesting of these modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7c5ccdac7bd17e4c12080471fbdf03014d2e874\"><code>a7c5ccd</code></a></td><td><code>Merge branch 'public/ticket-26856' of trac.sagemath.org:sage into gap_io</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c12daa66c875b95df2dbadb8c70a194565818b7d\"><code>c12daa6</code></a></td><td><code>Merge branch 'u/dimpase/packages/gap_io' of trac.sagemath.org:sage into gap_io</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/932811179edc2f981d55f4af330134a6d3e1fa49\"><code>9328111</code></a></td><td><code>no need to suppress warining</code></td></tr></table>\n",
    "created_at": "2018-12-29T18:31:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414897",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f49332f10f0b869fe5f81a60c6ffcf609ee10d7"><code>5f49332</code></a></td><td><code>fix sdh_install of symlinks with invalid targets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9854c3a3a59fd2ab42aacfb78f38346439f280d9"><code>9854c3a</code></a></td><td><code>Merge branch 'u/embray/build/sdh-install-symlinks' into public/ticket-26856</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/963757f864e94a44d1e0a66400a61efb493c99ba"><code>963757f</code></a></td><td><code>don't clean too early</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da38d2c1dae99deb5d817bb15b1d69ff087b53fc"><code>da38d2c</code></a></td><td><code>tagged # random - answer is always mathematically OK, outputs differ</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8b912d22cf2ab6b86f378500b27340b0f06d41e"><code>d8b912d</code></a></td><td><code>inital support for IO, following Erik on #22626</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e6f33cec28d63a3adce00f07297bb3313e8ce86"><code>0e6f33c</code></a></td><td><code>IO has landed, no need for this workaround</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bf1044efda750d8a767d88aa6a2afda69edadbe"><code>8bf1044</code></a></td><td><code>disable doctesting of these modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7c5ccdac7bd17e4c12080471fbdf03014d2e874"><code>a7c5ccd</code></a></td><td><code>Merge branch 'public/ticket-26856' of trac.sagemath.org:sage into gap_io</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c12daa66c875b95df2dbadb8c70a194565818b7d"><code>c12daa6</code></a></td><td><code>Merge branch 'u/dimpase/packages/gap_io' of trac.sagemath.org:sage into gap_io</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/932811179edc2f981d55f4af330134a6d3e1fa49"><code>9328111</code></a></td><td><code>no need to suppress warining</code></td></tr></table>




---

archive/issue_comments_414898.json:
```json
{
    "body": "Changed commit from **[`eed5de7`](https://github.com/sagemath/sagetrac-mirror/commit/eed5de7ffec325d75f08eb8b2b777228e148fabf)** to **[`9328111`](https://github.com/sagemath/sagetrac-mirror/commit/932811179edc2f981d55f4af330134a6d3e1fa49)**",
    "created_at": "2018-12-29T18:31:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414898",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`eed5de7`](https://github.com/sagemath/sagetrac-mirror/commit/eed5de7ffec325d75f08eb8b2b777228e148fabf)** to **[`9328111`](https://github.com/sagemath/sagetrac-mirror/commit/932811179edc2f981d55f4af330134a6d3e1fa49)**



---

archive/issue_comments_414899.json:
```json
{
    "body": "Changed commit from **[`9328111`](https://github.com/sagemath/sagetrac-mirror/commit/932811179edc2f981d55f4af330134a6d3e1fa49)** to **[`20c676a`](https://github.com/sagemath/sagetrac-mirror/commit/20c676a5d3fea184e82809366543e486e6aa2c98)**",
    "created_at": "2019-01-09T11:05:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414899",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9328111`](https://github.com/sagemath/sagetrac-mirror/commit/932811179edc2f981d55f4af330134a6d3e1fa49)** to **[`20c676a`](https://github.com/sagemath/sagetrac-mirror/commit/20c676a5d3fea184e82809366543e486e6aa2c98)**



---

archive/issue_comments_414900.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/20c676a5d3fea184e82809366543e486e6aa2c98\"><code>20c676a</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into HEAD</code></td></tr></table>\n",
    "created_at": "2019-01-09T11:05:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414900",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/20c676a5d3fea184e82809366543e486e6aa2c98"><code>20c676a</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into HEAD</code></td></tr></table>




---

archive/issue_comments_414901.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nmerged 8.6.rc0 in.",
    "created_at": "2019-01-09T11:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414901",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

merged 8.6.rc0 in.



---

archive/issue_comments_414902.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414902",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_371768.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371768"
}
```



---

archive/issue_events_371769.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371769"
}
```



---

archive/issue_events_371770.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-22T13:48:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371770"
}
```



---

archive/issue_comments_414903.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nMinor comment: if you are changing the `spkg-install` script of a package, you should also bump the patchlevel to force a rebuild.",
    "created_at": "2019-01-22T13:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414903",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Minor comment: if you are changing the `spkg-install` script of a package, you should also bump the patchlevel to force a rebuild.



---

archive/issue_comments_414904.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSince `dlopen` takes a `const char*`, it's safer to use byte literals here:\n\n```python\n    for suffix in [b\"so\", b\"dylib\", b\"dll\"]:\n        handle = dlopen(b\"libgap.\" + suffix, RTLD_NOW | RTLD_GLOBAL)\n```",
    "created_at": "2019-01-22T13:54:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414904",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Since `dlopen` takes a `const char*`, it's safer to use byte literals here:

```python
    for suffix in [b"so", b"dylib", b"dll"]:
        handle = dlopen(b"libgap." + suffix, RTLD_NOW | RTLD_GLOBAL)
```



---

archive/issue_comments_414905.json:
```json
{
    "body": "Author: **Dima Pasechnik, Erik Bray**",
    "created_at": "2019-01-22T13:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414905",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Dima Pasechnik, Erik Bray**



---

archive/issue_comments_414906.json:
```json
{
    "body": "Changed dependencies from **#22626, #26856** to none",
    "created_at": "2019-01-22T13:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414906",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#22626, #26856** to none



---

archive/issue_events_371771.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-22T13:58:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371771"
}
```



---

archive/issue_events_371772.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-22T13:58:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371772"
}
```



---

archive/issue_comments_414907.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nCopying a file into `$SAGE_LOCAL` like this is very fishy. At least it needs to be better explained why it's needed:\n\n```sh\ncp -f \"$SAGE_LOCAL/include/gap/config.h\" \"$GAP_ROOT/src/\"\n```",
    "created_at": "2019-01-22T13:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414907",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

Copying a file into `$SAGE_LOCAL` like this is very fishy. At least it needs to be better explained why it's needed:

```sh
cp -f "$SAGE_LOCAL/include/gap/config.h" "$GAP_ROOT/src/"
```



---

archive/issue_comments_414908.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nFinally a minor Cython style issue: I prefer `handle is NULL` as a more Pythonic spelling of `handle == NULL`.",
    "created_at": "2019-01-22T13:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414908",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

Finally a minor Cython style issue: I prefer `handle is NULL` as a more Pythonic spelling of `handle == NULL`.



---

archive/issue_comments_414909.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nBy the way, the commit history is a mess. Maybe it would be better to squash and rebase on top of 8.6.",
    "created_at": "2019-01-22T14:02:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414909",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

By the way, the commit history is a mess. Maybe it would be better to squash and rebase on top of 8.6.



---

archive/issue_comments_414910.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jdemeyer](#comment:21):\n> Copying a file into `$SAGE_LOCAL` like this is very fishy. At least it needs to be better explained why it's needed:\n> \n> ```sh\n> cp -f \"$SAGE_LOCAL/include/gap/config.h\" \"$GAP_ROOT/src/\"\n> ```\n\nIf I remember correctly this is where `io.c` expect some of its \"include\". I am planning to patch in sage-on-gentoo rather than doing something like that.\n\nNow going through the ticket and this bit in particular:\n\n```\n+    cdef void* handle\n+    for suffix in [\"so\", \"dylib\", \"dll\"]:\n+        handle = dlopen(\"libgap.\"+suffix, RTLD_NOW | RTLD_GLOBAL)\n+        if handle != NULL:\n+            break\n```\n\nwhere the point has been made that we don't need the full path. Now that starts to get unrelated but we do the same thing for libsingular in `libs/singular.pyx` and we go to great length to get the full path even defining it in `env.py`. If I read this correctly it is now way more complicated than it should be.",
    "created_at": "2019-01-22T18:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414910",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jdemeyer](#comment:21):
> Copying a file into `$SAGE_LOCAL` like this is very fishy. At least it needs to be better explained why it's needed:
> 
> ```sh
> cp -f "$SAGE_LOCAL/include/gap/config.h" "$GAP_ROOT/src/"
> ```

If I remember correctly this is where `io.c` expect some of its "include". I am planning to patch in sage-on-gentoo rather than doing something like that.

Now going through the ticket and this bit in particular:

```
+    cdef void* handle
+    for suffix in ["so", "dylib", "dll"]:
+        handle = dlopen("libgap."+suffix, RTLD_NOW | RTLD_GLOBAL)
+        if handle != NULL:
+            break
```

where the point has been made that we don't need the full path. Now that starts to get unrelated but we do the same thing for libsingular in `libs/singular.pyx` and we go to great length to get the full path even defining it in `env.py`. If I read this correctly it is now way more complicated than it should be.



---

archive/issue_comments_414911.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@kiwifb](#comment:24):\n> Replying to [@jdemeyer](#comment:21):\n> > Copying a file into `$SAGE_LOCAL` like this is very fishy. At least it needs to be better explained why it's needed:\n> > \n> > ```sh\n> > cp -f \"$SAGE_LOCAL/include/gap/config.h\" \"$GAP_ROOT/src/\"\n> > ```\n\n> \n> If I remember correctly this is where `io.c` expect some of its \"include\". I am planning to patch in sage-on-gentoo rather than doing something like that.\n\nThat's right. Perhaps the proper way would be to use `sdh_install` rather than `cp`, but on the other hand it's not clear to me whether `$GAP_ROOT/src/` is a location supported by this machinery.\n\nErik, could you look into this?\n\n(Of course, GAP having its include files in the same directory as C sources is a problem, due to their lack of proper install mechanism...)",
    "created_at": "2019-01-23T00:05:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414911",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@kiwifb](#comment:24):
> Replying to [@jdemeyer](#comment:21):
> > Copying a file into `$SAGE_LOCAL` like this is very fishy. At least it needs to be better explained why it's needed:
> > 
> > ```sh
> > cp -f "$SAGE_LOCAL/include/gap/config.h" "$GAP_ROOT/src/"
> > ```

> 
> If I remember correctly this is where `io.c` expect some of its "include". I am planning to patch in sage-on-gentoo rather than doing something like that.

That's right. Perhaps the proper way would be to use `sdh_install` rather than `cp`, but on the other hand it's not clear to me whether `$GAP_ROOT/src/` is a location supported by this machinery.

Erik, could you look into this?

(Of course, GAP having its include files in the same directory as C sources is a problem, due to their lack of proper install mechanism...)



---

archive/issue_comments_414912.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThis is all I had to do compile `io` against an installed gap (with `config.h` installed in `include/gap` like in vanilla sage)\n\n```diff\ndiff --git a/pkg/io-4.5.4/src/io.c b/pkg/io-4.5.4/src/io.c\nindex 5aa4a082..07e6e312 100644\n--- a/pkg/io-4.5.4/src/io.c\n+++ b/pkg/io-4.5.4/src/io.c\n@@ -11,8 +11,8 @@\n /* Try to use as much of the GNU C library as possible: */\n #define _GNU_SOURCE\n \n-#include \"src/compiled.h\"          /* GAP headers                */\n-#include \"src/iostream.h\"          /* Signal Handling            */\n+#include \"gap/compiled.h\"          /* GAP headers                */\n+#include \"gap/iostream.h\"          /* Signal Handling            */\n \n #undef PACKAGE\n #undef PACKAGE_BUGREPORT\n```",
    "created_at": "2019-01-23T00:21:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414912",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:26" align="right">comment:26</div>

This is all I had to do compile `io` against an installed gap (with `config.h` installed in `include/gap` like in vanilla sage)

```diff
diff --git a/pkg/io-4.5.4/src/io.c b/pkg/io-4.5.4/src/io.c
index 5aa4a082..07e6e312 100644
--- a/pkg/io-4.5.4/src/io.c
+++ b/pkg/io-4.5.4/src/io.c
@@ -11,8 +11,8 @@
 /* Try to use as much of the GNU C library as possible: */
 #define _GNU_SOURCE
 
-#include "src/compiled.h"          /* GAP headers                */
-#include "src/iostream.h"          /* Signal Handling            */
+#include "gap/compiled.h"          /* GAP headers                */
+#include "gap/iostream.h"          /* Signal Handling            */
 
 #undef PACKAGE
 #undef PACKAGE_BUGREPORT
```



---

archive/issue_comments_414913.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nrebased branch, using byte literals now, also internet-related tests fixed at one place\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13614cf8ec9230f42deb6795c055657c0644fda2\"><code>13614cf</code></a></td><td><code>rebased the messy branch from #26930</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7796fae728f732b674a6dcfef3e5025d479f3cce\"><code>7796fae</code></a></td><td><code>using use byte literals</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61afc499792c831be0e6e10e60979765a7f48f05\"><code>61afc49</code></a></td><td><code>change in catergory name (in tests tagged \"internet\")</code></td></tr></table>\n",
    "created_at": "2019-01-23T00:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414913",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

rebased branch, using byte literals now, also internet-related tests fixed at one place

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13614cf8ec9230f42deb6795c055657c0644fda2"><code>13614cf</code></a></td><td><code>rebased the messy branch from #26930</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7796fae728f732b674a6dcfef3e5025d479f3cce"><code>7796fae</code></a></td><td><code>using use byte literals</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61afc499792c831be0e6e10e60979765a7f48f05"><code>61afc49</code></a></td><td><code>change in catergory name (in tests tagged "internet")</code></td></tr></table>




---

archive/issue_comments_414914.json:
```json
{
    "body": "Changed branch from **[u/dimpase/packages/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/gap_io)** to **[public/packages/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/gap_io)**",
    "created_at": "2019-01-23T00:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414914",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/packages/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/gap_io)** to **[public/packages/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/gap_io)**



---

archive/issue_events_371773.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-23T00:59:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371773"
}
```



---

archive/issue_events_371774.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-23T00:59:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371774"
}
```



---

archive/issue_comments_414915.json:
```json
{
    "body": "Changed commit from **[`20c676a`](https://github.com/sagemath/sagetrac-mirror/commit/20c676a5d3fea184e82809366543e486e6aa2c98)** to **[`61afc49`](https://github.com/sagemath/sagetrac-mirror/commit/61afc499792c831be0e6e10e60979765a7f48f05)**",
    "created_at": "2019-01-23T00:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414915",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`20c676a`](https://github.com/sagemath/sagetrac-mirror/commit/20c676a5d3fea184e82809366543e486e6aa2c98)** to **[`61afc49`](https://github.com/sagemath/sagetrac-mirror/commit/61afc499792c831be0e6e10e60979765a7f48f05)**



---

archive/issue_events_371775.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-23T06:28:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371775"
}
```



---

archive/issue_events_371776.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-23T06:28:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371776"
}
```



---

archive/issue_comments_414916.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n[comment:17] and [comment:21] have not been addressed yet (neither has [comment:22] but that's just a style issue)",
    "created_at": "2019-01-23T06:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414916",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

[comment:17] and [comment:21] have not been addressed yet (neither has [comment:22] but that's just a style issue)



---

archive/issue_comments_414917.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThanks for doing the rebase, but `rebased the messy branch from #26930` is not really a good commit message. Better would be something like `Trac #26930: add GAP io package`.",
    "created_at": "2019-01-23T08:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414917",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Thanks for doing the rebase, but `rebased the messy branch from #26930` is not really a good commit message. Better would be something like `Trac #26930: add GAP io package`.



---

archive/issue_comments_414918.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI would like to handle the path for libgap.so (and its related variants) better, and had planned to do so soon before I saw all the recent work on this ticket.\n\nI think the path to libgap should be set in `sage.env` and should be possible to override by environment variable, analogous to the handling of `SINGULAR_SO` (it could even repurpose the same code more-or-less).",
    "created_at": "2019-01-23T10:38:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414918",
    "user": "https://github.com/embray"
}
```

<div id="comment:30" align="right">comment:30</div>

I would like to handle the path for libgap.so (and its related variants) better, and had planned to do so soon before I saw all the recent work on this ticket.

I think the path to libgap should be set in `sage.env` and should be possible to override by environment variable, analogous to the handling of `SINGULAR_SO` (it could even repurpose the same code more-or-less).



---

archive/issue_comments_414919.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThis change\n\n```diff\n\ndiff --git a/build/pkgs/gap_packages/spkg-install b/build/pkgs/gap_packages/spkg-install\nindex 1a3e8c5..607d2c7 100644\n--- a/build/pkgs/gap_packages/spkg-install\n+++ b/build/pkgs/gap_packages/spkg-install\n@@ -48,15 +48,15 @@ install_compiled_pkg()\n     # Clean up any build artificts before installing the rest of the package\n     # Also remove configure/Makefiles\n     # Note: None, if any of the packages really have a proper install target\n-    make clean  # Works for some packages but not all\n-    rm -rf bin/\n-    rm -rf configure configure.* config.* autogen.sh *.m4 Makefile* m4/\n \n     # Create the bin/ symlink\n     ln -s \"$SAGE_LOCAL/lib/gap/pkg/$pkg/bin\" bin\n \n     # Install the rest of the package files\n     sdh_install * \"$PKG_DIR/$pkg\"\n+    make clean  # Works for some packages but not all\n+    rm -rf bin/\n+    rm -rf configure configure.* config.* autogen.sh *.m4 Makefile* m4/\n }\n \n # Build and install compiled packages:\n```\n\nis not good.  You seem to have brought it over from some old branch for #26856, where I also had to remove it: [#26856 comment:110](https://github.com/sagemath/sage/issues/26856#comment:110)",
    "created_at": "2019-01-23T10:44:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414919",
    "user": "https://github.com/embray"
}
```

<div id="comment:31" align="right">comment:31</div>

This change

```diff

diff --git a/build/pkgs/gap_packages/spkg-install b/build/pkgs/gap_packages/spkg-install
index 1a3e8c5..607d2c7 100644
--- a/build/pkgs/gap_packages/spkg-install
+++ b/build/pkgs/gap_packages/spkg-install
@@ -48,15 +48,15 @@ install_compiled_pkg()
     # Clean up any build artificts before installing the rest of the package
     # Also remove configure/Makefiles
     # Note: None, if any of the packages really have a proper install target
-    make clean  # Works for some packages but not all
-    rm -rf bin/
-    rm -rf configure configure.* config.* autogen.sh *.m4 Makefile* m4/
 
     # Create the bin/ symlink
     ln -s "$SAGE_LOCAL/lib/gap/pkg/$pkg/bin" bin
 
     # Install the rest of the package files
     sdh_install * "$PKG_DIR/$pkg"
+    make clean  # Works for some packages but not all
+    rm -rf bin/
+    rm -rf configure configure.* config.* autogen.sh *.m4 Makefile* m4/
 }
 
 # Build and install compiled packages:
```

is not good.  You seem to have brought it over from some old branch for #26856, where I also had to remove it: [#26856 comment:110](https://github.com/sagemath/sage/issues/26856#comment:110)



---

archive/issue_comments_414920.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\n\n```diff\ndiff --git a/src/doc/en/constructions/groups.rst b/src/doc/en/constructions/groups.rst\nindex 30d8da4..0cc7b92 100644\n--- a/src/doc/en/constructions/groups.rst\n+++ b/src/doc/en/constructions/groups.rst\n@@ -184,7 +184,7 @@ Here's another way, working more directly with GAP::\n     [ Group( [ f1, f2 ] ), Group( [ f2 ] ), Group( <identity> of ... ) ]\n     sage: print(gap.eval(\"G := SymmetricGroup( 4 )\"))\n     Sym( [ 1 .. 4 ] )\n-    sage: print(gap.eval(\"normal := NormalSubgroups( G );\"))\n+    sage: print(gap.eval(\"normal := NormalSubgroups( G );\")) # random\n     [ Sym( [ 1 .. 4 ] ), Alt( [ 1 .. 4 ] ), Group([ (1,4)(2,3), (1,3)(2,4) ]),\n       Group(()) ]\n```\n\nI'm confused why it's still giving you random results here.  #26874 should have fixed this.  I want to look into it.  It's not too important of course, but it still troubles me that there's some non-determinism in the tests when AFAIK there shouldn't be.",
    "created_at": "2019-01-23T10:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414920",
    "user": "https://github.com/embray"
}
```

<div id="comment:32" align="right">comment:32</div>


```diff
diff --git a/src/doc/en/constructions/groups.rst b/src/doc/en/constructions/groups.rst
index 30d8da4..0cc7b92 100644
--- a/src/doc/en/constructions/groups.rst
+++ b/src/doc/en/constructions/groups.rst
@@ -184,7 +184,7 @@ Here's another way, working more directly with GAP::
     [ Group( [ f1, f2 ] ), Group( [ f2 ] ), Group( <identity> of ... ) ]
     sage: print(gap.eval("G := SymmetricGroup( 4 )"))
     Sym( [ 1 .. 4 ] )
-    sage: print(gap.eval("normal := NormalSubgroups( G );"))
+    sage: print(gap.eval("normal := NormalSubgroups( G );")) # random
     [ Sym( [ 1 .. 4 ] ), Alt( [ 1 .. 4 ] ), Group([ (1,4)(2,3), (1,3)(2,4) ]),
       Group(()) ]
```

I'm confused why it's still giving you random results here.  #26874 should have fixed this.  I want to look into it.  It's not too important of course, but it still troubles me that there's some non-determinism in the tests when AFAIK there shouldn't be.



---

archive/issue_comments_414921.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI don't know why you removed this:\n\n```diff\ndiff --git a/src/sage/graphs/strongly_regular_db.pyx b/src/sage/graphs/strongly_regular_db.pyx\nindex 55a1428..90af15a 100644\n--- a/src/sage/graphs/strongly_regular_db.pyx\n+++ b/src/sage/graphs/strongly_regular_db.pyx\n@@ -2450,10 +2450,8 @@ def SRG_416_100_36_20():\n         (416, 100, 36, 20)\n     \"\"\"\n     from sage.libs.gap.libgap import libgap\n-    libgap.eval(\"SetInfoLevel(InfoWarning,0)\") # silence #I warnings from GAP (without IO pkg)\n     libgap.LoadPackage(\"AtlasRep\")\n     g=libgap.AtlasGroup(\"G2(4)\",libgap.NrMovedPoints,416)\n-    libgap.eval(\"SetInfoLevel(InfoWarning,1)\") # restore #I warnings\n     h = Graph()\n     h.add_edges(g.Orbit([1,5],libgap.OnSets))\n     h.relabel()\n```\n\nIt's still not a standard package, so these warnings will still happen if the IO package is not installed.  This isn't just a problem for sage-the-distribution.  E.g. on Debian it's perfectly possible (at least for now) to install the sagemath package without installing the gap-io package.",
    "created_at": "2019-01-23T10:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414921",
    "user": "https://github.com/embray"
}
```

<div id="comment:33" align="right">comment:33</div>

I don't know why you removed this:

```diff
diff --git a/src/sage/graphs/strongly_regular_db.pyx b/src/sage/graphs/strongly_regular_db.pyx
index 55a1428..90af15a 100644
--- a/src/sage/graphs/strongly_regular_db.pyx
+++ b/src/sage/graphs/strongly_regular_db.pyx
@@ -2450,10 +2450,8 @@ def SRG_416_100_36_20():
         (416, 100, 36, 20)
     """
     from sage.libs.gap.libgap import libgap
-    libgap.eval("SetInfoLevel(InfoWarning,0)") # silence #I warnings from GAP (without IO pkg)
     libgap.LoadPackage("AtlasRep")
     g=libgap.AtlasGroup("G2(4)",libgap.NrMovedPoints,416)
-    libgap.eval("SetInfoLevel(InfoWarning,1)") # restore #I warnings
     h = Graph()
     h.add_edges(g.Orbit([1,5],libgap.OnSets))
     h.relabel()
```

It's still not a standard package, so these warnings will still happen if the IO package is not installed.  This isn't just a problem for sage-the-distribution.  E.g. on Debian it's perfectly possible (at least for now) to install the sagemath package without installing the gap-io package.



---

archive/issue_comments_414922.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@embray](#comment:33):\n> I don't know why you removed this:\n> \n> ```diff\n> diff --git a/src/sage/graphs/strongly_regular_db.pyx b/src/sage/graphs/strongly_regular_db.pyx\n> index 55a1428..90af15a 100644\n> --- a/src/sage/graphs/strongly_regular_db.pyx\n> +++ b/src/sage/graphs/strongly_regular_db.pyx\n> @@ -2450,10 +2450,8 @@ def SRG_416_100_36_20():\n>          (416, 100, 36, 20)\n>      \"\"\"\n>      from sage.libs.gap.libgap import libgap\n> -    libgap.eval(\"SetInfoLevel(InfoWarning,0)\") # silence #I warnings from GAP (without IO pkg)\n>      libgap.LoadPackage(\"AtlasRep\")\n>      g=libgap.AtlasGroup(\"G2(4)\",libgap.NrMovedPoints,416)\n> -    libgap.eval(\"SetInfoLevel(InfoWarning,1)\") # restore #I warnings\n>      h = Graph()\n>      h.add_edges(g.Orbit([1,5],libgap.OnSets))\n>      h.relabel()\n> ```\n> \n> It's still not a standard package, so these warnings will still happen if the IO package is not installed.  This isn't just a problem for sage-the-distribution.  E.g. on Debian it's perfectly possible (at least for now) to install the sagemath package without installing the gap-io package.\n\noh, I might have been confused by shaffling packages around. This chane makes sense if atlasrep is in gap-packages, but this is not the case any more.",
    "created_at": "2019-01-23T11:22:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414922",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@embray](#comment:33):
> I don't know why you removed this:
> 
> ```diff
> diff --git a/src/sage/graphs/strongly_regular_db.pyx b/src/sage/graphs/strongly_regular_db.pyx
> index 55a1428..90af15a 100644
> --- a/src/sage/graphs/strongly_regular_db.pyx
> +++ b/src/sage/graphs/strongly_regular_db.pyx
> @@ -2450,10 +2450,8 @@ def SRG_416_100_36_20():
>          (416, 100, 36, 20)
>      """
>      from sage.libs.gap.libgap import libgap
> -    libgap.eval("SetInfoLevel(InfoWarning,0)") # silence #I warnings from GAP (without IO pkg)
>      libgap.LoadPackage("AtlasRep")
>      g=libgap.AtlasGroup("G2(4)",libgap.NrMovedPoints,416)
> -    libgap.eval("SetInfoLevel(InfoWarning,1)") # restore #I warnings
>      h = Graph()
>      h.add_edges(g.Orbit([1,5],libgap.OnSets))
>      h.relabel()
> ```
> 
> It's still not a standard package, so these warnings will still happen if the IO package is not installed.  This isn't just a problem for sage-the-distribution.  E.g. on Debian it's perfectly possible (at least for now) to install the sagemath package without installing the gap-io package.

oh, I might have been confused by shaffling packages around. This chane makes sense if atlasrep is in gap-packages, but this is not the case any more.



---

archive/issue_comments_414923.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@embray](#comment:31):\n> This change\n> is not good.  You seem to have brought it over from some old branch for #26856, where I also had to remove it: [#26856 comment:110](https://github.com/sagemath/sage/issues/26856#comment:110)\n\nduh... I looked at that diff, wondering whether there is some whitespace-only difference there, for it looked totally the same :-(",
    "created_at": "2019-01-23T22:28:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414923",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@embray](#comment:31):
> This change
> is not good.  You seem to have brought it over from some old branch for #26856, where I also had to remove it: [#26856 comment:110](https://github.com/sagemath/sage/issues/26856#comment:110)

duh... I looked at that diff, wondering whether there is some whitespace-only difference there, for it looked totally the same :-(



---

archive/issue_comments_414924.json:
```json
{
    "body": "Changed commit from **[`61afc49`](https://github.com/sagemath/sagetrac-mirror/commit/61afc499792c831be0e6e10e60979765a7f48f05)** to **[`bce40a5`](https://github.com/sagemath/sagetrac-mirror/commit/bce40a554af8ba8a7d17251ce9a5f108143a0da0)**",
    "created_at": "2019-01-23T22:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414924",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`61afc49`](https://github.com/sagemath/sagetrac-mirror/commit/61afc499792c831be0e6e10e60979765a7f48f05)** to **[`bce40a5`](https://github.com/sagemath/sagetrac-mirror/commit/bce40a554af8ba8a7d17251ce9a5f108143a0da0)**



---

archive/issue_comments_414925.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f8a38a08378c265be5a140403156adac2e9fa65\"><code>0f8a38a</code></a></td><td><code>Trac #26930: add GAP io package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/946393cc6c465be0d23fde75ea533f4d813b38e9\"><code>946393c</code></a></td><td><code>using use byte literals</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cfb69cc4a11d1e4f2f6249e1f4ae14da0db4f4d0\"><code>cfb69cc</code></a></td><td><code>change in catergory name (in tests tagged \"internet\")</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bce40a554af8ba8a7d17251ce9a5f108143a0da0\"><code>bce40a5</code></a></td><td><code>took care of comments 17,22,29,31,33 on Trac #26930</code></td></tr></table>\n",
    "created_at": "2019-01-23T22:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414925",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f8a38a08378c265be5a140403156adac2e9fa65"><code>0f8a38a</code></a></td><td><code>Trac #26930: add GAP io package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/946393cc6c465be0d23fde75ea533f4d813b38e9"><code>946393c</code></a></td><td><code>using use byte literals</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cfb69cc4a11d1e4f2f6249e1f4ae14da0db4f4d0"><code>cfb69cc</code></a></td><td><code>change in catergory name (in tests tagged "internet")</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bce40a554af8ba8a7d17251ce9a5f108143a0da0"><code>bce40a5</code></a></td><td><code>took care of comments 17,22,29,31,33 on Trac #26930</code></td></tr></table>




---

archive/issue_comments_414926.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nWhat should we do with comment 21? Just patch the GAP/io package source?",
    "created_at": "2019-01-23T22:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414926",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

What should we do with comment 21? Just patch the GAP/io package source?



---

archive/issue_comments_414927.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d7016aa86ca24de03a3c3e7b5698af1e57040ff\"><code>0d7016a</code></a></td><td><code>patch source of GAP/io to correct header location</code></td></tr></table>\n",
    "created_at": "2019-01-23T22:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414927",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d7016aa86ca24de03a3c3e7b5698af1e57040ff"><code>0d7016a</code></a></td><td><code>patch source of GAP/io to correct header location</code></td></tr></table>




---

archive/issue_comments_414928.json:
```json
{
    "body": "Changed commit from **[`bce40a5`](https://github.com/sagemath/sagetrac-mirror/commit/bce40a554af8ba8a7d17251ce9a5f108143a0da0)** to **[`0d7016a`](https://github.com/sagemath/sagetrac-mirror/commit/0d7016aa86ca24de03a3c3e7b5698af1e57040ff)**",
    "created_at": "2019-01-23T22:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414928",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bce40a5`](https://github.com/sagemath/sagetrac-mirror/commit/bce40a554af8ba8a7d17251ce9a5f108143a0da0)** to **[`0d7016a`](https://github.com/sagemath/sagetrac-mirror/commit/0d7016aa86ca24de03a3c3e7b5698af1e57040ff)**



---

archive/issue_events_371777.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-23T22:58:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371777"
}
```



---

archive/issue_events_371778.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-23T22:58:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371778"
}
```



---

archive/issue_events_371779.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-23T23:00:00Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "title_is": "add GAP io package, set up libgap for GAP kernel modules",
    "title_was": "add GAP io package (and other GAP kernel modules)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371779"
}
```



---

archive/issue_comments_414929.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,5 @@\n on #22626 Erik [proposed a patch](https://github.com/sagemath/sage/issues/22626#comment:424).\n \n Here is a branch that implements this.\n+\n+io package needs a small patch to use proper include directory\n``````\n",
    "created_at": "2019-01-23T23:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414929",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,5 @@
 on #22626 Erik [proposed a patch](https://github.com/sagemath/sage/issues/22626#comment:424).
 
 Here is a branch that implements this.
+
+io package needs a small patch to use proper include directory
``````




---

archive/issue_comments_414930.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\npiing...",
    "created_at": "2019-01-28T11:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414930",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">comment:41</div>

piing...



---

archive/issue_comments_414931.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nHi!\n\nI'm currently trying to compile a bunch of GAP packages in Sage environment, and apparently, I need to add this:\n\n$ CFLAGS=\"-I../.. -I../../gen\" ./configure --with-gaproot=../..\n\nIs it the only way?",
    "created_at": "2019-02-04T17:27:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414931",
    "user": "https://github.com/zerline"
}
```

<div id="comment:42" align="right">comment:42</div>

Hi!

I'm currently trying to compile a bunch of GAP packages in Sage environment, and apparently, I need to add this:

$ CFLAGS="-I../.. -I../../gen" ./configure --with-gaproot=../..

Is it the only way?



---

archive/issue_events_371780.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-04T17:30:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371780"
}
```



---

archive/issue_events_371781.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-04T17:30:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371781"
}
```



---

archive/issue_comments_414932.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI just looked into this with Odile, who was trying to compile the IO package.  I don't think patching the sources is the way.  It's strange that the configure script, even given a path to the gaproot, doesn't add this.  I will look into what is *intended* for this and see if there's a reason what we're doing with just passing `--with-gaproot` to configure doesn't work.\n\nEither it's a bug on our end, or a bug in the package's configure.  Odile was able to work around it by adding `CFLAGS=-I../../ -I../../gen` and that seemed to work (where `../../` here was the relative path to the gaproot).  If we have to do that we can, but it still smells like a hack.\n\nI also want to address [#26930 comment:30](https://github.com/sagemath/sage/issues/26930#comment:30)",
    "created_at": "2019-02-04T17:30:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414932",
    "user": "https://github.com/embray"
}
```

<div id="comment:43" align="right">comment:43</div>

I just looked into this with Odile, who was trying to compile the IO package.  I don't think patching the sources is the way.  It's strange that the configure script, even given a path to the gaproot, doesn't add this.  I will look into what is *intended* for this and see if there's a reason what we're doing with just passing `--with-gaproot` to configure doesn't work.

Either it's a bug on our end, or a bug in the package's configure.  Odile was able to work around it by adding `CFLAGS=-I../../ -I../../gen` and that seemed to work (where `../../` here was the relative path to the gaproot).  If we have to do that we can, but it still smells like a hack.

I also want to address [#26930 comment:30](https://github.com/sagemath/sage/issues/26930#comment:30)



---

archive/issue_comments_414933.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI don't see why we should not patch package's source.\n\nIt's written with GAP's sources and headers alike living in GAPROOT/src/, and\nnaturally you can either create some foo/src to use in `-I`, or else, indeed, replace `src/` with `gap/`.\n\nI would like to see the log of the failure (without these extra CFLAGS)",
    "created_at": "2019-02-04T18:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414933",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:44" align="right">comment:44</div>

I don't see why we should not patch package's source.

It's written with GAP's sources and headers alike living in GAPROOT/src/, and
naturally you can either create some foo/src to use in `-I`, or else, indeed, replace `src/` with `gap/`.

I would like to see the log of the failure (without these extra CFLAGS)



---

archive/issue_comments_414934.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\n*after a bare ./configure --with-gaproot=../..* :\n\n\n```\n(sage-sh) odile@ancolie:json-2.0.0$ make\n  CXX      src/json.lo\nsrc/json.cc:5:10: fatal error: src/compiled.h: Aucun fichier ou dossier de ce type\n #include \"src/compiled.h\"          /* GAP headers                */\n          ^~~~~~~~~~~~~~~~\ncompilation terminated.\nmake: *** [Makefile:501: src/json.lo] Error 1\n\n```",
    "created_at": "2019-02-04T18:08:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414934",
    "user": "https://github.com/zerline"
}
```

<div id="comment:45" align="right">comment:45</div>

*after a bare ./configure --with-gaproot=../..* :


```
(sage-sh) odile@ancolie:json-2.0.0$ make
  CXX      src/json.lo
src/json.cc:5:10: fatal error: src/compiled.h: Aucun fichier ou dossier de ce type
 #include "src/compiled.h"          /* GAP headers                */
          ^~~~~~~~~~~~~~~~
compilation terminated.
make: *** [Makefile:501: src/json.lo] Error 1

```



---

archive/issue_comments_414935.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nDon't do things like this at `sage -sh` prompt, it's not meant for this.\n\nJust do the usual `./sage -f gap_packages` (with the branch pulled in, naturally).",
    "created_at": "2019-02-04T18:11:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414935",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">comment:46</div>

Don't do things like this at `sage -sh` prompt, it's not meant for this.

Just do the usual `./sage -f gap_packages` (with the branch pulled in, naturally).



---

archive/issue_comments_414936.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nand if you want more GAP packages installed, modify `gap_packages/spkg-install` accordingly.",
    "created_at": "2019-02-04T18:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414936",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:47" align="right">comment:47</div>

and if you want more GAP packages installed, modify `gap_packages/spkg-install` accordingly.



---

archive/issue_comments_414937.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nCould you point me to a documentation page for this?\n\n(I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)\n\nNote: I'm a complete newbie to GAP, not to mention GAP-in-Sage ..",
    "created_at": "2019-02-04T18:14:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414937",
    "user": "https://github.com/zerline"
}
```

<div id="comment:48" align="right">comment:48</div>

Could you point me to a documentation page for this?

(I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)

Note: I'm a complete newbie to GAP, not to mention GAP-in-Sage ..



---

archive/issue_comments_414938.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nThanks anyway, I'll try that.",
    "created_at": "2019-02-04T18:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414938",
    "user": "https://github.com/zerline"
}
```

<div id="comment:49" align="right">comment:49</div>

Thanks anyway, I'll try that.



---

archive/issue_comments_414939.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nHere is my gap_packages-4.10.0.log[http://fluidinfo.fr/gap/gap_packages-4.10.0.log](http://fluidinfo.fr/gap/gap_packages-4.10.0.log)\n\nNote: I have a crypting-0.9 source directory, in my ./local/share/gap/pkg : for some reason it was not in the build directory as the other packages, I just copied it there and here is my second log[http://fluidinfo.fr/gap/gap_packages-4.10.0.log.1](http://fluidinfo.fr/gap/gap_packages-4.10.0.log.1)",
    "created_at": "2019-02-04T18:27:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414939",
    "user": "https://github.com/zerline"
}
```

<div id="comment:50" align="right">comment:50</div>

Here is my gap_packages-4.10.0.log[http://fluidinfo.fr/gap/gap_packages-4.10.0.log](http://fluidinfo.fr/gap/gap_packages-4.10.0.log)

Note: I have a crypting-0.9 source directory, in my ./local/share/gap/pkg : for some reason it was not in the build directory as the other packages, I just copied it there and here is my second log[http://fluidinfo.fr/gap/gap_packages-4.10.0.log.1](http://fluidinfo.fr/gap/gap_packages-4.10.0.log.1)



---

archive/issue_comments_414940.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@zerline](#comment:48):\n> Could you point me to a documentation page for this?\n> \n> (I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)\n> \n\nThis link is totally obsolete - edited last time in 2013.\nI've just edited that page to make this clear. Sorry...",
    "created_at": "2019-02-04T18:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414940",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@zerline](#comment:48):
> Could you point me to a documentation page for this?
> 
> (I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)
> 

This link is totally obsolete - edited last time in 2013.
I've just edited that page to make this clear. Sorry...



---

archive/issue_comments_414941.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@zerline](#comment:45):\n> *after a bare ./configure --with-gaproot=../..* :\n> \n> \n> ```\n> (sage-sh) odile@ancolie:json-2.0.0$ make\n>   CXX      src/json.lo\n> src/json.cc:5:10: fatal error: src/compiled.h: Aucun fichier ou dossier de ce type\n>  #include \"src/compiled.h\"          /* GAP headers                */\n>           ^~~~~~~~~~~~~~~~\n> compilation terminated.\n> make: *** [Makefile:501: src/json.lo] Error 1\n> \n> ```\n\nThat's exactly one of the things I patch see #26930?replyto=45#comment:26",
    "created_at": "2019-02-04T18:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414941",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@zerline](#comment:45):
> *after a bare ./configure --with-gaproot=../..* :
> 
> 
> ```
> (sage-sh) odile@ancolie:json-2.0.0$ make
>   CXX      src/json.lo
> src/json.cc:5:10: fatal error: src/compiled.h: Aucun fichier ou dossier de ce type
>  #include "src/compiled.h"          /* GAP headers                */
>           ^~~~~~~~~~~~~~~~
> compilation terminated.
> make: *** [Makefile:501: src/json.lo] Error 1
> 
> ```

That's exactly one of the things I patch see #26930?replyto=45#comment:26



---

archive/issue_comments_414942.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nLet us separate a review for this ticket and adding yet more GAP packages.\nI just opened #27218 for this purpose.",
    "created_at": "2019-02-04T18:54:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414942",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:53" align="right">comment:53</div>

Let us separate a review for this ticket and adding yet more GAP packages.
I just opened #27218 for this purpose.



---

archive/issue_events_371782.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-04T18:54:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371782"
}
```



---

archive/issue_events_371783.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-04T18:54:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371783"
}
```



---

archive/issue_comments_414943.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@dimpase](#comment:51):\n> Replying to [@zerline](#comment:48):\n> > Could you point me to a documentation page for this?\n> > \n> > (I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)\n> > \n\n> This link is totally obsolete - edited last time in 2013.\n> I've just edited that page to make this clear. Sorry...\n\nYet this method works .. especially if you want to also test GAP by itself: from the GAP console, apparently *these* packages (those compiled with the method above) are loaded.",
    "created_at": "2019-02-04T21:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414943",
    "user": "https://github.com/zerline"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@dimpase](#comment:51):
> Replying to [@zerline](#comment:48):
> > Could you point me to a documentation page for this?
> > 
> > (I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)
> > 

> This link is totally obsolete - edited last time in 2013.
> I've just edited that page to make this clear. Sorry...

Yet this method works .. especially if you want to also test GAP by itself: from the GAP console, apparently *these* packages (those compiled with the method above) are loaded.



---

archive/issue_comments_414944.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@kiwifb](#comment:52):\n> Replying to [@zerline](#comment:45):\n> > *after a bare ./configure --with-gaproot=../..* :\n> > \n> > \n> > ```\n> > (sage-sh) odile@ancolie:json-2.0.0$ make\n> >   CXX      src/json.lo\n> > src/json.cc:5:10: fatal error: src/compiled.h: Aucun fichier ou dossier de ce type\n> >  #include \"src/compiled.h\"          /* GAP headers                */\n> >           ^~~~~~~~~~~~~~~~\n> > compilation terminated.\n> > make: *** [Makefile:501: src/json.lo] Error 1\n> > \n> > ```\n\n> \n> That's exactly one of the things I patch see #26930?replyto=45#comment:26 \n\nthank you",
    "created_at": "2019-02-04T21:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414944",
    "user": "https://github.com/zerline"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@kiwifb](#comment:52):
> Replying to [@zerline](#comment:45):
> > *after a bare ./configure --with-gaproot=../..* :
> > 
> > 
> > ```
> > (sage-sh) odile@ancolie:json-2.0.0$ make
> >   CXX      src/json.lo
> > src/json.cc:5:10: fatal error: src/compiled.h: Aucun fichier ou dossier de ce type
> >  #include "src/compiled.h"          /* GAP headers                */
> >           ^~~~~~~~~~~~~~~~
> > compilation terminated.
> > make: *** [Makefile:501: src/json.lo] Error 1
> > 
> > ```

> 
> That's exactly one of the things I patch see #26930?replyto=45#comment:26 

thank you



---

archive/issue_comments_414945.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@zerline](#comment:54):\n> Replying to [@dimpase](#comment:51):\n> > Replying to [@zerline](#comment:48):\n> > > Could you point me to a documentation page for this?\n> > > \n> > > (I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)\n> > > \n\n> > This link is totally obsolete - edited last time in 2013.\n> > I've just edited that page to make this clear. Sorry...\n\n> \n> Yet this method works .. especially if you want to also test GAP by itself: from the GAP console, apparently *these* packages (those compiled with the method above) are loaded.\n\nthere is no guarantee that one does not break GAP's installation in Sage this way - and it happened in the past often that people tried installing this way GAP packages with kernel modules (such as IO) and ended up with broken Sage installations.",
    "created_at": "2019-02-04T21:43:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414945",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@zerline](#comment:54):
> Replying to [@dimpase](#comment:51):
> > Replying to [@zerline](#comment:48):
> > > Could you point me to a documentation page for this?
> > > 
> > > (I just used https://wiki.sagemath.org/InstallingGapPackages, which recommends compiling within the Sage shell)
> > > 

> > This link is totally obsolete - edited last time in 2013.
> > I've just edited that page to make this clear. Sorry...

> 
> Yet this method works .. especially if you want to also test GAP by itself: from the GAP console, apparently *these* packages (those compiled with the method above) are loaded.

there is no guarantee that one does not break GAP's installation in Sage this way - and it happened in the past often that people tried installing this way GAP packages with kernel modules (such as IO) and ended up with broken Sage installations.



---

archive/issue_events_371784.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:40:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371784"
}
```



---

archive/issue_events_371785.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:40:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371785"
}
```



---

archive/issue_comments_414946.json:
```json
{
    "body": "Changed work issues from **test it in libgap, also on OSX** to none",
    "created_at": "2019-02-05T13:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414946",
    "user": "https://github.com/dimpase"
}
```

Changed work issues from **test it in libgap, also on OSX** to none



---

archive/issue_events_371786.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:45:29Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "title_is": "fix GAP's gac/libtool, add GAP io and crypting pgs, fix libgap for GAP kernel modules",
    "title_was": "add GAP io package, set up libgap for GAP kernel modules",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371786"
}
```



---

archive/issue_events_371787.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:45:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371787"
}
```



---

archive/issue_events_371788.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:45:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371788"
}
```



---

archive/issue_comments_414947.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,4 +3,6 @@\n \n Here is a branch that implements this.\n \n-io package needs a small patch to use proper include directory\n+GAP package sources use old location for GAP headers, so we need to set up a symbolic link to accommodate this. \n+\n+We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, see #27218 for details.\n``````\n",
    "created_at": "2019-02-05T13:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414947",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,4 +3,6 @@
 
 Here is a branch that implements this.
 
-io package needs a small patch to use proper include directory
+GAP package sources use old location for GAP headers, so we need to set up a symbolic link to accommodate this. 
+
+We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, see #27218 for details.
``````




---

archive/issue_comments_414948.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@dimpase](#comment:44):\n> I don't see why we should not patch package's source.\n\nIt isn't necessary normally when building the package, so why should it have to be patched?  ISTM the problem is just how GAP is being \"installed\" in Sage, which as we know is tricky since it doesn't have a proper installation system.  \n\nI think the stuff Odile pointed out last night about `sysinfo.gap` clearly needs to be addressed (and in a separate ticket; this one is already trying to do too much).\n\nFor example, mine contains (this is just partial):\n\n```\n$ cat sysinfo.gap\n# This files has been generated by the GAP build system,\n# do not edit manually!\nGAParch=x86_64-unknown-cygwin-default64\nGAP_ABI=64\nGAP_HPCGAP=no\nGAP_ADDGUARDS2=\n\nGAP_BIN_DIR=\"/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src\"\nGAP_LIB_DIR=\"/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src\"\n\nGAP_CC=\"gcc\"\nGAP_CFLAGS=\" -O2 -g  \"\nGAP_CPPFLAGS=\" -I/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src/src -I/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/home/embray/src/sagemath/sage/local/include      \"\nGAP_LDFLAGS=\" -L/home/embray/src/sagemath/sage/local/lib      -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib   -Wl,--stack,16777216\"\nGAP_LIBS=\" -lgmp -lz -lreadline    \"\n```\n\nIn other words, it puts in a lot of paths, which seem to be important for building many packages, but that reference the SPKG build directory and not the actual final GAP_ROOT location (under `$SAGE_LOCAL/share/gap`).\n\nSo I think this probably needs to be fixed up when \"installing\" GAP, at a minimum.",
    "created_at": "2019-02-05T15:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414948",
    "user": "https://github.com/embray"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@dimpase](#comment:44):
> I don't see why we should not patch package's source.

It isn't necessary normally when building the package, so why should it have to be patched?  ISTM the problem is just how GAP is being "installed" in Sage, which as we know is tricky since it doesn't have a proper installation system.  

I think the stuff Odile pointed out last night about `sysinfo.gap` clearly needs to be addressed (and in a separate ticket; this one is already trying to do too much).

For example, mine contains (this is just partial):

```
$ cat sysinfo.gap
# This files has been generated by the GAP build system,
# do not edit manually!
GAParch=x86_64-unknown-cygwin-default64
GAP_ABI=64
GAP_HPCGAP=no
GAP_ADDGUARDS2=

GAP_BIN_DIR="/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src"
GAP_LIB_DIR="/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src"

GAP_CC="gcc"
GAP_CFLAGS=" -O2 -g  "
GAP_CPPFLAGS=" -I/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src/src -I/home/embray/src/sagemath/sage/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/home/embray/src/sagemath/sage/local/include      "
GAP_LDFLAGS=" -L/home/embray/src/sagemath/sage/local/lib      -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib   -Wl,--stack,16777216"
GAP_LIBS=" -lgmp -lz -lreadline    "
```

In other words, it puts in a lot of paths, which seem to be important for building many packages, but that reference the SPKG build directory and not the actual final GAP_ROOT location (under `$SAGE_LOCAL/share/gap`).

So I think this probably needs to be fixed up when "installing" GAP, at a minimum.



---

archive/issue_comments_414949.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nOn the other hand, the problem of using src/ prefix for includes in quite a few GAP packages seems to be a bit too big to patch.",
    "created_at": "2019-02-05T15:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414949",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:60" align="right">comment:60</div>

On the other hand, the problem of using src/ prefix for includes in quite a few GAP packages seems to be a bit too big to patch.



---

archive/issue_events_371789.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T16:39:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "title_is": "add GAP io and crypting pkgs",
    "title_was": "fix GAP's gac/libtool, add GAP io and crypting pgs, fix libgap for GAP kernel modules",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371789"
}
```



---

archive/issue_comments_414950.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nThis should be a dependent of #27218, not the other way around.   I think #27218 will help here.  I don't mind including crypting in this ticket as well since it is small and we know that it's been asked for.  Plus it helps to have an additional test case.",
    "created_at": "2019-02-05T16:39:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414950",
    "user": "https://github.com/embray"
}
```

<div id="comment:61" align="right">comment:61</div>

This should be a dependent of #27218, not the other way around.   I think #27218 will help here.  I don't mind including crypting in this ticket as well since it is small and we know that it's been asked for.  Plus it helps to have an additional test case.



---

archive/issue_comments_414951.json:
```json
{
    "body": "Dependencies: **#27218**",
    "created_at": "2019-02-05T16:39:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414951",
    "user": "https://github.com/embray"
}
```

Dependencies: **#27218**



---

archive/issue_comments_414952.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n+These GAP packages extend GAP kernel functionality. \n On the libgap side, this requires tinkering with the loader, see\n on #22626 Erik [proposed a patch](https://github.com/sagemath/sage/issues/22626#comment:424).\n \n Here is a branch that implements this.\n \n-GAP package sources use old location for GAP headers, so we need to set up a symbolic link to accommodate this. \n-\n-We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, see #27218 for details.\n+We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, done in #27218.\n``````\n",
    "created_at": "2019-02-06T15:26:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414952",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
+These GAP packages extend GAP kernel functionality. 
 On the libgap side, this requires tinkering with the loader, see
 on #22626 Erik [proposed a patch](https://github.com/sagemath/sage/issues/22626#comment:424).
 
 Here is a branch that implements this.
 
-GAP package sources use old location for GAP headers, so we need to set up a symbolic link to accommodate this. 
-
-We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, see #27218 for details.
+We also need to fix GAP's gac/libtool mini-toolchain, used by some GAP pkgs. This involves patching of gac, and installing libtool, done in #27218.
``````




---

archive/issue_comments_414953.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nI added yet one more ticket for working on a way to get the libgap.so: #27230\n\nThe idea, as in [comment:30](#comment:30), was to use the same code for both `SINGULAR_SO` and a new `LIBGAP_SO` variable which serves a similar purpose.\n\nIf that code ends up being contentious we can fall back on a simpler method, though I think either way it makes sense to reuse the code used for `SINGULAR_SO` as well, rather than just looping over some extension names.",
    "created_at": "2019-02-06T16:01:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414953",
    "user": "https://github.com/embray"
}
```

<div id="comment:63" align="right">comment:63</div>

I added yet one more ticket for working on a way to get the libgap.so: #27230

The idea, as in [comment:30](#comment:30), was to use the same code for both `SINGULAR_SO` and a new `LIBGAP_SO` variable which serves a similar purpose.

If that code ends up being contentious we can fall back on a simpler method, though I think either way it makes sense to reuse the code used for `SINGULAR_SO` as well, rather than just looping over some extension names.



---

archive/issue_comments_414954.json:
```json
{
    "body": "Changed commit from **[`0d7016a`](https://github.com/sagemath/sagetrac-mirror/commit/0d7016aa86ca24de03a3c3e7b5698af1e57040ff)** to **[`87f59cc`](https://github.com/sagemath/sagetrac-mirror/commit/87f59ccc8aa0b1697da8d6f11991bd1236b562e9)**",
    "created_at": "2019-02-06T16:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414954",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`0d7016a`](https://github.com/sagemath/sagetrac-mirror/commit/0d7016aa86ca24de03a3c3e7b5698af1e57040ff)** to **[`87f59cc`](https://github.com/sagemath/sagetrac-mirror/commit/87f59ccc8aa0b1697da8d6f11991bd1236b562e9)**



---

archive/issue_comments_414955.json:
```json
{
    "body": "Changed branch from **[public/packages/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/gap_io)** to **[u/dimpase/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/gap_io)**",
    "created_at": "2019-02-06T16:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414955",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[public/packages/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/gap_io)** to **[u/dimpase/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/gap_io)**



---

archive/issue_comments_414956.json:
```json
{
    "body": "<div id=\"comment:64\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc3d6fe5a2d957e2bfe8dab3f9888c25a552b878\"><code>cc3d6fe</code></a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bc1900d1ea4011be1bfc285bd85033c25ce0c82\"><code>5bc1900</code></a></td><td><code>make similar replacements in a couple more files that reference the GAP build directory</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87f59ccc8aa0b1697da8d6f11991bd1236b562e9\"><code>87f59cc</code></a></td><td><code>revise trac/public/packages/gap_io to use #27218</code></td></tr></table>\n",
    "created_at": "2019-02-06T16:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414956",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:64"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc3d6fe5a2d957e2bfe8dab3f9888c25a552b878"><code>cc3d6fe</code></a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bc1900d1ea4011be1bfc285bd85033c25ce0c82"><code>5bc1900</code></a></td><td><code>make similar replacements in a couple more files that reference the GAP build directory</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87f59ccc8aa0b1697da8d6f11991bd1236b562e9"><code>87f59cc</code></a></td><td><code>revise trac/public/packages/gap_io to use #27218</code></td></tr></table>




---

archive/issue_comments_414957.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nIf you want, please also try merging #27230 into this and adding a `LIBGAP_SO` to `sage.env` like I suggested in that ticket, and then use that instead of the loop you have currently around `dlopen`.  That's a good observation that for Python 3 it will have to pass bytes to `dlopen()`, so you can use `str_to_bytes(LIBGAP_SO)` for that.",
    "created_at": "2019-02-06T16:18:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414957",
    "user": "https://github.com/embray"
}
```

<div id="comment:65" align="right">comment:65</div>

If you want, please also try merging #27230 into this and adding a `LIBGAP_SO` to `sage.env` like I suggested in that ticket, and then use that instead of the loop you have currently around `dlopen`.  That's a good observation that for Python 3 it will have to pass bytes to `dlopen()`, so you can use `str_to_bytes(LIBGAP_SO)` for that.



---

archive/issue_comments_414958.json:
```json
{
    "body": "Changed commit from **[`87f59cc`](https://github.com/sagemath/sagetrac-mirror/commit/87f59ccc8aa0b1697da8d6f11991bd1236b562e9)** to **[`3a65f9e`](https://github.com/sagemath/sagetrac-mirror/commit/3a65f9e38b16c1c85fb581a327fa7855c613df68)**",
    "created_at": "2019-02-06T20:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414958",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`87f59cc`](https://github.com/sagemath/sagetrac-mirror/commit/87f59ccc8aa0b1697da8d6f11991bd1236b562e9)** to **[`3a65f9e`](https://github.com/sagemath/sagetrac-mirror/commit/3a65f9e38b16c1c85fb581a327fa7855c613df68)**



---

archive/issue_comments_414959.json:
```json
{
    "body": "<div id=\"comment:66\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51aa946c35472e69a828ef1dd6d16ab7161a249e\"><code>51aa946</code></a></td><td><code>repackages the code for finding the libSingular.so as a somewhat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/34b27b2c8068805c2f24adaa45740a80839cecbc\"><code>34b27b2</code></a></td><td><code>rework _get_shared_lib_filename to cover more system-specific cases,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/917a21ba4b07dc86ed855d57bfba5cde7a110f8e\"><code>917a21b</code></a></td><td><code>fixed the test to be a little more flexible</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/785bf10b7ad6f9ea24ef6ee21fa1784437159fb3\"><code>785bf10</code></a></td><td><code>Merge branch 'u/embray/misc/sage-env-lib-filename' of trac.sagemath.org:sage into HEAD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a65f9e38b16c1c85fb581a327fa7855c613df68\"><code>3a65f9e</code></a></td><td><code>use GAP_SO in the dlopen call</code></td></tr></table>\n",
    "created_at": "2019-02-06T20:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414959",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:66"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51aa946c35472e69a828ef1dd6d16ab7161a249e"><code>51aa946</code></a></td><td><code>repackages the code for finding the libSingular.so as a somewhat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/34b27b2c8068805c2f24adaa45740a80839cecbc"><code>34b27b2</code></a></td><td><code>rework _get_shared_lib_filename to cover more system-specific cases,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/917a21ba4b07dc86ed855d57bfba5cde7a110f8e"><code>917a21b</code></a></td><td><code>fixed the test to be a little more flexible</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/785bf10b7ad6f9ea24ef6ee21fa1784437159fb3"><code>785bf10</code></a></td><td><code>Merge branch 'u/embray/misc/sage-env-lib-filename' of trac.sagemath.org:sage into HEAD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a65f9e38b16c1c85fb581a327fa7855c613df68"><code>3a65f9e</code></a></td><td><code>use GAP_SO in the dlopen call</code></td></tr></table>




---

archive/issue_events_371790.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-06T20:08:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371790"
}
```



---

archive/issue_events_371791.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-06T20:08:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371791"
}
```



---

archive/issue_comments_414960.json:
```json
{
    "body": "Changed dependencies from **#27218** to **#27218, #27230**",
    "created_at": "2019-02-06T20:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414960",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27218** to **#27218, #27230**



---

archive/issue_comments_414961.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nonce #27230 done it will be ready for review",
    "created_at": "2019-02-06T20:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414961",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:67" align="right">comment:67</div>

once #27230 done it will be ready for review



---

archive/issue_comments_414962.json:
```json
{
    "body": "<div id=\"comment:68\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d7e1e81708a8543c4bb5d10ff4a00159c2a7414\"><code>0d7e1e8</code></a></td><td><code>add setting GAP_SO to env.py</code></td></tr></table>\n",
    "created_at": "2019-02-07T01:41:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414962",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:68"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d7e1e81708a8543c4bb5d10ff4a00159c2a7414"><code>0d7e1e8</code></a></td><td><code>add setting GAP_SO to env.py</code></td></tr></table>




---

archive/issue_comments_414963.json:
```json
{
    "body": "Changed commit from **[`3a65f9e`](https://github.com/sagemath/sagetrac-mirror/commit/3a65f9e38b16c1c85fb581a327fa7855c613df68)** to **[`0d7e1e8`](https://github.com/sagemath/sagetrac-mirror/commit/0d7e1e81708a8543c4bb5d10ff4a00159c2a7414)**",
    "created_at": "2019-02-07T01:41:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414963",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3a65f9e`](https://github.com/sagemath/sagetrac-mirror/commit/3a65f9e38b16c1c85fb581a327fa7855c613df68)** to **[`0d7e1e8`](https://github.com/sagemath/sagetrac-mirror/commit/0d7e1e81708a8543c4bb5d10ff4a00159c2a7414)**



---

archive/issue_comments_414964.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nso this is now really ready for review.",
    "created_at": "2019-02-07T01:43:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414964",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:69" align="right">comment:69</div>

so this is now really ready for review.



---

archive/issue_comments_414965.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nIs this supposed to work on distro with an unchanged gap or is the io package now required?",
    "created_at": "2019-02-07T11:55:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414965",
    "user": "https://github.com/timokau"
}
```

<div id="comment:70" align="right">comment:70</div>

Is this supposed to work on distro with an unchanged gap or is the io package now required?



---

archive/issue_comments_414966.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@timokau](#comment:70):\n> Is this supposed to work on distro with an unchanged gap or is the io package now required?\n\nno, io package is still optional. As you see, this ticket does two things:\n\n* fixes Sage's libgap interface to allow kernel modules\n\n* adds two packages (both needing the 1st thing) to its optional spkg gap_packages",
    "created_at": "2019-02-07T12:04:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414966",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@timokau](#comment:70):
> Is this supposed to work on distro with an unchanged gap or is the io package now required?

no, io package is still optional. As you see, this ticket does two things:

* fixes Sage's libgap interface to allow kernel modules

* adds two packages (both needing the 1st thing) to its optional spkg gap_packages



---

archive/issue_comments_414967.json:
```json
{
    "body": "Changed commit from **[`0d7e1e8`](https://github.com/sagemath/sagetrac-mirror/commit/0d7e1e81708a8543c4bb5d10ff4a00159c2a7414)** to **[`a2f76b2`](https://github.com/sagemath/sagetrac-mirror/commit/a2f76b272ef3e8626468257b34e05484cf4b82bd)**",
    "created_at": "2019-02-08T20:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414967",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0d7e1e8`](https://github.com/sagemath/sagetrac-mirror/commit/0d7e1e81708a8543c4bb5d10ff4a00159c2a7414)** to **[`a2f76b2`](https://github.com/sagemath/sagetrac-mirror/commit/a2f76b272ef3e8626468257b34e05484cf4b82bd)**



---

archive/issue_comments_414968.json:
```json
{
    "body": "<div id=\"comment:72\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45565933c078eebeccc54dc4d51754de839d775f\"><code>4556593</code></a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44d20c18a4108d1d0fc7e614cc166a1ca8e5ae4c\"><code>44d20c1</code></a></td><td><code>repackages the code for finding the libSingular.so as a somewhat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1eebc0d2e93f2615fcbe2bfa1c32c2f3106ef80e\"><code>1eebc0d</code></a></td><td><code>rework _get_shared_lib_filename to cover more system-specific cases,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad3410ba0eb31169edcca1db587d7dd7f780dd20\"><code>ad3410b</code></a></td><td><code>fixed the test to be a little more flexible</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/691eeb8ca3ce93206912f1dace9d3020716f600c\"><code>691eeb8</code></a></td><td><code>rebased over 8.7.beta3 and the dependent tickets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2f76b272ef3e8626468257b34e05484cf4b82bd\"><code>a2f76b2</code></a></td><td><code>add setting GAP_SO to env.py</code></td></tr></table>\n",
    "created_at": "2019-02-08T20:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414968",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:72"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45565933c078eebeccc54dc4d51754de839d775f"><code>4556593</code></a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44d20c18a4108d1d0fc7e614cc166a1ca8e5ae4c"><code>44d20c1</code></a></td><td><code>repackages the code for finding the libSingular.so as a somewhat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1eebc0d2e93f2615fcbe2bfa1c32c2f3106ef80e"><code>1eebc0d</code></a></td><td><code>rework _get_shared_lib_filename to cover more system-specific cases,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad3410ba0eb31169edcca1db587d7dd7f780dd20"><code>ad3410b</code></a></td><td><code>fixed the test to be a little more flexible</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/691eeb8ca3ce93206912f1dace9d3020716f600c"><code>691eeb8</code></a></td><td><code>rebased over 8.7.beta3 and the dependent tickets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2f76b272ef3e8626468257b34e05484cf4b82bd"><code>a2f76b2</code></a></td><td><code>add setting GAP_SO to env.py</code></td></tr></table>




---

archive/issue_comments_414969.json:
```json
{
    "body": "<div id=\"comment:73\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2456f8f1b6b5f8309d35be4eff523a2ea1b7578d\"><code>2456f8f</code></a></td><td><code>rebased over 8.7.beta3 and the dependent tickets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99c0afca419ea98ffa31762a21425c4591f98a83\"><code>99c0afc</code></a></td><td><code>add setting GAP_SO to env.py</code></td></tr></table>\n",
    "created_at": "2019-02-26T11:08:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414969",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:73"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2456f8f1b6b5f8309d35be4eff523a2ea1b7578d"><code>2456f8f</code></a></td><td><code>rebased over 8.7.beta3 and the dependent tickets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99c0afca419ea98ffa31762a21425c4591f98a83"><code>99c0afc</code></a></td><td><code>add setting GAP_SO to env.py</code></td></tr></table>




---

archive/issue_comments_414970.json:
```json
{
    "body": "Changed commit from **[`a2f76b2`](https://github.com/sagemath/sagetrac-mirror/commit/a2f76b272ef3e8626468257b34e05484cf4b82bd)** to **[`99c0afc`](https://github.com/sagemath/sagetrac-mirror/commit/99c0afca419ea98ffa31762a21425c4591f98a83)**",
    "created_at": "2019-02-26T11:08:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414970",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a2f76b2`](https://github.com/sagemath/sagetrac-mirror/commit/a2f76b272ef3e8626468257b34e05484cf4b82bd)** to **[`99c0afc`](https://github.com/sagemath/sagetrac-mirror/commit/99c0afca419ea98ffa31762a21425c4591f98a83)**



---

archive/issue_comments_414971.json:
```json
{
    "body": "Changed commit from **[`99c0afc`](https://github.com/sagemath/sagetrac-mirror/commit/99c0afca419ea98ffa31762a21425c4591f98a83)** to **[`4927c10`](https://github.com/sagemath/sagetrac-mirror/commit/4927c10700abe459289512245549ce035d0d9f52)**",
    "created_at": "2019-02-27T21:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414971",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`99c0afc`](https://github.com/sagemath/sagetrac-mirror/commit/99c0afca419ea98ffa31762a21425c4591f98a83)** to **[`4927c10`](https://github.com/sagemath/sagetrac-mirror/commit/4927c10700abe459289512245549ce035d0d9f52)**



---

archive/issue_comments_414972.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db932f056121086a54530bf8079685861807b9c2\"><code>db932f0</code></a></td><td><code>extra / breaks sdh_install on OSX</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4927c10700abe459289512245549ce035d0d9f52\"><code>4927c10</code></a></td><td><code>Merge 'u/dimpase/gap_io' with fix from #27380</code></td></tr></table>\n",
    "created_at": "2019-02-27T21:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414972",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db932f056121086a54530bf8079685861807b9c2"><code>db932f0</code></a></td><td><code>extra / breaks sdh_install on OSX</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4927c10700abe459289512245549ce035d0d9f52"><code>4927c10</code></a></td><td><code>Merge 'u/dimpase/gap_io' with fix from #27380</code></td></tr></table>




---

archive/issue_comments_414973.json:
```json
{
    "body": "Changed dependencies from **#27218, #27230** to **#27218, #27230, #27380**",
    "created_at": "2019-02-27T21:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414973",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27218, #27230** to **#27218, #27230, #27380**



---

archive/issue_comments_414974.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\n#27380 (extra `/` removed (sic!)) has apparently fixed the problem I had with this branch on OSX, upon running tests on my ancient MacBook it should be ready to go.",
    "created_at": "2019-02-27T22:08:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414974",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:76" align="right">comment:76</div>

#27380 (extra `/` removed (sic!)) has apparently fixed the problem I had with this branch on OSX, upon running tests on my ancient MacBook it should be ready to go.



---

archive/issue_comments_414975.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nTests pass on OSX and Linux. Please review.",
    "created_at": "2019-02-28T07:01:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414975",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:77" align="right">comment:77</div>

Tests pass on OSX and Linux. Please review.



---

archive/issue_comments_414976.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nOSX-specific reviews are needed for this ticket and #27380",
    "created_at": "2019-02-28T07:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414976",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:78" align="right">comment:78</div>

OSX-specific reviews are needed for this ticket and #27380



---

archive/issue_comments_414977.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nIs there a reason this first \"installs\" crypting by copy in\n\n```diff\ndiff --git a/build/pkgs/gap_packages/spkg-install b/build/pkgs/gap_packages/spkg-install\nindex 1a3e8c5..07ce727 100644\n--- a/build/pkgs/gap_packages/spkg-install\n+++ b/build/pkgs/gap_packages/spkg-install\n@@ -15,6 +15,7 @@ sdh_install \\\n     AutoDoc-* \\\n     corelg \\\n     crime-* \\\n+    crypting-* \\\n     cryst \\\n     crystcat \\\n     design \\\n```\n\nbut then installs it again (including compilation) further down in\n\n```diff\n@@ -63,7 +64,7 @@ install_compiled_pkg()\n #\n # These packages have an old ./configure that take the GAP_ROOT as a positional\n # argument\n-for pkg in cohomolo-* grape-* guava-*\n+for pkg in cohomolo-* crypting-* grape-* guava-*\n do\n     echo \"Building GAP package $pkg\"\n     cd \"$PKG_SRC_DIR/$pkg\"\n```",
    "created_at": "2019-02-28T10:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414977",
    "user": "https://github.com/embray"
}
```

<div id="comment:79" align="right">comment:79</div>

Is there a reason this first "installs" crypting by copy in

```diff
diff --git a/build/pkgs/gap_packages/spkg-install b/build/pkgs/gap_packages/spkg-install
index 1a3e8c5..07ce727 100644
--- a/build/pkgs/gap_packages/spkg-install
+++ b/build/pkgs/gap_packages/spkg-install
@@ -15,6 +15,7 @@ sdh_install \
     AutoDoc-* \
     corelg \
     crime-* \
+    crypting-* \
     cryst \
     crystcat \
     design \
```

but then installs it again (including compilation) further down in

```diff
@@ -63,7 +64,7 @@ install_compiled_pkg()
 #
 # These packages have an old ./configure that take the GAP_ROOT as a positional
 # argument
-for pkg in cohomolo-* grape-* guava-*
+for pkg in cohomolo-* crypting-* grape-* guava-*
 do
     echo "Building GAP package $pkg"
     cd "$PKG_SRC_DIR/$pkg"
```



---

archive/issue_comments_414978.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nlooks like a harmless typo...",
    "created_at": "2019-02-28T10:26:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414978",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:80" align="right">comment:80</div>

looks like a harmless typo...



---

archive/issue_comments_414979.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nAny comment on [comment:32](#comment:32) ?  This test really shouldn't be giving unpredictable results.",
    "created_at": "2019-02-28T10:26:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414979",
    "user": "https://github.com/embray"
}
```

<div id="comment:81" align="right">comment:81</div>

Any comment on [comment:32](#comment:32) ?  This test really shouldn't be giving unpredictable results.



---

archive/issue_comments_414980.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@dimpase](#comment:80):\n> looks like a harmless typo...\n\nI wouldn't necessarily call it \"harmless\" but if it's a typo that's okay; I just wondered if there was a real reason or not.",
    "created_at": "2019-02-28T10:27:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414980",
    "user": "https://github.com/embray"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@dimpase](#comment:80):
> looks like a harmless typo...

I wouldn't necessarily call it "harmless" but if it's a typo that's okay; I just wondered if there was a real reason or not.



---

archive/issue_comments_414981.json:
```json
{
    "body": "<div id=\"comment:83\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a2bb6daa62b266a8463ab1f1f40b3a3b4024b12\"><code>1a2bb6d</code></a></td><td><code>only install crypting once</code></td></tr></table>\n",
    "created_at": "2019-02-28T16:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414981",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:83"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a2bb6daa62b266a8463ab1f1f40b3a3b4024b12"><code>1a2bb6d</code></a></td><td><code>only install crypting once</code></td></tr></table>




---

archive/issue_comments_414982.json:
```json
{
    "body": "Changed commit from **[`4927c10`](https://github.com/sagemath/sagetrac-mirror/commit/4927c10700abe459289512245549ce035d0d9f52)** to **[`1a2bb6d`](https://github.com/sagemath/sagetrac-mirror/commit/1a2bb6daa62b266a8463ab1f1f40b3a3b4024b12)**",
    "created_at": "2019-02-28T16:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414982",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4927c10`](https://github.com/sagemath/sagetrac-mirror/commit/4927c10700abe459289512245549ce035d0d9f52)** to **[`1a2bb6d`](https://github.com/sagemath/sagetrac-mirror/commit/1a2bb6daa62b266a8463ab1f1f40b3a3b4024b12)**



---

archive/issue_comments_414983.json:
```json
{
    "body": "<div id=\"comment:84\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61600394e43bdefbc918fa03a817311b39af4a05\"><code>6160039</code></a></td><td><code>removed #random tag, as it's hopefully fixed</code></td></tr></table>\n",
    "created_at": "2019-02-28T17:37:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414983",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:84"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61600394e43bdefbc918fa03a817311b39af4a05"><code>6160039</code></a></td><td><code>removed #random tag, as it's hopefully fixed</code></td></tr></table>




---

archive/issue_comments_414984.json:
```json
{
    "body": "Changed commit from **[`1a2bb6d`](https://github.com/sagemath/sagetrac-mirror/commit/1a2bb6daa62b266a8463ab1f1f40b3a3b4024b12)** to **[`6160039`](https://github.com/sagemath/sagetrac-mirror/commit/61600394e43bdefbc918fa03a817311b39af4a05)**",
    "created_at": "2019-02-28T17:37:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414984",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1a2bb6d`](https://github.com/sagemath/sagetrac-mirror/commit/1a2bb6daa62b266a8463ab1f1f40b3a3b4024b12)** to **[`6160039`](https://github.com/sagemath/sagetrac-mirror/commit/61600394e43bdefbc918fa03a817311b39af4a05)**



---

archive/issue_comments_414985.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nFixed both things.",
    "created_at": "2019-02-28T17:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414985",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:85" align="right">comment:85</div>

Fixed both things.



---

archive/issue_comments_414986.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nSeems to work on OS X. At least there is more stuff (`io`, `crypting`) in `local/share/gap/pkg` with this branch than without it. I'm not sure what the breakage was from #27380: `gap_packages` installed for me on top of a clean install of 8.7.beta5 without these branches.\n\nWhat else would you like me to check?",
    "created_at": "2019-02-28T18:26:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414986",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:86" align="right">comment:86</div>

Seems to work on OS X. At least there is more stuff (`io`, `crypting`) in `local/share/gap/pkg` with this branch than without it. I'm not sure what the breakage was from #27380: `gap_packages` installed for me on top of a clean install of 8.7.beta5 without these branches.

What else would you like me to check?



---

archive/issue_comments_414987.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nReplying to [@jhpalmieri](#comment:86):\n> Seems to work on OS X. At least there is more stuff (`io`, `crypting`) in `local/share/gap/pkg` with this branch than without it. I'm not sure what the breakage was from #27380: `gap_packages` installed for me on top of a clean install of 8.7.beta5 without these branches.\n> \n\nbut some GAP packages were not fully functional, as their binaries (only few GAP packages have these) were installed in wrong directories...\n\n> What else would you like me to check?\n\ncould you run tests, just to have another data point? (I tested on OSX 10.13, I don't have 10.14, my OSX box is too old for it).",
    "created_at": "2019-02-28T18:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414987",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:87" align="right">comment:87</div>

Replying to [@jhpalmieri](#comment:86):
> Seems to work on OS X. At least there is more stuff (`io`, `crypting`) in `local/share/gap/pkg` with this branch than without it. I'm not sure what the breakage was from #27380: `gap_packages` installed for me on top of a clean install of 8.7.beta5 without these branches.
> 

but some GAP packages were not fully functional, as their binaries (only few GAP packages have these) were installed in wrong directories...

> What else would you like me to check?

could you run tests, just to have another data point? (I tested on OSX 10.13, I don't have 10.14, my OSX box is too old for it).



---

archive/issue_comments_414988.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nAll tests pass for me. I didn't run full tests with `gap_packages` but without this branch, but I ran limited tests and saw one failure in `sage/groups`. So this looks good to me.",
    "created_at": "2019-02-28T20:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414988",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:88" align="right">comment:88</div>

All tests pass for me. I didn't run full tests with `gap_packages` but without this branch, but I ran limited tests and saw one failure in `sage/groups`. So this looks good to me.



---

archive/issue_comments_414989.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nI don't have a great internet connection at the moment but I can test on macosx 10.14.2 by Monday, if not earlier. This said, since this is a package can some one please tell me what needs to be tested. Is `sage -i io && sage -i macosx && make ptestlong` enough?",
    "created_at": "2019-03-01T13:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414989",
    "user": "https://github.com/AndrewAtLarge"
}
```

<div id="comment:89" align="right">comment:89</div>

I don't have a great internet connection at the moment but I can test on macosx 10.14.2 by Monday, if not earlier. This said, since this is a package can some one please tell me what needs to be tested. Is `sage -i io && sage -i macosx && make ptestlong` enough?



---

archive/issue_comments_414990.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nReplying to [@AndrewAtLarge](#comment:89):\n> I don't have a great internet connection at the moment but I can test on macosx 10.14.2 by Monday, if not earlier. This said, since this is a package can some one please tell me what needs to be tested. Is `sage -i io && sage -i macosx && make ptestlong` enough? \n\nYou just need to pull the branch, the GAP tarball is the same. So can be done over GSM :-)\n\nAfter merging the branch, you'll need to do \n\n```\n./sage -f gap_packages && make ptestlong\n```\nAnd if there are errors in tests, please posts them (from `logs/ptestlong.log` file).\nThanks!",
    "created_at": "2019-03-01T13:31:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414990",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:90" align="right">comment:90</div>

Replying to [@AndrewAtLarge](#comment:89):
> I don't have a great internet connection at the moment but I can test on macosx 10.14.2 by Monday, if not earlier. This said, since this is a package can some one please tell me what needs to be tested. Is `sage -i io && sage -i macosx && make ptestlong` enough? 

You just need to pull the branch, the GAP tarball is the same. So can be done over GSM :-)

After merging the branch, you'll need to do 

```
./sage -f gap_packages && make ptestlong
```
And if there are errors in tests, please posts them (from `logs/ptestlong.log` file).
Thanks!



---

archive/issue_comments_414991.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nOn Cygwin I'm getting a few cases of this failure in `src/sage/coding/linear_code.py`:\n\n```\nsage -t --long src/sage/coding/linear_code.py\n**********************************************************************\nFile \"src/sage/coding/linear_code.py\", line 3134, in sage.coding.linear_code.AbstractLinearCode.weight_distribution\nFailed example:\n    C.weight_distribution(algorithm=\"leon\")   # optional - gap_packages (Guava package)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.coding.linear_code.AbstractLinearCode.weight_distribution[8]>\", line 1, in <module>\n        C.weight_distribution(algorithm=\"leon\")   # optional - gap_packages (Guava package)\n      File \"sage/misc/cachefunc.pyx\", line 1950, in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10265)\n        w = self._instance_call(*args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1826, in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:9750)\n        return self.f(self._instance, *args, **kwds)\n      File \"/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.py\", line 3184, in weight_distribution\n        lines = subprocess.check_output([os.path.join(guava_bin_dir, 'wtdist'), input])\n      File \"/home/embray/src/sagemath/sage/local/lib/python2.7/subprocess.py\", line 223, in check_output\n        raise CalledProcessError(retcode, cmd, output=output)\n    CalledProcessError: Command '['/home/embray/src/sagemath/sage/local/share/gap/pkg/guava-3.14/bin/x86_64-unknown-cygwin-default64/wtdist', '/home/embray/.sage/temp/NAVI-Brick/6764/tmp_7ZlhoX::code']' returned non-zero exit status -11\n```\n\nThe \"exit status -11\" indicates that the `wtdist` program, whatever that is, from the guava package is segfaulting.  Which is odd because I don't remember having any problem with that before, and it's not clear why it would start with this ticket (unless maybe it's doing something with the IO module that it didn't do when it was unavailable).\n\nI'm going to try backing out the changes from this ticket and rebuilding `gap_packages` again just to rule out the possibility that the problem is somehow related to this ticket.",
    "created_at": "2019-03-01T15:34:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414991",
    "user": "https://github.com/embray"
}
```

<div id="comment:91" align="right">comment:91</div>

On Cygwin I'm getting a few cases of this failure in `src/sage/coding/linear_code.py`:

```
sage -t --long src/sage/coding/linear_code.py
**********************************************************************
File "src/sage/coding/linear_code.py", line 3134, in sage.coding.linear_code.AbstractLinearCode.weight_distribution
Failed example:
    C.weight_distribution(algorithm="leon")   # optional - gap_packages (Guava package)
Exception raised:
    Traceback (most recent call last):
      File "/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.coding.linear_code.AbstractLinearCode.weight_distribution[8]>", line 1, in <module>
        C.weight_distribution(algorithm="leon")   # optional - gap_packages (Guava package)
      File "sage/misc/cachefunc.pyx", line 1950, in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10265)
        w = self._instance_call(*args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1826, in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:9750)
        return self.f(self._instance, *args, **kwds)
      File "/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.py", line 3184, in weight_distribution
        lines = subprocess.check_output([os.path.join(guava_bin_dir, 'wtdist'), input])
      File "/home/embray/src/sagemath/sage/local/lib/python2.7/subprocess.py", line 223, in check_output
        raise CalledProcessError(retcode, cmd, output=output)
    CalledProcessError: Command '['/home/embray/src/sagemath/sage/local/share/gap/pkg/guava-3.14/bin/x86_64-unknown-cygwin-default64/wtdist', '/home/embray/.sage/temp/NAVI-Brick/6764/tmp_7ZlhoX::code']' returned non-zero exit status -11
```

The "exit status -11" indicates that the `wtdist` program, whatever that is, from the guava package is segfaulting.  Which is odd because I don't remember having any problem with that before, and it's not clear why it would start with this ticket (unless maybe it's doing something with the IO module that it didn't do when it was unavailable).

I'm going to try backing out the changes from this ticket and rebuilding `gap_packages` again just to rule out the possibility that the problem is somehow related to this ticket.



---

archive/issue_comments_414992.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nwe didn't build this part of guava before, that's why...",
    "created_at": "2019-03-01T17:18:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414992",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:92" align="right">comment:92</div>

we didn't build this part of guava before, that's why...



---

archive/issue_comments_414993.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nI don't see anything explicitly in this ticket that would cause it to start being built though, so I'm a little confused.  Is it because we didn't have #27218?  Does it just, silently not build or something?",
    "created_at": "2019-03-01T17:36:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414993",
    "user": "https://github.com/embray"
}
```

<div id="comment:93" align="right">comment:93</div>

I don't see anything explicitly in this ticket that would cause it to start being built though, so I'm a little confused.  Is it because we didn't have #27218?  Does it just, silently not build or something?



---

archive/issue_comments_414994.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nAFAICT the code that uses it doesn't check if the `wtdist` program exists or not or anything like that, so it should have just failed before with a command not found or something if it wasn't being built...",
    "created_at": "2019-03-01T17:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414994",
    "user": "https://github.com/embray"
}
```

<div id="comment:94" align="right">comment:94</div>

AFAICT the code that uses it doesn't check if the `wtdist` program exists or not or anything like that, so it should have just failed before with a command not found or something if it wasn't being built...



---

archive/issue_comments_414995.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nWell I was able to reproduce that issue with `gap_packages` prior to this ticket so I guess it's unrelated.  I'll make a new ticket for it. I'm not overly concerned about it in this case since gap_packages is not installed by default anyways.\n\nAs a side note, I realized in testing this that it this ticket should also bump the patch version on the SPKG version.\n\nWe should also clean up the commit history.  I can go ahead and do that...",
    "created_at": "2019-03-01T18:16:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414995",
    "user": "https://github.com/embray"
}
```

<div id="comment:95" align="right">comment:95</div>

Well I was able to reproduce that issue with `gap_packages` prior to this ticket so I guess it's unrelated.  I'll make a new ticket for it. I'm not overly concerned about it in this case since gap_packages is not installed by default anyways.

As a side note, I realized in testing this that it this ticket should also bump the patch version on the SPKG version.

We should also clean up the commit history.  I can go ahead and do that...



---

archive/issue_comments_414996.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\noops, sorry, I meant it was not installed before GAP 4.10.\nI gather it could be something trivial like whether or not there is `.exe` suffix...\n\nYes, please, bump up the version and rebase. The follow-up to this is #27295.",
    "created_at": "2019-03-01T18:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414996",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:96" align="right">comment:96</div>

oops, sorry, I meant it was not installed before GAP 4.10.
I gather it could be something trivial like whether or not there is `.exe` suffix...

Yes, please, bump up the version and rebase. The follow-up to this is #27295.



---

archive/issue_comments_414997.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nOkay, I'm fine with this now, especially since you tested on OSX.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ece3d59998c4d362b02744c03475a59bd6d8ef30\"><code>ece3d59</code></a></td><td><code>extra / breaks sdh_install on OSX</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77a2f32fd890c23bf6599609b4a26e718c77073b\"><code>77a2f32</code></a></td><td><code>Trac #26930: add setting GAP_SO to env.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/985e63a070ff2c164ab284016a9664f47c523738\"><code>985e63a</code></a></td><td><code>Trac: #26930: add GAP IO and crypting packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb77ab1b14ac08afebb95a08a4981230b6809d5b\"><code>bb77ab1</code></a></td><td><code>Trac #26903: Bump package version</code></td></tr></table>\n",
    "created_at": "2019-03-01T18:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414997",
    "user": "https://github.com/embray"
}
```

<div id="comment:97" align="right">comment:97</div>

Okay, I'm fine with this now, especially since you tested on OSX.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ece3d59998c4d362b02744c03475a59bd6d8ef30"><code>ece3d59</code></a></td><td><code>extra / breaks sdh_install on OSX</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77a2f32fd890c23bf6599609b4a26e718c77073b"><code>77a2f32</code></a></td><td><code>Trac #26930: add setting GAP_SO to env.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/985e63a070ff2c164ab284016a9664f47c523738"><code>985e63a</code></a></td><td><code>Trac: #26930: add GAP IO and crypting packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb77ab1b14ac08afebb95a08a4981230b6809d5b"><code>bb77ab1</code></a></td><td><code>Trac #26903: Bump package version</code></td></tr></table>




---

archive/issue_comments_414998.json:
```json
{
    "body": "Reviewer: **Erik Bray**",
    "created_at": "2019-03-01T18:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414998",
    "user": "https://github.com/embray"
}
```

Reviewer: **Erik Bray**



---

archive/issue_comments_414999.json:
```json
{
    "body": "Changed commit from **[`6160039`](https://github.com/sagemath/sagetrac-mirror/commit/61600394e43bdefbc918fa03a817311b39af4a05)** to **[`bb77ab1`](https://github.com/sagemath/sagetrac-mirror/commit/bb77ab1b14ac08afebb95a08a4981230b6809d5b)**",
    "created_at": "2019-03-01T18:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-414999",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`6160039`](https://github.com/sagemath/sagetrac-mirror/commit/61600394e43bdefbc918fa03a817311b39af4a05)** to **[`bb77ab1`](https://github.com/sagemath/sagetrac-mirror/commit/bb77ab1b14ac08afebb95a08a4981230b6809d5b)**



---

archive/issue_comments_415000.json:
```json
{
    "body": "Changed branch from **[u/dimpase/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/gap_io)** to **[public/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/gap_io)**",
    "created_at": "2019-03-01T18:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-415000",
    "user": "https://github.com/embray"
}
```

Changed branch from **[u/dimpase/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/gap_io)** to **[public/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/gap_io)**



---

archive/issue_events_371792.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-01T18:51:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371792"
}
```



---

archive/issue_events_371793.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-01T18:51:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371793"
}
```



---

archive/issue_events_371794.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2019-03-01T18:57:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371794"
}
```



---

archive/issue_events_371795.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2019-03-01T18:57:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371795"
}
```



---

archive/issue_comments_415001.json:
```json
{
    "body": "Changed commit from **[`bb77ab1`](https://github.com/sagemath/sagetrac-mirror/commit/bb77ab1b14ac08afebb95a08a4981230b6809d5b)** to **[`c84753f`](https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8)**",
    "created_at": "2019-03-01T18:57:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-415001",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bb77ab1`](https://github.com/sagemath/sagetrac-mirror/commit/bb77ab1b14ac08afebb95a08a4981230b6809d5b)** to **[`c84753f`](https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8)**



---

archive/issue_comments_415002.json:
```json
{
    "body": "<div id=\"comment:98\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e85cc632caa6edce7af6d97925adb0659da4f18\"><code>7e85cc6</code></a></td><td><code>Trac #26930: add GAP IO and crypting packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8\"><code>c84753f</code></a></td><td><code>Trac #26903: Bump package version</code></td></tr></table>\n",
    "created_at": "2019-03-01T18:57:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-415002",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:98"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e85cc632caa6edce7af6d97925adb0659da4f18"><code>7e85cc6</code></a></td><td><code>Trac #26930: add GAP IO and crypting packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8"><code>c84753f</code></a></td><td><code>Trac #26903: Bump package version</code></td></tr></table>




---

archive/issue_events_371796.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-01T18:57:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371796"
}
```



---

archive/issue_events_371797.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-01T18:57:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371797"
}
```



---

archive/issue_comments_415003.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nJust reworded one of the commit messages.",
    "created_at": "2019-03-01T18:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-415003",
    "user": "https://github.com/embray"
}
```

<div id="comment:99" align="right">comment:99</div>

Just reworded one of the commit messages.



---

archive/issue_events_371798.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-03T22:38:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371798"
}
```



---

archive/issue_events_371799.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2f926c717fde7dbd0fffcb9a7dc365a9babf851c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-03T22:38:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26930#event-371799"
}
```



---

archive/issue_comments_415004.json:
```json
{
    "body": "Changed branch from **[public/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/gap_io)** to **[`c84753f`](https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8)**",
    "created_at": "2019-03-03T22:38:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26930#issuecomment-415004",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/gap_io](https://github.com/sagemath/sagetrac-mirror/tree/public/gap_io)** to **[`c84753f`](https://github.com/sagemath/sagetrac-mirror/commit/c84753f36265886e31cbf9d7c31745d176a907c8)**
