# Issue 26130: fflas_ffpack is not tested, tests fail

archive/issues_025893.json:
```json
{
    "body": "While trying to port the nix build (and its dependencies) to darwin, `@`jbaum98 [discovered](https://github.com/linbox-team/fflas-ffpack/issues/173) that the fflas-ffpack tests are failing on darwin when using openblas. They don't fail on linux using openblas and they don't fail on darwin using another blas.\n\nTrying to figure out if that is a nix issue or a fflas-ffpack / openblas issue, I compared our build with the sage spkg. I noticed that sage is not even running the fflas_ffpack tests. So maybe some issues with darwin have gone unnoticed.\n\nI even get one test failure on linux:\n\n```\nFAIL: test-fgemm-check\n======================\n\nChecking ............................Modular<double> mod 67 ... PASSED with seed = 1535225205942725\nChecking ........................Modular<double> mod 351293 ... PASSED with seed = 1535225205942726\nChecking .........................Modular<double> mod 17659 ... PASSED with seed = 1535225205942727\nChecking ....................ModularBalanced<double> mod 67 ... PASSED with seed = 1535225205942725\nChecking ................ModularBalanced<double> mod 351293 ... PASSED with seed = 1535225205942726\nChecking .................ModularBalanced<double> mod 17659 ... PASSED with seed = 1535225205942727\nChecking .............................Modular<float> mod 13 ... FAILED\nFAILED with seed = 1535225205942725\nFAIL test-fgemm-check (exit status: 1)\n```\n\nUpstream issue: https://github.com/linbox-team/fflas-ffpack/issues/146\n\n\nCC:  @videlec @ClementPernet @dimpase @antonio-rojas @mkoeppe\n\nKeywords: darwin\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Matthias Koeppe\n\nAuthor: Timo Kaufmann\n\nBranch: 3ff111f82f23bd20ce072571d21566774ea2810e\n\nCommit: 3ff111f82f23bd20ce072571d21566774ea2810e\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26130\n\n",
    "closed_at": "2020-01-31T23:49:56Z",
    "created_at": "2018-08-25T19:39:44Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "fflas_ffpack is not tested, tests fail",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26130",
    "user": "https://github.com/timokau"
}
```
While trying to port the nix build (and its dependencies) to darwin, `@`jbaum98 [discovered](https://github.com/linbox-team/fflas-ffpack/issues/173) that the fflas-ffpack tests are failing on darwin when using openblas. They don't fail on linux using openblas and they don't fail on darwin using another blas.

Trying to figure out if that is a nix issue or a fflas-ffpack / openblas issue, I compared our build with the sage spkg. I noticed that sage is not even running the fflas_ffpack tests. So maybe some issues with darwin have gone unnoticed.

I even get one test failure on linux:

```
FAIL: test-fgemm-check
======================

Checking ............................Modular<double> mod 67 ... PASSED with seed = 1535225205942725
Checking ........................Modular<double> mod 351293 ... PASSED with seed = 1535225205942726
Checking .........................Modular<double> mod 17659 ... PASSED with seed = 1535225205942727
Checking ....................ModularBalanced<double> mod 67 ... PASSED with seed = 1535225205942725
Checking ................ModularBalanced<double> mod 351293 ... PASSED with seed = 1535225205942726
Checking .................ModularBalanced<double> mod 17659 ... PASSED with seed = 1535225205942727
Checking .............................Modular<float> mod 13 ... FAILED
FAILED with seed = 1535225205942725
FAIL test-fgemm-check (exit status: 1)
```

Upstream issue: https://github.com/linbox-team/fflas-ffpack/issues/146


CC:  @videlec @ClementPernet @dimpase @antonio-rojas @mkoeppe

Keywords: darwin

Upstream: Fixed upstream, in a later stable release.

Reviewer: Matthias Koeppe

Author: Timo Kaufmann

Branch: 3ff111f82f23bd20ce072571d21566774ea2810e

Commit: 3ff111f82f23bd20ce072571d21566774ea2810e

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26130





---

archive/issue_comments_365018.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-08-25T19:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365018",
    "user": "https://github.com/timokau"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_365019.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-08-25T19:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365019",
    "user": "https://github.com/timokau"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_365020.json:
```json
{
    "body": "Changing keywords from \"\" to \"darwin\".",
    "created_at": "2018-08-25T19:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365020",
    "user": "https://github.com/timokau"
}
```

Changing keywords from "" to "darwin".



---

archive/issue_comments_365021.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2018-08-25T19:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365021",
    "user": "https://github.com/timokau"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_365022.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-08-25T21:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_365023.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-27T13:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365023",
    "user": "https://github.com/timokau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_365024.json:
```json
{
    "body": "<a id='comment:3'></a>Setting to needs_review since someone with acess to a darwin machine needs to test this.",
    "created_at": "2018-10-27T13:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365024",
    "user": "https://github.com/timokau"
}
```

<a id='comment:3'></a>Setting to needs_review since someone with acess to a darwin machine needs to test this.



---

archive/issue_events_065164.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-10-29T18:17:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65164"
}
```



---

archive/issue_comments_365025.json:
```json
{
    "body": "<a id='comment:5'></a>On Darwin i get a fail with openblas too\n\n```\n$ sage -f -c fflas_ffpack\n...\n[fflas_ffpack-2.3.2] PASS: test-ftrmm\n[fflas_ffpack-2.3.2] FAIL: test-fgemm-check\n[fflas_ffpack-2.3.2] PASS: test-permutations\n...\n```\n\nIt look like it's a fflas-ffpack / openblas issue.\n\n\n```\n# file test-fgemm-check.log\nChecking ..........................Modular<double> mod 1693 ... PASSED with seed = 1541770760090127\nChecking .........................Modular<double> mod 12421 ... PASSED with seed = 1541770760090128\nChecking ...........................Modular<double> mod 139 ... PASSED with seed = 1541770760090129\nChecking ..................ModularBalanced<double> mod 1693 ... PASSED with seed = 1541770760090127\nChecking .................ModularBalanced<double> mod 12421 ... PASSED with seed = 1541770760090128\nChecking ...................ModularBalanced<double> mod 139 ... PASSED with seed = 1541770760090129\nChecking ...........................Modular<float> mod 1693 ... PASSED with seed = 1541770760090127\nChecking .............................Modular<float> mod 47 ... FAILED\nFAILED with seed = 1541770760090128\nFAIL test-fgemm-check (exit status: 1)\n```",
    "created_at": "2018-11-09T14:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365025",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:5'></a>On Darwin i get a fail with openblas too

```
$ sage -f -c fflas_ffpack
...
[fflas_ffpack-2.3.2] PASS: test-ftrmm
[fflas_ffpack-2.3.2] FAIL: test-fgemm-check
[fflas_ffpack-2.3.2] PASS: test-permutations
...
```

It look like it's a fflas-ffpack / openblas issue.


```
# file test-fgemm-check.log
Checking ..........................Modular<double> mod 1693 ... PASSED with seed = 1541770760090127
Checking .........................Modular<double> mod 12421 ... PASSED with seed = 1541770760090128
Checking ...........................Modular<double> mod 139 ... PASSED with seed = 1541770760090129
Checking ..................ModularBalanced<double> mod 1693 ... PASSED with seed = 1541770760090127
Checking .................ModularBalanced<double> mod 12421 ... PASSED with seed = 1541770760090128
Checking ...................ModularBalanced<double> mod 139 ... PASSED with seed = 1541770760090129
Checking ...........................Modular<float> mod 1693 ... PASSED with seed = 1541770760090127
Checking .............................Modular<float> mod 47 ... FAILED
FAILED with seed = 1541770760090128
FAIL test-fgemm-check (exit status: 1)
```



---

archive/issue_comments_365026.json:
```json
{
    "body": "<a id='comment:6'></a>It'd be great if you can help upstream find the cause of it in https://github.com/linbox-team/fflas-ffpack/issues/173 :)\n\n`@`jbaum98 had more test failures there, but this is one of them and he isn't responding. Maybe they have a common cause.",
    "created_at": "2018-11-09T19:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365026",
    "user": "https://github.com/timokau"
}
```

<a id='comment:6'></a>It'd be great if you can help upstream find the cause of it in https://github.com/linbox-team/fflas-ffpack/issues/173 :)

`@`jbaum98 had more test failures there, but this is one of them and he isn't responding. Maybe they have a common cause.



---

archive/issue_events_065165.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-05-03T07:36:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65165"
}
```



---

archive/issue_events_065166.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-05-03T07:36:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65166"
}
```



---

archive/issue_events_065167.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65167"
}
```



---

archive/issue_events_065168.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65168"
}
```



---

archive/issue_comments_365027.json:
```json
{
    "body": "<a id='comment:9'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365027",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_comments_365028.json:
```json
{
    "body": "<a id='comment:10'></a>Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365028",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>Ticket retargeted after milestone closed



---

archive/issue_events_065169.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65169"
}
```



---

archive/issue_events_065170.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65170"
}
```



---

archive/issue_comments_365029.json:
```json
{
    "body": "<a id='comment:12'></a>Tested at https://github.com/mkoeppe/sage/actions/runs/32812271 on top of 9.1.beta2",
    "created_at": "2020-01-30T03:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365029",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Tested at https://github.com/mkoeppe/sage/actions/runs/32812271 on top of 9.1.beta2



---

archive/issue_comments_365030.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-30T03:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365030",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_365031.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-31T23:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26130#issuecomment-365031",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065171.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-31T23:49:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26130",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26130#event-65171"
}
```
