# Issue 26026: Updates to Huffman codings

archive/issues_025789.json:
```json
{
    "body": "The main goal of these changes were to make this class work on Python 3, which previously it didn't due to comparisons failing while manipulating the heap queue data structures when building the tree.  The other problem was that the use of dict iterators meant that the codings weren't quite predictable; sometimes the codes for two characters could be swapped, leading to different test results (granted, not in a way that affects the length of the encodings).\n\nThis reimplements building the tree in a way that's deterministic and works the same on Python 2 and 3, and fixes a few other minor issues I noticed.\n\nCC:  @tscrim\n\nBranch/Commit: e913f5df63139d7e1000adf3dcf7aa51deddeb1f\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26026\n\n",
    "closed_at": "2018-11-19T18:01:14Z",
    "created_at": "2018-08-08T10:53:19Z",
    "labels": [
        "component: coding theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "Updates to Huffman codings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26026",
    "user": "https://github.com/embray"
}
```
The main goal of these changes were to make this class work on Python 3, which previously it didn't due to comparisons failing while manipulating the heap queue data structures when building the tree.  The other problem was that the use of dict iterators meant that the codings weren't quite predictable; sometimes the codes for two characters could be swapped, leading to different test results (granted, not in a way that affects the length of the encodings).

This reimplements building the tree in a way that's deterministic and works the same on Python 2 and 3, and fixes a few other minor issues I noticed.

CC:  @tscrim

Branch/Commit: e913f5df63139d7e1000adf3dcf7aa51deddeb1f

Reviewer: Frédéric Chapoton, Travis Scrimshaw

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26026





---

archive/issue_comments_500116.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-08T10:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500116",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_500117.json:
```json
{
    "body": "Changing commit from \"\" to \"d41dbe25f3480c7853556c012bde80c15741334a\"",
    "created_at": "2018-08-08T10:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500117",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "d41dbe25f3480c7853556c012bde80c15741334a"



---

archive/issue_comments_500118.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-08T10:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500118",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_500119.json:
```json
{
    "body": "<a id='comment:3'></a>The ticket #18315 also makes extensive changes to the Huffman coding algorithm.",
    "created_at": "2018-08-08T13:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500119",
    "user": "https://github.com/bryangingechen"
}
```

<a id='comment:3'></a>The ticket #18315 also makes extensive changes to the Huffman coding algorithm.



---

archive/issue_comments_500120.json:
```json
{
    "body": "<a id='comment:4'></a>Oops, I didn't see that one; it is quite old.  Are you trying to revive it?",
    "created_at": "2018-08-08T13:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500120",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>Oops, I didn't see that one; it is quite old.  Are you trying to revive it?



---

archive/issue_comments_500121.json:
```json
{
    "body": "<a id='comment:5'></a>Looking at the implementation in #18315, it would suffer from the same problems this is trying to fix, so I think this ticket is still relevant, albeit obviously not directly compatible with #18315.\n\nI haven't looked closely at the other coding algorithms added in that ticket but they might have some of the same kinds of problems too.  I have a few other nitpicks with that ticket but it looks good on the whole.",
    "created_at": "2018-08-08T13:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500121",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>Looking at the implementation in #18315, it would suffer from the same problems this is trying to fix, so I think this ticket is still relevant, albeit obviously not directly compatible with #18315.

I haven't looked closely at the other coding algorithms added in that ticket but they might have some of the same kinds of problems too.  I have a few other nitpicks with that ticket but it looks good on the whole.



---

archive/issue_comments_500122.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:4 embray]:\n> Oops, I didn't see that one; it is quite old.  Are you trying to revive it?\n\nI haven't looked at it in any real detail yet, and I'm also not knowledgeable on the subject. It did seem worthy of a little more attention though.",
    "created_at": "2018-08-08T13:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500122",
    "user": "https://github.com/bryangingechen"
}
```

<a id='comment:6'></a>Replying to [comment:4 embray]:
> Oops, I didn't see that one; it is quite old.  Are you trying to revive it?

I haven't looked at it in any real detail yet, and I'm also not knowledgeable on the subject. It did seem worthy of a little more attention though.



---

archive/issue_events_065018.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26026#event-65018"
}
```



---

archive/issue_comments_500123.json:
```json
{
    "body": "<a id='comment:8'></a>one trivial failing doctest",
    "created_at": "2018-11-06T14:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500123",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>one trivial failing doctest



---

archive/issue_comments_500124.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-11-06T14:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500124",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_500125.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-10T13:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500125",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_500126.json:
```json
{
    "body": "Changing commit from \"d41dbe25f3480c7853556c012bde80c15741334a\" to \"e913f5df63139d7e1000adf3dcf7aa51deddeb1f\"",
    "created_at": "2018-11-10T13:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500126",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "d41dbe25f3480c7853556c012bde80c15741334a" to "e913f5df63139d7e1000adf3dcf7aa51deddeb1f"



---

archive/issue_comments_500127.json:
```json
{
    "body": "<a id='comment:9'></a>I fixed the doctest\n\n---\nNew commits:",
    "created_at": "2018-11-10T13:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500127",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>I fixed the doctest

---
New commits:



---

archive/issue_comments_500128.json:
```json
{
    "body": "Changing branch from \"u/embray/python3/sage-coding-source_coding-huffman\" to \"public/ticket/26026\"",
    "created_at": "2018-11-10T13:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500128",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "u/embray/python3/sage-coding-source_coding-huffman" to "public/ticket/26026"



---

archive/issue_comments_500129.json:
```json
{
    "body": "<a id='comment:10'></a>green bot, please review",
    "created_at": "2018-11-11T15:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500129",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>green bot, please review



---

archive/issue_comments_500130.json:
```json
{
    "body": "<a id='comment:11'></a>please review (this is about a file with many failing doctest in python 3)",
    "created_at": "2018-11-16T17:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500130",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>please review (this is about a file with many failing doctest in python 3)



---

archive/issue_comments_500131.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw\"",
    "created_at": "2018-11-17T16:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500131",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Frédéric Chapoton, Travis Scrimshaw"



---

archive/issue_comments_500132.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-17T16:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500132",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_500133.json:
```json
{
    "body": "<a id='comment:12'></a>LGTM.",
    "created_at": "2018-11-17T16:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500133",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>LGTM.



---

archive/issue_comments_500134.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-11-19T18:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500134",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065019.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-19T18:01:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26026#event-65019"
}
```



---

archive/issue_comments_500135.json:
```json
{
    "body": "Changing branch from \"public/ticket/26026\" to \"e913f5df63139d7e1000adf3dcf7aa51deddeb1f\"",
    "created_at": "2018-11-19T18:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26026#issuecomment-500135",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/ticket/26026" to "e913f5df63139d7e1000adf3dcf7aa51deddeb1f"
