# Issue 26628: py3: some fixes for sandpiles tutorial

archive/issues_026391.json:
```json
{
    "assignees": [],
    "body": "namely simple changes of notation for the sink vertex\n\nThis decreases strongly the number of failing doctests under py3 in this file.\n\n**CC:**  @tscrim @vinklein\n\n**Branch/Commit:** [8ee90c7e421565e6ecd98fd2b79f2589b01f7e41](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)\n\n**Reviewer:** Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton, Erik Bray\n\nIssue created by migration from https://trac.sagemath.org/ticket/26628\n\n",
    "closed_at": "2019-01-24T18:17:58Z",
    "created_at": "2018-11-03T18:11:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: some fixes for sandpiles tutorial",
    "type": "issue",
    "updated_at": "2019-01-24T18:17:58Z",
    "url": "https://github.com/sagemath/sage/issues/26628",
    "user": "https://github.com/fchapoton"
}
```
namely simple changes of notation for the sink vertex

This decreases strongly the number of failing doctests under py3 in this file.

**CC:**  @tscrim @vinklein

**Branch/Commit:** [8ee90c7e421565e6ecd98fd2b79f2589b01f7e41](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)

**Reviewer:** Travis Scrimshaw, Frédéric Chapoton

**Author:** Frédéric Chapoton, Erik Bray

Issue created by migration from https://trac.sagemath.org/ticket/26628





---

archive/issue_events_319954.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319954"
}
```



---

archive/issue_events_319955.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "08517b",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319955"
}
```



---

archive/issue_events_319956.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319956"
}
```



---

archive/issue_events_319957.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:12:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319957"
}
```



---

archive/issue_comments_413050.json:
```json
{
    "body": "**Branch:** [u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)",
    "created_at": "2018-11-03T18:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413050",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)



---

archive/issue_comments_413051.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e262d0afd2601730b0c206ef012922e177f2ab9\">5e262d0</a></td><td><code>py3: fix doctests in c3_controlled</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd\">c6ce4b6</a></td><td><code>py3: some fixes for sandpiles</code></td></tr></table>\n",
    "created_at": "2018-11-03T18:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413051",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'>**Comment 1:**</a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e262d0afd2601730b0c206ef012922e177f2ab9">5e262d0</a></td><td><code>py3: fix doctests in c3_controlled</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd">c6ce4b6</a></td><td><code>py3: some fixes for sandpiles</code></td></tr></table>




---

archive/issue_comments_413052.json:
```json
{
    "body": "**Commit:** [c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)",
    "created_at": "2018-11-03T18:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413052",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)



---

archive/issue_comments_413053.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171\">7d3ecc7</a></td><td><code>py3: some fix for sandpiles</code></td></tr></table>\n",
    "created_at": "2018-11-03T18:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413053",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>**Comment 2:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171">7d3ecc7</a></td><td><code>py3: some fix for sandpiles</code></td></tr></table>




---

archive/issue_comments_413054.json:
```json
{
    "body": "**Changing commit** from \"[c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)\" to \"[7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)\".",
    "created_at": "2018-11-03T18:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413054",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)" to "[7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)".



---

archive/issue_comments_413055.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d\">ba6fff3</a></td><td><code>trac 26628 fixing doctests</code></td></tr></table>\n",
    "created_at": "2018-11-04T09:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413055",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>**Comment 3:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d">ba6fff3</a></td><td><code>trac 26628 fixing doctests</code></td></tr></table>




---

archive/issue_comments_413056.json:
```json
{
    "body": "**Changing commit** from \"[7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)\" to \"[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)\".",
    "created_at": "2018-11-04T09:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413056",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)" to "[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)".



---

archive/issue_comments_413057.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nbot is morally green, please review",
    "created_at": "2018-11-04T13:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413057",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'>**Comment 4:**</a>
bot is morally green, please review



---

archive/issue_comments_413058.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2018-11-04T14:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413058",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_413059.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nLGTM.",
    "created_at": "2018-11-04T14:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413059",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'>**Comment 5:**</a>
LGTM.



---

archive/issue_events_319958.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-04T14:32:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319958"
}
```



---

archive/issue_events_319959.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-04T14:32:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319959"
}
```



---

archive/issue_comments_413060.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)\" to \"[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)\".",
    "created_at": "2018-11-07T11:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413060",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)" to "[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)".



---

archive/issue_events_319960.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-07T11:27:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319960"
}
```



---

archive/issue_events_319961.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-07T11:27:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319961"
}
```



---

archive/issue_comments_413061.json:
```json
{
    "body": "**Changing commit** from \"[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)\" to \"\".",
    "created_at": "2018-11-11T10:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413061",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)" to "".



---

archive/issue_comments_413062.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nI'm randomly getting this\n\n```\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/sandpile.rst\", line 4678, in doc.en.thematic_tutorials.sandpile\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of 706 in doc.en.thematic_tutorials.sandpile\n    [705 tests, 1 failure, 93.88 s]\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 4769, in sage.sandpiles.sandpile.SandpileDivisor.values\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values\n    [941 tests, 1 failure, 54.14 s]\n```",
    "created_at": "2018-11-11T10:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413062",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'>**Comment 7:**</a>
I'm randomly getting this

```
**********************************************************************
File "src/doc/en/thematic_tutorials/sandpile.rst", line 4678, in doc.en.thematic_tutorials.sandpile
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of 706 in doc.en.thematic_tutorials.sandpile
    [705 tests, 1 failure, 93.88 s]
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 4769, in sage.sandpiles.sandpile.SandpileDivisor.values
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values
    [941 tests, 1 failure, 54.14 s]
```



---

archive/issue_comments_413063.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nAlso, for consistency I'd recommend using src.sage.repl.display.pretty_print.SagePrettyPrinter if you want to manually stringify an object",
    "created_at": "2018-11-11T10:18:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413063",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'>**Comment 8:**</a>
Also, for consistency I'd recommend using src.sage.repl.display.pretty_print.SagePrettyPrinter if you want to manually stringify an object



---

archive/issue_events_319962.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-12T08:54:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319962"
}
```



---

archive/issue_events_319963.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-12T08:54:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319963"
}
```



---

archive/issue_events_319964.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-12T08:54:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319964"
}
```



---

archive/issue_comments_413064.json:
```json
{
    "body": "**Changing branch** from \"[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)\" to \"[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)\".",
    "created_at": "2018-12-03T13:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413064",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)" to "[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)".



---

archive/issue_comments_413065.json:
```json
{
    "body": "**Commit:** [ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)",
    "created_at": "2018-12-03T13:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413065",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)



---

archive/issue_comments_413066.json:
```json
{
    "body": "**Changing commit** from \"[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)\" to \"[bfcaa32e04991f193af3f3d9a50a328646391ad6](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)\".",
    "created_at": "2018-12-03T13:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413066",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ba6fff38a08e5dc30071a4777fd68bba412b2c0d](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)" to "[bfcaa32e04991f193af3f3d9a50a328646391ad6](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)".



---

archive/issue_comments_413067.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e0dddb215587264d18124efaf7668a98d929667\">0e0dddb</a></td><td><code>Merge branch 'u/chapoton/26628' in 8.5.b6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6\">bfcaa32</a></td><td><code>trac 26628 repr of sandpiles</code></td></tr></table>\n",
    "created_at": "2018-12-03T13:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413067",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:12'>**Comment 12:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e0dddb215587264d18124efaf7668a98d929667">0e0dddb</a></td><td><code>Merge branch 'u/chapoton/26628' in 8.5.b6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6">bfcaa32</a></td><td><code>trac 26628 repr of sandpiles</code></td></tr></table>




---

archive/issue_events_319965.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-03T13:23:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319965"
}
```



---

archive/issue_events_319966.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-03T13:23:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319966"
}
```



---

archive/issue_comments_413068.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nIs this what you suggested, Volker ?",
    "created_at": "2018-12-03T13:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413068",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'>**Comment 13:**</a>
Is this what you suggested, Volker ?



---

archive/issue_comments_413069.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\n@vbraun:\n\nor should I rather use `from sage.repl.rich_output.pretty_print import pretty_print` ?",
    "created_at": "2018-12-07T09:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413069",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'>**Comment 14:**</a>
@vbraun:

or should I rather use `from sage.repl.rich_output.pretty_print import pretty_print` ?



---

archive/issue_events_319967.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-14T10:28:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319967"
}
```



---

archive/issue_events_319968.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-14T10:28:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319968"
}
```



---

archive/issue_comments_413070.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nok, the alternative with pretty_print does not make sense. Back to needs_review..",
    "created_at": "2018-12-29T14:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413070",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'>**Comment 16:**</a>
ok, the alternative with pretty_print does not make sense. Back to needs_review..



---

archive/issue_events_319969.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319969"
}
```



---

archive/issue_events_319970.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319970"
}
```



---

archive/issue_events_319971.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319971"
}
```



---

archive/issue_events_319972.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319972"
}
```



---

archive/issue_events_319973.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-12-29T16:54:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319973"
}
```



---

archive/issue_events_319974.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-12-29T16:54:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319974"
}
```



---

archive/issue_comments_413071.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nI'm still getting this on the OSX buildbot:\n\n```\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/sandpile.rst\", line 4678, in doc.en.thematic_tutorials.sandpile\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of 706 in doc.en.thematic_tutorials.sandpile\n    [705 tests, 1 failure, 86.65 s]\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 4771, in sage.sandpiles.sandpile.SandpileDivisor.values\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values\n    [941 tests, 1 failure, 43.18 s]\n----------------------------------------------------------------------\nsage -t --long src/doc/en/thematic_tutorials/sandpile.rst  # 1 doctest failed\nsage -t --long src/sage/sandpiles/sandpile.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2018-12-30T13:31:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413071",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'>**Comment 18:**</a>
I'm still getting this on the OSX buildbot:

```
**********************************************************************
File "src/doc/en/thematic_tutorials/sandpile.rst", line 4678, in doc.en.thematic_tutorials.sandpile
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of 706 in doc.en.thematic_tutorials.sandpile
    [705 tests, 1 failure, 86.65 s]
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 4771, in sage.sandpiles.sandpile.SandpileDivisor.values
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values
    [941 tests, 1 failure, 43.18 s]
----------------------------------------------------------------------
sage -t --long src/doc/en/thematic_tutorials/sandpile.rst  # 1 doctest failed
sage -t --long src/sage/sandpiles/sandpile.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_319975.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-30T13:31:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319975"
}
```



---

archive/issue_events_319976.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-30T13:31:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319976"
}
```



---

archive/issue_comments_413072.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)\" to \"[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)\".",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413072",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)" to "[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)".



---

archive/issue_comments_413073.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\n**NOTE**: I am going to recycle this ticket right now.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d976d7d612adfce8a881458bddcc13c5dd5ef9bb\">d976d7d</a></td><td><code>some care for sandpile tutorial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409\">6be2430</a></td><td><code>fix doctests</code></td></tr></table>\n",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413073",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'>**Comment 19:**</a>
**NOTE**: I am going to recycle this ticket right now.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d976d7d612adfce8a881458bddcc13c5dd5ef9bb">d976d7d</a></td><td><code>some care for sandpile tutorial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409">6be2430</a></td><td><code>fix doctests</code></td></tr></table>




---

archive/issue_comments_413074.json:
```json
{
    "body": "**Changing commit** from \"[bfcaa32e04991f193af3f3d9a50a328646391ad6](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)\" to \"[6be243066df8a07b2542b40120ea38adad748409](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)\".",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413074",
    "user": "https://github.com/fchapoton"
}
```

**Changing commit** from "[bfcaa32e04991f193af3f3d9a50a328646391ad6](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)" to "[6be243066df8a07b2542b40120ea38adad748409](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)".



---

archive/issue_events_319977.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-31T18:17:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319977"
}
```



---

archive/issue_events_319978.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-31T18:17:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319978"
}
```



---

archive/issue_comments_413075.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-the rest will have to wait for more fixes in generic graph\n+namely simple changes of notation for the sink vertex\n+\n+This decreases strongly the number of failing doctests under py3 in this file.\n``````\n",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413075",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-the rest will have to wait for more fixes in generic graph
+namely simple changes of notation for the sink vertex
+
+This decreases strongly the number of failing doctests under py3 in this file.
``````




---

archive/issue_events_319979.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-31T18:17:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "rename": {
        "from": "py3: some partial fix for sandpiles",
        "to": "py3: some fixes for sandpiles tutorial"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319979"
}
```



---

archive/issue_comments_413076.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\ngreen bot, please review (ticket has been recycled to do something related)",
    "created_at": "2018-12-31T20:25:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413076",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'>**Comment 20:**</a>
green bot, please review (ticket has been recycled to do something related)



---

archive/issue_events_319980.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-04T20:13:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319980"
}
```



---

archive/issue_events_319981.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-04T20:13:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319981"
}
```



---

archive/issue_events_319982.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T15:09:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319982"
}
```



---

archive/issue_events_319983.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T15:09:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319983"
}
```



---

archive/issue_comments_413077.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nSomething about this still smells off.  For example:\n\n```diff\n@@ -3595,14 +3595,14 @@ boolean\n \n EXAMPLES::\n \n-    sage: S = Sandpile({'a':[1,'b'], 'b':[1,'a'], 1:['a']},'a')\n-    sage: c = SandpileConfig(S, {'b':1, 1:2})\n+    sage: S = Sandpile({'a':['c','b'], 'b':['c','a'], 'c':['a']},'a')\n+    sage: c = SandpileConfig(S, {'b':1, 'c':2})\n     sage: c\n-    {1: 2, 'b': 1}\n+    {'c': 2, 'b': 1}\n```\n\nI'm not sure that last change is always going to be correct.  If `c` were a dict it would be pretty-printed with its keys sorted.  I haven't looked at `SandpileConfig` but it should probably do the same.",
    "created_at": "2019-01-10T15:09:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413077",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'>**Comment 22:**</a>
Something about this still smells off.  For example:

```diff
@@ -3595,14 +3595,14 @@ boolean
 
 EXAMPLES::
 
-    sage: S = Sandpile({'a':[1,'b'], 'b':[1,'a'], 1:['a']},'a')
-    sage: c = SandpileConfig(S, {'b':1, 1:2})
+    sage: S = Sandpile({'a':['c','b'], 'b':['c','a'], 'c':['a']},'a')
+    sage: c = SandpileConfig(S, {'b':1, 'c':2})
     sage: c
-    {1: 2, 'b': 1}
+    {'c': 2, 'b': 1}
```

I'm not sure that last change is always going to be correct.  If `c` were a dict it would be pretty-printed with its keys sorted.  I haven't looked at `SandpileConfig` but it should probably do the same.



---

archive/issue_comments_413078.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nAnd does this relate in any way to #26722?",
    "created_at": "2019-01-10T15:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413078",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'>**Comment 23:**</a>
And does this relate in any way to #26722?



---

archive/issue_comments_413079.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nThis is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.\n\nCan I set back to positive ?",
    "created_at": "2019-01-10T16:02:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413079",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'>**Comment 24:**</a>
This is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.

Can I set back to positive ?



---

archive/issue_comments_413080.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nReplying to [@fchapoton](#comment%3A24):\n> This is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.\n> \n> Can I set back to positive ?\n\nUnfortunately not: The problem is that since this is being repr'd like a dict, the output order is completely arbitrary, and this ticket is just changing it to a different arbitrary order that is not guaranteed to be the same between Python versions or even platforms.\n\nIf you give me a sec, I think I have a solution...",
    "created_at": "2019-01-10T16:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413080",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'>**Comment 25:**</a>
Replying to [@fchapoton](#comment%3A24):
> This is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.
> 
> Can I set back to positive ?

Unfortunately not: The problem is that since this is being repr'd like a dict, the output order is completely arbitrary, and this ticket is just changing it to a different arbitrary order that is not guaranteed to be the same between Python versions or even platforms.

If you give me a sec, I think I have a solution...



---

archive/issue_comments_413081.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e\">db899d8</a></td><td><code>fix pretty printing of SandpileConfig and SandpileDivisor</code></td></tr></table>\n",
    "created_at": "2019-01-10T16:42:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413081",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>**Comment 26:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e">db899d8</a></td><td><code>fix pretty printing of SandpileConfig and SandpileDivisor</code></td></tr></table>




---

archive/issue_comments_413082.json:
```json
{
    "body": "**Changing commit** from \"[6be243066df8a07b2542b40120ea38adad748409](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)\" to \"[db899d8f6434055900457db3bb9367537f57ae7e](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)\".",
    "created_at": "2019-01-10T16:42:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413082",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[6be243066df8a07b2542b40120ea38adad748409](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)" to "[db899d8f6434055900457db3bb9367537f57ae7e](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)".



---

archive/issue_events_319984.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T16:42:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319984"
}
```



---

archive/issue_events_319985.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T16:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319985"
}
```



---

archive/issue_comments_413083.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nthis will probably trigger the import of IPython at startup, no ?",
    "created_at": "2019-01-10T16:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413083",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:28'>**Comment 28:**</a>
this will probably trigger the import of IPython at startup, no ?



---

archive/issue_comments_413084.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nI'm not sure what you mean.",
    "created_at": "2019-01-10T16:46:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413084",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'>**Comment 29:**</a>
I'm not sure what you mean.



---

archive/issue_comments_413085.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nI mean that the line\n\n```\nfrom IPython.lib import pretty\n```\nmaybe will have a negative impact on sage startup time (if it imports all of IPython)\n\nI am asking because I tried to import sage pretty-printer in some ticket, and then the startup time got 10% longer (import of Ipython..)",
    "created_at": "2019-01-10T16:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413085",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'>**Comment 30:**</a>
I mean that the line

```
from IPython.lib import pretty
```
maybe will have a negative impact on sage startup time (if it imports all of IPython)

I am asking because I tried to import sage pretty-printer in some ticket, and then the startup time got 10% longer (import of Ipython..)



---

archive/issue_comments_413086.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nThat's odd that you found that to be the case, because the Sage REPL *is* IPython:\n\n```\n$ ./sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.6.rc0, Release Date: 2019-01-03                 \u2502\n\u2502 Using Python 2.7.15. Type \"help()\" for help.                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: import sys\nsage: sys.modules['IPython.lib.pretty']\n<module 'IPython.lib.pretty' from '/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/IPython/lib/pretty.pyc'>\nsage: sys.modules['sage.sandpiles.sandpile']\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n<ipython-input-4-8624d4f52316> in <module>()\n----> 1 sys.modules['sage.sandpiles.sandpile']\n\nKeyError: 'sage.sandpiles.sandpile'\n```",
    "created_at": "2019-01-10T16:52:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413086",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'>**Comment 31:**</a>
That's odd that you found that to be the case, because the Sage REPL *is* IPython:

```
$ ./sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.6.rc0, Release Date: 2019-01-03                 │
│ Using Python 2.7.15. Type "help()" for help.                       │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: import sys
sage: sys.modules['IPython.lib.pretty']
<module 'IPython.lib.pretty' from '/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/IPython/lib/pretty.pyc'>
sage: sys.modules['sage.sandpiles.sandpile']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-4-8624d4f52316> in <module>()
----> 1 sys.modules['sage.sandpiles.sandpile']

KeyError: 'sage.sandpiles.sandpile'
```



---

archive/issue_comments_413087.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nYes, strange indeed, but see bottom report here:\n\nhttps://patchbot.sagemath.org/ticket/26967/\n\nand in particular the startup plugins..\n\nEDIT: Apparently triggered by\n\n```\n+from sage.repl.rich_output.backend_base import BackendBase\n+from sage.repl.display.pretty_print import SagePrettyPrinter\n```",
    "created_at": "2019-01-10T16:57:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413087",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'>**Comment 32:**</a>
Yes, strange indeed, but see bottom report here:

https://patchbot.sagemath.org/ticket/26967/

and in particular the startup plugins..

EDIT: Apparently triggered by

```
+from sage.repl.rich_output.backend_base import BackendBase
+from sage.repl.display.pretty_print import SagePrettyPrinter
```



---

archive/issue_comments_413088.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nWell, `sage -c` is different because it doesn't load the REPL, but it does `import sage.all`.  However, I still *usually* get:\n\n```\n$ ./sage -c 'import sys; print(\"IPython\" in sys.modules)'\nFalse\n```\n\nThis might be in part because `sage.sandpiles` is lazy-imported.\n\nFor some odd reason though, immediately after a `./sage -b` I get:\n\n```\n$ ./sage -c 'import sys; print(\"IPython\" in sys.modules)'\nTrue\n```\n\nBut then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.",
    "created_at": "2019-01-10T17:13:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413088",
    "user": "https://github.com/embray"
}
```

<a id='comment:33'>**Comment 33:**</a>
Well, `sage -c` is different because it doesn't load the REPL, but it does `import sage.all`.  However, I still *usually* get:

```
$ ./sage -c 'import sys; print("IPython" in sys.modules)'
False
```

This might be in part because `sage.sandpiles` is lazy-imported.

For some odd reason though, immediately after a `./sage -b` I get:

```
$ ./sage -c 'import sys; print("IPython" in sys.modules)'
True
```

But then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.



---

archive/issue_comments_413089.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nAs my note says, it would be good to rework `sage.repl.display.pretty_print` so that this kind of thing can be avoided in the first place since it's pretty ugly anyways.",
    "created_at": "2019-01-10T17:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413089",
    "user": "https://github.com/embray"
}
```

<a id='comment:34'>**Comment 34:**</a>
As my note says, it would be good to rework `sage.repl.display.pretty_print` so that this kind of thing can be avoided in the first place since it's pretty ugly anyways.



---

archive/issue_comments_413090.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nReplying to [@embray](#comment%3A33):\n> But then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.\n\nI see: That's in order to rebuild the star imports cache.",
    "created_at": "2019-01-10T17:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413090",
    "user": "https://github.com/embray"
}
```

<a id='comment:35'>**Comment 35:**</a>
Replying to [@embray](#comment%3A33):
> But then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.

I see: That's in order to rebuild the star imports cache.



---

archive/issue_comments_413091.json:
```json
{
    "body": "**Changing author** from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Erik Bray\".",
    "created_at": "2019-01-11T07:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413091",
    "user": "https://github.com/fchapoton"
}
```

**Changing author** from "Frédéric Chapoton" to "Frédéric Chapoton, Erik Bray".



---

archive/issue_comments_413092.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nok, then.",
    "created_at": "2019-01-11T07:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413092",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'>**Comment 36:**</a>
ok, then.



---

archive/issue_comments_413093.json:
```json
{
    "body": "**Changing reviewer** from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton\".",
    "created_at": "2019-01-11T07:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413093",
    "user": "https://github.com/fchapoton"
}
```

**Changing reviewer** from "Travis Scrimshaw" to "Travis Scrimshaw, Frédéric Chapoton".



---

archive/issue_events_319986.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-11T07:44:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319986"
}
```



---

archive/issue_events_319987.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-11T07:44:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319987"
}
```



---

archive/issue_comments_413094.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nThanks.  It's still a good point you raise though: Merely importing those modules shouldn't cause `IPython` to be imported if it can be avoided (e.g. it's pointless to do so if we're not in IPython).\n\nI'll open a ticket for that.",
    "created_at": "2019-01-11T11:47:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413094",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'>**Comment 37:**</a>
Thanks.  It's still a good point you raise though: Merely importing those modules shouldn't cause `IPython` to be imported if it can be avoided (e.g. it's pointless to do so if we're not in IPython).

I'll open a ticket for that.



---

archive/issue_comments_413095.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nOn OSX:\n\n```\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 3486, in sage.sandpiles.sandpile.SandpileConfig.values\nFailed example:\n    c\nExpected:\n    {1: 2, 'b': 1}\nGot:\n    {'b': 1, 1: 2}\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 4765, in sage.sandpiles.sandpile.SandpileDivisor.values\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n```",
    "created_at": "2019-01-20T19:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413095",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:38'>**Comment 38:**</a>
On OSX:

```
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 3486, in sage.sandpiles.sandpile.SandpileConfig.values
Failed example:
    c
Expected:
    {1: 2, 'b': 1}
Got:
    {'b': 1, 1: 2}
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 4765, in sage.sandpiles.sandpile.SandpileDivisor.values
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
```



---

archive/issue_events_319988.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-20T19:34:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319988"
}
```



---

archive/issue_events_319989.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-20T19:34:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319989"
}
```



---

archive/issue_comments_413096.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\nDamnation...",
    "created_at": "2019-01-20T20:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413096",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'>**Comment 39:**</a>
Damnation...



---

archive/issue_comments_413097.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a58cbbbf6874773e7866cfac86cc822a3c82ed09\">a58cbbb</a></td><td><code>Merge branch 'public/ticket/26628' in 8.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41\">8ee90c7</a></td><td><code>sandpiles : fixing some doctests</code></td></tr></table>\n",
    "created_at": "2019-01-21T09:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413097",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'>**Comment 40:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a58cbbbf6874773e7866cfac86cc822a3c82ed09">a58cbbb</a></td><td><code>Merge branch 'public/ticket/26628' in 8.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41">8ee90c7</a></td><td><code>sandpiles : fixing some doctests</code></td></tr></table>




---

archive/issue_comments_413098.json:
```json
{
    "body": "**Changing commit** from \"[db899d8f6434055900457db3bb9367537f57ae7e](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)\" to \"[8ee90c7e421565e6ecd98fd2b79f2589b01f7e41](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)\".",
    "created_at": "2019-01-21T09:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413098",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[db899d8f6434055900457db3bb9367537f57ae7e](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)" to "[8ee90c7e421565e6ecd98fd2b79f2589b01f7e41](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)".



---

archive/issue_comments_413099.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nok, this should fix it.",
    "created_at": "2019-01-21T09:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413099",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:41'>**Comment 41:**</a>
ok, this should fix it.



---

archive/issue_events_319990.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-21T09:53:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319990"
}
```



---

archive/issue_events_319991.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-21T09:53:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319991"
}
```



---

archive/issue_comments_413100.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\ngreen bot. I have no way to test on OSX.",
    "created_at": "2019-01-21T12:20:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413100",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:42'>**Comment 42:**</a>
green bot. I have no way to test on OSX.



---

archive/issue_comments_413101.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\nVincent, would you please check the OsX behaviour ?",
    "created_at": "2019-01-22T07:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413101",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:43'>**Comment 43:**</a>
Vincent, would you please check the OsX behaviour ?



---

archive/issue_comments_413102.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\nYes ! The two OSX errors from [[comment:38](#comment%3A38)](https://github.com/sagemath/sage/issues/26628#comment:38) are fixed.",
    "created_at": "2019-01-22T10:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413102",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:44'>**Comment 44:**</a>
Yes ! The two OSX errors from [[comment:38](#comment%3A38)](https://github.com/sagemath/sage/issues/26628#comment:38) are fixed.



---

archive/issue_comments_413103.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nMerci beaucoup, Vincent. Je repasse en positif.",
    "created_at": "2019-01-22T10:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413103",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:45'>**Comment 45:**</a>
Merci beaucoup, Vincent. Je repasse en positif.



---

archive/issue_events_319992.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-22T10:18:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319992"
}
```



---

archive/issue_events_319993.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-22T10:18:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319993"
}
```



---

archive/issue_comments_413104.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\nWeird. I'd have to take a closer look at how IPython's pretty-print module orders heterogeneous types when printing dictionaries.  If it's doing something id-based then it's not going to reliable (at least not the default implementation ...)",
    "created_at": "2019-01-23T12:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413104",
    "user": "https://github.com/embray"
}
```

<a id='comment:46'>**Comment 46:**</a>
Weird. I'd have to take a closer look at how IPython's pretty-print module orders heterogeneous types when printing dictionaries.  If it's doing something id-based then it's not going to reliable (at least not the default implementation ...)



---

archive/issue_comments_413105.json:
```json
{
    "body": "<a id='comment:47'>**Comment 47:**</a>\nUgh, so it's using this:\n\n```\ndef _sorted_for_pprint(items):\n    \"\"\"\n    Sort the given items for pretty printing. Since some predictable\n    sorting is better than no sorting at all, we sort on the string\n    representation if normal sorting fails.\n    \"\"\"\n    items = list(items)\n    try:\n        return sorted(items)\n    except Exception:\n        try:\n            return sorted(items, key=str)\n        except Exception:\n            return items\n```\n\nIronically this will give more-or-less deterministic results on Python 3 (<3.7, where it relies on built-in dict ordering), but non-deterministic results on Python 2 where `sorted(items)` will not raise an exception, and instead rely on Python 2's crappy fallback ordering which is not deterministic.\n\nThis might explain some other tests that expect dicts in their output, but where we've struggled to get consistent results across platforms.  I'll look into fixing this.",
    "created_at": "2019-01-23T12:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413105",
    "user": "https://github.com/embray"
}
```

<a id='comment:47'>**Comment 47:**</a>
Ugh, so it's using this:

```
def _sorted_for_pprint(items):
    """
    Sort the given items for pretty printing. Since some predictable
    sorting is better than no sorting at all, we sort on the string
    representation if normal sorting fails.
    """
    items = list(items)
    try:
        return sorted(items)
    except Exception:
        try:
            return sorted(items, key=str)
        except Exception:
            return items
```

Ironically this will give more-or-less deterministic results on Python 3 (<3.7, where it relies on built-in dict ordering), but non-deterministic results on Python 2 where `sorted(items)` will not raise an exception, and instead rely on Python 2's crappy fallback ordering which is not deterministic.

This might explain some other tests that expect dicts in their output, but where we've struggled to get consistent results across platforms.  I'll look into fixing this.



---

archive/issue_events_319994.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319994"
}
```



---

archive/issue_events_319995.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "baff75f69d842e683b8e9219e8ea5bb198905351",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-24T18:17:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-319995"
}
```



---

archive/issue_comments_413106.json:
```json
{
    "body": "**Changing branch** from \"[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)\" to \"[8ee90c7e421565e6ecd98fd2b79f2589b01f7e41](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)\".",
    "created_at": "2019-01-24T18:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-413106",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)" to "[8ee90c7e421565e6ecd98fd2b79f2589b01f7e41](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)".
