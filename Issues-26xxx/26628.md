# Issue 26628: py3: some fixes for sandpiles tutorial

archive/issues_026391.json:
```json
{
    "assignees": [],
    "body": "namely simple changes of notation for the sink vertex\n\nThis decreases strongly the number of failing doctests under py3 in this file.\n\nCC:  @tscrim @vinklein\n\nBranch/Commit: **[`8ee90c7`](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)**\n\nReviewer: **Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton, Erik Bray**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26628_\n\n",
    "closed_at": "2019-01-24T18:17:58Z",
    "created_at": "2018-11-03T18:11:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: some fixes for sandpiles tutorial",
    "type": "issue",
    "updated_at": "2019-01-24T18:17:58Z",
    "url": "https://github.com/sagemath/sage/issues/26628",
    "user": "https://github.com/fchapoton"
}
```
namely simple changes of notation for the sink vertex

This decreases strongly the number of failing doctests under py3 in this file.

CC:  @tscrim @vinklein

Branch/Commit: **[`8ee90c7`](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)**

Reviewer: **Travis Scrimshaw, Frédéric Chapoton**

Author: **Frédéric Chapoton, Erik Bray**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/26628_





---

archive/issue_events_363414.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363414"
}
```



---

archive/issue_events_363415.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363415"
}
```



---

archive/issue_events_363416.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363416"
}
```



---

archive/issue_events_363417.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363417"
}
```



---

archive/issue_events_363418.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-03T18:12:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363418"
}
```



---

archive/issue_comments_410345.json:
```json
{
    "body": "Branch: **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)**",
    "created_at": "2018-11-03T18:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410345",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)**



---

archive/issue_comments_410346.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e262d0afd2601730b0c206ef012922e177f2ab9\"><code>5e262d0</code></a></td><td><code>py3: fix doctests in c3_controlled</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd\"><code>c6ce4b6</code></a></td><td><code>py3: some fixes for sandpiles</code></td></tr></table>\n",
    "created_at": "2018-11-03T18:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410346",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e262d0afd2601730b0c206ef012922e177f2ab9"><code>5e262d0</code></a></td><td><code>py3: fix doctests in c3_controlled</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd"><code>c6ce4b6</code></a></td><td><code>py3: some fixes for sandpiles</code></td></tr></table>




---

archive/issue_comments_410347.json:
```json
{
    "body": "Commit: **[`c6ce4b6`](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)**",
    "created_at": "2018-11-03T18:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410347",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`c6ce4b6`](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)**



---

archive/issue_comments_410348.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171\"><code>7d3ecc7</code></a></td><td><code>py3: some fix for sandpiles</code></td></tr></table>\n",
    "created_at": "2018-11-03T18:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410348",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171"><code>7d3ecc7</code></a></td><td><code>py3: some fix for sandpiles</code></td></tr></table>




---

archive/issue_comments_410349.json:
```json
{
    "body": "Changed commit from **[`c6ce4b6`](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)** to **[`7d3ecc7`](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)**",
    "created_at": "2018-11-03T18:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410349",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c6ce4b6`](https://github.com/sagemath/sagetrac-mirror/commit/c6ce4b6a5748a8dcf483dbc6d24157132f5e0cfd)** to **[`7d3ecc7`](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)**



---

archive/issue_comments_410350.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d\"><code>ba6fff3</code></a></td><td><code>trac 26628 fixing doctests</code></td></tr></table>\n",
    "created_at": "2018-11-04T09:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410350",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d"><code>ba6fff3</code></a></td><td><code>trac 26628 fixing doctests</code></td></tr></table>




---

archive/issue_comments_410351.json:
```json
{
    "body": "Changed commit from **[`7d3ecc7`](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)** to **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)**",
    "created_at": "2018-11-04T09:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410351",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7d3ecc7`](https://github.com/sagemath/sagetrac-mirror/commit/7d3ecc74880f3c8970ab2eccc70c9cdaa4e10171)** to **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)**



---

archive/issue_comments_410352.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nbot is morally green, please review",
    "created_at": "2018-11-04T13:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410352",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

bot is morally green, please review



---

archive/issue_comments_410353.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2018-11-04T14:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410353",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_410354.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nLGTM.",
    "created_at": "2018-11-04T14:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410354",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

LGTM.



---

archive/issue_events_363419.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-04T14:32:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363419"
}
```



---

archive/issue_events_363420.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-04T14:32:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363420"
}
```



---

archive/issue_comments_410355.json:
```json
{
    "body": "Changed branch from **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)** to **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)**",
    "created_at": "2018-11-07T11:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410355",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)** to **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)**



---

archive/issue_events_363421.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-07T11:27:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363421"
}
```



---

archive/issue_events_363422.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-07T11:27:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363422"
}
```



---

archive/issue_events_363423.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-11T10:13:41Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363423"
}
```



---

archive/issue_comments_410356.json:
```json
{
    "body": "Changed commit from **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)** to none",
    "created_at": "2018-11-11T10:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410356",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)** to none



---

archive/issue_comments_410357.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI'm randomly getting this\n\n```\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/sandpile.rst\", line 4678, in doc.en.thematic_tutorials.sandpile\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of 706 in doc.en.thematic_tutorials.sandpile\n    [705 tests, 1 failure, 93.88 s]\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 4769, in sage.sandpiles.sandpile.SandpileDivisor.values\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values\n    [941 tests, 1 failure, 54.14 s]\n```",
    "created_at": "2018-11-11T10:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410357",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

I'm randomly getting this

```
**********************************************************************
File "src/doc/en/thematic_tutorials/sandpile.rst", line 4678, in doc.en.thematic_tutorials.sandpile
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of 706 in doc.en.thematic_tutorials.sandpile
    [705 tests, 1 failure, 93.88 s]
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 4769, in sage.sandpiles.sandpile.SandpileDivisor.values
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values
    [941 tests, 1 failure, 54.14 s]
```



---

archive/issue_comments_410358.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAlso, for consistency I'd recommend using src.sage.repl.display.pretty_print.SagePrettyPrinter if you want to manually stringify an object",
    "created_at": "2018-11-11T10:18:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410358",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

Also, for consistency I'd recommend using src.sage.repl.display.pretty_print.SagePrettyPrinter if you want to manually stringify an object



---

archive/issue_events_363424.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-12T08:54:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363424"
}
```



---

archive/issue_events_363425.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-12T08:54:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363425"
}
```



---

archive/issue_events_363426.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-12T08:54:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363426"
}
```



---

archive/issue_comments_410359.json:
```json
{
    "body": "Changed branch from **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)** to **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)**",
    "created_at": "2018-12-03T13:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410359",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)** to **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)**



---

archive/issue_comments_410360.json:
```json
{
    "body": "Commit: **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)**",
    "created_at": "2018-12-03T13:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410360",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)**



---

archive/issue_comments_410361.json:
```json
{
    "body": "Changed commit from **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)** to **[`bfcaa32`](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)**",
    "created_at": "2018-12-03T13:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410361",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ba6fff3`](https://github.com/sagemath/sagetrac-mirror/commit/ba6fff38a08e5dc30071a4777fd68bba412b2c0d)** to **[`bfcaa32`](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)**



---

archive/issue_comments_410362.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e0dddb215587264d18124efaf7668a98d929667\"><code>0e0dddb</code></a></td><td><code>Merge branch 'u/chapoton/26628' in 8.5.b6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6\"><code>bfcaa32</code></a></td><td><code>trac 26628 repr of sandpiles</code></td></tr></table>\n",
    "created_at": "2018-12-03T13:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410362",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e0dddb215587264d18124efaf7668a98d929667"><code>0e0dddb</code></a></td><td><code>Merge branch 'u/chapoton/26628' in 8.5.b6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6"><code>bfcaa32</code></a></td><td><code>trac 26628 repr of sandpiles</code></td></tr></table>




---

archive/issue_events_363427.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-03T13:23:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363427"
}
```



---

archive/issue_events_363428.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-03T13:23:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363428"
}
```



---

archive/issue_comments_410363.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIs this what you suggested, Volker ?",
    "created_at": "2018-12-03T13:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410363",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

Is this what you suggested, Volker ?



---

archive/issue_comments_410364.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n@vbraun:\n\nor should I rather use `from sage.repl.rich_output.pretty_print import pretty_print` ?",
    "created_at": "2018-12-07T09:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410364",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:14" align="right">comment:14</div>

@vbraun:

or should I rather use `from sage.repl.rich_output.pretty_print import pretty_print` ?



---

archive/issue_events_363429.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-14T10:28:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363429"
}
```



---

archive/issue_events_363430.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-14T10:28:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363430"
}
```



---

archive/issue_comments_410365.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nok, the alternative with pretty_print does not make sense. Back to needs_review..",
    "created_at": "2018-12-29T14:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410365",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

ok, the alternative with pretty_print does not make sense. Back to needs_review..



---

archive/issue_events_363431.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363431"
}
```



---

archive/issue_events_363432.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363432"
}
```



---

archive/issue_events_363433.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363433"
}
```



---

archive/issue_events_363434.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-29T14:24:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363434"
}
```



---

archive/issue_events_363435.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-12-29T16:54:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363435"
}
```



---

archive/issue_events_363436.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-12-29T16:54:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363436"
}
```



---

archive/issue_comments_410366.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI'm still getting this on the OSX buildbot:\n\n```\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/sandpile.rst\", line 4678, in doc.en.thematic_tutorials.sandpile\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of 706 in doc.en.thematic_tutorials.sandpile\n    [705 tests, 1 failure, 86.65 s]\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 4771, in sage.sandpiles.sandpile.SandpileDivisor.values\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values\n    [941 tests, 1 failure, 43.18 s]\n----------------------------------------------------------------------\nsage -t --long src/doc/en/thematic_tutorials/sandpile.rst  # 1 doctest failed\nsage -t --long src/sage/sandpiles/sandpile.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2018-12-30T13:31:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410366",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:18" align="right">comment:18</div>

I'm still getting this on the OSX buildbot:

```
**********************************************************************
File "src/doc/en/thematic_tutorials/sandpile.rst", line 4678, in doc.en.thematic_tutorials.sandpile
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of 706 in doc.en.thematic_tutorials.sandpile
    [705 tests, 1 failure, 86.65 s]
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 4771, in sage.sandpiles.sandpile.SandpileDivisor.values
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
1 item had failures:
   1 of   6 in sage.sandpiles.sandpile.SandpileDivisor.values
    [941 tests, 1 failure, 43.18 s]
----------------------------------------------------------------------
sage -t --long src/doc/en/thematic_tutorials/sandpile.rst  # 1 doctest failed
sage -t --long src/sage/sandpiles/sandpile.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_363437.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-30T13:31:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363437"
}
```



---

archive/issue_events_363438.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-30T13:31:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363438"
}
```



---

archive/issue_comments_410367.json:
```json
{
    "body": "Changed branch from **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)** to **[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)**",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410367",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/chapoton/26628](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26628)** to **[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)**



---

archive/issue_comments_410368.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n**NOTE**: I am going to recycle this ticket right now.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d976d7d612adfce8a881458bddcc13c5dd5ef9bb\"><code>d976d7d</code></a></td><td><code>some care for sandpile tutorial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409\"><code>6be2430</code></a></td><td><code>fix doctests</code></td></tr></table>\n",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410368",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:19" align="right">comment:19</div>

**NOTE**: I am going to recycle this ticket right now.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d976d7d612adfce8a881458bddcc13c5dd5ef9bb"><code>d976d7d</code></a></td><td><code>some care for sandpile tutorial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409"><code>6be2430</code></a></td><td><code>fix doctests</code></td></tr></table>




---

archive/issue_comments_410369.json:
```json
{
    "body": "Changed commit from **[`bfcaa32`](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)** to **[`6be2430`](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)**",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410369",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`bfcaa32`](https://github.com/sagemath/sagetrac-mirror/commit/bfcaa32e04991f193af3f3d9a50a328646391ad6)** to **[`6be2430`](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)**



---

archive/issue_events_363439.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-31T18:17:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363439"
}
```



---

archive/issue_events_363440.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-31T18:17:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363440"
}
```



---

archive/issue_comments_410370.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-the rest will have to wait for more fixes in generic graph\n+namely simple changes of notation for the sink vertex\n+\n+This decreases strongly the number of failing doctests under py3 in this file.\n``````\n",
    "created_at": "2018-12-31T18:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410370",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-the rest will have to wait for more fixes in generic graph
+namely simple changes of notation for the sink vertex
+
+This decreases strongly the number of failing doctests under py3 in this file.
``````




---

archive/issue_events_363441.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-31T18:17:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "title_is": "py3: some fixes for sandpiles tutorial",
    "title_was": "py3: some partial fix for sandpiles",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363441"
}
```



---

archive/issue_comments_410371.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\ngreen bot, please review (ticket has been recycled to do something related)",
    "created_at": "2018-12-31T20:25:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410371",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

green bot, please review (ticket has been recycled to do something related)



---

archive/issue_events_363442.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-04T20:13:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363442"
}
```



---

archive/issue_events_363443.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-04T20:13:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363443"
}
```



---

archive/issue_events_363444.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T15:09:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363444"
}
```



---

archive/issue_events_363445.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T15:09:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363445"
}
```



---

archive/issue_comments_410372.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSomething about this still smells off.  For example:\n\n```diff\n@@ -3595,14 +3595,14 @@ boolean\n \n EXAMPLES::\n \n-    sage: S = Sandpile({'a':[1,'b'], 'b':[1,'a'], 1:['a']},'a')\n-    sage: c = SandpileConfig(S, {'b':1, 1:2})\n+    sage: S = Sandpile({'a':['c','b'], 'b':['c','a'], 'c':['a']},'a')\n+    sage: c = SandpileConfig(S, {'b':1, 'c':2})\n     sage: c\n-    {1: 2, 'b': 1}\n+    {'c': 2, 'b': 1}\n```\n\nI'm not sure that last change is always going to be correct.  If `c` were a dict it would be pretty-printed with its keys sorted.  I haven't looked at `SandpileConfig` but it should probably do the same.",
    "created_at": "2019-01-10T15:09:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410372",
    "user": "https://github.com/embray"
}
```

<div id="comment:22" align="right">comment:22</div>

Something about this still smells off.  For example:

```diff
@@ -3595,14 +3595,14 @@ boolean
 
 EXAMPLES::
 
-    sage: S = Sandpile({'a':[1,'b'], 'b':[1,'a'], 1:['a']},'a')
-    sage: c = SandpileConfig(S, {'b':1, 1:2})
+    sage: S = Sandpile({'a':['c','b'], 'b':['c','a'], 'c':['a']},'a')
+    sage: c = SandpileConfig(S, {'b':1, 'c':2})
     sage: c
-    {1: 2, 'b': 1}
+    {'c': 2, 'b': 1}
```

I'm not sure that last change is always going to be correct.  If `c` were a dict it would be pretty-printed with its keys sorted.  I haven't looked at `SandpileConfig` but it should probably do the same.



---

archive/issue_comments_410373.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nAnd does this relate in any way to #26722?",
    "created_at": "2019-01-10T15:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410373",
    "user": "https://github.com/embray"
}
```

<div id="comment:23" align="right">comment:23</div>

And does this relate in any way to #26722?



---

archive/issue_comments_410374.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThis is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.\n\nCan I set back to positive ?",
    "created_at": "2019-01-10T16:02:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410374",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:24" align="right">comment:24</div>

This is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.

Can I set back to positive ?



---

archive/issue_comments_410375.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@fchapoton](#comment:24):\n> This is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.\n> \n> Can I set back to positive ?\n\nUnfortunately not: The problem is that since this is being repr'd like a dict, the output order is completely arbitrary, and this ticket is just changing it to a different arbitrary order that is not guaranteed to be the same between Python versions or even platforms.\n\nIf you give me a sec, I think I have a solution...",
    "created_at": "2019-01-10T16:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410375",
    "user": "https://github.com/embray"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@fchapoton](#comment:24):
> This is a preliminary cleanup work, certainly not the last word. Your concern should go to #26722. Sandpiles is a big mess, and I hope to move forward by small steps.
> 
> Can I set back to positive ?

Unfortunately not: The problem is that since this is being repr'd like a dict, the output order is completely arbitrary, and this ticket is just changing it to a different arbitrary order that is not guaranteed to be the same between Python versions or even platforms.

If you give me a sec, I think I have a solution...



---

archive/issue_comments_410376.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e\"><code>db899d8</code></a></td><td><code>fix pretty printing of SandpileConfig and SandpileDivisor</code></td></tr></table>\n",
    "created_at": "2019-01-10T16:42:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410376",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e"><code>db899d8</code></a></td><td><code>fix pretty printing of SandpileConfig and SandpileDivisor</code></td></tr></table>




---

archive/issue_comments_410377.json:
```json
{
    "body": "Changed commit from **[`6be2430`](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)** to **[`db899d8`](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)**",
    "created_at": "2019-01-10T16:42:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410377",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6be2430`](https://github.com/sagemath/sagetrac-mirror/commit/6be243066df8a07b2542b40120ea38adad748409)** to **[`db899d8`](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)**



---

archive/issue_events_363446.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T16:42:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363446"
}
```



---

archive/issue_events_363447.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T16:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363447"
}
```



---

archive/issue_comments_410378.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nthis will probably trigger the import of IPython at startup, no ?",
    "created_at": "2019-01-10T16:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410378",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:28" align="right">comment:28</div>

this will probably trigger the import of IPython at startup, no ?



---

archive/issue_comments_410379.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI'm not sure what you mean.",
    "created_at": "2019-01-10T16:46:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410379",
    "user": "https://github.com/embray"
}
```

<div id="comment:29" align="right">comment:29</div>

I'm not sure what you mean.



---

archive/issue_comments_410380.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI mean that the line\n\n```\nfrom IPython.lib import pretty\n```\nmaybe will have a negative impact on sage startup time (if it imports all of IPython)\n\nI am asking because I tried to import sage pretty-printer in some ticket, and then the startup time got 10% longer (import of Ipython..)",
    "created_at": "2019-01-10T16:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410380",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:30" align="right">comment:30</div>

I mean that the line

```
from IPython.lib import pretty
```
maybe will have a negative impact on sage startup time (if it imports all of IPython)

I am asking because I tried to import sage pretty-printer in some ticket, and then the startup time got 10% longer (import of Ipython..)



---

archive/issue_comments_410381.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThat's odd that you found that to be the case, because the Sage REPL *is* IPython:\n\n```\n$ ./sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.6.rc0, Release Date: 2019-01-03                 \u2502\n\u2502 Using Python 2.7.15. Type \"help()\" for help.                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: import sys\nsage: sys.modules['IPython.lib.pretty']\n<module 'IPython.lib.pretty' from '/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/IPython/lib/pretty.pyc'>\nsage: sys.modules['sage.sandpiles.sandpile']\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n<ipython-input-4-8624d4f52316> in <module>()\n----> 1 sys.modules['sage.sandpiles.sandpile']\n\nKeyError: 'sage.sandpiles.sandpile'\n```",
    "created_at": "2019-01-10T16:52:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410381",
    "user": "https://github.com/embray"
}
```

<div id="comment:31" align="right">comment:31</div>

That's odd that you found that to be the case, because the Sage REPL *is* IPython:

```
$ ./sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.6.rc0, Release Date: 2019-01-03                 │
│ Using Python 2.7.15. Type "help()" for help.                       │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: import sys
sage: sys.modules['IPython.lib.pretty']
<module 'IPython.lib.pretty' from '/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/IPython/lib/pretty.pyc'>
sage: sys.modules['sage.sandpiles.sandpile']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-4-8624d4f52316> in <module>()
----> 1 sys.modules['sage.sandpiles.sandpile']

KeyError: 'sage.sandpiles.sandpile'
```



---

archive/issue_comments_410382.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nYes, strange indeed, but see bottom report here:\n\nhttps://patchbot.sagemath.org/ticket/26967/\n\nand in particular the startup plugins..\n\nEDIT: Apparently triggered by\n\n```\n+from sage.repl.rich_output.backend_base import BackendBase\n+from sage.repl.display.pretty_print import SagePrettyPrinter\n```",
    "created_at": "2019-01-10T16:57:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410382",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:32" align="right">comment:32</div>

Yes, strange indeed, but see bottom report here:

https://patchbot.sagemath.org/ticket/26967/

and in particular the startup plugins..

EDIT: Apparently triggered by

```
+from sage.repl.rich_output.backend_base import BackendBase
+from sage.repl.display.pretty_print import SagePrettyPrinter
```



---

archive/issue_comments_410383.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nWell, `sage -c` is different because it doesn't load the REPL, but it does `import sage.all`.  However, I still *usually* get:\n\n```\n$ ./sage -c 'import sys; print(\"IPython\" in sys.modules)'\nFalse\n```\n\nThis might be in part because `sage.sandpiles` is lazy-imported.\n\nFor some odd reason though, immediately after a `./sage -b` I get:\n\n```\n$ ./sage -c 'import sys; print(\"IPython\" in sys.modules)'\nTrue\n```\n\nBut then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.",
    "created_at": "2019-01-10T17:13:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410383",
    "user": "https://github.com/embray"
}
```

<div id="comment:33" align="right">comment:33</div>

Well, `sage -c` is different because it doesn't load the REPL, but it does `import sage.all`.  However, I still *usually* get:

```
$ ./sage -c 'import sys; print("IPython" in sys.modules)'
False
```

This might be in part because `sage.sandpiles` is lazy-imported.

For some odd reason though, immediately after a `./sage -b` I get:

```
$ ./sage -c 'import sys; print("IPython" in sys.modules)'
True
```

But then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.



---

archive/issue_comments_410384.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nAs my note says, it would be good to rework `sage.repl.display.pretty_print` so that this kind of thing can be avoided in the first place since it's pretty ugly anyways.",
    "created_at": "2019-01-10T17:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410384",
    "user": "https://github.com/embray"
}
```

<div id="comment:34" align="right">comment:34</div>

As my note says, it would be good to rework `sage.repl.display.pretty_print` so that this kind of thing can be avoided in the first place since it's pretty ugly anyways.



---

archive/issue_comments_410385.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@embray](#comment:33):\n> But then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.\n\nI see: That's in order to rebuild the star imports cache.",
    "created_at": "2019-01-10T17:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410385",
    "user": "https://github.com/embray"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@embray](#comment:33):
> But then not thereafter. Something must change immediately after a re-build that somehow triggers IPython from being imported.

I see: That's in order to rebuild the star imports cache.



---

archive/issue_comments_410386.json:
```json
{
    "body": "Changed author from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, Erik Bray**",
    "created_at": "2019-01-11T07:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410386",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Frédéric Chapoton** to **Frédéric Chapoton, Erik Bray**



---

archive/issue_comments_410387.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nok, then.",
    "created_at": "2019-01-11T07:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410387",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:36" align="right">comment:36</div>

ok, then.



---

archive/issue_comments_410388.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-01-11T07:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410388",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Frédéric Chapoton**



---

archive/issue_events_363448.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-11T07:44:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363448"
}
```



---

archive/issue_events_363449.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-11T07:44:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363449"
}
```



---

archive/issue_comments_410389.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThanks.  It's still a good point you raise though: Merely importing those modules shouldn't cause `IPython` to be imported if it can be avoided (e.g. it's pointless to do so if we're not in IPython).\n\nI'll open a ticket for that.",
    "created_at": "2019-01-11T11:47:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410389",
    "user": "https://github.com/embray"
}
```

<div id="comment:37" align="right">comment:37</div>

Thanks.  It's still a good point you raise though: Merely importing those modules shouldn't cause `IPython` to be imported if it can be avoided (e.g. it's pointless to do so if we're not in IPython).

I'll open a ticket for that.



---

archive/issue_comments_410390.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nOn OSX:\n\n```\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 3486, in sage.sandpiles.sandpile.SandpileConfig.values\nFailed example:\n    c\nExpected:\n    {1: 2, 'b': 1}\nGot:\n    {'b': 1, 1: 2}\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 4765, in sage.sandpiles.sandpile.SandpileDivisor.values\nFailed example:\n    D\nExpected:\n    {1: 2, 'a': 0, 'b': 1}\nGot:\n    {'a': 0, 'b': 1, 1: 2}\n**********************************************************************\n```",
    "created_at": "2019-01-20T19:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410390",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:38" align="right">comment:38</div>

On OSX:

```
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 3486, in sage.sandpiles.sandpile.SandpileConfig.values
Failed example:
    c
Expected:
    {1: 2, 'b': 1}
Got:
    {'b': 1, 1: 2}
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 4765, in sage.sandpiles.sandpile.SandpileDivisor.values
Failed example:
    D
Expected:
    {1: 2, 'a': 0, 'b': 1}
Got:
    {'a': 0, 'b': 1, 1: 2}
**********************************************************************
```



---

archive/issue_events_363450.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-20T19:34:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363450"
}
```



---

archive/issue_events_363451.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-20T19:34:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363451"
}
```



---

archive/issue_comments_410391.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nDamnation...",
    "created_at": "2019-01-20T20:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410391",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:39" align="right">comment:39</div>

Damnation...



---

archive/issue_comments_410392.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a58cbbbf6874773e7866cfac86cc822a3c82ed09\"><code>a58cbbb</code></a></td><td><code>Merge branch 'public/ticket/26628' in 8.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41\"><code>8ee90c7</code></a></td><td><code>sandpiles : fixing some doctests</code></td></tr></table>\n",
    "created_at": "2019-01-21T09:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410392",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a58cbbbf6874773e7866cfac86cc822a3c82ed09"><code>a58cbbb</code></a></td><td><code>Merge branch 'public/ticket/26628' in 8.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41"><code>8ee90c7</code></a></td><td><code>sandpiles : fixing some doctests</code></td></tr></table>




---

archive/issue_comments_410393.json:
```json
{
    "body": "Changed commit from **[`db899d8`](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)** to **[`8ee90c7`](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)**",
    "created_at": "2019-01-21T09:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410393",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`db899d8`](https://github.com/sagemath/sagetrac-mirror/commit/db899d8f6434055900457db3bb9367537f57ae7e)** to **[`8ee90c7`](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)**



---

archive/issue_comments_410394.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nok, this should fix it.",
    "created_at": "2019-01-21T09:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410394",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:41" align="right">comment:41</div>

ok, this should fix it.



---

archive/issue_events_363452.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-21T09:53:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363452"
}
```



---

archive/issue_events_363453.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-21T09:53:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363453"
}
```



---

archive/issue_comments_410395.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\ngreen bot. I have no way to test on OSX.",
    "created_at": "2019-01-21T12:20:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410395",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:42" align="right">comment:42</div>

green bot. I have no way to test on OSX.



---

archive/issue_comments_410396.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nVincent, would you please check the OsX behaviour ?",
    "created_at": "2019-01-22T07:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410396",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:43" align="right">comment:43</div>

Vincent, would you please check the OsX behaviour ?



---

archive/issue_comments_410397.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nYes ! The two OSX errors from [comment:38](https://github.com/sagemath/sage/issues/26628#comment:38) are fixed.",
    "created_at": "2019-01-22T10:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410397",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:44" align="right">comment:44</div>

Yes ! The two OSX errors from [comment:38](https://github.com/sagemath/sage/issues/26628#comment:38) are fixed.



---

archive/issue_comments_410398.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nMerci beaucoup, Vincent. Je repasse en positif.",
    "created_at": "2019-01-22T10:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410398",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:45" align="right">comment:45</div>

Merci beaucoup, Vincent. Je repasse en positif.



---

archive/issue_events_363454.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-22T10:18:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363454"
}
```



---

archive/issue_events_363455.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-22T10:18:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363455"
}
```



---

archive/issue_comments_410399.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nWeird. I'd have to take a closer look at how IPython's pretty-print module orders heterogeneous types when printing dictionaries.  If it's doing something id-based then it's not going to reliable (at least not the default implementation ...)",
    "created_at": "2019-01-23T12:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410399",
    "user": "https://github.com/embray"
}
```

<div id="comment:46" align="right">comment:46</div>

Weird. I'd have to take a closer look at how IPython's pretty-print module orders heterogeneous types when printing dictionaries.  If it's doing something id-based then it's not going to reliable (at least not the default implementation ...)



---

archive/issue_comments_410400.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nUgh, so it's using this:\n\n```\ndef _sorted_for_pprint(items):\n    \"\"\"\n    Sort the given items for pretty printing. Since some predictable\n    sorting is better than no sorting at all, we sort on the string\n    representation if normal sorting fails.\n    \"\"\"\n    items = list(items)\n    try:\n        return sorted(items)\n    except Exception:\n        try:\n            return sorted(items, key=str)\n        except Exception:\n            return items\n```\n\nIronically this will give more-or-less deterministic results on Python 3 (<3.7, where it relies on built-in dict ordering), but non-deterministic results on Python 2 where `sorted(items)` will not raise an exception, and instead rely on Python 2's crappy fallback ordering which is not deterministic.\n\nThis might explain some other tests that expect dicts in their output, but where we've struggled to get consistent results across platforms.  I'll look into fixing this.",
    "created_at": "2019-01-23T12:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410400",
    "user": "https://github.com/embray"
}
```

<div id="comment:47" align="right">comment:47</div>

Ugh, so it's using this:

```
def _sorted_for_pprint(items):
    """
    Sort the given items for pretty printing. Since some predictable
    sorting is better than no sorting at all, we sort on the string
    representation if normal sorting fails.
    """
    items = list(items)
    try:
        return sorted(items)
    except Exception:
        try:
            return sorted(items, key=str)
        except Exception:
            return items
```

Ironically this will give more-or-less deterministic results on Python 3 (<3.7, where it relies on built-in dict ordering), but non-deterministic results on Python 2 where `sorted(items)` will not raise an exception, and instead rely on Python 2's crappy fallback ordering which is not deterministic.

This might explain some other tests that expect dicts in their output, but where we've struggled to get consistent results across platforms.  I'll look into fixing this.



---

archive/issue_events_363456.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363456"
}
```



---

archive/issue_events_363457.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "baff75f69d842e683b8e9219e8ea5bb198905351",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-24T18:17:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26628#event-363457"
}
```



---

archive/issue_comments_410401.json:
```json
{
    "body": "Changed branch from **[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)** to **[`8ee90c7`](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)**",
    "created_at": "2019-01-24T18:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26628#issuecomment-410401",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/26628](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26628)** to **[`8ee90c7`](https://github.com/sagemath/sagetrac-mirror/commit/8ee90c7e421565e6ecd98fd2b79f2589b01f7e41)**
