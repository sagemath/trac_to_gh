# Issue 26105: Support base_morphism for hom(im_gens)

archive/issues_025868.json:
```json
{
    "body": "Currently, the method `.hom(im_gens)` on parents allows you to define the images of the generators of a structure. This is assuming that the coefficients of these generators can be sent to the codomain with some canonical coercion.\n\nThis is often insufficient, e.g., in the case of polynomial rings where you would also like to define a map that translate the ring of coefficients non-canonically. Note that function fields already have a specialized `.hom()` implementation that supports this feature.\n\nSee #26103 for a followup.\n\nCC:  @roed314 @xcaruso swewers\n\nKeywords: padicBordeaux\n\nBranch/Commit: 626f4ca244b2f87ce0838cba554244cc7ac037f0\n\nReviewer: David Roe, Julian R\u00fcth, Xavier Caruso\n\nAuthor: Julian R\u00fcth, David Roe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26105\n\n",
    "closed_at": "2019-10-12T22:12:36Z",
    "created_at": "2018-08-21T17:24:34Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Support base_morphism for hom(im_gens)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26105",
    "user": "https://github.com/saraedum"
}
```
Currently, the method `.hom(im_gens)` on parents allows you to define the images of the generators of a structure. This is assuming that the coefficients of these generators can be sent to the codomain with some canonical coercion.

This is often insufficient, e.g., in the case of polynomial rings where you would also like to define a map that translate the ring of coefficients non-canonically. Note that function fields already have a specialized `.hom()` implementation that supports this feature.

See #26103 for a followup.

CC:  @roed314 @xcaruso swewers

Keywords: padicBordeaux

Branch/Commit: 626f4ca244b2f87ce0838cba554244cc7ac037f0

Reviewer: David Roe, Julian Rüth, Xavier Caruso

Author: Julian Rüth, David Roe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26105





---

archive/issue_comments_495381.json:
```json
{
    "body": "<a id='comment:1'></a>\nroed, caruso: I am curious to hear what you think about this. I have been stumbling upon this several times during the past years.",
    "created_at": "2018-08-21T17:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495381",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:1'></a>
roed, caruso: I am curious to hear what you think about this. I have been stumbling upon this several times during the past years.



---

archive/issue_comments_495382.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Currently, the method `.hom(im_gens)` on parents allows you to define the images of the generators of a structure. This is assuming that the coefficients of these generators can be sent to the codomain with some canonical coercion.\n \n This is often insufficient, e.g., in the case of polynomial rings where you would also like to define a map that translate the ring of coefficients non-canonically. Note that function fields already have a specialized `.hom()` implementation that supports this feature.\n+\n+See #26103 for a followup.\n``````\n",
    "created_at": "2018-08-21T17:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495382",
    "user": "https://github.com/saraedum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Currently, the method `.hom(im_gens)` on parents allows you to define the images of the generators of a structure. This is assuming that the coefficients of these generators can be sent to the codomain with some canonical coercion.
 
 This is often insufficient, e.g., in the case of polynomial rings where you would also like to define a map that translate the ring of coefficients non-canonically. Note that function fields already have a specialized `.hom()` implementation that supports this feature.
+
+See #26103 for a followup.
``````




---

archive/issue_comments_495383.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe problem with `im_gens` is that it's not really mathematically defined in the first place. So I wouldn't try to add more functionality to it.\n\nInstead, I would define a specific morphism class for polynomial rings. Mathematically, a ring morphism from a polynomial ring is defined by a morphism of the base together with the images of the generators. That was my plan for #25558 but I stopped working on that...",
    "created_at": "2018-08-21T20:04:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495383",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
The problem with `im_gens` is that it's not really mathematically defined in the first place. So I wouldn't try to add more functionality to it.

Instead, I would define a specific morphism class for polynomial rings. Mathematically, a ring morphism from a polynomial ring is defined by a morphism of the base together with the images of the generators. That was my plan for #25558 but I stopped working on that...



---

archive/issue_comments_495384.json:
```json
{
    "body": "<a id='comment:4'></a>\nPolynomial rings are just one example. Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(\u03b1)\u2192l`.\n\nBut I think I also had this issue with fraction fields before.\n\nI agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.\n\nMaybe I'll just use a `SetMorphism` if I shouldn't extend `hom()` though I personally don't like these.\n\nAnyway, let me give a try at extending `hom()` and see what the result looks like.",
    "created_at": "2018-08-29T01:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495384",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:4'></a>
Polynomial rings are just one example. Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(α)→l`.

But I think I also had this issue with fraction fields before.

I agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.

Maybe I'll just use a `SetMorphism` if I shouldn't extend `hom()` though I personally don't like these.

Anyway, let me give a try at extending `hom()` and see what the result looks like.



---

archive/issue_comments_495385.json:
```json
{
    "body": "<a id='comment:5'></a>\nLooking at the ring homomorphism code brings back bad memories from #23204. Maybe I don't want to add more to morphism.pyx and homset.py as these should probably be drastically simplified if anything.",
    "created_at": "2018-08-29T02:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495385",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:5'></a>
Looking at the ring homomorphism code brings back bad memories from #23204. Maybe I don't want to add more to morphism.pyx and homset.py as these should probably be drastically simplified if anything.



---

archive/issue_comments_495386.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [saraedum](#comment%3A4):\n> I agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.\n\n\nOf course, if it works using generic code, that's fine for me. But it might be harder to do it that way. I'm pretty sure that some of the existing issues with morphism are precisely because code wants to be too generic and doesn't really know what it is doing.",
    "created_at": "2018-08-29T08:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495386",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Replying to [saraedum](#comment%3A4):
> I agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.


Of course, if it works using generic code, that's fine for me. But it might be harder to do it that way. I'm pretty sure that some of the existing issues with morphism are precisely because code wants to be too generic and doesn't really know what it is doing.



---

archive/issue_comments_495387.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [saraedum](#comment%3A4):\n> Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(\u03b1)\u2192l`.\n\n\nBut this is really a map induced by a polynomial ring map `k[x] \u2192 l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.",
    "created_at": "2018-08-29T08:43:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495387",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [saraedum](#comment%3A4):
> Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(α)→l`.


But this is really a map induced by a polynomial ring map `k[x] → l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.



---

archive/issue_comments_495388.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jdemeyer](#comment%3A7):\n> Replying to [saraedum](#comment%3A4):\n> > Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(\u03b1)\u2192l`.\n\n> \n> But this is really a map induced by a polynomial ring map `k[x] \u2192 l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.\n\n\nI am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]\u2192l`?",
    "created_at": "2018-08-29T10:52:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495388",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:8'></a>
Replying to [jdemeyer](#comment%3A7):
> Replying to [saraedum](#comment%3A4):
> > Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(α)→l`.

> 
> But this is really a map induced by a polynomial ring map `k[x] → l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.


I am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]→l`?



---

archive/issue_comments_495389.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [saraedum](#comment%3A8):\n> I am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]\u2192l`?\n\n\nBy giving a map `k \u2192 l` and the image of `x`.\n\nIf `k` is not a prime finite field, then use recursion: `k = f[\u03b1]`, so `k \u2192 l` is induced by a map `f[x] \u2192 l`.",
    "created_at": "2018-08-29T11:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495389",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Replying to [saraedum](#comment%3A8):
> I am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]→l`?


By giving a map `k → l` and the image of `x`.

If `k` is not a prime finite field, then use recursion: `k = f[α]`, so `k → l` is induced by a map `f[x] → l`.



---

archive/issue_comments_495390.json:
```json
{
    "body": "<a id='comment:10'></a>\nSorry, my question was how to do this in Sage precisely. So, I can map `k(\u03b1)\u2192k[x]` by mapping the generator to `x`. Then I map `k[x]\u2192l[x]` by using an induced map. Finally I use the evaluation `l[x]\u2192l`. But are people really supposed to figure this out on their own?\n\nIf I understand your proposal in comment 7 above, you would like to see a shortcut to define `k[x]\u2192l` as `(k[x]).hom(\u03b1', base_morphism=k\u2192l)`. But why not go all the way and allow people to write `(k(\u03b1)).hom(\u03b1', base_morphism=k\u2192l)`?",
    "created_at": "2018-08-29T11:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495390",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:10'></a>
Sorry, my question was how to do this in Sage precisely. So, I can map `k(α)→k[x]` by mapping the generator to `x`. Then I map `k[x]→l[x]` by using an induced map. Finally I use the evaluation `l[x]→l`. But are people really supposed to figure this out on their own?

If I understand your proposal in comment 7 above, you would like to see a shortcut to define `k[x]→l` as `(k[x]).hom(α', base_morphism=k→l)`. But why not go all the way and allow people to write `(k(α)).hom(α', base_morphism=k→l)`?



---

archive/issue_comments_495391.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [saraedum](#comment%3A10):\n> But why not go all the way and allow people to write `(k(\u03b1)).hom(\u03b1', base_morphism=k\u2192l)`?\n\n\nI'm only talking about the implementation. What you \"allow people to write\" is an entirely different discussion.",
    "created_at": "2018-08-29T11:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495391",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Replying to [saraedum](#comment%3A10):
> But why not go all the way and allow people to write `(k(α)).hom(α', base_morphism=k→l)`?


I'm only talking about the implementation. What you "allow people to write" is an entirely different discussion.



---

archive/issue_comments_495392.json:
```json
{
    "body": "<a id='comment:12'></a>\nAn alternative might be to just document these things in the docstring of `hom()`.",
    "created_at": "2018-08-29T12:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495392",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:12'></a>
An alternative might be to just document these things in the docstring of `hom()`.



---

archive/issue_comments_495393.json:
```json
{
    "body": "<a id='comment:13'></a>\n`@`saraedum:\nI'm not sure that I understand what you have in mind. Could you please give a short concrete example of what you would like to see implemented, please?",
    "created_at": "2018-08-29T14:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495393",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:13'></a>
`@`saraedum:
I'm not sure that I understand what you have in mind. Could you please give a short concrete example of what you would like to see implemented, please?



---

archive/issue_comments_495394.json:
```json
{
    "body": "<a id='comment:14'></a>\nA concrete example where I would like to be able to specify a base_morphism is the following:\n\n```\nsage: k = GF(2)\nsage: R.<a> = k[]\nsage: l.<a> = k.extension(a^3 + a^2 + 1)\nsage: R.<b> = l[]\nsage: m.<b> = l.extension(b^2 + b + a)\nsage: n.<z> = GF(2^6)\n\nsage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))\n```",
    "created_at": "2018-08-29T15:00:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495394",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:14'></a>
A concrete example where I would like to be able to specify a base_morphism is the following:

```
sage: k = GF(2)
sage: R.<a> = k[]
sage: l.<a> = k.extension(a^3 + a^2 + 1)
sage: R.<b> = l[]
sage: m.<b> = l.extension(b^2 + b + a)
sage: n.<z> = GF(2^6)

sage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))
```



---

archive/issue_comments_495395.json:
```json
{
    "body": "Changing keywords from \"\" to \"padicBordeaux\".",
    "created_at": "2019-09-10T16:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495395",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "" to "padicBordeaux".



---

archive/issue_comments_495396.json:
```json
{
    "body": "Changing branch from \"\" to \"u/roed/26105_base_hom\"",
    "created_at": "2019-09-11T22:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495396",
    "user": "https://github.com/roed314"
}
```

Changing branch from "" to "u/roed/26105_base_hom"



---

archive/issue_comments_495397.json:
```json
{
    "body": "<a id='comment:17'></a>\nI fixed a few other things as well:\n* a whitespace issue in parent.pyx (a function indented three spaces rather than 4)\n* Changed some double underscore attributes to single underscore\n* Switched some custom caching to `cached_method`.\n\n---\nNew commits:\n|                                                                                                                                          |                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[d4a35ac](https://github.com/sagemath/sagetrac-mirror/commit/d4a35ac1da3360df7a92d02fc0e7c898c3e0676a)|`Add base_map to homomorphisms defined by images of generators`|\n|[1f78dd4](https://github.com/sagemath/sagetrac-mirror/commit/1f78dd4c51b965187c3004eb5b743b41efe4e347)|`Fix some doctests`|",
    "created_at": "2019-09-11T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495397",
    "user": "https://github.com/roed314"
}
```

<a id='comment:17'></a>
I fixed a few other things as well:
* a whitespace issue in parent.pyx (a function indented three spaces rather than 4)
* Changed some double underscore attributes to single underscore
* Switched some custom caching to `cached_method`.

---
New commits:
|                                                                                                                                          |                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[d4a35ac](https://github.com/sagemath/sagetrac-mirror/commit/d4a35ac1da3360df7a92d02fc0e7c898c3e0676a)|`Add base_map to homomorphisms defined by images of generators`|
|[1f78dd4](https://github.com/sagemath/sagetrac-mirror/commit/1f78dd4c51b965187c3004eb5b743b41efe4e347)|`Fix some doctests`|



---

archive/issue_comments_495398.json:
```json
{
    "body": "Changing commit from \"\" to \"1f78dd4c51b965187c3004eb5b743b41efe4e347\"",
    "created_at": "2019-09-11T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495398",
    "user": "https://github.com/roed314"
}
```

Changing commit from "" to "1f78dd4c51b965187c3004eb5b743b41efe4e347"



---

archive/issue_comments_495399.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-09-11T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495399",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_495400.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe, Julian R\u00fcth\"",
    "created_at": "2019-09-12T07:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495400",
    "user": "https://github.com/saraedum"
}
```

Changing reviewer from "" to "David Roe, Julian Rüth"



---

archive/issue_comments_495401.json:
```json
{
    "body": "Changing author from \"Julian R\u00fcth\" to \"Julian R\u00fcth, David Roe\"",
    "created_at": "2019-09-12T07:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495401",
    "user": "https://github.com/saraedum"
}
```

Changing author from "Julian Rüth" to "Julian Rüth, David Roe"



---

archive/issue_comments_495402.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[84704ba](https://github.com/sagemath/sagetrac-mirror/commit/84704ba5472818a3efe97f6ef0784f4e383c512f)|`Fix doctests and py3, incorporate small reviewer suggestion`|",
    "created_at": "2019-09-12T08:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495402",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[84704ba](https://github.com/sagemath/sagetrac-mirror/commit/84704ba5472818a3efe97f6ef0784f4e383c512f)|`Fix doctests and py3, incorporate small reviewer suggestion`|



---

archive/issue_comments_495403.json:
```json
{
    "body": "Changing commit from \"1f78dd4c51b965187c3004eb5b743b41efe4e347\" to \"84704ba5472818a3efe97f6ef0784f4e383c512f\"",
    "created_at": "2019-09-12T08:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495403",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1f78dd4c51b965187c3004eb5b743b41efe4e347" to "84704ba5472818a3efe97f6ef0784f4e383c512f"



---

archive/issue_comments_495404.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [saraedum](#comment%3A14):\n> A concrete example where I would like to be able to specify a base_morphism is the following:\n> \n> ```\n> sage: k = GF(2)\n> sage: R.<a> = k[]\n> sage: l.<a> = k.extension(a^3 + a^2 + 1)\n> sage: R.<b> = l[]\n> sage: m.<b> = l.extension(b^2 + b + a)\n> sage: n.<z> = GF(2^6)\n> \n> sage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))\n> ```\n\n\nThis example raises the following error with the current implementation:\n\n```\nTraceback (most recent call last)\n...\nValueError: relations do not all (canonically) map to 0 under map determined by images of generators\n```",
    "created_at": "2019-09-12T19:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495404",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:20'></a>
Replying to [saraedum](#comment%3A14):
> A concrete example where I would like to be able to specify a base_morphism is the following:
> 
> ```
> sage: k = GF(2)
> sage: R.<a> = k[]
> sage: l.<a> = k.extension(a^3 + a^2 + 1)
> sage: R.<b> = l[]
> sage: m.<b> = l.extension(b^2 + b + a)
> sage: n.<z> = GF(2^6)
> 
> sage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))
> ```


This example raises the following error with the current implementation:

```
Traceback (most recent call last)
...
ValueError: relations do not all (canonically) map to 0 under map determined by images of generators
```



---

archive/issue_comments_495405.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-12T19:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495405",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_495406.json:
```json
{
    "body": "Changing author from \"Julian R\u00fcth, David Roe\" to \"Julian R\u00fcth, David Roe, Xavier Caruso\"",
    "created_at": "2019-09-12T19:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495406",
    "user": "https://github.com/xcaruso"
}
```

Changing author from "Julian Rüth, David Roe" to "Julian Rüth, David Roe, Xavier Caruso"



---

archive/issue_comments_495407.json:
```json
{
    "body": "Changing reviewer from \"David Roe, Julian R\u00fcth\" to \"David Roe, Julian R\u00fcth, Xavier Caruso\"",
    "created_at": "2019-09-12T19:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495407",
    "user": "https://github.com/xcaruso"
}
```

Changing reviewer from "David Roe, Julian Rüth" to "David Roe, Julian Rüth, Xavier Caruso"



---

archive/issue_comments_495408.json:
```json
{
    "body": "Changing author from \"Julian R\u00fcth, David Roe, Xavier Caruso\" to \"Julian R\u00fcth, David Roe\"",
    "created_at": "2019-09-12T19:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495408",
    "user": "https://github.com/xcaruso"
}
```

Changing author from "Julian Rüth, David Roe, Xavier Caruso" to "Julian Rüth, David Roe"



---

archive/issue_comments_495409.json:
```json
{
    "body": "<a id='comment:23'></a>\nA similar problem occurs with Lie algebras:\n\n```\nsage: R.<x> = ZZ[]\nsage: K.<i> = NumberField(x^2 + 1)\nsage: cc = K.hom([-i])\nsage: L.<X,Y,Z,W> = LieAlgebra(K, {('X','Y'): {'Z':i}, ('X','Z'): {'W':1}})\nsage: M.<A,B,C,D> = LieAlgebra(K, {('A','B'): {'C':i}, ('A','C'): {'D':1}})\nsage: phi = L.morphism({X:A, Y:B, Z:C, W:D}, base_map=cc)\n```\n\nThe last line should raise an error since `phi` is not a Lie Algebra morphism:\n\n```\nsage: phi(X.bracket(Y))\n-i*C\nsage: phi(X).bracket(phi(Y))\ni*C\n```\n\nIn the same fashion, if I define:\n\n```\nsage: phi = L.morphism({X:A,Y:B,W:D}, base_map=cc)\n```\n\nI expect `Z` to be mapped to `-C` but this is not the case:\n\n```\nsage: phi(Z)\nC\n```",
    "created_at": "2019-09-12T19:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495409",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:23'></a>
A similar problem occurs with Lie algebras:

```
sage: R.<x> = ZZ[]
sage: K.<i> = NumberField(x^2 + 1)
sage: cc = K.hom([-i])
sage: L.<X,Y,Z,W> = LieAlgebra(K, {('X','Y'): {'Z':i}, ('X','Z'): {'W':1}})
sage: M.<A,B,C,D> = LieAlgebra(K, {('A','B'): {'C':i}, ('A','C'): {'D':1}})
sage: phi = L.morphism({X:A, Y:B, Z:C, W:D}, base_map=cc)
```

The last line should raise an error since `phi` is not a Lie Algebra morphism:

```
sage: phi(X.bracket(Y))
-i*C
sage: phi(X).bracket(phi(Y))
i*C
```

In the same fashion, if I define:

```
sage: phi = L.morphism({X:A,Y:B,W:D}, base_map=cc)
```

I expect `Z` to be mapped to `-C` but this is not the case:

```
sage: phi(Z)
C
```



---

archive/issue_comments_495410.json:
```json
{
    "body": "Changing commit from \"84704ba5472818a3efe97f6ef0784f4e383c512f\" to \"ac1c05a2120c44a8bc4310dc1237559bda618b5f\"",
    "created_at": "2019-09-13T13:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495410",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "84704ba5472818a3efe97f6ef0784f4e383c512f" to "ac1c05a2120c44a8bc4310dc1237559bda618b5f"



---

archive/issue_comments_495411.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[c4f2a3f](https://github.com/sagemath/sagetrac-mirror/commit/c4f2a3f5b17eec98f88d2228a086baa1c53459c1)|`Fix _is_valid_homomorphism_`|\n|[ac1c05a](https://github.com/sagemath/sagetrac-mirror/commit/ac1c05a2120c44a8bc4310dc1237559bda618b5f)|`Documenting category and base_map options`|",
    "created_at": "2019-09-13T13:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495411",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[c4f2a3f](https://github.com/sagemath/sagetrac-mirror/commit/c4f2a3f5b17eec98f88d2228a086baa1c53459c1)|`Fix _is_valid_homomorphism_`|
|[ac1c05a](https://github.com/sagemath/sagetrac-mirror/commit/ac1c05a2120c44a8bc4310dc1237559bda618b5f)|`Documenting category and base_map options`|



---

archive/issue_comments_495412.json:
```json
{
    "body": "Changing commit from \"ac1c05a2120c44a8bc4310dc1237559bda618b5f\" to \"1738aa9010a4362b26bd76a015747dcee4731ad8\"",
    "created_at": "2019-09-13T13:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ac1c05a2120c44a8bc4310dc1237559bda618b5f" to "1738aa9010a4362b26bd76a015747dcee4731ad8"



---

archive/issue_comments_495413.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[1738aa9](https://github.com/sagemath/sagetrac-mirror/commit/1738aa9010a4362b26bd76a015747dcee4731ad8)|`Fix some doctests, remove category keywords from doctests`|",
    "created_at": "2019-09-13T13:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495413",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[1738aa9](https://github.com/sagemath/sagetrac-mirror/commit/1738aa9010a4362b26bd76a015747dcee4731ad8)|`Fix some doctests, remove category keywords from doctests`|



---

archive/issue_comments_495414.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-09-13T13:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495414",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_495415.json:
```json
{
    "body": "<a id='comment:26'></a>\nOkay, I think I've addressed Xavier's comments.",
    "created_at": "2019-09-13T13:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495415",
    "user": "https://github.com/roed314"
}
```

<a id='comment:26'></a>
Okay, I think I've addressed Xavier's comments.



---

archive/issue_comments_495416.json:
```json
{
    "body": "<a id='comment:27'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[d0e0953](https://github.com/sagemath/sagetrac-mirror/commit/d0e095381e58f26786a979298291b3ced85500a5)|`Add base_map to finite_field homsets`|",
    "created_at": "2019-09-13T15:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495416",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[d0e0953](https://github.com/sagemath/sagetrac-mirror/commit/d0e095381e58f26786a979298291b3ced85500a5)|`Add base_map to finite_field homsets`|



---

archive/issue_comments_495417.json:
```json
{
    "body": "Changing commit from \"1738aa9010a4362b26bd76a015747dcee4731ad8\" to \"d0e095381e58f26786a979298291b3ced85500a5\"",
    "created_at": "2019-09-13T15:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1738aa9010a4362b26bd76a015747dcee4731ad8" to "d0e095381e58f26786a979298291b3ced85500a5"



---

archive/issue_comments_495418.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[16feb8d](https://github.com/sagemath/sagetrac-mirror/commit/16feb8dfa1caf7aebd9e31f75397ebc6d084643e)|`Fix some errors with positional check arguments`|",
    "created_at": "2019-09-13T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495418",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[16feb8d](https://github.com/sagemath/sagetrac-mirror/commit/16feb8dfa1caf7aebd9e31f75397ebc6d084643e)|`Fix some errors with positional check arguments`|



---

archive/issue_comments_495419.json:
```json
{
    "body": "Changing commit from \"d0e095381e58f26786a979298291b3ced85500a5\" to \"16feb8dfa1caf7aebd9e31f75397ebc6d084643e\"",
    "created_at": "2019-09-13T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495419",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d0e095381e58f26786a979298291b3ced85500a5" to "16feb8dfa1caf7aebd9e31f75397ebc6d084643e"



---

archive/issue_comments_495420.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|\n|[c48e142](https://github.com/sagemath/sagetrac-mirror/commit/c48e14259ba645a8a377a1b4aebed240dc553666)|`Fix pyflakes`|\n|[aa84741](https://github.com/sagemath/sagetrac-mirror/commit/aa84741e43d429d05348ec8d1a2629e2f09a41b8)|`Fix some doctests`|",
    "created_at": "2019-09-13T23:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495420",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|[c48e142](https://github.com/sagemath/sagetrac-mirror/commit/c48e14259ba645a8a377a1b4aebed240dc553666)|`Fix pyflakes`|
|[aa84741](https://github.com/sagemath/sagetrac-mirror/commit/aa84741e43d429d05348ec8d1a2629e2f09a41b8)|`Fix some doctests`|



---

archive/issue_comments_495421.json:
```json
{
    "body": "Changing commit from \"16feb8dfa1caf7aebd9e31f75397ebc6d084643e\" to \"aa84741e43d429d05348ec8d1a2629e2f09a41b8\"",
    "created_at": "2019-09-13T23:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495421",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "16feb8dfa1caf7aebd9e31f75397ebc6d084643e" to "aa84741e43d429d05348ec8d1a2629e2f09a41b8"



---

archive/issue_comments_495422.json:
```json
{
    "body": "<a id='comment:30'></a>\nThere are still issues with Lie algebra:\n\n```\nsage: R.<x> = ZZ[]\nsage: K.<i> = NumberField(x^2 + 1)\nsage: cc = K.hom([-i])\nsage: L.<X,Y,Z> = LieAlgebra(K, {('X','Y'): {'Z':i}})\nsage: M.<A,B,C> = LieAlgebra(K, {('A','B'): {'C':-i}})\nsage: phi = L.morphism({X:A, Y:B, Z:C}, base_map=cc)\nTraceback (most recent call last):\n...\nValueError: this does not define a Lie algebra morphism; contradictory values for brackets of length 2\n```\n\nbut I think that `phi` is a well-defined semi-linear morphism of Lie algebras.\n\nThe checking is performed in the `__init__` function of `LieAlgebraMorphism_from_generators` (starting at line 474 of `src/sage/algebras/lie_algebras/morphism.py`).",
    "created_at": "2019-09-15T04:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495422",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:30'></a>
There are still issues with Lie algebra:

```
sage: R.<x> = ZZ[]
sage: K.<i> = NumberField(x^2 + 1)
sage: cc = K.hom([-i])
sage: L.<X,Y,Z> = LieAlgebra(K, {('X','Y'): {'Z':i}})
sage: M.<A,B,C> = LieAlgebra(K, {('A','B'): {'C':-i}})
sage: phi = L.morphism({X:A, Y:B, Z:C}, base_map=cc)
Traceback (most recent call last):
...
ValueError: this does not define a Lie algebra morphism; contradictory values for brackets of length 2
```

but I think that `phi` is a well-defined semi-linear morphism of Lie algebras.

The checking is performed in the `__init__` function of `LieAlgebraMorphism_from_generators` (starting at line 474 of `src/sage/algebras/lie_algebras/morphism.py`).



---

archive/issue_comments_495423.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-15T04:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495423",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_495424.json:
```json
{
    "body": "Changing commit from \"aa84741e43d429d05348ec8d1a2629e2f09a41b8\" to \"3d7377618234d5fd125b4803d30c72d909363e7a\"",
    "created_at": "2019-09-26T20:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "aa84741e43d429d05348ec8d1a2629e2f09a41b8" to "3d7377618234d5fd125b4803d30c72d909363e7a"



---

archive/issue_comments_495425.json:
```json
{
    "body": "<a id='comment:32'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[3d73776](https://github.com/sagemath/sagetrac-mirror/commit/3d7377618234d5fd125b4803d30c72d909363e7a)|`Fixing Lie algebra morphisms`|",
    "created_at": "2019-09-26T20:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[3d73776](https://github.com/sagemath/sagetrac-mirror/commit/3d7377618234d5fd125b4803d30c72d909363e7a)|`Fixing Lie algebra morphisms`|



---

archive/issue_comments_495426.json:
```json
{
    "body": "Changing commit from \"3d7377618234d5fd125b4803d30c72d909363e7a\" to \"72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829\"",
    "created_at": "2019-09-26T23:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495426",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3d7377618234d5fd125b4803d30c72d909363e7a" to "72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829"



---

archive/issue_comments_495427.json:
```json
{
    "body": "<a id='comment:33'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|\n|[72b677c](https://github.com/sagemath/sagetrac-mirror/commit/72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829)|`change_ring -> map_coefficients and fix composition of morphisms defined by images of generators`|",
    "created_at": "2019-09-26T23:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495427",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
|[72b677c](https://github.com/sagemath/sagetrac-mirror/commit/72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829)|`change_ring -> map_coefficients and fix composition of morphisms defined by images of generators`|



---

archive/issue_comments_495428.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-03T19:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495428",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_495429.json:
```json
{
    "body": "Changing commit from \"72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829\" to \"d780c6fdf4a793e833d091bb1de98198f3d89ae2\"",
    "created_at": "2019-10-03T21:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "72b677c28fdd9db2054a8b0ffc5a1b3aeaadd829" to "d780c6fdf4a793e833d091bb1de98198f3d89ae2"



---

archive/issue_comments_495430.json:
```json
{
    "body": "<a id='comment:35'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[d780c6f](https://github.com/sagemath/sagetrac-mirror/commit/d780c6fdf4a793e833d091bb1de98198f3d89ae2)|`Change base_map so that the codomain is always the codomain of the map`|",
    "created_at": "2019-10-03T21:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495430",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[d780c6f](https://github.com/sagemath/sagetrac-mirror/commit/d780c6fdf4a793e833d091bb1de98198f3d89ae2)|`Change base_map so that the codomain is always the codomain of the map`|



---

archive/issue_comments_495431.json:
```json
{
    "body": "<a id='comment:36'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[bfcbebe](https://github.com/sagemath/sagetrac-mirror/commit/bfcbebefa46b2e5f4845a73b848c3771fad1fcd5)|`Fix bug in composition`|",
    "created_at": "2019-10-03T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495431",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[bfcbebe](https://github.com/sagemath/sagetrac-mirror/commit/bfcbebefa46b2e5f4845a73b848c3771fad1fcd5)|`Fix bug in composition`|



---

archive/issue_comments_495432.json:
```json
{
    "body": "Changing commit from \"d780c6fdf4a793e833d091bb1de98198f3d89ae2\" to \"bfcbebefa46b2e5f4845a73b848c3771fad1fcd5\"",
    "created_at": "2019-10-03T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d780c6fdf4a793e833d091bb1de98198f3d89ae2" to "bfcbebefa46b2e5f4845a73b848c3771fad1fcd5"



---

archive/issue_comments_495433.json:
```json
{
    "body": "<a id='comment:37'></a>\nLGTM (see also discussion on Zulip).\n\nPositive review when patchbot is happy.",
    "created_at": "2019-10-03T23:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495433",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:37'></a>
LGTM (see also discussion on Zulip).

Positive review when patchbot is happy.



---

archive/issue_comments_495434.json:
```json
{
    "body": "<a id='comment:38'></a>\nThere are failing doctests.\n\n```\nFile \"src/sage/rings/morphism.pyx\", line 837, in sage.rings.morphism.RingHomomorphism._composition_\nFailed example:\n    (f*f).base_map()\nExpected:\n    Ring morphism:\n      From: Univariate Polynomial Ring in x over Rational Field\n      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field\n      Defn: x |--> 2*x\nGot:\n    Ring morphism:\n      From: Univariate Polynomial Ring in x over Rational Field\n      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field\n      Defn: x |--> 2*x\n            with map of base ring\n**********************************************************************\nFile \"src/sage/rings/morphism.pyx\", line 1117, in sage.rings.morphism.RingHomomorphism_im_gens.__init__\nFailed example:\n    phi = S.hom([xx+1,xx-1],check=False)\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: images do not define a valid homomorphism\nGot:\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/rings/morphism.pyx\", line 1192, in sage.rings.morphism.RingHomomorphism_im_gens.base_map\nFailed example:\n    phi.base_map()\nExpected:\n    Ring endomorphism of Number Field in i with defining polynomial x^2 + 1\n      Defn: i |--> -i\nGot:\n    Composite map:\n      From: Number Field in i with defining polynomial x^2 + 1\n      To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1\n      Defn:   Ring endomorphism of Number Field in i with defining polynomial x^2 + 1\n              Defn: i |--> -i\n            then\n              Polynomial base injection morphism:\n              From: Number Field in i with defining polynomial x^2 + 1\n              To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1\n**********************************************************************\nFile \"src/sage/structure/parent_gens.pyx\", line 311, in sage.structure.parent_gens.ParentWithGens.gens.hom\nFailed example:\n    f = R.hom([x+1], base_map=lambda t: t+1); f\nException raised:\n    Traceback (most recent call last):\n      File \"/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.structure.parent_gens.ParentWithGens.gens.hom[22]>\", line 1, in <module>\n        f = R.hom([x+Integer(1)], base_map=lambda t: t+Integer(1)); f\n      File \"sage/structure/parent_gens.pyx\", line 328, in sage.structure.parent_gens.ParentWithGens.hom (build/cythonized/sage/structure/parent_gens.c:3690)\n        return parent.Parent.hom(self, im_gens, codomain, base_map=base_map, category=category, check=check)\n      File \"sage/structure/parent.pyx\", line 1360, in sage.structure.parent.Parent.hom (build/cythonized/sage/structure/parent.c:11708)\n        return self.Hom(codomain, **Hom_kwds)(im_gens, **kwds)\n      File \"/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/homset.py\", line 208, in __call__\n        return morphism.RingHomomorphism_im_gens(self, im_gens, base_map=base_map, check=check)\n      File \"sage/rings/morphism.pyx\", line 1134, in sage.rings.morphism.RingHomomorphism_im_gens.__init__ (build/cythonized/sage/rings/morphism.c:8239)\n        if base_map.codomain() is not self.codomain():\n    AttributeError: 'function' object has no attribute 'codomain'\n**********************************************************************\nFile \"src/sage/structure/parent_gens.pyx\", line 315, in sage.structure.parent_gens.ParentWithGens.gens.hom\nFailed example:\n    f.category_for()\nExpected:\n    Join of Category of euclidean domains and Category of commutative algebras over (finite enumerated fields and subquotients of monoids and quotients of semigroups) and Category of infinite sets\nGot:\n    Category of enumerated euclidean domains\n**********************************************************************\nFile \"src/sage/structure/parent_gens.pyx\", line 317, in sage.structure.parent_gens.ParentWithGens.gens.hom\nFailed example:\n    f(-1)\nExpected:\n    0\nGot:\n    4\n**********************************************************************\n```\n\nAnd the flag is red for non_ascii and pyflakes but I don't understand what's wrong.",
    "created_at": "2019-10-04T06:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495434",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:38'></a>
There are failing doctests.

```
File "src/sage/rings/morphism.pyx", line 837, in sage.rings.morphism.RingHomomorphism._composition_
Failed example:
    (f*f).base_map()
Expected:
    Ring morphism:
      From: Univariate Polynomial Ring in x over Rational Field
      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field
      Defn: x |--> 2*x
Got:
    Ring morphism:
      From: Univariate Polynomial Ring in x over Rational Field
      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field
      Defn: x |--> 2*x
            with map of base ring
**********************************************************************
File "src/sage/rings/morphism.pyx", line 1117, in sage.rings.morphism.RingHomomorphism_im_gens.__init__
Failed example:
    phi = S.hom([xx+1,xx-1],check=False)
Expected:
    Traceback (most recent call last):
    ...
    TypeError: images do not define a valid homomorphism
Got:
    <BLANKLINE>
**********************************************************************
File "src/sage/rings/morphism.pyx", line 1192, in sage.rings.morphism.RingHomomorphism_im_gens.base_map
Failed example:
    phi.base_map()
Expected:
    Ring endomorphism of Number Field in i with defining polynomial x^2 + 1
      Defn: i |--> -i
Got:
    Composite map:
      From: Number Field in i with defining polynomial x^2 + 1
      To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1
      Defn:   Ring endomorphism of Number Field in i with defining polynomial x^2 + 1
              Defn: i |--> -i
            then
              Polynomial base injection morphism:
              From: Number Field in i with defining polynomial x^2 + 1
              To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1
**********************************************************************
File "src/sage/structure/parent_gens.pyx", line 311, in sage.structure.parent_gens.ParentWithGens.gens.hom
Failed example:
    f = R.hom([x+1], base_map=lambda t: t+1); f
Exception raised:
    Traceback (most recent call last):
      File "/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.structure.parent_gens.ParentWithGens.gens.hom[22]>", line 1, in <module>
        f = R.hom([x+Integer(1)], base_map=lambda t: t+Integer(1)); f
      File "sage/structure/parent_gens.pyx", line 328, in sage.structure.parent_gens.ParentWithGens.hom (build/cythonized/sage/structure/parent_gens.c:3690)
        return parent.Parent.hom(self, im_gens, codomain, base_map=base_map, category=category, check=check)
      File "sage/structure/parent.pyx", line 1360, in sage.structure.parent.Parent.hom (build/cythonized/sage/structure/parent.c:11708)
        return self.Hom(codomain, **Hom_kwds)(im_gens, **kwds)
      File "/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/homset.py", line 208, in __call__
        return morphism.RingHomomorphism_im_gens(self, im_gens, base_map=base_map, check=check)
      File "sage/rings/morphism.pyx", line 1134, in sage.rings.morphism.RingHomomorphism_im_gens.__init__ (build/cythonized/sage/rings/morphism.c:8239)
        if base_map.codomain() is not self.codomain():
    AttributeError: 'function' object has no attribute 'codomain'
**********************************************************************
File "src/sage/structure/parent_gens.pyx", line 315, in sage.structure.parent_gens.ParentWithGens.gens.hom
Failed example:
    f.category_for()
Expected:
    Join of Category of euclidean domains and Category of commutative algebras over (finite enumerated fields and subquotients of monoids and quotients of semigroups) and Category of infinite sets
Got:
    Category of enumerated euclidean domains
**********************************************************************
File "src/sage/structure/parent_gens.pyx", line 317, in sage.structure.parent_gens.ParentWithGens.gens.hom
Failed example:
    f(-1)
Expected:
    0
Got:
    4
**********************************************************************
```

And the flag is red for non_ascii and pyflakes but I don't understand what's wrong.



---

archive/issue_comments_495435.json:
```json
{
    "body": "Changing branch from \"u/roed/26105_base_hom\" to \"u/caruso/26105_base_hom\"",
    "created_at": "2019-10-06T19:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495435",
    "user": "https://github.com/xcaruso"
}
```

Changing branch from "u/roed/26105_base_hom" to "u/caruso/26105_base_hom"



---

archive/issue_comments_495436.json:
```json
{
    "body": "Changing commit from \"bfcbebefa46b2e5f4845a73b848c3771fad1fcd5\" to \"626f4ca244b2f87ce0838cba554244cc7ac037f0\"",
    "created_at": "2019-10-06T19:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495436",
    "user": "https://github.com/xcaruso"
}
```

Changing commit from "bfcbebefa46b2e5f4845a73b848c3771fad1fcd5" to "626f4ca244b2f87ce0838cba554244cc7ac037f0"



---

archive/issue_comments_495437.json:
```json
{
    "body": "<a id='comment:40'></a>\nI've just updated the doctest.\n\nIf you agree with my changes, please give a positive review.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|\n|[a62a47c](https://github.com/sagemath/sagetrac-mirror/commit/a62a47caf0630aa46f2a832f77276392cbb61633)|`Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom`|\n|[5324a83](https://github.com/sagemath/sagetrac-mirror/commit/5324a83022777dc347e6ac529c052760c6627e4f)|`Merge branch 'develop' into base_hom`|\n|[2f526f8](https://github.com/sagemath/sagetrac-mirror/commit/2f526f8ee20b2a5182b8e86169dcace69f3575c1)|`Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom`|\n|[3705163](https://github.com/sagemath/sagetrac-mirror/commit/37051638b7117dbac7cdf23d8351638eaa008abf)|`Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom`|\n|[243e72a](https://github.com/sagemath/sagetrac-mirror/commit/243e72ada852ff1d95b4b7d4f6ee62809fe2c18d)|`Merge branch 'develop' into base_hom`|\n|[626f4ca](https://github.com/sagemath/sagetrac-mirror/commit/626f4ca244b2f87ce0838cba554244cc7ac037f0)|`fix doctest`|",
    "created_at": "2019-10-06T19:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495437",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:40'></a>
I've just updated the doctest.

If you agree with my changes, please give a positive review.

---
New commits:
|                                                                                                                                          |                                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
|[a62a47c](https://github.com/sagemath/sagetrac-mirror/commit/a62a47caf0630aa46f2a832f77276392cbb61633)|`Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom`|
|[5324a83](https://github.com/sagemath/sagetrac-mirror/commit/5324a83022777dc347e6ac529c052760c6627e4f)|`Merge branch 'develop' into base_hom`|
|[2f526f8](https://github.com/sagemath/sagetrac-mirror/commit/2f526f8ee20b2a5182b8e86169dcace69f3575c1)|`Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom`|
|[3705163](https://github.com/sagemath/sagetrac-mirror/commit/37051638b7117dbac7cdf23d8351638eaa008abf)|`Merge branch 'u/roed/26105_base_hom' of git://trac.sagemath.org/sage into base_hom`|
|[243e72a](https://github.com/sagemath/sagetrac-mirror/commit/243e72ada852ff1d95b4b7d4f6ee62809fe2c18d)|`Merge branch 'develop' into base_hom`|
|[626f4ca](https://github.com/sagemath/sagetrac-mirror/commit/626f4ca244b2f87ce0838cba554244cc7ac037f0)|`fix doctest`|



---

archive/issue_comments_495438.json:
```json
{
    "body": "<a id='comment:41'></a>\nLooks good to me.",
    "created_at": "2019-10-10T19:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495438",
    "user": "https://github.com/roed314"
}
```

<a id='comment:41'></a>
Looks good to me.



---

archive/issue_comments_495439.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-10T19:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495439",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_081862.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-11T12:08:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26105#event-81862"
}
```



---

archive/issue_comments_495440.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-12T22:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495440",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_495441.json:
```json
{
    "body": "Changing branch from \"u/caruso/26105_base_hom\" to \"626f4ca244b2f87ce0838cba554244cc7ac037f0\"",
    "created_at": "2019-10-12T22:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26105#issuecomment-495441",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/caruso/26105_base_hom" to "626f4ca244b2f87ce0838cba554244cc7ac037f0"



---

archive/issue_events_081863.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-12T22:12:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26105",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26105#event-81863"
}
```
