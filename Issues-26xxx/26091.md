# Issue 26091: py3: hash for projective space

archive/issues_025854.json:
```json
{
    "body": "part of #24551\n\nCC:  tmonteil @tscrim\n\nReviewer: Julian R\u00fcth, Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nBranch: a3bddad41a19d480475cdc761403d4b0b9d796b7\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26091\n\n",
    "closed_at": "2018-09-09T07:38:40Z",
    "created_at": "2018-08-19T07:07:55Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "py3: hash for projective space",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26091",
    "user": "https://github.com/fchapoton"
}
```
part of #24551

CC:  tmonteil @tscrim

Reviewer: Julian Rüth, Travis Scrimshaw

Author: Frédéric Chapoton

Branch: a3bddad41a19d480475cdc761403d4b0b9d796b7

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26091





---

archive/issue_comments_388236.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-19T07:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388236",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_388237.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-08-19T07:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388237",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_388238.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-19T09:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_388239.json:
```json
{
    "body": "<a id='comment:3'></a>`@`tmonteil, could you please help me fix the 32 bits hash, by running the following doctest with this branch on your 32 bit machine and reporting the result ?\n\n```\n            sage: P.<x,y> = ProjectiveSpace(Zmod(10), 1)\n            sage: hash(P([2, 5]))\n            -479010389                     # 32-bit\n```",
    "created_at": "2018-08-19T09:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388239",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>`@`tmonteil, could you please help me fix the 32 bits hash, by running the following doctest with this branch on your 32 bit machine and reporting the result ?

```
            sage: P.<x,y> = ProjectiveSpace(Zmod(10), 1)
            sage: hash(P([2, 5]))
            -479010389                     # 32-bit
```



---

archive/issue_comments_388240.json:
```json
{
    "body": "<a id='comment:4'></a>I stopped my patchbot and restarted it on this ticket, see https://patchbot.sagemath.org/log/Pending/26091/debian/9.4/i686/4.9.0-6-686/tmonteil-debian-stretch-32/2018-08-19%2011:15:44",
    "created_at": "2018-08-19T11:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388240",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:4'></a>I stopped my patchbot and restarted it on this ticket, see https://patchbot.sagemath.org/log/Pending/26091/debian/9.4/i686/4.9.0-6-686/tmonteil-debian-stretch-32/2018-08-19%2011:15:44



---

archive/issue_comments_388241.json:
```json
{
    "body": "<a id='comment:5'></a>And the result is:\n\n```\nsage -t --long src/sage/schemes/projective/projective_point.py\n**********************************************************************\nFile \"src/sage/schemes/projective/projective_point.py\", line 402, in sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring.__hash__\nFailed example:\n    hash(P([2, 5]))\nExpected:\n    -479010389                     \nGot:\n    -2047536788\n**********************************************************************\n```",
    "created_at": "2018-08-19T15:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388241",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:5'></a>And the result is:

```
sage -t --long src/sage/schemes/projective/projective_point.py
**********************************************************************
File "src/sage/schemes/projective/projective_point.py", line 402, in sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring.__hash__
Failed example:
    hash(P([2, 5]))
Expected:
    -479010389                     
Got:
    -2047536788
**********************************************************************
```



---

archive/issue_comments_388242.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-19T15:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_388243.json:
```json
{
    "body": "<a id='comment:7'></a>Merci beaucoup !",
    "created_at": "2018-08-19T15:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388243",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>Merci beaucoup !



---

archive/issue_comments_388244.json:
```json
{
    "body": "<a id='comment:8'></a>Note that #23807 plans to solve this in a different way by making projective space use `UniqueRepresentation`.",
    "created_at": "2018-08-20T00:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388244",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>Note that #23807 plans to solve this in a different way by making projective space use `UniqueRepresentation`.



---

archive/issue_comments_388245.json:
```json
{
    "body": "<a id='comment:9'></a>Would you mind replacing the `sage: hash(P([2, 5]))` with `sage: hash(P([2, 5])) == hash(P([2, 5]))`? I find these 32/64 bit tests really annoying because you cannot update these easily.",
    "created_at": "2018-08-22T02:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388245",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:9'></a>Would you mind replacing the `sage: hash(P([2, 5]))` with `sage: hash(P([2, 5])) == hash(P([2, 5]))`? I find these 32/64 bit tests really annoying because you cannot update these easily.



---

archive/issue_comments_388246.json:
```json
{
    "body": "<a id='comment:10'></a>If you changed that, it would be a positive review from me. But I haven't looked at #23807, so I leave it to you to figure out whether that one should go in instead.",
    "created_at": "2018-08-22T02:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388246",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:10'></a>If you changed that, it would be a positive review from me. But I haven't looked at #23807, so I leave it to you to figure out whether that one should go in instead.



---

archive/issue_comments_388247.json:
```json
{
    "body": "<a id='comment:11'></a>I expect this to be done and merged before #23807.",
    "created_at": "2018-08-22T03:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388247",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>I expect this to be done and merged before #23807.



---

archive/issue_comments_388248.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-22T06:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388248",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_388249.json:
```json
{
    "body": "<a id='comment:13'></a>done (note that this is a case where the hash does not depend on the point..)",
    "created_at": "2018-08-22T06:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388249",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>done (note that this is a case where the hash does not depend on the point..)



---

archive/issue_comments_388250.json:
```json
{
    "body": "<a id='comment:14'></a>Everything seems to be ok. Positive review, somebody ?",
    "created_at": "2018-08-26T15:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388250",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>Everything seems to be ok. Positive review, somebody ?



---

archive/issue_comments_388251.json:
```json
{
    "body": "<a id='comment:15'></a>review, please",
    "created_at": "2018-08-29T18:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388251",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>review, please



---

archive/issue_comments_388252.json:
```json
{
    "body": "<a id='comment:16'></a>should we wait for #23807 ?",
    "created_at": "2018-09-07T12:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388252",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>should we wait for #23807 ?



---

archive/issue_comments_388253.json:
```json
{
    "body": "<a id='comment:17'></a>No, let's just get this in and rebase #23807 on this.",
    "created_at": "2018-09-07T23:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388253",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>No, let's just get this in and rebase #23807 on this.



---

archive/issue_comments_388254.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-07T23:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388254",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_388255.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-09T07:38:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388255",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065110.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-09T07:38:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26091#event-65110"
}
```



---

archive/issue_comments_388256.json:
```json
{
    "body": "<a id='comment:19'></a>Ah, I just noticed this one.  Thanks.  I was just starting to fix this myself but then I remembered to check first (actually I had already added a hash for this class a while ago, but only as a quick hack--never got around to documenting it or anything, so this is better).",
    "created_at": "2018-09-12T14:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26091#issuecomment-388256",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>Ah, I just noticed this one.  Thanks.  I was just starting to fix this myself but then I remembered to check first (actually I had already added a hash for this class a while ago, but only as a quick hack--never got around to documenting it or anything, so this is better).
