# Issue 26686: sagenb docs fail to build

archive/issues_026449.json:
```json
{
    "body": "Building sage in a clean environment with `make distclean && make`, fails on building the documentation for `sagenb`:\n\n```\nRunning Sphinx v1.7.6\nmaking output directory...\nloading pickled environment... not yet created\nbuilding [mo]: targets for 0 po files that are out of date\nbuilding [html]: targets for 19 source files that are out of date\nupdating environment: 19 added, 0 changed, 0 removed\nreading sources... [  5%] index\nreading sources... [ 10%] misc/introspect\nreading sources... [ 15%] misc/misc\n\nException occurred:\n  File \"sage/misc/lazy_import.pyx\", line 218, in sage.misc.lazy_import.LazyImport._\nget_object (build/cythonized/sage/misc/lazy_import.c:2412)\n    raise RuntimeError(f\"resolving lazy import {self._name} during startup\")\nRuntimeError: resolving lazy import dumps during startup\nThe full traceback has been saved in /tmp/sphinx-err-k0V6v7.log, if you want to report the issue to the developers.\nPlease also report this if it was a user error, so that a better error message can be provided next time.\nA bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!\nmake[4]: *** [Makefile:20: html] Error 2\nmake[4]: Leaving directory '/home/sage/sage-8.4/local/var/tmp/sage/build/sagenb-1.1.1/src/doc'\n```\n\n`make distclean && make sagenb && make` succeeds.\n\nInstalling all the dependencies of `sagelib` before `sagenb` with\n`make distclean && make arb boost_cropped brial bzip2 cddlib cliquer cypari cysignals cython decorator docutils ecl eclib ecm enum34 fflas_ffpack flint fplll freetype gap gc gf2x giac givaro glpk gsl iconv iml ipython_genutils jinja2 jupyter_core lcalc libatomic_ops libbraiding libgap libgd libhomfly libpng linbox lrcalc m4ri m4rie markupsafe mpc mpfi mpfr mpir ncurses ntl numpy openblas pari pari_galdata pari_seadata_small pip pkgconf pkgconfig planarity ppl pycygwin pynac python2 python3 ratpoints readline rw setuptools singular six sqlite symmetrica traitlets xz yasm zlib zn_poly && make sagenb` succeeds.\n\n`make distclean && make sagelib && make sagenb` fails.\n\nThe problem seems to occur if `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.\n\nKeywords: sagenb\n\nReviewer: Dima Pasechnik\n\nAuthor: Konrad K. Dabrowski\n\nBranch: a964c9438de535a4b6b230b80fd80515e57813f1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26686\n\n",
    "closed_at": "2018-11-15T22:57:34Z",
    "created_at": "2018-11-12T17:12:42Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "sagenb docs fail to build",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26686",
    "user": "https://github.com/Konrad127123"
}
```
Building sage in a clean environment with `make distclean && make`, fails on building the documentation for `sagenb`:

```
Running Sphinx v1.7.6
making output directory...
loading pickled environment... not yet created
building [mo]: targets for 0 po files that are out of date
building [html]: targets for 19 source files that are out of date
updating environment: 19 added, 0 changed, 0 removed
reading sources... [  5%] index
reading sources... [ 10%] misc/introspect
reading sources... [ 15%] misc/misc

Exception occurred:
  File "sage/misc/lazy_import.pyx", line 218, in sage.misc.lazy_import.LazyImport._
get_object (build/cythonized/sage/misc/lazy_import.c:2412)
    raise RuntimeError(f"resolving lazy import {self._name} during startup")
RuntimeError: resolving lazy import dumps during startup
The full traceback has been saved in /tmp/sphinx-err-k0V6v7.log, if you want to report the issue to the developers.
Please also report this if it was a user error, so that a better error message can be provided next time.
A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!
make[4]: *** [Makefile:20: html] Error 2
make[4]: Leaving directory '/home/sage/sage-8.4/local/var/tmp/sage/build/sagenb-1.1.1/src/doc'
```

`make distclean && make sagenb && make` succeeds.

Installing all the dependencies of `sagelib` before `sagenb` with
`make distclean && make arb boost_cropped brial bzip2 cddlib cliquer cypari cysignals cython decorator docutils ecl eclib ecm enum34 fflas_ffpack flint fplll freetype gap gc gf2x giac givaro glpk gsl iconv iml ipython_genutils jinja2 jupyter_core lcalc libatomic_ops libbraiding libgap libgd libhomfly libpng linbox lrcalc m4ri m4rie markupsafe mpc mpfi mpfr mpir ncurses ntl numpy openblas pari pari_galdata pari_seadata_small pip pkgconf pkgconfig planarity ppl pycygwin pynac python2 python3 ratpoints readline rw setuptools singular six sqlite symmetrica traitlets xz yasm zlib zn_poly && make sagenb` succeeds.

`make distclean && make sagelib && make sagenb` fails.

The problem seems to occur if `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.

Keywords: sagenb

Reviewer: Dima Pasechnik

Author: Konrad K. Dabrowski

Branch: a964c9438de535a4b6b230b80fd80515e57813f1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26686





---

archive/issue_comments_512781.json:
```json
{
    "body": "Changing branch from \"\" to \"u/Konrad127123/sagenb_docs_fail_to_build\"",
    "created_at": "2018-11-12T17:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512781",
    "user": "https://github.com/Konrad127123"
}
```

Changing branch from "" to "u/Konrad127123/sagenb_docs_fail_to_build"



---

archive/issue_comments_512782.json:
```json
{
    "body": "Changing commit from \"\" to \"a964c9438de535a4b6b230b80fd80515e57813f1\"",
    "created_at": "2018-11-12T17:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512782",
    "user": "https://github.com/Konrad127123"
}
```

Changing commit from "" to "a964c9438de535a4b6b230b80fd80515e57813f1"



---

archive/issue_comments_512783.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -30,4 +30,4 @@\n \n `make distclean && make sagelib && make sagenb` fails.\n \n-The problem seems to be occur `sagenb` is built after `sagelib`, but before $(SAGERUNTIME).\n+The problem seems to be occur `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.\n``````\n",
    "created_at": "2018-11-12T17:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512783",
    "user": "https://github.com/Konrad127123"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -30,4 +30,4 @@
 
 `make distclean && make sagelib && make sagenb` fails.
 
-The problem seems to be occur `sagenb` is built after `sagelib`, but before $(SAGERUNTIME).
+The problem seems to be occur `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.
``````




---

archive/issue_comments_512784.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-12T17:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512784",
    "user": "https://github.com/Konrad127123"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_512785.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[a964c94](https://git.sagemath.org/sage.git/commit?id=a964c9438de535a4b6b230b80fd80515e57813f1)|`sagenb should depend on $(SAGERUNTIME)`|",
    "created_at": "2018-11-12T17:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512785",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[a964c94](https://git.sagemath.org/sage.git/commit?id=a964c9438de535a4b6b230b80fd80515e57813f1)|`sagenb should depend on $(SAGERUNTIME)`|



---

archive/issue_comments_512786.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -30,4 +30,4 @@\n \n `make distclean && make sagelib && make sagenb` fails.\n \n-The problem seems to be occur `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.\n+The problem seems to occur if `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.\n``````\n",
    "created_at": "2018-11-12T17:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512786",
    "user": "https://github.com/Konrad127123"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -30,4 +30,4 @@
 
 `make distclean && make sagelib && make sagenb` fails.
 
-The problem seems to be occur `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.
+The problem seems to occur if `sagenb` is built after `sagelib`, but before `$(SAGERUNTIME)`.
``````




---

archive/issue_comments_512787.json:
```json
{
    "body": "<a id='comment:4'></a>\nAlso possibly worth noting: building all the packages that `sagenb` and `$(SAGERUNTIME)` depend on without actually building `$(SAGERUNTIME)` is not sufficient, so it looks like `$(SAGERUNTIME)` really is the minimal dependency that needs to be added.\n\ni.e. doing `make distclean && make alabaster appnope arb babel backports_abc backports_shutil_get_terminal_size backports_ssl_match_hostname boost_cropped brial bzip2 cddlib certifi cliquer cypari cysignals cython decorator docutils ecl eclib ecm enum34 fflas_ffpack flask flask_autoindex flask_babel flask_oldsessions flask_openid flask_silk flint fplll freetype future gap gc gf2x giac givaro glpk gsl iconv imagesize iml ipython ipython_genutils itsdangerous jinja2 jupyter_core lcalc libatomic_ops libbraiding libgap libgd libhomfly libpng linbox lrcalc m4ri m4rie markupsafe mathjax mpc mpfi mpfr mpir ncurses ntl numpy openblas packaging pari pari_galdata pari_seadata_small pathlib2 pathpy pexpect pickleshare pip pkgconf pkgconfig planarity ppl prompt_toolkit psutil ptyprocess pycygwin pygments pynac pyparsing python2 python3 python_openid pytz pyzmq ratpoints readline requests rw sagelib scandir setuptools setuptools_scm simplegeneric singledispatch singular six snowballstemmer speaklater sphinx sphinxcontrib_websupport sqlite symmetrica tornado traitlets twisted typing wcwidth werkzeug xz yasm zeromq zlib zn_poly zope_interface && make sagenb` still fails, although it fails slightly later:\n\n```\n[sagenb-1.1.1] Running Sphinx v1.7.6\n[sagenb-1.1.1] making output directory...\n[sagenb-1.1.1] loading pickled environment... not yet created\n[sagenb-1.1.1] building [mo]: targets for 0 po files that are out of date\n[sagenb-1.1.1] building [html]: targets for 19 source files that are out of date\n[sagenb-1.1.1] updating environment: 19 added, 0 changed, 0 removed\n[sagenb-1.1.1] reading sources... [  5%] index\n[sagenb-1.1.1] reading sources... [ 10%] misc/introspect\n[sagenb-1.1.1] reading sources... [ 15%] misc/misc\n[sagenb-1.1.1] reading sources... [ 21%] misc/sageinspect\n[sagenb-1.1.1] reading sources... [ 26%] misc/sphinxify\n[sagenb-1.1.1] reading sources... [ 31%] misc/support\n[sagenb-1.1.1] reading sources... [ 36%] notebook/cell\n[sagenb-1.1.1] reading sources... [ 42%] notebook/challenge\n[sagenb-1.1.1] reading sources... [ 47%] notebook/config\n[sagenb-1.1.1] reading sources... [ 52%] notebook/css\n[sagenb-1.1.1] reading sources... [ 57%] notebook/docHTMLProcessor\n[sagenb-1.1.1] reading sources... [ 63%] notebook/interact\n[sagenb-1.1.1] reading sources... [ 68%] notebook/js\n[sagenb-1.1.1] reading sources... [ 73%] notebook/notebook\n[sagenb-1.1.1] WARNING: autodoc: failed to import module u'sagenb.misc.introspect'; the following exception was raised:\n[sagenb-1.1.1] Traceback (most recent call last):\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sphinx/ext/autodoc/importer.py\", line 152, in import_module\n[sagenb-1.1.1]     __import__(modname)\n[sagenb-1.1.1]   File \"../sagenb/__init__.py\", line 3, in <module>\n[sagenb-1.1.1]     from . import storage\n[sagenb-1.1.1]   File \"../sagenb/storage/__init__.py\", line 3, in <module>\n[sagenb-1.1.1]     from .filesystem_storage import FilesystemDatastore\n[sagenb-1.1.1]   File \"../sagenb/storage/filesystem_storage.py\", line 52, in <module>\n[sagenb-1.1.1]     from sagenb.misc.misc import set_restrictive_permissions, encoded_str\n[sagenb-1.1.1]   File \"../sagenb/misc/misc.py\", line 216, in <module>\n[sagenb-1.1.1]     import sage.all\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/all.py\", line 83, in <module>\n[sagenb-1.1.1]     from sage.misc.all       import *         # takes a while\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/misc/all.py\", line 84, in <module>\n[sagenb-1.1.1]     from .functional import (additive_order,\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/misc/functional.py\", line 27, in <module>\n[sagenb-1.1.1]     from sage.rings.complex_double import CDF\n[sagenb-1.1.1]   File \"sage/rings/complex_double.pyx\", line 101, in init sage.rings.complex_double (build/cythonized/sage/rings/complex_double.c:24114)\n[sagenb-1.1.1]     cdef CC = ComplexField()\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/complex_field.py\", line 114, in ComplexField\n[sagenb-1.1.1]     C = ComplexField_class(prec)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/complex_field.py\", line 208, in __init__\n[sagenb-1.1.1]     self._populate_coercion_lists_(coerce_list=[RRtoCC(self._real_field(), self)])\n[sagenb-1.1.1]   File \"sage/rings/complex_number.pyx\", line 2580, in sage.rings.complex_number.RRtoCC.__init__ (build/cythonized/sage/rings/complex_number.c:21896)\n[sagenb-1.1.1]     Map.__init__(self, RR, CC)\n[sagenb-1.1.1]   File \"sage/categories/map.pyx\", line 125, in sage.categories.map.Map.__init__ (build/cythonized/sage/categories/map.c:3588)\n[sagenb-1.1.1]     parent = homset.Hom(parent, codomain)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/categories/homset.py\", line 397, in Hom\n[sagenb-1.1.1]     H = Hom(X, Y, category, check=False)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/categories/homset.py\", line 424, in Hom\n[sagenb-1.1.1]     H = X._Hom_(Y, category)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/categories/rings.py\", line 361, in _Hom_\n[sagenb-1.1.1]     from sage.rings.homset import RingHomset\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/homset.py\", line 19, in <module>\n[sagenb-1.1.1]     from . import quotient_ring\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py\", line 116, in <module>\n[sagenb-1.1.1]     import sage.rings.polynomial.multi_polynomial_ideal\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 239, in <module>\n[sagenb-1.1.1]     from sage.interfaces.all import (singular as singular_default,\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/all.py\", line 24, in <module>\n[sagenb-1.1.1]     from .maxima import maxima, Maxima\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py\", line 1238, in <module>\n[sagenb-1.1.1]     script_subdirectory=None)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py\", line 529, in __init__\n[sagenb-1.1.1]     raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')\n[sagenb-1.1.1] RuntimeError: You must get the file local/bin/sage-maxima.lisp\n[sagenb-1.1.1]\n[sagenb-1.1.1] WARNING: autodoc: failed to import module u'sagenb.misc.misc'; the following exception was raised:\n[sagenb-1.1.1] Traceback (most recent call last):\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sphinx/ext/autodoc/importer.py\", line 152, in import_module\n[sagenb-1.1.1]     __import__(modname)\n[sagenb-1.1.1]   File \"../sagenb/__init__.py\", line 3, in <module>\n[sagenb-1.1.1]     from . import storage\n[sagenb-1.1.1]   File \"../sagenb/storage/__init__.py\", line 3, in <module>\n[sagenb-1.1.1]     from .filesystem_storage import FilesystemDatastore\n[sagenb-1.1.1]   File \"../sagenb/storage/filesystem_storage.py\", line 52, in <module>\n[sagenb-1.1.1]     from sagenb.misc.misc import set_restrictive_permissions, encoded_str\n[sagenb-1.1.1]   File \"../sagenb/misc/misc.py\", line 352, in <module>\n[sagenb-1.1.1]     from sage.plot.colors import Color\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/plot/__init__.py\", line 2, in <module>\n[sagenb-1.1.1]     from . import all\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/plot/all.py\", line 3, in <module>\n[sagenb-1.1.1]     from .plot import plot, graphics_array, list_plot, parametric_plot, polar_plot\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/plot/plot.py\", line 577, in <module>\n[sagenb-1.1.1]     from sage.ext.fast_eval import fast_float, is_fast_float\n[sagenb-1.1.1]   File \"sage/ext/fast_eval.pyx\", line 93, in init sage.ext.fast_eval (build/cythonized/sage/ext/fast_eval.c:14529)\n[sagenb-1.1.1]     from sage.ext.fast_callable import fast_callable, Wrapper\n[sagenb-1.1.1]   File \"sage/ext/fast_callable.pyx\", line 308, in init sage.ext.fast_callable (build/cythonized/sage/ext/fast_callable.c:20784)\n[sagenb-1.1.1]     from sage.rings.all import RDF, CDF\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/all.py\", line 31, in <module>\n[sagenb-1.1.1]     from .quotient_ring import QuotientRing\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py\", line 116, in <module>\n[sagenb-1.1.1]     import sage.rings.polynomial.multi_polynomial_ideal\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 239, in <module>\n[sagenb-1.1.1]     from sage.interfaces.all import (singular as singular_default,\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/all.py\", line 24, in <module>\n[sagenb-1.1.1]     from .maxima import maxima, Maxima\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py\", line 1238, in <module>\n[sagenb-1.1.1]     script_subdirectory=None)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py\", line 529, in __init__\n[sagenb-1.1.1]     raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')\n[sagenb-1.1.1] RuntimeError: You must get the file local/bin/sage-maxima.lisp\n[sagenb-1.1.1]\n[sagenb-1.1.1] WARNING: autodoc: failed to import module u'sagenb.misc.support'; the following exception was raised:\n[sagenb-1.1.1] Traceback (most recent call last):\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sphinx/ext/autodoc/importer.py\", line 152, in import_module\n[sagenb-1.1.1]     __import__(modname)\n[sagenb-1.1.1]   File \"../sagenb/misc/support.py\", line 525, in <module>\n[sagenb-1.1.1]     from sage.symbolic.all import Expression, SR\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/symbolic/all.py\", line 3, in <module>\n[sagenb-1.1.1]     from sage.libs.pynac.pynac import I\n[sagenb-1.1.1]   File \"sage/symbolic/expression.pxd\", line 4, in init sage.libs.pynac.pynac (build/cythonized/sage/libs/pynac/pynac.cpp:31945)\n[sagenb-1.1.1]     cdef class Expression(CommutativeRingElement):\n[sagenb-1.1.1]   File \"sage/symbolic/expression.pyx\", line 161, in init sage.symbolic.expression (build/cythonized/sage/symbolic/expression.cpp:80707)\n[sagenb-1.1.1]     from . import ring\n[sagenb-1.1.1]   File \"sage/symbolic/ring.pyx\", line 32, in init sage.symbolic.ring (build/cythonized/sage/symbolic/ring.cpp:16908)\n[sagenb-1.1.1]     from sage.rings.all import RR, CC, ZZ\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/all.py\", line 31, in <module>\n[sagenb-1.1.1]     from .quotient_ring import QuotientRing\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py\", line 116, in <module>\n[sagenb-1.1.1]     import sage.rings.polynomial.multi_polynomial_ideal\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 239, in <module>\n[sagenb-1.1.1]     from sage.interfaces.all import (singular as singular_default,\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/all.py\", line 24, in <module>\n[sagenb-1.1.1]     from .maxima import maxima, Maxima\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py\", line 1238, in <module>\n[sagenb-1.1.1]     script_subdirectory=None)\n[sagenb-1.1.1]   File \"/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py\", line 529, in __init__\n[sagenb-1.1.1]     raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')\n[sagenb-1.1.1] RuntimeError: You must get the file local/bin/sage-maxima.lisp\n[sagenb-1.1.1]\n[sagenb-1.1.1]\n[sagenb-1.1.1] Exception occurred:\n[sagenb-1.1.1]   File \"sage/misc/lazy_import.pyx\", line 218, in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2412)\n[sagenb-1.1.1]     raise RuntimeError(f\"resolving lazy import {self._name} during startup\")\n[sagenb-1.1.1] RuntimeError: resolving lazy import load during startup\n[sagenb-1.1.1] The full traceback has been saved in /tmp/sphinx-err-JkWjJW.log, if you want to report the issue to the developers.\n[sagenb-1.1.1] Please also report this if it was a user error, so that a better error message can be provided next time.\n[sagenb-1.1.1] A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!\n[sagenb-1.1.1] make[2]: *** [Makefile:20: html] Error 2\n[sagenb-1.1.1] make[2]: Leaving directory '/home/sage/sage-8.4/local/var/tmp/sage/build/sagenb-1.1.1/src/doc'\n```",
    "created_at": "2018-11-12T22:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512787",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:4'></a>
Also possibly worth noting: building all the packages that `sagenb` and `$(SAGERUNTIME)` depend on without actually building `$(SAGERUNTIME)` is not sufficient, so it looks like `$(SAGERUNTIME)` really is the minimal dependency that needs to be added.

i.e. doing `make distclean && make alabaster appnope arb babel backports_abc backports_shutil_get_terminal_size backports_ssl_match_hostname boost_cropped brial bzip2 cddlib certifi cliquer cypari cysignals cython decorator docutils ecl eclib ecm enum34 fflas_ffpack flask flask_autoindex flask_babel flask_oldsessions flask_openid flask_silk flint fplll freetype future gap gc gf2x giac givaro glpk gsl iconv imagesize iml ipython ipython_genutils itsdangerous jinja2 jupyter_core lcalc libatomic_ops libbraiding libgap libgd libhomfly libpng linbox lrcalc m4ri m4rie markupsafe mathjax mpc mpfi mpfr mpir ncurses ntl numpy openblas packaging pari pari_galdata pari_seadata_small pathlib2 pathpy pexpect pickleshare pip pkgconf pkgconfig planarity ppl prompt_toolkit psutil ptyprocess pycygwin pygments pynac pyparsing python2 python3 python_openid pytz pyzmq ratpoints readline requests rw sagelib scandir setuptools setuptools_scm simplegeneric singledispatch singular six snowballstemmer speaklater sphinx sphinxcontrib_websupport sqlite symmetrica tornado traitlets twisted typing wcwidth werkzeug xz yasm zeromq zlib zn_poly zope_interface && make sagenb` still fails, although it fails slightly later:

```
[sagenb-1.1.1] Running Sphinx v1.7.6
[sagenb-1.1.1] making output directory...
[sagenb-1.1.1] loading pickled environment... not yet created
[sagenb-1.1.1] building [mo]: targets for 0 po files that are out of date
[sagenb-1.1.1] building [html]: targets for 19 source files that are out of date
[sagenb-1.1.1] updating environment: 19 added, 0 changed, 0 removed
[sagenb-1.1.1] reading sources... [  5%] index
[sagenb-1.1.1] reading sources... [ 10%] misc/introspect
[sagenb-1.1.1] reading sources... [ 15%] misc/misc
[sagenb-1.1.1] reading sources... [ 21%] misc/sageinspect
[sagenb-1.1.1] reading sources... [ 26%] misc/sphinxify
[sagenb-1.1.1] reading sources... [ 31%] misc/support
[sagenb-1.1.1] reading sources... [ 36%] notebook/cell
[sagenb-1.1.1] reading sources... [ 42%] notebook/challenge
[sagenb-1.1.1] reading sources... [ 47%] notebook/config
[sagenb-1.1.1] reading sources... [ 52%] notebook/css
[sagenb-1.1.1] reading sources... [ 57%] notebook/docHTMLProcessor
[sagenb-1.1.1] reading sources... [ 63%] notebook/interact
[sagenb-1.1.1] reading sources... [ 68%] notebook/js
[sagenb-1.1.1] reading sources... [ 73%] notebook/notebook
[sagenb-1.1.1] WARNING: autodoc: failed to import module u'sagenb.misc.introspect'; the following exception was raised:
[sagenb-1.1.1] Traceback (most recent call last):
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sphinx/ext/autodoc/importer.py", line 152, in import_module
[sagenb-1.1.1]     __import__(modname)
[sagenb-1.1.1]   File "../sagenb/__init__.py", line 3, in <module>
[sagenb-1.1.1]     from . import storage
[sagenb-1.1.1]   File "../sagenb/storage/__init__.py", line 3, in <module>
[sagenb-1.1.1]     from .filesystem_storage import FilesystemDatastore
[sagenb-1.1.1]   File "../sagenb/storage/filesystem_storage.py", line 52, in <module>
[sagenb-1.1.1]     from sagenb.misc.misc import set_restrictive_permissions, encoded_str
[sagenb-1.1.1]   File "../sagenb/misc/misc.py", line 216, in <module>
[sagenb-1.1.1]     import sage.all
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/all.py", line 83, in <module>
[sagenb-1.1.1]     from sage.misc.all       import *         # takes a while
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/misc/all.py", line 84, in <module>
[sagenb-1.1.1]     from .functional import (additive_order,
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/misc/functional.py", line 27, in <module>
[sagenb-1.1.1]     from sage.rings.complex_double import CDF
[sagenb-1.1.1]   File "sage/rings/complex_double.pyx", line 101, in init sage.rings.complex_double (build/cythonized/sage/rings/complex_double.c:24114)
[sagenb-1.1.1]     cdef CC = ComplexField()
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/complex_field.py", line 114, in ComplexField
[sagenb-1.1.1]     C = ComplexField_class(prec)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/complex_field.py", line 208, in __init__
[sagenb-1.1.1]     self._populate_coercion_lists_(coerce_list=[RRtoCC(self._real_field(), self)])
[sagenb-1.1.1]   File "sage/rings/complex_number.pyx", line 2580, in sage.rings.complex_number.RRtoCC.__init__ (build/cythonized/sage/rings/complex_number.c:21896)
[sagenb-1.1.1]     Map.__init__(self, RR, CC)
[sagenb-1.1.1]   File "sage/categories/map.pyx", line 125, in sage.categories.map.Map.__init__ (build/cythonized/sage/categories/map.c:3588)
[sagenb-1.1.1]     parent = homset.Hom(parent, codomain)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/categories/homset.py", line 397, in Hom
[sagenb-1.1.1]     H = Hom(X, Y, category, check=False)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/categories/homset.py", line 424, in Hom
[sagenb-1.1.1]     H = X._Hom_(Y, category)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/categories/rings.py", line 361, in _Hom_
[sagenb-1.1.1]     from sage.rings.homset import RingHomset
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/homset.py", line 19, in <module>
[sagenb-1.1.1]     from . import quotient_ring
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py", line 116, in <module>
[sagenb-1.1.1]     import sage.rings.polynomial.multi_polynomial_ideal
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 239, in <module>
[sagenb-1.1.1]     from sage.interfaces.all import (singular as singular_default,
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/all.py", line 24, in <module>
[sagenb-1.1.1]     from .maxima import maxima, Maxima
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py", line 1238, in <module>
[sagenb-1.1.1]     script_subdirectory=None)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py", line 529, in __init__
[sagenb-1.1.1]     raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')
[sagenb-1.1.1] RuntimeError: You must get the file local/bin/sage-maxima.lisp
[sagenb-1.1.1]
[sagenb-1.1.1] WARNING: autodoc: failed to import module u'sagenb.misc.misc'; the following exception was raised:
[sagenb-1.1.1] Traceback (most recent call last):
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sphinx/ext/autodoc/importer.py", line 152, in import_module
[sagenb-1.1.1]     __import__(modname)
[sagenb-1.1.1]   File "../sagenb/__init__.py", line 3, in <module>
[sagenb-1.1.1]     from . import storage
[sagenb-1.1.1]   File "../sagenb/storage/__init__.py", line 3, in <module>
[sagenb-1.1.1]     from .filesystem_storage import FilesystemDatastore
[sagenb-1.1.1]   File "../sagenb/storage/filesystem_storage.py", line 52, in <module>
[sagenb-1.1.1]     from sagenb.misc.misc import set_restrictive_permissions, encoded_str
[sagenb-1.1.1]   File "../sagenb/misc/misc.py", line 352, in <module>
[sagenb-1.1.1]     from sage.plot.colors import Color
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/plot/__init__.py", line 2, in <module>
[sagenb-1.1.1]     from . import all
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/plot/all.py", line 3, in <module>
[sagenb-1.1.1]     from .plot import plot, graphics_array, list_plot, parametric_plot, polar_plot
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/plot/plot.py", line 577, in <module>
[sagenb-1.1.1]     from sage.ext.fast_eval import fast_float, is_fast_float
[sagenb-1.1.1]   File "sage/ext/fast_eval.pyx", line 93, in init sage.ext.fast_eval (build/cythonized/sage/ext/fast_eval.c:14529)
[sagenb-1.1.1]     from sage.ext.fast_callable import fast_callable, Wrapper
[sagenb-1.1.1]   File "sage/ext/fast_callable.pyx", line 308, in init sage.ext.fast_callable (build/cythonized/sage/ext/fast_callable.c:20784)
[sagenb-1.1.1]     from sage.rings.all import RDF, CDF
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/all.py", line 31, in <module>
[sagenb-1.1.1]     from .quotient_ring import QuotientRing
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py", line 116, in <module>
[sagenb-1.1.1]     import sage.rings.polynomial.multi_polynomial_ideal
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 239, in <module>
[sagenb-1.1.1]     from sage.interfaces.all import (singular as singular_default,
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/all.py", line 24, in <module>
[sagenb-1.1.1]     from .maxima import maxima, Maxima
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py", line 1238, in <module>
[sagenb-1.1.1]     script_subdirectory=None)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py", line 529, in __init__
[sagenb-1.1.1]     raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')
[sagenb-1.1.1] RuntimeError: You must get the file local/bin/sage-maxima.lisp
[sagenb-1.1.1]
[sagenb-1.1.1] WARNING: autodoc: failed to import module u'sagenb.misc.support'; the following exception was raised:
[sagenb-1.1.1] Traceback (most recent call last):
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sphinx/ext/autodoc/importer.py", line 152, in import_module
[sagenb-1.1.1]     __import__(modname)
[sagenb-1.1.1]   File "../sagenb/misc/support.py", line 525, in <module>
[sagenb-1.1.1]     from sage.symbolic.all import Expression, SR
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/symbolic/all.py", line 3, in <module>
[sagenb-1.1.1]     from sage.libs.pynac.pynac import I
[sagenb-1.1.1]   File "sage/symbolic/expression.pxd", line 4, in init sage.libs.pynac.pynac (build/cythonized/sage/libs/pynac/pynac.cpp:31945)
[sagenb-1.1.1]     cdef class Expression(CommutativeRingElement):
[sagenb-1.1.1]   File "sage/symbolic/expression.pyx", line 161, in init sage.symbolic.expression (build/cythonized/sage/symbolic/expression.cpp:80707)
[sagenb-1.1.1]     from . import ring
[sagenb-1.1.1]   File "sage/symbolic/ring.pyx", line 32, in init sage.symbolic.ring (build/cythonized/sage/symbolic/ring.cpp:16908)
[sagenb-1.1.1]     from sage.rings.all import RR, CC, ZZ
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/all.py", line 31, in <module>
[sagenb-1.1.1]     from .quotient_ring import QuotientRing
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py", line 116, in <module>
[sagenb-1.1.1]     import sage.rings.polynomial.multi_polynomial_ideal
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 239, in <module>
[sagenb-1.1.1]     from sage.interfaces.all import (singular as singular_default,
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/all.py", line 24, in <module>
[sagenb-1.1.1]     from .maxima import maxima, Maxima
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py", line 1238, in <module>
[sagenb-1.1.1]     script_subdirectory=None)
[sagenb-1.1.1]   File "/home/sage/sage-8.4/local/lib/python2.7/site-packages/sage/interfaces/maxima.py", line 529, in __init__
[sagenb-1.1.1]     raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')
[sagenb-1.1.1] RuntimeError: You must get the file local/bin/sage-maxima.lisp
[sagenb-1.1.1]
[sagenb-1.1.1]
[sagenb-1.1.1] Exception occurred:
[sagenb-1.1.1]   File "sage/misc/lazy_import.pyx", line 218, in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2412)
[sagenb-1.1.1]     raise RuntimeError(f"resolving lazy import {self._name} during startup")
[sagenb-1.1.1] RuntimeError: resolving lazy import load during startup
[sagenb-1.1.1] The full traceback has been saved in /tmp/sphinx-err-JkWjJW.log, if you want to report the issue to the developers.
[sagenb-1.1.1] Please also report this if it was a user error, so that a better error message can be provided next time.
[sagenb-1.1.1] A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!
[sagenb-1.1.1] make[2]: *** [Makefile:20: html] Error 2
[sagenb-1.1.1] make[2]: Leaving directory '/home/sage/sage-8.4/local/var/tmp/sage/build/sagenb-1.1.1/src/doc'
```



---

archive/issue_comments_512788.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2018-11-12T23:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512788",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_512789.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-12T23:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512789",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_512790.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks, this appears to work for me.",
    "created_at": "2018-11-12T23:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512790",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
Thanks, this appears to work for me.



---

archive/issue_comments_512791.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2018-11-13T10:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512791",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_512792.json:
```json
{
    "body": "<a id='comment:7'></a>\n+1 Haven't tested this but this looks like the right fix to me.",
    "created_at": "2018-11-13T16:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512792",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
+1 Haven't tested this but this looks like the right fix to me.



---

archive/issue_events_066139.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-15T22:57:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26686#event-66139"
}
```



---

archive/issue_comments_512793.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-11-15T22:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512793",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_512794.json:
```json
{
    "body": "Changing branch from \"u/Konrad127123/sagenb_docs_fail_to_build\" to \"a964c9438de535a4b6b230b80fd80515e57813f1\"",
    "created_at": "2018-11-15T22:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512794",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/Konrad127123/sagenb_docs_fail_to_build" to "a964c9438de535a4b6b230b80fd80515e57813f1"



---

archive/issue_comments_512795.json:
```json
{
    "body": "Changing commit from \"a964c9438de535a4b6b230b80fd80515e57813f1\" to \"\"",
    "created_at": "2019-02-04T16:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512795",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing commit from "a964c9438de535a4b6b230b80fd80515e57813f1" to ""



---

archive/issue_comments_512796.json:
```json
{
    "body": "<a id='comment:9'></a>\nApparently, this is not the right fix. I fall into this issue while trying to build SDL for 8.6 (for which the patch is applied).\n\nNote that i manually disabled the build of openblas to fix some other issue, but i guess this should not be related.\n\nLet me attach two logs in attachment.",
    "created_at": "2019-02-04T16:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512796",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:9'></a>
Apparently, this is not the right fix. I fall into this issue while trying to build SDL for 8.6 (for which the patch is applied).

Note that i manually disabled the build of openblas to fix some other issue, but i guess this should not be related.

Let me attach two logs in attachment.



---

archive/issue_comments_512797.json:
```json
{
    "body": "Attachment [sagenb-1.1.1.log](tarball://root/attachments/some-uuid/ticket26686/sagenb-1.1.1.log) by tmonteil created at 2019-02-04 16:36:40",
    "created_at": "2019-02-04T16:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512797",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Attachment [sagenb-1.1.1.log](tarball://root/attachments/some-uuid/ticket26686/sagenb-1.1.1.log) by tmonteil created at 2019-02-04 16:36:40



---

archive/issue_comments_512798.json:
```json
{
    "body": "<a id='comment:10'></a>\nAttachment [sphinx-err-m94TqC.log](tarball://root/attachments/some-uuid/ticket26686/sphinx-err-m94TqC.log) by @dimpase created at 2019-02-04 16:49:29\n\nThis error means that your sagelib is broken.\n(I have seen such errors, and they always boiled down to this).\nCan you start Sage?",
    "created_at": "2019-02-04T16:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512798",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
Attachment [sphinx-err-m94TqC.log](tarball://root/attachments/some-uuid/ticket26686/sphinx-err-m94TqC.log) by @dimpase created at 2019-02-04 16:49:29

This error means that your sagelib is broken.
(I have seen such errors, and they always boiled down to this).
Can you start Sage?



---

archive/issue_comments_512799.json:
```json
{
    "body": "<a id='comment:11'></a>\nIt might be a bug in Sage's handling of dependencies, but I am not sure. Indeed, `$(SAGERUNTIME)` is a dependency of sagenb,",
    "created_at": "2019-02-04T16:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512799",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
It might be a bug in Sage's handling of dependencies, but I am not sure. Indeed, `$(SAGERUNTIME)` is a dependency of sagenb,



---

archive/issue_comments_512800.json:
```json
{
    "body": "<a id='comment:12'></a>\nNote that $(SAGERUNTIME) is not a dependency of sphinx, which sounds fishy. Can you add it to its dependencies and try again?",
    "created_at": "2019-02-04T16:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512800",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>
Note that $(SAGERUNTIME) is not a dependency of sphinx, which sounds fishy. Can you add it to its dependencies and try again?



---

archive/issue_comments_512801.json:
```json
{
    "body": "log of the sagenb buid with Sage 8.6",
    "created_at": "2019-02-04T18:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512801",
    "user": "https://github.com/zimmermann6"
}
```

log of the sagenb buid with Sage 8.6



---

archive/issue_comments_512802.json:
```json
{
    "body": "<a id='comment:13'></a>\nAttachment [sagenb-1.1.1.log.pz](tarball://root/attachments/some-uuid/ticket26686/sagenb-1.1.1.log.pz) by @zimmermann6 created at 2019-02-04 18:40:17\n\nI did hit this error while building sage-8.6 from source on my laptop (Intel(R) Core(TM) i5-6300U under Ubuntu 16.04. I did attach the log file `sagenb-1.1.1.log.pz`.\n\nPaul Zimmermann",
    "created_at": "2019-02-04T18:40:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512802",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:13'></a>
Attachment [sagenb-1.1.1.log.pz](tarball://root/attachments/some-uuid/ticket26686/sagenb-1.1.1.log.pz) by @zimmermann6 created at 2019-02-04 18:40:17

I did hit this error while building sage-8.6 from source on my laptop (Intel(R) Core(TM) i5-6300U under Ubuntu 16.04. I did attach the log file `sagenb-1.1.1.log.pz`.

Paul Zimmermann



---

archive/issue_comments_512803.json:
```json
{
    "body": "<a id='comment:14'></a>\nI'm unable to reproduce this bug using `make -j1` or `make -j1 sagenb`. Does it still occur with 8.7.beta3?\n\nIf so, please could you open a new ticket to avoid confusion with the original bug (the original bug was fixed, so this looks like a separate issue, albeit one which causes the same error). Could you also include a list of the files in `logs/pkgs` when the build fails?",
    "created_at": "2019-02-11T12:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512803",
    "user": "https://github.com/Konrad127123"
}
```

<a id='comment:14'></a>
I'm unable to reproduce this bug using `make -j1` or `make -j1 sagenb`. Does it still occur with 8.7.beta3?

If so, please could you open a new ticket to avoid confusion with the original bug (the original bug was fixed, so this looks like a separate issue, albeit one which causes the same error). Could you also include a list of the files in `logs/pkgs` when the build fails?



---

archive/issue_comments_512804.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [zimmerma](#comment%3A13):\n> I did hit this error while building sage-8.6 from source on my laptop (Intel(R) Core(TM) i5-6300U under Ubuntu 16.04. I did attach the log file `sagenb-1.1.1.log.pz`.\n\n\nthis looks as if the problem was earlier with building sagelib itself; as sagelib\nis needed to build sagenb docs, it should work.\nDoes starting Sage work?",
    "created_at": "2019-02-11T13:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512804",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>
Replying to [zimmerma](#comment%3A13):
> I did hit this error while building sage-8.6 from source on my laptop (Intel(R) Core(TM) i5-6300U under Ubuntu 16.04. I did attach the log file `sagenb-1.1.1.log.pz`.


this looks as if the problem was earlier with building sagelib itself; as sagelib
is needed to build sagenb docs, it should work.
Does starting Sage work?



---

archive/issue_comments_512805.json:
```json
{
    "body": "<a id='comment:16'></a>\nI'm not sure one can say this is a separate issue, since it corresponds fully to the description:\nin a clean environment (after extracting sage-8.6.tar.gz), running `make` produces exactly the\nsame result as in the description (see the log file I attached):\n\n```\nRunning Sphinx v1.7.6\nmaking output directory...\nloading pickled environment... not yet created\nbuilding [mo]: targets for 0 po files that are out of date\nbuilding [html]: targets for 19 source files that are out of date\nupdating environment: 19 added, 0 changed, 0 removed\nreading sources... [  5%] index\nreading sources... [ 10%] misc/introspect\nreading sources... [ 15%] misc/misc\n\nException occurred:\n  File \"sage/misc/lazy_import.pyx\", line 218, in sage.misc.lazy_import.LazyImpo\\\nrt._get_object (build/cythonized/sage/misc/lazy_import.c:2489)\n    raise RuntimeError(f\"resolving lazy import {self._name} during startup\")\nRuntimeError: resolving lazy import dumps during startup\nThe full traceback has been saved in /tmp/sphinx-err-luxsJe.log, if you want to\\\n report the issue to the developers.\nPlease also report this if it was a user error, so that a better error message \\\ncan be provided next time.\nA bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphi\\\nnx/issues>. Thanks!\n```\nThis was with `make` without any argument, thus `make -j1`.",
    "created_at": "2019-02-11T13:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512805",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:16'></a>
I'm not sure one can say this is a separate issue, since it corresponds fully to the description:
in a clean environment (after extracting sage-8.6.tar.gz), running `make` produces exactly the
same result as in the description (see the log file I attached):

```
Running Sphinx v1.7.6
making output directory...
loading pickled environment... not yet created
building [mo]: targets for 0 po files that are out of date
building [html]: targets for 19 source files that are out of date
updating environment: 19 added, 0 changed, 0 removed
reading sources... [  5%] index
reading sources... [ 10%] misc/introspect
reading sources... [ 15%] misc/misc

Exception occurred:
  File "sage/misc/lazy_import.pyx", line 218, in sage.misc.lazy_import.LazyImpo\
rt._get_object (build/cythonized/sage/misc/lazy_import.c:2489)
    raise RuntimeError(f"resolving lazy import {self._name} during startup")
RuntimeError: resolving lazy import dumps during startup
The full traceback has been saved in /tmp/sphinx-err-luxsJe.log, if you want to\
 report the issue to the developers.
Please also report this if it was a user error, so that a better error message \
can be provided next time.
A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphi\
nx/issues>. Thanks!
```
This was with `make` without any argument, thus `make -j1`.



---

archive/issue_comments_512806.json:
```json
{
    "body": "<a id='comment:17'></a>\nHow about the mentioned `/tmp/sphinx-err-luxsJe.log` ?",
    "created_at": "2019-02-11T13:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512806",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>
How about the mentioned `/tmp/sphinx-err-luxsJe.log` ?



---

archive/issue_comments_512807.json:
```json
{
    "body": "<a id='comment:18'></a>\nIn order to isolate this better, you can try removing the lines\n\n```\ncd doc\n$MAKE html || sdh_die \"Error building the documentation\"\ndocdir=\"$SAGE_LOCAL/share/doc/sagenb\"\nrm -rf \"$docdir\"\nmv build/html \"$docdir\"\n```\nfrom `build/pkgs/sagenb/spkg-install` and see whether building Sage completes and you can start it, etc.",
    "created_at": "2019-02-11T13:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512807",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>
In order to isolate this better, you can try removing the lines

```
cd doc
$MAKE html || sdh_die "Error building the documentation"
docdir="$SAGE_LOCAL/share/doc/sagenb"
rm -rf "$docdir"
mv build/html "$docdir"
```
from `build/pkgs/sagenb/spkg-install` and see whether building Sage completes and you can start it, etc.



---

archive/issue_comments_512808.json:
```json
{
    "body": "Attachment [sphinx-err-luxsJe.log](tarball://root/attachments/some-uuid/ticket26686/sphinx-err-luxsJe.log) by @zimmermann6 created at 2019-02-11 20:20:08",
    "created_at": "2019-02-11T20:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512808",
    "user": "https://github.com/zimmermann6"
}
```

Attachment [sphinx-err-luxsJe.log](tarball://root/attachments/some-uuid/ticket26686/sphinx-err-luxsJe.log) by @zimmermann6 created at 2019-02-11 20:20:08



---

archive/issue_comments_512809.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [dimpase](#comment%3A17):\n> How about the mentioned `/tmp/sphinx-err-luxsJe.log` ?\n\n\nit is now attached.",
    "created_at": "2019-02-11T20:20:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512809",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:19'></a>
Replying to [dimpase](#comment%3A17):
> How about the mentioned `/tmp/sphinx-err-luxsJe.log` ?


it is now attached.



---

archive/issue_comments_512810.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [zimmerma](#comment%3A19):\n> Replying to [dimpase](#comment%3A17):\n> > How about the mentioned `/tmp/sphinx-err-luxsJe.log` ?\n\n> \n> it is now attached.\n\nThanks - no clues there, unfortunately.\nCould you try the experiment proposed in comment 18 ?",
    "created_at": "2019-02-11T20:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512810",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
Replying to [zimmerma](#comment%3A19):
> Replying to [dimpase](#comment%3A17):
> > How about the mentioned `/tmp/sphinx-err-luxsJe.log` ?

> 
> it is now attached.

Thanks - no clues there, unfortunately.
Could you try the experiment proposed in comment 18 ?



---

archive/issue_comments_512811.json:
```json
{
    "body": "<a id='comment:21'></a>\nPlease create a new ticket instead of discussing things on an old ticket which is most likely unrelated.",
    "created_at": "2019-02-11T20:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512811",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Please create a new ticket instead of discussing things on an old ticket which is most likely unrelated.



---

archive/issue_comments_512812.json:
```json
{
    "body": "<a id='comment:22'></a>\nI think the underlying problem is all these `except ImportError` in `sagenb/misc/misc.py`. They hide real errors and just break stuff. I'll try to fix that upstream.\n\nIt won't solve your problem but at least it you'll get a proper error message.",
    "created_at": "2019-02-11T21:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512812",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
I think the underlying problem is all these `except ImportError` in `sagenb/misc/misc.py`. They hide real errors and just break stuff. I'll try to fix that upstream.

It won't solve your problem but at least it you'll get a proper error message.



---

archive/issue_comments_512813.json:
```json
{
    "body": "<a id='comment:23'></a>\nPlease continue the discussion at #27257.",
    "created_at": "2019-02-11T21:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26686#issuecomment-512813",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
Please continue the discussion at #27257.
