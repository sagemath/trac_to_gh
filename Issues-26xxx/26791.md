# Issue 26791: R help text differs on some systems

archive/issues_026554.json:
```json
{
    "assignees": [],
    "body": "See https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ.\n\n~~It looks like rpy2 picks up the systems R.~~\n\nWhen a symbol has been overloaded, R's `help` doesn't pick the right symbol.\n\nCC:  @EmmanuelCharpentier @embray @kiwifb @jdemeyer\n\nKeywords: **rpy2 R**\n\nBranch/Commit: **[bd0f8f2](https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef)**\n\nReviewer: **Emmanuel Charpentier**\n\nAuthor: **Timo Kaufmann**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26791_\n\n",
    "closed_at": "2019-01-02T19:05:31Z",
    "created_at": "2018-11-29T21:04:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "R help text differs on some systems",
    "type": "issue",
    "updated_at": "2019-01-02T19:05:31Z",
    "url": "https://github.com/sagemath/sage/issues/26791",
    "user": "https://github.com/timokau"
}
```
See https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ.

~~It looks like rpy2 picks up the systems R.~~

When a symbol has been overloaded, R's `help` doesn't pick the right symbol.

CC:  @EmmanuelCharpentier @embray @kiwifb @jdemeyer

Keywords: **rpy2 R**

Branch/Commit: **[bd0f8f2](https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef)**

Reviewer: **Emmanuel Charpentier**

Author: **Timo Kaufmann**

_Issue created by migration from https://trac.sagemath.org/ticket/26791_





---

archive/issue_events_350097.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-11-29T21:04:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350097"
}
```



---

archive/issue_events_350098.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-11-29T21:04:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350098"
}
```



---

archive/issue_events_350099.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-11-29T21:04:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350099"
}
```



---

archive/issue_events_350100.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-11-29T21:04:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350100"
}
```



---

archive/issue_comments_415387.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nI've looked at rpy2s build script. It contains the line\n\n```\nexport RHOMES=\"$SAGE_LOCAL\"/lib/R\n```\n\nThat looks like a typo. rpy2 respects the environment variable `RHOME`, without the `s`. Probably didn't cause any issues before because `rpy2` wasn't used very heavily before #26596.",
    "created_at": "2018-11-29T21:06:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415387",
    "user": "https://github.com/timokau"
}
```

<div id="comment:1" align="right">Comment 1</div>

I've looked at rpy2s build script. It contains the line

```
export RHOMES="$SAGE_LOCAL"/lib/R
```

That looks like a typo. rpy2 respects the environment variable `RHOME`, without the `s`. Probably didn't cause any issues before because `rpy2` wasn't used very heavily before #26596.



---

archive/issue_comments_415388.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c25df8dc460e3d810ea47f0c2340f6b3252ff746\">c25df8d</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>\n",
    "created_at": "2018-11-29T21:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415388",
    "user": "https://github.com/timokau"
}
```

<div id="comment:2" align="right">Comment 2</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c25df8dc460e3d810ea47f0c2340f6b3252ff746">c25df8d</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>




---

archive/issue_comments_415389.json:
```json
{
    "body": "Commit: **[c25df8d](https://github.com/sagemath/sagetrac-mirror/commit/c25df8dc460e3d810ea47f0c2340f6b3252ff746)**",
    "created_at": "2018-11-29T21:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415389",
    "user": "https://github.com/timokau"
}
```

Commit: **[c25df8d](https://github.com/sagemath/sagetrac-mirror/commit/c25df8dc460e3d810ea47f0c2340f6b3252ff746)**



---

archive/issue_events_350101.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-11-29T21:08:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350101"
}
```



---

archive/issue_comments_415390.json:
```json
{
    "body": "Branch: **[u/gh-timokau/rpy2-build-typo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/rpy2-build-typo)**",
    "created_at": "2018-11-29T21:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415390",
    "user": "https://github.com/timokau"
}
```

Branch: **[u/gh-timokau/rpy2-build-typo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/rpy2-build-typo)**



---

archive/issue_comments_415391.json:
```json
{
    "body": "Author: **Timo Kaufmann**",
    "created_at": "2018-11-29T21:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415391",
    "user": "https://github.com/timokau"
}
```

Author: **Timo Kaufmann**



---

archive/issue_comments_415392.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\n@EmmanuelCharpentier please test.",
    "created_at": "2018-11-29T21:10:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415392",
    "user": "https://github.com/timokau"
}
```

<div id="comment:3" align="right">Comment 3</div>

@EmmanuelCharpentier please test.



---

archive/issue_comments_415393.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThat's a case where you want a revision bump in the package version. We want everyone to re-install this.",
    "created_at": "2018-11-29T21:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415393",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">Comment 4</div>

That's a case where you want a revision bump in the package version. We want everyone to re-install this.



---

archive/issue_comments_415394.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@timokau](#comment%3A3):\n> @EmmanuelCharpentier please test.\n\nShall do. But I have to upgrade my local installation first. Don't expect results \nbefore tomorrow morning...\n\nNote that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).",
    "created_at": "2018-11-29T22:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415394",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@timokau](#comment%3A3):
> @EmmanuelCharpentier please test.

Shall do. But I have to upgrade my local installation first. Don't expect results 
before tomorrow morning...

Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).



---

archive/issue_comments_415395.json:
```json
{
    "body": "Changed commit from **[c25df8d](https://github.com/sagemath/sagetrac-mirror/commit/c25df8dc460e3d810ea47f0c2340f6b3252ff746)** to **[2af44d2](https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759)**",
    "created_at": "2018-11-29T22:58:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415395",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c25df8d](https://github.com/sagemath/sagetrac-mirror/commit/c25df8dc460e3d810ea47f0c2340f6b3252ff746)** to **[2af44d2](https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759)**



---

archive/issue_comments_415396.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759\">2af44d2</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>\n",
    "created_at": "2018-11-29T22:58:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415396",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6" align="right">Comment 6</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759">2af44d2</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>




---

archive/issue_comments_415397.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nRight, added the package bump.\n\nHow do you know which version rpy2 actually used?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759\">2af44d2</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>\n",
    "created_at": "2018-11-29T22:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415397",
    "user": "https://github.com/timokau"
}
```

<div id="comment:7" align="right">Comment 7</div>

Right, added the package bump.

How do you know which version rpy2 actually used?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759">2af44d2</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>




---

archive/issue_comments_415398.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106\">aeb8d30</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>\n",
    "created_at": "2018-11-29T23:00:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415398",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8" align="right">Comment 8</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106">aeb8d30</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>




---

archive/issue_comments_415399.json:
```json
{
    "body": "Changed commit from **[2af44d2](https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759)** to **[aeb8d30](https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106)**",
    "created_at": "2018-11-29T23:00:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415399",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2af44d2](https://github.com/sagemath/sagetrac-mirror/commit/2af44d2cf377bf9509d9d5a4d9f044c99ba55759)** to **[aeb8d30](https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106)**



---

archive/issue_comments_415400.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nReplying to [@timokau](#comment%3A7):\n> Right, added the package bump.\n> \n> How do you know which version rpy2 actually used?\n\nDo you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?",
    "created_at": "2018-11-29T23:03:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415400",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">Comment 9</div>

Replying to [@timokau](#comment%3A7):
> Right, added the package bump.
> 
> How do you know which version rpy2 actually used?

Do you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?



---

archive/issue_comments_415401.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A5):\n> Replying to [@timokau](#comment%3A3):\n> > @EmmanuelCharpentier please test.\n\n> \n> Shall do. But I have to upgrade my local installation first. Don't expect results \n> before tomorrow morning...\n> \n> Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).\n\nIt turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).\n\nBut manually fixing the typo in a local branch doesn fix the problem :\n\n```\nsage -f rpy2\nsage -t --long --warn-long 47.5 src/sage/interfaces/r.py \n```\ngives the same result :\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 47.5 src/sage/interfaces/r.py  # 3 doctests failed\n----------------------------------------------------------------------\n```\n\nVisual inspection shows the same docstring differences as before.\n\nPS : I saw a new update of this ticket while I was writing this : I still can't `trac checkout` this ticket. Now we have two problems 8-(.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106\">aeb8d30</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>\n",
    "created_at": "2018-11-29T23:08:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415401",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@EmmanuelCharpentier](#comment%3A5):
> Replying to [@timokau](#comment%3A3):
> > @EmmanuelCharpentier please test.

> 
> Shall do. But I have to upgrade my local installation first. Don't expect results 
> before tomorrow morning...
> 
> Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).

It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).

But manually fixing the typo in a local branch doesn fix the problem :

```
sage -f rpy2
sage -t --long --warn-long 47.5 src/sage/interfaces/r.py 
```
gives the same result :

```
----------------------------------------------------------------------
sage -t --long --warn-long 47.5 src/sage/interfaces/r.py  # 3 doctests failed
----------------------------------------------------------------------
```

Visual inspection shows the same docstring differences as before.

PS : I saw a new update of this ticket while I was writing this : I still can't `trac checkout` this ticket. Now we have two problems 8-(.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106">aeb8d30</a></td><td><code>Fix rpy2 build script typo</code></td></tr></table>




---

archive/issue_events_350102.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2018-11-29T23:09:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350102"
}
```



---

archive/issue_events_350103.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2018-11-29T23:09:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350103"
}
```



---

archive/issue_comments_415402.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nNot solved (see above)...",
    "created_at": "2018-11-29T23:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415402",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:11" align="right">Comment 11</div>

Not solved (see above)...



---

archive/issue_comments_415403.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A11):\n> Not solved (see above)...\n\nQuestion: Did you update some R packages or install new ones on top of the sage installation?",
    "created_at": "2018-11-29T23:15:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415403",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@EmmanuelCharpentier](#comment%3A11):
> Not solved (see above)...

Question: Did you update some R packages or install new ones on top of the sage installation?



---

archive/issue_comments_415404.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@kiwifb](#comment%3A12):\n> Replying to [@EmmanuelCharpentier](#comment%3A11):\n> > Not solved (see above)...\n\n> \n> Question: Did you update some R packages or install new ones on top of the sage installation?\n\nNope.\n\nBTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?",
    "created_at": "2018-11-29T23:23:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415404",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@kiwifb](#comment%3A12):
> Replying to [@EmmanuelCharpentier](#comment%3A11):
> > Not solved (see above)...

> 
> Question: Did you update some R packages or install new ones on top of the sage installation?

Nope.

BTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?



---

archive/issue_comments_415405.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A13):\n> BTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?\n\nI already advised Timo on that and the latest version of the branch has the bump.",
    "created_at": "2018-11-29T23:27:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415405",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@EmmanuelCharpentier](#comment%3A13):
> BTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?

I already advised Timo on that and the latest version of the branch has the bump.



---

archive/issue_comments_415406.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@kiwifb](#comment%3A9):\n> Replying to [@timokau](#comment%3A7):\n> > Right, added the package bump.\n> > \n> > How do you know which version rpy2 actually used?\n\n> \n> Do you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?\n\nThe first one.",
    "created_at": "2018-11-30T08:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415406",
    "user": "https://github.com/timokau"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@kiwifb](#comment%3A9):
> Replying to [@timokau](#comment%3A7):
> > Right, added the package bump.
> > 
> > How do you know which version rpy2 actually used?

> 
> Do you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?

The first one.



---

archive/issue_comments_415407.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A10):\n> Replying to [@EmmanuelCharpentier](#comment%3A5):\n> > Replying to [@timokau](#comment%3A3):\n> > > @EmmanuelCharpentier please test.\n\n> > \n> > Shall do. But I have to upgrade my local installation first. Don't expect results \n> > before tomorrow morning...\n> > \n> > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).\n\n> \n> It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).\n> \n> But manually fixing the typo in a local branch doesn fix the problem :\n> \n> ```\n> sage -f rpy2\n> sage -t --long --warn-long 47.5 src/sage/interfaces/r.py \n> ```\n\nDid you re-install `rpy2` between those commands? I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.\n\nCould you also post the result of\n\n```\n./sage -R --version # version of sage's R\nR --version # system R\n./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version\n./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with\n```",
    "created_at": "2018-11-30T08:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415407",
    "user": "https://github.com/timokau"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@EmmanuelCharpentier](#comment%3A10):
> Replying to [@EmmanuelCharpentier](#comment%3A5):
> > Replying to [@timokau](#comment%3A3):
> > > @EmmanuelCharpentier please test.

> > 
> > Shall do. But I have to upgrade my local installation first. Don't expect results 
> > before tomorrow morning...
> > 
> > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).

> 
> It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).
> 
> But manually fixing the typo in a local branch doesn fix the problem :
> 
> ```
> sage -f rpy2
> sage -t --long --warn-long 47.5 src/sage/interfaces/r.py 
> ```

Did you re-install `rpy2` between those commands? I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.

Could you also post the result of

```
./sage -R --version # version of sage's R
R --version # system R
./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version
./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with
```



---

archive/issue_comments_415408.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@timokau](#comment%3A16):\n> Replying to [@EmmanuelCharpentier](#comment%3A10):\n> > Replying to [@EmmanuelCharpentier](#comment%3A5):\n> > > Replying to [@timokau](#comment%3A3):\n> > > > @EmmanuelCharpentier please test.\n\n> > > \n> > > Shall do. But I have to upgrade my local installation first. Don't expect results \n> > > before tomorrow morning...\n> > > \n> > > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).\n\n> > \n> > It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).\n> > \n> > But manually fixing the typo in a local branch doesn fix the problem :\n> > \n> > ```\n> > sage -f rpy2\n> > sage -t --long --warn-long 47.5 src/sage/interfaces/r.py \n> > ```\n\n> \n> Did you re-install `rpy2` between those commands?\n\nNope. No reason to (see below).\n\n> I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.\n\nHuh ?\n\n```\nsage -advanced\n[ ... ]\n                           -f -- force build: install the packages even\n                                 if they are already installed\n```\n\nWhadadjasmoke ?\n\n\n> Could you also post the result of\n> \n> ```\n> ./sage -R --version # version of sage's R\n> ```\n\n\n```\ncharpent@zen-book-flip:/usr/local/sage-8$ ./sage -R\n\nR version 3.4.4 (2018-03-15) -- \"Someone to Lean On\"\nCopyright (C) 2018 The R Foundation for Statistical Computing\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nR est un logiciel libre livr\u00e9 sans AUCUNE GARANTIE.\nVous pouvez le redistribuer sous certaines conditions.\nTapez 'license()' ou 'licence()' pour plus de d\u00e9tails.\n\nR est un projet collaboratif avec de nombreux contributeurs.\nTapez 'contributors()' pour plus d'information et\n'citation()' pour la fa\u00e7on de le citer dans les publications.\n\nTapez 'demo()' pour des d\u00e9monstrations, 'help()' pour l'aide\nen ligne ou 'help.start()' pour obtenir l'aide au format HTML.\nTapez 'q()' pour quitter R.\n```\nInformation already given, BTW...\n\n\n> R --version # system R\n\n\n```\ncharpent@zen-book-flip:/usr/local/sage-8$ R --version\nR version 3.5.1 (2018-07-02) -- \"Feather Spray\"\nCopyright (C) 2018 The R Foundation for Statistical Computing\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under the terms of the\nGNU General Public License versions 2 or 3.\nFor more information about these matters see\nhttp://www.gnu.org/licenses/.\n```\nDitto...\n\n> ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version\n\n\n```\ncharpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version\n2.8.2\n```\nNo surprise here...\n\n> ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with\n> }}}         \n\n\n```\ncharpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)'\n('3', '4.4', '', 74408L)\n```\nDitto...",
    "created_at": "2018-11-30T09:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415408",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@timokau](#comment%3A16):
> Replying to [@EmmanuelCharpentier](#comment%3A10):
> > Replying to [@EmmanuelCharpentier](#comment%3A5):
> > > Replying to [@timokau](#comment%3A3):
> > > > @EmmanuelCharpentier please test.

> > > 
> > > Shall do. But I have to upgrade my local installation first. Don't expect results 
> > > before tomorrow morning...
> > > 
> > > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).

> > 
> > It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).
> > 
> > But manually fixing the typo in a local branch doesn fix the problem :
> > 
> > ```
> > sage -f rpy2
> > sage -t --long --warn-long 47.5 src/sage/interfaces/r.py 
> > ```

> 
> Did you re-install `rpy2` between those commands?

Nope. No reason to (see below).

> I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.

Huh ?

```
sage -advanced
[ ... ]
                           -f -- force build: install the packages even
                                 if they are already installed
```

Whadadjasmoke ?


> Could you also post the result of
> 
> ```
> ./sage -R --version # version of sage's R
> ```


```
charpent@zen-book-flip:/usr/local/sage-8$ ./sage -R

R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R est un logiciel libre livré sans AUCUNE GARANTIE.
Vous pouvez le redistribuer sous certaines conditions.
Tapez 'license()' ou 'licence()' pour plus de détails.

R est un projet collaboratif avec de nombreux contributeurs.
Tapez 'contributors()' pour plus d'information et
'citation()' pour la façon de le citer dans les publications.

Tapez 'demo()' pour des démonstrations, 'help()' pour l'aide
en ligne ou 'help.start()' pour obtenir l'aide au format HTML.
Tapez 'q()' pour quitter R.
```
Information already given, BTW...


> R --version # system R


```
charpent@zen-book-flip:/usr/local/sage-8$ R --version
R version 3.5.1 (2018-07-02) -- "Feather Spray"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under the terms of the
GNU General Public License versions 2 or 3.
For more information about these matters see
http://www.gnu.org/licenses/.
```
Ditto...

> ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version


```
charpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version
2.8.2
```
No surprise here...

> ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with
> }}}         


```
charpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)'
('3', '4.4', '', 74408L)
```
Ditto...



---

archive/issue_comments_415409.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A17):\n> > I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.\n\n> \n> Huh ?\n> \n> ```\n> sage -advanced\n> [ ... ]\n>                            -f -- force build: install the packages even\n>                                  if they are already installed\n> ```\n> \n> Whadadjasmoke ?\n\nThat was just my assumption, I never checked to be honest.\n\n> > Could you also post the result of\n> > \n> > ```\n> > ./sage -R --version # version of sage's R\n> > ```\n\n> [...]\n> Information already given, BTW...\n> \n> [...]\n> Ditto...\n> \n> [...]\n> Ditto...\n\nWell some of that information wasn't entirely clear before and for others I didn't know where you got them. Now we're both on the same page.\n\nSeems like I jumped to conclusions and misclassified the problem. The correct R seems to be used. Although I see no mention of `RHOMES` anywhere in the rpy2 code while `RHOME` is supposed to be the \"R Installation Directory\", so I don't know how it actually picked the correct one before.\n\nWhat headline do you get when you execute `help('c')` within `sage -R`? \"Combine Values into a Vector or List\" or \"Combining Objects\"?",
    "created_at": "2018-11-30T13:51:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415409",
    "user": "https://github.com/timokau"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@EmmanuelCharpentier](#comment%3A17):
> > I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.

> 
> Huh ?
> 
> ```
> sage -advanced
> [ ... ]
>                            -f -- force build: install the packages even
>                                  if they are already installed
> ```
> 
> Whadadjasmoke ?

That was just my assumption, I never checked to be honest.

> > Could you also post the result of
> > 
> > ```
> > ./sage -R --version # version of sage's R
> > ```

> [...]
> Information already given, BTW...
> 
> [...]
> Ditto...
> 
> [...]
> Ditto...

Well some of that information wasn't entirely clear before and for others I didn't know where you got them. Now we're both on the same page.

Seems like I jumped to conclusions and misclassified the problem. The correct R seems to be used. Although I see no mention of `RHOMES` anywhere in the rpy2 code while `RHOME` is supposed to be the "R Installation Directory", so I don't know how it actually picked the correct one before.

What headline do you get when you execute `help('c')` within `sage -R`? "Combine Values into a Vector or List" or "Combining Objects"?



---

archive/issue_events_350104.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-11-30T13:51:36Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "title_is": "R help text differs on some systems",
    "title_was": "rpy2 uses system R instead of sages R",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350104"
}
```



---

archive/issue_comments_415410.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@timokau](#comment%3A18):\n\n> What headline do you get when you execute `help('c')` within `sage -R`? \"Combine Values into a Vector or List\" or \"Combining Objects\"?\n\n`Combine Values into a Vector or List`",
    "created_at": "2018-11-30T20:27:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415410",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@timokau](#comment%3A18):

> What headline do you get when you execute `help('c')` within `sage -R`? "Combine Values into a Vector or List" or "Combining Objects"?

`Combine Values into a Vector or List`



---

archive/issue_comments_415411.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nThats weird. The only reason I can think of is the one Fran\u00e7ois already hinted to. Somehow there may be multiple help pages for `c`.\n\nWhat does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?",
    "created_at": "2018-11-30T23:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415411",
    "user": "https://github.com/timokau"
}
```

<div id="comment:21" align="right">Comment 21</div>

Thats weird. The only reason I can think of is the one François already hinted to. Somehow there may be multiple help pages for `c`.

What does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?



---

archive/issue_comments_415412.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@timokau](#comment%3A21):\n> Thats weird. The only reason I can think of is the one Fran\u00e7ois already hinted to. Somehow there may be multiple help pages for `c`.\n> \n> What does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?\n\n```\nsage: from rpy2 import robjects; print([ o.title() for o in robjects.help.pages(\n....: 'c') ])\n['Combining Objects', 'Combine Values into a Vector or List', 'NIMBLE language functions for R-like vector construction', 'Transformation of coordinate systems', \"Concatenating 'timeDate' Objects\"]\n```",
    "created_at": "2018-12-01T07:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415412",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@timokau](#comment%3A21):
> Thats weird. The only reason I can think of is the one François already hinted to. Somehow there may be multiple help pages for `c`.
> 
> What does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?

```
sage: from rpy2 import robjects; print([ o.title() for o in robjects.help.pages(
....: 'c') ])
['Combining Objects', 'Combine Values into a Vector or List', 'NIMBLE language functions for R-like vector construction', 'Transformation of coordinate systems', "Concatenating 'timeDate' Objects"]
```



---

archive/issue_comments_415413.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nOkay good, so we know what the problem is. There are multiple packages installed that provide a help page on the topic \"c\". My implementation in #26596 picks a different one by default than the R REPL does. The reason for that is that we cannot do plain `eval('help(\"c\")`), since for some reason rpy2 will then print the help page to stdout instead of returning it (as mentioned [in the rpy2 docs](https://rpy2.readthedocs.io/en/version_2.8.x/introduction.html#getting-help)). Instead we have to use rpy2s function `robjects.help.pages(\"c\")`, which returns a list of all help pages on the topic. I just picked the first one, assuming it would be the same one the R `help()` function would display. But apparently that is not the case.\n\nAre you really sure you haven't installed any additional R packages? For example one of the titles comes from the `nimble` package, which is not installed by default. This is a bug either way, but if you really didn't install that package that makes it even weirder.",
    "created_at": "2018-12-01T09:45:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415413",
    "user": "https://github.com/timokau"
}
```

<div id="comment:23" align="right">Comment 23</div>

Okay good, so we know what the problem is. There are multiple packages installed that provide a help page on the topic "c". My implementation in #26596 picks a different one by default than the R REPL does. The reason for that is that we cannot do plain `eval('help("c")`), since for some reason rpy2 will then print the help page to stdout instead of returning it (as mentioned [in the rpy2 docs](https://rpy2.readthedocs.io/en/version_2.8.x/introduction.html#getting-help)). Instead we have to use rpy2s function `robjects.help.pages("c")`, which returns a list of all help pages on the topic. I just picked the first one, assuming it would be the same one the R `help()` function would display. But apparently that is not the case.

Are you really sure you haven't installed any additional R packages? For example one of the titles comes from the `nimble` package, which is not installed by default. This is a bug either way, but if you really didn't install that package that makes it even weirder.



---

archive/issue_comments_415414.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nIt looks like R actually also prefers nimbles help page, *if the package is loaded*. If it is in batch mode (otherwise it'll show a list of matching help pages and let the user select one), `library(nimble); help(c)` will show nimble's help.\n\nSo I'll try to match the \"only loaded packages\" behaviour with rpy.",
    "created_at": "2018-12-01T10:21:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415414",
    "user": "https://github.com/timokau"
}
```

<div id="comment:24" align="right">Comment 24</div>

It looks like R actually also prefers nimbles help page, *if the package is loaded*. If it is in batch mode (otherwise it'll show a list of matching help pages and let the user select one), `library(nimble); help(c)` will show nimble's help.

So I'll try to match the "only loaded packages" behaviour with rpy.



---

archive/issue_comments_415415.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e035e77712786f2e07ad952acd5b0ee7147e3555\">e035e77</a></td><td><code>Merge remote-tracking branch 'origin/develop' into u/gh-timokau/rpy2-build-typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a3276592ac7d0d1cc0de7208135eff2b899be02\">9a32765</a></td><td><code>Only consider loaded packages for help pages in R</code></td></tr></table>\n",
    "created_at": "2018-12-01T11:44:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415415",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25" align="right">Comment 25</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e035e77712786f2e07ad952acd5b0ee7147e3555">e035e77</a></td><td><code>Merge remote-tracking branch 'origin/develop' into u/gh-timokau/rpy2-build-typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a3276592ac7d0d1cc0de7208135eff2b899be02">9a32765</a></td><td><code>Only consider loaded packages for help pages in R</code></td></tr></table>




---

archive/issue_comments_415416.json:
```json
{
    "body": "Changed commit from **[aeb8d30](https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106)** to **[9a32765](https://github.com/sagemath/sagetrac-mirror/commit/9a3276592ac7d0d1cc0de7208135eff2b899be02)**",
    "created_at": "2018-12-01T11:44:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415416",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[aeb8d30](https://github.com/sagemath/sagetrac-mirror/commit/aeb8d30f215a426b32fe096a5f22a3a25755b106)** to **[9a32765](https://github.com/sagemath/sagetrac-mirror/commit/9a3276592ac7d0d1cc0de7208135eff2b899be02)**



---

archive/issue_events_350105.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-12-01T11:44:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350105"
}
```



---

archive/issue_events_350106.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-12-01T11:44:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350106"
}
```



---

archive/issue_comments_415417.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nPlease test.",
    "created_at": "2018-12-01T11:44:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415417",
    "user": "https://github.com/timokau"
}
```

<div id="comment:26" align="right">Comment 26</div>

Please test.



---

archive/issue_comments_415418.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@timokau](#comment%3A23):\n\n> Are you really sure you haven't installed any additional R packages?\n\nSorry : I have probably misunderstood you the first time you've asked the question : I didn't **add** any **new** package to my Sage R installation. However, some packages are present :\n\n```\n dim(installed.packages())\n[1] 494  16\n```",
    "created_at": "2018-12-01T12:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415418",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@timokau](#comment%3A23):

> Are you really sure you haven't installed any additional R packages?

Sorry : I have probably misunderstood you the first time you've asked the question : I didn't **add** any **new** package to my Sage R installation. However, some packages are present :

```
 dim(installed.packages())
[1] 494  16
```



---

archive/issue_comments_415419.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nThats one less mystery. Good thing you did too, otherwise we wouldn't have found this bug :)\n\nDoes my latest commit fix it for you?",
    "created_at": "2018-12-01T12:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415419",
    "user": "https://github.com/timokau"
}
```

<div id="comment:28" align="right">Comment 28</div>

Thats one less mystery. Good thing you did too, otherwise we wouldn't have found this bug :)

Does my latest commit fix it for you?



---

archive/issue_comments_415420.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nSame result. Sorry...\n\nIn system's R, asking help on an overloaded system leads to a presentation of the alternatives and a question asking which symbol's help is needed. There is (rightly, IMHO) no ettempot to guess which one is the \"right\" one... :\n\n```\n> library(nimble)\nnimble version 0.6-12 is loaded.\nFor more information on NIMBLE and a User Manual,\nplease visit http://R-nimble.org.\n\nAttachement du package : \u2018nimble\u2019\n\nThe following object is masked from \u2018package:stats\u2019:\n\n    simulate\n\n> ?c\nHelp on topic \u2018c\u2019 was found in the following packages:\n\n  Package               Library\n  nimble                /usr/local/lib/R/site-library\n  base                  /usr/lib/R/library\n```",
    "created_at": "2018-12-01T12:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415420",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:29" align="right">Comment 29</div>

Same result. Sorry...

In system's R, asking help on an overloaded system leads to a presentation of the alternatives and a question asking which symbol's help is needed. There is (rightly, IMHO) no ettempot to guess which one is the "right" one... :

```
> library(nimble)
nimble version 0.6-12 is loaded.
For more information on NIMBLE and a User Manual,
please visit http://R-nimble.org.

Attachement du package : ‘nimble’

The following object is masked from ‘package:stats’:

    simulate

> ?c
Help on topic ‘c’ was found in the following packages:

  Package               Library
  nimble                /usr/local/lib/R/site-library
  base                  /usr/lib/R/library
```



---

archive/issue_comments_415421.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n See https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ.\n \n-It looks like rpy2 picks up the systems R.\n+~~It looks like rpy2 picks up the systems R.~~\n+\n+When a symbol has been overloaded, R's `help` doesn't pick the right symbol.\n``````\n",
    "created_at": "2018-12-01T12:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415421",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 See https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ.
 
-It looks like rpy2 picks up the systems R.
+~~It looks like rpy2 picks up the systems R.~~
+
+When a symbol has been overloaded, R's `help` doesn't pick the right symbol.
``````




---

archive/issue_events_350107.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2018-12-01T12:23:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350107"
}
```



---

archive/issue_events_350108.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2018-12-01T12:23:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350108"
}
```



---

archive/issue_comments_415422.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nThat is surprising, I could reproduce the issue when installing `nible` and the latest commit fixed it for me. What does `./sage -c \"from rpy2.robjects import r; print(r('loadedNamespaces()'))\"` print?\n\n\nR will usually let you select, but in \"batch mode\" it will just give you the first. I agree that that is not ideal behaviour, but I matched the behaviour of the old `r` interface (which parsed the batch output) to preserve backwards compatibility.",
    "created_at": "2018-12-01T12:33:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415422",
    "user": "https://github.com/timokau"
}
```

<div id="comment:30" align="right">Comment 30</div>

That is surprising, I could reproduce the issue when installing `nible` and the latest commit fixed it for me. What does `./sage -c "from rpy2.robjects import r; print(r('loadedNamespaces()'))"` print?


R will usually let you select, but in "batch mode" it will just give you the first. I agree that that is not ideal behaviour, but I matched the behaviour of the old `r` interface (which parsed the batch output) to preserve backwards compatibility.



---

archive/issue_comments_415423.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nI begin to think that #26596 was a mistake.",
    "created_at": "2018-12-02T07:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415423",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:31" align="right">Comment 31</div>

I begin to think that #26596 was a mistake.



---

archive/issue_comments_415424.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A31):\n> I begin to think that #26596 was a mistake.\n\nTo qualify : R is a complex beast ; most notably, it offers some \"interactive\" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but *might* be used by *some* Sage users.\n\nSimilarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... \n\nAs far as I can tell, using `rpy2` (which entails \"batch mode\") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.\n\nI haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.\n\nThe only way out I can see *presently* is to\n* remove Sage's R,\n* depend on system's R,\n* disclaim usability of \"interactive\" R functions from Sage,\nwhich furthermore opens the nightmare of maintaining compatibility across versions.\n\nISTR that Erik Bray \"had ideas\" about how to do that.\n\nThoughts ?",
    "created_at": "2018-12-02T07:41:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415424",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:32" align="right">Comment 32</div>

Replying to [@EmmanuelCharpentier](#comment%3A31):
> I begin to think that #26596 was a mistake.

To qualify : R is a complex beast ; most notably, it offers some "interactive" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but *might* be used by *some* Sage users.

Similarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... 

As far as I can tell, using `rpy2` (which entails "batch mode") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.

I haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.

The only way out I can see *presently* is to
* remove Sage's R,
* depend on system's R,
* disclaim usability of "interactive" R functions from Sage,
which furthermore opens the nightmare of maintaining compatibility across versions.

ISTR that Erik Bray "had ideas" about how to do that.

Thoughts ?



---

archive/issue_comments_415425.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A31):\n> I begin to think that #26596 was a mistake.\n\nI very much disagree.\n\nReplying to [@EmmanuelCharpentier](#comment%3A32):\n> Replying to [@EmmanuelCharpentier](#comment%3A31):\n> > I begin to think that #26596 was a mistake.\n\n> \n> To qualify : R is a complex beast ; most notably, it offers some \"interactive\" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but *might* be used by *some* Sage users.\n\nDo you have any concrete example of some feature that worked before but doesn't work now?\n\n> Similarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... \n> \n> As far as I can tell, using `rpy2` (which entails \"batch mode\") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.\n\nIt was already \"batch mode\" before. Now it uses the C interface that R provides instead of parsing the REPL output, which is much more robust.\n\n> I haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.\n> \n> The only way out I can see *presently* is to\n> * remove Sage's R,\n> * depend on system's R,\n\nI don't see how any of these options would improve anything.\n\n> * disclaim usability of \"interactive\" R functions from Sage,\n> which furthermore opens the nightmare of maintaining compatibility across versions.\n\nThat nightmare is *exactly* the point of #26596.\n\n> ISTR that Erik Bray \"had ideas\" about how to do that.\n> \n> Thoughts ?",
    "created_at": "2018-12-02T09:26:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415425",
    "user": "https://github.com/timokau"
}
```

<div id="comment:33" align="right">Comment 33</div>

Replying to [@EmmanuelCharpentier](#comment%3A31):
> I begin to think that #26596 was a mistake.

I very much disagree.

Replying to [@EmmanuelCharpentier](#comment%3A32):
> Replying to [@EmmanuelCharpentier](#comment%3A31):
> > I begin to think that #26596 was a mistake.

> 
> To qualify : R is a complex beast ; most notably, it offers some "interactive" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but *might* be used by *some* Sage users.

Do you have any concrete example of some feature that worked before but doesn't work now?

> Similarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... 
> 
> As far as I can tell, using `rpy2` (which entails "batch mode") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.

It was already "batch mode" before. Now it uses the C interface that R provides instead of parsing the REPL output, which is much more robust.

> I haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.
> 
> The only way out I can see *presently* is to
> * remove Sage's R,
> * depend on system's R,

I don't see how any of these options would improve anything.

> * disclaim usability of "interactive" R functions from Sage,
> which furthermore opens the nightmare of maintaining compatibility across versions.

That nightmare is *exactly* the point of #26596.

> ISTR that Erik Bray "had ideas" about how to do that.
> 
> Thoughts ?



---

archive/issue_comments_415426.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nNot a blocker..",
    "created_at": "2018-12-12T14:24:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415426",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:34" align="right">Comment 34</div>

Not a blocker..



---

archive/issue_events_350109.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-12T14:24:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350109"
}
```



---

archive/issue_events_350110.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-12T14:24:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350110"
}
```



---

archive/issue_comments_415427.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nIn my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.\n\nThis is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.",
    "created_at": "2018-12-12T15:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415427",
    "user": "https://github.com/timokau"
}
```

<div id="comment:35" align="right">Comment 35</div>

In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.

This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.



---

archive/issue_comments_415428.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nReplying to [@timokau](#comment%3A35):\n> In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.\n> \n> This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.\n\nI think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me \"two days\" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)",
    "created_at": "2018-12-12T18:12:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415428",
    "user": "https://github.com/embray"
}
```

<div id="comment:36" align="right">Comment 36</div>

Replying to [@timokau](#comment%3A35):
> In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.
> 
> This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.

I think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me "two days" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)



---

archive/issue_comments_415429.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nReplying to [@timokau](#comment%3A35):\n\n[ Snip... ]\n\n> This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.\n\nSorry : this one slipped from my queue.\n\nWhat worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).\n\nFor example, in the \"help\" failures, we have a problem because the old expect interface happened to select whatever was available in an \"empty\" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).\n\nWe should :\n* document this behaviour\n* specify how to select the package containing the function we wissh help about\n* use this mechanism to specify explicitly the relevant library argument (\"base\", in our case) and test agaist this specific  help text.\n\nFurthermore, we should be aware of the possibility of such surprises. I do not see a way to search systematically for them. But I still think we should document te possibility of such surprises.",
    "created_at": "2018-12-12T20:23:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415429",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:37" align="right">Comment 37</div>

Replying to [@timokau](#comment%3A35):

[ Snip... ]

> This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.

Sorry : this one slipped from my queue.

What worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).

For example, in the "help" failures, we have a problem because the old expect interface happened to select whatever was available in an "empty" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).

We should :
* document this behaviour
* specify how to select the package containing the function we wissh help about
* use this mechanism to specify explicitly the relevant library argument ("base", in our case) and test agaist this specific  help text.

Furthermore, we should be aware of the possibility of such surprises. I do not see a way to search systematically for them. But I still think we should document te possibility of such surprises.



---

archive/issue_comments_415430.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nReplying to [@embray](#comment%3A36):\n> Replying to [@timokau](#comment%3A35):\n> > In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.\n> > \n> > This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.\n\n> \n> I think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me \"two days\" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)\n\nWhy not the regular `# known failure` marker? Marking the whole file seems overkill.",
    "created_at": "2018-12-12T22:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415430",
    "user": "https://github.com/timokau"
}
```

<div id="comment:38" align="right">Comment 38</div>

Replying to [@embray](#comment%3A36):
> Replying to [@timokau](#comment%3A35):
> > In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.
> > 
> > This is very low severity, but if we can't solve it before release (waiting on @EmmanuelCharpentier's reply to my last post) I suggest that we at least mark the test as a known failure.

> 
> I think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me "two days" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)

Why not the regular `# known failure` marker? Marking the whole file seems overkill.



---

archive/issue_comments_415431.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A37):\n> What worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).\n\nThe new R interface also effectively runs the equivalent to an interpreter internally.\n\n> For example, in the \"help\" failures, we have a problem because the old expect interface happened to select whatever was available in an \"empty\" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).\n\nIn fact I just tested the behaviour under the old interface. `r.library('nimble'); r.help('c')` hangs indefinitely. The old R interface was seriously broken. Which is why I was asking for a concrete regression (besides this help pages issue).\n\nThis issue in particular is due to R being too helpful and automatically piping the `help` output into a pager, even when called through the library. Because of that, rpy2 had to implement its own custom help implementation.\n\nI put a lot of effort into compatibility with the old interface (where it was not broken). So if there is a difference, that is a bug.",
    "created_at": "2018-12-12T22:50:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415431",
    "user": "https://github.com/timokau"
}
```

<div id="comment:39" align="right">Comment 39</div>

Replying to [@EmmanuelCharpentier](#comment%3A37):
> What worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).

The new R interface also effectively runs the equivalent to an interpreter internally.

> For example, in the "help" failures, we have a problem because the old expect interface happened to select whatever was available in an "empty" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).

In fact I just tested the behaviour under the old interface. `r.library('nimble'); r.help('c')` hangs indefinitely. The old R interface was seriously broken. Which is why I was asking for a concrete regression (besides this help pages issue).

This issue in particular is due to R being too helpful and automatically piping the `help` output into a pager, even when called through the library. Because of that, rpy2 had to implement its own custom help implementation.

I put a lot of effort into compatibility with the old interface (where it was not broken). So if there is a difference, that is a bug.



---

archive/issue_comments_415432.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef\">bd0f8f2</a></td><td><code>Only consider loaded packages for help pages in R</code></td></tr></table>\n",
    "created_at": "2018-12-16T13:25:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415432",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40" align="right">Comment 40</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef">bd0f8f2</a></td><td><code>Only consider loaded packages for help pages in R</code></td></tr></table>




---

archive/issue_comments_415433.json:
```json
{
    "body": "Changed commit from **[9a32765](https://github.com/sagemath/sagetrac-mirror/commit/9a3276592ac7d0d1cc0de7208135eff2b899be02)** to **[bd0f8f2](https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef)**",
    "created_at": "2018-12-16T13:25:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415433",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9a32765](https://github.com/sagemath/sagetrac-mirror/commit/9a3276592ac7d0d1cc0de7208135eff2b899be02)** to **[bd0f8f2](https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef)**



---

archive/issue_comments_415434.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nOkay this should really be fixed now. I didn't actually use the new help function I wrote before, which is why it didn't work.\n\nThis time I made sure I reproduced the error before testing the fix. Sicne this fixes a regression, I think this should be included in the next rc.",
    "created_at": "2018-12-16T13:27:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415434",
    "user": "https://github.com/timokau"
}
```

<div id="comment:41" align="right">Comment 41</div>

Okay this should really be fixed now. I didn't actually use the new help function I wrote before, which is why it didn't work.

This time I made sure I reproduced the error before testing the fix. Sicne this fixes a regression, I think this should be included in the next rc.



---

archive/issue_events_350111.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-12-16T13:27:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350111"
}
```



---

archive/issue_events_350112.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-12-16T13:27:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350112"
}
```



---

archive/issue_comments_415435.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nNot entirely sure if the original typo fix also belongs here. I have no idea why it worked before, but apparently it doesn't really matter weather its `RHOME` or `RHOMES`. Can't really hurt to fix it anyways though.",
    "created_at": "2018-12-16T13:28:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415435",
    "user": "https://github.com/timokau"
}
```

<div id="comment:42" align="right">Comment 42</div>

Not entirely sure if the original typo fix also belongs here. I have no idea why it worked before, but apparently it doesn't really matter weather its `RHOME` or `RHOMES`. Can't really hurt to fix it anyways though.



---

archive/issue_comments_415436.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nApplied on top of 8.6.beta1, builds and passes ptestlong without any problem ==> `positive_review`.",
    "created_at": "2019-01-01T20:06:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415436",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:43" align="right">Comment 43</div>

Applied on top of 8.6.beta1, builds and passes ptestlong without any problem ==> `positive_review`.



---

archive/issue_events_350113.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-01-01T20:06:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350113"
}
```



---

archive/issue_events_350114.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-01-01T20:06:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350114"
}
```



---

archive/issue_comments_415437.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nReviewer name...",
    "created_at": "2019-01-01T22:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415437",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:44" align="right">Comment 44</div>

Reviewer name...



---

archive/issue_events_350115.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-01T22:00:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350115"
}
```



---

archive/issue_events_350116.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-01T22:00:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350116"
}
```



---

archive/issue_events_350117.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-01-02T04:55:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350117"
}
```



---

archive/issue_events_350118.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2019-01-02T04:55:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350118"
}
```



---

archive/issue_comments_415438.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nWups...",
    "created_at": "2019-01-02T04:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415438",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:45" align="right">Comment 45</div>

Wups...



---

archive/issue_comments_415439.json:
```json
{
    "body": "Reviewer: **Emmanuel Charpentier**",
    "created_at": "2019-01-02T04:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415439",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Reviewer: **Emmanuel Charpentier**



---

archive/issue_events_350119.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-02T19:05:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350119"
}
```



---

archive/issue_events_350120.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d0d258acecd18f24e33d89dc64314c002810917f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-02T19:05:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26791#event-350120"
}
```



---

archive/issue_comments_415440.json:
```json
{
    "body": "Changed branch from **[u/gh-timokau/rpy2-build-typo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/rpy2-build-typo)** to **[bd0f8f2](https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef)**",
    "created_at": "2019-01-02T19:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26791#issuecomment-415440",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-timokau/rpy2-build-typo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/rpy2-build-typo)** to **[bd0f8f2](https://github.com/sagemath/sagetrac-mirror/commit/bd0f8f2b77fd2853d63890f6d5b5aa6479c8caef)**
