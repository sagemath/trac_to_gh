# Issue 26791: R help text differs on some systems

archive/issues_026554.json:
```json
{
    "body": "CC:  @EmmanuelCharpentier @embray @kiwifb @jdemeyer\n\nKeywords: rpy2 R\n\nSee https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ.\n\n~~It looks like rpy2 picks up the systems R.~~\n\nWhen a symbol has been overloaded, R's `help` doesn't pick the right symbol.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26791\n\n",
    "closed_at": "2019-01-02T19:05:31Z",
    "created_at": "2018-11-29T21:04:40Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "R help text differs on some systems",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26791",
    "user": "https://github.com/timokau"
}
```
CC:  @EmmanuelCharpentier @embray @kiwifb @jdemeyer

Keywords: rpy2 R

See https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ.

~~It looks like rpy2 picks up the systems R.~~

When a symbol has been overloaded, R's `help` doesn't pick the right symbol.

Issue created by migration from https://trac.sagemath.org/ticket/26791





---

archive/issue_comments_372894.json:
```json
{
    "body": "I've looked at rpy2s build script. It contains the line\n\n```\nexport RHOMES=\"$SAGE_LOCAL\"/lib/R\n```\n\nThat looks like a typo. rpy2 respects the environment variable `RHOME`, without the `s`. Probably didn't cause any issues before because `rpy2` wasn't used very heavily before #26596.",
    "created_at": "2018-11-29T21:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372894",
    "user": "https://github.com/timokau"
}
```

I've looked at rpy2s build script. It contains the line

```
export RHOMES="$SAGE_LOCAL"/lib/R
```

That looks like a typo. rpy2 respects the environment variable `RHOME`, without the `s`. Probably didn't cause any issues before because `rpy2` wasn't used very heavily before #26596.



---

archive/issue_comments_372895.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-11-29T21:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372895",
    "user": "https://github.com/timokau"
}
```

New commits:



---

archive/issue_comments_372896.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-29T21:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372896",
    "user": "https://github.com/timokau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_372897.json:
```json
{
    "body": "`@`charpent please test.",
    "created_at": "2018-11-29T21:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372897",
    "user": "https://github.com/timokau"
}
```

`@`charpent please test.



---

archive/issue_comments_372898.json:
```json
{
    "body": "That's a case where you want a revision bump in the package version. We want everyone to re-install this.",
    "created_at": "2018-11-29T21:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372898",
    "user": "https://github.com/kiwifb"
}
```

That's a case where you want a revision bump in the package version. We want everyone to re-install this.



---

archive/issue_comments_372899.json:
```json
{
    "body": "Replying to [comment:3 gh-timokau]:\n> `@`charpent please test.\n\n\nShall do. But I have to upgrade my local installation first. Don't expect results \nbefore tomorrow morning...\n\nNote that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).",
    "created_at": "2018-11-29T22:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372899",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:3 gh-timokau]:
> `@`charpent please test.


Shall do. But I have to upgrade my local installation first. Don't expect results 
before tomorrow morning...

Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).



---

archive/issue_comments_372900.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-11-29T22:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372901.json:
```json
{
    "body": "Right, added the package bump.\n\nHow do you know which version rpy2 actually used?\n\n---\nNew commits:",
    "created_at": "2018-11-29T22:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372901",
    "user": "https://github.com/timokau"
}
```

Right, added the package bump.

How do you know which version rpy2 actually used?

---
New commits:



---

archive/issue_comments_372902.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-11-29T23:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372902",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372903.json:
```json
{
    "body": "Replying to [comment:7 gh-timokau]:\n> Right, added the package bump.\n> \n> How do you know which version rpy2 actually used?\n\n\nDo you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?",
    "created_at": "2018-11-29T23:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372903",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:7 gh-timokau]:
> Right, added the package bump.
> 
> How do you know which version rpy2 actually used?


Do you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?



---

archive/issue_comments_372904.json:
```json
{
    "body": "Replying to [comment:5 charpent]:\n> Replying to [comment:3 gh-timokau]:\n> > `@`charpent please test.\n\n> \n> Shall do. But I have to upgrade my local installation first. Don't expect results \n> before tomorrow morning...\n> \n> Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).\n\n\nIt turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).\n\nBut manually fixing the typo in a local branch doesn fix the problem :\n\n```\nsage -f rpy2\nsage -t --long --warn-long 47.5 src/sage/interfaces/r.py \n```\ngives the same result :\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 47.5 src/sage/interfaces/r.py  # 3 doctests failed\n----------------------------------------------------------------------\n```\n\nVisual inspection shows the same docstring differences as before.\n\nPS : I saw a new update of this ticket while I was writing this : I still can't `trac checkout` this ticket. Now we have two problems 8-(.\n\n---\nNew commits:",
    "created_at": "2018-11-29T23:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372904",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:5 charpent]:
> Replying to [comment:3 gh-timokau]:
> > `@`charpent please test.

> 
> Shall do. But I have to upgrade my local installation first. Don't expect results 
> before tomorrow morning...
> 
> Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).


It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).

But manually fixing the typo in a local branch doesn fix the problem :

```
sage -f rpy2
sage -t --long --warn-long 47.5 src/sage/interfaces/r.py 
```
gives the same result :

```
----------------------------------------------------------------------
sage -t --long --warn-long 47.5 src/sage/interfaces/r.py  # 3 doctests failed
----------------------------------------------------------------------
```

Visual inspection shows the same docstring differences as before.

PS : I saw a new update of this ticket while I was writing this : I still can't `trac checkout` this ticket. Now we have two problems 8-(.

---
New commits:



---

archive/issue_comments_372905.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-11-29T23:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372905",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_372906.json:
```json
{
    "body": "Not solved (see above)...",
    "created_at": "2018-11-29T23:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372906",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Not solved (see above)...



---

archive/issue_comments_372907.json:
```json
{
    "body": "Replying to [comment:11 charpent]:\n> Not solved (see above)...\n\n\nQuestion: Did you update some R packages or install new ones on top of the sage installation?",
    "created_at": "2018-11-29T23:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372907",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:11 charpent]:
> Not solved (see above)...


Question: Did you update some R packages or install new ones on top of the sage installation?



---

archive/issue_comments_372908.json:
```json
{
    "body": "Replying to [comment:12 fbissey]:\n> Replying to [comment:11 charpent]:\n> > Not solved (see above)...\n\n> \n> Question: Did you update some R packages or install new ones on top of the sage installation?\n\n\nNope.\n\nBTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?",
    "created_at": "2018-11-29T23:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372908",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:12 fbissey]:
> Replying to [comment:11 charpent]:
> > Not solved (see above)...

> 
> Question: Did you update some R packages or install new ones on top of the sage installation?


Nope.

BTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?



---

archive/issue_comments_372909.json:
```json
{
    "body": "Replying to [comment:13 charpent]:\n> BTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?\n\n\nI already advised Timo on that and the latest version of the branch has the bump.",
    "created_at": "2018-11-29T23:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372909",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:13 charpent]:
> BTW : your patches do not seem to have an updated checksum. I *think* that this is normal if the package itself remains the same... But shouldn't `build/pkgs/rpy2/package-version.txt` get bumped ?


I already advised Timo on that and the latest version of the branch has the bump.



---

archive/issue_comments_372910.json:
```json
{
    "body": "Replying to [comment:9 fbissey]:\n> Replying to [comment:7 gh-timokau]:\n> > Right, added the package bump.\n> > \n> > How do you know which version rpy2 actually used?\n\n> \n> Do you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?\n\n\nThe first one.",
    "created_at": "2018-11-30T08:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372910",
    "user": "https://github.com/timokau"
}
```

Replying to [comment:9 fbissey]:
> Replying to [comment:7 gh-timokau]:
> > Right, added the package bump.
> > 
> > How do you know which version rpy2 actually used?

> 
> Do you mean which version of `R` was rpy2 using? Or which version of rpy2 was installed?


The first one.



---

archive/issue_comments_372911.json:
```json
{
    "body": "Replying to [comment:10 charpent]:\n> Replying to [comment:5 charpent]:\n> > Replying to [comment:3 gh-timokau]:\n> > > `@`charpent please test.\n\n> > \n> > Shall do. But I have to upgrade my local installation first. Don't expect results \n> > before tomorrow morning...\n> > \n> > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).\n\n> \n> It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).\n> \n> But manually fixing the typo in a local branch doesn fix the problem :\n> \n> \n> ```\n> sage -f rpy2\n> sage -t --long --warn-long 47.5 src/sage/interfaces/r.py \n> ```\n\n\nDid you re-install `rpy2` between those commands? I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.\n\nCould you also post the result of\n\n```\n./sage -R --version # version of sage's R\nR --version # system R\n./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version\n./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with\n```",
    "created_at": "2018-11-30T08:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372911",
    "user": "https://github.com/timokau"
}
```

Replying to [comment:10 charpent]:
> Replying to [comment:5 charpent]:
> > Replying to [comment:3 gh-timokau]:
> > > `@`charpent please test.

> > 
> > Shall do. But I have to upgrade my local installation first. Don't expect results 
> > before tomorrow morning...
> > 
> > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).

> 
> It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).
> 
> But manually fixing the typo in a local branch doesn fix the problem :
> 
> 
> ```
> sage -f rpy2
> sage -t --long --warn-long 47.5 src/sage/interfaces/r.py 
> ```


Did you re-install `rpy2` between those commands? I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.

Could you also post the result of

```
./sage -R --version # version of sage's R
R --version # system R
./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version
./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with
```



---

archive/issue_comments_372912.json:
```json
{
    "body": "Replying to [comment:16 gh-timokau]:\n> Replying to [comment:10 charpent]:\n> > Replying to [comment:5 charpent]:\n> > > Replying to [comment:3 gh-timokau]:\n> > > > `@`charpent please test.\n\n> > > \n> > > Shall do. But I have to upgrade my local installation first. Don't expect results \n> > > before tomorrow morning...\n> > > \n> > > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).\n\n> > \n> > It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).\n> > \n> > But manually fixing the typo in a local branch doesn fix the problem :\n> > \n> > \n> > ```\n> > sage -f rpy2\n> > sage -t --long --warn-long 47.5 src/sage/interfaces/r.py \n> > ```\n\n> \n> Did you re-install `rpy2` between those commands?\n\n\nNope. No reason to (see below).\n\n> I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.\n\n\nHuh ?\n\n```\nsage -advanced\n[ ... ]\n                           -f -- force build: install the packages even\n                                 if they are already installed\n```\n\nWhadadjasmoke ?\n\n\n> Could you also post the result of\n> \n> \n> ```\n> ./sage -R --version # version of sage's R\n\n\n{{{\ncharpent@zen-book-flip:/usr/local/sage-8$ ./sage -R\n\nR version 3.4.4 (2018-03-15) -- \"Someone to Lean On\"\nCopyright (C) 2018 The R Foundation for Statistical Computing\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nR est un logiciel libre livr\u00e9 sans AUCUNE GARANTIE.\nVous pouvez le redistribuer sous certaines conditions.\nTapez 'license()' ou 'licence()' pour plus de d\u00e9tails.\n\nR est un projet collaboratif avec de nombreux contributeurs.\nTapez 'contributors()' pour plus d'information et\n'citation()' pour la fa\u00e7on de le citer dans les publications.\n\nTapez 'demo()' pour des d\u00e9monstrations, 'help()' pour l'aide\nen ligne ou 'help.start()' pour obtenir l'aide au format HTML.\nTapez 'q()' pour quitter R.\n}}}\nInformation already given, BTW...\n\n\n> R --version # system R\n{{{\ncharpent@zen-book-flip:/usr/local/sage-8$ R --version\nR version 3.5.1 (2018-07-02) -- \"Feather Spray\"\nCopyright (C) 2018 The R Foundation for Statistical Computing\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under the terms of the\nGNU General Public License versions 2 or 3.\nFor more information about these matters see\nhttp://www.gnu.org/licenses/.\n}}}\nDitto...\n\n> ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version\n{{{\ncharpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version\n2.8.2\n}}}\nNo surprise here...\n\n> ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with\n> }}}         \n{{{\ncharpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)'\n('3', '4.4', '', 74408L)\n}}}\nDitto...",
    "created_at": "2018-11-30T09:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372912",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:16 gh-timokau]:
> Replying to [comment:10 charpent]:
> > Replying to [comment:5 charpent]:
> > > Replying to [comment:3 gh-timokau]:
> > > > `@`charpent please test.

> > > 
> > > Shall do. But I have to upgrade my local installation first. Don't expect results 
> > > before tomorrow morning...
> > > 
> > > Note that the version described in my  my [report](https://groups.google.com/d/msg/sage-release/MX-SnQJh8EE/2vNChwf_CQAJ) (done on another machine !) used Sage's R (3.4.4) rather than system's R (3.5.1, as packaged by Debian).

> > 
> > It turns out that I can't check out the branch related to this ticket (see [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/j34e9EOGz)).
> > 
> > But manually fixing the typo in a local branch doesn fix the problem :
> > 
> > 
> > ```
> > sage -f rpy2
> > sage -t --long --warn-long 47.5 src/sage/interfaces/r.py 
> > ```

> 
> Did you re-install `rpy2` between those commands?


Nope. No reason to (see below).

> I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.


Huh ?

```
sage -advanced
[ ... ]
                           -f -- force build: install the packages even
                                 if they are already installed
```

Whadadjasmoke ?


> Could you also post the result of
> 
> 
> ```
> ./sage -R --version # version of sage's R


{{{
charpent@zen-book-flip:/usr/local/sage-8$ ./sage -R

R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R est un logiciel libre livré sans AUCUNE GARANTIE.
Vous pouvez le redistribuer sous certaines conditions.
Tapez 'license()' ou 'licence()' pour plus de détails.

R est un projet collaboratif avec de nombreux contributeurs.
Tapez 'contributors()' pour plus d'information et
'citation()' pour la façon de le citer dans les publications.

Tapez 'demo()' pour des démonstrations, 'help()' pour l'aide
en ligne ou 'help.start()' pour obtenir l'aide au format HTML.
Tapez 'q()' pour quitter R.
}}}
Information already given, BTW...


> R --version # system R
{{{
charpent@zen-book-flip:/usr/local/sage-8$ R --version
R version 3.5.1 (2018-07-02) -- "Feather Spray"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under the terms of the
GNU General Public License versions 2 or 3.
For more information about these matters see
http://www.gnu.org/licenses/.
}}}
Ditto...

> ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version
{{{
charpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'import rpy2; print(rpy2.__version__)' # sages rpy version
2.8.2
}}}
No surprise here...

> ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)' # the R sages rpy was build with
> }}}         
{{{
charpent@zen-book-flip:/usr/local/sage-8$ ./sage -c 'from rpy2.rinterface import R_VERSION_BUILD; print(R_VERSION_BUILD)'
('3', '4.4', '', 74408L)
}}}
Ditto...



---

archive/issue_comments_372913.json:
```json
{
    "body": "Replying to [comment:17 charpent]:\n> > I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.\n\n> \n> Huh ?\n> \n> \n> ```\n> sage -advanced\n> [ ... ]\n>                            -f -- force build: install the packages even\n>                                  if they are already installed\n> ```\n> \n> Whadadjasmoke ?\n\n\nThat was just my assumption, I never checked to be honest.\n\n> > Could you also post the result of\n> > \n> > \n> > ```\n> > ./sage -R --version # version of sage's R\n\n> \n> [...]\n> Information already given, BTW...\n> \n> [...]\n> Ditto...\n> \n> [...]\n> Ditto...\n\nWell some of that information wasn't entirely clear before and for others I didn't know where you got them. Now we're both on the same page.\n\nSeems like I jumped to conclusions and misclassified the problem. The correct R seems to be used. Although I see no mention of `RHOMES` anywhere in the rpy2 code while `RHOME` is supposed to be the \"R Installation Directory\", so I don't know how it actually picked the correct one before.\n\nWhat headline do you get when you execute `help('c')` within `sage -R`? \"Combine Values into a Vector or List\" or \"Combining Objects\"?",
    "created_at": "2018-11-30T13:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372913",
    "user": "https://github.com/timokau"
}
```

Replying to [comment:17 charpent]:
> > I think `-f` just removes the package and without reinstalling it before testing, god knows what happens.

> 
> Huh ?
> 
> 
> ```
> sage -advanced
> [ ... ]
>                            -f -- force build: install the packages even
>                                  if they are already installed
> ```
> 
> Whadadjasmoke ?


That was just my assumption, I never checked to be honest.

> > Could you also post the result of
> > 
> > 
> > ```
> > ./sage -R --version # version of sage's R

> 
> [...]
> Information already given, BTW...
> 
> [...]
> Ditto...
> 
> [...]
> Ditto...

Well some of that information wasn't entirely clear before and for others I didn't know where you got them. Now we're both on the same page.

Seems like I jumped to conclusions and misclassified the problem. The correct R seems to be used. Although I see no mention of `RHOMES` anywhere in the rpy2 code while `RHOME` is supposed to be the "R Installation Directory", so I don't know how it actually picked the correct one before.

What headline do you get when you execute `help('c')` within `sage -R`? "Combine Values into a Vector or List" or "Combining Objects"?



---

archive/issue_comments_372914.json:
```json
{
    "body": "Replying to [comment:18 gh-timokau]:\n\n> What headline do you get when you execute `help('c')` within `sage -R`? \"Combine Values into a Vector or List\" or \"Combining Objects\"?\n\n\n`Combine Values into a Vector or List`",
    "created_at": "2018-11-30T20:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372914",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:18 gh-timokau]:

> What headline do you get when you execute `help('c')` within `sage -R`? "Combine Values into a Vector or List" or "Combining Objects"?


`Combine Values into a Vector or List`



---

archive/issue_comments_372915.json:
```json
{
    "body": "Thats weird. The only reason I can think of is the one Fran\u00e7ois already hinted to. Somehow there may be multiple help pages for `c`.\n\nWhat does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?",
    "created_at": "2018-11-30T23:33:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372915",
    "user": "https://github.com/timokau"
}
```

Thats weird. The only reason I can think of is the one François already hinted to. Somehow there may be multiple help pages for `c`.

What does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?



---

archive/issue_comments_372916.json:
```json
{
    "body": "Replying to [comment:21 gh-timokau]:\n> Thats weird. The only reason I can think of is the one Fran\u00e7ois already hinted to. Somehow there may be multiple help pages for `c`.\n> \n> What does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?\n\n\n```\nsage: from rpy2 import robjects; print([ o.title() for o in robjects.help.pages(\n....: 'c') ])\n['Combining Objects', 'Combine Values into a Vector or List', 'NIMBLE language functions for R-like vector construction', 'Transformation of coordinate systems', \"Concatenating 'timeDate' Objects\"]\n```",
    "created_at": "2018-12-01T07:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372916",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:21 gh-timokau]:
> Thats weird. The only reason I can think of is the one François already hinted to. Somehow there may be multiple help pages for `c`.
> 
> What does `from rpy2 import robjects; print([ o.title() for o in robjects.help.pages('c') ])` give when executed within sage?


```
sage: from rpy2 import robjects; print([ o.title() for o in robjects.help.pages(
....: 'c') ])
['Combining Objects', 'Combine Values into a Vector or List', 'NIMBLE language functions for R-like vector construction', 'Transformation of coordinate systems', "Concatenating 'timeDate' Objects"]
```



---

archive/issue_comments_372917.json:
```json
{
    "body": "Okay good, so we know what the problem is. There are multiple packages installed that provide a help page on the topic \"c\". My implementation in #26596 picks a different one by default than the R REPL does. The reason for that is that we cannot do plain `eval('help(\"c\")`), since for some reason rpy2 will then print the help page to stdout instead of returning it (as mentioned [in the rpy2 docs](https://rpy2.readthedocs.io/en/version_2.8.x/introduction.html#getting-help)). Instead we have to use rpy2s function `robjects.help.pages(\"c\")`, which returns a list of all help pages on the topic. I just picked the first one, assuming it would be the same one the R `help()` function would display. But apparently that is not the case.\n\nAre you really sure you haven't installed any additional R packages? For example one of the titles comes from the `nimble` package, which is not installed by default. This is a bug either way, but if you really didn't install that package that makes it even weirder.",
    "created_at": "2018-12-01T09:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372917",
    "user": "https://github.com/timokau"
}
```

Okay good, so we know what the problem is. There are multiple packages installed that provide a help page on the topic "c". My implementation in #26596 picks a different one by default than the R REPL does. The reason for that is that we cannot do plain `eval('help("c")`), since for some reason rpy2 will then print the help page to stdout instead of returning it (as mentioned [in the rpy2 docs](https://rpy2.readthedocs.io/en/version_2.8.x/introduction.html#getting-help)). Instead we have to use rpy2s function `robjects.help.pages("c")`, which returns a list of all help pages on the topic. I just picked the first one, assuming it would be the same one the R `help()` function would display. But apparently that is not the case.

Are you really sure you haven't installed any additional R packages? For example one of the titles comes from the `nimble` package, which is not installed by default. This is a bug either way, but if you really didn't install that package that makes it even weirder.



---

archive/issue_comments_372918.json:
```json
{
    "body": "It looks like R actually also prefers nimbles help page, *if the package is loaded*. If it is in batch mode (otherwise it'll show a list of matching help pages and let the user select one), `library(nimble); help(c)` will show nimble's help.\n\nSo I'll try to match the \"only loaded packages\" behaviour with rpy.",
    "created_at": "2018-12-01T10:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372918",
    "user": "https://github.com/timokau"
}
```

It looks like R actually also prefers nimbles help page, *if the package is loaded*. If it is in batch mode (otherwise it'll show a list of matching help pages and let the user select one), `library(nimble); help(c)` will show nimble's help.

So I'll try to match the "only loaded packages" behaviour with rpy.



---

archive/issue_comments_372919.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-01T11:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372919",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372920.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-01T11:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372920",
    "user": "https://github.com/timokau"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372921.json:
```json
{
    "body": "Please test.",
    "created_at": "2018-12-01T11:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372921",
    "user": "https://github.com/timokau"
}
```

Please test.



---

archive/issue_comments_372922.json:
```json
{
    "body": "Replying to [comment:23 gh-timokau]:\n\n> Are you really sure you haven't installed any additional R packages?\n\n\nSorry : I have probably misunderstood you the first time you've asked the question : I didn't **add** any **new** package to my Sage R installation. However, some packages are present :\n\n```\n dim(installed.packages())\n[1] 494  16\n```",
    "created_at": "2018-12-01T12:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372922",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:23 gh-timokau]:

> Are you really sure you haven't installed any additional R packages?


Sorry : I have probably misunderstood you the first time you've asked the question : I didn't **add** any **new** package to my Sage R installation. However, some packages are present :

```
 dim(installed.packages())
[1] 494  16
```



---

archive/issue_comments_372923.json:
```json
{
    "body": "Thats one less mystery. Good thing you did too, otherwise we wouldn't have found this bug :)\n\nDoes my latest commit fix it for you?",
    "created_at": "2018-12-01T12:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372923",
    "user": "https://github.com/timokau"
}
```

Thats one less mystery. Good thing you did too, otherwise we wouldn't have found this bug :)

Does my latest commit fix it for you?



---

archive/issue_comments_372924.json:
```json
{
    "body": "Same result. Sorry...\n\nIn system's R, asking help on an overloaded system leads to a presentation of the alternatives and a question asking which symbol's help is needed. There is (rightly, IMHO) no ettempot to guess which one is the \"right\" one... :\n\n```\n> library(nimble)\nnimble version 0.6-12 is loaded.\nFor more information on NIMBLE and a User Manual,\nplease visit http://R-nimble.org.\n\nAttachement du package : \u2018nimble\u2019\n\nThe following object is masked from \u2018package:stats\u2019:\n\n    simulate\n\n> ?c\nHelp on topic \u2018c\u2019 was found in the following packages:\n\n  Package               Library\n  nimble                /usr/local/lib/R/site-library\n  base                  /usr/lib/R/library\n```",
    "created_at": "2018-12-01T12:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372924",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Same result. Sorry...

In system's R, asking help on an overloaded system leads to a presentation of the alternatives and a question asking which symbol's help is needed. There is (rightly, IMHO) no ettempot to guess which one is the "right" one... :

```
> library(nimble)
nimble version 0.6-12 is loaded.
For more information on NIMBLE and a User Manual,
please visit http://R-nimble.org.

Attachement du package : ‘nimble’

The following object is masked from ‘package:stats’:

    simulate

> ?c
Help on topic ‘c’ was found in the following packages:

  Package               Library
  nimble                /usr/local/lib/R/site-library
  base                  /usr/lib/R/library
```



---

archive/issue_comments_372925.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-01T12:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372925",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_372926.json:
```json
{
    "body": "That is surprising, I could reproduce the issue when installing `nible` and the latest commit fixed it for me. What does `./sage -c \"from rpy2.robjects import r; print(r('loadedNamespaces()'))\"` print?\n\n\nR will usually let you select, but in \"batch mode\" it will just give you the first. I agree that that is not ideal behaviour, but I matched the behaviour of the old `r` interface (which parsed the batch output) to preserve backwards compatibility.",
    "created_at": "2018-12-01T12:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372926",
    "user": "https://github.com/timokau"
}
```

That is surprising, I could reproduce the issue when installing `nible` and the latest commit fixed it for me. What does `./sage -c "from rpy2.robjects import r; print(r('loadedNamespaces()'))"` print?


R will usually let you select, but in "batch mode" it will just give you the first. I agree that that is not ideal behaviour, but I matched the behaviour of the old `r` interface (which parsed the batch output) to preserve backwards compatibility.



---

archive/issue_comments_372927.json:
```json
{
    "body": "I begin to think that #26596 was a mistake.",
    "created_at": "2018-12-02T07:20:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372927",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I begin to think that #26596 was a mistake.



---

archive/issue_comments_372928.json:
```json
{
    "body": "Replying to [comment:31 charpent]:\n> I begin to think that #26596 was a mistake.\n\n\nTo qualify : R is a complex beast ; most notably, it offers some \"interactive\" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but //might// be used by //some// Sage users.\n\nSimilarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... \n\nAs far as I can tell, using `rpy2` (which entails \"batch mode\") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.\n\nI haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.\n\nThe only way out I can see //presently// is to\n* remove Sage's R,\n* depend on system's R,\n* disclaim usability of \"interactive\" R functions from Sage,\nwhich furthermore opens the nightmare of maintaining compatibility across versions.\n\nISTR that Erik Bray \"had ideas\" about how to do that.\n\nThoughts ?",
    "created_at": "2018-12-02T07:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372928",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:31 charpent]:
> I begin to think that #26596 was a mistake.


To qualify : R is a complex beast ; most notably, it offers some "interactive" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but //might// be used by //some// Sage users.

Similarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... 

As far as I can tell, using `rpy2` (which entails "batch mode") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.

I haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.

The only way out I can see //presently// is to
* remove Sage's R,
* depend on system's R,
* disclaim usability of "interactive" R functions from Sage,
which furthermore opens the nightmare of maintaining compatibility across versions.

ISTR that Erik Bray "had ideas" about how to do that.

Thoughts ?



---

archive/issue_comments_372929.json:
```json
{
    "body": "Replying to [comment:31 charpent]:\n> I begin to think that #26596 was a mistake.\n\n\nI very much disagree.\n\nReplying to [comment:32 charpent]:\n> Replying to [comment:31 charpent]:\n> > I begin to think that #26596 was a mistake.\n\n> \n> To qualify : R is a complex beast ; most notably, it offers some \"interactive\" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but //might// be used by //some// Sage users.\n\n\nDo you have any concrete example of some feature that worked before but doesn't work now?\n\n> Similarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... \n> \n> As far as I can tell, using `rpy2` (which entails \"batch mode\") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.\n\n\nIt was already \"batch mode\" before. Now it uses the C interface that R provides instead of parsing the REPL output, which is much more robust.\n\n> I haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.\n> \n> The only way out I can see //presently// is to\n> * remove Sage's R,\n> * depend on system's R,\n\n\nI don't see how any of these options would improve anything.\n\n> * disclaim usability of \"interactive\" R functions from Sage,\n> which furthermore opens the nightmare of maintaining compatibility across versions.\n\n\nThat nightmare is *exactly* the point of #26596.\n\n> ISTR that Erik Bray \"had ideas\" about how to do that.\n> \n> Thoughts ?",
    "created_at": "2018-12-02T09:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372929",
    "user": "https://github.com/timokau"
}
```

Replying to [comment:31 charpent]:
> I begin to think that #26596 was a mistake.


I very much disagree.

Replying to [comment:32 charpent]:
> Replying to [comment:31 charpent]:
> > I begin to think that #26596 was a mistake.

> 
> To qualify : R is a complex beast ; most notably, it offers some "interactive" abilities (e. g. finding a data point from a plot by clicking on it), which **I** don't use regularly, but //might// be used by //some// Sage users.


Do you have any concrete example of some feature that worked before but doesn't work now?

> Similarly, I know that (some) packages among the 13473 packages available as of this morning do engage in interaction with the users through widgets (e. g. Tcl/Tk), menus, dialog boxes, etc... 
> 
> As far as I can tell, using `rpy2` (which entails "batch mode") loses these abilities. Therefore, Sage's R can't replace system's R for these uses.


It was already "batch mode" before. Now it uses the C interface that R provides instead of parsing the REPL output, which is much more robust.

> I haven't the foggiest idea of the importance of these abilities for Sage's R users. Similarly, testing the 13474 available packages for usability with Sage's R seems undoable.
> 
> The only way out I can see //presently// is to
> * remove Sage's R,
> * depend on system's R,


I don't see how any of these options would improve anything.

> * disclaim usability of "interactive" R functions from Sage,
> which furthermore opens the nightmare of maintaining compatibility across versions.


That nightmare is *exactly* the point of #26596.

> ISTR that Erik Bray "had ideas" about how to do that.
> 
> Thoughts ?



---

archive/issue_comments_372930.json:
```json
{
    "body": "Not a blocker..",
    "created_at": "2018-12-12T14:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372930",
    "user": "https://github.com/vbraun"
}
```

Not a blocker..



---

archive/issue_comments_372931.json:
```json
{
    "body": "In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.\n\nThis is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.",
    "created_at": "2018-12-12T15:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372931",
    "user": "https://github.com/timokau"
}
```

In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.

This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.



---

archive/issue_comments_372932.json:
```json
{
    "body": "Replying to [comment:35 gh-timokau]:\n> In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.\n> \n> This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.\n\n\nI think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me \"two days\" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)",
    "created_at": "2018-12-12T18:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372932",
    "user": "https://github.com/embray"
}
```

Replying to [comment:35 gh-timokau]:
> In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.
> 
> This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.


I think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me "two days" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)



---

archive/issue_comments_372933.json:
```json
{
    "body": "Replying to [comment:35 gh-timokau]:\n\n[ Snip... ]\n\n> This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.\n\n\nSorry : this one slipped from my queue.\n\nWhat worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).\n\nFor example, in the \"help\" failures, we have a problem because the old expect interface happened to select whatever was available in an \"empty\" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).\n\nWe should :\n* document this behaviour\n* specify how to select the package containing the function we wissh help about\n* use this mechanism to specify explicitly the relevant library argument (\"base\", in our case) and test agaist this specific  help text.\n\nFurthermore, we should be aware of the possibility of such surprises. I do not see a way to search systematically for them. But I still think we should document te possibility of such surprises.",
    "created_at": "2018-12-12T20:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372933",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:35 gh-timokau]:

[ Snip... ]

> This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.


Sorry : this one slipped from my queue.

What worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).

For example, in the "help" failures, we have a problem because the old expect interface happened to select whatever was available in an "empty" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).

We should :
* document this behaviour
* specify how to select the package containing the function we wissh help about
* use this mechanism to specify explicitly the relevant library argument ("base", in our case) and test agaist this specific  help text.

Furthermore, we should be aware of the possibility of such surprises. I do not see a way to search systematically for them. But I still think we should document te possibility of such surprises.



---

archive/issue_comments_372934.json:
```json
{
    "body": "Replying to [comment:36 embray]:\n> Replying to [comment:35 gh-timokau]:\n> > In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.\n> > \n> > This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.\n\n> \n> I think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me \"two days\" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)\n\n\nWhy not the regular `# known failure` marker? Marking the whole file seems overkill.",
    "created_at": "2018-12-12T22:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372934",
    "user": "https://github.com/timokau"
}
```

Replying to [comment:36 embray]:
> Replying to [comment:35 gh-timokau]:
> > In my opinion any known issue that may cause test failures for some users should be a blocker. Test failures in a released sage version should always indicate that there is a real, not already reported issue.
> > 
> > This is very low severity, but if we can't solve it before release (waiting on `@`charpent's reply to my last post) I suggest that we at least mark the test as a known failure.

> 
> I think, if nothing else, the tests could be marked as known failures on the relevant system using #26784, which still needs review (annoyingly, considering that when I first raised the suggestion as a solution to a different problem Volker gave me "two days" to implement it as though that problem were high priority; I did it in one day and yet two weeks later...)


Why not the regular `# known failure` marker? Marking the whole file seems overkill.



---

archive/issue_comments_372935.json:
```json
{
    "body": "Replying to [comment:37 charpent]:\n> What worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).\n\n\nThe new R interface also effectively runs the equivalent to an interpreter internally.\n\n> For example, in the \"help\" failures, we have a problem because the old expect interface happened to select whatever was available in an \"empty\" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).\n\n\nIn fact I just tested the behaviour under the old interface. `r.library('nimble'); r.help('c')` hangs indefinitely. The old R interface was seriously broken. Which is why I was asking for a concrete regression (besides this help pages issue).\n\nThis issue in particular is due to R being too helpful and automatically piping the `help` output into a pager, even when called through the library. Because of that, rpy2 had to implement its own custom help implementation.\n\nI put a lot of effort into compatibility with the old interface (where it was not broken). So if there is a difference, that is a bug.",
    "created_at": "2018-12-12T22:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372935",
    "user": "https://github.com/timokau"
}
```

Replying to [comment:37 charpent]:
> What worries me is that we introduce two distinct behaviours (using the interpreter and using the interactive interface to the library) without documenting the difference (which used to be irrelevant).


The new R interface also effectively runs the equivalent to an interpreter internally.

> For example, in the "help" failures, we have a problem because the old expect interface happened to select whatever was available in an "empty" interpreter (implicitly launched by the interface), whereas our library call picks (the first available answer in installed packages (installation dependent).


In fact I just tested the behaviour under the old interface. `r.library('nimble'); r.help('c')` hangs indefinitely. The old R interface was seriously broken. Which is why I was asking for a concrete regression (besides this help pages issue).

This issue in particular is due to R being too helpful and automatically piping the `help` output into a pager, even when called through the library. Because of that, rpy2 had to implement its own custom help implementation.

I put a lot of effort into compatibility with the old interface (where it was not broken). So if there is a difference, that is a bug.



---

archive/issue_comments_372936.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-16T13:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372937.json:
```json
{
    "body": "Okay this should really be fixed now. I didn't actually use the new help function I wrote before, which is why it didn't work.\n\nThis time I made sure I reproduced the error before testing the fix. Sicne this fixes a regression, I think this should be included in the next rc.",
    "created_at": "2018-12-16T13:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372937",
    "user": "https://github.com/timokau"
}
```

Okay this should really be fixed now. I didn't actually use the new help function I wrote before, which is why it didn't work.

This time I made sure I reproduced the error before testing the fix. Sicne this fixes a regression, I think this should be included in the next rc.



---

archive/issue_comments_372938.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-16T13:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372938",
    "user": "https://github.com/timokau"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372939.json:
```json
{
    "body": "Not entirely sure if the original typo fix also belongs here. I have no idea why it worked before, but apparently it doesn't really matter weather its `RHOME` or `RHOMES`. Can't really hurt to fix it anyways though.",
    "created_at": "2018-12-16T13:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372939",
    "user": "https://github.com/timokau"
}
```

Not entirely sure if the original typo fix also belongs here. I have no idea why it worked before, but apparently it doesn't really matter weather its `RHOME` or `RHOMES`. Can't really hurt to fix it anyways though.



---

archive/issue_comments_372940.json:
```json
{
    "body": "Applied on top of 8.6.beta1, builds and passes ptestlong without any problem ==> `positive_review`.",
    "created_at": "2019-01-01T20:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372940",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Applied on top of 8.6.beta1, builds and passes ptestlong without any problem ==> `positive_review`.



---

archive/issue_comments_372941.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-01T20:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372941",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_372942.json:
```json
{
    "body": "Reviewer name...",
    "created_at": "2019-01-01T22:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372942",
    "user": "https://github.com/vbraun"
}
```

Reviewer name...



---

archive/issue_comments_372943.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-01-01T22:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372943",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_372944.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-01-02T04:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372944",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_372945.json:
```json
{
    "body": "Wups...",
    "created_at": "2019-01-02T04:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372945",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Wups...



---

archive/issue_events_066327.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-02T19:05:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26791#event-66327"
}
```



---

archive/issue_comments_372946.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-02T19:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26791#issuecomment-372946",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
