# Issue 26884: Replace Combinatorial Object to Clonable List in DyckWords

archive/issues_026647.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nPart of #26883 meta-ticket.\n\nWe also fix some plainly wrong enumerating code which considered [1,0,0] as a Dyck word. \n\nCC:  @vinklein @hivert\n\nComponent: **combinatorics**\n\nAuthor: **Adrien Boussicault, Florent Hivert**\n\nBranch/Commit: **[u/hivert/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/26884) @ [`15bc8f1`](https://github.com/sagemath/sagetrac-mirror/commit/15bc8f1e7c29c2b3972cda493fced39df5469b79)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26884_\n\n",
    "created_at": "2018-12-12T16:27:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Replace Combinatorial Object to Clonable List in DyckWords",
    "type": "issue",
    "updated_at": "2022-08-31T02:51:13Z",
    "url": "https://github.com/sagemath/sage/issues/26884",
    "user": "https://github.com/sagetrac-boussica"
}
```
<div id="comment:0"></div>

Part of #26883 meta-ticket.

We also fix some plainly wrong enumerating code which considered [1,0,0] as a Dyck word. 

CC:  @vinklein @hivert

Component: **combinatorics**

Author: **Adrien Boussicault, Florent Hivert**

Branch/Commit: **[u/hivert/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/26884) @ [`15bc8f1`](https://github.com/sagemath/sagetrac-mirror/commit/15bc8f1e7c29c2b3972cda493fced39df5469b79)**

_Issue created by migration from https://trac.sagemath.org/ticket/26884_





---

archive/issue_events_366344.json:
```json
{
    "actor": "https://github.com/sagetrac-boussica",
    "created_at": "2018-12-12T16:27:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366344"
}
```



---

archive/issue_events_366345.json:
```json
{
    "actor": "https://github.com/sagetrac-boussica",
    "created_at": "2018-12-12T16:27:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366345"
}
```



---

archive/issue_events_366346.json:
```json
{
    "actor": "https://github.com/sagetrac-boussica",
    "created_at": "2018-12-12T16:27:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366346"
}
```



---

archive/issue_events_366347.json:
```json
{
    "actor": "https://github.com/sagetrac-boussica",
    "created_at": "2018-12-12T16:27:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366347"
}
```



---

archive/issue_comments_413816.json:
```json
{
    "body": "Branch: **[u/boussica/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/boussica/26884)**",
    "created_at": "2018-12-12T16:31:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413816",
    "user": "https://github.com/sagetrac-boussica"
}
```

Branch: **[u/boussica/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/boussica/26884)**



---

archive/issue_comments_413817.json:
```json
{
    "body": "Commit: **[`a00075b`](https://github.com/sagemath/sagetrac-mirror/commit/a00075bc238ce6c73c8219a467a9380ce45ae689)**",
    "created_at": "2018-12-12T16:31:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413817",
    "user": "https://github.com/vinklein"
}
```

Commit: **[`a00075b`](https://github.com/sagemath/sagetrac-mirror/commit/a00075bc238ce6c73c8219a467a9380ce45ae689)**



---

archive/issue_comments_413818.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a00075bc238ce6c73c8219a467a9380ce45ae689\"><code>a00075b</code></a></td><td><code>trac #26884 To be continued ...</code></td></tr></table>\n",
    "created_at": "2018-12-12T16:31:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413818",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a00075bc238ce6c73c8219a467a9380ce45ae689"><code>a00075b</code></a></td><td><code>trac #26884 To be continued ...</code></td></tr></table>




---

archive/issue_comments_413819.json:
```json
{
    "body": "Changed branch from **[u/boussica/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/boussica/26884)** to **[u/vklein/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26884)**",
    "created_at": "2018-12-12T17:42:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413819",
    "user": "https://github.com/vinklein"
}
```

Changed branch from **[u/boussica/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/boussica/26884)** to **[u/vklein/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26884)**



---

archive/issue_comments_413820.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nrebase on 8.5.rc0\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f812f654feeeaf3b44a6ace92dd8fbe8a9cd5806\"><code>f812f65</code></a></td><td><code>trac #26884 To be continued ...</code></td></tr></table>\n",
    "created_at": "2018-12-12T17:43:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413820",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:4" align="right">comment:4</div>

rebase on 8.5.rc0

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f812f654feeeaf3b44a6ace92dd8fbe8a9cd5806"><code>f812f65</code></a></td><td><code>trac #26884 To be continued ...</code></td></tr></table>




---

archive/issue_comments_413821.json:
```json
{
    "body": "Changed commit from **[`a00075b`](https://github.com/sagemath/sagetrac-mirror/commit/a00075bc238ce6c73c8219a467a9380ce45ae689)** to **[`f812f65`](https://github.com/sagemath/sagetrac-mirror/commit/f812f654feeeaf3b44a6ace92dd8fbe8a9cd5806)**",
    "created_at": "2018-12-12T17:43:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413821",
    "user": "https://github.com/vinklein"
}
```

Changed commit from **[`a00075b`](https://github.com/sagemath/sagetrac-mirror/commit/a00075bc238ce6c73c8219a467a9380ce45ae689)** to **[`f812f65`](https://github.com/sagemath/sagetrac-mirror/commit/f812f654feeeaf3b44a6ace92dd8fbe8a9cd5806)**



---

archive/issue_comments_413822.json:
```json
{
    "body": "Changed branch from **[u/vklein/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26884)** to **[u/hivert/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/26884)**",
    "created_at": "2018-12-13T09:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413822",
    "user": "https://github.com/hivert"
}
```

Changed branch from **[u/vklein/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26884)** to **[u/hivert/26884](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/26884)**



---

archive/issue_comments_413823.json:
```json
{
    "body": "Changed commit from **[`f812f65`](https://github.com/sagemath/sagetrac-mirror/commit/f812f654feeeaf3b44a6ace92dd8fbe8a9cd5806)** to **[`3405fe3`](https://github.com/sagemath/sagetrac-mirror/commit/3405fe3d12d622697663a5e10bdb0b4c51b6d7ff)**",
    "created_at": "2018-12-14T15:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413823",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f812f65`](https://github.com/sagemath/sagetrac-mirror/commit/f812f654feeeaf3b44a6ace92dd8fbe8a9cd5806)** to **[`3405fe3`](https://github.com/sagemath/sagetrac-mirror/commit/3405fe3d12d622697663a5e10bdb0b4c51b6d7ff)**



---

archive/issue_comments_413824.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3405fe3d12d622697663a5e10bdb0b4c51b6d7ff\"><code>3405fe3</code></a></td><td><code>Fixed element construction</code></td></tr></table>\n",
    "created_at": "2018-12-14T15:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413824",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3405fe3d12d622697663a5e10bdb0b4c51b6d7ff"><code>3405fe3</code></a></td><td><code>Fixed element construction</code></td></tr></table>




---

archive/issue_comments_413825.json:
```json
{
    "body": "Changed commit from **[`3405fe3`](https://github.com/sagemath/sagetrac-mirror/commit/3405fe3d12d622697663a5e10bdb0b4c51b6d7ff)** to **[`3140ed5`](https://github.com/sagemath/sagetrac-mirror/commit/3140ed5aecba1b8f9b6b955fcd6b700d527d3628)**",
    "created_at": "2018-12-14T17:02:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413825",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3405fe3`](https://github.com/sagemath/sagetrac-mirror/commit/3405fe3d12d622697663a5e10bdb0b4c51b6d7ff)** to **[`3140ed5`](https://github.com/sagemath/sagetrac-mirror/commit/3140ed5aecba1b8f9b6b955fcd6b700d527d3628)**



---

archive/issue_comments_413826.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3140ed5aecba1b8f9b6b955fcd6b700d527d3628\"><code>3140ed5</code></a></td><td><code>Removed unneeded comparison stuff</code></td></tr></table>\n",
    "created_at": "2018-12-14T17:02:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413826",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3140ed5aecba1b8f9b6b955fcd6b700d527d3628"><code>3140ed5</code></a></td><td><code>Removed unneeded comparison stuff</code></td></tr></table>




---

archive/issue_events_366348.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-12-14T17:11:00Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "title_is": "Replace Combinatorial Object to Clonable List in DyckWords",
    "title_was": "Replace Combinatorial Object to Clonable List in DickWords",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366348"
}
```



---

archive/issue_events_366349.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-12-14T17:11:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366349"
}
```



---

archive/issue_comments_413827.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Part of #26883 meta-ticket.\n+\n+We also fix some plainly wrong enumerating code which considered [1,0,0] as a Dyck word. \n``````\n",
    "created_at": "2018-12-14T17:11:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413827",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Part of #26883 meta-ticket.
+
+We also fix some plainly wrong enumerating code which considered [1,0,0] as a Dyck word. 
``````




---

archive/issue_comments_413828.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\none pyflakes warning (see patchbot plugins); coverage not 100%",
    "created_at": "2018-12-15T08:01:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413828",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

one pyflakes warning (see patchbot plugins); coverage not 100%



---

archive/issue_events_366350.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-15T08:01:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366350"
}
```



---

archive/issue_events_366351.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-15T08:01:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366351"
}
```



---

archive/issue_events_366352.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-15T08:01:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366352"
}
```



---

archive/issue_events_366353.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-15T08:01:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366353"
}
```



---

archive/issue_comments_413829.json:
```json
{
    "body": "Changed commit from **[`3140ed5`](https://github.com/sagemath/sagetrac-mirror/commit/3140ed5aecba1b8f9b6b955fcd6b700d527d3628)** to **[`15bc8f1`](https://github.com/sagemath/sagetrac-mirror/commit/15bc8f1e7c29c2b3972cda493fced39df5469b79)**",
    "created_at": "2018-12-16T00:08:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413829",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3140ed5`](https://github.com/sagemath/sagetrac-mirror/commit/3140ed5aecba1b8f9b6b955fcd6b700d527d3628)** to **[`15bc8f1`](https://github.com/sagemath/sagetrac-mirror/commit/15bc8f1e7c29c2b3972cda493fced39df5469b79)**



---

archive/issue_comments_413830.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15bc8f1e7c29c2b3972cda493fced39df5469b79\"><code>15bc8f1</code></a></td><td><code>Coverage + removed unused Hash</code></td></tr></table>\n",
    "created_at": "2018-12-16T00:08:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413830",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15bc8f1e7c29c2b3972cda493fced39df5469b79"><code>15bc8f1</code></a></td><td><code>Coverage + removed unused Hash</code></td></tr></table>




---

archive/issue_comments_413831.json:
```json
{
    "body": "Changed author from **Adrien Boussicault** to **Adrien Boussicault, Florent Hivert**",
    "created_at": "2018-12-16T00:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413831",
    "user": "https://github.com/hivert"
}
```

Changed author from **Adrien Boussicault** to **Adrien Boussicault, Florent Hivert**



---

archive/issue_events_366354.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-12-16T00:09:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366354"
}
```



---

archive/issue_events_366355.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-12-16T00:09:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366355"
}
```



---

archive/issue_comments_413832.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n-1 on going through an essentially trivial `_element_constructor_` in internal code that should give valid output. At the very least, you should not run the checks when constructing objects from internal code.\n\nI am also a little skeptical of this change:\n\n```diff\n-        if isinstance(word, DyckWord) and word.parent() is self:\n+        D = DyckWords_all()\n+        if isinstance(word, DyckWord) and word.parent() is D:\n             return word\n-        return self.element_class(self, list(word))\n+        return D.element_class(D, word)\n```\n`_element_constructor_` should return an element of ``self`` as these are not fa\u00e7ade parents. (Actually, the first check here can be removed because the coercion framework would have already caught that case before it got to the `_element_constructor_`.)\n\nGiven this change, I am very nervous about the resulting parent of the Dyck path. I suspect you are doing this because `ClonableList` also includes the parent in the check and you are subsequently forcing everything to be elements of the `DyckWords_all` to have comparisons work. This is bad practice and can mask a host of other subtle issues, especially when mixing fa\u00e7ade parents with code that is making a parent act like a fa\u00e7ade parent.\n\nThis looks like a bug to me:\n\n```diff\n                 sage: DyckWords().height_poset().an_element()   # indirect doctest\n-                [1, 0, 1, 0, 1, 0, 1, 0, 1, 0]\n+                [1, 0, 1, 0, 1, 0, 1, 0, 1, 1]\n```",
    "created_at": "2018-12-16T01:00:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413832",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

-1 on going through an essentially trivial `_element_constructor_` in internal code that should give valid output. At the very least, you should not run the checks when constructing objects from internal code.

I am also a little skeptical of this change:

```diff
-        if isinstance(word, DyckWord) and word.parent() is self:
+        D = DyckWords_all()
+        if isinstance(word, DyckWord) and word.parent() is D:
             return word
-        return self.element_class(self, list(word))
+        return D.element_class(D, word)
```
`_element_constructor_` should return an element of ``self`` as these are not façade parents. (Actually, the first check here can be removed because the coercion framework would have already caught that case before it got to the `_element_constructor_`.)

Given this change, I am very nervous about the resulting parent of the Dyck path. I suspect you are doing this because `ClonableList` also includes the parent in the check and you are subsequently forcing everything to be elements of the `DyckWords_all` to have comparisons work. This is bad practice and can mask a host of other subtle issues, especially when mixing façade parents with code that is making a parent act like a façade parent.

This looks like a bug to me:

```diff
                 sage: DyckWords().height_poset().an_element()   # indirect doctest
-                [1, 0, 1, 0, 1, 0, 1, 0, 1, 0]
+                [1, 0, 1, 0, 1, 0, 1, 0, 1, 1]
```



---

archive/issue_events_366356.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-12-16T01:00:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366356"
}
```



---

archive/issue_events_366357.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-12-16T01:00:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366357"
}
```



---

archive/issue_events_366358.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366358"
}
```



---

archive/issue_events_366359.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366359"
}
```



---

archive/issue_comments_413833.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413833",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_413834.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413834",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_366360.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366360"
}
```



---

archive/issue_events_366361.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366361"
}
```



---

archive/issue_events_366362.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366362"
}
```



---

archive/issue_events_366363.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366363"
}
```



---

archive/issue_comments_413835.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nTickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413835",
    "user": "https://github.com/embray"
}
```

<div id="comment:16" align="right">comment:16</div>

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_comments_413836.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tscrim](#comment%3A12):\n> -1 on going through an essentially trivial `_element_constructor_` in internal code that should give valid output. At the very least, you should not run the checks when constructing objects from internal code.\n\nThis is something that we need to discuss in relation with set factories. The idea of those is to allow the user to change the class and parent on an enumerating algorithm. Here you hardcoded the class and the parent. I strongly disagree with that. I'm using  `_element_constructor_` as a single entry point to allows for customisation.\n \n> `_element_constructor_` should return an element of ``self`` as these are not fa\u00e7ade parents. (Actually, the first check here can be removed because the coercion framework would have already caught that case before it got to the `_element_constructor_`.)\n\nAgain this is something that shoul'nt be hard coded.\n\n> I suspect you are doing this because `ClonableList` also includes the parent in the check and you are subsequently forcing everything to be elements of the `DyckWords_all` to have comparisons work. \n\nI'm not doing anything particular with parent for comparison that following the standard `element.__richcmp__` mechanism which compare the parent or use a coercion mechanism to ensure that the elements have the same parent. It seem that you decided to change this overall policy for some particular combinatorial objects which confuses me. \n\n> This is bad practice and can mask a host of other subtle issues, especially when mixing fa\u00e7ade parents with code that is making a parent act like a fa\u00e7ade parent. \n\nAny examples ?",
    "created_at": "2019-06-21T08:21:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413836",
    "user": "https://github.com/hivert"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tscrim](#comment%3A12):
> -1 on going through an essentially trivial `_element_constructor_` in internal code that should give valid output. At the very least, you should not run the checks when constructing objects from internal code.

This is something that we need to discuss in relation with set factories. The idea of those is to allow the user to change the class and parent on an enumerating algorithm. Here you hardcoded the class and the parent. I strongly disagree with that. I'm using  `_element_constructor_` as a single entry point to allows for customisation.
 
> `_element_constructor_` should return an element of ``self`` as these are not façade parents. (Actually, the first check here can be removed because the coercion framework would have already caught that case before it got to the `_element_constructor_`.)

Again this is something that shoul'nt be hard coded.

> I suspect you are doing this because `ClonableList` also includes the parent in the check and you are subsequently forcing everything to be elements of the `DyckWords_all` to have comparisons work. 

I'm not doing anything particular with parent for comparison that following the standard `element.__richcmp__` mechanism which compare the parent or use a coercion mechanism to ensure that the elements have the same parent. It seem that you decided to change this overall policy for some particular combinatorial objects which confuses me. 

> This is bad practice and can mask a host of other subtle issues, especially when mixing façade parents with code that is making a parent act like a façade parent. 

Any examples ?



---

archive/issue_comments_413837.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413837",
    "user": "https://github.com/embray"
}
```

<div id="comment:18" align="right">comment:18</div>

Ticket retargeted after milestone closed



---

archive/issue_events_366364.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366364"
}
```



---

archive/issue_events_366365.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366365"
}
```



---

archive/issue_comments_413838.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413838",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_366366.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366366"
}
```



---

archive/issue_events_366367.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366367"
}
```



---

archive/issue_events_366368.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366368"
}
```



---

archive/issue_events_366369.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366369"
}
```



---

archive/issue_events_366370.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366370"
}
```



---

archive/issue_events_366371.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366371"
}
```



---

archive/issue_comments_413839.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413839",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_366372.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366372"
}
```



---

archive/issue_events_366373.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366373"
}
```



---

archive/issue_comments_413840.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26884#issuecomment-413840",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_366374.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366374"
}
```



---

archive/issue_events_366375.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366375"
}
```



---

archive/issue_events_366376.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366376"
}
```



---

archive/issue_events_366377.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366377"
}
```



---

archive/issue_events_366378.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366378"
}
```



---

archive/issue_events_366379.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26884",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26884#event-366379"
}
```
