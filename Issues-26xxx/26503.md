# Issue 26503: Numerical glitch causes error in computation of fundamental group of curves

archive/issues_026266.json:
```json
{
    "assignees": [],
    "body": "In Sage 8.3 we get the following (wrong) answer:\n\n```\nsage: var('t')\nsage: wp = QQ[t](t^2 + t + 1).roots(QQbar)[0][0]\nsage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)\nsage: R.<x,y> = Kw[]\nsage: z = 1\nsage: f = y * (y + (-wp - 1)) * x * (x - 1) * (x - y) * (x + (-wp - 1)*y - 1) * (x + (-wp - 1)*y + (wp))\nsage: from sage.schemes.curves import zariski_vankampen as zvk\nsage: zvk.fundamental_group(f)\nFinitely presented group < x0, x1, x2, x3, x5 | x2*x1*x2^-1*x1^-1, x1*x0*x1^-1*x0^-1, x5*x2*x5^-1*x2^-1, x0^-1*x3*x0*x3^-1, x0^-1*x2*x0*x2^-1, x1*x3*x1^-1*x3^-1, x5^-1*x0*x5*x0^-1, x3^-1*x5*x3*x5^-1, x1*x5*x1^-1*x5^-1 >\n```\n\nIt must be wrong because the abelianized must have rank 7, so it must have at least 7 generators.\n\nNote that Sage 8.1 used to give right answers.\n\nAnyways, I think I did find the problem. When computing the braids corresponding to each segment, the endpoints are represented by floating point numbers, which may cause some errors. Using algebraic numbers for this seems to solve the issue.\n\n\nCC:  @tscrim @slel @sagetrac-tmonteil\n\nKeywords: **braids, numerical, QQbar, 32bit**\n\nBranch/Commit: **[b91818d](https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb)**\n\nReviewer: **Travis Scrimshaw, Samuel Leli\u00e8vre, Fr\u00e9d\u00e9ric Chapoton, Thierry Monteil**\n\nAuthor: **Miguel Marco**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26503_\n\n",
    "closed_at": "2019-03-25T19:43:57Z",
    "created_at": "2018-10-18T12:43:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Numerical glitch causes error in computation of fundamental group of curves",
    "type": "issue",
    "updated_at": "2019-03-25T19:43:57Z",
    "url": "https://github.com/sagemath/sage/issues/26503",
    "user": "https://github.com/miguelmarco"
}
```
In Sage 8.3 we get the following (wrong) answer:

```
sage: var('t')
sage: wp = QQ[t](t^2 + t + 1).roots(QQbar)[0][0]
sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)
sage: R.<x,y> = Kw[]
sage: z = 1
sage: f = y * (y + (-wp - 1)) * x * (x - 1) * (x - y) * (x + (-wp - 1)*y - 1) * (x + (-wp - 1)*y + (wp))
sage: from sage.schemes.curves import zariski_vankampen as zvk
sage: zvk.fundamental_group(f)
Finitely presented group < x0, x1, x2, x3, x5 | x2*x1*x2^-1*x1^-1, x1*x0*x1^-1*x0^-1, x5*x2*x5^-1*x2^-1, x0^-1*x3*x0*x3^-1, x0^-1*x2*x0*x2^-1, x1*x3*x1^-1*x3^-1, x5^-1*x0*x5*x0^-1, x3^-1*x5*x3*x5^-1, x1*x5*x1^-1*x5^-1 >
```

It must be wrong because the abelianized must have rank 7, so it must have at least 7 generators.

Note that Sage 8.1 used to give right answers.

Anyways, I think I did find the problem. When computing the braids corresponding to each segment, the endpoints are represented by floating point numbers, which may cause some errors. Using algebraic numbers for this seems to solve the issue.


CC:  @tscrim @slel @sagetrac-tmonteil

Keywords: **braids, numerical, QQbar, 32bit**

Branch/Commit: **[b91818d](https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb)**

Reviewer: **Travis Scrimshaw, Samuel Lelièvre, Frédéric Chapoton, Thierry Monteil**

Author: **Miguel Marco**

_Issue created by migration from https://trac.sagemath.org/ticket/26503_





---

archive/issue_events_346942.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T12:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346942"
}
```



---

archive/issue_events_346943.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T12:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346943"
}
```



---

archive/issue_events_346944.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T12:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346944"
}
```



---

archive/issue_events_346945.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T12:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346945"
}
```



---

archive/issue_comments_411425.json:
```json
{
    "body": "Branch: **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)**",
    "created_at": "2018-10-18T13:03:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411425",
    "user": "https://github.com/miguelmarco"
}
```

Branch: **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)**



---

archive/issue_events_346946.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T13:04:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346946"
}
```



---

archive/issue_events_346947.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T13:04:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346947"
}
```



---

archive/issue_comments_411426.json:
```json
{
    "body": "Changed branch from **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)** to none",
    "created_at": "2018-10-18T13:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411426",
    "user": "https://github.com/miguelmarco"
}
```

Changed branch from **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)** to none



---

archive/issue_events_346948.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2018-10-18T13:12:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346948"
}
```



---

archive/issue_comments_411427.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nTrying to see if Miguel Marco's branch is still there.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0ee3943f4da0bf30c699ef0efb6272070166a11\">d0ee394</a></td><td><code>Use algebraic numbers to pin the beginning and end of braids</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb4c62438bccd3b0b29cae7f648ea2ad48f5da44\">cb4c624</a></td><td><code>Added docytest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b55efda8aa69d6cfa2d3eaf5493c84e031bdc2b\">7b55efd</a></td><td><code>Merge branch 'fixzvk' into t/26503/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves</code></td></tr></table>\n",
    "created_at": "2018-10-18T16:49:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411427",
    "user": "https://github.com/slel"
}
```

<div id="comment:4" align="right">Comment 4</div>

Trying to see if Miguel Marco's branch is still there.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0ee3943f4da0bf30c699ef0efb6272070166a11">d0ee394</a></td><td><code>Use algebraic numbers to pin the beginning and end of braids</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb4c62438bccd3b0b29cae7f648ea2ad48f5da44">cb4c624</a></td><td><code>Added docytest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b55efda8aa69d6cfa2d3eaf5493c84e031bdc2b">7b55efd</a></td><td><code>Merge branch 'fixzvk' into t/26503/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves</code></td></tr></table>




---

archive/issue_comments_411428.json:
```json
{
    "body": "Commit: **[7b55efd](https://github.com/sagemath/sagetrac-mirror/commit/7b55efda8aa69d6cfa2d3eaf5493c84e031bdc2b)**",
    "created_at": "2018-10-18T16:49:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411428",
    "user": "https://github.com/slel"
}
```

Commit: **[7b55efd](https://github.com/sagemath/sagetrac-mirror/commit/7b55efda8aa69d6cfa2d3eaf5493c84e031bdc2b)**



---

archive/issue_comments_411429.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,9 @@\n In Sage 8.3 we get the following (wrong) answer:\n-\n \n ```\n sage: var('t')\n-sage: wp = QQ[t](t^2+t+1).roots(QQbar)[0][0]\n-sage: Kw.<wp>=NumberField(wp.minpoly(), embedding=wp)\n+sage: wp = QQ[t](t^2 + t + 1).roots(QQbar)[0][0]\n+sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)\n sage: R.<x,y> = Kw[]\n sage: z = 1\n sage: f = y * (y + (-wp - 1)) * x * (x - 1) * (x - y) * (x + (-wp - 1)*y - 1) * (x + (-wp - 1)*y + (wp))\n@@ -19,4 +18,3 @@\n \n Anyways, I think I did find the problem. When computing the braids corresponding to each segment, the endpoints are represented by floating point numbers, which may cause some errors. Using algebraic numbers for this seems to solve the issue.\n \n-\n``````\n",
    "created_at": "2018-10-18T16:49:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411429",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,9 @@
 In Sage 8.3 we get the following (wrong) answer:
-
 
 ```
 sage: var('t')
-sage: wp = QQ[t](t^2+t+1).roots(QQbar)[0][0]
-sage: Kw.<wp>=NumberField(wp.minpoly(), embedding=wp)
+sage: wp = QQ[t](t^2 + t + 1).roots(QQbar)[0][0]
+sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)
 sage: R.<x,y> = Kw[]
 sage: z = 1
 sage: f = y * (y + (-wp - 1)) * x * (x - 1) * (x - y) * (x + (-wp - 1)*y - 1) * (x + (-wp - 1)*y + (wp))
@@ -19,4 +18,3 @@
 
 Anyways, I think I did find the problem. When computing the braids corresponding to each segment, the endpoints are represented by floating point numbers, which may cause some errors. Using algebraic numbers for this seems to solve the issue.
 
-
``````




---

archive/issue_comments_411430.json:
```json
{
    "body": "Branch: **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)**",
    "created_at": "2018-10-18T16:49:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411430",
    "user": "https://github.com/slel"
}
```

Branch: **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)**



---

archive/issue_comments_411431.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nSo this change will likely slow things down, but it will make things more numerically stable (as evidenced by this example).\n\nOne thing that should be changed:\n\n```diff\n-    TESTS::\n+    TESTS:\n \n-        # Check that # 26503 is fixed\n+    Check that :trac:`26503` is fixed::\n```",
    "created_at": "2018-10-18T17:03:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411431",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">Comment 5</div>

So this change will likely slow things down, but it will make things more numerically stable (as evidenced by this example).

One thing that should be changed:

```diff
-    TESTS::
+    TESTS:
 
-        # Check that # 26503 is fixed
+    Check that :trac:`26503` is fixed::
```



---

archive/issue_comments_411432.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nPushing the suggestion by Travis Scrimshaw a bit further, I would change\n\n```\n    TESTS::\n\n        # Check that # 26503 is fixed\n        sage: var('t')\n        sage: wp = QQ[t](t^2+t+1).roots(QQbar)[0][0]\n        sage: Kw.<wp>=NumberField(wp.minpoly(), embedding=wp)\n        sage: R.<x,y> = Kw[]\n        sage: z = 1\n        sage: f = y * (y + (-wp - 1)) * x * (x - 1) * (x - y) * (x + (-wp - 1)*y - 1) * (x + (-wp - 1)*y + (wp))\n        sage: from sage.schemes.curves import zariski_vankampen as zvk\n        sage: g = f.subs({x:x+y})\n        sage: g = g.subs({x:x+y})\n        sage: disc = zvk.discrim(g)\n        sage: segs = zvk.segments(disc)\n        sage: segs[16]\n        (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)\n        sage: zvk.braid_in_segment(g, *segs[16])  # optional - sirocco\n        s0*s1*s3*s5*s1^-1*s0^-1*s3^-1\n```\nto the following, if you agree it means the same (please double check):\n\n```\n    TESTS:\n\n    Check that :trac:`26503` is fixed::\n        \n        sage: wp = QQ['t']([1, 1, 1]).roots(QQbar)[0][0]\n        sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)\n        sage: R.<x, y> = Kw[]\n        sage: z = -wp - 1\n        sage: f = y*(y + z)*x*(x - 1)*(x - y)*(x + z*y - 1)*(x + z*y + wp)\n        sage: from sage.schemes.curves import zariski_vankampen as zvk\n        sage: g = f.subs({x: x + 2*y})\n        sage: disc = zvk.discrim(g)\n        sage: segs = zvk.segments(disc)\n        sage: segs[16]\n        (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)\n        sage: zvk.braid_in_segment(g, *segs[16])  # optional - sirocco\n        s0*s1*s3*s5*s1^-1*s0^-1*s3^-1\n```\nThis combines some pep8 fixes, getting rid of a symbolic variable,\nusing `z` to clarify `f`, and combining two `.subs` into a single one.",
    "created_at": "2018-10-18T17:31:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411432",
    "user": "https://github.com/slel"
}
```

<div id="comment:6" align="right">Comment 6</div>

Pushing the suggestion by Travis Scrimshaw a bit further, I would change

```
    TESTS::

        # Check that # 26503 is fixed
        sage: var('t')
        sage: wp = QQ[t](t^2+t+1).roots(QQbar)[0][0]
        sage: Kw.<wp>=NumberField(wp.minpoly(), embedding=wp)
        sage: R.<x,y> = Kw[]
        sage: z = 1
        sage: f = y * (y + (-wp - 1)) * x * (x - 1) * (x - y) * (x + (-wp - 1)*y - 1) * (x + (-wp - 1)*y + (wp))
        sage: from sage.schemes.curves import zariski_vankampen as zvk
        sage: g = f.subs({x:x+y})
        sage: g = g.subs({x:x+y})
        sage: disc = zvk.discrim(g)
        sage: segs = zvk.segments(disc)
        sage: segs[16]
        (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)
        sage: zvk.braid_in_segment(g, *segs[16])  # optional - sirocco
        s0*s1*s3*s5*s1^-1*s0^-1*s3^-1
```
to the following, if you agree it means the same (please double check):

```
    TESTS:

    Check that :trac:`26503` is fixed::
        
        sage: wp = QQ['t']([1, 1, 1]).roots(QQbar)[0][0]
        sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)
        sage: R.<x, y> = Kw[]
        sage: z = -wp - 1
        sage: f = y*(y + z)*x*(x - 1)*(x - y)*(x + z*y - 1)*(x + z*y + wp)
        sage: from sage.schemes.curves import zariski_vankampen as zvk
        sage: g = f.subs({x: x + 2*y})
        sage: disc = zvk.discrim(g)
        sage: segs = zvk.segments(disc)
        sage: segs[16]
        (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)
        sage: zvk.braid_in_segment(g, *segs[16])  # optional - sirocco
        s0*s1*s3*s5*s1^-1*s0^-1*s3^-1
```
This combines some pep8 fixes, getting rid of a symbolic variable,
using `z` to clarify `f`, and combining two `.subs` into a single one.



---

archive/issue_comments_411433.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@tscrim](#comment%3A5):\n> So this change will likely slow things down, but it will make things more numerically stable (as evidenced by this example).\n> \n\nYes, but on the other hand, the other minor change I made that computes radical of the polynomial before computing the discriminant would make things faster, so overall the change could actually be faster. \n\nSamuel: I think your change is better. I will push a commit with it tomorrow.",
    "created_at": "2018-10-18T20:31:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411433",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@tscrim](#comment%3A5):
> So this change will likely slow things down, but it will make things more numerically stable (as evidenced by this example).
> 

Yes, but on the other hand, the other minor change I made that computes radical of the polynomial before computing the discriminant would make things faster, so overall the change could actually be faster. 

Samuel: I think your change is better. I will push a commit with it tomorrow.



---

archive/issue_comments_411434.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ba2b90026614dad76caf4bb3406942529e2a9dd\">5ba2b90</a></td><td><code>Improve doctests with reviewers suggestions</code></td></tr></table>\n",
    "created_at": "2018-10-19T09:38:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411434",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8" align="right">Comment 8</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ba2b90026614dad76caf4bb3406942529e2a9dd">5ba2b90</a></td><td><code>Improve doctests with reviewers suggestions</code></td></tr></table>




---

archive/issue_comments_411435.json:
```json
{
    "body": "Changed commit from **[7b55efd](https://github.com/sagemath/sagetrac-mirror/commit/7b55efda8aa69d6cfa2d3eaf5493c84e031bdc2b)** to **[5ba2b90](https://github.com/sagemath/sagetrac-mirror/commit/5ba2b90026614dad76caf4bb3406942529e2a9dd)**",
    "created_at": "2018-10-19T09:38:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411435",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7b55efd](https://github.com/sagemath/sagetrac-mirror/commit/7b55efda8aa69d6cfa2d3eaf5493c84e031bdc2b)** to **[5ba2b90](https://github.com/sagemath/sagetrac-mirror/commit/5ba2b90026614dad76caf4bb3406942529e2a9dd)**



---

archive/issue_comments_411436.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nA blank line is needed between `::` and the code block.\n\nAlso, please consider simplifying\n\n```\n        sage: g = f.subs({x:x+y})\n        sage: g = g.subs({x:x+y})\n```\ninto\n\n```\n        sage: g = f.subs({x: x + 2*y})\n```",
    "created_at": "2018-10-19T09:53:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411436",
    "user": "https://github.com/slel"
}
```

<div id="comment:9" align="right">Comment 9</div>

A blank line is needed between `::` and the code block.

Also, please consider simplifying

```
        sage: g = f.subs({x:x+y})
        sage: g = g.subs({x:x+y})
```
into

```
        sage: g = f.subs({x: x + 2*y})
```



---

archive/issue_comments_411437.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e966770c36f215128d9362ee6e3b48908bf1ac4\">6e96677</a></td><td><code>Minor fix in the doctest</code></td></tr></table>\n",
    "created_at": "2018-10-19T10:27:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411437",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10" align="right">Comment 10</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e966770c36f215128d9362ee6e3b48908bf1ac4">6e96677</a></td><td><code>Minor fix in the doctest</code></td></tr></table>




---

archive/issue_comments_411438.json:
```json
{
    "body": "Changed commit from **[5ba2b90](https://github.com/sagemath/sagetrac-mirror/commit/5ba2b90026614dad76caf4bb3406942529e2a9dd)** to **[6e96677](https://github.com/sagemath/sagetrac-mirror/commit/6e966770c36f215128d9362ee6e3b48908bf1ac4)**",
    "created_at": "2018-10-19T10:27:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411438",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5ba2b90](https://github.com/sagemath/sagetrac-mirror/commit/5ba2b90026614dad76caf4bb3406942529e2a9dd)** to **[6e96677](https://github.com/sagemath/sagetrac-mirror/commit/6e966770c36f215128d9362ee6e3b48908bf1ac4)**



---

archive/issue_comments_411439.json:
```json
{
    "body": "Changed branch from **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)** to **[public/ticket/26503](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26503)**",
    "created_at": "2018-11-30T20:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411439",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves)** to **[public/ticket/26503](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26503)**



---

archive/issue_events_346949.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-30T20:38:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346949"
}
```



---

archive/issue_events_346950.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-11-30T20:38:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346950"
}
```



---

archive/issue_comments_411440.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Samuel Leli\u00e8vre, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2018-11-30T20:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411440",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Travis Scrimshaw, Samuel Lelièvre, Frédéric Chapoton**



---

archive/issue_comments_411441.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI have made some trivial changes, and I allow myself to  turn this to positive.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd8864eb439a85f6bb778259ff1996de468cc87e\">fd8864e</a></td><td><code>Merge branch 'u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves' in 8.5.b5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67f1188713d9f2ba52f649301073beb262008e08\">67f1188</a></td><td><code>trac 26503 some minor details</code></td></tr></table>\n",
    "created_at": "2018-11-30T20:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411441",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">Comment 11</div>

I have made some trivial changes, and I allow myself to  turn this to positive.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd8864eb439a85f6bb778259ff1996de468cc87e">fd8864e</a></td><td><code>Merge branch 'u/mmarco/numerical_glitch_causes_error_in_computation_of_fundamental_group_of_curves' in 8.5.b5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67f1188713d9f2ba52f649301073beb262008e08">67f1188</a></td><td><code>trac 26503 some minor details</code></td></tr></table>




---

archive/issue_comments_411442.json:
```json
{
    "body": "Changed commit from **[6e96677](https://github.com/sagemath/sagetrac-mirror/commit/6e966770c36f215128d9362ee6e3b48908bf1ac4)** to **[67f1188](https://github.com/sagemath/sagetrac-mirror/commit/67f1188713d9f2ba52f649301073beb262008e08)**",
    "created_at": "2018-11-30T20:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411442",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[6e96677](https://github.com/sagemath/sagetrac-mirror/commit/6e966770c36f215128d9362ee6e3b48908bf1ac4)** to **[67f1188](https://github.com/sagemath/sagetrac-mirror/commit/67f1188713d9f2ba52f649301073beb262008e08)**



---

archive/issue_comments_411443.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nOn 32-bit:\n\n```\nDoctesting 3781 files using 2 threads.\n**********************************************************************\nFile \"src/sage/schemes/curves/zariski_vankampen.py\", line 333, in sage.schemes.curves.zariski_vankampen.braid_in_segment\nFailed example:\n    segs[16]\nExpected:\n    (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)\nGot:\n    (3.82181265801140e-17 + 0.577350269189626*I,\n     -0.500000000000000 + 0.288675134594813*I)\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.schemes.curves.zariski_vankampen.braid_in_segment\n    [35 tests, 1 failure, 0.91 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/schemes/curves/zariski_vankampen.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2018-12-01T13:42:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411443",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">Comment 12</div>

On 32-bit:

```
Doctesting 3781 files using 2 threads.
**********************************************************************
File "src/sage/schemes/curves/zariski_vankampen.py", line 333, in sage.schemes.curves.zariski_vankampen.braid_in_segment
Failed example:
    segs[16]
Expected:
    (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)
Got:
    (3.82181265801140e-17 + 0.577350269189626*I,
     -0.500000000000000 + 0.288675134594813*I)
**********************************************************************
1 item had failures:
   1 of  15 in sage.schemes.curves.zariski_vankampen.braid_in_segment
    [35 tests, 1 failure, 0.91 s]
----------------------------------------------------------------------
sage -t --long src/sage/schemes/curves/zariski_vankampen.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_346951.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-01T13:42:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346951"
}
```



---

archive/issue_events_346952.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-12-01T13:42:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346952"
}
```



---

archive/issue_comments_411444.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1269f8c4d1c93a255c45d492ff7e717111f13518\">1269f8c</a></td><td><code>#26503 Add abs tol to one doctest</code></td></tr></table>\n",
    "created_at": "2019-01-10T19:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411444",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13" align="right">Comment 13</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1269f8c4d1c93a255c45d492ff7e717111f13518">1269f8c</a></td><td><code>#26503 Add abs tol to one doctest</code></td></tr></table>




---

archive/issue_comments_411445.json:
```json
{
    "body": "Changed commit from **[67f1188](https://github.com/sagemath/sagetrac-mirror/commit/67f1188713d9f2ba52f649301073beb262008e08)** to **[1269f8c](https://github.com/sagemath/sagetrac-mirror/commit/1269f8c4d1c93a255c45d492ff7e717111f13518)**",
    "created_at": "2019-01-10T19:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411445",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[67f1188](https://github.com/sagemath/sagetrac-mirror/commit/67f1188713d9f2ba52f649301073beb262008e08)** to **[1269f8c](https://github.com/sagemath/sagetrac-mirror/commit/1269f8c4d1c93a255c45d492ff7e717111f13518)**



---

archive/issue_comments_411446.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nAdded `# abs tol 1e-16`.",
    "created_at": "2019-01-10T19:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411446",
    "user": "https://github.com/slel"
}
```

<div id="comment:14" align="right">Comment 14</div>

Added `# abs tol 1e-16`.



---

archive/issue_events_346953.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-10T19:59:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346953"
}
```



---

archive/issue_events_346954.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-10T19:59:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346954"
}
```



---

archive/issue_events_346955.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-10T19:59:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346955"
}
```



---

archive/issue_events_346956.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-10T19:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346956"
}
```



---

archive/issue_comments_411447.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nok",
    "created_at": "2019-01-10T20:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411447",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">Comment 15</div>

ok



---

archive/issue_events_346957.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-10T20:04:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346957"
}
```



---

archive/issue_events_346958.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-10T20:04:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346958"
}
```



---

archive/issue_events_346959.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-20T00:09:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346959"
}
```



---

archive/issue_events_346960.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-20T00:09:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346960"
}
```



---

archive/issue_comments_411448.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nOn 32-bit: \n\n```\nFile \"src/sage/schemes/curves/zariski_vankampen.py\", line 333, in sage.schemes.curves.zariski_vankampen.braid_in_segment\nFailed example:\n    segs[16]  # abs tol 1e-16\nExpected:\n    (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)\nGot:\n    (3.82181265801140e-17 + 0.577350269189626*I,\n     -0.500000000000000 + 0.288675134594813*I)\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.schemes.curves.zariski_vankampen.braid_in_segment\n    [35 tests, 1 failure, 0.79 s]\n```",
    "created_at": "2019-01-20T00:09:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411448",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">Comment 16</div>

On 32-bit: 

```
File "src/sage/schemes/curves/zariski_vankampen.py", line 333, in sage.schemes.curves.zariski_vankampen.braid_in_segment
Failed example:
    segs[16]  # abs tol 1e-16
Expected:
    (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)
Got:
    (3.82181265801140e-17 + 0.577350269189626*I,
     -0.500000000000000 + 0.288675134594813*I)
**********************************************************************
1 item had failures:
   1 of  15 in sage.schemes.curves.zariski_vankampen.braid_in_segment
    [35 tests, 1 failure, 0.79 s]
```



---

archive/issue_comments_411449.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nThere is a sign problem, not only a matter of tolerance..",
    "created_at": "2019-01-20T08:06:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411449",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">Comment 17</div>

There is a sign problem, not only a matter of tolerance..



---

archive/issue_comments_411450.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nSeems the order of the elements in `disc` can vary.\n\nMaybe exactifying the elements of disc and sorting them would fix that:\n\n```\n        sage: wp = QQ['t']([1, 1, 1]).roots(QQbar)[0][0]\n        sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)\n        sage: R.<x, y> = Kw[]\n        sage: z = -wp - 1\n        sage: f = y*(y + z)*x*(x - 1)*(x - y)*(x + z*y - 1)*(x + z*y + wp)\n        sage: from sage.schemes.curves import zariski_vankampen as zvk\n        sage: g = f.subs({x: x + 2*y})\n        sage: disc = zvk.discrim(g)\n        sage: for a in disc: a.exactify()\n        sage: disc = sorted(disc)\n        sage: segs = zvk.segments(disc)\n        sage: segs[16]  # abs tol 1e-16\n        (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)\n```",
    "created_at": "2019-01-20T11:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411450",
    "user": "https://github.com/slel"
}
```

<div id="comment:18" align="right">Comment 18</div>

Seems the order of the elements in `disc` can vary.

Maybe exactifying the elements of disc and sorting them would fix that:

```
        sage: wp = QQ['t']([1, 1, 1]).roots(QQbar)[0][0]
        sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)
        sage: R.<x, y> = Kw[]
        sage: z = -wp - 1
        sage: f = y*(y + z)*x*(x - 1)*(x - y)*(x + z*y - 1)*(x + z*y + wp)
        sage: from sage.schemes.curves import zariski_vankampen as zvk
        sage: g = f.subs({x: x + 2*y})
        sage: disc = zvk.discrim(g)
        sage: for a in disc: a.exactify()
        sage: disc = sorted(disc)
        sage: segs = zvk.segments(disc)
        sage: segs[16]  # abs tol 1e-16
        (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)
```



---

archive/issue_comments_411451.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@slel](#comment%3A18):\n> Seems the order of the elements in `disc` can vary.\n> \n> Maybe exactifying the elements of disc and sorting them would fix that:\n> \n> ```\n>         sage: wp = QQ['t']([1, 1, 1]).roots(QQbar)[0][0]\n>         sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)\n>         sage: R.<x, y> = Kw[]\n>         sage: z = -wp - 1\n>         sage: f = y*(y + z)*x*(x - 1)*(x - y)*(x + z*y - 1)*(x + z*y + wp)\n>         sage: from sage.schemes.curves import zariski_vankampen as zvk\n>         sage: g = f.subs({x: x + 2*y})\n>         sage: disc = zvk.discrim(g)\n>         sage: for a in disc: a.exactify()\n>         sage: disc = sorted(disc)\n>         sage: segs = zvk.segments(disc)\n>         sage: segs[16]  # abs tol 1e-16\n>         (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)\n> ```\n\nYes, that is what I think too. The failing doctest relies on the order of the roots of the discriminant being fixed, which apparently might not be depending on the architecture (as the failing doctest shows). Samuel's proposal makes more sense.",
    "created_at": "2019-01-20T11:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411451",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@slel](#comment%3A18):
> Seems the order of the elements in `disc` can vary.
> 
> Maybe exactifying the elements of disc and sorting them would fix that:
> 
> ```
>         sage: wp = QQ['t']([1, 1, 1]).roots(QQbar)[0][0]
>         sage: Kw.<wp> = NumberField(wp.minpoly(), embedding=wp)
>         sage: R.<x, y> = Kw[]
>         sage: z = -wp - 1
>         sage: f = y*(y + z)*x*(x - 1)*(x - y)*(x + z*y - 1)*(x + z*y + wp)
>         sage: from sage.schemes.curves import zariski_vankampen as zvk
>         sage: g = f.subs({x: x + 2*y})
>         sage: disc = zvk.discrim(g)
>         sage: for a in disc: a.exactify()
>         sage: disc = sorted(disc)
>         sage: segs = zvk.segments(disc)
>         sage: segs[16]  # abs tol 1e-16
>         (0.577350269189626*I, 0.500000000000000 + 0.288675134594813*I)
> ```

Yes, that is what I think too. The failing doctest relies on the order of the roots of the discriminant being fixed, which apparently might not be depending on the architecture (as the failing doctest shows). Samuel's proposal makes more sense.



---

archive/issue_comments_411452.json:
```json
{
    "body": "Changed commit from **[1269f8c](https://github.com/sagemath/sagetrac-mirror/commit/1269f8c4d1c93a255c45d492ff7e717111f13518)** to **[98c921d](https://github.com/sagemath/sagetrac-mirror/commit/98c921d1de31190676c339133c57b91fedd4cb74)**",
    "created_at": "2019-01-20T15:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411452",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1269f8c](https://github.com/sagemath/sagetrac-mirror/commit/1269f8c4d1c93a255c45d492ff7e717111f13518)** to **[98c921d](https://github.com/sagemath/sagetrac-mirror/commit/98c921d1de31190676c339133c57b91fedd4cb74)**



---

archive/issue_comments_411453.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/98c921d1de31190676c339133c57b91fedd4cb74\">98c921d</a></td><td><code>Sort to make braid_in_segment doctest pass on 32-bit</code></td></tr></table>\n",
    "created_at": "2019-01-20T15:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411453",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20" align="right">Comment 20</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/98c921d1de31190676c339133c57b91fedd4cb74">98c921d</a></td><td><code>Sort to make braid_in_segment doctest pass on 32-bit</code></td></tr></table>




---

archive/issue_comments_411454.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nPushed a commit to add this exactifying and sorting. Can someone test on 32-bit?",
    "created_at": "2019-01-20T15:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411454",
    "user": "https://github.com/slel"
}
```

<div id="comment:21" align="right">Comment 21</div>

Pushed a commit to add this exactifying and sorting. Can someone test on 32-bit?



---

archive/issue_events_346961.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-20T15:05:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346961"
}
```



---

archive/issue_events_346962.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-20T15:05:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346962"
}
```



---

archive/issue_comments_411455.json:
```json
{
    "body": "Changed keywords from none to **braids, numerical, QQbar, 32bit**",
    "created_at": "2019-01-20T23:36:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411455",
    "user": "https://github.com/slel"
}
```

Changed keywords from none to **braids, numerical, QQbar, 32bit**



---

archive/issue_comments_411456.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nPatchbot seems to have trouble with it, plus one of them is getting an error with `sirocco`:\n\n```\nFile \"src/sage/schemes/curves/zariski_vankampen.py\", line 337, in sage.schemes.curves.zariski_vankampen.braid_in_segment\nFailed example:\n    zvk.braid_in_segment(g, *segs[16])  # optional - sirocco\nExpected:\n    s0*s1*s3*s5*s1^-1*s0^-1*s3^-1\nGot:\n    s5^-1*s3*s0*s1*s0*s3^-1*s4^-1*s3^-1*s2^-1\n```",
    "created_at": "2019-01-21T00:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411456",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:23" align="right">Comment 23</div>

Patchbot seems to have trouble with it, plus one of them is getting an error with `sirocco`:

```
File "src/sage/schemes/curves/zariski_vankampen.py", line 337, in sage.schemes.curves.zariski_vankampen.braid_in_segment
Failed example:
    zvk.braid_in_segment(g, *segs[16])  # optional - sirocco
Expected:
    s0*s1*s3*s5*s1^-1*s0^-1*s3^-1
Got:
    s5^-1*s3*s0*s1*s0*s3^-1*s4^-1*s3^-1*s2^-1
```



---

archive/issue_comments_411457.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nLet me run a 32-bit patchbot on it.",
    "created_at": "2019-01-21T13:18:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411457",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:24" align="right">Comment 24</div>

Let me run a 32-bit patchbot on it.



---

archive/issue_events_346963.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2019-01-24T08:21:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346963"
}
```



---

archive/issue_events_346964.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2019-01-24T08:21:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346964"
}
```



---

archive/issue_comments_411458.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nMy 32-bit patchbot is unhappy :(",
    "created_at": "2019-01-24T08:21:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411458",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:25" align="right">Comment 25</div>

My 32-bit patchbot is unhappy :(



---

archive/issue_comments_411459.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nOrder seems to depend on the platform, so we can't rely on `segs[16]` and we need a better doctest.",
    "created_at": "2019-01-24T09:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411459",
    "user": "https://github.com/slel"
}
```

<div id="comment:26" align="right">Comment 26</div>

Order seems to depend on the platform, so we can't rely on `segs[16]` and we need a better doctest.



---

archive/issue_comments_411460.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nCan you check if the discrepancy on the order appears on `disc` or `segs` ?\n\nAnyways, maybe the right thing to do about this doctest is to be explicit and give the specific segment to test?",
    "created_at": "2019-02-20T18:01:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411460",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:27" align="right">Comment 27</div>

Can you check if the discrepancy on the order appears on `disc` or `segs` ?

Anyways, maybe the right thing to do about this doctest is to be explicit and give the specific segment to test?



---

archive/issue_comments_411461.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nWhat precisely is that part of the doctest suppose to be testing?",
    "created_at": "2019-02-20T20:36:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411461",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:28" align="right">Comment 28</div>

What precisely is that part of the doctest suppose to be testing?



---

archive/issue_comments_411462.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nIt is testing the computation of the braid along the segment. The segments are created from the Voronoi diagram of the points in disc. We compute them all, and pick a specific one (where the bug shows up) and test it. The problem seems to be that the orderof the computed segments seems to deppend on the platform, so we are picking a different one on 32 bits, and get different results.",
    "created_at": "2019-02-20T20:47:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411462",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:29" align="right">Comment 29</div>

It is testing the computation of the braid along the segment. The segments are created from the Voronoi diagram of the points in disc. We compute them all, and pick a specific one (where the bug shows up) and test it. The problem seems to be that the orderof the computed segments seems to deppend on the platform, so we are picking a different one on 32 bits, and get different results.



---

archive/issue_comments_411463.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nSo if the bug is showing up in that specific segment, perhaps the thing to do is isolate that segment, maybe by checking if that segment is in `segs` and then passing it to `braid_in_segments`?",
    "created_at": "2019-02-20T20:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411463",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:30" align="right">Comment 30</div>

So if the bug is showing up in that specific segment, perhaps the thing to do is isolate that segment, maybe by checking if that segment is in `segs` and then passing it to `braid_in_segments`?



---

archive/issue_comments_411464.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nAh, wait, that won't work outright because of the numerical noise.",
    "created_at": "2019-02-20T20:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411464",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:31" align="right">Comment 31</div>

Ah, wait, that won't work outright because of the numerical noise.



---

archive/issue_comments_411465.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nPerhaps instead of that specific segment, we check\n\n```\ns0*s1*s3*s5*s1^-1*s0^-1*s3^-1 in [zvk.braid_in_segment(g,s) for s in segs]\n```\nI guess we could then get the index of that braid in the corresponding list and then check the segment itself (if you also want to show that output).",
    "created_at": "2019-02-20T20:56:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411465",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:32" align="right">Comment 32</div>

Perhaps instead of that specific segment, we check

```
s0*s1*s3*s5*s1^-1*s0^-1*s3^-1 in [zvk.braid_in_segment(g,s) for s in segs]
```
I guess we could then get the index of that braid in the corresponding list and then check the segment itself (if you also want to show that output).



---

archive/issue_comments_411466.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a34879716cd44f1e6bd2375e68c72a693a52abac\">a348797</a></td><td><code>Use algebraic numbers to pin the beginning and end of braids</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3cd564fd3fcb3754a3b7e51179b64574a998234\">b3cd564</a></td><td><code>Added docytest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/446a5fb963c2a00e29156e3347fde31afb8110d8\">446a5fb</a></td><td><code>Improve doctests with reviewers suggestions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/666941e714558ec4aeff25838e550af310450ba0\">666941e</a></td><td><code>Minor fix in the doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/581cf35c17e497f2ff77df9f10f35fb57a1d2823\">581cf35</a></td><td><code>trac 26503 some minor details</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f081a6831b8576630cda1b111c497e6e651b268\">2f081a6</a></td><td><code>#26503 Add abs tol to one doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c74d7a2410e4214eb6b8c7dc26973a39f41b4d9\">5c74d7a</a></td><td><code>Sort to make braid_in_segment doctest pass on 32-bit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a1af794c1da83c1bb1097abae101f35dd551041\">1a1af79</a></td><td><code>Explicit path in doctest for braid_in_segment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5012a7ab8e44b38aa55a9266f89d10a7f6773f53\">5012a7a</a></td><td><code>Merge branch 'public/ticket/26503' of git://trac.sagemath.org/sage into t/26503/public/ticket/26503</code></td></tr></table>\n",
    "created_at": "2019-02-20T20:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411466",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33" align="right">Comment 33</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a34879716cd44f1e6bd2375e68c72a693a52abac">a348797</a></td><td><code>Use algebraic numbers to pin the beginning and end of braids</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3cd564fd3fcb3754a3b7e51179b64574a998234">b3cd564</a></td><td><code>Added docytest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/446a5fb963c2a00e29156e3347fde31afb8110d8">446a5fb</a></td><td><code>Improve doctests with reviewers suggestions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/666941e714558ec4aeff25838e550af310450ba0">666941e</a></td><td><code>Minor fix in the doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/581cf35c17e497f2ff77df9f10f35fb57a1d2823">581cf35</a></td><td><code>trac 26503 some minor details</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f081a6831b8576630cda1b111c497e6e651b268">2f081a6</a></td><td><code>#26503 Add abs tol to one doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c74d7a2410e4214eb6b8c7dc26973a39f41b4d9">5c74d7a</a></td><td><code>Sort to make braid_in_segment doctest pass on 32-bit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a1af794c1da83c1bb1097abae101f35dd551041">1a1af79</a></td><td><code>Explicit path in doctest for braid_in_segment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5012a7ab8e44b38aa55a9266f89d10a7f6773f53">5012a7a</a></td><td><code>Merge branch 'public/ticket/26503' of git://trac.sagemath.org/sage into t/26503/public/ticket/26503</code></td></tr></table>




---

archive/issue_comments_411467.json:
```json
{
    "body": "Changed commit from **[98c921d](https://github.com/sagemath/sagetrac-mirror/commit/98c921d1de31190676c339133c57b91fedd4cb74)** to **[5012a7a](https://github.com/sagemath/sagetrac-mirror/commit/5012a7ab8e44b38aa55a9266f89d10a7f6773f53)**",
    "created_at": "2019-02-20T20:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411467",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[98c921d](https://github.com/sagemath/sagetrac-mirror/commit/98c921d1de31190676c339133c57b91fedd4cb74)** to **[5012a7a](https://github.com/sagemath/sagetrac-mirror/commit/5012a7ab8e44b38aa55a9266f89d10a7f6773f53)**



---

archive/issue_comments_411468.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nI changed the doctest by giving explicitely the endpoints of the path. It still detects the bug.\n\nI didn't test it in a 32 bits system though.",
    "created_at": "2019-02-20T20:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411468",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:34" align="right">Comment 34</div>

I changed the doctest by giving explicitely the endpoints of the path. It still detects the bug.

I didn't test it in a 32 bits system though.



---

archive/issue_events_346965.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2019-02-20T21:01:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346965"
}
```



---

archive/issue_events_346966.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2019-02-20T21:01:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346966"
}
```



---

archive/issue_comments_411469.json:
```json
{
    "body": "Changed commit from **[5012a7a](https://github.com/sagemath/sagetrac-mirror/commit/5012a7ab8e44b38aa55a9266f89d10a7f6773f53)** to **[bfa164b](https://github.com/sagemath/sagetrac-mirror/commit/bfa164b0e61abd54a3fb87fc366ce0b1ff470169)**",
    "created_at": "2019-02-20T21:22:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411469",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5012a7a](https://github.com/sagemath/sagetrac-mirror/commit/5012a7ab8e44b38aa55a9266f89d10a7f6773f53)** to **[bfa164b](https://github.com/sagemath/sagetrac-mirror/commit/bfa164b0e61abd54a3fb87fc366ce0b1ff470169)**



---

archive/issue_comments_411470.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfa164b0e61abd54a3fb87fc366ce0b1ff470169\">bfa164b</a></td><td><code>Use left normal form of braid in doctest</code></td></tr></table>\n",
    "created_at": "2019-02-20T21:22:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411470",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36" align="right">Comment 36</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfa164b0e61abd54a3fb87fc366ce0b1ff470169">bfa164b</a></td><td><code>Use left normal form of braid in doctest</code></td></tr></table>




---

archive/issue_comments_411471.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nThe changes are good with me, but you need to mark 2 doctests with `# optional - sirocco` (see pathcbot). Thierry, can you run your 32-bit patchbot on this?",
    "created_at": "2019-02-20T23:36:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411471",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:37" align="right">Comment 37</div>

The changes are good with me, but you need to mark 2 doctests with `# optional - sirocco` (see pathcbot). Thierry, can you run your 32-bit patchbot on this?



---

archive/issue_comments_411472.json:
```json
{
    "body": "Changed commit from **[bfa164b](https://github.com/sagemath/sagetrac-mirror/commit/bfa164b0e61abd54a3fb87fc366ce0b1ff470169)** to **[b91818d](https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb)**",
    "created_at": "2019-03-12T20:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411472",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bfa164b](https://github.com/sagemath/sagetrac-mirror/commit/bfa164b0e61abd54a3fb87fc366ce0b1ff470169)** to **[b91818d](https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb)**



---

archive/issue_comments_411473.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a9594754bb77b6bddae40a181155acde396e7b5\">0a95947</a></td><td><code>Merge branch 'public/ticket/26503' in 8.7.b7</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb\">b91818d</a></td><td><code>adding the optional - sirocco tags</code></td></tr></table>\n",
    "created_at": "2019-03-12T20:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411473",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38" align="right">Comment 38</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a9594754bb77b6bddae40a181155acde396e7b5">0a95947</a></td><td><code>Merge branch 'public/ticket/26503' in 8.7.b7</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb">b91818d</a></td><td><code>adding the optional - sirocco tags</code></td></tr></table>




---

archive/issue_comments_411474.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nI have added the 2 missing sirocco tags",
    "created_at": "2019-03-12T20:51:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411474",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:39" align="right">Comment 39</div>

I have added the 2 missing sirocco tags



---

archive/issue_comments_411475.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nSorry, this fell off my radar by the time I got to a place where I could have made those modifications. Thank you Fr\u00e9d\u00e9ric for the fix and the reminder.\n\nCan someone with a 32-bit machine retest this for completeness?",
    "created_at": "2019-03-12T22:45:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411475",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:40" align="right">Comment 40</div>

Sorry, this fell off my radar by the time I got to a place where I could have made those modifications. Thank you Frédéric for the fix and the reminder.

Can someone with a 32-bit machine retest this for completeness?



---

archive/issue_comments_411476.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\n@sagetrac-tmonteil: Thierry, please launch your 32 bit patchbot on this ticket",
    "created_at": "2019-03-19T10:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411476",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:41" align="right">Comment 41</div>

@sagetrac-tmonteil: Thierry, please launch your 32 bit patchbot on this ticket



---

archive/issue_comments_411477.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nOK. I have to reboostrap one patchbot, so do not expect some result before this evening.",
    "created_at": "2019-03-19T11:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411477",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:42" align="right">Comment 42</div>

OK. I have to reboostrap one patchbot, so do not expect some result before this evening.



---

archive/issue_comments_411478.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A42):\n> OK. I have to reboostrap one patchbot, so do not expect some result before this evening.\n\nNo problem. Thank you for doing that.",
    "created_at": "2019-03-19T11:40:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411478",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:43" align="right">Comment 43</div>

Replying to [@sagetrac-tmonteil](#comment%3A42):
> OK. I have to reboostrap one patchbot, so do not expect some result before this evening.

No problem. Thank you for doing that.



---

archive/issue_comments_411479.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nThis looks good now on 32bit, see https://patchbot.sagemath.org/log/26503/debian/9.7/i686/4.9.0-7-686/tmonteil-debian-stretch-32/2019-03-21%2013:03:07.\n\nThere is an error for the file `src/sage/tests/books/computational-mathematics-with-sagemath/graphique_doctest.py` but it also exists for ticket 0, see https://patchbot.sagemath.org/ticket/0/ so it is unrelated to this ticket.",
    "created_at": "2019-03-21T16:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411479",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:44" align="right">Comment 44</div>

This looks good now on 32bit, see https://patchbot.sagemath.org/log/26503/debian/9.7/i686/4.9.0-7-686/tmonteil-debian-stretch-32/2019-03-21%2013:03:07.

There is an error for the file `src/sage/tests/books/computational-mathematics-with-sagemath/graphique_doctest.py` but it also exists for ticket 0, see https://patchbot.sagemath.org/ticket/0/ so it is unrelated to this ticket.



---

archive/issue_comments_411480.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw, Samuel Leli\u00e8vre, Fr\u00e9d\u00e9ric Chapoton** to **Travis Scrimshaw, Samuel Leli\u00e8vre, Fr\u00e9d\u00e9ric Chapoton, Thierry Monteil**",
    "created_at": "2019-03-21T16:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411480",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed reviewer from **Travis Scrimshaw, Samuel Lelièvre, Frédéric Chapoton** to **Travis Scrimshaw, Samuel Lelièvre, Frédéric Chapoton, Thierry Monteil**



---

archive/issue_comments_411481.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nThe error is actually tracked at #27250.",
    "created_at": "2019-03-21T16:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411481",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:45" align="right">Comment 45</div>

The error is actually tracked at #27250.



---

archive/issue_events_346967.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-21T23:16:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346967"
}
```



---

archive/issue_events_346968.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-21T23:16:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346968"
}
```



---

archive/issue_comments_411482.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nThank you. I am now setting this to positive review.",
    "created_at": "2019-03-21T23:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411482",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:46" align="right">Comment 46</div>

Thank you. I am now setting this to positive review.



---

archive/issue_comments_411483.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nThere's been a lot of trial and error on this, do we want to keep all these commits?\nWe could squash to a single commit instead -- I'm fine either way.",
    "created_at": "2019-03-22T08:06:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411483",
    "user": "https://github.com/slel"
}
```

<div id="comment:47" align="right">Comment 47</div>

There's been a lot of trial and error on this, do we want to keep all these commits?
We could squash to a single commit instead -- I'm fine either way.



---

archive/issue_events_346969.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346969"
}
```



---

archive/issue_events_346970.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346970"
}
```



---

archive/issue_comments_411484.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411484",
    "user": "https://github.com/embray"
}
```

<div id="comment:48" align="right">Comment 48</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_411485.json:
```json
{
    "body": "Changed branch from **[public/ticket/26503](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26503)** to **[b91818d](https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb)**",
    "created_at": "2019-03-25T19:43:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26503#issuecomment-411485",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/26503](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/26503)** to **[b91818d](https://github.com/sagemath/sagetrac-mirror/commit/b91818d769ea9bfd81b37d46a50d8dcc6d04a3eb)**



---

archive/issue_events_346971.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:43:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346971"
}
```



---

archive/issue_events_346972.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "cdbd7f6480abc17f88db691ce758df092edb994a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-25T19:43:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26503",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26503#event-346972"
}
```
