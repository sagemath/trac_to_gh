# Issue 26176: SageKernelSpec doctests fail in non-standard setups

archive/issues_025939.json:
```json
{
    "body": "In Debian's setup most `SageKernelSpec` doctests fail because Sage isn't installed in the final location when the doctest run and therefore `_mkdirs()` fails as it can't write to `/usr/share`.\n\nIn any case, `setup.py` installs into `install_data` but the doctests don't run there. We could probably just have the tests run there as well but also much of the tests that perform writes don't work there and are therefore disabled. I can see why the tests are the way they are but I don't think it's worth it. I think it's easier for packagers and good enough for [SageMath](SageMath) to just run all the tests in temporary places.\n\nCC:  @timokau @jdemeyer\n\nBranch/Commit: dacbb470150a1be92af5367e880fdb939458ee84\n\nReviewer: Jeroen Demeyer\n\nAuthor: Julian R\u00fcth\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26176\n\n",
    "closed_at": "2018-10-26T22:16:00Z",
    "created_at": "2018-09-02T14:58:19Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "SageKernelSpec doctests fail in non-standard setups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26176",
    "user": "https://github.com/saraedum"
}
```
In Debian's setup most `SageKernelSpec` doctests fail because Sage isn't installed in the final location when the doctest run and therefore `_mkdirs()` fails as it can't write to `/usr/share`.

In any case, `setup.py` installs into `install_data` but the doctests don't run there. We could probably just have the tests run there as well but also much of the tests that perform writes don't work there and are therefore disabled. I can see why the tests are the way they are but I don't think it's worth it. I think it's easier for packagers and good enough for [SageMath](SageMath) to just run all the tests in temporary places.

CC:  @timokau @jdemeyer

Branch/Commit: dacbb470150a1be92af5367e880fdb939458ee84

Reviewer: Jeroen Demeyer

Author: Julian Rüth

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26176





---

archive/issue_comments_496590.json:
```json
{
    "body": "Changing branch from \"\" to \"u/saraedum/26176\"",
    "created_at": "2018-09-02T14:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496590",
    "user": "https://github.com/saraedum"
}
```

Changing branch from "" to "u/saraedum/26176"



---

archive/issue_comments_496591.json:
```json
{
    "body": "Changing commit from \"\" to \"32b262d43711f7901cfaed43f6a0d7fa3c9bff34\"",
    "created_at": "2018-09-02T15:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496591",
    "user": "https://github.com/saraedum"
}
```

Changing commit from "" to "32b262d43711f7901cfaed43f6a0d7fa3c9bff34"



---

archive/issue_comments_496592.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-02T15:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496592",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_496593.json:
```json
{
    "body": "Changing author from \"\" to \"Julian R\u00fcth\"",
    "created_at": "2018-09-02T15:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496593",
    "user": "https://github.com/saraedum"
}
```

Changing author from "" to "Julian Rüth"



---

archive/issue_comments_496594.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[32b262d](https://github.com/sagemath/sagetrac-mirror/commit/32b262d43711f7901cfaed43f6a0d7fa3c9bff34)|`Make SageKernelSpec tests pass if Sage is not installed yet`|",
    "created_at": "2018-09-02T15:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496594",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[32b262d](https://github.com/sagemath/sagetrac-mirror/commit/32b262d43711f7901cfaed43f6a0d7fa3c9bff34)|`Make SageKernelSpec tests pass if Sage is not installed yet`|



---

archive/issue_comments_496595.json:
```json
{
    "body": "<a id='comment:3'></a>\nI'm confused, isn't that the same fix as in #25722?",
    "created_at": "2018-09-02T15:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496595",
    "user": "https://github.com/timokau"
}
```

<a id='comment:3'></a>
I'm confused, isn't that the same fix as in #25722?



---

archive/issue_comments_496596.json:
```json
{
    "body": "<a id='comment:4'></a>\nYes, sort of. But #25722 only does that for the symlinks. Here I do the same for all the `_mkdirs()` calls.",
    "created_at": "2018-09-02T17:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496596",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:4'></a>
Yes, sort of. But #25722 only does that for the symlinks. Here I do the same for all the `_mkdirs()` calls.



---

archive/issue_comments_496597.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2018-09-03T08:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496597",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_496598.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-03T08:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496598",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_496599.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-09-03T11:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496599",
    "user": "https://github.com/saraedum"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_496600.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[dacbb47](https://github.com/sagemath/sagetrac-mirror/commit/dacbb470150a1be92af5367e880fdb939458ee84)|`Fix a classmethod test`|",
    "created_at": "2018-09-03T12:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496600",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[dacbb47](https://github.com/sagemath/sagetrac-mirror/commit/dacbb470150a1be92af5367e880fdb939458ee84)|`Fix a classmethod test`|



---

archive/issue_comments_496601.json:
```json
{
    "body": "Changing commit from \"32b262d43711f7901cfaed43f6a0d7fa3c9bff34\" to \"dacbb470150a1be92af5367e880fdb939458ee84\"",
    "created_at": "2018-09-03T12:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "32b262d43711f7901cfaed43f6a0d7fa3c9bff34" to "dacbb470150a1be92af5367e880fdb939458ee84"



---

archive/issue_comments_496602.json:
```json
{
    "body": "<a id='comment:8'></a>\nSorry, I had missed this confusing invocation.",
    "created_at": "2018-09-03T12:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496602",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:8'></a>
Sorry, I had missed this confusing invocation.



---

archive/issue_comments_496603.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-03T12:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496603",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_496604.json:
```json
{
    "body": "<a id='comment:9'></a>\nI think this can be safely put back to positive review.",
    "created_at": "2018-10-25T01:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496604",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
I think this can be safely put back to positive review.



---

archive/issue_events_081958.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-25T01:48:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26176#event-81958"
}
```



---

archive/issue_comments_496605.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-25T01:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496605",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_496606.json:
```json
{
    "body": "Changing branch from \"u/saraedum/26176\" to \"dacbb470150a1be92af5367e880fdb939458ee84\"",
    "created_at": "2018-10-26T22:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496606",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/saraedum/26176" to "dacbb470150a1be92af5367e880fdb939458ee84"



---

archive/issue_events_081959.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-26T22:16:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26176#event-81959"
}
```



---

archive/issue_comments_496607.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-26T22:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26176#issuecomment-496607",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
