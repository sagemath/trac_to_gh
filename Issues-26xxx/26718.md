# Issue 26718: Upgrade to three.js r100

archive/issues_026481.json:
```json
{
    "assignees": [],
    "body": "This ticket is to upgrade to three.js r100.\n\nLinks\n- three.js releases: https://github.com/mrdoob/three.js/releases\n- three.js migration guide: https://github.com/mrdoob/three.js/wiki/Migration-Guide\n\nOur last upgrade of our threejs package was to Three.js r80 in #22226 in 2017-01.\n\nIn a [sage-support discussion](https://groups.google.com/d/msg/sage-support/bb6D_FkpJNQ/discussion) about 3D plotting on Arch Linux, [Antonio Rojas points out](https://groups.google.com/d/msg/sage-support/bb6D_FkpJNQ/qRrYcBG9AwAJ) that:\n\n> The three.js version shipped by Arch is too new and not supported by Sage.\n> Either use jsmol (which is still the default), or use the online version of three.js\n> (viewer='threejs', online=True) (with sagemath 8.4-4, in previous versions the\n> online version doesn't work either).\n\n\nDepends on #27568\n\nCC:  @antonio-rojas @kiwifb @novoselt @haraldschilly @slel @williamstein @egourgoulhon\n\nKeywords: **upgrade, threejs, three.js**\n\nBranch/Commit: **[`18d0e74`](https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5)**\n\nReviewer: **Eric Gourgoulhon**\n\nAuthor: **Paul Masson**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26718_\n\n",
    "closed_at": "2019-05-06T11:56:41Z",
    "created_at": "2018-11-19T07:47:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade to three.js r100",
    "type": "issue",
    "updated_at": "2019-05-06T11:56:41Z",
    "url": "https://github.com/sagemath/sage/issues/26718",
    "user": "https://github.com/slel"
}
```
This ticket is to upgrade to three.js r100.

Links
- three.js releases: https://github.com/mrdoob/three.js/releases
- three.js migration guide: https://github.com/mrdoob/three.js/wiki/Migration-Guide

Our last upgrade of our threejs package was to Three.js r80 in #22226 in 2017-01.

In a [sage-support discussion](https://groups.google.com/d/msg/sage-support/bb6D_FkpJNQ/discussion) about 3D plotting on Arch Linux, [Antonio Rojas points out](https://groups.google.com/d/msg/sage-support/bb6D_FkpJNQ/qRrYcBG9AwAJ) that:

> The three.js version shipped by Arch is too new and not supported by Sage.
> Either use jsmol (which is still the default), or use the online version of three.js
> (viewer='threejs', online=True) (with sagemath 8.4-4, in previous versions the
> online version doesn't work either).


Depends on #27568

CC:  @antonio-rojas @kiwifb @novoselt @haraldschilly @slel @williamstein @egourgoulhon

Keywords: **upgrade, threejs, three.js**

Branch/Commit: **[`18d0e74`](https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5)**

Reviewer: **Eric Gourgoulhon**

Author: **Paul Masson**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/26718_





---

archive/issue_events_364409.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-11-19T07:47:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364409"
}
```



---

archive/issue_events_364410.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-11-19T07:47:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364410"
}
```



---

archive/issue_events_364411.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-11-19T07:47:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364411"
}
```



---

archive/issue_events_364412.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-11-19T07:47:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364412"
}
```



---

archive/issue_comments_411459.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe breakage happened in r91. Since that version, plots only show a black box at first. If you click and drag on the black box you get the axes (which rotate correctly), but no plot.",
    "created_at": "2018-11-19T12:37:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411459",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:1" align="right">comment:1</div>

The breakage happened in r91. Since that version, plots only show a black box at first. If you click and drag on the black box you get the axes (which rotate correctly), but no plot.



---

archive/issue_comments_411460.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThree.js r100 is out.",
    "created_at": "2019-01-13T18:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411460",
    "user": "https://github.com/slel"
}
```

<div id="comment:2" align="right">comment:2</div>

Three.js r100 is out.



---

archive/issue_comments_411461.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHas this problem already been dealt with on SageCell or CoCalc, by any chance?",
    "created_at": "2019-01-30T09:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411461",
    "user": "https://github.com/slel"
}
```

<div id="comment:3" align="right">comment:3</div>

Has this problem already been dealt with on SageCell or CoCalc, by any chance?



---

archive/issue_comments_411462.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This ticket is to upgrade to three.js r98.\n+This ticket is to upgrade to three.js r100.\n \n Our last upgrade of our threejs package was to Three.js r80 in #22226 in 2017-01.\n \n``````\n",
    "created_at": "2019-01-30T09:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411462",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This ticket is to upgrade to three.js r98.
+This ticket is to upgrade to three.js r100.
 
 Our last upgrade of our threejs package was to Three.js r80 in #22226 in 2017-01.
 
``````




---

archive/issue_events_364413.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-30T09:20:32Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "title_is": "Upgrade to three.js r100",
    "title_was": "Upgrade to three.js r98",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364413"
}
```



---

archive/issue_events_364414.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-30T09:20:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364414"
}
```



---

archive/issue_events_364415.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-01-30T09:20:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364415"
}
```



---

archive/issue_comments_411463.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n This ticket is to upgrade to three.js r100.\n+\n+Links\n+- three.js releases: https://github.com/mrdoob/three.js/releases\n+- three.js migration guide: https://github.com/mrdoob/three.js/wiki/Migration-Guide\n \n Our last upgrade of our threejs package was to Three.js r80 in #22226 in 2017-01.\n \n``````\n",
    "created_at": "2019-01-30T09:25:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411463",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
 This ticket is to upgrade to three.js r100.
+
+Links
+- three.js releases: https://github.com/mrdoob/three.js/releases
+- three.js migration guide: https://github.com/mrdoob/three.js/wiki/Migration-Guide
 
 Our last upgrade of our threejs package was to Three.js r80 in #22226 in 2017-01.
 
``````




---

archive/issue_comments_411464.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@antonio-rojas](#comment%3A1):\n\n> The breakage happened in r91.\n\nAre there any hints in the [three.js r90--r91 migration guide](https://github.com/mrdoob/three.js/wiki/Migration-Guide#r90--r91)?",
    "created_at": "2019-01-30T09:25:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411464",
    "user": "https://github.com/slel"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@antonio-rojas](#comment%3A1):

> The breakage happened in r91.

Are there any hints in the [three.js r90--r91 migration guide](https://github.com/mrdoob/three.js/wiki/Migration-Guide#r90--r91)?



---

archive/issue_comments_411465.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@slel](#comment%3A4):\n> Replying to [@antonio-rojas](#comment%3A1):\n> \n> > The breakage happened in r91.\n\n> \n> Are there any hints in the [three.js r90--r91 migration guide](https://github.com/mrdoob/three.js/wiki/Migration-Guide#r90--r91)?\n\nThe first bad build is https://github.com/mrdoob/three.js/commit/e5012e237dd1f05182dc1879347e7cb05bbebf48",
    "created_at": "2019-01-30T13:44:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411465",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@slel](#comment%3A4):
> Replying to [@antonio-rojas](#comment%3A1):
> 
> > The breakage happened in r91.

> 
> Are there any hints in the [three.js r90--r91 migration guide](https://github.com/mrdoob/three.js/wiki/Migration-Guide#r90--r91)?

The first bad build is https://github.com/mrdoob/three.js/commit/e5012e237dd1f05182dc1879347e7cb05bbebf48



---

archive/issue_comments_411466.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@slel](#comment%3A3):\n> Has this problem already been dealt with on SageCell or CoCalc, by any chance?\n\nCoCalc has independent threejs code. This used to be the case with SageMathCell, but since it leads to incompatibilities between different interfaces and adds maintenance load, I was very happy to ditch it when threejs got available in Sage itself. I have no plans to change it back ;-)",
    "created_at": "2019-01-30T17:15:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411466",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@slel](#comment%3A3):
> Has this problem already been dealt with on SageCell or CoCalc, by any chance?

CoCalc has independent threejs code. This used to be the case with SageMathCell, but since it leads to incompatibilities between different interfaces and adds maintenance load, I was very happy to ditch it when threejs got available in Sage itself. I have no plans to change it back ;-)



---

archive/issue_comments_411467.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@slel](#comment%3A4):\n> Replying to [@antonio-rojas](#comment%3A1):\n> \n> > The breakage happened in r91.\n\n> \n> Are there any hints in the [three.js r90--r91 migration guide](https://github.com/mrdoob/three.js/wiki/Migration-Guide#r90--r91)?\n\nIn the first line: Geometry().center() has changed behavior. \n\nThere is some cleanup that needs to happen in the Three.js template before this upgrade. Then I\u2019ll take care of this ticket.",
    "created_at": "2019-03-29T19:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411467",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@slel](#comment%3A4):
> Replying to [@antonio-rojas](#comment%3A1):
> 
> > The breakage happened in r91.

> 
> Are there any hints in the [three.js r90--r91 migration guide](https://github.com/mrdoob/three.js/wiki/Migration-Guide#r90--r91)?

In the first line: Geometry().center() has changed behavior. 

There is some cleanup that needs to happen in the Three.js template before this upgrade. Then Iâ€™ll take care of this ticket.



---

archive/issue_comments_411468.json:
```json
{
    "body": "Dependencies: **#27568**",
    "created_at": "2019-03-30T02:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411468",
    "user": "https://github.com/paulmasson"
}
```

Dependencies: **#27568**



---

archive/issue_comments_411469.json:
```json
{
    "body": "Branch: **[u/paulmasson/26718](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/26718)**",
    "created_at": "2019-04-13T00:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411469",
    "user": "https://github.com/paulmasson"
}
```

Branch: **[u/paulmasson/26718](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/26718)**



---

archive/issue_events_364416.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-13T00:15:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364416"
}
```



---

archive/issue_events_364417.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-13T00:15:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364417"
}
```



---

archive/issue_events_364418.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-13T00:15:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364418"
}
```



---

archive/issue_comments_411470.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nPlease test existing notebooks with multiple transparent objects to confirm proper rendering of them.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b54017e077cb2b5351f7276f84220360608b43e\"><code>9b54017</code></a></td><td><code>Upgrade Three.js to r100</code></td></tr></table>\n",
    "created_at": "2019-04-13T00:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411470",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:10" align="right">comment:10</div>

Please test existing notebooks with multiple transparent objects to confirm proper rendering of them.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b54017e077cb2b5351f7276f84220360608b43e"><code>9b54017</code></a></td><td><code>Upgrade Three.js to r100</code></td></tr></table>




---

archive/issue_comments_411471.json:
```json
{
    "body": "Commit: **[`9b54017`](https://github.com/sagemath/sagetrac-mirror/commit/9b54017e077cb2b5351f7276f84220360608b43e)**",
    "created_at": "2019-04-13T00:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411471",
    "user": "https://github.com/paulmasson"
}
```

Commit: **[`9b54017`](https://github.com/sagemath/sagetrac-mirror/commit/9b54017e077cb2b5351f7276f84220360608b43e)**



---

archive/issue_comments_411472.json:
```json
{
    "body": "Author: **Paul Masson**",
    "created_at": "2019-04-13T00:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411472",
    "user": "https://github.com/paulmasson"
}
```

Author: **Paul Masson**



---

archive/issue_events_364419.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-04-19T14:43:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364419"
}
```



---

archive/issue_events_364420.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-04-19T14:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364420"
}
```



---

archive/issue_comments_411473.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAttachment: **[threejs-r100.tar.gz](https://github.com/sagemath/sage/files/ticket26718/threejs-r100.tar.gz)**\n\nIn a jupyter notebook, the following command\n\n```\nshow(line3d([(1,2,3), (1,0,-2), (3,1,4), (2,1,-2)]), viewer='threejs')\n```\nresults in a black box. If one click on it, one obtains an empty 3D frame, with no line drawn.",
    "created_at": "2019-04-19T14:43:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411473",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:11" align="right">comment:11</div>

Attachment: **[threejs-r100.tar.gz](https://github.com/sagemath/sage/files/ticket26718/threejs-r100.tar.gz)**

In a jupyter notebook, the following command

```
show(line3d([(1,2,3), (1,0,-2), (3,1,4), (2,1,-2)]), viewer='threejs')
```
results in a black box. If one click on it, one obtains an empty 3D frame, with no line drawn.



---

archive/issue_comments_411474.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2019-04-19T14:43:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411474",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_comments_411475.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5\"><code>18d0e74</code></a></td><td><code>Fix centering of points and lines</code></td></tr></table>\n",
    "created_at": "2019-04-19T21:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411475",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5"><code>18d0e74</code></a></td><td><code>Fix centering of points and lines</code></td></tr></table>




---

archive/issue_comments_411476.json:
```json
{
    "body": "Changed commit from **[`9b54017`](https://github.com/sagemath/sagetrac-mirror/commit/9b54017e077cb2b5351f7276f84220360608b43e)** to **[`18d0e74`](https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5)**",
    "created_at": "2019-04-19T21:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411476",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9b54017`](https://github.com/sagemath/sagetrac-mirror/commit/9b54017e077cb2b5351f7276f84220360608b43e)** to **[`18d0e74`](https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5)**



---

archive/issue_events_364421.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-19T21:16:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364421"
}
```



---

archive/issue_events_364422.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-19T21:16:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364422"
}
```



---

archive/issue_comments_411477.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nForgot to correct the centering for points and lines. Should work now.",
    "created_at": "2019-04-19T21:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411477",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:13" align="right">comment:13</div>

Forgot to correct the centering for points and lines. Should work now.



---

archive/issue_comments_411478.json:
```json
{
    "body": "Attachment: **[two_spheres.png](https://github.com/sagemath/sage/files/ticket26718/two_spheres.png)**\n\nthreejs plot of 2 spheres",
    "created_at": "2019-04-24T19:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411478",
    "user": "https://github.com/egourgoulhon"
}
```

Attachment: **[two_spheres.png](https://github.com/sagemath/sage/files/ticket26718/two_spheres.png)**

threejs plot of 2 spheres



---

archive/issue_events_364423.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-04-24T19:25:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364423"
}
```



---

archive/issue_events_364424.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-04-24T19:25:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364424"
}
```



---

archive/issue_comments_411479.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSorry for the delay in replying and thanks for the update.\nI've checked it in both python2 and python3 Sage. Everything seems OK. Some issues are not fixed by the upgrade to r100:\n\n- the code\n\n```\ng = sphere(color='red', opacity=0.2)\ng += sphere((0.5,0,0), color='lightgrey', opacity=0.4)\nshow(g, viewer='threejs')\n```\nresults in a truncated grey sphere, with some spurious shaded layers, cf. the attached image: ![](https://github.com/sagemath/sage/files/ticket26718/two_spheres.png))\n- the code\n\n```\nicosahedron(viewer='threejs')\n```\nyields a \"rounded\" icosahedron.\n\nThese issues were already there in r80 and I understand that it is not the scope of this ticket to fix them. So positive review and thanks for the upgrade!",
    "created_at": "2019-04-24T19:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411479",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:14" align="right">comment:14</div>

Sorry for the delay in replying and thanks for the update.
I've checked it in both python2 and python3 Sage. Everything seems OK. Some issues are not fixed by the upgrade to r100:

- the code

```
g = sphere(color='red', opacity=0.2)
g += sphere((0.5,0,0), color='lightgrey', opacity=0.4)
show(g, viewer='threejs')
```
results in a truncated grey sphere, with some spurious shaded layers, cf. the attached image: ![](https://github.com/sagemath/sage/files/ticket26718/two_spheres.png))
- the code

```
icosahedron(viewer='threejs')
```
yields a "rounded" icosahedron.

These issues were already there in r80 and I understand that it is not the scope of this ticket to fix them. So positive review and thanks for the upgrade!



---

archive/issue_comments_411480.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nEric, thanks for the review. I have several enhancements in mind but will wait until this ticket is merged in the next beta.\n\nThe icosahedron can be fixed with flat shading. I've already identified a spot in the code that should work for all Platonic solids.\n\nThe problem with the spheres is just part of how transparency works in WebGL. If you rotate the figure you'll see that the red sphere is truncated itself from certain angles. WebGL renders transparent objects as if located entirely at the center of the object. Extended intersecting transparent objects will always experience these sorts of issues. I don't think there's much I can do about that.",
    "created_at": "2019-04-24T20:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411480",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:15" align="right">comment:15</div>

Eric, thanks for the review. I have several enhancements in mind but will wait until this ticket is merged in the next beta.

The icosahedron can be fixed with flat shading. I've already identified a spot in the code that should work for all Platonic solids.

The problem with the spheres is just part of how transparency works in WebGL. If you rotate the figure you'll see that the red sphere is truncated itself from certain angles. WebGL renders transparent objects as if located entirely at the center of the object. Extended intersecting transparent objects will always experience these sorts of issues. I don't think there's much I can do about that.



---

archive/issue_comments_411481.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nWhere is the tarball?",
    "created_at": "2019-04-27T18:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411481",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>

Where is the tarball?



---

archive/issue_events_364425.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-27T18:01:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364425"
}
```



---

archive/issue_events_364426.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-27T18:01:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364426"
}
```



---

archive/issue_events_364427.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-27T18:08:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364427"
}
```



---

archive/issue_events_364428.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-04-27T18:08:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364428"
}
```



---

archive/issue_comments_411482.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@vbraun](#comment%3A16):\n> Where is the tarball?\n\nJust after [this comment](#comment%3A10)",
    "created_at": "2019-04-27T18:08:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411482",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@vbraun](#comment%3A16):
> Where is the tarball?

Just after [this comment](#comment%3A10)



---

archive/issue_comments_411483.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@paulmasson](#comment%3A15):\n> Eric, thanks for the review. I have several enhancements in mind but will wait until this ticket is merged in the next beta.\n> \n\nOK very good.\n\n> The icosahedron can be fixed with flat shading. I've already identified a spot in the code that should work for all Platonic solids.\n> \n> The problem with the spheres is just part of how transparency works in WebGL. If you rotate the figure you'll see that the red sphere is truncated itself from certain angles. WebGL renders transparent objects as if located entirely at the center of the object. Extended intersecting transparent objects will always experience these sorts of issues. I don't think there's much I can do about that.\n\nThanks for these explanations.",
    "created_at": "2019-04-28T08:09:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411483",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@paulmasson](#comment%3A15):
> Eric, thanks for the review. I have several enhancements in mind but will wait until this ticket is merged in the next beta.
> 

OK very good.

> The icosahedron can be fixed with flat shading. I've already identified a spot in the code that should work for all Platonic solids.
> 
> The problem with the spheres is just part of how transparency works in WebGL. If you rotate the figure you'll see that the red sphere is truncated itself from certain angles. WebGL renders transparent objects as if located entirely at the center of the object. Extended intersecting transparent objects will always experience these sorts of issues. I don't think there's much I can do about that.

Thanks for these explanations.



---

archive/issue_comments_411484.json:
```json
{
    "body": "Changed branch from **[u/paulmasson/26718](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/26718)** to **[`18d0e74`](https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5)**",
    "created_at": "2019-05-06T11:56:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26718#issuecomment-411484",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/paulmasson/26718](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/26718)** to **[`18d0e74`](https://github.com/sagemath/sagetrac-mirror/commit/18d0e74679a627d411a4e596d58072047030abe5)**



---

archive/issue_events_364429.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-06T11:56:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364429"
}
```



---

archive/issue_events_364430.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "86c5bb000259e6de5d7c60afc608a4b0d010b690",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-05-06T11:56:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26718",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26718#event-364430"
}
```
