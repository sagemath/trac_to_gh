# Issue 26949: py3: make sage autodoc extension work for both python2 and python3

archive/issues_026712.json:
```json
{
    "body": "Sage using python3 presently fails to build the sage documentation. This is because the current sage autodoc extension does not properly work with python3. This ticket provides new `sage_autodoc` that works for both python2 and python3.\n\nThe new `sage_autodoc` is based on the existing `sage_autodoc` but trimmed a lot to be in sync well with Sphinx' orthodox `autodoc`. This is to make it more **maintainable** by clarifying modifications made by Sage to Sphinx autodoc extension.\n\nReviewer: Jeroen Demeyer\n\nAuthor: Kwankyu Lee\n\nBranch: 16d81eb2f945aa75a3aefccd71c5e455dba0a44d\n\nCommit: 16d81eb2f945aa75a3aefccd71c5e455dba0a44d\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26949\n\n",
    "closed_at": "2019-01-24T18:17:49Z",
    "created_at": "2018-12-24T00:43:23Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "py3: make sage autodoc extension work for both python2 and python3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26949",
    "user": "https://github.com/kwankyu"
}
```
Sage using python3 presently fails to build the sage documentation. This is because the current sage autodoc extension does not properly work with python3. This ticket provides new `sage_autodoc` that works for both python2 and python3.

The new `sage_autodoc` is based on the existing `sage_autodoc` but trimmed a lot to be in sync well with Sphinx' orthodox `autodoc`. This is to make it more **maintainable** by clarifying modifications made by Sage to Sphinx autodoc extension.

Reviewer: Jeroen Demeyer

Author: Kwankyu Lee

Branch: 16d81eb2f945aa75a3aefccd71c5e455dba0a44d

Commit: 16d81eb2f945aa75a3aefccd71c5e455dba0a44d

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26949





---

archive/issue_comments_375246.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2018-12-24T01:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375246",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_375247.json:
```json
{
    "body": "Changing component from documentation to python3.",
    "created_at": "2018-12-24T01:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375247",
    "user": "https://github.com/kwankyu"
}
```

Changing component from documentation to python3.



---

archive/issue_comments_375248.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-24T01:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375248",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_375249.json:
```json
{
    "body": "<a id='comment:8'></a>I had always thought the issue was with `sage_autodoc.py` but I didn't have the python 3 background to attempt a change. I'll give it a try.",
    "created_at": "2018-12-24T17:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375249",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:8'></a>I had always thought the issue was with `sage_autodoc.py` but I didn't have the python 3 background to attempt a change. I'll give it a try.



---

archive/issue_comments_375250.json:
```json
{
    "body": "<a id='comment:9'></a>This is good progress. Methods in the Python 3 documentation look like `method(self):`, while in the Python 2 version, they look like `method()`. I don't object to that, but do we know why this change has happened? More significantly, in the Python 3 version, it seems that if a method has a decorator like ``@`cached_method` or ``@`abstract_method`, then the signature is gone completely and it just says `method`.",
    "created_at": "2018-12-24T20:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375250",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>This is good progress. Methods in the Python 3 documentation look like `method(self):`, while in the Python 2 version, they look like `method()`. I don't object to that, but do we know why this change has happened? More significantly, in the Python 3 version, it seems that if a method has a decorator like ``@`cached_method` or ``@`abstract_method`, then the signature is gone completely and it just says `method`.



---

archive/issue_comments_375251.json:
```json
{
    "body": "<a id='comment:10'></a>Also under [Sets](http://doc.sagemath.org/html/en/reference/categories/sage/categories/sets_cat.html) \n**an_element()** with Python 2 appears as **an_element** with Python 3. This may be due to confusing `py:method` (Python 2) with `py:attribute` (Python 3).",
    "created_at": "2018-12-24T21:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375251",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:10'></a>Also under [Sets](http://doc.sagemath.org/html/en/reference/categories/sage/categories/sets_cat.html) 
**an_element()** with Python 2 appears as **an_element** with Python 3. This may be due to confusing `py:method` (Python 2) with `py:attribute` (Python 3).



---

archive/issue_comments_375252.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 strogdon]:\n> Also under [Sets](http://doc.sagemath.org/html/en/reference/categories/sage/categories/sets_cat.html) \n> **an_element()** with Python 2 appears as **an_element** with Python 3. This may be due to confusing `py:method` (Python 2) with `py:attribute` (Python 3).\n\n\nI was guessing that this was because `an_element` is marked as ``@`cached_method`.",
    "created_at": "2018-12-24T22:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375252",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>Replying to [comment:10 strogdon]:
> Also under [Sets](http://doc.sagemath.org/html/en/reference/categories/sage/categories/sets_cat.html) 
> **an_element()** with Python 2 appears as **an_element** with Python 3. This may be due to confusing `py:method` (Python 2) with `py:attribute` (Python 3).


I was guessing that this was because `an_element` is marked as ``@`cached_method`.



---

archive/issue_comments_375253.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:9 jhpalmieri]:\n> This is good progress. Methods in the Python 3 documentation look like `method(self):`, while in the Python 2 version, they look like `method()`. I don't object to that, but do we know why this change has happened? More significantly, in the Python 3 version, it seems that if a method has a decorator like ``@`cached_method` or ``@`abstract_method`, then the signature is gone completely and it just says `method`.\n\n\nI expected these subtle differences. I cannot explain the cause of the differences, but know where to look. You can start with \n\n`vimdiff src/sage_setup/docbuild/ext/sage_autodoc3.py local/lib/python2.7/site-packages/sphinx/ext/autodoc/__init__.py` \n\nand perhaps also with comparing `sage_autodoc3` with the original `sage_autodoc`. \n\nI would welcome commits to fix these unpleasant changes, after switching to a public branch. \n\nTo understand how an attribute (in the general sense, of a module or of a class) is rendered by Sphinx, note that a  suitable `Documenter` is selected for each attribute in the last lines of the following (in `sage_autodoc`): \n\n```\n    def document_members(self, all_members=False):\n        \"\"\"Generate reST for member documentation.\n\n        If *all_members* is True, do all members, else those given by\n        *self.options.members*.\n        \"\"\"\n        # set current namespace for finding members\n        self.env.temp_data['autodoc:module'] = self.modname\n        if self.objpath:\n            self.env.temp_data['autodoc:class'] = self.objpath[0]\n\n        want_all = all_members or self.options.inherited_members or \\\n            self.options.members is ALL\n        # find out which members are documentable\n        members_check_module, members = self.get_object_members(want_all)\n\n        # remove members given by exclude-members\n        if self.options.exclude_members:\n            members = [(membername, member) for (membername, member) in members\n                       if membername not in self.options.exclude_members]\n\n        # document non-skipped members\n        memberdocumenters = []\n        for (mname, member, isattr) in self.filter_members(members, want_all): <------------------------\n            classes = [cls for cls in itervalues(self.documenters)\n                       if cls.can_document_member(member, mname, isattr, self)]  <----------------------\n            if not classes:\n                # don't know how to document this member\n                continue\n            # prefer the documenter with the highest priority\n            classes.sort(key=lambda cls: cls.priority)                 <----------------------\n            # give explicitly separated module name, so that members\n            # of inner classes can be documented\n            full_mname = self.modname + '::' + \\\n                '.'.join(self.objpath + [mname])\n            documenter = classes[-1](self.directive, full_mname, self.indent)               <---------- look here\n\n            memberdocumenters.append((documenter, isattr))\n\n        ...\n```",
    "created_at": "2018-12-24T23:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375253",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:12'></a>Replying to [comment:9 jhpalmieri]:
> This is good progress. Methods in the Python 3 documentation look like `method(self):`, while in the Python 2 version, they look like `method()`. I don't object to that, but do we know why this change has happened? More significantly, in the Python 3 version, it seems that if a method has a decorator like ``@`cached_method` or ``@`abstract_method`, then the signature is gone completely and it just says `method`.


I expected these subtle differences. I cannot explain the cause of the differences, but know where to look. You can start with 

`vimdiff src/sage_setup/docbuild/ext/sage_autodoc3.py local/lib/python2.7/site-packages/sphinx/ext/autodoc/__init__.py` 

and perhaps also with comparing `sage_autodoc3` with the original `sage_autodoc`. 

I would welcome commits to fix these unpleasant changes, after switching to a public branch. 

To understand how an attribute (in the general sense, of a module or of a class) is rendered by Sphinx, note that a  suitable `Documenter` is selected for each attribute in the last lines of the following (in `sage_autodoc`): 

```
    def document_members(self, all_members=False):
        """Generate reST for member documentation.

        If *all_members* is True, do all members, else those given by
        *self.options.members*.
        """
        # set current namespace for finding members
        self.env.temp_data['autodoc:module'] = self.modname
        if self.objpath:
            self.env.temp_data['autodoc:class'] = self.objpath[0]

        want_all = all_members or self.options.inherited_members or \
            self.options.members is ALL
        # find out which members are documentable
        members_check_module, members = self.get_object_members(want_all)

        # remove members given by exclude-members
        if self.options.exclude_members:
            members = [(membername, member) for (membername, member) in members
                       if membername not in self.options.exclude_members]

        # document non-skipped members
        memberdocumenters = []
        for (mname, member, isattr) in self.filter_members(members, want_all): <------------------------
            classes = [cls for cls in itervalues(self.documenters)
                       if cls.can_document_member(member, mname, isattr, self)]  <----------------------
            if not classes:
                # don't know how to document this member
                continue
            # prefer the documenter with the highest priority
            classes.sort(key=lambda cls: cls.priority)                 <----------------------
            # give explicitly separated module name, so that members
            # of inner classes can be documented
            full_mname = self.modname + '::' + \
                '.'.join(self.objpath + [mname])
            documenter = classes[-1](self.directive, full_mname, self.indent)               <---------- look here

            memberdocumenters.append((documenter, isattr))

        ...
```



---

archive/issue_comments_375254.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-25T11:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375254",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_375255.json:
```json
{
    "body": "<a id='comment:13'></a>While making things compatible with Python 3 is a good goal, having two completely independent implementations of it is a horrible solution. Then we would have two autodoc extensions to maintain instead of one.",
    "created_at": "2018-12-25T11:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375255",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>While making things compatible with Python 3 is a good goal, having two completely independent implementations of it is a horrible solution. Then we would have two autodoc extensions to maintain instead of one.



---

archive/issue_comments_375256.json:
```json
{
    "body": "<a id='comment:14'></a>Also, I would personally prefer to wait with this until after #26451. But it's partially my fault for dragging that, so consider this just a suggestion.",
    "created_at": "2018-12-25T11:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375256",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Also, I would personally prefer to wait with this until after #26451. But it's partially my fault for dragging that, so consider this just a suggestion.



---

archive/issue_comments_375257.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-26T01:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375257",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375258.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-26T01:42:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375258",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375259.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-26T02:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375259",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375260.json:
```json
{
    "body": "<a id='comment:18'></a>A cursory look at a python 3 build of the docs looks OK. Now for python 2.",
    "created_at": "2018-12-26T04:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375260",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:18'></a>A cursory look at a python 3 build of the docs looks OK. Now for python 2.



---

archive/issue_comments_375261.json:
```json
{
    "body": "Replying to [ticket:26949 klee]:\n> trimmed a lot to be in sync well with Sphinx' orthodox `autodoc`.\n\n\nCan you justify this? In particular, which \"orthodox `autodoc`\" are you talking about? Given that Sage is not using the latest Sphinx (see #26451 for that), this is a relevant question.",
    "created_at": "2018-12-26T12:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375261",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:26949 klee]:
> trimmed a lot to be in sync well with Sphinx' orthodox `autodoc`.


Can you justify this? In particular, which "orthodox `autodoc`" are you talking about? Given that Sage is not using the latest Sphinx (see #26451 for that), this is a relevant question.



---

archive/issue_comments_375262.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 jdemeyer]:\n> Replying to [ticket:26949 klee]:\n> > trimmed a lot to be in sync well with Sphinx' orthodox `autodoc`.\n\n> \n> Can you justify this? In particular, which \"orthodox `autodoc`\" are you talking about? Given that Sage is not using the latest Sphinx (see #26451 for that), this is a relevant question.\n\n\nI just meant the one currently shipped with Sage. So not the latest. \n\nYou know what I mean by \"sync well\" if you \"vimdiff\" old `sage_autodoc` and then the new `sage_autodoc`,  against Sphinx' `ext/autodoc/__init__py`.",
    "created_at": "2018-12-26T12:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375262",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>Replying to [comment:19 jdemeyer]:
> Replying to [ticket:26949 klee]:
> > trimmed a lot to be in sync well with Sphinx' orthodox `autodoc`.

> 
> Can you justify this? In particular, which "orthodox `autodoc`" are you talking about? Given that Sage is not using the latest Sphinx (see #26451 for that), this is a relevant question.


I just meant the one currently shipped with Sage. So not the latest. 

You know what I mean by "sync well" if you "vimdiff" old `sage_autodoc` and then the new `sage_autodoc`,  against Sphinx' `ext/autodoc/__init__py`.



---

archive/issue_comments_375263.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-26T13:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375263",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375264.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-26T13:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375264",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375265.json:
```json
{
    "body": "<a id='comment:23'></a>Please rebase to 8.5 and squash commits to just one commit.",
    "created_at": "2018-12-26T14:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375265",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Please rebase to 8.5 and squash commits to just one commit.



---

archive/issue_comments_375266.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-26T14:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375266",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_375267.json:
```json
{
    "body": "<a id='comment:26'></a>`sage.combinat.diagram_algebras.AbstractPartitionDiagrams.Element` is now documented as \"alias of `InheritComparisonClasscallMetaclass`\" which is not very informative.\n\nThis used to be \"alias of `AbstractPartitionDiagram`\".",
    "created_at": "2018-12-26T14:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375267",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>`sage.combinat.diagram_algebras.AbstractPartitionDiagrams.Element` is now documented as "alias of `InheritComparisonClasscallMetaclass`" which is not very informative.

This used to be "alias of `AbstractPartitionDiagram`".



---

archive/issue_comments_375268.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-26T14:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375268",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_375269.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:20 klee]:\n> I just meant the one currently shipped with Sage. So not the latest. \n\n\nThe most reasonable comparison is probably with Sphinx 1.7.9, the lastest bugfix of the version currently in Sage.",
    "created_at": "2018-12-26T14:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375269",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Replying to [comment:20 klee]:
> I just meant the one currently shipped with Sage. So not the latest. 


The most reasonable comparison is probably with Sphinx 1.7.9, the lastest bugfix of the version currently in Sage.



---

archive/issue_comments_375270.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-27T06:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375270",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375271.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-27T10:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375271",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375272.json:
```json
{
    "body": "<a id='comment:30'></a>Thanks! I'll have a deeper look at what's going wrong with `__qualname__`.",
    "created_at": "2018-12-27T20:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375272",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>Thanks! I'll have a deeper look at what's going wrong with `__qualname__`.



---

archive/issue_comments_375273.json:
```json
{
    "body": "<a id='comment:31'></a>The \"problem\" seems to be that Cython defines an ordinary attribute `__qualname__` on the metaclass. I'm not entirely convinced that your fix is the right thing to do, I'll need to think about it.",
    "created_at": "2018-12-30T01:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375273",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>The "problem" seems to be that Cython defines an ordinary attribute `__qualname__` on the metaclass. I'm not entirely convinced that your fix is the right thing to do, I'll need to think about it.



---

archive/issue_comments_375274.json:
```json
{
    "body": "<a id='comment:32'></a>see also #26319",
    "created_at": "2018-12-30T10:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375274",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'></a>see also #26319



---

archive/issue_comments_375275.json:
```json
{
    "body": "<a id='comment:33'></a>I consider the `__qualname__` issue a Cython bug: https://github.com/cython/cython/issues/2772\n\nSince the issue is almost certainly not limited to `InheritComparisonMetaclass`, it's pointless to work around it only there.\n\nInstead, I suggest to simply not use `__qualname__` in autodoc until this Cython bug is fixed.",
    "created_at": "2018-12-31T09:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375275",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>I consider the `__qualname__` issue a Cython bug: https://github.com/cython/cython/issues/2772

Since the issue is almost certainly not limited to `InheritComparisonMetaclass`, it's pointless to work around it only there.

Instead, I suggest to simply not use `__qualname__` in autodoc until this Cython bug is fixed.



---

archive/issue_comments_375276.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-31T09:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375276",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_375277.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:32 chapoton]:\n> see also #26319\n\n\nThat is a different unrelated problem with `__qualname__`",
    "created_at": "2018-12-31T09:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375277",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>Replying to [comment:32 chapoton]:
> see also #26319


That is a different unrelated problem with `__qualname__`



---

archive/issue_comments_375278.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-31T22:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375278",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375279.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:33 jdemeyer]:\n> I consider the `__qualname__` issue a Cython bug: https://github.com/cython/cython/issues/2772\n> \n> Since the issue is almost certainly not limited to `InheritComparisonMetaclass`, it's pointless to work around it only there.\n\n\nRight.\n\n> Instead, I suggest to simply not use `__qualname__` in autodoc until this Cython bug is fixed.\n\n\nDone. Thanks.",
    "created_at": "2018-12-31T22:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375279",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:37'></a>Replying to [comment:33 jdemeyer]:
> I consider the `__qualname__` issue a Cython bug: https://github.com/cython/cython/issues/2772
> 
> Since the issue is almost certainly not limited to `InheritComparisonMetaclass`, it's pointless to work around it only there.


Right.

> Instead, I suggest to simply not use `__qualname__` in autodoc until this Cython bug is fixed.


Done. Thanks.



---

archive/issue_comments_375280.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-31T22:55:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375280",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375281.json:
```json
{
    "body": "<a id='comment:40'></a>Rebased to 8.6.beta0 and squashed.\n\n---\nNew commits:",
    "created_at": "2019-01-01T09:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375281",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>Rebased to 8.6.beta0 and squashed.

---
New commits:



---

archive/issue_comments_375282.json:
```json
{
    "body": "<a id='comment:41'></a>Building the docs now...",
    "created_at": "2019-01-01T09:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375282",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>Building the docs now...



---

archive/issue_comments_375283.json:
```json
{
    "body": "<a id='comment:42'></a>Since the change involving `__qualname__` is a functional change, I decided to deal with that in a separate ticket: #27002",
    "created_at": "2019-01-02T17:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375283",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>Since the change involving `__qualname__` is a functional change, I decided to deal with that in a separate ticket: #27002



---

archive/issue_comments_375284.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-02T17:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375284",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_375285.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-02T22:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375285",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_375286.json:
```json
{
    "body": "<a id='comment:44'></a>Some things are no longer documented. For example `sage.schemes.elliptic_curves.padics.padic_lseries` which is a `CachedMethod`.",
    "created_at": "2019-01-02T22:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375286",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>Some things are no longer documented. For example `sage.schemes.elliptic_curves.padics.padic_lseries` which is a `CachedMethod`.



---

archive/issue_comments_375287.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:44 jdemeyer]:\n> Some things are no longer documented. For example `sage.schemes.elliptic_curves.padics.padic_lseries` which is a `CachedMethod`.\n\n\nYou might have noticed that these cached functions have wrong documentations already with the current sage. With the present patch, they now have no documentation. We are just seeing different manifestations of an issue with cached functions. Fixing this issue with cached functions seems to be out of the scope of the present ticket. I may open a ticket to tackle this issue if you agree.",
    "created_at": "2019-01-03T11:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375287",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:45'></a>Replying to [comment:44 jdemeyer]:
> Some things are no longer documented. For example `sage.schemes.elliptic_curves.padics.padic_lseries` which is a `CachedMethod`.


You might have noticed that these cached functions have wrong documentations already with the current sage. With the present patch, they now have no documentation. We are just seeing different manifestations of an issue with cached functions. Fixing this issue with cached functions seems to be out of the scope of the present ticket. I may open a ticket to tackle this issue if you agree.



---

archive/issue_comments_375288.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:45 klee]:\n> Replying to [comment:44 jdemeyer]:\n> > Some things are no longer documented. For example `sage.schemes.elliptic_curves.padics.padic_lseries` which is a `CachedMethod`.\n\n> \n> You might have noticed that these cached functions have wrong documentations already with the current sage. With the present patch, they now have no documentation. \n\n\nThis is right.\n\n> We are just seeing different manifestations of an issue with cached functions. \n\n\nThis is wrong. There is no issue with cached functions! All functions defined in `sage.schemes.elliptic_curves.padics` are imported and embedded into the class `EllipticCurve_rational_field` defined in `sage.schemes.elliptic_curves.padics.ell_rational_field`.  Thus the functions are well documented as methods in the documentation of the class. Hence there is no need to (should not) document the functions in `padics.py` in duplicate!\n\n>Fixing this issue with cached functions seems to be out of the scope of the present ticket. I may open a ticket to tackle this issue if you agree.\n\n\nWhat should be done is to remove the article `Miscellaneous p-adic functions` from the Sage documentation. I may open a ticket for this, if you agree.",
    "created_at": "2019-01-03T20:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375288",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:46'></a>Replying to [comment:45 klee]:
> Replying to [comment:44 jdemeyer]:
> > Some things are no longer documented. For example `sage.schemes.elliptic_curves.padics.padic_lseries` which is a `CachedMethod`.

> 
> You might have noticed that these cached functions have wrong documentations already with the current sage. With the present patch, they now have no documentation. 


This is right.

> We are just seeing different manifestations of an issue with cached functions. 


This is wrong. There is no issue with cached functions! All functions defined in `sage.schemes.elliptic_curves.padics` are imported and embedded into the class `EllipticCurve_rational_field` defined in `sage.schemes.elliptic_curves.padics.ell_rational_field`.  Thus the functions are well documented as methods in the documentation of the class. Hence there is no need to (should not) document the functions in `padics.py` in duplicate!

>Fixing this issue with cached functions seems to be out of the scope of the present ticket. I may open a ticket to tackle this issue if you agree.


What should be done is to remove the article `Miscellaneous p-adic functions` from the Sage documentation. I may open a ticket for this, if you agree.



---

archive/issue_comments_375289.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-03T20:15:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375289",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375290.json:
```json
{
    "body": "<a id='comment:48'></a>Rebased on sage 8.6.rc0 and removed a few unuseful comments like `# type: ...`\n\n---\nNew commits:",
    "created_at": "2019-01-04T01:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375290",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:48'></a>Rebased on sage 8.6.rc0 and removed a few unuseful comments like `# type: ...`

---
New commits:



---

archive/issue_comments_375291.json:
```json
{
    "body": "<a id='comment:49'></a>Fair enough regarding `padic_lseries`.\n\nStill, there is more documentation which is removed. For example `sage.combinat.finite_state_machine.FiniteStateMachine.output_alphabet`\n\nIn the sources, there is\n\n```python\n    output_alphabet = None\n    \"\"\"\n    A list of letters representing the output alphabet of the finite\n    state machine.\n\n    It can be set by the parameter ``output_alphabet`` when initializing\n    a finite state machine, see :class:`FiniteStateMachine`.\n\n    It can also be set by the method :meth:`determine_alphabets`.\n\n    .. SEEALSO::\n\n        :class:`FiniteStateMachine`,\n        :meth:`determine_alphabets`,\n        :attr:`input_alphabet`.\n    \"\"\"\n```\nand apparently Sphinx parses this correctly before this patch but not after this patch.",
    "created_at": "2019-01-04T11:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375291",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:49'></a>Fair enough regarding `padic_lseries`.

Still, there is more documentation which is removed. For example `sage.combinat.finite_state_machine.FiniteStateMachine.output_alphabet`

In the sources, there is

```python
    output_alphabet = None
    """
    A list of letters representing the output alphabet of the finite
    state machine.

    It can be set by the parameter ``output_alphabet`` when initializing
    a finite state machine, see :class:`FiniteStateMachine`.

    It can also be set by the method :meth:`determine_alphabets`.

    .. SEEALSO::

        :class:`FiniteStateMachine`,
        :meth:`determine_alphabets`,
        :attr:`input_alphabet`.
    """
```
and apparently Sphinx parses this correctly before this patch but not after this patch.



---

archive/issue_comments_375292.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:48 klee]:\n> removed a few unuseful comments like `# type: ...`\n\n\nIf those comments appear in the original, it's more maintainable to keep them.",
    "created_at": "2019-01-04T12:54:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375292",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'></a>Replying to [comment:48 klee]:
> removed a few unuseful comments like `# type: ...`


If those comments appear in the original, it's more maintainable to keep them.



---

archive/issue_comments_375293.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:50 jdemeyer]:\n> Replying to [comment:48 klee]:\n> > removed a few unuseful comments like `# type: ...`\n\n> \n> If those comments appear in the original, it's more maintainable to keep them.\n\n\nThe old `sage_autodoc` didn't keep those comments. It seems to be a convention of Sphinx, but absolutely not of Sage. Anyway I don't care. Do you prefer to follow Sphinx?",
    "created_at": "2019-01-04T13:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375293",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:51'></a>Replying to [comment:50 jdemeyer]:
> Replying to [comment:48 klee]:
> > removed a few unuseful comments like `# type: ...`

> 
> If those comments appear in the original, it's more maintainable to keep them.


The old `sage_autodoc` didn't keep those comments. It seems to be a convention of Sphinx, but absolutely not of Sage. Anyway I don't care. Do you prefer to follow Sphinx?



---

archive/issue_comments_375294.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-04T13:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375294",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375295.json:
```json
{
    "body": "<a id='comment:53'></a>Replying to [comment:51 klee]:\n> It seems to be a convention of Sphinx, but absolutely not of Sage.\n\n\nIt's not just a Sphinx thing: https://www.python.org/dev/peps/pep-0484/#suggested-syntax-for-python-2-7-and-straddling-code\n\n> Do you prefer to follow Sphinx? \n\n\nYes. More generally, we should stay as close to upstream Sphinx as possible.",
    "created_at": "2019-01-04T13:30:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375295",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'></a>Replying to [comment:51 klee]:
> It seems to be a convention of Sphinx, but absolutely not of Sage.


It's not just a Sphinx thing: https://www.python.org/dev/peps/pep-0484/#suggested-syntax-for-python-2-7-and-straddling-code

> Do you prefer to follow Sphinx? 


Yes. More generally, we should stay as close to upstream Sphinx as possible.



---

archive/issue_comments_375296.json:
```json
{
    "body": "<a id='comment:54'></a>I am not sure if my last commit will finally make everything right or break something somewhere. This business is going to be close to blind trials...\n\nAnyway personally I could not afford more trials if anything breaks, for some weeks. Sorry.",
    "created_at": "2019-01-04T13:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375296",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:54'></a>I am not sure if my last commit will finally make everything right or break something somewhere. This business is going to be close to blind trials...

Anyway personally I could not afford more trials if anything breaks, for some weeks. Sorry.



---

archive/issue_comments_375297.json:
```json
{
    "body": "<a id='comment:55'></a>Replying to [comment:54 klee]:\n> Anyway personally I could not afford more trials if anything breaks, for some weeks. Sorry.\n\n\nNo need to apologize. You already did very good work!\n\nGood to know that you'll be inactive. I'll try to fix any issues myself.",
    "created_at": "2019-01-04T13:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375297",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'></a>Replying to [comment:54 klee]:
> Anyway personally I could not afford more trials if anything breaks, for some weeks. Sorry.


No need to apologize. You already did very good work!

Good to know that you'll be inactive. I'll try to fix any issues myself.



---

archive/issue_comments_375298.json:
```json
{
    "body": "<a id='comment:56'></a>I'm happy enough with the generated documentation now.",
    "created_at": "2019-01-07T11:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375298",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>I'm happy enough with the generated documentation now.



---

archive/issue_comments_375299.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-07T14:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375299",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375300.json:
```json
{
    "body": "<a id='comment:58'></a>The last commit should not affect documentation. Tried a tiny bit to prepare for Sphinx 1.8.",
    "created_at": "2019-01-07T14:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375300",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:58'></a>The last commit should not affect documentation. Tried a tiny bit to prepare for Sphinx 1.8.



---

archive/issue_comments_375301.json:
```json
{
    "body": "<a id='comment:59'></a>OK, do you plan further changes? I'll just need to know when I can review the final version of this branch.",
    "created_at": "2019-01-07T14:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375301",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:59'></a>OK, do you plan further changes? I'll just need to know when I can review the final version of this branch.



---

archive/issue_comments_375302.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:59 jdemeyer]:\n> OK, do you plan further changes? I'll just need to know when I can review the final version of this branch.\n\n\nNo. Please proceed.",
    "created_at": "2019-01-07T14:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375302",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:60'></a>Replying to [comment:59 jdemeyer]:
> OK, do you plan further changes? I'll just need to know when I can review the final version of this branch.


No. Please proceed.



---

archive/issue_comments_375303.json:
```json
{
    "body": "<a id='comment:61'></a>Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375303",
    "user": "https://github.com/embray"
}
```

<a id='comment:61'></a>Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_066775.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26949#event-66775"
}
```



---

archive/issue_comments_375304.json:
```json
{
    "body": "<a id='comment:62'></a>any progress here ? Will this fix `make doc` for python3 ?",
    "created_at": "2019-01-17T09:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375304",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:62'></a>any progress here ? Will this fix `make doc` for python3 ?



---

archive/issue_comments_375305.json:
```json
{
    "body": "<a id='comment:63'></a>Replying to [comment:62 chapoton]:\n> any progress here ? Will this fix `make doc` for python3 ?\n\n\nYes. I am waiting for a final review.",
    "created_at": "2019-01-17T10:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375305",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:63'></a>Replying to [comment:62 chapoton]:
> any progress here ? Will this fix `make doc` for python3 ?


Yes. I am waiting for a final review.



---

archive/issue_comments_375306.json:
```json
{
    "body": "<a id='comment:64'></a>could you please check these pyflakes warnings (maybe not pertinent)\n\n```\n+src/sage_setup/docbuild/ext/sage_autodoc.py:33: 'warnings' imported but unused\n+src/sage_setup/docbuild/ext/sage_autodoc.py:36: 'six.iteritems' imported but unused\n+src/sage_setup/docbuild/ext/sage_autodoc.py:39: 'sphinx.errors.ExtensionError' imported but unused\n+src/sage_setup/docbuild/ext/sage_autodoc.py:41: 'sphinx.ext.autodoc.inspector.format_annotation' imported but unused\n+src/sage_setup/docbuild/ext/sage_autodoc.py:47: 'sphinx.util.inspect.Signature' imported but unused\n+src/sage_setup/docbuild/ext/sage_autodoc.py:50: 'sphinx.util.inspect.getargspec' imported but unused\n```",
    "created_at": "2019-01-17T10:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375306",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:64'></a>could you please check these pyflakes warnings (maybe not pertinent)

```
+src/sage_setup/docbuild/ext/sage_autodoc.py:33: 'warnings' imported but unused
+src/sage_setup/docbuild/ext/sage_autodoc.py:36: 'six.iteritems' imported but unused
+src/sage_setup/docbuild/ext/sage_autodoc.py:39: 'sphinx.errors.ExtensionError' imported but unused
+src/sage_setup/docbuild/ext/sage_autodoc.py:41: 'sphinx.ext.autodoc.inspector.format_annotation' imported but unused
+src/sage_setup/docbuild/ext/sage_autodoc.py:47: 'sphinx.util.inspect.Signature' imported but unused
+src/sage_setup/docbuild/ext/sage_autodoc.py:50: 'sphinx.util.inspect.getargspec' imported but unused
```



---

archive/issue_comments_375307.json:
```json
{
    "body": "<a id='comment:65'></a>Sorry, I forgot about this ticket. I will review it. Please do not make further changes.",
    "created_at": "2019-01-17T11:57:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375307",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:65'></a>Sorry, I forgot about this ticket. I will review it. Please do not make further changes.



---

archive/issue_comments_375308.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:64 chapoton]:\n> could you please check these pyflakes warnings (maybe not pertinent)\n> \n> ```\n> +src/sage_setup/docbuild/ext/sage_autodoc.py:33: 'warnings' imported but unused\n> +src/sage_setup/docbuild/ext/sage_autodoc.py:36: 'six.iteritems' imported but unused\n> +src/sage_setup/docbuild/ext/sage_autodoc.py:39: 'sphinx.errors.ExtensionError' imported but unused\n> +src/sage_setup/docbuild/ext/sage_autodoc.py:41: 'sphinx.ext.autodoc.inspector.format_annotation' imported but unused\n> +src/sage_setup/docbuild/ext/sage_autodoc.py:47: 'sphinx.util.inspect.Signature' imported but unused\n> +src/sage_setup/docbuild/ext/sage_autodoc.py:50: 'sphinx.util.inspect.getargspec' imported but unused\n> ```\n\n\nFixed all pyflakes warnings, except  one about`sphinx.util.inspect.Signature`. `Signature` is imported in the original Sphinx autodoc, and I think is very likely to be used in future,  perhaps in #26451 or in #26254.",
    "created_at": "2019-01-17T12:15:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375308",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:66'></a>Replying to [comment:64 chapoton]:
> could you please check these pyflakes warnings (maybe not pertinent)
> 
> ```
> +src/sage_setup/docbuild/ext/sage_autodoc.py:33: 'warnings' imported but unused
> +src/sage_setup/docbuild/ext/sage_autodoc.py:36: 'six.iteritems' imported but unused
> +src/sage_setup/docbuild/ext/sage_autodoc.py:39: 'sphinx.errors.ExtensionError' imported but unused
> +src/sage_setup/docbuild/ext/sage_autodoc.py:41: 'sphinx.ext.autodoc.inspector.format_annotation' imported but unused
> +src/sage_setup/docbuild/ext/sage_autodoc.py:47: 'sphinx.util.inspect.Signature' imported but unused
> +src/sage_setup/docbuild/ext/sage_autodoc.py:50: 'sphinx.util.inspect.getargspec' imported but unused
> ```


Fixed all pyflakes warnings, except  one about`sphinx.util.inspect.Signature`. `Signature` is imported in the original Sphinx autodoc, and I think is very likely to be used in future,  perhaps in #26451 or in #26254.



---

archive/issue_comments_375309.json:
```json
{
    "body": "<a id='comment:67'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-17T12:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375309",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:67'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375310.json:
```json
{
    "body": "<a id='comment:68'></a>I explicitly asked not to make further changes, so I will revert that last commit.",
    "created_at": "2019-01-17T13:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375310",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>I explicitly asked not to make further changes, so I will revert that last commit.



---

archive/issue_comments_375311.json:
```json
{
    "body": "<a id='comment:69'></a>Replying to [comment:68 jdemeyer]:\n> I explicitly asked not to make further changes, so I will revert that last commit. \n\n\nOk with that. But I am curious why the small, rather insignificant, change like the last commit is unacceptable to you. It seems not a big deal to me... Is there a technical reason that I miss?",
    "created_at": "2019-01-17T13:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375311",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:69'></a>Replying to [comment:68 jdemeyer]:
> I explicitly asked not to make further changes, so I will revert that last commit. 


Ok with that. But I am curious why the small, rather insignificant, change like the last commit is unacceptable to you. It seems not a big deal to me... Is there a technical reason that I miss?



---

archive/issue_comments_375312.json:
```json
{
    "body": "<a id='comment:70'></a>I just don't want to review a moving target. The change itself may or may not be fine but at some point the branch needs to be fixed. For example, I would need to review the fact that the change is as innocent as you claim it to be.",
    "created_at": "2019-01-17T14:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375312",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:70'></a>I just don't want to review a moving target. The change itself may or may not be fine but at some point the branch needs to be fixed. For example, I would need to review the fact that the change is as innocent as you claim it to be.



---

archive/issue_comments_375313.json:
```json
{
    "body": "<a id='comment:71'></a>Replying to [comment:70 jdemeyer]:\n> I just don't want to review a moving target. The change itself may or may not be fine but at some point the branch needs to be fixed. For example, I would need to review the fact that the change is as innocent as you claim it to be.\n\n\nI agree in general. Ok.",
    "created_at": "2019-01-17T14:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375313",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:71'></a>Replying to [comment:70 jdemeyer]:
> I just don't want to review a moving target. The change itself may or may not be fine but at some point the branch needs to be fixed. For example, I would need to review the fact that the change is as innocent as you claim it to be.


I agree in general. Ok.



---

archive/issue_comments_375314.json:
```json
{
    "body": "<a id='comment:72'></a>I know that everyone is in agreement, but if you want actual evidence: in #16298, an import was apparently unused anywhere, so removing it was recommended by `pyflakes` and looked innocent to all parties involved, but removing it actually broke things. So (a) `pyflakes` can be wrong, and (b) \"innocent\" changes may not actually be innocent.",
    "created_at": "2019-01-17T18:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375314",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:72'></a>I know that everyone is in agreement, but if you want actual evidence: in #16298, an import was apparently unused anywhere, so removing it was recommended by `pyflakes` and looked innocent to all parties involved, but removing it actually broke things. So (a) `pyflakes` can be wrong, and (b) "innocent" changes may not actually be innocent.



---

archive/issue_comments_375315.json:
```json
{
    "body": "<a id='comment:74'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-18T08:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375315",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:74'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_375316.json:
```json
{
    "body": "<a id='comment:75'></a>Reverted last commit and squashed the other commits.",
    "created_at": "2019-01-18T08:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375316",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:75'></a>Reverted last commit and squashed the other commits.



---

archive/issue_comments_375317.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-18T08:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375317",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_375318.json:
```json
{
    "body": "<a id='comment:77'></a>Thank you. I wish that now with this patch, `make` builds the documentation also on python3!",
    "created_at": "2019-01-18T09:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375318",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:77'></a>Thank you. I wish that now with this patch, `make` builds the documentation also on python3!



---

archive/issue_comments_375319.json:
```json
{
    "body": "<a id='comment:78'></a>Replying to [comment:68 jdemeyer]:\n> I explicitly asked not to make further changes, so I will revert that last commit. \n\n\nI understand your reasoning, but given that the commit was made and you hadn't actually (as far as anyone can tell) begun the review the change, why not just incorporate it into your review?  It does look pretty harmless to me and, while it should still have been checked, really doesn't add significant burden to review.",
    "created_at": "2019-01-18T13:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375319",
    "user": "https://github.com/embray"
}
```

<a id='comment:78'></a>Replying to [comment:68 jdemeyer]:
> I explicitly asked not to make further changes, so I will revert that last commit. 


I understand your reasoning, but given that the commit was made and you hadn't actually (as far as anyone can tell) begun the review the change, why not just incorporate it into your review?  It does look pretty harmless to me and, while it should still have been checked, really doesn't add significant burden to review.



---

archive/issue_comments_375320.json:
```json
{
    "body": "<a id='comment:79'></a>Replying to [comment:78 embray]:\n> you hadn't actually (as far as anyone can tell) begun the review the change,\n\n\nI thought that \"I will review it. Please do not make further changes.\" was clear enough. So yes, I was already building the documentation when that additional commit was pushed.\n\nCan we please not make further fuss about this? This ticket has positive review now, let's keep it that way. It's not perfect and that's fine. And the `pyflakes` warnings are the least of my worries with the Sage docbuilder.",
    "created_at": "2019-01-18T13:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375320",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:79'></a>Replying to [comment:78 embray]:
> you hadn't actually (as far as anyone can tell) begun the review the change,


I thought that "I will review it. Please do not make further changes." was clear enough. So yes, I was already building the documentation when that additional commit was pushed.

Can we please not make further fuss about this? This ticket has positive review now, let's keep it that way. It's not perfect and that's fine. And the `pyflakes` warnings are the least of my worries with the Sage docbuilder.



---

archive/issue_comments_375321.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-24T18:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26949#issuecomment-375321",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066776.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26949",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26949#event-66776"
}
```
