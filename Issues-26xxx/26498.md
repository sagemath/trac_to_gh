# Issue 26498: each asymptotic ring gets its own term monoid factory

archive/issues_026261.json:
```json
{
    "assignees": [],
    "body": "\n\n**Branch/Commit:** [4b1aab74e47fdc801396c5bcda7a32ffc4e37d43](https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43)\n\n**Reviewer:** Benjamin Hackl\n\n**Author:** Daniel Krenn\n\nIssue created by migration from https://trac.sagemath.org/ticket/26498\n\n",
    "closed_at": "2019-04-18T19:56:51Z",
    "created_at": "2018-10-17T13:05:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20asymptotic%20expansions",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "each asymptotic ring gets its own term monoid factory",
    "type": "issue",
    "updated_at": "2019-04-18T19:56:51Z",
    "url": "https://github.com/sagemath/sage/issues/26498",
    "user": "https://github.com/dkrenn"
}
```


**Branch/Commit:** [4b1aab74e47fdc801396c5bcda7a32ffc4e37d43](https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43)

**Reviewer:** Benjamin Hackl

**Author:** Daniel Krenn

Issue created by migration from https://trac.sagemath.org/ticket/26498





---

archive/issue_events_318645.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2018-10-17T13:05:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318645"
}
```



---

archive/issue_events_318646.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2018-10-17T13:05:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20asymptotic%20expansions",
    "label_color": "08517b",
    "label_name": "component: asymptotic expansions",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318646"
}
```



---

archive/issue_events_318647.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2018-10-17T13:05:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318647"
}
```



---

archive/issue_comments_411180.json:
```json
{
    "body": "**Branch:** [u/dkrenn/asy-own-term-monoid-factory](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/asy-own-term-monoid-factory)",
    "created_at": "2018-10-17T13:08:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411180",
    "user": "https://github.com/dkrenn"
}
```

**Branch:** [u/dkrenn/asy-own-term-monoid-factory](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/asy-own-term-monoid-factory)



---

archive/issue_comments_411181.json:
```json
{
    "body": "**Commit:** [2e9317e8a9866babebf62bdd6f6e7763e440f474](https://github.com/sagemath/sagetrac-mirror/commit/2e9317e8a9866babebf62bdd6f6e7763e440f474)",
    "created_at": "2018-10-18T13:30:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411181",
    "user": "https://github.com/sagetrac-git"
}
```

**Commit:** [2e9317e8a9866babebf62bdd6f6e7763e440f474](https://github.com/sagemath/sagetrac-mirror/commit/2e9317e8a9866babebf62bdd6f6e7763e440f474)



---

archive/issue_comments_411182.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e45ca857b20f26a01bc2d142ce96ab38222a1cf\">0e45ca8</a></td><td><code>Trac #26498: convenience method term_monoid</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e9317e8a9866babebf62bdd6f6e7763e440f474\">2e9317e</a></td><td><code>Trac #26498: take care of term_monoid_factory in Functors</code></td></tr></table>\n",
    "created_at": "2018-10-18T13:30:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411182",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>**Comment 2:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e45ca857b20f26a01bc2d142ce96ab38222a1cf">0e45ca8</a></td><td><code>Trac #26498: convenience method term_monoid</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e9317e8a9866babebf62bdd6f6e7763e440f474">2e9317e</a></td><td><code>Trac #26498: take care of term_monoid_factory in Functors</code></td></tr></table>




---

archive/issue_events_318648.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2018-10-18T13:30:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318648"
}
```



---

archive/issue_comments_411183.json:
```json
{
    "body": "**Author:** Daniel Krenn",
    "created_at": "2018-10-18T13:30:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411183",
    "user": "https://github.com/dkrenn"
}
```

**Author:** Daniel Krenn



---

archive/issue_comments_411184.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40708fd108c586ee8443ff3aaed16c017a2887de\">40708fd</a></td><td><code>Trac #26498: fixup `__init__` (somehow a line was not commited)</code></td></tr></table>\n",
    "created_at": "2018-10-20T15:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411184",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>**Comment 4:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40708fd108c586ee8443ff3aaed16c017a2887de">40708fd</a></td><td><code>Trac #26498: fixup `__init__` (somehow a line was not commited)</code></td></tr></table>




---

archive/issue_comments_411185.json:
```json
{
    "body": "**Changing commit** from \"[2e9317e8a9866babebf62bdd6f6e7763e440f474](https://github.com/sagemath/sagetrac-mirror/commit/2e9317e8a9866babebf62bdd6f6e7763e440f474)\" to \"[40708fd108c586ee8443ff3aaed16c017a2887de](https://github.com/sagemath/sagetrac-mirror/commit/40708fd108c586ee8443ff3aaed16c017a2887de)\".",
    "created_at": "2018-10-20T15:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411185",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[2e9317e8a9866babebf62bdd6f6e7763e440f474](https://github.com/sagemath/sagetrac-mirror/commit/2e9317e8a9866babebf62bdd6f6e7763e440f474)" to "[40708fd108c586ee8443ff3aaed16c017a2887de](https://github.com/sagemath/sagetrac-mirror/commit/40708fd108c586ee8443ff3aaed16c017a2887de)".



---

archive/issue_comments_411186.json:
```json
{
    "body": "**Changing commit** from \"[40708fd108c586ee8443ff3aaed16c017a2887de](https://github.com/sagemath/sagetrac-mirror/commit/40708fd108c586ee8443ff3aaed16c017a2887de)\" to \"[432dca4755323f302e0feb6738f46b1c3a500476](https://github.com/sagemath/sagetrac-mirror/commit/432dca4755323f302e0feb6738f46b1c3a500476)\".",
    "created_at": "2018-11-12T12:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411186",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[40708fd108c586ee8443ff3aaed16c017a2887de](https://github.com/sagemath/sagetrac-mirror/commit/40708fd108c586ee8443ff3aaed16c017a2887de)" to "[432dca4755323f302e0feb6738f46b1c3a500476](https://github.com/sagemath/sagetrac-mirror/commit/432dca4755323f302e0feb6738f46b1c3a500476)".



---

archive/issue_comments_411187.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/432dca4755323f302e0feb6738f46b1c3a500476\">432dca4</a></td><td><code>Trac #26498: method term_monoid</code></td></tr></table>\n",
    "created_at": "2018-11-12T12:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411187",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>**Comment 5:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/432dca4755323f302e0feb6738f46b1c3a500476">432dca4</a></td><td><code>Trac #26498: method term_monoid</code></td></tr></table>




---

archive/issue_comments_411188.json:
```json
{
    "body": "**Changing commit** from \"[432dca4755323f302e0feb6738f46b1c3a500476](https://github.com/sagemath/sagetrac-mirror/commit/432dca4755323f302e0feb6738f46b1c3a500476)\" to \"[4b1aab74e47fdc801396c5bcda7a32ffc4e37d43](https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43)\".",
    "created_at": "2019-04-16T14:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411188",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[432dca4755323f302e0feb6738f46b1c3a500476](https://github.com/sagemath/sagetrac-mirror/commit/432dca4755323f302e0feb6738f46b1c3a500476)" to "[4b1aab74e47fdc801396c5bcda7a32ffc4e37d43](https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43)".



---

archive/issue_comments_411189.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43\">4b1aab7</a></td><td><code>remove forgotten \"TODO\"</code></td></tr></table>\n",
    "created_at": "2019-04-16T14:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411189",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>**Comment 6:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43">4b1aab7</a></td><td><code>remove forgotten "TODO"</code></td></tr></table>




---

archive/issue_events_318649.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2019-04-16T14:14:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318649"
}
```



---

archive/issue_events_318650.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2019-04-16T14:14:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318650"
}
```



---

archive/issue_comments_411190.json:
```json
{
    "body": "**Reviewer:** Benjamin Hackl",
    "created_at": "2019-04-16T14:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411190",
    "user": "https://github.com/behackl"
}
```

**Reviewer:** Benjamin Hackl



---

archive/issue_events_318651.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2019-04-16T14:14:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318651"
}
```



---

archive/issue_events_318652.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2019-04-16T14:14:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318652"
}
```



---

archive/issue_comments_411191.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nI've looked through these changes and had one minor remark (the overlooked TODO in a docstring), this was already fixed via https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43.\n\nThus, I am happy. The patchbot tests seem to be false-negatives, testing the code locally (after merging `8.7`) made all tests pass. Good to go.",
    "created_at": "2019-04-16T14:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411191",
    "user": "https://github.com/behackl"
}
```

<a id='comment:7'>**Comment 7:**</a>
I've looked through these changes and had one minor remark (the overlooked TODO in a docstring), this was already fixed via https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43.

Thus, I am happy. The patchbot tests seem to be false-negatives, testing the code locally (after merging `8.7`) made all tests pass. Good to go.



---

archive/issue_comments_411192.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nJust a comment:\n\n```\nclass TermMonoidFactory(UniqueRepresentation, UniqueFactory):\n```\nhas a very strong code smell to me and makes me concerned about memory leaks. Maybe it is all okay, but it is a bit of a departure from normal use.",
    "created_at": "2019-04-17T01:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411192",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'>**Comment 8:**</a>
Just a comment:

```
class TermMonoidFactory(UniqueRepresentation, UniqueFactory):
```
has a very strong code smell to me and makes me concerned about memory leaks. Maybe it is all okay, but it is a bit of a departure from normal use.



---

archive/issue_comments_411193.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nReplying to [@tscrim](#comment%3A8):\n> Just a comment:\n> \n> ```\n> class TermMonoidFactory(UniqueRepresentation, UniqueFactory):\n> ```\n> has a very strong code smell to me and makes me concerned about memory leaks. Maybe it is all okay, but it is a bit of a departure from normal use.\n\nWe have/need a parametrized factory; the desired behavior should be that of both base classes. Where/how do you think the memory leak appears?",
    "created_at": "2019-04-17T08:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411193",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:9'>**Comment 9:**</a>
Replying to [@tscrim](#comment%3A8):
> Just a comment:
> 
> ```
> class TermMonoidFactory(UniqueRepresentation, UniqueFactory):
> ```
> has a very strong code smell to me and makes me concerned about memory leaks. Maybe it is all okay, but it is a bit of a departure from normal use.

We have/need a parametrized factory; the desired behavior should be that of both base classes. Where/how do you think the memory leak appears?



---

archive/issue_comments_411194.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nWhat I am worried about is `TermMonoidFactory` having a key `G` to its construction, when then creates an object `TM` (which has a weak ref from the factory) that then holds a strong ref to `G`, creating a reference cycle with a strong reference with the `UniqueRepresentation` key nailing it all in memory.\n\nIMO, it also feels like the `TermMonoidFactory` is better suited to being a parent that is its just a `UniqueRepresentation` (not to mention all of the ugly doctests). It just is looking quite awkward to me.\n\nHowever, this is not code I have an investment in, so the design decisions are your. So if there is no memory leak, then feel free to disregard my comment(s).",
    "created_at": "2019-04-17T12:29:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411194",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>**Comment 10:**</a>
What I am worried about is `TermMonoidFactory` having a key `G` to its construction, when then creates an object `TM` (which has a weak ref from the factory) that then holds a strong ref to `G`, creating a reference cycle with a strong reference with the `UniqueRepresentation` key nailing it all in memory.

IMO, it also feels like the `TermMonoidFactory` is better suited to being a parent that is its just a `UniqueRepresentation` (not to mention all of the ugly doctests). It just is looking quite awkward to me.

However, this is not code I have an investment in, so the design decisions are your. So if there is no memory leak, then feel free to disregard my comment(s).



---

archive/issue_comments_411195.json:
```json
{
    "body": "**Changing branch** from \"[u/dkrenn/asy-own-term-monoid-factory](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/asy-own-term-monoid-factory)\" to \"[4b1aab74e47fdc801396c5bcda7a32ffc4e37d43](https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43)\".",
    "created_at": "2019-04-18T19:56:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26498#issuecomment-411195",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/dkrenn/asy-own-term-monoid-factory](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/asy-own-term-monoid-factory)" to "[4b1aab74e47fdc801396c5bcda7a32ffc4e37d43](https://github.com/sagemath/sagetrac-mirror/commit/4b1aab74e47fdc801396c5bcda7a32ffc4e37d43)".



---

archive/issue_events_318653.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-18T19:56:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318653"
}
```



---

archive/issue_events_318654.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f2f05fc5bb8502e6859ad26ea769bba8a8acfee7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-04-18T19:56:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26498",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26498#event-318654"
}
```
