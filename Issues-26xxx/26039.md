# Issue 26039: LieAlgebraHomset is not unique

archive/issues_025802.json:
```json
{
    "body": "`sage.algebras.lie_algebras.morphism.LieAlgebraHomset` does not have the same unique behavior as Hom. A minimal example:\n\n```\nsage: from sage.algebras.lie_algebras.morphism import LieAlgebraHomset\nsage: L = LieAlgebra(QQ,1,abelian=True)\nsage: LieAlgebraHomset(L,L) == LieAlgebraHomset(L,L)\nTrue\nsage: LieAlgebraHomset(L,L) is LieAlgebraHomset(L,L)\nFalse\n```\n\nThis causes an issue with pickling for `LieAlgebraHomomorphism_im_gens`. Running\n\n```python\nL.<X> = LieAlgebra(QQ,1,abelian=True)\nf = LieAlgebraHomomorphism_im_gens(LieAlgebraHomset(L,L),[X])\nf._test_pickling()\n```\noutputs\n\n```\nRuntimeError: There is a bug in the coercion code in Sage.\nBoth x (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X) and y (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X) are supposed to have identical parents but they don't.\nIn fact, x has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'\nwhereas y has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'\nOriginal elements Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field\n  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and maps\n<type 'NoneType'> None\n<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'> (map internal to coercion system -- copy before use)\nCoercion map:\n  From: Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field\n  To:   Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field\n```\n\nKeywords: Lie algebras, morphisms\n\nReviewer: Travis Scrimshaw\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/26039\n\n",
    "closed_at": "2019-02-26T13:58:00Z",
    "created_at": "2018-08-10T05:38:15Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "LieAlgebraHomset is not unique",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26039",
    "user": "https://github.com/ehaka"
}
```
`sage.algebras.lie_algebras.morphism.LieAlgebraHomset` does not have the same unique behavior as Hom. A minimal example:

```
sage: from sage.algebras.lie_algebras.morphism import LieAlgebraHomset
sage: L = LieAlgebra(QQ,1,abelian=True)
sage: LieAlgebraHomset(L,L) == LieAlgebraHomset(L,L)
True
sage: LieAlgebraHomset(L,L) is LieAlgebraHomset(L,L)
False
```

This causes an issue with pickling for `LieAlgebraHomomorphism_im_gens`. Running

```python
L.<X> = LieAlgebra(QQ,1,abelian=True)
f = LieAlgebraHomomorphism_im_gens(LieAlgebraHomset(L,L),[X])
f._test_pickling()
```
outputs

```
RuntimeError: There is a bug in the coercion code in Sage.
Both x (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X) and y (=Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X) are supposed to have identical parents but they don't.
In fact, x has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'
whereas y has parent 'Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field'
Original elements Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and Lie algebra endomorphism of Abelian Lie algebra on generator X over Rational Field
  Defn: X |--> X (parent Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field) and maps
<type 'NoneType'> None
<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'> (map internal to coercion system -- copy before use)
Coercion map:
  From: Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field
  To:   Set of Lie algebra morphisms from Abelian Lie algebra on generator X over Rational Field to Abelian Lie algebra on generator X over Rational Field
```

Keywords: Lie algebras, morphisms

Reviewer: Travis Scrimshaw

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/26039





---

archive/issue_events_065039.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-10T06:10:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26039#event-65039"
}
```



---

archive/issue_comments_363821.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-10T06:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26039#issuecomment-363821",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_363822.json:
```json
{
    "body": "<a id='comment:1'></a>This is actually the correct behavior I believe. Part of the reason is that `Hom` already does the caching:\n\n```\nsage: Hom(L,L) is Hom(L,L)\nTrue\n```\nThe other is that `*Homset` should (in principle) work with something that is not a `UniqueRepresentation`, in which case it should not support that UR behavior.\n\nYes, it is subtle, and I am not completely sure it is properly documented. However, it is what should be happening and you should be using `Hom` to construct the homset.",
    "created_at": "2018-08-10T06:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26039#issuecomment-363822",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>This is actually the correct behavior I believe. Part of the reason is that `Hom` already does the caching:

```
sage: Hom(L,L) is Hom(L,L)
True
```
The other is that `*Homset` should (in principle) work with something that is not a `UniqueRepresentation`, in which case it should not support that UR behavior.

Yes, it is subtle, and I am not completely sure it is properly documented. However, it is what should be happening and you should be using `Hom` to construct the homset.



---

archive/issue_comments_363823.json:
```json
{
    "body": "<a id='comment:2'></a>I see, it seems that indeed also the Homset superclass behaves the same way. Good to know for the future, thanks!",
    "created_at": "2018-08-10T08:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26039#issuecomment-363823",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:2'></a>I see, it seems that indeed also the Homset superclass behaves the same way. Good to know for the future, thanks!



---

archive/issue_comments_363824.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-10T09:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26039#issuecomment-363824",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065040.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-26T13:58:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26039#event-65040"
}
```



---

archive/issue_comments_363825.json:
```json
{
    "body": "<a id='comment:4'></a>Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26039#issuecomment-363825",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_comments_363826.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26039#issuecomment-363826",
    "user": "https://github.com/embray"
}
```

Resolution: invalid
