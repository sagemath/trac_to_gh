# Issue 26993: Allow multiplication of function field elements with differentials from compatible fields

archive/issues_026756.json:
```json
{
    "body": "In the function field code, you currently can't multiply function field elements with differentials from a subfield.\n\nFor example, in this basic setup:\n\n```\nsage: K.<x> = FunctionField(QQ); R.<y> = K[]\nsage: L.<y> = K.extension(y^2 - x*y + 4*x^3)\n```\n\n`y * y.differential()` works, but `y * x.differential()` doesn't, because there's no way to multiply an element of `L` with a differential from `K`.\n\nThe code attached to this ticket fixes that problem by defining suitable actions and coercion morphisms.\n\nCC:  @kwankyu\n\nKeywords: function field\n\nBranch/Commit: bffacfcfbcd2b88c8b298f037d31228464e2763a\n\nReviewer: Kwankyu Lee, Travis Scrimshaw\n\nAuthor: Brent Baccala\n\nDependencies: #27712\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26993\n\n",
    "closed_at": "2019-06-27T20:13:44Z",
    "created_at": "2019-01-02T04:27:11Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Allow multiplication of function field elements with differentials from compatible fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26993",
    "user": "https://github.com/BrentBaccala"
}
```
In the function field code, you currently can't multiply function field elements with differentials from a subfield.

For example, in this basic setup:

```
sage: K.<x> = FunctionField(QQ); R.<y> = K[]
sage: L.<y> = K.extension(y^2 - x*y + 4*x^3)
```

`y * y.differential()` works, but `y * x.differential()` doesn't, because there's no way to multiply an element of `L` with a differential from `K`.

The code attached to this ticket fixes that problem by defining suitable actions and coercion morphisms.

CC:  @kwankyu

Keywords: function field

Branch/Commit: bffacfcfbcd2b88c8b298f037d31228464e2763a

Reviewer: Kwankyu Lee, Travis Scrimshaw

Author: Brent Baccala

Dependencies: #27712

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26993





---

archive/issue_comments_375867.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2019-01-02T04:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375867",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_375868.json:
```json
{
    "body": "<a id='comment:2'></a>Note: the dependency field should be filled with ticket numbers, including #, and not with branch names.",
    "created_at": "2019-01-02T12:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375868",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>Note: the dependency field should be filled with ticket numbers, including #, and not with branch names.



---

archive/issue_comments_375869.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 chapoton]:\n> Note: the dependency field should be filled with ticket numbers, including #, and not with branch names.\n\n\nCorrected.",
    "created_at": "2019-01-03T20:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375869",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:3'></a>Replying to [comment:2 chapoton]:
> Note: the dependency field should be filled with ticket numbers, including #, and not with branch names.


Corrected.



---

archive/issue_comments_375870.json:
```json
{
    "body": "<a id='comment:4'></a>Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375870",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_066974.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66974"
}
```



---

archive/issue_events_066975.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2019-01-17T21:36:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66975"
}
```



---

archive/issue_events_066976.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2019-01-17T21:36:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66976"
}
```



---

archive/issue_comments_375871.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-08T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_066977.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2019-04-08T19:43:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66977"
}
```



---

archive/issue_events_066978.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2019-04-08T19:43:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66978"
}
```



---

archive/issue_comments_375872.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-08T19:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375872",
    "user": "https://github.com/BrentBaccala"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_375873.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-11T02:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375874.json:
```json
{
    "body": "<a id='comment:10'></a>What is the map from the module of differentials of K into the module of differentials of L that you implement a coercion for?",
    "created_at": "2019-04-16T05:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375874",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:10'></a>What is the map from the module of differentials of K into the module of differentials of L that you implement a coercion for?



---

archive/issue_comments_375875.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 klee]:\n> What is the map from the module of differentials of K into the module of differentials of L that you implement a coercion for? \n\n\nf dx maps to f dx.\n\n```\nsage: K.<x> = FunctionField(QQ); R.<y> = K[]\nsage: L.<y> = K.extension(y^2 - x*y + 4*x^3)\n\nsage: x*x.differential()\n(x) d(x)\nsage: (x*x.differential()).parent()\nSpace of differentials of Rational function field in x over Rational Field\n\nsage: L.space_of_differentials()(x*x.differential())\n(x) d(x)\nsage: L.space_of_differentials()(x*x.differential()).parent()\nSpace of differentials of Function field in y defined by y^2 - x*y + 4*x^3\n```",
    "created_at": "2019-04-16T23:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375875",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:11'></a>Replying to [comment:10 klee]:
> What is the map from the module of differentials of K into the module of differentials of L that you implement a coercion for? 


f dx maps to f dx.

```
sage: K.<x> = FunctionField(QQ); R.<y> = K[]
sage: L.<y> = K.extension(y^2 - x*y + 4*x^3)

sage: x*x.differential()
(x) d(x)
sage: (x*x.differential()).parent()
Space of differentials of Rational function field in x over Rational Field

sage: L.space_of_differentials()(x*x.differential())
(x) d(x)
sage: L.space_of_differentials()(x*x.differential()).parent()
Space of differentials of Function field in y defined by y^2 - x*y + 4*x^3
```



---

archive/issue_comments_375876.json:
```json
{
    "body": "<a id='comment:12'></a>Do you also handle the case when  K=k(x), L=K(y), M=L(z) is a tower of function fields, z an element of M, and you take z*dx? What should be the result?",
    "created_at": "2019-04-17T04:57:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375876",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:12'></a>Do you also handle the case when  K=k(x), L=K(y), M=L(z) is a tower of function fields, z an element of M, and you take z*dx? What should be the result?



---

archive/issue_comments_375877.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 klee]:\n> Do you also handle the case when  K=k(x), L=K(y), M=L(z) is a tower of function fields, z an element of M, and you take z*dx? What should be the result?\n> \n\n\nNo, nested fields don't work right.  For example,\n\n```\nsage: K.<x> = FunctionField(QQ)\nsage: R.<y> = K[]\nsage: L.<y> = K.extension(y^2 - x)\nsage: R.<z> = L[]\nsage: M.<z> = L.extension(z^2 - y)\n\nsage: M.space_of_differentials()(x.differential())\nd(y)\n```\n\n\nPart of the reason for this is that the element constructor (without applying this ticket) doesn't work the way I'd expect:\n\n```\nsage: K.space_of_differentials()(x)\nd(x)\nsage: L.space_of_differentials()(x)\nd(x)\nsage: M.space_of_differentials()(x)\nd(y)\n```\n\nWhat is the rationale for expressing differentials in extensions w.r.t. the generator of the field immediately underneath the extension?  Should there be some way to express differentials w.r.t the rational function field under all of the extensions?\n\nI'm thinking that the result of `M.space_of_differentials()(x)` should be `d(x)` and the differentials should all be expressed w.r.t the base rational function field.  Otherwise, if they're expressed w.r.t. the first underlying field, then the result of `M.space_of_differentials()(x)` should be `2 y d(y)`.\n\nShould the user be able to select which variable is used to express differentials?\n\nFor my application, I either want to express differentials w.r.t the base rational function field, or w.r.t. a local uniformizing variable at a specific place.\n\nI'd like to hear some feedback on what klee (and others) think.",
    "created_at": "2019-04-17T22:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375877",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:13'></a>Replying to [comment:12 klee]:
> Do you also handle the case when  K=k(x), L=K(y), M=L(z) is a tower of function fields, z an element of M, and you take z*dx? What should be the result?
> 


No, nested fields don't work right.  For example,

```
sage: K.<x> = FunctionField(QQ)
sage: R.<y> = K[]
sage: L.<y> = K.extension(y^2 - x)
sage: R.<z> = L[]
sage: M.<z> = L.extension(z^2 - y)

sage: M.space_of_differentials()(x.differential())
d(y)
```


Part of the reason for this is that the element constructor (without applying this ticket) doesn't work the way I'd expect:

```
sage: K.space_of_differentials()(x)
d(x)
sage: L.space_of_differentials()(x)
d(x)
sage: M.space_of_differentials()(x)
d(y)
```

What is the rationale for expressing differentials in extensions w.r.t. the generator of the field immediately underneath the extension?  Should there be some way to express differentials w.r.t the rational function field under all of the extensions?

I'm thinking that the result of `M.space_of_differentials()(x)` should be `d(x)` and the differentials should all be expressed w.r.t the base rational function field.  Otherwise, if they're expressed w.r.t. the first underlying field, then the result of `M.space_of_differentials()(x)` should be `2 y d(y)`.

Should the user be able to select which variable is used to express differentials?

For my application, I either want to express differentials w.r.t the base rational function field, or w.r.t. a local uniformizing variable at a specific place.

I'd like to hear some feedback on what klee (and others) think.



---

archive/issue_comments_375878.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 gh-BrentBaccala]:\n> Replying to [comment:12 klee]:\n> > Do you also handle the case when  K=k(x), L=K(y), M=L(z) is a tower of function fields, z an element of M, and you take z*dx? What should be the result?\n> > \n\n> \n> No, nested fields don't work right. \n\n\nSo it seems.\n\n> Part of the reason for this is that the element constructor (without applying this ticket) doesn't work the way I'd expect:\n> \n> \n> ```\n> sage: K.space_of_differentials()(x)\n> d(x)\n> sage: L.space_of_differentials()(x)\n> d(x)\n> sage: M.space_of_differentials()(x)\n> d(y)\n> ```\n\n\nCurrently Sage only supports differentials of global function fields (and rational function fields). \n\nSo you may need to enlarge the class of function fields that differentials are supported before you work on this ticket. Or you may clarify the cases for which the coercion works.",
    "created_at": "2019-04-18T04:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375878",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>Replying to [comment:13 gh-BrentBaccala]:
> Replying to [comment:12 klee]:
> > Do you also handle the case when  K=k(x), L=K(y), M=L(z) is a tower of function fields, z an element of M, and you take z*dx? What should be the result?
> > 

> 
> No, nested fields don't work right. 


So it seems.

> Part of the reason for this is that the element constructor (without applying this ticket) doesn't work the way I'd expect:
> 
> 
> ```
> sage: K.space_of_differentials()(x)
> d(x)
> sage: L.space_of_differentials()(x)
> d(x)
> sage: M.space_of_differentials()(x)
> d(y)
> ```


Currently Sage only supports differentials of global function fields (and rational function fields). 

So you may need to enlarge the class of function fields that differentials are supported before you work on this ticket. Or you may clarify the cases for which the coercion works.



---

archive/issue_comments_375879.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 klee]:\n> Currently Sage only supports differentials of global function fields (and rational function fields). \n> \n> So you may need to enlarge the class of function fields that differentials are supported before you work on this ticket. Or you may clarify the cases for which the coercion works.\n\n\nOK, so let me change the example.  How about this:\n\n```\nsage: K.<x> = FunctionField(GF(31))\nsage: R.<y> = K[]\nsage: L.<y> = K.extension(y^2 - x)\nsage: R.<z> = L[]\nsage: M.<z> = L.extension(z^2 - y)\n\nsage: K.space_of_differentials()(x)\nd(x)\nsage: L.space_of_differentials()(x)\nd(x)\nsage: M.space_of_differentials()(x)\nd(y)\n```\n\nNow `M` is a global function field, right?  Yet we still see the same behavior.  Furthermore...\n\n```\nsage: z.differential()\n(8/x*z) d(y)\n```\n\nYet dz = 1/(2*z) dy, which doesn't seem to be (8/x*z):\n\n```\nsage: 1/(2*z) == (8/x*z)\nFalse\n```\n\nWhat's going on here?\n\n```\nsage: M.derivation()\nDerivation map:\n  From: Function field in z defined by z^2 + 30*y\n  To:   Function field in z defined by z^2 + 30*y\n  Defn: z |--> 8/x*z\n        y |--> 16/x*y\n        x |--> 1\n```\n\n`M`'s derivation map is w.r.t. x, but `FunctionFieldDifferential_global`'s constructor assumes that it's w.r.t. y, right?",
    "created_at": "2019-04-18T20:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375879",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:15'></a>Replying to [comment:14 klee]:
> Currently Sage only supports differentials of global function fields (and rational function fields). 
> 
> So you may need to enlarge the class of function fields that differentials are supported before you work on this ticket. Or you may clarify the cases for which the coercion works.


OK, so let me change the example.  How about this:

```
sage: K.<x> = FunctionField(GF(31))
sage: R.<y> = K[]
sage: L.<y> = K.extension(y^2 - x)
sage: R.<z> = L[]
sage: M.<z> = L.extension(z^2 - y)

sage: K.space_of_differentials()(x)
d(x)
sage: L.space_of_differentials()(x)
d(x)
sage: M.space_of_differentials()(x)
d(y)
```

Now `M` is a global function field, right?  Yet we still see the same behavior.  Furthermore...

```
sage: z.differential()
(8/x*z) d(y)
```

Yet dz = 1/(2*z) dy, which doesn't seem to be (8/x*z):

```
sage: 1/(2*z) == (8/x*z)
False
```

What's going on here?

```
sage: M.derivation()
Derivation map:
  From: Function field in z defined by z^2 + 30*y
  To:   Function field in z defined by z^2 + 30*y
  Defn: z |--> 8/x*z
        y |--> 16/x*y
        x |--> 1
```

`M`'s derivation map is w.r.t. x, but `FunctionFieldDifferential_global`'s constructor assumes that it's w.r.t. y, right?



---

archive/issue_comments_375880.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-04-18T23:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375880",
    "user": "https://github.com/BrentBaccala"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_375881.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 gh-BrentBaccala]:\n> Replying to [comment:14 klee]:\n> > Currently Sage only supports differentials of global function fields (and rational function fields). \n> > \n> > So you may need to enlarge the class of function fields that differentials are supported before you work on this ticket. Or you may clarify the cases for which the coercion works.\n\n> \n> OK, so let me change the example.  How about this:\n> \n> \n> ```\n> sage: K.<x> = FunctionField(GF(31))\n> sage: R.<y> = K[]\n> sage: L.<y> = K.extension(y^2 - x)\n> sage: R.<z> = L[]\n> sage: M.<z> = L.extension(z^2 - y)\n> \n> sage: K.space_of_differentials()(x)\n> d(x)\n> sage: L.space_of_differentials()(x)\n> d(x)\n> sage: M.space_of_differentials()(x)\n> d(y)\n> ```\n> \n> Now `M` is a global function field, right?  \n\n\nI meant global function fields in sage. They are separable extensions of rational function fields over finite fields. M is not a global function field in sage in this sense.\n\nThe erroneous behavior of your example just indicates that to support differentials of extensions of non-rational function fields, some part of the infrastructure needs to be fixed. \n\nI guess your coercion is not intended just for global functions fields.  But as we saw, based on the current sage, your coercion doesn't work right for tower of function fields.  Then perhaps the scope of your coercion is extensions of rational function fields. I asked you to clarify this.\n\nOn the other hand, I think what you are implementing is the natural inclusion of the tensor product $L \\otimes_K \\Omega_K$ into $\\Omega_L$ defined by f*(gdx) -> fg dx for f in L and g, x in K. Then the coercion would work right for towers of function fields once you enlarge the scope of differentials in sage properly. I am curious if you want to do this in this ticket or another ticket.",
    "created_at": "2019-04-19T01:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375881",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:17'></a>Replying to [comment:15 gh-BrentBaccala]:
> Replying to [comment:14 klee]:
> > Currently Sage only supports differentials of global function fields (and rational function fields). 
> > 
> > So you may need to enlarge the class of function fields that differentials are supported before you work on this ticket. Or you may clarify the cases for which the coercion works.

> 
> OK, so let me change the example.  How about this:
> 
> 
> ```
> sage: K.<x> = FunctionField(GF(31))
> sage: R.<y> = K[]
> sage: L.<y> = K.extension(y^2 - x)
> sage: R.<z> = L[]
> sage: M.<z> = L.extension(z^2 - y)
> 
> sage: K.space_of_differentials()(x)
> d(x)
> sage: L.space_of_differentials()(x)
> d(x)
> sage: M.space_of_differentials()(x)
> d(y)
> ```
> 
> Now `M` is a global function field, right?  


I meant global function fields in sage. They are separable extensions of rational function fields over finite fields. M is not a global function field in sage in this sense.

The erroneous behavior of your example just indicates that to support differentials of extensions of non-rational function fields, some part of the infrastructure needs to be fixed. 

I guess your coercion is not intended just for global functions fields.  But as we saw, based on the current sage, your coercion doesn't work right for tower of function fields.  Then perhaps the scope of your coercion is extensions of rational function fields. I asked you to clarify this.

On the other hand, I think what you are implementing is the natural inclusion of the tensor product $L \otimes_K \Omega_K$ into $\Omega_L$ defined by f*(gdx) -> fg dx for f in L and g, x in K. Then the coercion would work right for towers of function fields once you enlarge the scope of differentials in sage properly. I am curious if you want to do this in this ticket or another ticket.



---

archive/issue_comments_375882.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 klee]:\n> The erroneous behavior of your example just indicates that to support differentials of extensions of non-rational function fields, some part of the infrastructure needs to be fixed. \n\n\nOK.  I think that's another ticket.\n\n> I guess your coercion is not intended just for global functions fields.  But as we saw, based on the current sage, your coercion doesn't work right for tower of function fields.  Then perhaps the scope of your coercion is extensions of rational function fields. I asked you to clarify this.\n\n\nNo, my coercion is not intended just for global function fields.  I'd like it to work for all of the function fields that can formed using the present code.\n\n> On the other hand, I think what you are implementing is the natural inclusion of the tensor product $L \\otimes_K \\Omega_K$ into $\\Omega_L$ defined by f*(gdx) -> fg dx for f in L and g, x in K. Then the coercion would work right for towers of function fields once you enlarge the scope of differentials in sage properly. I am curious if you want to do this in this ticket or another ticket.\n> \n\n\nI'm thinking that I'll open another ticket to revise the differential code so that it supports all of the existing function fields, then come back to this ticket to see if any changes are needed here.\n\nI haven't created that new ticket yet.  Do you want me to add you to the cc line when I do?",
    "created_at": "2019-04-19T03:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375882",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:18'></a>Replying to [comment:17 klee]:
> The erroneous behavior of your example just indicates that to support differentials of extensions of non-rational function fields, some part of the infrastructure needs to be fixed. 


OK.  I think that's another ticket.

> I guess your coercion is not intended just for global functions fields.  But as we saw, based on the current sage, your coercion doesn't work right for tower of function fields.  Then perhaps the scope of your coercion is extensions of rational function fields. I asked you to clarify this.


No, my coercion is not intended just for global function fields.  I'd like it to work for all of the function fields that can formed using the present code.

> On the other hand, I think what you are implementing is the natural inclusion of the tensor product $L \otimes_K \Omega_K$ into $\Omega_L$ defined by f*(gdx) -> fg dx for f in L and g, x in K. Then the coercion would work right for towers of function fields once you enlarge the scope of differentials in sage properly. I am curious if you want to do this in this ticket or another ticket.
> 


I'm thinking that I'll open another ticket to revise the differential code so that it supports all of the existing function fields, then come back to this ticket to see if any changes are needed here.

I haven't created that new ticket yet.  Do you want me to add you to the cc line when I do?



---

archive/issue_comments_375883.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 gh-BrentBaccala]:\n> I'm thinking that I'll open another ticket to revise the differential code so that it supports all of the existing function fields, then come back to this ticket to see if any changes are needed here.\n\n\nNice.\n \n> I haven't created that new ticket yet.  Do you want me to add you to the cc line when I do?\n\n\nOk. No one asks for that these days :-)",
    "created_at": "2019-04-19T04:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375883",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:19'></a>Replying to [comment:18 gh-BrentBaccala]:
> I'm thinking that I'll open another ticket to revise the differential code so that it supports all of the existing function fields, then come back to this ticket to see if any changes are needed here.


Nice.
 
> I haven't created that new ticket yet.  Do you want me to add you to the cc line when I do?


Ok. No one asks for that these days :-)



---

archive/issue_comments_375884.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:18 gh-BrentBaccala]:\n> I'm thinking that I'll open another ticket to revise the differential code so that it supports all of the existing function fields, then come back to this ticket to see if any changes are needed here.\n\n\nThat ticket is now #27712",
    "created_at": "2019-04-22T18:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375884",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:20'></a>Replying to [comment:18 gh-BrentBaccala]:
> I'm thinking that I'll open another ticket to revise the differential code so that it supports all of the existing function fields, then come back to this ticket to see if any changes are needed here.


That ticket is now #27712



---

archive/issue_comments_375885.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-24T00:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375886.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-24T00:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375886",
    "user": "https://github.com/BrentBaccala"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375887.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-26T00:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375888.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-04T03:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375889.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-14T01:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_375890.json:
```json
{
    "body": "<a id='comment:27'></a>I worked on your code and could simplify a lot the code. \n\nPositive review on your part of the code.",
    "created_at": "2019-06-14T01:38:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375890",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:27'></a>I worked on your code and could simplify a lot the code. 

Positive review on your part of the code.



---

archive/issue_comments_375891.json:
```json
{
    "body": "<a id='comment:29'></a>Needs review on reviewer's part of the code.",
    "created_at": "2019-06-25T07:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375891",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:29'></a>Needs review on reviewer's part of the code.



---

archive/issue_comments_375892.json:
```json
{
    "body": "<a id='comment:30'></a>I thought the coercion frame took care of coercions of actions. In particular, I would think you do not need to implement that `_acted_upon_` given that you (now) have the coercion map.",
    "created_at": "2019-06-26T10:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375892",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:30'></a>I thought the coercion frame took care of coercions of actions. In particular, I would think you do not need to implement that `_acted_upon_` given that you (now) have the coercion map.



---

archive/issue_comments_375893.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:30 tscrim]:\n> I thought the coercion frame took care of coercions of actions. In particular, I would think you do not need to implement that `_acted_upon_` given that you (now) have the coercion map.\n\n\nThere is no action to be discovered by the coercion frame even though the coercion map is there. \n\nFor y*dx, where x is in a function field F and y is in its extension E, which is the case that this ticket deals with, the action on the differential dx is **not** constructed from `_rmul_` automatically because y is not in F.\n\n\nSo I implemented one.",
    "created_at": "2019-06-26T11:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375893",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:31'></a>Replying to [comment:30 tscrim]:
> I thought the coercion frame took care of coercions of actions. In particular, I would think you do not need to implement that `_acted_upon_` given that you (now) have the coercion map.


There is no action to be discovered by the coercion frame even though the coercion map is there. 

For y*dx, where x is in a function field F and y is in its extension E, which is the case that this ticket deals with, the action on the differential dx is **not** constructed from `_rmul_` automatically because y is not in F.


So I implemented one.



---

archive/issue_comments_375894.json:
```json
{
    "body": "<a id='comment:32'></a>Hmm...that sounds like a pushout construction is missing. Well, that could be done on a followup as this works.",
    "created_at": "2019-06-26T14:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375894",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'></a>Hmm...that sounds like a pushout construction is missing. Well, that could be done on a followup as this works.



---

archive/issue_events_066979.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-26T14:27:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66979"
}
```



---

archive/issue_events_066980.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-26T14:27:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66980"
}
```



---

archive/issue_comments_375895.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-26T14:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375895",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_375896.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-27T20:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26993#issuecomment-375896",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066981.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-27T20:13:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26993",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26993#event-66981"
}
```
