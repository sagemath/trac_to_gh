# Issue 26097: Py3: Some fixes in knot.link.py

archive/issues_025860.json:
```json
{
    "assignees": [],
    "body": "In `link.py`:\n- regions(): use of a sorted list instead of a set for available_segments to have the same result in py2 and py3.\n\n- _directions_of_edges(): Modify doctest to display results in the same order in py2 and py3.\n\nNote to reviewer : As i am not an expert in knots theory please ensure that the new results of `region()` are correct.\n\nAlso note that\n\n```\n                    if a in available_segments:\n                        available_segments.remove(a)\n```\nmight be slower than before. Tell me if the performance impact is negligible or if i should use another algorithm.\n\nCC:  @embray\n\nComponent: **python3**\n\nAuthor: **Vincent Klein**\n\nBranch: **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26097_\n\n",
    "closed_at": "2018-08-30T22:24:34Z",
    "created_at": "2018-08-20T12:24:07Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Py3: Some fixes in knot.link.py",
    "type": "issue",
    "updated_at": "2018-09-03T09:47:21Z",
    "url": "https://github.com/sagemath/sage/issues/26097",
    "user": "https://github.com/vinklein"
}
```
In `link.py`:
- regions(): use of a sorted list instead of a set for available_segments to have the same result in py2 and py3.

- _directions_of_edges(): Modify doctest to display results in the same order in py2 and py3.

Note to reviewer : As i am not an expert in knots theory please ensure that the new results of `region()` are correct.

Also note that

```
                    if a in available_segments:
                        available_segments.remove(a)
```
might be slower than before. Tell me if the performance impact is negligible or if i should use another algorithm.

CC:  @embray

Component: **python3**

Author: **Vincent Klein**

Branch: **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)**

Reviewer: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/26097_





---

archive/issue_events_357248.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-08-20T12:24:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357248"
}
```



---

archive/issue_events_357249.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-08-20T12:24:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357249"
}
```



---

archive/issue_events_357250.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-08-20T12:24:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357250"
}
```



---

archive/issue_events_357251.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-08-20T12:24:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357251"
}
```



---

archive/issue_events_357252.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-08-20T12:24:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "title_is": "Py3: Some fixes in knot.link.py",
    "title_was": "Py3: Some fix in knot.link.py",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357252"
}
```



---

archive/issue_comments_401830.json:
```json
{
    "body": "Branch: **[u/vklein/py3__some_fixes_in_knot_link_py](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/py3__some_fixes_in_knot_link_py)**",
    "created_at": "2018-08-20T12:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401830",
    "user": "https://github.com/vinklein"
}
```

Branch: **[u/vklein/py3__some_fixes_in_knot_link_py](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/py3__some_fixes_in_knot_link_py)**



---

archive/issue_comments_401831.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a7aed4361ee41cc8df0fbf4242ffd42dcf3bd8b\"><code>5a7aed4</code></a></td><td><code>Trac #26097: Some fixes in ``link.py`` for py3 :</code></td></tr></table>\n",
    "created_at": "2018-08-20T12:44:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401831",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a7aed4361ee41cc8df0fbf4242ffd42dcf3bd8b"><code>5a7aed4</code></a></td><td><code>Trac #26097: Some fixes in ``link.py`` for py3 :</code></td></tr></table>




---

archive/issue_comments_401832.json:
```json
{
    "body": "Commit: **[`5a7aed4`](https://github.com/sagemath/sagetrac-mirror/commit/5a7aed4361ee41cc8df0fbf4242ffd42dcf3bd8b)**",
    "created_at": "2018-08-20T12:44:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401832",
    "user": "https://github.com/vinklein"
}
```

Commit: **[`5a7aed4`](https://github.com/sagemath/sagetrac-mirror/commit/5a7aed4361ee41cc8df0fbf4242ffd42dcf3bd8b)**



---

archive/issue_comments_401833.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,13 @@\n+- regions(): use of a sorted list instead of a set for available_segments to have the same result in py2 and py3.\n \n+- _directions_of_edges(): Modify doctest to display results in the same order in py2 and py3.\n+\n+Note to reviewer : As i am not an expert in knots theory please ensure that the new results of `region()` are correct.\n+\n+Also note that\n+\n+```\n+                    if a in available_segments:\n+                        available_segments.remove(a)\n+```\n+might be slower than before. Tell me if the performance impact is negligible or if i should use another algorithm.\n``````\n",
    "created_at": "2018-08-20T12:44:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401833",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,13 @@
+- regions(): use of a sorted list instead of a set for available_segments to have the same result in py2 and py3.
 
+- _directions_of_edges(): Modify doctest to display results in the same order in py2 and py3.
+
+Note to reviewer : As i am not an expert in knots theory please ensure that the new results of `region()` are correct.
+
+Also note that
+
+```
+                    if a in available_segments:
+                        available_segments.remove(a)
+```
+might be slower than before. Tell me if the performance impact is negligible or if i should use another algorithm.
``````




---

archive/issue_comments_401834.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d1ec036be5eed09981bfb30ff0da56c6f4b237e\"><code>2d1ec03</code></a></td><td><code>Trac #26097: Fix some doctests in ``knot.py``</code></td></tr></table>\n",
    "created_at": "2018-08-20T12:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401834",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d1ec036be5eed09981bfb30ff0da56c6f4b237e"><code>2d1ec03</code></a></td><td><code>Trac #26097: Fix some doctests in ``knot.py``</code></td></tr></table>




---

archive/issue_comments_401835.json:
```json
{
    "body": "Changed commit from **[`5a7aed4`](https://github.com/sagemath/sagetrac-mirror/commit/5a7aed4361ee41cc8df0fbf4242ffd42dcf3bd8b)** to **[`2d1ec03`](https://github.com/sagemath/sagetrac-mirror/commit/2d1ec036be5eed09981bfb30ff0da56c6f4b237e)**",
    "created_at": "2018-08-20T12:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401835",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5a7aed4`](https://github.com/sagemath/sagetrac-mirror/commit/5a7aed4361ee41cc8df0fbf4242ffd42dcf3bd8b)** to **[`2d1ec03`](https://github.com/sagemath/sagetrac-mirror/commit/2d1ec036be5eed09981bfb30ff0da56c6f4b237e)**



---

archive/issue_comments_401836.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n+In `link.py`:\n - regions(): use of a sorted list instead of a set for available_segments to have the same result in py2 and py3.\n \n - _directions_of_edges(): Modify doctest to display results in the same order in py2 and py3.\n``````\n",
    "created_at": "2018-08-20T12:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401836",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
+In `link.py`:
 - regions(): use of a sorted list instead of a set for available_segments to have the same result in py2 and py3.
 
 - _directions_of_edges(): Modify doctest to display results in the same order in py2 and py3.
``````




---

archive/issue_events_357253.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-08-20T13:16:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357253"
}
```



---

archive/issue_comments_401837.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nbeware of #25768, closed but not yet in the latest beta..",
    "created_at": "2018-08-20T15:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401837",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

beware of #25768, closed but not yet in the latest beta..



---

archive/issue_comments_401838.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@fchapoton](#comment%3A7):\n> beware of #25768, closed but not yet in the latest beta..\n\nNice ! I was currently on the `connected_components()` problem ( and have not think of just avoiding the `sort()`).\n\nThat being said it look like these two tickets can be automatically merged.",
    "created_at": "2018-08-20T16:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401838",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@fchapoton](#comment%3A7):
> beware of #25768, closed but not yet in the latest beta..

Nice ! I was currently on the `connected_components()` problem ( and have not think of just avoiding the `sort()`).

That being said it look like these two tickets can be automatically merged.



---

archive/issue_comments_401839.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI think that the problem with doctests having a dictionary as result should rather be fixed globally in the doctest framework. \n\nMaybe Erik has ideas about that ? or already a fix in general ??",
    "created_at": "2018-08-26T16:55:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401839",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

I think that the problem with doctests having a dictionary as result should rather be fixed globally in the doctest framework. 

Maybe Erik has ideas about that ? or already a fix in general ??



---

archive/issue_comments_401840.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI get the idea but i see one drawback: If the doctest framework manage to set a standard output order it might be confusing for the user because he might obtain another result order when copy/pasting the doctest in the sage interpreter.",
    "created_at": "2018-08-27T12:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401840",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:10" align="right">comment:10</div>

I get the idea but i see one drawback: If the doctest framework manage to set a standard output order it might be confusing for the user because he might obtain another result order when copy/pasting the doctest in the sage interpreter.



---

archive/issue_comments_401841.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@fchapoton](#comment%3A9):\n> I think that the problem with doctests having a dictionary as result should rather be fixed globally in the doctest framework. \n> \n> Maybe Erik has ideas about that ? or already a fix in general ??\n\nIIRC just a plain dict is generally not a problem because its repr is already pprinted in ipython.  It's only a problem if the keys are heterogeneous.",
    "created_at": "2018-08-28T15:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401841",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@fchapoton](#comment%3A9):
> I think that the problem with doctests having a dictionary as result should rather be fixed globally in the doctest framework. 
> 
> Maybe Erik has ideas about that ? or already a fix in general ??

IIRC just a plain dict is generally not a problem because its repr is already pprinted in ipython.  It's only a problem if the keys are heterogeneous.



---

archive/issue_comments_401842.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nFWIW on my python 3 branch I get:\n\n```\n$ ./sage -t src/sage/knots/\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2018-08-28-15-07-02-267ca96a.\nGit branch: python3\nUsing --optional=meataxe,mpir,python2,sage\nDoctesting 4 files.\nsage -t src/sage/knots/knot.py\n    [42 tests, 8.48 s]\nsage -t src/sage/knots/__init__.py\n    [0 tests, 0.00 s]\nsage -t src/sage/knots/all.py\n    [0 tests, 0.00 s]\nsage -t src/sage/knots/link.py\n**********************************************************************\nFile \"src/sage/knots/link.py\", line 1995, in sage.knots.link.Link.regions\nFailed example:\n    L.regions()\nExpected:\n    [[1, 7, -4], [2, -5, -7], [3, -8, 5], [4, 8], [6, -1, -3], [-2, -6]]\nGot:\n    [[1, 7, -4], [2, -5, -7], [3, -8, 5], [4, 8], [6, -1, -3], [-6, -2]]\n**********************************************************************\nFile \"src/sage/knots/link.py\", line 2002, in sage.knots.link.Link.regions\nFailed example:\n    L.regions()\nExpected:\n    [[1, 3, 5], [2, -1], [4, -3], [6, -5], [-2, -6, -4]]\nGot:\n    [[1, 3, 5], [2, -1], [4, -3], [6, -5], [-6, -4, -2]]\n**********************************************************************\nFile \"src/sage/knots/link.py\", line 2005, in sage.knots.link.Link.regions\nFailed example:\n    L.regions()\nExpected:\n    [[1, -5], [2, -8, 4, 5], [3, 8], [6, -9, -2], [7, -3, 9], [10, -4, -7], [-10, -6, -1]]\nGot:\n    [[1, -5],\n     [2, -8, 4, 5],\n     [3, 8],\n     [6, -9, -2],\n     [7, -3, 9],\n     [10, -4, -7],\n     [-1, -10, -6]]\n**********************************************************************\nFile \"src/sage/knots/link.py\", line 2008, in sage.knots.link.Link.regions\nFailed example:\n    L.regions()\nExpected:\n    [[-3], [-4], [-6], [-8], [1, 2, 5, 7], [-2, 3, -1, 8, -7, 6, -5, 4]]\nGot:\n    [[-3], [-4], [-6], [-8], [1, 2, 5, 7], [-1, 8, -7, 6, -5, 4, -2, 3]]\n**********************************************************************\n1 item had failures:\n   4 of  17 in sage.knots.link.Link.regions\n    [413 tests, 4 failures, 8.36 s]\n----------------------------------------------------------------------\nsage -t src/sage/knots/link.py  # 4 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 17.1 seconds\n    cpu time: 9.1 seconds\n    cumulative wall time: 16.8 seconds\n```\n\nSo I think some of these other tests are fixed elsewhere.",
    "created_at": "2018-08-28T15:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401842",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

FWIW on my python 3 branch I get:

```
$ ./sage -t src/sage/knots/
too many failed tests, not using stored timings
Running doctests with ID 2018-08-28-15-07-02-267ca96a.
Git branch: python3
Using --optional=meataxe,mpir,python2,sage
Doctesting 4 files.
sage -t src/sage/knots/knot.py
    [42 tests, 8.48 s]
sage -t src/sage/knots/__init__.py
    [0 tests, 0.00 s]
sage -t src/sage/knots/all.py
    [0 tests, 0.00 s]
sage -t src/sage/knots/link.py
**********************************************************************
File "src/sage/knots/link.py", line 1995, in sage.knots.link.Link.regions
Failed example:
    L.regions()
Expected:
    [[1, 7, -4], [2, -5, -7], [3, -8, 5], [4, 8], [6, -1, -3], [-2, -6]]
Got:
    [[1, 7, -4], [2, -5, -7], [3, -8, 5], [4, 8], [6, -1, -3], [-6, -2]]
**********************************************************************
File "src/sage/knots/link.py", line 2002, in sage.knots.link.Link.regions
Failed example:
    L.regions()
Expected:
    [[1, 3, 5], [2, -1], [4, -3], [6, -5], [-2, -6, -4]]
Got:
    [[1, 3, 5], [2, -1], [4, -3], [6, -5], [-6, -4, -2]]
**********************************************************************
File "src/sage/knots/link.py", line 2005, in sage.knots.link.Link.regions
Failed example:
    L.regions()
Expected:
    [[1, -5], [2, -8, 4, 5], [3, 8], [6, -9, -2], [7, -3, 9], [10, -4, -7], [-10, -6, -1]]
Got:
    [[1, -5],
     [2, -8, 4, 5],
     [3, 8],
     [6, -9, -2],
     [7, -3, 9],
     [10, -4, -7],
     [-1, -10, -6]]
**********************************************************************
File "src/sage/knots/link.py", line 2008, in sage.knots.link.Link.regions
Failed example:
    L.regions()
Expected:
    [[-3], [-4], [-6], [-8], [1, 2, 5, 7], [-2, 3, -1, 8, -7, 6, -5, 4]]
Got:
    [[-3], [-4], [-6], [-8], [1, 2, 5, 7], [-1, 8, -7, 6, -5, 4, -2, 3]]
**********************************************************************
1 item had failures:
   4 of  17 in sage.knots.link.Link.regions
    [413 tests, 4 failures, 8.36 s]
----------------------------------------------------------------------
sage -t src/sage/knots/link.py  # 4 doctests failed
----------------------------------------------------------------------
Total time for all tests: 17.1 seconds
    cpu time: 9.1 seconds
    cumulative wall time: 16.8 seconds
```

So I think some of these other tests are fixed elsewhere.



---

archive/issue_comments_401843.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@embray](#comment%3A12):\n> FWIW on my python 3 branch I get:\n> \n> So I think some of these other tests are fixed elsewhere.\n\nIt might be something on your branch because i still get `_directions_of_edges` doctests error with sage version 8.4.beta2.\n\n\n```\n$ sage -t --long src/sage/knots/link.py\n...\n2 items had failures:\n   3 of   7 in sage.knots.link.Link._directions_of_edges\n   4 of  17 in sage.knots.link.Link.regions\n    [414 tests, 7 failures, 5.01 s]\n\n```",
    "created_at": "2018-08-29T07:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401843",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@embray](#comment%3A12):
> FWIW on my python 3 branch I get:
> 
> So I think some of these other tests are fixed elsewhere.

It might be something on your branch because i still get `_directions_of_edges` doctests error with sage version 8.4.beta2.


```
$ sage -t --long src/sage/knots/link.py
...
2 items had failures:
   3 of   7 in sage.knots.link.Link._directions_of_edges
   4 of  17 in sage.knots.link.Link.regions
    [414 tests, 7 failures, 5.01 s]

```



---

archive/issue_comments_401844.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nTrue, that one might be just luck, because I'm not sure why it would appear \"fixed\" otherwise.  However, normally a plain dict as output should not be a problem--in this case it might fail only because it's a tuple of dicts.  I *think* it would work if the tests were changed to something (which I find more instructive anyways) like:\n\n```\nsage: tails, heads = L._directions_of_edges()\nsage: tails\n...\nsage: heads\n...\n```\n\nin other words, printing each dict individually should work.",
    "created_at": "2018-08-29T09:57:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401844",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

True, that one might be just luck, because I'm not sure why it would appear "fixed" otherwise.  However, normally a plain dict as output should not be a problem--in this case it might fail only because it's a tuple of dicts.  I *think* it would work if the tests were changed to something (which I find more instructive anyways) like:

```
sage: tails, heads = L._directions_of_edges()
sage: tails
...
sage: heads
...
```

in other words, printing each dict individually should work.



---

archive/issue_comments_401845.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@embray](#comment%3A14):\n> in other words, printing each dict individually should work.\n\nSadly, if i am not missing something, it doesn't : \n\nPy2\n\n```\nsage: L = Link([[1, 3, 2, 4], [2, 3, 1, 4]])\nsage: tails, heads = L._directions_of_edges()\nsage: tails\n{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}\nsage: heads\n{1: [1, 3, 2, 4], 2: [2, 3, 1, 4], 3: [2, 3, 1, 4], 4: [1, 3, 2, 4]}\n```\n\nPy3\n\n```\n...\nsage: tails\n{2: [1, 3, 2, 4], 1: [2, 3, 1, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}\nsage: heads\n{2: [2, 3, 1, 4], 1: [1, 3, 2, 4], 3: [2, 3, 1, 4], 4: [1, 3, 2, 4]}\n```\n\nAnyway i think your idea of printing each dict separately is better than having a `for` loop.",
    "created_at": "2018-08-29T12:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401845",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@embray](#comment%3A14):
> in other words, printing each dict individually should work.

Sadly, if i am not missing something, it doesn't : 

Py2

```
sage: L = Link([[1, 3, 2, 4], [2, 3, 1, 4]])
sage: tails, heads = L._directions_of_edges()
sage: tails
{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}
sage: heads
{1: [1, 3, 2, 4], 2: [2, 3, 1, 4], 3: [2, 3, 1, 4], 4: [1, 3, 2, 4]}
```

Py3

```
...
sage: tails
{2: [1, 3, 2, 4], 1: [2, 3, 1, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}
sage: heads
{2: [2, 3, 1, 4], 1: [1, 3, 2, 4], 3: [2, 3, 1, 4], 4: [1, 3, 2, 4]}
```

Anyway i think your idea of printing each dict separately is better than having a `for` loop.



---

archive/issue_comments_401846.json:
```json
{
    "body": "Changed commit from **[`2d1ec03`](https://github.com/sagemath/sagetrac-mirror/commit/2d1ec036be5eed09981bfb30ff0da56c6f4b237e)** to **[`33c95fb`](https://github.com/sagemath/sagetrac-mirror/commit/33c95fbf5ea95077e8d7f1d7f300556c7df034ba)**",
    "created_at": "2018-08-29T12:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401846",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2d1ec03`](https://github.com/sagemath/sagetrac-mirror/commit/2d1ec036be5eed09981bfb30ff0da56c6f4b237e)** to **[`33c95fb`](https://github.com/sagemath/sagetrac-mirror/commit/33c95fbf5ea95077e8d7f1d7f300556c7df034ba)**



---

archive/issue_comments_401847.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb171af717ca8e84e3061d18ed4a2c15ed3de477\"><code>fb171af</code></a></td><td><code>Trac #26097: Some fixes in ``link.py`` for py3 :</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33c95fbf5ea95077e8d7f1d7f300556c7df034ba\"><code>33c95fb</code></a></td><td><code>Trac #26097: Fix some doctests in ``knot.py``</code></td></tr></table>\n",
    "created_at": "2018-08-29T12:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401847",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb171af717ca8e84e3061d18ed4a2c15ed3de477"><code>fb171af</code></a></td><td><code>Trac #26097: Some fixes in ``link.py`` for py3 :</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33c95fbf5ea95077e8d7f1d7f300556c7df034ba"><code>33c95fb</code></a></td><td><code>Trac #26097: Fix some doctests in ``knot.py``</code></td></tr></table>




---

archive/issue_comments_401848.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nRebased on 8.4.beta2",
    "created_at": "2018-08-29T12:57:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401848",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:17" align="right">comment:17</div>

Rebased on 8.4.beta2



---

archive/issue_comments_401849.json:
```json
{
    "body": "Changed commit from **[`33c95fb`](https://github.com/sagemath/sagetrac-mirror/commit/33c95fbf5ea95077e8d7f1d7f300556c7df034ba)** to **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)**",
    "created_at": "2018-08-29T12:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401849",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`33c95fb`](https://github.com/sagemath/sagetrac-mirror/commit/33c95fbf5ea95077e8d7f1d7f300556c7df034ba)** to **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)**



---

archive/issue_comments_401850.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5\"><code>b3f8dd2</code></a></td><td><code>Trac #26097: _directions_of_edges() doctests ...</code></td></tr></table>\n",
    "created_at": "2018-08-29T12:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401850",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5"><code>b3f8dd2</code></a></td><td><code>Trac #26097: _directions_of_edges() doctests ...</code></td></tr></table>




---

archive/issue_comments_401851.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n`b3f8dd2` doctest each dict separately with a `pprint` call\n\n@embray Do you know a way to force sage to use pprint for dict `__repr__` ?\n\n> just a plain dict is generally not a problem because its repr is already pprinted in ipython\n\nMaybe it's ipython version dependent. I will check that.",
    "created_at": "2018-08-29T13:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401851",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:19" align="right">comment:19</div>

`b3f8dd2` doctest each dict separately with a `pprint` call

@embray Do you know a way to force sage to use pprint for dict `__repr__` ?

> just a plain dict is generally not a problem because its repr is already pprinted in ipython

Maybe it's ipython version dependent. I will check that.



---

archive/issue_comments_401852.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@vinklein](#comment%3A19):\n> > just a plain dict is generally not a problem because its repr is already pprinted in ipython\n\n> \n> Maybe it's ipython version dependent. I will check that.\n\nI don't think that's it.  I think it may just be that the doctests don't pass through the IPython output formatting.  Perhaps they should.",
    "created_at": "2018-08-29T13:13:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401852",
    "user": "https://github.com/embray"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@vinklein](#comment%3A19):
> > just a plain dict is generally not a problem because its repr is already pprinted in ipython

> 
> Maybe it's ipython version dependent. I will check that.

I don't think that's it.  I think it may just be that the doctests don't pass through the IPython output formatting.  Perhaps they should.



---

archive/issue_comments_401853.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nYes.\n\nOr the problem can be that ipython's lib.pretty is not consistent between py2 and py3 :\n\nIn py3\n\n```\nsage: from IPython.lib.pretty import pprint\nsage: pprint(tails)\n{2: [1, 3, 2, 4], 1: [2, 3, 1, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}\nsage: from pprint import pprint\nsage: pprint(tails)\n{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}\n```\n\nIn Py2\n\n```\nsage: from IPython.lib.pretty import pprint\nsage: pprint(tails)\n{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}\nsage: from pprint import pprint\nsage: pprint(tails)\n{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}\n\n```",
    "created_at": "2018-08-29T13:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401853",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:21" align="right">comment:21</div>

Yes.

Or the problem can be that ipython's lib.pretty is not consistent between py2 and py3 :

In py3

```
sage: from IPython.lib.pretty import pprint
sage: pprint(tails)
{2: [1, 3, 2, 4], 1: [2, 3, 1, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}
sage: from pprint import pprint
sage: pprint(tails)
{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}
```

In Py2

```
sage: from IPython.lib.pretty import pprint
sage: pprint(tails)
{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}
sage: from pprint import pprint
sage: pprint(tails)
{1: [2, 3, 1, 4], 2: [1, 3, 2, 4], 3: [1, 3, 2, 4], 4: [2, 3, 1, 4]}

```



---

archive/issue_events_357254.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-08-29T18:35:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357254"
}
```



---

archive/issue_events_357255.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-08-29T18:35:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357255"
}
```



---

archive/issue_comments_401854.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nok, let it be. Merci !",
    "created_at": "2018-08-29T18:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401854",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

ok, let it be. Merci !



---

archive/issue_comments_401855.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2018-08-29T18:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401855",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_401856.json:
```json
{
    "body": "Changed branch from **[u/vklein/py3__some_fixes_in_knot_link_py](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/py3__some_fixes_in_knot_link_py)** to **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)**",
    "created_at": "2018-08-30T22:24:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401856",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vklein/py3__some_fixes_in_knot_link_py](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/py3__some_fixes_in_knot_link_py)** to **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)**



---

archive/issue_events_357256.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-30T22:24:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357256"
}
```



---

archive/issue_events_357257.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "dea785eb5b92b2813bdbda2ff2cffc5ed160d696",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-08-30T22:24:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26097#event-357257"
}
```



---

archive/issue_comments_401857.json:
```json
{
    "body": "Changed commit from **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)** to none",
    "created_at": "2018-09-03T09:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401857",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`b3f8dd2`](https://github.com/sagemath/sagetrac-mirror/commit/b3f8dd255b2adccb8c9a2b2bb6f148c6920bade5)** to none



---

archive/issue_comments_401858.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI don't really like this as is, but okay.\n\nI didn't realize that IPython wasn't using the standard `pprint.pprint`.  If its `pprint` is broken on Python 3 we should fix that.",
    "created_at": "2018-09-03T09:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26097#issuecomment-401858",
    "user": "https://github.com/embray"
}
```

<div id="comment:24" align="right">comment:24</div>

I don't really like this as is, but okay.

I didn't realize that IPython wasn't using the standard `pprint.pprint`.  If its `pprint` is broken on Python 3 we should fix that.
