# Issue 26936: WordMorphism: domain/codomain should be sortable if not given

archive/issues_026699.json:
```json
{
    "body": "In `src/sage/combinat/words/morphism.py`, there is the following code:\n\n```\ndom_alph.sort()\n```\nand\n\n```\nreturn FiniteWords(sorted(codom_alphabet))\n```\n\nThese will break with #22029.\n\n**CC:**  @videlec\n\n**Branch/Commit:** [db81e7dd2f141be4eed6cfcb87fc718ccae9e68c](https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c)\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** S\u00e9bastien Labb\u00e9\n\nIssue created by migration from https://trac.sagemath.org/ticket/26936\n\n",
    "closed_at": "2019-01-23T14:17:41Z",
    "created_at": "2018-12-21T15:32:49Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "WordMorphism: domain/codomain should be sortable if not given",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26936",
    "user": "https://github.com/jdemeyer"
}
```
In `src/sage/combinat/words/morphism.py`, there is the following code:

```
dom_alph.sort()
```
and

```
return FiniteWords(sorted(codom_alphabet))
```

These will break with #22029.

**CC:**  @videlec

**Branch/Commit:** [db81e7dd2f141be4eed6cfcb87fc718ccae9e68c](https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c)

**Reviewer:** Jeroen Demeyer

**Author:** Sébastien Labbé

Issue created by migration from https://trac.sagemath.org/ticket/26936





---

archive/issue_comments_419464.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis one is not trivial. Simply replacing the `sorted()` by `list()` gives a lot of doctest failures.",
    "created_at": "2018-12-22T13:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419464",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
This one is not trivial. Simply replacing the `sorted()` by `list()` gives a lot of doctest failures.



---

archive/issue_events_241901.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-12-22T14:17:32Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "rename": {
        "from": "WordMorphism should support unsortable codomain",
        "to": "WordMorphism should not assume sorted domain/codomain"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241901"
}
```



---

archive/issue_comments_419465.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,12 @@\n-This breaks with #22029:\n+In `src/sage/combinat/words/morphism.py`, there is the following code:\n \n ```\n-        return FiniteWords(sorted(codom_alphabet))\n+dom_alph.sort()\n ```\n+and\n+\n+```\n+return FiniteWords(sorted(codom_alphabet))\n+```\n+\n+These will break with #22029.\n``````\n",
    "created_at": "2018-12-22T14:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419465",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,12 @@
-This breaks with #22029:
+In `src/sage/combinat/words/morphism.py`, there is the following code:
 
 ```
-        return FiniteWords(sorted(codom_alphabet))
+dom_alph.sort()
 ```
+and
+
+```
+return FiniteWords(sorted(codom_alphabet))
+```
+
+These will break with #22029.
``````




---

archive/issue_comments_419466.json:
```json
{
    "body": "<a id='comment:3'></a>\nDoes something like this work?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbe667041c1f05fad5d9080ef82290d79042bb0e\">dbe6670</a></td><td><code>26936: try sorting</code></td></tr></table>\n",
    "created_at": "2018-12-23T15:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419466",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:3'></a>
Does something like this work?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbe667041c1f05fad5d9080ef82290d79042bb0e">dbe6670</a></td><td><code>26936: try sorting</code></td></tr></table>




---

archive/issue_comments_419467.json:
```json
{
    "body": "**Branch:** [public/26936](https://github.com/sagemath/sagetrac-mirror/tree/public/26936)",
    "created_at": "2018-12-23T15:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419467",
    "user": "https://github.com/seblabbe"
}
```

**Branch:** [public/26936](https://github.com/sagemath/sagetrac-mirror/tree/public/26936)



---

archive/issue_comments_419468.json:
```json
{
    "body": "**Commit:** [dbe667041c1f05fad5d9080ef82290d79042bb0e](https://github.com/sagemath/sagetrac-mirror/commit/dbe667041c1f05fad5d9080ef82290d79042bb0e)",
    "created_at": "2018-12-23T15:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419468",
    "user": "https://github.com/seblabbe"
}
```

**Commit:** [dbe667041c1f05fad5d9080ef82290d79042bb0e](https://github.com/sagemath/sagetrac-mirror/commit/dbe667041c1f05fad5d9080ef82290d79042bb0e)



---

archive/issue_comments_419469.json:
```json
{
    "body": "**Changing commit** from \"[dbe667041c1f05fad5d9080ef82290d79042bb0e](https://github.com/sagemath/sagetrac-mirror/commit/dbe667041c1f05fad5d9080ef82290d79042bb0e)\" to \"[f146b5e33df130565f76c6cbf74c42ea78c12008](https://github.com/sagemath/sagetrac-mirror/commit/f146b5e33df130565f76c6cbf74c42ea78c12008)\".",
    "created_at": "2018-12-23T15:11:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dbe667041c1f05fad5d9080ef82290d79042bb0e](https://github.com/sagemath/sagetrac-mirror/commit/dbe667041c1f05fad5d9080ef82290d79042bb0e)" to "[f146b5e33df130565f76c6cbf74c42ea78c12008](https://github.com/sagemath/sagetrac-mirror/commit/f146b5e33df130565f76c6cbf74c42ea78c12008)".



---

archive/issue_comments_419470.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f146b5e33df130565f76c6cbf74c42ea78c12008\">f146b5e</a></td><td><code>26936: try sorting</code></td></tr></table>\n",
    "created_at": "2018-12-23T15:11:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f146b5e33df130565f76c6cbf74c42ea78c12008">f146b5e</a></td><td><code>26936: try sorting</code></td></tr></table>




---

archive/issue_comments_419471.json:
```json
{
    "body": "<a id='comment:5'></a>\nI put `except TypeError` clauses if I understand #22029 correctly.",
    "created_at": "2018-12-23T15:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419471",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'></a>
I put `except TypeError` clauses if I understand #22029 correctly.



---

archive/issue_events_241902.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-12-23T15:14:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241902"
}
```



---

archive/issue_comments_419472.json:
```json
{
    "body": "**Author:** S\u00e9bastien Labb\u00e9",
    "created_at": "2018-12-23T15:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419472",
    "user": "https://github.com/seblabbe"
}
```

**Author:** Sébastien Labbé



---

archive/issue_comments_419473.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe problem with this `try`/`except` approach is that some methods/algorithms actually assume sorting. For example, `is_endomorphism()` will return `False` if the domain and codomain are the same, but in a different order.",
    "created_at": "2018-12-24T11:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419473",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
The problem with this `try`/`except` approach is that some methods/algorithms actually assume sorting. For example, `is_endomorphism()` will return `False` if the domain and codomain are the same, but in a different order.



---

archive/issue_events_241903.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-12-24T11:04:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241903"
}
```



---

archive/issue_events_241904.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-12-24T11:04:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241904"
}
```



---

archive/issue_comments_419474.json:
```json
{
    "body": "<a id='comment:9'></a>\nFor `codom_alphabet`, you need to convert to a `list` in any case.",
    "created_at": "2018-12-24T11:04:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419474",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
For `codom_alphabet`, you need to convert to a `list` in any case.



---

archive/issue_comments_419475.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1\">cb4aa1f</a></td><td><code>26936: fixing reviewer's comment</code></td></tr></table>\n",
    "created_at": "2018-12-31T12:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419475",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1">cb4aa1f</a></td><td><code>26936: fixing reviewer's comment</code></td></tr></table>




---

archive/issue_comments_419476.json:
```json
{
    "body": "**Changing commit** from \"[f146b5e33df130565f76c6cbf74c42ea78c12008](https://github.com/sagemath/sagetrac-mirror/commit/f146b5e33df130565f76c6cbf74c42ea78c12008)\" to \"[cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1](https://github.com/sagemath/sagetrac-mirror/commit/cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1)\".",
    "created_at": "2018-12-31T12:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419476",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f146b5e33df130565f76c6cbf74c42ea78c12008](https://github.com/sagemath/sagetrac-mirror/commit/f146b5e33df130565f76c6cbf74c42ea78c12008)" to "[cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1](https://github.com/sagemath/sagetrac-mirror/commit/cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1)".



---

archive/issue_events_241905.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-12-31T12:20:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241905"
}
```



---

archive/issue_events_241906.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2018-12-31T12:20:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241906"
}
```



---

archive/issue_comments_419477.json:
```json
{
    "body": "<a id='comment:12'></a>\nAs explained in [comment:8], I still don't agree with this approach. It may be sufficient to fix existing doctests, but it doesn't address the real problem. This ticket simply replaces an obvious problem by a much more hidden problem.",
    "created_at": "2018-12-31T12:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419477",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
As explained in [comment:8], I still don't agree with this approach. It may be sufficient to fix existing doctests, but it doesn't address the real problem. This ticket simply replaces an obvious problem by a much more hidden problem.



---

archive/issue_comments_419478.json:
```json
{
    "body": "<a id='comment:13'></a>\nIf such a problem happen, that is an alphabet with uncomparable elements, the user can define the domain and cododmain himself by doing for instance `WordMorphism(data, domain=domain, codomain=domain)`. Would you like to add such a suggestion to the user for example within the error message for `is_endomorphism`?\n\nAlso, I think the best thing we should do with the move to Python 3 is to make it so that using alphabet with uncomparable letters is not desirable anymore.",
    "created_at": "2018-12-31T14:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419478",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:13'></a>
If such a problem happen, that is an alphabet with uncomparable elements, the user can define the domain and cododmain himself by doing for instance `WordMorphism(data, domain=domain, codomain=domain)`. Would you like to add such a suggestion to the user for example within the error message for `is_endomorphism`?

Also, I think the best thing we should do with the move to Python 3 is to make it so that using alphabet with uncomparable letters is not desirable anymore.



---

archive/issue_comments_419479.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [slabbe](#comment%3A13):\n> Also, I think the best thing we should do with the move to Python 3 is to make it so that using alphabet with uncomparable letters is not desirable anymore.\n\n\nI don't really understand what you mean here.",
    "created_at": "2019-01-01T09:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419479",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [slabbe](#comment%3A13):
> Also, I think the best thing we should do with the move to Python 3 is to make it so that using alphabet with uncomparable letters is not desirable anymore.


I don't really understand what you mean here.



---

archive/issue_comments_419480.json:
```json
{
    "body": "<a id='comment:15'></a>\nMaybe the simplest solution for now would be to simply document that the alphabet must be sortable, and change the doctests with a non-sortable alphabet. Do you agree?",
    "created_at": "2019-01-02T16:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419480",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Maybe the simplest solution for now would be to simply document that the alphabet must be sortable, and change the doctests with a non-sortable alphabet. Do you agree?



---

archive/issue_comments_419481.json:
```json
{
    "body": "<a id='comment:16'></a>\nFor reference, the failing doctests are\n\n```\nsage -t --long src/sage/combinat/words/morphism.py\n**********************************************************************\nFile \"src/sage/combinat/words/morphism.py\", line 340, in sage.combinat.words.morphism.WordMorphism.__init__\nFailed example:\n    WordMorphism({'a':['a',6,'a'],6:[6,6,6,'a']})\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.words.morphism.WordMorphism.__init__[13]>\", line 1, in <module>\n        WordMorphism({'a':['a',Integer(6),'a'],Integer(6):[Integer(6),Integer(6),Integer(6),'a']})\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/combinat/words/morphism.py\", line 380, in __init__\n        codomain = self._build_codomain(data)\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/combinat/words/morphism.py\", line 478, in _build_codomain\n        return FiniteWords(sorted(codom_alphabet))\n      File \"sage/rings/integer.pyx\", line 952, in sage.rings.integer.Integer.__richcmp__ (build/cythonized/sage/rings/integer.c:7789)\n        return coercion_model.richcmp(left, right, op)\n      File \"sage/structure/coerce.pyx\", line 1967, in sage.structure.coerce.CoercionModel_cache_maps.richcmp (build/cythonized/sage/structure/coerce.c:19675)\n        raise bin_op_exception('<', x, y)\n    TypeError: unsupported operand parent(s) for <: 'Integer Ring' and '<type 'str'>'\n**********************************************************************\nFile \"src/sage/combinat/words/morphism.py\", line 1266, in sage.combinat.words.morphism.WordMorphism.image\nFailed example:\n    s = WordMorphism({0:[1,2], 'a':(2,3,4), 'z':[9,8,7]})\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.words.morphism.WordMorphism.image[4]>\", line 1, in <module>\n        s = WordMorphism({Integer(0):[Integer(1),Integer(2)], 'a':(Integer(2),Integer(3),Integer(4)), 'z':[Integer(9),Integer(8),Integer(7)]})\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/combinat/words/morphism.py\", line 404, in __init__\n        dom_alph.sort()\n      File \"sage/rings/integer.pyx\", line 952, in sage.rings.integer.Integer.__richcmp__ (build/cythonized/sage/rings/integer.c:7789)\n        return coercion_model.richcmp(left, right, op)\n      File \"sage/structure/coerce.pyx\", line 1971, in sage.structure.coerce.CoercionModel_cache_maps.richcmp (build/cythonized/sage/structure/coerce.c:19739)\n        raise bin_op_exception('>', x, y)\n    TypeError: unsupported operand parent(s) for >: 'Integer Ring' and '<type 'str'>'\n**********************************************************************\n```",
    "created_at": "2019-01-02T17:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419481",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
For reference, the failing doctests are

```
sage -t --long src/sage/combinat/words/morphism.py
**********************************************************************
File "src/sage/combinat/words/morphism.py", line 340, in sage.combinat.words.morphism.WordMorphism.__init__
Failed example:
    WordMorphism({'a':['a',6,'a'],6:[6,6,6,'a']})
Exception raised:
    Traceback (most recent call last):
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.words.morphism.WordMorphism.__init__[13]>", line 1, in <module>
        WordMorphism({'a':['a',Integer(6),'a'],Integer(6):[Integer(6),Integer(6),Integer(6),'a']})
      File "/opt/sage/local/lib/python2.7/site-packages/sage/combinat/words/morphism.py", line 380, in __init__
        codomain = self._build_codomain(data)
      File "/opt/sage/local/lib/python2.7/site-packages/sage/combinat/words/morphism.py", line 478, in _build_codomain
        return FiniteWords(sorted(codom_alphabet))
      File "sage/rings/integer.pyx", line 952, in sage.rings.integer.Integer.__richcmp__ (build/cythonized/sage/rings/integer.c:7789)
        return coercion_model.richcmp(left, right, op)
      File "sage/structure/coerce.pyx", line 1967, in sage.structure.coerce.CoercionModel_cache_maps.richcmp (build/cythonized/sage/structure/coerce.c:19675)
        raise bin_op_exception('<', x, y)
    TypeError: unsupported operand parent(s) for <: 'Integer Ring' and '<type 'str'>'
**********************************************************************
File "src/sage/combinat/words/morphism.py", line 1266, in sage.combinat.words.morphism.WordMorphism.image
Failed example:
    s = WordMorphism({0:[1,2], 'a':(2,3,4), 'z':[9,8,7]})
Exception raised:
    Traceback (most recent call last):
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.words.morphism.WordMorphism.image[4]>", line 1, in <module>
        s = WordMorphism({Integer(0):[Integer(1),Integer(2)], 'a':(Integer(2),Integer(3),Integer(4)), 'z':[Integer(9),Integer(8),Integer(7)]})
      File "/opt/sage/local/lib/python2.7/site-packages/sage/combinat/words/morphism.py", line 404, in __init__
        dom_alph.sort()
      File "sage/rings/integer.pyx", line 952, in sage.rings.integer.Integer.__richcmp__ (build/cythonized/sage/rings/integer.c:7789)
        return coercion_model.richcmp(left, right, op)
      File "sage/structure/coerce.pyx", line 1971, in sage.structure.coerce.CoercionModel_cache_maps.richcmp (build/cythonized/sage/structure/coerce.c:19739)
        raise bin_op_exception('>', x, y)
    TypeError: unsupported operand parent(s) for >: 'Integer Ring' and '<type 'str'>'
**********************************************************************
```



---

archive/issue_events_241907.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-02T20:44:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241907"
}
```



---

archive/issue_events_241908.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-02T20:44:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241908"
}
```



---

archive/issue_comments_419482.json:
```json
{
    "body": "**Changing commit** from \"[cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1](https://github.com/sagemath/sagetrac-mirror/commit/cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1)\" to \"[0cc0a618c71e99a912063097aef96135b67ea37e](https://github.com/sagemath/sagetrac-mirror/commit/0cc0a618c71e99a912063097aef96135b67ea37e)\".",
    "created_at": "2019-01-02T22:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419482",
    "user": "https://github.com/seblabbe"
}
```

**Changing commit** from "[cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1](https://github.com/sagemath/sagetrac-mirror/commit/cb4aa1fd1d476ab4766cbdd1349f23fb971b64d1)" to "[0cc0a618c71e99a912063097aef96135b67ea37e](https://github.com/sagemath/sagetrac-mirror/commit/0cc0a618c71e99a912063097aef96135b67ea37e)".



---

archive/issue_comments_419483.json:
```json
{
    "body": "**Changing branch** from \"[public/26936](https://github.com/sagemath/sagetrac-mirror/tree/public/26936)\" to \"[u/slabbe/26936](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/26936)\".",
    "created_at": "2019-01-02T22:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419483",
    "user": "https://github.com/seblabbe"
}
```

**Changing branch** from "[public/26936](https://github.com/sagemath/sagetrac-mirror/tree/public/26936)" to "[u/slabbe/26936](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/26936)".



---

archive/issue_comments_419484.json:
```json
{
    "body": "<a id='comment:18'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea22e208a07e8349e1885e5f600f125bc9a11743\">ea22e20</a></td><td><code>26936: fixing doctests with sortable alphabets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0cc0a618c71e99a912063097aef96135b67ea37e\">0cc0a61</a></td><td><code>26936: improved class documentation</code></td></tr></table>\n",
    "created_at": "2019-01-02T22:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419484",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:18'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea22e208a07e8349e1885e5f600f125bc9a11743">ea22e20</a></td><td><code>26936: fixing doctests with sortable alphabets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0cc0a618c71e99a912063097aef96135b67ea37e">0cc0a61</a></td><td><code>26936: improved class documentation</code></td></tr></table>




---

archive/issue_events_241909.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2019-01-02T22:34:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241909"
}
```



---

archive/issue_events_241910.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2019-01-02T22:34:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241910"
}
```



---

archive/issue_comments_419485.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [jdemeyer](#comment%3A15):\n> Maybe the simplest solution for now would be to simply document that the alphabet must be sortable, and change the doctests with a non-sortable alphabet. Do you agree?\n\n\nDo you mean \"with a *sortable* alphabet\" ?\n\nI updated a branch which fixes the 2 doctests. I also updated the class documentation: INPUT block was missing, the example block of the class doc was the same as the module doc, I erased it and replaced that by examples better suited for what is seen with `WordMorphism?` showing the different way of using the inputs. I also added a note block about the sortable expectation when the domain and codomain are not explicitely given.\n\nNeeds review.",
    "created_at": "2019-01-02T22:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419485",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:19'></a>
Replying to [jdemeyer](#comment%3A15):
> Maybe the simplest solution for now would be to simply document that the alphabet must be sortable, and change the doctests with a non-sortable alphabet. Do you agree?


Do you mean "with a *sortable* alphabet" ?

I updated a branch which fixes the 2 doctests. I also updated the class documentation: INPUT block was missing, the example block of the class doc was the same as the module doc, I erased it and replaced that by examples better suited for what is seen with `WordMorphism?` showing the different way of using the inputs. I also added a note block about the sortable expectation when the domain and codomain are not explicitely given.

Needs review.



---

archive/issue_comments_419486.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [slabbe](#comment%3A19):\n> Replying to [jdemeyer](#comment%3A15):\n> > Maybe the simplest solution for now would be to simply document that the alphabet must be sortable, and change the doctests with a non-sortable alphabet. Do you agree?\n\n> \n> Do you mean \"with a *sortable* alphabet\" ?\n\n\nIf `X` is any permutation of the alphabet, then `sorted(X)` always succeeds (not raising an exception) and always returns the same thing (independent of the chosen permutation)",
    "created_at": "2019-01-03T07:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419486",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Replying to [slabbe](#comment%3A19):
> Replying to [jdemeyer](#comment%3A15):
> > Maybe the simplest solution for now would be to simply document that the alphabet must be sortable, and change the doctests with a non-sortable alphabet. Do you agree?

> 
> Do you mean "with a *sortable* alphabet" ?


If `X` is any permutation of the alphabet, then `sorted(X)` always succeeds (not raising an exception) and always returns the same thing (independent of the chosen permutation)



---

archive/issue_comments_419487.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c\">db81e7d</a></td><td><code>26936: add example with non sortable alphabet</code></td></tr></table>\n",
    "created_at": "2019-01-03T09:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c">db81e7d</a></td><td><code>26936: add example with non sortable alphabet</code></td></tr></table>




---

archive/issue_comments_419488.json:
```json
{
    "body": "**Changing commit** from \"[0cc0a618c71e99a912063097aef96135b67ea37e](https://github.com/sagemath/sagetrac-mirror/commit/0cc0a618c71e99a912063097aef96135b67ea37e)\" to \"[db81e7dd2f141be4eed6cfcb87fc718ccae9e68c](https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c)\".",
    "created_at": "2019-01-03T09:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419488",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0cc0a618c71e99a912063097aef96135b67ea37e](https://github.com/sagemath/sagetrac-mirror/commit/0cc0a618c71e99a912063097aef96135b67ea37e)" to "[db81e7dd2f141be4eed6cfcb87fc718ccae9e68c](https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c)".



---

archive/issue_comments_419489.json:
```json
{
    "body": "<a id='comment:22'></a>\nI readded an example with a non-sortable alphabet showing how to deal with it by giving explicitely the domain and codomain.\n\nI did not check yet if it is okay with #22029.",
    "created_at": "2019-01-03T09:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419489",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:22'></a>
I readded an example with a non-sortable alphabet showing how to deal with it by giving explicitely the domain and codomain.

I did not check yet if it is okay with #22029.



---

archive/issue_comments_419490.json:
```json
{
    "body": "<a id='comment:23'></a>\n> I did not check yet if it is okay with #22029.\n\n\nIt is okay, I just checked.\n\nNeeds review.",
    "created_at": "2019-01-03T10:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419490",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:23'></a>
> I did not check yet if it is okay with #22029.


It is okay, I just checked.

Needs review.



---

archive/issue_comments_419491.json:
```json
{
    "body": "<a id='comment:24'></a>\nI'll merge this into the testing branch #22029 and see what the patchbot gives. Hang on...",
    "created_at": "2019-01-04T09:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419491",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
I'll merge this into the testing branch #22029 and see what the patchbot gives. Hang on...



---

archive/issue_events_241911.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-04T10:42:43Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "rename": {
        "from": "WordMorphism should not assume sorted domain/codomain",
        "to": "WordMorphism: domain/codomain should be sortable if not given"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241911"
}
```



---

archive/issue_comments_419492.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2019-01-04T10:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419492",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_events_241912.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-04T18:30:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241912"
}
```



---

archive/issue_events_241913.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-01-04T18:30:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241913"
}
```



---

archive/issue_events_241914.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "milestone": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241914"
}
```



---

archive/issue_events_241915.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241915"
}
```



---

archive/issue_comments_419493.json:
```json
{
    "body": "<a id='comment:28'></a>\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419493",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>
Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_241916.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-23T14:17:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241916"
}
```



---

archive/issue_events_241917.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-23T14:17:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26936#event-241917"
}
```



---

archive/issue_comments_419494.json:
```json
{
    "body": "**Changing branch** from \"[u/slabbe/26936](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/26936)\" to \"[db81e7dd2f141be4eed6cfcb87fc718ccae9e68c](https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c)\".",
    "created_at": "2019-01-23T14:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26936#issuecomment-419494",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/slabbe/26936](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/26936)" to "[db81e7dd2f141be4eed6cfcb87fc718ccae9e68c](https://github.com/sagemath/sagetrac-mirror/commit/db81e7dd2f141be4eed6cfcb87fc718ccae9e68c)".
