# Issue 26344: Nilpotent Lie groups

archive/issues_026107.json:
```json
{
    "body": "Implementation of nilpotent Lie groups as manifolds with a distinguished global coordinate system (exponential coordinates).\n\nPlanned features:\n\n* representation of elements in exponential coordinates of the first or second kind\n* multiplication of symbolic points (using the manifold point framework)\n* the frames of left-invariant and right-invariant vector fields\n* the exponential map `exp:\\mathfrak{g}\\to G` and the logarithm\n* the adjoint map `Ad:G\\times \\mathfrak{g}\\to\\mathfrak{g}`\n\nCC:  @tscrim @egourgoulhon\n\nKeywords: Lie groups, Lie algebras, manifolds, nilpotent\n\nReviewer: Eric Gourgoulhon, Travis Scrimshaw\n\nAuthor: Eero Hakavuori\n\nBranch: b2ef2d9896ca92c139c12781b7d92d2b56397bec\n\nDependencies: #26080\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26344\n\n",
    "closed_at": "2018-10-05T16:56:55Z",
    "created_at": "2018-09-25T06:28:14Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "Nilpotent Lie groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26344",
    "user": "https://github.com/ehaka"
}
```
Implementation of nilpotent Lie groups as manifolds with a distinguished global coordinate system (exponential coordinates).

Planned features:

* representation of elements in exponential coordinates of the first or second kind
* multiplication of symbolic points (using the manifold point framework)
* the frames of left-invariant and right-invariant vector fields
* the exponential map `exp:\mathfrak{g}\to G` and the logarithm
* the adjoint map `Ad:G\times \mathfrak{g}\to\mathfrak{g}`

CC:  @tscrim @egourgoulhon

Keywords: Lie groups, Lie algebras, manifolds, nilpotent

Reviewer: Eric Gourgoulhon, Travis Scrimshaw

Author: Eero Hakavuori

Branch: b2ef2d9896ca92c139c12781b7d92d2b56397bec

Dependencies: #26080

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26344





---

archive/issue_comments_506431.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-ehaka/nilpotent_lie_groups-26344\"",
    "created_at": "2018-09-25T06:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506431",
    "user": "https://github.com/ehaka"
}
```

Changing branch from "" to "u/gh-ehaka/nilpotent_lie_groups-26344"



---

archive/issue_comments_506432.json:
```json
{
    "body": "<a id='comment:1'></a>A partial first version is now ready, containing the exponential map, exponential coordinates of the first and second kind and group multiplication. Vector fields and the adjoint map are still completely missing, but I thought it would be good to get a working copy up in case there are already some glaring flaws.\n\nIn particular, one thing that did not feel quite right was the current method of computing the symbolic group law. The only way I could think of was to extract the structural coefficients of the Lie algebra and to create a new Lie algebra over `SR` using the same structural coefficients. Two immediate issues of the current approach are\n\n1. the overhead of creating a new Lie algebra\n2. the original base ring of the Lie algebra needs to admit a coercion into `SR`\n\nAnother thing is how to handle the symbolic group law. Currently it is done by creating two dummy-variables, computing the group law as a vector expression in exponential coordinates (through the BCH formula) and then evaluating the group law by substitution of the dummy-variables.\n\nThis is still work-in-progress, but I would be happy to hear comments or suggestions.\n\n---\nNew commits:",
    "created_at": "2018-09-25T06:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506432",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:1'></a>A partial first version is now ready, containing the exponential map, exponential coordinates of the first and second kind and group multiplication. Vector fields and the adjoint map are still completely missing, but I thought it would be good to get a working copy up in case there are already some glaring flaws.

In particular, one thing that did not feel quite right was the current method of computing the symbolic group law. The only way I could think of was to extract the structural coefficients of the Lie algebra and to create a new Lie algebra over `SR` using the same structural coefficients. Two immediate issues of the current approach are

1. the overhead of creating a new Lie algebra
2. the original base ring of the Lie algebra needs to admit a coercion into `SR`

Another thing is how to handle the symbolic group law. Currently it is done by creating two dummy-variables, computing the group law as a vector expression in exponential coordinates (through the BCH formula) and then evaluating the group law by substitution of the dummy-variables.

This is still work-in-progress, but I would be happy to hear comments or suggestions.

---
New commits:



---

archive/issue_comments_506433.json:
```json
{
    "body": "Changing commit from \"\" to \"63006ea2885a50569e2b95b24b83db8a7998dbc8\"",
    "created_at": "2018-09-25T06:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506433",
    "user": "https://github.com/ehaka"
}
```

Changing commit from "" to "63006ea2885a50569e2b95b24b83db8a7998dbc8"



---

archive/issue_comments_506434.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#26080\"",
    "created_at": "2018-09-25T06:39:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506434",
    "user": "https://github.com/ehaka"
}
```

Changing dependencies from "" to "#26080"



---

archive/issue_comments_506435.json:
```json
{
    "body": "<a id='comment:3'></a>Eric, I am cc-ing you in case you have any comments.\n\nThe symbolic ring is usually a bit of a slow beast. it definitely feels wrong to have to have a second copy of the Lie algebra over `SR`. You probably could just use the structure coeffs info.\n\nAnyways, I will think more about this.",
    "created_at": "2018-09-25T07:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506435",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Eric, I am cc-ing you in case you have any comments.

The symbolic ring is usually a bit of a slow beast. it definitely feels wrong to have to have a second copy of the Lie algebra over `SR`. You probably could just use the structure coeffs info.

Anyways, I will think more about this.



---

archive/issue_comments_506436.json:
```json
{
    "body": "<a id='comment:4'></a>Good to see that Lie groups are arriving in Sage!\nI'll have a look tomorrow, focusing on the `SR` issue.",
    "created_at": "2018-09-25T21:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506436",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:4'></a>Good to see that Lie groups are arriving in Sage!
I'll have a look tomorrow, focusing on the `SR` issue.



---

archive/issue_comments_506437.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-26T05:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506438.json:
```json
{
    "body": "Changing commit from \"63006ea2885a50569e2b95b24b83db8a7998dbc8\" to \"8e4dfb1820eb636dd5c5b84b3de90bab50445a12\"",
    "created_at": "2018-09-26T05:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506438",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "63006ea2885a50569e2b95b24b83db8a7998dbc8" to "8e4dfb1820eb636dd5c5b84b3de90bab50445a12"



---

archive/issue_comments_506439.json:
```json
{
    "body": "<a id='comment:6'></a>I am not sure I agree with caching the `*_invariant_frame`. I think this is already done by the atlas for the manifold and there is probably not much benefit to having this cached at the top level as not a lot of computation is done in the methods themselves.\n\nAnother comment is that `structure_coefficients` should exist anytime the Lie algebra has a basis because of the category. I believe the `variable_names()` and `indices()` should not fail either. So I don't see a meaningful exception being thrown.\n\nNow that I have enough time, I see why you are using the symbolic ring to create the group law. You are considering things as generic parameters and seeing what the result is. In principle, creating the `LieAlgebraWithStructureCoefficients` should be relatively quick. It might be better to implement a `change_ring()` method for the class instead of the helper function (which could have more general use). Unfortunately I don't see a way out of creating that (at least, one that is efficient), but it should not take a lot (well, a disproportionate amount) of memory.",
    "created_at": "2018-09-26T10:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506439",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>I am not sure I agree with caching the `*_invariant_frame`. I think this is already done by the atlas for the manifold and there is probably not much benefit to having this cached at the top level as not a lot of computation is done in the methods themselves.

Another comment is that `structure_coefficients` should exist anytime the Lie algebra has a basis because of the category. I believe the `variable_names()` and `indices()` should not fail either. So I don't see a meaningful exception being thrown.

Now that I have enough time, I see why you are using the symbolic ring to create the group law. You are considering things as generic parameters and seeing what the result is. In principle, creating the `LieAlgebraWithStructureCoefficients` should be relatively quick. It might be better to implement a `change_ring()` method for the class instead of the helper function (which could have more general use). Unfortunately I don't see a way out of creating that (at least, one that is efficient), but it should not take a lot (well, a disproportionate amount) of memory.



---

archive/issue_comments_506440.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [tscrim](#comment%3A6):\n> I am not sure I agree with caching the `*_invariant_frame`. I think this is already done by the atlas for the manifold and there is probably not much benefit to having this cached at the top level as not a lot of computation is done in the methods themselves.\n\n\nRight, I did not realize there is manifold level caching. I will remove it from here.\n\n> Another comment is that `structure_coefficients` should exist anytime the Lie algebra has a basis because of the category. \n\n\nThis is a good point, and I should in fact change `indices()` to `basis().keys()` as in the category code of `structure_coefficients`, so it will work regardless within the category.\n\n> It might be better to implement a `change_ring()` method for the class instead of the helper function (which could have more general use).\n\n\nIdeally construction of a Lie group would not rely on the Lie algebra having a `change_ring()` method, but instead only rely on things required/defined in the finite dimensional (nilpotent) Lie algebras with basis category. \n\nHowever it would make sense to by default use `change_ring` if it exists, and to implement this at least for `LieAlgebraWithStructureCoefficients`. Then only in the case when `change_ring` is not defined, the code could fall back to creation of a new Lie algebra using `structure_coefficients()`.\n\nThanks for the comments!",
    "created_at": "2018-09-26T12:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506440",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:7'></a>Replying to [tscrim](#comment%3A6):
> I am not sure I agree with caching the `*_invariant_frame`. I think this is already done by the atlas for the manifold and there is probably not much benefit to having this cached at the top level as not a lot of computation is done in the methods themselves.


Right, I did not realize there is manifold level caching. I will remove it from here.

> Another comment is that `structure_coefficients` should exist anytime the Lie algebra has a basis because of the category. 


This is a good point, and I should in fact change `indices()` to `basis().keys()` as in the category code of `structure_coefficients`, so it will work regardless within the category.

> It might be better to implement a `change_ring()` method for the class instead of the helper function (which could have more general use).


Ideally construction of a Lie group would not rely on the Lie algebra having a `change_ring()` method, but instead only rely on things required/defined in the finite dimensional (nilpotent) Lie algebras with basis category. 

However it would make sense to by default use `change_ring` if it exists, and to implement this at least for `LieAlgebraWithStructureCoefficients`. Then only in the case when `change_ring` is not defined, the code could fall back to creation of a new Lie algebra using `structure_coefficients()`.

Thanks for the comments!



---

archive/issue_comments_506441.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-26T16:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506442.json:
```json
{
    "body": "Changing commit from \"8e4dfb1820eb636dd5c5b84b3de90bab50445a12\" to \"61963e06463f59ef392fec1d5e488870788d25c6\"",
    "created_at": "2018-09-26T16:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506442",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8e4dfb1820eb636dd5c5b84b3de90bab50445a12" to "61963e06463f59ef392fec1d5e488870788d25c6"



---

archive/issue_comments_506443.json:
```json
{
    "body": "<a id='comment:9'></a>I gave a first glance: this looks very nice!\n\nA very minor remark: in the example shown in line 151 of `lie_group.py` (as well as in other similar examples), a shortcut for\n\n```\nsage: list(X[0].components(exp1_frame))\n```\nis \n\n```\nsage: X[0][exp1_frame,:]\n```\nMaybe you chose the longer version as being more explicit?\nAlso you can display the components of the vector field `X[0]` by\n\n```\nsage: X[0].display(exp1_frame)\nX_0 = d/dx_0 - 1/2*x_1 d/dx_2\n```\nSince `exp1_frame` is the default vector frame on `G`, this can be shorten to simply\n`X[0].display()`.",
    "created_at": "2018-09-26T22:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506443",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:9'></a>I gave a first glance: this looks very nice!

A very minor remark: in the example shown in line 151 of `lie_group.py` (as well as in other similar examples), a shortcut for

```
sage: list(X[0].components(exp1_frame))
```
is 

```
sage: X[0][exp1_frame,:]
```
Maybe you chose the longer version as being more explicit?
Also you can display the components of the vector field `X[0]` by

```
sage: X[0].display(exp1_frame)
X_0 = d/dx_0 - 1/2*x_1 d/dx_2
```
Since `exp1_frame` is the default vector frame on `G`, this can be shorten to simply
`X[0].display()`.



---

archive/issue_comments_506444.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [egourgoulhon](#comment%3A9):\n> I gave a first glance: this looks very nice!\n\n>\n> A very minor remark: in the example shown in line 151 of `lie_group.py` (as well as in other similar examples), a shortcut for\n> \n> ```\n> sage: list(X[0].components(exp1_frame))\n> ```\n> is \n> \n> ```\n> sage: X[0][exp1_frame,:]\n> ```\n> Maybe you chose the longer version as being more explicit?\n> Also you can display the components of the vector field `X[0]` by\n> \n> ```\n> sage: X[0].display(exp1_frame)\n> X_0 = d/dx_0 - 1/2*x_1 d/dx_2\n> ```\n\n\nThis choice was just a consequence of lack of knowledge on my part. Thanks for the advice, this will clean up the doc quite a bit!\n\n> Since `exp1_frame` is the default vector frame on `G`, this can be shorten to simply\n> `X[0].display()`. \n\n\nAt this point I don't know what should be the default frame. The best sounding options are either the coordinate frame of the default system of coordinates, or the left-invariant frame.",
    "created_at": "2018-09-27T04:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506444",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:10'></a>Replying to [egourgoulhon](#comment%3A9):
> I gave a first glance: this looks very nice!

>
> A very minor remark: in the example shown in line 151 of `lie_group.py` (as well as in other similar examples), a shortcut for
> 
> ```
> sage: list(X[0].components(exp1_frame))
> ```
> is 
> 
> ```
> sage: X[0][exp1_frame,:]
> ```
> Maybe you chose the longer version as being more explicit?
> Also you can display the components of the vector field `X[0]` by
> 
> ```
> sage: X[0].display(exp1_frame)
> X_0 = d/dx_0 - 1/2*x_1 d/dx_2
> ```


This choice was just a consequence of lack of knowledge on my part. Thanks for the advice, this will clean up the doc quite a bit!

> Since `exp1_frame` is the default vector frame on `G`, this can be shorten to simply
> `X[0].display()`. 


At this point I don't know what should be the default frame. The best sounding options are either the coordinate frame of the default system of coordinates, or the left-invariant frame.



---

archive/issue_comments_506445.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [gh-ehaka](#comment%3A10):\n> > Since `exp1_frame` is the default vector frame on `G`, this can be shorten to simply\n> > `X[0].display()`. \n  \n> \n> At this point I don't know what should be the default frame. The best sounding options are either the coordinate frame of the default system of coordinates, or the left-invariant frame.\n\nIn this case, it is probably better to keep the explicit form, i.e. `X[0].display(exp1_frame)`.",
    "created_at": "2018-09-27T08:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506445",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:11'></a>Replying to [gh-ehaka](#comment%3A10):
> > Since `exp1_frame` is the default vector frame on `G`, this can be shorten to simply
> > `X[0].display()`. 
  
> 
> At this point I don't know what should be the default frame. The best sounding options are either the coordinate frame of the default system of coordinates, or the left-invariant frame.

In this case, it is probably better to keep the explicit form, i.e. `X[0].display(exp1_frame)`.



---

archive/issue_comments_506446.json:
```json
{
    "body": "<a id='comment:12'></a>In the documentation, maybe you could use the method `at()` of vector fields to illustrate that the members of `G.left_invariant_frame()` do obey the definition of a left invariant vector field, for instance:\n\n```\nsage: L = lie_algebras.Heisenberg(QQ, 1)\nsage: G = NilpotentLieGroup(L, 'G'); G\nLie group of Heisenberg algebra of rank 1 over Rational Field\nsage: p,q,z = L.basis()\n```\nLet us first introduce a specific element `k` and generic element `g` in `G`: \n\n```\nsage: k = G.exp(p)*G.exp(q); k\nexp(p1 + q1 + 1/2*z)\nsage: g = G(G.chart_exp1()[:]); g  # a generic element of G\nexp(x_0*p1 + x_1*q1 + x_2*z)\n```\nWe introduce next the left translation by `k`:\n\n```\nsage: L_k = G.diff_map(G, coord_functions=(k*g).coordinates()); L_k\nDifferentiable map from the Lie group of Heisenberg algebra of rank 1 over Rational Field to itself\nsage: L_k.display()\nG --> G\n   (x_0, x_1, x_2) |--> (x_0 + 1, x_1 + 1, -1/2*x_0 + 1/2*x_1 + x_2 + 1/2)\n```\nThen we check that `X[0]` obeys the definition of a left invariant vector field as follows:\n\n```\nsage: X = G.left_invariant_frame(); X\nVector frame (G, (X_0,X_1,X_2))\nsage: L_k.differential(g)(X[0].at(g)) == X[0].at(L_k(g))\nTrue\n```\nOf course, we have as well\n\n```\nsage: L_k.differential(g)(X[1].at(g)) == X[1].at(L_k(g))\nTrue\nsage: L_k.differential(g)(X[2].at(g)) == X[2].at(L_k(g))\nTrue\n```\nOf course, a full check would require that `k` is a generic element of `G`; this is possible, by defining `k` from symbolic coordinates.",
    "created_at": "2018-09-27T08:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506446",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:12'></a>In the documentation, maybe you could use the method `at()` of vector fields to illustrate that the members of `G.left_invariant_frame()` do obey the definition of a left invariant vector field, for instance:

```
sage: L = lie_algebras.Heisenberg(QQ, 1)
sage: G = NilpotentLieGroup(L, 'G'); G
Lie group of Heisenberg algebra of rank 1 over Rational Field
sage: p,q,z = L.basis()
```
Let us first introduce a specific element `k` and generic element `g` in `G`: 

```
sage: k = G.exp(p)*G.exp(q); k
exp(p1 + q1 + 1/2*z)
sage: g = G(G.chart_exp1()[:]); g  # a generic element of G
exp(x_0*p1 + x_1*q1 + x_2*z)
```
We introduce next the left translation by `k`:

```
sage: L_k = G.diff_map(G, coord_functions=(k*g).coordinates()); L_k
Differentiable map from the Lie group of Heisenberg algebra of rank 1 over Rational Field to itself
sage: L_k.display()
G --> G
   (x_0, x_1, x_2) |--> (x_0 + 1, x_1 + 1, -1/2*x_0 + 1/2*x_1 + x_2 + 1/2)
```
Then we check that `X[0]` obeys the definition of a left invariant vector field as follows:

```
sage: X = G.left_invariant_frame(); X
Vector frame (G, (X_0,X_1,X_2))
sage: L_k.differential(g)(X[0].at(g)) == X[0].at(L_k(g))
True
```
Of course, we have as well

```
sage: L_k.differential(g)(X[1].at(g)) == X[1].at(L_k(g))
True
sage: L_k.differential(g)(X[2].at(g)) == X[2].at(L_k(g))
True
```
Of course, a full check would require that `k` is a generic element of `G`; this is possible, by defining `k` from symbolic coordinates.



---

archive/issue_comments_506447.json:
```json
{
    "body": "Changing branch from \"u/gh-ehaka/nilpotent_lie_groups-26344\" to \"public/groups/nilpotent_lie_groups-26344\"",
    "created_at": "2018-09-27T17:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506447",
    "user": "https://github.com/ehaka"
}
```

Changing branch from "u/gh-ehaka/nilpotent_lie_groups-26344" to "public/groups/nilpotent_lie_groups-26344"



---

archive/issue_comments_506448.json:
```json
{
    "body": "Changing commit from \"61963e06463f59ef392fec1d5e488870788d25c6\" to \"8a022e85abb13436b8dfc18528f45621309aa4f3\"",
    "created_at": "2018-09-27T17:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506448",
    "user": "https://github.com/ehaka"
}
```

Changing commit from "61963e06463f59ef392fec1d5e488870788d25c6" to "8a022e85abb13436b8dfc18528f45621309aa4f3"



---

archive/issue_comments_506449.json:
```json
{
    "body": "<a id='comment:13'></a>I moved the code over to a public branch so you can feel free to add improvements in if you so wish. I'm also still happy to hear comments and corrections and do the implementation myself as well.\n\nReplying to [egourgoulhon](#comment%3A12):\n> In the documentation, maybe you could use the method `at()` of vector fields to illustrate that the members of `G.left_invariant_frame()` do obey the definition of a left invariant vector field\n\n\nThanks for the suggestion, this is indeed a very good demonstration of basic Lie group functionality. I also ended up adding the creation of left/right translations as a prebuilt method as these maps should see heavy use in practice.\n\nI have still to add in the methods for the logarithm and adjoint maps, after that I would for the moment be satisfied with the basic Lie group functionality. Or at least I can't think of what it is I am missing.\n\n---\nNew commits:",
    "created_at": "2018-09-27T17:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506449",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:13'></a>I moved the code over to a public branch so you can feel free to add improvements in if you so wish. I'm also still happy to hear comments and corrections and do the implementation myself as well.

Replying to [egourgoulhon](#comment%3A12):
> In the documentation, maybe you could use the method `at()` of vector fields to illustrate that the members of `G.left_invariant_frame()` do obey the definition of a left invariant vector field


Thanks for the suggestion, this is indeed a very good demonstration of basic Lie group functionality. I also ended up adding the creation of left/right translations as a prebuilt method as these maps should see heavy use in practice.

I have still to add in the methods for the logarithm and adjoint maps, after that I would for the moment be satisfied with the basic Lie group functionality. Or at least I can't think of what it is I am missing.

---
New commits:



---

archive/issue_comments_506450.json:
```json
{
    "body": "<a id='comment:14'></a>There is also no real penalty for having more tickets (at least, I will continue to be reviewing tickets for at least the next year `:)`). So it doesn't hurt to do things in smaller bites too.",
    "created_at": "2018-09-27T21:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506450",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>There is also no real penalty for having more tickets (at least, I will continue to be reviewing tickets for at least the next year `:)`). So it doesn't hurt to do things in smaller bites too.



---

archive/issue_comments_506451.json:
```json
{
    "body": "Changing commit from \"8a022e85abb13436b8dfc18528f45621309aa4f3\" to \"c16d1f1bac71cbf7f6c21f24cd6f9284a43cebe2\"",
    "created_at": "2018-09-28T05:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8a022e85abb13436b8dfc18528f45621309aa4f3" to "c16d1f1bac71cbf7f6c21f24cd6f9284a43cebe2"



---

archive/issue_comments_506452.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-28T05:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506453.json:
```json
{
    "body": "<a id='comment:16'></a>The missing parts of the initial set of features I had in mind are now in. It didn't seem right to add the adjoint without adding the conjugation map as well so that is now there as well.\n\nAt this point I'll move the ticket over to the bug-hunting/improvement phase.",
    "created_at": "2018-09-28T05:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506453",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:16'></a>The missing parts of the initial set of features I had in mind are now in. It didn't seem right to add the adjoint without adding the conjugation map as well so that is now there as well.

At this point I'll move the ticket over to the bug-hunting/improvement phase.



---

archive/issue_comments_506454.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-28T05:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506454",
    "user": "https://github.com/ehaka"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_506455.json:
```json
{
    "body": "<a id='comment:17'></a>I took the liberty of adding a new section \"Lie groups\" at the manifold metaticket #18528 and put your ticket there. I hope you don't mind.",
    "created_at": "2018-09-28T08:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506455",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:17'></a>I took the liberty of adding a new section "Lie groups" at the manifold metaticket #18528 and put your ticket there. I hope you don't mind.



---

archive/issue_comments_506456.json:
```json
{
    "body": "<a id='comment:18'></a>A question came to my mind: at the moment\n\n```\nsage: L = G.lie_algebra(); L\nHeisenberg algebra of rank 1 over Rational Field\nsage: T1G = G.tangent_space(G.one()); T1G\nTangent space at exp(0)\n```\nare two different beasts:\n\n```\nsage: L.category()\nCategory of finite dimensional nilpotent lie algebras with basis over Rational Field\nsage: T1G.category()\nCategory of finite dimensional vector spaces over Symbolic Ring\nsage: L.basis()\nFinite family {'p1': p1, 'q1': q1, 'z': z}\nsage: T1G.bases()\n[Basis (d/dx_0,d/dx_1,d/dx_2) on the Tangent space at exp(0)]\n```\nalso as Python objects: `L` inherits from `sage.algebras.lie_algebras.lie_algebra.LieAlgebraWithGenerators`, while `T1G` inherits from `sage.tensor.modules.finite_rank_free_module.FiniteRankFreeModule`.\n\nWould it be worth to implement the canonical vector space isomorphism between the two? Would this be useful? A natural way to do it would be via Sage coercions, i.e. implement at least a coercion from `L` to `T1G` (the reverse may not work for vectors with symbolic components). If you think this is worth, this could anyway be postponed to another ticket...",
    "created_at": "2018-09-28T08:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506456",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:18'></a>A question came to my mind: at the moment

```
sage: L = G.lie_algebra(); L
Heisenberg algebra of rank 1 over Rational Field
sage: T1G = G.tangent_space(G.one()); T1G
Tangent space at exp(0)
```
are two different beasts:

```
sage: L.category()
Category of finite dimensional nilpotent lie algebras with basis over Rational Field
sage: T1G.category()
Category of finite dimensional vector spaces over Symbolic Ring
sage: L.basis()
Finite family {'p1': p1, 'q1': q1, 'z': z}
sage: T1G.bases()
[Basis (d/dx_0,d/dx_1,d/dx_2) on the Tangent space at exp(0)]
```
also as Python objects: `L` inherits from `sage.algebras.lie_algebras.lie_algebra.LieAlgebraWithGenerators`, while `T1G` inherits from `sage.tensor.modules.finite_rank_free_module.FiniteRankFreeModule`.

Would it be worth to implement the canonical vector space isomorphism between the two? Would this be useful? A natural way to do it would be via Sage coercions, i.e. implement at least a coercion from `L` to `T1G` (the reverse may not work for vectors with symbolic components). If you think this is worth, this could anyway be postponed to another ticket...



---

archive/issue_comments_506457.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [egourgoulhon](#comment%3A17):\n> I took the liberty of adding a new section \"Lie groups\" at the manifold metaticket #18528 and put your ticket there. I hope you don't mind.\n\n\nThis is perfectly fine by me, organization is good.\n\nReplying to [egourgoulhon](#comment%3A18):\n> Would it be worth to implement the canonical vector space isomorphism between the two? Would this be useful? A natural way to do it would be via Sage coercions, i.e. implement at least a coercion from `L` to `T1G` (the reverse may not work for vectors with symbolic components). If you think this is worth, this could anyway be postponed to another ticket...\n\n\nYes this makes sense, and at least the simple coercion should be quite immediate to define, since the basis of the Lie algebra and the basis coming from the exponential coordinate frame are already in direct correspondence as lists. \n\nIt might actually also be nice to give `T1G` the full Lie algebra structure and upgrade the coercion to one of Lie algebras. Since vector fields already have a Lie bracket operation defined, this should be doable through computation with the left-invariant frame. It would also allow computing symbolic Lie brackets.\n\nAll of this combined would add up to quite a bit though. I think leaving it to a new ticket would be a good idea.",
    "created_at": "2018-09-28T09:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506457",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:19'></a>Replying to [egourgoulhon](#comment%3A17):
> I took the liberty of adding a new section "Lie groups" at the manifold metaticket #18528 and put your ticket there. I hope you don't mind.


This is perfectly fine by me, organization is good.

Replying to [egourgoulhon](#comment%3A18):
> Would it be worth to implement the canonical vector space isomorphism between the two? Would this be useful? A natural way to do it would be via Sage coercions, i.e. implement at least a coercion from `L` to `T1G` (the reverse may not work for vectors with symbolic components). If you think this is worth, this could anyway be postponed to another ticket...


Yes this makes sense, and at least the simple coercion should be quite immediate to define, since the basis of the Lie algebra and the basis coming from the exponential coordinate frame are already in direct correspondence as lists. 

It might actually also be nice to give `T1G` the full Lie algebra structure and upgrade the coercion to one of Lie algebras. Since vector fields already have a Lie bracket operation defined, this should be doable through computation with the left-invariant frame. It would also allow computing symbolic Lie brackets.

All of this combined would add up to quite a bit though. I think leaving it to a new ticket would be a good idea.



---

archive/issue_comments_506458.json:
```json
{
    "body": "<a id='comment:20'></a>While having a coercion would be good, as Eric points out, the mismatch of base rings would force the direction of the coercion `L -> T1G`. However, because coercions have to preserve structure, `T1G` would have to carry a Lie algebra structure.\n\nNow, this does not have to be a coercion. You could implement the conversions (and have a helper method, such as `to_construction_Lie_algebra` or some better name) between the two objects. You probably could do this for the tangent space at a generic element since that just corresponds to conjugating by the element.\n\nAlso as previously stated, that would be good for a followup ticket.\n\nFor this ticket, the only other things I might want to see are a `lie_group` method on the Lie algebra (a generic one would raise a `NotImplementedError` or be an ``@`abstract_method(optional=True)`) and an `exp` method on the Lie algebra element that does `self.parent().lie_group().exp(self)`.",
    "created_at": "2018-09-28T21:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506458",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>While having a coercion would be good, as Eric points out, the mismatch of base rings would force the direction of the coercion `L -> T1G`. However, because coercions have to preserve structure, `T1G` would have to carry a Lie algebra structure.

Now, this does not have to be a coercion. You could implement the conversions (and have a helper method, such as `to_construction_Lie_algebra` or some better name) between the two objects. You probably could do this for the tangent space at a generic element since that just corresponds to conjugating by the element.

Also as previously stated, that would be good for a followup ticket.

For this ticket, the only other things I might want to see are a `lie_group` method on the Lie algebra (a generic one would raise a `NotImplementedError` or be an ``@`abstract_method(optional=True)`) and an `exp` method on the Lie algebra element that does `self.parent().lie_group().exp(self)`.



---

archive/issue_comments_506459.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-29T05:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506460.json:
```json
{
    "body": "Changing commit from \"c16d1f1bac71cbf7f6c21f24cd6f9284a43cebe2\" to \"7607b8c2a0358502c3796410640db3763ee82967\"",
    "created_at": "2018-09-29T05:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c16d1f1bac71cbf7f6c21f24cd6f9284a43cebe2" to "7607b8c2a0358502c3796410640db3763ee82967"



---

archive/issue_comments_506461.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-29T05:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506462.json:
```json
{
    "body": "Changing commit from \"7607b8c2a0358502c3796410640db3763ee82967\" to \"d3c77ac7b0569691b39e0c4e4f0b3ec4aefbaad4\"",
    "created_at": "2018-09-29T05:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506462",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7607b8c2a0358502c3796410640db3763ee82967" to "d3c77ac7b0569691b39e0c4e4f0b3ec4aefbaad4"



---

archive/issue_comments_506463.json:
```json
{
    "body": "<a id='comment:23'></a>I currently set the Lie algebra -> Lie group interface to default to naming the group 'G'. This allows both `L.lie_group()` and `X.exp()`, since requiring the name parameter for `exp` did not seem convenient for use.\n\nShould different(ly named) Lie groups of the same Lie algebra have a predefined canonical coercion between each other? Or should these be considered separate objects? I'm not sure about the intended use of the `_name` parameter when the underlying manifold is the same. In particular,  it is clear that\n\n```\nsage: NilpotentLieGroup(L, 'G') is NilpotentLieGroup(L, 'H')\nFalse\n```\nis desired behavior. Would\n\n```\nsage: NilpotentLieGroup(L, 'G') == NilpotentLieGroup(L, 'H')\nFalse\n```\nalso be desired behavior?",
    "created_at": "2018-09-29T05:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506463",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:23'></a>I currently set the Lie algebra -> Lie group interface to default to naming the group 'G'. This allows both `L.lie_group()` and `X.exp()`, since requiring the name parameter for `exp` did not seem convenient for use.

Should different(ly named) Lie groups of the same Lie algebra have a predefined canonical coercion between each other? Or should these be considered separate objects? I'm not sure about the intended use of the `_name` parameter when the underlying manifold is the same. In particular,  it is clear that

```
sage: NilpotentLieGroup(L, 'G') is NilpotentLieGroup(L, 'H')
False
```
is desired behavior. Would

```
sage: NilpotentLieGroup(L, 'G') == NilpotentLieGroup(L, 'H')
False
```
also be desired behavior?



---

archive/issue_comments_506464.json:
```json
{
    "body": "<a id='comment:24'></a>Another question I have is where should the Lie group functionality go in the source and reference?\nCurrently the source is under `sage.groups.lie_group.py` and the doc is not linked anywhere since I didn't know where to put it.",
    "created_at": "2018-09-29T07:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506464",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:24'></a>Another question I have is where should the Lie group functionality go in the source and reference?
Currently the source is under `sage.groups.lie_group.py` and the doc is not linked anywhere since I didn't know where to put it.



---

archive/issue_comments_506465.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [gh-ehaka](#comment%3A23):\n> I currently set the Lie algebra -> Lie group interface to default to naming the group 'G'. This allows both `L.lie_group()` and `X.exp()`, since requiring the name parameter for `exp` did not seem convenient for use.\n> \n\n\nI would favor passing the Lie group itself and not the string representing its name as the argument of the `exp` defined in the element methods of `LieAlgebras`, i.e. \nsomething like\n\n```\ndef exp(self, lie_group=None):\n    if not lie_group:\n        return self.parent().lie_group().exp(self)\n    return lie_group.exp(self)\n```\nThis seems more robust to me, especially at this level (element method of *all* Lie algebras).\n\n> Should different(ly named) Lie groups of the same Lie algebra have a predefined canonical coercion between each other? Or should these be considered separate objects? I'm not sure about the intended use of the `_name` parameter when the underlying manifold is the same. In particular,  it is clear that\n> \n> ```\n> sage: NilpotentLieGroup(L, 'G') is NilpotentLieGroup(L, 'H')\n> False\n> ```\n> is desired behavior. \n\nYes.\n> Would\n> \n> ```\n> sage: NilpotentLieGroup(L, 'G') == NilpotentLieGroup(L, 'H')\n> False\n> ```\n> also be desired behavior?\n\nI would say yes as well (this would be in the same vein as what we have for manifolds), but I am not 100% sure this is the best option.",
    "created_at": "2018-09-29T12:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506465",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:25'></a>Replying to [gh-ehaka](#comment%3A23):
> I currently set the Lie algebra -> Lie group interface to default to naming the group 'G'. This allows both `L.lie_group()` and `X.exp()`, since requiring the name parameter for `exp` did not seem convenient for use.
> 


I would favor passing the Lie group itself and not the string representing its name as the argument of the `exp` defined in the element methods of `LieAlgebras`, i.e. 
something like

```
def exp(self, lie_group=None):
    if not lie_group:
        return self.parent().lie_group().exp(self)
    return lie_group.exp(self)
```
This seems more robust to me, especially at this level (element method of *all* Lie algebras).

> Should different(ly named) Lie groups of the same Lie algebra have a predefined canonical coercion between each other? Or should these be considered separate objects? I'm not sure about the intended use of the `_name` parameter when the underlying manifold is the same. In particular,  it is clear that
> 
> ```
> sage: NilpotentLieGroup(L, 'G') is NilpotentLieGroup(L, 'H')
> False
> ```
> is desired behavior. 

Yes.
> Would
> 
> ```
> sage: NilpotentLieGroup(L, 'G') == NilpotentLieGroup(L, 'H')
> False
> ```
> also be desired behavior?

I would say yes as well (this would be in the same vein as what we have for manifolds), but I am not 100% sure this is the best option.



---

archive/issue_comments_506466.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [gh-ehaka](#comment%3A24):\n> Another question I have is where should the Lie group functionality go in the source and reference?\n> Currently the source is under `sage.groups.lie_group.py` and the doc is not linked anywhere since I didn't know where to put it.\n\n\nFor the reference manual, there are naturally two options:\n- a new subsection \"Lie groups\" of \n  http://doc.sagemath.org/html/en/reference/groups/\n- a new subsection \"Lie groups\" of http://doc.sagemath.org/html/en/reference/manifolds/\n\nsince Lie groups lie at the intersection of both topics. Depending on which one you choose, I would rename the source file `lie_group.py` to `nilpotent_lie_group.py` and place it in the new subdirectory `src/sage/groups/lie_groups` or `src/sage/manifolds/differentiable/lie_groups`.",
    "created_at": "2018-09-29T12:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506466",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:26'></a>Replying to [gh-ehaka](#comment%3A24):
> Another question I have is where should the Lie group functionality go in the source and reference?
> Currently the source is under `sage.groups.lie_group.py` and the doc is not linked anywhere since I didn't know where to put it.


For the reference manual, there are naturally two options:
- a new subsection "Lie groups" of 
  http://doc.sagemath.org/html/en/reference/groups/
- a new subsection "Lie groups" of http://doc.sagemath.org/html/en/reference/manifolds/

since Lie groups lie at the intersection of both topics. Depending on which one you choose, I would rename the source file `lie_group.py` to `nilpotent_lie_group.py` and place it in the new subdirectory `src/sage/groups/lie_groups` or `src/sage/manifolds/differentiable/lie_groups`.



---

archive/issue_comments_506467.json:
```json
{
    "body": "<a id='comment:27'></a>I would probably put it in with the groups as I think that is there more prominent feature. Moreover, our canonical Lie groups are usually thought of as (matrix) groups, GL, O, U, etc.",
    "created_at": "2018-09-29T23:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506467",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>I would probably put it in with the groups as I think that is there more prominent feature. Moreover, our canonical Lie groups are usually thought of as (matrix) groups, GL, O, U, etc.



---

archive/issue_comments_506468.json:
```json
{
    "body": "Changing commit from \"d3c77ac7b0569691b39e0c4e4f0b3ec4aefbaad4\" to \"383a19aea9a8f5d3541557a0f5b698e9338d3300\"",
    "created_at": "2018-09-30T05:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506468",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d3c77ac7b0569691b39e0c4e4f0b3ec4aefbaad4" to "383a19aea9a8f5d3541557a0f5b698e9338d3300"



---

archive/issue_comments_506469.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-30T05:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506470.json:
```json
{
    "body": "<a id='comment:29'></a>I moved the file to `sage/groups/lie_gps/nilpotent_lie_group.py`. All the other subfolders in groups were `*_gps` so I copied that folder convention. \n\nI added the subsection of Lie groups to the group reference, but it is slightly disturbing to have a separate \"Lie groups\" subsection when there is the matrix groups heading containing GL and others. On the other hand, the abstract-manifold Lie group doesn't fit under the \"Matrix and affine groups\" heading, and extending it to something like \"Matrix, affine, and Lie groups\" seemed even worse. Hopefully this a problem that will solve itself once more Lie group functionality eventually gets added in so that the \"Lie groups\" heading feels more fleshed out.",
    "created_at": "2018-09-30T05:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506470",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:29'></a>I moved the file to `sage/groups/lie_gps/nilpotent_lie_group.py`. All the other subfolders in groups were `*_gps` so I copied that folder convention. 

I added the subsection of Lie groups to the group reference, but it is slightly disturbing to have a separate "Lie groups" subsection when there is the matrix groups heading containing GL and others. On the other hand, the abstract-manifold Lie group doesn't fit under the "Matrix and affine groups" heading, and extending it to something like "Matrix, affine, and Lie groups" seemed even worse. Hopefully this a problem that will solve itself once more Lie group functionality eventually gets added in so that the "Lie groups" heading feels more fleshed out.



---

archive/issue_comments_506471.json:
```json
{
    "body": "<a id='comment:30'></a>I would argue that this is okay since the other matrix groups do not know they are Lie groups when working over topological fields and also work for a larger class of base fields (e.g., finite fields).",
    "created_at": "2018-09-30T07:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506471",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:30'></a>I would argue that this is okay since the other matrix groups do not know they are Lie groups when working over topological fields and also work for a larger class of base fields (e.g., finite fields).



---

archive/issue_comments_506472.json:
```json
{
    "body": "Changing commit from \"383a19aea9a8f5d3541557a0f5b698e9338d3300\" to \"790338ea26862e2800068d3a3d7fe35db5e9cfbc\"",
    "created_at": "2018-10-03T04:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506472",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "383a19aea9a8f5d3541557a0f5b698e9338d3300" to "790338ea26862e2800068d3a3d7fe35db5e9cfbc"



---

archive/issue_comments_506473.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-03T04:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506474.json:
```json
{
    "body": "<a id='comment:32'></a>I changed the docs of `NilpotentLieGroup` to suggest using the `L.lie_group('G')` syntax over `NilpotentLieGroup(L, 'G')`. Having now played around with these for a bit, the former seemed to be the more convenient entry point.\n\nAlthough now the `NilpotentLieGroup` entry point is not really even relevant as it does not provide any extra functionality. Possibly it could/should be removed from the global namespace? The only benefit I see to keeping it at this moment is being able to use `NilpotentLieGroup?` to see some usage examples.",
    "created_at": "2018-10-03T05:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506474",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:32'></a>I changed the docs of `NilpotentLieGroup` to suggest using the `L.lie_group('G')` syntax over `NilpotentLieGroup(L, 'G')`. Having now played around with these for a bit, the former seemed to be the more convenient entry point.

Although now the `NilpotentLieGroup` entry point is not really even relevant as it does not provide any extra functionality. Possibly it could/should be removed from the global namespace? The only benefit I see to keeping it at this moment is being able to use `NilpotentLieGroup?` to see some usage examples.



---

archive/issue_comments_506475.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-03T11:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506475",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506476.json:
```json
{
    "body": "Changing commit from \"790338ea26862e2800068d3a3d7fe35db5e9cfbc\" to \"e0d909f408fa28a35a351144fff2fee44dd2aa91\"",
    "created_at": "2018-10-03T11:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506476",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "790338ea26862e2800068d3a3d7fe35db5e9cfbc" to "e0d909f408fa28a35a351144fff2fee44dd2aa91"



---

archive/issue_comments_506477.json:
```json
{
    "body": "<a id='comment:34'></a>It probably should be removed, but it should be a new subcatalog `groups.lie`. So I did this.\n\nI removed the `Group.__init__` as that was not doing anything useful.\n\nI cached `chart_exp2` and just called that instead of `_Exp2`.\n\nOther misc doc tweaks.\n\nIf my changes are good, then I think we can set a positive review unless Eric has some more comments.",
    "created_at": "2018-10-03T11:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506477",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>It probably should be removed, but it should be a new subcatalog `groups.lie`. So I did this.

I removed the `Group.__init__` as that was not doing anything useful.

I cached `chart_exp2` and just called that instead of `_Exp2`.

Other misc doc tweaks.

If my changes are good, then I think we can set a positive review unless Eric has some more comments.



---

archive/issue_comments_506478.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Eric Gourgoulhon and Travis Scrimshaw\"",
    "created_at": "2018-10-03T11:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506478",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Eric Gourgoulhon and Travis Scrimshaw"



---

archive/issue_comments_506479.json:
```json
{
    "body": "Changing commit from \"e0d909f408fa28a35a351144fff2fee44dd2aa91\" to \"b2ef2d9896ca92c139c12781b7d92d2b56397bec\"",
    "created_at": "2018-10-03T14:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506479",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e0d909f408fa28a35a351144fff2fee44dd2aa91" to "b2ef2d9896ca92c139c12781b7d92d2b56397bec"



---

archive/issue_comments_506480.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-03T14:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_506481.json:
```json
{
    "body": "<a id='comment:36'></a>Ah, I didn't know about the groups catalog, this is a very good solution, thanks! I fixed a typo in the catalog and removed the now empty file `lie_gps/all.py`\n\nI modified the `_repr_` method of Lie group elements to avoid unnecessarily calling `chart_exp2` in case the default chart is `_Exp1`, since the computation is quite expensive. Although the current form is not ideal either, since now if the default coordinate chart is something other than `chart_exp2` or `_Exp1`, then it will still unnecessarily compute the transitions to and from exp-2 coordinates. Not sure how to handle this without the `_Exp2=None` default.\n\nOther than that, the changes look good to me.",
    "created_at": "2018-10-03T14:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506481",
    "user": "https://github.com/ehaka"
}
```

<a id='comment:36'></a>Ah, I didn't know about the groups catalog, this is a very good solution, thanks! I fixed a typo in the catalog and removed the now empty file `lie_gps/all.py`

I modified the `_repr_` method of Lie group elements to avoid unnecessarily calling `chart_exp2` in case the default chart is `_Exp1`, since the computation is quite expensive. Although the current form is not ideal either, since now if the default coordinate chart is something other than `chart_exp2` or `_Exp1`, then it will still unnecessarily compute the transitions to and from exp-2 coordinates. Not sure how to handle this without the `_Exp2=None` default.

Other than that, the changes look good to me.



---

archive/issue_comments_506482.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [tscrim](#comment%3A34):\n> If my changes are good, then I think we can set a positive review unless Eric has some more comments.\n\n\nEverything looks good to me, so I agree with the positive review.\nThanks for the nice work!",
    "created_at": "2018-10-03T22:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506482",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:37'></a>Replying to [tscrim](#comment%3A34):
> If my changes are good, then I think we can set a positive review unless Eric has some more comments.


Everything looks good to me, so I agree with the positive review.
Thanks for the nice work!



---

archive/issue_comments_506483.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-03T22:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506483",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065532.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-05T16:56:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26344#event-65532"
}
```



---

archive/issue_comments_506484.json:
```json
{
    "body": "Changing branch from \"public/groups/nilpotent_lie_groups-26344\" to \"b2ef2d9896ca92c139c12781b7d92d2b56397bec\"",
    "created_at": "2018-10-05T16:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506484",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/groups/nilpotent_lie_groups-26344" to "b2ef2d9896ca92c139c12781b7d92d2b56397bec"



---

archive/issue_comments_506485.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-05T16:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506485",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_506486.json:
```json
{
    "body": "Changing reviewer from \"Eric Gourgoulhon and Travis Scrimshaw\" to \"Eric Gourgoulhon, Travis Scrimshaw\"",
    "created_at": "2018-10-24T11:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506486",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Eric Gourgoulhon and Travis Scrimshaw" to "Eric Gourgoulhon, Travis Scrimshaw"



---

archive/issue_comments_506487.json:
```json
{
    "body": "Changing commit from \"b2ef2d9896ca92c139c12781b7d92d2b56397bec\" to \"\"",
    "created_at": "2018-10-24T11:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506487",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "b2ef2d9896ca92c139c12781b7d92d2b56397bec" to ""



---

archive/issue_comments_506488.json:
```json
{
    "body": "<a id='comment:41'></a>This should be re-targeted for 8.5.",
    "created_at": "2018-10-28T14:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26344#issuecomment-506488",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>This should be re-targeted for 8.5.



---

archive/issue_events_065533.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T14:52:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26344",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26344#event-65533"
}
```
