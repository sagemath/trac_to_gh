# Issue 26519: py3: care for islice

archive/issues_026282.json:
```json
{
    "assignees": [],
    "body": "\n\nBranch/Commit: **[`3baaea2`](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Vincent Klein**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton, Vincent Klein**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/26519_\n\n",
    "closed_at": "2018-10-23T22:27:53Z",
    "created_at": "2018-10-21T14:56:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: care for islice",
    "type": "issue",
    "updated_at": "2018-10-23T22:27:53Z",
    "url": "https://github.com/sagemath/sage/issues/26519",
    "user": "https://github.com/fchapoton"
}
```


Branch/Commit: **[`3baaea2`](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)**

Reviewer: **Frédéric Chapoton, Vincent Klein**

Author: **Frédéric Chapoton, Vincent Klein**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/26519_





---

archive/issue_events_366938.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-21T14:56:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366938"
}
```



---

archive/issue_events_366939.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-21T14:56:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "000080",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366939"
}
```



---

archive/issue_events_366940.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-21T14:56:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366940"
}
```



---

archive/issue_events_366941.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-21T14:56:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366941"
}
```



---

archive/issue_comments_408889.json:
```json
{
    "body": "Commit: **[`7b2e58d`](https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e)**",
    "created_at": "2018-10-21T14:56:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408889",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`7b2e58d`](https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e)**



---

archive/issue_events_366942.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-21T14:56:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366942"
}
```



---

archive/issue_comments_408890.json:
```json
{
    "body": "Branch: **[u/chapoton/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26519)**",
    "created_at": "2018-10-21T14:56:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408890",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26519)**



---

archive/issue_comments_408891.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e\"><code>7b2e58d</code></a></td><td><code>py3: wrapping islice args with int</code></td></tr></table>\n",
    "created_at": "2018-10-21T14:56:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408891",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e"><code>7b2e58d</code></a></td><td><code>py3: wrapping islice args with int</code></td></tr></table>




---

archive/issue_events_366943.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-10-22T08:21:47Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "subject": "https://github.com/vinklein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366943"
}
```



---

archive/issue_comments_408892.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere is some remaining \"islice\" errors cases on the modified lines. I propose the patch below:\n\n\n```\ndiff --git a/src/sage/rings/padics/local_generic_element.pyx b/src/sage/rings/padics/local_generic_element.pyx\nindex efb934b..3e89b37 100644\n--- a/src/sage/rings/padics/local_generic_element.pyx\n+++ b/src/sage/rings/padics/local_generic_element.pyx\n@@ -344,7 +344,7 @@ cdef class LocalGenericElement(CommutativeRingElement):\n         # construct the return value\n         ans = self.parent().zero()\n         for c in islice(self.expansion(lift_mode=lift_mode),\n-                        int(start), int(stop), k):\n+                        int(start), int(stop), int(k)):\n             ans += ppow * c\n             ppow *= pk\n \ndiff --git a/src/sage/rings/valuation/augmented_valuation.py b/src/sage/rings/valuation/augmented_valuation.py\nindex 5042977..cacd1ed 100644\n--- a/src/sage/rings/valuation/augmented_valuation.py\n+++ b/src/sage/rings/valuation/augmented_valuation.py\n@@ -1817,7 +1817,7 @@ class FiniteAugmentedValuation(AugmentedValuation_base, FiniteInductiveValuation\n             for i in range(f.degree(), -1, -1):\n                 j = i // self.phi().degree()\n                 from itertools import islice\n-                coefficients = list(islice(f.list(), j * self.phi().degree(),\n+                coefficients = list(islice(f.list(), int(j * self.phi().degree()),\n                                            int(i) + 1))\n                 g = self.domain()(coefficients)\n                 ng = self._base_valuation.simplify(g, error=error-j*self._mu, force=force, phiadic=False)\n```",
    "created_at": "2018-10-22T09:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408892",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:3" align="right">comment:3</div>

There is some remaining "islice" errors cases on the modified lines. I propose the patch below:


```
diff --git a/src/sage/rings/padics/local_generic_element.pyx b/src/sage/rings/padics/local_generic_element.pyx
index efb934b..3e89b37 100644
--- a/src/sage/rings/padics/local_generic_element.pyx
+++ b/src/sage/rings/padics/local_generic_element.pyx
@@ -344,7 +344,7 @@ cdef class LocalGenericElement(CommutativeRingElement):
         # construct the return value
         ans = self.parent().zero()
         for c in islice(self.expansion(lift_mode=lift_mode),
-                        int(start), int(stop), k):
+                        int(start), int(stop), int(k)):
             ans += ppow * c
             ppow *= pk
 
diff --git a/src/sage/rings/valuation/augmented_valuation.py b/src/sage/rings/valuation/augmented_valuation.py
index 5042977..cacd1ed 100644
--- a/src/sage/rings/valuation/augmented_valuation.py
+++ b/src/sage/rings/valuation/augmented_valuation.py
@@ -1817,7 +1817,7 @@ class FiniteAugmentedValuation(AugmentedValuation_base, FiniteInductiveValuation
             for i in range(f.degree(), -1, -1):
                 j = i // self.phi().degree()
                 from itertools import islice
-                coefficients = list(islice(f.list(), j * self.phi().degree(),
+                coefficients = list(islice(f.list(), int(j * self.phi().degree()),
                                            int(i) + 1))
                 g = self.domain()(coefficients)
                 ng = self._base_valuation.simplify(g, error=error-j*self._mu, force=force, phiadic=False)
```



---

archive/issue_events_366944.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2018-10-22T09:14:21Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "subject": "https://github.com/vinklein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366944"
}
```



---

archive/issue_comments_408893.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nok, go on",
    "created_at": "2018-10-22T09:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408893",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

ok, go on



---

archive/issue_comments_408894.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nDo you want me to add these fixes, or are you going to do that ?",
    "created_at": "2018-10-22T09:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408894",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

Do you want me to add these fixes, or are you going to do that ?



---

archive/issue_comments_408895.json:
```json
{
    "body": "Changed branch from **[u/chapoton/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26519)** to **[u/vklein/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26519)**",
    "created_at": "2018-10-22T10:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408895",
    "user": "https://github.com/vinklein"
}
```

Changed branch from **[u/chapoton/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/26519)** to **[u/vklein/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26519)**



---

archive/issue_comments_408896.json:
```json
{
    "body": "Changed author from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, Vincent Klein**",
    "created_at": "2018-10-22T10:37:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408896",
    "user": "https://github.com/vinklein"
}
```

Changed author from **Frédéric Chapoton** to **Frédéric Chapoton, Vincent Klein**



---

archive/issue_comments_408897.json:
```json
{
    "body": "Changed commit from **[`7b2e58d`](https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e)** to **[`3baaea2`](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)**",
    "created_at": "2018-10-22T10:37:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408897",
    "user": "https://github.com/vinklein"
}
```

Changed commit from **[`7b2e58d`](https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e)** to **[`3baaea2`](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)**



---

archive/issue_comments_408898.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489\"><code>3baaea2</code></a></td><td><code>Trac #26519: Fix some islice</code></td></tr></table>\n",
    "created_at": "2018-10-22T10:37:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408898",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:8"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489"><code>3baaea2</code></a></td><td><code>Trac #26519: Fix some islice</code></td></tr></table>




---

archive/issue_comments_408899.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI give positive review to `7b2e58d` except for the two lines fixed by `3baaea2`",
    "created_at": "2018-10-22T10:39:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408899",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:9" align="right">comment:9</div>

I give positive review to `7b2e58d` except for the two lines fixed by `3baaea2`



---

archive/issue_comments_408900.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n@fchapoton as i can't review my own commit i let you do that.",
    "created_at": "2018-10-22T10:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408900",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:10" align="right">comment:10</div>

@fchapoton as i can't review my own commit i let you do that.



---

archive/issue_comments_408901.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton, Vincent Klein**",
    "created_at": "2018-10-22T15:28:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408901",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton, Vincent Klein**



---

archive/issue_events_366945.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-22T15:28:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366945"
}
```



---

archive/issue_events_366946.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-22T15:28:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366946"
}
```



---

archive/issue_comments_408902.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nok, good to go from my side",
    "created_at": "2018-10-22T15:28:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408902",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">comment:11</div>

ok, good to go from my side



---

archive/issue_events_366947.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-23T22:27:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366947"
}
```



---

archive/issue_events_366948.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f27b6b54b3850db366bfb618644a90cb51d0ea8e",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-10-23T22:27:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/26519#event-366948"
}
```



---

archive/issue_comments_408903.json:
```json
{
    "body": "Changed branch from **[u/vklein/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26519)** to **[`3baaea2`](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)**",
    "created_at": "2018-10-23T22:27:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/26519#issuecomment-408903",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vklein/26519](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/26519)** to **[`3baaea2`](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)**
