# Issue 26519: py3: care for islice

archive/issues_026282.json:
```json
{
    "body": "\n\nBranch/Commit: 3baaea2a8199df646e5f51c9303ece5089d7a489\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton, Vincent Klein\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton, Vincent Klein\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26519\n\n",
    "closed_at": "2018-10-23T22:27:53Z",
    "created_at": "2018-10-21T14:56:01Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "py3: care for islice",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26519",
    "user": "https://github.com/fchapoton"
}
```


Branch/Commit: 3baaea2a8199df646e5f51c9303ece5089d7a489

Reviewer: Frédéric Chapoton, Vincent Klein

Author: Frédéric Chapoton, Vincent Klein

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26519





---

archive/issue_comments_511719.json:
```json
{
    "body": "Changing commit from \"\" to \"7b2e58dd8e428275bf6cd32148ef2d544be7ff8e\"",
    "created_at": "2018-10-21T14:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511719",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "7b2e58dd8e428275bf6cd32148ef2d544be7ff8e"



---

archive/issue_comments_511720.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-21T14:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511720",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_511721.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/26519\"",
    "created_at": "2018-10-21T14:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511721",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/26519"



---

archive/issue_comments_511722.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[7b2e58d](https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e)|`py3: wrapping islice args with int`|",
    "created_at": "2018-10-21T14:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511722",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[7b2e58d](https://github.com/sagemath/sagetrac-mirror/commit/7b2e58dd8e428275bf6cd32148ef2d544be7ff8e)|`py3: wrapping islice args with int`|



---

archive/issue_comments_511723.json:
```json
{
    "body": "Set assignee to @vinklein.",
    "created_at": "2018-10-22T08:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511723",
    "user": "https://github.com/vinklein"
}
```

Set assignee to @vinklein.



---

archive/issue_comments_511724.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere is some remaining \"islice\" errors cases on the modified lines. I propose the patch below:\n\n\n```\ndiff --git a/src/sage/rings/padics/local_generic_element.pyx b/src/sage/rings/padics/local_generic_element.pyx\nindex efb934b..3e89b37 100644\n--- a/src/sage/rings/padics/local_generic_element.pyx\n+++ b/src/sage/rings/padics/local_generic_element.pyx\n@@ -344,7 +344,7 @@ cdef class LocalGenericElement(CommutativeRingElement):\n         # construct the return value\n         ans = self.parent().zero()\n         for c in islice(self.expansion(lift_mode=lift_mode),\n-                        int(start), int(stop), k):\n+                        int(start), int(stop), int(k)):\n             ans += ppow * c\n             ppow *= pk\n \ndiff --git a/src/sage/rings/valuation/augmented_valuation.py b/src/sage/rings/valuation/augmented_valuation.py\nindex 5042977..cacd1ed 100644\n--- a/src/sage/rings/valuation/augmented_valuation.py\n+++ b/src/sage/rings/valuation/augmented_valuation.py\n@@ -1817,7 +1817,7 @@ class FiniteAugmentedValuation(AugmentedValuation_base, FiniteInductiveValuation\n             for i in range(f.degree(), -1, -1):\n                 j = i // self.phi().degree()\n                 from itertools import islice\n-                coefficients = list(islice(f.list(), j * self.phi().degree(),\n+                coefficients = list(islice(f.list(), int(j * self.phi().degree()),\n                                            int(i) + 1))\n                 g = self.domain()(coefficients)\n                 ng = self._base_valuation.simplify(g, error=error-j*self._mu, force=force, phiadic=False)\n```",
    "created_at": "2018-10-22T09:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511724",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:3'></a>
There is some remaining "islice" errors cases on the modified lines. I propose the patch below:


```
diff --git a/src/sage/rings/padics/local_generic_element.pyx b/src/sage/rings/padics/local_generic_element.pyx
index efb934b..3e89b37 100644
--- a/src/sage/rings/padics/local_generic_element.pyx
+++ b/src/sage/rings/padics/local_generic_element.pyx
@@ -344,7 +344,7 @@ cdef class LocalGenericElement(CommutativeRingElement):
         # construct the return value
         ans = self.parent().zero()
         for c in islice(self.expansion(lift_mode=lift_mode),
-                        int(start), int(stop), k):
+                        int(start), int(stop), int(k)):
             ans += ppow * c
             ppow *= pk
 
diff --git a/src/sage/rings/valuation/augmented_valuation.py b/src/sage/rings/valuation/augmented_valuation.py
index 5042977..cacd1ed 100644
--- a/src/sage/rings/valuation/augmented_valuation.py
+++ b/src/sage/rings/valuation/augmented_valuation.py
@@ -1817,7 +1817,7 @@ class FiniteAugmentedValuation(AugmentedValuation_base, FiniteInductiveValuation
             for i in range(f.degree(), -1, -1):
                 j = i // self.phi().degree()
                 from itertools import islice
-                coefficients = list(islice(f.list(), j * self.phi().degree(),
+                coefficients = list(islice(f.list(), int(j * self.phi().degree()),
                                            int(i) + 1))
                 g = self.domain()(coefficients)
                 ng = self._base_valuation.simplify(g, error=error-j*self._mu, force=force, phiadic=False)
```



---

archive/issue_comments_511725.json:
```json
{
    "body": "Remove assignee @vinklein.",
    "created_at": "2018-10-22T09:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511725",
    "user": "https://github.com/vinklein"
}
```

Remove assignee @vinklein.



---

archive/issue_comments_511726.json:
```json
{
    "body": "<a id='comment:5'></a>\nok, go on",
    "created_at": "2018-10-22T09:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511726",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
ok, go on



---

archive/issue_comments_511727.json:
```json
{
    "body": "<a id='comment:6'></a>\nDo you want me to add these fixes, or are you going to do that ?",
    "created_at": "2018-10-22T09:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511727",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
Do you want me to add these fixes, or are you going to do that ?



---

archive/issue_comments_511728.json:
```json
{
    "body": "Changing branch from \"u/chapoton/26519\" to \"u/vklein/26519\"",
    "created_at": "2018-10-22T10:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511728",
    "user": "https://github.com/vinklein"
}
```

Changing branch from "u/chapoton/26519" to "u/vklein/26519"



---

archive/issue_comments_511729.json:
```json
{
    "body": "Changing author from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Vincent Klein\"",
    "created_at": "2018-10-22T10:37:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511729",
    "user": "https://github.com/vinklein"
}
```

Changing author from "Frédéric Chapoton" to "Frédéric Chapoton, Vincent Klein"



---

archive/issue_comments_511730.json:
```json
{
    "body": "Changing commit from \"7b2e58dd8e428275bf6cd32148ef2d544be7ff8e\" to \"3baaea2a8199df646e5f51c9303ece5089d7a489\"",
    "created_at": "2018-10-22T10:37:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511730",
    "user": "https://github.com/vinklein"
}
```

Changing commit from "7b2e58dd8e428275bf6cd32148ef2d544be7ff8e" to "3baaea2a8199df646e5f51c9303ece5089d7a489"



---

archive/issue_comments_511731.json:
```json
{
    "body": "<a id='comment:8'></a>\nNew commits:\n|                                                                                                                                          |                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[3baaea2](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)|`Trac #26519: Fix some islice`|",
    "created_at": "2018-10-22T10:37:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511731",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:8'></a>
New commits:
|                                                                                                                                          |                              |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[3baaea2](https://github.com/sagemath/sagetrac-mirror/commit/3baaea2a8199df646e5f51c9303ece5089d7a489)|`Trac #26519: Fix some islice`|



---

archive/issue_comments_511732.json:
```json
{
    "body": "<a id='comment:9'></a>\nI give positive review to `7b2e58d` except for the two lines fixed by `3baaea2`",
    "created_at": "2018-10-22T10:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511732",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:9'></a>
I give positive review to `7b2e58d` except for the two lines fixed by `3baaea2`



---

archive/issue_comments_511733.json:
```json
{
    "body": "<a id='comment:10'></a>\n`@`chapoton as i can't review my own commit i let you do that.",
    "created_at": "2018-10-22T10:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511733",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:10'></a>
`@`chapoton as i can't review my own commit i let you do that.



---

archive/issue_comments_511734.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton, Vincent Klein\"",
    "created_at": "2018-10-22T15:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511734",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton, Vincent Klein"



---

archive/issue_comments_511735.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-22T15:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511735",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_511736.json:
```json
{
    "body": "<a id='comment:11'></a>\nok, good to go from my side",
    "created_at": "2018-10-22T15:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511736",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
ok, good to go from my side



---

archive/issue_events_074857.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-23T22:27:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26519#event-74857"
}
```



---

archive/issue_comments_511737.json:
```json
{
    "body": "Changing branch from \"u/vklein/26519\" to \"3baaea2a8199df646e5f51c9303ece5089d7a489\"",
    "created_at": "2018-10-23T22:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511737",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vklein/26519" to "3baaea2a8199df646e5f51c9303ece5089d7a489"



---

archive/issue_comments_511738.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-23T22:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-511738",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
