# Issue 26635: Major extensions to local components code

archive/issues_026398.json:
```json
{
    "body": "Some while ago, I contributed to Sage some code for computing the local component (at a given prime) of the automorphic representation attached to a modular form, based on algorithms from a paper I wrote with Jared Weinstein.\n\nThe existing implementation is incomplete in several ways:\n- it throws an error if the given modular form doesn't have minimal level at p among its character twists;\n- if the local component is supercuspidal, induced from a character of a ramified quadratic extension, then it doesn't completely compute the character, it just returns a string saying which extension it comes from;\n- in supercuspidal 2-adic cases where the level is divisible by 64, it fails because a certain quotient group that comes up in the computation isn't cyclic.\n\nI have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, with the new code the following example works, fulfilling a request from Ariel Pacetti:\n\n```\nsage: E = EllipticCurve(\"575c1\")\nsage: Pi = E.newform().local_component(5)\nsage: Pi.characters()\n[\nCharacter of Q_5*, of level 1, mapping 2 |--> 1/2*a, 5 |--> 1/2*a + 2,\nCharacter of Q_5*, of level 1, mapping 2 |--> -1/2*a, 5 |--> -1/2*a + 2\n]\n```\n\nKeywords: local-components\n\nBranch/Commit: c165835c65b91c1badecd3aae58fa1b031f74a2b\n\nReviewer: David Roe\n\nAuthor: David Loeffler\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/26635\n\n",
    "closed_at": "2021-06-06T13:19:33Z",
    "created_at": "2018-11-04T17:38:20Z",
    "labels": [
        "component: modular forms"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Major extensions to local components code",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26635",
    "user": "https://github.com/loefflerd"
}
```
Some while ago, I contributed to Sage some code for computing the local component (at a given prime) of the automorphic representation attached to a modular form, based on algorithms from a paper I wrote with Jared Weinstein.

The existing implementation is incomplete in several ways:
- it throws an error if the given modular form doesn't have minimal level at p among its character twists;
- if the local component is supercuspidal, induced from a character of a ramified quadratic extension, then it doesn't completely compute the character, it just returns a string saying which extension it comes from;
- in supercuspidal 2-adic cases where the level is divisible by 64, it fails because a certain quotient group that comes up in the computation isn't cyclic.

I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, with the new code the following example works, fulfilling a request from Ariel Pacetti:

```
sage: E = EllipticCurve("575c1")
sage: Pi = E.newform().local_component(5)
sage: Pi.characters()
[
Character of Q_5*, of level 1, mapping 2 |--> 1/2*a, 5 |--> 1/2*a + 2,
Character of Q_5*, of level 1, mapping 2 |--> -1/2*a, 5 |--> -1/2*a + 2
]
```

Keywords: local-components

Branch/Commit: c165835c65b91c1badecd3aae58fa1b031f74a2b

Reviewer: David Roe

Author: David Loeffler

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/26635





---

archive/issue_comments_511969.json:
```json
{
    "body": "Changing branch from \"\" to \"u/davidloeffler/minimal_twist_new\"",
    "created_at": "2018-11-04T17:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511969",
    "user": "https://github.com/loefflerd"
}
```

Changing branch from "" to "u/davidloeffler/minimal_twist_new"



---

archive/issue_comments_511970.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-04T17:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511970",
    "user": "https://github.com/loefflerd"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_511971.json:
```json
{
    "body": "Changing commit from \"\" to \"37ce61fee64a96db57abeaf5a41ac24ed3c00e98\"",
    "created_at": "2018-11-04T17:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511971",
    "user": "https://github.com/loefflerd"
}
```

Changing commit from "" to "37ce61fee64a96db57abeaf5a41ac24ed3c00e98"



---

archive/issue_comments_511972.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[1b55638](https://git.sagemath.org/sage.git/commit?id=1b556388b7af75dd239b2e183458222831da7f12)|`Add a minimal twist function for newform objects`|\n|[37ce61f](https://git.sagemath.org/sage.git/commit?id=37ce61fee64a96db57abeaf5a41ac24ed3c00e98)|`Local components: handle many previously-unimplemented cases`|",
    "created_at": "2018-11-04T17:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511972",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[1b55638](https://git.sagemath.org/sage.git/commit?id=1b556388b7af75dd239b2e183458222831da7f12)|`Add a minimal twist function for newform objects`|
|[37ce61f](https://git.sagemath.org/sage.git/commit?id=37ce61fee64a96db57abeaf5a41ac24ed3c00e98)|`Local components: handle many previously-unimplemented cases`|



---

archive/issue_comments_511973.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,14 @@\n - if the local component is supercuspidal, induced from a character of a ramified quadratic extension, then it doesn't completely compute the character, it just returns a string saying which extension it comes from;\n - in supercuspidal 2-adic cases where the level is divisible by 64, it fails because a certain quotient group that comes up in the computation isn't cyclic.\n \n-I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists.\n+I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, the following example now works, fulfilling a request from Ariel Pacetti:\n+\n+```\n+sage: E = EllipticCurve(\"575c1\")\n+sage: Pi = E.newform().local_component(5)\n+sage: Pi.characters()\n+[\n+Character of Q_5*, of level 1, mapping 2 |--> 1/2*a, 5 |--> 1/2*a + 2,\n+Character of Q_5*, of level 1, mapping 2 |--> -1/2*a, 5 |--> -1/2*a + 2\n+]\n+```\n``````\n",
    "created_at": "2018-11-04T17:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511973",
    "user": "https://github.com/loefflerd"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,14 @@
 - if the local component is supercuspidal, induced from a character of a ramified quadratic extension, then it doesn't completely compute the character, it just returns a string saying which extension it comes from;
 - in supercuspidal 2-adic cases where the level is divisible by 64, it fails because a certain quotient group that comes up in the computation isn't cyclic.
 
-I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists.
+I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, the following example now works, fulfilling a request from Ariel Pacetti:
+
+```
+sage: E = EllipticCurve("575c1")
+sage: Pi = E.newform().local_component(5)
+sage: Pi.characters()
+[
+Character of Q_5*, of level 1, mapping 2 |--> 1/2*a, 5 |--> 1/2*a + 2,
+Character of Q_5*, of level 1, mapping 2 |--> -1/2*a, 5 |--> -1/2*a + 2
+]
+```
``````




---

archive/issue_comments_511974.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n - if the local component is supercuspidal, induced from a character of a ramified quadratic extension, then it doesn't completely compute the character, it just returns a string saying which extension it comes from;\n - in supercuspidal 2-adic cases where the level is divisible by 64, it fails because a certain quotient group that comes up in the computation isn't cyclic.\n \n-I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, the following example now works, fulfilling a request from Ariel Pacetti:\n+I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, with the new code the following example works, fulfilling a request from Ariel Pacetti:\n \n ```\n sage: E = EllipticCurve(\"575c1\")\n``````\n",
    "created_at": "2018-11-04T18:01:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511974",
    "user": "https://github.com/loefflerd"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 - if the local component is supercuspidal, induced from a character of a ramified quadratic extension, then it doesn't completely compute the character, it just returns a string saying which extension it comes from;
 - in supercuspidal 2-adic cases where the level is divisible by 64, it fails because a certain quotient group that comes up in the computation isn't cyclic.
 
-I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, the following example now works, fulfilling a request from Ariel Pacetti:
+I have now reworked the code to fill in all of the above gaps. It should now work for all newforms and all primes, with the exception of certain nasty 2-adic cases where no nice parametrisation exists. In particular, with the new code the following example works, fulfilling a request from Ariel Pacetti:
 
 ```
 sage: E = EllipticCurve("575c1")
``````




---

archive/issue_comments_511975.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[482e00a](https://git.sagemath.org/sage.git/commit/?id=482e00a6c12d5d87fca8ac23aa1daf5edea3f9b9)|`Fix non-ascii chars, non-Py3 code etc picked up by patchbot`|",
    "created_at": "2018-11-04T22:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511975",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[482e00a](https://git.sagemath.org/sage.git/commit/?id=482e00a6c12d5d87fca8ac23aa1daf5edea3f9b9)|`Fix non-ascii chars, non-Py3 code etc picked up by patchbot`|



---

archive/issue_comments_511976.json:
```json
{
    "body": "Changing commit from \"37ce61fee64a96db57abeaf5a41ac24ed3c00e98\" to \"482e00a6c12d5d87fca8ac23aa1daf5edea3f9b9\"",
    "created_at": "2018-11-04T22:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "37ce61fee64a96db57abeaf5a41ac24ed3c00e98" to "482e00a6c12d5d87fca8ac23aa1daf5edea3f9b9"



---

archive/issue_comments_511977.json:
```json
{
    "body": "<a id='comment:6'></a>\nI just committed a fix for some minor coding-style violations picked up by the patchbot.",
    "created_at": "2018-11-04T22:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511977",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:6'></a>
I just committed a fix for some minor coding-style violations picked up by the patchbot.



---

archive/issue_comments_511978.json:
```json
{
    "body": "Changing branch from \"u/davidloeffler/minimal_twist_new\" to \"u/roed/minimal_twist_new\"",
    "created_at": "2021-04-28T22:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511978",
    "user": "https://github.com/roed314"
}
```

Changing branch from "u/davidloeffler/minimal_twist_new" to "u/roed/minimal_twist_new"



---

archive/issue_comments_511979.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[f8160a3](https://git.sagemath.org/sage.git/commit/?id=f8160a3c07931345e8c1a8ee33740d75f9c319d8)|`Fix trivial test failures`|",
    "created_at": "2021-04-28T22:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511979",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[f8160a3](https://git.sagemath.org/sage.git/commit/?id=f8160a3c07931345e8c1a8ee33740d75f9c319d8)|`Fix trivial test failures`|



---

archive/issue_comments_511980.json:
```json
{
    "body": "Changing commit from \"482e00a6c12d5d87fca8ac23aa1daf5edea3f9b9\" to \"f8160a3c07931345e8c1a8ee33740d75f9c319d8\"",
    "created_at": "2021-04-28T22:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511980",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "482e00a6c12d5d87fca8ac23aa1daf5edea3f9b9" to "f8160a3c07931345e8c1a8ee33740d75f9c319d8"



---

archive/issue_comments_511981.json:
```json
{
    "body": "<a id='comment:9'></a>\nI hopefully fixed the merge failure and a couple of deprecation warnings.  There seems to be one actual doctest failure:\n\n```\nFile \"src/sage/modular/local_comp/local_comp.py\", line 704, in sage.modular.local_comp.local_comp.PrimitiveSupercuspidal.characters\nFailed example:\n    Newforms(DirichletGroup(64, QQ).1, 2, names='a')[0].local_component(2).characters() # long time\nExpected:\n    [\n    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> -1/4*a0, 4*s + 1 |--> -1, -1 |--> 1, 2 |--> 1,\n    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> -1/4*a0, 4*s + 1 |--> 1, -1 |--> 1, 2 |--> 1\n    ]\nGot:\n    [\n    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> 1/2*a0, 4*s + 1 |--> 1, -1 |--> 1, 2 |--> 1,\n    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> 1/2*a0, 4*s + 1 |--> -1, -1 |--> 1, 2 |--> 1\n    ]\n```",
    "created_at": "2021-04-28T22:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511981",
    "user": "https://github.com/roed314"
}
```

<a id='comment:9'></a>
I hopefully fixed the merge failure and a couple of deprecation warnings.  There seems to be one actual doctest failure:

```
File "src/sage/modular/local_comp/local_comp.py", line 704, in sage.modular.local_comp.local_comp.PrimitiveSupercuspidal.characters
Failed example:
    Newforms(DirichletGroup(64, QQ).1, 2, names='a')[0].local_component(2).characters() # long time
Expected:
    [
    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> -1/4*a0, 4*s + 1 |--> -1, -1 |--> 1, 2 |--> 1,
    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> -1/4*a0, 4*s + 1 |--> 1, -1 |--> 1, 2 |--> 1
    ]
Got:
    [
    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> 1/2*a0, 4*s + 1 |--> 1, -1 |--> 1, 2 |--> 1,
    Character of unramified extension Q_2(s)* (s^2 + s + 1 = 0), of level 3, mapping s |--> 1, 2*s + 1 |--> 1/2*a0, 4*s + 1 |--> -1, -1 |--> 1, 2 |--> 1
    ]
```



---

archive/issue_comments_511982.json:
```json
{
    "body": "<a id='comment:10'></a>\nNope, merge still failed.  I'll try a more recent version of Sage soon.",
    "created_at": "2021-04-28T22:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511982",
    "user": "https://github.com/roed314"
}
```

<a id='comment:10'></a>
Nope, merge still failed.  I'll try a more recent version of Sage soon.



---

archive/issue_comments_511983.json:
```json
{
    "body": "<a id='comment:11'></a>\nNice to see some movement on this at long last, thanks for taking a look at it! The doctest failure looks harmless to me, my guess is that Sage has changed its mind about which generator to use for the coeff field of the newform. Let me know if you have trouble getting the merge to work, I can have a go myself (if I still remember how).",
    "created_at": "2021-04-29T09:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511983",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:11'></a>
Nice to see some movement on this at long last, thanks for taking a look at it! The doctest failure looks harmless to me, my guess is that Sage has changed its mind about which generator to use for the coeff field of the newform. Let me know if you have trouble getting the merge to work, I can have a go myself (if I still remember how).



---

archive/issue_comments_511984.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|\n|[0cef4b0](https://git.sagemath.org/sage.git/commit/?id=0cef4b09472bc5f69e21eed99ec46f9b36a913e3)|`Merge branch 'u/roed/minimal_twist_new' of git://trac.sagemath.org/sage into t/26635/minimal_twist_new`|",
    "created_at": "2021-04-30T08:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511984",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
|[0cef4b0](https://git.sagemath.org/sage.git/commit/?id=0cef4b09472bc5f69e21eed99ec46f9b36a913e3)|`Merge branch 'u/roed/minimal_twist_new' of git://trac.sagemath.org/sage into t/26635/minimal_twist_new`|



---

archive/issue_comments_511985.json:
```json
{
    "body": "Changing commit from \"f8160a3c07931345e8c1a8ee33740d75f9c319d8\" to \"0cef4b09472bc5f69e21eed99ec46f9b36a913e3\"",
    "created_at": "2021-04-30T08:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f8160a3c07931345e8c1a8ee33740d75f9c319d8" to "0cef4b09472bc5f69e21eed99ec46f9b36a913e3"



---

archive/issue_comments_511986.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[1681b79](https://git.sagemath.org/sage.git/commit/?id=1681b79a2a889c9a9d21eed4d4eea406ed06196c)|`Fix doctest failure`|",
    "created_at": "2021-04-30T08:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511986",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[1681b79](https://git.sagemath.org/sage.git/commit/?id=1681b79a2a889c9a9d21eed4d4eea406ed06196c)|`Fix doctest failure`|



---

archive/issue_comments_511987.json:
```json
{
    "body": "Changing commit from \"0cef4b09472bc5f69e21eed99ec46f9b36a913e3\" to \"1681b79a2a889c9a9d21eed4d4eea406ed06196c\"",
    "created_at": "2021-04-30T08:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0cef4b09472bc5f69e21eed99ec46f9b36a913e3" to "1681b79a2a889c9a9d21eed4d4eea406ed06196c"



---

archive/issue_comments_511988.json:
```json
{
    "body": "<a id='comment:14'></a>\nI got the merge to work (and have adjusted the doctest to what's currently returned).  I'll try to read through the code soon, and let you know if I have questions!",
    "created_at": "2021-04-30T08:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511988",
    "user": "https://github.com/roed314"
}
```

<a id='comment:14'></a>
I got the merge to work (and have adjusted the doctest to what's currently returned).  I'll try to read through the code soon, and let you know if I have questions!



---

archive/issue_comments_511989.json:
```json
{
    "body": "<a id='comment:15'></a>\nI checked about the failing long doctest. It is indeed unrelated to the code at hand, and arises because sage is using a random algorithm to choose a generator of the coeff field of the newform. Shall we just flag it as # random?",
    "created_at": "2021-05-01T08:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511989",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:15'></a>
I checked about the failing long doctest. It is indeed unrelated to the code at hand, and arises because sage is using a random algorithm to choose a generator of the coeff field of the newform. Shall we just flag it as # random?



---

archive/issue_comments_511990.json:
```json
{
    "body": "Changing commit from \"1681b79a2a889c9a9d21eed4d4eea406ed06196c\" to \"c2267ce939fdf1ffdfe0908025e8b3253487fe74\"",
    "created_at": "2021-05-05T15:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1681b79a2a889c9a9d21eed4d4eea406ed06196c" to "c2267ce939fdf1ffdfe0908025e8b3253487fe74"



---

archive/issue_comments_511991.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[c2267ce](https://git.sagemath.org/sage.git/commit/?id=c2267ce939fdf1ffdfe0908025e8b3253487fe74)|`Mostly style changes, one potential speedup`|",
    "created_at": "2021-05-05T15:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511991",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[c2267ce](https://git.sagemath.org/sage.git/commit/?id=c2267ce939fdf1ffdfe0908025e8b3253487fe74)|`Mostly style changes, one potential speedup`|



---

archive/issue_comments_511992.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[d0c9d58](https://git.sagemath.org/sage.git/commit/?id=d0c9d58f3323d86c5344b57fcd74f469ecef78d9)|`Mark fragile doctest as random`|",
    "created_at": "2021-05-05T15:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511992",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[d0c9d58](https://git.sagemath.org/sage.git/commit/?id=d0c9d58f3323d86c5344b57fcd74f469ecef78d9)|`Mark fragile doctest as random`|



---

archive/issue_comments_511993.json:
```json
{
    "body": "Changing commit from \"c2267ce939fdf1ffdfe0908025e8b3253487fe74\" to \"d0c9d58f3323d86c5344b57fcd74f469ecef78d9\"",
    "created_at": "2021-05-05T15:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511993",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c2267ce939fdf1ffdfe0908025e8b3253487fe74" to "d0c9d58f3323d86c5344b57fcd74f469ecef78d9"



---

archive/issue_comments_511994.json:
```json
{
    "body": "Changing commit from \"d0c9d58f3323d86c5344b57fcd74f469ecef78d9\" to \"7d4dd1bc2c9899b2c1261676f858e1eae9916d7a\"",
    "created_at": "2021-05-05T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511994",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d0c9d58f3323d86c5344b57fcd74f469ecef78d9" to "7d4dd1bc2c9899b2c1261676f858e1eae9916d7a"



---

archive/issue_comments_511995.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[7d4dd1b](https://git.sagemath.org/sage.git/commit/?id=7d4dd1bc2c9899b2c1261676f858e1eae9916d7a)|`Some more style fixes`|",
    "created_at": "2021-05-05T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511995",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[7d4dd1b](https://git.sagemath.org/sage.git/commit/?id=7d4dd1bc2c9899b2c1261676f858e1eae9916d7a)|`Some more style fixes`|



---

archive/issue_comments_511996.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-05T16:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511996",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_511997.json:
```json
{
    "body": "<a id='comment:19'></a>\nI read through the code and it looks good.  I made various minor changes to better conform to Sage's style guide.  The one substantive change I made was to move the line `t = self.discrete_log(n, p)` outside a loop.\n\nI'm going to give this a positive review now, but we should keep an eye on the patchbot results.  I'm also hopeful that I can help with improving speed eventually using #26849 (which still needs work).  Finally, what's the theoretical status on the missing 2-adic cases?\n\nI'm sorry this took so long to get reviewed!",
    "created_at": "2021-05-05T16:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511997",
    "user": "https://github.com/roed314"
}
```

<a id='comment:19'></a>
I read through the code and it looks good.  I made various minor changes to better conform to Sage's style guide.  The one substantive change I made was to move the line `t = self.discrete_log(n, p)` outside a loop.

I'm going to give this a positive review now, but we should keep an eye on the patchbot results.  I'm also hopeful that I can help with improving speed eventually using #26849 (which still needs work).  Finally, what's the theoretical status on the missing 2-adic cases?

I'm sorry this took so long to get reviewed!



---

archive/issue_comments_511998.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe\"",
    "created_at": "2021-05-05T16:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511998",
    "user": "https://github.com/roed314"
}
```

Changing reviewer from "" to "David Roe"



---

archive/issue_comments_511999.json:
```json
{
    "body": "<a id='comment:20'></a>\nThanks for the review! \n\nYour ticket for p-adic unit groups looks interesting & obviously it would be nice to unify it with the local-component code; but I doubt it would lead to much of a speed increase. In local-component computations, the computation time is overwhelmingly dominated by computing modular-symbol spaces and Hecke operators on them. The smoothchar.py stuff is just there to give a user-friendly way of interacting with the results of the modsym computation, it is computationally trivial in itself.",
    "created_at": "2021-05-05T17:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-511999",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:20'></a>
Thanks for the review! 

Your ticket for p-adic unit groups looks interesting & obviously it would be nice to unify it with the local-component code; but I doubt it would lead to much of a speed increase. In local-component computations, the computation time is overwhelmingly dominated by computing modular-symbol spaces and Hecke operators on them. The smoothchar.py stuff is just there to give a user-friendly way of interacting with the results of the modsym computation, it is computationally trivial in itself.



---

archive/issue_events_066070.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-05-10T11:02:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26635#event-66070"
}
```



---

archive/issue_comments_512000.json:
```json
{
    "body": "<a id='comment:22'></a>\nPDF docs don't build",
    "created_at": "2021-05-11T22:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512000",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:22'></a>
PDF docs don't build



---

archive/issue_comments_512001.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-05-11T22:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512001",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_512002.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [vbraun](#comment%3A22):\n> PDF docs don't build\n\n\nVolker: I cannot reproduce this failure on my machine (since pdf doc building doesn't work on my system for unrelated reasons). Can you post the relevant log file?",
    "created_at": "2021-05-13T11:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512002",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:23'></a>
Replying to [vbraun](#comment%3A22):
> PDF docs don't build


Volker: I cannot reproduce this failure on my machine (since pdf doc building doesn't work on my system for unrelated reasons). Can you post the relevant log file?



---

archive/issue_comments_512003.json:
```json
{
    "body": "<a id='comment:24'></a>\nWait, I found the error: exactly two characters missing in a single docstring in `smoothchar.py`. Testing, will upload shortly.",
    "created_at": "2021-05-13T12:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512003",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:24'></a>
Wait, I found the error: exactly two characters missing in a single docstring in `smoothchar.py`. Testing, will upload shortly.



---

archive/issue_comments_512004.json:
```json
{
    "body": "Changing branch from \"u/roed/minimal_twist_new\" to \"u/davidloeffler/minimal_twist_new\"",
    "created_at": "2021-05-13T12:57:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512004",
    "user": "https://github.com/loefflerd"
}
```

Changing branch from "u/roed/minimal_twist_new" to "u/davidloeffler/minimal_twist_new"



---

archive/issue_comments_512005.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-05-13T12:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512005",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_512006.json:
```json
{
    "body": "Changing commit from \"7d4dd1bc2c9899b2c1261676f858e1eae9916d7a\" to \"c165835c65b91c1badecd3aae58fa1b031f74a2b\"",
    "created_at": "2021-05-13T12:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512006",
    "user": "https://github.com/loefflerd"
}
```

Changing commit from "7d4dd1bc2c9899b2c1261676f858e1eae9916d7a" to "c165835c65b91c1badecd3aae58fa1b031f74a2b"



---

archive/issue_comments_512007.json:
```json
{
    "body": "<a id='comment:26'></a>\nRight, that should fix it. Given the microscopic size of the change, I presume it is valid to reinstate the positive review.\n\n---\nNew commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[c165835](https://git.sagemath.org/sage.git/commit?id=c165835c65b91c1badecd3aae58fa1b031f74a2b)|`Fix broken latex in docstring`|",
    "created_at": "2021-05-13T12:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512007",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:26'></a>
Right, that should fix it. Given the microscopic size of the change, I presume it is valid to reinstate the positive review.

---
New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[c165835](https://git.sagemath.org/sage.git/commit?id=c165835c65b91c1badecd3aae58fa1b031f74a2b)|`Fix broken latex in docstring`|



---

archive/issue_comments_512008.json:
```json
{
    "body": "<a id='comment:27'></a>\nYep, I agree with the positive review.",
    "created_at": "2021-05-13T16:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512008",
    "user": "https://github.com/roed314"
}
```

<a id='comment:27'></a>
Yep, I agree with the positive review.



---

archive/issue_comments_512009.json:
```json
{
    "body": "Changing branch from \"u/davidloeffler/minimal_twist_new\" to \"c165835c65b91c1badecd3aae58fa1b031f74a2b\"",
    "created_at": "2021-06-06T13:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512009",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/davidloeffler/minimal_twist_new" to "c165835c65b91c1badecd3aae58fa1b031f74a2b"



---

archive/issue_events_066071.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-06T13:19:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26635#event-66071"
}
```



---

archive/issue_comments_512010.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-06T13:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26635#issuecomment-512010",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
