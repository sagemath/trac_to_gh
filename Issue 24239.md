# Issue 24239: Properly download symlinked tarballs

archive/issues_024239.json:
```json
{
    "body": "CC:  @embray @vbraun @kiwifb\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24476\n\n",
    "created_at": "2018-01-05T13:55:12Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Properly download symlinked tarballs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24239",
    "user": "@jdemeyer"
}
```
CC:  @embray @vbraun @kiwifb



Issue created by migration from https://trac.sagemath.org/ticket/24476





---

archive/issue_comments_339423.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-01-05T14:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339423",
    "user": "@jdemeyer"
}
```

New commits:



---

archive/issue_comments_339424.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-05T14:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339424",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_339425.json:
```json
{
    "body": "So whats the plan, have a symlinked tarball or two packages refer to the same tarball? The latter seems more sane to me. Whereas the former raises some questions, e.g. what to upload to mirrors. \n\nLooking up tarball name -> package name isn't really important I think. Could just return a set of matching packages.",
    "created_at": "2018-01-05T23:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339425",
    "user": "@vbraun"
}
```

So whats the plan, have a symlinked tarball or two packages refer to the same tarball? The latter seems more sane to me. Whereas the former raises some questions, e.g. what to upload to mirrors. 

Looking up tarball name -> package name isn't really important I think. Could just return a set of matching packages.



---

archive/issue_comments_339426.json:
```json
{
    "body": "Two packages referring to the same tarball. In #12426 I ended up creating a spkg for gfortran which of course uses gcc's tarball.",
    "created_at": "2018-01-05T23:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339426",
    "user": "@kiwifb"
}
```

Two packages referring to the same tarball. In #12426 I ended up creating a spkg for gfortran which of course uses gcc's tarball.



---

archive/issue_comments_339427.json:
```json
{
    "body": "Replying to [comment:7 vbraun]:\n> Looking up tarball name -> package name isn't really important I think.\n\nIt is needed because the tarballs on the server are stored per package. The URL is something like `.../spkg/upstream/gcc/gcc-7.2.0.xz`, where `gcc` is the package name.",
    "created_at": "2018-01-06T07:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339427",
    "user": "@jdemeyer"
}
```

Replying to [comment:7 vbraun]:
> Looking up tarball name -> package name isn't really important I think.

It is needed because the tarballs on the server are stored per package. The URL is something like `.../spkg/upstream/gcc/gcc-7.2.0.xz`, where `gcc` is the package name.



---

archive/issue_comments_339428.json:
```json
{
    "body": "I am testing this together with #12426. If this is the only scenario to consider, this looks good. Should then #12426 become a dependence here?",
    "created_at": "2018-01-08T12:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339428",
    "user": "@dimpase"
}
```

I am testing this together with #12426. If this is the only scenario to consider, this looks good. Should then #12426 become a dependence here?



---

archive/issue_comments_339429.json:
```json
{
    "body": "Replying to [comment:10 dimpase]:\n> Should then #12426 become a dependence here?\n\nNo. Why should it be?",
    "created_at": "2018-01-08T13:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339429",
    "user": "@jdemeyer"
}
```

Replying to [comment:10 dimpase]:
> Should then #12426 become a dependence here?

No. Why should it be?



---

archive/issue_comments_339430.json:
```json
{
    "body": "looks good to me.",
    "created_at": "2018-01-12T13:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339430",
    "user": "@dimpase"
}
```

looks good to me.



---

archive/issue_comments_339431.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-12T13:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339431",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_339432.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-01-14T10:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24239#issuecomment-339432",
    "user": "@vbraun"
}
```

Resolution: fixed
