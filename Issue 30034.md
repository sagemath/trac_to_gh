# Issue 30034: nauty: Switch to autotoolized fork so that shared libraries can be built

archive/issues_030034.json:
```json
{
    "body": "CC:  winfried @tobihan\n\nThis is for #27952.\n\nThe fork is at https://github.com/mkoeppe/nauty\n\nIssue created by migration from https://trac.sagemath.org/ticket/30271\n\n",
    "created_at": "2020-08-02T13:04:03Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "nauty: Switch to autotoolized fork so that shared libraries can be built",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30034",
    "user": "@mkoeppe"
}
```
CC:  winfried @tobihan

This is for #27952.

The fork is at https://github.com/mkoeppe/nauty

Issue created by migration from https://trac.sagemath.org/ticket/30271





---

archive/issue_comments_426915.json:
```json
{
    "body": "As seen in https://github.com/Normaliz/Normaliz/runs/936924467, this needs more work:\n\n```\n  [nauty-2.7.1+ds+sage-2020-08-01]   /usr/bin/ld: cannot open linker script file ./nauty.map: No such file or directory\n  [nauty-2.7.1+ds+sage-2020-08-01]   collect2: error: ld returned 1 exit status\n```\n\n----\nNew commits:",
    "created_at": "2020-08-02T13:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426915",
    "user": "@mkoeppe"
}
```

As seen in https://github.com/Normaliz/Normaliz/runs/936924467, this needs more work:

```
  [nauty-2.7.1+ds+sage-2020-08-01]   /usr/bin/ld: cannot open linker script file ./nauty.map: No such file or directory
  [nauty-2.7.1+ds+sage-2020-08-01]   collect2: error: ld returned 1 exit status
```

----
New commits:



---

archive/issue_comments_426916.json:
```json
{
    "body": "(removing cc as requested)",
    "created_at": "2020-08-12T05:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426916",
    "user": "@mkoeppe"
}
```

(removing cc as requested)



---

archive/issue_comments_426917.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2020-08-12T05:24:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426917",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_426918.json:
```json
{
    "body": "ubuntu-trusty-maximal (https://github.com/mkoeppe/sage/runs/974420086)\n\n```\n/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:1512: undefined reference to `__gmpz_init'\nsumlines-sumlines.o: In function `add_one':\n/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:677: undefined reference to `__gmpz_init_set'\n/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:629: undefined reference to `__gmpz_add'\nsumlines-sumlines.o: In function `scanline':\n/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:961: undefined reference to `__gmpz_set_str'\nsumlines-sumlines.o: In function `writeline':\n/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:388: undefined reference to `__gmpz_out_str'\ncollect2: error: ld returned 1 exit status\n```\n\nWorked ok on `ubuntu-bionic-maximal` (https://github.com/mkoeppe/sage/runs/974420157)",
    "created_at": "2020-08-12T18:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426918",
    "user": "@mkoeppe"
}
```

ubuntu-trusty-maximal (https://github.com/mkoeppe/sage/runs/974420086)

```
/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:1512: undefined reference to `__gmpz_init'
sumlines-sumlines.o: In function `add_one':
/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:677: undefined reference to `__gmpz_init_set'
/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:629: undefined reference to `__gmpz_add'
sumlines-sumlines.o: In function `scanline':
/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:961: undefined reference to `__gmpz_set_str'
sumlines-sumlines.o: In function `writeline':
/sage/local/var/tmp/sage/build/nauty-2.7.1+ds+sage-2020-08-02/src/sumlines.c:388: undefined reference to `__gmpz_out_str'
collect2: error: ld returned 1 exit status
```

Worked ok on `ubuntu-bionic-maximal` (https://github.com/mkoeppe/sage/runs/974420157)



---

archive/issue_comments_426919.json:
```json
{
    "body": "`@`thansen: https://github.com/mkoeppe/nauty continues the autotoolization of nauty that is done partially by the Debian package. This may be of interest to the Debian maintainers",
    "created_at": "2020-12-10T07:03:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426919",
    "user": "@mkoeppe"
}
```

`@`thansen: https://github.com/mkoeppe/nauty continues the autotoolization of nauty that is done partially by the Debian package. This may be of interest to the Debian maintainers



---

archive/issue_comments_426920.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-10T07:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426920",
    "user": "@mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_426921.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30034#issuecomment-426921",
    "user": "@mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
