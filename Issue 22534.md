# Issue 22534: Numerical Precision for Heights in Number Fields

archive/issues_022534.json:
```json
{
    "body": "CC:  @raghukul01 @bhutz\n\nUse real interval field for floating point computations to compute relative heights in number fields without precision errors.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22771\n\n",
    "created_at": "2017-04-07T01:40:17Z",
    "labels": [
        "component: algebraic geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Numerical Precision for Heights in Number Fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22534",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjcombs"
}
```
CC:  @raghukul01 @bhutz

Use real interval field for floating point computations to compute relative heights in number fields without precision errors.

Issue created by migration from https://trac.sagemath.org/ticket/22771





---

archive/issue_comments_313731.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-05-28T03:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313731",
    "user": "https://github.com/raghukul01"
}
```

New commits:



---

archive/issue_comments_313732.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-28T03:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313732",
    "user": "https://github.com/raghukul01"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_313733.json:
```json
{
    "body": "Changing keywords from \"\" to \"number fields, gsoc2018\".",
    "created_at": "2018-05-28T03:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313733",
    "user": "https://github.com/raghukul01"
}
```

Changing keywords from "" to "number fields, gsoc2018".



---

archive/issue_comments_313734.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-28T18:03:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313735.json:
```json
{
    "body": "Here are a few things I've noticed so far.\n\n- Need to have in the longer description that this is using the 'relative multiplicative height'\n\n- remove todo block  (QQ and r=0 are covered in other functions)\n\n- step 13: spelling: thier\n\n\n- why switching to iter instead of yield? What about the issues of this being possibly *many* points? Please respond.\n\n- LLL reduction still in docs for elements_of_bounded_height.\n\n\n- need spaces between inputs lines in elements_of_bounded_height\n\n- spaces after , in parameters\n\n- This fails:\n\n```\nR.<x>=QQ[]\nK.<a> = NumberField(x^3 - x^2 + 1)\nA.<x,y>=AffineSpace(K,2)\nlist(A.points_of_bounded_height(2))\n```\n\nthen so does subschemes\n\n```\nA.<x,y>=AffineSpace(K,2)\nC = A.subscheme([x-y])\nC.rational_points(2)\n```\n\n\n- reference should be updated with published version\n\n- add yourself and TJ Combs to author section at top of file",
    "created_at": "2018-05-29T21:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313735",
    "user": "https://github.com/bhutz"
}
```

Here are a few things I've noticed so far.

- Need to have in the longer description that this is using the 'relative multiplicative height'

- remove todo block  (QQ and r=0 are covered in other functions)

- step 13: spelling: thier


- why switching to iter instead of yield? What about the issues of this being possibly *many* points? Please respond.

- LLL reduction still in docs for elements_of_bounded_height.


- need spaces between inputs lines in elements_of_bounded_height

- spaces after , in parameters

- This fails:

```
R.<x>=QQ[]
K.<a> = NumberField(x^3 - x^2 + 1)
A.<x,y>=AffineSpace(K,2)
list(A.points_of_bounded_height(2))
```

then so does subschemes

```
A.<x,y>=AffineSpace(K,2)
C = A.subscheme([x-y])
C.rational_points(2)
```


- reference should be updated with published version

- add yourself and TJ Combs to author section at top of file



---

archive/issue_comments_313736.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-29T21:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313736",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313737.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T17:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313738.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-31T08:27:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313739.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-31T08:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313739",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313740.json:
```json
{
    "body": "Sorry, I just realized I never commented on this. The fix does work, but I would change one thing.\n\nd_tilde is used in a couple other places, so I would covert d_tilde to RR in the same place M is converted (after calculations with it are done)\n\nd_tilde = RR(d_tilde)",
    "created_at": "2018-06-04T14:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313740",
    "user": "https://github.com/bhutz"
}
```

Sorry, I just realized I never commented on this. The fix does work, but I would change one thing.

d_tilde is used in a couple other places, so I would covert d_tilde to RR in the same place M is converted (after calculations with it are done)

d_tilde = RR(d_tilde)



---

archive/issue_comments_313741.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-04T14:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313741",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313742.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-04T14:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313742",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313743.json:
```json
{
    "body": "Sir,\nI have made the changes which you suggested, please review.\nI guess trac doesn't notify about commits pushed on the ticket, though I have added you to cc now.",
    "created_at": "2018-06-04T15:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313743",
    "user": "https://github.com/raghukul01"
}
```

Sir,
I have made the changes which you suggested, please review.
I guess trac doesn't notify about commits pushed on the ticket, though I have added you to cc now.



---

archive/issue_comments_313744.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-04T15:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313744",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313745.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-04T15:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313745",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313746.json:
```json
{
    "body": "no, I did get notified and even pulled it down and tested, but apparently I never put in my comments.\n\nIn going back over my tests with the new branch, there is one addition thing that I had noticed that needs to be fixed. With affine schemes working it exposed the fact that the height is converted to an absolute height incorrectly. In affine_space.py it has\n\n```\nbound = bound**(1/self.base_ring().absolute_degree())\n```\n\nwhich should be\n\n```\nbound = bound**self.base_ring().absolute_degree()\n```\n\n\nYou may need to adjust an example. If not, you should definitely add one that ensures this bound is converted correctly.",
    "created_at": "2018-06-04T15:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313746",
    "user": "https://github.com/bhutz"
}
```

no, I did get notified and even pulled it down and tested, but apparently I never put in my comments.

In going back over my tests with the new branch, there is one addition thing that I had noticed that needs to be fixed. With affine schemes working it exposed the fact that the height is converted to an absolute height incorrectly. In affine_space.py it has

```
bound = bound**(1/self.base_ring().absolute_degree())
```

which should be

```
bound = bound**self.base_ring().absolute_degree()
```


You may need to adjust an example. If not, you should definitely add one that ensures this bound is converted correctly.



---

archive/issue_comments_313747.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-06-04T20:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313747",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_313748.json:
```json
{
    "body": "I have changed the part which calculates relative height in affine_space.py, example 2 was taking a long time and the answer was also wrong. So I changed that (examples show previous calculation was wrong).",
    "created_at": "2018-06-04T21:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313748",
    "user": "https://github.com/raghukul01"
}
```

I have changed the part which calculates relative height in affine_space.py, example 2 was taking a long time and the answer was also wrong. So I changed that (examples show previous calculation was wrong).



---

archive/issue_comments_313749.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-04T21:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313749",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313750.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-04T21:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313750",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_313751.json:
```json
{
    "body": "Doctests fail. Run \"make ptestlong\"",
    "created_at": "2018-06-07T19:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313751",
    "user": "https://github.com/vbraun"
}
```

Doctests fail. Run "make ptestlong"



---

archive/issue_comments_313752.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-06-07T19:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313752",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_313753.json:
```json
{
    "body": "I ran the regular test, but  neglected to reun the longtests\n\n\n```\nFile \"src/sage/rings/number_field/number_field.py\", line 9375, in sage.rings.number_field.number_field.NumberField_absolute.elements_of_bounded_height\nFailed example:\n    len(list(L)) # long time (2 s)\nExpected:\n    2163\nGot:\n    2171\n```\n\n\nyou should check if this is another case of alg 3 missing points. If so we can just correct the result value.",
    "created_at": "2018-06-07T19:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313753",
    "user": "https://github.com/bhutz"
}
```

I ran the regular test, but  neglected to reun the longtests


```
File "src/sage/rings/number_field/number_field.py", line 9375, in sage.rings.number_field.number_field.NumberField_absolute.elements_of_bounded_height
Failed example:
    len(list(L)) # long time (2 s)
Expected:
    2163
Got:
    2171
```


you should check if this is another case of alg 3 missing points. If so we can just correct the result value.



---

archive/issue_comments_313754.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-08T09:23:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313754",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313755.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-08T09:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313755",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313756.json:
```json
{
    "body": "Yes it was a case of missing points, changing the height to 50.1 yeilds\n required output\n {{{\n sage: K.<a> = NumberField(x^4 - 5)\n sage: L = K.elements_of_bounded_height(50.1)\n sage: len(list(L)) # long time (2 s)\n 2171\n }}}",
    "created_at": "2018-06-08T09:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313756",
    "user": "https://github.com/raghukul01"
}
```

Yes it was a case of missing points, changing the height to 50.1 yeilds
 required output
 {{{
 sage: K.<a> = NumberField(x^4 - 5)
 sage: L = K.elements_of_bounded_height(50.1)
 sage: len(list(L)) # long time (2 s)
 2171
 }}}



---

archive/issue_comments_313757.json:
```json
{
    "body": "Changing the height bound is not quite what I meant. It sounds like this is an instance of getting the points in L' which are supposed to be within tolerance of the height\n\nabs(H_k(x) - B) < tolerance\n\nIf you need to move the bound to 50.1, then these points are outside of the specified tolerance when bound=50. Since we have to do some conversion between relative and absolute heights. Perhaps the issue is that tolerance must also undergo a similar 'conversion'?",
    "created_at": "2018-06-08T10:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313757",
    "user": "https://github.com/bhutz"
}
```

Changing the height bound is not quite what I meant. It sounds like this is an instance of getting the points in L' which are supposed to be within tolerance of the height

abs(H_k(x) - B) < tolerance

If you need to move the bound to 50.1, then these points are outside of the specified tolerance when bound=50. Since we have to do some conversion between relative and absolute heights. Perhaps the issue is that tolerance must also undergo a similar 'conversion'?



---

archive/issue_comments_313758.json:
```json
{
    "body": "Sorry, my comment was quite confusing,\n\nWhat I meant was if we change the bound to 50.1 or even to 50.02 (current default of tolerance is 0.01), and use algorithm-3 we get correct output (2171). If we use bound 50 in algorithm-4 we get 2171 as the output.\n\nSo it was a case of missing points.\n\nWhich conversion are you suggesting? we are dealing with relative heights here, right?",
    "created_at": "2018-06-08T10:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313758",
    "user": "https://github.com/raghukul01"
}
```

Sorry, my comment was quite confusing,

What I meant was if we change the bound to 50.1 or even to 50.02 (current default of tolerance is 0.01), and use algorithm-3 we get correct output (2171). If we use bound 50 in algorithm-4 we get 2171 as the output.

So it was a case of missing points.

Which conversion are you suggesting? we are dealing with relative heights here, right?



---

archive/issue_comments_313759.json:
```json
{
    "body": "The point I'm making is that we shouldn't be seeing if we can adjust the parameters to gt the 'right' answer, but rather see which is the right answer for the parameters in the doctest.\n\nThe difference are the eight points which all have height\n\n50.0163488242872\n\nso, if the tolerance is specified as 0.01 with a bound of 50, then these points should not be returned. In other words, that would be a failure in the tolerance.\n\nActually, it looks like the number_field.py function has default tolerance 0.2, which makes the new output correct, however, the other function (bdd_height) has default tolerance 0.01.  I would say maybe to make the default tolerance in all of these functions the same (perhaps the 0.01).",
    "created_at": "2018-06-08T13:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313759",
    "user": "https://github.com/bhutz"
}
```

The point I'm making is that we shouldn't be seeing if we can adjust the parameters to gt the 'right' answer, but rather see which is the right answer for the parameters in the doctest.

The difference are the eight points which all have height

50.0163488242872

so, if the tolerance is specified as 0.01 with a bound of 50, then these points should not be returned. In other words, that would be a failure in the tolerance.

Actually, it looks like the number_field.py function has default tolerance 0.2, which makes the new output correct, however, the other function (bdd_height) has default tolerance 0.01.  I would say maybe to make the default tolerance in all of these functions the same (perhaps the 0.01).



---

archive/issue_comments_313760.json:
```json
{
    "body": "Yes sir, I got your point, but before changing there is one issue.\n\nWhat should be the ideal value of tolerance, in earlier testing 0.01 was good enough, but as in this example height can be very close to tolerance (0.01634..). My suggestion is still to use 0.01, what are your views on that?",
    "created_at": "2018-06-08T14:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313760",
    "user": "https://github.com/raghukul01"
}
```

Yes sir, I got your point, but before changing there is one issue.

What should be the ideal value of tolerance, in earlier testing 0.01 was good enough, but as in this example height can be very close to tolerance (0.01634..). My suggestion is still to use 0.01, what are your views on that?



---

archive/issue_comments_313761.json:
```json
{
    "body": "I'm fine with 0.01. More important than the default value is that tolerance does what is claims it does (find all points within tolerance of the specified bound).",
    "created_at": "2018-06-08T14:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313761",
    "user": "https://github.com/bhutz"
}
```

I'm fine with 0.01. More important than the default value is that tolerance does what is claims it does (find all points within tolerance of the specified bound).



---

archive/issue_comments_313762.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-08T15:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313762",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313763.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-08T23:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313763",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313764.json:
```json
{
    "body": "I get doctest failures in affine_homset and affine_rational_points.\n\n\nAdditionally, in my testing tolerance is not behaving as described. In other words you can get points that do not satisfy |H(P) - B| < tol.  However, these points are always points that are above the specified height bound, so I do not think is concerning. However, the documentation should be updated accordingly.",
    "created_at": "2018-06-08T23:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313764",
    "user": "https://github.com/bhutz"
}
```

I get doctest failures in affine_homset and affine_rational_points.


Additionally, in my testing tolerance is not behaving as described. In other words you can get points that do not satisfy |H(P) - B| < tol.  However, these points are always points that are above the specified height bound, so I do not think is concerning. However, the documentation should be updated accordingly.



---

archive/issue_comments_313765.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-09T12:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313765",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313766.json:
```json
{
    "body": "Doc test were failing due to incorrect calculation of relative height, which was corrected in earlier commit. I have changes the bound accordingly, keeping existing bound would have taken very long time for the tests.",
    "created_at": "2018-06-09T12:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313766",
    "user": "https://github.com/raghukul01"
}
```

Doc test were failing due to incorrect calculation of relative height, which was corrected in earlier commit. I have changes the bound accordingly, keeping existing bound would have taken very long time for the tests.



---

archive/issue_comments_313767.json:
```json
{
    "body": "Sir,\nFor the documentation update I am planning to modify the current warning of algorithm 3 result (`In the current implementation, the output of the [Doyle-Krumm] algorithm cannot be guaranteed to be correct due to the necessity of floating point computations. In some cases, the default 53-bit precision is considerably lower than would be required for the algorithm to generate correct output.`) to what you are suggesting that there might me some points for which `H(p) > B + tolerance`, does this seem right?\n\nBTW can you share those tests? \n\nthanks in advance!",
    "created_at": "2018-06-09T13:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313767",
    "user": "https://github.com/raghukul01"
}
```

Sir,
For the documentation update I am planning to modify the current warning of algorithm 3 result (`In the current implementation, the output of the [Doyle-Krumm] algorithm cannot be guaranteed to be correct due to the necessity of floating point computations. In some cases, the default 53-bit precision is considerably lower than would be required for the algorithm to generate correct output.`) to what you are suggesting that there might me some points for which `H(p) > B + tolerance`, does this seem right?

BTW can you share those tests? 

thanks in advance!



---

archive/issue_comments_313768.json:
```json
{
    "body": "I'm not sure it requires a warning block as it does return all of the points up to the bound and decreasing the tolerance does get you exactly the points up to that bound. The part that I am finding inaccurate is the precise relationship between tolerance and those extra points. Clarifying that there are floating point issues and you may get extra points which can be 'corrected' by lowering the tolerance in enough.",
    "created_at": "2018-06-09T13:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313768",
    "user": "https://github.com/bhutz"
}
```

I'm not sure it requires a warning block as it does return all of the points up to the bound and decreasing the tolerance does get you exactly the points up to that bound. The part that I am finding inaccurate is the precise relationship between tolerance and those extra points. Clarifying that there are floating point issues and you may get extra points which can be 'corrected' by lowering the tolerance in enough.



---

archive/issue_comments_313769.json:
```json
{
    "body": "Okay so should this comment be made only in bdd_height? or every place where bdd_height is called indirectly?",
    "created_at": "2018-06-09T13:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313769",
    "user": "https://github.com/raghukul01"
}
```

Okay so should this comment be made only in bdd_height? or every place where bdd_height is called indirectly?



---

archive/issue_comments_313770.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-09T13:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313770",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313771.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-09T13:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313771",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313772.json:
```json
{
    "body": "updated doctests and docstrings",
    "created_at": "2018-06-09T13:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313772",
    "user": "https://github.com/raghukul01"
}
```

updated doctests and docstrings



---

archive/issue_comments_313773.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-10T18:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313773",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313774.json:
```json
{
    "body": "I'm ok with the vague description of lowering tolerance, except that I would not just say extra, but rather points larger than the specified bound.\n\nHowever, there are still a number of documentation issues surrounding tolerance that I had missed earlier.\n\n- bdd_height still claims that all points satisfy |H(P) - B| < tol. Which is what I am finding to be not accurate.\n\n- elements_of_bounded_height still lists the old warning\n\n- there is no way to specify tolerance or precision in the places affine objects call enum_number_field\n\n- there is no way specify tolerance in the places projective objects call enum_number_field\n\n- The statements about what algorithm is used etc, should be also be in the indirect call places as well. (these are actually more likely to be used by the user).",
    "created_at": "2018-06-10T18:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313774",
    "user": "https://github.com/bhutz"
}
```

I'm ok with the vague description of lowering tolerance, except that I would not just say extra, but rather points larger than the specified bound.

However, there are still a number of documentation issues surrounding tolerance that I had missed earlier.

- bdd_height still claims that all points satisfy |H(P) - B| < tol. Which is what I am finding to be not accurate.

- elements_of_bounded_height still lists the old warning

- there is no way to specify tolerance or precision in the places affine objects call enum_number_field

- there is no way specify tolerance in the places projective objects call enum_number_field

- The statements about what algorithm is used etc, should be also be in the indirect call places as well. (these are actually more likely to be used by the user).



---

archive/issue_comments_313775.json:
```json
{
    "body": "btw, this is a situation where I'd be tempted to switch the affine.rational_points/.points and projective.rational_points/.points functions to *kwds since which keywords are needed dependents on which situation/algorithm is being used.",
    "created_at": "2018-06-10T20:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313775",
    "user": "https://github.com/bhutz"
}
```

btw, this is a situation where I'd be tempted to switch the affine.rational_points/.points and projective.rational_points/.points functions to *kwds since which keywords are needed dependents on which situation/algorithm is being used.



---

archive/issue_comments_313776.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-11T17:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313777.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-11T17:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313777",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313778.json:
```json
{
    "body": "Here is a suggestion for updating the docs. Please look over for typos.\n\nAlso there are still a couple functionality things:\nkwds needed so tolerance, precision can be specified if needed\n\n- affine homeset needs *kwds \n\n- product projective needs *kwds\n\n- projective homset needs *kwds\n\nneed to remember to run doctests before pushing...\n\n```\nsage -t --warn-long 63.5 product_projective/homset.py  # 1 doctest failed\nsage -t --warn-long 63.5 product_projective/space.py  # 2 doctests failed\n```\n\n----\nNew commits:",
    "created_at": "2018-06-11T18:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313778",
    "user": "https://github.com/bhutz"
}
```

Here is a suggestion for updating the docs. Please look over for typos.

Also there are still a couple functionality things:
kwds needed so tolerance, precision can be specified if needed

- affine homeset needs *kwds 

- product projective needs *kwds

- projective homset needs *kwds

need to remember to run doctests before pushing...

```
sage -t --warn-long 63.5 product_projective/homset.py  # 1 doctest failed
sage -t --warn-long 63.5 product_projective/space.py  # 2 doctests failed
```

----
New commits:



---

archive/issue_comments_313779.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-11T18:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313779",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313780.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-14T18:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313780",
    "user": "https://github.com/raghukul01"
}
```

New commits:



---

archive/issue_comments_313781.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-14T18:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313781",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313782.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-19T14:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313782",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313783.json:
```json
{
    "body": "algorithm 5 is spelled wrong evertywhere\n\nin affine homset: dimension zero line in docs. this doesn't work for rings, so you probably mean: whether the field is infinite or not.",
    "created_at": "2018-06-19T14:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313783",
    "user": "https://github.com/bhutz"
}
```

algorithm 5 is spelled wrong evertywhere

in affine homset: dimension zero line in docs. this doesn't work for rings, so you probably mean: whether the field is infinite or not.



---

archive/issue_comments_313784.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-19T23:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313785.json:
```json
{
    "body": "added suggested changes",
    "created_at": "2018-06-19T23:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313785",
    "user": "https://github.com/raghukul01"
}
```

added suggested changes



---

archive/issue_comments_313786.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-19T23:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313786",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313787.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-20T00:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313787",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_313788.json:
```json
{
    "body": "from ptestlong looks like the same set of failures from we got in #23627\n\n\n```\nsage -t --long --warn-long 66.7 src/sage/graphs/generators/smallgraphs.py  # 3 doctests failed\nsage -t --long --warn-long 66.7 src/sage/coding/linear_code.py  # 109 doctests failed\nsage -t --long --warn-long 66.7 src/sage/coding/codecan/autgroup_can_label.pyx  # 55 doctests failed\nsage -t --long --warn-long 66.7 src/sage/coding/codecan/codecan.pyx  # 41 doctests failed\nsage -t --long --warn-long 66.7 src/sage/coding/code_constructions.py  # 3 doctests failed\nsage -t --long --warn-long 66.7 src/doc/en/constructions/linear_codes.rst  # 13 doctests failed\nsage -t --long --warn-long 66.7 src/sage/coding/hamming_code.py  # 1 doctest failed\nsage -t --long --warn-long 66.7 src/sage/tests/books/judson-abstract-algebra/algcodes-sage.py  # 9 doctests failed\n```\n",
    "created_at": "2018-06-20T00:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313788",
    "user": "https://github.com/bhutz"
}
```

from ptestlong looks like the same set of failures from we got in #23627


```
sage -t --long --warn-long 66.7 src/sage/graphs/generators/smallgraphs.py  # 3 doctests failed
sage -t --long --warn-long 66.7 src/sage/coding/linear_code.py  # 109 doctests failed
sage -t --long --warn-long 66.7 src/sage/coding/codecan/autgroup_can_label.pyx  # 55 doctests failed
sage -t --long --warn-long 66.7 src/sage/coding/codecan/codecan.pyx  # 41 doctests failed
sage -t --long --warn-long 66.7 src/sage/coding/code_constructions.py  # 3 doctests failed
sage -t --long --warn-long 66.7 src/doc/en/constructions/linear_codes.rst  # 13 doctests failed
sage -t --long --warn-long 66.7 src/sage/coding/hamming_code.py  # 1 doctest failed
sage -t --long --warn-long 66.7 src/sage/tests/books/judson-abstract-algebra/algcodes-sage.py  # 9 doctests failed
```




---

archive/issue_comments_313789.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-20T10:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313789",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313790.json:
```json
{
    "body": "Corrected the line in hamming_code.py",
    "created_at": "2018-06-20T10:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313790",
    "user": "https://github.com/raghukul01"
}
```

Corrected the line in hamming_code.py



---

archive/issue_comments_313791.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-20T10:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313791",
    "user": "https://github.com/raghukul01"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_313792.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-20T16:18:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313792",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_313793.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-21T17:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22534#issuecomment-313793",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_021198.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2018-06-21T17:26:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22534",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22534#event-21198"
}
```
