# Issue 19324: enforce Sage integers in Krawtchouk

Issue created by migration from Trac.

Original creator: dimpase

Original creation time: 2015-11-09 19:39:23

CC:  nbruin ppurka

see https://groups.google.com/d/msg/sage-support/I7BAQTnS_mY/8G9s-6N1AwAJ

if input parameters are `int`, division in the loop will get ugly


---

Comment by dimpase created at 2015-11-09 23:28:26

should add a doctest...
----
New commits:


---

Comment by git created at 2015-11-09 23:34:09

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2015-11-09 23:34:42

Changing status from new to needs_review.


---

Comment by git created at 2015-11-09 23:48:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ppurka created at 2015-11-10 13:46:19

Hi Dima,

  Can you let n,q,i alone and just keep the changes
`l = ZZ(l)` and
`for j in srange(1,l+1):`

  These changes should be enough to ensure that the correct coercions take place and the division does not become an integer division. I will send you a document from Matti Aaltonen which shows that almost all properties of Krawtchouks hold even for noninteger n,q,i. Alternatively, you can refer to his paper "A new upper bound on nonbinary block codes", M. Aaltonen, Discrete Maths, 83 (1990), 139-160.

basu.


---

Comment by git created at 2015-11-10 17:44:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2015-11-10 17:46:45

Replying to [comment:5 ppurka]:
> Hi Dima,
> 
>   Can you let n,q,i alone and just keep the changes
> `l = ZZ(l)` and
> `for j in srange(1,l+1):`

OK, done. I also renamed i to x, to make it look more like a polynomial...


---

Comment by dimpase created at 2015-11-11 08:10:32

I am not sure that the implementation is correct for the case where all these parameters are non-integer. It seems that sometimes the sum must become infinite...


---

Comment by dimpase created at 2015-11-11 09:24:29

Replying to [comment:8 dimpase]:
> I am not sure that the implementation is correct for the case where all these parameters are non-integer. It seems that sometimes the sum must become infinite...

OK, I see; we should add the generating function definition of `K` to the documentation...


---

Comment by git created at 2015-11-11 11:09:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-11-11 11:18:13

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ppurka created at 2015-11-12 11:45:06

Can you apply this patch? Otherwise the rest looks good:

```diff
diff --git a/src/sage/coding/delsarte_bounds.py b/src/sage/coding/delsarte_bounds.py
index b4f05b6..cd78e3c 100644
--- a/src/sage/coding/delsarte_bounds.py
+++ b/src/sage/coding/delsarte_bounds.py
`@``@` -21,7 +21,7 `@``@` def Krawtchouk(n,q,l,x,check=True):
     Compute ``K^{n,q}_l(x)``, the Krawtchouk polynomial.
 
     See :wikipedia:`Kravchuk_polynomials`; It is defined by the generating function
-    `(1-(q-1)z)^{n-x}(1-z)^k=\sum_{l} K^{n,q}_k(x)z^l` and is equal to
+    `(1+(q-1)z)^{n-x}(1-z)^x=\sum_{l} K^{n,q}_l(x)z^l` and is equal to
 
     .. math::
 
`@``@` -45,7 +45,7 `@``@` def Krawtchouk(n,q,l,x,check=True):
 
     TESTS:
 
-    check that the bug reported on #19561 is fixed::
+    check that the bug reported on :trac:`19561` is fixed::
 
         sage: Krawtchouk(3,2,3,3)
         -1
```


EDIT: Fixed another typo.


---

Comment by ppurka created at 2015-11-12 11:47:41

Fixed another typo.. `1+(q-1)z`


---

Comment by git created at 2015-11-12 12:20:23

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2015-11-12 12:21:12

Replying to [comment:13 ppurka]:
> Fixed another typo.. `1+(q-1)z`

OK, all done


---

Comment by ppurka created at 2015-11-12 13:00:58

Sorry, `:trac:19561` is missing the single backticks!


---

Comment by git created at 2015-11-12 13:16:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ppurka created at 2015-11-12 13:51:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-11-12 22:44:27

Resolution: fixed
