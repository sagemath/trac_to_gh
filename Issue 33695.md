# Issue 33695: Sets of unhashable elements are broken

archive/issues_033695.json:
```json
{
    "body": "CC:  @tscrim\n\nDocumentation says \"Sets with unhashable objects work, but with less functionality\". However, this functionality is actually broken in at least two ways.\n\nFirst, Sets of unhashable elements fail to recognize equal elements - for example\n\n\n```\nS = Set([factor(10),factor(10)])\nprint(S)\n```\n\n\nprints `Set of elements of [2 * 5, 2 * 5]`, that is the resulting Set here contains two identical elements.\n\n----\n\nSecond, Set skips the first element when it's created from an iterator of unhashable elements:\n\n\n```\nS = Set( [i] for i in (1..5) )\nprint(list(S))\n```\n\n\nThis code prints `[[2], [3], [4], [5]]`, that is the first generated element `[1]` is missing.\n\nA patch for the latter issue was proposed at https://ask.sagemath.org/question/62252/?answer=62285#post-id-62285 which however comes with an overhead.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33932\n\n",
    "created_at": "2022-05-29T02:43:43Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Sets of unhashable elements are broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33695",
    "user": "https://github.com/maxale"
}
```
CC:  @tscrim

Documentation says "Sets with unhashable objects work, but with less functionality". However, this functionality is actually broken in at least two ways.

First, Sets of unhashable elements fail to recognize equal elements - for example


```
S = Set([factor(10),factor(10)])
print(S)
```


prints `Set of elements of [2 * 5, 2 * 5]`, that is the resulting Set here contains two identical elements.

----

Second, Set skips the first element when it's created from an iterator of unhashable elements:


```
S = Set( [i] for i in (1..5) )
print(list(S))
```


This code prints `[[2], [3], [4], [5]]`, that is the first generated element `[1]` is missing.

A patch for the latter issue was proposed at https://ask.sagemath.org/question/62252/?answer=62285#post-id-62285 which however comes with an overhead.

Issue created by migration from https://trac.sagemath.org/ticket/33932





---

archive/issue_comments_478826.json:
```json
{
    "body": "See also #23324",
    "created_at": "2022-06-06T21:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33695#issuecomment-478826",
    "user": "https://github.com/mantepse"
}
```

See also #23324



---

archive/issue_comments_478827.json:
```json
{
    "body": "The second example is fixed in #34387",
    "created_at": "2022-08-31T21:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33695#issuecomment-478827",
    "user": "https://github.com/mkoeppe"
}
```

The second example is fixed in #34387



---

archive/issue_comments_478828.json:
```json
{
    "body": "The first example is a dup of #23324.",
    "created_at": "2022-08-31T22:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33695#issuecomment-478828",
    "user": "https://github.com/mkoeppe"
}
```

The first example is a dup of #23324.



---

archive/issue_comments_478829.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-31T22:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33695#issuecomment-478829",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_478830.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-31T23:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33695#issuecomment-478830",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_030382.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-01T02:30:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33695#event-30382"
}
```



---

archive/issue_comments_478831.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-09-01T02:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33695#issuecomment-478831",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
