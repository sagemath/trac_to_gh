# Issue 24882: Fail to integrate sqrt(x^2)/x

Issue created by migration from https://trac.sagemath.org/ticket/25119

Original creator: rws

Original creation time: 2018-04-08 16:46:02

CC:  slelievre kcrisman


```
sage: integrate(sqrt(x^2)/x,x)
...
RuntimeError: ECL says: Error executing code in Maxima: expt: undefined: 0 to a negative exponent.

sage: integrate(sqrt(x^2)/x,x,algorithm='fricas')
sqrt(x^2)
sage: integrate(sqrt(x^2)/x,x,algorithm='giac')
x*sign(x)
sage: integrate(sqrt(x^2)/x,x,algorithm='sympy')
sqrt(x^2)
```



---

Comment by chapoton created at 2020-09-21 07:16:01

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-09-21 07:16:01

Changing keywords from "" to "integral".


---

Comment by chapoton created at 2020-09-21 07:16:01

Here is a fix (bandaid). One should report upstream to maxima.
----
New commits:


---

Comment by chapoton created at 2020-09-21 15:34:11

bots are morally green, please review


---

Comment by kcrisman created at 2020-09-21 18:49:13

Thanks, Frédéric.  Can I ask whether the changes other than the new doctest and the addition of `RunTimeError` are nontrivial?  I don't think so, but there were a lot of prettification changes.


---

Comment by kcrisman created at 2020-09-21 19:13:26

In vanilla Maxima:

```
(%i4) domain:complex;
(%o4)                               complex
(%i5) integrate(sqrt(x^2)/x,x);

expt: undefined: 0 to a negative exponent.
 -- an error. To debug this try: debugmode(true);
```



---

Comment by kcrisman created at 2020-09-21 19:21:43

However, before giving positive review, I'd suppose we'd want a way to check that this one was fixed - maybe `# known bug` below it where we require `algorithm='maxima'`?


---

Comment by chapoton created at 2020-09-21 20:11:06

All the other changes are purely white space removal or addition, for the sake of flake8 conmpliance.

I guess one could a "known bug" doctest, yes.


---

Comment by kcrisman created at 2020-09-21 21:17:15

Ah yes.  I haven't used that, personally, but I'm sure it complains a lot.  Unfortunately, it just makes tickets harder to review at times.  I won't raise this on -devel because I know how annoyingly much extra work it would be, but having two different commits for that sort of thing is helpful to reviewers.


---

Comment by chapoton created at 2020-09-22 09:29:00

Do you want the "known bug" doctest ? This does not seem to be really necessary to me. We are not responsible for maxima bugs.


---

Comment by kcrisman created at 2020-09-22 12:26:37

It would be nice, because we typically do this in other cases.  But I guess since in this case it is an actual exception raised, as opposed to a wrong result we had to work around, it is not necessary.

But if Volker complains about failing doctests, I am trusting your morally green patchbot :-) Just upgraded OS (still several versions behind) and so won't be building new Sage for a little while until I have time to check that command line tools are working properly.


---

Comment by kcrisman created at 2020-09-22 12:26:37

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-09-27 09:09:54

Resolution: fixed
