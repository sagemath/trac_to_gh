# Issue 18908: Rigorously computing analytic ranks of elliptic curves (for ranks 1, 2, 3)

Issue created by migration from https://trac.sagemath.org/ticket/19145

Original creator: mkovesi

Original creation time: 2015-09-05 22:57:24

CC:  pbruin cremona

Keywords: elliptic curves analytic rank sd69

This is an improvement to the analytic_rank() function in the Elliptic curves over the rational numbers class. The current implementation only produces a value that is probably the analytic rank. This ticket is based on error bound computations to give a provable value of analytic rank.

I will post code shortly.


---

Comment by mkovesi created at 2015-09-09 04:57:14

New commits:


---

Comment by tmonteil created at 2017-04-20 22:27:49

Does this ticket needs review ? I am not volunteering, just point that nobody will look at it unless its status is set to `needs_review`.


---

Comment by cremona created at 2021-02-03 15:57:52

I am merging with develop (9.3.beta3) -- there were some merge conflicts, but easily fixed.  Then I'll upload the new merged branch and set to needs review.

I noticed that the old 'pari' code for analytic rank manages to call ellanalyticrank *twice* which should be fixed whether or not we keep this.  But I hope it will be judged as correct, since I use the analytic rank function a lot.

I suspect that that the author has disappeared as this is the work of a 5-year old MSc thesis.


---

Comment by cremona created at 2021-02-03 16:58:57

I pushed a branch u/cremona/19145 which just merges develop into u/mkovesi/19145.
----
New commits:


---

Comment by cremona created at 2021-02-03 16:58:57

Changing status from new to needs_review.


---

Comment by git created at 2021-02-12 16:18:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-03-26 08:42:58

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2021-03-26 08:42:58

some python2 print are lurking ==> needs work


---

Comment by wuthrich created at 2021-03-28 21:25:35

A few comments:

The while loops in the last few functions can be simplified.

Why is k>15000 an indication that something is wrong? Doesn't k increase as sqrt{N} and so we expect it that large when the conductor is in the millions.

I guess we are certain that precision loss in the sum is never larger than epsilon, are we?

The sums can be made a bit faster by using Horner's scheme; especially in _G2 etc. Though I would guess that these sums are already implemented in pari. Probably much faster.


---

Comment by mmezzarobba created at 2021-04-04 11:07:24

Maybe a stupid question because I don't know anything about the context, sorry, but just in case: Your code is using floating-point arithmetic in several places. Is it clear that the computation is rigorous in spite of possible rounding errors? (If not, you may want to consider working in RBF instead of RR.)


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
