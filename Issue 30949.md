# Issue 30949: MACOSX_VERSION is not always defined during the build process

Issue created by migration from https://trac.sagemath.org/ticket/31186

Original creator: jhpalmieri

Original creation time: 2021-01-05 00:48:20

Should it be? Or should each package define it if it wants it? It is used here:

```
% git grep MACOSX_VERSION build/pkgs/
build/pkgs/curl/spkg-install.in:    if [ $MACOSX_VERSION -ge 16 ]; then
build/pkgs/curl/spkg-install.in:        echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang and --with-darwinssl."
build/pkgs/pari/spkg-install.in:MACOSX_VERSION=`uname -r | awk -F. '{print $1}'`
build/pkgs/pari/spkg-install.in:if [ $MACOSX_VERSION -ge 14 ]; then
build/pkgs/psutil/spkg-install.in:if [ "$UNAME" = "Darwin" ] && [ $MACOSX_VERSION -ge 16 ]; then
build/pkgs/psutil/spkg-install.in:    echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang."
build/pkgs/python3/spkg-build.in:    if [ $MACOSX_VERSION -ge 16 ]; then
build/pkgs/python3/spkg-build.in:        echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang."
build/pkgs/r/spkg-install.in:    if [ $MACOSX_VERSION -ge 14 ]; then
build/pkgs/r/spkg-install.in:        echo "OS X 10.$[$MACOSX_VERSION-4] Configuring R without aqua support."
build/pkgs/r/spkg-install.in:    if [ $MACOSX_VERSION -ge 16 ]; then
build/pkgs/r/spkg-install.in:        echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang."
```

It is defined in `src/bin/sage-env` (and also in `build/pkgs/pari/spkg-install.in`).


---

Comment by jhpalmieri created at 2021-01-05 00:50:58

New commits:


---

Comment by jhpalmieri created at 2021-01-05 00:50:58

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-01-06 02:17:54

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-01-06 02:18:14

Changing priority from major to critical.


---

Comment by jhpalmieri created at 2021-01-06 03:01:29

Great, thanks!


---

Comment by vbraun created at 2021-01-17 13:46:13

Resolution: fixed
