# Issue 33994: addition in InfinityRing gives wrong result

Issue created by migration from https://trac.sagemath.org/ticket/34231

Original creator: @maxale

Original creation time: 2022-07-27 15:49:50

CC:  tscrim

The following code shows an arithmetic bug in `InfinityRing` and broken commutativity:


```
R = InfinityRing
print( R(1) + R(0) )
print( R(0) + R(1) )
```


While `R(1) + R(0)` evaluates to `A positive finite number` (which is correct!), switching the arguments into `R(0) + R(1)` changes the evaluation to `Zero`, which is wrong.


---

Comment by @maxale created at 2022-07-27 15:53:53

Changing type from PLEASE CHANGE to defect.


---

Comment by @DaveWitteMorris created at 2022-07-28 02:31:44

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2022-07-28 02:31:44

Thanks for pointing out the bug. I think this will fix it.
----
New commits:


---

Comment by mkoeppe created at 2022-07-28 06:07:35

Looks like `CommutativeAdditiveSemigroups` forgets to provide a test method `_test_additive_commutativity` and `InfinityRing` forgets to do `TestSuite(InfinityRing).run()` in a doctest


---

Comment by tscrim created at 2022-07-29 02:12:45

Replying to [comment:5 mkoeppe]:
> Looks like `CommutativeAdditiveSemigroups` forgets to provide a test method `_test_additive_commutativity` and `InfinityRing` forgets to do `TestSuite(InfinityRing).run()` in a doctest

This file predates the `TestSuite`, so it is not surprising it is not in there. I am also a bit worried that because addition is only a partially defined operation and it has multiple element classes, the `TestSuite` run would not be guaranteed to work for most of the tests.

There are probably ways on improving this, but at least for now, this fixes a clear bug and tests against it. So positive review.


---

Comment by tscrim created at 2022-07-29 02:12:45

Changing status from needs_review to positive_review.


---

Comment by @DaveWitteMorris created at 2022-07-29 04:46:27

Thanks!


---

Comment by vbraun created at 2022-08-04 22:47:03

Resolution: fixed
