# Issue 18014: Equality comparison with 0 is not consistant

archive/issues_018014.json:
```json
{
    "body": "Assignee: @tscrim\n\nCC:  @nthiery @darijgr @nbruin @robertwb @fchapoton @videlec\n\nKeywords: zero\n\nCurrently we have the following in Sage:\n\n```\nsage: C = CombinatorialFreeModule(QQ, ['a','b'])\nsage: C.zero() == ZZ(0)\nTrue\nsage: C.zero() == QQ(0)\nFalse\nsage: M.zero()\n(0, 0, 0, 0)\nsage: M.zero() == ZZ(0)\nTrue\nsage: M.zero() == QQ(0)\nFalse\n```\n\nWhat I've been doing has been implementing a custom `__eq__` which checks explicitly for the other argument is 0 and then checking `self.is_zero`. However I'm thinking we should have a general fix with this as a special case, but we could do it just for these element classes.\n\nAdditionally this works when there a coercion from the base ring. I guess more generally do we want equality checking for when there is a conversion to the base ring? Thoughts?\n\nIssue created by migration from https://trac.sagemath.org/ticket/18251\n\n",
    "created_at": "2015-04-19T18:00:05Z",
    "labels": [
        "component: coercion",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Equality comparison with 0 is not consistant",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18014",
    "user": "https://github.com/tscrim"
}
```
Assignee: @tscrim

CC:  @nthiery @darijgr @nbruin @robertwb @fchapoton @videlec

Keywords: zero

Currently we have the following in Sage:

```
sage: C = CombinatorialFreeModule(QQ, ['a','b'])
sage: C.zero() == ZZ(0)
True
sage: C.zero() == QQ(0)
False
sage: M.zero()
(0, 0, 0, 0)
sage: M.zero() == ZZ(0)
True
sage: M.zero() == QQ(0)
False
```

What I've been doing has been implementing a custom `__eq__` which checks explicitly for the other argument is 0 and then checking `self.is_zero`. However I'm thinking we should have a general fix with this as a special case, but we could do it just for these element classes.

Additionally this works when there a coercion from the base ring. I guess more generally do we want equality checking for when there is a conversion to the base ring? Thoughts?

Issue created by migration from https://trac.sagemath.org/ticket/18251





---

archive/issue_comments_242097.json:
```json
{
    "body": "Part of the problem is that there is no coercion defined anyway:\n\n```\nsage: C = CombinatorialFreeModule(QQ, ['a','b'])\nsage: C.coerce(QQ(0))\nTypeError: no canonical coercion from Rational Field to Free module generated by {'a', 'b'} over Rational Field\n```\n\n\nThis makes sense, but it means that the problem is different from what I originally thought.",
    "created_at": "2016-07-29T14:31:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18014#issuecomment-242097",
    "user": "https://github.com/jdemeyer"
}
```

Part of the problem is that there is no coercion defined anyway:

```
sage: C = CombinatorialFreeModule(QQ, ['a','b'])
sage: C.coerce(QQ(0))
TypeError: no canonical coercion from Rational Field to Free module generated by {'a', 'b'} over Rational Field
```


This makes sense, but it means that the problem is different from what I originally thought.



---

archive/issue_comments_242098.json:
```json
{
    "body": "And the coercion model has an explicit special case for `ZZ(0)`.",
    "created_at": "2016-07-29T14:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18014#issuecomment-242098",
    "user": "https://github.com/jdemeyer"
}
```

And the coercion model has an explicit special case for `ZZ(0)`.



---

archive/issue_comments_242099.json:
```json
{
    "body": "I am going to attach my branch anyway, which does coercion but doesn't actually fix the problem.",
    "created_at": "2016-07-29T14:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18014#issuecomment-242099",
    "user": "https://github.com/jdemeyer"
}
```

I am going to attach my branch anyway, which does coercion but doesn't actually fix the problem.



---

archive/issue_comments_242100.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-07-29T14:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18014#issuecomment-242100",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_242101.json:
```json
{
    "body": "The current behavior of CFM agrees with that of the usual modules:\n\n```sage\nsage: V = QQ^3\nsage: V.coerce(ZZ(0))\n(0, 0, 0)\nsage: V.coerce(QQ(0))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: no canonical coercion from Rational Field to Vector space of dimension 3 over Rational Field\nsage: V.zero() == QQ(0)\nFalse\nsage: V.zero() == ZZ(0)\nTrue\n```\n\nI'm thinking a better and more general solution would be to special case the zero of the base ring or possibly just `QQ`.",
    "created_at": "2016-07-30T14:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18014#issuecomment-242101",
    "user": "https://github.com/tscrim"
}
```

The current behavior of CFM agrees with that of the usual modules:

```sage
sage: V = QQ^3
sage: V.coerce(ZZ(0))
(0, 0, 0)
sage: V.coerce(QQ(0))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: no canonical coercion from Rational Field to Vector space of dimension 3 over Rational Field
sage: V.zero() == QQ(0)
False
sage: V.zero() == ZZ(0)
True
```

I'm thinking a better and more general solution would be to special case the zero of the base ring or possibly just `QQ`.
