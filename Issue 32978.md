# Issue 32978: WeierstrassIsomorphism should coerce its inputs to a common parent

Issue created by migration from https://trac.sagemath.org/ticket/33215

Original creator: lorenz

Original creation time: 2022-01-22 04:56:19

CC:  cremona defeo

With Sage 9.5.rc3:

```
sage: E = EllipticCurve(GF(71^2),[5,5])
sage: from sage.schemes.elliptic_curves.weierstrass_morphism import WeierstrassIsomorphism
sage: iso = WeierstrassIsomorphism(E, (1,2,3,4))
sage: ~iso
---------------------------------------------------------------------------

# ...

~/prg/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py in __call__(self, EorP)
    237         if len(EorP) == 5:
    238             a1, a2, a3, a4, a6 = EorP
--> 239             a6 += r*(a4 + r*(a2 + r)) - t*(a3 + r*a1 + t)
    240             a4 += -s*a3 + 2*r*a2 - (t + r*s)*a1 + 3*r*r - 2*s*t
    241             a3 += r*a1 + t + t

# ...

TypeError: unsupported operand parent(s) for +: 'Finite Field in z2 of size 71^2' and 'Rational Field'
```



---

Comment by lorenz created at 2022-01-22 05:10:36

Changing status from new to needs_review.


---

Comment by tscrim created at 2022-02-27 00:55:20

LGTM.


---

Comment by tscrim created at 2022-02-27 00:55:20

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-03-01 21:30:55

Resolution: fixed
