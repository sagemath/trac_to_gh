# Issue 32978: WeierstrassIsomorphism should coerce its inputs to a common parent

archive/issues_032978.json:
```json
{
    "body": "CC:  @JohnCremona @defeo\n\nWith Sage 9.5.rc3:\n\n```\nsage: E = EllipticCurve(GF(71^2),[5,5])\nsage: from sage.schemes.elliptic_curves.weierstrass_morphism import WeierstrassIsomorphism\nsage: iso = WeierstrassIsomorphism(E, (1,2,3,4))\nsage: ~iso\n---------------------------------------------------------------------------\n\n# ...\n\n~/prg/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py in __call__(self, EorP)\n    237         if len(EorP) == 5:\n    238             a1, a2, a3, a4, a6 = EorP\n--> 239             a6 += r*(a4 + r*(a2 + r)) - t*(a3 + r*a1 + t)\n    240             a4 += -s*a3 + 2*r*a2 - (t + r*s)*a1 + 3*r*r - 2*s*t\n    241             a3 += r*a1 + t + t\n\n# ...\n\nTypeError: unsupported operand parent(s) for +: 'Finite Field in z2 of size 71^2' and 'Rational Field'\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33215\n\n",
    "created_at": "2022-01-22T04:56:19Z",
    "labels": [
        "component: elliptic curves",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "WeierstrassIsomorphism should coerce its inputs to a common parent",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32978",
    "user": "https://github.com/yyyyx4"
}
```
CC:  @JohnCremona @defeo

With Sage 9.5.rc3:

```
sage: E = EllipticCurve(GF(71^2),[5,5])
sage: from sage.schemes.elliptic_curves.weierstrass_morphism import WeierstrassIsomorphism
sage: iso = WeierstrassIsomorphism(E, (1,2,3,4))
sage: ~iso
---------------------------------------------------------------------------

# ...

~/prg/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py in __call__(self, EorP)
    237         if len(EorP) == 5:
    238             a1, a2, a3, a4, a6 = EorP
--> 239             a6 += r*(a4 + r*(a2 + r)) - t*(a3 + r*a1 + t)
    240             a4 += -s*a3 + 2*r*a2 - (t + r*s)*a1 + 3*r*r - 2*s*t
    241             a3 += r*a1 + t + t

# ...

TypeError: unsupported operand parent(s) for +: 'Finite Field in z2 of size 71^2' and 'Rational Field'
```


Issue created by migration from https://trac.sagemath.org/ticket/33215





---

archive/issue_comments_469738.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-22T05:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32978",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32978#issuecomment-469738",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_469739.json:
```json
{
    "body": "LGTM.",
    "created_at": "2022-02-27T00:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32978",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32978#issuecomment-469739",
    "user": "https://github.com/tscrim"
}
```

LGTM.



---

archive/issue_comments_469740.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-27T00:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32978",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32978#issuecomment-469740",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_469741.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-03-01T21:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32978",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32978#issuecomment-469741",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_029869.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-01T21:30:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32978",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32978#event-29869"
}
```
