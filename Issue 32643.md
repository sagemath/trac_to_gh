# Issue 32643: Replace Singular example with GAP in _get_shared_lib_path()

Issue created by migration from https://trac.sagemath.org/ticket/32880

Original creator: mjo

Original creation time: 2021-11-16 01:29:41

We still have a doctest for `_get_shared_lib_path()` that ensures it can find libSingular. However,

1. the premise behind `_get_shared_lib_path()` does not make sense; you can't just guess where a library comes from
2. as a result of (1), it's failing to find libSingular in some cases; but thankfully
3. we no longer care if it can find libSingular, because the full path to libSingular is contained in `LIBSINGULAR_PATH`

Instead we should have it look for libgap, because gap is still installed from an SPKG, and we can ensure that it's installed in just the right way for `_get_shared_lib_path()` to find it. Moreover, we actually call the function with "gap" as an argument, so there's that.

Reported in #29024#comment:170


---

Comment by mjo created at 2021-11-16 12:04:14

New commits:


---

Comment by mjo created at 2021-11-16 12:04:14

Changing status from new to needs_review.


---

Comment by tornaria created at 2021-11-22 17:30:14

Looks good to me. I took the patch for the sagemath package for void linux (wip) which uses system singular, and the failing doctest now passes.

See â€‹https://github.com/void-linux/void-packages/pull/34030


---

Comment by tornaria created at 2021-11-22 17:30:14

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-12-19 11:47:21

Resolution: fixed
