# Issue 27936: Implemented Is_Newton for Dynamical Systems

Issue created by migration from https://trac.sagemath.org/ticket/28173

Original creator: @jl0128

Original creation time: 2019-07-11 16:10:43

Keywords: SI2019

We want to implement a function that checks whether a dynamical system is conjugate to a map of the form `f(z) = z - p(z)/p'(z)` where p is a square free polynomial.


---

Comment by @jl0128 created at 2019-07-11 16:23:07

New commits:


---

Comment by @jl0128 created at 2019-07-11 16:23:07

Changing status from new to needs_review.


---

Comment by @Torrencem created at 2019-07-25 15:20:37

Changing status from needs_review to needs_work.


---

Comment by @Torrencem created at 2019-07-25 15:20:37

1. The NotImplementedError ("Degree one Newton maps are trivial.") should not start with a capital letter and shouldn't end with punctuation

2. Small note: 
`tuple([Npoly.derivative(z) == (z - N_aff[0]).denominator(), M])`
is much more clear as
`Npoly.derivative(z) == (z - N_aff[0]).denominator(), M`

3. This try except:


```
try:
    Fbar = self.change_ring(QQbar)
except ValueError:
    Fbar = self.change_ring(self.base_ring().embeddings(QQbar)[0])
```


is redundant. `self.change_ring(QQbar)` will pick an embedding if one isn't provided, not raise a ValueError (see `is_postcritically_finite()` for an example of this behavior)

4. This function should probably check to make sure `self` is a map from P1 to P1. Right now, `sigma_1 = self.sigma_invariants(1)` raises a `NotImplementedError`, but if that changes in the future, this function will break unexpectedly somewhere

5. One other very small thing: `.is_Newton(return_conjugation=True)` returns either the boolean `false`, or a tuple of `(true, matrix)`. Maybe it should return `(false, None)` on failure, so that unwrapping (like `is_n, mat = ....is_Newton(return_conjugation=True)`) still works (see `is_periodic(return_period=True)` for an example of a similar situation)

A more mathematical problem: Why does this function go to field extensions to find conjugations? e.g.:


```
A.<z> = AffineSpace(QQ, 1)
f = DynamicalSystem_affine([z - (z^3 + 2*z)/(3*z^2 + 2)])
M = Matrix([[1, 2], [2, 1]])
F = f.homogenize(1).conjugate(M)

bl, mat = F.is_Newton(return_conjugation=True)
print mat
print mat.parent()
# gives:
[-1/3*a    2/3]
[ 2/3*a   -1/3]

Full MatrixSpace of 2 by 2 dense matrices over Number Field in a with defining polynomial y^2 + 2
```


Shouldn't it be able to find the inverse of the conjugation by `M`, in this example?


---

Comment by @ksldr created at 2019-07-30 13:51:57

Changing status from needs_work to needs_review.


---

Comment by @ksldr created at 2019-07-30 13:51:57

New commits:


---

Comment by @Torrencem created at 2019-07-30 14:46:27

New commits:


---

Comment by @Torrencem created at 2019-07-30 14:47:01

The commit 1c55249 changes the return type as we talked about. How does this look?


---

Comment by gjorgenson created at 2019-07-30 19:39:23

This looks good to me, thanks!


---

Comment by atowsley created at 2019-11-18 20:43:51

Changing status from needs_review to positive_review.


---

Comment by atowsley created at 2019-11-18 20:43:51

Changing keywords from "SI2019" to "SI2019, sd104".


---

Comment by atowsley created at 2019-11-18 20:43:51

Resolved the merge conflict
----
New commits:


---

Comment by chapoton created at 2019-11-19 15:40:42

Is the removal of a full method an intended effect ? Just to be sure...


---

Comment by atowsley created at 2019-11-19 16:03:21

Yes, the method we removed is part of another ticket and shouldn't have been included here.


---

Comment by chapoton created at 2019-11-19 19:02:23

ok then. Next time, think about using "Return" and not "Returns"


---

Comment by vbraun created at 2019-11-30 00:01:29

Merge conflict


---

Comment by vbraun created at 2019-11-30 00:01:29

Changing status from positive_review to needs_work.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by tscrim created at 2020-04-14 23:27:10

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2020-04-14 23:27:10

I made a few small tweaks and changes, but mostly just resolved the merge conflict. Frédéric, can you give a quick check of my changes before setting back to a positive review?
----
New commits:


---

Comment by chapoton created at 2020-04-15 07:00:56

Looks good, but there remains one typo :

"if the maps has" should probably be "if the map has"


---

Comment by git created at 2020-04-15 08:16:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-04-15 08:16:38

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-04-15 08:16:38

Thank you. I am interpreting that as a positive review. Please revert if you disagree.


---

Comment by vbraun created at 2020-04-16 22:33:02

Resolution: fixed
