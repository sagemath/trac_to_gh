# Issue 28485: update constants for S-unit solver

Issue created by migration from https://trac.sagemath.org/ticket/28722

Original creator: mwest

Original creation time: 2019-11-12 04:25:16

CC:  malmskog

Keywords: s-unit

Working with Beth Malmskog and Chris Rasmussen to update the constants for solving the S-unit equation.


---

Comment by mwest created at 2019-11-13 18:11:42

New commits:


---

Comment by mwest created at 2019-11-13 18:11:42

Changing status from new to needs_review.


---

Comment by mwest created at 2019-11-13 20:02:45

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-11-18 02:48:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-11-24 08:18:08

I would suggest the follwing change, more efficient by not creating the list,

```diff
@@ -785,8 +788,8 @@ def reduction_step_complex_case(place,B0,G,g0,c7):
     #the case when the real part is 0 for all log(a_i)
 
     pl = refine_embedding(place)
-    if len([g for g in G if (pl(g).abs()-1).abs() > 2**(-place.codomain().precision())])  ==  0:
-
+    if not any((pl(g).abs() - 1).abs() > 2**(-place.codomain().precision())
+               for g in G):
```


**EDIT**:

and moreover compute the lowerbound outside of the loop would be much better !


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by git created at 2020-06-17 04:38:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-17 14:37:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-17 15:43:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mwest created at 2020-06-17 16:09:36

Changing status from needs_work to needs_review.


---

Comment by mwest created at 2020-06-17 16:09:36

Much work has been done since the last commit to update the bounds to match more recent work by K. Yu as suggested by a reviewer of our paper. The arXiv variant of our paper is available here: https://arxiv.org/abs/1903.00977 .

This significantly reduced the pre-LLL bounds but ultimately does not affect the post-LLL bounds.


---

Comment by mwest created at 2020-06-17 21:41:34

Something wrong with the docbuild, will work on it.


---

Comment by mwest created at 2020-06-17 21:41:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-06-18 14:40:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-18 14:51:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mwest created at 2020-06-18 14:52:01

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2020-06-19 19:27:49

wrong diff

```diff
-    # We build a second dictionary of dictionaries.
+    # We build a second dictionary of dictiories.
```



---

Comment by chapoton created at 2020-06-20 07:02:42

some doctests are failing, see patchbot report

and the patchbot also suggests to remove some unused variables and imports, and to use `Return` instead of `Returns`


---

Comment by chapoton created at 2020-06-20 07:02:42

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-06-23 03:54:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 03:57:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 15:34:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 15:46:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 15:48:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 17:50:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mwest created at 2020-07-01 15:23:17

Changing status from needs_work to needs_review.


---

Comment by mwest created at 2020-07-01 15:23:17

I believe the patchbot issues have all been addressed. Let's give this another shot.


---

Comment by chapoton created at 2020-07-01 19:11:53

badly broken (syntax error)


---

Comment by git created at 2020-07-01 20:47:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-07-02 06:53:15

this is missing underscore after reference

```
+    Return the constant `c_3` from [AKMRVW].
```

same here:

```
+    Return the constant Omega' appearing in [AKMRVW].
```

and same here

```
+        The constant ``c13``  in Section 5, [AKMRVW]
```


Please check elsewhere.

The following should have a double ::

```
+    EXAMPLES:
+
+        sage: from sage.rings.number_field.S_unit_solver import mus, Omega_prime
```


This could be `if not npi:`

```
+    if len(npi) == 0:
```



You suppressed empty lines between functions. Please put them back. Outside a class, functions must be separated by 2 empty lines. Inside classes, by just one empty line. This is pep8 official recommandation, that we want to follow.

The typo is still there

```
-    # We build a second dictionary of dictionaries.
+    # We build a second dictionary of dictiories.
```


Another typo here:

```
+        #We narrow down the list unitl only one value rmains
```


Note that pep8 also suggest that comments should look like
`  # this is a comment`
rather than
`#this is a comment`

One spurious dot here:

```
+    See [Sma1998]_., [AKMRVW]_.
```



---

Comment by chapoton created at 2020-07-02 06:57:31

And here False should have the same style as True

```
+    ``True`` if (1.15) is satisfied, otherwise `False`.
```


Some "Return" first lines are missing a final dot.

Instead of "var", I suggest to use "polygen" to avoid using any symbolic stuff.


---

Comment by git created at 2020-07-02 15:03:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mwest created at 2020-07-02 15:06:03

Thank you for taking such a close look at the code.  I will continue to update per pep8. I will also make sure my collaborators have the most recent version.


---

Comment by mwest created at 2020-07-02 15:09:26

WRT using `polygen` instead of `var`, we tried that and apparently there were problems in some test cases.


---

Comment by git created at 2020-07-02 19:50:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-08-15 22:12:43

author name


---

Comment by mkoeppe created at 2020-08-15 22:12:43

Changing status from needs_review to needs_work.


---

Comment by mwest created at 2020-08-17 15:48:05

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2020-08-29 07:02:26

ok, let us keep more enhancements for another ticket


---

Comment by chapoton created at 2020-08-29 07:02:26

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2020-09-01 10:40:32

Would the authors like to comment on a claim by Benjamin Matschke yesterday, in a talk at Banff (https://www.birs.ca/events/2020/5-day-workshops/20w5005/schedule) that your code failed to solve x+y=1 over Q with S={2,3,5} in 30 days using 7G memory!!!  I have queried this with Matschke.  I have Angelos's very old (2015) Sage code for this which solves that example in a fraction of a second (or did so after a small amount of python3 conversion).  Even {2,3,5,7,11} only took 17s on my laptop.  I have not tried the code on this ticket.


---

Comment by cremona created at 2020-09-01 11:00:49

Also:  is the case K=QQ not implemented?

Also:

```
sage: QI.<i> = QuadraticField(-1)
sage: solve_S_unit_equation(QI,QI(6).support())
```

raises an error.


---

Comment by vbraun created at 2020-09-06 21:51:10

Resolution: fixed
