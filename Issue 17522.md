# Issue 17522: convenience class symbolic ExpressionTreeWalker(Converter)

Issue created by migration from https://trac.sagemath.org/ticket/17759

Original creator: rws

Original creation time: 2015-02-10 14:29:26

CC:  kcrisman niles

This class can already be used as base class for `SubstituteFunction` but is intended also for other uses.

```
sage: from sage.symbolic.expression_conversions import ExpressionTreeWalker
sage: from sage.symbolic.random_tests import random_expr
sage: foo = random_expr(20, nvars=2)
sage: s = ExpressionTreeWalker(foo)
sage: bool(s() == foo)
True
```



---

Comment by rws created at 2015-02-10 14:32:51

Changing status from new to needs_review.


---

Comment by rws created at 2015-02-10 14:32:51

New commits:


---

Comment by rws created at 2015-02-26 14:06:48

OK, this is not really a tree walker but a deep copier, i.e., function objects are called again. This misses possible hold arguments that were given but are lost, see #17849. So let's implement a real tree walker in this ticket that only replaces specific operators but leaves the rest of the tree as is.

EDIT:
 * http://www.ginac.de/tutorial/#Visitors-and-tree-traversal
 * http://www.ginac.de/tutorial/#Applying-a-function-on-subexpressions


---

Comment by rws created at 2015-02-28 16:06:01

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-02-28 16:27:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2015-02-28 16:28:17

Changing status from needs_work to needs_review.


---

Comment by rws created at 2015-03-30 06:44:59

Passes all tests in a 6.6rc1 patchbot run (ignore long startup, docbuild plugins).


---

Comment by rws created at 2015-04-20 07:59:51

Now some patchbot fails because of #18255.


---

Comment by rws created at 2015-05-25 06:55:23

New commits:


---

Comment by mmezzarobba created at 2015-05-25 10:07:33

Changing status from needs_review to positive_review.


---

Comment by mmezzarobba created at 2015-05-25 10:07:33

Lgtm, though I don't know that code too well... (and the commit history is a little bit confusing `:-)`)


---

Comment by rws created at 2015-05-25 12:46:53

Replying to [comment:17 mmezzarobba]:
> Lgtm, though I don't know that code too well... (and the commit history is a little bit confusing `:-)`)
Changing the branch should make earlier commits disappear, at least in the commit log. Do we have a trac bug ticket for this?

But thanks for the review!


---

Comment by rws created at 2015-05-25 13:04:15

Ah no, my mistake, I didn't squash it all, sorry.


---

Comment by vbraun created at 2015-05-25 22:49:44

Resolution: fixed
