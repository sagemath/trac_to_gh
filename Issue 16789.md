# Issue 16789: Compare PARI objects using cmp_universal() instead of strcmp()

Issue created by migration from Trac.

Original creator: pbruin

Original creation time: 2014-09-22 14:19:12

CC:  jdemeyer

After the separate implementations of `__cmp__()` and `__richcmp__()` for PARI objects in #16127, it is a small step to replace the string comparison in `__cmp__()` by the built-in PARI function `cmp_universal()`.  This is faster, mathematically no more or less meaningful, and (unlike string comparison) gives a total ordering on the set of PARI objects up to the "indistinguishability" relation (`gidentical()`).


---

Comment by pbruin created at 2014-09-22 15:21:29

Changing keywords from "" to "pari comparison".


---

Comment by pbruin created at 2014-09-22 15:21:29

Changing status from new to needs_review.


---

Comment by pbruin created at 2014-09-22 15:33:16

There is only one slightly strange thing in all of this, namely the following:

```diff
--- a/src/sage/rings/number_field/splitting_field.py
+++ b/src/sage/rings/number_field/splitting_field.py
`@``@` -87,7 +87,7 `@``@` class SplittingData:
     delta = self.dm.__cmp__(other.dm)
     if delta:
         return delta
- return self.pol.__cmp__(other.pol)
+ return cmp(str(self.pol), str(other.pol))
 
     def poldegree(self):
         """
 
```

I had to resort to string comparison because there is one doctest (in `sage/schemes/elliptic_curves/ell_number_field.py`) that times out otherwise:

```
sage: E = EllipticCurve('27a1')
sage: K.<b> = E.division_field(7); K  # long time (8s on sage.math, 2014)
```

I wonder if we are just lucky that this terminates in reasonable time with the current sorting of polynomials, or if there is some PARI bug that potentially causes a very long time or infinite loop in the splitting field computation.


---

Comment by jdemeyer created at 2014-09-25 09:29:52

Amended commit message.
----
New commits:


---

Comment by git created at 2014-09-25 11:27:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-09-25 11:34:36

In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?

Thanks for adding the warning about `cmp()`; I had planned to do that, but forgot.


---

Comment by jdemeyer created at 2014-09-25 11:38:11

Replying to [comment:7 pbruin]:
> In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?
Doesn't matter, `self.poldegree()` is defined to be `self.pol.poldegree()`.


---

Comment by pbruin created at 2014-09-25 11:42:39

Replying to [comment:8 jdemeyer]:
> Replying to [comment:7 pbruin]:
> > In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?
> Doesn't matter, `self.poldegree()` is defined to be `self.pol.poldegree()`.
I see, that had escaped me.


---

Comment by jdemeyer created at 2014-09-25 11:42:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-09-27 12:57:14

Resolution: fixed
