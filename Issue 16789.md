# Issue 16789: Compare PARI objects using cmp_universal() instead of strcmp()

archive/issues_016789.json:
```json
{
    "body": "CC:  @jdemeyer\n\nAfter the separate implementations of `__cmp__()` and `__richcmp__()` for PARI objects in #16127, it is a small step to replace the string comparison in `__cmp__()` by the built-in PARI function `cmp_universal()`.  This is faster, mathematically no more or less meaningful, and (unlike string comparison) gives a total ordering on the set of PARI objects up to the \"indistinguishability\" relation (`gidentical()`).\n\nIssue created by migration from https://trac.sagemath.org/ticket/17026\n\n",
    "created_at": "2014-09-22T14:19:12Z",
    "labels": [
        "component: interfaces",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Compare PARI objects using cmp_universal() instead of strcmp()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16789",
    "user": "https://github.com/pjbruin"
}
```
CC:  @jdemeyer

After the separate implementations of `__cmp__()` and `__richcmp__()` for PARI objects in #16127, it is a small step to replace the string comparison in `__cmp__()` by the built-in PARI function `cmp_universal()`.  This is faster, mathematically no more or less meaningful, and (unlike string comparison) gives a total ordering on the set of PARI objects up to the "indistinguishability" relation (`gidentical()`).

Issue created by migration from https://trac.sagemath.org/ticket/17026





---

archive/issue_comments_221806.json:
```json
{
    "body": "Changing keywords from \"\" to \"pari comparison\".",
    "created_at": "2014-09-22T15:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221806",
    "user": "https://github.com/pjbruin"
}
```

Changing keywords from "" to "pari comparison".



---

archive/issue_comments_221807.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-22T15:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221807",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_221808.json:
```json
{
    "body": "There is only one slightly strange thing in all of this, namely the following:\n\n```diff\n--- a/src/sage/rings/number_field/splitting_field.py\n+++ b/src/sage/rings/number_field/splitting_field.py\n@@ -87,7 +87,7 @@ class SplittingData:\n     delta = self.dm.__cmp__(other.dm)\n     if delta:\n         return delta\n- return self.pol.__cmp__(other.pol)\n+ return cmp(str(self.pol), str(other.pol))\n \n     def poldegree(self):\n         \"\"\"\n \n```\n\nI had to resort to string comparison because there is one doctest (in `sage/schemes/elliptic_curves/ell_number_field.py`) that times out otherwise:\n\n```\nsage: E = EllipticCurve('27a1')\nsage: K.<b> = E.division_field(7); K  # long time (8s on sage.math, 2014)\n```\n\nI wonder if we are just lucky that this terminates in reasonable time with the current sorting of polynomials, or if there is some PARI bug that potentially causes a very long time or infinite loop in the splitting field computation.",
    "created_at": "2014-09-22T15:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221808",
    "user": "https://github.com/pjbruin"
}
```

There is only one slightly strange thing in all of this, namely the following:

```diff
--- a/src/sage/rings/number_field/splitting_field.py
+++ b/src/sage/rings/number_field/splitting_field.py
@@ -87,7 +87,7 @@ class SplittingData:
     delta = self.dm.__cmp__(other.dm)
     if delta:
         return delta
- return self.pol.__cmp__(other.pol)
+ return cmp(str(self.pol), str(other.pol))
 
     def poldegree(self):
         """
 
```

I had to resort to string comparison because there is one doctest (in `sage/schemes/elliptic_curves/ell_number_field.py`) that times out otherwise:

```
sage: E = EllipticCurve('27a1')
sage: K.<b> = E.division_field(7); K  # long time (8s on sage.math, 2014)
```

I wonder if we are just lucky that this terminates in reasonable time with the current sorting of polynomials, or if there is some PARI bug that potentially causes a very long time or infinite loop in the splitting field computation.



---

archive/issue_comments_221809.json:
```json
{
    "body": "Amended commit message.\n----\nNew commits:",
    "created_at": "2014-09-25T09:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221809",
    "user": "https://github.com/jdemeyer"
}
```

Amended commit message.
----
New commits:



---

archive/issue_comments_221810.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-25T11:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221810",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221811.json:
```json
{
    "body": "In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?\n\nThanks for adding the warning about `cmp()`; I had planned to do that, but forgot.",
    "created_at": "2014-09-25T11:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221811",
    "user": "https://github.com/pjbruin"
}
```

In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?

Thanks for adding the warning about `cmp()`; I had planned to do that, but forgot.



---

archive/issue_comments_221812.json:
```json
{
    "body": "Replying to [comment:7 pbruin]:\n> In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?\nDoesn't matter, `self.poldegree()` is defined to be `self.pol.poldegree()`.",
    "created_at": "2014-09-25T11:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221812",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:7 pbruin]:
> In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?
Doesn't matter, `self.poldegree()` is defined to be `self.pol.poldegree()`.



---

archive/issue_comments_221813.json:
```json
{
    "body": "Replying to [comment:8 jdemeyer]:\n> Replying to [comment:7 pbruin]:\n> > In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?\n> Doesn't matter, `self.poldegree()` is defined to be `self.pol.poldegree()`.\nI see, that had escaped me.",
    "created_at": "2014-09-25T11:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221813",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:8 jdemeyer]:
> Replying to [comment:7 pbruin]:
> > In `key()`, shouldn't `self.poldegree()` be `self.pol.poldegree()`?
> Doesn't matter, `self.poldegree()` is defined to be `self.pol.poldegree()`.
I see, that had escaped me.



---

archive/issue_comments_221814.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-25T11:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221814",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049553.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-27T12:57:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16789#event-49553"
}
```



---

archive/issue_comments_221815.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-27T12:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16789#issuecomment-221815",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
