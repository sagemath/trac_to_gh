# Issue 28791: bugs for binary quadratic forms whose discriminant is a square

archive/issues_028791.json:
```json
{
    "body": "CC:  sbrandhorst\n\nKeywords: binary quadratic form\n\nTicket #28989 fixes bugs for quadratic forms whose discriminant is positive, but not a square. This ticket addresses the remaining case where the discriminant is a square. Symptoms of the bugs include:\n\nTwo forms may be properly equivalent, but not equivalent, and equivalence is not reflexive:\n\n```\nsage: Q = BinaryQF(0, 2, 0)\nsage: Q.discriminant()\n4\nsage: Q.is_equivalent(Q, proper=True)\nTrue\nsage: Q.is_equivalent(Q, proper=False)\nFalse\n```\n\n\nThe forms `-4*x^2 + 10*x*y`, `-2*x^2 + 10*x*y`, ` 10*x*y`, `2*x^2 + 10*x*y`, `4*x^2 + 10*x*y`, and `5*x^2 + 10*x*y` are not primitive (i.e., the gcd of the coefficients is not 1), but they appear in a list of primitive forms:\n\n```\nsage: BinaryQF_reduced_representatives(10^2, primitive_only=True)\n[-4*x^2 + 10*x*y,\n -3*x^2 + 10*x*y,\n -2*x^2 + 10*x*y,\n -x^2 + 10*x*y,\n 10*x*y,\n x^2 + 10*x*y,\n 2*x^2 + 10*x*y,\n 3*x^2 + 10*x*y,\n 4*x^2 + 10*x*y,\n 5*x^2 + 10*x*y]\n```\n\n\nI will upload a PR soon.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29028\n\n",
    "created_at": "2020-01-16T18:54:35Z",
    "labels": [
        "number theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "bugs for binary quadratic forms whose discriminant is a square",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28791",
    "user": "@DaveWitteMorris"
}
```
CC:  sbrandhorst

Keywords: binary quadratic form

Ticket #28989 fixes bugs for quadratic forms whose discriminant is positive, but not a square. This ticket addresses the remaining case where the discriminant is a square. Symptoms of the bugs include:

Two forms may be properly equivalent, but not equivalent, and equivalence is not reflexive:

```
sage: Q = BinaryQF(0, 2, 0)
sage: Q.discriminant()
4
sage: Q.is_equivalent(Q, proper=True)
True
sage: Q.is_equivalent(Q, proper=False)
False
```


The forms `-4*x^2 + 10*x*y`, `-2*x^2 + 10*x*y`, ` 10*x*y`, `2*x^2 + 10*x*y`, `4*x^2 + 10*x*y`, and `5*x^2 + 10*x*y` are not primitive (i.e., the gcd of the coefficients is not 1), but they appear in a list of primitive forms:

```
sage: BinaryQF_reduced_representatives(10^2, primitive_only=True)
[-4*x^2 + 10*x*y,
 -3*x^2 + 10*x*y,
 -2*x^2 + 10*x*y,
 -x^2 + 10*x*y,
 10*x*y,
 x^2 + 10*x*y,
 2*x^2 + 10*x*y,
 3*x^2 + 10*x*y,
 4*x^2 + 10*x*y,
 5*x^2 + 10*x*y]
```


I will upload a PR soon.

Issue created by migration from https://trac.sagemath.org/ticket/29028





---

archive/issue_comments_406860.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-01-16T19:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406860",
    "user": "@DaveWitteMorris"
}
```

New commits:



---

archive/issue_comments_406861.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-16T19:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406861",
    "user": "@DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_406862.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-17T18:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406862",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_406863.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-22T03:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406863",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_406864.json:
```json
{
    "body": "Merged in #28989 again, to fix a merge conflict caused by the latest changes there.",
    "created_at": "2020-01-22T03:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406864",
    "user": "@DaveWitteMorris"
}
```

Merged in #28989 again, to fix a merge conflict caused by the latest changes there.



---

archive/issue_comments_406865.json:
```json
{
    "body": "Two little changes:\n\n```diff\n         We check that the first part of :trac:`29028` is fixed::\n+\n             sage: Q = BinaryQF(0, 2, 0)\n             sage: Q.discriminant()\n             4\n```\n\n\n```diff\n     Test another part of :trac:`29028`::\n+\n         sage: BinaryQF_reduced_representatives(10^2, proper=False, primitive_only=False)\n```\n\nas you need a blankline after the `::` line.",
    "created_at": "2020-01-29T05:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406865",
    "user": "tscrim"
}
```

Two little changes:

```diff
         We check that the first part of :trac:`29028` is fixed::
+
             sage: Q = BinaryQF(0, 2, 0)
             sage: Q.discriminant()
             4
```


```diff
     Test another part of :trac:`29028`::
+
         sage: BinaryQF_reduced_representatives(10^2, proper=False, primitive_only=False)
```

as you need a blankline after the `::` line.



---

archive/issue_comments_406866.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-29T21:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406866",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_406867.json:
```json
{
    "body": "Thanks for the corrections.",
    "created_at": "2020-01-29T21:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406867",
    "user": "@DaveWitteMorris"
}
```

Thanks for the corrections.



---

archive/issue_comments_406868.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-29T23:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406868",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_406869.json:
```json
{
    "body": "Thanks. LGTM.",
    "created_at": "2020-01-29T23:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406869",
    "user": "tscrim"
}
```

Thanks. LGTM.



---

archive/issue_comments_406870.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-31T23:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28791#issuecomment-406870",
    "user": "vbraun"
}
```

Resolution: fixed
