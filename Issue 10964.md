# Issue 10964: Add BMSS algorithm for isogenies of elliptic curves

archive/issues_010964.json:
```json
{
    "body": "Assignee: @JohnCremona\n\nCC:  @categorie jpflori @pjbruin\n\nKeywords: isogenies\n\nAdd the algorithm by Bostain, Morain, Salvy and Schost for normalized cyclic isogenies in characteristic 0 or large enough.\n\nReferences:\n\n[BMSS08] Alin Bostan, Fran\u00e7ois Morain, Bruno Salvy, and \u00c9ric Schost, Fast algorithms for computing isogenies between elliptic curves, Mathematics of Computation 77 (2008), 1755\u20131778.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11095\n\n",
    "created_at": "2011-03-30T13:33:43Z",
    "labels": [
        "component: elliptic curves",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Add BMSS algorithm for isogenies of elliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10964",
    "user": "https://github.com/defeo"
}
```
Assignee: @JohnCremona

CC:  @categorie jpflori @pjbruin

Keywords: isogenies

Add the algorithm by Bostain, Morain, Salvy and Schost for normalized cyclic isogenies in characteristic 0 or large enough.

References:

[BMSS08] Alin Bostan, François Morain, Bruno Salvy, and Éric Schost, Fast algorithms for computing isogenies between elliptic curves, Mathematics of Computation 77 (2008), 1755–1778.

Issue created by migration from https://trac.sagemath.org/ticket/11095





---

archive/issue_comments_118337.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-03T16:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118337",
    "user": "https://github.com/defeo"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_118338.json:
```json
{
    "body": "Besides implementing BMSS, I cleaned a bit `ell_curve_isogeny`, moving the algorithms that do not work in any characteristic to a new module `ell_isogeny_char_zero`. In my view, only the `EllipticCurveIsogeny` class and V\u00e9lu/Kohel formulae should remain in ell_curve_isogeny` in the end.\n\nBMSS runs significantly faster than Stark's, and works for slightly larger characteristics, I thus set it as the default choice. I haven't produced any serious benchmarks, but I will if the reviewers ask me to.",
    "created_at": "2011-05-03T16:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118338",
    "user": "https://github.com/defeo"
}
```

Besides implementing BMSS, I cleaned a bit `ell_curve_isogeny`, moving the algorithms that do not work in any characteristic to a new module `ell_isogeny_char_zero`. In my view, only the `EllipticCurveIsogeny` class and Vélu/Kohel formulae should remain in ell_curve_isogeny` in the end.

BMSS runs significantly faster than Stark's, and works for slightly larger characteristics, I thus set it as the default choice. I haven't produced any serious benchmarks, but I will if the reviewers ask me to.



---

archive/issue_comments_118339.json:
```json
{
    "body": "I like this a lot, and it is a good idea to start moving stuff out of the huge isogenies file.  I am planning to do the same for the isogenies of small degree code --currently the genus 0 prime degrees 2,3,5,7,13 and the others which can occur over Q.  Kimi Tsukazaki and I are working on extending that to all the ell for which `X_0(ell)^+` has genus 0.\n\nI tested this against 4.7.rc1 and had some doctest failures.  I expect these will be easy to fix.\n\n```\nsage -t  sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\n// ** nInitExp failed: using Z/2^2\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 165:\n    sage: isogeny_Stark(E1pr, E2pr, 11)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_2[7]>\", line 1, in <module>\n        isogeny_Stark(E1pr, E2pr, Integer(11))###line 165:\n    sage: isogeny_Stark(E1pr, E2pr, 11)\n    NameError: name 'E1pr' is not defined\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 334:\n    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[23]>\", line 1, in <module>\n        kernel = isogeny_BMSS(E1pr, E2pr, Integer(9))###line 334:\n    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)\n    NameError: name 'E1pr' is not defined\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 335:\n    sage: kernel\nExpected:\n    x^8 + 36*x^7 + 95*x^6 + 84*x^4 + 16*x^3 + 70*x^2 + 12*x + 78\nGot:\n    x^4 + 14*x^3 + x^2 + 34*x + 21\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 337:\n    sage: kernel.is_square()\nExpected:\n    False\nGot:\n    True\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 339:\n    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm=\"bmss\")\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: The two curves are not linked by a normalized isogeny of degree 9\nGot:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[26]>\", line 1, in <module>\n        isogeny_kernel(E1pr, E2pr, Integer(9), algorithm=\"bmss\")###line 339:\n    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm=\"bmss\")\n    NameError: name 'E1pr' is not defined\n**********************************************************************\n2 items had failures:\n   1 of  22 in __main__.example_2\n   4 of  28 in __main__.example_3\n***Test Failed*** 5 failures.\nFor whitespace errors, see the file /home/jec/.sage//tmp/.doctest_ell_isogeny_char_zero.py\n\t [3.8 s]\n```",
    "created_at": "2011-05-03T17:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118339",
    "user": "https://github.com/JohnCremona"
}
```

I like this a lot, and it is a good idea to start moving stuff out of the huge isogenies file.  I am planning to do the same for the isogenies of small degree code --currently the genus 0 prime degrees 2,3,5,7,13 and the others which can occur over Q.  Kimi Tsukazaki and I are working on extending that to all the ell for which `X_0(ell)^+` has genus 0.

I tested this against 4.7.rc1 and had some doctest failures.  I expect these will be easy to fix.

```
sage -t  sage/schemes/elliptic_curves/ell_isogeny_char_zero.py
// ** nInitExp failed: using Z/2^2
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 165:
    sage: isogeny_Stark(E1pr, E2pr, 11)
Exception raised:
    Traceback (most recent call last):
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_2[7]>", line 1, in <module>
        isogeny_Stark(E1pr, E2pr, Integer(11))###line 165:
    sage: isogeny_Stark(E1pr, E2pr, 11)
    NameError: name 'E1pr' is not defined
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 334:
    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)
Exception raised:
    Traceback (most recent call last):
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[23]>", line 1, in <module>
        kernel = isogeny_BMSS(E1pr, E2pr, Integer(9))###line 334:
    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)
    NameError: name 'E1pr' is not defined
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 335:
    sage: kernel
Expected:
    x^8 + 36*x^7 + 95*x^6 + 84*x^4 + 16*x^3 + 70*x^2 + 12*x + 78
Got:
    x^4 + 14*x^3 + x^2 + 34*x + 21
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 337:
    sage: kernel.is_square()
Expected:
    False
Got:
    True
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 339:
    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm="bmss")
Expected:
    Traceback (most recent call last):
    ...
    ValueError: The two curves are not linked by a normalized isogeny of degree 9
Got:
    Traceback (most recent call last):
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[26]>", line 1, in <module>
        isogeny_kernel(E1pr, E2pr, Integer(9), algorithm="bmss")###line 339:
    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm="bmss")
    NameError: name 'E1pr' is not defined
**********************************************************************
2 items had failures:
   1 of  22 in __main__.example_2
   4 of  28 in __main__.example_3
***Test Failed*** 5 failures.
For whitespace errors, see the file /home/jec/.sage//tmp/.doctest_ell_isogeny_char_zero.py
	 [3.8 s]
```



---

archive/issue_events_028767.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-05-03T17:25:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28767"
}
```



---

archive/issue_comments_118340.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-03T17:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118340",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_118341.json:
```json
{
    "body": "Ooops! I had made some last minute change to the doctest and must have tested the wrong file afterwards. The new patch passes all tests, including -testall -long",
    "created_at": "2011-05-03T19:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118341",
    "user": "https://github.com/defeo"
}
```

Ooops! I had made some last minute change to the doctest and must have tested the wrong file afterwards. The new patch passes all tests, including -testall -long



---

archive/issue_comments_118342.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-03T19:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118342",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_118343.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-13T13:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118343",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_118344.json:
```json
{
    "body": "I realized that my code for BMSS fails when the isogeny has strictly positive valuation at x, which happens for example when the origin is a point of order 2 and the isogeny has odd degree as in the code below\n\n```\nsage: from sage.schemes.elliptic_curves.ell_isogeny_char_zero import *\nsage: E = EllipticCurve([-1,0])\nsage: E2 = EllipticCurve([-3^4,0])\nsage: E.isogeny(kernel=None, codomain=E2, degree=9)\nTraceback (most recent call last)\n...\nValueError: The two curves are not linked by a normalized isogeny of degree 9\nsage: isogeny_Stark(E,E2,9)\nx^8 - 4*x^6 + 10/3*x^4 + 4/3*x^2 + 1/9\nsage: isogeny_BMSS(E,E2,9)\nx^7 - 4*x^5 + 10/3*x^3 + 4/3*x\n```\n\nThe fix is easy, I hope I'll have time to send a revised patch next week.",
    "created_at": "2011-05-13T13:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118344",
    "user": "https://github.com/defeo"
}
```

I realized that my code for BMSS fails when the isogeny has strictly positive valuation at x, which happens for example when the origin is a point of order 2 and the isogeny has odd degree as in the code below

```
sage: from sage.schemes.elliptic_curves.ell_isogeny_char_zero import *
sage: E = EllipticCurve([-1,0])
sage: E2 = EllipticCurve([-3^4,0])
sage: E.isogeny(kernel=None, codomain=E2, degree=9)
Traceback (most recent call last)
...
ValueError: The two curves are not linked by a normalized isogeny of degree 9
sage: isogeny_Stark(E,E2,9)
x^8 - 4*x^6 + 10/3*x^4 + 4/3*x^2 + 1/9
sage: isogeny_BMSS(E,E2,9)
x^7 - 4*x^5 + 10/3*x^3 + 4/3*x
```

The fix is easy, I hope I'll have time to send a revised patch next week.



---

archive/issue_comments_118345.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-06-10T17:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118345",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_118346.json:
```json
{
    "body": "Attachment [trac_11095_isogenies_char_0.patch](tarball://root/attachments/some-uuid/ticket11095/trac_11095_isogenies_char_0.patch) by @defeo created at 2011-06-10 17:58:43\n\nFinally, here's the easy fix! I hope it will be ok now.",
    "created_at": "2011-06-10T17:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118346",
    "user": "https://github.com/defeo"
}
```

Attachment [trac_11095_isogenies_char_0.patch](tarball://root/attachments/some-uuid/ticket11095/trac_11095_isogenies_char_0.patch) by @defeo created at 2011-06-10 17:58:43

Finally, here's the easy fix! I hope it will be ok now.



---

archive/issue_comments_118347.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-01T16:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118347",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_118348.json:
```json
{
    "body": "On sage 4.7.1.alpha3 with this patch:\n\n```\nsage -t -long devel/sage/sage/interfaces/ecm.py\n*** *** Error: TIMED OUT! PROCESS KILLED! *** ***\n\n         [1800.5 s]\n```",
    "created_at": "2011-07-01T16:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118348",
    "user": "https://github.com/mstreng"
}
```

On sage 4.7.1.alpha3 with this patch:

```
sage -t -long devel/sage/sage/interfaces/ecm.py
*** *** Error: TIMED OUT! PROCESS KILLED! *** ***

         [1800.5 s]
```



---

archive/issue_comments_118349.json:
```json
{
    "body": "Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.\n\nI tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?",
    "created_at": "2011-07-06T21:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118349",
    "user": "https://github.com/defeo"
}
```

Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.

I tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?



---

archive/issue_comments_118350.json:
```json
{
    "body": "Replying to [comment:9 defeo]:\n> Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.\n> \n> I tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?\n\n\nI'll see if I can reproduce it, and will let you know tomorrow.",
    "created_at": "2011-07-06T21:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118350",
    "user": "https://github.com/mstreng"
}
```

Replying to [comment:9 defeo]:
> Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.
> 
> I tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?


I'll see if I can reproduce it, and will let you know tomorrow.



---

archive/issue_comments_118351.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-06T21:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118351",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_118352.json:
```json
{
    "body": "Replying to [comment:10 mstreng]:\n> I'll see if I can reproduce it, and will let you know tomorrow.\n\n\nThe problem vanished. Sorry for the trouble.",
    "created_at": "2011-07-06T21:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118352",
    "user": "https://github.com/mstreng"
}
```

Replying to [comment:10 mstreng]:
> I'll see if I can reproduce it, and will let you know tomorrow.


The problem vanished. Sorry for the trouble.



---

archive/issue_comments_118353.json:
```json
{
    "body": "Added depracation warnings, as suggested by Marco. Apply second patch only (is this going to confuse the patchbot?).",
    "created_at": "2011-07-11T00:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118353",
    "user": "https://github.com/defeo"
}
```

Added depracation warnings, as suggested by Marco. Apply second patch only (is this going to confuse the patchbot?).



---

archive/issue_comments_118354.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-27T16:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118354",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_118355.json:
```json
{
    "body": "1. I'm confused by the `ValueErrors` raised by `isogeny_kernel`.\n\n```\nValueError, \"The two curves are not linked by a normalized isogeny of degree %s\"%ell\n```\n\nFirst of all, the comment \"or a non-sense polynomial if no such isogeny exists\" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?\n\nSecond, the test \"`ker_poly.degree() != ell-1`\" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)\n\nThird, why is the test \"`not check`\" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?\n\n2. The word \"separable\" seems to be missing from the `ValueErrors`\n\n3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals \"Stark\", \"stark\", \"Starks\", or \"starks\", before detecting that it actually equals \"BMSS\". It may speed things up by epsilon to put the most-used case first. (this is not the reason for \"needs work\")\n\nps. The patch bot seems to have understood that you only want the second patch.",
    "created_at": "2011-07-27T16:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118355",
    "user": "https://github.com/mstreng"
}
```

1. I'm confused by the `ValueErrors` raised by `isogeny_kernel`.

```
ValueError, "The two curves are not linked by a normalized isogeny of degree %s"%ell
```

First of all, the comment "or a non-sense polynomial if no such isogeny exists" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?

Second, the test "`ker_poly.degree() != ell-1`" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)

Third, why is the test "`not check`" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?

2. The word "separable" seems to be missing from the `ValueErrors`

3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals "Stark", "stark", "Starks", or "starks", before detecting that it actually equals "BMSS". It may speed things up by epsilon to put the most-used case first. (this is not the reason for "needs work")

ps. The patch bot seems to have understood that you only want the second patch.



---

archive/issue_comments_118356.json:
```json
{
    "body": "Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.  For ordinary curves the set of degrees is the set of all positive integers represented by a ceratin positive definite quadratic form;  for supersingular curves every degree except a finite number are possible (see Kohel's thesis).",
    "created_at": "2011-07-27T16:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118356",
    "user": "https://github.com/JohnCremona"
}
```

Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.  For ordinary curves the set of degrees is the set of all positive integers represented by a ceratin positive definite quadratic form;  for supersingular curves every degree except a finite number are possible (see Kohel's thesis).



---

archive/issue_comments_118357.json:
```json
{
    "body": "Replying to [comment:14 cremona]:\n> Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.\n\n\nThe word \"normalized\" is important here. That should limit the possibilities.",
    "created_at": "2011-07-27T19:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118357",
    "user": "https://github.com/mstreng"
}
```

Replying to [comment:14 cremona]:
> Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.


The word "normalized" is important here. That should limit the possibilities.



---

archive/issue_comments_118358.json:
```json
{
    "body": "Replying to [comment:15 mstreng]:\n> Replying to [comment:14 cremona]:\n> > Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.\n\n> \n> The word \"normalized\" is important here. That should limit the possibilities.\n\n\nNot if you do not mind replacing the codomain with an isomorphic curve, since composing with a scaling map ([u,r,s,t]=[u,0,0,0]) multiplies the constant by u (or maybe `u^-1`) so u can always be chosen to make the isogeny normalised!",
    "created_at": "2011-07-27T19:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118358",
    "user": "https://github.com/JohnCremona"
}
```

Replying to [comment:15 mstreng]:
> Replying to [comment:14 cremona]:
> > Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.

> 
> The word "normalized" is important here. That should limit the possibilities.


Not if you do not mind replacing the codomain with an isomorphic curve, since composing with a scaling map ([u,r,s,t]=[u,0,0,0]) multiplies the constant by u (or maybe `u^-1`) so u can always be chosen to make the isogeny normalised!



---

archive/issue_comments_118359.json:
```json
{
    "body": "Replying to [comment:16 cremona]:\n> Not if you do not mind replacing the codomain with an isomorphic curve\n\n\nI don't mind, but the code in this patch does mind.",
    "created_at": "2011-07-27T19:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118359",
    "user": "https://github.com/mstreng"
}
```

Replying to [comment:16 cremona]:
> Not if you do not mind replacing the codomain with an isomorphic curve


I don't mind, but the code in this patch does mind.



---

archive/issue_comments_118360.json:
```json
{
    "body": "Replying to [comment:13 mstreng]:\n> \n> First of all, the comment \"or a non-sense polynomial if no such isogeny exists\" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?\n\n\nI fixed the docs to be more explicit on this, hope it is clear now.\n\n> \n> Second, the test \"`ker_poly.degree() != ell-1`\" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)\n\n\nMarco is right: the \"normalized\" requirement is very strong. Indeed if two isogenies are normalized for the same models, then they are solution to the same differential equation with the same initial conditions. In characteristic 0, this means that their power series expansion at infinity is the same, which I think should be enough to prove that there is only one such isogeny.\n\nIn positive characteristic, this means that the power series are equal at least up to the (p-1)/2-th term (which is the limit up to which the BMSS algorithm can compute the solution). I am less sure about unicity in this case, but I am inclined to think that only one isogeny of degree less than p/4 will satisfy the condition (this is true for multiplication-by-m maps, at least).\n\nAs an example, take the multiplication maps by 1 and by p-1 on a curve E: they are both normalized for the models (E,E), which implies that the expansion at infinity of the multiplication-by-(p-1) map is x + O(x^((p-1)/2)). Of course the BMSS algorithm will refuse to compute the second map, because it has degree (p-1)^2 > p/4.\n\nAs a final remark, if we know the right (u,r,s,t) we can normalize the models, as John suggests. But, except for the case of scalar multiplication maps, computing such an isomorphisms is very expensive. I'm working on this in another patch.\n\n> Third, why is the test \"`not check`\" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?\n\n\nMaybe not, but these algorithms all tend to have some special cases which were not considered in the literature and which yield false answers. So why not test as long as the test comes for free (we have to compute the square root anyway).\n\n> 2. The word \"separable\" seems to be missing from the `ValueErrors`\n\n\nThe constraints on the degree imply that if such an error is returned, then p does not divide `ell` (otherwise a `ZeroDivisionError` is returned instead), thus no unseparable isogeny of degree `ell` exists either.\n\n> 3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals \"Stark\", \"stark\", \"Starks\", or \"starks\", before detecting that it actually equals \"BMSS\". It may speed things up by epsilon to put the most-used case first. (this is not the reason for \"needs work\")\n\n\ndone\n\n> ps. The patch bot seems to have understood that you only want the second patch.\n\n\nYes, but it also used to mention a failure that I was not able to reproduce. It seems to be down now, anyway.",
    "created_at": "2011-07-28T00:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118360",
    "user": "https://github.com/defeo"
}
```

Replying to [comment:13 mstreng]:
> 
> First of all, the comment "or a non-sense polynomial if no such isogeny exists" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?


I fixed the docs to be more explicit on this, hope it is clear now.

> 
> Second, the test "`ker_poly.degree() != ell-1`" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)


Marco is right: the "normalized" requirement is very strong. Indeed if two isogenies are normalized for the same models, then they are solution to the same differential equation with the same initial conditions. In characteristic 0, this means that their power series expansion at infinity is the same, which I think should be enough to prove that there is only one such isogeny.

In positive characteristic, this means that the power series are equal at least up to the (p-1)/2-th term (which is the limit up to which the BMSS algorithm can compute the solution). I am less sure about unicity in this case, but I am inclined to think that only one isogeny of degree less than p/4 will satisfy the condition (this is true for multiplication-by-m maps, at least).

As an example, take the multiplication maps by 1 and by p-1 on a curve E: they are both normalized for the models (E,E), which implies that the expansion at infinity of the multiplication-by-(p-1) map is x + O(x^((p-1)/2)). Of course the BMSS algorithm will refuse to compute the second map, because it has degree (p-1)^2 > p/4.

As a final remark, if we know the right (u,r,s,t) we can normalize the models, as John suggests. But, except for the case of scalar multiplication maps, computing such an isomorphisms is very expensive. I'm working on this in another patch.

> Third, why is the test "`not check`" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?


Maybe not, but these algorithms all tend to have some special cases which were not considered in the literature and which yield false answers. So why not test as long as the test comes for free (we have to compute the square root anyway).

> 2. The word "separable" seems to be missing from the `ValueErrors`


The constraints on the degree imply that if such an error is returned, then p does not divide `ell` (otherwise a `ZeroDivisionError` is returned instead), thus no unseparable isogeny of degree `ell` exists either.

> 3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals "Stark", "stark", "Starks", or "starks", before detecting that it actually equals "BMSS". It may speed things up by epsilon to put the most-used case first. (this is not the reason for "needs work")


done

> ps. The patch bot seems to have understood that you only want the second patch.


Yes, but it also used to mention a failure that I was not able to reproduce. It seems to be down now, anyway.



---

archive/issue_comments_118361.json:
```json
{
    "body": "Attachment [trac_11095_isogenies_char_0.2.patch](tarball://root/attachments/some-uuid/ticket11095/trac_11095_isogenies_char_0.2.patch) by @defeo created at 2011-07-30 05:45:11",
    "created_at": "2011-07-30T05:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118361",
    "user": "https://github.com/defeo"
}
```

Attachment [trac_11095_isogenies_char_0.2.patch](tarball://root/attachments/some-uuid/ticket11095/trac_11095_isogenies_char_0.2.patch) by @defeo created at 2011-07-30 05:45:11



---

archive/issue_comments_118362.json:
```json
{
    "body": "what are the work issues for that ticket?\n\nPaul",
    "created_at": "2011-09-16T13:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118362",
    "user": "https://github.com/zimmermann6"
}
```

what are the work issues for that ticket?

Paul



---

archive/issue_comments_118363.json:
```json
{
    "body": "Changing keywords from \"isogenies\" to \"isogenies ecc2011\".",
    "created_at": "2011-09-16T13:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118363",
    "user": "https://github.com/zimmermann6"
}
```

Changing keywords from "isogenies" to "isogenies ecc2011".



---

archive/issue_events_028768.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28768"
}
```



---

archive/issue_events_028769.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28769"
}
```



---

archive/issue_comments_118364.json:
```json
{
    "body": "here is a patch rebased on 5.12.beta4\n\nfor the bot : \n\napply only trac_11095_isogenies_char_0_v3.patch\u200b",
    "created_at": "2013-09-03T19:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118364",
    "user": "https://github.com/fchapoton"
}
```

here is a patch rebased on 5.12.beta4

for the bot : 

apply only trac_11095_isogenies_char_0_v3.patch​



---

archive/issue_comments_118365.json:
```json
{
    "body": "apply only trac_11095_isogenies_char_0_v3.patch",
    "created_at": "2013-09-03T19:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118365",
    "user": "https://github.com/fchapoton"
}
```

apply only trac_11095_isogenies_char_0_v3.patch



---

archive/issue_comments_118366.json:
```json
{
    "body": "Attachment [trac_11095_isogenies_char_0_v3.patch](tarball://root/attachments/some-uuid/ticket11095/trac_11095_isogenies_char_0_v3.patch) by @fchapoton created at 2013-09-03 19:25:21",
    "created_at": "2013-09-03T19:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118366",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_11095_isogenies_char_0_v3.patch](tarball://root/attachments/some-uuid/ticket11095/trac_11095_isogenies_char_0_v3.patch) by @fchapoton created at 2013-09-03 19:25:21



---

archive/issue_comments_118367.json:
```json
{
    "body": "apply only trac_11095_isogenies_char_0_v3.patch",
    "created_at": "2013-09-03T19:26:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118367",
    "user": "https://github.com/fchapoton"
}
```

apply only trac_11095_isogenies_char_0_v3.patch



---

archive/issue_comments_118368.json:
```json
{
    "body": "This is going to conflict with #13615 -- can we agree on an order to do them in?",
    "created_at": "2013-09-03T19:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118368",
    "user": "https://github.com/JohnCremona"
}
```

This is going to conflict with #13615 -- can we agree on an order to do them in?



---

archive/issue_comments_118369.json:
```json
{
    "body": "Oh, definitely #13615 first. \n\nThis ticket has been bitrotting for years, although I've never abandoned it and I still use the code from time to time. The new git workflow might be the occasion to go back to it... maybe. In the meantime, I'll put the milestone to sage-pending.",
    "created_at": "2013-09-03T21:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118369",
    "user": "https://github.com/defeo"
}
```

Oh, definitely #13615 first. 

This ticket has been bitrotting for years, although I've never abandoned it and I still use the code from time to time. The new git workflow might be the occasion to go back to it... maybe. In the meantime, I'll put the milestone to sage-pending.



---

archive/issue_events_028770.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2013-09-03T21:23:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28770"
}
```



---

archive/issue_events_028771.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2013-09-03T21:23:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28771"
}
```



---

archive/issue_comments_118370.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2014-04-12T13:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118370",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_118371.json:
```json
{
    "body": "I converted the latest patch into a Git branch; there were some conflicts that I hopefully resolved correctly, and all doctests pass.\n\nWould it make sense to call the new module `isogeny_char_zero` instead of `ell_isogeny_char_zero`?  There is also `isogeny_small_degree`; it would be nice if we could avoid having modules with three different prefixes (`isogeny*`, `ell_isogeny*` and `ell_curve_isogeny*`)...",
    "created_at": "2014-04-12T13:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118371",
    "user": "https://github.com/pjbruin"
}
```

I converted the latest patch into a Git branch; there were some conflicts that I hopefully resolved correctly, and all doctests pass.

Would it make sense to call the new module `isogeny_char_zero` instead of `ell_isogeny_char_zero`?  There is also `isogeny_small_degree`; it would be nice if we could avoid having modules with three different prefixes (`isogeny*`, `ell_isogeny*` and `ell_curve_isogeny*`)...



---

archive/issue_comments_118372.json:
```json
{
    "body": "Good point about naming of modules.  there are 14 with names starting ell_ in the directory called elliptic_curves and the ell_ prefix could be removed from all of them!  (There is also lseries_ell).  But doing so would cause a lot of problems for any other branches affecting any of those files...",
    "created_at": "2014-04-12T16:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118372",
    "user": "https://github.com/JohnCremona"
}
```

Good point about naming of modules.  there are 14 with names starting ell_ in the directory called elliptic_curves and the ell_ prefix could be removed from all of them!  (There is also lseries_ell).  But doing so would cause a lot of problems for any other branches affecting any of those files...



---

archive/issue_comments_118373.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-24T22:47:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_118374.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-04-24T22:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118374",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_118375.json:
```json
{
    "body": "Since John and I are for it and nobody seems to be against it, I removed the `ell_` prefix from `isogeny_char_zero`.  (For existing files that would of course be too drastic to do here.)",
    "created_at": "2014-04-24T22:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118375",
    "user": "https://github.com/pjbruin"
}
```

Since John and I are for it and nobody seems to be against it, I removed the `ell_` prefix from `isogeny_char_zero`.  (For existing files that would of course be too drastic to do here.)



---

archive/issue_comments_118376.json:
```json
{
    "body": "Thanks Peter for resurrecting this old ticket of mine. I have no objections to the file renaming.\n\nBack in 2011 Marco Streng and I bypassed Trac and discussed this ticket via mail. I feel I must make an update to explain why the ticket was set to needs work back then.\n\nEssentially, Marco was unhappy about the documentation for two reasons.\n\n1. It wasn't clear whether Stark's algorithm could fail silently. I just had a look at it. It can. I'm commiting the necessary modifications to the docs.\n\n2. The docstring talks about THE normalized isogeny of degree at most `degree`, but it wasn't immediately clear that this isogeny should be unique. Marco himself gave the proof of unicity. This is explained in the note in the docstring of `isogeny_BMSS`.\n\nI can't find any other issue in my mail logs, so it is good to go for me.",
    "created_at": "2014-04-26T03:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118376",
    "user": "https://github.com/defeo"
}
```

Thanks Peter for resurrecting this old ticket of mine. I have no objections to the file renaming.

Back in 2011 Marco Streng and I bypassed Trac and discussed this ticket via mail. I feel I must make an update to explain why the ticket was set to needs work back then.

Essentially, Marco was unhappy about the documentation for two reasons.

1. It wasn't clear whether Stark's algorithm could fail silently. I just had a look at it. It can. I'm commiting the necessary modifications to the docs.

2. The docstring talks about THE normalized isogeny of degree at most `degree`, but it wasn't immediately clear that this isogeny should be unique. Marco himself gave the proof of unicity. This is explained in the note in the docstring of `isogeny_BMSS`.

I can't find any other issue in my mail logs, so it is good to go for me.



---

archive/issue_events_028772.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-26T11:24:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28772"
}
```



---

archive/issue_events_028773.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-26T11:24:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28773"
}
```



---

archive/issue_comments_118377.json:
```json
{
    "body": "OK.  I cannot review it right now, so I just changed the milestone to \"undiscourage\" people from reviewing it.\n  \n---\nNew commits:",
    "created_at": "2014-04-26T11:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118377",
    "user": "https://github.com/pjbruin"
}
```

OK.  I cannot review it right now, so I just changed the milestone to "undiscourage" people from reviewing it.
  
---
New commits:



---

archive/issue_events_028774.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28774"
}
```



---

archive/issue_events_028775.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28775"
}
```



---

archive/issue_comments_118378.json:
```json
{
    "body": "I have made a few minor changes, including:\n\n- put new raise statements into python3 syntax\n- alignement changes in doc\n \n---\nNew commits:",
    "created_at": "2014-05-24T09:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118378",
    "user": "https://github.com/fchapoton"
}
```

I have made a few minor changes, including:

- put new raise statements into python3 syntax
- alignement changes in doc
 
---
New commits:



---

archive/issue_comments_118379.json:
```json
{
    "body": "I've been experimenting a bit and it seems to work well.  Would it be possible to make `EllipticCurve.isogeny()` and `EllipticCurveIsogeny` accept `algorithm='bmss'`?  In the following example I wanted to compute a 20-isogeny between two elliptic curves over a quadratic field (knowing a priori that such an isogeny exists).  Trying `E.isogeny()` gives a `NotImplementedError` and it seems that I have to import `isogeny_kernel`:\n\n```\nsage: K.<a> = NumberField(x^2 - 17*x - 120)\nsage: E = EllipticCurve([0, 1, 0, -89423170640*a + 1999987182576, 87486176701141216*a - 1956665490639249900])\nsage: E_isog = EllipticCurve([0, 0, 0, 1/3*(6255584200920576*a - 139908796923911440), 1/27*(-5210907833850999276681216*a + 116544166379886781944583040)])\nsage: E.isogeny(kernel=None, codomain=E_isog, degree=20)\n...\nNotImplementedError: For basic Kohel's algorithm, if the kernel degree is even then the kernel must be contained in the two torsion.\nsage: from sage.schemes.elliptic_curves.isogeny_char_zero import isogeny_kernel \nsage: isogeny_kernel(E, E_isog, 20)\nx^10 + (-2152280*a + 48136659)*x^9 + (-148051244547864/5*a + 3311228950404238/5)*x^8 + (-129467694651804753040*a + 2895599965960126731024)*x^7 + (-131438756167338709694710304*a + 2939683593714796730731625088)*x^6 + (196151384137228169247793952562368*a - 4387008996787386307912516668742368)*x^5 + (211127593344837320952211060140401067136*a - 4721958274971357551356075375634080673472)*x^4 + (-676089273725371340027412364537916253836377856/5*a + 15121023690506428142245429629695675550575584512/5)*x^3 + (-58033791954670621184885097803503676816467494405632*a + 1297950399599077493253508317741911096974395766973184)*x^2 + (26614381917191620756309912883562400685500952121788824576*a - 595241952679626281929246822605533328842111805768309632256)*x + 665314371570672918992258944764049661423822960574864980480000*a - 14880038428536031844363469294864157021058877011246176591280640\n```\nBy the way, in this example Stark's algorithm fails; I haven't checked exactly why.\n\n```\nsage: isogeny_kernel(E, E_isog, 20, algorithm='stark')\n...\nRuntimeError: Stark's algorithm returned an unexpected result. Please report this bug.\n```",
    "created_at": "2014-05-24T15:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118379",
    "user": "https://github.com/pjbruin"
}
```

I've been experimenting a bit and it seems to work well.  Would it be possible to make `EllipticCurve.isogeny()` and `EllipticCurveIsogeny` accept `algorithm='bmss'`?  In the following example I wanted to compute a 20-isogeny between two elliptic curves over a quadratic field (knowing a priori that such an isogeny exists).  Trying `E.isogeny()` gives a `NotImplementedError` and it seems that I have to import `isogeny_kernel`:

```
sage: K.<a> = NumberField(x^2 - 17*x - 120)
sage: E = EllipticCurve([0, 1, 0, -89423170640*a + 1999987182576, 87486176701141216*a - 1956665490639249900])
sage: E_isog = EllipticCurve([0, 0, 0, 1/3*(6255584200920576*a - 139908796923911440), 1/27*(-5210907833850999276681216*a + 116544166379886781944583040)])
sage: E.isogeny(kernel=None, codomain=E_isog, degree=20)
...
NotImplementedError: For basic Kohel's algorithm, if the kernel degree is even then the kernel must be contained in the two torsion.
sage: from sage.schemes.elliptic_curves.isogeny_char_zero import isogeny_kernel 
sage: isogeny_kernel(E, E_isog, 20)
x^10 + (-2152280*a + 48136659)*x^9 + (-148051244547864/5*a + 3311228950404238/5)*x^8 + (-129467694651804753040*a + 2895599965960126731024)*x^7 + (-131438756167338709694710304*a + 2939683593714796730731625088)*x^6 + (196151384137228169247793952562368*a - 4387008996787386307912516668742368)*x^5 + (211127593344837320952211060140401067136*a - 4721958274971357551356075375634080673472)*x^4 + (-676089273725371340027412364537916253836377856/5*a + 15121023690506428142245429629695675550575584512/5)*x^3 + (-58033791954670621184885097803503676816467494405632*a + 1297950399599077493253508317741911096974395766973184)*x^2 + (26614381917191620756309912883562400685500952121788824576*a - 595241952679626281929246822605533328842111805768309632256)*x + 665314371570672918992258944764049661423822960574864980480000*a - 14880038428536031844363469294864157021058877011246176591280640
```
By the way, in this example Stark's algorithm fails; I haven't checked exactly why.

```
sage: isogeny_kernel(E, E_isog, 20, algorithm='stark')
...
RuntimeError: Stark's algorithm returned an unexpected result. Please report this bug.
```



---

archive/issue_comments_118380.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-25T14:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118380",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_028776.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28776"
}
```



---

archive/issue_events_028777.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10964#event-28777"
}
```



---

archive/issue_comments_118381.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-22T21:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118381",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_118382.json:
```json
{
    "body": "The merge conflicts appear to result from #11327.",
    "created_at": "2014-08-22T21:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118382",
    "user": "https://github.com/pjbruin"
}
```

The merge conflicts appear to result from #11327.



---

archive/issue_comments_118383.json:
```json
{
    "body": "Replying to [comment:39 pbruin]:\n> The merge conflicts appear to result from #11327.\n\n\nIf so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.",
    "created_at": "2014-08-24T17:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118383",
    "user": "https://github.com/JohnCremona"
}
```

Replying to [comment:39 pbruin]:
> The merge conflicts appear to result from #11327.


If so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.



---

archive/issue_comments_118384.json:
```json
{
    "body": "Replying to [comment:40 cremona]:\n> Replying to [comment:39 pbruin]:\n> > The merge conflicts appear to result from #11327.\n\n> \n> If so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.\n\nI apologise in return: this particular conflict could have been avoided if I had finished my review instead of wondering about adding an extra bit of functionality (comment:36) and leaving it there.",
    "created_at": "2014-08-25T13:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118384",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:40 cremona]:
> Replying to [comment:39 pbruin]:
> > The merge conflicts appear to result from #11327.

> 
> If so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.

I apologise in return: this particular conflict could have been avoided if I had finished my review instead of wondering about adding an extra bit of functionality (comment:36) and leaving it there.



---

archive/issue_comments_118385.json:
```json
{
    "body": "No big deal. I'm back from conferences+vacation and I'm going to have a look at these conflicts and other isogeny related code in the next few days.",
    "created_at": "2014-08-25T13:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118385",
    "user": "https://github.com/defeo"
}
```

No big deal. I'm back from conferences+vacation and I'm going to have a look at these conflicts and other isogeny related code in the next few days.



---

archive/issue_comments_118386.json:
```json
{
    "body": "The conflict seems to me to be not so easy to solve. What do you think ?",
    "created_at": "2015-01-27T16:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118386",
    "user": "https://github.com/fchapoton"
}
```

The conflict seems to me to be not so easy to solve. What do you think ?



---

archive/issue_comments_118387.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-09T20:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118387",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_118388.json:
```json
{
    "body": "For this part of the last commit\n\n```diff\n--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n@@ -3441,13 +3436,14 @@ class EllipticCurveIsogeny(Morphism):\n aut = [a for a in auts if a.u == sc]\n if len(aut) != 1:\n     raise ValueError(\"There is a bug in dual().\")\n+ # PROBLEM HERE BELOW IN THE CODE : E0 not defined !\n phi_hat.set_post_isomorphism(WeierstrassIsomorphism(E0,aut[0],E0))\n self.__dual = phi_hat\n \n```\nsee #17293, where I also noticed this problem; the correct line is\n\n```\nphi_hat.set_post_isomorphism(aut[0])\n```",
    "created_at": "2015-02-09T20:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118388",
    "user": "https://github.com/pjbruin"
}
```

For this part of the last commit

```diff
--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
@@ -3441,13 +3436,14 @@ class EllipticCurveIsogeny(Morphism):
 aut = [a for a in auts if a.u == sc]
 if len(aut) != 1:
     raise ValueError("There is a bug in dual().")
+ # PROBLEM HERE BELOW IN THE CODE : E0 not defined !
 phi_hat.set_post_isomorphism(WeierstrassIsomorphism(E0,aut[0],E0))
 self.__dual = phi_hat
 
```
see #17293, where I also noticed this problem; the correct line is

```
phi_hat.set_post_isomorphism(aut[0])
```



---

archive/issue_comments_118389.json:
```json
{
    "body": "Ok. anyway, the merge I did here was not perfectly clean : the functions moved to isogeny_char_zero are pretty much in their state dating from before #11327\n\nthis is rather annoying..",
    "created_at": "2015-02-09T20:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118389",
    "user": "https://github.com/fchapoton"
}
```

Ok. anyway, the merge I did here was not perfectly clean : the functions moved to isogeny_char_zero are pretty much in their state dating from before #11327

this is rather annoying..



---

archive/issue_comments_118390.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-09T20:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_118391.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-11T20:22:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10964#issuecomment-118391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:
