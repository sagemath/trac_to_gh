# Issue 26881: Failing doctests due to syntax warnings from GAP

Issue created by migration from https://trac.sagemath.org/ticket/27118

Original creator: jdemeyer

Original creation time: 2019-01-25 10:10:57

CC:  dimpase

On my system, I have this:

```
sage -t src/sage/categories/finite_monoids.py
**********************************************************************
File "src/sage/categories/finite_monoids.py", line 73, in sage.categories.finite_monoids.FiniteMonoids.ParentMethods.nerve
Failed example:
    Sigma2 = groups.permutation.Cyclic(2)
Expected nothing
Got:
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/lib/operdebug.g:46
      PrintTo1(fname, f);
              ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/lib/operdebug.g:59
          n := SubstitutionSublist(nams[i],"CategoryCollections","CC");
                                  ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/lib/operdebug.g:66
      PrintTo1(fname, f);
              ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/pkg/SmallGrp-1.3/read.g:25
            READ_SMALL_FUNCS[s] := LoadFunc(Concatenation("small", String(s)));
                            ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/pkg/SmallGrp-1.3/read.g:26
            READ_SMALL_FUNCS[s]( Concatenation( "smlgp", String(s), ".g" ),
                            ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/pkg/SmallGrp-1.3/read.g:30
        for i in [ 2 .. Length( SMALL_AVAILABLE_FUNCS ) ] do
                                                      ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/pkg/SmallGrp-1.3/read.g:32
            READ_IDLIB_FUNCS[ i ] := LoadFunc(Concatenation("id", String(i)));
                            ^
    Syntax warning: Unbound global variable in /usr/local/src/sage-config/local/sh\
    are/gap/pkg/SmallGrp-1.3/read.g:33
            READ_IDLIB_FUNCS[ i ]( Concatenation( "idgrp", String( i ), ".g" ),
                            ^
    Error, Variable: 'READ_SMALL_FUNCS' must have an assigned value
    Error, was not in any namespace
**********************************************************************
```


Various other doctests fail with the same messages.


---

Comment by dimpase created at 2019-01-25 11:35:59

Please specify what Sage version this is and whether you have gap_packages installed.


---

Comment by jdemeyer created at 2019-01-25 11:51:36

sgae 8.7.beta0 with `gap_packages` installed. Reinstalling `gap_packages` does not help.

I cannot reproduce (yet) this on other systems, this just happens with one Sage installation.


---

Comment by dimpase created at 2019-01-25 11:54:58

How about reinstalling `gap` and `gap_packages`? 


(and making sure old GAP is purged from SAGE_LOCAL - this is supposed to be automatic, but...)


---

Comment by jdemeyer created at 2019-01-25 11:59:31

Replying to [comment:3 dimpase]:
> and making sure old GAP is purged from SAGE_LOCAL - this is supposed to be automatic, but...

If this is required, then that's a bug.


---

Comment by jdemeyer created at 2019-01-25 13:10:40

Reinstalling GAP solved the problem.


---

Comment by dimpase created at 2019-01-25 13:18:34

reinstalling GAP is not required, but there is no telling about how you mangled your SAGE_LOCAL, so I cannot consider this a bug - surely  it should not be a blocker.

I imagine you cannot reproduce it anyway :-)


---

Comment by dimpase created at 2019-01-25 13:18:34

Changing priority from blocker to major.


---

Comment by embray created at 2019-03-25 10:56:15

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)


---

Comment by embray created at 2019-06-14 14:54:19

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).


---

Comment by slelievre created at 2020-10-14 21:46:02

Proposing to close as worksforme since there
has been no recent manifestation of this.


---

Comment by slelievre created at 2020-10-14 21:46:02

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-11-08 08:29:12

Resolution: worksforme
