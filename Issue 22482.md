# Issue 22482: integral points for elliptic curves broken

Issue created by migration from https://trac.sagemath.org/ticket/22719

Original creator: wuthrich

Original creation time: 2017-03-30 15:26:05

CC:  cremona

Keywords: integral points, ratpoints


```
sage: E = EllipticCurve("141d1")
sage: E.integral_points()
```


goes boom with
` --> 198         raise RuntimeError('Bad arguments to ratpoints')`



---

Comment by wuthrich created at 2017-03-30 15:27:16

I am not sure this has not been noted before in some form, but I could not find anything about it.
It is the optimal curve of lowest conductor for which this appears.


---

Comment by cremona created at 2017-03-30 15:33:33

Thanks for spotting this.  Since this was implemented I have checed many thousands of curves to compare with Magma, so this must be something new.  In particular ratpoints has changed.

There's another ticket which has been around for ages in which I am fixing other integral points bugs.  What joy.


---

Comment by cremona created at 2017-11-07 19:48:12

I just found this and took a look.  It's easy to fix (though I don't know what has changed): in line 5770 of ell_rational_field.py ratpoints() does not like being given H=0 which it is in this case.  I fixed this example by replacing the line above, defining H by

```
H = max(xmin.abs(), xmax.abs(), 1)
```

I am running some tests.


---

Comment by cremona created at 2017-11-07 20:00:09

Changing status from new to needs_review.


---

Comment by cremona created at 2017-11-07 20:00:09

New commits:


---

Comment by cremona created at 2017-11-07 20:01:33

I checked all curves of conductor <1000.  Doing more checking now -- note that it's a lot quicker to run E.integral_points() on curves when you have the optional database_cremona_ellcurve installed since it does not have to find the Mordell-Weil group of each.


---

Comment by roed created at 2017-11-08 22:55:37

Changing status from needs_review to positive_review.


---

Comment by roed created at 2017-11-08 22:55:37

Looks good.


---

Comment by wuthrich created at 2017-11-09 09:10:26

Oh, someone beat me to it :)
I did random checks with thousands of curves and it always gives an answer now.


---

Comment by cremona created at 2017-11-09 09:18:38

Thanks both -- I meant to post again to say that I ran all curves up to conductor 10^5 with no problems.


---

Comment by vbraun created at 2017-12-11 01:03:55

Resolution: fixed
