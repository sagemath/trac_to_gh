# Issue 10794: R package documentation not accessible from notebook

Issue created by migration from https://trac.sagemath.org/ticket/10860

Original creator: aginiewicz

Original creation time: 2011-02-28 18:49:17

Assignee: jason, mpatel, was

CC:  kcrisman jason mpatel timdumol

Keywords: unicode, notebook, docstring, R

The documentation of package R is not accessible from notebook, while it works from command line.


```
sage: r.lm?
<html><!--notruncate-->
Traceback (most recent call last):
 File "<stdin>", line 1, in <module>
 File "_sage_input_3.py", line 10, in <module>
   exec compile(u'print _support_.docstring("r.lm", globals(),
system="sage")' + '\n', '', 'single')
 File "", line 1, in <module>

 File "/opt/sage/devel/sagenb/sagenb/misc/support.py", line 263, in docstring
   return html_markup(s)
 File "/opt/sage/devel/sagenb/sagenb/misc/support.py", line 288, in html_markup
   return '<div class="docstring">' + preamble + '<pre>' + s + '</pre></div>'
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position
116: ordinal not in range(128)
</html>
```



---

Attachment

decode string before converting to html


---

Comment by aginiewicz created at 2011-02-28 18:56:20

Changing status from new to needs_review.


---

Comment by aginiewicz created at 2011-02-28 18:56:20

Added simple fix for the issue mentioned. With the patch R documentation works again. I also checked documentation for plot. Also, all tests on 4.6.1 passed.


---

Comment by kcrisman created at 2011-04-21 01:58:28

Changing status from needs_review to needs_info.


---

Comment by kcrisman created at 2011-04-21 01:58:28

This works.  I'm not quite sure why - is all R doc in UTF-8 now? maybe this happened with the last R upgrade - but it does.  

Positive review if we can't think of a way to doctest this.  Is this something we can doctest using `EMBEDDED_MODE`?  cc:ing in a few people who might know the answer to that question.


---

Comment by kcrisman created at 2011-06-14 07:30:15

Changing status from needs_info to needs_review.


---

Comment by kcrisman created at 2011-06-14 07:30:15

Apparently it is.

```
sage: a = r.lm
sage: b = a._sage_doc_()
sage: b[:150]
'lm                    package:stats                    R Documentation\n\n_\x08F_\x08i_\x08t_\x08t_\x08i_\x08n_\x08g _\x08L_\x08i_\x08n_\x08e_\x08a_\x08r _\x08M_\x08o_\x08d_\x08e_\x08l_\x08s\n\n_\x08D_\x08e_\x08s_\x08c_\x08r_\x08'
```

I've added a doctest for this.  There are warnings, but they are ok - I think they are just because of the R formatting.  Warnings of this type do not affect passing doctests.


---

Comment by kcrisman created at 2011-06-14 07:30:32

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2011-06-14 07:30:32

Changing keywords from "unicode, notebook, docstring, R" to "unicode, notebook, docstring, R, sd31".


---

Attachment

Apply after initial patch


---

Comment by kcrisman created at 2011-06-14 07:31:46

Apply [attachment:10860.patch] and [attachment:trac_10860-review.patch].


---

Comment by kcrisman created at 2011-06-14 07:32:19

To the notebook repository, of course.


---

Comment by jdemeyer created at 2011-06-15 20:13:57

Resolution: fixed
