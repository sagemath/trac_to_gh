# Issue 24050: Issue with vertex cover for graphs with multiple edges

archive/issues_024050.json:
```json
{
    "body": "CC:  jmantysalo\n\nSeveral issues to fix for `vertex_cover` with multigraphs \n\n```\nsage: G = Graph([(0,1)]*5 + [(1,2)]*2, multiedges=True)\nsage: G.vertex_cover(reduction_rules=False, algorithm='MILP')\n[1]\nsage: G.vertex_cover(reduction_rules=True, algorithm='MILP')\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-47-3efdc00ac3e0> in <module>()\n----> 1 G.vertex_cover(reduction_rules=True, algorithm='MILP')\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in vertex_cover(self, algorithm, value_only, reduction_rules, solver, verbosity)\n   6622 \n   6623                 elif du == 2:\n-> 6624                     v,w  = g.neighbors(u)\n   6625 \n   6626                     if g.has_edge(v,w):\n\nValueError: need more than 1 value to unpack\nsage: G.vertex_cover(reduction_rules=False)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-48-5167d984b139> in <module>()\n----> 1 G.vertex_cover(reduction_rules=False)\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in vertex_cover(self, algorithm, value_only, reduction_rules, solver, verbosity)\n   6674 \n   6675         elif algorithm == \"Cliquer\" or algorithm == \"mcqd\":\n-> 6676             independent = g.complement().clique_maximum(algorithm=algorithm)\n   6677             if value_only:\n   6678                 size_cover_g = g.order() - len(independent)\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in complement(self)\n  17433 \n  17434         \"\"\"\n> 17435         self._scream_if_not_simple()\n  17436 \n  17437         G = self.copy(data_structure='dense')\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in _scream_if_not_simple(self, allow_loops, allow_multiple_edges)\n   1298                    \"meantime if you want to use it please disallow \"+name+\" using \"+\n   1299                    functions+\".\")\n-> 1300             raise ValueError(msg)\n   1301 \n   1302     def networkx_graph(self, copy=True):\n\nValueError: This method is not known to work on graphs with multiedges. Perhaps this method can be updated to handle them, but in the meantime if you want to use it please disallow multiedges using allow_multiple_edges().\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24287\n\n",
    "created_at": "2017-11-27T15:15:13Z",
    "labels": [
        "graph theory",
        "major",
        "bug"
    ],
    "title": "Issue with vertex cover for graphs with multiple edges",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24050",
    "user": "dcoudert"
}
```
CC:  jmantysalo

Several issues to fix for `vertex_cover` with multigraphs 

```
sage: G = Graph([(0,1)]*5 + [(1,2)]*2, multiedges=True)
sage: G.vertex_cover(reduction_rules=False, algorithm='MILP')
[1]
sage: G.vertex_cover(reduction_rules=True, algorithm='MILP')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-47-3efdc00ac3e0> in <module>()
----> 1 G.vertex_cover(reduction_rules=True, algorithm='MILP')

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in vertex_cover(self, algorithm, value_only, reduction_rules, solver, verbosity)
   6622 
   6623                 elif du == 2:
-> 6624                     v,w  = g.neighbors(u)
   6625 
   6626                     if g.has_edge(v,w):

ValueError: need more than 1 value to unpack
sage: G.vertex_cover(reduction_rules=False)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-48-5167d984b139> in <module>()
----> 1 G.vertex_cover(reduction_rules=False)

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in vertex_cover(self, algorithm, value_only, reduction_rules, solver, verbosity)
   6674 
   6675         elif algorithm == "Cliquer" or algorithm == "mcqd":
-> 6676             independent = g.complement().clique_maximum(algorithm=algorithm)
   6677             if value_only:
   6678                 size_cover_g = g.order() - len(independent)

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in complement(self)
  17433 
  17434         """
> 17435         self._scream_if_not_simple()
  17436 
  17437         G = self.copy(data_structure='dense')

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in _scream_if_not_simple(self, allow_loops, allow_multiple_edges)
   1298                    "meantime if you want to use it please disallow "+name+" using "+
   1299                    functions+".")
-> 1300             raise ValueError(msg)
   1301 
   1302     def networkx_graph(self, copy=True):

ValueError: This method is not known to work on graphs with multiedges. Perhaps this method can be updated to handle them, but in the meantime if you want to use it please disallow multiedges using allow_multiple_edges().
```


Issue created by migration from https://trac.sagemath.org/ticket/24287





---

archive/issue_comments_337145.json:
```json
{
    "body": "I have also cleaned some parts of the method.\n----\nNew commits:",
    "created_at": "2017-11-27T17:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337145",
    "user": "dcoudert"
}
```

I have also cleaned some parts of the method.
----
New commits:



---

archive/issue_comments_337146.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-11-27T17:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337146",
    "user": "dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_337147.json:
```json
{
    "body": "Seems good, I'll check.\n\nI noticed `[v for v in g.vertex_iterator() . . .]`, which can be said shortly as `[v for v in g . . .]`.",
    "created_at": "2017-11-27T18:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337147",
    "user": "jmantysalo"
}
```

Seems good, I'll check.

I noticed `[v for v in g.vertex_iterator() . . .]`, which can be said shortly as `[v for v in g . . .]`.



---

archive/issue_comments_337148.json:
```json
{
    "body": "What I don't know is if `for v in g` creates a list of uses an iterator.",
    "created_at": "2017-11-27T18:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337148",
    "user": "dcoudert"
}
```

What I don't know is if `for v in g` creates a list of uses an iterator.



---

archive/issue_comments_337149.json:
```json
{
    "body": "Replying to [comment:3 dcoudert]:\n> What I don't know is if `for v in g` creates a list of uses an iterator.\n\nAccording to documentation of `__iter_` it outputs an iteratort.\n\nFeel free to mark this as positive review if you want. Or you can also correct the input section that says \"It can be one of those two values.\" and then lists three values.",
    "created_at": "2017-11-27T20:25:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337149",
    "user": "jmantysalo"
}
```

Replying to [comment:3 dcoudert]:
> What I don't know is if `for v in g` creates a list of uses an iterator.

According to documentation of `__iter_` it outputs an iteratort.

Feel free to mark this as positive review if you want. Or you can also correct the input section that says "It can be one of those two values." and then lists three values.



---

archive/issue_comments_337150.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-27T20:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337150",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337151.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-27T20:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337151",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337152.json:
```json
{
    "body": "I have implemented all your comments. I let you conclude on the status.",
    "created_at": "2017-11-27T20:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337152",
    "user": "dcoudert"
}
```

I have implemented all your comments. I let you conclude on the status.



---

archive/issue_comments_337153.json:
```json
{
    "body": "All good.",
    "created_at": "2017-11-28T05:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337153",
    "user": "jmantysalo"
}
```

All good.



---

archive/issue_comments_337154.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-28T05:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337154",
    "user": "jmantysalo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_337155.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-12-13T17:37:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24050#issuecomment-337155",
    "user": "vbraun"
}
```

Resolution: fixed
