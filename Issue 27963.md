# Issue 27963: reduce base field for scheme morphisms

Issue created by migration from https://trac.sagemath.org/ticket/28200

Original creator: bhutz

Original creation time: 2019-07-15 17:23:55

Keywords: SI2019

It is possible that the field defined by the coefficients is strictly contained in base field of the morphism. This can be happen in a number of situations, especially from conjugations or computing normal forms. There should be a general function to reduce to the field of definition of the coefficients.


---

Comment by bhutz created at 2019-07-15 17:27:27

Here is an initial implementation that could use some more testing.

This just implements the function and does not have any of the 'client' functions utilize this; like conjugate or normal form. I'm not sure those additional modifications should be part of this ticket.
----
New commits:


---

Comment by bhutz created at 2019-07-25 15:11:24

Changing status from new to needs_review.


---

Comment by @HTalbott created at 2019-07-25 15:17:40

Changing status from needs_review to needs_work.


---

Comment by @HTalbott created at 2019-07-25 15:17:40

On line 1684 of src/sage/schemes/projective/projective_morphism.py, the method finds the max of the the degrees of the coefficients. This should find the LCM rather than the max. For instance, the following code currently gives the minimal field as GF(5 to 3), when it should give GF(5 to 6), as below:

```
sage: K.<t>=GF(5^6)
sage: A.<x>=AffineSpace(K,1)
sage: H=End(A)
sage: f=H([x^2+x*(t^3 + 2*t^2 + 4*t)+(t^5 + 3*t^4 + t^2 + 4*t)])
sage: f.reduce_base_field()
Scheme endomorphism of Affine Space of dimension 1 over Finite Field in t of size 5^6
  Defn: Defined on coordinates by sending (x) to
        (x^2 + (t^3 + 2*t^2 - t)*x + (t^5 - 2*t^4 + t^2 - t))
```



---

Comment by git created at 2019-07-25 18:27:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2019-07-25 18:28:16

Changing status from needs_work to needs_review.


---

Comment by git created at 2019-07-30 13:59:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @HTalbott created at 2019-07-30 14:01:17

Changing status from needs_review to positive_review.


---

Comment by @HTalbott created at 2019-07-30 14:01:17

Fixed small documentations errors. Everything else looks good!
----
New commits:


---

Comment by vbraun created at 2019-08-01 22:54:56

Resolution: fixed
