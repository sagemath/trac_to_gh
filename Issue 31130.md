# Issue 31130: bug in kernel of ring homomorphism of quotient rings

archive/issues_031130.json:
```json
{
    "body": "CC:  @slel @tscrim\n\nAs reported on [sage-devel](https://groups.google.com/g/sage-devel/c/jS5tMpVlrFs):\n\n```\nsage: A.<t> = QQ[]\nsage: B.<x,y> = QQ[]\nsage: H = B.quotient(B.ideal([B.1]))\nsage: f = A.hom([H.0], H)\nsage: f.kernel()\nPrincipal ideal (t) of Univariate Polynomial Ring in t over Rational Field\n```\n\nwhereas the kernel should be the zero ideal.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31367\n\n",
    "created_at": "2021-02-09T10:22:30Z",
    "labels": [
        "commutative algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "bug in kernel of ring homomorphism of quotient rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31130",
    "user": "@mwageringel"
}
```
CC:  @slel @tscrim

As reported on [sage-devel](https://groups.google.com/g/sage-devel/c/jS5tMpVlrFs):

```
sage: A.<t> = QQ[]
sage: B.<x,y> = QQ[]
sage: H = B.quotient(B.ideal([B.1]))
sage: f = A.hom([H.0], H)
sage: f.kernel()
Principal ideal (t) of Univariate Polynomial Ring in t over Rational Field
```

whereas the kernel should be the zero ideal.

Issue created by migration from https://trac.sagemath.org/ticket/31367





---

archive/issue_comments_444752.json:
```json
{
    "body": "The problem indeed only occurs with quotient rings, as the implementation switches from the quotient to the cover ring in order to compute an elimination ideal. For this, the elimination variables need to be lifted from the quotient to the cover ring. However, one of the generator variables of the quotient ring is 0 in the example, so `0.lift()` gives 0 again, rather than a variable of the cover ring. I have fixed this by taking the correct variables from the cover ring directly.\n\nIn more detail, the problematic call to `elimination_ideal` is of this kind:\n\n```\nsage: R.<x,y,z> = QQ[]\nsage: R.ideal(x-y, z).elimination_ideal([y, R(0)])\nIdeal (x - y, z) of Multivariate Polynomial Ring in x, y, z over Rational Field\n```\n\nThis is a usage error because it calls `elimination_ideal` with a 0 instead of a variable. The implementation then calls libsingular with the product of the passed variables, which is 0 again, so nothing gets eliminated.\n\nA question that remains is whether `elimination_ideal` should validate its arguments in order to make sure they are all variables of the ring. This can be a different ticket though.\n----\nNew commits:",
    "created_at": "2021-02-10T19:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444752",
    "user": "@mwageringel"
}
```

The problem indeed only occurs with quotient rings, as the implementation switches from the quotient to the cover ring in order to compute an elimination ideal. For this, the elimination variables need to be lifted from the quotient to the cover ring. However, one of the generator variables of the quotient ring is 0 in the example, so `0.lift()` gives 0 again, rather than a variable of the cover ring. I have fixed this by taking the correct variables from the cover ring directly.

In more detail, the problematic call to `elimination_ideal` is of this kind:

```
sage: R.<x,y,z> = QQ[]
sage: R.ideal(x-y, z).elimination_ideal([y, R(0)])
Ideal (x - y, z) of Multivariate Polynomial Ring in x, y, z over Rational Field
```

This is a usage error because it calls `elimination_ideal` with a 0 instead of a variable. The implementation then calls libsingular with the product of the passed variables, which is 0 again, so nothing gets eliminated.

A question that remains is whether `elimination_ideal` should validate its arguments in order to make sure they are all variables of the ring. This can be a different ticket though.
----
New commits:



---

archive/issue_comments_444753.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-02-10T19:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444753",
    "user": "@mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_444754.json:
```json
{
    "body": "The bot is green. Please review.",
    "created_at": "2021-02-14T14:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444754",
    "user": "@mwageringel"
}
```

The bot is green. Please review.



---

archive/issue_comments_444755.json:
```json
{
    "body": "LGTM.",
    "created_at": "2021-02-14T23:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444755",
    "user": "@tscrim"
}
```

LGTM.



---

archive/issue_comments_444756.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-02-14T23:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444756",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_444757.json:
```json
{
    "body": "Thank you.",
    "created_at": "2021-02-15T21:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444757",
    "user": "@mwageringel"
}
```

Thank you.



---

archive/issue_comments_444758.json:
```json
{
    "body": "Replying to [comment:1 gh-mwageringel]:\n> A question that remains is whether `elimination_ideal` should validate its arguments in order to make sure they are all variables of the ring. This can be a different ticket though.\n\nI have created #31414 for validating the input of `elimination_ideal`.",
    "created_at": "2021-02-18T20:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444758",
    "user": "@mwageringel"
}
```

Replying to [comment:1 gh-mwageringel]:
> A question that remains is whether `elimination_ideal` should validate its arguments in order to make sure they are all variables of the ring. This can be a different ticket though.

I have created #31414 for validating the input of `elimination_ideal`.



---

archive/issue_comments_444759.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-03-09T00:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-444759",
    "user": "@vbraun"
}
```

Resolution: fixed
