# Issue 31130: bug in kernel of ring homomorphism of quotient rings

Issue created by migration from https://trac.sagemath.org/ticket/31367

Original creator: @mwageringel

Original creation time: 2021-02-09 10:22:30

CC:  slelievre tscrim

As reported on [sage-devel](https://groups.google.com/g/sage-devel/c/jS5tMpVlrFs):

```
sage: A.<t> = QQ[]
sage: B.<x,y> = QQ[]
sage: H = B.quotient(B.ideal([B.1]))
sage: f = A.hom([H.0], H)
sage: f.kernel()
Principal ideal (t) of Univariate Polynomial Ring in t over Rational Field
```

whereas the kernel should be the zero ideal.


---

Comment by @mwageringel created at 2021-02-10 19:47:25

The problem indeed only occurs with quotient rings, as the implementation switches from the quotient to the cover ring in order to compute an elimination ideal. For this, the elimination variables need to be lifted from the quotient to the cover ring. However, one of the generator variables of the quotient ring is 0 in the example, so `0.lift()` gives 0 again, rather than a variable of the cover ring. I have fixed this by taking the correct variables from the cover ring directly.

In more detail, the problematic call to `elimination_ideal` is of this kind:

```
sage: R.<x,y,z> = QQ[]
sage: R.ideal(x-y, z).elimination_ideal([y, R(0)])
Ideal (x - y, z) of Multivariate Polynomial Ring in x, y, z over Rational Field
```

This is a usage error because it calls `elimination_ideal` with a 0 instead of a variable. The implementation then calls libsingular with the product of the passed variables, which is 0 again, so nothing gets eliminated.

A question that remains is whether `elimination_ideal` should validate its arguments in order to make sure they are all variables of the ring. This can be a different ticket though.
----
New commits:


---

Comment by @mwageringel created at 2021-02-10 19:47:25

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2021-02-14 14:13:12

The bot is green. Please review.


---

Comment by tscrim created at 2021-02-14 23:35:55

LGTM.


---

Comment by tscrim created at 2021-02-14 23:35:55

Changing status from needs_review to positive_review.


---

Comment by @mwageringel created at 2021-02-15 21:06:07

Thank you.


---

Comment by @mwageringel created at 2021-02-18 20:11:31

Replying to [comment:1 gh-mwageringel]:
> A question that remains is whether `elimination_ideal` should validate its arguments in order to make sure they are all variables of the ring. This can be a different ticket though.

I have created #31414 for validating the input of `elimination_ideal`.


---

Comment by vbraun created at 2021-03-09 00:01:37

Resolution: fixed
