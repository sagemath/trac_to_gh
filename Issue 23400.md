# Issue 23400: failing doctest in sage/geometry/polyhedron/backend_normaliz.py (non-sorted)

archive/issues_023400.json:
```json
{
    "body": "CC:  @mkoeppe\n\n\n```\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/backend_normaliz.py\", line 412, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull\nFailed example:\n    set(PI.Vrepresentation())                                # optional - pynormaliz\nExpected:\n    {A vertex at (-1, 0), A vertex at (0, 1), A ray in the direction (1, 0)}\nGot:\n    {A ray in the direction (1, 0), A vertex at (-1, 0), A vertex at (0, 1)}\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/backend_normaliz.py\", line 420, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull\nFailed example:\n    set(PI.Vrepresentation())                                # optional - pynormaliz\nExpected:\n    {A vertex at (1, 0),\n     A ray in the direction (1, 0),\n     A line in the direction (1, -1)}\nGot:\n    {A line in the direction (1, -1),\n     A ray in the direction (1, 0),\n     A vertex at (1, 0)}\n```\n\nreported by patchbot https://patchbot.sagemath.org/log/23633/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-08-17%2016:47:36\n\nIssue created by migration from https://trac.sagemath.org/ticket/23637\n\n",
    "created_at": "2017-08-18T07:11:21Z",
    "labels": [
        "component: doctest framework",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "failing doctest in sage/geometry/polyhedron/backend_normaliz.py (non-sorted)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23400",
    "user": "https://github.com/dkrenn"
}
```
CC:  @mkoeppe


```
**********************************************************************
File "src/sage/geometry/polyhedron/backend_normaliz.py", line 412, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull
Failed example:
    set(PI.Vrepresentation())                                # optional - pynormaliz
Expected:
    {A vertex at (-1, 0), A vertex at (0, 1), A ray in the direction (1, 0)}
Got:
    {A ray in the direction (1, 0), A vertex at (-1, 0), A vertex at (0, 1)}
**********************************************************************
File "src/sage/geometry/polyhedron/backend_normaliz.py", line 420, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull
Failed example:
    set(PI.Vrepresentation())                                # optional - pynormaliz
Expected:
    {A vertex at (1, 0),
     A ray in the direction (1, 0),
     A line in the direction (1, -1)}
Got:
    {A line in the direction (1, -1),
     A ray in the direction (1, 0),
     A vertex at (1, 0)}
```

reported by patchbot https://patchbot.sagemath.org/log/23633/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-08-17%2016:47:36

Issue created by migration from https://trac.sagemath.org/ticket/23637





---

archive/issue_comments_327111.json:
```json
{
    "body": "Duplicate of #23586",
    "created_at": "2017-08-18T07:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327111",
    "user": "https://github.com/jdemeyer"
}
```

Duplicate of #23586



---

archive/issue_comments_327112.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2017-08-18T07:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327112",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_events_060491.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-18T07:22:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60491"
}
```



---

archive/issue_events_060492.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-18T07:22:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60492"
}
```



---

archive/issue_comments_327113.json:
```json
{
    "body": "Replying to [comment:1 jdemeyer]:\n> Duplicate of #23586\n\nThank you; I wasn't aware of this ticket.",
    "created_at": "2017-08-18T07:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327113",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:1 jdemeyer]:
> Duplicate of #23586

Thank you; I wasn't aware of this ticket.



---

archive/issue_comments_327114.json:
```json
{
    "body": "I'm reopening this ticket to server as ticket for solution 1 as described in https://groups.google.com/forum/#!topic/sage-devel/_2vtRbauvrw . I.e. just fix the doctest in pynormaliz itself and not rely on #23586 where the approach is making the doctest framework more robust, which might take longer then we want to wait for.",
    "created_at": "2017-08-29T15:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327114",
    "user": "https://github.com/koffie"
}
```

I'm reopening this ticket to server as ticket for solution 1 as described in https://groups.google.com/forum/#!topic/sage-devel/_2vtRbauvrw . I.e. just fix the doctest in pynormaliz itself and not rely on #23586 where the approach is making the doctest framework more robust, which might take longer then we want to wait for.



---

archive/issue_comments_327115.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2017-08-29T15:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327115",
    "user": "https://github.com/koffie"
}
```

Changing priority from major to blocker.



---

archive/issue_events_060493.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-08-29T15:48:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60493"
}
```



---

archive/issue_events_060494.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-08-29T15:48:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60494"
}
```



---

archive/issue_comments_327116.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2017-08-29T15:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327116",
    "user": "https://github.com/koffie"
}
```

Changing status from closed to new.



---

archive/issue_events_060495.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-08-29T15:48:25Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60495"
}
```



---

archive/issue_comments_327117.json:
```json
{
    "body": "Resolution changed from duplicate to ",
    "created_at": "2017-08-29T15:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327117",
    "user": "https://github.com/koffie"
}
```

Resolution changed from duplicate to 



---

archive/issue_comments_327118.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-08-29T16:03:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327118",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_327119.json:
```json
{
    "body": "I'm going to see if your branch is actually a solution and wether `__cmp__` is deterministic. I suspect not and then this is not really a fix.",
    "created_at": "2017-08-29T16:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327119",
    "user": "https://github.com/koffie"
}
```

I'm going to see if your branch is actually a solution and wether `__cmp__` is deterministic. I suspect not and then this is not really a fix.



---

archive/issue_comments_327120.json:
```json
{
    "body": "I just had a look, and as far as I can see it doesn't use `__cmp__` but it has `__ge__` and friends. And furthermore that these are not overwritten but all inherited from object , and hence not deterministic.",
    "created_at": "2017-08-29T16:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327120",
    "user": "https://github.com/koffie"
}
```

I just had a look, and as far as I can see it doesn't use `__cmp__` but it has `__ge__` and friends. And furthermore that these are not overwritten but all inherited from object , and hence not deterministic.



---

archive/issue_comments_327121.json:
```json
{
    "body": "I agree that my branch is not a solution. Please write one.",
    "created_at": "2017-08-29T16:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327121",
    "user": "https://github.com/fchapoton"
}
```

I agree that my branch is not a solution. Please write one.



---

archive/issue_comments_327122.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-29T17:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327122",
    "user": "https://github.com/koffie"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_327123.json:
```json
{
    "body": "Ok, made the doctests deterministic\n----\nNew commits:",
    "created_at": "2017-08-29T17:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327123",
    "user": "https://github.com/koffie"
}
```

Ok, made the doctests deterministic
----
New commits:



---

archive/issue_comments_327124.json:
```json
{
    "body": "PEP8: `key = str)` -> `key=str)`. Otherwise LGTM and we can finally have these tests being deterministic.",
    "created_at": "2017-08-29T17:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327124",
    "user": "https://github.com/tscrim"
}
```

PEP8: `key = str)` -> `key=str)`. Otherwise LGTM and we can finally have these tests being deterministic.



---

archive/issue_comments_327125.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-29T17:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327125",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_327126.json:
```json
{
    "body": "Ok fixed the formatting issues",
    "created_at": "2017-08-29T17:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327126",
    "user": "https://github.com/koffie"
}
```

Ok fixed the formatting issues



---

archive/issue_comments_327127.json:
```json
{
    "body": "I think this is a good enough (temporary) solution.",
    "created_at": "2017-08-29T17:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327127",
    "user": "https://github.com/tscrim"
}
```

I think this is a good enough (temporary) solution.



---

archive/issue_comments_327128.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-29T17:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327128",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_327129.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-29T20:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327129",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_327130.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2017-08-29T20:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327130",
    "user": "https://github.com/vbraun"
}
```

Merge conflict



---

archive/issue_comments_327131.json:
```json
{
    "body": "Hi Volker,\n\nCould you be a bit more specific, which tickets cause the conflict. Or will there be a new beta4 soon on which I can rebase this. Because this message is not helping.",
    "created_at": "2017-08-29T21:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327131",
    "user": "https://github.com/koffie"
}
```

Hi Volker,

Could you be a bit more specific, which tickets cause the conflict. Or will there be a new beta4 soon on which I can rebase this. Because this message is not helping.



---

archive/issue_comments_327132.json:
```json
{
    "body": "Be patient, You just need to wait for the next beta (end of the week ?).",
    "created_at": "2017-08-30T07:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327132",
    "user": "https://github.com/fchapoton"
}
```

Be patient, You just need to wait for the next beta (end of the week ?).



---

archive/issue_events_060496.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-31T13:17:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60496"
}
```



---

archive/issue_events_060497.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-31T13:17:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60497"
}
```



---

archive/issue_comments_327133.json:
```json
{
    "body": "I'm fixing #23586.",
    "created_at": "2017-08-31T13:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327133",
    "user": "https://github.com/jdemeyer"
}
```

I'm fixing #23586.



---

archive/issue_comments_327134.json:
```json
{
    "body": "Why does this use sets anyway?",
    "created_at": "2017-08-31T13:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327134",
    "user": "https://github.com/jdemeyer"
}
```

Why does this use sets anyway?



---

archive/issue_comments_327135.json:
```json
{
    "body": "Changing component from doctest framework to doctest coverage.",
    "created_at": "2017-08-31T13:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327135",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from doctest framework to doctest coverage.



---

archive/issue_comments_327136.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-31T13:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327136",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_060498.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-31T13:36:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60498"
}
```



---

archive/issue_events_060499.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-31T13:36:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60499"
}
```



---

archive/issue_comments_327137.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-08-31T13:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327137",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_327138.json:
```json
{
    "body": "I believe it uses sets because there is no (natural) ordering on that output. However, I do not know if normaliz and our code has any guarantee on the output order. Maybe Matthias can comment more on this.",
    "created_at": "2017-08-31T13:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327138",
    "user": "https://github.com/tscrim"
}
```

I believe it uses sets because there is no (natural) ordering on that output. However, I do not know if normaliz and our code has any guarantee on the output order. Maybe Matthias can comment more on this.



---

archive/issue_comments_327139.json:
```json
{
    "body": "Replying to [comment:21 tscrim]:\n> I believe it uses sets because there is no (natural) ordering on that output.\n\nWell, clearly `set()` doesn't solve that problem...",
    "created_at": "2017-08-31T14:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327139",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:21 tscrim]:
> I believe it uses sets because there is no (natural) ordering on that output.

Well, clearly `set()` doesn't solve that problem...



---

archive/issue_comments_327140.json:
```json
{
    "body": "Yes we might not need set, but we do need know whether the output orderering albeit being arbitrary, is still deterministic at least. Because if it is not deterministic this still means we have flaky doctests and still need to sort.",
    "created_at": "2017-08-31T15:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327140",
    "user": "https://github.com/koffie"
}
```

Yes we might not need set, but we do need know whether the output orderering albeit being arbitrary, is still deterministic at least. Because if it is not deterministic this still means we have flaky doctests and still need to sort.



---

archive/issue_comments_327141.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-08-31T15:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327141",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_327142.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2017-08-31T22:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327142",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_327143.json:
```json
{
    "body": "Replying to [comment:21 tscrim]:\n> I believe it uses sets because there is no (natural) ordering on that output. However, I do not know if normaliz and our code has any guarantee on the output order. Maybe Matthias can comment more on this.\n\nYes, the order of the output has no significance and to my understanding can change from version to version of normaliz.\nI used `set(...)` in the doctest, based on the misconception that this is the correct idiom. I now understand that I should have used `sorted(...)` instead. I do not agree with the current patch, which just uses the unsorted output as is.",
    "created_at": "2017-08-31T22:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327143",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:21 tscrim]:
> I believe it uses sets because there is no (natural) ordering on that output. However, I do not know if normaliz and our code has any guarantee on the output order. Maybe Matthias can comment more on this.

Yes, the order of the output has no significance and to my understanding can change from version to version of normaliz.
I used `set(...)` in the doctest, based on the misconception that this is the correct idiom. I now understand that I should have used `sorted(...)` instead. I do not agree with the current patch, which just uses the unsorted output as is.



---

archive/issue_comments_327144.json:
```json
{
    "body": "Replying to [comment:24 mkoeppe]:\n> to my understanding can change from version to version of normaliz.\n\nThat's actually not bad at all. There are many doctests which depend on the *version* of a package. If the output is consistent for any given version, it is fine to put that output in the doctest.",
    "created_at": "2017-09-01T12:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327144",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:24 mkoeppe]:
> to my understanding can change from version to version of normaliz.

That's actually not bad at all. There are many doctests which depend on the *version* of a package. If the output is consistent for any given version, it is fine to put that output in the doctest.



---

archive/issue_comments_327145.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-01T12:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327145",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_327146.json:
```json
{
    "body": "I also just verified experimentally that the doctests are stable within a version by running:\n\n\n```\n./sage -t --file-iterations=100 src/sage/geometry/polyhedron/backend_normaliz.py\n```\n\n\nso I agree with Jeroen that his branch solves the main problem of this ticket, namely make the results of the patchbot reliable again. So positive review from me.\n\nI understand that having doctests pass for multiple normaliz versions is something nice to have since it makes it easier to upgrade normaliz. But let's fix that problem for during the next upgrade of normaliz and not waste any more time on this ticket so that we can get consistent patchbot behaviour again.",
    "created_at": "2017-09-01T13:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327146",
    "user": "https://github.com/koffie"
}
```

I also just verified experimentally that the doctests are stable within a version by running:


```
./sage -t --file-iterations=100 src/sage/geometry/polyhedron/backend_normaliz.py
```


so I agree with Jeroen that his branch solves the main problem of this ticket, namely make the results of the patchbot reliable again. So positive review from me.

I understand that having doctests pass for multiple normaliz versions is something nice to have since it makes it easier to upgrade normaliz. But let's fix that problem for during the next upgrade of normaliz and not waste any more time on this ticket so that we can get consistent patchbot behaviour again.



---

archive/issue_comments_327147.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-01T13:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327147",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_327148.json:
```json
{
    "body": "Thank you for the explanation Matthias. However, I agree with Jeroen: the output is deterministic on the version of normaliz (which is bound to the Sage version by our current distribution methods, for better or worse), so directly comparing the output is good and clean as it does not require any extra modification to pass. Another package that we frequently have to update tests for is GAP.",
    "created_at": "2017-09-01T13:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327148",
    "user": "https://github.com/tscrim"
}
```

Thank you for the explanation Matthias. However, I agree with Jeroen: the output is deterministic on the version of normaliz (which is bound to the Sage version by our current distribution methods, for better or worse), so directly comparing the output is good and clean as it does not require any extra modification to pass. Another package that we frequently have to update tests for is GAP.



---

archive/issue_comments_327149.json:
```json
{
    "body": "Replying to [comment:28 tscrim]:\n> Another package that we frequently have to update tests for is GAP.\n\n...and PARI/GP.\n\nThe doctest framework does support `# tol` for numerical differences but not `# generates same group` or whatever for number-theoretical output",
    "created_at": "2017-09-01T14:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327149",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:28 tscrim]:
> Another package that we frequently have to update tests for is GAP.

...and PARI/GP.

The doctest framework does support `# tol` for numerical differences but not `# generates same group` or whatever for number-theoretical output



---

archive/issue_comments_327150.json:
```json
{
    "body": "Replying to [comment:27 mderickx]:\n> I understand that having doctests pass for multiple normaliz versions is something nice to have since it makes it easier to upgrade normaliz. But let's fix that problem for during the next upgrade of normaliz and not waste any more time on this ticket so that we can get consistent patchbot behaviour again.\n\nNo objections here.",
    "created_at": "2017-09-01T15:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327150",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:27 mderickx]:
> I understand that having doctests pass for multiple normaliz versions is something nice to have since it makes it easier to upgrade normaliz. But let's fix that problem for during the next upgrade of normaliz and not waste any more time on this ticket so that we can get consistent patchbot behaviour again.

No objections here.



---

archive/issue_comments_327151.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-09-02T09:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327151",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_327152.json:
```json
{
    "body": "merge conflict",
    "created_at": "2017-09-02T09:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327152",
    "user": "https://github.com/vbraun"
}
```

merge conflict



---

archive/issue_comments_327153.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-09-06T03:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327153",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_327154.json:
```json
{
    "body": "Trivial rebase.\n----\nNew commits:",
    "created_at": "2017-09-06T03:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327154",
    "user": "https://github.com/tscrim"
}
```

Trivial rebase.
----
New commits:



---

archive/issue_events_060500.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-10T22:06:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23400#event-60500"
}
```



---

archive/issue_comments_327155.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-10T22:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23400#issuecomment-327155",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
