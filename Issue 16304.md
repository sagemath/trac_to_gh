# Issue 16304: MOLS table : 10 000 integers

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2014-06-25 16:22:07

CC:  vdelecroix knsam brett

Here it is !

Nathann


---

Comment by ncohen created at 2014-06-25 16:22:18

Changing status from new to needs_review.


---

Comment by git created at 2014-06-25 16:22:54

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by vdelecroix created at 2014-06-25 17:13:13

Cool!

- Would be better if you read the handbook_data.txt only if `compare=True`.
- Would be nice if we could print the table of the handbook itself! Like a `sage/compare/handbook` alternative

Vincent


---

Comment by git created at 2014-06-26 07:37:57

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2014-06-26 07:40:57

I added a "if" to avoid loading the file when it is not necessary. If you want to be able to print the handbook's table you will have to add a commit.

Nathann


---

Comment by vdelecroix created at 2014-06-28 13:41:39

Good to go! (doc builds and doctests pass)

Vincent


---

Comment by vdelecroix created at 2014-06-28 13:41:39

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-06-28 13:42:37

Thanks !

Nathann


---

Comment by vbraun created at 2014-06-29 03:57:32

reviewer name


---

Comment by vbraun created at 2014-06-29 19:17:27

Missing file?

```
sage -t --long src/sage/combinat/designs/latin_squares.py
**********************************************************************
File "src/sage/combinat/designs/latin_squares.py", line 46, in sage.combinat.designs.latin_squares
Failed example:
    MOLS_table(15,compare=True) # long time
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildbot/build/sage/bsd-1/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/buildbot/build/sage/bsd-1/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.combinat.designs.latin_squares[2]>", line 1, in <module>
        MOLS_table(Integer(15),compare=True) # long time
      File "/Users/buildbot/build/sage/bsd-1/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/designs/latin_squares.py", line 470, in MOLS_table
        handbook_file = open("handbook_data.txt",'r')
    IOError: [Errno 2] No such file or directory: 'handbook_data.txt'
**********************************************************************
File "src/sage/combinat/designs/latin_squares.py", line 460, in sage.combinat.designs.latin_squares.MOLS_table
Failed example:
    MOLS_table(5,compare=True) # long time
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildbot/build/sage/bsd-1/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/buildbot/build/sage/bsd-1/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.combinat.designs.latin_squares.MOLS_table[2]>", line 1, in <module>
        MOLS_table(Integer(5),compare=True) # long time
      File "/Users/buildbot/build/sage/bsd-1/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/designs/latin_squares.py", line 470, in MOLS_table
        handbook_file = open("handbook_data.txt",'r')
    IOError: [Errno 2] No such file or directory: 'handbook_data.txt'
**********************************************************************
```



---

Comment by vdelecroix created at 2014-06-29 19:59:20

nope, it is in the commit â€‹29c48c3... I don't understand the error!!

EDIT: and the doctest pass on my computer!

REDIT: actually depending from where you run the computation the test fails or not

from SAGE_ROOT running

```
sage -t src/sage/combinat/designs/latin_squares.py
```

*does* fail!!

Vincent


---

Comment by vdelecroix created at 2014-06-29 20:14:06

Easy solution:

move the file handbook_data.txt into local/share (where most of the raw data belong) and then use

```
import os.path
from sage.misc.misc import SAGE_SHARE
handbook_file = open(os.path.join(SAGE_SHARE, "handbook_data.txt"),'r')
...
```


What do you think Nathann?

Vincent


---

Comment by vdelecroix created at 2014-06-29 20:14:26

Changing status from positive_review to needs_work.


---

Comment by vdelecroix created at 2014-06-29 20:18:33

All right, proposition at "public/16541v2"?

By the way Nathann, there is no license issue with copying the whole MOLS table from the handbook?

Vincent


---

Comment by ncohen created at 2014-06-30 07:03:24

> All right, proposition at "public/16541v2"?
> 
> By the way Nathann, there is no license issue with copying the whole MOLS table from the handbook?

You mean that whoever copies/paste Sage's table of MOLS in a paper has to publish it in open access, or that whoever uses our table in a software has to license it with the GPL ? `:-P`

I take it as a mathematical result. Or 10 000 mathematical results. Of which a good part has been obtained with Sage's functions `;-)`

Nathann


---

Comment by ncohen created at 2014-06-30 07:04:22

Yo !

> Easy solution:
> 
> move the file handbook_data.txt into local/share (where most of the raw data belong) and then use
> {{{
> import os.path
> from sage.misc.misc import SAGE_SHARE
> handbook_file = open(os.path.join(SAGE_SHARE, "handbook_data.txt"),'r')
> ...
> }}}
> 
> What do you think Nathann?

I don't know if I can just write a file to `SAGE_SHARE` or if it has to go through a SPKG `-_-`

Nathann


---

Comment by git created at 2014-06-30 07:24:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2014-06-30 07:26:15

Branch updated with a new "designs" spkg. And the tar.bz2 that should be located in SAGE_ROOT/upstream/ is there : 

http://www.steinertriples.fr/ncohen/tmp/designs-20140630.tar.bz2

Nathann


---

Comment by ncohen created at 2014-06-30 07:26:15

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2014-06-30 07:59:09

Hi Nathann,

You are probably right with the spkg. In order to work, the spkg needs to be in standard but the policy is that new spkg goes into optional. Either you write a try/except in the function to test whether the file is here or you ask on sage-devel is everybody is ok to add a trivial text file to the list of standard spkg (the file is really like the database of conway polynomials, si I guess this is fine).

Vincent


---

Comment by vdelecroix created at 2014-06-30 07:59:20

Changing status from needs_review to needs_info.


---

Comment by ncohen created at 2014-06-30 08:00:38

> You are probably right with the spkg. In order to work, the spkg needs to be in standard but the policy is that new spkg goes into optional.

I don't think that anybody is stupid enough to tell me that I need to wait one year to add a text file into Sage.

I will write to Sage, if that's a problem.

Nathann


---

Comment by vbraun created at 2014-06-30 13:35:32

I'm ok with making it a standard spkg. Note that, by definition, this means that it is installed by default. You need a corresponding entry in `build/deps` for that.

A more specific name than "designs" would be nice, maybe "combinatorial_designs". But design alone isn't even unique in math, e.g. dessins d'enfants.

A saner way to install the file would be to mkdir -p the target directory and then just copy the file. Blowing the whole directory away is unnecessary and potentially counterproductive in the future, maybe you'll add an optional huge database later on. Not to mention umasks.


---

Comment by git created at 2014-06-30 13:46:45

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2014-06-30 13:47:00

Changing status from needs_info to needs_review.


---

Comment by ncohen created at 2014-06-30 13:47:00

New commits:


---

Comment by ncohen created at 2014-06-30 13:47:51

Is that right ?

Nathann


---

Comment by vdelecroix created at 2014-07-03 07:04:53

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2014-07-03 07:04:53

At least for me this is good!

Vincent


---

Comment by vbraun created at 2014-07-03 12:46:26

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-07-03 12:46:26

Can you add a `== License ==` section? Data cannot be copyrighted, but the way it is stored in a database is. Not specifying a license means we are not allowed to distribute it.


---

Comment by ncohen created at 2014-07-03 13:06:10

And what should I put there ? GPL2 or something ? Is that a correct license for data ?

Nathann


---

Comment by ncohen created at 2014-07-03 13:06:29

Besides how can I give a license to a data I just found in a book ? `O_o`


---

Comment by vbraun created at 2014-07-03 13:58:48

GPL or Public Domain is fine. The data is not copyrighted, its the presentation. You choose the license since you curated the electronic database (even if its a bit silly in this case).


---

Comment by git created at 2014-07-03 14:01:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-07-03 14:01:15

Okay....

Nathann


---

Comment by ncohen created at 2014-07-03 14:01:15

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2014-07-03 14:31:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-07-05 18:18:32

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-07-05 18:18:32

Code still refers to `designs/MOLS_table.txt`. Also, I'd recommend to use os.path.join to concatenate paths.


---

Comment by ncohen created at 2014-07-05 19:13:27

Arg, sorry... And obviously doctests passed because the file was installed on my computed `T_T`

Nathann


---

Comment by git created at 2014-07-05 19:30:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-07-05 19:35:49

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2014-07-06 00:06:53

Its still not installed by default. You also need to define the `COMBINATORIAL_DESIGNS` variable somewhere, there should be a corresponding line `COMBINATORIAL_DESGINS=newest_version combinatorial_designs`(or so, with corrected backticks) in `build/install`


---

Comment by vbraun created at 2014-07-06 00:06:53

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-07-06 07:44:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-07-06 07:44:57

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2014-07-16 07:44:36

ping ?


---

Comment by ncohen created at 2014-07-28 11:17:31

Pom Pom Pom ...


---

Comment by vdelecroix created at 2014-07-28 13:45:55

Everything went fine on my computer... I set it to positive review.

Vincent


---

Comment by vdelecroix created at 2014-07-28 13:45:55

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-07-28 16:27:04

Resolution: fixed


---

Comment by vbraun created at 2014-07-29 23:47:09

Fix for the graph database boo-boo in #16735
