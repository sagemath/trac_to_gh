# Issue 10847: Better error messages for bad arrow plots

Issue created by migration from https://trac.sagemath.org/ticket/10925

Original creator: kcrisman

Original creation time: 2011-03-13 01:49:09

Assignee: jason, was

CC:  jason ryan

Keywords: beginner

The error messages for bad arrow setups are somewhat amusing.

```
sage: version()
'Sage Version 4.6.2, Release Date: 2011-02-25'
sage: arrow([1,2,1],[2,1])
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (2, 0))

ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (844, 0))

---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/plot/arrow.pyc in arrow(tailpoint, headpoint, **kwds)
    342     except ValueError:
    343         from sage.plot.plot3d.shapes import arrow3d
--> 344         return arrow3d(tailpoint, headpoint, **kwds)
    345 
    346 @rename_keyword(color='rgbcolor')

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)
    571                     kwds[new_name] = kwds[old_name]
    572                     del kwds[old_name]
--> 573             return func(*args, **kwds)
    574         
    575         return wrapper

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/plot/plot3d/shapes.so in sage.plot.plot3d.shapes.arrow3d (sage/plot/plot3d/shapes.c:5870)()

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/structure/element.so in sage.structure.element.ModuleElement.__sub__ (sage/structure/element.c:8080)()

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6996)()

TypeError: unsupported operand parent(s) for '-': 'Vector space of dimension 2 over Real Double Field' and 'Vector space of dimension 3 over Real Double Field'
```

and 

```
sage: arrow([1],[1])
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (2, 0))

---------------------------------------------------------------------------
ArithmeticError                           Traceback (most recent call last)
/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/plot/arrow.pyc in arrow(tailpoint, headpoint, **kwds)
    342     except ValueError:
    343         from sage.plot.plot3d.shapes import arrow3d
--> 344         return arrow3d(tailpoint, headpoint, **kwds)
    345 
    346 @rename_keyword(color='rgbcolor')

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)
    571                     kwds[new_name] = kwds[old_name]
    572                     del kwds[old_name]
--> 573             return func(*args, **kwds)
    574         
    575         return wrapper

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/plot/plot3d/shapes.so in sage.plot.plot3d.shapes.arrow3d (sage/plot/plot3d/shapes.c:6038)()

/Applications/MathApps/sage/local/lib/python2.6/site-packages/sage/modules/free_module_element.so in sage.modules.free_module_element.FreeModuleElement.cross_product (sage/modules/free_module_element.c:10882)()

ArithmeticError: Cross product only defined for vectors of length three or seven, not (3 and 1)
```

I leave the traces in for those who want to fix this; tentatively saying beginner.  Ideally, we should plot one-dimensional arrows as well (such as how we plot one-dimensional vectors), or should this remain impossible?


---

Comment by git created at 2014-05-30 04:55:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by philwilt created at 2014-06-01 04:14:56

Changing status from new to needs_review.


---

Comment by kcrisman created at 2014-08-27 19:10:33

This seems really complicated.  Would it be easier to just do 

```
try:
    if len(headpoint) !=  len(tail point):
        stuff
    elif
except TypeError # kind of error when you ask for len of something that doesn't have it
    make into lists like you do
```

I get what this code is doing but I'm afraid it's going to be hard to maintain.  I don't know how much of an efficiency gain your solution might be, though, or maybe there are too many cases anyway no matter how you do it.

What do you think?  By the way, it needs doctests of the "bad" cases (there should be examples of traceback doctesting in nearby code, I think, for sure elsewhere in the plot modules).   Thanks for working on this, it's close!


---

Comment by kcrisman created at 2014-10-22 18:11:52

Changing status from needs_review to needs_work.


---

Comment by kkiviat created at 2017-03-05 13:52:16

New commits:


---

Comment by kkiviat created at 2017-03-05 13:52:16

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2018-01-06 00:03:49

Changing status from needs_review to needs_work.


---

Comment by @DaveWitteMorris created at 2020-05-27 02:57:10

Changing keywords from "beginner" to "".


---

Comment by @DaveWitteMorris created at 2020-05-27 02:57:10

Removing the "beginner" tag from old tickets. Some could be returned to beginner-friendly status by adding a comment about what needs to be done. Some others might be easy for an experienced developer to finish.
