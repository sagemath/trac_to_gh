# Issue 13532: add content method to symbolic expressions

archive/issues_013532.json:
```json
{
    "body": "Assignee: burcin\n\nAttached patch provides a thin wrapper around the `content()` method in pynac.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13736\n\n",
    "created_at": "2012-11-21T14:23:53Z",
    "labels": [
        "symbolics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.11",
    "title": "add content method to symbolic expressions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13532",
    "user": "burcin"
}
```
Assignee: burcin

Attached patch provides a thin wrapper around the `content()` method in pynac.

Issue created by migration from https://trac.sagemath.org/ticket/13736





---

archive/issue_comments_167285.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-11-21T14:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167285",
    "user": "burcin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_167286.json:
```json
{
    "body": "Attachment [trac_13736-content.patch](tarball://root/attachments/some-uuid/ticket13736/trac_13736-content.patch) by burcin created at 2012-11-21 14:37:39",
    "created_at": "2012-11-21T14:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167286",
    "user": "burcin"
}
```

Attachment [trac_13736-content.patch](tarball://root/attachments/some-uuid/ticket13736/trac_13736-content.patch) by burcin created at 2012-11-21 14:37:39



---

archive/issue_comments_167287.json:
```json
{
    "body": "Is \"content\" a well-known thing (especially for non-polynomials)?  I did find the definition in the Ginac documentation, but this should probably be slightly clarified since it will show up in the tab-completion.    Especially since this doesn't provide the corresponding `unit` and `primpart` methods (which might even be confused with other things in algebra) I'm reluctant for this to go in by itself.  Also,\n\n```\nsage: (2*x+4*sin(y)).content(2*x)\n2*x + 4*sin(y)\n```\n\nand things like that seem to not really be in the spirit of this.  If anything, shouldn't this content be `1`?  Or should this be disallowed?  I don't think it can be considered user error with such minimal doc of an unfamiliar term.\n\nThat said, I realize this is needed for #13609 and hence #13729, so I will try to be responsive to any responses!",
    "created_at": "2012-11-21T16:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167287",
    "user": "kcrisman"
}
```

Is "content" a well-known thing (especially for non-polynomials)?  I did find the definition in the Ginac documentation, but this should probably be slightly clarified since it will show up in the tab-completion.    Especially since this doesn't provide the corresponding `unit` and `primpart` methods (which might even be confused with other things in algebra) I'm reluctant for this to go in by itself.  Also,

```
sage: (2*x+4*sin(y)).content(2*x)
2*x + 4*sin(y)
```

and things like that seem to not really be in the spirit of this.  If anything, shouldn't this content be `1`?  Or should this be disallowed?  I don't think it can be considered user error with such minimal doc of an unfamiliar term.

That said, I realize this is needed for #13609 and hence #13729, so I will try to be responsive to any responses!



---

archive/issue_comments_167288.json:
```json
{
    "body": "Thanks for looking into this.\n\nI can rename the function to `_content()` and add a warning that the behavior is not well defined. I doubt if we will ever have proper input error checking or consistency with Sage's description of content for various domains. I definitely don't have time to implement this.",
    "created_at": "2012-11-21T16:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167288",
    "user": "burcin"
}
```

Thanks for looking into this.

I can rename the function to `_content()` and add a warning that the behavior is not well defined. I doubt if we will ever have proper input error checking or consistency with Sage's description of content for various domains. I definitely don't have time to implement this.



---

archive/issue_comments_167289.json:
```json
{
    "body": "Okay, this seems like a reasonable compromise - it can be used for the purposes we need it for and not have it be something that unsuspecting new Algebra students will rely on.  I assume the `_content` version will still suffice for the needs in #13609?",
    "created_at": "2012-11-23T16:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167289",
    "user": "kcrisman"
}
```

Okay, this seems like a reasonable compromise - it can be used for the purposes we need it for and not have it be something that unsuspecting new Algebra students will rely on.  I assume the `_content` version will still suffice for the needs in #13609?



---

archive/issue_comments_167290.json:
```json
{
    "body": "Replying to [comment:4 kcrisman]:\n> Okay, this seems like a reasonable compromise - it can be used for the purposes we need it for and not have it be something that unsuspecting new Algebra students will rely on.  I assume the `_content` version will still suffice for the needs in #13609?\n\nYes, it will do. I will upload a new patch once I settle on the correct solution of #13609. I don't expect to have time for this till next weekend though.",
    "created_at": "2012-11-24T11:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167290",
    "user": "burcin"
}
```

Replying to [comment:4 kcrisman]:
> Okay, this seems like a reasonable compromise - it can be used for the purposes we need it for and not have it be something that unsuspecting new Algebra students will rely on.  I assume the `_content` version will still suffice for the needs in #13609?

Yes, it will do. I will upload a new patch once I settle on the correct solution of #13609. I don't expect to have time for this till next weekend though.



---

archive/issue_comments_167291.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-11-24T11:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167291",
    "user": "burcin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_167292.json:
```json
{
    "body": "This ticket seems to be a the bottom of the dependency chain for a few pynac-related patches... I'd be happy to review it when ready ;-)",
    "created_at": "2013-05-07T17:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167292",
    "user": "vbraun"
}
```

This ticket seems to be a the bottom of the dependency chain for a few pynac-related patches... I'd be happy to review it when ready ;-)



---

archive/issue_comments_167293.json:
```json
{
    "body": "Attachment [trac_13736-content-take2.patch](tarball://root/attachments/some-uuid/ticket13736/trac_13736-content-take2.patch) by burcin created at 2013-05-07 17:33:43",
    "created_at": "2013-05-07T17:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167293",
    "user": "burcin"
}
```

Attachment [trac_13736-content-take2.patch](tarball://root/attachments/some-uuid/ticket13736/trac_13736-content-take2.patch) by burcin created at 2013-05-07 17:33:43



---

archive/issue_comments_167294.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-05-07T17:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167294",
    "user": "burcin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_167295.json:
```json
{
    "body": "It would be less confusing if we also wrap GiNaC unit and primpart and copy in some of the documentation\n\n```\nThe methods\n\n     ex ex::unit(const ex & x);\n     ex ex::content(const ex & x);\n     ex ex::primpart(const ex & x);\n     ex ex::primpart(const ex & x, const ex & c);\n\nreturn the unit part, content part, and primitive polynomial of a\nmultivariate polynomial with respect to the variable \u2018x\u2019 (the\nunit part being the sign of the leading coefficient, the content\npart being the GCD of the coefficients, and the primitive\npolynomial being the input polynomial divided by the unit and\ncontent parts). The second variant of primpart() expects the\npreviously calculated content part of the polynomial in c, which\nenables it to work faster in the case where the content part has\nalready been computed. The product of unit, content, and\nprimitive part is the original polynomial.\n```\n\nThis is `FactorTermsList[poly, x]` in Mathematica, so perhaps we can have a non-underscore method that returns all three?",
    "created_at": "2013-05-09T09:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167295",
    "user": "vbraun"
}
```

It would be less confusing if we also wrap GiNaC unit and primpart and copy in some of the documentation

```
The methods

     ex ex::unit(const ex & x);
     ex ex::content(const ex & x);
     ex ex::primpart(const ex & x);
     ex ex::primpart(const ex & x, const ex & c);

return the unit part, content part, and primitive polynomial of a
multivariate polynomial with respect to the variable ‘x’ (the
unit part being the sign of the leading coefficient, the content
part being the GCD of the coefficients, and the primitive
polynomial being the input polynomial divided by the unit and
content parts). The second variant of primpart() expects the
previously calculated content part of the polynomial in c, which
enables it to work faster in the case where the content part has
already been computed. The product of unit, content, and
primitive part is the original polynomial.
```

This is `FactorTermsList[poly, x]` in Mathematica, so perhaps we can have a non-underscore method that returns all three?



---

archive/issue_comments_167296.json:
```json
{
    "body": "I've taken the liberty to write the patch ;-) Feel free to set to positive review if you agree with it.",
    "created_at": "2013-05-09T10:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167296",
    "user": "vbraun"
}
```

I've taken the liberty to write the patch ;-) Feel free to set to positive review if you agree with it.



---

archive/issue_comments_167297.json:
```json
{
    "body": "instructions for the bot:\n\napply trac_13736-content-take2.patch trac_13736-unit_primpart.patch",
    "created_at": "2013-05-24T11:41:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167297",
    "user": "chapoton"
}
```

instructions for the bot:

apply trac_13736-content-take2.patch trac_13736-unit_primpart.patch



---

archive/issue_comments_167298.json:
```json
{
    "body": "Attachment [trac_13736-unit_primpart.patch](tarball://root/attachments/some-uuid/ticket13736/trac_13736-unit_primpart.patch) by vbraun created at 2013-06-17 22:50:01\n\nUpdated patch",
    "created_at": "2013-06-17T22:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167298",
    "user": "vbraun"
}
```

Attachment [trac_13736-unit_primpart.patch](tarball://root/attachments/some-uuid/ticket13736/trac_13736-unit_primpart.patch) by vbraun created at 2013-06-17 22:50:01

Updated patch



---

archive/issue_comments_167299.json:
```json
{
    "body": "Looks good to me. We can switch this to positive review when the patchbot gets around to testing it.",
    "created_at": "2013-06-17T22:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167299",
    "user": "burcin"
}
```

Looks good to me. We can switch this to positive review when the patchbot gets around to testing it.



---

archive/issue_comments_167300.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd48\".",
    "created_at": "2013-06-17T22:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167300",
    "user": "burcin"
}
```

Changing keywords from "" to "sd48".



---

archive/issue_comments_167301.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-06-17T23:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167301",
    "user": "burcin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_167302.json:
```json
{
    "body": "So ... it's okay that `content` isn't a hidden method?",
    "created_at": "2013-06-18T19:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167302",
    "user": "kcrisman"
}
```

So ... it's okay that `content` isn't a hidden method?



---

archive/issue_comments_167303.json:
```json
{
    "body": "Replying to [comment:13 kcrisman]:\n> So ... it's okay that `content` isn't a hidden method?\n\nHaving `primpart()` and `unit()` available clarifies what these functions do. The answers they return are what one would expect as long as no exotic coefficients are involved. I don't know what would happen if you have a polynomial where the coefficients live in different domains. But this is the case for most symbolics functionality. I say we merge this and see if anyone complains. :)\n\nThat said, I don't understand why the patchbot complains about startup time. These patches should not effect that at all.",
    "created_at": "2013-06-18T20:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167303",
    "user": "burcin"
}
```

Replying to [comment:13 kcrisman]:
> So ... it's okay that `content` isn't a hidden method?

Having `primpart()` and `unit()` available clarifies what these functions do. The answers they return are what one would expect as long as no exotic coefficients are involved. I don't know what would happen if you have a polynomial where the coefficients live in different domains. But this is the case for most symbolics functionality. I say we merge this and see if anyone complains. :)

That said, I don't understand why the patchbot complains about startup time. These patches should not effect that at all.



---

archive/issue_comments_167304.json:
```json
{
    "body": "There might be unaccounted-for systematics in the startup timing code like hdd location and cylinder alignment. We are also talking about a tiny increase, too. And the probability is not *that* high. We have seen somewhat unexpected effects before, its not clear where it comes from.",
    "created_at": "2013-06-18T20:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167304",
    "user": "vbraun"
}
```

There might be unaccounted-for systematics in the startup timing code like hdd location and cylinder alignment. We are also talking about a tiny increase, too. And the probability is not *that* high. We have seen somewhat unexpected effects before, its not clear where it comes from.



---

archive/issue_comments_167305.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-06-19T12:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13532#issuecomment-167305",
    "user": "jdemeyer"
}
```

Resolution: fixed
