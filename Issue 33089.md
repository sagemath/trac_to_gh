# Issue 33089: Maxima (Zeilberger) gives incorrect sum of polynomial with binomial coefficients

Issue created by migration from https://trac.sagemath.org/ticket/33326

Original creator: @DaveWitteMorris

Original creation time: 2022-02-12 05:05:49

Keywords: maxima, sum, binomial, Zeilberger

As reported on [sage-devel](https://groups.google.com/g/sage-devel/c/G7Jxm42sTIo/m/cS8jpJ19BgAJ), maxima (and therefore sage) calculates the following sum incorrectly (but gives the correct answer when the constant `1` is changed to the variable `y`:

```
sage: s, n, x, y, t = var('s, n, x, y, t')
sage: sum(binomial(n,s) * (x + 1)^s * x^(n-s), s, 0, n)  # should be (2*x + 1)^n
(2*x)^n
sage: sum(binomial(n,s) * (x + y)^s * x^(n-s), s, 0, n)  # correct
(2*x + y)^n
```

The problem is in maxima. More precisely, as will be explained in the maxima bug report, the Zeilberger method computes an incorrect recurrence relation.

Related ticket: #31844. (In this related bug, Zeilberger computes the correct recurrence relation, but the wrong initial condition.)


---

Comment by @DaveWitteMorris created at 2022-02-12 05:09:40

Fyi, `maple` and `giac` get the correct answer (but in more complicated forms):

```
sage: sum(binomial(n,s) * (x + 1)^s * x^(n-s), s, 0, n, algorithm="maple")
x^n*((2*x + 1)/x)^n
sage: sum(binomial(n,s) * (x + 1)^s * x^(n-s), s, 0, n, algorithm="giac")
x^n*e^(n*log(2*x + 1) - n*log(x))
```

Sage doesn't understand `sympy`'s answer, so I don't know whether it is correct:

```
sage: sum(binomial(n,s) * (x + 1)^s * x^(n-s), s, 0, n, algorithm="sympy")
     ...
NotImplementedError: conversion to SageMath is not implemented
```



---

Comment by @DaveWitteMorris created at 2022-02-12 05:37:48

This is now [maxima bug #3940](https://sourceforge.net/p/maxima/bugs/3940/).


---

Comment by chapoton created at 2022-02-12 08:30:50

Sympy says

```
x**n*Piecewise(((1 + (x + 1)/x)**n, ((re(n) <= -1) & (Abs((x + 1)/x) < 1)) | ((re(n) > 0) & (Abs((x + 1)/x) <= 1)) | ((re(n) <= 0) & (re(n) > -1) & Ne((x + 1)/x, -1) & (Abs((x + 1)/x) <= 1))), (Sum((x + 1)**s*binomial(n, s)/x**s, (s, 0, n)), True))
```

