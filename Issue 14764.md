# Issue 14764: PPL 1.0 does not build on Cygwin

Issue created by migration from https://trac.sagemath.org/ticket/15001

Original creator: jpflori

Original creation time: 2013-08-05 13:16:10

CC:  vbraun jdemeyer tscrim

Keywords: cygwin ppl spkg

PPL 1.0 uses some libm long double functions (floorl, frexpl) as soon as it detects the long double type is available and looks functional.
Unfortunately the Cygwin's libm does not provide such function, and we do not build Cephes on Cygwin.

The easy solution is to use plain double precision in place of the extended ones (with a std:: prefix, as PPL also defines its own floor function).
This is what is implemented in 1.1.pre* releases of ppl available at http://bugseng.com/products/ppl/download/ftp/snapshots/.

There was a similar report archived at http://www.cs.unipr.it/pipermail/ppl-devel/2012-September/018538.html.


---

Comment by jpflori created at 2013-08-05 13:56:05

A straight update to ppl-1.1pre9 solves the issue.
(I've not run any of the PPL or Sage testsuites yet.)

Would it make sense to update to such a release?
Or should we backport the needed patches?
I have no idea how stable the PPL prereleases are.
Maybe Volker who is the spkg maintainer according to SPKG.txt has a better idea of the stability of such releases?


---

Comment by jdemeyer created at 2013-08-05 14:21:19

There are precedents of using pre-release versions in Sage packages. So, if it doesn't break anything, that's fine for me. *Just make sure you clearly label the version as being a pre-release and document where/how you obtained it*. Don't simply call the package `ppl-1.1.spkg`


---

Comment by jdemeyer created at 2013-08-05 14:25:49

Also, it must be a *public release*. "Some developer sent me this tarball" isn't good enough.


---

Comment by vbraun created at 2013-08-05 14:34:17

Alternatively you can probably disable the floating-point features with the configure switch `--disable-fpmath`. They are not used by Sage and we only enabled them because it tends to break stuff linked against the system ppl library (did I mention that abusing `LD_LIBRARY_PATH` sucks?)


---

Comment by jpflori created at 2013-08-05 14:39:26

As you can see in the ticket description, it is a public release, available at http://bugseng.com/external/ppl/download/ftp/

Note though that it seems only one "snapshot" is available at a given time, so when a new one is released, the previous one will disapppear.
And it does not seem trivial to get the right commit from the PPL git server (no recent branches or tags), though it seems that for some time the (pre)release version are "tagged" with a "Version number bumped" commit message, e.g. http://www.cs.unipr.it/git/gitweb.cgi?p=ppl/ppl.git;a=commit;h=f1487c86784d0b54d566502957b8ae5993bf32b8


---

Comment by jpflori created at 2013-08-05 14:40:42

Replying to [comment:4 vbraun]:
> Alternatively you can probably disable the floating-point features with the configure switch `--disable-fpmath`. 
That should do the trick from what I saw in the build system files ...
>They are not used by Sage and we only enabled them because it tends to break stuff linked against the system ppl library (did I mention that abusing `LD_LIBRARY_PATH` sucks?)
... but I guess it could be more error-prone then.


---

Comment by jpflori created at 2013-08-06 21:27:26

Spkg diff, for review only.


---

Comment by jpflori created at 2013-08-06 21:29:15

Changing status from new to needs_review.


---

Attachment


---

Comment by vbraun created at 2013-08-06 22:40:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2013-08-06 22:40:13

Looks good to me. I trust that it fixes the Cygwin problem since I can't try that myself.


---

Comment by jdemeyer created at 2013-08-10 06:38:28

Resolution: fixed
