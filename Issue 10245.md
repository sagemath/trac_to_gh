# Issue 10245: Can't get symbol from callable function x |--> x

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2010-11-10 15:48:07

Assignee: burcin

CC:  jason

Keywords: plot

From [this](http://ask.sagemath.org/question/198/plotting-x-free-variable-error) ask.sagemath question:


```
I was plotting sin(x)/x and also wanted a seperate plot of sin(x) and x so I could visualize those components as well. However I get an error when plotting x saying "free variable x -> x". If I add a coefficient to h(x) such as h(x) = 1.0001*x then it works fine.

This is the code I am using:

f(x) = sin(x)/x
g(x) = sin(x)
h(x) = x

fig1 = plot(f,-10,10,rgbcolor='green')
fig2 = plot(g,-10,10,rgbcolor='purple')
fig3 = plot(h,-10,10,rgbcolor='red')

figure = fig1 + fig2 + fig3
show(figure,xmin=-10,xmax=10,ymin=-10,ymax=10,figsize=[8,8],fontsize=20)
```


The underlying problem is 

```
The exception arises in `sage.symbolic.expression_conversions.FastFloatConverter.symbol`:

            try:
                return self.ff.fast_float_constant(float(ex))
            except TypeError:
                raise ValueError, "free variable: %s" % repr(ex)

so that it assumes if a callable expression doesn't have the variable, it must be a constant.  However, it before this asks for `if name in vars` and `if name in svars`, but here the `name` is `'x |--> x'`.

So what we need to do is fix it so that if the operator is `None` in the previous traceback in your error message, we check for this case explicitly, where the name isn't just one of the variables.
```



---

Comment by kcrisman created at 2011-03-15 15:44:19

See also [this ask.sagemath.org question](http://ask.sagemath.org/question/437/valueerror-free-variable-x-x-when-plotting-the) where exactly the same thing comes up.

I'm putting this as 'beginner', and moving to 'critical', though that is pretty meaningless... Anyway, it's really dumb that we can't plot x.


---

Comment by kcrisman created at 2011-03-15 15:44:19

Changing keywords from "plot" to "plot, beginner".


---

Comment by kcrisman created at 2011-03-15 15:44:19

Changing priority from major to critical.


---

Comment by kcrisman created at 2011-03-16 12:09:01

Based on 4.7.alpha1


---

Comment by kcrisman created at 2011-03-16 12:11:18

Changing status from new to needs_review.


---

Attachment

Ready for review.   This should fix the problem, and I tried to do it in a relatively elegant way.  Unfortunately, there really is no such elegant way, since `symbol` shouldn't be relying on strings anyway, right?  Oh well.


---

Comment by mhansen created at 2011-04-04 12:09:42

Looks good to me.


---

Comment by mhansen created at 2011-04-04 12:09:42

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-04-07 08:38:27

Resolution: fixed
