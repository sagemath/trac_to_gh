# Issue 26196: Slowness in generic quo_rem

archive/issues_026196.json:
```json
{
    "body": "While working on #26405, I noticed that the generic implementation of `quo_rem` is very slow. Indeed, compare:\n\n\n```\nsage: R = Zp(2)\nsage: S.<x> = R[]\nsage: P = S.random_element(degree=100)\nsage: a = R.random_element()\nsage: %timeit _ = P % (x-a)\n1000 loops, best of 3: 1.64 ms per loop\nsage: %timeit _ = P(a)\n10000 loops, best of 3: 81.9 \u00b5s per loop\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26433\n\n",
    "created_at": "2018-10-08T22:19:29Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "Slowness in generic quo_rem",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26196",
    "user": "https://github.com/xcaruso"
}
```
While working on #26405, I noticed that the generic implementation of `quo_rem` is very slow. Indeed, compare:


```
sage: R = Zp(2)
sage: S.<x> = R[]
sage: P = S.random_element(degree=100)
sage: a = R.random_element()
sage: %timeit _ = P % (x-a)
1000 loops, best of 3: 1.64 ms per loop
sage: %timeit _ = P(a)
10000 loops, best of 3: 81.9 µs per loop
```


Issue created by migration from https://trac.sagemath.org/ticket/26433





---

archive/issue_comments_368702.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-08T23:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_368703.json:
```json
{
    "body": "Timings are now:\n\n\n```\nsage: %timeit _ = P % Q\n1000 loops, best of 3: 210 \u00b5s per loop\n```\n",
    "created_at": "2018-10-08T23:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368703",
    "user": "https://github.com/xcaruso"
}
```

Timings are now:


```
sage: %timeit _ = P % Q
1000 loops, best of 3: 210 µs per loop
```




---

archive/issue_comments_368704.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-08T23:16:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368704",
    "user": "https://github.com/xcaruso"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_368705.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-08T23:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368705",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_368706.json:
```json
{
    "body": "I made a few Cython improvements. I also pulled out the `if` statement because I felt the code duplication was minimal and it would be better to avoid doing the if check every time in the loop.\n\nIf my changes are good, then positive review (with the author name is filled in).",
    "created_at": "2018-10-10T00:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368706",
    "user": "https://github.com/tscrim"
}
```

I made a few Cython improvements. I also pulled out the `if` statement because I felt the code duplication was minimal and it would be better to avoid doing the if check every time in the loop.

If my changes are good, then positive review (with the author name is filled in).



---

archive/issue_comments_368707.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-10-10T00:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_368708.json:
```json
{
    "body": "LGTM.",
    "created_at": "2018-10-10T14:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368708",
    "user": "https://github.com/xcaruso"
}
```

LGTM.



---

archive/issue_comments_368709.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-10T14:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368709",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_368710.json:
```json
{
    "body": "The patchbot reports one failing doctest in `src/sage/geometry/polyhedron/library.py` but I guess it is not related to this ticket (and the test passes on my computer).",
    "created_at": "2018-10-11T01:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368710",
    "user": "https://github.com/xcaruso"
}
```

The patchbot reports one failing doctest in `src/sage/geometry/polyhedron/library.py` but I guess it is not related to this ticket (and the test passes on my computer).



---

archive/issue_events_065710.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-20T11:58:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26196#event-65710"
}
```



---

archive/issue_comments_368711.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-20T11:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368711",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_368712.json:
```json
{
    "body": "This should be re-targeted for 8.5.",
    "created_at": "2018-10-28T14:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368712",
    "user": "https://github.com/embray"
}
```

This should be re-targeted for 8.5.



---

archive/issue_events_065711.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T14:52:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26196#event-65711"
}
```



---

archive/issue_comments_368713.json:
```json
{
    "body": "A regression that may be due to this change: #26433.",
    "created_at": "2018-12-17T11:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368713",
    "user": "https://github.com/mezzarobba"
}
```

A regression that may be due to this change: #26433.



---

archive/issue_comments_368714.json:
```json
{
    "body": "See #26907.",
    "created_at": "2018-12-17T11:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26196#issuecomment-368714",
    "user": "https://github.com/tscrim"
}
```

See #26907.
