# Issue 25449: Converting IntegerMod_int64 to IntegerMod_int

archive/issues_025212.json:
```json
{
    "body": "The following code fails for all primes between 46349 and 65521, i.e., the primes between `sqrt(2^31-1)` and `2^16`.\n\n```python\nsage: k = GF(55667)\nsage: F.<x> = FunctionField(k)\nsage: R.<t> = k[]\nsage: t(x)\nTypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n```\n\n\nCC:  @saraedum\n\nBranch/Commit: 21e99818a6758436e2f61c1a8e0b09889f09318c\n\nReviewer: Simon Brandhorst, Stefan Wewers\n\nAuthor: Julian R\u00fcth\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25449\n\n",
    "closed_at": "2018-08-05T08:18:12Z",
    "created_at": "2018-05-27T14:16:47Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Converting IntegerMod_int64 to IntegerMod_int",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25449",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```
The following code fails for all primes between 46349 and 65521, i.e., the primes between `sqrt(2^31-1)` and `2^16`.

```python
sage: k = GF(55667)
sage: F.<x> = FunctionField(k)
sage: R.<t> = k[]
sage: t(x)
TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
```


CC:  @saraedum

Branch/Commit: 21e99818a6758436e2f61c1a8e0b09889f09318c

Reviewer: Simon Brandhorst, Stefan Wewers

Author: Julian RÃ¼th

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25449





---

archive/issue_comments_378006.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,12 +1,12 @@\n The following code fails:\n \n+    {{{#!python\n     sage: k = GF(55667)\n+    sage: F.<x> = FunctionField(k)\n+    sage: F._ring(x)(x)\n+    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n+    }}}\n \n-    sage: F.<x> = FunctionField(k)\n-\n-    sage: F._ring(x)(x)\n-\n-    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n \n Author: Stefan Wewers\n \n```\n",
    "created_at": "2018-05-27T14:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378006",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,12 +1,12 @@
 The following code fails:
 
+    {{{#!python
     sage: k = GF(55667)
+    sage: F.<x> = FunctionField(k)
+    sage: F._ring(x)(x)
+    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
+    }}}
 
-    sage: F.<x> = FunctionField(k)
-
-    sage: F._ring(x)(x)
-
-    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
 
 Author: Stefan Wewers
 
```




---

archive/issue_comments_378007.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-05-27T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378007",
    "user": "https://github.com/saraedum"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_378008.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to commutative algebra.",
    "created_at": "2018-05-27T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378008",
    "user": "https://github.com/saraedum"
}
```

Changing component from PLEASE CHANGE to commutative algebra.



---

archive/issue_comments_378009.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+The following code fails:\n+\n+```python\n+sage: k = GF(55667)\n+sage: F.<x> = FunctionField(k)\n+sage: R.<t> = F[]\n+sage: t(x)\n+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n+```\n \n \n Author: Stefan Wewers\n```\n",
    "created_at": "2018-05-27T19:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378009",
    "user": "https://github.com/saraedum"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,12 @@
+The following code fails:
+
+```python
+sage: k = GF(55667)
+sage: F.<x> = FunctionField(k)
+sage: R.<t> = F[]
+sage: t(x)
+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
+```
 
 
 Author: Stefan Wewers
```




---

archive/issue_comments_378010.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+The following code fails:\n+\n+```python\n+sage: k = GF(55667)\n+sage: F.<x> = FunctionField(k)\n+sage: R.<t> = k[]\n+sage: t(x)\n+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n+```\n \n \n Author: Stefan Wewers\n```\n",
    "created_at": "2018-05-27T19:43:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378010",
    "user": "https://github.com/saraedum"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,12 @@
+The following code fails:
+
+```python
+sage: k = GF(55667)
+sage: F.<x> = FunctionField(k)
+sage: R.<t> = k[]
+sage: t(x)
+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
+```
 
 
 Author: Stefan Wewers
```




---

archive/issue_comments_378011.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+The following code fails for all primes between 46349 and 65521.\n+\n+```python\n+sage: k = GF(55667)\n+sage: F.<x> = FunctionField(k)\n+sage: R.<t> = k[]\n+sage: t(x)\n+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n+```\n \n \n Author: Stefan Wewers\n```\n",
    "created_at": "2018-05-27T20:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378011",
    "user": "https://github.com/saraedum"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,12 @@
+The following code fails for all primes between 46349 and 65521.
+
+```python
+sage: k = GF(55667)
+sage: F.<x> = FunctionField(k)
+sage: R.<t> = k[]
+sage: t(x)
+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
+```
 
 
 Author: Stefan Wewers
```




---

archive/issue_comments_378012.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+The following code fails for all primes between 46349 and 65521, i.e., the primes between `sqrt(2^31-1)` and `2^16`.\n+\n+```python\n+sage: k = GF(55667)\n+sage: F.<x> = FunctionField(k)\n+sage: R.<t> = k[]\n+sage: t(x)\n+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n+```\n \n \n Author: Stefan Wewers\n```\n",
    "created_at": "2018-05-27T20:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378012",
    "user": "https://github.com/saraedum"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,12 @@
+The following code fails for all primes between 46349 and 65521, i.e., the primes between `sqrt(2^31-1)` and `2^16`.
+
+```python
+sage: k = GF(55667)
+sage: F.<x> = FunctionField(k)
+sage: R.<t> = k[]
+sage: t(x)
+TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
+```
 
 
 Author: Stefan Wewers
```




---

archive/issue_comments_378013.json:
```json
{
    "body": "<a id='comment:8'></a>New commits:",
    "created_at": "2018-05-27T20:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378013",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:8'></a>New commits:



---

archive/issue_comments_378014.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-27T20:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378014",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_378015.json:
```json
{
    "body": "<a id='comment:9'></a>I have not run doctests. Let's see what the patchbots say.",
    "created_at": "2018-05-27T20:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378015",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:9'></a>I have not run doctests. Let's see what the patchbots say.



---

archive/issue_comments_378016.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-28T13:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378016",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378017.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-11T07:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378017",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_378018.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-11T16:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378018",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378019.json:
```json
{
    "body": "<a id='comment:13'></a>New commits:",
    "created_at": "2018-06-11T16:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378019",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:13'></a>New commits:



---

archive/issue_comments_378020.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-11T16:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378020",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_378021.json:
```json
{
    "body": "<a id='comment:14'></a>The patchbot complains that we are importing additional modules at start up. This is probably happening here:\n\n```\n+        from sage.rings.fraction_field_FpT import FpT\n+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:\n```\nYou could try to use a lazy_import instead?\n\nOtherwise the code looks perfectly reasonable.",
    "created_at": "2018-07-03T20:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378021",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:14'></a>The patchbot complains that we are importing additional modules at start up. This is probably happening here:

```
+        from sage.rings.fraction_field_FpT import FpT
+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:
```
You could try to use a lazy_import instead?

Otherwise the code looks perfectly reasonable.



---

archive/issue_comments_378022.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-04T15:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378023.json:
```json
{
    "body": "<a id='comment:16'></a>I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)",
    "created_at": "2018-07-04T15:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378023",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:16'></a>I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)



---

archive/issue_comments_378024.json:
```json
{
    "body": "<a id='comment:17'></a>The patchbot also complains about:\n\n```\nFile \"src/sage/rings/polynomial/polynomial_ring.py\", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field\nFailed example:\n    t(x)\nExpected nothing\nGot:\n    x\n```\nCould that be related?",
    "created_at": "2018-07-04T15:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378024",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:17'></a>The patchbot also complains about:

```
File "src/sage/rings/polynomial/polynomial_ring.py", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field
Failed example:
    t(x)
Expected nothing
Got:
    x
```
Could that be related?



---

archive/issue_comments_378025.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-04T18:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378025",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_378026.json:
```json
{
    "body": "<a id='comment:18'></a>It is not working.\n\n```\nsage: k = GF(55667)\nsage: F.<x> = FunctionField(k)\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n...\n\nAttributeError: 'NoneType' object has no attribute 'category'\n```",
    "created_at": "2018-07-04T18:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378026",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:18'></a>It is not working.

```
sage: k = GF(55667)
sage: F.<x> = FunctionField(k)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
...

AttributeError: 'NoneType' object has no attribute 'category'
```



---

archive/issue_comments_378027.json:
```json
{
    "body": "<a id='comment:19'></a>Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)\nis that\n\nyour extra if clause messes up the else clause. \nAnd there is an x after sage: t(x) missing .",
    "created_at": "2018-07-04T19:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378027",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:19'></a>Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)
is that

your extra if clause messes up the else clause. 
And there is an x after sage: t(x) missing .



---

archive/issue_comments_378028.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-07T23:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378029.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-07-07T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378029",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_378030.json:
```json
{
    "body": "<a id='comment:22'></a>Thanks for having a look and sorry for that stupid error.",
    "created_at": "2018-07-07T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378030",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:22'></a>Thanks for having a look and sorry for that stupid error.



---

archive/issue_comments_378031.json:
```json
{
    "body": "<a id='comment:23'></a>The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.",
    "created_at": "2018-07-13T19:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378031",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:23'></a>The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.



---

archive/issue_comments_378032.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-21T07:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378032",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_378033.json:
```json
{
    "body": "<a id='comment:24'></a>The patchbot is happy now.",
    "created_at": "2018-07-21T07:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378033",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

<a id='comment:24'></a>The patchbot is happy now.



---

archive/issue_events_063869.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:18:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25449#event-63869"
}
```



---

archive/issue_comments_378034.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25449#issuecomment-378034",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
