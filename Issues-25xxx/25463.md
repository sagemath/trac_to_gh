# Issue 25463: pyflakes cleanup of elliptic curves

archive/issues_025226.json:
```json
{
    "body": "Aim: that all files in src.sage.schemes.elliptic_curves pass pyflakes, except for all.py.\n\nCC:  @categorie\n\nBranch/Commit: 70a2fc2e6ecf10f6c20e6f6b9b6da327e347cc16\n\nReviewer: John Cremona, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton, John Cremona\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25463\n\n",
    "closed_at": "2018-05-31T17:25:38Z",
    "created_at": "2018-05-30T07:40:32Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "pyflakes cleanup of elliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25463",
    "user": "https://github.com/fchapoton"
}
```
Aim: that all files in src.sage.schemes.elliptic_curves pass pyflakes, except for all.py.

CC:  @categorie

Branch/Commit: 70a2fc2e6ecf10f6c20e6f6b9b6da327e347cc16

Reviewer: John Cremona, Frédéric Chapoton

Author: Frédéric Chapoton, John Cremona

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25463





---

archive/issue_comments_354984.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-30T07:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354984",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_354985.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-05-30T07:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354985",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_354986.json:
```json
{
    "body": "<a id='comment:2'></a>I will look at this, and with luck will finish it off.  Thanks for doing the bulk so far.",
    "created_at": "2018-05-30T08:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354986",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:2'></a>I will look at this, and with luck will finish it off.  Thanks for doing the bulk so far.



---

archive/issue_comments_354987.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T09:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354988.json:
```json
{
    "body": "<a id='comment:4'></a>OK so I positively review all the changes made in the first commit, and offer more, which almost finishes off sage.schemes.elliptic_curves. \n\nRemaining issues:\n\n1. padic_lseries has 4 lines 1627-30 which look redundant but I want to ask someone else.\n2. all.py: this must be a general thing to decide if we want pyflakes not to comlain about almost all all.py files!  One way round it is to simply add a line \"assert x\" for everything imported, but is that necessary?\n3. There's a test in ell_number_field which is tagged long time with an estimate (by me probably) of 80s but it now takes 180s which is ridiculous.  I don't have time now to track down the regression, but there must be one somewhere.  I will open a ticket for that after checking that there is not yet one (I think there is a ticket about slow doctests for that file).",
    "created_at": "2018-05-30T09:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354988",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>OK so I positively review all the changes made in the first commit, and offer more, which almost finishes off sage.schemes.elliptic_curves. 

Remaining issues:

1. padic_lseries has 4 lines 1627-30 which look redundant but I want to ask someone else.
2. all.py: this must be a general thing to decide if we want pyflakes not to comlain about almost all all.py files!  One way round it is to simply add a line "assert x" for everything imported, but is that necessary?
3. There's a test in ell_number_field which is tagged long time with an estimate (by me probably) of 80s but it now takes 180s which is ridiculous.  I don't have time now to track down the regression, but there must be one somewhere.  I will open a ticket for that after checking that there is not yet one (I think there is a ticket about slow doctests for that file).



---

archive/issue_comments_354989.json:
```json
{
    "body": "<a id='comment:5'></a>I think we should already do the changes here, and maybe care for the few remaining ones later in another ticket. There is no need to do anything for all.py.\n\nI agree with your changes, and propose to set to positive once a patchbot is green.",
    "created_at": "2018-05-30T11:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354989",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>I think we should already do the changes here, and maybe care for the few remaining ones later in another ticket. There is no need to do anything for all.py.

I agree with your changes, and propose to set to positive once a patchbot is green.



---

archive/issue_comments_354990.json:
```json
{
    "body": "<a id='comment:6'></a>There are failing doctests in \n\nsage -t src/sage/schemes/elliptic_curves/BSD.py\n\nThese 3 failing doctests seem to be improvements over the existing ones. Should we just change them ?",
    "created_at": "2018-05-30T11:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354990",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>There are failing doctests in 

sage -t src/sage/schemes/elliptic_curves/BSD.py

These 3 failing doctests seem to be improvements over the existing ones. Should we just change them ?



---

archive/issue_comments_354991.json:
```json
{
    "body": "<a id='comment:7'></a>Yes, it seems that fixing the typo on current line means that the 5-part of the proof now goes through.  I would like Chris Wuthrich to give a view on both this and the one in padic_lseries before we merge this, but I will make an updated commit now. \n\nI guess this will be the first time in history where pyflakes has succeeded in solving one of the Millennium $1M Prize problems!",
    "created_at": "2018-05-30T12:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354991",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>Yes, it seems that fixing the typo on current line means that the 5-part of the proof now goes through.  I would like Chris Wuthrich to give a view on both this and the one in padic_lseries before we merge this, but I will make an updated commit now. 

I guess this will be the first time in history where pyflakes has succeeded in solving one of the Millennium $1M Prize problems!



---

archive/issue_comments_354992.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-30T12:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354992",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_354993.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T13:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354993",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354994.json:
```json
{
    "body": "<a id='comment:10'></a>I guess I will have to learn what pyflakes is. By now I assume it is a thing that picks up redundant or bad lines. Tell me if I need more. (Is there a version for cython, too? The amount of cython warnings during compilation should frighten anyone.)\n\n> padic_lseries has 4 lines 1627-30 which look redundant but I want to ask someone else. \n\n{{{\n        if p < 5:\n            phi = self.frobenius(min(6,prec),algorithm=\"approx\")\n        else:\n            phi = self.frobenius(prec+2,algorithm=\"mw\")\n}}}\nYes, they are, please delete.\nphi enters the picture only at line 1737.\n\nYes, the crit(e)_lw is mine. Sorry about this and thanks for correcting. I agree that the doctest can be changed as proposed.\n\nLet me know if I need to look at anything further, I am happy to help.",
    "created_at": "2018-05-30T13:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354994",
    "user": "https://github.com/categorie"
}
```

<a id='comment:10'></a>I guess I will have to learn what pyflakes is. By now I assume it is a thing that picks up redundant or bad lines. Tell me if I need more. (Is there a version for cython, too? The amount of cython warnings during compilation should frighten anyone.)

> padic_lseries has 4 lines 1627-30 which look redundant but I want to ask someone else. 

{{{
        if p < 5:
            phi = self.frobenius(min(6,prec),algorithm="approx")
        else:
            phi = self.frobenius(prec+2,algorithm="mw")
}}}
Yes, they are, please delete.
phi enters the picture only at line 1737.

Yes, the crit(e)_lw is mine. Sorry about this and thanks for correcting. I agree that the doctest can be changed as proposed.

Let me know if I need to look at anything further, I am happy to help.



---

archive/issue_comments_354995.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T13:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354995",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354996.json:
```json
{
    "body": "<a id='comment:12'></a>Thanks -- all the last commit does is delete the lines which had been commented out.\n\nYes, pyflakes does a syntax check & warns of unused imports, of variables assigned to but never then used (which can be a bug, as with one of these), or re-use of a variable name.  I don't know about cython.",
    "created_at": "2018-05-30T13:52:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354996",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>Thanks -- all the last commit does is delete the lines which had been commented out.

Yes, pyflakes does a syntax check & warns of unused imports, of variables assigned to but never then used (which can be a bug, as with one of these), or re-use of a variable name.  I don't know about cython.



---

archive/issue_comments_354997.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-30T13:52:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354997",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_354998.json:
```json
{
    "body": "<a id='comment:13'></a>I have just launched my patchbot. We can give a positive review once it's green.",
    "created_at": "2018-05-30T14:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354998",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>I have just launched my patchbot. We can give a positive review once it's green.



---

archive/issue_comments_354999.json:
```json
{
    "body": "<a id='comment:14'></a>green bot. Thanks !",
    "created_at": "2018-05-30T16:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-354999",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>green bot. Thanks !



---

archive/issue_comments_355000.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-30T16:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-355000",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_063894.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-31T17:25:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25463#event-63894"
}
```



---

archive/issue_comments_355001.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-31T17:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-355001",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
