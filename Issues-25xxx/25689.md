# Issue 25689: Update q_analogues.q_jordan

archive/issues_025452.json:
```json
{
    "body": "Small updates to q_jordan:\n\n1. Add default for `q`, like the other `q`-functions.\n2. Better handling of parents.\n3. Allow the `q=1` case.\n4. Better documentation.\n\nOn the way, an update for the multinomial function was needed.\n\nFor future reference, it might be possible to implement ``q_jordan`` using some closed-form expression, but that is for another ticket.\n\nCC:  @tscrim @jdemeyer\n\nKeywords: days94, q-analogs\n\nBranch/Commit: 0c4e9aedded12dc271b84e1cc3521934ed62d7b8\n\nReviewer: Travis Scrimshaw\n\nAuthor: Tomer Bauer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25689\n\n",
    "closed_at": "2018-08-05T08:17:59Z",
    "created_at": "2018-06-28T14:40:08Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Update q_analogues.q_jordan",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25689",
    "user": "https://github.com/mathzeta"
}
```
Small updates to q_jordan:

1. Add default for `q`, like the other `q`-functions.
2. Better handling of parents.
3. Allow the `q=1` case.
4. Better documentation.

On the way, an update for the multinomial function was needed.

For future reference, it might be possible to implement ``q_jordan`` using some closed-form expression, but that is for another ticket.

CC:  @tscrim @jdemeyer

Keywords: days94, q-analogs

Branch/Commit: 0c4e9aedded12dc271b84e1cc3521934ed62d7b8

Reviewer: Travis Scrimshaw

Author: Tomer Bauer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25689





---

archive/issue_comments_492683.json:
```json
{
    "body": "<a id='comment:1'></a>I have not touched the `q_stirling_number2` function added in #25235, even though I used the develop branch.",
    "created_at": "2018-06-28T15:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492683",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:1'></a>I have not touched the `q_stirling_number2` function added in #25235, even though I used the develop branch.



---

archive/issue_comments_492684.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-28T16:04:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492684",
    "user": "https://github.com/mathzeta"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_492685.json:
```json
{
    "body": "<a id='comment:4'></a>Can't we deprecate the list/iterable input? I don't see the point of that, given that you can just do `multinomial(*L)` instead of `multinomial(L)`.",
    "created_at": "2018-06-30T11:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492685",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Can't we deprecate the list/iterable input? I don't see the point of that, given that you can just do `multinomial(*L)` instead of `multinomial(L)`.



---

archive/issue_comments_492686.json:
```json
{
    "body": "<a id='comment:5'></a>Why did you remove `q_stirling_number2`?",
    "created_at": "2018-06-30T11:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492686",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Why did you remove `q_stirling_number2`?



---

archive/issue_comments_492687.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-06-30T11:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492687",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_492688.json:
```json
{
    "body": "<a id='comment:6'></a>Allowing general iterables is also dangerous because some Elements are iterable. Imagine for example that we extend this to allowing polynomials...",
    "created_at": "2018-06-30T11:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492688",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Allowing general iterables is also dangerous because some Elements are iterable. Imagine for example that we extend this to allowing polynomials...



---

archive/issue_comments_492689.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 jdemeyer]:\n> Allowing general iterables is also dangerous because some Elements are iterable. Imagine for example that we extend this to allowing polynomials...\n\nFor `multinomial` I would still like to use at least a list, a tuple, a Partition or a Composition as input. One example is calculating the number of elements of a given cycle type in the symmetric group, and it can come up as any of those objects.\n\nReplying to [comment:5 jdemeyer]:\n> Why did you remove `q_stirling_number2`?\n\n\nWe might need a git expert to explain how/why `q_stirling_number2` was removed. What is the best option to add it back without a new commit? I even fix it a bit in #25715.",
    "created_at": "2018-07-01T22:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492689",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:7'></a>Replying to [comment:6 jdemeyer]:
> Allowing general iterables is also dangerous because some Elements are iterable. Imagine for example that we extend this to allowing polynomials...

For `multinomial` I would still like to use at least a list, a tuple, a Partition or a Composition as input. One example is calculating the number of elements of a given cycle type in the symmetric group, and it can come up as any of those objects.

Replying to [comment:5 jdemeyer]:
> Why did you remove `q_stirling_number2`?


We might need a git expert to explain how/why `q_stirling_number2` was removed. What is the best option to add it back without a new commit? I even fix it a bit in #25715.



---

archive/issue_comments_492690.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:4 jdemeyer]:\n> Can't we deprecate the list/iterable input? I don't see the point of that, given that you can just do `multinomial(*L)` instead of `multinomial(L)`.\n\n\nThis probably should be done in a new ticket. One point of deprecating the variable amount of arguments version is that it is less consistent with some parts of Sage. For example, Partition and Composition get an iterable, as does Python's builtins such as list, set and tuple.",
    "created_at": "2018-07-02T07:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492690",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:8'></a>Replying to [comment:4 jdemeyer]:
> Can't we deprecate the list/iterable input? I don't see the point of that, given that you can just do `multinomial(*L)` instead of `multinomial(L)`.


This probably should be done in a new ticket. One point of deprecating the variable amount of arguments version is that it is less consistent with some parts of Sage. For example, Partition and Composition get an iterable, as does Python's builtins such as list, set and tuple.



---

archive/issue_comments_492691.json:
```json
{
    "body": "Changing branch from \"u/mathzeta2/q_jordan_update\" to \"u/mathzeta2/q_jordan_update_rebased\"",
    "created_at": "2018-07-02T14:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492691",
    "user": "https://github.com/mathzeta"
}
```

Changing branch from "u/mathzeta2/q_jordan_update" to "u/mathzeta2/q_jordan_update_rebased"



---

archive/issue_comments_492692.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-07-02T14:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492692",
    "user": "https://github.com/mathzeta"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_492693.json:
```json
{
    "body": "Changing commit from \"01334acbdd3ec38f6abaf4cd53dde3f09d9e9907\" to \"51c88c48e07794aee198319a9db84e1a444f4973\"",
    "created_at": "2018-07-02T14:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492693",
    "user": "https://github.com/mathzeta"
}
```

Changing commit from "01334acbdd3ec38f6abaf4cd53dde3f09d9e9907" to "51c88c48e07794aee198319a9db84e1a444f4973"



---

archive/issue_comments_492694.json:
```json
{
    "body": "<a id='comment:11'></a>New commits:",
    "created_at": "2018-07-02T14:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492694",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:11'></a>New commits:



---

archive/issue_comments_492695.json:
```json
{
    "body": "<a id='comment:12'></a>There is not a point of wrapping `tp` as a `Partition` in the recursion part as the cache converts it over (you should actually do `_Partitions(t)` instead of `Partition(t)` because the former is faster), and then you unwrap it with `list`.\n\nOtherwise LGTM.",
    "created_at": "2018-07-05T23:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492695",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>There is not a point of wrapping `tp` as a `Partition` in the recursion part as the cache converts it over (you should actually do `_Partitions(t)` instead of `Partition(t)` because the former is faster), and then you unwrap it with `list`.

Otherwise LGTM.



---

archive/issue_comments_492696.json:
```json
{
    "body": "<a id='comment:13'></a>`_Partitions` is a tiny bit faster indeed. Thanks.\n\nI also thought that the extra call to `Partition` is redundant, but the recursive call to `q_jordan` is to the undecorated function. Maybe a new helper function `_cached_q_jordan` can help?\n\n(A solution for another day is an iterative implementation, as done in `q_subgroups_of_abelian_group`.)",
    "created_at": "2018-07-06T02:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492696",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:13'></a>`_Partitions` is a tiny bit faster indeed. Thanks.

I also thought that the extra call to `Partition` is redundant, but the recursive call to `q_jordan` is to the undecorated function. Maybe a new helper function `_cached_q_jordan` can help?

(A solution for another day is an iterative implementation, as done in `q_subgroups_of_abelian_group`.)



---

archive/issue_comments_492697.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-17T15:48:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492698.json:
```json
{
    "body": "Changing commit from \"51c88c48e07794aee198319a9db84e1a444f4973\" to \"0c4e9aedded12dc271b84e1cc3521934ed62d7b8\"",
    "created_at": "2018-07-17T15:48:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "51c88c48e07794aee198319a9db84e1a444f4973" to "0c4e9aedded12dc271b84e1cc3521934ed62d7b8"



---

archive/issue_comments_492699.json:
```json
{
    "body": "<a id='comment:15'></a>Now things are better, and use `_Partitions`, also for `q_subgroups_of_abelian_group`.\n\nThe `cached_function` decorator use the `key` argument only for comparisons in the cache, and that is why I was puzzled when checking for the empty partition, as opposed to a list composed of all zeros. The empty partition have zero length and it is `False` as a boolean:\n\n```sage\nsage: Partition([]) == Partition([0]) == Partition([0, 0])\nTrue\n```\n\nBut this is not true for lists like `[0]`, of course.",
    "created_at": "2018-07-17T16:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492699",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:15'></a>Now things are better, and use `_Partitions`, also for `q_subgroups_of_abelian_group`.

The `cached_function` decorator use the `key` argument only for comparisons in the cache, and that is why I was puzzled when checking for the empty partition, as opposed to a list composed of all zeros. The empty partition have zero length and it is `False` as a boolean:

```sage
sage: Partition([]) == Partition([0]) == Partition([0, 0])
True
```

But this is not true for lists like `[0]`, of course.



---

archive/issue_comments_492700.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:12 tscrim]:\n> Otherwise LGTM.\n\n\nI wanted to set the ticket to positive review myself, but I would appreciate a look at the last commit for a final OK.",
    "created_at": "2018-08-03T06:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492700",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:16'></a>Replying to [comment:12 tscrim]:
> Otherwise LGTM.


I wanted to set the ticket to positive review myself, but I would appreciate a look at the last commit for a final OK.



---

archive/issue_comments_492701.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2018-08-03T06:31:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492701",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_492702.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-03T06:31:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492702",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_492703.json:
```json
{
    "body": "<a id='comment:17'></a>Sorry, I lost track of this. Your changes are good. Thanks.",
    "created_at": "2018-08-03T06:31:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492703",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>Sorry, I lost track of this. Your changes are good. Thanks.



---

archive/issue_comments_492704.json:
```json
{
    "body": "Changing branch from \"u/mathzeta2/q_jordan_update_rebased\" to \"0c4e9aedded12dc271b84e1cc3521934ed62d7b8\"",
    "created_at": "2018-08-05T08:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492704",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mathzeta2/q_jordan_update_rebased" to "0c4e9aedded12dc271b84e1cc3521934ed62d7b8"



---

archive/issue_comments_492705.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25689#issuecomment-492705",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_064313.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:17:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25689",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25689#event-64313"
}
```
