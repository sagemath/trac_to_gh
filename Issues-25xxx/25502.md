# Issue 25502: py3: implement __hash__ method in ContinuousMap

archive/issues_025265.json:
```json
{
    "body": "`ContinuousMap` defines its own `__eq__` method, while inheritating from `Morphism.__hash__`. Now, as pointed out in #24551, Python3 breaks the inheritance of `__hash__` when `__eq__` is redefined. This ticket fixes this by implementing `ContinousMap.__hash__`. Moreover, contrary to `Morphism.__hash__`, the new method does not rely on `repr()` and guarantees that two continous maps that compare equal have the same hash.\n\nNote that there is a proposal at #25393 to remove `Morphism.__hash__`. \n\n`ContinousMap` (more precisely the derived class `DiffMap`) needs to be hashable because `DiffMap` objects serve as keys in the dictionary of vector field modules on a manifold, a module of vector fields on a differentiable manifold being essentially defined by a differentiable map (with the important special case of the identity map; see [here](http://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/vectorfield_module.html) for details).\n\n\nCC:  @tscrim @embray @fchapoton\n\nKeywords: python3, topological manifold\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Eric Gourgoulhon\n\nBranch: 83dcbb1e363942f044fcb9a78d05c7bf8029be0b\n\nCommit: 83dcbb1e363942f044fcb9a78d05c7bf8029be0b\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25502\n\n",
    "closed_at": "2018-06-06T19:53:33Z",
    "created_at": "2018-06-03T20:13:14Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "py3: implement __hash__ method in ContinuousMap",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25502",
    "user": "https://github.com/egourgoulhon"
}
```
`ContinuousMap` defines its own `__eq__` method, while inheritating from `Morphism.__hash__`. Now, as pointed out in #24551, Python3 breaks the inheritance of `__hash__` when `__eq__` is redefined. This ticket fixes this by implementing `ContinousMap.__hash__`. Moreover, contrary to `Morphism.__hash__`, the new method does not rely on `repr()` and guarantees that two continous maps that compare equal have the same hash.

Note that there is a proposal at #25393 to remove `Morphism.__hash__`. 

`ContinousMap` (more precisely the derived class `DiffMap`) needs to be hashable because `DiffMap` objects serve as keys in the dictionary of vector field modules on a manifold, a module of vector fields on a differentiable manifold being essentially defined by a differentiable map (with the important special case of the identity map; see [here](http://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/vectorfield_module.html) for details).


CC:  @tscrim @embray @fchapoton

Keywords: python3, topological manifold

Reviewer: Frédéric Chapoton

Author: Eric Gourgoulhon

Branch: 83dcbb1e363942f044fcb9a78d05c7bf8029be0b

Commit: 83dcbb1e363942f044fcb9a78d05c7bf8029be0b

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25502





---

archive/issue_comments_355730.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-06-03T20:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25502#issuecomment-355730",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_355731.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-03T20:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25502#issuecomment-355731",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_355732.json:
```json
{
    "body": "<a id='comment:3'></a>does seem to be a very rough hash... But it will do the job for the moment",
    "created_at": "2018-06-04T06:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25502#issuecomment-355732",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>does seem to be a very rough hash... But it will do the job for the moment



---

archive/issue_comments_355733.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-04T06:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25502#issuecomment-355733",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_355734.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 chapoton]:\n> does seem to be a very rough hash... But it will do the job for the moment\n\n\nYes it's pretty rough, but there should be no loss of efficiency, since continuous maps are only used as keys in the dictionary `DifferentiableManifold._vector_field_modules`, which is of very small size; most of the time, it has a single element (the continuous map being then merely the identity map).",
    "created_at": "2018-06-04T08:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25502#issuecomment-355734",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:4'></a>Replying to [comment:3 chapoton]:
> does seem to be a very rough hash... But it will do the job for the moment


Yes it's pretty rough, but there should be no loss of efficiency, since continuous maps are only used as keys in the dictionary `DifferentiableManifold._vector_field_modules`, which is of very small size; most of the time, it has a single element (the continuous map being then merely the identity map).



---

archive/issue_comments_355735.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-06T19:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25502#issuecomment-355735",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_063966.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-06T19:53:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25502",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25502#event-63966"
}
```
