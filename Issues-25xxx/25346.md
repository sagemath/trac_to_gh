# Issue 25346: improve (un)flattening morphisms

archive/issues_025109.json:
```json
{
    "body": "\n\nCC:  @videlec @bhutz\n\nBranch/Commit: 49b51be49b8c47633b3683033e4217aa174bf47c\n\nReviewer: Ben Hutz\n\nAuthor: Marc Mezzarobba\n\nDependencies: #25233\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25346\n\n",
    "closed_at": "2018-06-01T15:42:10Z",
    "created_at": "2018-05-11T18:22:24Z",
    "labels": [
        "component: commutative algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "improve (un)flattening morphisms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25346",
    "user": "https://github.com/mezzarobba"
}
```


CC:  @videlec @bhutz

Branch/Commit: 49b51be49b8c47633b3683033e4217aa174bf47c

Reviewer: Ben Hutz

Author: Marc Mezzarobba

Dependencies: #25233

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25346





---

archive/issue_comments_486061.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mmezzarobba/25346-flatten\"",
    "created_at": "2018-05-11T19:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486061",
    "user": "https://github.com/mezzarobba"
}
```

Changing branch from "" to "u/mmezzarobba/25346-flatten"



---

archive/issue_comments_486062.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[0d56c5f](https://github.com/sagemath/sagetrac-mirror/commit/0d56c5f309704f42c255a7d8976a73a70d7b3579)|`Support repeated variable names in FlatteningMorphism`|\n|[751fe89](https://github.com/sagemath/sagetrac-mirror/commit/751fe8934b48ff6f7e14cdf03b8f923dc8cb3ebe)|`cached flattening_morphism() method for univariate polynomial rings`|\n|[8de9bbf](https://github.com/sagemath/sagetrac-mirror/commit/8de9bbfad926e89eef4ff0f0ed84fc7b37bee741)|`use FlatteningMorphism in gcd over stacked polynomial rings`|\n|[5be96e0](https://github.com/sagemath/sagetrac-mirror/commit/5be96e077ba684f425d22b4057029e1efc6355d4)|`typo`|\n|[6768cf6](https://github.com/sagemath/sagetrac-mirror/commit/6768cf6b139ff32db676b8533538f51a063a4627)|`small optimization in flattening_morphism()`|\n|[6361fdc](https://github.com/sagemath/sagetrac-mirror/commit/6361fdcbb3327456cd4062a5f556ddad6246ec91)|`speed up creation of (un)flattening morphisms`|\n|[d425e29](https://github.com/sagemath/sagetrac-mirror/commit/d425e29abf884deface3e40f1eb8d0e59b9d558c)|`singular polys: _element_constructor_(check=False)`|\n|[49b51be](https://github.com/sagemath/sagetrac-mirror/commit/49b51be49b8c47633b3683033e4217aa174bf47c)|`speed up (un)flattening morphisms`|",
    "created_at": "2018-05-11T19:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486062",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[0d56c5f](https://github.com/sagemath/sagetrac-mirror/commit/0d56c5f309704f42c255a7d8976a73a70d7b3579)|`Support repeated variable names in FlatteningMorphism`|
|[751fe89](https://github.com/sagemath/sagetrac-mirror/commit/751fe8934b48ff6f7e14cdf03b8f923dc8cb3ebe)|`cached flattening_morphism() method for univariate polynomial rings`|
|[8de9bbf](https://github.com/sagemath/sagetrac-mirror/commit/8de9bbfad926e89eef4ff0f0ed84fc7b37bee741)|`use FlatteningMorphism in gcd over stacked polynomial rings`|
|[5be96e0](https://github.com/sagemath/sagetrac-mirror/commit/5be96e077ba684f425d22b4057029e1efc6355d4)|`typo`|
|[6768cf6](https://github.com/sagemath/sagetrac-mirror/commit/6768cf6b139ff32db676b8533538f51a063a4627)|`small optimization in flattening_morphism()`|
|[6361fdc](https://github.com/sagemath/sagetrac-mirror/commit/6361fdcbb3327456cd4062a5f556ddad6246ec91)|`speed up creation of (un)flattening morphisms`|
|[d425e29](https://github.com/sagemath/sagetrac-mirror/commit/d425e29abf884deface3e40f1eb8d0e59b9d558c)|`singular polys: _element_constructor_(check=False)`|
|[49b51be](https://github.com/sagemath/sagetrac-mirror/commit/49b51be49b8c47633b3683033e4217aa174bf47c)|`speed up (un)flattening morphisms`|



---

archive/issue_comments_486063.json:
```json
{
    "body": "Changing commit from \"\" to \"49b51be49b8c47633b3683033e4217aa174bf47c\"",
    "created_at": "2018-05-11T19:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486063",
    "user": "https://github.com/mezzarobba"
}
```

Changing commit from "" to "49b51be49b8c47633b3683033e4217aa174bf47c"



---

archive/issue_comments_486064.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#25233\"",
    "created_at": "2018-05-11T19:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486064",
    "user": "https://github.com/mezzarobba"
}
```

Changing dependencies from "" to "#25233"



---

archive/issue_comments_486065.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-11T19:17:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486065",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_486066.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-05-12T20:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486066",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_486067.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ben Hutz\"",
    "created_at": "2018-05-12T20:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486067",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "" to "Ben Hutz"



---

archive/issue_comments_486068.json:
```json
{
    "body": "<a id='comment:4'></a>\nI've run a few tests on this and haven't come up with anything that does not work correctly.\n\nHowever, I'd like to know what prompted the addition of ArithmeticError to the gcd check in dehomomgenize for affine morphisms.\n\nIt is likely that whatever this is will also occur in normalize_coordinates for projective morphisms.",
    "created_at": "2018-05-12T20:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486068",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:4'></a>
I've run a few tests on this and haven't come up with anything that does not work correctly.

However, I'd like to know what prompted the addition of ArithmeticError to the gcd check in dehomomgenize for affine morphisms.

It is likely that whatever this is will also occur in normalize_coordinates for projective morphisms.



---

archive/issue_comments_486069.json:
```json
{
    "body": "<a id='comment:5'></a>\nThat last comment is better directed to #25233 as that is where the change was made; so I've added it there.",
    "created_at": "2018-05-12T20:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486069",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:5'></a>
That last comment is better directed to #25233 as that is where the change was made; so I've added it there.



---

archive/issue_comments_486070.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-05-14T10:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486070",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_486071.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [bhutz](#comment%3A4):\n\nBen, do you still intend to review this branch?",
    "created_at": "2018-05-31T07:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486071",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:7'></a>
Replying to [bhutz](#comment%3A4):

Ben, do you still intend to review this branch?



---

archive/issue_comments_486072.json:
```json
{
    "body": "<a id='comment:8'></a>\nYes ,I'll review this now that 25233 is closed",
    "created_at": "2018-05-31T14:40:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486072",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>
Yes ,I'll review this now that 25233 is closed



---

archive/issue_comments_486073.json:
```json
{
    "body": "<a id='comment:9'></a>\nThis looks fine to me. I'd still like the arithmeticerror issue resolved, but I understand the desire for that to be a separate ticket.",
    "created_at": "2018-05-31T16:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486073",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:9'></a>
This looks fine to me. I'd still like the arithmeticerror issue resolved, but I understand the desire for that to be a separate ticket.



---

archive/issue_comments_486074.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-31T16:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486074",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_486075.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [bhutz](#comment%3A9):\n> This looks fine to me.\n\n\nThanks!\n\n> I'd still like the arithmeticerror issue resolved, but I understand the desire for that to be a separate ticket.\n\n\nActually, with on a branch that contains contain and my other tickets currently waiting for review, it now works for me (that is, the gcd is computed)! I don't know not sure what changed fixed the issue.",
    "created_at": "2018-05-31T18:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486075",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:10'></a>
Replying to [bhutz](#comment%3A9):
> This looks fine to me.


Thanks!

> I'd still like the arithmeticerror issue resolved, but I understand the desire for that to be a separate ticket.


Actually, with on a branch that contains contain and my other tickets currently waiting for review, it now works for me (that is, the gcd is computed)! I don't know not sure what changed fixed the issue.



---

archive/issue_comments_486076.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-01T15:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486076",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_072254.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-01T15:42:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25346#event-72254"
}
```



---

archive/issue_comments_486077.json:
```json
{
    "body": "Changing branch from \"u/mmezzarobba/25346-flatten\" to \"49b51be49b8c47633b3683033e4217aa174bf47c\"",
    "created_at": "2018-06-01T15:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25346#issuecomment-486077",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mmezzarobba/25346-flatten" to "49b51be49b8c47633b3683033e4217aa174bf47c"
