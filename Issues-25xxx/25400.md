# Issue 25400: LattE: is_package_installed -> feature

archive/issues_025163.json:
```json
{
    "body": "The function `_volume_latte` calls `is_package_installed` which does not exist anymore. As a consequence\n\n```\nsage -t --long src/sage/geometry/polyhedron/base.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 4410, in sage.geometry.polyhedron.base.Polyhedron_base._volume_latte\nFailed example:\n    polytopes.hypercube(3)._volume_latte() #optional - latte_int\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 562, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 972, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.geometry.polyhedron.base.Polyhedron_base._volume_latte[0]>\", line 1, in <module>\n        polytopes.hypercube(Integer(3))._volume_latte() #optional - latte_int\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base.py\", line 4436, in _volume_latte\n        if is_package_installed('latte_int'):\n    NameError: global name 'is_package_installed' is not defined\n**********************************************************************\n```\n\nCC:  @jplab @mkoeppe @mo271\n\nBranch/Commit: e54f09e8a36c8778b2dac3b31a8cac17f62798c9\n\nReviewer: Julian R\u00fcth\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25400\n\n",
    "closed_at": "2018-06-06T19:53:43Z",
    "created_at": "2018-05-19T07:36:14Z",
    "labels": [
        "component: packages: optional",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "LattE: is_package_installed -> feature",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25400",
    "user": "https://github.com/videlec"
}
```
The function `_volume_latte` calls `is_package_installed` which does not exist anymore. As a consequence

```
sage -t --long src/sage/geometry/polyhedron/base.py
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 4410, in sage.geometry.polyhedron.base.Polyhedron_base._volume_latte
Failed example:
    polytopes.hypercube(3)._volume_latte() #optional - latte_int
Exception raised:
    Traceback (most recent call last):
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 562, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 972, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.base.Polyhedron_base._volume_latte[0]>", line 1, in <module>
        polytopes.hypercube(Integer(3))._volume_latte() #optional - latte_int
      File "/opt/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base.py", line 4436, in _volume_latte
        if is_package_installed('latte_int'):
    NameError: global name 'is_package_installed' is not defined
**********************************************************************
```

CC:  @jplab @mkoeppe @mo271

Branch/Commit: e54f09e8a36c8778b2dac3b31a8cac17f62798c9

Reviewer: Julian RÃ¼th

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25400





---

archive/issue_comments_377244.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+The function \\`_volume_latte\\` calls \\`is_package_installed\\` which does not exist anymore. As a consequence\n+\n \\`\\`\\`\n sage -t --long src/sage/geometry/polyhedron/base.py\n **********************************************************************\n```\n",
    "created_at": "2018-05-19T07:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377244",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,5 @@
+The function \`_volume_latte\` calls \`is_package_installed\` which does not exist anymore. As a consequence
+
 \`\`\`
 sage -t --long src/sage/geometry/polyhedron/base.py
 **********************************************************************
```




---

archive/issue_comments_377245.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2018-05-19T08:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377245",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_377246.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-19T08:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377246",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_377247.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-05-19T08:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377248.json:
```json
{
    "body": "<a id='comment:6'></a>The function `_volume_latte` from `sage.geometry.polyhedron.base` calls `is_package_installed` which is not imported anymore... (#20382). As a consequence\n\n```\nsage -t --long src/sage/geometry/polyhedron/base.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 4410, in sage.geometry.polyhedron.base.Polyhedron_base._volume_latte\nFailed example:\n    polytopes.hypercube(3)._volume_latte() #optional - latte_int\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 562, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 972, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.geometry.polyhedron.base.Polyhedron_base._volume_latte[0]>\", line 1, in <module>\n        polytopes.hypercube(Integer(3))._volume_latte() #optional - latte_int\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base.py\", line 4436, in _volume_latte\n        if is_package_installed('latte_int'):\n    NameError: global name 'is_package_installed' is not defined\n**********************************************************************\n```\n\nInstead of reimporting it, we rather rely on the new feature framework introduced in #20382.",
    "created_at": "2018-05-19T08:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377248",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>The function `_volume_latte` from `sage.geometry.polyhedron.base` calls `is_package_installed` which is not imported anymore... (#20382). As a consequence

```
sage -t --long src/sage/geometry/polyhedron/base.py
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 4410, in sage.geometry.polyhedron.base.Polyhedron_base._volume_latte
Failed example:
    polytopes.hypercube(3)._volume_latte() #optional - latte_int
Exception raised:
    Traceback (most recent call last):
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 562, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 972, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.base.Polyhedron_base._volume_latte[0]>", line 1, in <module>
        polytopes.hypercube(Integer(3))._volume_latte() #optional - latte_int
      File "/opt/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base.py", line 4436, in _volume_latte
        if is_package_installed('latte_int'):
    NameError: global name 'is_package_installed' is not defined
**********************************************************************
```

Instead of reimporting it, we rather rely on the new feature framework introduced in #20382.



---

archive/issue_comments_377249.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-20T23:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377249",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_377250.json:
```json
{
    "body": "<a id='comment:7'></a>Looks good. I think you want to drop an \"s\" and replace `\"Test whether count and integrate are functionals.\"` with\n`\"Test whether ``count`` and ``integrate`` are functional.\"` Also, I think that our new files should have copyright headers at least that's what the developer guide suggests.\n\nThe patchbot run looks weird. Do you understand what's going on?",
    "created_at": "2018-05-20T23:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377250",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:7'></a>Looks good. I think you want to drop an "s" and replace `"Test whether count and integrate are functionals."` with
`"Test whether ``count`` and ``integrate`` are functional."` Also, I think that our new files should have copyright headers at least that's what the developer guide suggests.

The patchbot run looks weird. Do you understand what's going on?



---

archive/issue_comments_377251.json:
```json
{
    "body": "<a id='comment:8'></a>This is a reasonable failure that has to be fixed\n\n```\nsage -t --long --warn-long 80.1 src/sage/interfaces/latte.py\n**********************************************************************\nFile \"src/sage/interfaces/latte.py\", line 45, in sage.interfaces.latte.count\nFailed example:\n    from sage.interfaces.latte import count\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 562, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 972, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.latte.count[0]>\", line 1, in <module>\n        from sage.interfaces.latte import count\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/interfaces/latte.py\", line 18, in <module>\n        Latte().require()\n      File \"/opt/sage/local/lib/python2.7/site-packages/sage/features/__init__.py\", line 158, in require\n        raise FeatureNotPresentError(self, presence.reason, presence.resolution)\n    FeatureNotPresentError: LattE is not available.\n    Executable 'count' not found on PATH.\n    To install count you can try to run 'sage -i latte_int'.\n    Further installation instructions might be available at https://www.math.ucdavis.edu/~latte/software.php.\n```",
    "created_at": "2018-05-21T06:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377251",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>This is a reasonable failure that has to be fixed

```
sage -t --long --warn-long 80.1 src/sage/interfaces/latte.py
**********************************************************************
File "src/sage/interfaces/latte.py", line 45, in sage.interfaces.latte.count
Failed example:
    from sage.interfaces.latte import count
Exception raised:
    Traceback (most recent call last):
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 562, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 972, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.latte.count[0]>", line 1, in <module>
        from sage.interfaces.latte import count
      File "/opt/sage/local/lib/python2.7/site-packages/sage/interfaces/latte.py", line 18, in <module>
        Latte().require()
      File "/opt/sage/local/lib/python2.7/site-packages/sage/features/__init__.py", line 158, in require
        raise FeatureNotPresentError(self, presence.reason, presence.resolution)
    FeatureNotPresentError: LattE is not available.
    Executable 'count' not found on PATH.
    To install count you can try to run 'sage -i latte_int'.
    Further installation instructions might be available at https://www.math.ucdavis.edu/~latte/software.php.
```



---

archive/issue_comments_377252.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-05-28T13:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377253.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-28T14:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377253",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_377254.json:
```json
{
    "body": "<a id='comment:11'></a>rebased on beta3... needs review",
    "created_at": "2018-05-28T14:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377254",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>rebased on beta3... needs review



---

archive/issue_comments_377255.json:
```json
{
    "body": "<a id='comment:13'></a>There's something about this ticket which seems to make patchbots crash. Whenever my patchbot (fermat) gets around to testing this ticket, it gets as far as applying the patch + building docs, and then it hangs -- the python subprocesses that are spawned to build the various ref manual chapters somehow get stuck + don't terminate.\n\nAny idea what could be causing this? No other currently-open ticket causes this behaviour.",
    "created_at": "2018-05-29T12:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377255",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:13'></a>There's something about this ticket which seems to make patchbots crash. Whenever my patchbot (fermat) gets around to testing this ticket, it gets as far as applying the patch + building docs, and then it hangs -- the python subprocesses that are spawned to build the various ref manual chapters somehow get stuck + don't terminate.

Any idea what could be causing this? No other currently-open ticket causes this behaviour.



---

archive/issue_comments_377256.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-29T13:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377256",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_377257.json:
```json
{
    "body": "<a id='comment:14'></a>I made a check at import time... if it fails it is possible that sphinx hang forever. I will test.",
    "created_at": "2018-05-29T13:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377257",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>I made a check at import time... if it fails it is possible that sphinx hang forever. I will test.



---

archive/issue_comments_377258.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T14:06:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377258",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_377259.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-30T14:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377259",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_377260.json:
```json
{
    "body": "<a id='comment:17'></a>feel free to set this to positive review if the patchbot issue is fixed now.",
    "created_at": "2018-06-01T23:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377260",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:17'></a>feel free to set this to positive review if the patchbot issue is fixed now.



---

archive/issue_comments_377261.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-03T08:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377261",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_377262.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-06T19:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25400#issuecomment-377262",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_063792.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-06T19:53:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25400",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25400#event-63792"
}
```
